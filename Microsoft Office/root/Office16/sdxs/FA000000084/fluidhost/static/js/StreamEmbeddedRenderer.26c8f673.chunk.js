"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[835],{72029:function(e,t,n){n.r(t),n.d(t,{StreamEmbeddedRenderer:function(){return ze}});var i=n(72791),r=n(96013),o=n(5769),a=n(73562),s=n(44759),c=n(71507),u=n(78339),l=n(69438),d=n(2701),p=n(4942),h="playerInteractiveTimestamp";function f(){return{setIsReady:function(e,t){var n;t.playerInteractiveTimestamp&&e.setResult(!0,(n={},(0,p.Z)(n,h,Math.round(t.playerInteractiveTimestamp)),(0,p.Z)(n,"unfurlDurationMs_performanceNow",Math.round(t.playerInteractiveTimestamp-e.startTime)),n))},addAdditionalProps:function(e,t){e.addAdditionalProps(t)}}}var m=n(19426);function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m.E.VideoLoadFromUnfurl;return e.activities.get(t)}var y=[" ","Enter"],b=[].concat(y,["Tab"]);var _=n(33874),w=n(74165),g=n(15861),k=n(97349),E=n(70897),S=n(55520),T=function(e,t,n,i,r,o,a,s){this.level=e,this.isExpected=t,this.scenario=n,this.knownError=i,this.originalError=r,this.message=o,this.playbackSessionId=a,this.hostSessionId=s},P=n(75971),I=function(e){this.willBeUnregistered=!1,this.unregisterOnNextCall=!1,this.callback=e},M=function(){function e(e){this._observers=new Array,this.onCallbackError=e}return e.prototype.subscribe=function(e,t){if(void 0===t&&(t={}),!e)return function(){};var n=new I(e);return n.unregisterOnNextCall=!!t.unregisterOnFirstCall,this._observers.push(n),this.internalRemove.bind(this,n)},e.prototype.notify=function(e){for(var t=0,n=this._observers;t<n.length;t++){var i=n[t];if(!i.willBeUnregistered){try{i.callback(e)}catch(r){this.onCallbackError&&this.onCallbackError(r)}i.unregisterOnNextCall&&this.deferUnregister(i)}}},e.prototype.unsubscribeAll=function(){this._observers.length=0},e.prototype.deferUnregister=function(e){var t=this;e.unregisterOnNextCall=!1,e.willBeUnregistered=!0,setTimeout((function(){t.internalRemove(e)}),0)},e.prototype.internalRemove=function(e){var t=this._observers.indexOf(e);return-1!==t&&(this._observers.splice(t,1),!0)},e}(),C=function(){function e(e,t){this._observable=new M(t),this._value=e,this.onCallbackError=t}return e.prototype.unsubscribeAll=function(){this._observable.unsubscribeAll()},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){e!==this._value&&(this._value=e,this._observable.notify(e))},enumerable:!1,configurable:!0}),e.prototype.subscribe=function(e,t){var n=!(null===t||void 0===t?void 0:t.ignoreCurrentValue);if(n)try{e(this._value)}catch(i){this.onCallbackError&&this.onCallbackError(i)}return(null===t||void 0===t?void 0:t.unregisterOnFirstCall)&&n?function(){}:this._observable.subscribe(e,t)},e}(),A=function(){function e(e){this._callbacks=[],this._owner=e}return e.prototype.addCallback=function(e){this._callbacks.push(e)},e.prototype.dispose=function(){for(var e;e=this._callbacks.pop();)e.call(this._owner)},e}();function O(e,t){var n=e,i=n.dispose,r="function"===typeof i&&i.disposalChain||function(e){var t=new A(e),n=e.dispose,i=function(){t.dispose(),n&&(e.dispose=n,e.dispose())};return e.dispose=i,i.disposalChain=t,t}(n);return r.addCallback(t),n}var R=function(){function e(){this._disposables={},this._lastDisposableId=0,this.isDisposed=!1}return e.prototype.attach=function(e){var t=this,n="".concat(++this._lastDisposableId),i=O(e,(function(){delete t._disposables[n]}));return this._disposables[n]=i,i},e.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0);for(var e=this._disposables,t=0,n=Object.keys(e);t<n.length;t++){var i=n[t],r=e[i];r&&"function"===typeof r.dispose&&r.dispose(),delete e[i]}},e}(),U=function(){function e(e){this._scope=new R,this._targetMap=new WeakMap,this._disposableMap=new WeakMap}return e.prototype.on=function(e,t,n){var i;if(x(e))i=e;else{var r=this._targetMap.get(e);r?i=r:(i=new EventTarget,this._targetMap.set(e,i))}i.addEventListener(t,n);var o=this._disposableMap.get(e);o||(o=new Map,this._disposableMap.set(e,o));var a=this._scope.attach({dispose:function(){i.removeEventListener(t,n)}});o.set(t,a)},e.prototype.off=function(e,t,n){var i;if(x(e))i=e;else{var r=this._targetMap.get(e);r&&(i=r)}var o=this._disposableMap.get(e);if(o){var a=o.get(t);a&&(a.dispose(),o.delete(t)),0===o.size&&this._disposableMap.delete(e)}i&&i.removeEventListener(t,n)},e.prototype.dispose=function(){this._scope.dispose()},e}();function x(e){return!!e.addEventListener}var N=function(){function e(e){this._scope=new R,this._timeoutMap=new Map}return e.prototype.setTimeout=function(e,t){var n=this,i=setTimeout((function(){n._timeoutMap.delete(i),e()}),t),r=this._scope.attach({dispose:function(){clearTimeout(i)}});return this._timeoutMap.set(i,r),i},e.prototype.clearTimeout=function(e){var t=this._timeoutMap.get(e);t&&(this._timeoutMap.delete(e),t.dispose())},e.prototype.dispose=function(){this._scope.dispose()},e}(),D="unsupportedCommand",F="handlerError",L="handlerRejection",H="acknowledgeTimeout",V="resultTimeout",W="setupTimeout",j="canceled",Z="disposed",G=0,B=function(){function e(e,t){void 0===t&&(t={});var n=this,i=new Map,r={onCommand:e.onCommand,onNotification:e.onNotification},o=e.initResources,a=e.initTimeoutMs,s=void 0===a?1e4:a,c=e.ackTimeoutMs,u=void 0===c?1e3:c,l=e.resultTimeoutMs,d=void 0===l?1e4:l,p=t.asyncType,h=void 0===p?N:p,f=t.eventGroupType,m=void 0===f?U:f,v=this._scope=new R;v.attach(o);var y,b=this._async=v.attach(new h(this)),_=v.attach(new m(this));this._ackTimeoutMs=u,this._resultTimeoutMs=d,this._invokeCommandHandler=function(e){try{var t=r.onCommand&&r.onCommand(e);return t?Promise.resolve(t).catch((function(e){return{result:"error",error:{code:(e=e||{name:L,isExpected:!1,message:"Unknown error"}).code||e.name||L,message:e.message||"".concat(e)},isExpected:!!e.isExpected}})):Promise.resolve({result:"error",error:{code:D,message:e.command},isExpected:!0})}catch(n){return Promise.resolve({result:"error",isExpected:!1,error:{code:F,message:n&&"Name: ".concat(n.name,"; Message: ").concat(n.message||n)}})}},this._invokeNotificationHandler=function(e){try{r.onNotification&&r.onNotification(e)}catch(a){}};var w=this._port=new Promise((function(t,i){v.attach({dispose:function(){var e=new Error("Initialization canceled.");e.code=j,i(e)}}),y=b.setTimeout((function(){var e=new Error("Initialization timed out after ".concat(s,"ms"));e.code=W,i(e)}),s),e.init((function(e){b.clearTimeout(y),v.attach({dispose:function(){e.close()}});_.on(e,"message",(function(t){var i=t.data;if(i&&"object"===typeof i)return"acknowledge"===i.type?n._onAcknowledge(i):"command"===i.type?n._onCommand(e,i):"notification"===i.type?n._onNotification(i):"result"===i.type?n._onResult(i):void 0})),e.start(),t(e)}),i)}));this.ready=w.then((function(){}),(function(e){return n.dispose(),Promise.reject(e)})),this._signals=i}return e.prototype.dispose=function(){this._scope.dispose(),this._signals.forEach((function(e){e.resolve({result:"error",isExpected:!0,error:{code:j,message:"Messenger disposed"}})})),this._signals.clear()},e.prototype.sendCommand=function(e,t){var n=this;if(void 0===t&&(t={}),this._scope.isDisposed)return Promise.resolve({result:"error",isExpected:!1,error:{code:Z,message:"disposed"}});var i=++G,r=t.timeoutDelayMs,o=void 0===r?this._resultTimeoutMs:r,a=t.acknowledgeTimeoutMs,s=void 0===a?this._ackTimeoutMs:a;return this._port.then((function(t){var r=n._async,a=new Promise((function(e){n._signals.set(i,{acknowledgeTimeout:r.setTimeout((function(){n._onResult(K(i,H))}),s),resultTimeout:r.setTimeout((function(){n._onResult(K(i,V))}),o),resolve:e})}));return t.postMessage({type:"command",id:i,data:e}),a}))},e.prototype.sendNotification=function(e){this._scope.isDisposed||this._port.then((function(t){t.postMessage({type:"notification",data:e})}))},e.prototype._onAcknowledge=function(e){var t=this._signals.get(e.id);t&&this._async.clearTimeout(t.acknowledgeTimeout)},e.prototype._onCommand=function(e,t){var n=t.id;e.postMessage({type:"acknowledge",id:n}),this._invokeCommandHandler(t.data).then((function(t){e.postMessage({type:"result",data:t,id:n})})).catch((function(e){}))},e.prototype._onNotification=function(e){this._invokeNotificationHandler(e.data)},e.prototype._onResult=function(e){var t=e.id,n=this._async,i=this._signals,r=i.get(t);r&&(n.clearTimeout(r.acknowledgeTimeout),n.clearTimeout(r.resultTimeout),r.resolve(e.data)),i.delete(t)},e}();function K(e,t){return{id:e,data:{result:"error",error:{code:t,message:"Timed out"},isExpected:!1}}}var z,X={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},J=new Uint8Array(16);function Y(){if(!z&&!(z="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return z(J)}for(var Q=[],q=0;q<256;++q)Q.push((q+256).toString(16).slice(1));function $(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(Q[e[t+0]]+Q[e[t+1]]+Q[e[t+2]]+Q[e[t+3]]+"-"+Q[e[t+4]]+Q[e[t+5]]+"-"+Q[e[t+6]]+Q[e[t+7]]+"-"+Q[e[t+8]]+Q[e[t+9]]+"-"+Q[e[t+10]]+Q[e[t+11]]+Q[e[t+12]]+Q[e[t+13]]+Q[e[t+14]]+Q[e[t+15]]).toLowerCase()}var ee,te=function(e,t,n){if(X.randomUUID&&!t&&!e)return X.randomUUID();var i=(e=e||{}).random||(e.rng||Y)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(var r=0;r<16;++r)t[n+r]=i[r];return t}return $(i)},ne=((ee={}).SHAREPOINT_TOKEN="SPO",ee);var ie=function(){this.playState=new C(void 0),this.isPlayerReady=new C(!1)},re=function(){function e(e,t,n,i){this._ttlMs=new C(void 0),this._ttirMs=new C(void 0),this._playerInteractiveTimestamp=new C(void 0),this._latestValuesFromIframe={playState:void 0},this._crossWindow=e,this._tokenRetriever=t,this._embedUrl=n,this._onError=i,this.playbackApi=new ie,this.playerStats={ttlMs:this._ttlMs,ttirMs:this._ttirMs,playerInteractiveTimestamp:this._playerInteractiveTimestamp},this.subscribeToApiEvents()}return e.prototype.warmData=function(){return this._crossWindow.sendCommand({command:"one-player-warm-data"}).then((function(){return Promise.resolve()})).catch((function(e){throw new T("warning",!1,"warmData","warmDataUnknown",e)}))},e.prototype.loadPlayer=function(){return this._crossWindow.sendCommand({command:"one-player-load-player"}).then((function(){return Promise.resolve()})).catch((function(e){throw new T("fatal",!1,"loadPlayer","loadPlayerUnknown",e)}))},e.prototype.onCommand=function(e){if("getToken"===e.command)return function(e,t,n){return(0,P.__awaiter)(this,void 0,void 0,(function(){var i,r,o,a,s;return(0,P.__generator)(this,(function(c){switch(c.label){case 0:if(!Object.prototype.hasOwnProperty.call(ne,e.tokenType))return[3,4];i=e.tokenType,c.label=1;case 1:return c.trys.push([1,3,,4]),[4,t.getTokenAsync(ne[i],n)];case 2:return[2,{result:"success",token:c.sent()}];case 3:return r=c.sent(),o="",a="","object"===typeof r&&null!==r&&(s=r,o=Object.prototype.hasOwnProperty.call(s,"code")&&"string"===typeof s.code?s.code:"",a=Object.prototype.hasOwnProperty.call(s,"message")&&"string"===typeof s.message?s.message:""),[2,{result:"error",isExpected:!1,error:{code:o,message:a}}];case 4:return[2,{result:"error",isExpected:!1,error:{code:"UnsupportedTokenType",message:"Unsupported token type"}}]}}))}))}(e,this._tokenRetriever,this._embedUrl)},e.prototype.onNotification=function(e){switch(e.notification){case"one-player-first-interactive":if(e.timestamp&&e.timestampTimeOrigin){var t=e.timestampTimeOrigin-performance.timeOrigin;this._playerInteractiveTimestamp.value=t+e.timestamp}break;case"one-player-player-ready":this.playbackApi.isPlayerReady.value=!0===e.isReady,void 0!==e.ttlMs&&(this._ttlMs.value=e.ttlMs);break;case"one-player-play-state":var n="Playing"===e.playState?"Playing":"Paused";this._latestValuesFromIframe.playState=n,this.playbackApi.playState.value=n,void 0!==e.ttirMs&&(this._ttirMs.value=e.ttirMs);break;case"one-player-fatal-playback-error":this._onError(e.onePlayerError||new T("fatal",!1,"playback","playbackUnknown",e.error,void 0,e.pbsid,e.hsi));break;case"one-player-fatal-create-session-error":this._onError(e.onePlayerError||new T("fatal",!1,"createSession","createSessionUnknown",e.error,void 0,e.pbsid,e.hsi))}},e.prototype.subscribeToApiEvents=function(){var e=this;this.playbackApi.playState.subscribe((function(t){t&&t!==e._latestValuesFromIframe.playState&&e._crossWindow.sendCommand({command:"Paused"===t?"one-player-pause":"one-player-play"}).catch((function(t){e._onError(new T("warning",!1,"playback","enginePlayback",t,"could not send play/pause command"))}))}))},e}(),oe=function(){function e(e,t,n,i){if(this._channelId=te(),this._onError=i,null===t.contentWindow)throw new Error("The iframe's contentWindow is null");var r=window.location.origin&&"null"!==window.location.origin?window.location.origin:"*";this._embedUrl=e+"#channelId="+this._channelId+"&origin="+r,this._host=function(e,t){void 0===t&&(t={});var n=e.channelId,i=e.onReinitialize,r=e.origin,o=e.receiver,a=void 0===o?window:o,s=e.source,c=e.identifyParent,u=t.eventGroupType,l=void 0===u?U:u,d=t.messengerType,p=void 0===d?B:d,h=new R,f=h.attach(new l(null));return new p({onCommand:e.onCommand,onNotification:e.onNotification,init:function(e,t){var o;if(c&&s){var u=setInterval((function(){var e={type:"identify-parent",channelId:n};s.postMessage(e,r)}),100);o=h.attach({dispose:function(){clearInterval(u)}})}var l=!1;f.on(a,"message",(function(t){var a=t.data;if(t.origin===r&&(!s||t.source===s)&&a&&"object"===typeof a&&"initialize"===a.type&&a.channelId===n){if(o&&o.dispose(),i){if(l)return i(),void f.dispose();l=!0}else f.dispose();var c=a.replyTo;c.postMessage({type:"activate"}),e(c)}}))},initResources:h,initTimeoutMs:e.initTimeoutMs,ackTimeoutMs:e.ackTimeoutMs,resultTimeoutMs:e.resultTimeoutMs})}({identifyParent:!0,source:t.contentWindow,channelId:this._channelId.toString(),origin:new URL(e).origin,initTimeoutMs:4e4,onCommand:this.onCommand.bind(this),onNotification:this.onNotification.bind(this)}),this.iFrameApi=new re(this._host,n,this._embedUrl,this._onError),this._onNotificationCallback=this.iFrameApi.onNotification.bind(this.iFrameApi),this._onCommandCallback=this.iFrameApi.onCommand.bind(this.iFrameApi)}return e.prototype.getDecoratedEmbedUrl=function(){return this._embedUrl},e.prototype.dispose=function(){this._host.dispose()},e.prototype.onCommand=function(e){return this._onCommandCallback(e)},e.prototype.onNotification=function(e){this._onNotificationCallback(e)},e}();function ae(e,t,n){return new Promise((function(i,r){e.onload=function(){i()},e.onerror=function(e){r(e)};var o=e.contentDocument;o.body||o.createElement("body");var a=o.createElement("form");a.action=t,a.method="POST",a.style.visibility="hidden",a.target="_self";var s=o.createElement("input");s.type="hidden",s.name="access_token",s.value=n,a.appendChild(s),o.body.appendChild(a),a.submit()}))}var se=function(){function e(e,t,n,i,r){var o=this;this._hasNavigatedToAboutBlank=!1,this._iframe=document.createElement("iframe"),this._iframe.style.flex="1",this._iframe.style.border="none",r&&(this._iframe.allowFullscreen=!0),this._iframe.allow="autoplay *";var a=this.onLoad.bind(this);this._iframe.addEventListener("load",a),this._embedUrl=e,this._containerDiv=t,this._tokenRetriever=n,this._onError=i,this._containerDiv.style.display="flex",this._containerDiv.appendChild(this._iframe),this._disposeActions=[function(){o._iframe&&(o._containerDiv.removeChild(o._iframe),o._iframe.removeEventListener("load",a),o._iframe=void 0)}]}return e.prototype.loadAndConnectToOnePlayer=function(){return(0,P.__awaiter)(this,void 0,void 0,(function(){var e,t,n,i=this;return(0,P.__generator)(this,(function(r){switch(r.label){case 0:if(void 0===this._iframe)throw new Error("Cannot load and connect to OnePlayer because the iframe has been disposed.");r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this._tokenRetriever.getTokenAsync("SPO",this._embedUrl)];case 2:return e=r.sent(),[3,4];case 3:throw t=r.sent(),new T("fatal",!1,"loadIframe","getTokenFailed",t);case 4:this._crossWindowChannel=new oe(this._embedUrl,this._iframe,this._tokenRetriever,this._onError),this._disposeActions.push((function(){var e;return null===(e=i._crossWindowChannel)||void 0===e?void 0:e.dispose()})),this._embedUrl=this._crossWindowChannel.getDecoratedEmbedUrl(),r.label=5;case 5:return r.trys.push([5,7,,8]),[4,ae(this._iframe,this._embedUrl,e)];case 6:return r.sent(),[3,8];case 7:throw n=r.sent(),new T("fatal",!1,"loadIframe","navToEmbed",n);case 8:return[2,this._crossWindowChannel.iFrameApi]}}))}))},e.prototype.dispose=function(){for(var e=0,t=this._disposeActions;e<t.length;e++){(0,t[e])()}this._disposeActions.length=0},e.prototype.onLoad=function(){var e,t;try{"about:blank"===(null===(t=null===(e=this._iframe)||void 0===e?void 0:e.contentWindow)||void 0===t?void 0:t.location.href)&&(this._hasNavigatedToAboutBlank&&this._onError(new T("fatal",!1,"loadIframe","iframeForciblyUnloaded",void 0,void 0)),this._hasNavigatedToAboutBlank=!0)}catch(n){}},e}(),ce=function(){function e(e){this._loaderOptionsBase=e}return e.prototype.createPlaybackSession=function(e,t){return(0,P.__awaiter)(this,void 0,void 0,(function(){var n,i,r,o;return(0,P.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,this.createPlaybackSessionInternal(e?"autoplayOn":"autoplayOff",t)];case 1:return n=a.sent(),i=n[0],r=n[1],[2,{playbackApi:i.playbackApi,dispose:r,playerStats:i.playerStats}];case 2:throw(o=a.sent())instanceof T?o:new T("fatal",!1,"loadIframe","iframeUnknown",o,void 0,t.hostSessionId);case 3:return[2]}}))}))},e.prototype.createDeferredPlaybackSession=function(e){return(0,P.__awaiter)(this,void 0,void 0,(function(){var t,n,i,r,o;return(0,P.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,this.createPlaybackSessionInternal("deferredLoad",e)];case 1:return t=a.sent(),n=t[0],i=t[1],r=new C(void 0),n.playbackApi.isPlayerReady.subscribe((function(e){e&&(r.value=n.playbackApi)})),[2,{playbackApi:r,loadPlayer:function(){return n.loadPlayer()},warmData:function(){return n.warmData()},dispose:i,playerStats:n.playerStats}];case 2:throw(o=a.sent())instanceof T?(o.hostSessionId=e.hostSessionId,o):new T("fatal",!1,"loadIframe","iframeUnknown",o,void 0,e.hostSessionId);case 3:return[2]}}))}))},e.prototype.createPlaybackSessionInternal=function(e,t){return(0,P.__awaiter)(this,void 0,void 0,(function(){var n,i,r,o,a;return(0,P.__generator)(this,(function(s){switch(s.label){case 0:return n={timeOrigin:performance.timeOrigin,timestamp:performance.now()},[4,this.getEmbedUrlAsync(t.videoId.videoUrl)];case 1:return i=s.sent(),i=this.adjustEmbedUrlQueryString(e,i,t,n),r=void 0,o=function(){try{null===r||void 0===r||r.dispose()}catch(e){throw e instanceof T?e:new T("fatal",!1,"dispose","disposeUnknown",e,void 0,t.hostSessionId)}},a=function(e){t.onError(o,e)},[4,(r=new se(i,t.containerDiv,this._loaderOptionsBase.tokenRetriever,a,t.allowFullscreen)).loadAndConnectToOnePlayer()];case 2:return[2,[s.sent(),o]]}}))}))},e}(),ue=function(e){function t(t){return e.call(this,t)||this}return(0,P.__extends)(t,e),t.prototype.adjustEmbedUrlQueryString=function(e,t,n,i){var r=new URL(t);r.searchParams.delete("access_token"),r.searchParams.set("auth","readwrite");var o=void 0,a=void 0;n.theme&&(o="light"===n.theme.name?1:0,a=n.theme.primaryColor);var s=JSON.stringify({af:"autoplayOn"===e?1:0,dl:"deferredLoad"===e?1:void 0,ha:n.hostApp,hp:n.hostPlatform,hv:n.hostView,hc:n.hostComponent,hm:n.hostMode,hsi:n.hostSessionId,t0:n.hostTimestamps.t0.timestamp,t0to:n.hostTimestamps.t0.timeOrigin,tcs:i.timestamp,tcsto:i.timeOrigin,ust:o,pc:a,ol:n.overrideLanguage,hvm:n.hideVideoMetadata,itf:n.enableVideoPlayerTabstopDuringPlayback?"rc":"ffe"});if(r.searchParams.set("embed",s),n.startTimeInSeconds){var c={playbackOptions:{startTimeInSeconds:n.startTimeInSeconds}};r.searchParams.set("nav",JSON.stringify(c))}return r.toString()},t.prototype.getEmbedUrlAsync=function(e){if(-1!==e.indexOf("embed.aspx"))return Promise.resolve(e);throw new T("fatal",!1,"loadIframe","unrecognizedVideoUrlFormat",void 0)},t}(ce);function le(e){var t="beginSilentSignOn";try{return e.tokenRetriever.beginSilentSignOn(),t="iframeUnknown",new ue(e)}catch(n){throw n instanceof T?n:new T("fatal",!1,"loadIframe",t,n)}}var de=n(77482),pe={MSIE:"MSIE",CHROME:"Chrome",FIREFOX:"Firefox",SAFARI:"Safari",EDGE:"Edge",EDGE_CHROMIUM:"Edge Chromium",ELECTRON:"Electron",SKYPE_SHELL:"SkypeShell",PHANTOMJS:"PhantomJS",OPERA:"Opera"},he="Windows",fe="Mac OS X",me="Windows Phone",ve="Windows RT",ye="iOS",be="Android",_e="Linux",we=/(windows|win32)/i,ge=/ arm;/i,ke=/windows\sphone\s\d+\.\d+/i,Ee=/(macintosh|mac os x)/i,Se=/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i,Te=/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,Pe=/android/i,Ie={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},Me="([\\d,.]+)",Ce="Unknown",Ae="undefined";function Oe(e,t){return t.indexOf(e)>-1}function Re(e,t){return t===pe.MSIE?function(e){var t=e.match(new RegExp(pe.MSIE+" "+Me));if(t)return t[1];var n=e.match(new RegExp("rv:"+Me));if(n)return n[1];return""}(e):function(e,t){e===pe.SAFARI&&(e="Version");var n=t.match(new RegExp(e+"/"+Me));if(n)return n[1];return}(t===pe.EDGE_CHROMIUM?"Edg":t,e)}var Ue=function(e){return e.match(ke)?me:e.match(ge)?ve:e.match(Se)?ye:e.match(Pe)?be:e.match(Te)?_e:e.match(Ee)?fe:e.match(we)?he:Ce},xe=function(e,t){return t===he?Ne(e,"Windows NT"):t===be?Ne(e,t):t===fe?De(e):Ce},Ne=function(e,t){var n=e.match(new RegExp(t+" "+Me));return n?Ie[n[1]]?Ie[n[1]]:n[1]:Ce},De=function(e){var t=e.match(new RegExp(fe+" ([\\d,_,.]+)"));if(t){var n=t[1].replace(/_/g,".");if(n){var i=function(e){return e.indexOf(".")>-1?".":e.indexOf("_")>-1?"_":null}(n);return i?n.split(i)[0]:n}}return Ce},Fe=void 0;function Le(){if(!Fe){var e=typeof navigator!==Ae?navigator.userAgent:"",t=function(e){return Oe("OPR/",e)?pe.OPERA:Oe(pe.PHANTOMJS,e)?pe.PHANTOMJS:Oe(pe.EDGE,e)?pe.EDGE:Oe("Edg",e)?pe.EDGE_CHROMIUM:Oe(pe.ELECTRON,e)?pe.ELECTRON:Oe(pe.CHROME,e)?pe.CHROME:Oe("Trident",e)?pe.MSIE:Oe(pe.FIREFOX,e)?pe.FIREFOX:Oe(pe.SAFARI,e)?pe.SAFARI:Oe(pe.SKYPE_SHELL,e)?pe.SKYPE_SHELL:void 0}(e),n=void 0!==t?Re(e,t):void 0,i=Ue(e),r=void 0!==i?xe(e,i):void 0;Fe={browserName:t,browserVersion:n,osName:i,osVersion:r}}return Fe}var He=function(){return"undefined"===typeof window};function Ve(){return function(e){if(He())switch(e){case"Android":return"Android";case"iOS":return"iOS";case"Linux":return"Linux";case"Mac OS X":return"Mac";case"Windows":return"Win32";default:return}return"Web"}(Le().osName)}var We=n(26934);function je(e){var t,n,i=null!==(t=Ve())&&void 0!==t?t:"Native",r=We.H3[e];return void 0===r?{hostApp:e,hostPlatform:i}:{hostApp:r.hostApp,hostPlatform:null!==(n=r.hostPlatform)&&void 0!==n?n:i}}function Ze(e){return function(t){"Playing"===t?e.raiseIsPlaying():"Paused"===t&&e.raiseIsPaused()}}function Ge(e,t){return Be.apply(this,arguments)}function Be(){return Be=(0,g.Z)((0,w.Z)().mark((function e(t,n){var i;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={beginSilentSignOn:function(){},getTokenAsync:function(){var e=(0,g.Z)((0,w.Z)().mark((function e(i,r){var o,s,c,u;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return[],e.prev=1,null===n||void 0===n||n.markSubActivityStart(m.u.OnePlayerTokenRetrieval),s=k.v.SharePoint,o=(0,E.B)((0,S.P)(r),s),e.next=7,t.TokenProvider.getToken(o);case 7:return c=e.sent,null===n||void 0===n||n.markSubActivityEnd(m.u.OnePlayerTokenRetrieval),e.abrupt("return",c.token);case 12:throw e.prev=12,e.t0=e.catch(1),null===n||void 0===n||n.markSubActivityEnd(m.u.OnePlayerTokenRetrieval,(u={},(0,p.Z)(u,a.KF.OnePlayerTokenRetrieval,"failed"),(0,p.Z)(u,"tokenType",i),u)),e.t0;case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t,n){return e.apply(this,arguments)}}()},e.abrupt("return",{tokenRetriever:i});case 2:case"end":return e.stop()}}),e)}))),Be.apply(this,arguments)}function Ke(){return Ke=(0,g.Z)((0,w.Z)().mark((function e(t,n,i,r,o,a,s){var c,u,l,d,p,h,f,y,b,_,g,k,E=arguments;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d=E.length>7&&void 0!==E[7]&&E[7],p=je(null!==(c=i.AppID)&&void 0!==c?c:""),h=p.hostApp,f=p.hostPlatform,y=!1,b=v(r),e.next=6,Ge(i,b);case 6:return _=e.sent,g={videoId:{videoUrl:n},containerDiv:t,allowFullscreen:!0,onError:a,hostApp:h,hostPlatform:f,hostComponent:de._,hostView:"",theme:o,hostSessionId:(null===(u=r.telemetryConfig)||void 0===u?void 0:u.hostSessionId)||"",hostMode:void 0,hostEnvironment:y?"Dev":"Prod",hostTimestamps:{t0:{timestamp:d?performance.now():null!==(l=null===b||void 0===b?void 0:b.startTime)&&void 0!==l?l:performance.now(),timeOrigin:performance.timeOrigin}},overrideLanguage:s,enableVideoPlayerTabstopDuringPlayback:!1},null===b||void 0===b||b.markSubActivityEnd(m.u.TimeInPlaybackLoopComponent),k=le(_),e.next=12,k.createPlaybackSession(!1,g);case 12:return e.abrupt("return",e.sent);case 13:case"end":return e.stop()}}),e)}))),Ke.apply(this,arguments)}var ze=function(e){var t,n=e.embeddableUrl,p=e.playbackStateSetter,h=e.parentRef,w=e.setViewRootElement,g=e.endRenderingActivity,k=e.onKeyDownHandler,E=e.strings,S=(0,u.w)(),T=(0,l.I)(),P=(0,d.j)(),I=i.useRef(null),M=i.useRef(null),C=i.useRef(null),A=i.useRef(null),O="dark"===(null===(t=(0,r.u)())||void 0===t?void 0:t.themeName)?"dark":"light",R=(0,o.bU)(),U=i.useMemo(f,[]),x=i.useCallback((function(e){var t=v(T);t&&e&&U.setIsReady(t,{playerInteractiveTimestamp:e})}),[T,U]),N=i.useCallback((function(e){!function(e){return y.includes(e.key)}(e)?function(e){return b.includes(e.key)}(e)||k(e):(e.preventDefault(),e.stopPropagation(),"Playing"===p.getPlaybackState()?p.pause():p.play())}),[p,k]),D=i.useCallback((function(){(0,_.X6)(h.current)}),[h]),F=i.useCallback((function(){(0,_.hN)(h.current)}),[h]);return i.useEffect((function(){var e=v(T),t=function(t,n){var r=n.level,o=n.isExpected,s=n.scenario,u=n.knownError;"iframeForciblyUnloaded"===u?(A.current=null,t(),null===e||void 0===e||e.markSubActivityStart(m.u.SetupIframeAfterIframeForciblyUnloaded),i(),null===e||void 0===e||e.markSubActivityEnd(m.u.SetupIframeAfterIframeForciblyUnloaded)):(g(c.G.Embedded),null===e||void 0===e||e.setResult(!1,{errorCode:a.KF.IframePlayerSetup,level:r,scenario:s,isExpected:o},u))};function i(){var r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];""!==n&&null!==I.current&&(I.current.isConnected?function(e,t,n,i,r,o,a){return Ke.apply(this,arguments)}(I.current,n,P,T,{name:O},t,R,r).then((function(e){g(c.G.Embedded),A.current=e,p.initialize(e.playbackApi),w(M.current),C.current={playStateUnsubscribe:e.playbackApi.playState.subscribe(Ze(p)),playerStatsPlayerInteractiveTimestampUnsubscribe:e.playerStats.playerInteractiveTimestamp.subscribe(x)}})).catch((function(t){g(c.G.Embedded),null===e||void 0===e||e.setResult(!1,{errorCode:a.KF.IframePlayerSetup},t),(0,s.S)(t,S,"setupIframePlayer",a.KF.IframePlayerSetup)})):function(e,t,n){null===n||void 0===n||n.markSubActivityStart(m.u.VideoHydratedInDetachedMode);var i=document.createElement("iframe");i.height="0px",i.width="0px",i.style.visibility="hidden";var r=function r(){e.removeChild(i),null===n||void 0===n||n.markSubActivityEnd(m.u.VideoHydratedInDetachedMode),t(!0),document.removeEventListener("load",r),document.removeEventListener("error",r)};i.addEventListener("load",r),i.addEventListener("error",r),e.appendChild(i)}(I.current,i,e))}return i(),function(){var e,t;C.current&&(t=C.current,Object.values(t).forEach((function(e){return e()}))),null===(e=A.current)||void 0===e||e.dispose()}}),[n,P,S,T,p,g,O,w,x,U,N,R]),i.createElement(i.Fragment,null,i.createElement("div",{ref:M,role:"link",tabIndex:0,onFocus:D,onBlur:F,onKeyDown:N,"aria-label":E.onePlayerIframeHostContainerAriaLabel}),i.createElement("div",{ref:I,className:_.ap,"aria-label":E.onePlayerIframeHostContainerAriaLabel}))}}}]);
//# sourceMappingURL=StreamEmbeddedRenderer.26c8f673.chunk.js.map