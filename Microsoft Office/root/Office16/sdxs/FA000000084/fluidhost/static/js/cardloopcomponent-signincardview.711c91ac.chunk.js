"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[7057],{3965:function(e,t,r){r.d(t,{h:function(){return o}});var n=r(4026),a=r(72791),i=r(37785),o=function(e){var t=e.content,r=e.className,o=e.datatid;return t?a.createElement(n.x,{className:r,"data-tid":o},a.createElement(i.V,{content:t})):null}},37785:function(e,t,r){r.d(t,{V:function(){return p}});var n=r(72791),a=r(15671),i=r(43144),o=r(1937),l=function(){function e(){(0,a.Z)(this,e),this.options={attributeCallbacks:u()}}return(0,i.Z)(e,[{key:"sanitizeHtml",value:function(e){return o.Z.sanitizeHtml(e,this.options)}}],[{key:"instance",value:function(){return this.sInstance||(this.sInstance=new e),this.sInstance}}]),e}();l.sInstance=null;var c=["width","height","style"],s={IMG:{width:"auto",height:"auto",style:""}},u=function(){var e={};return c.forEach((function(t){e[t]=d(t)})),e},d=function(e){return function(t,r){return r&&void 0!==s[r.tagName]&&void 0!==s[r.tagName][e]?s[r.tagName][e]:m(t)}},m=function(e){var t=null===e||void 0===e?void 0:e.split(";").map((function(e){return-1===e.indexOf("font-size")?e:null})).join(";");return t},p=n.memo((function(e){var t=e.content,r=l.instance().sanitizeHtml(t);return n.createElement("div",{dangerouslySetInnerHTML:{__html:r}})}));p.displayName="RichHtml"},13425:function(e,t,r){r.d(t,{p:function(){return i}});var n=r(3717),a=r(23711),i=(0,n.NF)((function(e){return(0,a.ZC)({cardStack:{marginLeft:"16px",marginBottom:"8px"},factName:{fontSize:"14px",fontWeight:600,color:e.palette.neutralPrimary},cardTitle:{fontSize:"18px",fontWeight:600,textAlign:"start",display:"block",whiteSpace:"pre-wrap",wordBreak:"break-word",textOverflow:"clip",textSizeAdjust:"100%",overflowWrap:"anywhere",color:e.palette.neutralPrimary},cardSubTitle:{fontSize:"14px",fontWeight:600,width:"fit-content",textAlign:"start",textSizeAdjust:"100%",wordBreak:"break-word",color:e.palette.neutralPrimary},cardText:{fontSize:"12px",width:"fit-content",textAlign:"start",wordBreak:"break-word",whiteSpace:"normal",color:e.palette.neutralPrimary},thumbnailImage:{flexShrink:"0 !important"},heroImage:{height:"100%",width:"100%",maxWidth:"fit-content"},cardButton:{overflow:"hidden",textOverflow:"ellipsis",textAlign:"center",verticalAlign:"middle",cursor:"default",fontFamily:"'Segoe UI', sans-serif",fontSize:"14px",fontWeight:600,padding:"4px 10px 5px 10px","-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",height:"31px",marginTop:"1px",border:"1px solid",backgroundColor:e.palette.white,color:e.palette.themePrimary,borderColor:e.palette.themePrimary,"&:hover":{border:"1px solid",backgroundColor:e.palette.white,color:e.palette.themePrimary,borderColor:e.palette.themePrimary},"&:active":{cursor:"pointer"}},buttonStack:{marginTop:"5px"}})}))},15045:function(e,t,r){r.r(t),r.d(t,{default:function(){return P}});var n=r(94577),a=r(72341),i=r(84398),o=r(62827),l=r(72791),c=r(74165),s=r(75971);function u(e,t,r,n,a,i,o){return(0,s.__awaiter)(this,void 0,void 0,(0,c.Z)().mark((function e(){var t;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=n.activityRequest,!o||!t){e.next=6;break}return t.authCode=o,t.retryAsync(),e.abrupt("return",[!1,void 0]);case 6:e.next=11;break;case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",[!0,void 0]);case 11:return e.abrupt("return",[!0,void 0]);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))}var d,m,p=r(29439),f=r(20112),h=r(80111),v=r(13425),g=r(3965),x=r(4927),b=r(81318),k=r(97708),w=r(90110);!function(e){e.title="signin-card-title"}(d||(d={})),function(e){e.initial="You need to sign in to see the card content.",e.retry="Sign in failed. Please retry sign in to see the card content."}(m||(m={}));var y=function(e){return e>0?m.retry:m.initial},S=function(e){var t=e.handleRetryWithToken,r=l.useState(!1),a=(0,p.Z)(r,2),o=a[0],u=a[1],m=(0,n.R)(),S=m.cardData,E=m.urlData,C=(0,i.o)(),N=C.metaOSProvider,P=C.cardChannelProvider,z=(0,f.R)().setCardData,I=(0,h.T)().theme,T=(0,v.p)(I),_=S.payload,Z=l.useState(0),A=(0,p.Z)(Z,2),D=A[0],R=A[1],U=l.useCallback((function(){return(0,s.__awaiter)(void 0,void 0,void 0,(0,c.Z)().mark((function e(){var r;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),r=function e(r){return(0,s.__awaiter)(void 0,void 0,void 0,(0,c.Z)().mark((function n(){var a,i,o,l,s,d,m;return(0,c.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,null===(a=N.openAuth)||void 0===a?void 0:a.call(N,S.appId,r);case 2:return i=n.sent,o=!0===(null===i||void 0===i?void 0:i.status)?i.message:void 0,n.next=6,t(E,S,S.appId,r,z,P,o);case 6:if(l=n.sent,s=(0,p.Z)(l,2),d=s[0],m=s[1],!d){n.next=17;break}if(!m){n.next=16;break}return n.next=14,e(m);case 14:n.next=17;break;case 16:R(D+1);case 17:u(!1);case 18:case"end":return n.stop()}}),n)})))},e.next=4,r(_);case 4:case"end":return e.stop()}}),e)})))}),[_,N,S,t,E,z,P,D]);return l.createElement(x.K,{tokens:{childrenGap:10},className:T.cardStack},l.createElement(x.K.Item,{align:"auto"},l.createElement(g.h,{className:T.cardTitle,content:y(D),datatid:d.title})),l.createElement(x.K.Item,{align:"baseline"},l.createElement(b.a,{className:T.cardButton,disabled:o,onClick:U,text:"Sign In"},o&&l.createElement(k.$,{size:w.E.small}))))},E=function(){return l.createElement(S,{handleRetryWithToken:u})};function C(e,t,r,n,a,i,o){return(0,s.__awaiter)(this,void 0,void 0,(0,c.Z)().mark((function l(){var s;return(0,c.Z)().wrap((function(l){for(;;)switch(l.prev=l.next){case 0:if(null===e||void 0===e?void 0:e.url){l.next=2;break}return l.abrupt("return",[!1,void 0]);case 2:if(l.prev=2,!o){l.next=11;break}return l.next=6,i.unfurl(e.url,r,o,n.type);case 6:return s=l.sent,a(Object.assign(Object.assign({},t),s)),l.abrupt("return",[!1,void 0]);case 11:if("silentAuth"!==n.type){l.next=25;break}if(n.requiresUserConsent){l.next=16;break}n.requiresUserConsent=!0,l.next=22;break;case 16:if(!n.authUrl){l.next=21;break}n.type="auth",n.requiresUserConsent=!0,l.next=22;break;case 21:case 25:return l.abrupt("return",[!0,void 0]);case 22:return l.abrupt("return",[!0,n]);case 26:l.next=31;break;case 28:return l.prev=28,l.t0=l.catch(2),l.abrupt("return",[!0,void 0]);case 31:case"end":return l.stop()}}),l,null,[[2,28]])})))}var N=function(){var e=(0,n.R)(),t=e.urlData,r=e.cardDataHandler,i=(0,a.v)().logger;return(null===t||void 0===t?void 0:t.url)?l.createElement(S,{handleRetryWithToken:C}):(i.logEvent("error","NoUrlFound"),null===r||void 0===r||r.rejector(),l.createElement(o.F,{message:"Unable to render the card"}))},P=function(){var e=(0,n.R)(),t=e.cardData,r=e.cardDataHandler,c=(0,a.v)(),s=c.logger,u=c.baseCardPerfMarker,d=(0,i.o)(),m=d.metaOSProvider,p=d.cardChannelProvider;if(l.useEffect((function(){u.end()}),[u]),!m||!p||!(null===t||void 0===t?void 0:t.appId)){return s.logEvent("error","NoMetaOSProvider"),null===r||void 0===r||r.rejector(),l.createElement(o.F,{message:"Unable to render the card"})}return"CardAction"===t.payload.authScenario?l.createElement(E,null):l.createElement(N,null)}},97708:function(e,t,r){r.d(t,{$:function(){return v}});var n=r(19482),a=r(75971),i=r(72791),o=r(90110),l=r(41693),c=r(73341),s=r(29577),u=(0,l.y)(),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.type,r=e.size,n=e.ariaLabel,l=e.ariaLive,d=e.styles,m=e.label,p=e.theme,f=e.className,h=e.labelPosition,v=n,g=(0,c.pq)(this.props,c.n7,["size"]),x=r;void 0===x&&void 0!==t&&(x=t===o.d.large?o.E.large:o.E.medium);var b=u(d,{theme:p,size:x,className:f,labelPosition:h});return i.createElement("div",(0,a.__assign)({},g,{className:b.root}),i.createElement("div",{className:b.circle}),m&&i.createElement("div",{className:b.label},m),v&&i.createElement("div",{role:"status","aria-live":l},i.createElement(s.U,null,i.createElement("div",{className:b.screenReaderText},v))))},t.defaultProps={size:o.E.medium,ariaLive:"polite",labelPosition:"bottom"},t}(i.Component),m=r(23711),p=r(3717),f={root:"ms-Spinner",circle:"ms-Spinner-circle",label:"ms-Spinner-label"},h=(0,p.NF)((function(){return(0,m.F4)({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}})})),v=(0,n.z)(d,(function(e){var t,r=e.theme,n=e.size,i=e.className,l=e.labelPosition,c=r.palette,s=(0,m.Cn)(f,r);return{root:[s.root,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},"top"===l&&{flexDirection:"column-reverse"},"right"===l&&{flexDirection:"row"},"left"===l&&{flexDirection:"row-reverse"},i],circle:[s.circle,{boxSizing:"border-box",borderRadius:"50%",border:"1.5px solid "+c.themeLight,borderTopColor:c.themePrimary,animationName:h(),animationDuration:"1.3s",animationIterationCount:"infinite",animationTimingFunction:"cubic-bezier(.53,.21,.29,.67)",selectors:(t={},t[m.qJ]=(0,a.__assign)({borderTopColor:"Highlight"},(0,m.xM)()),t)},n===o.E.xSmall&&["ms-Spinner--xSmall",{width:12,height:12}],n===o.E.small&&["ms-Spinner--small",{width:16,height:16}],n===o.E.medium&&["ms-Spinner--medium",{width:20,height:20}],n===o.E.large&&["ms-Spinner--large",{width:28,height:28}]],label:[s.label,r.fonts.small,{color:c.themePrimary,margin:"8px 0 0",textAlign:"center"},"top"===l&&{margin:"0 0 8px"},"right"===l&&{margin:"0 0 0 8px"},"left"===l&&{margin:"0 8px 0 0"}],screenReaderText:m.ul}}),void 0,{scope:"Spinner"})},90110:function(e,t,r){var n,a;r.d(t,{E:function(){return n},d:function(){return a}}),function(e){e[e.xSmall=0]="xSmall",e[e.small=1]="small",e[e.medium=2]="medium",e[e.large=3]="large"}(n||(n={})),function(e){e[e.normal=0]="normal",e[e.large=1]="large"}(a||(a={}))}}]);
//# sourceMappingURL=cardloopcomponent-signincardview.711c91ac.chunk.js.map