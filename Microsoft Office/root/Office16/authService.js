(()=>{"use strict";var e={6801:e=>{e.exports={i8:"2.2.0"}}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={exports:{}};return e[i](o,o.exports,n),o.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var e=function(){function e(){this.registrations=new Map}return e.prototype.addEventListener=function(e,t){this.registrations.set(e,t)},e.prototype.dispatchEvent=function(e,t){this.registrations.has(e)&&this.registrations.get(e)(t)},e.prototype.clearListeners=function(){this.registrations.clear()},e}(),t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},t(e,n)};function i(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}var r=function(){return r=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},r.apply(this,arguments)};function o(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{u(i.next(e))}catch(e){o(e)}}function s(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((i=i.apply(e,t||[])).next())}))}function a(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,i=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}function s(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var u,c=function(){function e(e){this.listeners={},this.element=e}return e.prototype.addListener=function(e,t){this.element&&(this.removeListener(e),this.element.addEventListener(e,t),this.listeners[e]=t)},e.prototype.removeListener=function(e){this.element&&this.listeners[e]&&(this.element.removeEventListener(e,this.listeners[e]),delete this.listeners[e])},e.prototype.removeAllListeners=function(){for(var e=0,t=Object.keys(this.listeners);e<t.length;e++){var n=t[e];this.removeListener(n)}},e}(),l=new Uint8Array(16);function d(){if(!u&&!(u="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return u(l)}const f=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var p=[],v=0;v<256;++v)p.push((v+256).toString(16).substr(1));const h=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(p[e[t+0]]+p[e[t+1]]+p[e[t+2]]+p[e[t+3]]+"-"+p[e[t+4]]+p[e[t+5]]+"-"+p[e[t+6]]+p[e[t+7]]+"-"+p[e[t+8]]+p[e[t+9]]+"-"+p[e[t+10]]+p[e[t+11]]+p[e[t+12]]+p[e[t+13]]+p[e[t+14]]+p[e[t+15]]).toLowerCase();if(!function(e){return"string"==typeof e&&f.test(e)}(n))throw TypeError("Stringified UUID is invalid");return n},g=function(e,t,n){var i=(e=e||{}).random||(e.rng||d)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(var r=0;r<16;++r)t[n+r]=i[r];return t}return h(i)};var m,y,S="Authorization code exceeds max length of 2048 characters",T="Authorization code contains unexpected characters. Allowed characters are a-z, A-Z, 0-9, ., _, +, /, =, ~, and -",C="{authId}",b="authId",I="result",w=(m={},{startAuth:function(e,t,n){var i=function(e){var t=new URL(e).searchParams.get(b);return t&&t!==C?t:g()}(e);return e=e.replace("{oauthRedirectMethod}","deeplink").replace(C,i).replace("{hostRedirectUrl}",n?function(e,t){var n=new URL(e);n.searchParams.delete(b),n.searchParams.delete(I);var i=decodeURIComponent(n.searchParams.toString()),r=""===i.trim();n.search="";var o="".concat(i).concat(r?"":"&");return encodeURIComponent("".concat(n.toString(),"?").concat(o).concat(b,"=").concat(t,"&").concat(I,"=").concat("{result}"))}(n,i):""),m[i]={handler:t,url:e,timeoutId:window.setTimeout((function(){t(!1,"OAuth session timeout"),delete m[i]}),12e4)},e},completeAuth:function(e,t){if("string"==typeof e&&"string"==typeof t){var n=m[e];if(n){window.clearTimeout(n.timeoutId);var i=RegExp("^[-a-zA-Z0-9._~+/=]+$");t.length>2048?n.handler(!1,S):i.test(t)?n.handler(!0,t):n.handler(!1,T),delete m[e]}}}});!function(e){e.Debug="Debug",e.Info="Info",e.Warn="Warn",e.Error="Error"}(y||(y={}));var A,k,E,P=n(6801).i8,x="appInitialization.appLoaded",D="appInitialization.expectedFailure",O="appInitialization.failure",_="appInitialization.success",F="authentication.getAuthToken",R="authentication.getUser",M="authentication.authenticate",U="authentication.authenticate.success",N="authentication.authenticate.failure",H="calendar.composeMeeting",L="calendar.openCalendarItem",z="conversations.openConversation",B="conversations.closeConversation",V="getChatMembers",W="tasks.startTask",K="tasks.completeTask",q={resize:"tasks.updateTask"},j="files.addCloudStorageFolder",G="files.copyMoveFiles",J="files.deleteCloudStorageFolder",Q="files.getCloudStorageFolders",X="openFilePreview",$="files.getExternalProviders",Z="files.getCloudStorageFolderContents",Y="getContext",ee="initialize",te="location.getLocation",ne={showLocation:"location.showLocation"},ie="interactive.getFluidTenantInfo",re="interactive.getFluidToken",oe="interactive.getFluidContainerId",ae="interactive.setFluidContainerId",se="interactive.getNtpTime",ue="interactive.registerClientId",ce="interactive.getClientRoles",le="interactive.getClientInfo",de="mail.composeMail",fe="mail.openMailItem",pe="captureImage",ve="getMedia",he="selectMedia",ge="viewImages",me="meeting.getAppContentStageSharingCapabilities",ye="meeting.getAppContentStageSharingState",Se="meeting.getAuthenticationTokenForAnonymousUser",Te="getIncomingClientAudioState",Ce="meeting.getLiveStreamState",be="meeting.getMeetingDetails",Ie={setOptions:"meeting.appShareButton.setOptions"},we="meeting.requestStartLiveStreaming",Ae="meeting.requestStopLiveStreaming",ke="meeting.shareAppContentToStage",Ee="meeting.stopSharingAppContentToStage",Pe="toggleIncomingClientAudio",xe="meeting.requestAppAudioHandling",De="meeting.updateMicState",Oe="meetingRoom.getPairedMeetingRoomInfo",_e="meetingRoom.sendCommandToPairedMeetingRoom",Fe="settings.getSettings",Re="navigateCrossDomain",Me="pages.navigateToApp",Ue="returnFocus",Ne="setFrameContext",He="shareDeepLink",Le={navigateBack:"navigateBack"},ze={navigateTo:"pages.currentApp.navigateTo",navigateToDefaultPage:"pages.currentApp.navigateToDefaultPage"},Be={getTabInstances:"getTabInstances",getMruTabInstances:"getMruTabInstances",navigateToTab:"navigateToTab"},Ve={setConfig:"settings.setSettings",setValidityState:"settings.setValidityState",save:{success:"settings.save.success",failure:"settings.save.failure"},remove:{success:"settings.remove.success",failure:"settings.remove.failure"}},We={enterFullscreen:"enterFullscreen",exitFullscreen:"exitFullscreen"},Ke={getPermissionStatus:"permissions.has"},qe="permissions.request",je="remoteCamera.getCapableParticipants",Ge="remoteCamera.requestControl",Je="remoteCamera.sendControlCommand",Qe="remoteCamera.terminateSession",Xe="search.unregister",$e="search.closeSearch",Ze="teams.getTeamChannels",Ye="teams.refreshSiteUrl",et={getConfigSetting:"getConfigSetting",joinedTeams:{getUserJoinedTeams:"getUserJoinedTeams"}};(E=A||(A={})).AuthFailed="AuthFailed",E.Timeout="Timeout",E.Other="Other",E.AppInitTimeout="AppInitTimeout",E.Validation="Validation",E.Validation_InvalidDomains="Validation_InvalidDomains",function(e){e.PermissionError="PermissionError",e.NotFound="NotFound",e.Throttling="Throttling",e.Offline="Offline",e.Other="Other"}(k||(k={}));var tt,nt,it,rt,ot,at,st,ut,ct,lt,dt,ft,pt,vt,ht,gt,mt,yt,St,Tt={resourceDomainParameter:"{resourceDomain}",validResourcePattern:"^((https|api)://{resourceDomain}([:/].*)?)$"},Ct=/^(\*\.)*[^*]+$/i,bt=["com.example.microsoftteamstabs.test","com.example.m365testapp.test"];(St=tt||(tt={})).Unknown="unknown",St.Loading="loading",St.WaitingForAppLoad="WaitingForAppLoad",St.Loaded="loaded",St.Failed="failed",St.Unloading="unloading",St.Unloaded="unloaded",St.Cached="cached",(yt=nt||(nt={}))[yt.NOT_SUPPORTED_ON_PLATFORM=100]="NOT_SUPPORTED_ON_PLATFORM",yt[yt.INTERNAL_ERROR=500]="INTERNAL_ERROR",yt[yt.NOT_SUPPORTED_IN_CURRENT_CONTEXT=501]="NOT_SUPPORTED_IN_CURRENT_CONTEXT",yt[yt.PERMISSION_DENIED=1e3]="PERMISSION_DENIED",yt[yt.NETWORK_ERROR=2e3]="NETWORK_ERROR",yt[yt.NO_HW_SUPPORT=3e3]="NO_HW_SUPPORT",yt[yt.INVALID_ARGUMENTS=4e3]="INVALID_ARGUMENTS",yt[yt.UNAUTHORIZED_USER_OPERATION=5e3]="UNAUTHORIZED_USER_OPERATION",yt[yt.INSUFFICIENT_RESOURCES=6e3]="INSUFFICIENT_RESOURCES",yt[yt.THROTTLE=7e3]="THROTTLE",yt[yt.USER_ABORT=8e3]="USER_ABORT",yt[yt.OPERATION_TIMED_OUT=8001]="OPERATION_TIMED_OUT",yt[yt.OLD_PLATFORM=9e3]="OLD_PLATFORM",yt[yt.FILE_NOT_FOUND=404]="FILE_NOT_FOUND",yt[yt.SIZE_EXCEEDED=1e4]="SIZE_EXCEEDED",function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff"}(it||(it={})),function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared"}(rt||(rt={})),function(e){e[e.Admin=0]="Admin",e[e.User=1]="User",e[e.Guest=2]="Guest"}(ot||(ot={})),(mt=at||(at={})).Inline="inline",mt.Desktop="desktop",mt.Web="web",function(e){e.M365Content="m365content"}(st||(st={})),function(e){e.DriveId="driveId",e.GroupId="groupId",e.SiteId="siteId",e.UserId="userId"}(ut||(ut={})),function(e){e.Public="public",e.EUDB="eudb",e.DOD="dod",e.DOJ="doj"}(ct||(ct={})),function(e){e.Public="public",e.EUDB="eudb",e.Other="other"}(lt||(lt={})),function(e){e.office="Office",e.orange="Orange",e.outlook="Outlook",e.outlookWin32="OutlookWin32",e.teams="Teams",e.teamsModern="TeamsModern"}(dt||(dt={})),function(e){e.windows="windows",e.macOs="macos"}(ft||(ft={})),function(e){e.default="default",e.dark="dark",e.highContrast="contrast"}(pt||(pt={})),function(e){e.fileOpenPreference="fileOpenPreference",e.theme="theme"}(vt||(vt={})),function(e){e.web="web",e.desktop="desktop"}(ht||(ht={})),function(e){e.settings="settings",e.content="content",e.authentication="authentication",e.remove="remove",e.task="task",e.sidePanel="sidePanel",e.meetingStage="meetingStage"}(gt||(gt={}));var It=function(){var e=this;this.items=new Map,this.add=function(t){if(t){var n=t.toLowerCase();if(!e.items.has(n))return e.items.set(n,t),!0}return!1},this.values=function(){return Array.from(e.items.values())}},wt={wildcardValidDomainRuleDetection:!0,extendedAppLoadTimeoutInMillis:void 0,authExtensionContextForUrlValidation:!0};function At(){return wt}var kt=function(e){return e&&new URL(e).host},Et=function(e,t,n,i){try{var r=new URL(Ot(e,i));return void 0!==n&&Mt(r,xt(n,i),t)}catch(e){return t.log(y.Error,"isValidUrlForApp","Invalid url",null),!1}},Pt=function(e){for(var t=[],n=0,i=e;n<i.length;n++){var r=i[n];r.match(Ct)||t.push(r)}return t},xt=function(e,t){var n,i,r=new It;return e.validDomains&&e.validDomains.forEach((function(e){return r.add(_t(e,t))})),null===(n=e.pages.configurable)||void 0===n||n.forEach((function(e){return r.add(kt(Ot(e.configurationUrl,t)))})),null===(i=e.pages.static)||void 0===i||i.forEach((function(e){e.contentUrl&&r.add(kt(Ot(e.contentUrl,t)))})),Array.from(r.values())},Dt=function(e,t,n,i,r){var o,a;if((n.name===dt.teams||n.name===dt.teamsModern)&&t&&t.length>0&&(!i||i.isFullTrust||(a=i.id)&&-1!==bt.indexOf(a.toLowerCase())))return Promise.resolve(t);if(null===(o=null==i?void 0:i.webApplicationInfo)||void 0===o?void 0:o.resource){var s=Ft(i,r);return s&&Rt(s,e)?Promise.resolve([s]):Promise.reject("App resource defined in manifest and iframe origin do not match")}return Promise.reject("App webApplicationInfo or resource not defined in manifest")},Ot=function(e,t){var n,i,r,o,a,s,u,c,l,d,f,p;if(!t)return e;var v={teamSiteDomain:(null===(n=t.sharePointSite)||void 0===n?void 0:n.teamSiteDomain)||"",teamSitePath:(null===(i=t.sharePointSite)||void 0===i?void 0:i.teamSitePath)||"",teamSiteUrl:(null===(r=t.sharePointSite)||void 0===r?void 0:r.teamSiteUrl)||"",mySiteDomain:(null===(o=t.sharePointSite)||void 0===o?void 0:o.mySiteDomain)||"",mySitePath:(null===(a=t.sharePointSite)||void 0===a?void 0:a.mySitePath)||"",channelRelativeUrl:(null===(s=t.channel)||void 0===s?void 0:s.relativeUrl)||"",sharePointSite:{teamSiteDomain:(null===(u=t.sharePointSite)||void 0===u?void 0:u.teamSiteDomain)||"",teamSitePath:(null===(c=t.sharePointSite)||void 0===c?void 0:c.teamSitePath)||"",teamSiteUrl:(null===(l=t.sharePointSite)||void 0===l?void 0:l.teamSiteUrl)||"",mySiteDomain:(null===(d=t.sharePointSite)||void 0===d?void 0:d.mySiteDomain)||"",mySitePath:(null===(f=t.sharePointSite)||void 0===f?void 0:f.mySitePath)||""},channel:{relativeUrl:(null===(p=t.channel)||void 0===p?void 0:p.relativeUrl)||""}};return Ht(e,v)},_t=function(e,t){var n,i,r,o;if(!t)return e;var a={teamSiteDomain:(null===(n=t.sharePointSite)||void 0===n?void 0:n.teamSiteDomain)||"",mySiteDomain:(null===(i=t.sharePointSite)||void 0===i?void 0:i.mySiteDomain)||"",sharePointSite:{teamSiteDomain:(null===(r=t.sharePointSite)||void 0===r?void 0:r.teamSiteDomain)||"",mySiteDomain:(null===(o=t.sharePointSite)||void 0===o?void 0:o.mySiteDomain)||""}};return Ht(e,a)},Ft=function(e,t){var n,i;return(null===(n=e.webApplicationInfo)||void 0===n?void 0:n.resource)&&Ot(null===(i=e.webApplicationInfo)||void 0===i?void 0:i.resource,t)},Rt=function(e,t){if(e&&t){if(e===t)return!0;var n=kt(t),i=Tt.validResourcePattern.replace(Tt.resourceDomainParameter,n);return new RegExp(i,"i").test(e)}return!1},Mt=function(e,t,n){var i=Nt(e),r=new It,o=s([],t,!0),a=Pt(s([],t,!0));a.length>0&&(n.log(y.Debug,"isUrlInDomainList","Invalid domain detected with ".concat(a,"}")),At().wildcardValidDomainRuleDetection&&(o=o.filter((function(e){return!a.includes(e)}))));for(var u=0,c=o;u<c.length;u++){var l=c[u];if(r.add(l)){var d=Ut(l),f=new RegExp("^https://".concat(d,"((/|\\?).*)?$"),"i");if(i.match(f))return!0}}return!1},Ut=function(e){if(!0===At().wildcardValidDomainRuleDetection&&Pt([e]).length>0)throw new Error("The wildcardValidDomainRuleDetection flag is enabled and an improper wildcard domain segment was detected: "+e);for(var t=e.split("."),n="",i=0;i<t.length;i++){var r=t[i],o=r.indexOf("*");n+=i>0?"[.]":"",n+=o>-1?r.slice(0,o)+"[^/^.]+"+r.slice(o+1):r}return n},Nt=function(e){return e.href},Ht=function(e,t,n){void 0===n&&(n=[]);var i=e.indexOf("?"),r="",o="";return i>0?(r=e.substring(0,i),o=e.substring(i)):r=e,r&&(r=Lt(r,t,n,(function(e){return encodeURI(e)}))),o&&(o=Lt(o,t,n,(function(e){return encodeURIComponent(e)}))),r+o},Lt=function(e,t,n,i){if(void 0===n&&(n=[]),void 0!==t)if("object"==typeof t)for(var r in t)e=Lt(e,t[r],n.concat(r),i);else{var o=n.join("."),a=new RegExp("{".concat(o.replace(".","\\."),"}"),"g");e=e.replace(a,i(t))}return e};function zt(e){var t,n;return{actionInfo:e.actionInfo,locale:e.app.locale,appSessionId:e.app.sessionId||"",appLaunchId:e.app.launchId||"",theme:e.app.theme,appIconPosition:e.app.iconPositionVertical||0,osLocaleInfo:e.app.osLocaleInfo,parentMessageId:e.app.parentMessageId||"",userClickTime:e.app.userClickTime||0,userFileOpenPreference:e.app.userFileOpenPreference||at.Inline,hostName:e.app.host.name,hostClientType:e.app.host.clientType,sessionId:e.app.host.sessionId||"",ringId:e.app.host.ringId,entityId:e.page.id||"",frameContext:e.page.frameContext,subEntityId:e.page.subPageId||"",isFullScreen:e.page.isFullScreen||!1,isMultiWindow:e.page.isMultiWindow||!1,sourceOrigin:e.page.sourceOrigin||"",userObjectId:void 0!==e.user?e.user.id:void 0,isCallingAllowed:void 0!==e.user?e.user.isCallingAllowed:void 0,isPSTNCallingAllowed:void 0!==e.user?e.user.isPSTNCallingAllowed:void 0,userLicenseType:void 0!==e.user?e.user.licenseType:"",loginHint:void 0!==e.user?e.user.loginHint:void 0,userPrincipalName:void 0!==e.user?e.user.userPrincipalName:void 0,upn:void 0!==e.user?e.user.userPrincipalName:void 0,userDisplayName:void 0!==e.user?e.user.displayName:void 0,tid:void 0!==e.user&&void 0!==e.user.tenant?e.user.tenant.id:void 0,tenantSKU:(null===(n=null===(t=null==e?void 0:e.user)||void 0===t?void 0:t.tenant)||void 0===n?void 0:n.sku)||"",channelId:void 0!==e.channel?e.channel.id:void 0,channelName:void 0!==e.channel?e.channel.displayName:void 0,channelRelativeUrl:void 0!==e.channel?e.channel.relativeUrl:void 0,channelType:void 0!==e.channel?e.channel.membershipType:void 0,defaultOneNoteSectionId:void 0!==e.channel?e.channel.defaultOneNoteSectionId:void 0,hostTeamGroupId:void 0!==e.channel?e.channel.ownerGroupId:void 0,hostTeamTenantId:void 0!==e.channel?e.channel.ownerTenantId:void 0,chatId:void 0!==e.chat?e.chat.id:"",meetingId:void 0!==e.meeting?e.meeting.id:"",sharepoint:e.sharepoint,teamId:void 0!==e.team?e.team.internalId:void 0,teamName:void 0!==e.team?e.team.displayName:void 0,teamType:void 0!==e.team?e.team.type:void 0,groupId:void 0!==e.team?e.team.groupId:void 0,teamTemplateId:void 0!==e.team?e.team.templateId:void 0,isTeamArchived:void 0!==e.team?e.team.isArchived:void 0,userTeamRole:void 0!==e.team?e.team.userRole:void 0,teamSiteId:void 0!==e.sharePointSite?e.sharePointSite.teamSiteId:void 0,teamSiteUrl:void 0!==e.sharePointSite?e.sharePointSite.teamSiteUrl:void 0,teamSiteDomain:void 0!==e.sharePointSite?e.sharePointSite.teamSiteDomain:void 0,teamSitePath:void 0!==e.sharePointSite?e.sharePointSite.teamSitePath:void 0,mySiteDomain:void 0!==e.sharePointSite?e.sharePointSite.mySiteDomain:void 0,mySitePath:void 0!==e.sharePointSite?e.sharePointSite.mySitePath:void 0}}var Bt,Vt=new RegExp("[a-zA-Z0-9_\\-\\.]+(@|%40|%2540)[a-zA-Z0-9_\\-\\.]+\\.[a-zA-Z]{2,5}","g"),Wt=function(e){return!!e&&void 0!==e.user.id};var Kt,qt=((Bt={})["appInstallDialog.openAppInstallDialog"]="api.appInstallDialog.openAppInstallDialog",Bt[F]="api.getAuthToken",Bt[R]="api.getUser",Bt[M]="api.authentication.authenticate",Bt[N]="api.authentication.notifyFailure",Bt[U]="api.authentication.notifySuccess",Bt["appEntity.selectAppEntity"]="api.appEntity.selectAppEntity",Bt["media.scanBarCode"]="api.barCode.scanBarCode",Bt[H]="api.calendar.composeMeeting",Bt[L]="api.calendar.openCalendarItem",Bt["call.startCall"]="api.call.startCall",Bt["chat.openChat"]="api.chat.openChat",Bt[z]="api.conversations.openConversation",Bt[B]="api.conversations.closeConversation",Bt[V]="api.conversations.getChatMembers",Bt[W]="api.dialogs.open",Bt[K]="api.dialogs.submit",Bt[q.resize]="api.dialogs.update.resize",Bt[X]="api.files.openFilePreview",Bt[Q]="api.files.getCloudStorageFolders",Bt[j]="api.files.addCloudStorageFolder",Bt[J]="api.files.deleteCloudStorageFolder",Bt[G]="api.files.copyMoveFiles",Bt[$]="api.files.getExternalProviders",Bt[Z]="api.files.getCloudStorageFolderContents",Bt[Y]="api.getContext",Bt[ie]="api.interactive.getFluidTenantInfo",Bt[re]="api.interactive.getFluidToken",Bt[oe]="api.interactive.getFluidContainerId",Bt[ae]="api.interactive.setFluidContainerId",Bt[se]="api.interactive.getNtpTime",Bt[ue]="api.interactive.registerClientId",Bt[ce]="api.interactive.getClientRoles",Bt[le]="api.interactive.getClientInfo",Bt.executeDeepLink="api.links.openLink",Bt[te]="api.location.getCurrentLocation",Bt[ne.showLocation]="api.location.map.showLocation",Bt[fe]="api.mail.openMailItem",Bt[de]="api.mail.composeMail",Bt[pe]="api.media.captureImage",Bt[ve]="api.media.getMedia",Bt[he]="api.media.selectMedia",Bt[ge]="api.media.viewImages",Bt[me]="api.meeting.getAppContentStageSharingCapabilities",Bt[ye]="api.meeting.getAppContentStageSharingState",Bt[Se]="api.meeting.getAuthenticationTokenForAnonymousUser",Bt[Te]="api.meeting.getIncomingClientAudioState",Bt[Ce]="api.meeting.getLiveStreamState",Bt[be]="api.meeting.getMeetingDetails",Bt[we]="api.meeting.requestStartLiveStreaming",Bt[Ae]="api.meeting.requestStopLiveStreaming",Bt[ke]="api.meeting.shareAppContentToStage",Bt[Ee]="api.meeting.stopSharingAppContentToStage",Bt[Ie.setOptions]="api.meeting.appShareButton.setOptions",Bt[Pe]="api.meeting.toggleIncomingClientAudio",Bt[xe]="api.meeting.requestAppAudioHandling",Bt[De]="api.meeting.updateMicState",Bt["monetization.openPurchaseExperience"]="api.monetization.openPurchaseExperience",Bt[Oe]="api.meetingRoom.getPairedMeetingRoomInfo",Bt[_e]="api.meetingRoom.sendCommandToPairedMeetingRoom",Bt["notifications.showNotification"]="api.notifications.showNotification",Bt[Ve.setConfig]="api.pages.config.setConfig",Bt[Ve.remove.failure]="api.pages.config.remove.failure",Bt[Ve.remove.success]="api.pages.config.remove.success",Bt[Ve.save.failure]="api.pages.config.save.failure",Bt[Ve.save.success]="api.pages.config.save.success",Bt[Ve.setValidityState]="api.pages.config.setValidityState",Bt[ze.navigateTo]="api.pages.currentApp.navigateTo",Bt[ze.navigateToDefaultPage]="api.pages.currentApp.navigateToDefaultPage",Bt[Le.navigateBack]="api.pages.backStack.navigateBack",Bt[We.enterFullscreen]="api.pages.fullTrust.enterFullscreen",Bt[We.exitFullscreen]="api.pages.fullTrust.exitFullscreen",Bt[Fe]="api.pages.getConfig",Bt[Re]="api.pages.navigateCrossDomain",Bt[Me]="api.pages.navigateToApp",Bt[Ue]="api.pages.returnFocus",Bt[He]="api.pages.shareDeepLink",Bt[Ne]="api.pages.setCurrentFrame",Bt[Be.getMruTabInstances]="api.pages.tabs.getMruTabInstances",Bt[Be.getTabInstances]="api.pages.tabs.getTabInstances",Bt[Be.navigateToTab]="api.pages.tabs.navigateToTab",Bt["people.selectPeople"]="api.people.selectPeople",Bt[Ke.getPermissionStatus]="api.permissions.storageService.getPermissionStatus",Bt[qe]="api.permissions.requestUserConsentForPermission",Bt["profile.showProfile"]="api.profile.showProfile",Bt[je]="api.remoteCamera.getCapableParticipants",Bt[Ge]="api.remoteCamera.requestControl",Bt[Je]="api.remoteCamera.sendControlCommand",Bt[Qe]="api.remoteCamera.terminateSession",Bt.registerHandler="api.registerHandler",Bt[Xe]="api.search.unregister",Bt[$e]="api.search.closeSearch",Bt["stageView.open"]="api.stageView.open",Bt[Ze]="api.teams.getTeamChannels",Bt[Ye]="api.teams.refreshSiteUrl",Bt[et.joinedTeams.getUserJoinedTeams]="api.teams.fullTrust.joinedTeams.getUserJoinedTeams",Bt[et.getConfigSetting]="api.teams.fullTrust.getConfigSetting",Bt),jt=(nt.INTERNAL_ERROR,function(e,t){return{errorCode:e,message:t}}),Gt=function(e){return o(void 0,void 0,void 0,(function(){return a(this,(function(t){return null!=e?[2,{kind:"appResponse",data:e}]:[2,{kind:"appResponse"}]}))}))},Jt={kind:"logResponse"},Qt=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return o(void 0,void 0,void 0,(function(){return a(this,(function(n){switch(n.label){case 0:return[4,e.apply(void 0,t)];case 1:return n.sent(),[2,Jt]}}))}))},Xt="App does not have the required permissions for this operation",$t=function(){function e(e,t){this.appSdkHost=e,this.telemetryService=t,this.handlers={},this.appDefinition=this.appSdkHost.getAppDefinition()}return e.prototype.registerHandler=function(e,t,n){var i;this.handlers[e]={callback:t,scenarioName:null!==(i=null==n?void 0:n.scenarioName)&&void 0!==i?i:qt[e],errorCallback:null==n?void 0:n.errorCallback,isRestrictedToFullTrustApps:null==n?void 0:n.isRestrictedToFullTrustApps,isRestrictedToFullTrustOrLobApps:null==n?void 0:n.isRestrictedToFullTrustOrLobApps}},e.prototype.deleteMessageHandling=function(e){delete this.handlers[e]},e.prototype.canHandleMessage=function(e){return this.validateInitialization(e)&&void 0!==this.handlers[e]},e.prototype.handleMessage=function(e,t,n){var i,r,s,u;return o(this,void 0,void 0,(function(){var o,c,l,d;return a(this,(function(a){switch(a.label){case 0:if(!this.validateInitialization(e))return[2,Promise.reject("SDK context is not initialized")];if(!this.canHandleMessage(e))return[2,Promise.reject("Handler cannot handle message: ".concat(e))];(o=this.handlers[e]).scenarioName&&this.telemetryService&&(c=this.telemetryService.createScenario(o.scenarioName,null===(i=this.appDefinition)||void 0===i?void 0:i.id,n),n&&c.markPhase("MessageDelay")),a.label=1;case 1:if(a.trys.push([1,3,,4]),o.isRestrictedToFullTrustApps&&!(null===(r=this.appSdkHost.getAppDefinition())||void 0===r?void 0:r.isFullTrust))throw jt(nt.INTERNAL_ERROR,Xt);if(o.isRestrictedToFullTrustOrLobApps&&!(null===(s=this.appSdkHost.getAppDefinition())||void 0===s?void 0:s.isFullTrust)&&!(null===(u=this.appSdkHost.getAppDefinition())||void 0===u?void 0:u.isLOB))throw jt(nt.INTERNAL_ERROR,Xt);if(!this.appSdkHost.checkIfCachedAndRequestAllowed(e))throw"Request not allowed when cached";return this.validateDependencies(e),[4,o.callback.apply(this,t)];case 2:return l=a.sent(),null==c||c.stop(),[2,l];case 3:return d=a.sent(),this.appSdkHost.getLogger().log(y.Error,"handleMessage","Error in handling message",d),o.errorCallback?[2,o.errorCallback(d,c)]:(null==c||c.fail(d),[2,Promise.reject(d)]);case 4:return[2]}}))}))},e.prototype.validateInitialization=function(e){return e===ee||this.appSdkHost.isInitialized()},e.prototype.validateDependencies=function(e){},e.prototype.cleanup=function(){},e}(),Zt=[{versionToDowngradeFrom:2,downgradeToPreviousVersion:function(e){var t,n,i,o,a;return{apiVersion:1,supports:r(r({},e.supports),{dialog:e.supports.dialog?{bot:null===(i=null===(n=null===(t=e.supports)||void 0===t?void 0:t.dialog)||void 0===n?void 0:n.url)||void 0===i?void 0:i.bot,card:null===(o=e.supports.dialog)||void 0===o?void 0:o.card,update:null===(a=e.supports.dialog)||void 0===a?void 0:a.update}:void 0})}}}],Yt=function(e){function t(t,n,i,r){var o,a,s,u,c,l=this;return(l=e.call(this,t,i)||this).appSdkHost=t,l.hubServices=n,l.telemetryService=i,l.hostVersionsInfo=r,l.initializationStatusReported=!1,l.setupAppLoadTimer=function(){var e,t=null!==(e=At().extendedAppLoadTimeoutInMillis)&&void 0!==e?e:3e4;return l.registerAppInitMessageHandlers?window.setTimeout((function(){l.appSdkHost.setAppInitInfo({state:tt.Failed,reason:A.AppInitTimeout}),l.failAppInitializationScenario("App Load timed out")}),t):window.setTimeout((function(){l.failAppInitializationScenario("SDK initialization timed out")}),15e3)},l.stopAppInitializationScenario=function(){var e;l.clearTimeoutTimer(),null===(e=l.appInitializationScenario)||void 0===e||e.stop()},l.failAppInitializationScenario=function(e){var t;l.clearTimeoutTimer(),null===(t=l.appInitializationScenario)||void 0===t||t.fail(e)},l.clearTimeoutTimer=function(){window.clearTimeout(l.appLoadTimerId)},l.appSdkHost.startAppInitializationScenario(),l.appInitializationScenario=null===(o=l.appSdkHost)||void 0===o?void 0:o.getAppInitializationScenario(),null===(a=l.appInitializationScenario)||void 0===a||a.markPhase("ClickToBeginLoad"),l.registerAppInitMessageHandlers=(null===(s=t.getAppDefinition())||void 0===s?void 0:s.showLoadingIndicator)||!1,(null==i?void 0:i.enableExtendedInitializationTracking)&&(l.extendedAppInitializationScenario=null===(u=l.telemetryService)||void 0===u?void 0:u.createScenario("appInitializationExtended"),null===(c=l.extendedAppInitializationScenario)||void 0===c||c.markPhase("ClickToBeginLoad")),l.appLoadTimerId=l.setupAppLoadTimer(),l}return i(t,e),t.prototype.initHandlers=function(){this.registerHandler(ee,this.initialize),this.registerHandler(Y,this.getContext,{errorCallback:this.onGetContextError}),this.registerHandler("readyToUnload",this.readyToUnload),this.registerHandler(x,this.handleAppLoaded),this.registerHandler(_,this.handleSuccess),this.registerHandler(O,this.handleFailure),this.registerHandler(D,this.handleExpectedFailure)},t.prototype.initialize=function(e,t,n){var i,r,o,a,s,u,c,l,d,f,p;n||(n=1),null===(i=this.appInitializationScenario)||void 0===i||i.markPhase("BeginLoadToInitialized"),null===(r=this.extendedAppInitializationScenario)||void 0===r||r.markPhase("BeginLoadToInitialized"),null===(o=this.telemetryService)||void 0===o||o.setAppSdkVersion(t),this.registerAppInitMessageHandlers||(this.appSdkHost.setAppInitInfo({state:tt.Loaded}),this.stopAppInitializationScenario()),this.appSdkHost.setInitialized(!0);var v,h,g={apiVersion:2,hostVersionsInfo:this.hostVersionsInfo,supports:{app:{},appInstallDialog:this.hubServices.appInstallDialogService?{}:void 0,appEntity:this.hubServices.appEntityService?{}:void 0,barCode:this.hubServices.barCodeService?{}:void 0,calendar:this.hubServices.calendarService?{}:void 0,call:this.hubServices.callService?{}:void 0,chat:this.hubServices.chatService?{}:void 0,conversations:this.hubServices.conversationsService?{}:void 0,dialog:this.hubServices.dialogService?{url:this.hubServices.dialogService.urlService?{bot:this.hubServices.dialogService.urlService.urlBotService?{}:void 0}:void 0,card:this.hubServices.dialogService.cardService&&this.hostVersionsInfo&&this.hostVersionsInfo.adaptiveCardSchemaVersion&&(v=this.hostVersionsInfo.adaptiveCardSchemaVersion,!(v.majorVersion<1||1==v.majorVersion&&v.minorVersion<5))?{bot:this.hubServices.dialogService.cardService.cardBotService?{}:void 0}:void 0,update:this.hubServices.dialogService.updateService?{}:void 0}:void 0,files:this.hubServices.filesService?{}:void 0,interactive:this.hubServices.interactiveService?{}:void 0,mail:this.hubServices.mailService?{}:void 0,media:this.hubServices.mediaService?{}:void 0,meeting:this.hubServices.meetingService?{appShareButton:this.hubServices.meetingService.appShareButton?{}:void 0}:void 0,meetingRoom:this.hubServices.meetingRoomService?{}:void 0,notifications:this.hubServices.notificationService?{}:void 0,location:this.hubServices.locationService&&this.hubServices.locationService.mapService?{}:void 0,geoLocation:this.hubServices.locationService?{map:this.hubServices.locationService.mapService?{}:void 0}:void 0,logs:this.hubServices.logService?{}:void 0,pages:{appButton:(null===(a=this.hubServices.pageService)||void 0===a?void 0:a.appButtonService)?{}:void 0,tabs:(null===(s=this.hubServices.pageService)||void 0===s?void 0:s.tabsService)?{}:void 0,config:(null===(u=this.hubServices.pageService)||void 0===u?void 0:u.configService)?{}:void 0,backStack:(null===(c=this.hubServices.pageService)||void 0===c?void 0:c.backStackService)?{}:void 0,fullTrust:(null===(l=this.hubServices.pageService)||void 0===l?void 0:l.fullTrustService)?{}:void 0,currentApp:{}},people:this.hubServices.peopleService?{}:void 0,permissions:this.hubServices.devicePermissionService?{}:void 0,profile:this.hubServices.profileService?{}:void 0,remoteCamera:this.hubServices.remoteCameraService?{}:void 0,monetization:this.hubServices.monetizationService?{}:void 0,search:this.hubServices.searchService?{}:void 0,sharing:this.hubServices.sharingService?{}:void 0,stageView:this.hubServices.stageViewService?{}:void 0,teams:this.hubServices.teamsService?{fullTrust:(null===(d=this.hubServices.teamsService)||void 0===d?void 0:d.fullTrustService)?{joinedTeams:(null===(p=null===(f=this.hubServices.teamsService)||void 0===f?void 0:f.fullTrustService)||void 0===p?void 0:p.joinedTeamsService)?{}:void 0}:void 0}:void 0,teamsCore:this.hubServices.cacheManagementService?{}:void 0,video:this.hubServices.videoExtensibilityService&&(this.hubServices.videoExtensibilityService.mediaStreamService||this.hubServices.videoExtensibilityService.sharedFrameService)?{mediaStream:this.hubServices.videoExtensibilityService.mediaStreamService?{}:void 0,sharedFrame:this.hubServices.videoExtensibilityService.sharedFrameService?{}:void 0}:void 0}};h=n<g.apiVersion?function(e,t,n){if(void 0===n&&(n=Zt),e.apiVersion<=t)return e;for(var i=e,r=0,o=n;r<o.length;r++){var a=o[r];if(i.apiVersion===a.versionToDowngradeFrom&&(i=a.downgradeToPreviousVersion(i)),i.apiVersion<=t)break}return i}(g,n):g;var m=[this.appSdkHost.getFrameContext(),this.appSdkHost.getHubInfo().clientType,"2.0.0",JSON.stringify(h)];return Gt(m)},t.prototype.getContext=function(){return o(this,void 0,void 0,(function(){var e,t;return a(this,(function(n){switch(n.label){case 0:return t=zt,[4,this.appSdkHost.getAppContext()];case 1:return e=t.apply(void 0,[n.sent()]),[2,Gt(e)]}}))}))},t.prototype.onGetContextError=function(e,t){return null==t||t.fail(e),Gt({})},t.prototype.handleAppLoaded=function(){var e,t;return o(this,void 0,void 0,(function(){return a(this,(function(n){return null===(e=this.appInitializationScenario)||void 0===e||e.markPhase("InitializedToAppLoadedInvoked"),null===(t=this.extendedAppInitializationScenario)||void 0===t||t.markPhase("InitializedToAppLoadedInvoked"),this.appSdkHost.setAppInitInfo({state:tt.Loaded}),[2,Jt]}))}))},t.prototype.handleSuccess=function(){var e;return o(this,void 0,void 0,(function(){return a(this,(function(t){return this.markInitializationStatusAsReported()?(this.appSdkHost.setAppInitInfo({state:tt.Loaded}),this.registerAppInitMessageHandlers&&this.stopAppInitializationScenario(),null===(e=this.extendedAppInitializationScenario)||void 0===e||e.stop(),[2,Jt]):[2,Jt]}))}))},t.prototype.handleFailure=function(e,t){var n;return o(this,void 0,void 0,(function(){return a(this,(function(e){return this.markInitializationStatusAsReported()?(this.appSdkHost.setAppInitInfo({state:tt.Failed,reason:t}),this.registerAppInitMessageHandlers&&this.failAppInitializationScenario(t),null===(n=this.extendedAppInitializationScenario)||void 0===n||n.fail(t),[2,Jt]):[2,Jt]}))}))},t.prototype.handleExpectedFailure=function(e,t){var n;return o(this,void 0,void 0,(function(){return a(this,(function(e){return this.markInitializationStatusAsReported()?(this.appSdkHost.setAppInitInfo({state:tt.Loaded}),this.registerAppInitMessageHandlers&&this.failAppInitializationScenario("Expected."+t),null===(n=this.extendedAppInitializationScenario)||void 0===n||n.fail("Expected."+t),[2,Jt]):[2,Jt]}))}))},t.prototype.markInitializationStatusAsReported=function(){return!this.initializationStatusReported&&(this.initializationStatusReported=!0,!0)},t.prototype.readyToUnload=function(){return o(this,void 0,void 0,(function(){return a(this,(function(e){return this.appSdkHost.setAppInitInfo({state:tt.Unloaded}),[2,Jt]}))}))},t.prototype.cleanup=function(){this.clearTimeoutTimer()},t}($t),en=function(e){function t(t,n,i){var r=e.call(this,t,i)||this;return r.appSdkHost=t,r.authenticationService=n,r.telemetryService=i,r}return i(t,e),t.prototype.initHandlers=function(){this.registerHandler(R,this.handleGetUser,{errorCallback:this.onGetUserError,isRestrictedToFullTrustApps:!0}),this.registerHandler(F,this.handleGetAuthToken,{errorCallback:this.onGetAuthTokenError})},t.prototype.validateDependencies=function(){if(!this.authenticationService)throw"No authentication service is available"},t.prototype.handleGetUser=function(){return o(this,void 0,void 0,(function(){var e,t,n;return a(this,(function(i){switch(i.label){case 0:return[4,this.authenticationService.getUser()];case 1:return(e=i.sent())?[4,this.appSdkHost.getAppContext()]:[3,3];case 2:return t=i.sent(),n=r(r({},e.profile),{dataResidency:(o=t.user.dataResidency,o===ct.Public?lt.Public:o===ct.EUDB?lt.EUDB:lt.Other)}),[2,Gt([!0,n])];case 3:return[2,Promise.reject("Failed to fetch the user profile")]}var o}))}))},t.prototype.onGetUserError=function(e,t){return null==t||t.fail("GetUser failed ".concat(e)),Gt([!1,e])},t.prototype.handleGetAuthToken=function(e,t,n,i){return o(this,void 0,void 0,(function(){var r,o,s;return a(this,(function(a){switch(a.label){case 0:return[4,this.appSdkHost.getAppContext()];case 1:return r=a.sent(),[4,Dt(e.origin,t,this.appSdkHost.getHubInfo(),this.appDefinition,r)];case 2:return o=a.sent(),[4,this.authenticationService.acquireToken(o[0],n,i)];case 3:return s=a.sent(),[2,Gt([!0,s.token])]}}))}))},t.prototype.onGetAuthTokenError=function(e,t){return null==t||t.fail("GetAuthToken failed ".concat(e)),Gt([!1,e])},t}($t),tn=function(e){function t(t,n,i){var r=e.call(this,t,n,i)||this;return r.appAuthSdkHost=t,r.authenticationService=n,r.telemetryService=i,r}return i(t,e),t.prototype.initHandlers=function(){e.prototype.initHandlers.call(this),this.registerHandler(U,this.handleNotifySuccess),this.registerHandler(N,this.handleNotifyFailure)},t.prototype.handleNotifySuccess=function(e,t){return this.appAuthSdkHost.closeWindow(),this.appAuthSdkHost.stopAuthWindowMonitor(),Qt(this.authenticationService.notifySuccess,t)},t.prototype.handleNotifyFailure=function(e,t){return this.appAuthSdkHost.closeWindow(),this.appAuthSdkHost.stopAuthWindowMonitor(),Qt(this.authenticationService.notifyFailure,t,Nl.Other)},t}(en),nn=function(e){if(null==e||null===typeof e||"string"==typeof e||"boolean"==typeof e||"number"==typeof e)return e;if(Array.isArray(e))return e.map((function(e){return nn(e)}));if(e instanceof Date)return new Date(e.getTime());if(e instanceof ArrayBuffer)return"function"==typeof structuredClone?structuredClone(e):e.slice(0);if("object"==typeof e){for(var t={},n=0,i=Object.getOwnPropertyNames(e);n<i.length;n++){var r=i[n],o=e[r];t[r]=nn(o)}return t}throw Error("Provided type '"+typeof e+"' ("+Object.prototype.toString.call(e)+") can't be cloned using deepCopy.")},rn=function(){function e(e){this.appSdkHost=e,this.messageHandlers=[],this.TAG="BaseMessageProcessor"}return e.prototype.process=function(e){var t;return o(this,void 0,void 0,(function(){var n,i,r,o;return a(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),n=e.data,i=n.args,(i=n.args&&Array.isArray(n.args)?n.args.map((function(e){return t=e,"function"==typeof structuredClone?structuredClone(t):nn(t);var t})):[]).unshift(e),[4,this.callMessageHandler(n.func,i,n.timestamp)];case 1:return"appResponse"===(r=a.sent()).kind?(this.processHandlerResultHelper(n,r),this.appSdkHost.getLogger().log(y.Info,this.TAG,"Function name: ".concat(e.data.func)),[2,Promise.resolve(!0)]):[3,3];case 2:return o=a.sent(),this.appSdkHost.getLogger().log(y.Error,this.TAG,"Error in processing request: ".concat(null===(t=e.data)||void 0===t?void 0:t.func),o),[3,3];case 3:return[2,Promise.resolve(!1)]}}))}))},e.prototype.callMessageHandler=function(e,t,n){for(var i=0,r=this.messageHandlers;i<r.length;i++){var o=r[i];if(o.canHandleMessage(e))return o.handleMessage(e,t,n)}return Promise.reject("Unhandled message")},e.prototype.processHandlerResultHelper=function(e,t){var n=e.id,i=[];t.data&&(i=Array.isArray(t.data)?t.data:[t.data]),this.appSdkHost.postResponseToApp(n,i)},e.prototype.cleanup=function(){this.messageHandlers.forEach((function(e){return e.cleanup()}))},e}(),on=function(e){function t(t,n,i){var r=e.call(this,t)||this;return r.appSdkHost=t,r.authService=n,r.telemetryService=i,r.messageHandlers.push(new tn(t,n,i)),r.messageHandlers.push(new Yt(t,{},i)),r.messageHandlers.forEach((function(e){return e.initHandlers()})),r}return i(t,e),t}(rn),an=(Kt=[],{fireEvent:function(e){Kt.forEach((function(t){return t(e)}))},addListener:function(e){e&&Kt.push(e)}});function sn(e,t,n){an.fireEvent({level:e,category:t,message:n})}function un(e,t,n){sn(0,e,(function(){var e=n instanceof Error?n.message:"";return"".concat(t,": ").concat(e)}))}var cn={};function ln(e,t){"Office."===e.substring(0,7)&&"."!==e[e.length-1]?cn[e]?(t.ariaTenantToken&&(cn[e].ariaTenantToken=t.ariaTenantToken),t.dnmToken&&(cn[e].dnmToken=t.dnmToken)):cn[e]=t:sn(0,0,(function(){return"Namespace: ".concat(e)}))}function dn(e,t){for(var n=e.length;n>0;){var i=e.substr(0,n);if(cn[i]){var r=cn[i];return t.ariaTenantToken=r.ariaTenantToken,t.dnmToken=r.dnmToken,!0}n=e.lastIndexOf(".",n-1)}return!1}var fn=9007199254740991,pn=-fn,vn=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,hn=/^[a-zA-Z0-9_\.]{1,95}$/;function gn(e){return hn.test(e)}function mn(e){e&&e.forEach((function(e){if("string"!=typeof e.name||!gn(e.name))throw new Error("Invalid dataField name");2===e.dataType&&function(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<pn||e>fn)throw new Error("Invalid integer ".concat(JSON.stringify(e)))}(e.value)}))}function yn(e,t,n){return Cn(e,1,t,n)}function Sn(e,t,n){return Cn(e,2,t,n)}function Tn(e,t,n){return Cn(e,0,t,n)}function Cn(e,t,n,i){return{name:e,dataType:t,value:n,classification:i||4}}function bn(e){var t={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?r({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp||(new Date).getTime()};return e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t}var In,wn,An,kn,En,Pn,xn,Dn=function(){function e(e,t,n){var i,o,a;this.telemetrySinks=[],this.persistentDataFields=[],this.partAFields=[],this.eventQueue=[],this.config=n||{},e&&(this.telemetrySinks=e.telemetrySinks,(i=this.persistentDataFields).push.apply(i,e.persistentDataFields),this.config=r(r({},e.getConfig()),this.config),(o=this.partAFields).push.apply(o,e.partAFields)),t&&(a=this.persistentDataFields).push.apply(a,t)}return e.prototype.addEventContentType=function(e,t){e.push(Sn("EventContent.Type",t))},e.prototype.sendTelemetryEvent=function(e){var t=bn(e),n=t.telemetryProperties;n.nexusTenantToken=-1;var i=n.ariaTenantToken;i||dn(t.eventName,n)||i?this.sendTelemetryEventInternal(t,1):sn(0,0,(function(){return"No tenant token: "+e.eventName}))},e.prototype.sendCustomerContent=function(e){var t=bn(e),n=t.telemetryProperties,i=n.customerContentVersion;return(!i||i>2)&&(n.customerContentVersion=2),n.ariaTenantToken=void 0,n.nexusTenantToken=void 0,n.dnmToken=void 0,this.addEventContentType(t.dataFields,2),this.sendTelemetryEventInternal(t,2)},e.prototype.sendDirectNumericEvent=function(e){var t=bn(e),n=t.telemetryProperties;n.dnmToken||dn(t.eventName,n)||n.dnmToken?(this.addEventContentType(t.dataFields,1),this.sendTelemetryEventInternal(t,3)):sn(0,0,(function(){return"No dnm token: "+t.eventName}))},e.prototype.sendTelemetryEventInternal=function(e,t){if(2===t||!e.telemetryProperties.customerContentVersion&&!e.telemetryProperties.customerContentType){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push([e,t]):sn(1,0,(function(){return"No telemetry sinks are attached."})));this.processTelemetryEvent(e,t)}catch(e){return void un(0,"SendTelemetryEvent",e)}this.telemetrySinks.forEach((function(n){try{3===t||2===t?n.sendNonStandardEvent&&n.sendNonStandardEvent(e,t):n.sendTelemetryEvent(e)}catch(e){}}))}else sn(0,0,(function(){return"Customer content"}))},e.prototype.processTelemetryEvent=function(e,t){var n,i,r;if(e.dataFields&&(null===(r=e.dataFields)||void 0===r||r.unshift(Tn("OTelJS.Version","4.13.17")),3!==t&&this.persistentDataFields&&(n=e.dataFields).unshift.apply(n,this.persistentDataFields)),this.partAFields.length>0){var o=e.eventContract||{name:"",dataFields:[]};(i=o.dataFields).push.apply(i,this.partAFields),e.eventContract=o}this.config.disableValidation||function(e){if(!(t=e.eventName)||t.length>98||!vn.test(t))throw new Error("Invalid eventName");var t,n=e.eventContract;if(n){if(n.name&&!gn(n.name))throw new Error("Invalid eventContract");mn(n.dataFields)}mn(e.dataFields)}(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e),this.flushQueue()},e.prototype.flushQueue=function(){var e=this.eventQueue;if(this.eventQueue=[],this.telemetrySinks.length>0)for(var t=0,n=e;t<n.length;t++){var i=n[t],r=i[0],o=i[1];this.sendTelemetryEventInternal(r,o)}},e.prototype.setTenantToken=function(e,t,n){ln(e,{ariaTenantToken:t,nexusTenantToken:n})},e.prototype.setDNMToken=function(e,t){ln(e,{dnmToken:t})},e.prototype.cloneEvent=function(e){return bn(e)},e.prototype.getConfig=function(){return this.config},e}();!function(e){e.getFields=function(e,t){var n=[];return n.push(Sn("".concat(e,".Code"),t.code)),void 0!==t.type&&n.push(Tn("".concat(e,".Type"),t.type)),void 0!==t.tag&&n.push(Sn("".concat(e,".Tag"),t.tag)),void 0!==t.isExpected&&n.push(yn("".concat(e,".IsExpected"),t.isExpected)),n.push(Tn("zC.Activity.Result","Office.System.Result")),n}}(In||(In={})),function(e){e.contractName="Office.System.Activity",e.getFields=function(t){var n="Activity",i=[];return void 0!==t.cV&&i.push(Tn("".concat(n,".CV"),t.cV)),i.push(Sn("".concat(n,".Duration"),t.duration)),i.push(Sn("".concat(n,".Count"),t.count)),i.push(Sn("".concat(n,".AggMode"),t.aggMode)),void 0!==t.success&&i.push(yn("".concat(n,".Success"),t.success)),void 0!==t.result&&i.push.apply(i,In.getFields("".concat(n,".Result"),t.result)),i.push(Tn("zC.Activity",e.contractName)),i}}(wn||(wn={})),function(e){e.getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(Tn("".concat(e,".Id"),t.id)),void 0!==t.version&&n.push(Tn("".concat(e,".Version"),t.version)),void 0!==t.sessionId&&n.push(Tn("".concat(e,".SessionId"),t.sessionId)),n}}(An||(An={})),function(e){e.getFields=function(e,t){var n=[];return void 0!==t.alias&&n.push(Tn("".concat(e,".Alias"),t.alias)),void 0!==t.primaryIdentityHash&&n.push(Tn("".concat(e,".PrimaryIdentityHash"),t.primaryIdentityHash)),void 0!==t.primaryIdentitySpace&&n.push(Tn("".concat(e,".PrimaryIdentitySpace"),t.primaryIdentitySpace)),void 0!==t.tenantId&&n.push(Tn("".concat(e,".TenantId"),t.tenantId)),void 0!==t.tenantGroup&&n.push(Tn("".concat(e,".TenantGroup"),t.tenantGroup)),void 0!==t.isAnonymous&&n.push(yn("".concat(e,".IsAnonymous"),t.isAnonymous)),n}}(kn||(kn={})),function(e){e.getFields=function(e,t){var n=[];return void 0!==t.name&&n.push(Tn("".concat(e,".Name"),t.name)),void 0!==t.state&&n.push(Tn("".concat(e,".State"),t.state)),n}}(En||(En={})),function(e){e.getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(Sn("".concat(e,".Id"),t.id)),void 0!==t.name&&n.push(Tn("".concat(e,".Name"),t.name)),void 0!==t.commandSurface&&n.push(Tn("".concat(e,".CommandSurface"),t.commandSurface)),void 0!==t.parentName&&n.push(Tn("".concat(e,".ParentName"),t.parentName)),void 0!==t.triggerMethod&&n.push(Tn("".concat(e,".TriggerMethod"),t.triggerMethod)),void 0!==t.timeOffsetMs&&n.push(Sn("".concat(e,".TimeOffsetMs"),t.timeOffsetMs)),n}}(Pn||(Pn={})),function(e){e.getFields=function(e,t){var n=[];return n.push(Tn("".concat(e,".ErrorGroup"),t.errorGroup)),n.push(Sn("".concat(e,".Tag"),t.tag)),void 0!==t.code&&n.push(Sn("".concat(e,".Code"),t.code)),void 0!==t.id&&n.push(Sn("".concat(e,".Id"),t.id)),void 0!==t.count&&n.push(Sn("".concat(e,".Count"),t.count)),n}}(xn||(xn={}));var On,_n=wn,Fn=In,Rn=xn,Mn=En,Un=An,Nn=Pn,Hn=kn;function Ln(e,t){return e?e+"."+t:t}function zn(e,t,n,i,r){void 0===r&&(r=4),i&&e.push(Tn("".concat(Ln(t,n)),i,r))}function Bn(e,t,n,i){"boolean"==typeof i&&e.push(yn("".concat(Ln(t,n)),i))}function Vn(e,t,n,i){"number"==typeof i&&e.push(Sn("".concat(Ln(t,n)),i))}!function(e){var t,n;t=e.Office||(e.Office={}),(n=t.System||(t.System={})).Activity=_n,n.Result=Fn,n.Error=Rn,n.Funnel=Mn,n.Host=Un,n.User=Hn,n.UserAction=Nn}(On||(On={}));var Wn,Kn={contractName:"Office.System.Activity",getFields:function(e){var t="Activity",n=[];return zn(n,t,"CV",e.cV),Vn(n,t,"Duration",e.duration),Vn(n,t,"Count",e.count),Vn(n,t,"AggMode",e.aggMode),Bn(n,t,"Success",e.success),e.result&&n.push.apply(n,function(e){var t="Activity.Result",n=[];return Vn(n,t,"Code",e.code),zn(n,t,"Type",e.type),Vn(n,t,"Tag",e.tag),Bn(n,t,"IsExpected",e.isExpected),n.push(Tn("zC.Activity.Result","Office.System.Result")),n}(e.result)),n.push(Tn("zC.Activity",this.contractName)),n}},qn=function(e){var t="User",n=[];return zn(n,t,"PrimaryIdentityHash",e.primaryIdentityHash),zn(n,t,"PrimaryIdentitySpace",e.primaryIdentitySpace),zn(n,t,"TenantId",e.tenantId,1),zn(n,t,"TenantGroup",e.tenantGroup,1),Bn(n,t,"IsAnonymous",e.isAnonymous),n},jn=function(e){var t="Session",n=[];return zn(n,t,"Id",e.id,1),zn(n,t,"EcsETag",e.ecsETag,1),n};!function(e){var t,n,i="Copilot";(n=e.FeatureActionType||(e.FeatureActionType={})).IsEnabled="IsEnabled",n.IsSeen="IsSeen",n.IsTried="IsTried",n.IsKept="IsKept",n.IsRejected="IsRejected",(t=e.Capability||(e.Capability={})).ContentGeneration="Content Generation",t.Commanding="Commanding",t.QAandSummaries="QA and Summaries",t.Collaboration="Collaboration",t.Suggestions="Suggestions",e.getFields=function(e){var t=[];return void 0!==e.featureActionType&&t.push(Tn("".concat(i,".FeatureActionType"),e.featureActionType)),void 0!==e.isUserInitiated&&t.push(yn("".concat(i,".IsUserInitiated"),e.isUserInitiated)),void 0!==e.featureName&&t.push(Tn("".concat(i,".FeatureName"),e.featureName)),void 0!==e.capability&&t.push(Tn("".concat(i,".Capability"),e.capability)),void 0!==e.isThumbsUp&&t.push(yn("".concat(i,".IsThumbsUp"),e.isThumbsUp)),t.push(Tn("zC.".concat(i),"Office.System.Copilot")),t}}(Wn||(Wn={}));var Gn=function(){return 1e3*Date.now()};"object"==typeof window&&"object"==typeof window.performance&&"now"in window.performance&&(Gn=function(){return 1e3*Math.floor(window.performance.now())});var Jn,Qn=function(e){var t,n=Gn(),i=bn(e.telemetryEvent);return{cv:e.parentCv.getNext(),eventName:e.telemetryEvent.eventName,dataFields:i.dataFields,eventFlags:i.eventFlags,telemetryProperties:i.telemetryProperties,createChildActivity:function(t){return Qn({telemetryEvent:t,sendTelemetryEvent:e.sendTelemetryEvent,parentCv:this.cv})},setResult:function(e,t,n){this.result={code:e,type:t,tag:n}},endNow:function(){if(!t){void 0===this.success&&void 0===this.result&&sn(1,0,(function(){return"Activity does not have success or result set"}));var i=Gn();t=!0;var r={duration:i-n,count:1,aggMode:0,cV:this.cv.value,success:this.success,result:this.result},o=this.eventContract&&this.eventContract.dataFields?this.eventContract.dataFields:[];return o.push.apply(o,Kn.getFields(r)),this.eventContract={name:Kn.contractName,dataFields:o},e.sendTelemetryEvent(this)}sn(0,0,(function(){return"Already ended"}))}}},Xn=function(){function e(e){this.value=e,this.nextChild=0}return e.prototype.getNext=function(){return new e("".concat(this.value,".").concat(++this.nextChild))},e}(),$n=function(e){function t(t,n,i){var r=e.call(this,t,n,i)||this;return r.baseCv=function(){if(!Jn){for(var e=[],t=0;t<22;t++)e.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(Math.floor(64*Math.random())));Jn=new Xn(e.join(""))}return Jn}(),r}return i(t,e),t.prototype.createActivity=function(e){return Qn({sendTelemetryEvent:this.sendTelemetryEvent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t.prototype.sendActivity=function(e,t,n,i){return this.sendTelemetryEvent({eventName:e,eventContract:{name:Kn.contractName,dataFields:Kn.getFields(t)},dataFields:n,eventFlags:i})},t.prototype.sendError=function(e){var t=function(e){var t="Error",n=[];return n.push(Tn("".concat(t,".ErrorGroup"),e.errorGroup)),n.push(Sn("".concat(t,".Tag"),e.tag)),void 0!==e.code&&n.push(Sn("".concat(t,".Code"),e.code)),void 0!==e.id&&n.push(Sn("".concat(t,".Id"),e.id)),void 0!==e.count&&n.push(Sn("".concat(t,".Count"),e.count)),n}(e.error);return null!=e.dataFields&&t.push.apply(t,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:t,eventFlags:e.eventFlags})},t.prototype.createCustomerContentActivity=function(e){return Qn({sendTelemetryEvent:this.sendCustomerContent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t}(Dn),Zn="Data.";function Yn(e,t,n,i){var r=!0;if(t)for(var o=function(t){var o=t.classification,a=t.dataType,s=t.name;if(o&&!(4===o||1===o||2===i&&32===o||3===i&&2048===o))return r=!1,"break";if(3===i&&n&&3!==a&&1!==a&&2!==a&&"OTelJS.Version"!==s&&"OTelJS.Sink"!==s)return sn(0,1,(function(){return"DNM: Invalid field type "+s})),r=!1,"break";var u;u=n?"zC."===s.substr(0,3)?"zC."+Zn+s.substr(3):Zn+s:s;var c=void 0;switch(a){case 3:c=6;break;case 2:c=4;break;case 4:c=8;break;case 0:return e[u]="string"==typeof t.value?t.value.substr(0,25e3):t.value,"continue";default:return e[u]=t.value,"continue"}var l={value:t.value,propertyType:c};e[u]=l},a=0,s=t;a<s.length&&"break"!==o(s[a]);a++);return r}var ei="User.TenantId",ti="Session.Id";function ni(e){sn(0,1,(function(){return"Invalid "+e}))}var ii="function",ri="object",oi="undefined",ai="prototype",si="hasOwnProperty",ui=Object,ci=ui[ai],li=ui.assign,di=ui.create,fi=ui.defineProperty,pi=ci[si],vi=null;function hi(e){void 0===e&&(e=!0);var t=!1===e?null:vi;return t||(typeof globalThis!==oi&&(t=globalThis),t||typeof self===oi||(t=self),t||typeof window===oi||(t=window),t||typeof n.g===oi||(t=n.g),vi=t),t}function gi(e){throw new TypeError(e)}function mi(e){if(di)return di(e);if(null==e)return{};var t=typeof e;function n(){}return t!==ri&&t!==ii&&gi("Object prototype may only be an Object:"+e),n[ai]=e,new n}var yi,Si,Ti="initialize",Ci="name",bi="getNotifyMgr",Ii="identifier",wi="push",Ai="isInitialized",ki="config",Ei="instrumentationKey",Pi="logger",xi="length",Di="time",Oi="processNext",_i="getProcessTelContext",Fi="addNotificationListener",Ri="removeNotificationListener",Mi="stopPollingInternalLogs",Ui="onComplete",Ni="getPlugin",Hi="flush",Li="_extensions",zi="splice",Bi="teardown",Vi="messageId",Wi="message",Ki="isAsync",qi="_doTeardown",ji="update",Gi="getNext",Ji="diagLog",Qi="setNextPlugin",Xi="createNew",$i="cookieCfg",Zi="indexOf",Yi="substring",er="userAgent",tr="split",nr="setEnabled",ir="substr",rr="nodeType",or="apply",ar="replace",sr="enableDebugExceptions",ur="toLowerCase",cr="call",lr="type",dr="handler",fr="listeners",pr="isChildEvt",vr="getCtx",hr="setCtx",gr="complete",mr="traceId",yr="spanId",Sr="traceFlags",Tr="undefined",Cr="constructor",br="prototype",Ir="function",wr="_dynInstFuncs",Ar="_isDynProxy",kr="_dynClass",Er="_dynInstChk",Pr=Er,xr="_dfOpts",Dr="_unknown_",Or="__proto__",_r="_dyn"+Or,Fr="__dynProto$Gbl",Rr="_dynInstProto",Mr="useBaseInst",Ur="setInstFuncs",Nr=Object,Hr=Nr.getPrototypeOf,Lr=Nr.getOwnPropertyNames,zr=(typeof globalThis!==Tr&&(Si=globalThis),Si||typeof self===Tr||(Si=self),Si||typeof window===Tr||(Si=window),Si||typeof n.g===Tr||(Si=n.g),Si||{}),Br=zr[Fr]||(zr[Fr]={o:(yi={},yi[Ur]=!0,yi[Mr]=!0,yi),n:1e3});function Vr(e,t){return e&&Nr[br].hasOwnProperty.call(e,t)}function Wr(e){return e&&(e===Nr[br]||e===Array[br])}function Kr(e){return Wr(e)||e===Function[br]}function qr(e){var t;if(e){if(Hr)return Hr(e);var n=e[Or]||e[br]||(e[Cr]?e[Cr][br]:null);t=e[_r]||n,Vr(e,_r)||(delete e[Rr],t=e[_r]=e[Rr]||e[_r],e[Rr]=n)}return t}function jr(e,t){var n=[];if(Lr)n=Lr(e);else for(var i in e)"string"==typeof i&&Vr(e,i)&&n.push(i);if(n&&n.length>0)for(var r=0;r<n.length;r++)t(n[r])}function Gr(e,t,n){return t!==Cr&&typeof e[t]===Ir&&(n||Vr(e,t))}function Jr(e){throw new TypeError("DynamicProto: "+e)}function Qr(e,t){for(var n=e.length-1;n>=0;n--)if(e[n]===t)return!0;return!1}function Xr(e,t,n,i,r){if(!Wr(e)){var o=n[wr]=n[wr]||{},a=o[t]=o[t]||{};!1!==o[Pr]&&(o[Pr]=!!r),jr(n,(function(t){Gr(n,t,!1)&&n[t]!==i[t]&&(a[t]=n[t],delete n[t],(!Vr(e,t)||e[t]&&!e[t][Ar])&&(e[t]=function(e,t){var n=function(){var i=function(e,t,n,i){var r=null;if(e&&Vr(n,kr)){var o=e[wr]||{};if((r=(o[n[kr]]||{})[t])||Jr("Missing ["+t+"] "+Ir),!r[Er]&&!1!==o[Pr]){for(var a=!Vr(e,t),s=qr(e),u=[];a&&s&&!Kr(s)&&!Qr(u,s);){var c=s[t];if(c){a=c===i;break}u.push(s),s=qr(s)}try{a&&(e[t]=r),r[Er]=1}catch(e){o[Pr]=!1}}}return r}(this,t,e,n)||function(e,t,n){var i=t[e];return i===n&&(i=qr(t)[e]),typeof i!==Ir&&Jr("["+e+"] is not a "+Ir),i}(t,e,n);return i.apply(this,arguments)};return n[Ar]=1,n}(e,t)))}))}}function $r(e,t){return Vr(e,br)?e.name||t||Dr:((e||{})[Cr]||{}).name||t||Dr}function Zr(e,t,n,i){Vr(e,br)||Jr("theClass is an invalid class definition.");var r=e[br];(function(e,t){if(Hr){for(var n=[],i=qr(t);i&&!Kr(i)&&!Qr(n,i);){if(i===e)return!0;n.push(i),i=qr(i)}return!1}return!0})(r,t)||Jr("["+$r(e)+"] not in hierarchy of ["+$r(t)+"]");var o=null;Vr(r,kr)?o=r[kr]:(o="_dynCls$"+$r(e,"_")+"$"+Br.n,Br.n++,r[kr]=o);var a=Zr[xr],s=!!a[Mr];s&&i&&void 0!==i[Mr]&&(s=!!i[Mr]);var u=function(e){var t={};return jr(e,(function(n){!t[n]&&Gr(e,n,!1)&&(t[n]=e[n])})),t}(t),c=function(e,t,n,i){function r(e,t,n){var r=t[n];if(r[Ar]&&i){var o=e[wr]||{};!1!==o[Pr]&&(r=(o[t[kr]]||{})[n]||r)}return function(){return r.apply(e,arguments)}}var o={};jr(n,(function(e){o[e]=r(t,n,e)}));for(var a=qr(e),s=[];a&&!Kr(a)&&!Qr(s,a);)jr(a,(function(e){!o[e]&&Gr(a,e,!Hr)&&(o[e]=r(t,a,e))})),s.push(a),a=qr(a);return o}(r,t,u,s);n(t,c);var l=!!Hr&&!!a[Ur];l&&i&&(l=!!i[Ur]),Xr(r,o,t,u,!1!==l)}Zr[xr]=Br.o;var Yr="",eo="channels",to="core",no="createPerfMgr",io="disabled",ro="extensionConfig",oo="processTelemetry",ao="priority",so="eventsSent",uo="eventsDiscarded",co="eventsSendRequest",lo="perfEvent",fo="errorToConsole",po="warnToConsole",vo="getPerfMgr",ho="toISOString",go="endsWith",mo="startsWith",yo="indexOf",So="trim",To="toString",Co="__proto__",bo="constructor",Io=fi,wo=ui.freeze,Ao=(ui.seal,ui.keys),ko=String[ai],Eo=ko[So],Po=ko[go],xo=ko[mo],Do=Date[ai][ho],Oo=Array.isArray,_o=ci[To],Fo=pi[To],Ro=Fo[cr](ui),Mo=/-([a-z])/g,Uo=/([^\w\d_$])/g,No=/^(\d+[\w\d_$])/,Ho=Object.getPrototypeOf;function Lo(e){return void 0===e||typeof e===oi}function zo(e){return null===e||Lo(e)}function Bo(e){return!zo(e)}function Vo(e,t){return!(!e||!pi[cr](e,t))}function Wo(e){return!(!e||typeof e!==ri)}function Ko(e){return!(!e||typeof e!==ii)}function qo(e){var t=e;return t&&Xo(t)&&(t=(t=(t=t[ar](Mo,(function(e,t){return t.toUpperCase()})))[ar](Uo,"_"))[ar](No,(function(e,t){return"_"+t}))),t}function jo(e,t){if(e)for(var n in e)pi[cr](e,n)&&t[cr](e,n,e[n])}function Go(e,t){var n=!1;return e&&t&&!(n=e===t)&&(n=xo?e[mo](t):function(e,t){var n=!1,i=t?t[xi]:0;if(e&&i&&e[xi]>=i&&!(n=e===t)){for(var r=0;r<i;r++)if(e[r]!==t[r])return!1;n=!0}return n}(e,t)),n}function Jo(e,t){return!(!e||!t)&&-1!==e[Zi](t)}var Qo=Oo||function(e){return!(!e||"[object Array]"!==_o[cr](e))};function Xo(e){return"string"==typeof e}function $o(e){return"number"==typeof e}function Zo(e){return"boolean"==typeof e}function Yo(e){var t=!1;if(e&&"object"==typeof e){var n=Ho?Ho(e):function(e){if(e){if(Ho)return Ho(e);var t=e[Co]||e[ai]||e[bo];if(t)return t}return null}(e);n?(n[bo]&&pi[cr](n,bo)&&(n=n[bo]),t=typeof n===ii&&Fo[cr](n)===Ro):t=!0}return t}function ea(e){if(e)return Do?e[ho]():function(e){if(e&&e.getUTCFullYear){var t=function(e){var t=String(e);return 1===t[xi]&&(t="0"+t),t};return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}(e)}function ta(e,t,n){var i=e[xi];try{for(var r=0;r<i&&(!(r in e)||-1!==t[cr](n||e,e[r],r,e));r++);}catch(e){}}function na(e,t,n){if(e){if(e[yo])return e[yo](t,n);var i=e[xi],r=n||0;try{for(var o=Math.max(r>=0?r:i-Math.abs(r),0);o<i;o++)if(o in e&&e[o]===t)return o}catch(e){}}return-1}function ia(e){return e&&(e=Eo&&e[So]?e[So]():e[ar]?e[ar](/^\s+|(?=\s)\s+$/g,Yr):e),e}var ra=!{toString:null}.propertyIsEnumerable("toString"),oa=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];function aa(e){var t=typeof e;if(t===ii||t===ri&&null!==e||gi("objKeys called on non-object"),!ra&&Ao)return Ao(e);var n=[];for(var i in e)e&&pi[cr](e,i)&&n[wi](i);if(ra)for(var r=oa[xi],o=0;o<r;o++)e&&pi[cr](e,oa[o])&&n[wi](oa[o]);return n}function sa(e,t,n,i){if(Io)try{var r={enumerable:!0,configurable:!0};return n&&(r.get=n),i&&(r.set=i),Io(e,t,r),!0}catch(e){}return!1}var ua=wo||function(e){return e};function ca(){var e=Date;return e.now?e.now():(new e).getTime()}function la(e){return function(e){return!(!e||"[object Error]"!==_o[cr](e))}(e)?e[Ci]:Yr}function da(e,t,n,i,r){var o=n;return e&&((o=e[t])===n||r&&!r(o)||i&&!i(n)||(o=n,e[t]=o)),o}function fa(e,t,n){var i;return e?!(i=e[t])&&zo(i)&&(i=Lo(n)?{}:n,e[t]=i):i=Lo(n)?{}:n,i}function pa(e,t){return zo(e)?t:e}function va(e){return!!e}function ha(e){throw new Error(e)}function ga(e,t,n,i,r){e&&t&&n&&(!1!==r||Lo(e[t]))&&(e[t]=function(e,t){var n=null,i=null;return Ko(e)?n=e:i=e,function(){var e=arguments;if(n&&(i=n()),i)return i[t][or](i,e)}}(n,i))}function ma(e){return e&&li&&(e=ui(li({},e))),e}function ya(e,t,n,i,r,o){var a=arguments,s=a[0]||{},u=a[xi],c=!1,l=1;for(u>0&&Zo(s)&&(c=s,s=a[l]||{},l++),Wo(s)||(s={});l<u;l++){var d=a[l],f=Qo(d),p=Wo(d);for(var v in d)if(f&&v in d||p&&pi[cr](d,v)){var h=d[v],g=void 0;if(c&&h&&((g=Qo(h))||Yo(h))){var m=s[v];g?Qo(m)||(m=[]):Yo(m)||(m={}),h=ya(c,m,h)}void 0!==h&&(s[v]=h)}}return s}var Sa="window",Ta="document",Ca="navigator",ba="location",Ia="performance",wa="JSON",Aa="crypto",ka="msCrypto",Ea="msie",Pa="trident/",xa="XMLHttpRequest",Da=null,Oa=null,_a=!1,Fa=null,Ra=null;function Ma(e,t){var n=!1;if(e){try{if(!(n=t in e)){var i=e[ai];i&&(n=t in i)}}catch(e){}if(!n)try{n=!Lo((new e)[t])}catch(e){}}return n}function Ua(e){var t=hi();return t&&t[e]?t[e]:e===Sa&&Na()?window:null}function Na(){return Boolean(typeof window===ri&&window)}function Ha(){return Na()?window:Ua(Sa)}function La(){return Boolean(typeof document===ri&&document)?document:Ua(Ta)}function za(){return Boolean(typeof navigator===ri&&navigator)}function Ba(){return za()?navigator:Ua(Ca)}function Va(e){if(e&&_a){var t=Ua("__mockLocation");if(t)return t}return typeof location===ri&&location?location:Ua(ba)}function Wa(){return Boolean(typeof JSON===ri&&JSON||null!==Ua(wa))}function Ka(){return Wa()?JSON||Ua(wa):null}function qa(){var e=Ba();return!(!e||!e.product)&&"ReactNative"===e.product}function ja(){var e=Ba();if(e&&(e[er]!==Oa||null===Da)){var t=((Oa=e[er])||Yr)[ur]();Da=Jo(t,Ea)||Jo(t,Pa)}return Da}function Ga(e){var t=Object[ai].toString[cr](e),n=Yr;return"[object Error]"===t?n="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e[Ci]+"'":Wa()&&(n=Ka().stringify(e)),t+n}function Ja(){return null===Ra&&(Ra=za()&&Boolean(Ba().sendBeacon)),Ra}function Qa(e){var t=!1;try{t=!!Ua("fetch");var n=Ua("Request");t&&e&&n&&(t=Ma(n,"keepalive"))}catch(e){}return t}function Xa(){var e=!1;try{e=!!Ua(xa)}catch(e){}return e}var $a,Za=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],Ya=null;function es(e,t){return function(){var n=arguments,i=ts(t);if(i){var r=i.listener;r&&r[e]&&r[e][or](r,n)}}}function ts(e){var t,n=Ya;return n||!0===e.disableDbgExt||(n=Ya||((t=Ua("Microsoft"))&&(Ya=t.ApplicationInsights),Ya)),n?n.ChromeDbgExt:null}function ns(e){if(!$a){$a={};for(var t=0;t<Za[xi];t++)$a[Za[t]]=es(Za[t],e)}return $a}function is(e){return e?'"'+e[ar](/\"/g,Yr)+'"':Yr}function rs(e,t){var n=typeof console!==oi?console:Ua("console");if(n){var i="log";n[e]&&(i=e),Ko(n[i])&&n[i](t)}}var os=function(){function e(e,t,n,i){void 0===n&&(n=!1);var r=this;r[Vi]=e,r[Wi]=(n?"AI: ":"AI (Internal): ")+e;var o=Yr;Wa()&&(o=Ka().stringify(i));var a=(t?" message:"+is(t):Yr)+(i?" props:"+is(o):Yr);r[Wi]+=a}return e.dataType="MessageData",e}(),as=function(){function e(t){this.identifier="DiagnosticLogger",this.queue=[];var n,i,r,o,a=0,s={};Zr(e,this,(function(e){function u(t,n){if(!(a>=r)){var o=!0,u="AITR_"+n[Vi];if(s[u]?o=!1:s[u]=!0,o&&(t<=i&&(e.queue[wi](n),a++,c(1===t?"error":"warn",n)),a===r)){var l="Internal events throttle limit per PageView reached for this app.",d=new os(23,l,!1);e.queue[wi](d),1===t?e[fo](l):e[po](l)}}}function c(e,n){var i=ts(t||{});i&&i[Ji]&&i[Ji](e,n)}!function(e){n=pa(e.loggingLevelConsole,0),i=pa(e.loggingLevelTelemetry,1),r=pa(e.maxMessageLimit,25),o=pa(e.enableDebug,pa(e[sr],!1))}(t||{}),e.consoleLoggingLevel=function(){return n},e.telemetryLoggingLevel=function(){return i},e.maxInternalMessageLimit=function(){return r},e[sr]=function(){return o},e.throwInternal=function(t,i,r,a,l){void 0===l&&(l=!1);var d=new os(i,r,l,a);if(o)throw Ga(d);var f=1===t?fo:po;if(Lo(d[Wi]))c("throw"+(1===t?"Critical":"Warning"),d);else{if(l){var p=+d[Vi];!s[p]&&n>=t&&(e[f](d[Wi]),s[p]=!0)}else n>=t&&e[f](d[Wi]);u(t,d)}},e[po]=function(e){rs("warn",e),c("warning",e)},e[fo]=function(e){rs("error",e),c("error",e)},e.resetInternalMessageCount=function(){a=0,s={}},e.logInternalMessage=u}))}return e.__ieDyn=1,e}();function ss(e){return e||new as}function us(e,t,n,i,r,o){void 0===o&&(o=!1),ss(e).throwInternal(t,n,i,r,o)}function cs(e,t){ss(e)[po](t)}var ls="toGMTString",ds="toUTCString",fs="cookie",ps="expires",vs="enabled",hs="isCookieUseDisabled",gs="disableCookiesUsage",ms="_ckMgr",ys=null,Ss=null,Ts=null,Cs=La(),bs={},Is={};function ws(e){return!e||e.isEnabled()}function As(e,t){return!!(t&&e&&Qo(e.ignoreCookies))&&-1!==e.ignoreCookies[Zi](t)}function ks(e,t){var n,i=function(e){var t=e[$i]=e[$i]||{};if(da(t,"domain",e.cookieDomain,Bo,zo),da(t,"path",e.cookiePath||"/",null,zo),zo(t[vs])){var n=void 0;Lo(e[hs])||(n=!e[hs]),Lo(e[gs])||(n=!e[gs]),t[vs]=n}return t}(e||Is),r=i.path||"/",o=i.domain,a=!1!==i[vs],s=((n={isEnabled:function(){var e=a&&Es(t),n=Is[ms];return e&&n&&s!==n&&(e=ws(n)),e}})[nr]=function(e){a=!1!==e},n.set=function(e,t,n,a,u){var c,l=!1;if(ws(s)&&!function(e,t){return!!(t&&e&&Qo(e.blockedCookies)&&-1!==e.blockedCookies[Zi](t))||As(e,t)}(i,e)){var d={},f=ia(t||Yr),p=f[Zi](";");if(-1!==p&&(f=ia(t[Yi](0,p)),d=Ps(t[Yi](p+1))),da(d,"domain",a||o,va,Lo),!zo(n)){var v=ja();if(Lo(d[ps])){var h=ca()+1e3*n;if(h>0){var g=new Date;g.setTime(h),da(d,ps,xs(g,v?ls:ds)||xs(g,v?ls:ds)||Yr,va)}}v||da(d,"max-age",Yr+n,null,Lo)}var m=Va();m&&"https:"===m.protocol&&(da(d,"secure",null,null,Lo),null===Ss&&(c=(Ba()||{})[er],Ss=!(Xo(c)&&(Jo(c,"CPU iPhone OS 12")||Jo(c,"iPad; CPU OS 12")||Jo(c,"Macintosh; Intel Mac OS X 10_14")&&Jo(c,"Version/")&&Jo(c,"Safari")||Jo(c,"Macintosh; Intel Mac OS X 10_14")&&function(e,t){var n=!1;return e&&t&&!(n=e===t)&&(n=Po?e[go](t):function(e,t){var n=!1,i=t?t[xi]:0,r=e?e[xi]:0;if(i&&r&&r>=i&&!(n=e===t)){for(var o=r-1,a=i-1;a>=0;a--){if(e[o]!=t[a])return!1;o--}n=!0}return n}(e,t)),n}(c,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||Jo(c,"Chrome/5")||Jo(c,"Chrome/6")||Jo(c,"UnrealEngine")&&!Jo(c,"Chrome")||Jo(c,"UCBrowser/12")||Jo(c,"UCBrowser/11")))),Ss&&da(d,"SameSite","None",null,Lo)),da(d,"path",u||r,null,Lo),(i.setCookie||_s)(e,Ds(f,d)),l=!0}return l},n.get=function(e){var t=Yr;return ws(s)&&!As(i,e)&&(t=(i.getCookie||Os)(e)),t},n.del=function(e,t){var n=!1;return ws(s)&&(n=s.purge(e,t)),n},n.purge=function(e,n){var r,o=!1;if(Es(t)){var a=((r={}).path=n||"/",r[ps]="Thu, 01 Jan 1970 00:00:01 GMT",r);ja()||(a["max-age"]="0"),(i.delCookie||_s)(e,Ds(Yr,a)),o=!0}return o},n);return s[ms]=s,s}function Es(e){if(null===ys){ys=!1;try{ys=void 0!==(Cs||{})[fs]}catch(t){us(e,2,68,"Cannot access document.cookie - "+la(t),{exception:Ga(t)})}}return ys}function Ps(e){var t={};return e&&e[xi]&&ta(ia(e)[tr](";"),(function(e){if(e=ia(e||Yr)){var n=e[Zi]("=");-1===n?t[e]=null:t[ia(e[Yi](0,n))]=ia(e[Yi](n+1))}})),t}function xs(e,t){return Ko(e[t])?e[t]():null}function Ds(e,t){var n=e||Yr;return jo(t,(function(e,t){n+="; "+e+(zo(t)?Yr:"="+t)})),n}function Os(e){var t=Yr;if(Cs){var n=Cs[fs]||Yr;Ts!==n&&(bs=Ps(n),Ts=n),t=ia(bs[e]||Yr)}return t}function _s(e,t){Cs&&(Cs[fs]=e+"="+t)}var Fs=4294967296,Rs=4294967295,Ms=!1,Us=123456789,Ns=987654321;function Hs(){try{var e=2147483647&ca();(t=(Math.random()*Fs^e)+e)<0&&(t>>>=0),Us=123456789+t&Rs,Ns=987654321-t&Rs,Ms=!0}catch(e){}var t}function Ls(e){var t=0,n=Ua(Aa)||Ua(ka);return n&&n.getRandomValues&&(t=n.getRandomValues(new Uint32Array(1))[0]&Rs),0===t&&ja()&&(Ms||Hs(),t=function(e){var t=((Ns=36969*(65535&Ns)+(Ns>>16)&Rs)<<16)+(65535&(Us=18e3*(65535&Us)+(Us>>16)&Rs))>>>0&Rs|0;return e||(t>>>=0),t}()&Rs),0===t&&(t=Math.floor(Fs*Math.random()|0)),e||(t>>>=0),t}var zs=fi,Bs="2.8.14",Vs="."+function(e){void 0===e&&(e=22);for(var t=Ls()>>>0,n=0,i=Yr;i[xi]<e;)n++,i+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&t),t>>>=6,5===n&&(t=(Ls()<<2&4294967295|3&t)>>>0,n=0);return i}(6),Ws=0;function Ks(e){return 1===e[rr]||9===e[rr]||!+e[rr]}function qs(e,t){return void 0===t&&(t=!1),qo(e+Ws+++(t?"."+Bs:Yr)+Vs)}function js(e){var t={id:qs("_aiData-"+(e||Yr)+"."+Bs),accept:function(e){return Ks(e)},get:function(e,n,i,r){var o=e[t.id];return o?o[qo(n)]:(r&&((o=function(e,t){var n=t[e.id];if(!n){n={};try{Ks(t)&&(function(e,t,n){if(zs)try{return zs(e,t,{value:n,enumerable:!1,configurable:!0}),!0}catch(e){}return!1}(t,e.id,n)||(t[e.id]=n))}catch(e){}}return n}(t,e))[qo(n)]=i),i)},kill:function(e,t){if(e&&e[t])try{delete e[t]}catch(e){}}};return t}var Gs="on",Js="attachEvent",Qs="addEventListener",Xs="detachEvent",$s="removeEventListener",Zs="events",Ys="visibilitychange",eu="pagehide",tu="pageshow",nu="unload",iu="beforeunload",ru=qs("aiEvtPageHide"),ou=qs("aiEvtPageShow"),au=/\.[\.]+/g,su=/[\.]+$/,uu=1,cu=js("events"),lu=/^([^.]*)(?:\.(.+)|)/;function du(e){return e&&e[ar]?e[ar](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,Yr):e}function fu(e,t){var n;if(t){var i=Yr;Qo(t)?(i=Yr,ta(t,(function(e){(e=du(e))&&("."!==e[0]&&(e="."+e),i+=e)}))):i=du(t),i&&("."!==i[0]&&(i="."+i),e=(e||Yr)+i)}var r=lu.exec(e||Yr)||[];return(n={})[lr]=r[1],n.ns=(r[2]||Yr).replace(au,".").replace(su,Yr)[tr](".").sort().join("."),n}function pu(e,t,n){void 0===n&&(n=!0);var i=cu.get(e,Zs,{},n),r=i[t];return r||(r=i[t]=[]),r}function vu(e,t,n,i){e&&t&&t[lr]&&(e[$s]?e[$s](t[lr],n,i):e[Xs]&&e[Xs](Gs+t[lr],n))}function hu(e,t,n,i){for(var r=t[xi];r--;){var o=t[r];o&&(n.ns&&n.ns!==o.evtName.ns||i&&!i(o)||(vu(e,o.evtName,o[dr],o.capture),t[zi](r,1)))}}function gu(e,t){return t?fu("xx",Qo(t)?[e].concat(t):[e,t]).ns[tr]("."):e}function mu(e,t,n,i,r){var o;void 0===r&&(r=!1);var a=!1;if(e)try{var s=fu(t,i);if(a=function(e,t,n,i){var r=!1;return e&&t&&t[lr]&&n&&(e[Qs]?(e[Qs](t[lr],n,i),r=!0):e[Js]&&(e[Js](Gs+t[lr],n),r=!0)),r}(e,s,n,r),a&&cu.accept(e)){var u=((o={guid:uu++,evtName:s})[dr]=n,o.capture=r,o);pu(e,s.type)[wi](u)}}catch(e){}return a}function yu(e,t,n,i,r){if(void 0===r&&(r=!1),e)try{var o=fu(t,i),a=!1;!function(e,t,n){if(t[lr])hu(e,pu(e,t[lr]),t,n);else{var i=cu.get(e,Zs,{});jo(i,(function(i,r){hu(e,r,t,n)})),0===aa(i)[xi]&&cu.kill(e,Zs)}}(e,o,(function(e){return!((!o.ns||n)&&e[dr]!==n||(a=!0,0))})),a||vu(e,o,n,r)}catch(e){}}function Su(e,t,n,i){var r=!1;return t&&e&&e[xi]>0&&ta(e,(function(e){e&&(n&&-1!==na(n,e)||(r=function(e,t,n){var i=!1,r=Ha();r&&(i=mu(r,e,t,n),i=mu(r.body,e,t,n)||i);var o=La();return o&&(i=mu(o,e,t,n)||i),i}(e,t,i)||r))})),r}function Tu(e,t,n){e&&Qo(e)&&ta(e,(function(e){e&&function(e,t,n){var i=Ha();i&&(yu(i,e,t,n),yu(i.body,e,t,n));var r=La();r&&yu(r,e,t,n)}(e,t,n)}))}function Cu(e,t,n){var i=gu(ru,n),r=Su([eu],e,t,i);return t&&-1!==na(t,Ys)||(r=Su([Ys],(function(t){var n=La();e&&n&&"hidden"===n.visibilityState&&e(t)}),t,i)||r),!r&&t&&(r=Cu(e,null,n)),r}function bu(e,t,n){var i=gu(ou,n),r=Su([tu],e,t,i);return!(r=Su([Ys],(function(t){var n=La();e&&n&&"visible"===n.visibilityState&&e(t)}),t,i)||r)&&t&&(r=bu(e,null,n)),r}function Iu(){var e=function(){for(var e,t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n=Yr,i=0;i<4;i++)n+=t[15&(e=Ls())]+t[e>>4&15]+t[e>>8&15]+t[e>>12&15]+t[e>>16&15]+t[e>>20&15]+t[e>>24&15]+t[e>>28&15];var r=t[8+(3&Ls())|0];return n[ir](0,8)+n[ir](9,4)+"4"+n[ir](13,3)+r+n[ir](16,3)+n[ir](19,12)}();return e[Yi](0,8)+"-"+e[Yi](8,12)+"-"+e[Yi](12,16)+"-"+e[Yi](16,20)+"-"+e[Yi](20)}var wu=((hi()||{}).Symbol,(hi()||{}).Reflect,function(e,t){return wu=ui.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t[si](n)&&(e[n]=t[n])},wu(e,t)});function Au(e,t){function n(){this.constructor=e}typeof t!==ii&&null!==t&&gi("Class extends value "+String(t)+" is not a constructor or null"),wu(e,t),e[ai]=null===t?mi(t):(n[ai]=t[ai],new n)}function ku(e,t){for(var n=0,i=t.length,r=e.length;n<i;n++,r++)e[r]=t[n];return e}var Eu="ctx",Pu="ParentContextKey",xu="ChildrenContextKey",Du=function(){function e(t,n,i){var r,o=this,a=!1;o.start=ca(),o[Ci]=t,o[Ki]=i,o[pr]=function(){return!1},Ko(n)&&(a=sa(o,"payload",(function(){return!r&&Ko(n)&&(r=n(),n=null),r}))),o[vr]=function(t){return t?t===e[Pu]||t===e[xu]?o[t]:(o[Eu]||{})[t]:null},o[hr]=function(t,n){t&&(t===e[Pu]?(o[t]||(o[pr]=function(){return!0}),o[t]=n):t===e[xu]?o[t]=n:(o[Eu]=o[Eu]||{})[t]=n)},o[gr]=function(){var t=0,i=o[vr](e[xu]);if(Qo(i))for(var r=0;r<i[xi];r++){var s=i[r];s&&(t+=s[Di])}o[Di]=ca()-o.start,o.exTime=o[Di]-t,o[gr]=function(){},!a&&Ko(n)&&(o.payload=n())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),Ou=function(){function e(t){this.ctx={},Zr(e,this,(function(e){e.create=function(e,t,n){return new Du(e,t,n)},e.fire=function(e){e&&(e[gr](),t&&Ko(t[lo])&&t[lo](e))},e[hr]=function(t,n){t&&((e[Eu]=e[Eu]||{})[t]=n)},e[vr]=function(t){return(e[Eu]||{})[t]}}))}return e.__ieDyn=1,e}(),_u="CoreUtils.doPerf";function Fu(e,t,n,i,r){if(e){var o=e;if(o[vo]&&(o=o[vo]()),o){var a=void 0,s=o[vr](_u);try{if(a=o.create(t(),i,r)){if(s&&a[hr]&&(a[hr](Du[Pu],s),s[vr]&&s[hr])){var u=s[vr](Du[xu]);u||(u=[],s[hr](Du[xu],u)),u[wi](a)}return o[hr](_u,a),n(a)}}catch(e){a&&a[hr]&&a[hr]("exception",e)}finally{a&&o.fire(a),o[hr](_u,s)}}}return n()}function Ru(e,t,n){return!(!e||e[xi]!==t||e===n||!e.match(/^[\da-f]*$/))}var Mu=js("plugin");function Uu(e){return Mu.get(e,"state",{},!0)}function Nu(e,t){for(var n,i=[],r=null,o=e[Gi]();o;){var a=o[Ni]();a&&(r&&Ko(r[Qi])&&Ko(a[oo])&&r[Qi](a),(Ko(a[Ai])?a[Ai]():(n=Uu(a))[Ai])||i[wi](a),r=a,o=o[Gi]())}ta(i,(function(i){var r=e[to]();i[Ti](e.getCfg(),r,t,e[Gi]()),n=Uu(i),i[to]||n[to]||(n[to]=r),n[Ai]=!0,delete n[Bi]}))}function Hu(e){return e.sort((function(e,t){var n=0;if(t){var i=Ko(t[oo]);Ko(e[oo])?n=i?e[ao]-t[ao]:1:i&&(n=-1)}else n=e?1:-1;return n}))}var Lu="TelemetryPluginChain",zu="_hasRun",Bu="_getTelCtx",Vu=0;function Wu(e,t,n,i){var r=null,o=[];null!==i&&(r=i?function(e,t,n){for(;e;){if(e[Ni]()===n)return e;e=e[Gi]()}return Gu([n],t[ki]||{},t)}(e,n,i):e);var a={_next:function(){var e=r;if(r=e?e[Gi]():null,!e){var t=o;t&&t[xi]>0&&(ta(t,(function(e){try{e.func[cr](e.self,e.args)}catch(e){us(n[Pi],2,73,"Unexpected Exception during onComplete - "+Ga(e))}})),o=[])}return e},ctx:{core:function(){return n},diagLog:function(){return function(e,t){return(e||{})[Pi]||new as(t)}(n,t)},getCfg:function(){return t},getExtCfg:s,getConfig:function(e,n,i){void 0===i&&(i=!1);var r,o=s(e,null);return o&&!zo(o[n])?r=o[n]:t&&!zo(t[n])&&(r=t[n]),zo(r)?i:r},hasNext:function(){return!!r},getNext:function(){return r},setNext:function(e){r=e},iterate:function(e){for(var t;t=a._next();){var n=t[Ni]();n&&e(n)}},onComplete:function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];e&&o[wi]({func:e,self:Lo(t)?a.ctx:t,args:n})}}};function s(e,n,i){var r;if(void 0===n&&(n={}),void 0===i&&(i=0),t){var o=t[ro];o&&e&&(r=o[e])}if(r){if(Wo(n)&&0!==i){var a=ya(!0,n,r);t&&2===i&&jo(n,(function(e){if(zo(a[e])){var n=t[e];zo(n)||(a[e]=n)}})),r=a}}else r=n;return r}return a}function Ku(e,t,n,i){var r=Wu(e,t,n,i),o=r.ctx;return o[Oi]=function(e){var t=r._next();return t&&t[oo](e,o),!t},o[Xi]=function(e,i){return void 0===e&&(e=null),Qo(e)&&(e=Gu(e,t,n,i)),Ku(e||o[Gi](),t,n,i)},o}function qu(e,t,n){var i=t[ki]||{},r=Wu(e,i,t,n),o=r.ctx;return o[Oi]=function(e){var t=r._next();return t&&t.unload(o,e),!t},o[Xi]=function(e,n){return void 0===e&&(e=null),Qo(e)&&(e=Gu(e,i,t,n)),qu(e||o[Gi](),t,n)},o}function ju(e,t,n){var i=t[ki]||{},r=Wu(e,i,t,n).ctx;return r[Oi]=function(e){return r.iterate((function(t){Ko(t[ji])&&t[ji](r,e)}))},r[Xi]=function(e,n){return void 0===e&&(e=null),Qo(e)&&(e=Gu(e,i,t,n)),ju(e||r[Gi](),t,n)},r}function Gu(e,t,n,i){var r=null,o=!i;if(Qo(e)&&e[xi]>0){var a=null;ta(e,(function(e){if(o||i!==e||(o=!0),o&&e&&Ko(e[oo])){var s=function(e,t,n){var i,r=null,o=Ko(e[oo]),a=Ko(e[Qi]),s={getPlugin:function(){return e},getNext:function(){return r},processTelemetry:function(i,c){u(c=c||function(){var i;return e&&Ko(e[Bu])&&(i=e[Bu]()),i||(i=Ku(s,t,n)),i}(),(function(t){if(!e||!o)return!1;var n=Uu(e);return!n[Bi]&&!n[io]&&(a&&e[Qi](r),e[oo](i,t),!0)}),"processTelemetry",(function(){return{item:i}}),!i.sync)||c[Oi](i)},unload:function(t,n){u(t,(function(){var i=!1;if(e){var r=Uu(e),o=e[to]||r[to];!e||o&&o!==t.core()||r[Bi]||(r[to]=null,r[Bi]=!0,r[Ai]=!1,e[Bi]&&!0===e[Bi](t,n)&&(i=!0))}return i}),"unload",(function(){}),n[Ki])||t[Oi](n)},update:function(t,n){u(t,(function(){var i=!1;if(e){var r=Uu(e),o=e[to]||r[to];!e||o&&o!==t.core()||r[Bi]||e[ji]&&!0===e[ji](t,n)&&(i=!0)}return i}),"update",(function(){}),!1)||t[Oi](n)},_id:i=e?e[Ii]+"-"+e[ao]+"-"+Vu++:"Unknown-0-"+Vu++,_setNext:function(e){r=e}};function u(t,n,o,a,s){var u=!1,c=e?e[Ii]:Lu,l=t[zu];return l||(l=t[zu]={}),t.setNext(r),e&&Fu(t[to](),(function(){return c+":"+o}),(function(){l[i]=!0;try{var e=r?r._id:Yr;e&&(l[e]=!1),u=n(t)}catch(e){var a=!r||l[r._id];a&&(u=!0),r&&a||us(t[Ji](),1,73,"Plugin ["+c+"] failed during "+o+" - "+Ga(e)+", run flags: "+Ga(l))}}),a,s),u}return ua(s)}(e,t,n);r||(r=s),a&&a._setNext(s),a=s}}))}return i&&!r?Gu([i],t,n):r}var Ju=500;function Qu(e,t,n){t&&Qo(t)&&t[xi]>0&&(ta(t=t.sort((function(e,t){return e[ao]-t[ao]})),(function(e){e[ao]<Ju&&ha("Channel has invalid priority - "+e[Ii])})),e[wi]({queue:ua(t),chain:Gu(t,n[ki],n)}))}function Xu(){var e=[];return{add:function(t){t&&e[wi](t)},run:function(t,n){ta(e,(function(e){try{e(t,n)}catch(e){us(t[Ji](),2,73,"Unexpected error calling unload handler - "+Ga(e))}})),e=[]}}}var $u="getPlugin",Zu=function(){function e(){var t,n,i,r,o,a=this;function s(e){void 0===e&&(e=null);var t=e;if(!t){var r=n||Ku(null,{},a[to]);t=i&&i[$u]?r[Xi](null,i[$u]):r[Xi](null,i)}return t}function u(e,t,r){e&&da(e,ro,[],null,zo),!r&&t&&(r=t[_i]()[Gi]());var o=i;i&&i[$u]&&(o=i[$u]()),a[to]=t,n=Ku(r,e,t,o)}function c(){t=!1,a[to]=null,n=null,i=null,o=[],r=Xu()}c(),Zr(e,a,(function(e){e[Ti]=function(e,n,i,r){u(e,n,r),t=!0},e[Bi]=function(t,n){var a,s=e[to];if(s&&(!t||s===t[to]())){var u,l=!1,d=t||qu(null,s,i&&i[$u]?i[$u]():i),f=n||((a={reason:0})[Ki]=!1,a);return e[qi]&&!0===e[qi](d,f,p)?u=!0:p(),u}function p(){if(!l){l=!0,r.run(d,n);var e=o;o=[],ta(e,(function(e){e.rm()})),!0===u&&d[Oi](f),c()}}},e[ji]=function(t,n){var r=e[to];if(r&&(!t||r===t[to]())){var o,a=!1,s=t||ju(null,r,i&&i[$u]?i[$u]():i),c=n||{reason:0};return e._doUpdate&&!0===e._doUpdate(s,c,l)?o=!0:l(),o}function l(){a||(a=!0,u(s.getCfg(),s.core(),s[Gi]()))}},e._addHook=function(e){e&&(Qo(e)?o=o.concat(e):o[wi](e))},ga(e,"_addUnloadCb",(function(){return r}),"add")})),a[Ji]=function(e){return s(e)[Ji]()},a[Ai]=function(){return t},a.setInitialized=function(e){t=e},a[Qi]=function(e){i=e},a[Oi]=function(e,t){t?t[Oi](e):i&&Ko(i[oo])&&i[oo](e,null)},a._getTelCtx=s}return e.__ieDyn=1,e}(),Yu=function(e){function t(){var n,i,r=e.call(this)||this;function o(){n=0,i=[]}return r.identifier="TelemetryInitializerPlugin",r.priority=199,o(),Zr(t,r,(function(e,t){e.addTelemetryInitializer=function(e){var t={id:n++,fn:e};return i[wi](t),{remove:function(){ta(i,(function(e,n){if(e.id===t.id)return i[zi](n,1),-1}))}}},e[oo]=function(t,n){for(var r=!1,o=i[xi],a=0;a<o;++a){var s=i[a];if(s)try{if(!1===s.fn[or](null,[t])){r=!0;break}}catch(e){us(n[Ji](),1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+la(e),{exception:Ga(e)},!0)}}r||e[Oi](t,n)},e[qi]=function(){o()}})),r}return Au(t,e),t.__ieDyn=1,t}(Zu),ec="Plugins must provide initialize method",tc="_notificationManager",nc="SDK is still unloading...",ic={loggingLevelConsole:1};function rc(e,t){return new Ou(t)}function oc(e,t){var n=!1;return ta(t,(function(t){if(t===e)return n=!0,-1})),n}var ac=function(){function e(){var t,n,i,r,o,a,s,u,c,l,d,f,p,v,h,g,m,y,S,T,C=0,b=!1;Zr(e,this,(function(e){function I(n){if(!C&&!b&&(n||e[Pi]&&e[Pi].queue[xi]>0)){var i=pa(t.diagnosticLogInterval);i&&i>0||(i=1e4),C=setInterval((function(){clearInterval(C),C=0,D()}),i)}return C}function w(){n=!1,t=ya(!0,{},ic),e[ki]=t,e[Pi]=new as(t),e[Li]=[],h=new Yu,i=[],r=null,o=null,a=null,s=null,u=null,l=null,c=[],d=null,f=null,p=null,v=!1,g=null,m=qs("AIBaseCore",!0),y=Xu(),T=null}function A(){var n=Ku(P(),t,e);return n[Ui](I),n}function k(n){var i=function(e,t,n){var i,r=[],o={};return ta(n,(function(t){(zo(t)||zo(t[Ti]))&&ha(ec);var n=t[ao],i=t[Ii];t&&n&&(zo(o[n])?o[n]=i:cs(e,"Two extensions have same priority #"+n+" - "+o[n]+", "+i)),(!n||n<500)&&r[wi](t)})),(i={all:n})[to]=r,i}(e[Pi],0,c);l=i[to],u=null;var r=i.all;if(p=ua(function(e,t,n){var i=[];if(e&&ta(e,(function(e){return Qu(i,e,n)})),t){var r=[];ta(t,(function(e){e[ao]>Ju&&r[wi](e)})),Qu(i,r,n)}return i}(f,r,e)),d){var o=na(r,d);-1!==o&&r[zi](o,1),-1!==(o=na(l,d))&&l[zi](o,1),d._setQueue(p)}else d=function(e,t){function n(){return Ku(null,t[ki],t,null)}function i(e,t,n,i){var r=e?e[xi]+1:1;function o(){0==--r&&(i&&i(),i=null)}r>0&&ta(e,(function(e){if(e&&e.queue[xi]>0){var i=e.chain,a=t[Xi](i);a[Ui](o),n(a)}else r--})),o()}var r=!1,o={identifier:"ChannelControllerPlugin",priority:Ju,initialize:function(t,n,i,o){r=!0,ta(e,(function(e){e&&e.queue[xi]>0&&Nu(Ku(e.chain,t,n),i)}))},isInitialized:function(){return r},processTelemetry:function(t,r){i(e,r||n(),(function(e){e[Oi](t)}),(function(){r[Oi](t)}))},update:function(t,n){var r=n||{reason:0};return i(e,t,(function(e){e[Oi](r)}),(function(){t[Oi](r)})),!0},pause:function(){i(e,n(),(function(e){e.iterate((function(e){e.pause&&e.pause()}))}),null)},resume:function(){i(e,n(),(function(e){e.iterate((function(e){e.resume&&e.resume()}))}),null)},teardown:function(t,n){var o=n||{reason:0,isAsync:!1};return i(e,t,(function(e){e[Oi](o)}),(function(){t[Oi](o),r=!1})),!0},getChannel:function(t){var n=null;return e&&e[xi]>0&&ta(e,(function(e){if(e&&e.queue[xi]>0&&(ta(e.queue,(function(e){if(e[Ii]===t)return n=e,-1})),n))return-1})),n},flush:function(t,r,o,a){var s=1,u=!1,c=null;function l(){s--,u&&0===s&&(c&&(clearTimeout(c),c=null),r&&r(u),r=null)}return a=a||5e3,i(e,n(),(function(e){e.iterate((function(e){if(e[Hi]){s++;var n=!1;e[Hi](t,(function(){n=!0,l()}),o)||n||(t&&null==c?c=setTimeout((function(){c=null,l()}),a):l())}}))}),(function(){u=!0,l()})),!0},_setQueue:function(t){e=t}};return o}(p,e);r[wi](d),l[wi](d),e[Li]=Hu(r),d[Ti](t,e,r),Nu(A(),r),e[Li]=ua(Hu(l||[])).slice(),n&&function(t){var n=ju(P(),e);n[Ui](I),e._updateHook&&!0===e._updateHook(n,t)||n[Oi](t)}(n)}function E(t){var n,i=null,r=null;return ta(e[Li],(function(e){if(e[Ii]===t&&e!==d&&e!==h)return r=e,-1})),!r&&d&&(r=d.getChannel(t)),r&&((n={plugin:r})[nr]=function(e){Uu(r)[io]=!e},n.isEnabled=function(){var e=Uu(r);return!e[Bi]&&!e[io]},n.remove=function(e,t){var n;void 0===e&&(e=!0);var i=[r],o=((n={reason:1})[Ki]=e,n);x(i,o,(function(e){e&&k({reason:32,removed:i}),t&&t(e)}))},i=n),i}function P(){if(!u){var n=(l||[]).slice();-1===na(n,h)&&n[wi](h),u=Gu(Hu(n),t,e)}return u}function x(n,i,r){if(n&&n[xi]>0){var o=qu(Gu(n,t,e),e);o[Ui]((function(){var e=!1,t=[];ta(c,(function(i,r){oc(i,n)?e=!0:t[wi](i)})),c=t;var i=[];f&&(ta(f,(function(t,r){var o=[];ta(t,(function(t){oc(t,n)?e=!0:o[wi](t)})),i[wi](o)})),f=i),r&&r(e),I()})),o[Oi](i)}else r(!1)}function D(){if(e[Pi]&&e[Pi].queue){var n=e[Pi].queue.slice(0);e[Pi].queue[xi]=0,ta(n,(function(n){var i,r=((i={})[Ci]=g||"InternalMessageId: "+n[Vi],i.iKey=pa(t[Ei]),i.time=ea(new Date),i.baseType=os.dataType,i.baseData={message:n[Wi]},i);e.track(r)}))}}function O(e,t,n,i){return d?d[Hi](e,t,n||6,i):(t&&t(!1),!0)}function _(t){var n=e[Pi];n?(us(n,2,73,t),I()):ha(t)}var F,R,M,U;w(),e[Ai]=function(){return n},e[Ti]=function(i,o,s,u){var l,d;v&&ha(nc),e[Ai]()&&ha("Core should not be initialized more than once"),t=i||{},e[ki]=t,zo(i[Ei])&&ha("Please provide instrumentation key"),r=u,e[tc]=u,!0===(d=pa(t.disableDbgExt))&&S&&(r[Ri](S),S=null),r&&!S&&!0!==d&&(S=ns(t),r[Fi](S)),!(l=pa(t.enablePerfMgr))&&a&&(a=null),l&&fa(t,no,rc),fa(t,ro,{}).NotificationManager=r,s&&(e[Pi]=s);var h=fa(t,"extensions",[]);(c=[])[wi].apply(c,ku(ku([],o),h)),f=fa(t,eo,[]),k(null),p&&0!==p[xi]||ha("No "+eo+" available"),n=!0,e.releaseQueue()},e.getTransmissionControls=function(){var e=[];return p&&ta(p,(function(t){e[wi](t.queue)})),ua(e)},e.track=function(n){n.iKey=n.iKey||t[Ei],n[Di]=n[Di]||ea(new Date),n.ver=n.ver||"4.0",!v&&e[Ai]()?A()[Oi](n):i[wi](n)},e[_i]=A,e[bi]=function(){return r||(r=function(){var e;return mi(((e={})[Fi]=function(e){},e[Ri]=function(e){},e[so]=function(e){},e[uo]=function(e,t){},e[co]=function(e,t){},e))}(),e[tc]=r),r},e[Fi]=function(e){r&&r[Fi](e)},e[Ri]=function(e){r&&r[Ri](e)},e.getCookieMgr=function(){return s||(s=ks(t,e[Pi])),s},e.setCookieMgr=function(e){s=e},e[vo]=function(){if(!o&&!a&&pa(t.enablePerfMgr)){var n=pa(t[no]);Ko(n)&&(a=n(e,e[bi]()))}return o||a||null},e.setPerfMgr=function(e){o=e},e.eventCnt=function(){return i[xi]},e.releaseQueue=function(){if(n&&i[xi]>0){var e=i;i=[],ta(e,(function(e){A()[Oi](e)}))}},e.pollInternalLogs=function(e){return g=e||null,b=!1,C&&(clearInterval(C),C=null),I(!0)},e[Mi]=function(){b=!0,C&&(clearInterval(C),C=0,D())},R=function(){return h},M=["addTelemetryInitializer"],(F=e)&&R&&Wo(F)&&Qo(M)&&ta(M,(function(e){Xo(e)&&ga(F,e,R,e,U)})),e.unload=function(t,i,r){var o;void 0===t&&(t=!0),n||ha("SDK is not initialized"),v&&ha(nc);var a=((o={reason:50})[Ki]=t,o.flushComplete=!1,o),s=qu(P(),e);function u(t){a.flushComplete=t,v=!0,y.run(s,a),e[Mi](),s[Oi](a)}s[Ui]((function(){w(),i&&i(a)}),e),D(),O(t,u,6,r)||u(!1)},e[Ni]=E,e.addPlugin=function(e,t,n,i){if(!e)return i&&i(!1),void _(ec);var r=E(e[Ii]);if(r&&!t)return i&&i(!1),void _("Plugin ["+e[Ii]+"] is already loaded!");var o={reason:16};function a(t){c[wi](e),o.added=[e],k(o),i&&i(!0)}if(r){var s=[r.plugin];x(s,{reason:2,isAsync:!!n},(function(e){e?(o.removed=s,o.reason|=32,a()):i&&i(!1)}))}else a()},e.evtNamespace=function(){return m},e[Hi]=O,e.getTraceCtx=function(e){var t;return T||(t={},T={getName:function(){return t[Ci]},setName:function(e){t[Ci]=e},getTraceId:function(){return t[mr]},setTraceId:function(e){Ru(e,32,"00000000000000000000000000000000")&&(t[mr]=e)},getSpanId:function(){return t[yr]},setSpanId:function(e){Ru(e,16,"0000000000000000")&&(t[yr]=e)},getTraceFlags:function(){return t[Sr]},setTraceFlags:function(e){t[Sr]=e}}),T},e.setTraceCtx=function(e){T=e||null},ga(e,"addUnloadCb",(function(){return y}),"add")}))}return e.__ieDyn=1,e}();function sc(e,t,n,i){ta(e,(function(e){if(e&&e[t])if(n)setTimeout((function(){return i(e)}),0);else try{i(e)}catch(e){}}))}var uc,cc=function(){function e(t){this.listeners=[];var n=!!(t||{}).perfEvtsSendAll;Zr(e,this,(function(e){e[Fi]=function(t){e.listeners[wi](t)},e[Ri]=function(t){for(var n=na(e[fr],t);n>-1;)e.listeners[zi](n,1),n=na(e[fr],t)},e[so]=function(t){sc(e[fr],so,!0,(function(e){e[so](t)}))},e[uo]=function(t,n){sc(e[fr],uo,!0,(function(e){e[uo](t,n)}))},e[co]=function(t,n){sc(e[fr],co,n,(function(e){e[co](t,n)}))},e[lo]=function(t){t&&(!n&&t[pr]()||sc(e[fr],lo,!1,(function(e){t[Ki]?setTimeout((function(){return e[lo](t)}),0):e[lo](t)})))}}))}return e.__ieDyn=1,e}(),lc=function(e){function t(){var n=e.call(this)||this;return Zr(t,n,(function(e,t){function n(t){var n=e[bi]();n&&n[uo]([t],2)}e[Ti]=function(e,n,i,r){t[Ti](e,n,i||new as(e),r||new cc(e))},e.track=function(i){Fu(e[vo](),(function(){return"AppInsightsCore:track"}),(function(){null===i&&(n(i),ha("Invalid telemetry item")),function(e){zo(e[Ci])&&(n(e),ha("telemetry name required"))}(i),t.track(i)}),(function(){return{item:i}}),!i.sync)}})),n}return Au(t,e),t.__ieDyn=1,t}(ac),dc="",fc="version",pc="properties",vc="1DS-Web-JS-3.2.12",hc="withCredentials",gc=((uc={})[0]=0,uc[2]=6,uc[1]=1,uc[3]=7,uc[4098]=6,uc[4097]=1,uc[4099]=7,uc);function mc(e){return!(e===dc||zo(e))}function yc(e,t,n){var i=-1;if(!Lo(e))if(t>0&&(32===t?i=8192:t<=13&&(i=t<<5)),function(e){return e>=0&&e<=9}(n))-1===i&&(i=0),i|=n;else{var r=gc[bc(e)]||-1;-1!==i&&-1!==r?i|=r:6===r&&(i=r)}return i}function Sc(e,t,n,i,r){var o={},a=!1,s=0,u=arguments.length,c=arguments;for("[object Boolean]"===Object[ai].toString.call(c[0])&&(a=c[0],s++);s<u;s++)jo(c[s],(function(e,t){a&&t&&Wo(t)?Qo(t)?(o[e]=o[e]||[],ta(t,(function(t,n){t&&Wo(t)?o[e][n]=Sc(!0,o[e][n],t):o[e][n]=t}))):o[e]=Sc(!0,o[e],t):o[e]=t}));return o}Boolean(La()),Boolean(Ha());var Tc=function(){var e=Ua(Ia);return e&&e.now?e.now():ca()};function Cc(e,t){var n=e;n.timings=n.timings||{},n.timings.processTelemetryStart=n.timings.processTelemetryStart||{},n.timings.processTelemetryStart[t]=Tc()}function bc(e){var t=0;if(null!=e){var n=typeof e;"string"===n?t=1:"number"===n?t=2:"boolean"===n?t=3:n===ri&&(t=4,Qo(e)?(t=4096,e.length>0&&(t|=bc(e[0]))):pi.call(e,"value")&&(t=8192|bc(e.value)))}return t}var Ic=function(e){function t(){var n=e.call(this)||this;return n.pluginVersionStringArr=[],Zr(t,n,(function(e,t){e.logger&&e.logger.queue||(e.logger=new as({loggingLevelConsole:1})),e.initialize=function(n,i,r,o){Fu(e,(function(){return"AppInsightsCore.initialize"}),(function(){var a=e.pluginVersionStringArr;if(n){n.endpointUrl||(n.endpointUrl="https://browser.events.data.microsoft.com/OneCollector/1.0/");var s=n.propertyStorageOverride;!s||s.getProperty&&s.setProperty||ha("Invalid property storage override passed."),n.channels&&ta(n.channels,(function(e){e&&ta(e,(function(e){if(e.identifier&&e.version){var t=e.identifier+"="+e.version;a.push(t)}}))}))}e.getWParam=function(){return"undefined"!=typeof document||n.enableWParam?0:-1},i&&ta(i,(function(e){if(e&&e.identifier&&e.version){var t=e.identifier+"="+e.version;a.push(t)}})),e.pluginVersionString=a.join(";"),e.pluginVersionStringArr=a;try{t.initialize(n,i,r,o),e.pollInternalLogs("InternalLog")}catch(t){var u=e.logger,c=Ga(t);-1!==c.indexOf("channels")&&(c+="\n - Channels must be provided through config.channels only!"),us(u,1,514,"SDK Initialization Failed - no telemetry will be sent: "+c)}}),(function(){return{config:n,extensions:i,logger:r,notificationManager:o}}))},e.track=function(n){Fu(e,(function(){return"AppInsightsCore.track"}),(function(){var i,r=n;if(r){r.timings=r.timings||{},r.timings.trackStart=Tc(),(i=r.latency)&&$o(i)&&i>=1&&i<=4||(r.latency=1);var o=r.ext=r.ext||{};o.sdk=o.sdk||{},o.sdk.ver=vc;var a=r.baseData=r.baseData||{};a[pc]=a[pc]||{};var s=a[pc];s[fc]=s[fc]||e.pluginVersionString||dc}t.track(r)}),(function(){return{item:n}}),!n.sync)}})),n}return Au(t,e),t.__ieDyn=1,t}(lc);const wc=Ic;var Ac,kc,Ec=(kc={},jo({Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5},(function(e,t){kc[e]=t,kc[t]=e})),Ac=kc,wo&&jo(Ac,(function(e,t){(Qo(t)||Wo(t))&&wo(t)})),ua(Ac)),Pc="REAL_TIME",xc="",Dc="POST",Oc="drop",_c="requeue",Fc="application/x-json-stream",Rc="cache-control",Mc="content-type",Uc="kill-duration",Nc="time-delta-millis",Hc="client-version",Lc="client-id",zc="time-delta-to-apply-millis",Bc="upload-time",Vc="apikey",Wc="AuthMsaDeviceTicket",Kc="AuthXToken",qc="msfpc",jc="trace",Gc="user";function Jc(e){var t=(e.ext||{}).intweb;return t&&mc(t[qc])?t[qc]:null}function Qc(e){for(var t=null,n=0;null===t&&n<e.length;n++)t=Jc(e[n]);return t}var Xc=function(){function e(t,n){var i=n?[].concat(n):[],r=this,o=Qc(i);r.iKey=function(){return t},r.Msfpc=function(){return o||xc},r.count=function(){return i.length},r.events=function(){return i},r.addEvent=function(e){return!!e&&(i.push(e),o||(o=Jc(e)),!0)},r.split=function(n,r){var a;if(n<i.length){var s=i.length-n;zo(r)||(s=r<s?r:s),a=i.splice(n,s),o=Qc(i)}return new e(t,a)}}return e.create=function(t,n){return new e(t,n)},e}();const $c=function(){function e(){var t=!0,n=!0,i=!0,r="use-collector-delta",o=!1;Zr(e,this,(function(e){e.allowRequestSending=function(){return t},e.firstRequestSent=function(){i&&(i=!1,o||(t=!1))},e.shouldAddClockSkewHeaders=function(){return n},e.getClockSkewHeaderValue=function(){return r},e.setClockSkew=function(e){o||(e?(r=e,n=!0,o=!0):n=!1,t=!0)}}))}return e.__ieDyn=1,e}();var Zc=function(){function e(){var t={};Zr(e,this,(function(e){e.setKillSwitchTenants=function(e,n){if(e&&n)try{var i=function(e){var t=[];return e&&ta(e,(function(e){t.push(ia(e))})),t}(e.split(","));if("this-request-only"===n)return i;for(var r=1e3*parseInt(n,10),o=0;o<i.length;++o)t[i[o]]=ca()+r}catch(e){return[]}return[]},e.isTenantKilled=function(e){var n=t,i=ia(e);return void 0!==n[i]&&n[i]>ca()||(delete n[i],!1)}}))}return e.__ieDyn=1,e}();const Yc=Zc;function el(e){var t,n=Math.floor(1200*Math.random())+2400;return t=Math.pow(2,e)*n,Math.min(t,6e5)}var tl,nl=2e6,il=Math.min(nl,65e3),rl="metadata",ol="f",al=/\./,sl=function(){function e(t,n,i,r){var o="data",a="baseData",s=!!r,u=n,c={};Zr(e,this,(function(e){function n(e,t,r,o,a,l,d){jo(e,(function(e,f){var p=null;if(f||mc(f)){var v=r,h=e,g=a,m=t;if(s&&!o&&al.test(e)){var y=e.split("."),S=y.length;if(S>1){g&&(g=g.slice());for(var T=0;T<S-1;T++){var C=y[T];m=m[C]=m[C]||{},v+="."+C,g&&g.push(C)}h=y[S-1]}}var b=o&&function(e,t){var n=c[e];return void 0===n&&(e.length>=7&&(n=Go(e,"ext.metadata")||Go(e,"ext.web")),c[e]=n),n}(v);if(p=!b&&u&&u.handleField(v,h)?u.value(v,h,f,i):function(e,t,n){if(!t&&!mc(t)||"string"!=typeof e)return null;var i=typeof t;if("string"===i||"number"===i||"boolean"===i||Qo(t))t={value:t};else if("object"!==i||pi.call(t,"value")){if(zo(t.value)||t.value===dc||!Xo(t.value)&&!$o(t.value)&&!Zo(t.value)&&!Qo(t.value))return null}else t={value:n?JSON.stringify(t):t};if(Qo(t.value)&&!(t.value.length>0))return null;if(!zo(t.kind)){if(Qo(t.value)||!(0===(r=t.kind)||r>0&&r<=13||32===r))return null;t.value=t.value.toString()}var r;return t}(h,f,i)){var I=p.value;if(m[h]=I,l&&l(g,h,p),d&&"object"==typeof I&&!Qo(I)){var w=g;w&&(w=w.slice()).push(h),n(f,I,v+"."+h,o,w,l,d)}}}}))}e.createPayload=function(e,t,n,i,r,o){return{apiKeys:[],payloadBlob:xc,overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:e,isTeardown:t,isSync:n,isBeacon:i,sendType:o,sendReason:r}},e.appendPayload=function(n,i,r){var o=n&&i&&!n.overflow;return o&&Fu(t,(function(){return"Serializer:appendPayload"}),(function(){for(var t=i.events(),o=n.payloadBlob,a=n.numEvents,s=!1,u=[],c=[],l=n.isBeacon,d=l?65e3:3984588,f=l?il:nl,p=0,v=0;p<t.length;){var h=t[p];if(h){if(a>=r){n.overflow=i.split(p);break}var g=e.getEventBlob(h);if(g&&g.length<=f){var m=g.length;if(o.length+m>d){n.overflow=i.split(p);break}o&&(o+="\n"),o+=g,++v>20&&(o.substr(0,1),v=0),s=!0,a++}else g?u.push(h):c.push(h),t.splice(p,1),p--}p++}if(u&&u.length>0&&n.sizeExceed.push(Xc.create(i.iKey(),u)),c&&c.length>0&&n.failedEvts.push(Xc.create(i.iKey(),c)),s){n.batches.push(i),n.payloadBlob=o,n.numEvents=a;var y=i.iKey();-1===na(n.apiKeys,y)&&n.apiKeys.push(y)}}),(function(){return{payload:n,theBatch:{iKey:i.iKey(),evts:i.events()},max:r}})),o},e.getEventBlob=function(e){try{return Fu(t,(function(){return"Serializer.getEventBlob"}),(function(){var t={};t.name=e.name,t.time=e.time,t.ver=e.ver,t.iKey="o:"+function(e){if(e){var t=e.indexOf("-");if(t>-1)return e.substring(0,t)}return dc}(e.iKey);var i={},r=e.ext;r&&(t.ext=i,jo(r,(function(e,t){n(t,i[e]={},"ext."+e,!0,null,null,!0)})));var s=t[o]={};s.baseType=e.baseType;var u=s[a]={};return n(e.baseData,u,a,!1,[a],(function(e,t,n){ul(i,e,t,n)}),!0),n(e.data,s,o,!1,[],(function(e,t,n){ul(i,e,t,n)}),!0),JSON.stringify(t)}),(function(){return{item:e}}))}catch(e){return null}}}))}return e.__ieDyn=1,e}();function ul(e,t,n,i){if(i&&e){var r=yc(i.value,i.kind,i.propertyType);if(r>-1){var o=e[rl];o||(o=e[rl]={f:{}});var a=o[ol];if(a||(a=o[ol]={}),t)for(var s=0;s<t.length;s++){var u=t[s];a[u]||(a[u]={f:{}});var c=a[u][ol];c||(c=a[u][ol]={}),a=c}a=a[n]={},Qo(i.value)?a.a={t:r}:a.t=r}}}var cl="sendAttempt",ll="&NoResponseBody=true",dl=((tl={})[1]=_c,tl[100]=_c,tl[200]="sent",tl[8004]=Oc,tl[8003]=Oc,tl),fl={},pl={};function vl(e,t,n){fl[e]=t,!1!==n&&(pl[t]=e)}function hl(e){try{return e.responseText}catch(e){}return xc}function gl(e,t){var n=!1;if(e&&t){var i=aa(e);if(i&&i.length>0)for(var r=t.toLowerCase(),o=0;o<i.length;o++){var a=i[o];if(a&&Vo(t,a)&&a.toLowerCase()===r){n=!0;break}}}return n}function ml(e,t,n,i){t&&n&&n.length>0&&(i&&fl[t]?(e.hdrs[fl[t]]=n,e.useHdrs=!0):e.url+="&"+t+"="+n)}function yl(e,t){return t&&($o(t)?e=[t].concat(e):Qo(t)&&(e=t.concat(e))),e}vl(Wc,Wc,!1),vl(Hc,Hc),vl(Lc,"Client-Id"),vl(Vc,Vc),vl(zc,zc),vl(Bc,Bc),vl(Kc,Kc);var Sl=function(){function e(t,n,i,r,o){this._responseHandlers=[];var a,s,u,c,l,d,f,p,v,h,g="?cors=true&"+Mc.toLowerCase()+"="+Fc,m=new Yc,y=!1,S=new $c,T=!1,C=0,b=!0,I=[],w={},A=[],k=null,E=!1,P=!1,x=!1;Zr(e,this,(function(e){var D=!0;function O(e,t){for(var n=0,i=null,r=0;null==i&&r<e.length;)1===(n=e[r])?(null===Fa&&(Fa=typeof XDomainRequest!==oi)&&Xa()&&(Fa=Fa&&!Ma(Ua(xa),"withCredentials")),Fa?i=_:Xa()&&(i=R)):2===n&&Qa(t)&&(!t||t&&!p)?i=F:T&&3===n&&Ja()&&(i=U),r++;return i?{_transport:n,_isSync:t,sendPOST:i}:null}function _(e,t,n){var i=new XDomainRequest;i.open(Dc,e.urlString),e.timeout&&(i.timeout=e.timeout),i.onload=function(){var e=hl(i);M(t,200,{},e),G(e)},i.onerror=function(){M(t,400,{})},i.ontimeout=function(){M(t,500,{})},i.onprogress=function(){},n?i.send(e.data):o.set((function(){i.send(e.data)}),0)}function F(e,t,n){var i,r=e.urlString,a=!1,s=!1,u=((i={body:e.data,method:Dc}).Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0,i);n&&(u.keepalive=!0,2===e._sendReason&&(a=!0,h&&(r+=ll))),D&&(u.credentials="include"),e.headers&&aa(e.headers).length>0&&(u.headers=e.headers),fetch(r,u).then((function(e){var n={},i=xc,r=e.headers;r&&r.forEach((function(e,t){n[t]=e})),e.body&&e.text().then((function(e){i=e})),s||(s=!0,M(t,e.status,n,i),G(i))})).catch((function(e){s||(s=!0,M(t,0,{}))})),a&&!s&&(s=!0,M(t,200,{})),!s&&e.timeout>0&&o.set((function(){s||(s=!0,M(t,500,{}))}),e.timeout)}function R(e,t,n){var i=e.urlString;function r(e,t,n){if(!e[n]&&t&&t.getResponseHeader){var i=t.getResponseHeader(n);i&&(e[n]=ia(i))}return e}function o(e,n){M(t,e.status,function(e){var t,n,i={};return e.getAllResponseHeaders?(t=e.getAllResponseHeaders(),n={},Xo(t)&&ta(ia(t).split(/[\r\n]+/),(function(e){if(e){var t=e.indexOf(": ");if(-1!==t){var i=ia(e.substring(0,t)).toLowerCase(),r=ia(e.substring(t+1));n[i]=r}else n[ia(e)]=1}})),i=n):(i=r(i,e,Nc),i=r(i,e,Uc),i=r(i,e,"kill-duration-seconds")),i}(e),n)}n&&e.disableXhrSync&&(n=!1);var a=function(e,t,n,i,r,o){function a(e,t,n){try{e[t]=n}catch(e){}}void 0===i&&(i=!1),void 0===r&&(r=!1);var s=new XMLHttpRequest;return i&&a(s,"Microsoft_ApplicationInsights_BypassAjaxInstrumentation",i),n&&a(s,hc,n),s.open(e,t,!r),n&&a(s,hc,n),!r&&o&&a(s,"timeout",o),s}(Dc,i,D,!0,n,e.timeout);jo(e.headers,(function(e,t){a.setRequestHeader(e,t)})),a.onload=function(){var e=hl(a);o(a,e),G(e)},a.onerror=function(){o(a)},a.ontimeout=function(){o(a)},a.send(e.data)}function M(e,t,n,i){try{e(t,n,i)}catch(e){us(s,2,518,Ga(e))}}function U(e,t,n){var i=200,r=e._thePayload,o=e.urlString+(h?ll:xc);try{var a=Ba();if(!a.sendBeacon(o,e.data))if(r){var u=[];ta(r.batches,(function(e){if(u&&e&&e.count()>0){for(var t=e.events(),n=0;n<t.length;n++)if(!a.sendBeacon(o,k.getEventBlob(t[n]))){u.push(e.split(n));break}}else u.push(e.split(0))})),J(u,8003,r.sendType,!0)}else i=0}catch(e){cs(s,"Failed to send telemetry using sendBeacon API. Ex:"+Ga(e)),i=0}finally{M(t,i,{},xc)}}function N(e){return 2===e||3===e}function H(e){return P&&N(e)&&(e=2),e}function L(){return!y&&C<n}function z(){var e=A;return A=[],e}function B(e,t,n){var i=!1;return e&&e.length>0&&!y&&u[t]&&k&&(i=0!==t||L()&&(n>0||S.allowRequestSending())),i}function V(e){var t={};return e&&ta(e,(function(e,n){t[n]={iKey:e.iKey(),evts:e.events()}})),t}function W(e,n,i,r,o){if(e&&0!==e.length)if(y)J(e,1,r);else{r=H(r);try{var a=e,l=0!==r;Fu(c,(function(){return"HttpManager:_sendBatches"}),(function(a){a&&(e=e.slice(0));for(var s=[],c=null,d=Tc(),f=u[r]||(l?u[1]:u[0]),p=f&&f._transport,h=v&&(P||N(r)||3===p||f._isSync&&2===p);B(e,r,n);){var g=e.shift();g&&g.count()>0&&(m.isTenantKilled(g.iKey())?s.push(g):(c=c||k.createPayload(n,i,l,h,o,r),k.appendPayload(c,g,t)?null!==c.overflow&&(e=[c.overflow].concat(e),c.overflow=null,q(c,d,Tc(),o),d=Tc(),c=null):(q(c,d,Tc(),o),d=Tc(),e=[g].concat(e),c=null)))}c&&q(c,d,Tc(),o),e.length>0&&(A=e.concat(A)),J(s,8004,r)}),(function(){return{batches:V(a),retryCount:n,isTeardown:i,isSynchronous:l,sendReason:o,useSendBeacon:N(r),sendType:r}}),!l)}catch(e){us(s,2,48,"Unexpected Exception sending batch: "+Ga(e))}}}function K(e,t,n){e[t]=e[t]||{},e[t][a.identifier]=n}function q(t,n,r,o){if(t&&t.payloadBlob&&t.payloadBlob.length>0){var l=!!e.sendHook,v=u[t.sendType];!N(t.sendType)&&t.isBeacon&&2===t.sendReason&&(v=u[2]||u[3]||v);var h=x;(t.isBeacon||3===v._transport)&&(h=!1);var y=function(e,t){var n={url:g,hdrs:{},useHdrs:!1};t?(n.hdrs=Sc(n.hdrs,w),n.useHdrs=aa(n.hdrs).length>0):jo(w,(function(e,t){pl[e]?ml(n,pl[e],t,!1):(n.hdrs[e]=t,n.useHdrs=!0)})),ml(n,Lc,"NO_AUTH",t),ml(n,Hc,vc,t);var i=xc;ta(e.apiKeys,(function(e){i.length>0&&(i+=","),i+=e})),ml(n,Vc,i,t),ml(n,Bc,ca().toString(),t);var r=function(e){for(var t=0;t<e.batches.length;t++){var n=e.batches[t].Msfpc();if(n)return encodeURIComponent(n)}return xc}(e);if(mc(r)&&(n.url+="&ext.intweb.msfpc="+r),S.shouldAddClockSkewHeaders()&&ml(n,zc,S.getClockSkewHeaderValue(),t),c.getWParam){var o=c.getWParam();o>=0&&(n.url+="&w="+o)}for(var a=0;a<I.length;a++)n.url+="&"+I[a].name+"="+I[a].value;return n}(t,h);h=h||y.useHdrs;var T=Tc();Fu(c,(function(){return"HttpManager:_doPayloadSend"}),(function(){for(var u=0;u<t.batches.length;u++)for(var g=t.batches[u].events(),I=0;I<g.length;I++){var w=g[I];if(E){var A=w.timings=w.timings||{};K(A,"sendEventStart",T),K(A,"serializationStart",n),K(A,"serializationCompleted",r)}w[cl]>0?w[cl]++:w[cl]=1}J(t.batches,1e3+(o||0),t.sendType,!0);var k={data:t.payloadBlob,urlString:y.url,headers:y.hdrs,_thePayload:t,_sendReason:o,timeout:d,disableXhrSync:f,disableFetchKeepAlive:p};h&&(gl(k.headers,Rc)||(k.headers[Rc]="no-cache, no-store"),gl(k.headers,Mc)||(k.headers[Mc]=Fc));var x=null;v&&(x=function(n){S.firstRequestSent();var r=function(n,r){!function(t,n,r,o){var s,u=9e3,c=null,l=!1,d=!1;try{var f=!0;if(typeof t!==oi){if(n){S.setClockSkew(n[Nc]);var p=n[Uc]||n["kill-duration-seconds"];ta(m.setKillSwitchTenants(n["kill-tokens"],p),(function(e){ta(r.batches,(function(t){if(t.iKey()===e){c=c||[];var n=t.split(0);r.numEvents-=n.count(),c.push(n)}}))}))}if(200==t||204==t)return void(u=200);((s=t)>=300&&s<500&&408!=s&&429!=s||501==s||505==s||r.numEvents<=0)&&(f=!1),u=9e3+t%1e3}if(f){u=100;var v=r.retryCnt;0===r.sendType&&(v<i?(l=!0,j((function(){0===r.sendType&&C--,W(r.batches,v+1,r.isTeardown,P?2:r.sendType,5)}),P,el(v))):(d=!0,P&&(u=8001)))}}finally{l||(S.setClockSkew(),function(t,n,i,r){try{r&&a._backOffTransmission(),200===n&&(r||t.isSync||a._clearBackOff(),function(e){if(E){var t=Tc();ta(e,(function(e){e&&e.count()>0&&function(e,t){E&&ta(e,(function(e){K(e.timings=e.timings||{},"sendEventCompleted",t)}))}(e.events(),t)}))}}(t.batches)),J(t.batches,n,t.sendType,!0)}finally{0===t.sendType&&(C--,5!==i&&e.sendQueuedRequests(t.sendType,i))}}(r,u,o,d)),J(c,8004,r.sendType)}}(n,r,t,o)},u=t.isTeardown||t.isSync;try{v.sendPOST(n,r,u),e.sendListener&&e.sendListener(k,n,u,t.isBeacon)}catch(e){cs(s,"Unexpected exception sending payload. Ex:"+Ga(e)),M(r,0,{})}}),Fu(c,(function(){return"HttpManager:_doPayloadSend.sender"}),(function(){if(x)if(0===t.sendType&&C++,l&&!t.isBeacon&&3!==v._transport){var n={data:k.data,urlString:k.urlString,headers:Sc({},k.headers),timeout:k.timeout,disableXhrSync:k.disableXhrSync,disableFetchKeepAlive:k.disableFetchKeepAlive},i=!1;Fu(c,(function(){return"HttpManager:_doPayloadSend.sendHook"}),(function(){try{e.sendHook(n,(function(e){i=!0,b||e._thePayload||(e._thePayload=e._thePayload||k._thePayload,e._sendReason=e._sendReason||k._sendReason),x(e)}),t.isSync||t.isTeardown)}catch(e){i||x(k)}}))}else x(k)}))}),(function(){return{thePayload:t,serializationStart:n,serializationCompleted:r,sendReason:o}}),t.isSync)}t.sizeExceed&&t.sizeExceed.length>0&&J(t.sizeExceed,8003,t.sendType),t.failedEvts&&t.failedEvts.length>0&&J(t.failedEvts,8002,t.sendType)}function j(e,t,n){t?e():o.set(e,n)}function G(t){var n=e._responseHandlers;try{for(var i=0;i<n.length;i++)try{n[i](t)}catch(e){us(s,1,519,"Response handler failed: "+e)}if(t){var r=JSON.parse(t);mc(r.webResult)&&mc(r.webResult[qc])&&l.set("MSFPC",r.webResult[qc],31536e3)}}catch(e){}}function J(e,t,n,i){if(e&&e.length>0&&r){var o=r[(u=t,l=dl[u],mc(l)||(l="oth",u>=9e3&&u<=9999?l="rspFail":u>=8e3&&u<=8999?l=Oc:u>=1e3&&u<=1999&&(l="send")),l)];if(o){var a=0!==n;Fu(c,(function(){return"HttpManager:_sendBatchesNotification"}),(function(){j((function(){try{o.call(r,e,t,a,n)}catch(e){us(s,1,74,"send request notification failed: "+e)}}),i||a,0)}),(function(){return{batches:V(e),reason:t,isSync:a,sendSync:i,sendType:n}}),!a)}}var u,l}e.initialize=function(e,t,n,i,r){var o;r||(r={}),g=e+g,x=!!Lo(r.avoidOptions)||!r.avoidOptions,c=t,l=t.getCookieMgr(),E=!c.config.disableEventTimings;var m=!!c.config.enableCompoundKey;s=(a=n).diagLog();var y=r.valueSanitizer,S=r.stringifyObjects;Lo(r.enableCompoundKey)||(m=!!r.enableCompoundKey),d=r.xhrTimeout,f=!!r.disableXhrSync,p=!!r.disableFetchKeepAlive,h=!1!==r.addNoResponse,T=!qa(),k=new sl(c,y,S,m),zo(r.useSendBeacon)||(T=!!r.useSendBeacon);var C=i,I=r.alwaysUseXhrOverride?i:null,w=r.alwaysUseXhrOverride?i:null,A=[3,2];if(!i){b=!1;var P=Va();P&&P.protocol&&"file:"===P.protocol.toLowerCase()&&(D=!1);var _=[];qa()?(_=[2,1],A=[2,1,3]):_=[1,2,3],(i=O(_=yl(_,r.transports),!1))||cs(s,"No available transport to send events"),C=O(_,!0)}I||(I=O(A=yl(A,r.unloadTransports),!0)),v=!b&&(T&&Ja()||!p&&Qa(!0)),(o={})[0]=i,o[1]=C||O([1,2,3],!0),o[2]=I||C||O([1],!0),o[3]=w||O([2,3],!0)||C||O([1],!0),u=o},e._getDbgPlgTargets=function(){return[u[0],m,k,u]},e.addQueryStringParameter=function(e,t){for(var n=0;n<I.length;n++)if(I[n].name===e)return void(I[n].value=t);I.push({name:e,value:t})},e.addHeader=function(e,t){w[e]=t},e.canSendRequest=function(){return L()&&S.allowRequestSending()},e.sendQueuedRequests=function(e,t){Lo(e)&&(e=0),P&&(e=H(e),t=2),B(A,e,0)&&W(z(),0,!1,e,t||0)},e.isCompletelyIdle=function(){return!y&&0===C&&0===A.length},e.setUnloading=function(e){P=e},e.addBatch=function(e){if(e&&e.count()>0){if(m.isTenantKilled(e.iKey()))return!1;A.push(e)}return!0},e.teardown=function(){A.length>0&&W(z(),0,!0,2,2)},e.pause=function(){y=!0},e.resume=function(){y=!1,e.sendQueuedRequests(0,4)},e.sendSynchronousBatch=function(e,t,n){e&&e.count()>0&&(zo(t)&&(t=1),P&&(t=H(t),n=2),W([e],0,!1,t,n||0))}}))}return e.__ieDyn=1,e}();function Tl(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return setTimeout(e,t,n)}function Cl(e){clearTimeout(e)}function bl(e,t){return{set:e||Tl,clear:t||Cl}}var Il="eventsDiscarded",wl="overrideInstrumentationKey",Al="maxEventRetryAttempts",kl="maxUnloadEventRetryAttempts";const El=function(e){function t(){var n,i=e.call(this)||this;i.identifier="PostChannel",i.priority=1011,i.version="3.2.12";var r,o,a,s,u,c,l,d=!1,f=[],p=null,v=!1,h=0,g=500,m=0,y=1e4,S={},T=Pc,C=null,b=null,I=0,w=0,A={},k=-1,E=!0,P=!1,x=6,D=2;return Zr(t,i,(function(e,t){function i(e){"beforeunload"!==(e||Ha().event).type&&(P=!0,o.setUnloading(P)),L(2,2)}function O(e){P=!1,o.setUnloading(P)}function _(e,t){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=1),e.ext&&e.ext[jc]&&delete e.ext[jc],e.ext&&e.ext[Gc]&&e.ext[Gc].id&&delete e.ext[Gc].id,E&&(e.ext=ma(e.ext),e.baseData&&(e.baseData=ma(e.baseData)),e.data&&(e.data=ma(e.data))),e.sync)if(I||v)e.latency=3,e.sync=!1;else if(o)return E&&(e=ma(e)),void o.sendSynchronousBatch(Xc.create(e.iKey,[e]),!0===e.sync?1:e.sync,3);var n=e.latency,i=m,r=y;4===n&&(i=h,r=g);var a=!1;if(i<r)a=!V(e,t);else{var s=1,u=20;4===n&&(s=4,u=1),a=!0,function(e,t,n,i){for(;n<=t;){var r=z(e,t,!0);if(r&&r.count()>0){var o=r.split(0,i),a=o.count();if(a>0)return 4===n?h-=a:m-=a,$(Il,[o],Ec.QueueFull),!0}n++}return W(),!1}(e.iKey,e.latency,s,u)&&(a=!V(e,t))}a&&X(Il,[e],Ec.QueueFull)}function F(e,t,n){var i=K(e,t,n);return o.sendQueuedRequests(t,n),i}function R(){return m>0}function M(){if(k>=0&&K(k,0,u)&&o.sendQueuedRequests(0,u),h>0&&!b&&!v){var e=S[T][2];e>=0&&(b=N((function(){b=null,F(4,0,1),M()}),e))}var t=S[T][1];!C&&!p&&t>=0&&!v&&(R()?C=N((function(){C=null,F(0===w?3:1,0,1),w++,w%=2,M()}),t):w=0)}function U(){n=null,d=!1,f=[],p=null,v=!1,h=0,g=500,m=0,y=1e4,S={},T=Pc,C=null,b=null,I=0,w=0,r=null,A={},a=void 0,s=0,k=-1,u=null,E=!0,P=!1,x=6,D=2,c=null,l=bl(),o=new Sl(500,2,1,{requeue:J,send:Z,sent:Y,drop:ee,rspFail:te,oth:ne},l),G(),A[4]={batches:[],iKeyMap:{}},A[3]={batches:[],iKeyMap:{}},A[2]={batches:[],iKeyMap:{}},A[1]={batches:[],iKeyMap:{}},ie()}function N(e,t){0===t&&I&&(t=1);var n=1e3;return I&&(n=el(I-1)),l.set(e,t*n)}function H(){return null!==C&&(l.clear(C),C=null,w=0,!0)}function L(e,t){H(),p&&(l.clear(p),p=null),v||F(1,e,t)}function z(e,t,n){var i=A[t];i||(i=A[t=1]);var r=i.iKeyMap[e];return!r&&n&&(r=Xc.create(e),i.batches.push(r),i.iKeyMap[e]=r),r}function B(t,n){o.canSendRequest()&&!I&&(a>0&&m>a&&(n=!0),n&&null==p&&e.flush(t,null,20))}function V(e,t){E&&(e=ma(e));var n=e.latency,i=z(e.iKey,n,!0);return!!i.addEvent(e)&&(4!==n?(m++,t&&0===e.sendAttempt&&B(!e.sync,s>0&&i.count()>=s)):h++,!0)}function W(){for(var e=0,t=0,n=function(n){var i=A[n];i&&i.batches&&ta(i.batches,(function(i){4===n?e+=i.count():t+=i.count()}))},i=1;i<=4;i++)n(i);m=t,h=e}function K(t,n,i){var r=!1,a=0===n;return!a||o.canSendRequest()?Fu(e.core,(function(){return"PostChannel._queueBatches"}),(function(){for(var e=[],n=4;n>=t;){var i=A[n];i&&i.batches&&i.batches.length>0&&(ta(i.batches,(function(t){o.addBatch(t)?r=r||t&&t.count()>0:e=e.concat(t.events()),4===n?h-=t.count():m-=t.count()})),i.batches=[],i.iKeyMap={}),n--}e.length>0&&X(Il,e,Ec.KillSwitch),r&&k>=t&&(k=-1,u=0)}),(function(){return{latency:t,sendType:n,sendReason:i}}),!a):(k=k>=0?Math.min(k,t):t,u=Math.max(u,i)),r}function q(e,t){F(1,0,t),W(),j((function(){e&&e(),f.length>0?p=N((function(){p=null,q(f.shift(),t)}),0):(p=null,M())}))}function j(e){o.isCompletelyIdle()?e():p=N((function(){p=null,j(e)}),.25)}function G(){(S={})[Pc]=[2,1,0],S.NEAR_REAL_TIME=[6,3,0],S.BEST_EFFORT=[18,9,0]}function J(t,n){var i=[],r=x;P&&(r=D),ta(t,(function(t){t&&t.count()>0&&ta(t.events(),(function(t){t&&(t.sync&&(t.latency=4,t.sync=!1),t.sendAttempt<r?(Cc(t,e.identifier),_(t,!1)):i.push(t))}))})),i.length>0&&X(Il,i,Ec.NonRetryableStatus),P&&L(2,2)}function Q(t,n){var i=e._notificationManager||{},r=i[t];if(r)try{r.apply(i,n)}catch(n){us(e.diagLog(),1,74,t+" notification failed: "+n)}}function X(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];t&&t.length>0&&Q(e,[t].concat(n))}function $(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];t&&t.length>0&&ta(t,(function(t){t&&t.count()>0&&Q(e,[t.events()].concat(n))}))}function Z(e,t,n){e&&e.length>0&&Q("eventsSendRequest",[t>=1e3&&t<=1999?t-1e3:0,!0!==n])}function Y(e,t){$("eventsSent",e,t),M()}function ee(e,t){$(Il,e,t>=8e3&&t<=8999?t-8e3:Ec.Unknown)}function te(e){$(Il,e,Ec.NonRetryableStatus),M()}function ne(e,t){$(Il,e,Ec.Unknown),M()}function ie(){s=n&&n.disableAutoBatchFlushLimit?0:Math.max(1500,y/6)}U(),e._getDbgPlgTargets=function(){return[o]},e.initialize=function(s,u,d){Fu(u,(function(){return"PostChannel:initialize"}),(function(){var f=u;t.initialize(s,u,d);try{u.addUnloadCb,c=gu(qs(e.identifier),u.evtNamespace&&u.evtNamespace());var p=e._getTelCtx();s.extensionConfig[e.identifier]=s.extensionConfig[e.identifier]||{},n=p.getExtCfg(e.identifier),l=bl(n.setTimeoutOverride,n.clearTimeoutOverride),E=!n.disableOptimizeObj&&!!Ua("chrome"),function(e){var t=e.getWParam;e.getWParam=function(){var e=0;return n.ignoreMc1Ms0CookieProcessing&&(e|=2),e|t()}}(f),n.eventsLimitInMem>0&&(y=n.eventsLimitInMem),n.immediateEventLimit>0&&(g=n.immediateEventLimit),n.autoFlushEventsLimit>0&&(a=n.autoFlushEventsLimit),$o(n[Al])&&(x=n[Al]),$o(n[kl])&&(D=n[kl]),ie(),n.httpXHROverride&&n.httpXHROverride.sendPOST&&(r=n.httpXHROverride),mc(s.anonCookieName)&&o.addQueryStringParameter("anoncknm",s.anonCookieName),o.sendHook=n.payloadPreprocessor,o.sendListener=n.payloadListener;var v=n.overrideEndpointUrl?n.overrideEndpointUrl:s.endpointUrl;e._notificationManager=u.getNotifyMgr(),o.initialize(v,e.core,e,r,n);var h=s.disablePageUnloadEvents||[];(function(e,t,n,i){var r=!1;t&&e&&Qo(e)&&!(r=Su(e,t,n,i))&&n&&n[xi]>0&&(r=Su(e,t,null,i))})([iu,nu,eu],i,h,c),Cu(i,h,c),bu(O,s.disablePageShowEvents,c)}catch(t){throw e.setInitialized(!1),t}}),(function(){return{coreConfig:s,core:u,extensions:d}}))},e.processTelemetry=function(t,i){Cc(t,e.identifier);var r=(i=e._getTelCtx(i)).getExtCfg(e.identifier),o=!!n.disableTelemetry;r&&(o=o||!!r.disableTelemetry);var a=t;o||d||(n[wl]&&(a.iKey=n[wl]),r&&r[wl]&&(a.iKey=r[wl]),_(a,!0),P?L(2,2):M()),e.processNext(a,i)},e._doTeardown=function(e,t){var n;L(2,2),d=!0,o.teardown(),Tu([iu,nu,eu],null,c),n=gu(ru,c),Tu([eu],null,n),Tu([Ys],null,n),function(e,t){var n=gu(ou,t);Tu([tu],null,n),Tu([Ys],null,n)}(0,c),U()},e.setEventQueueLimits=function(e,t){y=e>0?e:1e4,a=t>0?t:0,ie();var n=m>e;if(!n&&s>0)for(var i=1;!n&&i<=3;i++){var r=A[i];r&&r.batches&&ta(r.batches,(function(e){e&&e.count()>=s&&(n=!0)}))}B(!0,n)},e.pause=function(){H(),v=!0,o.pause()},e.resume=function(){v=!1,o.resume(),M()},e.addResponseHandler=function(e){o._responseHandlers.push(e)},e._loadTransmitProfiles=function(e){H(),G(),T=Pc,M(),jo(e,(function(e,t){var n=t.length;if(n>=2){var i=n>2?t[2]:0;if(t.splice(0,n-2),t[1]<0&&(t[0]=-1),t[1]>0&&t[0]>0){var r=t[0]/t[1];t[0]=Math.ceil(r)*t[1]}i>=0&&t[1]>=0&&i>t[1]&&(i=t[1]),t.push(i),S[e]=t}}))},e.flush=function(e,t,n){if(void 0===e&&(e=!0),!v)if(n=n||1,e)null==p?(H(),K(1,0,n),p=N((function(){p=null,q(t,n)}),0)):f.push(t);else{var i=H();F(1,1,n),null!=t&&t(),i&&M()}},e.setMsaAuthTicket=function(e){o.addHeader(Wc,e)},e.hasEvents=R,e._setTransmitProfile=function(e){T!==e&&void 0!==S[e]&&(H(),T=e,M())},e._backOffTransmission=function(){I<4&&(I++,H(),M())},e._clearBackOff=function(){I&&(I=0,H(),M())},sa(e,"_setTimeoutOverride",(function(){return l.set}),(function(e){l=bl(e,l.clear)})),sa(e,"_clearTimeoutOverride",(function(){return l.clear}),(function(e){l=bl(l.set,e)}))})),i}return Au(t,e),t.__ieDyn=1,t}(Zu);var Pl,xl,Dl="HttpManager:_sendBatches",Ol="PrivacyGuard:_processTelemetry",_l=function(){function e(e,t,n){this.start=Date.now(),this.name=e,this.isAsync=!0===n,this.payload=t}return e.prototype.isChildEvt=function(){return!1},e.prototype.complete=function(){this.time=Date.now()-this.start,this.exTime=this.time},e}(),Fl=function(){function e(e){this._callbacks=e}return e.prototype.create=function(e,t,n){return e===Dl||e===Ol?new _l(e,t,n):null},e.prototype.fire=function(e){if(e&&e.complete(),this._callbacks)switch(e.name){case Dl:this.handleSendBatches(e);break;case Ol:this.handlePrivacyGuardNotification(e)}},e.prototype.setCtx=function(e,t){},e.prototype.getCtx=function(e){},e.prototype.handleSendBatches=function(e){if(this._callbacks.requestProcessingStats){var t=0;if(e.payload){var n=e.payload();if(n.batches)for(var i in n.batches)t+=n.batches[i].evts.length}this._callbacks.requestProcessingStats(e.time||0,t)}},e.prototype.handlePrivacyGuardNotification=function(e){this._callbacks.privacyGuardStats&&e.time&&e.time>0&&this._callbacks.privacyGuardStats(e.time)},e}(),Rl=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.initialize=function(t,n){this._postChannel=new El;var i=null!=n?n:[];t.channels=[[this._postChannel]],t.extensionConfig=t.extensionConfig||[],t.extensionConfig[this._postChannel.identifier]=r(r({},t.channelConfiguration),t.extensionConfig[this._postChannel.identifier]);try{e.prototype.initialize.call(this,t,i)}catch(e){this.logger.warnToConsole("Failed to initialize SDK."+e)}},t.prototype.setUploadFrequency=function(e){if(this._postChannel&&e){var t=e/1e3,n=t/2,i={};i.OTelCustomTransmissionProfile=[t,n],this._postChannel._loadTransmitProfiles(i),this._postChannel._setTransmitProfile("OTelCustomTransmissionProfile")}},t.prototype.flush=function(e){this._postChannel&&this._postChannel.flush(e)},t.prototype.shutdown=function(){this._postChannel&&this._postChannel.teardown()},t}(wc),Ml=function(e){function t(t,n){var i,o=e.call(this,t,n)||this;o.sendTelemetryEvent=function(e){return function(t,n){try{return void((r=o.getOneDSTelemetryEvent(e))&&i&&i.track(r))}catch(e){return void un(1,"1DS Sink",e)}var r}()},o.sendCustomerContent=function(e){},o.sendNonStandardEvent=function(e,t){var n=!1;u.forEach((function(i){i.canHandle(t)&&(i.processEvent(e),n=!0)})),n||sn(0,1,(function(){return"Missing Handler for "+t+"to process"+e.eventName}))},o.flush=function(e){null==i||i.flush(e),u.forEach((function(t){t.flush(e)}))},o.shutdown=function(){try{null==i||i.shutdown(),u.forEach((function(e){e.shutdown()}))}catch(e){sn(0,2,(function(){return"An error occurred on shutdown"}))}};var a,s,u=n.nonStandardEventHandlers||[];if(i=function(e,t){var n=e.httpXHROverride,i={instrumentationKey:"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405",endpointUrl:e.endpointUrl,channelConfiguration:{eventsLimitInMem:e.eventsLimitInMem,httpXHROverride:n,setTimeoutOverride:e.setTimeoutOverride,clearTimeoutOverride:e.clearTimeoutOverride,ignoreMc1Ms0CookieProcessing:!0,disableOptimizeObj:!0},enableWParam:!n,disableCookiesUsage:!0,extensionConfig:r({},e.extensionConfig)};e.stats&&e.stats.networkStats&&i.channelConfiguration&&(i.channelConfiguration.payloadListener=function(t,n){var i,r=n||t;r.data&&(null===(i=e.stats)||void 0===i||i.networkStats(r.data.length))});var o=new Rl;return o.initialize(i,e.plugins),o.setUploadFrequency(e.uploadFrequency),e.notificationListener&&o.addNotificationListener(e.notificationListener),e.stats&&o.setPerfMgr(new Fl(e.stats)),o}(n),u.forEach((function(e){e.initialize(o,n)})),!n.endpointUrl)throw new Error("Missing Endpoint Url");return n.disableStatsTracking||(a=o,(s=i)&&s.addNotificationListener({eventsSent:function(e){sn(2,2,(function(){return"Successfully sent ".concat(e.length," event(s)")})),sn(3,2,(function(){return"Sent event(s) details : ".concat(JSON.stringify(e,null,2))})),a.eventsSent+=e.length},eventsDiscarded:function(e,t){sn(0,2,(function(){return"Discarded ".concat(e.length," event(s) because ").concat(t)})),sn(3,2,(function(){return"Discarded event(s) details : ".concat(JSON.stringify(e,null,2))})),a.eventsDiscarded+=e.length}})),o}return i(t,e),t}((function(e,t){var n=this;this.eventsProcessed=0,this.eventsSent=0,this.eventsDiscarded=0;var i=[],r=!1,o=!0,a={name:"DiagnosticLevel",processEvent:function(e){var t=e.eventFlags.diagnosticLevel;return r||10===t||110===t||120===t}},s={},u=Iu();this.init=function(){return o=o&&function(e){function t(t){return"string"==typeof e[t]&&""!=e[t]||(ni(t),!1)}var n=t("App.Name")&&t("App.Version")&&t("App.Platform")&&t(ti);if(e["User.IsAnonymous"]||(n=n&&t("User.PrimaryIdentityHash")&&t("User.PrimaryIdentitySpace")),!n)return n;var i=/^[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}$/,r=e[ei];return!r||t(ei)&&i.test(r)||(ni(ei),n=!1),i.test(e[ti])||(ni(ti),n=!1),n}(s)},this.getOneDSTelemetryEvent=function(e){return c(e,{eventType:1})},this.getOneDSCustomerContent=function(e){var t=e.telemetryProperties.customerContentVersion;if(t&&Math.floor(t)<=2&&1===e.telemetryProperties.customerContentType)return c(e,{eventType:2})};var c=function(e,t){var r,o=bn(e);if(function(e,t){for(var n=function(n){var i=t[n];if(!i.processEvent(e))return sn(2,1,(function(){return"".concat(e.eventName," suppressed by ").concat(i.name)})),{value:!1}},i=0;i<t.length;i++){var r=n(i);if("object"==typeof r)return r.value}return!0}(o,i)){var a=(r=o,r.timestamp?new Date(r.timestamp):new Date).toISOString(),c={"Event.Name":o.eventName,"Event.Source":"OTelJS","Event.Time":{value:a,propertyType:9}};for(var l in n.eventsProcessed++,c["Event.Sequence"]={value:n.eventsProcessed,propertyType:4},c["Event.Id"]=u+"."+n.eventsProcessed,s)c[l]=s[l];if(!Yn(c,o.dataFields,!0,t.eventType))return void sn(0,1,(function(){return"Dropping Event: "+o.eventName}));var d="custom";o.eventContract&&(o.eventContract.name&&(c["Event.Contract"]=o.eventContract.name,d+="."+o.eventContract.name.toLowerCase().replace(/\./g,"_")),Yn(c,o.eventContract.dataFields,!1,t.eventType));var f=function(e,t){return 2===t?"b22a201c3f1d41d28ccc399ba6cc9ca2-1972c77f-1f79-4283-a0f9-b4ddc4646f55-7121":e.telemetryProperties&&(1!==t||e.telemetryProperties.ariaTenantToken)?1===t?e.telemetryProperties.ariaTenantToken:void 0:void sn(0,1,(function(){return"Missing Aria Token"}))}(o,t.eventType);if(!f)return;return{iKey:f,name:o.eventName,data:c,time:a,baseType:d,ext:{sdk:{seq:n.eventsProcessed}}}}};this.addPreprocessor=function(e){i.push(e)},this.getOneDSPersistentDataFields=function(){return s},this.getPreprocessors=function(){return i};var l=function(e){Yn(s,e,!1,1)};this.addPersistentDataFields=l,this.setOptionalEventsEnabled=function(e){r=e},this.setFullEventsEnabled=this.setOptionalEventsEnabled,t.enableOptionalEvents&&(r=!0),l(e);var d,f=t.coreFields;if(f){l(function(e){var t="App",n=[];return zn(n,t,"Name",e.name,1),zn(n,t,"Platform",e.platform,1),zn(n,t,"Version",e.version,1),n}(f.app)),l(qn(f.user)),l(jn(f.session));var p=f.release;p&&l((zn(d=[],"Release","AudienceGroup",p.audienceGroup,1),d))}this.addPreprocessor(a)}));(xl=Pl||(Pl={})).USGOV_DOD="https://pf.events.data.microsoft.com/OneCollector/1.0/",xl.USGOV_DOJ="https://tb.events.data.microsoft.com/OneCollector/1.0/",xl.PUBLIC="https://browser.events.data.microsoft.com/OneCollector/1.0/",xl.CUSTOMER_CONTENT="",xl.EUDB="https://eu-office.events.data.microsoft.com/OneCollector/1.0/";var Ul=function(){return 1e3*Date.now()};"object"==typeof window&&"object"==typeof window.performance&&"now"in window.performance&&(Ul=function(){return 1e3*Math.floor(window.performance.now())});var Nl,Hl=function(){function e(e,t,n){this.hubInfo=e,this.customTelemetryService=n,this.letterRegex=/[a-zA-Z]/,this.consumerTid="9188040d-6c67-4c5b-b112-36a304b66dad",this.telemetrySource="AppHostSdk",this.namespace="Office.AppHostingSdk",this.eventFieldPrefix="AppHost",this.ariaTenantToken="7ada8d16f9234e2093f080920f21dd7d-41cee27e-93c2-4a6b-a7aa-2001e852d387-7123",this.nexusTenantToken=-1,this.anonymousDataFields=s([],On.Office.System.User.getFields("User",{isAnonymous:!0}),!0);var i=[Tn("".concat(this.eventFieldPrefix,".HostName"),this.hubInfo.name),Tn("".concat(this.eventFieldPrefix,".HostVersion"),this.hubInfo.version),Tn("".concat(this.eventFieldPrefix,".HostSdkVersion"),P),Tn("".concat(this.eventFieldPrefix,".HostSessionId"),this.hubInfo.sessionId),Tn("".concat(this.eventFieldPrefix,".TelemetrySource"),this.telemetrySource),Tn("".concat(this.eventFieldPrefix,".Platform"),t.app.host.clientType===ht.web?"Web":"Desktop")];this.telemetryLogger=new $n,this.telemetryLogger.setTenantToken(this.namespace,this.ariaTenantToken,this.nexusTenantToken);var r=zl(t.user.dataResidency);r&&(this.oneDsSink=new Ml(i,{endpointUrl:r}),this.telemetryLogger.telemetrySinks=[this.oneDsSink]),this.setAppContext(t),this.isTest=function(){try{return void 0!==process.env.JEST_WORKER_ID}catch(e){return!!window.Cypress}}(),this.enableExtendedInitializationTracking=(null==n?void 0:n.enableExtendedInitializationTracking)||!1}return e.prototype.createScenario=function(e,t,n){var i,r;void 0===n&&(n=Date.now()),t=null!=t?t:null===(i=this.appDefinition)||void 0===i?void 0:i.id;var o=this.isTest?void 0:this.telemetryLogger.createActivity(this.createTelemetryEvent(e,n,t)),a=null===(r=this.customTelemetryService)||void 0===r?void 0:r.createScenario(e,t,n),s=this.shouldLogToAria(e);return new Ll(this,s,n,a,o)},e.prototype.setAppSdkVersion=function(e){this.appSdkVersion=e},e.prototype.setAppContext=function(e){var t,n,i,r,o,a,s,u=this.appContext;if(this.appContext=e,this.oneDsSink){if(Wt(e)&&(!Wt(u)||e.user.id!==u.user.id)){var c=!e.user.id,l=void 0;if(c)l=this.anonymousDataFields;else{var d=(null===(n=null===(t=this.appContext.user)||void 0===t?void 0:t.tenant)||void 0===n?void 0:n.id)!==this.consumerTid;l=qn({primaryIdentityHash:null===(i=e.user)||void 0===i?void 0:i.id,primaryIdentitySpace:d?"UserObjectId":"MSAPuid",tenantId:null===(o=null===(r=this.appContext.user)||void 0===r?void 0:r.tenant)||void 0===o?void 0:o.id,tenantGroup:d?"Commercial":"Consumer",isAnonymous:c})}this.oneDsSink.addPersistentDataFields(l)}if(this.appContext.app.sessionId!==(null==u?void 0:u.app.sessionId)){var f=jn({id:null!==(a=this.appContext.app.sessionId)&&void 0!==a?a:""});this.oneDsSink.addPersistentDataFields(f)}if(this.appContext.app.locale!==(null==u?void 0:u.app.locale)){var p=Tn("Culture.UiLanguage",null!==(s=this.appContext.app.locale)&&void 0!==s?s:"");this.oneDsSink.addPersistentDataFields([p])}}},e.prototype.setAppDefinition=function(e){this.appDefinition=e},e.prototype.isSessionIdSet=function(){var e;return!!(null===(e=this.appContext)||void 0===e?void 0:e.app.sessionId)},e.prototype.createTelemetryEvent=function(e,t,n){var i,r,o,a,s,u,c;return{eventName:"".concat(this.namespace,".").concat(this.sanitizeScenarioName(e)),eventFlags:{dataCategories:2,diagnosticLevel:110},dataFields:[Tn("HostedAppId",null!=n?n:""),Tn("HostedAppEntityId",null!==(r=null===(i=this.appContext)||void 0===i?void 0:i.page.id)&&void 0!==r?r:""),Tn("HostedAppSdkVersion",null!==(o=this.appSdkVersion)&&void 0!==o?o:""),Tn("HostedAppFrameContext",null!==(s=null===(a=this.appContext)||void 0===a?void 0:a.page.frameContext)&&void 0!==s?s:""),Tn("HostedAppSessionId",null!==(c=null===(u=this.appContext)||void 0===u?void 0:u.app.sessionId)&&void 0!==c?c:"")],timestamp:t}},e.prototype.sanitizeScenarioName=function(e){for(var t="",n=!0,i=0;i<e.length;i++){var r=e.charAt(i);"."===r&&0!==i&&"."!==t.charAt(t.length-1)?(t+=r,n=!0):this.letterRegex.test(r)?n?(n=!1,t+=r.toUpperCase()):t+=r:n=!0}return t},e.prototype.shouldLogToAria=function(e){return!e.startsWith("eventDispatch")&&"appInitializationExtended"!==e},e}(),Ll=function(){function e(e,t,n,i,r){this.logger=e,this.shouldLogToAria=t,this.clientTimestamp=n,this.customScenario=i,this.activity=r,this.lastMark=function(e){var t=Date.now();return Ul()-1e3*(t-e)}(n)}return e.prototype.markPhase=function(e){var t,n,i,r=Ul(),o=r-this.lastMark;this.lastMark=r,null===(n=null===(t=this.activity)||void 0===t?void 0:t.dataFields)||void 0===n||n.push(Sn("Activity.Phase.".concat(e),o)),null===(i=this.customScenario)||void 0===i||i.markPhase(e)},e.prototype.stop=function(){var e;this.endActivity(!0),null===(e=this.customScenario)||void 0===e||e.stop()},e.prototype.fail=function(e){var t,n,i,r,o;null===(n=null===(t=this.activity)||void 0===t?void 0:t.dataFields)||void 0===n||n.push(Tn("ErrorMessage",(r=e)?((o=r)&&(o=o.replace(Vt,"email_removed")),o):"")),this.endActivity(!1),null===(i=this.customScenario)||void 0===i||i.fail(e)},e.prototype.endActivity=function(e){this.shouldLogToAria&&this.activity&&this.logger.isSessionIdSet()&&(this.activity.success=e,this.activity.endNow())},e}(),zl=function(e){switch(e){case ct.EUDB:return Pl.EUDB;case ct.DOD:return Pl.USGOV_DOD;case ct.DOJ:return Pl.USGOV_DOJ;case ct.Public:return Pl.PUBLIC;default:return}},Bl=function(){function e(e,t,n,i,o,a){var s=this;this.hostWindow=e,this.context=t,this.authenticationService=n,this.logger=i,this.customTelemetryService=o,this.onAppInitStateChanged=a,this.initialized=!1,this.initializeAuthenticationContext=function(e){var t;s.context=e,s.contextPromise=null===(t=s.authenticationService)||void 0===t?void 0:t.getUser().then((function(e){var t,n,i,o,a,u,c,l,d,f=r(r({},null===(t=s.context)||void 0===t?void 0:t.user),{id:(null===(n=null==e?void 0:e.profile)||void 0===n?void 0:n.oid)||"",displayName:(null===(i=null==e?void 0:e.profile)||void 0===i?void 0:i.displayName)||"",loginHint:(null===(o=null==e?void 0:e.profile)||void 0===o?void 0:o.loginHint)||"",userPrincipalName:(null===(a=null==e?void 0:e.profile)||void 0===a?void 0:a.upn)||"",tenant:{id:(null===(u=null==e?void 0:e.profile)||void 0===u?void 0:u.tid)||"",sku:null===(d=null===(l=null===(c=s.context)||void 0===c?void 0:c.user)||void 0===l?void 0:l.tenant)||void 0===d?void 0:d.sku}}),p=r(r({},s.context.app),{userClickTime:s.getUserClickTime()}),v=r(r({},s.context),{app:p,user:f});return s.telemetryService.setAppContext(v),v}))},this.getContext=function(){return s.context},this.getAppContext=function(){return s.contextPromise?s.contextPromise.then((function(e){return e})).catch((function(){return s.context})):Promise.resolve(s.context)},this.getAppDefinition=function(){return s.appDefinition},this.checkIfCachedAndRequestAllowed=function(e){return!0},this.setAppInitInfo=function(e){s.onAppInitStateChanged&&s.onAppInitStateChanged(e)},this.getLogger=function(){return s.logger},this.telemetryService=new Hl(this.getHubInfo(),t,this.customTelemetryService),this.context.app.userClickTime&&(this.userClickTime=this.context.app.userClickTime)}return e.prototype.isInitialized=function(){return this.initialized},e.prototype.setInitialized=function(e){this.initialized=e},e.prototype.getHubInfo=function(){return{name:this.context.app.host.name,version:this.context.app.host.version,clientType:this.context.app.host.clientType,sessionId:this.context.app.host.sessionId}},e.prototype.unloadApp=function(e){this.telemetryService.createScenario("appTermination",e.id).stop()},e.prototype.getHostWindow=function(){return this.hostWindow},e.prototype.getFrameContext=function(){return this.context.page.frameContext},e.prototype.getUserClickTime=function(){return this.userClickTime},e.prototype.setUserClickTime=function(e){this.userClickTime=e},e.prototype.startAppInitializationScenario=function(){var e;this.appInitializationScenario=null===(e=this.telemetryService)||void 0===e?void 0:e.createScenario("appInitialization",void 0,this.getUserClickTime())},e.prototype.getAppInitializationScenario=function(){return this.appInitializationScenario},e}();!function(e){e.AppDefinitionUnavailable="AppDefinitionUnavailable",e.BlockedByBrowser="BlockedByBrowser",e.CancelledByUser="CancelledByUser",e.InvalidAuthUrl="InvalidAuthUrl",e.InvalidFrameContext="InvalidFrameContext",e.Other="Other"}(Nl||(Nl={}));var Vl=function(e){function t(t,n,i,r,s,u,l,d){var f,p=this;if((p=e.call(this,t,s,r,u,l,void 0)||this).hostWindow=t,p.openWindowInfo=n,p.appDefinition=i,p.authenticationService=r,p.context=s,p.logger=u,p.onAuthMessageReceived=function(e){return o(p,void 0,void 0,(function(){var t;return a(this,(function(n){switch(n.label){case 0:return this.authWindow&&this.authWindow===e.source?((t=e.origin)!==this.origin&&this.checkUrlIsValid(t)&&(this.origin=e.origin),this.origin===t&&this.messageProcessor?[4,this.messageProcessor.process(e)]:[3,2]):[2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},p.setupAuthMessageHandlers=function(){p.authenticationService&&(p.messageProcessor=new on(p,p.authenticationService,p.telemetryService))},p.passContextForUrlValidation=At().authExtensionContextForUrlValidation,p.context.page.frameContext!==gt.authentication&&p.HandleError("Invalid frame context for scenario",Nl.InvalidFrameContext),p.appDefinition||p.HandleError("App definition not available",Nl.AppDefinitionUnavailable),p.checkUrlIsValid(n.url)&&p.hostWindow){var v=p.hostWindow,h="";n.width&&n.height&&(h="width=".concat(n.width,",height=").concat(n.height),null!=n.left&&null!=n.top&&(h="".concat(h,",left=").concat(n.left,",top=").concat(n.top))),d?p.hostWindow.open(w.startAuth(n.url,(function(e,t){e?r.notifySuccess(t):(t!==S&&t!==T||u.log(y.Error,"HostedWebContentAuthSdkService",t),r.notifyFailure(t))}),r.externalAuthRedirectUrl)):(p.authWindow=v.open(n.url,"appAuthWindow",h),p.authWindow?(p.origin=n.url,p.setUserClickTime(null!==(f=s.app.userClickTime)&&void 0!==f?f:Date.now()),p.setupAuthMessageHandlers(),p.globalWindowEventListener=new c(v),p.globalWindowEventListener.addListener("message",p.onAuthMessageReceived),p.startAuthWindowMonitor(),p.initializeAuthenticationContext(s)):p.HandleError("browser is blocking the url to open",Nl.BlockedByBrowser))}else p.HandleError("Auth url is not valid",Nl.InvalidAuthUrl);return p}return i(t,e),t.prototype.checkUrlIsValid=function(e){return this.passContextForUrlValidation?Et(e,this.logger,this.appDefinition,this.context):Et(e,this.logger,this.appDefinition)},t.prototype.getHostWindow=function(){return this.authWindow||null},t.prototype.postResponseToApp=function(e,t){this.sendResponseMessage(e,t)},t.prototype.isWindowOpen=function(){return!!this.authWindow&&!this.authWindow.closed},t.prototype.closeWindow=function(){this.unloadApp(this.appDefinition)},t.prototype.sendResponseMessage=function(e,t){if(this.origin){var n={id:e,args:t,origin:this.origin};this.postMessage(n)}},t.prototype.sendRequestMessage=function(e,t){if(this.origin){var n={func:e,args:t};this.postMessage(n)}},t.prototype.startAuthWindowMonitor=function(){var e=this;this.stopAuthWindowMonitor(),this.authWindowMonitor=this.hostWindow.setInterval((function(){e.authWindowInterval()}),100)},t.prototype.authWindowInterval=function(){this.isWindowOpen()?this.sendRequestMessage("ping"):(this.HandleError("CancelledByUser",Nl.CancelledByUser),this.closeWindow(),this.stopAuthWindowMonitor())},t.prototype.stopAuthWindowMonitor=function(){this.authWindowMonitor&&(this.hostWindow.clearInterval(this.authWindowMonitor),this.authWindowMonitor=void 0)},t.prototype.unloadApp=function(e){var t;this.unloadSDK(),null===(t=this.authWindow)||void 0===t||t.close()},t.prototype.unloadSDK=function(){this.globalWindowEventListener&&this.globalWindowEventListener.removeListener("message")},t.prototype.postMessage=function(e){var t;this.origin&&(null===(t=this.authWindow)||void 0===t||t.postMessage(e,this.origin))},t.prototype.HandleError=function(e,t){this.authenticationService&&this.authenticationService.notifyFailure(e,t)},t}(Bl);const Wl={Debug:console.debug,Info:console.log,Warn:console.warn,Error:console.error};class Kl{log(e,t,n,i){Wl[e](`[LoggerService] tag: ${t}, level: ${e}, message: ${n}, exception: `,i||"undefined")}}var ql,jl,Gl=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{u(i.next(e))}catch(e){o(e)}}function s(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((i=i.apply(e,t||[])).next())}))};!function(e){e.Success="success",e.Failure="failure"}(ql||(ql={})),function(e){e.AuthConfig="AuthConfig"}(jl||(jl={}));const Jl=window.chrome.webview;class Ql extends e{constructor(e){super(),this.data=e,this.getUser=()=>Gl(this,void 0,void 0,(function*(){return{profile:{oid:this.data.userObjectId||"",tid:this.data.tenantId||"",upn:this.data.userPrincipalName||"",loginHint:this.data.loginHint||""}}})),this.notifySuccess=e=>Gl(this,void 0,void 0,(function*(){Xl(this.data.type,ql.Success,e)})),this.notifyFailure=e=>Gl(this,void 0,void 0,(function*(){Xl(this.data.type,ql.Failure,e)})),this.acquireToken=(e,t,n)=>Gl(this,void 0,void 0,(function*(){return Xl(this.data.type,ql.Failure,"acquireToken in MetaOSAuthExtension is not implemented"),{token:""}}))}}function Xl(e,t,n){null==Jl||Jl.postMessage({eventType:e,status:t,data:n})}null==Jl||Jl.addEventListener("message",(e=>{e.data&&e.data.type===jl.AuthConfig&&function(e){const t=e.validDomains?e.validDomains.split(","):[];new Vl(window,{url:e.targetUrl,width:e.width,height:e.height,left:e.left,top:e.right},{id:e.appId||"",validDomains:t,showLoadingIndicator:e.showLoadingIndicator,version:e.appVersion||"",devicePermissions:[],isFullTrust:!1,isLOB:!1,pages:{configurable:[],static:[]}},new Ql(e),{app:{locale:e.locale||"en-US",theme:e.isDarkMode?pt.dark:pt.default,host:{name:dt.outlookWin32,clientType:ht.desktop,version:e.clientVersion,sessionId:e.hostSessionId},sessionId:e.sessionId},page:{id:"defaultId",frameContext:gt.authentication},user:{dataResidency:e.dataResidency}},new Kl)||Xl(e.type,ql.Failure,"MetaOSAuthExtension is null")}(e.data)}))})()})();