(()=>{var U4e=Object.create;var Sse=Object.defineProperty;var G4e=Object.getOwnPropertyDescriptor;var K4e=Object.getOwnPropertyNames;var V4e=Object.getPrototypeOf,W4e=Object.prototype.hasOwnProperty;var j4e=(e,r)=>()=>(e&&(r=e(e=0)),r);var Y=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports);var H4e=(e,r,n,a)=>{if(r&&typeof r=="object"||typeof r=="function")for(var o=K4e(r),u=0,t=o.length,d;u<t;u++)d=o[u],!W4e.call(e,d)&&d!==n&&Sse(e,d,{get:(s=>r[s]).bind(null,d),enumerable:!(a=G4e(r,d))||a.enumerable});return e};var KW=(e,r,n)=>(n=e!=null?U4e(V4e(e)):{},H4e(r||!e||!e.__esModule?Sse(n,"default",{value:e,enumerable:!0}):n,e));var yse=Y((exports,module)=>{_();if(exports.__platformBundles!==void 0)for(platformBundles=exports.__platformBundles.concat(),Reflect.deleteProperty(exports,"__platformBundles"),i=0;i<platformBundles.length;++i)console.log("PB start "+(i+1)+"/"+platformBundles.length),eval(platformBundles[i]),console.log("PB done  "+(i+1)+"/"+platformBundles.length);var platformBundles,i});var global,_=j4e(()=>{global=new Function("return this;")();yse()});var Cse=Y(()=>{_()});var _se=Y(()=>{_()});var Rse=Y(()=>{_()});var An=Y((wun,TI)=>{_();function Q4e(e){return e&&e.__esModule?e:{default:e}}TI.exports=Q4e,TI.exports.__esModule=!0,TI.exports.default=TI.exports});var bI=Y((xun,Hy)=>{_();function VW(e){return Hy.exports=VW=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Hy.exports.__esModule=!0,Hy.exports.default=Hy.exports,VW(e)}Hy.exports=VW,Hy.exports.__esModule=!0,Hy.exports.default=Hy.exports});var bse=Y((Bun,Qy)=>{_();var z4e=bI().default;function Tse(){"use strict";Qy.exports=Tse=function(){return e},Qy.exports.__esModule=!0,Qy.exports.default=Qy.exports;var e={},r=Object.prototype,n=r.hasOwnProperty,a=Object.defineProperty||function(L,D,U){L[D]=U.value},o=typeof Symbol=="function"?Symbol:{},u=o.iterator||"@@iterator",t=o.asyncIterator||"@@asyncIterator",d=o.toStringTag||"@@toStringTag";function s(L,D,U){return Object.defineProperty(L,D,{value:U,enumerable:!0,configurable:!0,writable:!0}),L[D]}try{s({},"")}catch(L){s=function(U,V,ne){return U[V]=ne}}function c(L,D,U,V){var ne=D&&D.prototype instanceof p?D:p,J=Object.create(ne.prototype),$=new x(V||[]);return a(J,"_invoke",{value:F(L,U,$)}),J}function l(L,D,U){try{return{type:"normal",arg:L.call(D,U)}}catch(V){return{type:"throw",arg:V}}}e.wrap=c;var f={};function p(){}function m(){}function v(){}var h={};s(h,u,function(){return this});var S=Object.getPrototypeOf,y=S&&S(S(G([])));y&&y!==r&&n.call(y,u)&&(h=y);var C=v.prototype=p.prototype=Object.create(h);function E(L){["next","throw","return"].forEach(function(D){s(L,D,function(U){return this._invoke(D,U)})})}function I(L,D){function U(ne,J,$,Z){var ie=l(L[ne],L,J);if(ie.type!=="throw"){var X=ie.arg,Q=X.value;return Q&&z4e(Q)=="object"&&n.call(Q,"__await")?D.resolve(Q.__await).then(function(b){U("next",b,$,Z)},function(b){U("throw",b,$,Z)}):D.resolve(Q).then(function(b){X.value=b,$(X)},function(b){return U("throw",b,$,Z)})}Z(ie.arg)}var V;a(this,"_invoke",{value:function(J,$){function Z(){return new D(function(ie,X){U(J,$,ie,X)})}return V=V?V.then(Z,Z):Z()}})}function F(L,D,U){var V="suspendedStart";return function(ne,J){if(V==="executing")throw new Error("Generator is already running");if(V==="completed"){if(ne==="throw")throw J;return H()}for(U.method=ne,U.arg=J;;){var $=U.delegate;if($){var Z=w($,U);if(Z){if(Z===f)continue;return Z}}if(U.method==="next")U.sent=U._sent=U.arg;else if(U.method==="throw"){if(V==="suspendedStart")throw V="completed",U.arg;U.dispatchException(U.arg)}else U.method==="return"&&U.abrupt("return",U.arg);V="executing";var ie=l(L,D,U);if(ie.type==="normal"){if(V=U.done?"completed":"suspendedYield",ie.arg===f)continue;return{value:ie.arg,done:U.done}}ie.type==="throw"&&(V="completed",U.method="throw",U.arg=ie.arg)}}}function w(L,D){var U=D.method,V=L.iterator[U];if(V===void 0)return D.delegate=null,U==="throw"&&L.iterator.return&&(D.method="return",D.arg=void 0,w(L,D),D.method==="throw")||U!=="return"&&(D.method="throw",D.arg=new TypeError("The iterator does not provide a '"+U+"' method")),f;var ne=l(V,L.iterator,D.arg);if(ne.type==="throw")return D.method="throw",D.arg=ne.arg,D.delegate=null,f;var J=ne.arg;return J?J.done?(D[L.resultName]=J.value,D.next=L.nextLoc,D.method!=="return"&&(D.method="next",D.arg=void 0),D.delegate=null,f):J:(D.method="throw",D.arg=new TypeError("iterator result is not an object"),D.delegate=null,f)}function B(L){var D={tryLoc:L[0]};1 in L&&(D.catchLoc=L[1]),2 in L&&(D.finallyLoc=L[2],D.afterLoc=L[3]),this.tryEntries.push(D)}function k(L){var D=L.completion||{};D.type="normal",delete D.arg,L.completion=D}function x(L){this.tryEntries=[{tryLoc:"root"}],L.forEach(B,this),this.reset(!0)}function G(L){if(L){var D=L[u];if(D)return D.call(L);if(typeof L.next=="function")return L;if(!isNaN(L.length)){var U=-1,V=function ne(){for(;++U<L.length;)if(n.call(L,U))return ne.value=L[U],ne.done=!1,ne;return ne.value=void 0,ne.done=!0,ne};return V.next=V}}return{next:H}}function H(){return{value:void 0,done:!0}}return m.prototype=v,a(C,"constructor",{value:v,configurable:!0}),a(v,"constructor",{value:m,configurable:!0}),m.displayName=s(v,d,"GeneratorFunction"),e.isGeneratorFunction=function(L){var D=typeof L=="function"&&L.constructor;return!!D&&(D===m||(D.displayName||D.name)==="GeneratorFunction")},e.mark=function(L){return Object.setPrototypeOf?Object.setPrototypeOf(L,v):(L.__proto__=v,s(L,d,"GeneratorFunction")),L.prototype=Object.create(C),L},e.awrap=function(L){return{__await:L}},E(I.prototype),s(I.prototype,t,function(){return this}),e.AsyncIterator=I,e.async=function(L,D,U,V,ne){ne===void 0&&(ne=Promise);var J=new I(c(L,D,U,V),ne);return e.isGeneratorFunction(D)?J:J.next().then(function($){return $.done?$.value:J.next()})},E(C),s(C,d,"Generator"),s(C,u,function(){return this}),s(C,"toString",function(){return"[object Generator]"}),e.keys=function(L){var D=Object(L),U=[];for(var V in D)U.push(V);return U.reverse(),function ne(){for(;U.length;){var J=U.pop();if(J in D)return ne.value=J,ne.done=!1,ne}return ne.done=!0,ne}},e.values=G,x.prototype={constructor:x,reset:function(D){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!D)for(var U in this)U.charAt(0)==="t"&&n.call(this,U)&&!isNaN(+U.slice(1))&&(this[U]=void 0)},stop:function(){this.done=!0;var D=this.tryEntries[0].completion;if(D.type==="throw")throw D.arg;return this.rval},dispatchException:function(D){if(this.done)throw D;var U=this;function V(X,Q){return $.type="throw",$.arg=D,U.next=X,Q&&(U.method="next",U.arg=void 0),!!Q}for(var ne=this.tryEntries.length-1;ne>=0;--ne){var J=this.tryEntries[ne],$=J.completion;if(J.tryLoc==="root")return V("end");if(J.tryLoc<=this.prev){var Z=n.call(J,"catchLoc"),ie=n.call(J,"finallyLoc");if(Z&&ie){if(this.prev<J.catchLoc)return V(J.catchLoc,!0);if(this.prev<J.finallyLoc)return V(J.finallyLoc)}else if(Z){if(this.prev<J.catchLoc)return V(J.catchLoc,!0)}else{if(!ie)throw new Error("try statement without catch or finally");if(this.prev<J.finallyLoc)return V(J.finallyLoc)}}}},abrupt:function(D,U){for(var V=this.tryEntries.length-1;V>=0;--V){var ne=this.tryEntries[V];if(ne.tryLoc<=this.prev&&n.call(ne,"finallyLoc")&&this.prev<ne.finallyLoc){var J=ne;break}}J&&(D==="break"||D==="continue")&&J.tryLoc<=U&&U<=J.finallyLoc&&(J=null);var $=J?J.completion:{};return $.type=D,$.arg=U,J?(this.method="next",this.next=J.finallyLoc,f):this.complete($)},complete:function(D,U){if(D.type==="throw")throw D.arg;return D.type==="break"||D.type==="continue"?this.next=D.arg:D.type==="return"?(this.rval=this.arg=D.arg,this.method="return",this.next="end"):D.type==="normal"&&U&&(this.next=U),f},finish:function(D){for(var U=this.tryEntries.length-1;U>=0;--U){var V=this.tryEntries[U];if(V.finallyLoc===D)return this.complete(V.completion,V.afterLoc),k(V),f}},catch:function(D){for(var U=this.tryEntries.length-1;U>=0;--U){var V=this.tryEntries[U];if(V.tryLoc===D){var ne=V.completion;if(ne.type==="throw"){var J=ne.arg;k(V)}return J}}throw new Error("illegal catch attempt")},delegateYield:function(D,U,V){return this.delegate={iterator:G(D),resultName:U,nextLoc:V},this.method==="next"&&(this.arg=void 0),f}},e}Qy.exports=Tse,Qy.exports.__esModule=!0,Qy.exports.default=Qy.exports});var Y0=Y((Uun,Pse)=>{_();var I4=bse()();Pse.exports=I4;try{regeneratorRuntime=I4}catch(e){typeof globalThis=="object"?globalThis.regeneratorRuntime=I4:Function("r","regeneratorRuntime = r")(I4)}});var WW=Y((Kun,PI)=>{_();function Y4e(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,a=new Array(r);n<r;n++)a[n]=e[n];return a}PI.exports=Y4e,PI.exports.__esModule=!0,PI.exports.default=PI.exports});var Ese=Y((Wun,EI)=>{_();var J4e=WW();function X4e(e){if(Array.isArray(e))return J4e(e)}EI.exports=X4e,EI.exports.__esModule=!0,EI.exports.default=EI.exports});var jW=Y((Hun,NI)=>{_();function Z4e(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}NI.exports=Z4e,NI.exports.__esModule=!0,NI.exports.default=NI.exports});var M4=Y((zun,AI)=>{_();var Nse=WW();function $4e(e,r){if(e){if(typeof e=="string")return Nse(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Nse(e,r)}}AI.exports=$4e,AI.exports.__esModule=!0,AI.exports.default=AI.exports});var Ase=Y((Jun,OI)=>{_();function eLe(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}OI.exports=eLe,OI.exports.__esModule=!0,OI.exports.default=OI.exports});var L_=Y((Zun,kI)=>{_();var rLe=Ese(),nLe=jW(),tLe=M4(),aLe=Ase();function iLe(e){return rLe(e)||nLe(e)||tLe(e)||aLe()}kI.exports=iLe,kI.exports.__esModule=!0,kI.exports.default=kI.exports});var hb=Y((esn,zy)=>{_();function HW(){return zy.exports=HW=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},zy.exports.__esModule=!0,zy.exports.default=zy.exports,HW.apply(this,arguments)}zy.exports=HW,zy.exports.__esModule=!0,zy.exports.default=zy.exports});var at=Y((nsn,FI)=>{_();function oLe(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}FI.exports=oLe,FI.exports.__esModule=!0,FI.exports.default=FI.exports});var kse=Y((asn,II)=>{_();var Ose=bI().default;function uLe(e,r){if(Ose(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r||"default");if(Ose(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}II.exports=uLe,II.exports.__esModule=!0,II.exports.default=II.exports});var QW=Y((osn,MI)=>{_();var sLe=bI().default,lLe=kse();function cLe(e){var r=lLe(e,"string");return sLe(r)==="symbol"?r:String(r)}MI.exports=cLe,MI.exports.__esModule=!0,MI.exports.default=MI.exports});var it=Y((ssn,wI)=>{_();var dLe=QW();function Fse(e,r){for(var n=0;n<r.length;n++){var a=r[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,dLe(a.key),a)}}function fLe(e,r,n){return r&&Fse(e.prototype,r),n&&Fse(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}wI.exports=fLe,wI.exports.__esModule=!0,wI.exports.default=wI.exports});var zW=Y(w4=>{_();var Ise=An();Object.defineProperty(w4,"__esModule",{value:!0});w4.NoopLogger=void 0;var pLe=Ise(at()),mLe=Ise(it()),gLe=function(){function e(){(0,pLe.default)(this,e)}return(0,mLe.default)(e,[{key:"sendTraceTag",value:function(){}},{key:"shipAssertTag",value:function(){}},{key:"debugAssertTag",value:function(){}},{key:"setCorrelationId",value:function(){}}]),e}();w4.NoopLogger=gLe});var BN=Y(DI=>{_();Object.defineProperty(DI,"__esModule",{value:!0});DI.TraceLevel=void 0;var YW;DI.TraceLevel=YW;(function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"})(YW||(DI.TraceLevel=YW={}))});var Yy=Y(xI=>{_();Object.defineProperty(xI,"__esModule",{value:!0});xI.LogCategory=void 0;var JW;xI.LogCategory=JW;(function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",e[e.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WacFeedback=356]="msoulscat_Wac_WacFeedback",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptDataSync=844]="msoulscat_Wac_PptDataSync",e[e.msoulscat_Wac_PptFluidRuntime=848]="msoulscat_Wac_PptFluidRuntime",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",e[e.msoulscat_Wac_PptVideos=846]="msoulscat_Wac_PptVideos",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_OAuth=3e3]="msoulscat_Wac_OAuth",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",e[e.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",e[e.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost",e[e.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools",e[e.msoulscat_Osf_Latency=1401]="msoulscat_Osf_Latency",e[e.msoulscat_Osf_Notification=1402]="msoulscat_Osf_Notification",e[e.msoulscat_Osf_Runtime=1403]="msoulscat_Osf_Runtime",e[e.msoulscat_Wac_AiMaker=3041]="msoulscat_Wac_AiMaker",e[e.msoulscat_Wac_AiRewrite=3043]="msoulscat_Wac_AiRewrite",e[e.msoulscat_Wac_AiInsert=3044]="msoulscat_Wac_AiInsert",e[e.msoulscat_Wac_AiSummarize=3047]="msoulscat_Wac_AiSummarize",e[e.msoulscat_Wac_CopilotCompose=3048]="msoulscat_Wac_CopilotCompose",e[e.msoulscat_Wac_Skittles=3049]="msoulscat_Wac_Skittles"})(JW||(xI.LogCategory=JW={}))});var XW=Y(x4=>{_();var Mse=An();Object.defineProperty(x4,"__esModule",{value:!0});x4.ConsoleLogger=void 0;var vLe=Mse(at()),hLe=Mse(it()),LI=BN(),SLe=Yy(),D4=function(){function e(){(0,vLe.default)(this,e),this.correlationId=""}return(0,hLe.default)(e,[{key:"getLogMessage",value:function(n,a,o){var u="tag_"+e.tagIntToString(n)+" ["+SLe.LogCategory[a]+"] "+o;return this.correlationId&&this.correlationId!==""&&(u+="		"+this.correlationId),u}},{key:"sendTraceTag",value:function(n,a,o,u){var t=this.logMessage;switch(o){case LI.TraceLevel.Error:t=this.logError;break;case LI.TraceLevel.Warning:t=this.logWarning;break;case LI.TraceLevel.Info:t=this.logInfo;break;case LI.TraceLevel.Verbose:t=this.logVerbose;break;case LI.TraceLevel.Spam:default:t=this.logMessage;break}try{t(this.getLogMessage(n,a,u))}catch(s){var d=typeof navigator!="undefined"?navigator:void 0;if(d&&!/rv:11.0/i.test(d.userAgent))throw s}}},{key:"shipAssertTag",value:function(n,a,o,u){console.assert(o,this.getLogMessage(n,a,u))}},{key:"debugAssertTag",value:function(n,a,o,u){this.shipAssertTag(n,a,o,u)}},{key:"setCorrelationId",value:function(n){this.correlationId=n}},{key:"logMessage",value:function(n){"log"in console&&console.log(n)}},{key:"logError",value:function(n){"error"in console&&console.error(n)}},{key:"logWarning",value:function(n){"warn"in console&&console.warn(n)}},{key:"logInfo",value:function(n){"info"in console&&console.info(n)}},{key:"logVerbose",value:function(n){"debug"in console&&console.debug(n)}}],[{key:"tagIntToString",value:function(n){return n<=e.maxNumericTag?n.toString():n>>24>=this.minOldSchemeHighByteValue?String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255):e.map.charAt(n>>24&63)+e.map.charAt(n>>18&63)+e.map.charAt(n>>12&63)+e.map.charAt(n>>6&63)+e.map.charAt(n&63)}}]),e}();x4.ConsoleLogger=D4;D4.maxNumericTag=65535;D4.minOldSchemeHighByteValue=36;D4.map="abcdefghijklmnopqrstuvwxyz0123456789"});var ZW=Y(Sb=>{_();var wse=An();Object.defineProperty(Sb,"__esModule",{value:!0});Sb.UlsLoggerWrapper=Sb.ULS=void 0;Sb.initializeLogger=RLe;var yLe=wse(at()),CLe=wse(it()),_Le=zW(),Ssn=XW(),Dse=function(){function e(){(0,yLe.default)(this,e),this.externalLogger=new _Le.NoopLogger}return(0,CLe.default)(e,[{key:"setCorrelationId",value:function(n){this.externalLogger.setCorrelationId(n)}},{key:"setLogger",value:function(n){this.externalLogger=n}},{key:"sendTraceTag",value:function(n,a,o,u){this.externalLogger.sendTraceTag(n,a,o,u)}},{key:"debugAssertTag",value:function(n,a,o,u){this.externalLogger.debugAssertTag(n,a,o,u)}},{key:"shipAssertTag",value:function(n,a,o,u){this.externalLogger.shipAssertTag(n,a,o,u)}}]),e}();Sb.UlsLoggerWrapper=Dse;var xse=new Dse;Sb.ULS=xse;function RLe(e){if(!e)throw new Error("The 'logger' argument is missing");xse.setLogger(e)}});var ej=Y(BI=>{_();Object.defineProperty(BI,"__esModule",{value:!0});BI.LogType=void 0;var $W;BI.LogType=$W;(function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"})($W||(BI.LogType=$W={}))});var nj=Y(rj=>{_();Object.defineProperty(rj,"__esModule",{value:!0});rj.uploadLogs=TLe;function TLe(e,r,n){if(r){var a=window.navigator;if(a&&a.sendBeacon)try{a.sendBeacon(r,e);return}catch(o){}bLe(e,r,n)}}function bLe(e,r,n){var a=new XMLHttpRequest;(a.readyState===XMLHttpRequest.UNSENT||a.readyState===XMLHttpRequest.DONE)&&(a.open("POST",r,n),a.send(e))}});var aj=Y(tj=>{_();Object.defineProperty(tj,"__esModule",{value:!0});tj.formatForUpload=PLe;function PLe(e,r,n,a){var o=[],u=e.map(function(d){return NLe(d,a,o)}),t=ALe(a,u,r,n,o);return JSON.stringify(t)}var ELe=1e3;function NLe(e,r,n){var a={};if(a.G=e.tag,a.T=e.timestamp-r,a.M=e.message,a.C=e.category,e.correlationId){var o=n.findIndex(function(t){return t===e.correlationId});o<0&&(o=n.push(e.correlationId)-1),a.I=o}var u=e.type*ELe+e.level;return a.D=u,a}function ALe(e,r,n,a,o){var u={};return u.T=e,u.L=r,u.S=n,u.I=a,o&&o.length>0&&(u.W=o),u.V=1,u}});var Bse=Y(L4=>{_();var Lse=An();Object.defineProperty(L4,"__esModule",{value:!0});L4.bUlsCache=void 0;var OLe=Lse(at()),kLe=Lse(it()),FLe=nj(),ILe=aj(),MLe=BN(),qI=function(){function e(r,n,a){var o=this;(0,OLe.default)(this,e),this.uploadId=0,this.logCache=[],this.timestampBase=Date.now(),this.userSessionId="00000000-0000-0000-0000-000000000000",this.flushOnClose=function(){o.triggerUpload(!1,!1)},this.flush=function(){o.triggerUploadAsync()},this.triggerUploadAsync=function(){window.setTimeout(function(){return o.triggerUpload(!0,!0)},0)},this.triggerUpload=function(t,d){if(window.clearTimeout(o.timeoutId),o.logCache.length>0){o.uploadId+=1;var s=(0,ILe.formatForUpload)(o.logCache,o.userSessionId,o.uploadId,o.timestampBase);(0,FLe.uploadLogs)(s,o.remoteUrlEndpoint,d),o.logCache=[],o.timestampBase=Date.now()}t&&(o.timeoutId=window.setTimeout(o.triggerUploadAsync,e.uploadCadenceInMsSec))},this.userSessionId=r;var u=n+"?usid="+r;a!==void 0&&a.forEach(function(t,d){u+="&"+d+"="+t}),this.remoteUrlEndpoint=u,window.setTimeout(function(){return o.triggerUpload(!0,!0)},0)}return(0,kLe.default)(e,[{key:"handleTrace",value:function(n){n.message.length>e.messageMaxChars&&(n.message=n.message.substr(0,e.messageMaxChars-e.trimmedMessage.length)+e.trimmedMessage),this.logCache.push(n),(this.logCache.length>e.uploadTriggerSize||n.level===MLe.TraceLevel.Error)&&this.triggerUploadAsync()}}]),e}();L4.bUlsCache=qI;qI.messageMaxChars=3072;qI.uploadCadenceInMsSec=3e4;qI.uploadTriggerSize=30;qI.trimmedMessage="... [Trimmed]"});var Kse=Y(qN=>{_();var qse=An();Object.defineProperty(qN,"__esModule",{value:!0});qN.RemoteUlsLogger=void 0;qN.getUlsLogger=LLe;qN.getUlsLoggerDeprecated=BLe;var wLe=qse(at()),DLe=qse(it()),xLe=ej(),Use=Bse(),ij=BN(),Gse=function(){function e(r,n,a){(0,wLe.default)(this,e),this.correlationId="",this.cache=new Use.bUlsCache(r,n,a)}return(0,DLe.default)(e,[{key:"setCorrelationId",value:function(n){this.correlationId=n}},{key:"sendTraceTag",value:function(n,a,o,u){B4(this.cache,n,a,o,u,this.correlationId)}},{key:"debugAssertTag",value:function(n,a,o,u){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")}},{key:"shipAssertTag",value:function(n,a,o,u){o&&B4(this.cache,n,a,ij.TraceLevel.Error,u,this.correlationId)}},{key:"flush",value:function(){this.cache.flush()}},{key:"flushOnClose",value:function(){this.cache.flushOnClose}}]),e}();qN.RemoteUlsLogger=Gse;function LLe(e,r){return new Gse(e,r)}function BLe(e,r){var n=new Use.bUlsCache(e,r);return{sendTraceTag:function(o,u,t,d){return B4(n,o,u,t,d,"")},shipAssertTag:function(o,u,t,d){t&&B4(n,o,u,ij.TraceLevel.Error,d,"")},debugAssertTag:function(){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:n.flush,flushOnClose:n.flushOnClose,setCorrelationId:function(){}}}function B4(e,r,n,a,o,u){var t=ij.TraceLevel.Info;if(!(a>t)){var d={timestamp:Date.now(),category:n,tag:r,level:a,type:xLe.LogType.Trace,message:o,correlationId:u};e.handleTrace(d)}}});var Wse=Y(Vse=>{_();Object.defineProperty(Vse,"__esModule",{value:!0})});var q4=Y((Msn,Jy)=>{_();function oj(e,r){return Jy.exports=oj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,o){return a.__proto__=o,a},Jy.exports.__esModule=!0,Jy.exports.default=Jy.exports,oj(e,r)}Jy.exports=oj,Jy.exports.__esModule=!0,Jy.exports.default=Jy.exports});var Qf=Y((Dsn,UI)=>{_();var qLe=q4();function ULe(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&qLe(e,r)}UI.exports=ULe,UI.exports.__esModule=!0,UI.exports.default=UI.exports});var uj=Y((Lsn,GI)=>{_();function GLe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}GI.exports=GLe,GI.exports.__esModule=!0,GI.exports.default=GI.exports});var zf=Y((qsn,KI)=>{_();var KLe=bI().default,VLe=uj();function WLe(e,r){if(r&&(KLe(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VLe(e)}KI.exports=WLe,KI.exports.__esModule=!0,KI.exports.default=KI.exports});var Ed=Y((Gsn,Xy)=>{_();function sj(e){return Xy.exports=sj=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Xy.exports.__esModule=!0,Xy.exports.default=Xy.exports,sj(e)}Xy.exports=sj,Xy.exports.__esModule=!0,Xy.exports.default=Xy.exports});var Hse=Y(U4=>{_();var VI=An();Object.defineProperty(U4,"__esModule",{value:!0});U4.UnitTestLogger=void 0;var jLe=VI(it()),HLe=VI(at()),QLe=VI(Qf()),zLe=VI(zf()),jse=VI(Ed()),YLe=zW();function JLe(e){var r=XLe();return function(){var a=(0,jse.default)(e),o;if(r){var u=(0,jse.default)(this).constructor;o=Reflect.construct(a,arguments,u)}else o=a.apply(this,arguments);return(0,zLe.default)(this,o)}}function XLe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var ZLe=function(e){(0,QLe.default)(n,e);var r=JLe(n);function n(){return(0,HLe.default)(this,n),r.apply(this,arguments)}return(0,jLe.default)(n)}(YLe.NoopLogger);U4.UnitTestLogger=ZLe});var zse=Y(G4=>{_();var Qse=An();Object.defineProperty(G4,"__esModule",{value:!0});G4.CategoryLogger=void 0;var $Le=Qse(at()),e5e=Qse(it()),lj=BN(),cj=ZW(),r5e=function(){function e(r){(0,$Le.default)(this,e),this.category=r,this.category=r}return(0,e5e.default)(e,[{key:"info",value:function(n,a){for(var o=arguments.length,u=new Array(o>2?o-2:0),t=2;t<o;t++)u[t-2]=arguments[t];cj.ULS.sendTraceTag(n,this.category,lj.TraceLevel.Info,this.messageToLog(a,u))}},{key:"warn",value:function(n,a){for(var o=arguments.length,u=new Array(o>2?o-2:0),t=2;t<o;t++)u[t-2]=arguments[t];cj.ULS.sendTraceTag(n,this.category,lj.TraceLevel.Warning,this.messageToLog(a,u))}},{key:"error",value:function(n,a){for(var o=arguments.length,u=new Array(o>2?o-2:0),t=2;t<o;t++)u[t-2]=arguments[t];cj.ULS.sendTraceTag(n,this.category,lj.TraceLevel.Error,this.messageToLog(a,u))}},{key:"messageToLog",value:function(n){for(var a=arguments.length,o=new Array(a>1?a-1:0),u=1;u<a;u++)o[u-1]=arguments[u];if(!o.length)return n;var t=o.map(function(d){return JSON.stringify(d)}).join(", ");return n+": "+t}}]),e}();G4.CategoryLogger=r5e});var yb=Y(Co=>{_();Object.defineProperty(Co,"__esModule",{value:!0});var dj=ZW();Object.keys(dj).forEach(function(e){e==="default"||e==="__esModule"||e in Co&&Co[e]===dj[e]||Object.defineProperty(Co,e,{enumerable:!0,get:function(){return dj[e]}})});var fj=Kse();Object.keys(fj).forEach(function(e){e==="default"||e==="__esModule"||e in Co&&Co[e]===fj[e]||Object.defineProperty(Co,e,{enumerable:!0,get:function(){return fj[e]}})});var pj=aj();Object.keys(pj).forEach(function(e){e==="default"||e==="__esModule"||e in Co&&Co[e]===pj[e]||Object.defineProperty(Co,e,{enumerable:!0,get:function(){return pj[e]}})});var mj=nj();Object.keys(mj).forEach(function(e){e==="default"||e==="__esModule"||e in Co&&Co[e]===mj[e]||Object.defineProperty(Co,e,{enumerable:!0,get:function(){return mj[e]}})});var gj=Yy();Object.keys(gj).forEach(function(e){e==="default"||e==="__esModule"||e in Co&&Co[e]===gj[e]||Object.defineProperty(Co,e,{enumerable:!0,get:function(){return gj[e]}})});var vj=Wse();Object.keys(vj).forEach(function(e){e==="default"||e==="__esModule"||e in Co&&Co[e]===vj[e]||Object.defineProperty(Co,e,{enumerable:!0,get:function(){return vj[e]}})});var hj=ej();Object.keys(hj).forEach(function(e){e==="default"||e==="__esModule"||e in Co&&Co[e]===hj[e]||Object.defineProperty(Co,e,{enumerable:!0,get:function(){return hj[e]}})});var Sj=BN();Object.keys(Sj).forEach(function(e){e==="default"||e==="__esModule"||e in Co&&Co[e]===Sj[e]||Object.defineProperty(Co,e,{enumerable:!0,get:function(){return Sj[e]}})});var yj=Hse();Object.keys(yj).forEach(function(e){e==="default"||e==="__esModule"||e in Co&&Co[e]===yj[e]||Object.defineProperty(Co,e,{enumerable:!0,get:function(){return yj[e]}})});var Cj=XW();Object.keys(Cj).forEach(function(e){e==="default"||e==="__esModule"||e in Co&&Co[e]===Cj[e]||Object.defineProperty(Co,e,{enumerable:!0,get:function(){return Cj[e]}})});var _j=zse();Object.keys(_j).forEach(function(e){e==="default"||e==="__esModule"||e in Co&&Co[e]===_j[e]||Object.defineProperty(Co,e,{enumerable:!0,get:function(){return _j[e]}})})});var Jse=Y((Ysn,Yse)=>{"use strict";_();Yse.exports=function(){return typeof globalThis!="object"||!globalThis?!1:globalThis.Array===Array}});var $se=Y((Xsn,Zse)=>{_();var Xse=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};Zse.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return Xse()}try{return __global__||Xse()}finally{delete Object.prototype.__global__}}()});var Rj=Y(($sn,ele)=>{"use strict";_();ele.exports=Jse()()?globalThis:$se()});var Tj=Y(K4=>{_();Object.defineProperty(K4,"__esModule",{value:!0});K4.globalThis=void 0;var n5e=t5e(Rj());function rle(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,n=new WeakMap;return(rle=function(o){return o?n:r})(e)}function t5e(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var n=rle(r);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(u!=="default"&&Object.prototype.hasOwnProperty.call(e,u)){var t=o?Object.getOwnPropertyDescriptor(e,u):null;t&&(t.get||t.set)?Object.defineProperty(a,u,t):a[u]=e[u]}return a.default=e,n&&n.set(e,a),a}var a5e=n5e;K4.globalThis=a5e});var j4=Y(B_=>{_();Object.defineProperty(B_,"__esModule",{value:!0});B_.getBooleanFeatureGate=o5e;B_.getFeatureGateDictionary=nle;B_.getIntFeatureGate=s5e;B_.getNumberFeatureGate=u5e;B_.getStringFeatureGate=W4;B_.setFeatureGateDictionaryGetter=l5e;var V4=Tj(),i5e={};function nle(){return typeof V4.globalThis.__get_feature_gate_dictionary_variable=="undefined"?i5e:V4.globalThis.__get_feature_gate_dictionary_variable()}function W4(e,r){var n;return(n=nle()[e])!=null?n:r}function o5e(e,r){var n,a=(n=W4(e))==null?void 0:n.trim().toLowerCase();return a==="true"?!0:a==="false"?!1:r}function u5e(e,r){var n,a=(n=W4(e))==null?void 0:n.trim().toLowerCase();if(a===void 0)return r;if(a==="infinity"||a==="+infinity")return 1/0;if(a==="-infinity")return-(1/0);var o=parseFloat(a);return isNaN(o)?r:o}function s5e(e,r){var n,a=(n=W4(e))==null?void 0:n.trim();if(a===void 0)return r;var o=parseInt(a,10);return isNaN(o)?r:o}function l5e(e){var r=V4.globalThis.__get_feature_gate_dictionary_variable;return V4.globalThis.__get_feature_gate_dictionary_variable=e,r}});var tle=Y(Pj=>{_();Object.defineProperty(Pj,"__esModule",{value:!0});Pj.makeGetTypedFeatureGate=c5e;var bj=j4();function c5e(e){function r(n){var a=e[n];switch(typeof a){case"boolean":return(0,bj.getBooleanFeatureGate)(n,a);case"number":return(0,bj.getNumberFeatureGate)(n,a);case"string":return(0,bj.getStringFeatureGate)(n,a);default:throw new Error("Wrong defaultValue type")}}return r}});var Q4=Y(WI=>{_();Object.defineProperty(WI,"__esModule",{value:!0});WI.getChangeGateDictionary=ale;WI.isChangeGateEnabled=d5e;WI.setChangeGateDictionaryGetter=f5e;var H4=Tj();function ale(){return typeof H4.globalThis.__get_change_gate_dictionary_variable=="undefined"?{}:H4.globalThis.__get_change_gate_dictionary_variable()}function d5e(e){var r,n=ale();return(r=n[e])!=null?r:!0}function f5e(e){var r=H4.globalThis.__get_change_gate_dictionary_variable;return H4.globalThis.__get_change_gate_dictionary_variable=e,r}});var ile=Y(Ej=>{_();Object.defineProperty(Ej,"__esModule",{value:!0});Ej.makeTypedIsChangeGateEnabled=m5e;var p5e=Q4();function m5e(e){return function(r){return(0,p5e.isChangeGateEnabled)(r)}}});var sle=Y(z4=>{_();var g5e=An();Object.defineProperty(z4,"__esModule",{value:!0});z4.overrideChangeGates=ule;z4.overrideTypedChangeGates=h5e;var v5e=g5e(hb()),ole=Q4();function ule(e){var r=(0,ole.setChangeGateDictionaryGetter)(void 0);return(0,ole.setChangeGateDictionaryGetter)(function(){var n=r!==void 0?r():{};return(0,v5e.default)({},n,e)}),r}function h5e(e,r){return ule(r)}});var dle=Y(Y4=>{_();var S5e=An();Object.defineProperty(Y4,"__esModule",{value:!0});Y4.overrideFeatureGates=cle;Y4.overrideTypedFeatureGates=C5e;var y5e=S5e(hb()),lle=j4();function cle(e){for(var r,n={},a=0,o=Object.keys(e);a<o.length;a++){var u,t=o[a];n[t]=(u=e[t])==null?void 0:u.toString()}var d=function(){return{}},s=(r=(0,lle.setFeatureGateDictionaryGetter)(void 0))!=null?r:d;return(0,lle.setFeatureGateDictionaryGetter)(function(){return(0,y5e.default)({},s(),n)}),s}function C5e(e,r){return cle(r)}});var jI=Y(Vc=>{_();Object.defineProperty(Vc,"__esModule",{value:!0});var Nj=j4();Object.keys(Nj).forEach(function(e){e==="default"||e==="__esModule"||e in Vc&&Vc[e]===Nj[e]||Object.defineProperty(Vc,e,{enumerable:!0,get:function(){return Nj[e]}})});var Aj=tle();Object.keys(Aj).forEach(function(e){e==="default"||e==="__esModule"||e in Vc&&Vc[e]===Aj[e]||Object.defineProperty(Vc,e,{enumerable:!0,get:function(){return Aj[e]}})});var Oj=Q4();Object.keys(Oj).forEach(function(e){e==="default"||e==="__esModule"||e in Vc&&Vc[e]===Oj[e]||Object.defineProperty(Vc,e,{enumerable:!0,get:function(){return Oj[e]}})});var kj=ile();Object.keys(kj).forEach(function(e){e==="default"||e==="__esModule"||e in Vc&&Vc[e]===kj[e]||Object.defineProperty(Vc,e,{enumerable:!0,get:function(){return kj[e]}})});var Fj=sle();Object.keys(Fj).forEach(function(e){e==="default"||e==="__esModule"||e in Vc&&Vc[e]===Fj[e]||Object.defineProperty(Vc,e,{enumerable:!0,get:function(){return Fj[e]}})});var Ij=dle();Object.keys(Ij).forEach(function(e){e==="default"||e==="__esModule"||e in Vc&&Vc[e]===Ij[e]||Object.defineProperty(Vc,e,{enumerable:!0,get:function(){return Ij[e]}})})});var fle=Y(US=>{_();Object.defineProperty(US,"__esModule",{value:!0});US.setFeatureGateManager=US.getStringFeatureGate=US.getIntFeatureGate=US.getBooleanFeatureGate=void 0;var Cb,_5e=function(r){Cb=r};US.setFeatureGateManager=_5e;var R5e=function(r,n){return Cb?Cb.getIntFeatureGate(r,n):n};US.getIntFeatureGate=R5e;var T5e=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return Cb?Cb.getBooleanFeatureGate(r,n):n};US.getBooleanFeatureGate=T5e;var b5e=function(r,n){return Cb?Cb.getStringFeatureGate(r,n):n};US.getStringFeatureGate=b5e});var ple=Y(()=>{_()});var Dj=Y(q_=>{_();Object.defineProperty(q_,"__esModule",{value:!0});var Mj=fle();Object.keys(Mj).forEach(function(e){e==="default"||e==="__esModule"||e in q_&&q_[e]===Mj[e]||Object.defineProperty(q_,e,{enumerable:!0,get:function(){return Mj[e]}})});var wj=ple();Object.keys(wj).forEach(function(e){e==="default"||e==="__esModule"||e in q_&&q_[e]===wj[e]||Object.defineProperty(q_,e,{enumerable:!0,get:function(){return wj[e]}})})});var Lj=Y(Nh=>{_();Object.defineProperty(Nh,"__esModule",{value:!0});Nh.getAppSettingValue=HI;Nh.getListAppSetting=k5e;Nh.isChangeGateEnabledInAppSetting=F5e;Nh.isChangeGateEnabledInAppSettingWithDelimiter=I5e;Nh.isFeatureEnabled=A5e;Nh.setAppSettingValueForTest=O5e;Nh.setAppSettings=J4;Nh.setIsFeatureEnabledCallback=N5e;Nh.setTestAppSettings=E5e;var P5e=Dj(),Eh,UN,xj;function J4(e){Eh=e;try{UN=JSON.parse(HI("DisabledChangeGates","{}"))}catch(r){UN={}}}function E5e(e){var r=Eh;return J4(e),function(){J4(r)}}function N5e(e){xj=e}function A5e(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=xj?xj(e):!!Eh&&!!Eh[e]&&Eh[e].toLowerCase()==="true";return n||(0,P5e.getBooleanFeatureGate)(e,r)}function HI(e,r){return!Eh||!Eh[e]?r:Eh[e]}function O5e(e,r){Eh||J4({});var n=Eh[e];return Eh[e]=r,n}function k5e(e){var r=HI(e,"[]");return JSON.parse(r)}function F5e(e,r){var n=HI(e,"");return!(UN&&r in UN)&&!n.split(",").some(function(a){return a===r})}function I5e(e,r,n){var a=HI(e,"");return!(UN&&r in UN)&&!a.split(n).some(function(o){return o.trim()===r})}});var mle=Y(GN=>{_();Object.defineProperty(GN,"__esModule",{value:!0});GN.getDeploymentRing=GN.getAppSettingsForDeploymentRingValueForTest=void 0;var M5e=Lj(),w5e=function(){var r=(0,M5e.getAppSettingValue)("StatusBarEnvironmentNameToUse","").toLowerCase();return r.length===0?"production":r.indexOf("outer ring")>=0?"outer-ring":r.indexOf("inner ring")>=0?"inner-ring":r.indexOf("dev box")>=0?"dev-box":"production"};GN.getDeploymentRing=w5e;var D5e=function(r){var n=r==="production"?"":r==="outer-ring"?"Outer Ring (PPE) : FakeDC2":r==="inner-ring"?"Inner Ring (Fastfood) : FakeDC1":"Dev Box";return{StatusBarEnvironmentNameToUse:n}};GN.getAppSettingsForDeploymentRingValueForTest=D5e});var Bj=Y(Ah=>{_();Object.defineProperty(Ah,"__esModule",{value:!0});Object.defineProperty(Ah,"AppSettingsDictionary",{enumerable:!0,get:function(){return _b.AppSettingsDictionary}});Object.defineProperty(Ah,"DeploymentRing",{enumerable:!0,get:function(){return gle.DeploymentRing}});Object.defineProperty(Ah,"getAppSettingValue",{enumerable:!0,get:function(){return _b.getAppSettingValue}});Object.defineProperty(Ah,"getDeploymentRing",{enumerable:!0,get:function(){return gle.getDeploymentRing}});Object.defineProperty(Ah,"getListAppSetting",{enumerable:!0,get:function(){return _b.getListAppSetting}});Object.defineProperty(Ah,"isChangeGateEnabledInAppSetting",{enumerable:!0,get:function(){return _b.isChangeGateEnabledInAppSetting}});Object.defineProperty(Ah,"isFeatureEnabled",{enumerable:!0,get:function(){return _b.isFeatureEnabled}});Object.defineProperty(Ah,"setAppSettings",{enumerable:!0,get:function(){return _b.setAppSettings}});Object.defineProperty(Ah,"setIsFeatureEnabledCallback",{enumerable:!0,get:function(){return _b.setIsFeatureEnabledCallback}});var _b=Lj(),gle=mle()});var hle=Y(qj=>{_();Object.defineProperty(qj,"__esModule",{value:!0});qj.setWebpackPublicPath=x5e;var vle=Bj();function x5e(e){var r=e;(0,vle.isFeatureEnabled)("AppChromeOverrideEnabled")&&(r=(0,vle.getAppSettingValue)("AppChromeBaseScriptUrlOverride","")),__webpack_public_path__=__webpack_public_path__||r}});var Sle=Y(QI=>{_();Object.defineProperty(QI,"__esModule",{value:!0});var Uj=hle();Object.keys(Uj).forEach(function(e){e==="default"||e==="__esModule"||e in QI&&QI[e]===Uj[e]||Object.defineProperty(QI,e,{enumerable:!0,get:function(){return Uj[e]}})})});var yle=Y(Oh=>{_();Object.defineProperty(Oh,"__esModule",{value:!0});var Gj=Bj();Object.keys(Gj).forEach(function(e){e==="default"||e==="__esModule"||e in Oh&&Oh[e]===Gj[e]||Object.defineProperty(Oh,e,{enumerable:!0,get:function(){return Gj[e]}})});var Kj=Sle();Object.keys(Kj).forEach(function(e){e==="default"||e==="__esModule"||e in Oh&&Oh[e]===Kj[e]||Object.defineProperty(Oh,e,{enumerable:!0,get:function(){return Kj[e]}})});var Vj=Dj();Object.keys(Vj).forEach(function(e){e==="default"||e==="__esModule"||e in Oh&&Oh[e]===Vj[e]||Object.defineProperty(Oh,e,{enumerable:!0,get:function(){return Vj[e]}})})});var jj=Y(Wj=>{_();var L5e=An();Object.defineProperty(Wj,"__esModule",{value:!0});Wj.configureGating=G5e;var B5e=L5e(hb()),Cle=yb(),_le=jI(),q5e=yle(),U5e="Microsoft.Office.",Rle="Microsoft.Office.Excel.";function G5e(e){(0,_le.setFeatureGateDictionaryGetter)(function(){return e}),(0,_le.setChangeGateDictionaryGetter)(function(){return V5e(e)}),(0,q5e.setIsFeatureEnabledCallback)(function(r){return Cle.ULS.shipAssertTag(508864162,Cle.LogCategory.msoulscat_ES_EWAJS,!1,"The deprecated office-online-app-platform's isFeatureEnabled API was called on feature gate '"+r+"'. Please switch over to office-online-feature-gates' getBooleanFeatureGate API."),e[r]==="true"||!r.startsWith(U5e)&&e[Rle+r]==="true"})}var K5e="Microsoft.Office.Excel.OfficeVSO:";function V5e(e){var r=(0,B5e.default)({},e);for(var n in Object.keys(e))if(n.startsWith(K5e)){var a=n.replace(Rle,"");a.length>0&&(r[a]=e[n])}return r}});var Tle=Y(zI=>{_();Object.defineProperty(zI,"__esModule",{value:!0});var Hj=jj();Object.keys(Hj).forEach(function(e){e==="default"||e==="__esModule"||e in zI&&zI[e]===Hj[e]||Object.defineProperty(zI,e,{enumerable:!0,get:function(){return Hj[e]}})})});var Ec=Y((Uln,ble)=>{_();ble.exports=OfficePlatformGlobal.Reka});var Nle=Y(YI=>{_();var Ple=An();Object.defineProperty(YI,"__esModule",{value:!0});YI.MockRekaBridge=void 0;YI.initMockRekaBridge=Q5e;var W5e=Ple(at()),j5e=Ple(it()),H5e=Ec(),Ele=function(){function e(){(0,W5e.default)(this,e),this.RekaConstants={}}return(0,j5e.default)(e,[{key:"invokeNative",value:function(n){}}]),e}();YI.MockRekaBridge=Ele;function Q5e(){for(var e=new Ele,r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];H5e.RekaInstance.initBridge(e,n)}});var Ale=Y(JI=>{_();Object.defineProperty(JI,"__esModule",{value:!0});var Qj=Nle();Object.keys(Qj).forEach(function(e){e==="default"||e==="__esModule"||e in JI&&JI[e]===Qj[e]||Object.defineProperty(JI,e,{enumerable:!0,get:function(){return Qj[e]}})})});var Fle=Y(KN=>{_();var Ole=An();Object.defineProperty(KN,"__esModule",{value:!0});KN.ServiceInfos=KN.NativeServices=void 0;var z5e=Ole(at()),Y5e=Ole(it()),J5e=Ec(),kle={ITaskPaneClient2Host:["Uxpp::Internal::RekaServices::ITaskPaneClient2Host",{loaded:["FireAndForgetMethod",[]]}]};KN.ServiceInfos=kle;var X5e=function(){function e(){(0,z5e.default)(this,e)}return(0,Y5e.default)(e,null,[{key:"ITaskPaneClient2Host",get:function(){return e._ITaskPaneClient2Host??=J5e.RekaServiceRegistry.getNativeService(kle.ITaskPaneClient2Host)}}]),e}();KN.NativeServices=X5e});var Ile=Y(X4=>{_();Object.defineProperty(X4,"__esModule",{value:!0});X4.ServiceInfos=void 0;var Z5e={ITaskPaneHost2Client:["Uxpp::Internal::RekaServices::ITaskPaneHost2Client",{start2:["ReturnsPromiseMethod","$number",["Uxpp::TaskPanes::StartParams"]],start:["ReturnsPromiseMethod","$number",["Uxpp::TaskPanes::StartParams"]]}]};X4.ServiceInfos=Z5e});var zj=Y(VN=>{_();var Mle=An();Object.defineProperty(VN,"__esModule",{value:!0});VN.ServiceInfos=VN.NativeServices=void 0;var $5e=Mle(at()),e6e=Mle(it()),r6e=Ec(),wle={Logger:["Uxpp::Internal::RekaServices::Logger",{sendTraceTag:["FireAndForgetMethod",["$number","$number","$string"]],shipAssertTag:["FireAndForgetMethod",["$number","$boolean","$string"]],debugAssertTag:["FireAndForgetMethod",["$number","$boolean","$string"]],setCorrelationId:["FireAndForgetMethod",["$string"]]}]};VN.ServiceInfos=wle;var n6e=function(){function e(){(0,$5e.default)(this,e)}return(0,e6e.default)(e,null,[{key:"Logger",get:function(){return e._Logger??=r6e.RekaServiceRegistry.getNativeService(wle.Logger)}}]),e}();VN.NativeServices=n6e});var Ble=Y(WN=>{_();var Dle=An();Object.defineProperty(WN,"__esModule",{value:!0});WN.ServiceInfos=WN.NativeServices=void 0;var t6e=Dle(at()),a6e=Dle(it()),xle=Ec();xle.CustomTypeRegistry.registerTypeInfos({"Uxpp::RekaServices::PowerOptionsTaskPane::PowerOptionsTaskPaneProps":{pal:["opt-field","$string"]}});var Lle={IPowerOptionsTaskPaneCallbacks:["Uxpp::RekaServices::PowerOptionsTaskPane::IPowerOptionsTaskPaneCallbacks",{do:["FireAndForgetMethod",[]]}]};WN.ServiceInfos=Lle;var i6e=function(){function e(){(0,t6e.default)(this,e)}return(0,a6e.default)(e,null,[{key:"IPowerOptionsTaskPaneCallbacks",get:function(){return e._IPowerOptionsTaskPaneCallbacks??=xle.RekaServiceRegistry.getNativeService(Lle.IPowerOptionsTaskPaneCallbacks)}}]),e}();WN.NativeServices=i6e});var qle=Y(()=>{_();var o6e=Ec();o6e.CustomTypeRegistry.registerTypeInfos({"Uxpp::Internal::RekaServices::ServiceInteropArgs":{serviceName:"$string",methodName:"$string",serializedValue:"$string",taskPaneInstanceId:"$number",promiseId:"$number"}})});var Ule=Y(()=>{_();var u6e=Ec();u6e.CustomTypeRegistry.registerTypeInfos({"Uxpp::TaskPanes::StartParams":{taskPaneId:"$number",propsJson:"$string",themeId:"$number"}})});var Gle=Y(Rb=>{_();Object.defineProperty(Rb,"__esModule",{value:!0});Rb.nativeNamespace=Rb.TraceLevel=void 0;var s6e="Uxpp.Internal.RekaServices";Rb.nativeNamespace=s6e;var Yj;Rb.TraceLevel=Yj;(function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"})(Yj||(Rb.TraceLevel=Yj={}))});var Kle=Y(Jj=>{_();Object.defineProperty(Jj,"__esModule",{value:!0});Object.defineProperty(Jj,"TraceLevel",{enumerable:!0,get:function(){return l6e.TraceLevel}});var l6e=Gle()});var Xj=Y(jN=>{_();var Vle=An();Object.defineProperty(jN,"__esModule",{value:!0});jN.ServiceInfos=jN.NativeServices=void 0;var c6e=Vle(at()),d6e=Vle(it()),f6e=Ec(),Wle={RekaTelemetryAdapter:["Uxpp::RekaServices::RekaTelemetryAdapter",{sendTelemetryEvent:["FireAndForgetMethod",["$string"]]}]};jN.ServiceInfos=Wle;var p6e=function(){function e(){(0,c6e.default)(this,e)}return(0,d6e.default)(e,null,[{key:"RekaTelemetryAdapter",get:function(){return e._RekaTelemetryAdapter??=f6e.RekaServiceRegistry.getNativeService(Wle.RekaTelemetryAdapter)}}]),e}();jN.NativeServices=p6e});var Zj=Y(HN=>{_();var jle=An();Object.defineProperty(HN,"__esModule",{value:!0});HN.ServiceInfos=HN.NativeServices=void 0;var m6e=jle(at()),g6e=jle(it()),v6e=Ec(),Hle={UxppGatesService:["Uxpp::RekaServices::UxppGatesService",{getGates:["ReturnsPromiseMethod",["$indexer","$string"],[]]}]};HN.ServiceInfos=Hle;var h6e=function(){function e(){(0,m6e.default)(this,e)}return(0,g6e.default)(e,null,[{key:"UxppGatesService",get:function(){return e._UxppGatesService??=v6e.RekaServiceRegistry.getNativeService(Hle.UxppGatesService)}}]),e}();HN.NativeServices=h6e});var Yle=Y(QN=>{_();var Qle=An();Object.defineProperty(QN,"__esModule",{value:!0});QN.ServiceInfos=QN.NativeServices=void 0;var S6e=Qle(at()),y6e=Qle(it()),C6e=Ec(),zle={UxppPowerOptionsJsService:["Uxpp::Internal::RekaServices::UxppPowerOptionsJsService",{simulateTestEvent:["ReturnsPromiseMethod","$string",["$string"]],onTestEvent:["Event","$string"]}]};QN.ServiceInfos=zle;var _6e=function(){function e(){(0,S6e.default)(this,e)}return(0,y6e.default)(e,null,[{key:"UxppPowerOptionsJsService",get:function(){return e._UxppPowerOptionsJsService??=C6e.RekaServiceRegistry.getNativeService(zle.UxppPowerOptionsJsService)}}]),e}();QN.NativeServices=_6e});var Zle=Y(zN=>{_();var Jle=An();Object.defineProperty(zN,"__esModule",{value:!0});zN.ServiceInfos=zN.NativeServices=void 0;var R6e=Jle(at()),T6e=Jle(it()),b6e=Ec(),Xle={UxppPowerOptionsService:["Uxpp::Internal::RekaServices::UxppPowerOptionsService",{simulateThemeChange:["FireAndForgetMethod",["$number"]]}]};zN.ServiceInfos=Xle;var P6e=function(){function e(){(0,R6e.default)(this,e)}return(0,T6e.default)(e,null,[{key:"UxppPowerOptionsService",get:function(){return e._UxppPowerOptionsService??=b6e.RekaServiceRegistry.getNativeService(Xle.UxppPowerOptionsService)}}]),e}();zN.NativeServices=P6e});var rce=Y(YN=>{_();var $le=An();Object.defineProperty(YN,"__esModule",{value:!0});YN.ServiceInfos=YN.NativeServices=void 0;var E6e=$le(at()),N6e=$le(it()),A6e=Ec(),ece={UxppRekaServiceManager:["Uxpp::Internal::RekaServices::UxppRekaServiceManager",{indicateStarted:["FireAndForgetMethod",[]],registerServices:["ReturnsPromiseMethod","$any",[["$array","$string"]]],raiseEvent:["FireAndForgetMethod",["$string","$string","$string"]]}]};YN.ServiceInfos=ece;var O6e=function(){function e(){(0,E6e.default)(this,e)}return(0,N6e.default)(e,null,[{key:"UxppRekaServiceManager",get:function(){return e._UxppRekaServiceManager??=A6e.RekaServiceRegistry.getNativeService(ece.UxppRekaServiceManager)}}]),e}();YN.NativeServices=O6e});var nce=Y(Tb=>{_();Object.defineProperty(Tb,"__esModule",{value:!0});Tb.nativeNamespace=Tb.UxppThemeId=void 0;var k6e="Uxpp.TaskPanes";Tb.nativeNamespace=k6e;var $j;Tb.UxppThemeId=$j;(function(e){e[e.Colorful=0]="Colorful",e[e.VeryDark=1]="VeryDark",e[e.Black=2]="Black",e[e.Fresh=3]="Fresh",e[e.MacLight=4]="MacLight",e[e.MacDark=5]="MacDark"})($j||(Tb.UxppThemeId=$j={}))});var tce=Y(eH=>{_();Object.defineProperty(eH,"__esModule",{value:!0});Object.defineProperty(eH,"UxppThemeId",{enumerable:!0,get:function(){return F6e.UxppThemeId}});var F6e=nce()});var oce=Y(JN=>{_();var ace=An();Object.defineProperty(JN,"__esModule",{value:!0});JN.ServiceInfos=JN.NativeServices=void 0;var I6e=ace(at()),M6e=ace(it()),w6e=Ec(),ice={UxppThemeService:["Uxpp::Internal::RekaServices::UxppThemeService",{getCurrentTheme:["ReturnsPromiseMethod","$number",[]],onThemeChange:["Event","$number"]}]};JN.ServiceInfos=ice;var D6e=function(){function e(){(0,I6e.default)(this,e)}return(0,M6e.default)(e,null,[{key:"UxppThemeService",get:function(){return e._UxppThemeService??=w6e.RekaServiceRegistry.getNativeService(ice.UxppThemeService)}}]),e}();JN.NativeServices=D6e});var uce=Y(()=>{_();var x6e=Ec();x6e.CustomTypeRegistry.registerTypeInfos({"Uxpp::TaskPanes::TaskPaneInstance":{instanceId:"$number",taskPaneId:"$number"}})});var cce=Y(XN=>{_();var sce=An();Object.defineProperty(XN,"__esModule",{value:!0});XN.ServiceInfos=XN.NativeServices=void 0;var L6e=sce(at()),B6e=sce(it()),q6e=Ec(),lce={UxppPaneLifecycleService:["Uxpp::Internal::RekaServices::UxppPaneLifecycleService",{onClose:["Event","Uxpp::TaskPanes::TaskPaneInstance"]}]};XN.ServiceInfos=lce;var U6e=function(){function e(){(0,L6e.default)(this,e)}return(0,B6e.default)(e,null,[{key:"UxppPaneLifecycleService",get:function(){return e._UxppPaneLifecycleService??=q6e.RekaServiceRegistry.getNativeService(lce.UxppPaneLifecycleService)}}]),e}();XN.NativeServices=U6e});var fce=Y(wi=>{_();Object.defineProperty(wi,"__esModule",{value:!0});Object.defineProperty(wi,"Gates",{enumerable:!0,get:function(){return $4.Gates}});Object.defineProperty(wi,"IPowerOptionsTaskPaneCallbacks",{enumerable:!0,get:function(){return Z4.IPowerOptionsTaskPaneCallbacks}});Object.defineProperty(wi,"ITaskPaneClient2Host",{enumerable:!0,get:function(){return rH.ITaskPaneClient2Host}});Object.defineProperty(wi,"ITaskPaneClient2HostNativeServices",{enumerable:!0,get:function(){return rH.NativeServices}});Object.defineProperty(wi,"ITaskPaneClient2HostServiceInfos",{enumerable:!0,get:function(){return rH.ServiceInfos}});Object.defineProperty(wi,"ITaskPaneHost2Client",{enumerable:!0,get:function(){return dce.ITaskPaneHost2Client}});Object.defineProperty(wi,"ITaskPaneHost2ClientServiceInfos",{enumerable:!0,get:function(){return dce.ServiceInfos}});Object.defineProperty(wi,"Logger",{enumerable:!0,get:function(){return nH.Logger}});Object.defineProperty(wi,"LoggerNativeServices",{enumerable:!0,get:function(){return nH.NativeServices}});Object.defineProperty(wi,"LoggerServiceInfos",{enumerable:!0,get:function(){return nH.ServiceInfos}});Object.defineProperty(wi,"PowerOptionsTaskPaneNativeServices",{enumerable:!0,get:function(){return Z4.NativeServices}});Object.defineProperty(wi,"PowerOptionsTaskPaneProps",{enumerable:!0,get:function(){return Z4.PowerOptionsTaskPaneProps}});Object.defineProperty(wi,"PowerOptionsTaskPaneServiceInfos",{enumerable:!0,get:function(){return Z4.ServiceInfos}});Object.defineProperty(wi,"RekaTelemetryAdapter",{enumerable:!0,get:function(){return tH.RekaTelemetryAdapter}});Object.defineProperty(wi,"ServiceInteropArgs",{enumerable:!0,get:function(){return G6e.ServiceInteropArgs}});Object.defineProperty(wi,"StartParams",{enumerable:!0,get:function(){return K6e.StartParams}});Object.defineProperty(wi,"TaskPaneInstance",{enumerable:!0,get:function(){return j6e.TaskPaneInstance}});Object.defineProperty(wi,"TelemetryAdapterNativeServices",{enumerable:!0,get:function(){return tH.NativeServices}});Object.defineProperty(wi,"TelemetryAdapterServiceInfos",{enumerable:!0,get:function(){return tH.ServiceInfos}});Object.defineProperty(wi,"TraceLevel",{enumerable:!0,get:function(){return V6e.TraceLevel}});Object.defineProperty(wi,"UxppGatesService",{enumerable:!0,get:function(){return $4.UxppGatesService}});Object.defineProperty(wi,"UxppGatesServiceNativeServices",{enumerable:!0,get:function(){return $4.NativeServices}});Object.defineProperty(wi,"UxppGatesServiceServiceInfos",{enumerable:!0,get:function(){return $4.ServiceInfos}});Object.defineProperty(wi,"UxppPaneLifecycleService",{enumerable:!0,get:function(){return sH.UxppPaneLifecycleService}});Object.defineProperty(wi,"UxppPaneLifecycleServiceNativeServices",{enumerable:!0,get:function(){return sH.NativeServices}});Object.defineProperty(wi,"UxppPaneLifecycleServiceServiceInfos",{enumerable:!0,get:function(){return sH.ServiceInfos}});Object.defineProperty(wi,"UxppPowerOptionsJsService",{enumerable:!0,get:function(){return aH.UxppPowerOptionsJsService}});Object.defineProperty(wi,"UxppPowerOptionsJsServiceNativeServices",{enumerable:!0,get:function(){return aH.NativeServices}});Object.defineProperty(wi,"UxppPowerOptionsJsServiceServiceInfos",{enumerable:!0,get:function(){return aH.ServiceInfos}});Object.defineProperty(wi,"UxppPowerOptionsService",{enumerable:!0,get:function(){return iH.UxppPowerOptionsService}});Object.defineProperty(wi,"UxppPowerOptionsServiceNativeServices",{enumerable:!0,get:function(){return iH.NativeServices}});Object.defineProperty(wi,"UxppPowerOptionsServiceServiceInfos",{enumerable:!0,get:function(){return iH.ServiceInfos}});Object.defineProperty(wi,"UxppRekaServiceManager",{enumerable:!0,get:function(){return oH.UxppRekaServiceManager}});Object.defineProperty(wi,"UxppRekaServiceManagerNativeServices",{enumerable:!0,get:function(){return oH.NativeServices}});Object.defineProperty(wi,"UxppRekaServiceManagerServiceInfos",{enumerable:!0,get:function(){return oH.ServiceInfos}});Object.defineProperty(wi,"UxppThemeId",{enumerable:!0,get:function(){return W6e.UxppThemeId}});Object.defineProperty(wi,"UxppThemeService",{enumerable:!0,get:function(){return uH.UxppThemeService}});Object.defineProperty(wi,"UxppThemeServiceNativeServices",{enumerable:!0,get:function(){return uH.NativeServices}});Object.defineProperty(wi,"UxppThemeServiceServiceInfos",{enumerable:!0,get:function(){return uH.ServiceInfos}});var rH=Fle(),dce=Ile(),nH=zj(),Z4=Ble(),G6e=qle(),K6e=Ule(),V6e=Kle(),tH=Xj(),$4=Zj(),aH=Yle(),iH=Zle(),oH=rce(),W6e=tce(),uH=oce(),j6e=uce(),sH=cce()});var pce=Y(()=>{_()});var vce=Y(lH=>{_();var H6e=An();Object.defineProperty(lH,"__esModule",{value:!0});lH.initializeGates=J6e;var mce=H6e(Y0()),Q6e=Y6e(Zj()),z6e=jj();function gce(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,n=new WeakMap;return(gce=function(o){return o?n:r})(e)}function Y6e(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var n=gce(r);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(u!=="default"&&Object.prototype.hasOwnProperty.call(e,u)){var t=o?Object.getOwnPropertyDescriptor(e,u):null;t&&(t.get||t.set)?Object.defineProperty(a,u,t):a[u]=e[u]}return a.default=e,n&&n.set(e,a),a}function J6e(){var e;return mce.default.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,mce.default.awrap(Q6e.NativeServices.UxppGatesService.getGates());case 2:e=n.sent,(0,z6e.configureGating)(e);case 4:case"end":return n.stop()}},null,null,null,Promise)}});var hce=Y(XI=>{_();Object.defineProperty(XI,"__esModule",{value:!0});XI.HRESULT=void 0;var cH;XI.HRESULT=cH;(function(e){e[e.hrNoError=0]="hrNoError",e[e.hrFail=2148140012]="hrFail"})(cH||(XI.HRESULT=cH={}))});var yce=Y(eL=>{_();var Sce=An();Object.defineProperty(eL,"__esModule",{value:!0});eL.Lazy=void 0;var X6e=Sce(at()),Z6e=Sce(it()),$6e=function(){function e(r){(0,X6e.default)(this,e),this._factory=r}return(0,Z6e.default)(e,[{key:"value",get:function(){return this._value===void 0&&(this._value=this._factory()),this._value}}]),e}();eL.Lazy=$6e});var Cce=Y(rL=>{_();Object.defineProperty(rL,"__esModule",{value:!0});rL.nameof=void 0;var eBe=function(r){return r};rL.nameof=eBe});var dH=Y((Wcn,ZI)=>{_();function rBe(e){if(Array.isArray(e))return e}ZI.exports=rBe,ZI.exports.__esModule=!0,ZI.exports.default=ZI.exports});var _ce=Y((Hcn,$I)=>{_();function nBe(e,r){var n=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var a,o,u,t,d=[],s=!0,c=!1;try{if(u=(n=n.call(e)).next,r===0){if(Object(n)!==n)return;s=!1}else for(;!(s=(a=u.call(n)).done)&&(d.push(a.value),d.length!==r);s=!0);}catch(l){c=!0,o=l}finally{try{if(!s&&n.return!=null&&(t=n.return(),Object(t)!==t))return}finally{if(c)throw o}}return d}}$I.exports=nBe,$I.exports.__esModule=!0,$I.exports.default=$I.exports});var fH=Y((zcn,eM)=>{_();function tBe(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}eM.exports=tBe,eM.exports.__esModule=!0,eM.exports.default=eM.exports});var GS=Y((Jcn,rM)=>{_();var aBe=dH(),iBe=_ce(),oBe=M4(),uBe=fH();function sBe(e,r){return aBe(e)||iBe(e,r)||oBe(e,r)||uBe()}rM.exports=sBe,rM.exports.__esModule=!0,rM.exports.default=rM.exports});var Ece=Y(v0=>{_();var Rce=An();Object.defineProperty(v0,"__esModule",{value:!0});v0.areEqual=dBe;v0.asStringOrUndefined=fBe;v0.conditional=pBe;v0.deepReplaceProperties=Tce;v0.filterProperties=bce;v0.forceCast=mBe;v0.getDefinedProperties=gBe;v0.getPropertyOrDefault=vBe;v0.handleUndefined=hBe;v0.isObject=Pce;v0.isRecord=pH;v0.toString=SBe;v0.transform=yBe;var lBe=Rce(GS()),cBe=Rce(hb());function dBe(e,r,n){return e===void 0&&r===void 0||e===null&&r===null?!0:e===null||r===null||e===void 0||r===void 0?!1:n(e,r)}function fBe(e){if(typeof e=="string")return e}function pBe(e,r){return e?r:void 0}function Tce(e,r){var n=e;if(r){var a;n=(a=n)!=null?a:{};for(var o=(0,cBe.default)({},n),u=0,t=Object.entries(r);u<t.length;u++){var d=t[u],s=(0,lBe.default)(d,2),c=s[0],l=s[1];o[c]=pH(l)?Tce(n[c],l):l}return o}return n}function bce(e,r){for(var n={},a=0,o=Object.keys(e);a<o.length;a++){var u=o[a],t=e[u];r(t)&&(n[u]=t)}return n}function mBe(e){return e}function gBe(e){return bce(e,function(r){return r!==void 0})}function vBe(e,r,n){var a;return e&&pH(e)&&e.hasOwnProperty(r)&&(a=e[r])!=null?a:n}function hBe(e){return function(r){if(r!==void 0)return e(r)}}function Pce(e){return e!==null&&typeof e=="object"}function pH(e){return Pce(e)&&!Array.isArray(e)&&e.constructor===Object}function SBe(e){if(e!=null)return e.toString()}function yBe(e,r){if(e!==void 0)return r(e)}});var gH=Y(mH=>{_();Object.defineProperty(mH,"__esModule",{value:!0});mH.sendEvent=_Be;var CBe=Xj();function _Be(e){CBe.NativeServices.RekaTelemetryAdapter.sendTelemetryEvent(e)}});var bb=Y((ndn,Nce)=>{_();Nce.exports=OfficePlatformGlobal.Telemetry.OTelV4});var vH=Y(Cp=>{_();Object.defineProperty(Cp,"__esModule",{value:!0});Cp.PartialEventNameScope=void 0;Cp.appendEventNameSuffix=OBe;Cp.appendToOfficeClientNamespacePrefix=EBe;Cp.appendToOfficeUxppNamespacePrefix=ABe;Cp.getAppName=RBe;Cp.officeAppClientNamespacePrefix=Oce;Cp.officeAppNamespacePrefix=Ace;Cp.officeUxppNamespacePrefix=Cp.officeUxppAriaTenantToken=void 0;Cp.setAppName=TBe;var tL=".",nL=void 0;function RBe(){return nL}function TBe(e){nL===void 0&&(nL=e)}var nM;Cp.PartialEventNameScope=nM;(function(e){e[e.UxppRuntime=0]="UxppRuntime",e[e.PowerOptions=1]="PowerOptions",e[e.PowerQuery=2]="PowerQuery",e[e.DataCleansing=3]="DataCleansing"})(nM||(Cp.PartialEventNameScope=nM={}));var bBe="Office.Uxpp";Cp.officeUxppNamespacePrefix=bBe;var PBe="771eb6027aa74c4bbec78a064eb2ca56-d6fad40c-2791-45d8-a56f-3a4f8eb06f93-7480";Cp.officeUxppAriaTenantToken=PBe;function Ace(){var e;return"Office."+((e=nL)!=null?e:"None")}function Oce(){return""+Ace()+tL+"Client"}function EBe(e){return""+Oce()+tL+nM[e]}function NBe(){return"Office.Uxpp.Client"}function ABe(e){return""+NBe()+tL+nM[e]}function OBe(e,r){return""+e+tL+r}});var kce=Y(hH=>{_();Object.defineProperty(hH,"__esModule",{value:!0});hH.getTagString=IBe;var tM="abcdefghijklmnopqrstuvwxyz0123456789",kBe=65535,FBe=36;function IBe(e){return e<=kBe?e.toString():e>>24>=FBe?(e>>24&255).toString()+(e>>16&255).toString()+(e>>8&255).toString()+(e&255).toString():tM[e>>24&63]+tM[e>>18&63]+tM[e>>12&63]+tM[e>>6&63]+tM[e&63]}});var aL=Y(nv=>{_();Object.defineProperty(nv,"__esModule",{value:!0});nv.createLogLevelField=xBe;nv.createTagField=BBe;nv.createTagNumberField=qBe;nv.errorLogLevel=void 0;nv.getTagNumber=UBe;nv.getTraceLevel=LBe;nv.infoLogLevel=void 0;nv.removeHiddenDataFields=KBe;var Fce=yb(),SH=bb(),MBe=kce(),Ice="Error";nv.errorLogLevel=Ice;var wBe="Info";nv.infoLogLevel=wBe;var yH="Hidden.Tag",DBe="Tag",CH="Hidden.Log.Level";function xBe(e){return(0,SH.makeStringDataField)(CH,e)}function LBe(e){var r=Mce(e,CH);return r===Ice?Fce.TraceLevel.Error:Fce.TraceLevel.Info}function BBe(e){return(0,SH.makeStringDataField)(DBe,(0,MBe.getTagString)(e))}function qBe(e){return(0,SH.makeDoubleDataField)(yH,e)}function UBe(e){return GBe(e,yH)}function GBe(e,r){var n=Mce(e,r);return isNaN(Number(n))?0:Number(n)}function Mce(e,r){var n,a=(n=e.dataFields)==null?void 0:n.filter(function(o){return o.name===r});if(a!=null&&a.length)return a[0].value}function KBe(e){VBe(e),WBe(e)}function VBe(e){e.dataFields=wce(e,yH)}function WBe(e){e.dataFields=wce(e,CH)}function wce(e,r){var n;return(n=e.dataFields)==null?void 0:n.filter(function(a){return a.name!==r})}});var Lce=Y(iL=>{_();var xce=An();Object.defineProperty(iL,"__esModule",{value:!0});iL.UlsTraceSink=void 0;var jBe=xce(at()),HBe=xce(it()),Dce=yb(),_H=bb(),RH=aL(),QBe=function(){function e(){(0,jBe.default)(this,e)}return(0,HBe.default)(e,[{key:"sendTelemetryEvent",value:function(n){try{var a=(0,RH.getTraceLevel)(n),o=(0,RH.getTagNumber)(n);(0,RH.removeHiddenDataFields)(n),Dce.ULS.sendTraceTag(o,Dce.LogCategory.msoulscat_ES_EWAJS,a,JSON.stringify(n))}catch(u){(0,_H.logNotification)(_H.LogLevel.Error,_H.Category.Sink,function(){return"UlsTraceSink caught an error for event name '"+n.eventName+"': (timestamp="+Date.now()+") "+JSON.stringify(u)})}}}]),e}();iL.UlsTraceSink=QBe});var bH=Y(Pb=>{_();var Bce=An();Object.defineProperty(Pb,"__esModule",{value:!0});Pb.getFilledEventFlags=nqe;Pb.initTelemetryLoggerWithSink=rqe;Pb.logger=void 0;Pb.setAriaTenantToken=XBe;var zBe=Bce(at()),YBe=Bce(it()),KS=yb(),VS=bb(),Zy=vH(),aM=aL(),JBe=Lce(),TH="";function XBe(e){TH=e}eqe();var ZBe=function(){function e(){(0,zBe.default)(this,e)}return(0,YBe.default)(e,[{key:"log",value:function(n,a){this.sendTelemetryEvent(n,a,aM.infoLogLevel)}},{key:"error",value:function(n,a){this.sendTelemetryEvent(n,a,aM.errorLogLevel)}},{key:"sendTelemetryEvent",value:function(n,a,o){KS.ULS.shipAssertTag(508864192,KS.LogCategory.msoulscat_ES_EWAJS,(0,Zy.getAppName)()===void 0||a.eventName.startsWith((0,Zy.officeAppClientNamespacePrefix)())||a.eventName.startsWith(Zy.officeUxppNamespacePrefix)||a.eventName.startsWith((0,Zy.officeAppNamespacePrefix)()),"Telemetry event '"+a.eventName+"' with tag '"+n+"' will be dropped in Desktop's UXPP because its name is not prefixed by the namespace '"+(0,Zy.officeAppNamespacePrefix)()+"' as configured by setTenantToken"),a.dataFields??=[],a.dataFields.push((0,aM.createTagNumberField)(n),(0,aM.createTagField)(n),(0,aM.createLogLevelField)(o)),U_.sendTelemetryEvent(a)}}]),e}(),$Be=new ZBe;Pb.logger=$Be;var U_;function eqe(){U_=new VS.SimpleTelemetryLogger,U_.addSink(new JBe.UlsTraceSink),U_.setTenantToken((0,Zy.officeAppNamespacePrefix)(),TH),(0,VS.onNotification)().addListener(function(e){KS.ULS.sendTraceTag(508864163,KS.LogCategory.msoulscat_ES_EWAJS,qce(e.level),e.message())})}function rqe(e){U_=new VS.SimpleTelemetryLogger,U_.addSink(e),U_.setTenantToken((0,Zy.officeAppNamespacePrefix)(),TH),U_.setTenantToken(Zy.officeUxppNamespacePrefix,Zy.officeUxppAriaTenantToken),(0,VS.onNotification)().addListener(function(r){KS.ULS.sendTraceTag(508687499,KS.LogCategory.msoulscat_ES_EWAJS,qce(r.level),r.message())})}function qce(e){switch(e){case VS.LogLevel.Error:return KS.TraceLevel.Error;case VS.LogLevel.Info:return KS.TraceLevel.Info;case VS.LogLevel.Verbose:return KS.TraceLevel.Verbose;case VS.LogLevel.Warning:return KS.TraceLevel.Warning}}function nqe(e,r,n){return{dataCategories:e,diagnosticLevel:r,samplingPolicy:n,costPriority:VS.EnumObjects.CostPriority.Normal,persistencePriority:VS.EnumObjects.PersistencePriority.Normal}}});var AH=Y(kh=>{_();Object.defineProperty(kh,"__esModule",{value:!0});var PH=bH();Object.keys(PH).forEach(function(e){e==="default"||e==="__esModule"||e in kh&&kh[e]===PH[e]||Object.defineProperty(kh,e,{enumerable:!0,get:function(){return PH[e]}})});var EH=vH();Object.keys(EH).forEach(function(e){e==="default"||e==="__esModule"||e in kh&&kh[e]===EH[e]||Object.defineProperty(kh,e,{enumerable:!0,get:function(){return EH[e]}})});var NH=aL();Object.keys(NH).forEach(function(e){e==="default"||e==="__esModule"||e in kh&&kh[e]===NH[e]||Object.defineProperty(kh,e,{enumerable:!0,get:function(){return NH[e]}})})});var kH=Y(oL=>{_();var Uce=An();Object.defineProperty(oL,"__esModule",{value:!0});oL.RekaSink=void 0;var tqe=Uce(at()),aqe=Uce(it()),OH=bb(),iqe=gH(),oqe=AH(),uqe=function(){function e(){(0,tqe.default)(this,e)}return(0,aqe.default)(e,[{key:"sendTelemetryEvent",value:function(n){try{(0,oqe.removeHiddenDataFields)(n),(0,iqe.sendEvent)(JSON.stringify(n))}catch(a){(0,OH.logNotification)(OH.LogLevel.Error,OH.Category.Sink,function(){return"RekaSink caught an error for event name '"+n.eventName+"': (timestamp="+Date.now()+") "+JSON.stringify(a)})}}}]),e}();oL.RekaSink=uqe});var Gce=Y(FH=>{_();Object.defineProperty(FH,"__esModule",{value:!0});FH.initializeTelemetry=cqe;var sqe=kH(),lqe=bH();function cqe(){(0,lqe.initTelemetryLoggerWithSink)(new sqe.RekaSink)}});var Kce=Y(Fh=>{_();Object.defineProperty(Fh,"__esModule",{value:!0});var IH=gH();Object.keys(IH).forEach(function(e){e==="default"||e==="__esModule"||e in Fh&&Fh[e]===IH[e]||Object.defineProperty(Fh,e,{enumerable:!0,get:function(){return IH[e]}})});var MH=kH();Object.keys(MH).forEach(function(e){e==="default"||e==="__esModule"||e in Fh&&Fh[e]===MH[e]||Object.defineProperty(Fh,e,{enumerable:!0,get:function(){return MH[e]}})});var wH=Gce();Object.keys(wH).forEach(function(e){e==="default"||e==="__esModule"||e in Fh&&Fh[e]===wH[e]||Object.defineProperty(Fh,e,{enumerable:!0,get:function(){return wH[e]}})})});var Vce=Y(Nd=>{_();Object.defineProperty(Nd,"__esModule",{value:!0});Nd.arrayHasLength=dqe;Nd.arrayLengthIsInRange=fqe;Nd.arrayNotEmpty=pqe;Nd.assert=mqe;Nd.equal=bqe;Nd.isDefined=gqe;Nd.isFalse=Rqe;Nd.isGreaterOrEqualToZero=hqe;Nd.isGreaterThanZero=vqe;Nd.isInRange=Tqe;Nd.isNever=Sqe;Nd.isNeverWithoutThrowing=yqe;Nd.isOfType=Cqe;Nd.isTrue=_qe;Nd.notEqual=Pqe;Nd.notNull=Eqe;Nd.notUndefined=Nqe;function dqe(e,r,n){if(e.length!==r)throw new Error("Array should have "+r+" items instead of "+e.length+". Array name: "+n)}function fqe(e,r,n,a){if(e.length<r||e.length>n)throw new Error("Array length should be in range ["+r+", "+n+"] instead of "+e.length+". Array name: "+a)}function pqe(e,r){if(e.length===0)throw new Error("Array should not be empty. Array name: "+r)}function mqe(e,r){if(!e)throw new Error(r?r():"Expected condition to be true")}function gqe(e,r){if(e===void 0)throw new Error("Argument should not be undefined. Argument name: "+r)}function vqe(e,r){if(e<=0)throw new Error("Argument "+r+" is not greater than zero. Value: "+e)}function hqe(e,r){if(e<0)throw new Error("Argument "+r+" is not greater than or equal to zero. Value: "+e)}function Sqe(e){throw new Error("Unexpected value: "+e)}function yqe(e){}function Cqe(e,r){if(!r(e))throw new Error("Value is not of expected type")}function _qe(e,r){if(!e)throw new Error("Condition should be true. "+r)}function Rqe(e,r){if(e)throw new Error("Condition should be false. "+r)}function Tqe(e,r,n,a){var o=r+n-1;if(e<r||e>o)throw new Error("Argument out of range ["+r+", "+o+"]. Actual value: "+e+". "+a)}function bqe(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(e!==r)throw new Error("Values "+e+" and "+r+" should be equal. "+n)}function Pqe(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(e===r)throw new Error("Values "+e+" and "+r+" should not be equal. "+n)}function Eqe(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e===null)throw new Error("Value should not be null: "+r)}function Nqe(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e===void 0)throw new Error("Value should not be undefined: "+r)}});var Wce=Y(Cs=>{_();Object.defineProperty(Cs,"__esModule",{value:!0});var DH=pce();Object.keys(DH).forEach(function(e){e==="default"||e==="__esModule"||e in Cs&&Cs[e]===DH[e]||Object.defineProperty(Cs,e,{enumerable:!0,get:function(){return DH[e]}})});var xH=vce();Object.keys(xH).forEach(function(e){e==="default"||e==="__esModule"||e in Cs&&Cs[e]===xH[e]||Object.defineProperty(Cs,e,{enumerable:!0,get:function(){return xH[e]}})});var LH=hce();Object.keys(LH).forEach(function(e){e==="default"||e==="__esModule"||e in Cs&&Cs[e]===LH[e]||Object.defineProperty(Cs,e,{enumerable:!0,get:function(){return LH[e]}})});var BH=yce();Object.keys(BH).forEach(function(e){e==="default"||e==="__esModule"||e in Cs&&Cs[e]===BH[e]||Object.defineProperty(Cs,e,{enumerable:!0,get:function(){return BH[e]}})});var qH=Cce();Object.keys(qH).forEach(function(e){e==="default"||e==="__esModule"||e in Cs&&Cs[e]===qH[e]||Object.defineProperty(Cs,e,{enumerable:!0,get:function(){return qH[e]}})});var UH=Ece();Object.keys(UH).forEach(function(e){e==="default"||e==="__esModule"||e in Cs&&Cs[e]===UH[e]||Object.defineProperty(Cs,e,{enumerable:!0,get:function(){return UH[e]}})});var GH=Kce();Object.keys(GH).forEach(function(e){e==="default"||e==="__esModule"||e in Cs&&Cs[e]===GH[e]||Object.defineProperty(Cs,e,{enumerable:!0,get:function(){return GH[e]}})});var KH=Vce();Object.keys(KH).forEach(function(e){e==="default"||e==="__esModule"||e in Cs&&Cs[e]===KH[e]||Object.defineProperty(Cs,e,{enumerable:!0,get:function(){return KH[e]}})})});var Hce=Y(sL=>{_();var jce=An();Object.defineProperty(sL,"__esModule",{value:!0});sL.LoggerAdapter=void 0;var Aqe=jce(at()),Oqe=jce(it()),uL=zj(),kqe=function(){function e(){(0,Aqe.default)(this,e),this.correlationId=""}return(0,Oqe.default)(e,[{key:"sendTraceTag",value:function(n,a,o,u){uL.NativeServices.Logger.sendTraceTag(n,o,u)}},{key:"shipAssertTag",value:function(n,a,o,u){o||uL.NativeServices.Logger.shipAssertTag(n,o,new Error(u).stack)}},{key:"debugAssertTag",value:function(n,a,o,u){o||uL.NativeServices.Logger.debugAssertTag(n,o,new Error(u).stack)}},{key:"setCorrelationId",value:function(n){this.correlationId=n,uL.NativeServices.Logger.setCorrelationId(n)}}]),e}();sL.LoggerAdapter=kqe});var Qce=Y(iM=>{_();Object.defineProperty(iM,"__esModule",{value:!0});var VH=Hce();Object.keys(VH).forEach(function(e){e==="default"||e==="__esModule"||e in iM&&iM[e]===VH[e]||Object.defineProperty(iM,e,{enumerable:!0,get:function(){return VH[e]}})})});var Ih=Y(Wc=>{_();Object.defineProperty(Wc,"__esModule",{value:!0});var WH=Tle();Object.keys(WH).forEach(function(e){e==="default"||e==="__esModule"||e in Wc&&Wc[e]===WH[e]||Object.defineProperty(Wc,e,{enumerable:!0,get:function(){return WH[e]}})});var jH=Ale();Object.keys(jH).forEach(function(e){e==="default"||e==="__esModule"||e in Wc&&Wc[e]===jH[e]||Object.defineProperty(Wc,e,{enumerable:!0,get:function(){return jH[e]}})});var HH=fce();Object.keys(HH).forEach(function(e){e==="default"||e==="__esModule"||e in Wc&&Wc[e]===HH[e]||Object.defineProperty(Wc,e,{enumerable:!0,get:function(){return HH[e]}})});var QH=Wce();Object.keys(QH).forEach(function(e){e==="default"||e==="__esModule"||e in Wc&&Wc[e]===QH[e]||Object.defineProperty(Wc,e,{enumerable:!0,get:function(){return QH[e]}})});var zH=AH();Object.keys(zH).forEach(function(e){e==="default"||e==="__esModule"||e in Wc&&Wc[e]===zH[e]||Object.defineProperty(Wc,e,{enumerable:!0,get:function(){return zH[e]}})});var YH=Qce();Object.keys(YH).forEach(function(e){e==="default"||e==="__esModule"||e in Wc&&Wc[e]===YH[e]||Object.defineProperty(Wc,e,{enumerable:!0,get:function(){return YH[e]}})})});var JH=Y(ZN=>{_();var zce=An();Object.defineProperty(ZN,"__esModule",{value:!0});ZN.nameOfEvent=ZN.UxppEvent=void 0;var Yce=zce(at()),Jce=zce(it()),Fqe=Ih(),Iqe=function(){function e(r,n){(0,Yce.default)(this,e),this.serviceInfo=r,this.eventName=n,this.handlers=new Map,this.serviceInfo=r,this.eventName=n}return(0,Jce.default)(e,[{key:"subscribe",value:function(n){var a=new wqe(this);return this.handlers.set(a,n),a}},{key:"unsubscribe",value:function(n){this.handlers.delete(n)}},{key:"unsubscribeAll",value:function(){this.handlers.clear()}},{key:"trigger",value:function(n){Fqe.UxppRekaServiceManagerNativeServices.UxppRekaServiceManager.raiseEvent(this.serviceInfo[0],this.eventName,JSON.stringify([n])),this.handlers.forEach(function(a,o){return a(n,o)})}}]),e}();ZN.UxppEvent=Iqe;var Mqe=function(r){return r};ZN.nameOfEvent=Mqe;var wqe=function(){function e(r){(0,Yce.default)(this,e),this.event=r,this.event=r}return(0,Jce.default)(e,[{key:"unsubscribe",value:function(){this.event.unsubscribe(this)}}]),e}()});var XH=Y(lL=>{_();var Zce=An();Object.defineProperty(lL,"__esModule",{value:!0});lL.UxppPowerOptionsJsDataService=void 0;var Dqe=Zce(at()),xqe=Zce(it()),Lqe=Ih(),Xce=JH(),$ce=function(){function e(){(0,Dqe.default)(this,e),this.onTestEvent=new Xce.UxppEvent(e.ServiceInfo,(0,Xce.nameOfEvent)("onTestEvent"))}return(0,xqe.default)(e,[{key:"simulateTestEvent",value:function(n){return console.log("Raising Test Event: ",n),this.onTestEvent.trigger(n),Promise.resolve("Event Raised")}}]),e}();lL.UxppPowerOptionsJsDataService=$ce;$ce.ServiceInfo=Lqe.UxppPowerOptionsJsServiceServiceInfos.UxppPowerOptionsJsService});var rde=Y((xdn,ede)=>{_();ede.exports=OfficePlatformGlobal.ReactNativeReka});var tde=Y(ZH=>{_();var nde=An();Object.defineProperty(ZH,"__esModule",{value:!0});ZH.initHeadlessUxpp=Vqe;var G_=nde(Y0()),Bqe=nde(L_()),Mh=Ih(),cL=bb(),qqe=Ec(),Uqe=yb(),Gqe=XH();function Kqe(e){var r,n,a,o,u;return G_.default.async(function(d){for(;;)switch(d.prev=d.next){case 0:return(0,Mh.setAppName)(e.appName),e.ariaTenantToken&&(0,Mh.setAriaTenantToken)(e.ariaTenantToken),r=e.headlessApps.filter(function(s){return s.services!==void 0}).flatMap(function(s){return s.services}),r.push(Gqe.UxppPowerOptionsJsDataService),n=[],a={logger:new Mh.LoggerAdapter,registerServiceInstances:function(){n.push.apply(n,arguments)}},d.next=8,G_.default.awrap(Promise.resolve().then(()=>KW(rde())));case 8:return o=d.sent,o.initReka.apply(o,(0,Bqe.default)(r)),(0,Uqe.initializeLogger)(a.logger),(0,Mh.initializeTelemetry)(),d.next=14,G_.default.awrap((0,Mh.initializeGates)());case 14:return u=e.headlessApps.map(function(c){var l,f;return G_.default.async(function(m){for(;;)switch(m.prev=m.next){case 0:if(l=typeof c.enableOption=="function"?c.enableOption():c.enableOption,l){m.next=3;break}return m.abrupt("return");case 3:return m.next=5,G_.default.awrap(c.importModule());case 5:return f=m.sent,m.next=8,G_.default.awrap(f.default(a));case 8:case"end":return m.stop()}},null,null,null,Promise)}),d.next=17,G_.default.awrap(Promise.all(u));case 17:return n.forEach(function(s){return qqe.RekaInstance.registerServiceInstance(s)}),d.next=20,G_.default.awrap(Mh.UxppRekaServiceManagerNativeServices.UxppRekaServiceManager.registerServices(n.concat(r).map(function(s){return s.ServiceInfo[0]})));case 20:console.log("Uxpp headless started"),Mh.UxppRekaServiceManagerNativeServices.UxppRekaServiceManager.indicateStarted();case 22:case"end":return d.stop()}},null,null,null,Promise)}function Vqe(e){Kqe(e).catch(function(r){throw Mh.logger.error(508440917,{eventName:(0,Mh.appendToOfficeUxppNamespacePrefix)(Mh.PartialEventNameScope.UxppRuntime),dataFields:[(0,cL.makeBooleanDataField)("Headless.Load.Failed",!0)],eventFlags:(0,Mh.getFilledEventFlags)(cL.EnumObjects.DataCategories.ProductServiceUsage,cL.EnumObjects.DiagnosticLevel.RequiredServiceData,cL.EnumObjects.SamplingPolicy.CriticalBusinessImpact)}),r})}});var ade=Y(oM=>{_();Object.defineProperty(oM,"__esModule",{value:!0});var $H=tde();Object.keys($H).forEach(function(e){e==="default"||e==="__esModule"||e in oM&&oM[e]===$H[e]||Object.defineProperty(oM,e,{enumerable:!0,get:function(){return $H[e]}})})});var ide=Y(uM=>{_();Object.defineProperty(uM,"__esModule",{value:!0});var eQ=XH();Object.keys(eQ).forEach(function(e){e==="default"||e==="__esModule"||e in uM&&uM[e]===eQ[e]||Object.defineProperty(uM,e,{enumerable:!0,get:function(){return eQ[e]}})})});var sde=Y(dL=>{_();var ude=An();Object.defineProperty(dL,"__esModule",{value:!0});dL.PaneLifecycleManager=void 0;var Wqe=ude(at()),jqe=ude(it()),ode=Ih(),Hqe=Yy(),Qqe=function(){function e(r){var n=this;(0,Wqe.default)(this,e),this.logger=r,this.registeredOnClosed=[],this.logger=r;var a=ode.UxppPaneLifecycleServiceNativeServices.UxppPaneLifecycleService;a.onClose.subscribe(function(o){return n.onClose(o)})}return(0,jqe.default)(e,[{key:"registerOnClose",value:function(n){this.registeredOnClosed.push(n)}},{key:"onClose",value:function(n){var a=this;this.registeredOnClosed.forEach(function(o){try{o(n)}catch(u){a.logger.sendTraceTag(508703832,Hqe.LogCategory.msoulscat_ES_EWAJS,ode.TraceLevel.Error,"PaneLifecycleManager.onClose got error")}})}}]),e}();dL.PaneLifecycleManager=Qqe});var lde=Y(K_=>{_();Object.defineProperty(K_,"__esModule",{value:!0});var rQ=JH();Object.keys(rQ).forEach(function(e){e==="default"||e==="__esModule"||e in K_&&K_[e]===rQ[e]||Object.defineProperty(K_,e,{enumerable:!0,get:function(){return rQ[e]}})});var nQ=sde();Object.keys(nQ).forEach(function(e){e==="default"||e==="__esModule"||e in K_&&K_[e]===nQ[e]||Object.defineProperty(K_,e,{enumerable:!0,get:function(){return nQ[e]}})})});var cde=Y(()=>{_()});var sM=Y(Al=>{_();Object.defineProperty(Al,"__esModule",{value:!0});var tQ=Cse();Object.keys(tQ).forEach(function(e){e==="default"||e==="__esModule"||e in Al&&Al[e]===tQ[e]||Object.defineProperty(Al,e,{enumerable:!0,get:function(){return tQ[e]}})});var aQ=_se();Object.keys(aQ).forEach(function(e){e==="default"||e==="__esModule"||e in Al&&Al[e]===aQ[e]||Object.defineProperty(Al,e,{enumerable:!0,get:function(){return aQ[e]}})});var iQ=Rse();Object.keys(iQ).forEach(function(e){e==="default"||e==="__esModule"||e in Al&&Al[e]===iQ[e]||Object.defineProperty(Al,e,{enumerable:!0,get:function(){return iQ[e]}})});var oQ=ade();Object.keys(oQ).forEach(function(e){e==="default"||e==="__esModule"||e in Al&&Al[e]===oQ[e]||Object.defineProperty(Al,e,{enumerable:!0,get:function(){return oQ[e]}})});var uQ=ide();Object.keys(uQ).forEach(function(e){e==="default"||e==="__esModule"||e in Al&&Al[e]===uQ[e]||Object.defineProperty(Al,e,{enumerable:!0,get:function(){return uQ[e]}})});var sQ=lde();Object.keys(sQ).forEach(function(e){e==="default"||e==="__esModule"||e in Al&&Al[e]===sQ[e]||Object.defineProperty(Al,e,{enumerable:!0,get:function(){return sQ[e]}})});var lQ=cde();Object.keys(lQ).forEach(function(e){e==="default"||e==="__esModule"||e in Al&&Al[e]===lQ[e]||Object.defineProperty(Al,e,{enumerable:!0,get:function(){return lQ[e]}})})});var dde=Y($N=>{_();Object.defineProperty($N,"__esModule",{value:!0});$N.AriaTenantToken=$N.AppName=void 0;var zqe="Excel";$N.AppName=zqe;var Yqe="19eb5e37de684ce38ce5cf3d5842d3f7-e8722941-bde5-4b98-9cd5-2775ec51482c-6873";$N.AriaTenantToken=Yqe});var pL=Y(fL=>{_();Object.defineProperty(fL,"__esModule",{value:!0});fL.getTypedFeatureGate=void 0;var Jqe=jI(),Xqe={"Microsoft.Office.Excel.DesktopX10JavascriptDebug":!1,"Microsoft.Office.Excel.DesktopX10UxppEnabled":!1,"Microsoft.Office.Excel.LogFloodgateActivity":!1},Zqe=(0,Jqe.makeGetTypedFeatureGate)(Xqe);fL.getTypedFeatureGate=Zqe});var mde=Y(eA=>{_();var fde=An();Object.defineProperty(eA,"__esModule",{value:!0});eA.ServiceInfos=eA.NativeServices=void 0;var $qe=fde(at()),eUe=fde(it()),rUe=Ec(),pde={UxppAnnotationsService:["Uxpp::Internal::RekaServices::UxppAnnotationsService",{registerAnnotationType:["ReturnsPromiseMethod","$any",["$string","$boolean"]],unregisterAnnotationType:["ReturnsPromiseMethod","$any",["$string"]],registerOnClose:["ReturnsPromiseMethod","$any",[]],onNewAnnotation:["Event","Uxpp::Internal::RekaServices::SerializedAnnotation"],onClose:["Event","$string"]}]};eA.ServiceInfos=pde;var nUe=function(){function e(){(0,$qe.default)(this,e)}return(0,eUe.default)(e,null,[{key:"UxppAnnotationsService",get:function(){return e._UxppAnnotationsService??=rUe.RekaServiceRegistry.getNativeService(pde.UxppAnnotationsService)}}]),e}();eA.NativeServices=nUe});var hde=Y(gL=>{_();var dQ=An();Object.defineProperty(gL,"__esModule",{value:!0});gL.AnnotationsManager=void 0;var mL=dQ(Y0()),tUe=dQ(at()),aUe=dQ(it()),gde=Yy(),vde=Ih(),cQ=mde(),iUe=function(){function e(r){var n=this;(0,tUe.default)(this,e),this.registeredValidatedAnnotations=new Map,this.registeredNotValidatedAnnotations=new Map,this.registeredClosedConnection=[],this.logger=r;var a=cQ.NativeServices.UxppAnnotationsService;a.onNewAnnotation.subscribe(function(o){return n.onAnnotationArrived(o)}),a.onClose.subscribe(function(o){return n.onClose(o)})}return(0,aUe.default)(e,[{key:"registerAnnotation",value:function(n,a,o){var u;return mL.default.async(function(d){for(;;)switch(d.prev=d.next){case 0:return u=cQ.NativeServices.UxppAnnotationsService,d.next=3,mL.default.awrap(u.registerAnnotationType(n,a));case 3:a?this.registerAnnotationToMap(n,o,this.registeredValidatedAnnotations):this.registerAnnotationToMap(n,o,this.registeredNotValidatedAnnotations);case 4:case"end":return d.stop()}},null,this,null,Promise)}},{key:"registerOnClose",value:function(n){var a;return mL.default.async(function(u){for(;;)switch(u.prev=u.next){case 0:return a=cQ.NativeServices.UxppAnnotationsService,u.next=3,mL.default.awrap(a.registerOnClose());case 3:this.registeredClosedConnection.push(n);case 4:case"end":return u.stop()}},null,this,null,Promise)}},{key:"onClose",value:function(n){var a=this;this.registeredClosedConnection.forEach(function(o){try{o(n)}catch(u){a.logger.sendTraceTag(508703250,gde.LogCategory.msoulscat_ES_EWAJS,vde.TraceLevel.Error,"AnnotationsManager.onClose: "+u)}})}},{key:"onAnnotationArrived",value:function(n){n.validated?this.invokeAnnotationCallbacks(n,this.registeredValidatedAnnotations):this.invokeAnnotationCallbacks(n,this.registeredNotValidatedAnnotations)}},{key:"registerAnnotationToMap",value:function(n,a,o){var u;o.has(n)||o.set(n,[]),(u=o.get(n))==null||u.push(a)}},{key:"invokeAnnotationCallbacks",value:function(n,a){var o,u=this,t=(o=a.get(n.annotationType))!=null?o:[];t.forEach(function(d){try{d(n)}catch(s){u.logger.sendTraceTag(508703249,gde.LogCategory.msoulscat_ES_EWAJS,vde.TraceLevel.Error,"AnnotationsManager.invokeAnnotationCallbacks: "+s)}})}}]),e}();gL.AnnotationsManager=iUe});var vL=Y(wh=>{_();Object.defineProperty(wh,"__esModule",{value:!0});wh.nativeNamespace=wh.OperationType=wh.AnnotationType_TableLintWorksheetAggregateAnnotation=wh.AnnotationType_TableLintColumnAnnotation=void 0;var oUe="Uxpp.Internal.RekaServices";wh.nativeNamespace=oUe;var fQ;wh.OperationType=fQ;(function(e){e[e.Invalid=-1]="Invalid",e[e.Add=0]="Add",e[e.Move=1]="Move",e[e.UpdateAnnotationMetaData=2]="UpdateAnnotationMetaData",e[e.Update=3]="Update",e[e.Delete=4]="Delete",e[e.Purge=5]="Purge",e[e.Focus=6]="Focus",e[e.Visibility=7]="Visibility"})(fQ||(wh.OperationType=fQ={}));var uUe="AugLoop_Tablelint_TableLintColumnAnnotation";wh.AnnotationType_TableLintColumnAnnotation=uUe;var sUe="AugLoop_Tablelint_TableLintWorksheetAggregateAnnotation";wh.AnnotationType_TableLintWorksheetAggregateAnnotation=sUe});var Sde=Y(lM=>{_();Object.defineProperty(lM,"__esModule",{value:!0});Object.defineProperty(lM,"AnnotationType_TableLintColumnAnnotation",{enumerable:!0,get:function(){return pQ.AnnotationType_TableLintColumnAnnotation}});Object.defineProperty(lM,"AnnotationType_TableLintWorksheetAggregateAnnotation",{enumerable:!0,get:function(){return pQ.AnnotationType_TableLintWorksheetAggregateAnnotation}});Object.defineProperty(lM,"OperationType",{enumerable:!0,get:function(){return pQ.OperationType}});var lUe=Ec(),pQ=vL();lUe.CustomTypeRegistry.registerTypeInfos({"Uxpp::Internal::RekaServices::SerializedAnnotation":{serializedData:"$string",annotationType:"$string",operationType:"$number",validated:"$boolean"}})});var _de=Y(rA=>{_();var yde=An();Object.defineProperty(rA,"__esModule",{value:!0});rA.ServiceInfos=rA.NativeServices=void 0;var cUe=yde(at()),dUe=yde(it()),fUe=Ec(),Cde={DataCleansingAnnotationsService:["Uxpp::Internal::RekaServices::DataCleansingAnnotationsService",{getAnnotationList:["ReturnsPromiseMethod",["$array","Uxpp::Internal::RekaServices::SerializedAnnotation"],[]],onNewAnnotationList:["Event",["$array","Uxpp::Internal::RekaServices::SerializedAnnotation"]]}]};rA.ServiceInfos=Cde;var pUe=function(){function e(){(0,cUe.default)(this,e)}return(0,dUe.default)(e,null,[{key:"DataCleansingAnnotationsService",get:function(){return e._DataCleansingAnnotationsService??=fUe.RekaServiceRegistry.getNativeService(Cde.DataCleansingAnnotationsService)}}]),e}();rA.NativeServices=pUe});var Tde=Y(Rde=>{_();Object.defineProperty(Rde,"__esModule",{value:!0})});var bde=Y(cM=>{_();Object.defineProperty(cM,"__esModule",{value:!0});cM.AnnotationState=void 0;var mQ;cM.AnnotationState=mQ;(function(e){e[e.Undefined=0]="Undefined",e[e.Created=10]="Created",e[e.Sent=20]="Sent",e[e.Duplicated=30]="Duplicated",e[e.Seen=40]="Seen",e[e.Tried=50]="Tried",e[e.Kept=60]="Kept",e[e.Rejected=70]="Rejected"})(mQ||(cM.AnnotationState=mQ={}))});var Ede=Y(Pde=>{_();Object.defineProperty(Pde,"__esModule",{value:!0})});var Nde=Y(Dh=>{_();Object.defineProperty(Dh,"__esModule",{value:!0});Dh.OperationErrorCode=Dh.ItemOperation=Dh.ItemChanges=void 0;var gQ;Dh.ItemOperation=gQ;(function(e){e[e.None=0]="None",e[e.Added=1]="Added",e[e.Updated=2]="Updated",e[e.Deleted=3]="Deleted"})(gQ||(Dh.ItemOperation=gQ={}));var vQ;Dh.ItemChanges=vQ;(function(e){e[e.ContentChanged=0]="ContentChanged",e[e.ContentWasEmpty=1]="ContentWasEmpty",e[e.FormattingChanged=2]="FormattingChanged",e[e.ContentWasInsideOfTheTable=3]="ContentWasInsideOfTheTable"})(vQ||(Dh.ItemChanges=vQ={}));var hQ;Dh.OperationErrorCode=hQ;(function(e){e[e.AddOfZeroElements=0]="AddOfZeroElements",e[e.AddOfItemsWithExtraOrMissingIds=1]="AddOfItemsWithExtraOrMissingIds",e[e.AddOfItemWithUndefinedId=2]="AddOfItemWithUndefinedId",e[e.AddOfUndefinedItem=3]="AddOfUndefinedItem",e[e.AddOfItemsWithDuplicateIds=4]="AddOfItemsWithDuplicateIds",e[e.SetHeadToNonExistingItem=5]="SetHeadToNonExistingItem",e[e.DeleteOfNonExistingItem=6]="DeleteOfNonExistingItem",e[e.UpdateOfNonExistentItem=7]="UpdateOfNonExistentItem",e[e.UpdateOfStubbedItem=8]="UpdateOfStubbedItem",e[e.MoveOfNonExistentItem=9]="MoveOfNonExistentItem",e[e.UpdateMetaDataOfNonAnnotationType=10]="UpdateMetaDataOfNonAnnotationType",e[e.SequentialyInvertedUpdate=11]="SequentialyInvertedUpdate",e[e.DeltaOfNonExistingItem=100]="DeltaOfNonExistingItem"})(hQ||(Dh.OperationErrorCode=hQ={}))});var Ode=Y(Ade=>{_();Object.defineProperty(Ade,"__esModule",{value:!0})});var Fde=Y(kde=>{_();Object.defineProperty(kde,"__esModule",{value:!0})});var Mde=Y(J0=>{_();var Ide=An();Object.defineProperty(J0,"__esModule",{value:!0});J0.ecsMetadataBlockWidth=J0.ecsMetadataBlockHeight=J0.OpenType=J0.GridConstants=J0.BlobRefType=void 0;var mUe=Ide(it()),gUe=Ide(at()),vUe=512;J0.ecsMetadataBlockHeight=vUe;var hUe=32;J0.ecsMetadataBlockWidth=hUe;var SQ;J0.BlobRefType=SQ;(function(e){e[e.None=0]="None",e[e.HttpsGetDownloadUrl=1]="HttpsGetDownloadUrl",e[e.AlCodedLocation=2]="AlCodedLocation"})(SQ||(J0.BlobRefType=SQ={}));var yQ;J0.OpenType=yQ;(function(e){e[e.NewDocument=0]="NewDocument",e[e.EditDocument=1]="EditDocument",e[e.ViewOnlyDocument=2]="ViewOnlyDocument"})(yQ||(J0.OpenType=yQ={}));var nA=(0,mUe.default)(function e(){(0,gUe.default)(this,e)});J0.GridConstants=nA;nA.lowerIndexBound=1;nA.maxNumberOfRows=1048576;nA.maxNumberOfColumns=16384;nA.firstColumnName="A";nA.lastColumnName="XFD"});var Eb=Y(SL=>{_();var CQ=An();Object.defineProperty(SL,"__esModule",{value:!0});SL.SchemaObject=void 0;var SUe=CQ(L_()),yUe=CQ(at()),CUe=CQ(it());function _Ue(e,r){var n=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=RUe(e))||r&&e&&typeof e.length=="number"){n&&(e=n);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function RUe(e,r){if(e){if(typeof e=="string")return wde(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wde(e,r)}}function wde(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,a=new Array(r);n<r;n++)a[n]=e[n];return a}var hL=function(){function e(r){(0,yUe.default)(this,e),e.assign(e,this,r)}return(0,CUe.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_SchemaObject"}},{key:"getBaseTypes",value:function(){return[]}},{key:"getTypeNameFor",value:function(n){return n&&n.H_?n.H_.T_:void 0}},{key:"getBaseTypesFor",value:function(n){return n&&n.H_&&n.H_.B_?n.H_.B_:[]}},{key:"getAllTypesFor",value:function(n){var a=e.getTypeNameFor(n);return a?[a].concat((0,SUe.default)(e.getBaseTypesFor(n))):[]}},{key:"matchesTypesFor",value:function(n,a){if(!Array.isArray(a)||a.length===0)return!0;for(var o=e.getTypeNameFor(n),u=e.getBaseTypesFor(n),t=_Ue(a),d;!(d=t()).done;){var s=d.value;if(s===o||u.indexOf(s)>=0)return!0}return!1}},{key:"assign",value:function(n,a,o){if(o)for(var u=0,t=Object.keys(o);u<t.length;u++){var d=t[u];a[d]=o[d]}return a.H_=n.H_,a}}]),e}();SL.SchemaObject=hL;hL.H_={T_:hL.getTypeName(),B_:hL.getBaseTypes()}});var Bde=Y(tA=>{_();var Dde=An();Object.defineProperty(tA,"__esModule",{value:!0});tA.BinaryClassificationAnnotation=tA.Annotation=void 0;var xde=Dde(at()),Lde=Dde(it()),_L=Eb(),yL=function(){function e(r){(0,xde.default)(this,e),_L.SchemaObject.assign(e,this,r)}return(0,Lde.default)(e,[{key:"metadata",get:function(){return this.M_},set:function(n){this.M_=n}}],[{key:"getTypeName",value:function(){return"AugLoop_Core_Annotation"}},{key:"getBaseTypes",value:function(){return[]}},{key:"typeGuard",value:function(n){return _L.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();tA.Annotation=yL;yL.H_={T_:yL.getTypeName(),B_:yL.getBaseTypes()};var CL=function(){function e(r){(0,xde.default)(this,e),_L.SchemaObject.assign(e,this,r)}return(0,Lde.default)(e,[{key:"metadata",get:function(){return this.M_},set:function(n){this.M_=n}}],[{key:"getTypeName",value:function(){return"AugLoop_Core_BinaryClassificationAnnotation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Annotation"]}},{key:"typeGuard",value:function(n){return _L.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();tA.BinaryClassificationAnnotation=CL;CL.H_={T_:CL.getTypeName(),B_:CL.getBaseTypes()}});var Kde=Y(aA=>{_();var qde=An();Object.defineProperty(aA,"__esModule",{value:!0});aA.UserCommand=aA.Event=void 0;var Ude=qde(at()),Gde=qde(it()),bL=Eb(),RL=function(){function e(r){(0,Ude.default)(this,e),bL.SchemaObject.assign(e,this,r)}return(0,Gde.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_Event"}},{key:"getBaseTypes",value:function(){return[]}},{key:"typeGuard",value:function(n){return bL.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();aA.Event=RL;RL.H_={T_:RL.getTypeName(),B_:RL.getBaseTypes()};var TL=function(){function e(r){(0,Ude.default)(this,e),bL.SchemaObject.assign(e,this,r)}return(0,Gde.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_UserCommand"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Event"]}},{key:"typeGuard",value:function(n){return bL.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();aA.UserCommand=TL;TL.H_={T_:TL.getTypeName(),B_:TL.getBaseTypes()}});var Wde=Y(Uo=>{_();var Vde=An();Object.defineProperty(Uo,"__esModule",{value:!0});Uo.VisibilityOperation=Uo.UpdateOperation=Uo.UpdateAnnotationMetaDataOperation=Uo.SignalOperation=Uo.PurgeOperation=Uo.OperationWithSiblingContext=Uo.Operation=Uo.MoveOperation=Uo.MicroSyncOperation=Uo.ItemDelta=Uo.ItemChangesDelta=Uo.FocusOperation=Uo.DeltaUpdateOperation=Uo.DeleteOperation=Uo.AddOperation=void 0;var h0=Vde(at()),S0=Vde(it()),mu=Eb(),PL=function(){function e(r){(0,h0.default)(this,e),mu.SchemaObject.assign(e,this,r)}return(0,S0.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_ItemDelta"}},{key:"getBaseTypes",value:function(){return[]}},{key:"typeGuard",value:function(n){return mu.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Uo.ItemDelta=PL;PL.H_={T_:PL.getTypeName(),B_:PL.getBaseTypes()};var EL=function(){function e(r){(0,h0.default)(this,e),mu.SchemaObject.assign(e,this,r)}return(0,S0.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_ItemChangesDelta"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_ItemDelta"]}},{key:"typeGuard",value:function(n){return mu.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Uo.ItemChangesDelta=EL;EL.H_={T_:EL.getTypeName(),B_:EL.getBaseTypes()};var NL=function(){function e(r){(0,h0.default)(this,e),mu.SchemaObject.assign(e,this,r)}return(0,S0.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_Operation"}},{key:"getBaseTypes",value:function(){return[]}},{key:"typeGuard",value:function(n){return mu.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Uo.Operation=NL;NL.H_={T_:NL.getTypeName(),B_:NL.getBaseTypes()};var AL=function(){function e(r){(0,h0.default)(this,e),mu.SchemaObject.assign(e,this,r)}return(0,S0.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_OperationWithSiblingContext"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Operation"]}},{key:"typeGuard",value:function(n){return mu.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Uo.OperationWithSiblingContext=AL;AL.H_={T_:AL.getTypeName(),B_:AL.getBaseTypes()};var OL=function(){function e(r){(0,h0.default)(this,e),mu.SchemaObject.assign(e,this,r)}return(0,S0.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_AddOperation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}},{key:"typeGuard",value:function(n){return mu.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Uo.AddOperation=OL;OL.H_={T_:OL.getTypeName(),B_:OL.getBaseTypes()};var kL=function(){function e(r){(0,h0.default)(this,e),mu.SchemaObject.assign(e,this,r)}return(0,S0.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_MoveOperation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}},{key:"typeGuard",value:function(n){return mu.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Uo.MoveOperation=kL;kL.H_={T_:kL.getTypeName(),B_:kL.getBaseTypes()};var FL=function(){function e(r){(0,h0.default)(this,e),mu.SchemaObject.assign(e,this,r)}return(0,S0.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_UpdateAnnotationMetaDataOperation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Operation"]}},{key:"typeGuard",value:function(n){return mu.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Uo.UpdateAnnotationMetaDataOperation=FL;FL.H_={T_:FL.getTypeName(),B_:FL.getBaseTypes()};var IL=function(){function e(r){(0,h0.default)(this,e),mu.SchemaObject.assign(e,this,r)}return(0,S0.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_UpdateOperation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Operation"]}},{key:"typeGuard",value:function(n){return mu.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Uo.UpdateOperation=IL;IL.H_={T_:IL.getTypeName(),B_:IL.getBaseTypes()};var ML=function(){function e(r){(0,h0.default)(this,e),mu.SchemaObject.assign(e,this,r)}return(0,S0.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_DeleteOperation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Operation"]}},{key:"typeGuard",value:function(n){return mu.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Uo.DeleteOperation=ML;ML.H_={T_:ML.getTypeName(),B_:ML.getBaseTypes()};var wL=function(){function e(r){(0,h0.default)(this,e),mu.SchemaObject.assign(e,this,r)}return(0,S0.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_PurgeOperation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Operation"]}},{key:"typeGuard",value:function(n){return mu.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Uo.PurgeOperation=wL;wL.H_={T_:wL.getTypeName(),B_:wL.getBaseTypes()};var DL=function(){function e(r){(0,h0.default)(this,e),mu.SchemaObject.assign(e,this,r)}return(0,S0.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_FocusOperation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Operation"]}},{key:"typeGuard",value:function(n){return mu.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Uo.FocusOperation=DL;DL.H_={T_:DL.getTypeName(),B_:DL.getBaseTypes()};var xL=function(){function e(r){(0,h0.default)(this,e),mu.SchemaObject.assign(e,this,r)}return(0,S0.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_VisibilityOperation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Operation"]}},{key:"typeGuard",value:function(n){return mu.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Uo.VisibilityOperation=xL;xL.H_={T_:xL.getTypeName(),B_:xL.getBaseTypes()};var LL=function(){function e(r){(0,h0.default)(this,e),mu.SchemaObject.assign(e,this,r)}return(0,S0.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_DeltaUpdateOperation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Operation"]}},{key:"typeGuard",value:function(n){return mu.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Uo.DeltaUpdateOperation=LL;LL.H_={T_:LL.getTypeName(),B_:LL.getBaseTypes()};var BL=function(){function e(r){(0,h0.default)(this,e),mu.SchemaObject.assign(e,this,r)}return(0,S0.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_MicroSyncOperation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Operation"]}},{key:"typeGuard",value:function(n){return mu.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Uo.MicroSyncOperation=BL;BL.H_={T_:BL.getTypeName(),B_:BL.getBaseTypes()};var qL=function(){function e(r){(0,h0.default)(this,e),mu.SchemaObject.assign(e,this,r)}return(0,S0.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Signals_SignalOperation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Operation"]}},{key:"typeGuard",value:function(n){return mu.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Uo.SignalOperation=qL;qL.H_={T_:qL.getTypeName(),B_:qL.getBaseTypes()}});var zde=Y(iA=>{_();var jde=An();Object.defineProperty(iA,"__esModule",{value:!0});iA.Signal=iA.DirtyAreaSignal=void 0;var Hde=jde(at()),Qde=jde(it()),KL=Eb(),UL=function(){function e(r){(0,Hde.default)(this,e),KL.SchemaObject.assign(e,this,r)}return(0,Qde.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Signals_Signal"}},{key:"getBaseTypes",value:function(){return[]}},{key:"typeGuard",value:function(n){return KL.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();iA.Signal=UL;UL.H_={T_:UL.getTypeName(),B_:UL.getBaseTypes()};var GL=function(){function e(r){(0,Hde.default)(this,e),KL.SchemaObject.assign(e,this,r)}return(0,Qde.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_DirtyAreaSignal"}},{key:"getBaseTypes",value:function(){return["AugLoop_Signals_Signal"]}},{key:"typeGuard",value:function(n){return KL.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();iA.DirtyAreaSignal=GL;GL.H_={T_:GL.getTypeName(),B_:GL.getBaseTypes()}});var Jde=Y(Go=>{_();var Yde=An();Object.defineProperty(Go,"__esModule",{value:!0});Go.UserContextHolder=Go.UserCommandsHolder=Go.TileGroup=Go.TenantContextHolder=Go.SubDocument=Go.Session=Go.ItemFilter=Go.GridNeighborhoodContext=Go.GridCell=Go.EventsHolder=Go.DynamicContext=Go.Document=Go.ContextHolder=Go.Blob=Go.Binary=void 0;var y0=Yde(at()),C0=Yde(it()),gu=Eb(),VL=function(){function e(r){(0,y0.default)(this,e),gu.SchemaObject.assign(e,this,r)}return(0,C0.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_Blob"}},{key:"getBaseTypes",value:function(){return[]}},{key:"typeGuard",value:function(n){return gu.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Go.Blob=VL;VL.H_={T_:VL.getTypeName(),B_:VL.getBaseTypes()};var WL=function(){function e(r){(0,y0.default)(this,e),gu.SchemaObject.assign(e,this,r)}return(0,C0.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_Binary"}},{key:"getBaseTypes",value:function(){return[]}},{key:"typeGuard",value:function(n){return gu.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Go.Binary=WL;WL.H_={T_:WL.getTypeName(),B_:WL.getBaseTypes()};var jL=function(){function e(r){(0,y0.default)(this,e),gu.SchemaObject.assign(e,this,r)}return(0,C0.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_TileGroup"}},{key:"getBaseTypes",value:function(){return[]}},{key:"typeGuard",value:function(n){return gu.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Go.TileGroup=jL;jL.H_={T_:jL.getTypeName(),B_:jL.getBaseTypes()};var HL=function(){function e(r){(0,y0.default)(this,e),gu.SchemaObject.assign(e,this,r)}return(0,C0.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_Session"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_TileGroup"]}},{key:"typeGuard",value:function(n){return gu.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Go.Session=HL;HL.H_={T_:HL.getTypeName(),B_:HL.getBaseTypes()};var QL=function(){function e(r){(0,y0.default)(this,e),gu.SchemaObject.assign(e,this,r)}return(0,C0.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_Document"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_TileGroup"]}},{key:"typeGuard",value:function(n){return gu.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Go.Document=QL;QL.H_={T_:QL.getTypeName(),B_:QL.getBaseTypes()};var zL=function(){function e(r){(0,y0.default)(this,e),gu.SchemaObject.assign(e,this,r)}return(0,C0.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_SubDocument"}},{key:"getBaseTypes",value:function(){return[]}},{key:"typeGuard",value:function(n){return gu.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Go.SubDocument=zL;zL.H_={T_:zL.getTypeName(),B_:zL.getBaseTypes()};var YL=function(){function e(r){(0,y0.default)(this,e),gu.SchemaObject.assign(e,this,r)}return(0,C0.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_GridCell"}},{key:"getBaseTypes",value:function(){return[]}},{key:"typeGuard",value:function(n){return gu.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Go.GridCell=YL;YL.H_={T_:YL.getTypeName(),B_:YL.getBaseTypes()};var JL=function(){function e(r){(0,y0.default)(this,e),gu.SchemaObject.assign(e,this,r)}return(0,C0.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_GridNeighborhoodContext"}},{key:"getBaseTypes",value:function(){return[]}},{key:"typeGuard",value:function(n){return gu.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Go.GridNeighborhoodContext=JL;JL.H_={T_:JL.getTypeName(),B_:JL.getBaseTypes()};var XL=function(){function e(r){(0,y0.default)(this,e),gu.SchemaObject.assign(e,this,r)}return(0,C0.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_ItemFilter"}},{key:"getBaseTypes",value:function(){return[]}},{key:"typeGuard",value:function(n){return gu.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Go.ItemFilter=XL;XL.H_={T_:XL.getTypeName(),B_:XL.getBaseTypes()};var ZL=function(){function e(r){(0,y0.default)(this,e),gu.SchemaObject.assign(e,this,r)}return(0,C0.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_DynamicContext"}},{key:"getBaseTypes",value:function(){return[]}},{key:"typeGuard",value:function(n){return gu.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Go.DynamicContext=ZL;ZL.H_={T_:ZL.getTypeName(),B_:ZL.getBaseTypes()};var $L=function(){function e(r){(0,y0.default)(this,e),gu.SchemaObject.assign(e,this,r)}return(0,C0.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_ContextHolder"}},{key:"getBaseTypes",value:function(){return[]}},{key:"typeGuard",value:function(n){return gu.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Go.ContextHolder=$L;$L.H_={T_:$L.getTypeName(),B_:$L.getBaseTypes()};var e5=function(){function e(r){(0,y0.default)(this,e),gu.SchemaObject.assign(e,this,r)}return(0,C0.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_UserContextHolder"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_ContextHolder"]}},{key:"typeGuard",value:function(n){return gu.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Go.UserContextHolder=e5;e5.H_={T_:e5.getTypeName(),B_:e5.getBaseTypes()};var r5=function(){function e(r){(0,y0.default)(this,e),gu.SchemaObject.assign(e,this,r)}return(0,C0.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_TenantContextHolder"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_ContextHolder"]}},{key:"typeGuard",value:function(n){return gu.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Go.TenantContextHolder=r5;r5.H_={T_:r5.getTypeName(),B_:r5.getBaseTypes()};var n5=function(){function e(r){(0,y0.default)(this,e),gu.SchemaObject.assign(e,this,r)}return(0,C0.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_EventsHolder"}},{key:"getBaseTypes",value:function(){return[]}},{key:"typeGuard",value:function(n){return gu.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Go.EventsHolder=n5;n5.H_={T_:n5.getTypeName(),B_:n5.getBaseTypes()};var t5=function(){function e(r){(0,y0.default)(this,e),gu.SchemaObject.assign(e,this,r)}return(0,C0.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_UserCommandsHolder"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_EventsHolder"]}},{key:"typeGuard",value:function(n){return gu.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Go.UserCommandsHolder=t5;t5.H_={T_:t5.getTypeName(),B_:t5.getBaseTypes()}});var MQ=Y(eo=>{_();Object.defineProperty(eo,"__esModule",{value:!0});var xh={OperationErrorCode:!0,ItemOperation:!0,ItemChanges:!0};Object.defineProperty(eo,"ItemChanges",{enumerable:!0,get:function(){return IQ.ItemChanges}});Object.defineProperty(eo,"ItemOperation",{enumerable:!0,get:function(){return IQ.ItemOperation}});Object.defineProperty(eo,"OperationErrorCode",{enumerable:!0,get:function(){return IQ.OperationErrorCode}});var _Q=bde();Object.keys(_Q).forEach(function(e){e==="default"||e==="__esModule"||Object.prototype.hasOwnProperty.call(xh,e)||e in eo&&eo[e]===_Q[e]||Object.defineProperty(eo,e,{enumerable:!0,get:function(){return _Q[e]}})});var RQ=Ede();Object.keys(RQ).forEach(function(e){e==="default"||e==="__esModule"||Object.prototype.hasOwnProperty.call(xh,e)||e in eo&&eo[e]===RQ[e]||Object.defineProperty(eo,e,{enumerable:!0,get:function(){return RQ[e]}})});var IQ=Nde(),TQ=Ode();Object.keys(TQ).forEach(function(e){e==="default"||e==="__esModule"||Object.prototype.hasOwnProperty.call(xh,e)||e in eo&&eo[e]===TQ[e]||Object.defineProperty(eo,e,{enumerable:!0,get:function(){return TQ[e]}})});var bQ=Fde();Object.keys(bQ).forEach(function(e){e==="default"||e==="__esModule"||Object.prototype.hasOwnProperty.call(xh,e)||e in eo&&eo[e]===bQ[e]||Object.defineProperty(eo,e,{enumerable:!0,get:function(){return bQ[e]}})});var PQ=Mde();Object.keys(PQ).forEach(function(e){e==="default"||e==="__esModule"||Object.prototype.hasOwnProperty.call(xh,e)||e in eo&&eo[e]===PQ[e]||Object.defineProperty(eo,e,{enumerable:!0,get:function(){return PQ[e]}})});var EQ=Bde();Object.keys(EQ).forEach(function(e){e==="default"||e==="__esModule"||Object.prototype.hasOwnProperty.call(xh,e)||e in eo&&eo[e]===EQ[e]||Object.defineProperty(eo,e,{enumerable:!0,get:function(){return EQ[e]}})});var NQ=Kde();Object.keys(NQ).forEach(function(e){e==="default"||e==="__esModule"||Object.prototype.hasOwnProperty.call(xh,e)||e in eo&&eo[e]===NQ[e]||Object.defineProperty(eo,e,{enumerable:!0,get:function(){return NQ[e]}})});var AQ=Wde();Object.keys(AQ).forEach(function(e){e==="default"||e==="__esModule"||Object.prototype.hasOwnProperty.call(xh,e)||e in eo&&eo[e]===AQ[e]||Object.defineProperty(eo,e,{enumerable:!0,get:function(){return AQ[e]}})});var OQ=Eb();Object.keys(OQ).forEach(function(e){e==="default"||e==="__esModule"||Object.prototype.hasOwnProperty.call(xh,e)||e in eo&&eo[e]===OQ[e]||Object.defineProperty(eo,e,{enumerable:!0,get:function(){return OQ[e]}})});var kQ=zde();Object.keys(kQ).forEach(function(e){e==="default"||e==="__esModule"||Object.prototype.hasOwnProperty.call(xh,e)||e in eo&&eo[e]===kQ[e]||Object.defineProperty(eo,e,{enumerable:!0,get:function(){return kQ[e]}})});var FQ=Jde();Object.keys(FQ).forEach(function(e){e==="default"||e==="__esModule"||Object.prototype.hasOwnProperty.call(xh,e)||e in eo&&eo[e]===FQ[e]||Object.defineProperty(eo,e,{enumerable:!0,get:function(){return FQ[e]}})})});var Zde=Y(Hl=>{_();var Xde=An();Object.defineProperty(Hl,"__esModule",{value:!0});Hl.TableLintWorksheetAggregateAnnotation=Hl.TableLintUnsupportedFeatureAnnotation=Hl.TableLintTextInconsistencySuggestion=Hl.TableLintSuggestion=Hl.TableLintNumberFormattingInconsistencySuggestion=Hl.TableLintExtraSpacesSuggestion=Hl.TableLintErrorAnnotation=Hl.TableLintColumnAnnotation=Hl.TableLintAnnotationBase=Hl.TableLintAnnotation=void 0;var WS=Xde(at()),jS=Xde(it()),jc=MQ(),a5=function(){function e(r){(0,WS.default)(this,e),jc.SchemaObject.assign(e,this,r)}return(0,jS.default)(e,[{key:"metadata",get:function(){return this.M_},set:function(n){this.M_=n}}],[{key:"getTypeName",value:function(){return"AugLoop_Tablelint_TableLintAnnotationBase"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Annotation"]}},{key:"typeGuard",value:function(n){return jc.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Hl.TableLintAnnotationBase=a5;a5.H_={T_:a5.getTypeName(),B_:a5.getBaseTypes()};var i5=function(){function e(r){(0,WS.default)(this,e),jc.SchemaObject.assign(e,this,r)}return(0,jS.default)(e,[{key:"metadata",get:function(){return this.M_},set:function(n){this.M_=n}}],[{key:"getTypeName",value:function(){return"AugLoop_Tablelint_TableLintAnnotation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Tablelint_TableLintAnnotationBase","AugLoop_Core_Annotation"]}},{key:"typeGuard",value:function(n){return jc.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Hl.TableLintAnnotation=i5;i5.H_={T_:i5.getTypeName(),B_:i5.getBaseTypes()};var o5=function(){function e(r){(0,WS.default)(this,e),jc.SchemaObject.assign(e,this,r)}return(0,jS.default)(e,[{key:"metadata",get:function(){return this.M_},set:function(n){this.M_=n}}],[{key:"getTypeName",value:function(){return"AugLoop_Tablelint_TableLintColumnAnnotation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Tablelint_TableLintAnnotationBase","AugLoop_Core_Annotation"]}},{key:"typeGuard",value:function(n){return jc.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Hl.TableLintColumnAnnotation=o5;o5.H_={T_:o5.getTypeName(),B_:o5.getBaseTypes()};var u5=function(){function e(r){(0,WS.default)(this,e),jc.SchemaObject.assign(e,this,r)}return(0,jS.default)(e,[{key:"metadata",get:function(){return this.M_},set:function(n){this.M_=n}}],[{key:"getTypeName",value:function(){return"AugLoop_Tablelint_TableLintErrorAnnotation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Tablelint_TableLintAnnotationBase","AugLoop_Core_Annotation"]}},{key:"typeGuard",value:function(n){return jc.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Hl.TableLintErrorAnnotation=u5;u5.H_={T_:u5.getTypeName(),B_:u5.getBaseTypes()};var s5=function(){function e(r){(0,WS.default)(this,e),jc.SchemaObject.assign(e,this,r)}return(0,jS.default)(e,[{key:"metadata",get:function(){return this.M_},set:function(n){this.M_=n}}],[{key:"getTypeName",value:function(){return"AugLoop_Tablelint_TableLintUnsupportedFeatureAnnotation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Tablelint_TableLintAnnotationBase","AugLoop_Core_Annotation"]}},{key:"typeGuard",value:function(n){return jc.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Hl.TableLintUnsupportedFeatureAnnotation=s5;s5.H_={T_:s5.getTypeName(),B_:s5.getBaseTypes()};var l5=function(){function e(r){(0,WS.default)(this,e),jc.SchemaObject.assign(e,this,r)}return(0,jS.default)(e,[{key:"metadata",get:function(){return this.M_},set:function(n){this.M_=n}}],[{key:"getTypeName",value:function(){return"AugLoop_Tablelint_TableLintWorksheetAggregateAnnotation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Annotation"]}},{key:"typeGuard",value:function(n){return jc.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Hl.TableLintWorksheetAggregateAnnotation=l5;l5.H_={T_:l5.getTypeName(),B_:l5.getBaseTypes()};var c5=function(){function e(r){(0,WS.default)(this,e),jc.SchemaObject.assign(e,this,r)}return(0,jS.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Tablelint_TableLintSuggestion"}},{key:"getBaseTypes",value:function(){return[]}},{key:"typeGuard",value:function(n){return jc.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Hl.TableLintSuggestion=c5;c5.H_={T_:c5.getTypeName(),B_:c5.getBaseTypes()};var d5=function(){function e(r){(0,WS.default)(this,e),jc.SchemaObject.assign(e,this,r)}return(0,jS.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Tablelint_TableLintTextInconsistencySuggestion"}},{key:"getBaseTypes",value:function(){return["AugLoop_Tablelint_TableLintSuggestion"]}},{key:"typeGuard",value:function(n){return jc.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Hl.TableLintTextInconsistencySuggestion=d5;d5.H_={T_:d5.getTypeName(),B_:d5.getBaseTypes()};var f5=function(){function e(r){(0,WS.default)(this,e),jc.SchemaObject.assign(e,this,r)}return(0,jS.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Tablelint_TableLintNumberFormattingInconsistencySuggestion"}},{key:"getBaseTypes",value:function(){return["AugLoop_Tablelint_TableLintSuggestion"]}},{key:"typeGuard",value:function(n){return jc.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Hl.TableLintNumberFormattingInconsistencySuggestion=f5;f5.H_={T_:f5.getTypeName(),B_:f5.getBaseTypes()};var p5=function(){function e(r){(0,WS.default)(this,e),jc.SchemaObject.assign(e,this,r)}return(0,jS.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Tablelint_TableLintExtraSpacesSuggestion"}},{key:"getBaseTypes",value:function(){return["AugLoop_Tablelint_TableLintSuggestion"]}},{key:"typeGuard",value:function(n){return jc.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();Hl.TableLintExtraSpacesSuggestion=p5;p5.H_={T_:p5.getTypeName(),B_:p5.getBaseTypes()}});var rfe=Y(g5=>{_();var efe=An();Object.defineProperty(g5,"__esModule",{value:!0});g5.TableLintLogMetric=void 0;var TUe=efe(at()),bUe=efe(it()),$de=MQ(),m5=function(){function e(r){(0,TUe.default)(this,e),$de.SchemaObject.assign(e,this,r)}return(0,bUe.default)(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Tablelint_TableLintLogMetric"}},{key:"getBaseTypes",value:function(){return[]}},{key:"typeGuard",value:function(n){return $de.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}]),e}();g5.TableLintLogMetric=m5;m5.H_={T_:m5.getTypeName(),B_:m5.getBaseTypes()}});var nfe=Y(Lh=>{_();Object.defineProperty(Lh,"__esModule",{value:!0});var wQ=Tde();Object.keys(wQ).forEach(function(e){e==="default"||e==="__esModule"||e in Lh&&Lh[e]===wQ[e]||Object.defineProperty(Lh,e,{enumerable:!0,get:function(){return wQ[e]}})});var DQ=Zde();Object.keys(DQ).forEach(function(e){e==="default"||e==="__esModule"||e in Lh&&Lh[e]===DQ[e]||Object.defineProperty(Lh,e,{enumerable:!0,get:function(){return DQ[e]}})});var xQ=rfe();Object.keys(xQ).forEach(function(e){e==="default"||e==="__esModule"||e in Lh&&Lh[e]===xQ[e]||Object.defineProperty(Lh,e,{enumerable:!0,get:function(){return xQ[e]}})})});var sfe=Y(oA=>{_();var PUe=An();Object.defineProperty(oA,"__esModule",{value:!0});oA.deserializeDataCleansingAnnotations=EUe;oA.parseAggregateAnnotation=ife;oA.parseColumnAnnotation=ofe;oA.serializeAnnotation=NUe;var tfe=PUe(L_()),afe=nfe(),LQ=vL();function EUe(e){return[].concat((0,tfe.default)(AUe(e)),(0,tfe.default)(OUe(e)))}function ife(e){return new afe.TableLintWorksheetAggregateAnnotation(JSON.parse(e.serializedData))}function ofe(e){return new afe.TableLintColumnAnnotation(JSON.parse(e.serializedData))}function NUe(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:LQ.OperationType.Invalid,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;return{serializedData:JSON.stringify(e),annotationType:r,operationType:n,validated:a}}function AUe(e){return ufe(e,LQ.AnnotationType_TableLintColumnAnnotation,ofe)}function OUe(e){return ufe(e,LQ.AnnotationType_TableLintWorksheetAggregateAnnotation,ife)}function ufe(e,r,n){return(e==null?void 0:e.filter(function(a){return a.annotationType===r}).map(n))||[]}});var pfe=Y(S5=>{_();var qQ=An();Object.defineProperty(S5,"__esModule",{value:!0});S5.Manager=void 0;var BQ=qQ(Y0()),kUe=qQ(at()),FUe=qQ(it()),v5=Sde(),IUe=wUe(_de()),h5=sfe(),lfe=Yy(),cfe=Ih(),dfe=sM(),MUe=jI();function ffe(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,n=new WeakMap;return(ffe=function(o){return o?n:r})(e)}function wUe(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var n=ffe(r);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(u!=="default"&&Object.prototype.hasOwnProperty.call(e,u)){var t=o?Object.getOwnPropertyDescriptor(e,u):null;t&&(t.get||t.set)?Object.defineProperty(a,u,t):a[u]=e[u]}return a.default=e,n&&n.set(e,a),a}var DUe=function(){function e(r,n,a){var o=this;(0,kUe.default)(this,e),this.ServiceInfo=IUe.ServiceInfos.DataCleansingAnnotationsService,this.onNewAnnotationList=new dfe.UxppEvent(this.ServiceInfo,(0,dfe.nameOfEvent)("onNewAnnotationList")),this.annotationsProvider=r,this.annotationsStorage=n,this.logger=a,this.annotationsStorage.registerAnnotationCollectionUpdated(function(){var t;return BQ.default.async(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,BQ.default.awrap(o.getAnnotationList());case 2:t=s.sent,o.logger.sendTraceTag(508703247,lfe.LogCategory.msoulscat_ES_EWAJS,cfe.TraceLevel.Info,"UxppDataCleansingManager.AnnotationCollectionUpdated: Got "+t.length+" annotations"),o.onNewAnnotationList.trigger(t);case 5:case"end":return s.stop()}},null,null,null,Promise)}),(0,MUe.getBooleanFeatureGate)("Microsoft.Office.Excel.DataCleansingDesktop",!1)&&this.annotationsProvider.registerAnnotations(function(u){return o.annotationArrived(u)})}return(0,FUe.default)(e,[{key:"annotationArrived",value:function(n){switch(n.annotationType){case v5.AnnotationType_TableLintColumnAnnotation:this.annotationsStorage.addColumnAnnotation((0,h5.parseColumnAnnotation)(n));break;case v5.AnnotationType_TableLintWorksheetAggregateAnnotation:this.annotationsStorage.addAggregateAnnotation((0,h5.parseAggregateAnnotation)(n));break;default:break}}},{key:"getAnnotationList",value:function(){var n,a;return BQ.default.async(function(u){for(;;)switch(u.prev=u.next){case 0:return n=[],a=this.annotationsStorage.getAllAnnotations(),a.aggregateAnnotations.forEach(function(t){n.push((0,h5.serializeAnnotation)(t,v5.AnnotationType_TableLintWorksheetAggregateAnnotation))}),a.columnAnnotations.forEach(function(t){n.push((0,h5.serializeAnnotation)(t,v5.AnnotationType_TableLintColumnAnnotation))}),this.logger.sendTraceTag(508703246,lfe.LogCategory.msoulscat_ES_EWAJS,cfe.TraceLevel.Info,"UxppDataCleansingManager.getAnnotationList: Got "+n.length+" annotations"),u.abrupt("return",n);case 6:case"end":return u.stop()}},null,this,null,Promise)}}]),e}();S5.Manager=DUe});var gfe=Y(C5=>{_();var GQ=An();Object.defineProperty(C5,"__esModule",{value:!0});C5.AnnotationsProvider=void 0;var y5=GQ(Y0()),xUe=GQ(at()),LUe=GQ(it()),Bh=vL(),UQ=Ih(),mfe=Yy(),BUe=function(){function e(r,n){(0,xUe.default)(this,e),this.annotationArrivedCallback=void 0,this.connectionClosedCallback=void 0,this.annotationsManager=r,this.logger=n}return(0,LUe.default)(e,[{key:"registerAnnotations",value:function(n){var a=this;return y5.default.async(function(u){for(;;)switch(u.prev=u.next){case 0:if(this.annotationArrivedCallback===void 0){u.next=2;break}throw new Error("Annotations already registered");case 2:return this.annotationArrivedCallback=n,u.next=5,y5.default.awrap(Promise.all([this.annotationsManager.registerAnnotation(Bh.AnnotationType_TableLintColumnAnnotation,!0,function(t){return a.onAnnotationArrived(t)}),this.annotationsManager.registerAnnotation(Bh.AnnotationType_TableLintWorksheetAggregateAnnotation,!0,function(t){return a.onAnnotationArrived(t)})]));case 5:this.logger.sendTraceTag(0,mfe.LogCategory.msoulscat_ES_EWAJS,UQ.TraceLevel.Info,"AnnotationsProvider.registerAnnotations: registered annotations");case 6:case"end":return u.stop()}},null,this,null,Promise)}},{key:"registerOnClose",value:function(n){var a=this;return y5.default.async(function(u){for(;;)switch(u.prev=u.next){case 0:if(this.connectionClosedCallback===void 0){u.next=2;break}throw new Error("Closed connection already registered");case 2:return this.connectionClosedCallback=n,u.next=5,y5.default.awrap(this.annotationsManager.registerOnClose(function(t){return a.connectionClosedCallback==null?void 0:a.connectionClosedCallback(t)}));case 5:this.logger.sendTraceTag(0,mfe.LogCategory.msoulscat_ES_EWAJS,UQ.TraceLevel.Info,"AnnotationsProvider.registerOnClose: registered on close");case 6:case"end":return u.stop()}},null,this,null,Promise)}},{key:"onAnnotationArrived",value:function(n){var a;switch(n.operationType){case Bh.OperationType.Add:case Bh.OperationType.Update:(a=this.annotationArrivedCallback)==null||a.call(this,n);break;case Bh.OperationType.Invalid:case Bh.OperationType.Move:case Bh.OperationType.UpdateAnnotationMetaData:case Bh.OperationType.Delete:case Bh.OperationType.Purge:case Bh.OperationType.Focus:case Bh.OperationType.Visibility:break;default:(0,UQ.isNever)(n.operationType)}}}]),e}();C5.AnnotationsProvider=BUe});var V_=Y(($fn,dM)=>{_();var qUe=QW();function UUe(e,r,n){return r=qUe(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}dM.exports=UUe,dM.exports.__esModule=!0,dM.exports.default=dM.exports});var vfe=Y(R5=>{_();var _5=An();Object.defineProperty(R5,"__esModule",{value:!0});R5.AnnotationsStorage=void 0;var fM=_5(V_()),GUe=_5(L_()),KUe=_5(at()),VUe=_5(it()),uA=Yy(),sA=Ih(),WUe=function(){function e(r){(0,KUe.default)(this,e),this.annotationCollectionUpdatedCallbacks=[],this.sheetAggregateAnnotationBySheet=new Map,this.columnAnnotationsWithNoAggregateAnnotation=new Map,this.columnAnnotationsByAggregateAnnotationId=new Map,this.logger=r}return(0,VUe.default)(e,[{key:"getAllAnnotations",value:function(){var n=this,a={aggregateAnnotations:[],columnAnnotations:[]};return this.sheetAggregateAnnotationBySheet.forEach(function(o){var u,t,d=(u=n.columnAnnotationsByAggregateAnnotationId.get(o.id))!=null?u:[];a.aggregateAnnotations.push(o),(t=a.columnAnnotations).push.apply(t,(0,GUe.default)(d))}),a}},{key:"registerAnnotationCollectionUpdated",value:function(n){this.annotationCollectionUpdatedCallbacks.push(n)}},{key:"addColumnAnnotation",value:function(n){this.columnAnnotationsWithNoAggregateAnnotation.set(n.id,n),this.logger.sendTraceTag(0,uA.LogCategory.msoulscat_ES_EWAJS,sA.TraceLevel.Verbose,"AnnotationsStorage.onColumnAnnotationReceived: Received "+n.id)}},{key:"addAggregateAnnotation",value:function(n){var a,o=this,u=this.sheetAggregateAnnotationBySheet.get(n.worksheetId);this.logger.sendTraceTag(508703244,uA.LogCategory.msoulscat_ES_EWAJS,sA.TraceLevel.Info,"AnnotationsStorage.onAggregateAnnotationReceived: Received "+JSON.stringify((a={},(0,fM.default)(a,"id",n.id),(0,fM.default)(a,"sheetId",n.worksheetId),(0,fM.default)(a,"previous",u==null?void 0:u.id),(0,fM.default)(a,"errorCount",n.errorCount),(0,fM.default)(a,"suggestionsCount",n.suggestionsCount),a))),(u==null?void 0:u.id)===n.id&&this.logger.sendTraceTag(508703243,uA.LogCategory.msoulscat_ES_EWAJS,sA.TraceLevel.Info,"AnnotationsStorage.onAggregateAnnotationReceived: Received duplicate "+n.id),this.sheetAggregateAnnotationBySheet.set(n.worksheetId,n);var t=this.getRelatedPendingAnnotations(n);t.forEach(function(d){o.columnAnnotationsWithNoAggregateAnnotation.delete(d.id)}),this.columnAnnotationsByAggregateAnnotationId.set(n.id,t),this.annotationCollectionUpdated()}},{key:"annotationCollectionUpdated",value:function(){this.annotationCollectionUpdatedCallbacks.forEach(function(n){return n()})}},{key:"getRelatedPendingAnnotations",value:function(n){var a=Array.from(this.columnAnnotationsWithNoAggregateAnnotation.values()).filter(function(d){return d.worksheetId===n.worksheetId});if(!a.length)return this.logger.sendTraceTag(508703242,uA.LogCategory.msoulscat_ES_EWAJS,sA.TraceLevel.Info,"AnnotationsStorage.getRelatedPendingAnnotations: No pending sheet annotations"),[];if(!Array.isArray(n.aggregatedAnnotations))return this.logger.sendTraceTag(508703241,uA.LogCategory.msoulscat_ES_EWAJS,sA.TraceLevel.Important,"AnnotationsStorage.getRelatedPendingAnnotations: No aggregated annotations IDs"),a;var o=new Set(n.aggregatedAnnotations),u=a.filter(function(d){var s;return o.has((s=d.id)!=null?s:"")}),t=a.filter(function(d){return!o.has(d.id)});return t.length&&this.logger.sendTraceTag(508703240,uA.LogCategory.msoulscat_ES_EWAJS,sA.TraceLevel.Info,"AnnotationsStorage.getRelatedPendingAnnotations: Found "+t.length+" unrelated annotations"),u}}]),e}();R5.AnnotationsStorage=WUe});var yfe=Y(lA=>{_();var hfe=An();Object.defineProperty(lA,"__esModule",{value:!0});lA.ServiceInfos=lA.NativeServices=void 0;var jUe=hfe(at()),HUe=hfe(it()),QUe=Ec(),Sfe={DataCleansingStateService:["Uxpp::Internal::RekaServices::DataCleansingStateService",{getState:["ReturnsPromiseMethod","DataCleansing::TaskPane::RekaServices::State",[]],onStateChange:["Event","DataCleansing::TaskPane::RekaServices::State"]}]};lA.ServiceInfos=Sfe;var zUe=function(){function e(){(0,jUe.default)(this,e)}return(0,HUe.default)(e,null,[{key:"DataCleansingStateService",get:function(){return e._DataCleansingStateService??=QUe.RekaServiceRegistry.getNativeService(Sfe.DataCleansingStateService)}}]),e}();lA.NativeServices=zUe});var Rfe=Y(T5=>{_();var KQ=An();Object.defineProperty(T5,"__esModule",{value:!0});T5.StateProvider=void 0;var YUe=KQ(Y0()),JUe=KQ(at()),XUe=KQ(it()),ZUe=Yy(),$Ue=Ih(),Cfe=sM(),eGe=nGe(yfe()),rGe=jI();function _fe(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,n=new WeakMap;return(_fe=function(o){return o?n:r})(e)}function nGe(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var n=_fe(r);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(u!=="default"&&Object.prototype.hasOwnProperty.call(e,u)){var t=o?Object.getOwnPropertyDescriptor(e,u):null;t&&(t.get||t.set)?Object.defineProperty(a,u,t):a[u]=e[u]}return a.default=e,n&&n.set(e,a),a}var tGe=function(){function e(r,n){var a=this;(0,JUe.default)(this,e),this.hostState={errorState:void 0,isFeedbackAllowed:!0},this.ServiceInfo=eGe.ServiceInfos.DataCleansingStateService,this.onStateChange=new Cfe.UxppEvent(this.ServiceInfo,(0,Cfe.nameOfEvent)("onStateChange")),this.annotationsProvider=r,this.logger=n,(0,rGe.getBooleanFeatureGate)("Microsoft.Office.Excel.DataCleansingDesktop",!1)&&this.annotationsProvider.registerOnClose(function(o){return a.connectionClosed(o)})}return(0,XUe.default)(e,[{key:"getState",value:function(){return YUe.default.async(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",this.hostState);case 1:case"end":return a.stop()}},null,this,null,Promise)}},{key:"connectionClosed",value:function(n){this.logger.sendTraceTag(508703253,ZUe.LogCategory.msoulscat_ES_EWAJS,$Ue.TraceLevel.Info,"StateProvider.connectionClosed: Got "+n),this.hostState.errorState=n,this.onStateChange.trigger(this.hostState)}}]),e}();T5.StateProvider=tGe});var Tfe=Y(Nb=>{_();Object.defineProperty(Nb,"__esModule",{value:!0});Nb.nativeNamespace=Nb.TaskPaneId=void 0;var aGe="Uxpp.TaskPanes";Nb.nativeNamespace=aGe;var VQ;Nb.TaskPaneId=VQ;(function(e){e[e.PowerOptionsTaskPane=0]="PowerOptionsTaskPane",e[e.DataCleansingTaskPane=1]="DataCleansingTaskPane",e[e.PowerQueryTaskPane=2]="PowerQueryTaskPane",e[e.NumOfTaskPanes=3]="NumOfTaskPanes"})(VQ||(Nb.TaskPaneId=VQ={}))});var Pfe=Y(HQ=>{_();var iGe=An();Object.defineProperty(HQ,"__esModule",{value:!0});HQ.initDataCleansing=mGe;var oGe=iGe(Y0()),uGe=pfe(),sGe=gfe(),lGe=vfe(),cGe=sM(),bfe=Ih(),dGe=Rfe(),WQ=yb(),fGe=Tfe(),jQ=bb(),pGe=pL();function mGe(e,r,n){var a,o,u,t,d;return oGe.default.async(function(c){for(;;)switch(c.prev=c.next){case 0:a=new sGe.AnnotationsProvider(e,r),o=new lGe.AnnotationsStorage(r),u=new uGe.Manager(a,o,r),t=new dGe.StateProvider(a,r),(0,pGe.getTypedFeatureGate)("Microsoft.Office.Excel.LogFloodgateActivity")&&(d=new cGe.PaneLifecycleManager(r),gGe(d)),n(u,t);case 6:case"end":return c.stop()}},null,null,null,Promise)}function gGe(e){e.registerOnClose(function(r){r.taskPaneId===fGe.TaskPaneId.DataCleansingTaskPane&&(bfe.logger.log(508703252,{eventName:"Office.Excel.DataCleansing.UserClosedTaskPaneDesktopFloodgate",eventFlags:(0,bfe.getFilledEventFlags)(jQ.EnumObjects.DataCategories.ProductServiceUsage,jQ.EnumObjects.DiagnosticLevel.RequiredServiceData,jQ.EnumObjects.SamplingPolicy.CriticalBusinessImpact)}),WQ.ULS.sendTraceTag(508703251,WQ.LogCategory.msoulscat_ES_EWAJS,WQ.TraceLevel.Info,"init.registerOnClose: data cleansing survey, user closed the TP, was triggered"))})}});var Nfe=Y(QQ=>{_();var vGe=An();Object.defineProperty(QQ,"__esModule",{value:!0});QQ.default=yGe;var Efe=vGe(Y0()),hGe=hde(),SGe=Pfe();function yGe(e){var r;return Efe.default.async(function(a){for(;;)switch(a.prev=a.next){case 0:return r=new hGe.AnnotationsManager(e.logger),a.next=3,Efe.default.awrap((0,SGe.initDataCleansing)(r,e.logger,e.registerServiceInstances));case 3:case"end":return a.stop()}},null,null,null,Promise)}});var Afe=Y(b5=>{_();Object.defineProperty(b5,"__esModule",{value:!0});b5.ServiceInfos=void 0;var CGe={SchedulerJsService:["X10::SchedulerJsService",{suggestion:["ReturnsPromiseMethod",["$union",["X10::Shared::Superseded","X10::Suggestion::Done","X10::Shared::Failed"]],["X10::Suggestion::SuggestionRequest"]],valuePreview:["ReturnsPromiseMethod",["$union",["X10::ValuePreview::Done","X10::ValuePreview::Unavailable","X10::Shared::Superseded","X10::Shared::Failed"]],["X10::ValuePreview::ValuePreviewRequest"]]}]};b5.ServiceInfos=CGe});var Ofe=Y(()=>{_();global.window=global;(function(){if(typeof btoa=="function")return!1;var e={ascii:function(){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},indices:function(){if(!this.cache){this.cache={};for(var n=e.ascii(),a=0;a<n.length;a++){var o=n[a];this.cache[o]=a}}return this.cache}};global.btoa=function(r){for(var n=e.ascii(),a=r.length-1,o=-1,u="";o<a;){var t=r.charCodeAt(++o)<<16|r.charCodeAt(++o)<<8|r.charCodeAt(++o);u+=n[t>>>18&63]+n[t>>>12&63]+n[t>>>6&63]+n[t&63]}var d=r.length%3;if(d>0)for(u=u.slice(0,d-3);u.length%4!==0;)u+="=";return u},global.atob=function(r){for(var n=e.indices(),a=r.indexOf("="),o=a>-1,u=o?a:r.length,t=-1,d="";t<u;){var s=n[r[++t]]<<18|n[r[++t]]<<12|n[r[++t]]<<6|n[r[++t]];s!==0&&(d+=String.fromCharCode(s>>>16&255,s>>>8&255,s&255))}return o&&(d=d.slice(0,a-r.length)),d}})()});var kfe=Y(P5=>{_();Object.defineProperty(P5,"__esModule",{value:!0});P5.packageVersion=void 0;var _Ge="46.4.13";P5.packageVersion=_Ge});var Ffe=Y(E5=>{"use strict";_();Object.defineProperty(E5,"__esModule",{value:!0});E5.fnv1a=void 0;var RGe=2166136261;function TGe(e){for(var r=RGe,n=e.length,a=0;a<n;a+=1)r^=e.charCodeAt(a),r+=(r<<1)+(r<<4)+(r<<7)+(r<<8)+(r<<24);return r>>>0}E5.fnv1a=TGe});var zQ=Y(N5=>{"use strict";_();Object.defineProperty(N5,"__esModule",{value:!0});N5.JSF32=void 0;var Ife=function(r,n){return(r<<n|r>>>32-n)>>>0},bGe=function(){function e(r){this.x=new Uint32Array([4058668781,r,r,r]);for(var n=0;n<20;n+=1)this.nextU32()}return e.prototype.next=function(){return this.nextU32()*23283064365386963e-26},e.prototype.nextU32=function(){var r=this.x[0]-Ife(this.x[1],27)>>>0;return this.x[0]=(this.x[1]^Ife(this.x[2],17))>>>0,this.x[1]=this.x[2]+this.x[3]>>>0,this.x[2]=this.x[3]+r>>>0,this.x[3]=r+this.x[0]>>>0},e}();N5.JSF32=bGe});var Mfe=Y(A5=>{"use strict";_();Object.defineProperty(A5,"__esModule",{value:!0});A5.findIsomorphicSubtrees=void 0;function PGe(e,r,n,a){n===void 0&&(n=function(){return""}),a===void 0&&(a=function(){return 1});for(var o=[e],u=new Set(o),t=0;t<o.length;t+=1)for(var d=0,s=r(o[t]);d<s.length;d++){var c=s[d];u.has(c)||(u.add(c),o.push(c))}u.clear(),o.reverse();var l=new Map,f=[],p=new Map;function m(F){var w=p.get(F);return w!==void 0||(w=p.size,p.set(F,w)),w}var v=[];o.forEach(function(F,w){var B=r(F).map(function(U){return l.get(U)});if(B.some(function(U){return U===void 0}))throw new Error("Circular references in the tree");var k=B.map(function(U){return f[U]}),x=k.join("/")+"/"+n(F),G=m(x);if(f.push(G),v[G]===void 0){var H=k.map(function(U){return v[U]}),L=H.map(function(U){return U.size}).reduce(function(U,V){return U+V},a(F)),D=H.map(function(U){return U.depth}).reduce(function(U,V){return Math.max(U,V)},0)+1;v[G]={subtrees:[F],size:L,depth:D}}else v[G].subtrees.push(F);l.set(F,w)});for(var h=0,S=v;h<S.length;h++){var y=S[h];y.subtrees.reverse()}for(var C=new Array(o.length),E=0,I=v;E<I.length;E++){var y=I[E];C[C.length-l.get(y.subtrees[0])-1]=y}return EGe(C)}A5.findIsomorphicSubtrees=PGe;function EGe(e){return e.filter(function(r){return r!==void 0})}});var br=Y(bo=>{_();Object.defineProperty(bo,"__esModule",{value:!0});bo.__assign=void 0;bo.__asyncDelegator=VGe;bo.__asyncGenerator=KGe;bo.__asyncValues=WGe;bo.__await=pM;bo.__awaiter=xGe;bo.__classPrivateFieldGet=YGe;bo.__classPrivateFieldIn=XGe;bo.__classPrivateFieldSet=JGe;bo.__createBinding=void 0;bo.__decorate=OGe;bo.__esDecorate=FGe;bo.__exportStar=BGe;bo.__extends=NGe;bo.__generator=LGe;bo.__importDefault=zGe;bo.__importStar=QGe;bo.__makeTemplateObject=jGe;bo.__metadata=DGe;bo.__param=kGe;bo.__propKey=MGe;bo.__read=wfe;bo.__rest=AGe;bo.__runInitializers=IGe;bo.__setFunctionName=wGe;bo.__spread=qGe;bo.__spreadArray=GGe;bo.__spreadArrays=UGe;bo.__values=XQ;var YQ=function(r,n){return YQ=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var u in o)Object.prototype.hasOwnProperty.call(o,u)&&(a[u]=o[u])},YQ(r,n)};function NGe(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");YQ(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}var JQ=function(){return bo.__assign=JQ=Object.assign||function(n){for(var a,o=1,u=arguments.length;o<u;o++){a=arguments[o];for(var t in a)Object.prototype.hasOwnProperty.call(a,t)&&(n[t]=a[t])}return n},JQ.apply(this,arguments)};bo.__assign=JQ;function AGe(e,r){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&r.indexOf(a)<0&&(n[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,a=Object.getOwnPropertySymbols(e);o<a.length;o++)r.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(n[a[o]]=e[a[o]]);return n}function OGe(e,r,n,a){var o=arguments.length,u=o<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,n):a,t;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(e,r,n,a);else for(var d=e.length-1;d>=0;d--)(t=e[d])&&(u=(o<3?t(u):o>3?t(r,n,u):t(r,n))||u);return o>3&&u&&Object.defineProperty(r,n,u),u}function kGe(e,r){return function(n,a){r(n,a,e)}}function FGe(e,r,n,a,o,u){function t(y){if(y!==void 0&&typeof y!="function")throw new TypeError("Function expected");return y}for(var d=a.kind,s=d==="getter"?"get":d==="setter"?"set":"value",c=!r&&e?a.static?e:e.prototype:null,l=r||(c?Object.getOwnPropertyDescriptor(c,a.name):{}),f,p=!1,m=n.length-1;m>=0;m--){var v={};for(var h in a)v[h]=h==="access"?{}:a[h];for(var h in a.access)v.access[h]=a.access[h];v.addInitializer=function(y){if(p)throw new TypeError("Cannot add initializers after decoration has completed");u.push(t(y||null))};var S=(0,n[m])(d==="accessor"?{get:l.get,set:l.set}:l[s],v);if(d==="accessor"){if(S===void 0)continue;if(S===null||typeof S!="object")throw new TypeError("Object expected");(f=t(S.get))&&(l.get=f),(f=t(S.set))&&(l.set=f),(f=t(S.init))&&o.push(f)}else(f=t(S))&&(d==="field"?o.push(f):l[s]=f)}c&&Object.defineProperty(c,a.name,l),p=!0}function IGe(e,r,n){for(var a=arguments.length>2,o=0;o<r.length;o++)n=a?r[o].call(e,n):r[o].call(e);return a?n:void 0}function MGe(e){return typeof e=="symbol"?e:"".concat(e)}function wGe(e,r,n){return typeof r=="symbol"&&(r=r.description?"[".concat(r.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",r):r})}function DGe(e,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,r)}function xGe(e,r,n,a){function o(u){return u instanceof n?u:new n(function(t){t(u)})}return new(n||(n=Promise))(function(u,t){function d(l){try{c(a.next(l))}catch(f){t(f)}}function s(l){try{c(a.throw(l))}catch(f){t(f)}}function c(l){l.done?u(l.value):o(l.value).then(d,s)}c((a=a.apply(e,r||[])).next())})}function LGe(e,r){var n={label:0,sent:function(){if(u[0]&1)throw u[1];return u[1]},trys:[],ops:[]},a,o,u,t;return t={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(t[Symbol.iterator]=function(){return this}),t;function d(c){return function(l){return s([c,l])}}function s(c){if(a)throw new TypeError("Generator is already executing.");for(;t&&(t=0,c[0]&&(n=0)),n;)try{if(a=1,o&&(u=c[0]&2?o.return:c[0]?o.throw||((u=o.return)&&u.call(o),0):o.next)&&!(u=u.call(o,c[1])).done)return u;switch(o=0,u&&(c=[c[0]&2,u.value]),c[0]){case 0:case 1:u=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,o=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(u=n.trys,!(u=u.length>0&&u[u.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!u||c[1]>u[0]&&c[1]<u[3])){n.label=c[1];break}if(c[0]===6&&n.label<u[1]){n.label=u[1],u=c;break}if(u&&n.label<u[2]){n.label=u[2],n.ops.push(c);break}u[2]&&n.ops.pop(),n.trys.pop();continue}c=r.call(e,n)}catch(l){c=[6,l],o=0}finally{a=u=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}var ZQ=Object.create?function(e,r,n,a){a===void 0&&(a=n);var o=Object.getOwnPropertyDescriptor(r,n);(!o||("get"in o?!r.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return r[n]}}),Object.defineProperty(e,a,o)}:function(e,r,n,a){a===void 0&&(a=n),e[a]=r[n]};bo.__createBinding=ZQ;function BGe(e,r){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(r,n)&&ZQ(r,e,n)}function XQ(e){var r=typeof Symbol=="function"&&Symbol.iterator,n=r&&e[r],a=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function wfe(e,r){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var a=n.call(e),o,u=[],t;try{for(;(r===void 0||r-- >0)&&!(o=a.next()).done;)u.push(o.value)}catch(d){t={error:d}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return u}function qGe(){for(var e=[],r=0;r<arguments.length;r++)e=e.concat(wfe(arguments[r]));return e}function UGe(){for(var e=0,r=0,n=arguments.length;r<n;r++)e+=arguments[r].length;for(var a=Array(e),o=0,r=0;r<n;r++)for(var u=arguments[r],t=0,d=u.length;t<d;t++,o++)a[o]=u[t];return a}function GGe(e,r,n){if(n||arguments.length===2)for(var a=0,o=r.length,u;a<o;a++)(u||!(a in r))&&(u||(u=Array.prototype.slice.call(r,0,a)),u[a]=r[a]);return e.concat(u||Array.prototype.slice.call(r))}function pM(e){return this instanceof pM?(this.v=e,this):new pM(e)}function KGe(e,r,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=n.apply(e,r||[]),o,u=[];return o={},t("next"),t("throw"),t("return"),o[Symbol.asyncIterator]=function(){return this},o;function t(p){a[p]&&(o[p]=function(m){return new Promise(function(v,h){u.push([p,m,v,h])>1||d(p,m)})})}function d(p,m){try{s(a[p](m))}catch(v){f(u[0][3],v)}}function s(p){p.value instanceof pM?Promise.resolve(p.value.v).then(c,l):f(u[0][2],p)}function c(p){d("next",p)}function l(p){d("throw",p)}function f(p,m){p(m),u.shift(),u.length&&d(u[0][0],u[0][1])}}function VGe(e){var r,n;return r={},a("next"),a("throw",function(o){throw o}),a("return"),r[Symbol.iterator]=function(){return this},r;function a(o,u){r[o]=e[o]?function(t){return(n=!n)?{value:pM(e[o](t)),done:!1}:u?u(t):t}:u}}function WGe(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=e[Symbol.asyncIterator],n;return r?r.call(e):(e=typeof XQ=="function"?XQ(e):e[Symbol.iterator](),n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n);function a(u){n[u]=e[u]&&function(t){return new Promise(function(d,s){t=e[u](t),o(d,s,t.done,t.value)})}}function o(u,t,d,s){Promise.resolve(s).then(function(c){u({value:c,done:d})},t)}}function jGe(e,r){return Object.defineProperty?Object.defineProperty(e,"raw",{value:r}):e.raw=r,e}var HGe=Object.create?function(e,r){Object.defineProperty(e,"default",{enumerable:!0,value:r})}:function(e,r){e.default=r};function QGe(e){if(e&&e.__esModule)return e;var r={};if(e!=null)for(var n in e)n!=="default"&&Object.prototype.hasOwnProperty.call(e,n)&&ZQ(r,e,n);return HGe(r,e),r}function zGe(e){return e&&e.__esModule?e:{default:e}}function YGe(e,r,n,a){if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof r=="function"?e!==r||!a:!r.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?a:n==="a"?a.call(e):a?a.value:r.get(e)}function JGe(e,r,n,a,o){if(a==="m")throw new TypeError("Private method is not writable");if(a==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof r=="function"?e!==r||!o:!r.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a==="a"?o.call(e,n):o?o.value=n:r.set(e,n),n}function XGe(e,r){if(r===null||typeof r!="object"&&typeof r!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?r===e:e.has(r)}});var xfe=Y(O5=>{"use strict";_();Object.defineProperty(O5,"__esModule",{value:!0});O5.combinations=void 0;var ZGe=br();function Dfe(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];if(e.length===0)return[[]];for(var n=e[0],a=e.slice(1),o=Dfe.apply(void 0,a),u=[],t=0,d=n;t<d.length;t++)for(var s=d[t],c=0,l=o;c<l.length;c++){var f=l[c];u.push(ZGe.__spreadArray([s],f,!0))}return u}O5.combinations=Dfe});var ez=Y(k5=>{"use strict";_();var $Q;Object.defineProperty(k5,"__esModule",{value:!0});k5.mathLog2=void 0;k5.mathLog2=($Q=Math.log2)!==null&&$Q!==void 0?$Q:function(e){return Math.log(e)*Math.LOG2E}});var F5=Y(qh=>{"use strict";_();Object.defineProperty(qh,"__esModule",{value:!0});qh.anonymizeFormulaString=qh.anonymizeMagnitude=qh.kindAnonymizers=qh.anonymize=void 0;var $Ge=ez();function e9e(e){if(typeof e=="object"&&e!==null){var r=e.kind;if(typeof r=="string")return r}}function r9e(e){var r=typeof e;if(r==="object"){if(e===null)return"null";if(Array.isArray(e))return"Array"}return r}function rz(e){return e}function n9e(e){return typeof e!="number"?"<unexpected>":isFinite(e)?"<number>":e}function t9e(e){return typeof e!="bigint"?"<unexpected>":"<bigint>"}function a9e(e){return typeof e!="string"?"<unexpected>":e.length>0?"<string>":e}function i9e(e){if(typeof e!="function")return"<unexpected>";var r=e.name;return typeof r=="string"&&r.length>0?"<function ".concat(r,">"):"<function>"}function o9e(e){if(typeof e!="object")return"<unexpected>";var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=nz(e[n],n));return r}function u9e(e){return typeof e!="object"||!Array.isArray(e)?"<unexpected>":e.map(nz)}function s9e(e){return typeof e!="symbol"?"<unexpected>":"<symbol ".concat(String(e),">")}function nz(e,r){if(typeof r=="string"&&c9e[r]!=null)return e;var n=e9e(e),a=n!==void 0?qh.kindAnonymizers[n]:void 0;return a===void 0&&(a=d9e[r9e(e)]),a!==void 0?a(e,r):"<unexpected>"}function l9e(e){try{return String(JSON.stringify(nz(e,void 0)))}catch(a){if(a==null||typeof a!="object")return"<error: ".concat(String(JSON.stringify(a)),">");var r=String(a.name),n=String(a.message);return n.indexOf(r)>=0?"<error ".concat(n,">"):"<error ".concat(r,": ").concat(n,">")}}qh.anonymize=l9e;var c9e={kind:!0,type:!0,index:!0,length:!0,row:!0,col:!0,rows:!0,cols:!0},d9e={boolean:rz,symbol:s9e,undefined:rz,null:rz,number:n9e,bigint:t9e,string:a9e,function:i9e,object:o9e,Array:u9e};qh.kindAnonymizers=Object.create(null);function f9e(e){var r=Math.abs(e);return r===0?-1e4:Math.floor((0,$Ge.mathLog2)(r))}qh.anonymizeMagnitude=f9e;var p9e="[^=\\[\\]\\.\\\\\\/%@#\\-_\\+,;\\(\\):?\"&<>'!\\{\\}~\\^\\*$\x80\xA2\xA3\xA4\xA5\u20A0\u20A1\u20A2\u20A3\u20A4\u20A5\u20A6\u20A7\u20A8\u20A9\u20AA\u20AB\u20AC\u20AD\u20AE\u20AF\u20B0\u20B1\u20B2\u20B3\u20B4\u20B5\u20B6\u20B7\u20B8\u20B9\\s\uA0C2d]",m9e=new RegExp(p9e,"g"),g9e=/[0-9]/g,v9e=/d/g;function h9e(e){var r=e.toLowerCase().replace(v9e,"w"),n=r.replace(g9e,"d");return n.replace(m9e,"w")}qh.anonymizeFormulaString=h9e});var tz=Y(I5=>{"use strict";_();Object.defineProperty(I5,"__esModule",{value:!0});I5.globalThis=void 0;var S9e=Rj(),y9e=S9e;I5.globalThis=y9e});var D5=Y(X0=>{"use strict";_();Object.defineProperty(X0,"__esModule",{value:!0});X0.setFeatureGateDictionaryGetter=X0.getIntFeatureGate=X0.getNumberFeatureGate=X0.getBooleanFeatureGate=X0.getStringFeatureGate=X0.getFeatureGateDictionary=void 0;var M5=tz(),C9e={};function Lfe(){return typeof M5.globalThis.__get_feature_gate_dictionary_variable=="undefined"?C9e:M5.globalThis.__get_feature_gate_dictionary_variable()}X0.getFeatureGateDictionary=Lfe;function w5(e,r){var n;return(n=Lfe()[e])!==null&&n!==void 0?n:r}X0.getStringFeatureGate=w5;function _9e(e,r){var n,a=(n=w5(e))===null||n===void 0?void 0:n.trim().toLowerCase();return a==="true"?!0:a==="false"?!1:r}X0.getBooleanFeatureGate=_9e;function R9e(e,r){var n,a=(n=w5(e))===null||n===void 0?void 0:n.trim().toLowerCase();if(a===void 0)return r;if(a==="infinity"||a==="+infinity")return 1/0;if(a==="-infinity")return-(1/0);var o=parseFloat(a);return isNaN(o)?r:o}X0.getNumberFeatureGate=R9e;function T9e(e,r){var n,a=(n=w5(e))===null||n===void 0?void 0:n.trim();if(a===void 0)return r;var o=parseInt(a,10);return isNaN(o)?r:o}X0.getIntFeatureGate=T9e;function b9e(e){var r=M5.globalThis.__get_feature_gate_dictionary_variable;return M5.globalThis.__get_feature_gate_dictionary_variable=e,r}X0.setFeatureGateDictionaryGetter=b9e});var Bfe=Y(x5=>{"use strict";_();Object.defineProperty(x5,"__esModule",{value:!0});x5.makeGetTypedFeatureGate=void 0;var az=D5();function P9e(e){function r(n){var a=e[n];switch(typeof a){case"boolean":return(0,az.getBooleanFeatureGate)(n,a);case"number":return(0,az.getNumberFeatureGate)(n,a);case"string":return(0,az.getStringFeatureGate)(n,a);default:throw new Error("Wrong defaultValue type")}}return r}x5.makeGetTypedFeatureGate=P9e});var B5=Y(W_=>{"use strict";_();Object.defineProperty(W_,"__esModule",{value:!0});W_.setChangeGateDictionaryGetter=W_.isChangeGateEnabled=W_.getChangeGateDictionary=void 0;var L5=tz();function qfe(){return typeof L5.globalThis.__get_change_gate_dictionary_variable=="undefined"?{}:L5.globalThis.__get_change_gate_dictionary_variable()}W_.getChangeGateDictionary=qfe;function E9e(e){var r,n=qfe();return(r=n[e])!==null&&r!==void 0?r:!0}W_.isChangeGateEnabled=E9e;function N9e(e){var r=L5.globalThis.__get_change_gate_dictionary_variable;return L5.globalThis.__get_change_gate_dictionary_variable=e,r}W_.setChangeGateDictionaryGetter=N9e});var Ufe=Y(q5=>{"use strict";_();Object.defineProperty(q5,"__esModule",{value:!0});q5.makeTypedIsChangeGateEnabled=void 0;var A9e=B5();function O9e(e){return function(r){return(0,A9e.isChangeGateEnabled)(r)}}q5.makeTypedIsChangeGateEnabled=O9e});var Wfe=Y(cA=>{"use strict";_();Object.defineProperty(cA,"__esModule",{value:!0});cA.overrideTypedChangeGates=cA.overrideChangeGates=void 0;var Gfe=br(),Kfe=B5();function Vfe(e){var r=(0,Kfe.setChangeGateDictionaryGetter)(void 0);return(0,Kfe.setChangeGateDictionaryGetter)(function(){var n=r!==void 0?r():{};return Gfe.__assign(Gfe.__assign({},n),e)}),r}cA.overrideChangeGates=Vfe;function k9e(e,r){return Vfe(r)}cA.overrideTypedChangeGates=k9e});var zfe=Y(dA=>{"use strict";_();Object.defineProperty(dA,"__esModule",{value:!0});dA.overrideTypedFeatureGates=dA.overrideFeatureGates=void 0;var jfe=br(),Hfe=D5();function Qfe(e){for(var r,n,a={},o=0,u=Object.keys(e);o<u.length;o++){var t=u[o];a[t]=(r=e[t])===null||r===void 0?void 0:r.toString()}var d=function(){return{}},s=(n=(0,Hfe.setFeatureGateDictionaryGetter)(void 0))!==null&&n!==void 0?n:d;return(0,Hfe.setFeatureGateDictionaryGetter)(function(){return jfe.__assign(jfe.__assign({},s()),a)}),s}dA.overrideFeatureGates=Qfe;function F9e(e,r){return Qfe(r)}dA.overrideTypedFeatureGates=F9e});var Ql=Y(j_=>{"use strict";_();Object.defineProperty(j_,"__esModule",{value:!0});var fA=br();fA.__exportStar(D5(),j_);fA.__exportStar(Bfe(),j_);fA.__exportStar(B5(),j_);fA.__exportStar(Ufe(),j_);fA.__exportStar(Wfe(),j_);fA.__exportStar(zfe(),j_)});var K5=Y(zl=>{"use strict";_();Object.defineProperty(zl,"__esModule",{value:!0});zl.values=zl.prependErrorMessage=zl.messageFromError=zl.partialArray=zl.arrayFill=zl.repeat=zl.stringEndsWith=zl.stringStartsWith=zl.isInteger=zl.mathLog2=void 0;var U5=Ql(),I9e=F5(),M9e=ez();Object.defineProperty(zl,"mathLog2",{enumerable:!0,get:function(){return M9e.mathLog2}});function G5(e){try{return e()}catch(r){return!1}}zl.isInteger=typeof Number.isInteger=="function"&&G5(function(){return!Number.isInteger(1.1)})&&(0,U5.isChangeGateEnabled)("Microsoft.Office.Excel.ChangeGate.CalcPolyfillUtils")?function(e){return Number.isInteger(e)}:function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};zl.stringStartsWith=G5(function(){return!"ab".startsWith("b")&&"abc".startsWith("b",1)&&!"abc".startsWith("a",1)})&&(0,U5.isChangeGateEnabled)("Microsoft.Office.Excel.ChangeGate.CalcPolyfillUtils")?function(e,r,n){return n===void 0&&(n=0),e.startsWith(r,n)}:function(e,r,n){return n===void 0&&(n=0),n+r.length<=e.length&&e.substring(n,n+r.length)===r};zl.stringEndsWith=G5(function(){return!"ab".endsWith("a")})&&(0,U5.isChangeGateEnabled)("Microsoft.Office.Excel.ChangeGate.CalcPolyfillUtils")?function(e,r){return e.endsWith(r)}:function(e,r){return r.length<=e.length&&e.substring(e.length-r.length,e.length)===r};zl.repeat=G5(function(){return"a".repeat(3)==="aaa"})&&(0,U5.isChangeGateEnabled)("Microsoft.Office.Excel.ChangeGate.CalcPolyfillUtils")?function(e,r){return e.repeat(r)}:function(e,r){return Array(r+1).join(e)};function w9e(e,r){for(var n=0;n<e.length;n+=1)e[n]=r;return e}zl.arrayFill=w9e;function D9e(e){var r=[];return Object.keys(e).map(Number).forEach(function(n){return r[n]=e[n]}),r}zl.partialArray=D9e;function x9e(e){if(e==null||typeof e!="object")return(0,I9e.anonymize)(e);var r=e,n=String(r.name),a=String(r.message);if(r.stack!=null){var o=String(r.stack);return o.indexOf(a)>=0&&o.indexOf(n)>=0?o:"".concat(n,": ").concat(a,"\n").concat(o)}return a.indexOf(n)>=0?a:"".concat(n,": ").concat(a)}zl.messageFromError=x9e;function L9e(e,r){if(e==null||typeof e!="object")return e;var n=e;return n.message="".concat(r," ").concat(String(n.message)),n}zl.prependErrorMessage=L9e;function B9e(e){var r=[];for(var n in e)Object.hasOwnProperty.call(e,n)&&r.push(e[n]);return r}zl.values=B9e});var Jfe=Y(Bs=>{"use strict";_();Object.defineProperty(Bs,"__esModule",{value:!0});Bs.getBoundingRectForText=Bs.getCharIndexInTextFromPoint=Bs.calcHashCode=Bs.decodeHtml=Bs.getQueryParameterByName=Bs.chainFallbackPromises=Bs.retry=Bs.getPerfWatchMarkName=Bs.getStringifiedError=Bs.defaultToJSONResultWhenStringifyFails=Bs.forEachPromise=void 0;function q9e(e,r,n){return e.reduce(function(a,o){return a.then(function(){return!n||!n.stop?r(o,n):Promise.resolve(void 0)})},Promise.resolve(void 0))}Bs.forEachPromise=q9e;Bs.defaultToJSONResultWhenStringifyFails="...";function U9e(e){if(e===0)return"0";if(!e)return"";try{var r=JSON.stringify(Yfe(e));return r}catch(n){return Bs.defaultToJSONResultWhenStringifyFails}}Bs.getStringifiedError=U9e;var G9e=5;function Yfe(e,r){if(r===void 0&&(r=0),r<0||r>G9e||e==null||typeof e!="object")return e;var n={};Object.getOwnPropertyNames(e).forEach(function(u){u!=="stack"&&u.toUpperCase()!==u&&(n[u]=e[u])});var a=Object.getPrototypeOf(e);a&&typeof a=="object"&&Object.keys(a).forEach(function(u){u!=="stack"&&u.toUpperCase()!==u&&(n[u]=e[u])});var o={};return Object.keys(n).forEach(function(u){o[u]=Yfe(n[u],r+1)}),o}var iz="_",K9e="\\W",V9e=new RegExp("".concat(K9e,"+"),"g");function W9e(e){if(!e)return"";var r=e.trim().substring(0,200).trim().replace(V9e,iz).substring(0,80);return r&&r.length>0&&r.substr(r.length-1,1)===iz&&(r=r.substr(0,r.length-1)),r&&r.length>0&&r.substr(0,1)===iz&&(r=r.substr(1)),r}Bs.getPerfWatchMarkName=W9e;function j9e(e,r){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(r<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got ".concat(r)));for(var n=Promise.reject(),a=function(t){n=n.catch(function(d){return e(t,d)})},o=1;o<=r;o+=1)a(o);return n}Bs.retry=j9e;function H9e(e,r){if(!e||e.length===0)return Promise.reject();for(var n=r(e[0]),a=function(t){var d=e[t];n=n.catch(function(){return r(d)})},o=1;o<e.length;o+=1)a(o);return n}Bs.chainFallbackPromises=H9e;function Q9e(e,r){var n=new RegExp("[?&]".concat(r,"(=([^&#]*)|&|#|$)")),a=n.exec(e);if(a)return a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):""}Bs.getQueryParameterByName=Q9e;function z9e(e){return typeof e=="string"?new DOMParser().parseFromString(e,"text/html").documentElement.textContent:e}Bs.decodeHtml=z9e;function Y9e(e){if(!e)return 0;for(var r=5381,n=r,a=e.length,o=0;o<a&&(r=((r<<5)+r^e.charCodeAt(o))&4294967295,o!==a-1);o+=2)n=((n<<5)+n^e.charCodeAt(o+1))&4294967295;var u=n*35685,t=n*23896<<16,d=r+u+t&4294967295;return d<0&&(d+=4294967296),d}Bs.calcHashCode=Y9e;function J9e(e,r,n){n===void 0&&(n=!1);var a=-1,o=null;if(document.caretPositionFromPoint!==void 0){var u=document.caretPositionFromPoint(e,r);u!==null&&(a=u.offset,u.offsetNode!=null&&u.offsetNode.parentElement!=null&&u.offsetNode.parentElement.nodeName==="SPAN"?o=u.offsetNode.parentElement:o=u.offsetNode)}else if(document.caretRangeFromPoint!==void 0){var u=document.caretRangeFromPoint(e,r);u!==null&&(a=u.startOffset,u.startContainer!=null&&u.startContainer.parentElement!=null&&u.startContainer.parentElement.nodeName==="SPAN"?o=u.startContainer.parentElement:o=u.startContainer)}else try{o=document.elementFromPoint(e,r);var u=document.body.createTextRange();u.moveToPoint(e,r);var t=document.body.createTextRange();t.moveToElementText(o),t.setEndPoint("EndToStart",u),a=t.text.length}catch(s){return a}if(n)for(var d=!1;o!=null;)o.previousSibling===null&&o.parentNode!==null&&o.parentNode.parentNode!==null&&o.parentNode.parentNode.childNodes.length>1&&!d?(o=o.parentNode,d=!0):(o=o.previousSibling,o!=null&&o.textContent!=null&&(a+=o.textContent.length,d&&(a+=1)));else for(;o!=null;)o=o.previousSibling,o!=null&&o.textContent!=null&&(a+=o.textContent.length);return a}Bs.getCharIndexInTextFromPoint=J9e;function X9e(e,r,n,a){a===void 0&&(a=!1);function o(t,d,s){if(!t||!t.textContent)return d;if(a&&(d<0||d>t.textContent.length&&(t.childNodes.length===0||t.childNodes[0].nodeName!=="DIV"))||d<0||d>t.textContent.length)return d-t.textContent.length;if(!t.hasChildNodes())return s(t,d),d-t.textContent.length;for(var c=t.childNodes,l=0;l<c.length&&d>=0;l+=1)d=o(c[l],d,s),a&&c[l].nodeName==="DIV"&&(d-=1);return d}var u=document.createRange();return o(e,r,function(t,d){return u.setStart(t,d)}),o(e,n,function(t,d){return u.setEnd(t,d)}),u.getBoundingClientRect()}Bs.getBoundingRectForText=X9e});var V5=Y(Z0=>{"use strict";_();Object.defineProperty(Z0,"__esModule",{value:!0});Z0.NulLogger=Z0.ConsoleLogger=Z0.ULS=Z0.LogCategory=Z0.TraceLevel=void 0;var Z9e;(function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"})(Z9e=Z0.TraceLevel||(Z0.TraceLevel={}));var $9e;(function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"})($9e=Z0.LogCategory||(Z0.LogCategory={}));function eKe(e){var r=e;return{ULS:{trace:function(a,o,u){return r.traceTag(0,a,o,u)},traceTag:function(a,o,u,t){return r.traceTag(a,o,u,t)},debugTrace:function(a,o,u){return r.debugTraceTag(0,a,o,u)},debugTraceTag:function(a,o,u,t){return r.debugTraceTag(a,o,u,t)},assert:function(a,o,u){return r.assertTag(0,a,o,u)},assertTag:function(a,o,u,t){return r.assertTag(a,o,u,t)},shipAssert:function(a,o,u){return r.shipAssertTag(0,a,o,u)},shipAssertTag:function(a,o,u,t){return r.shipAssertTag(a,o,u,t)},dnmTrace:function(a,o,u){return r.dnmTraceTag(0,a,o,u)},dnmTraceTag:function(a,o,u,t){return r.dnmTraceTag(a,o,u,t)}}}}Z0.ULS={getFromExternalLogger:eKe};var rKe=function(){function e(){}return e.prototype.shipAssertTag=function(r,n,a,o){console.assert(a,"shipAssertTag:",r,n,o)},e.prototype.assertTag=function(r,n,a,o){console.assert(a,"assertTag",r,n,o)},e.prototype.traceTag=function(r,n,a,o){console.log("traceTag",r,o,n,a)},e.prototype.dnmTraceTag=function(r,n,a,o){console.log("dnmTraceTag",r,o,n,a)},e.prototype.debugTraceTag=function(r,n,a,o){console.log("debugTraceTag",r,o,n,a)},e}();Z0.ConsoleLogger=rKe;var nKe=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e.prototype.dnmTraceTag=function(){},e}();Z0.NulLogger=nKe});var Xfe=Y(W5=>{"use strict";_();Object.defineProperty(W5,"__esModule",{value:!0});W5.promises=void 0;var oz={},uz="promises";function tKe(){return oz[uz]===void 0&&(oz[uz]=typeof Promise!="undefined"&&typeof Promise.resolve=="function"&&typeof Promise.resolve(0).then=="function"),oz[uz]}W5.promises=tKe});var $fe=Y($0=>{"use strict";_();Object.defineProperty($0,"__esModule",{value:!0});$0.timeStamp=$0.failure=$0.success=$0.end=$0.mark=$0.start=void 0;function aKe(e){var r=sz(),n=e,a=r,o={},u=function(s,c,l){return lKe(o,n,a,s,c,l)},t=function(s){return Zfe(o,s,a)};return o.start=0,{mark:function(s){return t(s)},end:function(s){return u(!0,s)},success:function(s,c){return u(!0,s,c)},failure:function(s,c){return u(!1,s,c)}}}$0.start=aKe;function iKe(e,r){e!==void 0&&e.mark(r)}$0.mark=iKe;function oKe(e,r){e!==void 0&&e.end(r)}$0.end=oKe;function uKe(e,r,n){e!==void 0&&e.success(r,n)}$0.success=uKe;function sKe(e,r,n){e!==void 0&&e.failure(r,n)}$0.failure=sKe;function sz(){var e=typeof self!="undefined"?self:window;return e.performance&&e.performance.now?e.performance.now():Date.now()}$0.timeStamp=sz;function Zfe(e,r,n){e[r]=sz()-n}function lKe(e,r,n,a,o,u){Zfe(e,"end",n);var t={sessionName:r,result:a?"success":"failure",message:u,marks:e},d=JSON.stringify(t);o(d)}});var epe=Y(pA=>{"use strict";_();Object.defineProperty(pA,"__esModule",{value:!0});pA.isChangeGateEnabled=pA.setChangeGatesManager=void 0;var lz,cKe=function(r){lz=r};pA.setChangeGatesManager=cKe;var dKe=function(r){return lz?lz.isChangeGateEnabled(r):!0};pA.isChangeGateEnabled=dKe});var npe=Y(rpe=>{"use strict";_();Object.defineProperty(rpe,"__esModule",{value:!0})});var ape=Y(j5=>{"use strict";_();Object.defineProperty(j5,"__esModule",{value:!0});var tpe=br();tpe.__exportStar(epe(),j5);tpe.__exportStar(npe(),j5)});var ope=Y(mA=>{"use strict";_();Object.defineProperty(mA,"__esModule",{value:!0});mA.initEwaUtils=mA.ewaUtils=void 0;var fKe=ape(),ipe={isChangeGateEnabled:function(r){return!1}};function pKe(){return ipe}mA.ewaUtils=pKe;function mKe(e){if(!e)throw new Error("the 'ewaUtils' argument is missing");(0,fKe.setChangeGatesManager)({isChangeGateEnabled:e.isChangeGateEnabled}),ipe=e}mA.initEwaUtils=mKe});var upe=Y(Q5=>{"use strict";_();Object.defineProperty(Q5,"__esModule",{value:!0});Q5.initStopwatchFactory=void 0;var H5=function(){return Date.now()};function gKe(e,r){return r===void 0&&(r=1),typeof self!="undefined"&&self.performance&&self.performance.now&&(H5=function(){return self.performance.now()}),function(n){var a=H5(),o=n;return{reset:function(t){t!=null&&(o=t),a=H5()},stop:function(t){var d=H5()-a,s=JSON.stringify({Target:o,Duration:d.toFixed(r),StopInfo:t});e(s)}}}}Q5.initStopwatchFactory=gKe});var spe=Y(z5=>{"use strict";_();Object.defineProperty(z5,"__esModule",{value:!0});z5.TelemetryCollector=void 0;var vKe=function(){function e(){this.counters={},this.timers={},this.events={}}return e.prototype.getJsonForLogging=function(){return'{"Events":'+this.getEventsLoggableString()+',"Counters":'+this.getCountersLoggableString()+',"Timers":'+this.getTimersLoggableString()+"}"},e.prototype.addEvent=function(r,n){r==null||n===null||n===void 0||(this.events[r]=n)},e.prototype.clearEvents=function(){this.events={}},e.prototype.getEventsLoggableString=function(){return JSON.stringify(this.events)},e.prototype.incrementCounter=function(r){r!=null&&(this.counters.hasOwnProperty(r)?this.counters[r]+=1:this.counters[r]=1)},e.prototype.getCountersLoggableString=function(){return JSON.stringify(this.counters)},e.prototype.clearCounters=function(){this.counters={}},e.prototype.startTimer=function(r){r!=null&&(this.timers[r]={name:r,startTime:Date.now(),endTime:void 0,isRunning:!0,duration:void 0})},e.prototype.endTimer=function(r){r!=null&&this.timers.hasOwnProperty(r)&&(this.timers[r].endTime=Date.now(),this.timers[r].isRunning=!1,this.timers[r].duration=this.timers[r].endTime-this.timers[r].startTime)},e.prototype.getTimerDuration=function(r){return r==null?"-1":this.timers.hasOwnProperty(r)&&this.timers[r].duration!==void 0?this.timers[r].duration:"-1"},e.prototype.getTimersLoggableString=function(){return JSON.stringify(this.timers)},e}();z5.TelemetryCollector=vKe});var lpe=Y(Y5=>{"use strict";_();Object.defineProperty(Y5,"__esModule",{value:!0});Y5.getNewGuid=void 0;function hKe(){var e=new Uint8Array(31),r=SKe(e),n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",a=0,o=n.replace(/[xy]/g,function(u){var t=e[a]&15;a+=1;var d=u==="x"?t:t&3|8;return d.toString(16)});return[o,r]}Y5.getNewGuid=hKe;function SKe(e){var r={crypto:!1,perfNow:!1,exceptions:[]},n=typeof self!="undefined"?self:window,a=n.crypto||n.msCrypto;if(a){r.crypto=!0;try{return a.getRandomValues(e),r}catch(c){r.exceptions.push("crypto: ".concat(JSON.stringify(c)))}}var o=!1,u=n.performance;try{u&&u.now&&u.now()!==1/0&&(o=!0)}catch(c){r.exceptions.push("perfNow: ".concat(JSON.stringify(c)))}for(var t=0;t<e.length;t+=1){try{if(o){r.perfNow=!0;var d=Math.floor(u.now()*100)%10;(d<0||d>9)&&(d=0);for(var s=0;s<d;s+=1)Math.random()}}catch(c){r.exceptions.push("Math.random: ".concat(JSON.stringify(c)))}e[t]=Math.floor(Math.random()*16)}return r}});var cpe=Y(H_=>{"use strict";_();Object.defineProperty(H_,"__esModule",{value:!0});H_.TextAreaInputMode=H_.TextAreaVirtualKeyboardPolicy=void 0;var yKe;(function(e){e.Auto="auto",e.Manual="manual"})(yKe=H_.TextAreaVirtualKeyboardPolicy||(H_.TextAreaVirtualKeyboardPolicy={}));var CKe;(function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"})(CKe=H_.TextAreaInputMode||(H_.TextAreaInputMode={}))});var dpe=Y(Ab=>{"use strict";_();Object.defineProperty(Ab,"__esModule",{value:!0});Ab.isReplaceChildrenSupported=Ab.replaceChildren=void 0;var _Ke=function(r){if(r)if((0,Ab.isReplaceChildrenSupported)(r))r.replaceChildren();else for(;r.lastChild;)r.removeChild(r.lastChild)};Ab.replaceChildren=_Ke;var RKe=function(r){return!!r.replaceChildren};Ab.isReplaceChildrenSupported=RKe});var Ol=Y(Po=>{"use strict";_();Object.defineProperty(Po,"__esModule",{value:!0});Po.TelemetryCollector=Po.initStopwatchFactory=Po.ewaUtils=Po.initEwaUtils=Po.ConsoleLogger=Po.NulLogger=Po.perfWatch=Po.browserSupport=Po.LogCategory=Po.TraceLevel=Po.ULS=Po.utils=Po.replaceChildren=Po.TextAreaInputMode=Po.TextAreaVirtualKeyboardPolicy=Po.getNewGuid=void 0;var TKe=Jfe();Po.utils=TKe;var mM=V5();Object.defineProperty(Po,"ULS",{enumerable:!0,get:function(){return mM.ULS}});Object.defineProperty(Po,"TraceLevel",{enumerable:!0,get:function(){return mM.TraceLevel}});Object.defineProperty(Po,"LogCategory",{enumerable:!0,get:function(){return mM.LogCategory}});Object.defineProperty(Po,"NulLogger",{enumerable:!0,get:function(){return mM.NulLogger}});Object.defineProperty(Po,"ConsoleLogger",{enumerable:!0,get:function(){return mM.ConsoleLogger}});var bKe=Xfe();Po.browserSupport=bKe;var PKe=$fe();Po.perfWatch=PKe;var fpe=ope();Object.defineProperty(Po,"initEwaUtils",{enumerable:!0,get:function(){return fpe.initEwaUtils}});Object.defineProperty(Po,"ewaUtils",{enumerable:!0,get:function(){return fpe.ewaUtils}});var EKe=upe();Object.defineProperty(Po,"initStopwatchFactory",{enumerable:!0,get:function(){return EKe.initStopwatchFactory}});var NKe=spe();Object.defineProperty(Po,"TelemetryCollector",{enumerable:!0,get:function(){return NKe.TelemetryCollector}});var AKe=lpe();Object.defineProperty(Po,"getNewGuid",{enumerable:!0,get:function(){return AKe.getNewGuid}});var ppe=cpe();Object.defineProperty(Po,"TextAreaVirtualKeyboardPolicy",{enumerable:!0,get:function(){return ppe.TextAreaVirtualKeyboardPolicy}});Object.defineProperty(Po,"TextAreaInputMode",{enumerable:!0,get:function(){return ppe.TextAreaInputMode}});var OKe=dpe();Object.defineProperty(Po,"replaceChildren",{enumerable:!0,get:function(){return OKe.replaceChildren}})});var $y=Y(ll=>{"use strict";_();Object.defineProperty(ll,"__esModule",{value:!0});ll.assertPositiveLength=ll.assertIndex=ll.assertPositiveInteger=ll.assertNatural=ll.assertInteger=ll.assertTrue=ll.assertFalse=ll.assertNever=ll.ulsLogger=void 0;var J5=Ol(),vM=K5(),Q_=F5();function mpe(e,r){function n(a,o,u,t){if(e(a,o,u,t),!u)throw new Error("".concat(r," ").concat(a," ").concat(o," ").concat(t))}return n}function gpe(e){return{shipAssertTag:mpe(e.shipAssertTag.bind(e),"shipAssertTag"),assertTag:mpe(e.assertTag.bind(e),"assertTag"),traceTag:e.traceTag.bind(e),debugTraceTag:e.debugTraceTag.bind(e),dnmTraceTag:e.dnmTraceTag.bind(e)}}function gM(e){return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];try{return e.apply(void 0,r)}catch(a){}}}function kKe(e){return{shipAssertTag:gM(e.shipAssertTag.bind(e)),assertTag:gM(e.assertTag.bind(e)),traceTag:gM(e.traceTag.bind(e)),debugTraceTag:gM(e.debugTraceTag.bind(e)),dnmTraceTag:gM(e.dnmTraceTag.bind(e))}}var vpe=function(){function e(){this.callBufferCapacity=100,this.callBuffer=[],this.shipAssertTag=this.createBufferingCallback("shipAssertTag"),this.assertTag=this.createBufferingCallback("assertTag"),this.traceTag=this.createBufferingCallback("traceTag"),this.dnmTraceTag=this.createBufferingCallback("dnmTraceTag"),this.debugTraceTag=this.createBufferingCallback("debugTraceTag")}return e.prototype.createBufferingCallback=function(r){var n=this;return function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];n.callBuffer.length<n.callBufferCapacity&&n.callBuffer.push({method:r,args:a})}},e.prototype.invokeBufferedCalls=function(){var r;if(this.callBuffer.length!==0){var n=this.callBuffer;this.callBuffer=[];var a="calc.common.DefaultLogger.invokeBufferedCalls: ".concat(n.length," calls before initLogger");ll.ulsLogger.ULS.traceTag(579736781,J5.LogCategory.msoulscat_ES_EWAJS,J5.TraceLevel.Warning,a);for(var o=0,u=n;o<u.length;o++){var t=u[o];(r=ll.ulsLogger.noThrowLogger)[t.method].apply(r,t.args)}}},e}(),FKe=function(){function e(){this.logger=new vpe,this.ULS=gpe(this.logger),this.noThrowLogger=this.logger}return e.prototype.setLogger=function(r){var n=this.logger;this.logger=r,this.ULS=gpe(r),this.noThrowLogger=kKe(r),n instanceof vpe&&n.invokeBufferedCalls()},e}();ll.ulsLogger=new FKe;function IKe(e,r){var n=(0,Q_.anonymize)(r),a="".concat(e,": code should be unreachable because a value has type 'never'; given ").concat(n);return ll.ulsLogger.ULS.assertTag(595980872,J5.LogCategory.msoulscat_ES_EWAJS,!1,a)}ll.assertNever=IKe;function Ob(e){return ll.ulsLogger.ULS.assertTag(595980873,J5.LogCategory.msoulscat_ES_EWAJS,!1,e)}ll.assertFalse=Ob;function MKe(e,r){r||Ob("".concat(e,": expected condition to be true"))}ll.assertTrue=MKe;function wKe(e,r){(0,vM.isInteger)(r)||Ob("".concat(e,": expected integer; given ").concat((0,Q_.anonymize)(r)))}ll.assertInteger=wKe;function DKe(e,r){(!(0,vM.isInteger)(r)||r<0)&&Ob("".concat(e,": expected natural number; given ").concat((0,Q_.anonymize)(r)))}ll.assertNatural=DKe;function xKe(e,r){(!(0,vM.isInteger)(r)||r<=0)&&Ob("".concat(e,": expected positive integer; given ").concat((0,Q_.anonymize)(r)))}ll.assertPositiveInteger=xKe;function LKe(e,r,n){(!(0,vM.isInteger)(r)||r<0||r>=n)&&Ob("".concat(e,": expected natural number less than ").concat((0,Q_.anonymize)(n),"; given ").concat((0,Q_.anonymize)(r)))}ll.assertIndex=LKe;function BKe(e,r,n){(!(0,vM.isInteger)(r)||r<=0||r>n)&&Ob("".concat(e,": expected positive integer at most ").concat((0,Q_.anonymize)(n),"; given ").concat((0,Q_.anonymize)(r)))}ll.assertPositiveLength=BKe});var X5=Y(Ad=>{"use strict";_();Object.defineProperty(Ad,"__esModule",{value:!0});Ad.isTypedChangeGateEnabled=Ad.setFeatureGateDictionaryGetter=Ad.overrideTypedFeatureGates=Ad.getTypedFeatureGate=Ad.getFeatures=Ad.isFeatureEnabled=Ad.initFeatureConfiguration=Ad.FeatureName=void 0;var qKe=$y(),hpe=Ol(),Spe=Ql(),dz;(function(e){e.FeatureCheckingEnabled="FeatureCheckingEnabled",e.CalcPreventSpillingHack="CalcPreventSpillingHack",e.CalcLegacyImplicitIntersection="CalcLegacyImplicitIntersection",e.CalcRecordFunctions="CalcRecordFunctions",e.CalcNestedRecordFunction="CalcNestedRecordFunction",e.CalcLetRecFunction="CalcLetRecFunction",e.CalcLambdaFunction="CalcLambdaFunction",e.CalcLambdaBasicFunctions="CalcLambdaBasicFunctions",e.CalcLambdaHelperFunctions="CalcLambdaHelperFunctions",e.CalcLambdaOptionalParameters="CalcLambdaOptionalParameters",e.CalcLambdaDefaultParameters="CalcLambdaDefaultParameters",e.CalcLambdaCellValues="CalcLambdaCellValues",e.CalcLambdaArrayLifting="CalcLambdaArrayLifting"})(dz=Ad.FeatureName||(Ad.FeatureName={}));var ype=function(r){var n="calc.common.isFeatureEnabledCallback: called with ".concat(r," before initCalc");return qKe.ulsLogger.ULS.traceTag(526989323,hpe.LogCategory.msoulscat_ES_EWAJS,hpe.TraceLevel.Warning,n),!1},cz={};function UKe(e){typeof e=="function"&&(ype=e)}Ad.initFeatureConfiguration=UKe;function Cpe(e){return cz[e]===void 0&&(cz[e]=ype(e)),cz[e]}Ad.isFeatureEnabled=Cpe;function GKe(){var e={};for(var r in dz){var n=dz[r];n!=null&&(e[n]=Cpe(n))}return e}Ad.getFeatures=GKe;var KKe={"Microsoft.Office.Excel.ProseFormulaRepairExperimentLogBuggyIsEnabled":!1,"Microsoft.Office.Excel.ProseFormulaRepairExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSDemoFeatureGateString":"DummyStringValue","Microsoft.Office.Excel.CalcTSDemoFeatureGateInt":42,"Microsoft.Office.Excel.CalcTSDemoFeatureGateBoolean":!1,"Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSUnitExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSExceLintExperimentIsEnabled":!1,"Microsoft.Office.Excel.SmartFormulaBarUseDevScheduler":!1,"Microsoft.Office.Excel.x10DoNotThrowOnDoublePluginRegistration":!0,"Microsoft.Office.Excel.AutocompleteRangeSuggestionPlugin":!1,"Microsoft.Office.Excel.x10AutocompleteWrapperPluginIsEnabled":!1,"Microsoft.Office.Excel.x10AutocompleteBinaryModelExperimentPlugin":!1,TESTING_ONLY_RECALC_SERVICE_IMPORTSCRIPTS_FAIL:!1,TESTING_ONLY_SCHEDULER_IMPORTSCRIPTS_FAIL:!1,TESTING_ONLY_TEST_PLUGIN_IMPORTSCRIPTS_FAIL:!1,"Microsoft.Office.Excel.FormulaCollection":!1,"Microsoft.Office.Excel.x10ParserPerformanceMeasurements":!1,"Microsoft.Office.Excel.ArgumentAssistanceOnMainThread":!1,"Microsoft.Office.Excel.AutoCompleteOnMainThread":!1,"Microsoft.Office.Excel.UnitlessTimeAndDate":!1,"Microsoft.Office.Excel.UnitExpIgnoreDivMul":!1,"Microsoft.Office.Excel.x10PythonAutocompletionEnabled":!1,"Microsoft.Office.Excel.MockWorkerThreadPlugin":!1,"Microsoft.Office.Excel.EnableFullSessionLogging":!1,"Microsoft.Office.Excel.UseAggregatedLogging":!1,"Microsoft.Office.Excel.LocalizedErrorNames":!1,"Microsoft.Office.Excel.ChatGPTPluginEnabled":!1,"Microsoft.Office.Excel.CalcTsFuncsFirstSlice":!1,"Microsoft.Office.Excel.FormulaRepairSuggestionsLimit":1,"Microsoft.Office.Excel.SkipFormulaPluginsForNonFormulaCells":!1,"Microsoft.Office.Excel.ProcessNotificationsAfterShouldRunPlugin":!1,"Microsoft.Office.Excel.FormulaByExamplePluginEnabled":!1,"Microsoft.Office.Excel.DebugStructRefFF":!1};Ad.getTypedFeatureGate=(0,Spe.makeGetTypedFeatureGate)(KKe);var _pe=Ql();Object.defineProperty(Ad,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return _pe.overrideTypedFeatureGates}});Object.defineProperty(Ad,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return _pe.setFeatureGateDictionaryGetter}});Ad.isTypedChangeGateEnabled=(0,Spe.makeTypedIsChangeGateEnabled)(["OfficeVSO:XXX_TestChangeGate","OfficeVSO:6476056_OnlySendNestedDotNotationPath","OfficeVSO:7396249_getTableHeadersFromServer","OfficeVSO:7536593_resolveCorrelatedRequestsWithNoPlugins","OfficeVSO:7903424_Microsoft.Office.Excel.ProvideX10FeaturesFromSchedulerFeatures","OfficeVSO:7920319_fixArgumentAssistanceHandlingWhitespaces","OfficeVSO:7938178_EditSpecialFormat","Microsoft.Office.Excel.CoerceStringToArray","OfficeVSO:8151860_x10AddComputationGroupsToRequests"])});var tv=Y(Sa=>{"use strict";_();Object.defineProperty(Sa,"__esModule",{value:!0});Sa.mapFromArrayOfPairs=Sa.singleton=Sa.now=Sa.typedInstanceCreator=Sa.makeStringCompareCI=Sa.fastAbs=Sa.fastMax=Sa.fastMin=Sa.pair=Sa.filterOutNones=Sa.isNone=Sa.isDefined=Sa.safeConcat=Sa.safePush=Sa.strEnumArray=Sa.numEnumMap=Sa.numEnumArray=Sa.cloneStringMap=Sa.makeStringMap=Sa.identity=Sa.staticAssertIsOptional=Sa.staticAssertIs=Sa.staticAssertSame=Sa.staticAssertExtends=Sa.makeNewtypeIso=void 0;function VKe(e,r){return{wrap:e,unwrap:r}}Sa.makeNewtypeIso=VKe;function WKe(){}Sa.staticAssertExtends=WKe;function jKe(){}Sa.staticAssertSame=jKe;function Rpe(){return function(e){return e}}Sa.staticAssertIs=Rpe;Sa.staticAssertIsOptional=Rpe();function HKe(e){return e}Sa.identity=HKe;function Tpe(){var e=Object.create(null);return e.___=void 0,delete e.___,e}Sa.makeStringMap=Tpe;function QKe(e){var r=Tpe();for(var n in e)r[n]=e[n];return r}Sa.cloneStringMap=QKe;function bpe(e){return Object.keys(e).map(function(r){return Number(r)}).filter(function(r){return!isNaN(r)})}Sa.numEnumArray=bpe;function zKe(e,r){for(var n={},a=0,o=bpe(e);a<o.length;a++){var u=o[a];n[u]=r(u)}return n}Sa.numEnumMap=zKe;function YKe(e){return Object.keys(e).map(function(r){return r}).map(function(r){return e[r]}).sort()}Sa.strEnumArray=YKe;function fz(e,r){for(var n=0,a=r;n<a.length;n++){var o=a[n];e.push(o)}return e}Sa.safePush=fz;function JKe(e,r){var n=[];fz(n,e);for(var a=0,o=r;a<o.length;a++){var u=o[a];fz(n,u)}return n}Sa.safeConcat=JKe;function Ppe(e){return e!=null}Sa.isDefined=Ppe;function XKe(e){return e==null}Sa.isNone=XKe;function ZKe(e){return e.filter(Ppe)}Sa.filterOutNones=ZKe;var k0n=function(){function e(){}return e}();function $Ke(e,r){return[e,r]}Sa.pair=$Ke;function e8e(e,r){return e<r?e:r}Sa.fastMin=e8e;function r8e(e,r){return e<r?r:e}Sa.fastMax=r8e;function n8e(e){return e<0?-e:e}Sa.fastAbs=n8e;function t8e(e){var r=[e],n=e.indexOf("-");return n>0&&r.push(e.substring(0,n)),r[r.length-1]!=="en"&&r.push("en"),r}function a8e(e){var r={sensitivity:"accent"};try{var n=new Intl.Collator(t8e(e),r);return n.compare.bind(n)}catch(a){return function(u,t){return u===t?0:u.toLocaleUpperCase().localeCompare(t.toLocaleUpperCase())}}}Sa.makeStringCompareCI=a8e;function i8e(){return function(e){return e}}Sa.typedInstanceCreator=i8e;Sa.now=typeof self!="undefined"&&self.performance!=null&&self.performance.now!=null?function(){return self.performance.now()}:typeof process!="undefined"&&process.hrtime!=null?function(){var e=process.hrtime(),r=e[0],n=e[1];return r*1e3+n/1e6}:function(){return Date.now()};function o8e(e){var r=function(){function n(){}return n.instance=function(){return n.value===void 0&&(n.value=e()),n.value},n.prototype.instance=function(){return n.instance()},n.value=void 0,n}();return r}Sa.singleton=o8e;function u8e(e){return e.reduce(function(r,n){var a=n[0],o=n[1];return r[a]=o,r},{})}Sa.mapFromArrayOfPairs=u8e});var Npe=Y(HS=>{"use strict";_();Object.defineProperty(HS,"__esModule",{value:!0});HS.randomElement=HS.randomShuffled=HS.randomIndex=HS.randomFloat=void 0;var s8e=$y(),l8e=zQ(),pz=c8e(.4531024141007942);function c8e(e){var r=process.env.BUILD_BUILDID!=null?e:Math.random()*Date.now();return new l8e.JSF32(r)}function d8e(){return pz.next()}HS.randomFloat=d8e;function Epe(e){return(0,s8e.assertTrue)("calc.common.randomIndex",e>0),Math.min(e-1,Math.floor(pz.next()*e))}HS.randomIndex=Epe;function f8e(e){var r=e.map(function(a){return[pz.next(),a]}),n=r.sort(function(a,o){return a[0]<o[0]?-1:a[0]===o[0]?0:1});return n.map(function(a){return a[1]})}HS.randomShuffled=f8e;function p8e(e){return e[Epe(e.length)]}HS.randomElement=p8e});var vA=Y(gA=>{"use strict";_();Object.defineProperty(gA,"__esModule",{value:!0});gA.entry=gA.makeEmptyTable=void 0;var m8e={getCount:function(){return 0},getValue:function(){},getEntry:function(){},contains:function(){return!1},forEach:function(){return!0}};function g8e(){return m8e}gA.makeEmptyTable=g8e;function v8e(e,r){return{key:e,value:r}}gA.entry=v8e});var kpe=Y(em=>{"use strict";_();Object.defineProperty(em,"__esModule",{value:!0});em.enumerateKeysInOrder=em.enumerateInOrder=em.RootPointer=em.ArrayMapTree=em.floorToPowerOf2=void 0;var h8e=vA();function Ape(e){if(e===0)return 0;var r=e;return r=(r|r>>>1)>>>0,r=(r|r>>>2)>>>0,r=(r|r>>>4)>>>0,r=(r|r>>>8)>>>0,r=(r|r>>>16)>>>0,r+=1,r/2}em.floorToPowerOf2=Ape;var S8e=function(){function e(r,n,a){this.keyCompare=r,this.keys=n,this.values=a}return e.create=function(r){return new e(r,[],[])},e.prototype.setValue=function(r,n){return this.setValues([[r,n]])},e.prototype.remove=function(r){var n=this.getKeyIndex(r);return n===void 0?this:this.filter(function(a){return a!==r})},e.prototype.getOrSetValue=function(r,n){var a=this.getKeyIndex(r);if(a===void 0){var o=n();return[this.setValue(r,o),o]}return[this,this.values[a]]},e.prototype.filter=function(r){for(var n=[],a=0;a<this.keys.length;a+=1){var o=this.keys[a],u=this.values[a];r(o,u)&&n.push([o,u])}return n.length===this.getCount()?this:this.ofSequence(n)},e.prototype.getCount=function(){return this.keys.length},e.prototype.getValue=function(r){var n=this.getKeyIndex(r);if(n!==void 0)return this.values[n]},e.prototype.getEntry=function(r){var n=this.getKeyIndex(r);if(n!==void 0)return(0,h8e.entry)(this.keys[n],this.values[n])},e.prototype.contains=function(r){return this.getKeyIndex(r)!==void 0},e.prototype.forEach=function(r){for(var n=0;n<this.keys.length;n+=1)if(!r(this.keys[n],this.values[n]))return!1;return!0},e.prototype.setValues=function(r){var n=this,a=this.keys.map(function(f,p){return[f,n.values[p],p]}),o=a.length;r.forEach(function(f,p){var m=f[0],v=f[1];return a.push([m,v,p+o])}),a.sort(function(f,p){var m=f[0],v=f[2],h=p[0],S=p[2],y=n.keyCompare(m,h);return y!==0?y:v-S});for(var u=[],t=void 0,d=0;d<a.length;d+=1){var s=a[d],c=s[0],l=s[1];t===void 0||this.keyCompare(c,t)!==0?(u.push([c,l]),t=c):u[u.length-1]=[c,l]}return this.ofSequence(u)},e.prototype.getKeyIndex=function(r){for(var n=em.RootPointer;n>=0&&n<this.keys.length;){var a=this.keyCompare(r,this.keys[n]);if(a===0)return n;if(a<0){n=vz(n);continue}if(a>0){n=hz(n);continue}}},e.prototype.ofSequence=function(r){var n=this,a=r.slice();a.sort(function(f,p){var m=f[0],v=p[0];return n.keyCompare(m,v)});for(var o=new Array(a.length),u=new Array(a.length),t=C8e(a.length),d=0;d<a.length;d+=1){var s=a[t[d]],c=s[0],l=s[1];o[d]=c,u[d]=l}return new e(this.keyCompare,o,u)},e}();em.ArrayMapTree=S8e;em.RootPointer=0;function Ope(e,r){var n=[];return mz(e,r,n),n}em.enumerateInOrder=Ope;function mz(e,r,n){r<0||r>=e.keys.length||(mz(e,vz(r),n),n.push([e.keys[r],e.values[r]]),mz(e,hz(r),n))}function y8e(e,r){return Ope(e,r).map(function(n){var a=n[0];return a})}em.enumerateKeysInOrder=y8e;function C8e(e){var r=new Array(e);return gz(em.RootPointer,r,0,e),r}function gz(e,r,n,a){if(!(e>=r.length)){var o=_8e(a);r[e]=n+o,gz(vz(e),r,n,o),gz(hz(e),r,n+o+1,a-o-1)}}function _8e(e){var r=Ape(e);return r/2-1<=e-r?r-1:e-r/2}function vz(e){return 2*e+1}function hz(e){return 2*e+2}});var Sz=Y(Z5=>{"use strict";_();Object.defineProperty(Z5,"__esModule",{value:!0});Z5.BinaryHeap=void 0;var R8e=function(){function e(r){this.items=[],this.cmp=r}return e.prototype.insert=function(r){this.items.push(r);for(var n=this.getCount()-1;n>0;){var a=n-1>>>1,o=this.items[a];if(this.cmp(o,r)>0)this.items[n]=o;else break;n=a}this.items[n]=r},e.prototype.peek=function(){return this.items[0]},e.prototype.removeMin=function(){var r=this.peek(),n=this.items.pop(),a=this.getCount()-1;if(a<0||n===void 0)return r;var o=0;for(this.items[0]=n;o<a;){var u=o,t=(o<<1)+1,d=(o<<1)+2;if(t<=a&&this.cmp(this.items[t],n)<0&&(u=t),d<=a&&this.cmp(this.items[d],u===t?this.items[u]:n)<0&&(u=d),o!==u)this.items[o]=this.items[u],o=u;else break}return this.items[o]=n,r},e.prototype.getCount=function(){return this.items.length},e.prototype.clear=function(){this.items.length=0},e.prototype.forEach=function(r){for(var n=0,a=this.items;n<a.length;n++){var o=a[n];if(!r(o))return}},e}();Z5.BinaryHeap=R8e});var _z=Y(wr=>{"use strict";_();Object.defineProperty(wr,"__esModule",{value:!0});wr.forEachKeyUntyped=wr.forEachKey=wr.getNodeCount=wr.complement=wr.symmetricDiff=wr.lazy=wr.empty=wr.dense=wr.compareUntyped=wr.combineCmp=wr.compare=wr.exceptUntyped=wr.except=wr.meetsUntyped=wr.meets=wr.intersectUntyped=wr.intersect=wr.unionUntyped=wr.union=wr.fromUntyped=wr.createFromKey=wr.cacheKeySplitting=wr.SetKind=void 0;var Fpe=br(),T8e=br(),b8e=T8e.__assign,Cz;(function(e){e[e.Dense=0]="Dense",e[e.Empty=1]="Empty"})(Cz=wr.SetKind||(wr.SetKind={}));function Ipe(e,r,n){return n===void 0&&(n=10),function(a){if(a.split!==void 0)return a.split;var o=e(a),u=a===r?0:a.depth;return u!==void 0&&u<n&&(a.split=o,o[0][0].depth=u+1,o[1][0].depth=u+1),o}}wr.cacheKeySplitting=Ipe;function P8e(e){var r=Fpe.__assign(Fpe.__assign({},e),{split:Ipe(e.split,e.top)});return function(n){return SA(r,a6(r,r.top,n))}}wr.createFromKey=P8e;function SA(e,r){return r===wr.empty?wr.empty:r===wr.dense?wr.dense:{setOperations:e,root:r}}wr.fromUntyped=SA;function Mpe(e,r){return r===wr.empty?e:r===wr.dense||e===wr.empty?r:e===wr.dense?e:SA(e.setOperations,$5(e.setOperations,e.setOperations.top,e.root,r.root))}wr.union=Mpe;function $5(e,r,n,a){if(a===wr.empty)return n;if(a===wr.dense||n===wr.empty)return a;if(n===wr.dense)return n;if(n.isExact&&a.isExact){var o=E8e(e,r,n,a);if(o!==void 0)return o}var u=av(e,r,n),t=av(e,r,a),d=e.split(r),s=d[0][0],c=d[1][0],l=$5(e,s,u.left,t.left),f=$5(e,c,u.right,t.right);return hM(e,s,c,l,f)}wr.unionUntyped=$5;function E8e(e,r,n,a){var o=n.key,u=a.key,t=e.compare(o,u);if(t!==void 0)return t<0?a:n;var d=e.union(o,u);if(d!==void 0){var s=e.compare(d,r);return s!==void 0&&s===0?wr.dense:hA(e,r,d,!0)}}function N8e(e,r){return e===wr.empty?e:r===wr.empty||e===wr.dense?r:r===wr.dense?e:SA(e.setOperations,e6(e.setOperations,e.setOperations.top,e.root,r.root))}wr.intersect=N8e;function e6(e,r,n,a){if(n===wr.empty)return n;if(a===wr.empty||n===wr.dense)return a;if(a===wr.dense)return n;if(n.isExact&&a.isExact){var o=A8e(e,r,n,a);if(o!==void 0)return o}var u=av(e,r,n),t=av(e,r,a),d=e.split(r),s=d[0][0],c=d[1][0],l=e6(e,s,u.left,t.left),f=e6(e,c,u.right,t.right);return hM(e,s,c,l,f)}wr.intersectUntyped=e6;function A8e(e,r,n,a){var o=n.key,u=a.key;if(!e.meets(o,u))return wr.empty;var t=e.compare(o,u);if(t!==void 0)return t<0?n:a;var d=e.intersect(o,u);if(d!==void 0)return hA(e,r,d,!0)}function O8e(e,r){return e===wr.empty||r===wr.empty?!1:e===wr.dense||r===wr.dense?!0:r6(e.setOperations,e.setOperations.top,e.root,r.root)}wr.meets=O8e;function r6(e,r,n,a){if(n===wr.empty||a===wr.empty)return!1;if(n===wr.dense||a===wr.dense)return!0;if(n.isExact&&a.isExact)return e.meets(n.key,a.key);var o=av(e,r,n),u=av(e,r,a),t=e.split(r),d=t[0][0],s=t[1][0];return r6(e,d,o.left,u.left)||r6(e,s,o.right,u.right)}wr.meetsUntyped=r6;function n6(e,r){return e===wr.empty||r===wr.empty?e:r===wr.dense?wr.empty:e===wr.dense?SA(r.setOperations,kb(r.setOperations,r.setOperations.top,e,r.root)):SA(e.setOperations,kb(e.setOperations,e.setOperations.top,e.root,r.root))}wr.except=n6;function kb(e,r,n,a){if(n===wr.empty||a===wr.empty)return n;if(a===wr.dense)return wr.empty;if(n===wr.dense){var o=av(e,r,a),u=e.split(r),t=u[0][0],d=u[1][0],s=kb(e,t,wr.dense,o.left),c=kb(e,d,wr.dense,o.right);return hM(e,t,d,s,c)}if(n.isExact&&a.isExact){var l=k8e(e,r,n,a);if(l!==void 0)return l}var f=av(e,r,n),p=av(e,r,a),m=e.split(r),v=m[0][0],h=m[1][0],S=kb(e,v,f.left,p.left),y=kb(e,h,f.right,p.right);return hM(e,v,h,S,y)}wr.exceptUntyped=kb;function k8e(e,r,n,a){var o=n.key,u=a.key;if(!e.meets(o,u))return n;var t=e.except(o,u);if(t!==void 0)return hA(e,r,t,!0)}function F8e(e,r){return e===r?0:e===wr.empty?-1:r===wr.empty?1:e===wr.dense?r===wr.dense?0:1:r===wr.dense?-1:t6(e.setOperations,e.setOperations.top,e.root,r.root)}wr.compare=F8e;function wpe(e,r){if(!(e===void 0||r===void 0))return e===0?r:r===0||e===r?e:void 0}wr.combineCmp=wpe;function t6(e,r,n,a){if(n===a)return 0;if(n===wr.empty)return-1;if(a===wr.empty)return 1;if(n===wr.dense)return a===wr.dense?0:1;if(a===wr.dense)return-1;if(n.isExact&&a.isExact)return I8e(e,n,a);var o=av(e,r,n),u=av(e,r,a),t=e.split(r),d=t[0][0],s=t[1][0],c=t6(e,d,o.left,u.left);if(c!==void 0){var l=t6(e,s,o.right,u.right);if(l!==void 0)return wpe(c,l)}}wr.compareUntyped=t6;function I8e(e,r,n){return e.compare(r.key,n.key)}function hM(e,r,n,a,o){return a===wr.empty?o===wr.empty?wr.empty:o===wr.dense?eC(a,o,void 0,!1,e.infimum(n,n),e.supremum(n,n)):eC(a,o,void 0,!1,o.infimum,o.supremum):o===wr.empty?a===wr.dense?eC(a,o,void 0,!1,e.infimum(r,r),e.supremum(r,r)):eC(a,o,void 0,!1,a.infimum,a.supremum):a===wr.dense?o===wr.dense?wr.dense:eC(a,o,void 0,!1,e.combineInfima(e.infimum(r,r),o.infimum),e.combineSuprema(e.supremum(r,r),o.supremum)):o===wr.dense?eC(a,o,void 0,!1,e.combineInfima(a.infimum,e.infimum(n,n)),e.combineSuprema(a.supremum,e.supremum(n,n))):eC(a,o,void 0,!1,e.combineInfima(a.infimum,o.infimum),e.combineSuprema(a.supremum,o.supremum))}wr.dense=Cz.Dense;wr.empty=Cz.Empty;function eC(e,r,n,a,o,u){return{key:n,left:e,right:r,isExact:a,infimum:o,supremum:u}}function a6(e,r,n){if(!e.meets(r,n))return wr.empty;var a=e.compare(r,n);if(a!==void 0)return a<=0?wr.dense:hA(e,r,n,!0);var o=e.intersect(r,n);return o!==void 0?hA(e,r,o,!0):hA(e,r,n,!1)}wr.lazy=a6;function hA(e,r,n,a){return a?eC(void 0,void 0,n,!0,e.infimum(n,r),e.supremum(n,r)):eC(void 0,void 0,n,!1,e.infimum(n,r),e.supremum(n,r))}function av(e,r,n){if(n.left!==void 0)return n;var a=e.split(r),o=a[0][0],u=a[1][0],t=a6(e,o,n.key),d=a6(e,u,n.key),s=hM(e,o,u,t,d);if(s===wr.empty||s===wr.dense)throw new Error("incorrect set operations implementation");var c=s,l=n;return b8e(l,{left:c.left,right:c.right})}function M8e(e,r){return Mpe(n6(e,r),n6(r,e))}wr.symmetricDiff=M8e;function w8e(e){return n6(wr.dense,e)}wr.complement=w8e;function D8e(e){return e===wr.empty||e===wr.dense?0:yz(e.root)}wr.getNodeCount=D8e;function yz(e){return e===void 0||e===wr.empty||e===wr.dense?0:yz(e.left)+yz(e.right)+1}function x8e(e,r){return e===wr.empty?!0:Dpe(e.setOperations,e.root,r)}wr.forEachKey=x8e;function Dpe(e,r,n){function a(o,u){if(u===wr.empty)return!0;if(u===wr.dense)return n(o);if(u.isExact)return n(u.key);var t=av(e,o,u),d=e.split(o),s=d[0][0],c=d[1][0];return a(s,t.left)&&a(c,t.right)}return a(e.top,r)}wr.forEachKeyUntyped=Dpe});var xpe=Y(i6=>{"use strict";_();Object.defineProperty(i6,"__esModule",{value:!0});i6.Deque=void 0;function QS(e,r){return e&r-1}var L8e=function(){function e(){this.front=0,this.count=0,this.values=[void 0]}return e.prototype.getCount=function(){return this.count},e.prototype.maybeResize=function(){var r=this.values.length;if(this.count>=r){this.values.length=r<<1;for(var n=0;n<this.front;n+=1)this.values[r+n]=this.values[n],this.values[n]=void 0;return}var a=r>>4;if(a>=1&&this.count<a){for(var n=0;n<this.count;n+=1)this.values[QS(this.front+n,a)]=this.values[QS(this.front+n,r)];this.values.length=a,this.front=QS(this.front,a)}},e.prototype.pushBack=function(r){this.maybeResize(),this.values[QS(this.front+this.count,this.values.length)]=r,this.count+=1},e.prototype.pushFront=function(r){this.maybeResize();var n=QS(this.front-1,this.values.length);this.values[n]=r,this.front=n,this.count+=1},e.prototype.peekBack=function(){return this.values[QS(this.front+this.count-1,this.values.length)]},e.prototype.peekFront=function(){return this.values[this.front]},e.prototype.peekPos=function(r){if(!(r<0||r>=this.count))return this.values[QS(this.front+r,this.values.length)]},e.prototype.popBack=function(){var r=QS(this.front+this.count-1,this.values.length),n=this.values[r];return n!==void 0&&(this.values[r]=void 0,this.count-=1),n},e.prototype.popFront=function(){var r=this.values[this.front];return r!==void 0&&(this.values[this.front]=void 0,this.front=QS(this.front+1,this.values.length),this.count-=1),r},e.prototype.forEach=function(r){for(var n=this.values.length,a=0;a<this.count;a+=1){var o=this.values[QS(this.front+a,n)];if(!r(o))return!1}return!0},e}();i6.Deque=L8e});var Lpe=Y(z_=>{"use strict";_();Object.defineProperty(z_,"__esModule",{value:!0});z_.makeNumberDict=z_.makeStringDict=z_.makeDictionary=void 0;var Rz=vA(),Fb=tv();function Tz(e){function r(n,a){return Object.prototype.hasOwnProperty.call(n,a)}return{entries:(0,Fb.makeStringMap)(),keyToString:e,getCount:function(){return Object.keys(this.entries).length},getValue:function(a){var o=this.keyToString(a),u=r(this.entries,o)?this.entries[o]:void 0;return(0,Fb.isDefined)(u)?u.value:void 0},getEntry:function(a){var o=this.getValue(a);return o===void 0?void 0:(0,Rz.entry)(a,o)},setValue:function(a,o){var u=this.keyToString(a),t=r(this.entries,u)?this.entries[u]:void 0;(0,Fb.isDefined)(t)?t.value=o:this.entries[u]=(0,Rz.entry)(a,o)},contains:function(a){var o=this.keyToString(a),u=r(this.entries,o)?this.entries[o]:void 0;return(0,Fb.isDefined)(u)},remove:function(a){var o=this.keyToString(a);return r(this.entries,o)?(delete this.entries[o],!0):!1},getOrSetValue:function(a,o){var u=this.keyToString(a),t=r(this.entries,u)?this.entries[u]:void 0;if((0,Fb.isDefined)(t))return t.value;var d=o();return delete this.entries[u],this.entries[u]=(0,Rz.entry)(a,d),d},forEach:function(a){for(var o in this.entries){var u=r(this.entries,o)?this.entries[o]:void 0;if((0,Fb.isDefined)(u)&&!a(u.key,u.value))return!1}return!0},filter:function(a){var o=[];this.forEach(function(s,c){return a(s,c)||o.push(s),!0});for(var u=0,t=o;u<t.length;u++){var d=t[u];this.remove(d)}}}}z_.makeDictionary=Tz;function B8e(){return Tz(Fb.identity)}z_.makeStringDict=B8e;function q8e(){return Tz(function(e){return String(e)})}z_.makeNumberDict=q8e});var bz=Y(u6=>{"use strict";_();Object.defineProperty(u6,"__esModule",{value:!0});u6.logCollisionKey=void 0;var Bpe=Ol(),U8e=$y(),o6={},qpe=0;function G8e(e){var r=o6[e];o6[e]=(r===void 0?0:r)+1,qpe+=1,qpe%100===0&&(U8e.ulsLogger.ULS.traceTag(595858520,Bpe.LogCategory.msoulscat_ES_EWAJS,Bpe.TraceLevel.Info,"calc.common.hashUtils.logCollision: ".concat(JSON.stringify(o6),".")),o6={})}function K8e(e){G8e(V8e(e))}u6.logCollisionKey=K8e;function V8e(e){return typeof e=="object"?e===null?"null":"Object {".concat(Object.keys(e),"}"):typeof e}});var Upe=Y(s6=>{"use strict";_();Object.defineProperty(s6,"__esModule",{value:!0});s6.makeHashSet=void 0;var Pz=tv(),Ez=bz();function W8e(e,r){return{map:{},keyToHash:e,keyEquals:r,nelements:0,add:function(a){var o=this.keyToHash(a);if((0,Pz.isNone)(this.map[o]))this.map[o]=[a],this.nelements+=1;else{for(var u=this.map[o],t=0;t<u.length;t+=1)if(this.keyEquals(a,u[t]))return;(0,Ez.logCollisionKey)(a),u.push(a),this.nelements+=1}},contains:function(a){var o=this.keyToHash(a),u=this.map[o];if((0,Pz.isNone)(u))return!1;for(var t=0;t<u.length;t+=1)if(this.keyEquals(a,u[t]))return!0;return(0,Ez.logCollisionKey)(a),!1},forEach:function(a){var o=this,u=Object.keys(this.map);u.forEach(function(t){var d=o.map[Number(t)];d.forEach(function(s){a(s)})})},size:function(){return this.nelements},remove:function(a){var o=this,u=this.keyToHash(a),t=this.map[u];if((0,Pz.isNone)(t))return!1;var d=[],s=!1;return t.forEach(function(c){o.keyEquals(a,c)?(o.nelements-=1,s=!0):d.push(c)}),this.map[u]=d,s||(0,Ez.logCollisionKey)(a),s}}}s6.makeHashSet=W8e});var Gpe=Y(d6=>{"use strict";_();Object.defineProperty(d6,"__esModule",{value:!0});d6.makeHashTable=void 0;var l6=vA(),c6=bz(),Nz=tv();function j8e(e,r){return{map:{},nentries:0,keyToHash:e,keyEquals:r,getCount:function(){return this.nentries},getValue:function(a){var o=this.getEntry(a);return o===void 0?void 0:o.value},getEntry:function(a){var o=this.keyToHash(a),u=this.map[o];if(!(0,Nz.isNone)(u)){for(var t=0;t<u.length;t+=1){var d=u[t];if(this.keyEquals(a,d.key))return d}(0,c6.logCollisionKey)(a)}},contains:function(a){return this.getValue(a)!==void 0},setValue:function(a,o){var u=this.keyToHash(a),t=this.map[u];if(t==null)this.map[u]=[(0,l6.entry)(a,o)],this.nentries+=1;else{for(var d=0;d<t.length;d+=1){var s=t[d];if(this.keyEquals(s.key,a)){s.value=o;return}}t.push((0,l6.entry)(a,o)),this.nentries+=1,(0,c6.logCollisionKey)(a)}},remove:function(a){var o=this.keyToHash(a),u=this.map[o];if((0,Nz.isNone)(u))return!1;for(var t=[],d=!1,s=0;s<u.length;s+=1){var c=u[s];this.keyEquals(a,c.key)?(this.nentries-=1,d=!0):t.push(c)}return this.map[o]=t,d||(0,c6.logCollisionKey)(a),d},getOrSetValue:function(a,o){var u=this.keyToHash(a),t=this.map[u];if((0,Nz.isNone)(t)){var d=o();return this.map[u]=[(0,l6.entry)(a,d)],this.nentries+=1,d}for(var s=0;s<t.length;s+=1){var c=t[s];if(this.keyEquals(a,c.key))return c.value}var l=o();return t.push((0,l6.entry)(a,l)),this.nentries+=1,(0,c6.logCollisionKey)(a),l},forEach:function(a){var o=this,u=Object.keys(this.map);return u.every(function(t){var d=o.map[Number(t)];return d.every(function(s){return a(s.key,s.value)})})},filter:function(a){var o=[];this.forEach(function(s,c){return a(s,c)||o.push(s),!0});for(var u=0,t=o;u<t.length;u++){var d=t[u];this.remove(d)}}}}d6.makeHashTable=j8e});var Vpe=Y(zS=>{"use strict";_();Object.defineProperty(zS,"__esModule",{value:!0});zS.binarySearch=zS.exponentialBuckets=zS.linearBuckets=zS.Histogram=void 0;var H8e=function(){function e(r){var n=this;this.buckets=r,this.createSampleCounts=function(){return new Array(n.buckets.length+1).fill(0)},this.sampleCounts=this.createSampleCounts(),this.findBucket=function(){var a=function(t,d){return t-d},o=n.buckets.length;return function(u){return Kpe(n.buckets,0,o,u,a)}}()}return e.prototype.addSample=function(r){var n=this.findBucket(r);n<0&&(n=~n),this.sampleCounts[n]+=1},e.prototype.reset=function(){var r={buckets:this.buckets,sampleCounts:this.sampleCounts};return this.sampleCounts=this.createSampleCounts(),r},e}();zS.Histogram=H8e;function Q8e(e,r,n){for(var a=(r-e)/(n-1),o=[],u=e,t=0;t<n;u+=a,t+=1)o.push(u);return o}zS.linearBuckets=Q8e;function z8e(e,r,n){for(var a=Math.log(e),o=(Math.log(r)-a)/(n-1),u=[],t=0,d=0;d<n;t+=o,d+=1)u.push(Math.exp(a+t));return u}zS.exponentialBuckets=z8e;function Kpe(e,r,n,a,o){for(var u=r,t=r+n-1;u<=t;){var d=u+(t-u>>>1),s=o(e[d],a);if(s===0)return d;s<0?u=d+1:t=d-1}return~u}zS.binarySearch=Kpe});var Az=Y(_p=>{"use strict";_();Object.defineProperty(_p,"__esModule",{value:!0});_p.ivlCompare=_p.ivlExcept=_p.ivlMeetsOrTouches=_p.ivlMeets=_p.ivlDistance=_p.ivlMeet=_p.ivlJoin=void 0;var rC=tv();function Y8e(e,r){var n=e[0],a=e[1],o=r[0],u=r[1];return[(0,rC.fastMin)(n,o),(0,rC.fastMax)(a,u)]}_p.ivlJoin=Y8e;function J8e(e,r){var n=e[0],a=e[1],o=r[0],u=r[1];return[(0,rC.fastMax)(n,o),(0,rC.fastMin)(a,u)]}_p.ivlMeet=J8e;function X8e(e,r){var n=e[0],a=e[1],o=r[0],u=r[1];return(0,rC.fastAbs)(n+a-(o+u))*.5}_p.ivlDistance=X8e;function Z8e(e,r){var n=e[0],a=e[1],o=r[0],u=r[1];return(0,rC.fastMax)(n,o)<(0,rC.fastMin)(a,u)}_p.ivlMeets=Z8e;function $8e(e,r){var n=e[0],a=e[1],o=r[0],u=r[1];return(0,rC.fastMax)(n,o)<=(0,rC.fastMin)(a,u)}_p.ivlMeetsOrTouches=$8e;function e7e(e,r){var n=e[0],a=e[1],o=r[0],u=r[1];if(n<o&&u>=a)return[n,o];if(n>=o&&u<a)return[u,a]}_p.ivlExcept=e7e;function r7e(e,r){var n=e[0],a=e[1],o=r[0],u=r[1];if(n===o&&a===u)return 0;if(n>=o&&a<=u)return-1;if(n<=o&&a>=u)return 1}_p.ivlCompare=r7e});var Wpe=Y(f6=>{"use strict";_();Object.defineProperty(f6,"__esModule",{value:!0});f6.PriorityQueue=void 0;var n7e=Sz(),t7e=function(){function e(r){this.min=0,this.max=0,this.heap=new n7e.BinaryHeap(function(n,a){var o=n[0],u=n[1],t=a[0],d=a[1],s=r(o,t);return s!==0?s:u-d})}return e.prototype.peek=function(){var r=this.heap.peek();if(r!==void 0)return r[0]},e.prototype.enqueue=function(r){this.max+=1,this.heap.insert([r,this.max])},e.prototype.push=function(r){this.min-=1,this.heap.insert([r,this.min])},e.prototype.pop=function(){var r=this.heap.removeMin();if(r===void 0){this.min=0,this.max=0;return}return r[0]},e.prototype.getCount=function(){return this.heap.getCount()},e.prototype.clear=function(){this.heap.clear()},e}();f6.PriorityQueue=t7e});var r0e=Y(vu=>{"use strict";_();Object.defineProperty(vu,"__esModule",{value:!0});vu.productSetSerializer=vu.ProductSetSerializer=vu.getSubspaceCount=vu.forEachProduct=vu.getSubspaces=vu.symmetricDiffProduct=vu.complementProduct=vu.meetsProduct=vu.compareProduct=vu.exceptProduct=vu.intersectProduct=vu.unionProduct=vu.project=vu.createFromProduct=void 0;var Fo=br(),Dr=_z(),a7e=function(r,n){return r<n?-1:r>n?1:0},i7e=function(r,n){var a=r[0],o=n[0];return a7e(String(a),String(o))},jpe={};function o7e(e){for(var r="",n=0,a=e;n<a.length;n++){var o=a[n];r+=String(o[0]),r+="\0",r+=String(o[1]),r+="\0"}return r}var Ib=function(r){for(var n=[],a=0,o=Object.keys(r);a<o.length;a++){var u=o[a],t=u;n.push([t,r[t].id])}var d=o7e(n.sort(i7e)),s=jpe[d];return s===void 0&&(s={box:{},probabilities:{},depth:1},jpe[d]=s),s};function zpe(e){return Object.getOwnPropertyNames(e).length>0}function Uh(e){return zpe(e)?{isSubspace:!0,bounds:e}:Dr.dense}function Fz(e){return e.isSubspace?1:e.subspaceCount}var Hpe=function(r,n,a){return{isSubspace:!1,left:r,right:n,bounds:a,subspaceCount:Fz(r)+Fz(n)}};function yA(e,r){if(r===Dr.dense)return r;if(r.isSubspace){for(var n=!1,a=0,o=Object.keys(r.bounds);a<o.length;a++){var u=o[a];if(Object.prototype.hasOwnProperty.call(e,u)){n=!0;break}}if(!n)return Dr.dense}return{productOperations:e,root:r}}function _0(e){return e===void 0?Dr.dense:e}var iv={unzip:function(r){for(var n={},a={},o=0,u=Object.keys(r);o<u.length;o++){var t=u[o],d=t;if(Object.prototype.hasOwnProperty.call(r,d)){var s=r[d];if(s===Dr.empty)return Dr.empty;if(s===Dr.dense)continue;n[d]=s.setOperations,a[d]=s.root}}return yA(n,Uh(a))},combineProduct:function(r,n,a,o){for(var u={},t=0,d=Object.keys(r);t<d.length;t++){var s=d[t],c=s;if(Object.prototype.hasOwnProperty.call(r,c)){var l=o(r[c],r[c].top,_0(n[c]),_0(a[c]));if(l===Dr.empty)return Dr.empty;if(l===Dr.dense)continue;u[c]=l}}return u},restrict:function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];for(var o={},u=0,t=n;u<t.length;u++){var d=t[u];if(Object.prototype.hasOwnProperty.call(r,d)){var s=r[d];o[d]=s}}return o},fromUntypedProduct:function(r,n,a){for(var o={},u=0,t=a;u<t.length;u++){var d=t[u],s=n[d];o[d]=(0,Dr.fromUntyped)(r[d],s!==void 0?s:Dr.dense)}return o},denseProduct:function(r){for(var n={},a=0,o=r;a<o.length;a++){var u=o[a];n[u]=Dr.dense}return n}};vu.createFromProduct=iv.unzip.bind(iv);function Qpe(e,r,n){var a=iv.combineProduct(e,r,n,Dr.unionUntyped);if(a===Dr.empty)throw new Error("broken invariant: the union of two non-empty products cannot be empty");return a}function h6(e,r,n){for(var a=0,o=0,u=Object.keys(e);o<u.length;o++){var t=u[o],d=t;if(Object.prototype.hasOwnProperty.call(e,d)){var s=_0(r[d]),c=_0(n[d]),l=e[d];if(a=(0,Dr.combineCmp)(a,(0,Dr.compareUntyped)(l,l.top,s,c)),a===void 0)return}}return a}var Ype=function(){var e={};return function(r,n,a){var o;if(n===e.left&&a===e.right)return e.res;e.left=n,e.right=a;var u=h6(r,n.bounds,a.bounds);if(u!==void 0)return e.res=u<=0?a:n;for(var t,d=Object.keys(r),s=0,c=d;s<c.length;s++){var l=c[s];if(Object.prototype.hasOwnProperty.call(r,l)){var f=(0,Dr.compareUntyped)(r[l],r[l].top,_0(n.bounds[l]),_0(a.bounds[l]));if(f!==0){if(t!==void 0)return e.res=void 0;t=l}}}if(t!==void 0){var p=(0,Dr.unionUntyped)(r[t],r[t].top,_0(n.bounds[t]),_0(a.bounds[t]));if(p===Dr.empty)return e.res=Dr.empty;if(p===Dr.dense){var m=n.bounds,v=t,h=m[v],S=Fo.__rest(m,[typeof v=="symbol"?v:v+""]);return e.res=Uh(S)}var y=Fo.__assign(Fo.__assign({},n.bounds),(o={},o[t]=p,o));return e.res=Uh(y)}return e.res=void 0}}();function p6(e,r,n){if(n===Dr.empty)return r;if(n===Dr.dense||r===Dr.empty)return n;if(r===Dr.dense)return r;if(!r.isSubspace||!n.isSubspace)return Hpe(r,n,Qpe(e,r.bounds,n.bounds));var a=Ype(e,r,n);return a!==void 0?a:Hpe(r,n,Qpe(e,r.bounds,n.bounds))}function Iz(e,r,n){for(var a=[],o=3;o<arguments.length;o++)a[o-3]=arguments[o];if(r===Dr.empty||r===Dr.dense)return r;if(r.isSubspace){var u=iv.restrict.apply(iv,Fo.__spreadArray([r.bounds],a,!1));return Uh(u)}var t=S6(e,n),d=t[0],s=t[1],c=Mb(e,r,d,s),l=c[0],f=c[1],p=Iz.apply(void 0,Fo.__spreadArray([e,l,d],a,!1)),m=Iz.apply(void 0,Fo.__spreadArray([e,f,s],a,!1));return p6(e,p,m)}function Jpe(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];if(e===Dr.dense||e===Dr.empty)return e;var a=iv.restrict.apply(iv,Fo.__spreadArray([e.productOperations],r,!1));if(!zpe(a))return Dr.dense;var o=Iz.apply(void 0,Fo.__spreadArray([a,e.root,Ib(a)],r,!1));return o===Dr.empty?o:yA(a,o)}vu.project=Jpe;function S6(e,r){var n,a,o,u;if(r.children!==void 0)return r.children;for(var t=r.box,d=r.probabilities,s,c,l=0,f=Object.keys(e),p=0,m=f;p<m.length;p++){var v=m[p];if(Object.prototype.hasOwnProperty.call(e,v)){var h=d[v],S=e[v];if(h===void 0){s=v,c=S.top;break}if(h>l){var y=_0(t[v]);if(y===Dr.empty)throw new Error("the key split can never return empty");var C=S.top;if(y!==Dr.dense){if(!y.isExact)throw new Error("the key can always be represented exactly");C=y.key}if(!S.canSplit(C))continue;s=v,l=h,c=C}}}if(s===void 0||c===void 0)throw new Error("there has to be at least one dimension");var E=e[s],I=E.split(c),F=I[0],w=F[0],B=F[1],k=I[1],x=k[0],G=k[1],H=[{box:Fo.__assign(Fo.__assign({},t),(n={},n[s]=(0,Dr.lazy)(E,E.top,w),n)),probabilities:Fo.__assign(Fo.__assign({},d),(a={},a[s]=B,a)),depth:r.depth+1},{box:Fo.__assign(Fo.__assign({},t),(o={},o[s]=(0,Dr.lazy)(E,E.top,x),o)),probabilities:Fo.__assign(Fo.__assign({},d),(u={},u[s]=G,u)),depth:r.depth+1}];return r.depth<10&&(r.children=H),H}function Mz(e,r,n,a){if(r===Dr.empty)return[Dr.empty,Dr.empty];if(r===Dr.dense)return[Uh(n),Uh(a)];var o=h6(e,r.bounds,n);if(o!==void 0&&o<=0)return[r,Dr.empty];var u=iv.combineProduct(e,r.bounds,n,Dr.intersectUntyped);if(u===Dr.empty)return[Dr.empty,r];var t=iv.combineProduct(e,r.bounds,a,Dr.intersectUntyped);if(r.isSubspace)return[Uh(u),t===Dr.empty?Dr.empty:Uh(t)];var d=Mz(e,r.left,n,a),s=d[0],c=d[1],l=Mz(e,r.right,n,a),f=l[0],p=l[1];return[p6(e,s,f),p6(e,c,p)]}var Mb=function(r,n,a,o){var u=a.box,t=o.box;return Mz(r,n,u,t)};function m6(e,r,n,a,o){var u=S6(e,a),t=u[0],d=u[1],s=Mb(e,r,t,d),c=s[0],l=s[1],f=Mb(e,n,t,d),p=f[0],m=f[1],v=o(e,c,p,t);if(v===Dr.dense)return Dr.dense;var h=o(e,l,m,d);return p6(e,v,h)}function Xpe(e,r,n,a){if(n===Dr.empty)return r;if(r===Dr.empty)return n;if(r===Dr.dense)return r;if(n===Dr.dense)return n;if(r.isSubspace&&n.isSubspace){var o=Ype(e,r,n);if(o!==void 0)return o}return m6(e,r,n,a,Xpe)}function Zpe(e,r){if(r===Dr.empty)return e;if(r===Dr.dense||e===Dr.empty)return r;if(e===Dr.dense)return e;var n=Fo.__assign(Fo.__assign({},e.productOperations),r.productOperations),a=Xpe(n,e.root,r.root,Ib(n));return a===Dr.empty?a:yA(n,a)}vu.unionProduct=Zpe;function $pe(e,r,n,a){if(r===Dr.empty||n===Dr.empty)return Dr.empty;if(r===Dr.dense)return n;if(n===Dr.dense)return r;if(r.isSubspace&&n.isSubspace){var o=iv.combineProduct(e,r.bounds,n.bounds,Dr.intersectUntyped);return o===Dr.empty?Dr.empty:Uh(o)}return m6(e,r,n,a,$pe)}function u7e(e,r){if(e===Dr.empty)return e;if(r===Dr.empty||e===Dr.dense)return r;if(r===Dr.dense)return e;var n=Fo.__assign(Fo.__assign({},e.productOperations),r.productOperations),a=$pe(n,e.root,r.root,Ib(n));return a===Dr.empty?a:yA(n,a)}vu.intersectProduct=u7e;function s7e(e,r,n){var a,o=h6(e,r.bounds,n.bounds);if(o===0||o===-1)return Dr.empty;for(var u,t=Object.keys(e),d=0,s=t;d<s.length;d++){var c=s[d];if(Object.prototype.hasOwnProperty.call(e,c)){var l=(0,Dr.compareUntyped)(e[c],e[c].top,_0(r.bounds[c]),_0(n.bounds[c]));if(l===void 0||l>0){if(u!==void 0)return;u=c}}}if(u!==void 0){var f=(0,Dr.exceptUntyped)(e[u],e[u].top,_0(r.bounds[u]),_0(n.bounds[u]));if(f===Dr.empty)return Dr.empty;if(f===Dr.dense){var p=r.bounds,m=u,v=p[m],h=Fo.__rest(p,[typeof m=="symbol"?m:m+""]);return Uh(h)}var S=Fo.__assign(Fo.__assign({},r.bounds),(a={},a[u]=f,a));return Uh(S)}}function g6(e,r,n,a){if(r===Dr.empty)return r;if(n===Dr.dense)return Dr.empty;if(n===Dr.empty)return r;if(r===Dr.dense)return m6(e,r,n,a,g6);if(r.isSubspace&&n.isSubspace){var o=s7e(e,r,n);if(o!==void 0)return o}return m6(e,r,n,a,g6)}function v6(e,r){if(e===Dr.empty||r===Dr.empty)return e;if(r===Dr.dense)return Dr.empty;if(e===Dr.dense){var n=g6(r.productOperations,Dr.dense,r.root,Ib(r.productOperations));return n===Dr.empty?n:yA(r.productOperations,n)}var a=Fo.__assign(Fo.__assign({},e.productOperations),r.productOperations),o=g6(a,e.root,r.root,Ib(a));return o===Dr.empty?o:yA(a,o)}vu.exceptProduct=v6;function wz(e,r,n,a){if(r===n)return 0;if(r===Dr.empty)return-1;if(n===Dr.empty)return 1;if(r===Dr.dense)return n===Dr.dense?0:1;if(n===Dr.dense)return-1;if(r.isSubspace&&n.isSubspace)return h6(e,r.bounds,n.bounds);var o=S6(e,a),u=o[0],t=o[1],d=Mb(e,r,u,t),s=d[0],c=d[1],l=Mb(e,n,u,t),f=l[0],p=l[1],m=wz(e,s,f,u);if(m!==void 0)return(0,Dr.combineCmp)(m,wz(e,c,p,t))}function l7e(e,r){if(e===r)return 0;if(e===Dr.empty)return-1;if(r===Dr.empty)return 1;if(e===Dr.dense)return r===Dr.dense?0:1;if(r===Dr.dense)return-1;var n=Fo.__assign(Fo.__assign({},e.productOperations),r.productOperations);return wz(n,e.root,r.root,Ib(n))}vu.compareProduct=l7e;function c7e(e,r,n){for(var a=0,o=Object.keys(e);a<o.length;a++){var u=o[a],t=u;if(Object.prototype.hasOwnProperty.call(e,t)){var d=_0(r[t]),s=_0(n[t]),c=e[t];if(!(0,Dr.meetsUntyped)(c,c.top,d,s))return!1}}return!0}function Dz(e,r,n,a){if(r===Dr.empty||n===Dr.empty)return!1;if(r===Dr.dense||n===Dr.dense)return!0;if(!c7e(e,r.bounds,n.bounds))return!1;if(r.isSubspace&&n.isSubspace)return!0;var o=S6(e,a),u=o[0],t=o[1],d=Mb(e,r,u,t),s=d[0],c=d[1],l=Mb(e,n,u,t),f=l[0],p=l[1];return Dz(e,s,f,u)||Dz(e,c,p,t)}function d7e(e,r){if(e===Dr.empty||r===Dr.empty)return!1;if(e===Dr.dense||r===Dr.dense)return!0;var n=Fo.__assign(Fo.__assign({},e.productOperations),r.productOperations);return Dz(n,e.root,r.root,Ib(n))}vu.meetsProduct=d7e;var f7e=function(r){return v6(Dr.dense,r)};vu.complementProduct=f7e;var p7e=function(r,n){return Zpe(v6(r,n),v6(n,r))};vu.symmetricDiffProduct=p7e;function m7e(e){if(e===Dr.empty||e===Dr.dense)return[];var r=[];function n(a){if(a.isSubspace){r.push(a.bounds);return}n(a.left),n(a.right)}return n(e.root),r}vu.getSubspaces=m7e;function g7e(e,r){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];var o=Jpe.apply(void 0,Fo.__spreadArray([e],n,!1));if(o===Dr.empty)return!0;if(o===Dr.dense)return r(iv.denseProduct(n));var u=o.productOperations,t=o.root;function d(s){return s.isSubspace?r(iv.fromUntypedProduct(u,s.bounds,n)):d(s.left)&&d(s.right)}return d(t)}vu.forEachProduct=g7e;function v7e(e){return e===Dr.empty||e===Dr.dense?0:Fz(e.root)}vu.getSubspaceCount=v7e;var h7e=function(){function e(r){r===void 0&&(r=[]),this.buffer=r,this.cursor=0}return e.prototype.putBack=function(r){this.cursor-=1,this.buffer[this.cursor]=r},e.prototype.pick=function(){return this.buffer[this.cursor]},Object.defineProperty(e.prototype,"length",{get:function(){return this.buffer.length-this.cursor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this.length===0},enumerable:!1,configurable:!0}),e.prototype.pop=function(){var r=this.pick();return this.cursor+=1,r},e}(),S7e=function(){function e(){var r=this;this.size=0,this.clear=function(){},this.get=function(){},this.set=function(){return r}}return e}();function Oz(e,r){var n=function(o,u){for(var t=[],d=2;d<arguments.length;d++)t[d-2]=arguments[d];var s=r.get(o);if(s!==void 0){u.push("__cached__",s);return}e.apply(void 0,Fo.__spreadArray([o,u],t,!1)),r.set(o,r.size)};return n}function kz(e,r){var n=function(o){for(var u=[],t=1;t<arguments.length;t++)u[t-1]=arguments[t];if(o.pick()==="__cached__"){o.pop();var d=o.pop();return r[d]}var s=e.apply(void 0,Fo.__spreadArray([o],u,!1));return r.push(s),s};return n}var e0e=function(){function e(r){var n=this,a,o,u,t;this.globalProductOperations=r,this.cached=typeof Map!="undefined"?new Map:new S7e,this.cache=[],this.serializers={},this.serializeProductSet=function(c,l){if(c===Dr.empty||c===Dr.dense){l.push(c);return}var f=c,p=n.getDims(f.productOperations);l.push(p),n.serializeUntypedSparseProductCached(f.root,l,p)},this.deserializeProductSet=function(c){var l=c.pop();if(l===Dr.empty||l===Dr.dense)return l;c.putBack(l);for(var f={},p=c.pop(),m=0,v=p;m<v.length;m++){var h=v[m],S=n.globalProductOperations[h];f[h]=S}var y=n.deserializeUntypedSparseProductCached(c,p);return{productOperations:f,root:y}},this.serializeUntypedSparse=function(c,l,f){l.push(c==null?void 0:c.isExact),l.push(n.serializers[f].serializeBound(c==null?void 0:c.infimum)),l.push(n.serializers[f].serializeBound(c==null?void 0:c.supremum));var p=e.normalizeKey(c==null?void 0:c.key);l.push(n.serializers[f].serializeKey(p));for(var m=0,v=[c==null?void 0:c.left,c==null?void 0:c.right];m<v.length;m++){var h=v[m];h==null||h===Dr.empty||h===Dr.dense?l.push(h):(l.push("us"),n.serializeUntypedSparseCached(h,l,f))}},this.deserializeUntypedSparse=function(c,l){var f=c.pop(),p=n.serializers[l].deserializeBound(c.pop()),m=n.serializers[l].deserializeBound(c.pop()),v=n.serializers[l].deserializeKey(c.pop()),h=["left","right"].map(function(C){var E=c.pop();if(E==="us"){var I=n.deserializeUntypedSparseCached(c,l);return I}return E}),S=h[0],y=h[1];return{infimum:p,supremum:m,isExact:f,key:v,left:S,right:y}},this.serializeUntypedSparseProduct=function(c,l,f){l.push(c.isSubspace);for(var p=0,m=f;p<m.length;p++){var v=m[p],h=c.bounds[v];n.serializeUntypedSparseCached(h,l,v)}c.isSubspace||(n.serializeUntypedSparseProductCached(c.left,l,f),n.serializeUntypedSparseProductCached(c.right,l,f),l.push(c.subspaceCount))},this.deserializeUntypedSparseProduct=function(c,l){for(var f=c.pop(),p={},m=0,v=l;m<v.length;m++){var h=v[m],S=n.deserializeUntypedSparseCached(c,h);p[h]=S}if(!f){var y=n.deserializeUntypedSparseProductCached(c,l),C=n.deserializeUntypedSparseProductCached(c,l),E=c.pop();return{isSubspace:f,bounds:p,left:y,right:C,subspaceCount:E}}return{isSubspace:f,bounds:p}},this.serializeUntypedSparseCached=Oz(this.serializeUntypedSparse,this.cached),this.deserializeUntypedSparseCached=kz(this.deserializeUntypedSparse,this.cache),this.serializeProductSetCached=Oz(this.serializeProductSet,this.cached),this.deserializeProductSetCached=kz(this.deserializeProductSet,this.cache),this.serializeUntypedSparseProductCached=Oz(this.serializeUntypedSparseProduct,this.cached),this.deserializeUntypedSparseProductCached=kz(this.deserializeUntypedSparseProduct,this.cache);for(var d in r){var s={serializeKey:(a=r[d].serializeKey)!==null&&a!==void 0?a:function(c){return JSON.stringify(c)},deserializeKey:(o=r[d].deserializeKey)!==null&&o!==void 0?o:function(c){return JSON.parse(c)},serializeBound:(u=r[d].serializeBound)!==null&&u!==void 0?u:function(c){return JSON.stringify(c)},deserializeBound:(t=r[d].deserializeBound)!==null&&t!==void 0?t:function(c){return JSON.parse(c)}};this.serializers[d]=s}}return e.prototype.getDims=function(r){return Object.keys(r)},e.prototype.serialize=function(r){this.cached.clear();var n=[];n.push(r.length);for(var a=0,o=r;a<o.length;a++){var u=o[a];this.serializeProductSetCached(u,n)}return JSON.stringify(n)},e.prototype.deserialize=function(r){this.cache.length=0;for(var n=new h7e(JSON.parse(r)),a=n.pop(),o=[],u=0;u<a;u+=1){var t=this.deserializeProductSetCached(n);o.push(t)}return o},e.normalizeKey=function(r){if(typeof r=="object"){var n=Fo.__assign({},r);return delete n.depth,delete n.split,n}return r},e}();vu.ProductSetSerializer=e0e;function y7e(e){return new e0e(e)}vu.productSetSerializer=y7e});var qz=Y(hu=>{"use strict";_();Object.defineProperty(hu,"__esModule",{value:!0});hu.remove=hu.removeUntyped=hu.insert=hu.insertUntyped=hu.forEach=hu.forEachUntyped=hu.find=hu.findUntyped=hu.empty=hu.emptyUntyped=hu.isLeaf=hu.fromUntyped=hu.Color=void 0;var T6=$y(),Bz;(function(e){e[e.Red=0]="Red",e[e.Black=1]="Black"})(Bz=hu.Color||(hu.Color={}));var xz;(function(e){e[e.DoubleBlack=2]="DoubleBlack"})(xz||(xz={}));var Hc=Bz.Red,Ui=Bz.Black,ov=xz.DoubleBlack,nC={c:Ui,l:void 0,r:void 0},n0e={c:ov,l:void 0,r:void 0};function b6(e,r){return{ops:e,root:r}}hu.fromUntyped=b6;function J_(e){return e.l===void 0}hu.isLeaf=J_;function Yf(e){return e.c===Hc}function wb(e){return e.c===Ui&&e.l!==void 0}function uv(e){return e.c===Ui&&e.l===void 0}hu.emptyUntyped=nC;function C7e(e){return b6(e,hu.emptyUntyped)}hu.empty=C7e;function eu(e,r,n,a,o){return{c:e,l:r,key:n,value:a,r:o}}function _A(e,r){var n=r.l,a=r.key,o=r.value,u=r.r;return eu(e,n,a,o,u)}function CA(e){return J_(e)?nC:_A(Ui,e)}function _7e(e){return wb(e)&&e.l.c===Ui&&e.r.c===Ui?_A(Hc,e):e}function R7e(e){return Yf(e)&&(e.l.c===Hc||e.r.c===Hc)?_A(Ui,e):e}function _6(e,r,n){if(!J_(n)){var a=e.keyCompare(r,n.key);return a<0?_6(e,r,n.l):a>0?_6(e,r,n.r):n}}hu.findUntyped=_6;function T7e(e,r){return _6(r.ops,e,r.root)}hu.find=T7e;function R6(e,r){return J_(r)?!0:!R6(e,r.l)||!e(r.key,r.value)?!1:R6(e,r.r)}hu.forEachUntyped=R6;function b7e(e,r){return R6(e,r.root)}hu.forEach=b7e;function Y_(e,r,n,a,o){if(e===Ui){if(Yf(r)&&Yf(r.l))return eu(Hc,_A(Ui,r.l),r.key,r.value,eu(Ui,r.r,n,a,o));if(Yf(o)&&Yf(o.r))return eu(Hc,eu(Ui,r,n,a,o.l),o.key,o.value,_A(Ui,o.r));if(Yf(r)&&Yf(r.r))return eu(Hc,eu(Ui,r.l,r.key,r.value,r.r.l),r.r.key,r.r.value,eu(Ui,r.r.r,n,a,o));if(Yf(o)&&Yf(o.l))return eu(Hc,eu(Ui,r,n,a,o.l.l),o.l.key,o.l.value,eu(Ui,o.l.r,o.key,o.value,o.r))}if(e===ov){if(Yf(o)&&Yf(o.l))return eu(Ui,eu(Ui,r,n,a,o.l.l),o.l.key,o.l.value,eu(Ui,o.l.r,o.key,o.value,o.r));if(Yf(r)&&Yf(r.r))return eu(Ui,eu(Ui,r.l,r.key,r.value,r.r.l),r.r.key,r.r.value,eu(Ui,r.r.r,n,a,o))}return eu(e,r,n,a,o)}function y6(e,r,n,a,o){return e===Hc&&r.c===ov&&wb(o)?Y_(Ui,eu(Hc,CA(r),n,a,o.l),o.key,o.value,o.r):e===Hc&&wb(r)&&o.c===ov?Y_(Ui,r.l,r.key,r.value,eu(Hc,r.r,n,a,CA(o))):e===Ui&&r.c===ov&&wb(o)?Y_(ov,eu(Hc,CA(r),n,a,o.l),o.key,o.value,o.r):e===Ui&&wb(r)&&o.c===ov?Y_(ov,r.l,r.key,r.value,eu(Hc,r.r,n,a,CA(o))):e===Ui&&r.c===ov&&Yf(o)&&wb(o.l)?eu(Ui,Y_(Ui,eu(Hc,CA(r),n,a,o.l.l),o.l.key,o.l.value,o.l.r),o.key,o.value,o.r):e===Ui&&Yf(r)&&wb(r.r)&&o.c===ov?eu(Ui,r.l,r.key,r.value,Y_(Ui,r.r.l,r.r.key,r.r.value,eu(Hc,r.r.r,n,a,CA(o)))):((0,T6.assertTrue)("calc.common.rbTree.rotate: expected R|B",r.c!==ov&&o.c!==ov),eu(e,r,n,a,o))}function Lz(e,r,n,a){if(J_(a))return eu(Hc,nC,r,n,nC);var o=e.keyCompare(r,a.key);return o<0?Y_(a.c,Lz(e,r,n,a.l),a.key,a.value,a.r):o>0?Y_(a.c,a.l,a.key,a.value,Lz(e,r,n,a.r)):eu(a.c,a.l,r,n,a.r)}function t0e(e,r,n,a){return R7e(Lz(e,r,n,a))}hu.insertUntyped=t0e;function P7e(e,r,n){return b6(n.ops,t0e(n.ops,e,r,n.root))}hu.insert=P7e;function C6(e,r,n){if(J_(n))return n;if(n.c===Hc&&uv(n.l)&&uv(n.r))return e.keyCompare(r,n.key)===0?nC:n;if(n.c===Ui&&uv(n.l)&&uv(n.r))return e.keyCompare(r,n.key)===0?n0e:n;if(n.c===Ui&&Yf(n.l)&&uv(n.l.l)&&uv(n.l.r)&&uv(n.r)){var a=e.keyCompare(r,n.key);return a<0?eu(Ui,C6(e,r,n.l),n.key,n.value,nC):a>0?n:eu(Ui,nC,n.l.key,n.l.value,nC)}var o=e.keyCompare(r,n.key);if(o<0)return y6(n.c,C6(e,r,n.l),n.key,n.value,n.r);if(o>0)return y6(n.c,n.l,n.key,n.value,C6(e,r,n.r));(0,T6.assertTrue)("calc.common.rbTree.rem: expected node",!J_(n.r));var u=a0e(n.r),t=u[0],d=u[1],s=u[2];return y6(n.c,n.l,t,d,s)}function a0e(e){if(e.c===Hc&&uv(e.l)&&uv(e.r))return[e.key,e.value,nC];if(e.c===Ui&&uv(e.l)&&uv(e.r))return[e.key,e.value,n0e];if(e.c===Ui&&uv(e.l)&&Yf(e.r))return[e.key,e.value,_A(Ui,e.r)];(0,T6.assertTrue)("calc.common.rbTree.remMin: expected node",!J_(e.l));var r=a0e(e.l),n=r[0],a=r[1],o=r[2];return[n,a,y6(e.c,o,e.key,e.value,e.r)]}function i0e(e,r,n){var a=C6(e,r,_7e(n));return(0,T6.assertTrue)("calc.common.rbTree.remove: expected R|B",a.c===Hc||a.c===Ui),a}hu.removeUntyped=i0e;function E7e(e,r){return b6(r.ops,i0e(r.ops,e,r.root))}hu.remove=E7e});var o0e=Y(P6=>{"use strict";_();Object.defineProperty(P6,"__esModule",{value:!0});P6.RedBlackMapTree=void 0;var tC=qz(),N7e=function(){function e(r,n,a){this.root=r,this.count=n,this.keyCompare=a}return e.create=function(r){return new e(tC.emptyUntyped,0,r)},e.prototype.getCount=function(){return this.count},e.prototype.getValue=function(r){var n=(0,tC.findUntyped)(this,r,this.root);return n==null?void 0:n.value},e.prototype.getEntry=function(r){return(0,tC.findUntyped)(this,r,this.root)},e.prototype.contains=function(r){return this.getValue(r)!==void 0},e.prototype.forEach=function(r){return(0,tC.forEachUntyped)(r,this.root)},e.prototype.setValue=function(r,n){return new e((0,tC.insertUntyped)(this,r,n,this.root),this.contains(r)?this.count:this.count+1,this.keyCompare)},e.prototype.remove=function(r){return this.contains(r)?new e((0,tC.removeUntyped)(this,r,this.root),this.count-1,this.keyCompare):this},e.prototype.getOrSetValue=function(r,n){var a=this.getValue(r);if(a!==void 0)return[this,a];var o=n();return[new e((0,tC.insertUntyped)(this,r,o,this.root),this.count+1,this.keyCompare),o]},e.prototype.filter=function(r){var n=this,a=tC.emptyUntyped,o=0;return this.forEach(function(u,t){return r(u,t)&&(a=(0,tC.insertUntyped)(n,u,t,a),o+=1),!1}),new e(a,o,this.keyCompare)},e}();P6.RedBlackMapTree=N7e});var u0e=Y(E6=>{"use strict";_();Object.defineProperty(E6,"__esModule",{value:!0});E6.RingBuffer=void 0;var A7e=function(){function e(r){r===void 0&&(r=1/0),this.list=r<1/0?new Array(r):new Array,this.counter=0,this.capacity=r,this.readIndex=0,this.writeIndex=0}return e.prototype.count=function(){return this.counter},e.prototype.isEmpty=function(){return this.counter===0},e.prototype.enqueue=function(r){this.list[this.writeIndex]=r;var n=this.counter!==0&&this.writeIndex===this.readIndex;n?this.readIndex=(this.readIndex+1)%this.capacity:this.counter++,this.writeIndex=(this.writeIndex+1)%this.capacity},e.prototype.dequeue=function(){if(!this.isEmpty()){var r=this.list[this.readIndex];return this.list[this.readIndex]=void 0,this.readIndex=(this.readIndex+1)%this.capacity,this.counter--,r}},e.prototype.executeOnEveryElement=function(r){for(var n=0;n<this.counter;n++){var a=(this.readIndex+n)%this.capacity,o=this.list[a];if(o!==void 0){var u=r(o);if(!u)return!1}}return!0},e}();E6.RingBuffer=A7e});var f0e=Y(aC=>{"use strict";_();Object.defineProperty(aC,"__esModule",{value:!0});aC.RTree=aC.RTKind=aC.copyExcept=void 0;var s0e=br(),rm=tv(),O7e=vA();function RA(e,r,n){if(n!==void 0){var a=e.slice();return a[r]=n,a}var o=e.slice(0,-1);return r<e.length-1&&(o[r]=e[e.length-1]),o}aC.copyExcept=RA;var YS;(function(e){e[e.Ptr=1]="Ptr",e[e.Leaf=2]="Leaf",e[e.Branch=3]="Branch"})(YS=aC.RTKind||(aC.RTKind={}));function yM(e,r,n){return{kind:e,key:r,value:n}}function Uz(e,r){return yM(YS.Ptr,e,r)}function TA(e,r){return yM(YS.Leaf,e,r)}function Db(e,r){return yM(YS.Branch,e,r)}var k7e=function(){function e(r,n,a){this.lattice=r,this.root=n,this.count=a}return e.create=function(r,n,a,o,u){u===void 0&&(u=2);var t=u>1?Math.ceil(u):1,d=t*2;function s(l,f){var p=a(l,f);return p!==void 0&&p>=0}function c(l,f){var p=a(l,f);return p!==void 0&&p<=0}return new e({keyJoin:r,keyMeets:n,keyCompare:a,keyDistance:o,minChildren:t,maxChildren:d,keyGe:s,keyLe:c},void 0,0)},e.prototype.getCount=function(){return this.count},Object.defineProperty(e.prototype,"bounds",{get:function(){var n;return(n=this.root)===null||n===void 0?void 0:n.key},enumerable:!1,configurable:!0}),e.prototype.getValue=function(r){if(this.root===void 0)return;function n(a,o){var u=a.keyCompare(o.key,r);if(o.kind===YS.Ptr)return u===0?o.value:void 0;if(!(u===void 0||u<0))for(var t=0,d=o.value;t<d.length;t++){var s=d[t],c=n(a,s);if(c!==void 0)return c}}return n(this.lattice,this.root)},e.prototype.getEntry=function(r){var n=this.getValue(r);return n===void 0?void 0:(0,O7e.entry)(r,n)},e.prototype.setValue=function(r,n,a){a===void 0&&(a=function(t){return!0});var o=d0e(this.lattice,this.root,r,a,n);return o!==void 0?o===this.root?this:new e(this.lattice,o,this.count):new e(this.lattice,c0e(this.lattice,this.root,Uz(r,n)),this.count+1)},e.prototype.filter=function(r){var n=new e(this.lattice,void 0,0);return this.forEach(function(a,o){return r(a,o)&&(n=n.setValue(a,o)),!0}),n},e.prototype.contains=function(r,n){return n===void 0&&(n=function(o){return!0}),d0e(this.lattice,this.root,r,n)!==void 0},e.prototype.getOrSetValue=function(r,n){var a=this.getValue(r);if(a===void 0){var o=n();return[this.setValue(r,o),o]}return[this,a]},e.prototype.forEach=function(r){return SM(this.root,r)},e.prototype.forEachGe=function(r,n){var a=this;return SM(this.root,n,function(o){return a.lattice.keyGe(o,r)},function(o){return a.lattice.keyGe(o,r)})},e.prototype.forEachLe=function(r,n){var a=this;return SM(this.root,n,function(o){return a.lattice.keyMeets(o,r)},function(o){return a.lattice.keyLe(o,r)})},e.prototype.forEachMeets=function(r,n){var a=this;return SM(this.root,n,function(o){return a.lattice.keyMeets(o,r)},function(o){return a.lattice.keyMeets(o,r)})},e.prototype.remove=function(r){var n=this;if(this.root==null)return this;var a=[],o=this.lattice,u=function p(m,v){var h=o.keyCompare(m.key,r);if(h===void 0||h<0)return(0,rm.pair)(m,1);if(m.kind===YS.Leaf){for(var S=m.value,y=0;y<S.length;y+=1)if(o.keyCompare(S[y].key,r)===0){var C=RA(S,y);if(C.length<v){var E=TA(m.key,C);return a.push(E),(0,rm.pair)(E,3)}return(0,rm.pair)(TA(N6(o,C),C),2)}}else for(var S=m.value,y=0;y<S.length;y+=1){var I=p(S[y],o.minChildren),F=I[0],w=I[1];if(w===3){var C=RA(S,y);if(C.length>=v)return(0,rm.pair)(Db(N6(o,C),C),2);var E=Db(m.key,C);return a.push(E),(0,rm.pair)(E,3)}if(w===2)return(0,rm.pair)(Db(m.key,RA(S,y,F)),2)}return(0,rm.pair)(m,1)},t=this.root.kind===YS.Leaf?1:2,d=u(this.root,t),s=d[0],c=d[1];if(s===this.root)return this;for(var l=c===3?void 0:s,f=0;f<a.length;f+=1)SM(a[f],function(p,m){return l=c0e(n.lattice,l,Uz(p,m)),!0});return new e(this.lattice,l,this.count-1)},e}();aC.RTree=k7e;function SM(e,r,n,a){var o=n!==void 0?n:function(){return!0},u=a!==void 0?a:function(){return!0};if(e==null)return!0;var t=function d(s){if(!o(s.key))return!0;if(s.kind===YS.Leaf)for(var c=s.value,l=0;l<c.length;l+=1){var f=c[l];if(u(f.key)&&!r(f.key,f.value))return!1}else for(var c=s.value,l=0;l<c.length;l+=1)if(!d(c[l]))return!1;return!0};return t(e)}function F7e(e,r,n){for(var a=0,o=e.keyDistance(r[0].key,n),u=r[0].value.length,t=1;t<r.length;t+=1){var d=r[t],s=e.keyDistance(d.key,n);(s<o||s===o&&d.value.length<u)&&(a=t,o=s,u=d.value.length)}return a}function I7e(e,r){for(var n=0,a=1,o=e.keyDistance(r[0].key,r[1].key),u=2;u<r.length;u+=1)for(var t=0;t<u;t+=1){var d=e.keyDistance(r[t].key,r[u].key);d>o&&(n=t,a=u,o=d)}return(0,rm.pair)(n,a)}function M7e(e,r){for(var n=I7e(e,r),a=n[0],o=n[1],u=r[a].key,t=r[o].key,d=[],s=0;s<r.length;s+=1){var c=r[s];d.push([c,e.keyDistance(u,c.key)-e.keyDistance(t,c.key)])}d.sort(function(m,v){return m[1]-v[1]});for(var l=e.minChildren;l<r.length-e.minChildren&&d[l][1]<0;l+=1);for(var f=[],p=[],s=0;s<l;s+=1)f.push(d[s][0]);for(var s=l;s<r.length;s+=1)p.push(d[s][0]);return(0,rm.pair)(f,p)}function N6(e,r){for(var n=r[0].key,a=1;a<r.length;a+=1)n=e.keyJoin(n,r[a].key);return n}function l0e(e,r,n){var a=M7e(e,n),o=a[0],u=a[1];return(0,rm.pair)(yM(r,N6(e,o),o),yM(r,N6(e,u),u))}function c0e(e,r,n){if(r==null)return TA(n.key,[n]);function a(d){if(d.kind===YS.Leaf){var s=s0e.__spreadArray(s0e.__spreadArray([],d.value,!0),[n],!1);if(s.length>e.maxChildren){var c=l0e(e,d.kind,s),l=c[0],f=c[1];return(0,rm.pair)(TA(l.key,l.value),f)}return(0,rm.pair)(TA(e.keyJoin(d.key,n.key),s),void 0)}var p=d.value.slice(),m=F7e(e,p,n.key),v=a(p[m]),h=v[0],S=v[1];if(p[m]=h,S!=null&&(p.push(S),p.length>e.maxChildren)){var y=l0e(e,d.kind,p),C=y[0],f=y[1];return(0,rm.pair)(Db(C.key,C.value),f)}return(0,rm.pair)(Db(e.keyJoin(d.key,n.key),p),void 0)}var o=a(r),u=o[0],t=o[1];return t!=null?Db(e.keyJoin(u.key,t.key),[u,t]):u}function d0e(e,r,n,a,o){if(r===void 0)return;function u(d){if(e.keyCompare(d.key,n)===0)return o===void 0||d.value===o||!a(d.value)?d:Uz(d.key,o)}function t(d){if(d.kind===YS.Leaf){for(var s=0;s<d.value.length;s+=1){var c=d.value[s],l=u(c);if(l!==void 0)return TA(d.key,RA(d.value,s,l))}return}for(var s=0;s<d.value.length;s+=1){var c=d.value[s];if(e.keyMeets(c.key,n)){var l=t(c);if(l!==void 0)return Db(d.key,RA(d.value,s,l))}}}return t(r)}});var g0e=Y(X_=>{"use strict";_();Object.defineProperty(X_,"__esModule",{value:!0});X_.boundedParetoSetOperations=X_.boundedParetoSplitter=X_.boundedPareto=void 0;var A6=tv(),bA=Az();function p0e(e,r,n){var a=Math.pow(r,e),o=1-Math.pow(r/n,e),u=Math.pow(n,e),t=u*a,d=u-a,s=-1/e,c=e===1?function(f){return(1-a/f)/o}:function(f){return(1-a*Math.pow(f,-e))/o},l=e===1?function(f){return 1/((u-f*d)/t)}:function(f){return Math.pow((u-f*d)/t,s)};return{cdf:c,invCdf:l}}X_.boundedPareto=p0e;function m0e(e,r,n){var a=p0e(e,r,n);return{canSplit:function(u){var t=u[0],d=u[1];return d-t>1},split:function(u){var t=u[0],d=u[1],s=a.cdf(d),c=a.cdf(t+1),l=a.invCdf((s+c)/2),f=(0,A6.fastMin)((0,A6.fastMax)(Math.round(l),t+1),d-1),p=a.cdf(f)-a.cdf(t+1),m=a.cdf(d)-a.cdf(f),v=[[[t,f],p],[[f,d],m]];return v}}}X_.boundedParetoSplitter=m0e;function w7e(e,r,n,a,o){var u=m0e(e,r,n);return{id:o,split:function(d){return u.split(d)},canSplit:function(d){return u.canSplit(d)},meets:bA.ivlMeets,intersect:bA.ivlMeet,union:function(d,s){return(0,bA.ivlMeetsOrTouches)(d,s)?(0,bA.ivlJoin)(d,s):void 0},except:bA.ivlExcept,compare:bA.ivlCompare,top:a,infimum:function(d){var s=d[0];return s},supremum:function(d){var s=d[1];return s},combineInfima:function(d,s){return(0,A6.fastMin)(d,s)},combineSuprema:function(d,s){return(0,A6.fastMax)(d,s)}}}X_.boundedParetoSetOperations=w7e});var C0e=Y(Eo=>{"use strict";_();Object.defineProperty(Eo,"__esModule",{value:!0});Eo.broadcastArray2D=Eo.broadcastArray=Eo.colArray2D=Eo.rowArray2D=Eo.singletonArray2D=Eo.constantArray2D=Eo.constantArray=Eo.array2DToJaggedArray=Eo.jaggedArray=Eo.array2DForall2=Eo.array2DForall=Eo.NonstrictSparseArray2D=Eo.NonstrictArray2D=Eo.StrictSparseArray2D=Eo.strictArray2D=Eo.StrictArray2D=void 0;var cl=$y(),v0e=tv(),Gz=function(){function e(r,n,a){(0,cl.assertNatural)("calc.common.StrictArray2D",r),(0,cl.assertNatural)("calc.common.StrictArray2D",n);var o=a.length;o<r&&(0,cl.assertFalse)("calc.common.StrictArray2D: expected elements.length >= ".concat(r,"; given ").concat(o));for(var u=0;u<o;u+=1){var t=a[u].length;t<n&&(0,cl.assertFalse)("calc.common.StrictArray2D: expected elements[".concat(u,"].length >= ").concat(r,"; given ").concat(t))}this.rows=r,this.cols=n,this.elements=a}return e.prototype.get=function(r,n){return(0,cl.assertIndex)("calc.common.StrictArray2D.get",r,this.rows),(0,cl.assertIndex)("calc.common.StrictArray2D.get",n,this.cols),this.elements[r][n]},e.prototype.strict=function(){return this},e.prototype.map=function(r){var n=this;return new Z_(this.rows,this.cols,function(a,o){return r(n.elements[a][o])})},e}();Eo.StrictArray2D=Gz;function D7e(e,r,n){return new Gz(e,r,n)}Eo.strictArray2D=D7e;var h0e=function(){function e(r,n,a,o,u,t){(0,cl.assertNatural)("calc.common.StrictSparseArray2D",r),(0,cl.assertNatural)("calc.common.StrictSparseArray2D",n),(0,cl.assertIndex)("calc.common.StrictSparseArray2D",a,r+1),(0,cl.assertIndex)("calc.common.StrictSparseArray2D",o,n+1);var d=u.length;d<a&&(0,cl.assertFalse)("calc.common.StrictSparseArray2D: expected elements.length >= ".concat(a,"; given ").concat(d));for(var s=0;s<d;s+=1){var c=u[s].length;c<o&&(0,cl.assertFalse)("calc.common.StrictSparseArray2D: expected elements[".concat(s,"].length >= ").concat(o,"; given ").concat(c))}this.rows=r,this.cols=n,this.denseRows=a,this.denseCols=o,this.denseElements=u,this.sparseElement=t}return e.prototype.get=function(r,n){return(0,cl.assertIndex)("calc.common.StrictSparseArray2D.get",r,this.rows),(0,cl.assertIndex)("calc.common.StrictSparseArray2D.get",n,this.cols),r<this.denseRows&&n<this.denseCols?this.denseElements[r][n]:this.sparseElement},e.prototype.getSparse=function(){return this.sparseElement},e.prototype.strict=function(){return this},e.prototype.map=function(r){var n=this;return new S0e(this.rows,this.cols,this.denseRows,this.denseCols,function(a,o){return r(n.denseElements[a][o])},function(){return r(n.sparseElement)})},e}();Eo.StrictSparseArray2D=h0e;var Z_=function(){function e(r,n,a){(0,cl.assertNatural)("calc.common.NonstrictArray2D",r),(0,cl.assertNatural)("calc.common.NonstrictArray2D",n),this.rows=r,this.cols=n,this.func=a}return e.prototype.get=function(r,n){return(0,cl.assertIndex)("calc.common.NonstrictArray2D.get",r,this.rows),(0,cl.assertIndex)("calc.common.NonstrictArray2D.get",n,this.cols),this.func(r,n)},e.prototype.strict=function(){var r=O6(this.rows,this.cols,this.func);return new Gz(this.rows,this.cols,r)},e.prototype.map=function(r){var n=this;return new e(this.rows,this.cols,function(a,o){return r(n.func(a,o))})},e}();Eo.NonstrictArray2D=Z_;var S0e=function(){function e(r,n,a,o,u,t){(0,cl.assertNatural)("calc.common.NonstrictSparseArray2D",r),(0,cl.assertNatural)("calc.common.NonstrictSparseArray2D",n),(0,cl.assertIndex)("calc.common.NonstrictSparseArray2D",a,r+1),(0,cl.assertIndex)("calc.common.NonstrictSparseArray2D",o,n+1),this.rows=r,this.cols=n,this.denseRows=a,this.denseCols=o,this.denseFunc=u,this.sparseFunc=t}return e.prototype.get=function(r,n){return(0,cl.assertIndex)("calc.common.NonstrictSparseArray2D.get",r,this.rows),(0,cl.assertIndex)("calc.common.NonstrictSparseArray2D.get",n,this.cols),r<this.denseRows&&n<this.denseCols?this.denseFunc(r,n):this.sparseFunc()},e.prototype.getSparse=function(){return this.sparseFunc()},e.prototype.strict=function(){var r=O6(this.denseRows,this.denseCols,this.denseFunc),n=this.sparseFunc();return new h0e(this.rows,this.cols,this.denseRows,this.denseCols,r,n)},e.prototype.map=function(r){var n=this;return new e(this.rows,this.cols,this.denseRows,this.denseCols,function(a,o){return r(n.denseFunc(a,o))},function(){return r(n.sparseFunc())})},e}();Eo.NonstrictSparseArray2D=S0e;function x7e(e,r){for(var n=0;n<r.rows;n+=1)for(var a=0;a<r.cols;a+=1)if(!e(r.get(n,a)))return!1;return!0}Eo.array2DForall=x7e;function L7e(e,r,n){for(var a=(0,v0e.fastMin)(r.rows,n.rows),o=(0,v0e.fastMin)(r.cols,n.cols),u=0;u<a;u+=1)for(var t=0;t<o;t+=1)if(!e(r.get(u,t),n.get(u,t)))return!1;return!0}Eo.array2DForall2=L7e;function O6(e,r,n){for(var a=[],o=0;o<e;o+=1){for(var u=[],t=0;t<r;t+=1)u[t]=n(o,t);a[o]=u}return a}Eo.jaggedArray=O6;function B7e(e){return O6(e.rows,e.cols,e.get.bind(e))}Eo.array2DToJaggedArray=B7e;function y0e(e,r,n){for(var a=[],o=[],u=0;u<r;u+=1)o[u]=n;for(var t=0;t<e;t+=1)a[t]=o;return a}Eo.constantArray=y0e;function Kz(e,r,n){return new Z_(e,r,function(a,o){return n})}Eo.constantArray2D=Kz;function q7e(e){return Kz(1,1,e)}Eo.singletonArray2D=q7e;function U7e(e){return new Z_(1,e.length,function(r,n){return e[n]})}Eo.rowArray2D=U7e;function G7e(e){return new Z_(e.length,1,function(r,n){return e[r]})}Eo.colArray2D=G7e;function K7e(e,r,n,a,o,u){if(e===n&&r===a)return o;if(e===1&&r===1)return y0e(n,a,o[0]===void 0?u:o[0][0]);var t=[],d;e===1?d=function(f,p){return p<r?o[0][p]:u}:r===1?d=function(f,p){return f<e?o[f][0]:u}:d=function(f,p){return f<e&&p<r?o[f][p]:u};for(var s=0;s<n;s+=1){t.push([]);for(var c=0;c<a;c+=1)t[s][c]=d(s,c)}return t}Eo.broadcastArray=K7e;function V7e(e,r,n,a){return n.rows===e&&n.cols===r?n:n.rows===1&&n.cols===1?Kz(e,r,n.get(0,0)):n.rows===1?new Z_(e,r,function(o,u){return u<n.cols?n.get(0,u):a}):n.cols===1?new Z_(e,r,function(o,u){return o<n.rows?n.get(o,0):a}):new Z_(e,r,function(o,u){return o<n.rows&&u<n.cols?n.get(o,u):a})}Eo.broadcastArray2D=V7e});var R0e=Y(_0e=>{"use strict";_();Object.defineProperty(_0e,"__esModule",{value:!0})});var CM=Y(Qc=>{"use strict";_();Object.defineProperty(Qc,"__esModule",{value:!0});Qc.MaybeThenable=Qc.collapseThenable=Qc.bindMaybeThenable=Qc.isThenable=Qc.promiseLoop=Qc.newPromise=Qc.promiseFinally=Qc.ResolvablePromiseWithTimeout=Qc.ResolvablePromise=void 0;var W7e=br(),j7e=tv(),k6=function(){function e(){var r=this;this.promise=new Promise(function(n,a){r._resolve=n,r._reject=a})}return e.prototype.then=function(r,n){return this.promise.then(r,n)},e.prototype.toPromise=function(){return this.promise},e.prototype.resolve=function(r){return this._resolve(r),PA(r)?this.promise.then():void 0},e.prototype.reject=function(r){return this._reject(r),PA(r)?this.promise.then():void 0},e}();Qc.ResolvablePromise=k6;var H7e=function(e){W7e.__extends(r,e);function r(n,a){var o=e.call(this)||this;return a.setTimeout(function(){var u=new Error("Promise timeout");u.name="TimeoutError",o.reject(u)},n),o}return r}(k6);Qc.ResolvablePromiseWithTimeout=H7e;function Q7e(e,r){return e.then(function(n){return r(),n},function(n){return r(),Promise.reject(n)})}Qc.promiseFinally=Q7e;function z7e(){var e,r=new Promise(function(n,a){return e=[n,a]});return[r,e]}Qc.newPromise=z7e;function Y7e(e,r){var n;return new Promise(function(a,o){function u(t){if(t!==void 0){n=t;try{Promise.resolve(e(n)).then(u,o)}catch(d){o(d)}}else a(n)}Promise.resolve(r).then(u,o)})}Qc.promiseLoop=Y7e;function PA(e){return(0,j7e.isDefined)(e)&&typeof e.then=="function"}Qc.isThenable=PA;function J7e(e,r,n){return PA(e)?e.then(r,n):r(e)}Qc.bindMaybeThenable=J7e;function X7e(e){return e}Qc.collapseThenable=X7e;Qc.MaybeThenable={all:function(r){var n=new Array(r.length),a=new k6,o=0;return r.forEach(function(u,t){PA(u)?u.then(function(d){n[t]=d,++o===r.length&&a.resolve(n)},function(d){a.reject(d)}):n[t]=u}),a},any:function(r){var n=new k6;return r.forEach(function(a,o){if(PA(a))a.then(function(u){n.resolve({result:u,resolvedIndex:o})},function(u){n.reject(u)});else return n.resolve({result:a,resolvedIndex:o})}),n}}});var Wz=Y($_=>{"use strict";_();Object.defineProperty($_,"__esModule",{value:!0});$_.defaultSetTimeoutInterface=$_.clearTimerUnified=$_.setImmediateUnified=void 0;var T0e=br(),Z7e=$y();function $7e(e,r){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];return{kind:"Timeout",timer:setTimeout.apply(void 0,T0e.__spreadArray([e,r],n,!1))}}function b0e(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return{kind:"Immediate",timer:setImmediate.apply(void 0,T0e.__spreadArray([e],r,!1))}}$_.setImmediateUnified=b0e;function Vz(e){switch(e.kind){case"Immediate":clearImmediate(e.timer);break;case"Timeout":clearTimeout(e.timer);break;case"Mocking":e.delayedCallback.isValid=!1;break;default:(0,Z7e.assertNever)("unknown timer.kind",e)}}$_.clearTimerUnified=Vz;$_.defaultSetTimeoutInterface={setImmediate:b0e,setTimeout:$7e,clearImmediate:Vz,clearTimeout:Vz}});var N0e=Y(eR=>{"use strict";_();Object.defineProperty(eR,"__esModule",{value:!0});eR.asyncLoop=eR.asyncLoopFactory=eR.delayPromiseImpl=void 0;var jz=tv(),eVe=CM(),rVe=Wz();function P0e(e){return function(r){return new Promise(function(n){return e.setTimeout(n,r,void 0)})}}eR.delayPromiseImpl=P0e;function E0e(e){return function(r,n){var a,o,u,t=(a=n==null?void 0:n.timeThreshold)!==null&&a!==void 0?a:10,d=(o=n==null?void 0:n.costThreshold)!==null&&o!==void 0?o:1,s=(u=n==null?void 0:n.macrotaskDelay)!==null&&u!==void 0?u:0,c={iterations:0,microtaskContinues:0,macrotaskContinues:0,macrotaskTotalDelay:0},l=(0,eVe.newPromise)(),f=l[0],p=l[1],m=p[0],v=p[1];function h(){try{for(var F=0;F<d;){c.iterations+=1;var w=r();if(w===void 0)return!1;F+=w}return!0}catch(B){return v(B),!1}}var S=!0;function y(){S=!1}var C=e(s),E=(0,jz.now)();function I(){if(!S||!h())return m();var F=(0,jz.now)();F-E<t?(Promise.resolve().then(I),c.microtaskContinues+=1):(C.then(function(){C=e(s),E=(0,jz.now)(),c.macrotaskTotalDelay+=E-F,I()}),c.macrotaskContinues+=1)}return I(),{promise:f,stop:y,stats:c}}}eR.asyncLoopFactory=E0e;eR.asyncLoop=E0e(P0e(rVe.defaultSetTimeoutInterface))});var A0e=Y(Ue=>{"use strict";_();Object.defineProperty(Ue,"__esModule",{value:!0});Ue.codePointCapitalD=Ue.codePointCapitalC=Ue.codePointCapitalB=Ue.codePointCapitalA=Ue.codePointTilde=Ue.codePointRightCurlyBracket=Ue.codePointPipe=Ue.codePointLeftCurlyBracket=Ue.codePointBacktick=Ue.codePointUnderscore=Ue.codePointCircumflexAccent=Ue.codePointRightSquareBracket=Ue.codePointBackslash=Ue.codePointLeftSquareBracket=Ue.codePointAtSign=Ue.codePointQuestionMark=Ue.codePointGreaterThanSign=Ue.codePointEqualsSign=Ue.codePointLessThanSign=Ue.codePointSemicolon=Ue.codePointColon=Ue.codePointDigitNine=Ue.codePointDigitEight=Ue.codePointDigitSeven=Ue.codePointDigitSix=Ue.codePointDigitFive=Ue.codePointDigitFour=Ue.codePointDigitThree=Ue.codePointDigitTwo=Ue.codePointDigitOne=Ue.codePointDigitZero=Ue.codePointSlash=Ue.codePointFullStop=Ue.codePointMinusSign=Ue.codePointComma=Ue.codePointPlusSign=Ue.codePointAsterisk=Ue.codePointRightParen=Ue.codePointLeftParen=Ue.codePointSingleQuote=Ue.codePointAmpersand=Ue.codePointPercentSign=Ue.codePointDollarSign=Ue.codePointHash=Ue.codePointDoubleQuote=Ue.codePointExclamationMark=Ue.codePointSpace=Ue.codePointCR=Ue.codePointLF=Ue.codePointTab=void 0;Ue.codePointThaiDigitNine=Ue.codePointThaiDigitZero=Ue.codePointSmallZ=Ue.codePointSmallY=Ue.codePointSmallX=Ue.codePointSmallW=Ue.codePointSmallV=Ue.codePointSmallU=Ue.codePointSmallT=Ue.codePointSmallS=Ue.codePointSmallR=Ue.codePointSmallQ=Ue.codePointSmallP=Ue.codePointSmallO=Ue.codePointSmallN=Ue.codePointSmallM=Ue.codePointSmallL=Ue.codePointSmallK=Ue.codePointSmallJ=Ue.codePointSmallI=Ue.codePointSmallH=Ue.codePointSmallG=Ue.codePointSmallF=Ue.codePointSmallE=Ue.codePointSmallD=Ue.codePointSmallC=Ue.codePointSmallB=Ue.codePointSmallA=Ue.codePointCapitalZ=Ue.codePointCapitalY=Ue.codePointCapitalX=Ue.codePointCapitalW=Ue.codePointCapitalV=Ue.codePointCapitalU=Ue.codePointCapitalT=Ue.codePointCapitalS=Ue.codePointCapitalR=Ue.codePointCapitalQ=Ue.codePointCapitalP=Ue.codePointCapitalO=Ue.codePointCapitalN=Ue.codePointCapitalM=Ue.codePointCapitalL=Ue.codePointCapitalK=Ue.codePointCapitalJ=Ue.codePointCapitalI=Ue.codePointCapitalH=Ue.codePointCapitalG=Ue.codePointCapitalF=Ue.codePointCapitalE=void 0;Ue.codePointInvertedQuestionMark=Ue.codePointInvertedExclamationMark=Ue.codePointRightSingleQuotationMark=Ue.codePointLeftSingleQuotationMark=Ue.codePointEuroSign=Ue.codePointFullwidthLatinSmallZ=Ue.codePointFullwidthLatinSmallA=Ue.codePointFullwidthLatinCapitalZ=Ue.codePointFullwidthLatinCapitalA=Ue.codePointFullwidthDigitNine=Ue.codePointFullwidthDigitZero=void 0;Ue.codePointTab=9;Ue.codePointLF=10;Ue.codePointCR=13;Ue.codePointSpace=32;Ue.codePointExclamationMark=33;Ue.codePointDoubleQuote=34;Ue.codePointHash=35;Ue.codePointDollarSign=36;Ue.codePointPercentSign=37;Ue.codePointAmpersand=38;Ue.codePointSingleQuote=39;Ue.codePointLeftParen=40;Ue.codePointRightParen=41;Ue.codePointAsterisk=42;Ue.codePointPlusSign=43;Ue.codePointComma=44;Ue.codePointMinusSign=45;Ue.codePointFullStop=46;Ue.codePointSlash=47;Ue.codePointDigitZero=48;Ue.codePointDigitOne=49;Ue.codePointDigitTwo=50;Ue.codePointDigitThree=51;Ue.codePointDigitFour=52;Ue.codePointDigitFive=53;Ue.codePointDigitSix=54;Ue.codePointDigitSeven=55;Ue.codePointDigitEight=56;Ue.codePointDigitNine=57;Ue.codePointColon=58;Ue.codePointSemicolon=59;Ue.codePointLessThanSign=60;Ue.codePointEqualsSign=61;Ue.codePointGreaterThanSign=62;Ue.codePointQuestionMark=63;Ue.codePointAtSign=64;Ue.codePointLeftSquareBracket=91;Ue.codePointBackslash=92;Ue.codePointRightSquareBracket=93;Ue.codePointCircumflexAccent=94;Ue.codePointUnderscore=95;Ue.codePointBacktick=96;Ue.codePointLeftCurlyBracket=123;Ue.codePointPipe=124;Ue.codePointRightCurlyBracket=125;Ue.codePointTilde=126;Ue.codePointCapitalA=65;Ue.codePointCapitalB=66;Ue.codePointCapitalC=67;Ue.codePointCapitalD=68;Ue.codePointCapitalE=69;Ue.codePointCapitalF=70;Ue.codePointCapitalG=71;Ue.codePointCapitalH=72;Ue.codePointCapitalI=73;Ue.codePointCapitalJ=74;Ue.codePointCapitalK=75;Ue.codePointCapitalL=76;Ue.codePointCapitalM=77;Ue.codePointCapitalN=78;Ue.codePointCapitalO=79;Ue.codePointCapitalP=80;Ue.codePointCapitalQ=81;Ue.codePointCapitalR=82;Ue.codePointCapitalS=83;Ue.codePointCapitalT=84;Ue.codePointCapitalU=85;Ue.codePointCapitalV=86;Ue.codePointCapitalW=87;Ue.codePointCapitalX=88;Ue.codePointCapitalY=89;Ue.codePointCapitalZ=90;Ue.codePointSmallA=97;Ue.codePointSmallB=98;Ue.codePointSmallC=99;Ue.codePointSmallD=100;Ue.codePointSmallE=101;Ue.codePointSmallF=102;Ue.codePointSmallG=103;Ue.codePointSmallH=104;Ue.codePointSmallI=105;Ue.codePointSmallJ=106;Ue.codePointSmallK=107;Ue.codePointSmallL=108;Ue.codePointSmallM=109;Ue.codePointSmallN=110;Ue.codePointSmallO=111;Ue.codePointSmallP=112;Ue.codePointSmallQ=113;Ue.codePointSmallR=114;Ue.codePointSmallS=115;Ue.codePointSmallT=116;Ue.codePointSmallU=117;Ue.codePointSmallV=118;Ue.codePointSmallW=119;Ue.codePointSmallX=120;Ue.codePointSmallY=121;Ue.codePointSmallZ=122;Ue.codePointThaiDigitZero=3664;Ue.codePointThaiDigitNine=3673;Ue.codePointFullwidthDigitZero=65296;Ue.codePointFullwidthDigitNine=65305;Ue.codePointFullwidthLatinCapitalA=65313;Ue.codePointFullwidthLatinCapitalZ=65338;Ue.codePointFullwidthLatinSmallA=65345;Ue.codePointFullwidthLatinSmallZ=65370;Ue.codePointEuroSign=8364;Ue.codePointLeftSingleQuotationMark=8216;Ue.codePointRightSingleQuotationMark=8217;Ue.codePointInvertedExclamationMark=161;Ue.codePointInvertedQuestionMark=191});var EA=Y(rR=>{_();Object.defineProperty(rR,"__esModule",{value:!0});rR.asError=tVe;rR.encodeError=Qz;rR.encodeResultValue=aVe;rR.encodeWorkerErrorInfo=k0e;rR.isError=F6;rR.isWorkerError=Hz;var O0e=br();function Hz(e){return F6(e)&&e.name==="WorkerError"&&typeof e.info=="object"}function F6(e){if(e==null)return!1;if(e instanceof Error)return!0;var r=e;return typeof r.name=="string"&&typeof r.message=="string"&&(r.stack==null||typeof r.stack=="string")}function nVe(e){var r=typeof e;switch(r){case"function":case"symbol":case"undefined":return"<".concat(r,">");case"object":return JSON.stringify(e);default:return"".concat(e)}}function tVe(e){return F6(e)?e:new Error("(non-Error object) ".concat(nVe(e)))}function k0e(e){return(0,O0e.__assign)((0,O0e.__assign)({},e),{error:e.error?Qz(e.error):void 0})}function Qz(e){return{name:e.name,message:Hz(e)?e.baseMessage:e.message,stack:e.stack,info:Hz(e)?k0e(e.info):void 0}}function aVe(e){return F6(e)?{isError:!0,value:Qz(e)}:{isError:!1,value:e}}});var NA=Y(JS=>{_();Object.defineProperty(JS,"__esModule",{value:!0});JS.WorkerError=void 0;JS.decodeError=Yz;JS.decodeResultValue=oVe;JS.decodeWorkerErrorInfo=I0e;JS.getErrorEventWorkerError=iVe;JS.knownErrorClasses=void 0;var _M=br(),zz=EA(),RM=function(e){(0,_M.__extends)(r,e);function r(n,a){var o=this.constructor,u=this,t;u=e.call(this,"".concat(n,"; info = ").concat(JSON.stringify((0,_M.__assign)((0,_M.__assign)({},a),{error:(t=a.error)===null||t===void 0?void 0:t.message}))))||this,u.baseMessage=n,u.info=a,u.name="WorkerError";var d=o.prototype;return Object.getPrototypeOf(u)!==d&&(Object.setPrototypeOf!=null?Object.setPrototypeOf(u,d):u.__proto__=d),u}return r.isWorkerError=zz.isWorkerError,r}(Error);JS.WorkerError=RM;function iVe(e,r,n){if((0,zz.isError)(n.error)){if((0,zz.isWorkerError)(n.error))return n.error;var a={cause:"UnhandledError",idInfo:e,error:n.error};return new RM("".concat(r," received an unhandled error"),a)}if(n.message==null){var o={cause:"UnhandledError",idInfo:e};return new RM("".concat(r," received a non-error (worker script fetch probably failed)"),o)}var u={cause:"UnhandledError",idInfo:e},t="".concat(n.message," at ").concat(n.filename,":").concat(n.lineno,":").concat(n.colno);return new RM("".concat(r," received an unhandled error: ").concat(t),u)}var F0e={Error,EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError};JS.knownErrorClasses=F0e;function Yz(e){var r;if(e.name==="WorkerError")r=new RM(e.message,I0e(e.info));else{var n=F0e[e.name];n?r=new n(e.message):(r=new Error(e.message),r.name=e.name)}return e.stack!=null&&(r.stack=e.stack),r}function I0e(e){return(0,_M.__assign)((0,_M.__assign)({},e),{error:e.error?Yz(e.error):void 0})}function oVe(e){return e.isError?Yz(e.value):e.value}});var AA=Y(iC=>{_();Object.defineProperty(iC,"__esModule",{value:!0});iC.dispatchCreateWorker=SVe;iC.dispatchWorkerError=vVe;iC.getCreateMode=mVe;iC.getCreateTimeout=pVe;iC.getSafeParams=fVe;iC.isThreadingSupported=M0e;iC.setConfig=dVe;var uVe=br(),sVe=EA(),lVe=3e5,cVe="Thread";function M0e(){return typeof Blob!="undefined"&&typeof URL!="undefined"&&URL.createObjectURL!==void 0&&URL.revokeObjectURL!==void 0&&typeof Worker!="undefined"}var Jf;function dVe(e){if(Jf)throw new TypeError("setConfig has already been called");Jf=e}function fVe(){var e=Jf??{};return{createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls?(0,uVe.__spreadArray)([],e.importScriptUrls,!0):void 0,typedWorkersUrl:e.typedWorkersUrl,typedWorkersName:e.typedWorkersName,importScriptsMaxRetries:e.importScriptsMaxRetries}}function pVe(e){var r,n;return(n=(r=e==null?void 0:e.createTimeout)!==null&&r!==void 0?r:Jf==null?void 0:Jf.createTimeout)!==null&&n!==void 0?n:lVe}function mVe(e){var r,n,a=(n=(r=e==null?void 0:e.createMode)!==null&&r!==void 0?r:Jf==null?void 0:Jf.createMode)!==null&&n!==void 0?n:cVe;return a==="ThreadOrLocal"?M0e()?"Thread":"Local":a}function w0e(e){setTimeout(function(){throw e})}function D0e(){return typeof self!="undefined"&&"__typed_workers_thread"in self?self:void 0}function gVe(e){var r=D0e();if(r!==void 0){var n={kind:1,error:(0,sVe.encodeResultValue)(e)};r.postMessage(n)}else console.warn(e)}function vVe(e){var r;try{((r=Jf==null?void 0:Jf.onWorkerError)!==null&&r!==void 0?r:gVe)(e)}catch(n){console.warn(e),w0e(n)}}function hVe(e){var r=D0e();if(r!==void 0){var n={kind:2,stats:e};r.postMessage(n)}}function SVe(e){var r;try{((r=Jf==null?void 0:Jf.onCreateWorker)!==null&&r!==void 0?r:hVe)(e)}catch(n){w0e(n)}}});var I6=Y(TM=>{_();Object.defineProperty(TM,"__esModule",{value:!0});TM.indexObject=_Ve;TM.paramInsideDef=void 0;var yVe=br();function CVe(e){throw new ReferenceError("".concat(e," is not defined"))}function _Ve(e,r,n){n===void 0&&(n=CVe);try{for(var a=r.split("."),o=0,u=a;o<u.length;o++){var t=u[o];e=e[t]}return e??n(r)}catch(d){return n(r)}}var x0e=function e(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];return e.transfer.apply(e,(0,yVe.__spreadArray)([r,void 0],n,!1))};TM.paramInsideDef=x0e;x0e.transfer=function(e,r){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];return{def:e,args:n,transferables:r??[]}}});var B0e=Y(OA=>{_();Object.defineProperty(OA,"__esModule",{value:!0});OA.isTypedChangeGateEnabled=OA.getTypedFeatureGate=void 0;var L0e=Ql(),RVe=(0,L0e.makeTypedIsChangeGateEnabled)(["OfficeVSO:WINum_CGExample","OfficeVSO:5592319_TypedWorkersProxyPromiseFix"]);OA.isTypedChangeGateEnabled=RVe;var TVe=(0,L0e.makeGetTypedFeatureGate)({"Microsoft.Office.Shared.FGExample":!0});OA.getTypedFeatureGate=TVe});var bM=Y(XS=>{_();Object.defineProperty(XS,"__esModule",{value:!0});XS.createEmptyRecord=Jz;XS.createObjectFromFunction=kVe;XS.getFunctionPropertyNames=NVe;XS.haveNativeProxy=AVe;XS.maxTimeout=void 0;XS.promiseFinally=PVe;XS.setCallbacksTimeout=EVe;var bVe=B0e();function PVe(e,r){return e.then(function(n){return r(),n},function(n){return r(),Promise.reject(n)})}var q0e=1073741824;XS.maxTimeout=q0e;function EVe(e,r,n){if(e>q0e)return n;var a=setTimeout(r,Math.max(0,e));return{resolve:function(u){clearTimeout(a),n.resolve(u)},reject:function(u){clearTimeout(a),n.reject(u)}}}function Jz(){var e=Object.create(null);return e.key=void 0,delete e.key,e}function NVe(e){for(var r=Jz();e!=null;){for(var n=0,a=Object.getOwnPropertyNames(e);n<a.length;n++){var o=a[n];try{typeof e[o]=="function"&&(r[o]=!0)}catch(u){}}e=Object.getPrototypeOf(e)}return Object.getOwnPropertyNames(r)}var M6;function AVe(){return M6??(M6=OVe())}function OVe(){try{return typeof Proxy=="function"&&new Proxy({},{get:function(){return!0}}).k===!0}catch(e){return!1}}function kVe(e,r){var n=Jz(),a=(0,bVe.isTypedChangeGateEnabled)("OfficeVSO:5592319_TypedWorkersProxyPromiseFix")?function(o,u){var t;return u==="then"?void 0:(t=o[u])!==null&&t!==void 0?t:o[u]=e(u)}:function(o,u){var t;return(t=o[u])!==null&&t!==void 0?t:o[u]=e(u)};return r?(r.forEach(function(o){return a(n,o)}),n):new Proxy(n,{get:a})}});var G0e=Y(EM=>{_();Object.defineProperty(EM,"__esModule",{value:!0});EM.EndpointState=void 0;EM.throwWorkerError=U0e;var w6=br(),D6=AA(),PM=EA(),Gh=NA(),xb=bM();function U0e(e){throw e}var FVe=-1,IVe=function(){function e(r,n){var a,o,u=this;this.idInfo=r,this.port=n,this.isClosed=!1,this.exports={},this.unresolvedCalls=(0,xb.createEmptyRecord)();var t=function(f){var p,m=f.funcNames;(p=u.onImports)===null||p===void 0||p.call(u,(0,xb.createObjectFromFunction)(u.createPostProxy.bind(u),m),(0,xb.createObjectFromFunction)(u.createCallProxy.bind(u),m))},d=function(){var f;return(f=u.onClose)===null||f===void 0?void 0:f.call(u)},s=(a={},a[0]=this.onInvoke.bind(this),a[1]=this.onResult.bind(this),a[2]=t,a[3]=d,a),c=(o={},o[0]=this.onSendInvokeFailed.bind(this),o[1]=this.onSendResultFailed.bind(this),o[2]=d,o[3]=d,o);this.port.onmessage=function(l){var f=l.data;return s[f.kind](f)},this.port.onmessageerror=function(l){var f=l.data;return c[f.kind](f)}}return e.prototype.setExports=function(r){this.exports=r;var n=(0,xb.haveNativeProxy)()?void 0:(0,xb.getFunctionPropertyNames)(r),a={kind:2,funcNames:n};this.port.postMessage(a)},e.prototype.close=function(){if(!this.isClosed){this.isClosed=!0;var r={kind:3};this.port.postMessage(r),this.port.close();for(var n in this.unresolvedCalls){var a=this.unresolvedCalls[n],o=a.reject,u=a.funcName,t={cause:"Connection",idInfo:this.idInfo,funcName:u},d=new Gh.WorkerError("Importing Endpoint closed while waiting for ".concat(u," result"),t);o(d)}}},e.prototype.onInvoke=function(r){var n=this,a=r.callId,o=r.funcName,u=r.args,t=Promise.resolve().then(function(){var d=n.exports[o];if(d)return d.apply(n.exports,u);var s=a>=0?"call":"post",c={cause:"Connection",idInfo:n.idInfo,callId:a,funcName:o};throw new Gh.WorkerError("Exporting Endpoint received a ".concat(s," to unknown function ").concat(o),c)});a>=0?t.then(function(d){return n.sendResult(a,o,!0,d)},function(d){return n.sendResult(a,o,!1,d)}):t.catch(function(d){var s=(0,PM.asError)(d),c={cause:"UnhandledError",idInfo:n.idInfo,error:s,callId:a,funcName:o};(0,D6.dispatchWorkerError)(new Gh.WorkerError("Exporting Endpoint's ".concat(o," implementation threw or rejected"),c))})},e.prototype.sendResult=function(r,n,a,o){var u=(0,PM.encodeResultValue)(o),t={kind:1,callId:r,funcName:n,isFulfilled:a,resultValue:u};try{this.port.postMessage(t,void 0)}catch(d){this.onSendResultFailed(t,(0,PM.asError)(d))}},e.prototype.onSendResultFailed=function(r,n){var a=r.callId,o=r.funcName,u=r.resultValue,t=n?"Exporting Endpoint failed to send ".concat(o," result"):"Importing Endpoint failed to deserialize ".concat(o," result"),d={cause:"MessageError",idInfo:this.idInfo,error:n,callId:a,funcName:o},s=new Gh.WorkerError(t,d);u.isError?(0,D6.dispatchWorkerError)(s):this.sendResult(a,o,!1,s)},e.prototype.takeCallbacks=function(r){var n=this.unresolvedCalls[r];return n&&delete this.unresolvedCalls[r],n},e.prototype.setCallTimeout=function(r,n,a,o){var u=this;if(a>xb.maxTimeout)return o;var t=function(){var s=u.takeCallbacks(r);if(s){var c={cause:"Timeout",idInfo:u.idInfo,timeout:a,callId:r,funcName:n};s.reject(new Gh.WorkerError("Importing Endpoint's call to ".concat(n," timed out"),c))}};return(0,xb.setCallbacksTimeout)(a,t,o)},e.prototype.sendCall=function(r,n,a,o){var u=this;return new Promise(function(t,d){var s=FVe+=1,c={kind:0,callId:s,funcName:r,args:n};u.unresolvedCalls[s]=(0,w6.__assign)((0,w6.__assign)({},u.setCallTimeout(s,r,a,{resolve:t,reject:d})),{funcName:r});try{u.port.postMessage(c,o)}catch(m){var l=u.takeCallbacks(s);if(l){var f=(0,PM.asError)(m),p={cause:"MessageError",idInfo:u.idInfo,error:f,callId:s,funcName:r};l.reject(new Gh.WorkerError("Importing Endpoint failed to send call to ".concat(r),p))}}})},e.prototype.sendPost=function(r,n,a,o){var u={kind:0,callId:-1,funcName:r,args:n};try{this.port.postMessage(u,o)}catch(s){var t=(0,PM.asError)(s),d={cause:"MessageError",idInfo:this.idInfo,error:t,callId:-1,funcName:r};a(new Gh.WorkerError("Importing Endpoint failed to post to ".concat(r),d))}},e.prototype.onSendInvokeFailed=function(r){var n,a=r.callId,o=r.funcName,u=a>=0?"call":"post",t={cause:"MessageError",idInfo:this.idInfo,callId:a,funcName:o},d=new Gh.WorkerError("Exporting Endpoint failed to deserialize ".concat(u," to ").concat(o),t),s=a>=0?this.takeCallbacks(a):void 0,c=(n=s==null?void 0:s.reject)!==null&&n!==void 0?n:D6.dispatchWorkerError;c(d)},e.prototype.onResult=function(r){var n=r.callId,a=r.funcName,o=r.isFulfilled,u=r.resultValue;if(n>=0){var t=this.takeCallbacks(n);if(t){var d=o?t.resolve:t.reject;d((0,Gh.decodeResultValue)(u))}}else{var s={cause:"InternalError",idInfo:this.idInfo,callId:n,funcName:a};(0,D6.dispatchWorkerError)(new Gh.WorkerError("Exporting Endpoint sent a result for a post to ".concat(a),s))}},e.prototype.createPostProxy=function(r){var n=this,a=function o(){for(var u=[],t=0;t<arguments.length;t++)u[t]=arguments[t];return o.transfer.apply(o,(0,w6.__spreadArray)([void 0],u,!1))};return a.transfer=function(o){for(var u,t,d,s=[],c=1;c<arguments.length;c++)s[c-1]=arguments[c];if(!n.isClosed){var l=(d=(u=a.onPostMessageError)!==null&&u!==void 0?u:(t=n.getOnPostMessageError)===null||t===void 0?void 0:t.call(n))!==null&&d!==void 0?d:U0e;n.sendPost(r,s,l,o)}},a},e.prototype.createCallProxy=function(r){var n=this,a=function o(){for(var u=[],t=0;t<arguments.length;t++)u[t]=arguments[t];return o.transfer.apply(o,(0,w6.__spreadArray)([void 0],u,!1))};return a.transfer=function(o){for(var u,t,d,s=[],c=1;c<arguments.length;c++)s[c-1]=arguments[c];if(n.isClosed){var l={cause:"Connection",idInfo:n.idInfo,funcName:r};return Promise.reject(new Gh.WorkerError("".concat(n.idInfo.side," Endpoint's call.").concat(r," called after close"),l))}var f=(d=(u=a.callTimeout)!==null&&u!==void 0?u:(t=n.getCallTimeout)===null||t===void 0?void 0:t.call(n))!==null&&d!==void 0?d:1/0;return n.sendCall(r,s,f,o)},a.callTimeout=void 0,a},e}();EM.EndpointState=IVe});var Xz=Y(NM=>{_();Object.defineProperty(NM,"__esModule",{value:!0});NM.Endpoint=void 0;NM.getSafeOptions=DVe;var K0e=AA(),MVe=EA(),x6=NA(),V0e=G0e(),wVe=bM();function DVe(e){return{id:e.id,createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls,importScriptsMaxRetries:e.importScriptsMaxRetries}}var xVe=function(){function e(r,n,a){this.callTimeout=1/0,this.onPostMessageError=V0e.throwWorkerError,this._idInfo=r,this._state=n,this.createMode=a;var o=function(t){return function(){var d=r.side==="Outside"?"inside":"outside",s={cause:"Connection",idInfo:r};throw new x6.WorkerError("".concat(r.side," Endpoint's ").concat(t," referenced before the ").concat(d," Endpoint started"),s)}};Object.defineProperties(this,{post:{configurable:!0,enumerable:!1,get:o("post")},call:{configurable:!0,enumerable:!1,get:o("call")}})}return e._create=function(r,n,a){var o=n.port,u=n.options,t=n.createMode,d={type:"Endpoint",side:r,id:u==null?void 0:u.id},s,c;try{s=new V0e.EndpointState(d,o),c=new e(d,s,t)}catch(l){return Promise.reject(l)}return new Promise(function(l,f){var p;s.getCallTimeout=function(){return c.callTimeout},s.getOnPostMessageError=function(){return c.onPostMessageError},s.onImports=function(S,y){Object.defineProperties(c,{post:{configurable:!0,enumerable:!1,writable:!1,value:S},call:{configurable:!0,enumerable:!1,writable:!1,value:y}}),v.resolve()},s.onClose=function(){return c.close("Force")};var m=(0,K0e.getCreateTimeout)(u),v=(0,wVe.setCallbacksTimeout)(m,function(){var S=r==="Outside"?"inside":"outside",y={cause:"Timeout",idInfo:d,timeout:m},C=new x6.WorkerError("".concat(r," Endpoint timed out waiting for the ").concat(S," to start"),y);v.reject(C)},{resolve:l,reject:f});c._closedDuringCreate=function(){v.resolve()};var h;try{h=a(c)}catch(S){return v.reject(S)}(p=c._state)===null||p===void 0||p.setExports(h)}).then(function(){return c._closedDuringCreate=void 0,c},function(l){return c._closedDuringCreate=void 0,c.close(),Promise.reject(l)})},e.prototype.hasBeenClosed=function(){return this._state===void 0},e.prototype.close=function(r){var n,a;if(this._state){if(this._closedDuringCreate)if(r==="Force")this._closedDuringCreate();else{var o={cause:"Connection",idInfo:this._idInfo};throw new x6.WorkerError("".concat(this._idInfo.side," Endpoint's close called during creation"),o)}var u=this._state;this._state=void 0;try{u.close(),(n=this._onClose)===null||n===void 0||n.call(this),(a=this.onClose)===null||a===void 0||a.call(this)}catch(t){var o={cause:"Connection",idInfo:this._idInfo,error:(0,MVe.asError)(t)};(0,K0e.dispatchWorkerError)(new x6.WorkerError("".concat(this._idInfo.side," Endpoint's close threw an error"),o))}}},e.createOutside=function(r,n){return n===void 0&&(n=function(){}),e._create("Outside",r,n)},e.createInside=function(r,n){return e._create("Inside",r,n)},e}();NM.Endpoint=xVe});var W0e=Y(Zz=>{_();Object.defineProperty(Zz,"__esModule",{value:!0});Zz.importScriptsWithRetry=qVe;function LVe(e,r,n){var a=e.indexOf("?");if(a<0)return"".concat(e,"?").concat(r,"=").concat(n);for(var o=e.slice(0,a+1),u=e.slice(a+1).split("&"),t=0;t<u.length&&!(u[t][r.length]==="="&&u[t].slice(0,r.length)===r);t+=1);return u[t]="".concat(r,"=").concat(n),o+u.join("&")}function BVe(e,r){for(var n,a=0;a<=r;a+=1)try{importScripts(a>0?LVe(e,"retries",String(a)):e);return}catch(o){n=o}throw n}function qVe(e,r){if(r===0){importScripts.apply(void 0,e);return}for(var n=0,a=e;n<a.length;n++){var o=a[n];BVe(o,r)}}});var j0e=Y(L6=>{_();Object.defineProperty(L6,"__esModule",{value:!0});L6.isWorkerThread=UVe;L6.workerName=GVe;function UVe(){return typeof WorkerGlobalScope!="undefined"}function GVe(){return self.name}});var eY=Y(Kh=>{_();Object.defineProperty(Kh,"__esModule",{value:!0});Object.defineProperty(Kh,"Endpoint",{enumerable:!0,get:function(){return WVe.Endpoint}});Object.defineProperty(Kh,"WorkerError",{enumerable:!0,get:function(){return KVe.WorkerError}});Object.defineProperty(Kh,"dispatchWorkerError",{enumerable:!0,get:function(){return $z.dispatchWorkerError}});Object.defineProperty(Kh,"importScriptsWithRetry",{enumerable:!0,get:function(){return jVe.importScriptsWithRetry}});Object.defineProperty(Kh,"isThreadingSupported",{enumerable:!0,get:function(){return $z.isThreadingSupported}});Object.defineProperty(Kh,"isWorkerThread",{enumerable:!0,get:function(){return H0e.isWorkerThread}});Object.defineProperty(Kh,"paramInsideDef",{enumerable:!0,get:function(){return VVe.paramInsideDef}});Object.defineProperty(Kh,"setConfig",{enumerable:!0,get:function(){return $z.setConfig}});Object.defineProperty(Kh,"workerName",{enumerable:!0,get:function(){return H0e.workerName}});var KVe=NA(),$z=AA(),VVe=I6(),WVe=Xz(),jVe=W0e(),H0e=j0e()});var Q0e=Y(B6=>{_();Object.defineProperty(B6,"__esModule",{value:!0});B6.default=void 0;var HVe='!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=12)}([function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return o})),r.d(t,"__assign",(function(){return i})),r.d(t,"__rest",(function(){return a})),r.d(t,"__decorate",(function(){return u})),r.d(t,"__param",(function(){return c})),r.d(t,"__esDecorate",(function(){return f})),r.d(t,"__runInitializers",(function(){return l})),r.d(t,"__propKey",(function(){return s})),r.d(t,"__setFunctionName",(function(){return d})),r.d(t,"__metadata",(function(){return p})),r.d(t,"__awaiter",(function(){return y})),r.d(t,"__generator",(function(){return v})),r.d(t,"__createBinding",(function(){return _})),r.d(t,"__exportStar",(function(){return g})),r.d(t,"__values",(function(){return b})),r.d(t,"__read",(function(){return h})),r.d(t,"__spread",(function(){return m})),r.d(t,"__spreadArrays",(function(){return w})),r.d(t,"__spreadArray",(function(){return O})),r.d(t,"__await",(function(){return j})),r.d(t,"__asyncGenerator",(function(){return G})),r.d(t,"__asyncDelegator",(function(){return T})),r.d(t,"__asyncValues",(function(){return P})),r.d(t,"__makeTemplateObject",(function(){return S})),r.d(t,"__importStar",(function(){return E})),r.d(t,"__importDefault",(function(){return F})),r.d(t,"__classPrivateFieldGet",(function(){return k})),r.d(t,"__classPrivateFieldSet",(function(){return C})),r.d(t,"__classPrivateFieldIn",(function(){return D}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function u(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function c(e,t){return function(r,n){t(r,n,e)}}function f(e,t,r,n,o,i){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var u,c=n.kind,f="getter"===c?"get":"setter"===c?"set":"value",l=!t&&e?n.static?e:e.prototype:null,s=t||(l?Object.getOwnPropertyDescriptor(l,n.name):{}),d=!1,p=r.length-1;p>=0;p--){var y={};for(var v in n)y[v]="access"===v?{}:n[v];for(var v in n.access)y.access[v]=n.access[v];y.addInitializer=function(e){if(d)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(e||null))};var _=(0,r[p])("accessor"===c?{get:s.get,set:s.set}:s[f],y);if("accessor"===c){if(void 0===_)continue;if(null===_||"object"!=typeof _)throw new TypeError("Object expected");(u=a(_.get))&&(s.get=u),(u=a(_.set))&&(s.set=u),(u=a(_.init))&&o.push(u)}else(u=a(_))&&("field"===c?o.push(u):s[f]=u)}l&&Object.defineProperty(l,n.name,s),d=!0}function l(e,t,r){for(var n=arguments.length>2,o=0;o<t.length;o++)r=n?t[o].call(e,r):t[o].call(e);return n?r:void 0}function s(e){return"symbol"==typeof e?e:"".concat(e)}function d(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function y(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function u(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,u)}c((n=n.apply(e,t||[])).next())}))}function v(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(c){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&u[0]?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,n=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],n=0}finally{r=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}}var _=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function g(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||_(t,e,r)}function b(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function h(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function m(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(h(arguments[t]));return e}function w(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)n[o]=i[a];return n}function O(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function j(e){return this instanceof j?(this.v=e,this):new j(e)}function G(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||u(e,t)}))})}function u(e,t){try{(r=o[e](t)).value instanceof j?Promise.resolve(r.value.v).then(c,f):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function c(e){u("next",e)}function f(e){u("throw",e)}function l(e,t){e(t),i.shift(),i.length&&u(i[0][0],i[0][1])}}function T(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:j(e[n](t)),done:!1}:o?o(t):t}:o}}function P(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=b(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function S(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var x=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function E(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&_(t,e,r);return x(t,e),t}function F(e){return e&&e.__esModule?e:{default:e}}function k(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function C(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function D(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use \'in\' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var n=r(4),o={};function i(){return void 0===n.globalThis.__get_feature_gate_dictionary_variable?o:n.globalThis.__get_feature_gate_dictionary_variable()}function a(e,t){var r;return null!==(r=i()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=i,t.getStringFeatureGate=a,t.getBooleanFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;var o=parseFloat(n);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim();if(void 0===n)return t;var o=parseInt(n,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){var t=n.globalThis.__get_feature_gate_dictionary_variable;return n.globalThis.__get_feature_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0;var n=r(4);function o(){return void 0===n.globalThis.__get_change_gate_dictionary_variable?{}:n.globalThis.__get_change_gate_dictionary_variable()}t.getChangeGateDictionary=o,t.isChangeGateEnabled=function(e){var t;return null===(t=o()[e])||void 0===t||t},t.setChangeGateDictionaryGetter=function(e){var t=n.globalThis.__get_change_gate_dictionary_variable;return n.globalThis.__get_change_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);n.__exportStar(r(1),t),n.__exportStar(r(8),t),n.__exportStar(r(2),t),n.__exportStar(r(9),t),n.__exportStar(r(10),t),n.__exportStar(r(11),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThis=void 0;var n=r(5);t.globalThis=n},function(e,t,r){"use strict";e.exports=r(6)()?globalThis:r(7)},function(e,t,r){"use strict";e.exports=function(){return"object"==typeof globalThis&&(!!globalThis&&globalThis.Array===Array)}},function(e,t){var r=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return r()}try{return __global__||r()}finally{delete Object.prototype.__global__}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var n=r(1);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var n=r(2);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,n.isChangeGateEnabled)(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var n=r(0),o=r(2);function i(e){var t=(0,o.setChangeGateDictionaryGetter)(void 0);return(0,o.setChangeGateDictionaryGetter)((function(){var r=void 0!==t?t():{};return n.__assign(n.__assign({},r),e)})),t}t.overrideChangeGates=i,t.overrideTypedChangeGates=function(e,t){return i(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var n=r(0),o=r(1);function i(e){for(var t,r,i={},a=0,u=Object.keys(e);a<u.length;a++){var c=u[a];i[c]=null===(t=e[c])||void 0===t?void 0:t.toString()}var f=null!==(r=(0,o.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,o.setFeatureGateDictionaryGetter)((function(){return n.__assign(n.__assign({},f()),i)})),f}t.overrideFeatureGates=i,t.overrideTypedFeatureGates=function(e,t){return i(t)}},function(e,t,r){"use strict";r.r(t);var n=r(0);function o(e){return i(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function i(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function a(e){return i(e)?e:new Error("(non-Error object) ".concat(function(e){var t=typeof e;switch(t){case"function":case"symbol":case"undefined":return"<".concat(t,">");case"object":return JSON.stringify(e);default:return"".concat(e)}}(e)))}function u(e){return{name:e.name,message:o(e)?e.baseMessage:e.message,stack:e.stack,info:o(e)?(t=e.info,Object(n.__assign)(Object(n.__assign)({},t),{error:t.error?u(t.error):void 0})):void 0};var t}function c(e){throw new ReferenceError("".concat(e," is not defined"))}function f(e,t,r){void 0===r&&(r=c);try{for(var n=t.split("."),o=0,i=n;o<i.length;o++){e=e[i[o]]}return null!=e?e:r(t)}catch(e){return r(t)}}var l=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return l.transfer.apply(l,Object(n.__spreadArray)([e,void 0],t,!1))};l.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var s="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function d(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:s()))}function p(e,t,r){var n=e.indexOf("?");if(n<0)return"".concat(e,"?").concat(t,"=").concat(r);for(var o=e.slice(0,n+1),i=e.slice(n+1).split("&"),a=0;a<i.length&&("="!==i[a][t.length]||i[a].slice(0,t.length)!==t);a+=1);return i[a]="".concat(t,"=").concat(r),o+i.join("&")}function y(e,t){for(var r,n=0;n<=t;n+=1)try{return void importScripts(n>0?p(e,"retries",String(n)):e)}catch(e){r=e}throw r}function v(e,t){if(0!==t)for(var r=0,n=e;r<n.length;r++){y(n[r],t)}else importScripts.apply(void 0,e)}var _=r(3);self.onmessage=function(e){var t,r,c=e.data,l=c.config,p=c.port,y=c.options,g=c.script,b=c.args,h=c.featureGateDictionary,m=c.changeGateDictionary;self.onmessage=null,self.__typed_workers_thread=!0,Object(_.setFeatureGateDictionaryGetter)((function(){return h})),Object(_.setChangeGateDictionaryGetter)((function(){return m}));var w,O=null!==(r=null!==(t=y.importScriptsMaxRetries)&&void 0!==t?t:l.importScriptsMaxRetries)&&void 0!==r?r:0;function j(){var e;if(w)return w;if(void 0===l.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return v([l.typedWorkersUrl],O),(w=f(self,null!==(e=l.typedWorkersName)&&void 0!==e?e:"typedWorkers")).setConfig(l),w}var G={status:"Pending",start:s()};function T(e,t){var r,n={kind:0,error:e?void 0:i(r=a(t))?{isError:!0,value:u(r)}:{isError:!1,value:r},stopwatch:G};self.postMessage(n),e||setTimeout(self.close.bind(self),6e4)}try{(function(e,t){function r(t){throw d(e,o(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!==(r=d(e,"Success"))&&void 0!==r?r:t}),r)}catch(e){r(e)}})(G,(function(){var e,t;return v(Object(n.__spreadArray)(Object(n.__spreadArray)([],null!==(t=null!==(e=null==y?void 0:y.importScriptUrls)&&void 0!==e?e:l.importScriptUrls)&&void 0!==t?t:[],!0),void 0!==g.scriptUrl?[g.scriptUrl]:[],!0),O),f(self,g.insideInitName).apply(void 0,Object(n.__spreadArray)([{config:l,importTypedWorkers:j,connection:{port:p,options:y,createMode:"Thread"}}],b,!1))})).then((function(){return T(!0)}),(function(e){return T(!1,e)}))}catch(e){T(!1,e)}}}]);';B6.default=HVe});var J0e=Y(U6=>{_();var QVe=An();Object.defineProperty(U6,"__esModule",{value:!0});U6.Thread=void 0;var zVe=br(),q6=AA(),rY=NA(),YVe=I6(),z0e=QVe(Q0e()),JVe=bM(),Y0e=Ql(),XVe=-1;function ZVe(e){var r="def"in e?e:(0,YVe.paramInsideDef)(e),n=r.def,a=r.args,o=r.transferables;if(typeof n!="function")return[n,a,o,void 0];var u="__generatedInsideInit".concat(XVe+=1),t="var ".concat(u," = ").concat(n.toString(),";");return[{scriptUrl:void 0,insideInitName:u},a,o,t]}var $Ve=function(){function e(r,n){var a,o;try{var u=void 0;a=ZVe(n),this.script=a[0],this.args=a[1],this.transferables=a[2],u=a[3];var t=u===void 0?[z0e.default]:[u,"\n\n",z0e.default];this.blobUrl=URL.createObjectURL(new Blob(t,{type:"application/javascript"}));var d={};r.id!=null&&(d.name=r.id),this.worker=new Worker(this.blobUrl,d)}catch(s){throw(o=this.worker)===null||o===void 0||o.terminate(),this.revokeBlobUrl(),s}}return e.prototype.revokeBlobUrl=function(){this.blobUrl!==void 0&&(URL.revokeObjectURL(this.blobUrl),this.blobUrl=void 0)},e.prototype.createInside=function(r,n){var a=this,o=r.port,u=r.options,t={type:"Thread",side:"Outside",id:u.id},d=this.worker,s=new Promise(function(c,l){a.createCallbacks={resolve:c,reject:l};var f={config:(0,q6.getSafeParams)(),port:o,options:u,script:a.script,args:a.args,featureGateDictionary:(0,Y0e.getFeatureGateDictionary)(),changeGateDictionary:(0,Y0e.getChangeGateDictionary)()};d.postMessage(f,(0,zVe.__spreadArray)([o],a.transferables,!0)),d.onerror=function(p){p.preventDefault();var m=(0,rY.getErrorEventWorkerError)(t,"worker.onerror",p);a.createCallbacks?a.createCallbacks.reject(m):(0,q6.dispatchWorkerError)(m)},d.onmessage=function(p){var m,v,h=p.data;switch(h.kind){case 0:return n.insideInit=h.stopwatch,h.error===void 0?(m=a.createCallbacks)===null||m===void 0?void 0:m.resolve():(v=a.createCallbacks)===null||v===void 0?void 0:v.reject((0,rY.decodeResultValue)(h.error));case 1:return(0,q6.dispatchWorkerError)((0,rY.decodeResultValue)(h.error));case 2:return(0,q6.dispatchCreateWorker)(h.stats)}}});return(0,JVe.promiseFinally)(s,function(){return void(a.createCallbacks=void 0)})},e.prototype.terminate=function(){var r;if(this.worker){var n=this.worker;this.worker=void 0,(r=this.createCallbacks)===null||r===void 0||r.resolve(),n.terminate(),this.revokeBlobUrl()}},e}();U6.Thread=$Ve});var $0e=Y(kA=>{_();Object.defineProperty(kA,"__esModule",{value:!0});kA.createWorkerStats=tWe;kA.startStopwatch=rWe;kA.stopStopwatch=tY;kA.timePromise=nWe;var eWe=EA(),Z0e=typeof performance!="undefined"&&performance.timeOrigin!==void 0?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function rWe(){return{status:"Pending",start:Z0e()}}function tY(e,r,n){e.status==="Pending"&&(e.status=r,e.end=Math.max(e.start,n??Z0e()))}function nWe(e,r){function n(a){throw tY(e,(0,eWe.isWorkerError)(a)&&a.info.cause==="Timeout"?"Timeout":"Error"),a}try{return r().then(function(a){var o;return(o=tY(e,"Success"))!==null&&o!==void 0?o:a},n)}catch(a){n(a)}}function G6(e){var r=1e3;return Math.round(e*r)/r}function X0e(e,r,n){return e<r?r:e>n?n:e}function nY(e,r,n){var a,o,u,t=X0e((a=e==null?void 0:e.start)!==null&&a!==void 0?a:1/0,r,n),d=X0e((o=e==null?void 0:e.end)!==null&&o!==void 0?o:1/0,r,n);return{status:(u=e==null?void 0:e.status)!==null&&u!==void 0?u:"Pending",start:G6(t-r),end:G6(d-r),duration:G6(d-t)}}function tWe(e){var r=e.id,n=e.createMode,a=e.createWorker,o=e.insideInit,u=e.createOutside,t=e.createThread,d=a.status,s=a.start,c=a.end;if(!(d==="Pending"||c===void 0)){var l=c-s,f={id:r,createMode:n,createWorker:{status:d,absStart:s,duration:G6(l)},createThread:n==="Thread"?nY(t,s,c):void 0,createOutside:nY(u,s,c),insideInit:nY(o,s,c)};return f}}});var ame=Y(oY=>{_();Object.defineProperty(oY,"__esModule",{value:!0});oY.createWorker=tme;var aY=br(),aWe=I6(),eme=Xz(),iY=AA(),iWe=J0e(),oWe=NA(),ZS=$0e(),uWe=bM(),sWe=lWe(eY());function rme(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,n=new WeakMap;return(rme=function(o){return o?n:r})(e)}function lWe(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var n=rme(r);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(u!=="default"&&Object.prototype.hasOwnProperty.call(e,u)){var t=o?Object.getOwnPropertyDescriptor(e,u):null;t&&(t.get||t.set)?Object.defineProperty(a,u,t):a[u]=e[u]}return a.default=e,n&&n.set(e,a),a}var cWe=(0,aY.__assign)((0,aY.__assign)({},sWe),{createWorker:tme});function dWe(e,r,n){var a="def"in n?n:(0,aWe.paramInsideDef)(n),o=a.def,u=a.args;if(typeof o!="function"){var t={type:"Endpoint",side:"Inside",id:e.options.id},d={cause:"InternalError",idInfo:t};return Promise.reject(new oWe.WorkerError("Loading an InsideScript to create a local worker is unimplemented",d))}return Promise.resolve().then(function(){return(0,ZS.timePromise)(r.insideInit=(0,ZS.startStopwatch)(),function(){return o.apply(void 0,(0,aY.__spreadArray)([{config:(0,iY.getSafeParams)(),importTypedWorkers:function(){return cWe},connection:e}],u,!1)).then(function(){})})})}function nme(e,r,n,a,o){var u=new MessageChannel,t=u.port1,d=u.port2,s;return Promise.all([a({port:t,options:e,createMode:r}),(0,ZS.timePromise)(n.createOutside=(0,ZS.startStopwatch)(),function(){return eme.Endpoint.createOutside({port:d,options:e,createMode:r},function(c){return o(s=c)})})]).then(function(){return s},function(c){return s?s.close("Force"):d.close(),Promise.reject(c)})}function fWe(e,r,n,a){return nme(e,"Local",r,function(o){return dWe(o,r,n)},a)}function pWe(e,r,n,a){r.createThread=(0,ZS.startStopwatch)();var o;try{o=new iWe.Thread(e,n)}catch(u){return(0,ZS.stopStopwatch)(r.createThread,"Error"),Promise.reject(u)}return(0,ZS.stopStopwatch)(r.createThread,"Success"),nme(e,"Thread",r,function(u){return o.createInside(u,r)},a).then(function(u){return u.hasBeenClosed()?o.terminate():u._onClose=o.terminate.bind(o),u},function(u){return o.terminate(),Promise.reject(u)})}function tme(e,r,n){n===void 0&&(n=function(){});var a=(0,iY.getCreateMode)(e),o="local"in r?a==="Local"?r.local:r.thread:r,u=a==="Local"?fWe:pWe,t={id:e.id,createMode:a,createWorker:(0,ZS.startStopwatch)()},d=(0,ZS.timePromise)(t.createWorker,function(){return u((0,eme.getSafeOptions)(e),t,o,n)});return(0,uWe.promiseFinally)(d,function(){var s=(0,ZS.createWorkerStats)(t);s&&(0,iY.dispatchCreateWorker)(s)})}});var oC=Y(FA=>{_();Object.defineProperty(FA,"__esModule",{value:!0});var mWe={createWorker:!0};Object.defineProperty(FA,"createWorker",{enumerable:!0,get:function(){return gWe.createWorker}});var uY=eY();Object.keys(uY).forEach(function(e){e==="default"||e==="__esModule"||Object.prototype.hasOwnProperty.call(mWe,e)||e in FA&&FA[e]===uY[e]||Object.defineProperty(FA,e,{enumerable:!0,get:function(){return uY[e]}})});var gWe=ame()});var sY=Y(IA=>{"use strict";_();Object.defineProperty(IA,"__esModule",{value:!0});IA.initStopwatch=IA.ulsStopwatchFactory=void 0;var K6=Ol(),ime={ULS:new K6.NulLogger},vWe=function(r){return ime.ULS.traceTag(595948114,K6.LogCategory.msoulscat_ES_EWAJS,K6.TraceLevel.Info,r)};IA.ulsStopwatchFactory=(0,K6.initStopwatchFactory)(vWe);function hWe(e){ime.ULS=e}IA.initStopwatch=hWe});var ome=Y(V6=>{"use strict";_();Object.defineProperty(V6,"__esModule",{value:!0});V6.excelOnlineCalcPackageVersion=void 0;V6.excelOnlineCalcPackageVersion="46.4.13"});var dme=Y(zc=>{"use strict";_();Object.defineProperty(zc,"__esModule",{value:!0});zc.initCalcThread=zc.initCalcInThread=zc.initCalc=zc.getCalcAbsUrlOrThrow=zc.getCalcAbsUrl=zc.isCalcInit=zc.maxRetriesForLoadingScript=zc.initCalcCalled=void 0;var W6=br(),$S=Ol(),cY=oC(),Lb=$y(),SWe=sY(),sme=X5(),ume=K5(),yWe=CM(),CWe=ome();zc.initCalcCalled=new yWe.ResolvablePromise;zc.maxRetriesForLoadingScript=9;var _We=/^(https)|(http)|(file):\/\//,lY=!1,j6=void 0;function RWe(){return lY}zc.isCalcInit=RWe;function TWe(){return j6}zc.getCalcAbsUrl=TWe;function lme(){if(j6==null)throw new Error("initCalc was not passed calcAbsUrl");return j6}zc.getCalcAbsUrlOrThrow=lme;function bWe(e,r,n){cme(e,r,n,void 0)}zc.initCalc=bWe;function cme(e,r,n,a){if(lY){var o="calc.config.initCalc: Calc is already initialized";Lb.ulsLogger.ULS.traceTag(595910878,$S.LogCategory.msoulscat_ES_EWAJS,$S.TraceLevel.Info,o);return}if(Lb.ulsLogger.setLogger(e),(0,SWe.initStopwatch)(e),(0,sme.initFeatureConfiguration)(r),n!=null&&!_We.test(n)){var u="calc.config.initCalc: calcAbsUrl is not absolute: ".concat(n);Lb.ulsLogger.ULS.traceTag(595910879,$S.LogCategory.msoulscat_ES_EWAJS,$S.TraceLevel.Warning,u)}cY.setConfig(a??{importScriptsMaxRetries:zc.maxRetriesForLoadingScript,onWorkerError:function(c){var l={error:(0,ume.messageFromError)(c),innerError:c.info.error?(0,ume.messageFromError)(c.info.error):void 0},f="calc.onWorkerError: ".concat(JSON.stringify(l));Lb.ulsLogger.ULS.traceTag(593335298,$S.LogCategory.msoulscat_ES_EWAJS,$S.TraceLevel.Warning,f)},onCreateWorker:function(c){var l="calc.onCreateWorker: ".concat(JSON.stringify(c));Lb.ulsLogger.ULS.traceTag(593335299,$S.LogCategory.msoulscat_ES_EWAJS,$S.TraceLevel.Info,l)}}),j6=n,lY=!0;var t=" (".concat("production",")"),d="calc.config.initCalc: Calc version ".concat(CWe.excelOnlineCalcPackageVersion).concat(t," initialized");Lb.ulsLogger.ULS.traceTag(594642132,$S.LogCategory.msoulscat_ES_EWAJS,$S.TraceLevel.Info,d),zc.initCalcCalled.resolve(void 0)}function PWe(e,r,n,a){return W6.__awaiter(this,void 0,void 0,function(){var o;return W6.__generator(this,function(u){switch(u.label){case 0:return[4,cY.Endpoint.createOutside(e)];case 1:return o=u.sent(),cme(NWe(o.post),function(t){return r[t]===!0},n,a),[2]}})})}zc.initCalcInThread=PWe;function EWe(e){return W6.__awaiter(this,void 0,void 0,function(){var r,n,a,o,u,t;return W6.__generator(this,function(d){switch(d.label){case 0:r=lme(),n=new MessageChannel,a={port:n.port1,options:{id:"WorkerThreadLogger"}},o={port:n.port2,options:{id:"WorkerThreadLogger"}},d.label=1;case 1:return d.trys.push([1,3,,4]),[4,Promise.all([cY.Endpoint.createInside(a,function(){return Lb.ulsLogger.noThrowLogger}),e.call.initCalcThreadInside.transfer([o.port],o,(0,sme.getFeatures)(),r)])];case 2:return u=d.sent()[0],[2,u];case 3:throw t=d.sent(),a.port.close(),t;case 4:return[2]}})})}zc.initCalcThread=EWe;function NWe(e){var r=function(a){return"[".concat(new Date().toISOString(),"] ").concat(a)};return{shipAssertTag:function(a,o,u,t){e.shipAssertTag(a,o,u,r(t))},assertTag:function(a,o,u,t){e.assertTag(a,o,u,r(t))},traceTag:function(a,o,u,t){e.traceTag(a,o,u,r(t))},debugTraceTag:function(a,o,u,t){e.debugTraceTag(a,o,u,r(t))},dnmTraceTag:function(a,o,u,t){e.dnmTraceTag(a,o,u,r(t))}}}});var fme=Y(H6=>{"use strict";_();Object.defineProperty(H6,"__esModule",{value:!0});H6.mixin=void 0;var AWe=br();function OWe(e,r,n){var a=function(o){AWe.__extends(u,o);function u(){for(var t=[],d=0;d<arguments.length;d++)t[d]=arguments[d];for(var s=o.apply(this,t)||this,c=r(s),l=0,f=n;l<f.length;l++){var p=f[l];Object.defineProperty(s,p,{value:c[p].bind(c),enumerable:!1,configurable:!1})}return s}return u}(e);return a}H6.mixin=OWe});var z6=Y(rf=>{"use strict";_();Object.defineProperty(rf,"__esModule",{value:!0});rf.javaScriptError=rf.ReasonKind=rf.isSuccess=rf.failure=rf.successUndefined=rf.success=rf.ResultKind=void 0;var Q6;(function(e){e.Success="Success",e.Failure="Failure",e.Paused="Paused",e.Breaked="Breaked"})(Q6=rf.ResultKind||(rf.ResultKind={}));function pme(e){return{kind:Q6.Success,value:e}}rf.success=pme;rf.successUndefined=pme(void 0);function kWe(e){return{kind:Q6.Failure,reason:e}}rf.failure=kWe;function FWe(e){return e.kind===Q6.Success}rf.isSuccess=FWe;var mme;(function(e){e.JavaScriptError="JavaScriptError"})(mme=rf.ReasonKind||(rf.ReasonKind={}));function IWe(e){return{kind:mme.JavaScriptError,error:e}}rf.javaScriptError=IWe});var Rme=Y(ru=>{"use strict";_();Object.defineProperty(ru,"__esModule",{value:!0});ru.makeGetCharCodeBits=ru.forEachClassInterval=ru.CharCodeBits=ru.codePointIterator=ru.numCodeUnits=ru.stringCodePointAt=ru.countCodePoints=ru.scanCodePointsBack=ru.scanCodePoints=ru.stringFromCodePoint=ru.surrogatePairToCodePoint=ru.isAnySurrogate=ru.isLowSurrogate=ru.isHighSurrogate=void 0;var MWe=tv(),vme=55296,hme=56320,gme=65533;function AM(e){return(e&64512)===vme}ru.isHighSurrogate=AM;function OM(e){return(e&64512)===hme}ru.isLowSurrogate=OM;function Sme(e){return(e&63488)===55296}ru.isAnySurrogate=Sme;function yme(e,r){if(!(!AM(e)||!OM(r)))return((e&1023)<<10|r&1023)+65536}ru.surrogatePairToCodePoint=yme;function wWe(e){if(e<=65535)return String.fromCharCode(e);var r=e-65536;return String.fromCharCode(r>>10|vme,r&1023|hme)}ru.stringFromCodePoint=wWe;function DWe(e,r,n){for(var a=r,o=0;o<n;o+=1){if(a>=e.length)return;var u=e.charCodeAt(a);AM(u)&&a+1<e.length&&OM(e.charCodeAt(a+1))?a+=2:a+=1}return a}ru.scanCodePoints=DWe;function xWe(e,r,n){for(var a=r,o=0;o<n;o+=1){if(a-1<0)return;var u=e.charCodeAt(a-1);OM(u)&&a-2>=0&&AM(e.charCodeAt(a-2))?a-=2:a-=1}return a}ru.scanCodePointsBack=xWe;function LWe(e,r,n){for(var a=0,o=r;o<n;a+=1){var u=e.charCodeAt(o);AM(u)&&o+1<n&&OM(e.charCodeAt(o+1))?o+=2:o+=1}return a}ru.countCodePoints=LWe;function Cme(e,r){var n=e.charCodeAt(r);if(!Sme(n))return n;if(r+1>=e.length)return gme;var a=e.charCodeAt(r+1),o=yme(n,a);return o??gme}ru.stringCodePointAt=Cme;function _me(e){return e>=65536?2:1}ru.numCodeUnits=_me;function BWe(e,r){r===void 0&&(r=0);for(var n=[],a=r;a<e.length;){var o=Cme(e,a);n.push(o),a+=_me(o)}return n}ru.codePointIterator=BWe;var dY;(function(e){e[e.IdentStartClass=32]="IdentStartClass",e[e.IdentContinueClass=64]="IdentContinueClass"})(dY=ru.CharCodeBits||(ru.CharCodeBits={}));function fY(e,r){if((e.length&1)===1)throw new Error("Invalid class length");for(var n=0;n<e.length;n+=2)for(var a=e[n],o=e[n+1],u=a;u<o;u+=1)r(u,a,o)}ru.forEachClassInterval=fY;function qWe(e,r){var n;function a(u){n[u]|=dY.IdentStartClass}function o(u){n[u]|=dY.IdentContinueClass}return function(u){if(n===void 0){var t=(0,MWe.fastMax)(e[e.length-1],r[r.length-1]);n=new Uint8Array(t),fY(e,a),fY(r,o)}var d=n[u];return d!==void 0?d:0}}ru.makeGetCharCodeBits=qWe});var bme=Y(MA=>{"use strict";_();Object.defineProperty(MA,"__esModule",{value:!0});MA.wrapIntoAsync=MA.wrapIntoAsyncClass=void 0;function UWe(e){for(var r=function(){function d(s){this.obj=s}return d}(),n=r,a=function(s){n.prototype[s]=function(){for(var c,l=[],f=0;f<arguments.length;f++)l[f]=arguments[f];var p=(c=this.obj)[s].apply(c,l);return Promise.resolve(p)}},o=0,u=e;o<u.length;o++){var t=u[o];a(t)}return n}function Tme(){return function(e){return UWe(e)}}MA.wrapIntoAsyncClass=Tme;function GWe(e,r){var n=Tme()(r);return new n(e)}MA.wrapIntoAsync=GWe});var Pme=Y(Y6=>{"use strict";_();Object.defineProperty(Y6,"__esModule",{value:!0});Y6.createArrayLogger=void 0;var KWe=br();function VWe(e,r,n){e===void 0&&(e=!1),r===void 0&&(r=function(){return!0});function a(t){n===void 0?t():setTimeout(function(){return t()},n)}var o=new Set,u=new Set;return{log:[],addTriggerListener:function(d){o.add(d)},waitForMessage:function(d,s){var c=this;return new Promise(function(l){var f=setTimeout(function(){console.warn("ArrayLogger.waitForMessage: timed out waiting for message; timeout = ".concat(s)),l(!1)},s);c.addTriggerListener(function(p){var m=d(p);return m&&(clearTimeout(f),l(!0)),m})})},waitForReceivedButDelayedMessages:function(){var d=[];return u.forEach(function(s){return d.push(s)}),Promise.all(d).then(function(){})},addLogMessage:function(d){var s=this;if(r(d)){var c=new Promise(function(l){a(function(){s.log.push(d),e&&console.log.apply(console,KWe.__spreadArray([new Date().toISOString()],d,!1)),o.forEach(function(f){f(d)&&o.delete(f)}),l()})}).then(function(){u.delete(c)});u.add(c)}},shipAssertTag:function(){for(var d=[],s=0;s<arguments.length;s++)d[s]=arguments[s];this.addLogMessage(["shipAssertTag",d]);var c=d[2],l=d[3];if(!c)throw new TypeError("shipAssertTag: ".concat(l))},assertTag:function(){for(var d=[],s=0;s<arguments.length;s++)d[s]=arguments[s];this.addLogMessage(["assertTag",d]);var c=d[2],l=d[3];if(!c)throw new TypeError("assertTag: ".concat(l))},traceTag:function(){for(var d=[],s=0;s<arguments.length;s++)d[s]=arguments[s];this.addLogMessage(["traceTag",d])},dnmTraceTag:function(){for(var d=[],s=0;s<arguments.length;s++)d[s]=arguments[s];this.addLogMessage(["dnmTraceTag",d])},debugTraceTag:function(){for(var d=[],s=0;s<arguments.length;s++)d[s]=arguments[s];this.addLogMessage(["debugTraceTag",d])}}}Y6.createArrayLogger=VWe});var Eme=Y(nR=>{"use strict";_();Object.defineProperty(nR,"__esModule",{value:!0});nR.featureEnabledDummyCallback=nR.AssertLogger=nR.ConsoleLogger=void 0;var Vh=X5(),WWe=function(){function e(){}return e.prototype.shipAssertTag=function(r,n,a,o){if(console.assert(a,"shipAssertTag2 ".concat(r," ").concat(n," ").concat(o)),!a)throw new Error("shipAssertTag2 ".concat(r," ").concat(n," ").concat(o))},e.prototype.assertTag=function(r,n,a,o){if(console.assert(a,"assertTag2 ".concat(r," ").concat(n," ").concat(o)),!a)throw new Error("assertTag2 ".concat(r," ").concat(n," ").concat(o))},e.prototype.traceTag=function(r,n,a,o){console.log("traceTag2",r,o,n,a)},e.prototype.dnmTraceTag=function(r,n,a,o){console.log("dnmTraceTag2",r,o,n,a)},e.prototype.debugTraceTag=function(r,n,a,o){console.log("debugTraceTag2",r,o,n,a)},e}();nR.ConsoleLogger=WWe;var jWe=function(){function e(){this.traceTag=function(){},this.debugTraceTag=function(){},this.dnmTraceTag=function(){}}return e.prototype.shipAssertTag=function(r,n,a,o){if(!a)throw new Error("shipAssertTag2 ".concat(r," ").concat(n," ").concat(o))},e.prototype.assertTag=function(r,n,a,o){if(!a)throw new Error("assertTag2 ".concat(r," ").concat(n," ").concat(o))},e}();nR.AssertLogger=jWe;function HWe(e){switch(e){case Vh.FeatureName.FeatureCheckingEnabled:return!0;case Vh.FeatureName.CalcRecordFunctions:case Vh.FeatureName.CalcNestedRecordFunction:case Vh.FeatureName.CalcLetRecFunction:case Vh.FeatureName.CalcLambdaFunction:case Vh.FeatureName.CalcLambdaBasicFunctions:case Vh.FeatureName.CalcLambdaHelperFunctions:case Vh.FeatureName.CalcLambdaOptionalParameters:case Vh.FeatureName.CalcLambdaDefaultParameters:case Vh.FeatureName.CalcLambdaCellValues:case Vh.FeatureName.CalcLambdaArrayLifting:return!0;default:return e.startsWith("OfficeVSO:")}}nR.featureEnabledDummyCallback=HWe});var mY=Y(Hu=>{"use strict";_();Object.defineProperty(Hu,"__esModule",{value:!0});Hu.VoidMachine=Hu.AllMachine=Hu.MachineRuntime=Hu.MachineCycle=Hu.nextOnSuccessReceiver=Hu.callMachineTransition=Hu.breakTransition=Hu.nextTransition=Hu.TransitionKind=void 0;var QWe=br(),Wh=z6(),e1;(function(e){e[e.Next=1]="Next",e[e.CallMachine=2]="CallMachine",e[e.Break=3]="Break"})(e1=Hu.TransitionKind||(Hu.TransitionKind={}));function pY(e,r,n){return{kind:e,machine:r,receiver:n}}Hu.nextTransition=pY(e1.Next,void 0,void 0);Hu.breakTransition=pY(e1.Break,void 0,void 0);function J6(e,r){return pY(e1.CallMachine,e,r)}Hu.callMachineTransition=J6;var zWe={receiveResult:function(r){return(0,Wh.isSuccess)(r)?Hu.nextTransition:r}};function YWe(){return zWe}Hu.nextOnSuccessReceiver=YWe;var Nme=function(e){QWe.__extends(r,e);function r(n,a){var o=this.constructor,u=e.call(this,"Cycle detected: tried to call an already-running Machine")||this;u.machine=n,u.stackDepth=a;var t=o.prototype;return Object.getPrototypeOf(u)!==t&&(Object.setPrototypeOf!=null?Object.setPrototypeOf(u,t):u.__proto__=t),u}return r}(Error);Hu.MachineCycle=Nme;var Pgn=Hu.MachineRuntime=function(){function e(r){this.numSteps=0,this.stack=[];try{this.pushFrame(J6(r,{receiveResult:function(a){return a}})),this.transition=Hu.nextTransition}catch(n){this.transition=(0,Wh.failure)((0,Wh.javaScriptError)(n))}}return e.resetStats=function(){e.maxStackDepth=0,e.numPauses=0,e.numCycles=0},e.prototype.pushFrame=function(r){var n=this.stack.length,a=r.machine;if(a.runStatus===!0)throw e.numCycles+=1,new Nme(a,n);a.runStatus===!1&&(a.runStatus=!0),this.stack.push(r),e.maxStackDepth<n+1&&(e.maxStackDepth=n+1)},e.prototype.advanceTopFrame=function(){var r=this.stack[this.stack.length-1].machine;return typeof r.runStatus!="boolean"?r.runStatus:r.next()},e.prototype.step=function(){this.numSteps+=1;var r=this.transition;try{switch(r.kind){case e1.Next:return this.transition=this.advanceTopFrame(),Hu.nextTransition;case e1.CallMachine:return this.pushFrame(r),this.transition=this.advanceTopFrame(),Hu.nextTransition;case e1.Break:return this.transition=Hu.nextTransition,r;default:var n=this.stack.pop();return n?(n.machine.runStatus=r,this.transition=n.receiver.receiveResult(r),Hu.nextTransition):r}}catch(a){return this.transition=(0,Wh.failure)((0,Wh.javaScriptError)(a)),Hu.nextTransition}},e.prototype.run=function(r){if(r===void 0&&(r=function(){return!1}),this.result)return this.result;try{for(;;){var n=this.step();if(n.kind===e1.Break)return n;if(n.kind!==e1.Next)return this.result=n;if(r())return e.numPauses+=1,n}}catch(a){return this.result=(0,Wh.failure)((0,Wh.javaScriptError)(a))}},e.prototype.runToResult=function(){for(;;){var r=this.run();if(r.kind!==e1.Break)return r}},e.maxStackDepth=0,e.numPauses=0,e.numCycles=0,e}(),JWe=function(){function e(r){this.machines=r,this.runStatus=!1,this.values=[]}return e.prototype.next=function(){return this.values.length<this.machines.length?J6(this.machines[this.values.length],this):(0,Wh.success)(this.values)},e.prototype.receiveResult=function(r){return(0,Wh.isSuccess)(r)?(this.values.push(r.value),this.next()):r},e}();Hu.AllMachine=JWe;var XWe=function(){function e(r){this.machine=r,this.runStatus=!1}return e.prototype.next=function(){return J6(this.machine,this)},e.prototype.receiveResult=function(r){return(0,Wh.isSuccess)(r)?Wh.successUndefined:r},e}();Hu.VoidMachine=XWe});var Ame=Y(X6=>{"use strict";_();Object.defineProperty(X6,"__esModule",{value:!0});X6.Pledge=void 0;var Bb=mY(),uC=z6(),Agn=X6.Pledge=function(){function e(r,n,a){this.transition=r,this.onFulfilled=n,this.onRejected=a,this.runStatus=r instanceof e||r.kind===Bb.TransitionKind.CallMachine?!1:r}return e.prototype.setState=function(r,n,a){return this.onFulfilled=n,this.onRejected=a,this.transition=r,r},e.prototype.next=function(){return this.transition instanceof e?this.transition=(0,Bb.callMachineTransition)(this.transition,this):this.transition},e.prototype.receiveResult=function(r){var n;try{if((0,uC.isSuccess)(r)){if(!this.onFulfilled)return this.setState(r,void 0,void 0);n=this.onFulfilled(r.value)}else{if(!this.onRejected)return this.setState(r,void 0,void 0);n=this.onRejected(r.reason)}}catch(a){return this.setState((0,uC.failure)((0,uC.javaScriptError)(a)),void 0,void 0)}return n instanceof e?(this.setState(n.transition,n.onFulfilled,n.onRejected),n.setState(this,void 0,void 0),this.next()):this.setState((0,uC.success)(n),void 0,void 0)},e.prototype.bind=function(r){return new e(this,r,void 0)},e.prototype.catch=function(r){return new e(this,void 0,r)},e.prototype.finally=function(r){return new e(this,function(n){return r(),n},function(n){return r(),e.reject(n)})},e.all=function(r){return e.fromMachine(new Bb.AllMachine(r.map(e.resolve)))},e.prototype.settle=function(){return new Bb.MachineRuntime(this).runToResult()},e.settleOrThrow=function(r){var n=r.settle();if((0,uC.isSuccess)(n))return n.value;throw n.reason.error},e.resolve=function(r){return r instanceof e?r:new e((0,uC.success)(r),void 0,void 0)},e.reject=function(r){return new e((0,uC.failure)(r),void 0,void 0)},e.undefinedPledge=e.resolve(void 0),e.fromMachine=function(r){if(r instanceof e)return r;var n=new e(e.undefinedPledge,void 0,void 0);return n.transition=(0,Bb.callMachineTransition)(r,n),n},e.try=function(r){return e.undefinedPledge.bind(r)},e.RepeatMachine=function(){function r(n,a){this.onLoop=n,this.accum=a,this.runStatus=!1}return r.prototype.next=function(){var n=this.onLoop(this.accum);return n instanceof e?(0,Bb.callMachineTransition)(n,this):this.receiveSuccess(n)},r.prototype.receiveResult=function(n){return(0,uC.isSuccess)(n)?this.receiveSuccess(n.value):n},r.prototype.receiveSuccess=function(n){return n===void 0?(0,uC.success)(this.accum):(this.accum=n,Bb.nextTransition)},r}(),e.repeat=function(r,n){return e.resolve(n).bind(function(a){return e.fromMachine(new e.RepeatMachine(r,a))})},e}()});var Ome=Y(wA=>{"use strict";_();Object.defineProperty(wA,"__esModule",{value:!0});wA.throwAfterSteps=wA.pauseAfterSteps=void 0;function ZWe(e){var r=Math.max(1,Math.floor(e)),n=0;return function(){return n+=1,n>=r}}wA.pauseAfterSteps=ZWe;function $We(e){var r=Math.max(1,Math.floor(e)),n=0;return function(){if(n+=1,n<r)return!1;throw r}}wA.throwAfterSteps=$We});var Fme=Y(Z6=>{"use strict";_();Object.defineProperty(Z6,"__esModule",{value:!0});Z6.RevocableSingleton=void 0;var kme=function(){function e(r,n){var a=this;this.target=r,this.isRevoked=!1;var o=function(t){if(a.isRevoked)throw new TypeError("".concat(String(t),": ").concat(n))};this.proxy=typeof Proxy=="undefined"?r:new Proxy(r,{get:function(t,d,s){return o(d),Reflect.get(t,d,s)},set:function(t,d,s,c){return o(d),Reflect.set(t,d,s,c)}})}return e.prototype.revoke=function(){this.isRevoked=!0},e}(),eje=function(){function e(r){this.message=r}return e.prototype.getInstance=function(){var r;return(r=this.instance)===null||r===void 0?void 0:r.proxy},e.prototype.setInstance=function(r){var n;return(n=this.instance)===null||n===void 0||n.revoke(),r===void 0?this.instance=void 0:(this.instance=new kme(r,this.message),this.instance.proxy)},e.prototype.revokeInstance=function(){if(this.instance)return this.instance.revoke(),this.instance=new kme(this.instance.target,this.message),this.instance.proxy},e}();Z6.RevocableSingleton=eje});var Cn=Y(pn=>{"use strict";_();Object.defineProperty(pn,"__esModule",{value:!0});pn.revocableSingleton=pn.testUtils=pn.pledge=pn.machine=pn.testConfig=pn.arrayLogger=pn.wrapIntoAsyncModule=pn.unicode=pn.result=pn.mixin=pn.promise=pn.stopwatch=pn.resolvablePromise=pn.config=pn.codePoint=pn.setTimeoutInterfaceModule=pn.asyncLoopModule=pn.async=pn.arrayUtils=pn.table=pn.split=pn.rTree=pn.ringBuffer=pn.rbTree=pn.rbMapTree=pn.productSet=pn.priorityQueue=pn.interval=pn.histogram=pn.hashTable=pn.hashSet=pn.dictionary=pn.deque=pn.bspSet=pn.binaryHeap=pn.arrayMapTree=pn.testUtil=pn.core=pn.featureConfiguration=pn.assertions=pn.util=pn.anonymizer=pn.combinations=pn.findIsomorphicSubtrees=pn.JSF32=pn.fnv1a=pn.PackageName=void 0;pn.PackageName="excel-online-calc-common";var rje=Ffe();Object.defineProperty(pn,"fnv1a",{enumerable:!0,get:function(){return rje.fnv1a}});var nje=zQ();Object.defineProperty(pn,"JSF32",{enumerable:!0,get:function(){return nje.JSF32}});var tje=Mfe();Object.defineProperty(pn,"findIsomorphicSubtrees",{enumerable:!0,get:function(){return tje.findIsomorphicSubtrees}});var aje=xfe();Object.defineProperty(pn,"combinations",{enumerable:!0,get:function(){return aje.combinations}});var ije=F5();pn.anonymizer=ije;var oje=K5();pn.util=oje;var uje=$y();pn.assertions=uje;var sje=X5();pn.featureConfiguration=sje;var lje=tv();pn.core=lje;var cje=Npe();pn.testUtil=cje;var dje=kpe();pn.arrayMapTree=dje;var fje=Sz();pn.binaryHeap=fje;var pje=_z();pn.bspSet=pje;var mje=xpe();pn.deque=mje;var gje=Lpe();pn.dictionary=gje;var vje=Upe();pn.hashSet=vje;var hje=Gpe();pn.hashTable=hje;var Sje=Vpe();pn.histogram=Sje;var yje=Az();pn.interval=yje;var Cje=Wpe();pn.priorityQueue=Cje;var _je=r0e();pn.productSet=_je;var Rje=o0e();pn.rbMapTree=Rje;var Tje=qz();pn.rbTree=Tje;var bje=u0e();pn.ringBuffer=bje;var Pje=f0e();pn.rTree=Pje;var Eje=g0e();pn.split=Eje;var Nje=vA();pn.table=Nje;pn.arrayUtils=C0e();pn.async=R0e();pn.asyncLoopModule=N0e();pn.setTimeoutInterfaceModule=Wz();pn.codePoint=A0e();pn.config=dme();pn.resolvablePromise=CM();pn.stopwatch=sY();pn.promise=CM();var Aje=fme();Object.defineProperty(pn,"mixin",{enumerable:!0,get:function(){return Aje.mixin}});pn.result=z6();pn.unicode=Rme();pn.wrapIntoAsyncModule=bme();pn.arrayLogger=Pme();pn.testConfig=Eme();pn.machine=mY();pn.pledge=Ame();pn.testUtils=Ome();pn.revocableSingleton=Fme()});var ft=Y(ya=>{_();Object.defineProperty(ya,"__esModule",{value:!0});ya.typedInstanceCreator=ya.strEnumArray=ya.staticAssertSame=ya.staticAssertIsOptional=ya.staticAssertIs=ya.staticAssertExtends=ya.singleton=ya.safePush=ya.safeConcat=ya.pair=ya.numEnumMap=ya.numEnumArray=ya.now=ya.mapFromArrayOfPairs=ya.makeStringMap=ya.makeStringCompareCI=ya.makeNewtypeIso=ya.isNone=ya.isDefined=ya.identity=ya.filterOutNones=ya.fastMin=ya.fastMax=ya.fastAbs=ya.cloneStringMap=void 0;var qs=Cn(),Oje=qs.core.makeNewtypeIso;ya.makeNewtypeIso=Oje;var kje=qs.core.staticAssertExtends;ya.staticAssertExtends=kje;var Fje=qs.core.staticAssertSame;ya.staticAssertSame=Fje;var Ije=qs.core.staticAssertIs;ya.staticAssertIs=Ije;var Mje=qs.core.staticAssertIsOptional;ya.staticAssertIsOptional=Mje;var wje=qs.core.identity;ya.identity=wje;var Dje=qs.core.makeStringMap;ya.makeStringMap=Dje;var xje=qs.core.cloneStringMap;ya.cloneStringMap=xje;var Lje=qs.core.numEnumArray;ya.numEnumArray=Lje;var Bje=qs.core.numEnumMap;ya.numEnumMap=Bje;var qje=qs.core.strEnumArray;ya.strEnumArray=qje;var Uje=qs.core.safePush;ya.safePush=Uje;var Gje=qs.core.safeConcat;ya.safeConcat=Gje;var Kje=qs.core.isDefined;ya.isDefined=Kje;var Vje=qs.core.isNone;ya.isNone=Vje;var Wje=qs.core.filterOutNones;ya.filterOutNones=Wje;var jje=qs.core.pair;ya.pair=jje;var Hje=qs.core.fastMin;ya.fastMin=Hje;var Qje=qs.core.fastMax;ya.fastMax=Qje;var zje=qs.core.fastAbs;ya.fastAbs=zje;var Yje=qs.core.makeStringCompareCI;ya.makeStringCompareCI=Yje;var Jje=qs.core.typedInstanceCreator;ya.typedInstanceCreator=Jje;var Xje=qs.core.singleton;ya.singleton=Xje;var Zje=qs.core.mapFromArrayOfPairs;ya.mapFromArrayOfPairs=Zje;var $je=qs.core.now;ya.now=$je});var Ai=Y(Yc=>{_();Object.defineProperty(Yc,"__esModule",{value:!0});Yc.ulsLogger=Yc.assertTrue=Yc.assertPositiveLength=Yc.assertPositiveInteger=Yc.assertNever=Yc.assertNatural=Yc.assertInteger=Yc.assertIndex=Yc.assertFalse=void 0;var sC=Cn(),eHe=sC.assertions.ulsLogger;Yc.ulsLogger=eHe;var rHe=sC.assertions.assertTrue;Yc.assertTrue=rHe;var nHe=sC.assertions.assertFalse;Yc.assertFalse=nHe;var tHe=sC.assertions.assertNever;Yc.assertNever=tHe;var aHe=sC.assertions.assertNatural;Yc.assertNatural=aHe;var iHe=sC.assertions.assertIndex;Yc.assertIndex=iHe;var oHe=sC.assertions.assertInteger;Yc.assertInteger=oHe;var uHe=sC.assertions.assertPositiveInteger;Yc.assertPositiveInteger=uHe;var sHe=sC.assertions.assertPositiveLength;Yc.assertPositiveLength=sHe});var ig=Y(Yl=>{_();Object.defineProperty(Yl,"__esModule",{value:!0});Yl.values=Yl.stringStartsWith=Yl.stringEndsWith=Yl.repeat=Yl.prependErrorMessage=Yl.partialArray=Yl.messageFromError=Yl.mathLog2=Yl.isInteger=Yl.arrayFill=void 0;var r1=Cn(),lHe=r1.util.arrayFill;Yl.arrayFill=lHe;var cHe=r1.util.isInteger;Yl.isInteger=cHe;var dHe=r1.util.mathLog2;Yl.mathLog2=dHe;var fHe=r1.util.messageFromError;Yl.messageFromError=fHe;var pHe=r1.util.partialArray;Yl.partialArray=pHe;var mHe=r1.util.prependErrorMessage;Yl.prependErrorMessage=mHe;var gHe=r1.util.repeat;Yl.repeat=gHe;var vHe=r1.util.stringEndsWith;Yl.stringEndsWith=vHe;var hHe=r1.util.stringStartsWith;Yl.stringStartsWith=hHe;var SHe=r1.util.values;Yl.values=SHe});var gY=Y($6=>{_();Object.defineProperty($6,"__esModule",{value:!0});$6.Deque=void 0;var yHe=Cn(),CHe=yHe.deque.Deque;$6.Deque=CHe});var rB=Y(eB=>{_();Object.defineProperty(eB,"__esModule",{value:!0});eB.Pledge=void 0;var _He=Cn(),RHe=_He.pledge.Pledge;eB.Pledge=RHe});var wme=Y(FM=>{_();Object.defineProperty(FM,"__esModule",{value:!0});FM.common=void 0;var Rp=DA(ft()),qb=DA(Ai()),kM=DA(ig()),THe=DA(gY()),Ime=DA(Cn()),bHe=DA(rB());function Mme(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,n=new WeakMap;return(Mme=function(o){return o?n:r})(e)}function DA(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var n=Mme(r);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(u!=="default"&&Object.prototype.hasOwnProperty.call(e,u)){var t=o?Object.getOwnPropertyDescriptor(e,u):null;t&&(t.get||t.set)?Object.defineProperty(a,u,t):a[u]=e[u]}return a.default=e,n&&n.set(e,a),a}var vY;FM.common=vY;(function(e){e.fastMin=Rp.fastMin,e.fastMax=Rp.fastMax,e.fastAbs=Rp.fastAbs,e.identity=Rp.identity,e.numEnumArray=Rp.numEnumArray,e.numEnumMap=Rp.numEnumMap,e.safePush=Rp.safePush,e.safeConcat=Rp.safeConcat,e.isDefined=Rp.isDefined,e.isNone=Rp.isNone,e.makeStringMap=Rp.makeStringMap,e.now=Rp.now,e.staticAssertExtends=Rp.staticAssertExtends,e.staticAssertSame=Rp.staticAssertSame,e.staticAssertIs=Rp.staticAssertIs,e.staticAssertIsOptional=Rp.staticAssertIsOptional,e.JSF32=Ime.JSF32,e.Pledge=bHe.Pledge,e.assertNever=qb.assertNever,e.assertNatural=qb.assertNatural,e.assertTrue=qb.assertTrue,e.assertFalse=qb.assertFalse,e.assertPositiveLength=qb.assertPositiveLength,e.assertPositiveInteger=qb.assertPositiveInteger,e.assertIndex=qb.assertIndex,e.messageFromError=kM.messageFromError,e.isInteger=kM.isInteger,e.stringStartsWith=kM.stringStartsWith,e.stringEndsWith=kM.stringEndsWith,e.arrayFill=kM.arrayFill,e.ResultKind=Ime.result.ResultKind;var r;(function(n){n.Deque=THe.Deque})(r=e.ds||(e.ds={}))})(vY||(FM.common=vY={}))});var Jc=Y(Tp=>{_();Object.defineProperty(Tp,"__esModule",{value:!0});Tp.isTypedChangeGateEnabled=Tp.isFeatureEnabled=Tp.initFeatureConfiguration=Tp.getTypedFeatureGate=Tp.getFeatures=Tp.FeatureName=void 0;Object.defineProperty(Tp,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return Dme.overrideTypedFeatureGates}});Object.defineProperty(Tp,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return Dme.setFeatureGateDictionaryGetter}});var xA=Cn(),Dme=Ql(),PHe=xA.featureConfiguration.FeatureName;Tp.FeatureName=PHe;var EHe=xA.featureConfiguration.initFeatureConfiguration;Tp.initFeatureConfiguration=EHe;var NHe=xA.featureConfiguration.isFeatureEnabled;Tp.isFeatureEnabled=NHe;var AHe=xA.featureConfiguration.getFeatures;Tp.getFeatures=AHe;var OHe=xA.featureConfiguration.getTypedFeatureGate;Tp.getTypedFeatureGate=OHe;var kHe=xA.featureConfiguration.isTypedChangeGateEnabled;Tp.isTypedChangeGateEnabled=kHe});var Di=Y(bp=>{_();Object.defineProperty(bp,"__esModule",{value:!0});bp.successUndefined=bp.success=bp.javaScriptError=bp.isSuccess=bp.failure=bp.ResultKind=bp.ReasonKind=void 0;var Ub=Cn(),FHe=Ub.result.ReasonKind;bp.ReasonKind=FHe;var IHe=Ub.result.ResultKind;bp.ResultKind=IHe;var MHe=Ub.result.failure;bp.failure=MHe;var wHe=Ub.result.isSuccess;bp.isSuccess=wHe;var DHe=Ub.result.javaScriptError;bp.javaScriptError=DHe;var xHe=Ub.result.success;bp.success=xHe;var LHe=Ub.result.successUndefined;bp.successUndefined=LHe});var lC=Y(Pp=>{"use strict";_();Object.defineProperty(Pp,"__esModule",{value:!0});Pp.functionType=Pp.FunctionFlags=Pp.SpecialPrecs=Pp.SignatureType=Pp.OperKind=void 0;var hY=Cn(),BHe=hY.assertions.assertNatural,xme=hY.assertions.assertFalse,qHe=hY.assertions.assertIndex,UHe;(function(e){e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=4]="Boolean",e[e.Error=8]="Error",e[e.Range=16]="Range",e[e.Array=32]="Array",e[e.Missing=64]="Missing",e[e.Blank=128]="Blank",e[e.Rich=256]="Rich"})(UHe=Pp.OperKind||(Pp.OperKind={}));var GHe;(function(e){e[e.None=0]="None",e[e.Goto=512]="Goto",e[e.Ref3D=1024]="Ref3D",e[e.All=2047]="All"})(GHe=Pp.SignatureType||(Pp.SignatureType={}));var KHe;(function(e){e[e.None=0]="None",e[e.OwnDoc=1]="OwnDoc",e[e.OwnSheet=2]="OwnSheet",e[e.OwnRow=4]="OwnRow",e[e.OwnCol=8]="OwnCol",e[e.OwnRowCopy=16]="OwnRowCopy",e[e.OwnColCopy=32]="OwnColCopy",e[e.OwnDocSheets=64]="OwnDocSheets",e[e.CellProps=128]="CellProps",e[e.AllCells=256]="AllCells",e[e.AllNames=512]="AllNames",e[e.Time=1024]="Time",e[e.Calc=2048]="Calc",e[e.InFilterMode=4096]="InFilterMode",e[e.RefStyle=8192]="RefStyle",e[e.All=16383]="All"})(KHe=Pp.SpecialPrecs||(Pp.SpecialPrecs={}));var VHe;(function(e){e[e.None=0]="None",e[e.Dark=1]="Dark",e[e.Macro=2]="Macro",e[e.OnlyParsedDuringLoad=4]="OnlyParsedDuringLoad",e[e.Internal=8]="Internal",e[e.Allow3dRef=16]="Allow3dRef",e[e.HiddenFromUI=32]="HiddenFromUI"})(VHe=Pp.FunctionFlags||(Pp.FunctionFlags={}));function WHe(e,r,n,a,o,u,t,d){if(BHe("calc.lang.functionType",r),qHe("calc.lang.functionType",e,r+1),a.length===0?o.length!==0:o.length>=a.length){var s=JSON.stringify(o);xme("calc.lang.functionType: expected tailTypes.length < restTypes.length; given ".concat(s))}if(a.length===0&&n.length+o.length<r){var s=JSON.stringify(n);xme("calc.lang.functionType: expected headTypes.length + tailTypes.length >= ".concat(r,"; given ").concat(s))}return{minArgs:e,maxArgs:r,headTypes:n,restTypes:a,tailTypes:o,returnType:u,staticPrecs:t,flags:d}}Pp.functionType=WHe});var Gb=Y(Dn=>{"use strict";_();var nf;Object.defineProperty(Dn,"__esModule",{value:!0});Dn.falseOper=Dn.trueOper=Dn.blankOper=Dn.missingOper=Dn.range3DOper=Dn.rangeSeqOper=Dn.arrayOper=Dn.externalErrorOper=Dn.busyErrorOper=Dn.calcErrorOper=Dn.fieldErrorOper=Dn.unknownErrorOper=Dn.blockedErrorOper=Dn.connectErrorOper=Dn.spillErrorOper=Dn.gettingDataErrorOper=Dn.naErrorOper=Dn.numErrorOper=Dn.nameErrorOper=Dn.refErrorOper=Dn.valueErrorOper=Dn.div0ErrorOper=Dn.nullErrorOper=Dn.errorOper=Dn.stringOper=Dn.booleanOper=Dn.precedents=Dn.ErrorType=Dn.cellStringLimit=Dn.PrecsBound=void 0;var nB=Cn(),Lme=nB.assertions.assertNatural,jHe=nB.assertions.assertPositiveInteger,HHe=nB.assertions.assertFalse,QHe=nB.util.partialArray,cC=lC(),zHe;(function(e){e[e.Lower=-1]="Lower",e[e.Exact=0]="Exact",e[e.Upper=1]="Upper"})(zHe=Dn.PrecsBound||(Dn.PrecsBound={}));Dn.cellStringLimit=32767;var Io;(function(e){e[e.NULL=1]="NULL",e[e.DIV0=2]="DIV0",e[e.VALUE=3]="VALUE",e[e.REF=4]="REF",e[e.NAME=5]="NAME",e[e.NUM=6]="NUM",e[e.NA=7]="NA",e[e.GETTING_DATA=8]="GETTING_DATA",e[e.SPILL=9]="SPILL",e[e.CONNECT=10]="CONNECT",e[e.BLOCKED=11]="BLOCKED",e[e.UNKNOWN=12]="UNKNOWN",e[e.FIELD=13]="FIELD",e[e.CALC=14]="CALC",e[e.BUSY=16]="BUSY",e[e.EXTERNAL=19]="EXTERNAL"})(Io=Dn.ErrorType||(Dn.ErrorType={}));function YHe(e,r,n,a,o){return{cells:e,names:r,udfs:n,special:a,bound:o}}Dn.precedents=YHe;function JHe(e){return e?Dn.trueOper:Dn.falseOper}Dn.booleanOper=JHe;function XHe(e){return{kind:cC.OperKind.String,value:e}}Dn.stringOper=XHe;function ZHe(e){var r=$He[e];return r!==void 0?r:Xf(e)}Dn.errorOper=ZHe;Dn.nullErrorOper=Xf(Io.NULL);Dn.div0ErrorOper=Xf(Io.DIV0);Dn.valueErrorOper=Xf(Io.VALUE);Dn.refErrorOper=Xf(Io.REF);Dn.nameErrorOper=Xf(Io.NAME);Dn.numErrorOper=Xf(Io.NUM);Dn.naErrorOper=Xf(Io.NA);Dn.gettingDataErrorOper=Xf(Io.GETTING_DATA);Dn.spillErrorOper=Xf(Io.SPILL);Dn.connectErrorOper=Xf(Io.CONNECT);Dn.blockedErrorOper=Xf(Io.BLOCKED);Dn.unknownErrorOper=Xf(Io.UNKNOWN);Dn.fieldErrorOper=Xf(Io.FIELD);Dn.calcErrorOper=Xf(Io.CALC);Dn.busyErrorOper=Xf(Io.BUSY);Dn.externalErrorOper=Xf(Io.EXTERNAL);function Xf(e){return{kind:cC.OperKind.Error,type:e}}var $He=QHe((nf={},nf[Io.NULL]=Dn.nullErrorOper,nf[Io.DIV0]=Dn.div0ErrorOper,nf[Io.VALUE]=Dn.valueErrorOper,nf[Io.REF]=Dn.refErrorOper,nf[Io.NAME]=Dn.nameErrorOper,nf[Io.NUM]=Dn.numErrorOper,nf[Io.NA]=Dn.naErrorOper,nf[Io.GETTING_DATA]=Dn.gettingDataErrorOper,nf[Io.SPILL]=Dn.spillErrorOper,nf[Io.CONNECT]=Dn.connectErrorOper,nf[Io.BLOCKED]=Dn.blockedErrorOper,nf[Io.UNKNOWN]=Dn.unknownErrorOper,nf[Io.FIELD]=Dn.fieldErrorOper,nf[Io.CALC]=Dn.calcErrorOper,nf[Io.BUSY]=Dn.busyErrorOper,nf[Io.EXTERNAL]=Dn.externalErrorOper,nf));function eQe(e,r,n){return Lme("calc.lang.arrayOper",e),Lme("calc.lang.arrayOper",r),n.length!==e?HHe("calc.lang.arrayOper: Inconsistent row number"):{kind:cC.OperKind.Array,rows:e,cols:r,opers:n}}Dn.arrayOper=eQe;function rQe(e,r){return jHe("calc.lang.rangeSeqOper",r.length),{kind:cC.OperKind.Range,sheets:e,ranges:r}}Dn.rangeSeqOper=rQe;function nQe(e,r){return{kind:cC.OperKind.Range,sheets:e,ranges:[r]}}Dn.range3DOper=nQe;Dn.missingOper={kind:cC.OperKind.Missing};Dn.blankOper={kind:cC.OperKind.Blank};Dn.trueOper={kind:cC.OperKind.Boolean,value:!0};Dn.falseOper={kind:cC.OperKind.Boolean,value:!1}});var sv=Y(tt=>{"use strict";_();Object.defineProperty(tt,"__esModule",{value:!0});tt.isSheetGridCell=tt.isSheetGridRange=tt.isGridCell=tt.isSheetIndex=tt.userDefinedFuncLoc=tt.nameLoc=tt.nameScope=tt.documentScope=tt.originCell=tt.sheetGridCell=tt.sheetGridRange=tt.sheetGridCube=tt.gridCell=tt.gridRange=tt.unsafeGridRange=tt.sheetRangeIndexes=tt.allSheetsRange=tt.sheetIndex=tt.sheetRange=tt.structRefColumnLoc=tt.documentLoc=tt.sheetCols=tt.sheetRows=tt.lexicalSourceUDF=tt.lexicalSourceWSF=tt.lexicalSourceName=tt.lexicalSourceGrid=tt.lexicalSourceRange=tt.lexicalSourceCell=tt.NameSource=tt.LexicalKind=void 0;var SY=Cn(),tB=SY.assertions.assertIndex,Bme=SY.assertions.assertPositiveLength,tQe=SY.assertions.assertFalse,tR;(function(e){e[e.Cell=1]="Cell",e[e.Range=2]="Range",e[e.NameManager=3]="NameManager",e[e.CondFormatting=4]="CondFormatting",e[e.DataValidation=5]="DataValidation",e[e.Indirect=6]="Indirect",e[e.WSF=7]="WSF",e[e.UDF=8]="UDF",e[e.Other=9]="Other"})(tR=tt.LexicalKind||(tt.LexicalKind={}));var aQe;(function(e){e.AppHead="AppHead",e.Plain="Plain",e.StructRef="StructRef",e.Indirect="Indirect"})(aQe=tt.NameSource||(tt.NameSource={}));function qme(e){return{kind:tR.Cell,range:e}}tt.lexicalSourceCell=qme;function Ume(e){return{kind:tR.Range,range:e}}tt.lexicalSourceRange=Ume;function iQe(e,r){switch(e){case tR.Cell:return Hme(r)?qme(r):tQe("calc.lang.lexicalSourceGrid: expected cell");case tR.Range:return Ume(r)}}tt.lexicalSourceGrid=iQe;function oQe(e){return{kind:tR.NameManager,name:e}}tt.lexicalSourceName=oQe;function uQe(e){return{kind:tR.WSF,id:e}}tt.lexicalSourceWSF=uQe;function sQe(e){return{kind:tR.UDF,udf:e}}tt.lexicalSourceUDF=sQe;tt.sheetRows=1048576;tt.sheetCols=16384;function lQe(e,r){return{path:e,name:r}}tt.documentLoc=lQe;function cQe(e,r,n,a){return{name:e,range:r,hasHeadersRow:n,hasTotalsRow:a}}tt.structRefColumnLoc=cQe;function Gme(e,r,n){return{document:e,index:r,index2:n}}tt.sheetRange=Gme;function Kme(e,r){return Gme(e,r,r)}tt.sheetIndex=Kme;function dQe(e){return{document:e,index:void 0,index2:void 0}}tt.allSheetsRange=dQe;function fQe(e,r){return{sheets:e,position:r}}tt.sheetRangeIndexes=fQe;function yY(e,r,n,a){return{row:e,col:r,rows:n,cols:a}}tt.unsafeGridRange=yY;function pQe(e,r,n,a){return tB("calc.lang.gridRange",e,tt.sheetRows),tB("calc.lang.gridRange",r,tt.sheetCols),Bme("calc.lang.gridRange",n,tt.sheetRows-e),Bme("calc.lang.gridRange",a,tt.sheetCols-r),yY(e,r,n,a)}tt.gridRange=pQe;function mQe(e,r){return tB("calc.lang.gridCell",e,tt.sheetRows),tB("calc.lang.gridCell",r,tt.sheetCols),yY(e,r,1,1)}tt.gridCell=mQe;function aB(e,r){return{sheet:e,range:r}}tt.sheetGridCube=aB;tt.sheetGridRange=aB;tt.sheetGridCell=aB;tt.originCell=aB;function Vme(e){return{document:e,index:void 0}}tt.documentScope=Vme;function gQe(e,r){return r===void 0?Vme(e):Kme(e,r)}tt.nameScope=gQe;function vQe(e,r){return{scope:e,name:r}}tt.nameLoc=vQe;function hQe(e,r){return{document:e,id:r}}tt.userDefinedFuncLoc=hQe;function Wme(e){return e.index===e.index2}tt.isSheetIndex=Wme;function jme(e){return e.rows===1&&e.cols===1}tt.isGridCell=jme;function SQe(e){return Wme(e.sheet)}tt.isSheetGridRange=SQe;function Hme(e){return jme(e.range)}tt.isSheetGridCell=Hme});var CY=Y(iB=>{"use strict";_();Object.defineProperty(iB,"__esModule",{value:!0});iB.getCharCodeBits=void 0;var yQe=Cn(),CQe=yQe.unicode.makeGetCharCodeBits;iB.getCharCodeBits=CQe([65,91,92,93,95,96,97,123,170,171,181,182,186,187,192,215,216,247,248,706,710,722,736,741,748,749,750,751,880,885,886,888,890,894,895,896,902,903,904,907,908,909,910,930,931,1014,1015,1154,1162,1328,1329,1367,1369,1370,1376,1417,1488,1515,1519,1523,1568,1611,1646,1648,1649,1748,1749,1750,1765,1767,1774,1776,1786,1789,1791,1792,1808,1809,1810,1840,1869,1958,1969,1970,1994,2027,2036,2038,2042,2043,2048,2070,2074,2075,2084,2085,2088,2089,2112,2137,2144,2155,2208,2229,2230,2248,2308,2362,2365,2366,2384,2385,2392,2402,2417,2433,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2493,2494,2510,2511,2524,2526,2527,2530,2544,2546,2556,2557,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2649,2653,2654,2655,2674,2677,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2749,2750,2768,2769,2784,2786,2809,2810,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2877,2878,2908,2910,2911,2914,2929,2930,2947,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3024,3025,3077,3085,3086,3089,3090,3113,3114,3130,3133,3134,3160,3163,3168,3170,3200,3201,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3261,3262,3294,3295,3296,3298,3313,3315,3332,3341,3342,3345,3346,3387,3389,3390,3406,3407,3412,3415,3423,3426,3450,3456,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3585,3643,3648,3663,3713,3715,3716,3717,3718,3723,3724,3748,3749,3750,3751,3761,3762,3764,3773,3774,3776,3781,3782,3783,3804,3808,3840,3841,3904,3912,3913,3949,3976,3981,4096,4139,4159,4160,4176,4182,4186,4190,4193,4194,4197,4199,4206,4209,4213,4226,4238,4239,4256,4294,4295,4296,4301,4302,4304,4347,4348,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4992,5008,5024,5110,5112,5118,5121,5741,5743,5760,5761,5787,5792,5867,5870,5881,5888,5901,5902,5906,5920,5938,5952,5970,5984,5997,5998,6001,6016,6068,6103,6104,6108,6109,6176,6265,6272,6313,6314,6315,6320,6390,6400,6431,6480,6510,6512,6517,6528,6572,6576,6602,6656,6679,6688,6741,6823,6824,6917,6964,6981,6988,7043,7073,7086,7088,7098,7142,7168,7204,7245,7248,7258,7294,7296,7305,7312,7355,7357,7360,7401,7405,7406,7412,7413,7415,7418,7419,7424,7616,7680,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8125,8126,8127,8130,8133,8134,8141,8144,8148,8150,8156,8160,8173,8178,8181,8182,8189,8305,8306,8319,8320,8336,8349,8450,8451,8455,8456,8458,8468,8469,8470,8472,8478,8484,8485,8486,8487,8488,8489,8490,8506,8508,8512,8517,8522,8526,8527,8544,8585,11264,11311,11312,11359,11360,11493,11499,11503,11506,11508,11520,11558,11559,11560,11565,11566,11568,11624,11631,11632,11648,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,12293,12296,12321,12330,12337,12342,12344,12349,12353,12439,12443,12448,12449,12539,12540,12544,12549,12592,12593,12687,12704,12736,12784,12800,13312,19904,19968,40957,40960,42125,42192,42238,42240,42509,42512,42528,42538,42540,42560,42607,42623,42654,42656,42736,42775,42784,42786,42889,42891,42944,42946,42955,42997,43010,43011,43014,43015,43019,43020,43043,43072,43124,43138,43188,43250,43256,43259,43260,43261,43263,43274,43302,43312,43335,43360,43389,43396,43443,43471,43472,43488,43493,43494,43504,43514,43519,43520,43561,43584,43587,43588,43596,43616,43639,43642,43643,43646,43696,43697,43698,43701,43703,43705,43710,43712,43713,43714,43715,43739,43742,43744,43755,43762,43765,43777,43783,43785,43791,43793,43799,43808,43815,43816,43823,43824,43867,43868,43882,43888,44003,44032,55204,55216,55239,55243,55292,63744,64110,64112,64218,64256,64263,64275,64280,64285,64286,64287,64297,64298,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64434,64467,64830,64848,64912,64914,64968,65008,65020,65136,65141,65142,65277,65313,65339,65345,65371,65382,65471,65474,65480,65482,65488,65490,65496,65498,65501],[48,58,63,64,65,91,92,93,95,96,97,123,162,167,168,171,174,177,178,182,183,187,188,191,192,215,216,247,248,888,890,894,895,896,900,907,908,909,910,930,931,1328,1329,1367,1369,1370,1376,1417,1421,1424,1425,1470,1471,1472,1473,1475,1476,1478,1479,1480,1488,1515,1519,1523,1536,1545,1547,1548,1550,1563,1564,1565,1567,1642,1646,1748,1749,1792,1807,1867,1869,1970,1984,2039,2042,2043,2045,2094,2112,2140,2144,2155,2208,2229,2230,2248,2259,2404,2406,2416,2417,2436,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2492,2501,2503,2505,2507,2511,2519,2520,2524,2526,2527,2532,2534,2557,2558,2559,2561,2564,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2620,2621,2622,2627,2631,2633,2635,2638,2641,2642,2649,2653,2654,2655,2662,2678,2689,2692,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2748,2758,2759,2762,2763,2766,2768,2769,2784,2788,2790,2800,2801,2802,2809,2816,2817,2820,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2876,2885,2887,2889,2891,2894,2901,2904,2908,2910,2911,2916,2918,2936,2946,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3006,3011,3014,3017,3018,3022,3024,3025,3031,3032,3046,3067,3072,3085,3086,3089,3090,3113,3114,3130,3133,3141,3142,3145,3146,3150,3157,3159,3160,3163,3168,3172,3174,3184,3192,3204,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3260,3269,3270,3273,3274,3278,3285,3287,3294,3295,3296,3300,3302,3312,3313,3315,3328,3341,3342,3345,3346,3397,3398,3401,3402,3408,3412,3428,3430,3456,3457,3460,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3530,3531,3535,3541,3542,3543,3544,3552,3558,3568,3570,3572,3585,3643,3647,3663,3664,3674,3713,3715,3716,3717,3718,3723,3724,3748,3749,3750,3751,3774,3776,3781,3782,3783,3784,3790,3792,3802,3804,3808,3840,3844,3859,3860,3861,3898,3902,3912,3913,3949,3953,3973,3974,3992,3993,4029,4030,4045,4046,4048,4053,4057,4096,4170,4176,4294,4295,4296,4301,4302,4304,4347,4348,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4957,4960,4969,4989,4992,5018,5024,5110,5112,5118,5121,5742,5743,5760,5761,5787,5792,5867,5870,5881,5888,5901,5902,5909,5920,5941,5952,5972,5984,5997,5998,6001,6002,6004,6016,6100,6103,6104,6107,6110,6112,6122,6128,6138,6155,6159,6160,6170,6176,6265,6272,6315,6320,6390,6400,6431,6432,6444,6448,6460,6464,6465,6470,6510,6512,6517,6528,6572,6576,6602,6608,6619,6622,6684,6688,6751,6752,6781,6783,6794,6800,6810,6823,6824,6832,6849,6912,6988,6992,7002,7009,7037,7040,7156,7168,7224,7232,7242,7245,7294,7296,7305,7312,7355,7357,7360,7376,7379,7380,7419,7424,7674,7675,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8133,8134,8148,8150,8156,8157,8176,8178,8181,8182,8191,8203,8208,8234,8239,8255,8257,8260,8261,8274,8275,8276,8277,8288,8293,8294,8306,8308,8317,8319,8333,8336,8349,8352,8384,8400,8433,8448,8588,8592,9001,9003,9255,9280,9291,9312,10088,10102,10181,10183,10214,10224,10627,10649,10712,10716,10748,10750,11124,11126,11158,11159,11311,11312,11359,11360,11508,11517,11518,11520,11558,11559,11560,11565,11566,11568,11624,11631,11632,11647,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,11744,11776,11823,11824,11856,11858,11904,11930,11931,12020,12032,12246,12272,12284,12292,12296,12306,12308,12320,12336,12337,12349,12350,12352,12353,12439,12441,12448,12449,12539,12540,12544,12549,12592,12593,12687,12688,12772,12784,12831,12832,40957,40960,42125,42128,42183,42192,42238,42240,42509,42512,42540,42560,42611,42612,42622,42623,42738,42752,42944,42946,42955,42997,43053,43056,43066,43072,43124,43136,43206,43216,43226,43232,43256,43259,43260,43261,43310,43312,43348,43360,43389,43392,43457,43471,43482,43488,43519,43520,43575,43584,43598,43600,43610,43616,43715,43739,43742,43744,43760,43762,43767,43777,43783,43785,43791,43793,43799,43808,43815,43816,43823,43824,43884,43888,44011,44012,44014,44016,44026,44032,55204,55216,55239,55243,55292,63744,64110,64112,64218,64256,64263,64275,64280,64285,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64450,64467,64830,64848,64912,64914,64968,65008,65022,65024,65040,65056,65072,65075,65077,65101,65104,65122,65123,65124,65127,65129,65130,65136,65141,65142,65277,65279,65280,65284,65285,65291,65292,65296,65306,65308,65311,65313,65339,65342,65371,65372,65373,65374,65375,65382,65471,65474,65480,65482,65488,65490,65496,65498,65501,65504,65511,65512,65519,65529,65534])});var oB=Y(dC=>{"use strict";_();Object.defineProperty(dC,"__esModule",{value:!0});dC.worksheetFuncTypes=dC.worksheetFuncEnglishNames=dC.WorksheetFuncId=void 0;var _Qe=lC(),RQe;(function(e){e[e.COUNT=0]="COUNT",e[e.IF=1]="IF",e[e.ISNA=2]="ISNA",e[e.ISERROR=3]="ISERROR",e[e.SUM=4]="SUM",e[e.AVERAGE=5]="AVERAGE",e[e.MIN=6]="MIN",e[e.MAX=7]="MAX",e[e.ROW=8]="ROW",e[e.COLUMN=9]="COLUMN",e[e.NA=10]="NA",e[e.NPV=11]="NPV",e[e.STDEV=12]="STDEV",e[e.DOLLAR=13]="DOLLAR",e[e.FIXED=14]="FIXED",e[e.SIN=15]="SIN",e[e.COS=16]="COS",e[e.TAN=17]="TAN",e[e.ATAN=18]="ATAN",e[e.PI=19]="PI",e[e.SQRT=20]="SQRT",e[e.EXP=21]="EXP",e[e.LN=22]="LN",e[e.LOG10=23]="LOG10",e[e.ABS=24]="ABS",e[e.INT=25]="INT",e[e.SIGN=26]="SIGN",e[e.ROUND=27]="ROUND",e[e.LOOKUP=28]="LOOKUP",e[e.INDEX=29]="INDEX",e[e.REPT=30]="REPT",e[e.MID=31]="MID",e[e.LEN=32]="LEN",e[e.VALUE=33]="VALUE",e[e.TRUE=34]="TRUE",e[e.FALSE=35]="FALSE",e[e.AND=36]="AND",e[e.OR=37]="OR",e[e.NOT=38]="NOT",e[e.MOD=39]="MOD",e[e.DCOUNT=40]="DCOUNT",e[e.DSUM=41]="DSUM",e[e.DAVERAGE=42]="DAVERAGE",e[e.DMIN=43]="DMIN",e[e.DMAX=44]="DMAX",e[e.DSTDEV=45]="DSTDEV",e[e.VAR=46]="VAR",e[e.DVAR=47]="DVAR",e[e.TEXT=48]="TEXT",e[e.LINEST=49]="LINEST",e[e.TREND=50]="TREND",e[e.LOGEST=51]="LOGEST",e[e.GROWTH=52]="GROWTH",e[e.GOTO=53]="GOTO",e[e.HALT=54]="HALT",e[e.RETURN=55]="RETURN",e[e.PV=56]="PV",e[e.FV=57]="FV",e[e.NPER=58]="NPER",e[e.PMT=59]="PMT",e[e.RATE=60]="RATE",e[e.MIRR=61]="MIRR",e[e.IRR=62]="IRR",e[e.RAND=63]="RAND",e[e.MATCH=64]="MATCH",e[e.DATE=65]="DATE",e[e.TIME=66]="TIME",e[e.DAY=67]="DAY",e[e.MONTH=68]="MONTH",e[e.YEAR=69]="YEAR",e[e.WEEKDAY=70]="WEEKDAY",e[e.HOUR=71]="HOUR",e[e.MINUTE=72]="MINUTE",e[e.SECOND=73]="SECOND",e[e.NOW=74]="NOW",e[e.AREAS=75]="AREAS",e[e.ROWS=76]="ROWS",e[e.COLUMNS=77]="COLUMNS",e[e.OFFSET=78]="OFFSET",e[e.ABSREF=79]="ABSREF",e[e.RELREF=80]="RELREF",e[e.ARGUMENT=81]="ARGUMENT",e[e.SEARCH=82]="SEARCH",e[e.TRANSPOSE=83]="TRANSPOSE",e[e.ERROR=84]="ERROR",e[e.STEP=85]="STEP",e[e.TYPE=86]="TYPE",e[e.ECHO=87]="ECHO",e[e.SET_NAME=88]="SET_NAME",e[e.CALLER=89]="CALLER",e[e.DEREF=90]="DEREF",e[e.WINDOWS=91]="WINDOWS",e[e.SERIES=92]="SERIES",e[e.DOCUMENTS=93]="DOCUMENTS",e[e.ACTIVE_CELL=94]="ACTIVE_CELL",e[e.SELECTION=95]="SELECTION",e[e.RESULT=96]="RESULT",e[e.ATAN2=97]="ATAN2",e[e.ASIN=98]="ASIN",e[e.ACOS=99]="ACOS",e[e.CHOOSE=100]="CHOOSE",e[e.HLOOKUP=101]="HLOOKUP",e[e.VLOOKUP=102]="VLOOKUP",e[e.LINKS=103]="LINKS",e[e.INPUT=104]="INPUT",e[e.ISREF=105]="ISREF",e[e.GET_FORMULA=106]="GET_FORMULA",e[e.GET_NAME=107]="GET_NAME",e[e.SET_VALUE=108]="SET_VALUE",e[e.LOG=109]="LOG",e[e.EXEC=110]="EXEC",e[e.CHAR=111]="CHAR",e[e.LOWER=112]="LOWER",e[e.UPPER=113]="UPPER",e[e.PROPER=114]="PROPER",e[e.LEFT=115]="LEFT",e[e.RIGHT=116]="RIGHT",e[e.EXACT=117]="EXACT",e[e.TRIM=118]="TRIM",e[e.REPLACE=119]="REPLACE",e[e.SUBSTITUTE=120]="SUBSTITUTE",e[e.CODE=121]="CODE",e[e.NAMES=122]="NAMES",e[e.DIRECTORY=123]="DIRECTORY",e[e.FIND=124]="FIND",e[e.CELL=125]="CELL",e[e.ISERR=126]="ISERR",e[e.ISTEXT=127]="ISTEXT",e[e.ISNUMBER=128]="ISNUMBER",e[e.ISBLANK=129]="ISBLANK",e[e.T=130]="T",e[e.N=131]="N",e[e.FOPEN=132]="FOPEN",e[e.FCLOSE=133]="FCLOSE",e[e.FSIZE=134]="FSIZE",e[e.FREADLN=135]="FREADLN",e[e.FREAD=136]="FREAD",e[e.FWRITELN=137]="FWRITELN",e[e.FWRITE=138]="FWRITE",e[e.FPOS=139]="FPOS",e[e.DATEVALUE=140]="DATEVALUE",e[e.TIMEVALUE=141]="TIMEVALUE",e[e.SLN=142]="SLN",e[e.SYD=143]="SYD",e[e.DDB=144]="DDB",e[e.GET_DEF=145]="GET_DEF",e[e.REFTEXT=146]="REFTEXT",e[e.TEXTREF=147]="TEXTREF",e[e.INDIRECT=148]="INDIRECT",e[e.REGISTER=149]="REGISTER",e[e.CALL=150]="CALL",e[e.ADD_BAR=151]="ADD_BAR",e[e.ADD_MENU=152]="ADD_MENU",e[e.ADD_COMMAND=153]="ADD_COMMAND",e[e.ENABLE_COMMAND=154]="ENABLE_COMMAND",e[e.CHECK_COMMAND=155]="CHECK_COMMAND",e[e.RENAME_COMMAND=156]="RENAME_COMMAND",e[e.SHOW_BAR=157]="SHOW_BAR",e[e.DELETE_MENU=158]="DELETE_MENU",e[e.DELETE_COMMAND=159]="DELETE_COMMAND",e[e.GET_CHART_ITEM=160]="GET_CHART_ITEM",e[e.DIALOG_BOX=161]="DIALOG_BOX",e[e.CLEAN=162]="CLEAN",e[e.MDETERM=163]="MDETERM",e[e.MINVERSE=164]="MINVERSE",e[e.MMULT=165]="MMULT",e[e.FILES=166]="FILES",e[e.IPMT=167]="IPMT",e[e.PPMT=168]="PPMT",e[e.COUNTA=169]="COUNTA",e[e.CANCEL_KEY=170]="CANCEL_KEY",e[e.FOR=171]="FOR",e[e.WHILE=172]="WHILE",e[e.BREAK=173]="BREAK",e[e.NEXT=174]="NEXT",e[e.INITIATE=175]="INITIATE",e[e.REQUEST=176]="REQUEST",e[e.POKE=177]="POKE",e[e.EXECUTE=178]="EXECUTE",e[e.TERMINATE=179]="TERMINATE",e[e.RESTART=180]="RESTART",e[e.HELP=181]="HELP",e[e.GET_BAR=182]="GET_BAR",e[e.PRODUCT=183]="PRODUCT",e[e.FACT=184]="FACT",e[e.GET_CELL=185]="GET_CELL",e[e.GET_WORKSPACE=186]="GET_WORKSPACE",e[e.GET_WINDOW=187]="GET_WINDOW",e[e.GET_DOCUMENT=188]="GET_DOCUMENT",e[e.DPRODUCT=189]="DPRODUCT",e[e.ISNONTEXT=190]="ISNONTEXT",e[e.GET_NOTE=191]="GET_NOTE",e[e.NOTE=192]="NOTE",e[e.STDEVP=193]="STDEVP",e[e.VARP=194]="VARP",e[e.DSTDEVP=195]="DSTDEVP",e[e.DVARP=196]="DVARP",e[e.TRUNC=197]="TRUNC",e[e.ISLOGICAL=198]="ISLOGICAL",e[e.DCOUNTA=199]="DCOUNTA",e[e.DELETE_BAR=200]="DELETE_BAR",e[e.UNREGISTER=201]="UNREGISTER",e[e.USDOLLAR=204]="USDOLLAR",e[e.FINDB=205]="FINDB",e[e.SEARCHB=206]="SEARCHB",e[e.REPLACEB=207]="REPLACEB",e[e.LEFTB=208]="LEFTB",e[e.RIGHTB=209]="RIGHTB",e[e.MIDB=210]="MIDB",e[e.LENB=211]="LENB",e[e.ROUNDUP=212]="ROUNDUP",e[e.ROUNDDOWN=213]="ROUNDDOWN",e[e.ASC=214]="ASC",e[e.DBCS=215]="DBCS",e[e.RANK=216]="RANK",e[e.ADDRESS=219]="ADDRESS",e[e.DAYS360=220]="DAYS360",e[e.TODAY=221]="TODAY",e[e.VDB=222]="VDB",e[e.ELSE=223]="ELSE",e[e.ELSE_IF=224]="ELSE_IF",e[e.END_IF=225]="END_IF",e[e.FOR_CELL=226]="FOR_CELL",e[e.MEDIAN=227]="MEDIAN",e[e.SUMPRODUCT=228]="SUMPRODUCT",e[e.SINH=229]="SINH",e[e.COSH=230]="COSH",e[e.TANH=231]="TANH",e[e.ASINH=232]="ASINH",e[e.ACOSH=233]="ACOSH",e[e.ATANH=234]="ATANH",e[e.DGET=235]="DGET",e[e.CREATE_OBJECT=236]="CREATE_OBJECT",e[e.VOLATILE=237]="VOLATILE",e[e.LAST_ERROR=238]="LAST_ERROR",e[e.CUSTOM_UNDO=239]="CUSTOM_UNDO",e[e.CUSTOM_REPEAT=240]="CUSTOM_REPEAT",e[e.FORMULA_CONVERT=241]="FORMULA_CONVERT",e[e.GET_LINK_INFO=242]="GET_LINK_INFO",e[e.TEXT_BOX=243]="TEXT_BOX",e[e.INFO=244]="INFO",e[e.GROUP=245]="GROUP",e[e.GET_OBJECT=246]="GET_OBJECT",e[e.DB=247]="DB",e[e.PAUSE=248]="PAUSE",e[e.RESUME=251]="RESUME",e[e.FREQUENCY=252]="FREQUENCY",e[e.ADD_TOOLBAR=253]="ADD_TOOLBAR",e[e.DELETE_TOOLBAR=254]="DELETE_TOOLBAR",e[e._UDF=255]="_UDF",e[e.RESET_TOOLBAR=256]="RESET_TOOLBAR",e[e.EVALUATE=257]="EVALUATE",e[e.GET_TOOLBAR=258]="GET_TOOLBAR",e[e.GET_TOOL=259]="GET_TOOL",e[e.SPELLING_CHECK=260]="SPELLING_CHECK",e[e.ERROR_TYPE=261]="ERROR_TYPE",e[e.APP_TITLE=262]="APP_TITLE",e[e.WINDOW_TITLE=263]="WINDOW_TITLE",e[e.SAVE_TOOLBAR=264]="SAVE_TOOLBAR",e[e.ENABLE_TOOL=265]="ENABLE_TOOL",e[e.PRESS_TOOL=266]="PRESS_TOOL",e[e.REGISTER_ID=267]="REGISTER_ID",e[e.GET_PROJECT=268]="GET_PROJECT",e[e.AVEDEV=269]="AVEDEV",e[e.BETADIST=270]="BETADIST",e[e.GAMMALN=271]="GAMMALN",e[e.BETAINV=272]="BETAINV",e[e.BINOMDIST=273]="BINOMDIST",e[e.CHIDIST=274]="CHIDIST",e[e.CHIINV=275]="CHIINV",e[e.COMBIN=276]="COMBIN",e[e.CONFIDENCE=277]="CONFIDENCE",e[e.CRITBINOM=278]="CRITBINOM",e[e.EVEN=279]="EVEN",e[e.EXPONDIST=280]="EXPONDIST",e[e.FDIST=281]="FDIST",e[e.FINV=282]="FINV",e[e.FISHER=283]="FISHER",e[e.FISHERINV=284]="FISHERINV",e[e.FLOOR=285]="FLOOR",e[e.GAMMADIST=286]="GAMMADIST",e[e.GAMMAINV=287]="GAMMAINV",e[e.CEILING=288]="CEILING",e[e.HYPGEOMDIST=289]="HYPGEOMDIST",e[e.LOGNORMDIST=290]="LOGNORMDIST",e[e.LOGINV=291]="LOGINV",e[e.NEGBINOMDIST=292]="NEGBINOMDIST",e[e.NORMDIST=293]="NORMDIST",e[e.NORMSDIST=294]="NORMSDIST",e[e.NORMINV=295]="NORMINV",e[e.NORMSINV=296]="NORMSINV",e[e.STANDARDIZE=297]="STANDARDIZE",e[e.ODD=298]="ODD",e[e.PERMUT=299]="PERMUT",e[e.POISSON=300]="POISSON",e[e.TDIST=301]="TDIST",e[e.WEIBULL=302]="WEIBULL",e[e.SUMXMY2=303]="SUMXMY2",e[e.SUMX2MY2=304]="SUMX2MY2",e[e.SUMX2PY2=305]="SUMX2PY2",e[e.CHITEST=306]="CHITEST",e[e.CORREL=307]="CORREL",e[e.COVAR=308]="COVAR",e[e.FORECAST=309]="FORECAST",e[e.FTEST=310]="FTEST",e[e.INTERCEPT=311]="INTERCEPT",e[e.PEARSON=312]="PEARSON",e[e.RSQ=313]="RSQ",e[e.STEYX=314]="STEYX",e[e.SLOPE=315]="SLOPE",e[e.TTEST=316]="TTEST",e[e.PROB=317]="PROB",e[e.DEVSQ=318]="DEVSQ",e[e.GEOMEAN=319]="GEOMEAN",e[e.HARMEAN=320]="HARMEAN",e[e.SUMSQ=321]="SUMSQ",e[e.KURT=322]="KURT",e[e.SKEW=323]="SKEW",e[e.ZTEST=324]="ZTEST",e[e.LARGE=325]="LARGE",e[e.SMALL=326]="SMALL",e[e.QUARTILE=327]="QUARTILE",e[e.PERCENTILE=328]="PERCENTILE",e[e.PERCENTRANK=329]="PERCENTRANK",e[e.MODE=330]="MODE",e[e.TRIMMEAN=331]="TRIMMEAN",e[e.TINV=332]="TINV",e[e.MOVIE_COMMAND=334]="MOVIE_COMMAND",e[e.GET_MOVIE=335]="GET_MOVIE",e[e.CONCATENATE=336]="CONCATENATE",e[e.POWER=337]="POWER",e[e.SPREADBASE_DATA_FIELD=338]="SPREADBASE_DATA_FIELD",e[e.GET_VIEW=339]="GET_VIEW",e[e.GET_FIELD=340]="GET_FIELD",e[e.GET_ITEM=341]="GET_ITEM",e[e.RADIANS=342]="RADIANS",e[e.DEGREES=343]="DEGREES",e[e.SUBTOTAL=344]="SUBTOTAL",e[e.SUMIF=345]="SUMIF",e[e.COUNTIF=346]="COUNTIF",e[e.COUNTBLANK=347]="COUNTBLANK",e[e.SCENARIO_GET=348]="SCENARIO_GET",e[e.OPTIONS_LISTS=349]="OPTIONS_LISTS",e[e.ISPMT=350]="ISPMT",e[e.DATEDIF=351]="DATEDIF",e[e.DATESTRING=352]="DATESTRING",e[e.NUMBERSTRING=353]="NUMBERSTRING",e[e.ROMAN=354]="ROMAN",e[e.OPENDIALOG=355]="OPENDIALOG",e[e.SAVEDIALOG=356]="SAVEDIALOG",e[e.VIEW_GET=357]="VIEW_GET",e[e.GETPIVOTDATA=358]="GETPIVOTDATA",e[e.HYPERLINK=359]="HYPERLINK",e[e.FURIGANA=360]="FURIGANA",e[e.AVERAGEA=361]="AVERAGEA",e[e.MAXA=362]="MAXA",e[e.MINA=363]="MINA",e[e.STDEVPA=364]="STDEVPA",e[e.VARPA=365]="VARPA",e[e.STDEVA=366]="STDEVA",e[e.VARA=367]="VARA",e[e.BAHTTEXT=368]="BAHTTEXT",e[e.THAIDOW=369]="THAIDOW",e[e.THAIDIGIT=370]="THAIDIGIT",e[e.THAIMOY=371]="THAIMOY",e[e.THAINUMSOUND=372]="THAINUMSOUND",e[e.THAINUMSTRING=373]="THAINUMSTRING",e[e.THAISTRINGLENGTH=374]="THAISTRINGLENGTH",e[e.ISTHAIDIGIT=375]="ISTHAIDIGIT",e[e.ROUNDBAHTDOWN=376]="ROUNDBAHTDOWN",e[e.ROUNDBAHTUP=377]="ROUNDBAHTUP",e[e.THAIYEAR=378]="THAIYEAR",e[e.RTD=379]="RTD",e[e.CUBEVALUE=380]="CUBEVALUE",e[e.CUBEMEMBER=381]="CUBEMEMBER",e[e.CUBEMEMBERPROPERTY=382]="CUBEMEMBERPROPERTY",e[e.CUBERANKEDMEMBER=383]="CUBERANKEDMEMBER",e[e.HEX2BIN=384]="HEX2BIN",e[e.HEX2DEC=385]="HEX2DEC",e[e.HEX2OCT=386]="HEX2OCT",e[e.DEC2BIN=387]="DEC2BIN",e[e.DEC2HEX=388]="DEC2HEX",e[e.DEC2OCT=389]="DEC2OCT",e[e.OCT2BIN=390]="OCT2BIN",e[e.OCT2HEX=391]="OCT2HEX",e[e.OCT2DEC=392]="OCT2DEC",e[e.BIN2DEC=393]="BIN2DEC",e[e.BIN2OCT=394]="BIN2OCT",e[e.BIN2HEX=395]="BIN2HEX",e[e.IMSUB=396]="IMSUB",e[e.IMDIV=397]="IMDIV",e[e.IMPOWER=398]="IMPOWER",e[e.IMABS=399]="IMABS",e[e.IMSQRT=400]="IMSQRT",e[e.IMLN=401]="IMLN",e[e.IMLOG2=402]="IMLOG2",e[e.IMLOG10=403]="IMLOG10",e[e.IMSIN=404]="IMSIN",e[e.IMCOS=405]="IMCOS",e[e.IMEXP=406]="IMEXP",e[e.IMARGUMENT=407]="IMARGUMENT",e[e.IMCONJUGATE=408]="IMCONJUGATE",e[e.IMAGINARY=409]="IMAGINARY",e[e.IMREAL=410]="IMREAL",e[e.COMPLEX=411]="COMPLEX",e[e.IMSUM=412]="IMSUM",e[e.IMPRODUCT=413]="IMPRODUCT",e[e.SERIESSUM=414]="SERIESSUM",e[e.FACTDOUBLE=415]="FACTDOUBLE",e[e.SQRTPI=416]="SQRTPI",e[e.QUOTIENT=417]="QUOTIENT",e[e.DELTA=418]="DELTA",e[e.GESTEP=419]="GESTEP",e[e.ISEVEN=420]="ISEVEN",e[e.ISODD=421]="ISODD",e[e.MROUND=422]="MROUND",e[e.ERF=423]="ERF",e[e.ERFC=424]="ERFC",e[e.BESSELJ=425]="BESSELJ",e[e.BESSELK=426]="BESSELK",e[e.BESSELY=427]="BESSELY",e[e.BESSELI=428]="BESSELI",e[e.XIRR=429]="XIRR",e[e.XNPV=430]="XNPV",e[e.PRICEMAT=431]="PRICEMAT",e[e.YIELDMAT=432]="YIELDMAT",e[e.INTRATE=433]="INTRATE",e[e.RECEIVED=434]="RECEIVED",e[e.DISC=435]="DISC",e[e.PRICEDISC=436]="PRICEDISC",e[e.YIELDDISC=437]="YIELDDISC",e[e.TBILLEQ=438]="TBILLEQ",e[e.TBILLPRICE=439]="TBILLPRICE",e[e.TBILLYIELD=440]="TBILLYIELD",e[e.PRICE=441]="PRICE",e[e.YIELD=442]="YIELD",e[e.DOLLARDE=443]="DOLLARDE",e[e.DOLLARFR=444]="DOLLARFR",e[e.NOMINAL=445]="NOMINAL",e[e.EFFECT=446]="EFFECT",e[e.CUMPRINC=447]="CUMPRINC",e[e.CUMIPMT=448]="CUMIPMT",e[e.EDATE=449]="EDATE",e[e.EOMONTH=450]="EOMONTH",e[e.YEARFRAC=451]="YEARFRAC",e[e.COUPDAYBS=452]="COUPDAYBS",e[e.COUPDAYS=453]="COUPDAYS",e[e.COUPDAYSNC=454]="COUPDAYSNC",e[e.COUPNCD=455]="COUPNCD",e[e.COUPNUM=456]="COUPNUM",e[e.COUPPCD=457]="COUPPCD",e[e.DURATION=458]="DURATION",e[e.MDURATION=459]="MDURATION",e[e.ODDLPRICE=460]="ODDLPRICE",e[e.ODDLYIELD=461]="ODDLYIELD",e[e.ODDFPRICE=462]="ODDFPRICE",e[e.ODDFYIELD=463]="ODDFYIELD",e[e.RANDBETWEEN=464]="RANDBETWEEN",e[e.WEEKNUM=465]="WEEKNUM",e[e.AMORDEGRC=466]="AMORDEGRC",e[e.AMORLINC=467]="AMORLINC",e[e.CONVERT=468]="CONVERT",e[e.ACCRINT=469]="ACCRINT",e[e.ACCRINTM=470]="ACCRINTM",e[e.WORKDAY=471]="WORKDAY",e[e.NETWORKDAYS=472]="NETWORKDAYS",e[e.GCD=473]="GCD",e[e.MULTINOMIAL=474]="MULTINOMIAL",e[e.LCM=475]="LCM",e[e.FVSCHEDULE=476]="FVSCHEDULE",e[e.CUBEKPIMEMBER=477]="CUBEKPIMEMBER",e[e.CUBESET=478]="CUBESET",e[e.CUBESETCOUNT=479]="CUBESETCOUNT",e[e.IFERROR=480]="IFERROR",e[e.COUNTIFS=481]="COUNTIFS",e[e.SUMIFS=482]="SUMIFS",e[e.AVERAGEIF=483]="AVERAGEIF",e[e.AVERAGEIFS=484]="AVERAGEIFS",e[e.AGGREGATE=485]="AGGREGATE",e[e.BINOM_DIST=486]="BINOM_DIST",e[e.BINOM_INV=487]="BINOM_INV",e[e.CONFIDENCE_NORM=488]="CONFIDENCE_NORM",e[e.CONFIDENCE_T=489]="CONFIDENCE_T",e[e.CHISQ_TEST=490]="CHISQ_TEST",e[e.F_TEST=491]="F_TEST",e[e.COVARIANCE_P=492]="COVARIANCE_P",e[e.COVARIANCE_S=493]="COVARIANCE_S",e[e.EXPON_DIST=494]="EXPON_DIST",e[e.GAMMA_DIST=495]="GAMMA_DIST",e[e.GAMMA_INV=496]="GAMMA_INV",e[e.MODE_MULT=497]="MODE_MULT",e[e.MODE_SNGL=498]="MODE_SNGL",e[e.NORM_DIST=499]="NORM_DIST",e[e.NORM_INV=500]="NORM_INV",e[e.PERCENTILE_EXC=501]="PERCENTILE_EXC",e[e.PERCENTILE_INC=502]="PERCENTILE_INC",e[e.PERCENTRANK_EXC=503]="PERCENTRANK_EXC",e[e.PERCENTRANK_INC=504]="PERCENTRANK_INC",e[e.POISSON_DIST=505]="POISSON_DIST",e[e.QUARTILE_EXC=506]="QUARTILE_EXC",e[e.QUARTILE_INC=507]="QUARTILE_INC",e[e.RANK_AVG=508]="RANK_AVG",e[e.RANK_EQ=509]="RANK_EQ",e[e.STDEV_S=510]="STDEV_S",e[e.STDEV_P=511]="STDEV_P",e[e.T_DIST=512]="T_DIST",e[e.T_DIST_2T=513]="T_DIST_2T",e[e.T_DIST_RT=514]="T_DIST_RT",e[e.T_INV=515]="T_INV",e[e.T_INV_2T=516]="T_INV_2T",e[e.VAR_S=517]="VAR_S",e[e.VAR_P=518]="VAR_P",e[e.WEIBULL_DIST=519]="WEIBULL_DIST",e[e.NETWORKDAYS_INTL=520]="NETWORKDAYS_INTL",e[e.WORKDAY_INTL=521]="WORKDAY_INTL",e[e.ECMA_CEILING=522]="ECMA_CEILING",e[e.ISO_CEILING=523]="ISO_CEILING",e[e.BETA_DIST=525]="BETA_DIST",e[e.BETA_INV=526]="BETA_INV",e[e.CHISQ_DIST=527]="CHISQ_DIST",e[e.CHISQ_DIST_RT=528]="CHISQ_DIST_RT",e[e.CHISQ_INV=529]="CHISQ_INV",e[e.CHISQ_INV_RT=530]="CHISQ_INV_RT",e[e.F_DIST=531]="F_DIST",e[e.F_DIST_RT=532]="F_DIST_RT",e[e.F_INV=533]="F_INV",e[e.F_INV_RT=534]="F_INV_RT",e[e.HYPGEOM_DIST=535]="HYPGEOM_DIST",e[e.LOGNORM_DIST=536]="LOGNORM_DIST",e[e.LOGNORM_INV=537]="LOGNORM_INV",e[e.NEGBINOM_DIST=538]="NEGBINOM_DIST",e[e.NORM_S_DIST=539]="NORM_S_DIST",e[e.NORM_S_INV=540]="NORM_S_INV",e[e.T_TEST=541]="T_TEST",e[e.Z_TEST=542]="Z_TEST",e[e.ERF_PRECISE=543]="ERF_PRECISE",e[e.ERFC_PRECISE=544]="ERFC_PRECISE",e[e.GAMMALN_PRECISE=545]="GAMMALN_PRECISE",e[e.CEILING_PRECISE=546]="CEILING_PRECISE",e[e.FLOOR_PRECISE=547]="FLOOR_PRECISE",e[e.ACOT=548]="ACOT",e[e.ACOTH=549]="ACOTH",e[e.COT=550]="COT",e[e.COTH=551]="COTH",e[e.CSC=552]="CSC",e[e.CSCH=553]="CSCH",e[e.SEC=554]="SEC",e[e.SECH=555]="SECH",e[e.IMTAN=556]="IMTAN",e[e.IMCOT=557]="IMCOT",e[e.IMCSC=558]="IMCSC",e[e.IMCSCH=559]="IMCSCH",e[e.IMSEC=560]="IMSEC",e[e.IMSECH=561]="IMSECH",e[e.BITAND=562]="BITAND",e[e.BITOR=563]="BITOR",e[e.BITXOR=564]="BITXOR",e[e.BITLSHIFT=565]="BITLSHIFT",e[e.BITRSHIFT=566]="BITRSHIFT",e[e.PERMUTATIONA=567]="PERMUTATIONA",e[e.COMBINA=568]="COMBINA",e[e.XOR=569]="XOR",e[e.PDURATION=570]="PDURATION",e[e.BASE=571]="BASE",e[e.DECIMAL=572]="DECIMAL",e[e.DAYS=573]="DAYS",e[e.BINOM_DIST_RANGE=574]="BINOM_DIST_RANGE",e[e.GAMMA=575]="GAMMA",e[e.SKEW_P=576]="SKEW_P",e[e.GAUSS=577]="GAUSS",e[e.PHI=578]="PHI",e[e.RRI=579]="RRI",e[e.UNICHAR=580]="UNICHAR",e[e.UNICODE=581]="UNICODE",e[e.MUNIT=582]="MUNIT",e[e.ARABIC=583]="ARABIC",e[e.ISOWEEKNUM=584]="ISOWEEKNUM",e[e.NUMBERVALUE=585]="NUMBERVALUE",e[e.SHEET=586]="SHEET",e[e.SHEETS=587]="SHEETS",e[e.FORMULATEXT=588]="FORMULATEXT",e[e.ISFORMULA=589]="ISFORMULA",e[e.IFNA=590]="IFNA",e[e.CEILING_MATH=591]="CEILING_MATH",e[e.FLOOR_MATH=592]="FLOOR_MATH",e[e.IMSINH=593]="IMSINH",e[e.IMCOSH=594]="IMCOSH",e[e.FILTERXML=595]="FILTERXML",e[e.WEBSERVICE=596]="WEBSERVICE",e[e.ENCODEURL=597]="ENCODEURL",e[e.FORECAST_ETS=598]="FORECAST_ETS",e[e.FORECAST_ETS_CONFINT=599]="FORECAST_ETS_CONFINT",e[e.FORECAST_ETS_SEASONALITY=600]="FORECAST_ETS_SEASONALITY",e[e.FORECAST_LINEAR=601]="FORECAST_LINEAR",e[e.FORECAST_ETS_STAT=602]="FORECAST_ETS_STAT",e[e.MAXIFS=603]="MAXIFS",e[e.MINIFS=604]="MINIFS",e[e.TEXTJOIN=605]="TEXTJOIN",e[e.CONCAT=606]="CONCAT",e[e.IFS=607]="IFS",e[e.SWITCH=608]="SWITCH",e[e.SINGLE=609]="SINGLE",e[e.AVERAGE_WEIGHTED=610]="AVERAGE_WEIGHTED",e[e.ANCHORARRAY=611]="ANCHORARRAY",e[e._FV=612]="_FV",e[e.FIELDVALUE=613]="FIELDVALUE",e[e.FILTER=614]="FILTER",e[e.SORT=615]="SORT",e[e.UNIQUE=616]="UNIQUE",e[e.RICHSEARCH=617]="RICHSEARCH",e[e.LARGEPROPERTY=618]="LARGEPROPERTY",e[e.SMALLPROPERTY=619]="SMALLPROPERTY",e[e.AVERAGEPROPERTY=620]="AVERAGEPROPERTY",e[e.FINDN=621]="FINDN",e[e.TEXTSLICE=622]="TEXTSLICE",e[e.TEXTBEFORE=623]="TEXTBEFORE",e[e.TEXTAFTER=624]="TEXTAFTER",e[e.TEXTSPLIT=625]="TEXTSPLIT",e[e._SORT=626]="_SORT",e[e._ONEDARRAY=627]="_ONEDARRAY",e[e.XMATCH=628]="XMATCH",e[e.XLOOKUP=629]="XLOOKUP",e[e.SORTBY=630]="SORTBY",e[e.RANDARRAY=631]="RANDARRAY",e[e.SEQUENCE=632]="SEQUENCE",e[e.STOCKHISTORY=633]="STOCKHISTORY",e[e.WRAPROWS=634]="WRAPROWS",e[e.VSTACK=635]="VSTACK",e[e.HSTACK=636]="HSTACK",e[e.CHOOSEROWS=637]="CHOOSEROWS",e[e.CHOOSECOLS=638]="CHOOSECOLS",e[e.LET=639]="LET",e[e.LAMBDA=640]="LAMBDA",e[e.MAKEARRAY=641]="MAKEARRAY",e[e.APPLY=642]="APPLY",e[e.ISLAMBDA=643]="ISLAMBDA",e[e.ARITY=644]="ARITY",e[e.RECURSE=645]="RECURSE",e[e.VALUETOTEXT=647]="VALUETOTEXT",e[e.ARRAYTOTEXT=648]="ARRAYTOTEXT",e[e.FORMATTEDNUMBER=649]="FORMATTEDNUMBER",e[e.TOCOL=650]="TOCOL",e[e.TOROW=651]="TOROW",e[e.WRAPCOLS=652]="WRAPCOLS",e[e.MAP=653]="MAP",e[e.REDUCE=654]="REDUCE",e[e.SCAN=655]="SCAN",e[e.BYROW=656]="BYROW",e[e.BYCOL=657]="BYCOL",e[e.ISOMITTED=658]="ISOMITTED",e[e.EXPAND=659]="EXPAND",e[e.TAKE=660]="TAKE",e[e.DROP=661]="DROP",e[e.PY=662]="PY",e[e.IMAGE=664]="IMAGE",e[e.UNIT=665]="UNIT",e[e.GROUPBY=666]="GROUPBY",e[e.PIVOTBY=667]="PIVOTBY",e[e.PQSOURCE=668]="PQSOURCE",e[e.PYTHON_STR=669]="PYTHON_STR",e[e.PYTHON_TYPE=670]="PYTHON_TYPE",e[e.PYTHON_TYPENAME=671]="PYTHON_TYPENAME",e[e.PYO=672]="PYO",e[e.TESTFUNCTIONBEGIN=673]="TESTFUNCTIONBEGIN",e[e.GRF=674]="GRF",e[e.RICHERROR=675]="RICHERROR",e[e.COUNTER=676]="COUNTER",e[e.BROKENRECORD=677]="BROKENRECORD",e[e.STREAM=678]="STREAM",e[e.GETRICHERRORS=679]="GETRICHERRORS",e[e.DBGSTAT=680]="DBGSTAT",e[e.RICHNUMBER=681]="RICHNUMBER",e[e.RICHERNUMBER=682]="RICHERNUMBER",e[e.DBGWRITE=683]="DBGWRITE",e[e.TEST=684]="TEST",e[e.AAC=685]="AAC",e[e.AWC=686]="AWC",e[e.PARSEDEXPRESSION=687]="PARSEDEXPRESSION",e[e.AGE_CONTACTTEST=688]="AGE_CONTACTTEST",e[e.FIRSTNAME_CONTACTTEST=689]="FIRSTNAME_CONTACTTEST",e[e.FULLNAME_CONTACTTEST=690]="FULLNAME_CONTACTTEST",e[e.LASTNAME_CONTACTTEST=691]="LASTNAME_CONTACTTEST",e[e.TRANSLATENAME_CONTACTTEST=692]="TRANSLATENAME_CONTACTTEST",e[e.ARRAYVALUE=693]="ARRAYVALUE",e[e.RECORD=694]="RECORD",e[e.DISPLAYSTRING_GENERALTEST=695]="DISPLAYSTRING_GENERALTEST",e[e.LETREC=750]="LETREC",e[e.NESTEDRECORD=751]="NESTEDRECORD"})(RQe=dC.WorksheetFuncId||(dC.WorksheetFuncId={}));dC.worksheetFuncEnglishNames=[[255,"255"],[268,"GET.WORKBOOK"],[349,"OPTIONS.LISTS.GET"],[355,"OPEN.DIALOG"],[356,"SAVE.DIALOG"],[360,"PHONETIC"],[369,"THAIDAYOFWEEK"],[371,"THAIMONTHOFYEAR"],[612,"_FV"],[626,"_SORT"],[627,"_ONEDARRAY"],[669,"PYTHON_STR"],[670,"PYTHON_TYPE"],[671,"PYTHON_TYPENAME"],[688,"AGE_CONTACTTEST"],[689,"FIRSTNAME_CONTACTTEST"],[690,"FULLNAME_CONTACTTEST"],[691,"LASTNAME_CONTACTTEST"],[692,"TRANSLATENAME_CONTACTTEST"],[695,"DISPLAYSTRING_GENERALTEST"]].reduce(function(e,r){return e[r[0]]=r[1],e},[]);var N=[];dC.worksheetFuncTypes=[[1,255,N,[57],N,1,0,16],[1,3,[36,831,831],N,N,823,0,0],[1,1,[15],N,N,4,0,0],[1,1,[15],N,N,4,0,0],[1,255,N,[305],N,1,0,16],[1,255,N,[49],N,1,0,16],[1,255,N,[49],N,1,0,16],[1,255,N,[49],N,1,0,16],[0,1,[16],N,N,33,0,0],[0,1,[16],N,N,33,0,0],[0,0,N,N,N,3,0,16],[2,255,[1],[49],N,1,0,16],[1,255,N,[49],N,1,0,16],[1,2,[1,1],N,N,2,0,0],[1,3,[1,65,4],N,N,2,0,0],[1,1,[1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[0,0,N,N,N,1,0,0],[1,1,[1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[2,2,[1,1],N,N,1,0,0],[2,3,[263,48,48],N,N,263,0,0],[2,4,[48,1,1,1],N,N,311,0,0],[2,2,[2,1],N,N,2,0,0],[3,3,[2,1,1],N,N,2,0,0],[1,1,[2],N,N,1,0,0],[1,1,[7],N,N,1,0,0],[0,0,N,N,N,4,0,16],[0,0,N,N,N,4,0,16],[1,255,N,[52],N,4,0,16],[1,255,N,[52],N,4,0,16],[1,1,[4],N,N,4,0,16],[2,2,[1,1],N,N,1,0,0],[3,3,[16,83,18],N,N,1,0,0],[3,3,[16,19,18],N,N,1,0,0],[3,3,[16,19,18],N,N,1,0,0],[3,3,[16,19,18],N,N,1,0,0],[3,3,[16,19,18],N,N,1,0,0],[3,3,[16,19,18],N,N,1,0,0],[1,255,N,[49],N,1,0,16],[3,3,[16,19,18],N,N,1,0,0],[2,2,[263,2],N,N,2,0,0],[1,4,[48,112,84,84],N,N,32,0,0],[1,4,[48,112,112,84],N,N,32,0,0],[1,4,[48,112,84,84],N,N,32,0,0],[1,4,[48,112,112,84],N,N,32,0,0],[1,1,[16],N,N,512,0,2],[0,1,[4],N,N,512,0,2],[0,1,[575],N,N,512,0,2],[3,5,[1,1,1,1,1],N,N,1,0,0],[3,5,[1,1,1,1,1],N,N,1,0,0],[3,5,[1,1,1,1,1],N,N,1,0,0],[3,5,[1,1,1,1,1],N,N,1,0,0],[3,6,[1,1,1,1,1,1],N,N,1,0,0],[3,3,[48,1,1],N,N,1,0,16],[1,2,[48,1],N,N,1,0,0],[0,0,N,N,N,1,16383,0],[2,3,[263,305,17],N,N,1,0,0],[3,3,[1,1,1],N,N,1,0,0],[3,3,[1,1,1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[1,2,[1,1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[0,0,N,N,N,1,16383,0],[1,1,[16],N,N,1,0,0],[1,1,[48],N,N,1,0,0],[1,1,[48],N,N,1,0,0],[3,5,[16,65,65,65,65],N,N,16,16383,0],[2,2,[2,16],N,N,16,0,2],[2,2,[16,16],N,N,2,0,2],[0,3,[66,81,16],N,N,4,0,2],[2,3,[2,2,1],N,N,1,0,0],[1,1,[39],N,N,32,0,0],[0,2,[1,24],N,N,4,0,2],[0,0,N,N,N,4,0,2],[1,1,[303],N,N,1,0,0],[0,1,[4],N,N,4,0,2],[1,2,[2,63],N,N,4,0,2],[0,0,N,N,N,50,0,2],[1,1,[16],N,N,47,0,2],[0,2,[65,66],N,N,32,0,2],[4,5,[87,117,117,1,117],N,N,4,0,0],[0,2,[1,66],N,N,32,0,2],[0,0,N,N,N,16,0,2],[0,0,N,N,N,16,0,2],[0,1,[1],N,N,4,0,2],[2,2,[1,1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[2,255,[33],[831],N,823,0,0],[3,4,[263,49,49,4],N,N,295,0,0],[3,4,[263,49,49,4],N,N,295,0,0],[0,2,[66,65],N,N,32,0,2],[1,7,[2,65,66,67,65,65,2],N,N,575,0,2],[1,1,[63],N,N,4,0,0],[1,1,[18],N,N,2,0,2],[1,2,[2,4],N,N,6,0,2],[2,2,[16,47],N,N,4,0,2],[1,2,[1,1],N,N,1,0,0],[1,4,[2,1,4,4],N,N,7,0,2],[1,1,[1],N,N,2,0,0],[1,1,[2],N,N,2,0,0],[1,1,[2],N,N,2,0,0],[1,1,[2],N,N,2,0,0],[1,2,[2,9],N,N,2,0,0],[1,2,[2,9],N,N,2,0,0],[2,2,[258,258],N,N,4,0,0],[1,1,[2],N,N,2,0,0],[4,4,[2,1,1,2],N,N,2,0,0],[3,4,[2,2,2,2],N,N,2,0,0],[1,1,[2],N,N,1,0,0],[0,3,[66,65,66],N,N,32,0,2],[0,1,[2],N,N,2,0,2],[2,3,[2,2,1],N,N,1,0,0],[1,2,[2,16],N,N,303,16383,0],[1,1,[15],N,N,4,0,0],[1,1,[143],N,N,4,0,0],[1,1,[143],N,N,4,0,0],[1,1,[143],N,N,4,0,0],[1,1,[23],N,N,2,0,0],[1,1,[23],N,N,1,0,0],[1,2,[2,1],N,N,1,0,2],[1,1,[1],N,N,1,0,2],[1,1,[1],N,N,1,0,2],[1,1,[1],N,N,2,0,2],[2,2,[1,1],N,N,2,0,2],[2,2,[1,2],N,N,1,0,2],[2,2,[1,2],N,N,1,0,2],[1,2,[1,1],N,N,1,0,2],[1,1,[3],N,N,1,0,0],[1,1,[3],N,N,1,0,0],[3,3,[1,1,1],N,N,1,0,0],[4,4,[1,1,1,1],N,N,1,0,0],[4,5,[1,1,1,1,1],N,N,1,0,0],[1,3,[2,66,65],N,N,2,0,2],[1,2,[16,4],N,N,2,0,2],[1,2,[2,4],N,N,16,0,2],[1,2,[2,4],N,N,16,16383,0],[1,255,[2,3,66,66,66,65,67,66,67],[66],N,3,0,2],[1,255,[3],[127],N,575,0,2],[0,1,[3],N,N,1,0,2],[2,4,[3,115,83,3],N,N,1,0,2],[3,5,[3,83,115,83,3],N,N,1,0,2],[4,5,[3,3,3,4,3],N,N,4,0,2],[4,5,[3,3,3,4,3],N,N,4,0,2],[4,5,[3,3,3,3,3],N,N,4,0,2],[0,1,[3],N,N,4,0,2],[2,3,[3,3,3],N,N,4,0,2],[3,4,[3,3,3,3],N,N,4,0,2],[1,3,[1,67,66],N,N,1,0,2],[1,1,[52],N,N,36,0,2],[1,1,[2],N,N,2,0,0],[1,1,[32],N,N,1,0,0],[1,1,[32],N,N,32,0,0],[2,2,[32,32],N,N,32,0,0],[0,2,[2,2],N,N,32,0,2],[4,6,[1,1,1,1,1,1],N,N,1,0,0],[4,6,[1,1,1,1,1,1],N,N,1,0,0],[1,255,N,[121],N,1,0,16],[0,2,[1,16],N,N,4,0,2],[3,4,[2,1,1,1],N,N,512,0,2],[1,1,[4],N,N,512,0,2],[0,0,N,N,N,512,0,2],[0,0,N,N,N,512,0,2],[2,2,[2,2],N,N,1,0,2],[2,2,[1,2],N,N,32,0,2],[3,3,[1,18,18],N,N,4,0,2],[2,2,[1,2],N,N,4,0,2],[1,1,[1],N,N,4,0,2],[0,1,[1],N,N,512,0,2],[0,1,[2],N,N,4,0,2],[0,4,[3,3,3,3],N,N,3,0,2],[1,255,N,[113],N,1,0,16],[1,1,[1],N,N,1,0,0],[1,2,[1,16],N,N,47,0,2],[1,1,[1],N,N,47,0,2],[1,2,[1,2],N,N,47,0,2],[1,2,[1,2],N,N,63,0,2],[3,3,[16,19,18],N,N,1,0,0],[1,1,[143],N,N,4,0,0],[0,3,[82,65,65],N,N,2,0,2],[0,4,[66,82,17,17],N,N,1,0,2],[1,255,N,[49],N,1,0,16],[1,255,N,[49],N,1,0,16],[3,3,[16,19,18],N,N,1,0,0],[3,3,[16,19,18],N,N,1,0,0],[1,2,[1,1],N,N,1,0,0],[1,1,[143],N,N,4,0,0],[3,3,[16,83,18],N,N,1,0,0],[1,1,[3],N,N,4,0,2],[1,1,[3],N,N,4,0,2],void 0,void 0,[1,2,[1,1],N,N,2,0,32],[2,3,[2,2,1],N,N,1,0,32],[2,3,[2,2,1],N,N,1,0,32],[4,4,[2,1,1,2],N,N,2,0,32],[1,2,[2,9],N,N,2,0,32],[1,2,[2,9],N,N,2,0,32],[3,3,[2,1,1],N,N,2,0,32],[1,1,[2],N,N,1,0,32],[2,2,[1,1],N,N,1,0,0],[2,2,[1,1],N,N,1,0,0],[1,1,[2],N,N,2,0,32],[1,1,[2],N,N,2,0,32],[2,3,[1,16,4],N,N,1,0,16],void 0,void 0,[2,5,[1,65,65,68,66],N,N,2,0,0],[2,3,[1,1,4],N,N,1,0,0],[0,0,N,N,N,1,16383,0],[5,7,[1,1,1,1,1,1,4],N,N,1,0,0],[0,0,N,N,N,512,0,2],[1,1,[12],N,N,512,0,2],[0,0,N,N,N,512,0,2],[1,3,[2,82,84],N,N,512,0,2],[1,255,N,[49],N,1,0,16],[1,255,N,[32],N,1,0,0],[1,1,[1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[3,3,[16,19,18],N,N,263,0,0],[2,11,[1,18,17,17,18,17,17,115,84,21,17],N,N,2,0,2],[0,1,[4],N,N,4,0,2],[0,0,N,N,N,16,0,2],[0,2,[2,2],N,N,4,0,2],[0,3,[2,2,2],N,N,4,0,2],[2,5,[2,23,23,23,23],N,N,2,0,2],[2,4,[2,1,1,2],N,N,1,0,2],[1,4,[2,66,65,65],N,N,1,0,2],[1,1,[2],N,N,3,16383,0],[0,0,N,N,N,2,0,2],[1,5,[1,2,1,1,1],N,N,47,0,2],[4,5,[1,1,1,1,1],N,N,1,0,0],[0,1,[4],N,N,512,0,2],void 0,void 0,[0,1,[1],N,N,512,0,2],[2,2,[48,48],N,N,32,0,16],[0,2,[66,96],N,N,2,0,2],[1,1,[2],N,N,4,0,2],[1,255,[17],[127],N,575,0,32],[1,1,[3],N,N,4,0,2],[1,1,[2],N,N,63,0,2],[1,2,[1,3],N,N,47,0,2],[1,3,[1,3,1],N,N,47,0,2],[1,3,[2,66,4],N,N,4,0,2],[1,1,[15],N,N,1,0,0],[0,1,[2],N,N,4,0,2],[0,1,[2],N,N,4,0,2],[0,2,[99,66],N,N,4,0,2],[3,3,[3,1,4],N,N,4,0,2],[3,3,[3,1,4],N,N,4,0,2],[2,3,[2,3,66],N,N,1,0,2],[1,2,[1,2],N,N,35,0,2],[1,255,N,[49],N,1,0,16],[3,5,[1,1,1,65,65],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[3,5,[1,1,1,65,65],N,N,1,0,0],[4,4,[1,1,1,4],N,N,1,0,0],[2,2,[1,1],N,N,1,0,0],[2,2,[1,1],N,N,1,0,0],[2,2,[1,1],N,N,1,0,0],[3,3,[1,1,1],N,N,1,0,0],[3,3,[1,1,1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[3,3,[1,1,4],N,N,1,0,0],[3,3,[1,1,1],N,N,1,0,0],[3,3,[1,1,1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[2,2,[1,1],N,N,1,0,0],[4,4,[1,1,1,4],N,N,1,0,0],[3,3,[1,1,1],N,N,1,0,0],[2,2,[1,1],N,N,1,0,0],[4,4,[1,1,1,1],N,N,1,0,0],[3,3,[1,1,1],N,N,1,0,0],[3,3,[1,1,1],N,N,1,0,0],[3,3,[1,1,1],N,N,1,0,0],[4,4,[1,1,1,4],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[3,3,[1,1,1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[3,3,[1,1,1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[2,2,[1,1],N,N,1,0,0],[3,3,[1,1,4],N,N,1,0,0],[3,3,[1,1,1],N,N,1,0,0],[4,4,[1,1,1,4],N,N,1,0,0],[2,2,[32,32],N,N,1,0,0],[2,2,[32,32],N,N,1,0,0],[2,2,[32,32],N,N,1,0,0],[2,2,[32,32],N,N,1,0,0],[2,2,[32,32],N,N,1,0,0],[2,2,[32,32],N,N,1,0,0],[3,3,[1,32,32],N,N,1,0,0],[2,2,[32,32],N,N,1,0,0],[2,2,[32,32],N,N,1,0,0],[2,2,[32,32],N,N,1,0,0],[2,2,[32,32],N,N,1,0,0],[2,2,[32,32],N,N,1,0,0],[2,2,[32,32],N,N,1,0,0],[4,4,[32,32,1,1],N,N,1,0,0],[3,4,[32,32,1,65],N,N,1,0,0],[1,255,N,[49],N,1,0,16],[1,255,N,[49],N,1,0,16],[1,255,N,[49],N,1,0,16],[1,255,N,[49],N,1,0,16],[1,255,N,[49],N,1,0,16],[1,255,N,[49],N,1,0,16],[2,3,[49,1,1],N,N,1,0,16],[2,2,[49,1],N,N,1,0,16],[2,2,[49,1],N,N,1,0,16],[2,2,[49,1],N,N,1,0,16],[2,2,[49,1],N,N,1,0,16],[2,3,[49,1,65],N,N,1,0,16],[1,255,N,[32],N,1,0,16],[2,2,[49,1],N,N,1,0,16],[2,2,[1,1],N,N,1,0,0],void 0,[3,4,[2,1,1,1],N,N,1,0,34],[2,3,[2,1,1],N,N,1,0,34],[1,255,N,[2],N,2,0,0],[2,2,[1,1],N,N,1,0,0],[2,9,[66,2,66,65,65,65,66,66,66],N,N,2,0,2],[1,2,[1,2],N,N,35,0,2],[1,3,[1,66,2],N,N,35,0,2],[1,4,[1,66,66,2],N,N,7,0,2],[1,1,[1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[2,255,[1],[16],N,1,0,0],[2,3,[16,15,16],N,N,1,0,0],[2,2,[16,15],N,N,1,0,0],[1,1,[16],N,N,1,0,0],[1,2,[1,2],N,N,19,0,2],[1,1,[33],N,N,33,0,2],[4,4,[1,1,1,1],N,N,1,0,0],[3,3,[1,1,2],N,N,1,0,32],[1,1,[1],N,N,2,0,32],[2,2,[1,1],N,N,2,0,32],[1,2,[1,5],N,N,2,0,0],[0,4,[66,66,66,65],N,N,6,0,2],[0,5,[66,66,66,66,65],N,N,6,0,2],[1,2,[1,2],N,N,19,0,2],[2,255,[18,18],[2,79],N,15,0,0],[1,2,[2,39],N,N,39,0,0],[1,1,[16],N,N,2,0,32],[1,255,N,[49],N,1,0,16],[1,255,N,[49],N,1,0,16],[1,255,N,[49],N,1,0,16],[1,255,N,[49],N,1,0,16],[1,255,N,[49],N,1,0,16],[1,255,N,[49],N,1,0,16],[1,255,N,[49],N,1,0,16],[1,1,[1],N,N,2,0,0],[1,1,[1],N,N,2,0,32],[1,1,[3],N,N,2,0,32],[1,1,[1],N,N,2,0,32],[1,1,[1],N,N,2,0,32],[1,1,[1],N,N,2,0,32],[1,1,[2],N,N,1,0,32],[1,1,[2],N,N,4,0,32],[1,1,[1],N,N,1,0,32],[1,1,[1],N,N,1,0,32],[1,1,[1],N,N,1,0,32],[3,255,N,[2],N,2,0,0],[1,255,[2],[50],N,15,0,0],[2,3,[2,50,2],N,N,10,0,0],[3,3,[2,2,2],N,N,15,0,0],[3,4,[2,2,1,2],N,N,10,0,0],[1,2,[95,95],N,N,9,0,0],[1,1,[95],N,N,9,0,0],[1,2,[95,95],N,N,9,0,0],[1,2,[95,95],N,N,9,0,0],[1,2,[95,95],N,N,9,0,0],[1,2,[95,95],N,N,9,0,0],[1,2,[95,95],N,N,9,0,0],[1,2,[95,95],N,N,9,0,0],[1,1,[95],N,N,9,0,0],[1,1,[95],N,N,9,0,0],[1,2,[95,95],N,N,9,0,0],[1,2,[95,95],N,N,9,0,0],[2,2,[95,95],N,N,9,0,0],[2,2,[95,95],N,N,9,0,0],[2,2,[95,95],N,N,9,0,0],[1,1,[95],N,N,9,0,0],[1,1,[95],N,N,9,0,0],[1,1,[95],N,N,9,0,0],[1,1,[95],N,N,9,0,0],[1,1,[95],N,N,9,0,0],[1,1,[95],N,N,9,0,0],[1,1,[95],N,N,9,0,0],[1,1,[95],N,N,9,0,0],[1,1,[95],N,N,9,0,0],[1,1,[95],N,N,9,0,0],[1,1,[95],N,N,9,0,0],[1,1,[95],N,N,9,0,0],[2,3,[95,95,95],N,N,9,0,0],[1,255,N,[127],N,9,0,0],[1,255,N,[127],N,9,0,0],[4,4,[95,95,95,127],N,N,9,0,0],[1,1,[95],N,N,9,0,0],[1,1,[95],N,N,9,0,0],[2,2,[95,95],N,N,9,0,0],[1,2,[95,95],N,N,9,0,0],[1,2,[95,95],N,N,9,0,0],[1,1,[95],N,N,9,0,0],[1,1,[95],N,N,9,0,0],[2,2,[95,95],N,N,9,0,0],[1,2,[95,95],N,N,9,0,0],[1,1,[95],N,N,9,0,0],[2,2,[95,95],N,N,9,0,0],[2,2,[95,95],N,N,9,0,0],[2,2,[95,95],N,N,9,0,0],[2,2,[95,95],N,N,9,0,0],[2,3,[127,127,95],N,N,9,0,0],[3,3,[95,127,127],N,N,9,0,0],[5,6,[95,95,95,95,95,95],N,N,9,0,0],[5,6,[95,95,95,95,95,95],N,N,9,0,0],[4,5,[95,95,95,95,95],N,N,9,0,0],[4,5,[95,95,95,95,95],N,N,9,0,0],[4,5,[95,95,95,95,95],N,N,9,0,0],[4,5,[95,95,95,95,95],N,N,9,0,0],[4,5,[95,95,95,95,95],N,N,9,0,0],[3,3,[95,95,95],N,N,9,0,0],[3,3,[95,95,95],N,N,9,0,0],[3,3,[95,95,95],N,N,9,0,0],[6,7,[95,95,95,95,95,95,95],N,N,9,0,0],[6,7,[95,95,95,95,95,95,95],N,N,9,0,0],[2,2,[95,95],N,N,9,0,0],[2,2,[95,95],N,N,9,0,0],[2,2,[95,95],N,N,9,0,0],[2,2,[95,95],N,N,9,0,0],[6,6,[95,95,95,95,95,95],N,N,9,0,0],[6,6,[95,95,95,95,95,95],N,N,9,0,0],[2,2,[95,95],N,N,9,0,0],[2,2,[95,95],N,N,9,0,0],[2,3,[95,95,95],N,N,9,0,0],[3,4,[95,95,95,95],N,N,9,0,0],[3,4,[95,95,95,95],N,N,9,0,0],[3,4,[95,95,95,95],N,N,9,0,0],[3,4,[95,95,95,95],N,N,9,0,0],[3,4,[95,95,95,95],N,N,9,0,0],[3,4,[95,95,95,95],N,N,9,0,0],[5,6,[95,95,95,95,95,95],N,N,9,0,0],[5,6,[95,95,95,95,95,95],N,N,9,0,0],[7,8,[95,95,95,95,95,95,95,95],N,N,9,0,0],[7,8,[95,95,95,95,95,95,95,95],N,N,9,0,0],[8,9,[95,95,95,95,95,95,95,95,95],N,N,9,0,0],[8,9,[95,95,95,95,95,95,95,95,95],N,N,9,0,0],[2,2,[95,95],N,N,9,16383,0],[1,2,[95,95],N,N,9,0,0],[6,7,[95,95,95,95,95,95,95],N,N,9,0,32],[6,7,[95,95,95,95,95,95,95],N,N,9,0,0],[3,3,[95,95,95],N,N,9,0,0],[6,8,[95,95,95,95,95,95,95,95],N,N,9,0,0],[4,5,[95,95,95,95,95],N,N,9,0,0],[2,3,[95,95,127],N,N,9,0,0],[2,3,[95,95,127],N,N,9,0,0],[1,255,N,[127],N,9,0,0],[1,255,N,[127],N,9,0,0],[1,255,N,[127],N,9,0,0],[2,2,[95,127],N,N,9,0,0],[3,4,[2,2,1,2],N,N,10,0,0],[2,5,[2,50,2,1,2],N,N,10,0,0],[1,1,[2],N,N,9,0,0],[2,2,[47,575],N,N,303,0,0],[2,255,N,[16,15],N,1,0,0],[3,255,[16],[16,15],N,1,0,0],[2,3,[16,15,16],N,N,1,0,0],[3,255,[16],[16,15],N,1,0,0],[3,254,[1,1,48,17],[16],N,1,0,0],[4,4,[1,1,1,4],N,N,1,0,0],[3,3,[1,1,1],N,N,1,0,0],[3,3,[1,1,1],N,N,1,0,0],[3,3,[1,1,1],N,N,1,0,0],[2,2,[32,32],N,N,1,0,0],[2,2,[32,32],N,N,1,0,0],[2,2,[32,32],N,N,1,0,0],[2,2,[32,32],N,N,1,0,0],[3,3,[1,1,4],N,N,1,0,0],[4,4,[1,1,1,4],N,N,1,0,0],[3,3,[1,1,1],N,N,1,0,0],[1,254,N,[32],N,32,0,16],[1,254,N,[32],N,1,0,16],[4,4,[1,1,1,4],N,N,1,0,0],[3,3,[1,1,1],N,N,1,0,0],[2,2,[49,1],N,N,1,0,16],[2,2,[49,1],N,N,1,0,16],[2,3,[49,1,65],N,N,1,0,16],[2,3,[49,1,65],N,N,1,0,16],[3,3,[1,1,4],N,N,1,0,0],[2,2,[49,1],N,N,1,0,16],[2,2,[49,1],N,N,1,0,16],[2,3,[1,16,4],N,N,1,0,16],[2,3,[1,16,4],N,N,1,0,16],[1,254,N,[49],N,1,0,16],[1,254,N,[49],N,1,0,16],[3,3,[1,1,4],N,N,1,0,0],[2,2,[1,1],N,N,1,0,0],[2,2,[1,1],N,N,1,0,0],[2,2,[1,1],N,N,1,0,0],[2,2,[1,1],N,N,1,0,0],[1,254,N,[49],N,1,0,16],[1,254,N,[49],N,1,0,16],[4,4,[1,1,1,4],N,N,1,0,0],[2,4,[95,95,75,127],N,N,9,0,0],[2,4,[95,95,75,127],N,N,9,0,0],[2,2,[1,1],N,N,1,0,32],[1,2,[1,65],N,N,1,0,32],void 0,[4,6,[1,1,1,4,65,65],N,N,1,0,0],[3,5,[1,1,1,65,65],N,N,1,0,0],[3,3,[1,1,4],N,N,1,0,0],[2,2,[1,1],N,N,1,0,0],[2,2,[1,1],N,N,1,0,0],[2,2,[1,1],N,N,1,0,0],[4,4,[1,1,1,4],N,N,1,0,0],[3,3,[1,1,1],N,N,1,0,0],[3,3,[1,1,1],N,N,1,0,0],[3,3,[1,1,1],N,N,1,0,0],[5,5,[1,1,1,1,4],N,N,1,0,0],[4,4,[1,1,1,4],N,N,1,0,0],[3,3,[1,1,1],N,N,1,0,0],[4,4,[1,1,1,4],N,N,1,0,0],[2,2,[1,4],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[4,4,[32,32,1,1],N,N,1,0,0],[2,3,[49,1,1],N,N,1,0,16],[1,1,[95],N,N,9,0,0],[1,1,[95],N,N,9,0,0],[1,1,[1],N,N,1,0,0],[1,2,[1,65],N,N,1,0,32],[1,2,[1,65],N,N,1,0,32],[1,1,[1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[1,1,[95],N,N,9,0,0],[1,1,[95],N,N,9,0,0],[1,1,[95],N,N,9,0,0],[1,1,[95],N,N,9,0,0],[1,1,[95],N,N,9,0,0],[1,1,[95],N,N,9,0,0],[2,2,[1,1],N,N,1,0,0],[2,2,[1,1],N,N,1,0,0],[2,2,[1,1],N,N,1,0,0],[2,2,[1,1],N,N,1,0,0],[2,2,[1,1],N,N,1,0,0],[2,2,[1,1],N,N,1,0,0],[2,2,[1,1],N,N,1,0,0],[1,254,N,[52],N,4,0,16],[3,3,[1,1,1],N,N,1,0,0],[2,3,[1,1,65],N,N,2,0,0],[2,2,[2,1],N,N,1,0,0],[2,2,[3,3],N,N,1,0,0],[3,4,[1,1,1,65],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[1,254,N,[49],N,1,0,16],[1,1,[1],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[3,3,[1,1,1],N,N,1,0,0],[1,1,[1],N,N,2,0,0],[1,1,[2],N,N,1,0,0],[1,1,[1],N,N,32,0,0],[1,1,[2],N,N,1,0,0],[1,1,[1],N,N,1,0,0],[1,3,[2,66,66],N,N,1,0,0],[0,1,[50],N,N,1,16383,16],[0,1,[48],N,N,1,16383,16],[1,1,[16],N,N,2,16383,0],[1,1,[16],N,N,4,0,0],[2,2,[47,575],N,N,303,0,0],[1,3,[1,65,65],N,N,1,0,0],[1,3,[1,65,65],N,N,1,0,0],[1,1,[95],N,N,9,0,0],[1,1,[95],N,N,9,0,0],[2,2,[2,2],N,N,47,0,0],[1,1,[2],N,N,10,0,0],[1,1,[2],N,N,10,0,0],[3,6,[1,48,48,65,65,65],N,N,1,0,0],[3,7,[1,48,48,65,65,65,65],N,N,1,0,0],[2,4,[48,48,65,65],N,N,1,0,0],[3,3,[1,32,32],N,N,1,0,0],[3,6,[48,48,1,65,65,65],N,N,1,0,0],[3,254,[16],[16,15],N,1,0,0],[3,254,[16],[16,15],N,1,0,0],[3,254,[114,68],[114],N,2,0,16],[1,254,N,[114],N,2,0,16],[2,254,N,[44,575],N,831,0,0],[3,254,[47],[575,575],[575],831,0,0],[1,1,[1527],N,N,1503,0,53],[2,254,N,[113,113],N,1,0,17],[1,1,[16],N,N,48,0,21],[2,3,[271,2,4],N,N,303,0,21],[2,2,[271,2],N,N,303,0,17],[2,3,[48,48,111],N,N,303,0,1],[1,4,[160,96,96,4],N,N,32,0,1],[1,3,[160,4,4],N,N,32,0,1],[2,2,[2,256],N,N,1,0,8],[3,3,[2,49,1],N,N,1,0,24],[3,3,[2,49,1],N,N,1,0,24],[2,254,[2],[49],N,1,0,24],[2,7,[34,2,65,65,65,74,68],N,N,1,0,1],[1,3,[2,65,65],N,N,2,0,1],[2,6,[2,34,65,65,65,74],N,N,2,0,1],[2,6,[2,34,65,65,65,74],N,N,2,0,1],[2,6,[2,98,98,68,65,495],N,N,32,0,1],[1,4,[32,96,96,4],N,N,32,0,9],[2,2,[4,16],N,N,32,0,25],[2,4,[391,48,65,65],N,N,1,0,1],[3,6,[391,48,48,511,65,65],N,N,319,0,1],[2,254,[160],[160,65],N,32,0,1],[0,5,[65,65,65,65,68],N,N,32,16383,1],[1,4,[65,65,65,65],N,N,32,0,1],[2,254,[258,1,65,65,65],[65],N,32,0,17],[2,3,[32,1,463],N,N,32,0,1],[1,254,N,[48],N,32,0,17],[1,254,N,[48],N,32,0,17],[2,254,[48],[33],N,32,0,1],[2,254,[48],[33],N,32,0,1],[3,254,N,[319,319],[319],319,0,1],[1,254,N,[319],N,319,0,1],[3,3,[65,65,319],N,N,32,0,1],[1,254,N,[319],N,319,0,1],[1,1,[271],N,N,4,0,1],[1,1,[271],N,N,9,0,1],[0,0,N,N,N,319,0,1],void 0,[1,2,[399,1],N,N,2,0,1],[1,2,[32,1],N,N,2,0,1],[2,2,[15,2],N,N,256,0,17],[1,3,[48,65,68],N,N,32,0,17],[1,3,[48,65,68],N,N,32,0,17],[2,3,[32,1,463],N,N,32,0,1],[2,254,[48],[319],N,32,0,1],[3,3,[511,48,271],N,N,319,0,1],[3,3,[511,48,271],N,N,32,0,1],[1,2,[48,271],N,N,32,0,1],[1,2,[48,271],N,N,32,0,1],[1,1,[1535],N,N,4,0,1],[2,4,[32,65,65,495],N,N,32,0,1],[2,3,[48,65,65],N,N,48,0,1],[2,3,[48,65,65],N,N,48,0,1],[1,254,[1,1],[447],N,303,0,17],void 0,[1,5,[2,66,65,65,65],N,N,264,0,1],[2,2,[15,2],N,N,271,0,17],[3,7,[112,96,96,65,65,96,96],N,N,32,0,1],[4,10,[112,112,96,96,65,65,96,65,96,96],N,N,32,0,1],[1,1,[2],N,N,264,0,5],[1,1,[256],N,N,2,0,17],[1,1,[256],N,N,2,0,17],[1,1,[256],N,N,2,0,17],[1,254,[1,1],[447],N,1087,0,49],[0,0,N,N,N,1,0,1],[1,2,[287,2],N,N,288,0,17],[1,2,[1,1],N,N,10,0,17],[0,0,N,N,N,1,0,1],[3,254,[47],[2,47],N,47,0,17],[0,1,[1],N,N,1,0,1],[0,1,[1],N,N,32,0,1],[1,2,[2,1],N,N,47,0,1],[1,1,[1],N,N,264,0,17],[1,1,[1],N,N,264,0,17],[2,2,[2,47],N,N,47,0,1],[1,254,[2],[1151],N,1087,0,16],[1,254,[1],[1151],N,1087,0,0],[1,254,[1],[1151],N,1087,0,0],[1,1,[16],N,N,32,0,1],[1,1,[256],N,N,2,0,17],[1,1,[256],N,N,2,0,17],[1,1,[256],N,N,2,0,17],[1,1,[256],N,N,2,0,17],[2,2,[256,2],N,N,2,0,17],[1,1,[32],N,N,256,0,17],[3,254,[15],[2,47],N,303,0,17],[1,1,[256],N,N,2,0,17],void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,[3,254,N,[319,319],[319],319,0,1],[3,254,[15],[2,303],N,303,0,17]].map(function(e){return e===void 0?void 0:_Qe.functionType.apply(void 0,e)})});var og=Y(Xc=>{"use strict";_();Object.defineProperty(Xc,"__esModule",{value:!0});Xc.assertPositiveLength=Xc.assertPositiveInteger=Xc.assertInteger=Xc.assertIndex=Xc.assertNatural=Xc.assertNever=Xc.assertFalse=Xc.assertTrue=Xc.ulsLogger=void 0;var fC=Cn();Xc.ulsLogger=fC.assertions.ulsLogger;Xc.assertTrue=fC.assertions.assertTrue;Xc.assertFalse=fC.assertions.assertFalse;Xc.assertNever=fC.assertions.assertNever;Xc.assertNatural=fC.assertions.assertNatural;Xc.assertIndex=fC.assertions.assertIndex;Xc.assertInteger=fC.assertions.assertInteger;Xc.assertPositiveInteger=fC.assertions.assertPositiveInteger;Xc.assertPositiveLength=fC.assertions.assertPositiveLength});var Ep=Y(Ca=>{"use strict";_();Object.defineProperty(Ca,"__esModule",{value:!0});Ca.now=Ca.mapFromArrayOfPairs=Ca.singleton=Ca.typedInstanceCreator=Ca.makeStringCompareCI=Ca.fastAbs=Ca.fastMax=Ca.fastMin=Ca.pair=Ca.filterOutNones=Ca.isNone=Ca.isDefined=Ca.safeConcat=Ca.safePush=Ca.strEnumArray=Ca.numEnumMap=Ca.numEnumArray=Ca.cloneStringMap=Ca.makeStringMap=Ca.identity=Ca.staticAssertIsOptional=Ca.staticAssertIs=Ca.staticAssertSame=Ca.staticAssertExtends=Ca.makeNewtypeIso=void 0;var Us=Cn();Ca.makeNewtypeIso=Us.core.makeNewtypeIso;Ca.staticAssertExtends=Us.core.staticAssertExtends;Ca.staticAssertSame=Us.core.staticAssertSame;Ca.staticAssertIs=Us.core.staticAssertIs;Ca.staticAssertIsOptional=Us.core.staticAssertIsOptional;Ca.identity=Us.core.identity;Ca.makeStringMap=Us.core.makeStringMap;Ca.cloneStringMap=Us.core.cloneStringMap;Ca.numEnumArray=Us.core.numEnumArray;Ca.numEnumMap=Us.core.numEnumMap;Ca.strEnumArray=Us.core.strEnumArray;Ca.safePush=Us.core.safePush;Ca.safeConcat=Us.core.safeConcat;Ca.isDefined=Us.core.isDefined;Ca.isNone=Us.core.isNone;Ca.filterOutNones=Us.core.filterOutNones;Ca.pair=Us.core.pair;Ca.fastMin=Us.core.fastMin;Ca.fastMax=Us.core.fastMax;Ca.fastAbs=Us.core.fastAbs;Ca.makeStringCompareCI=Us.core.makeStringCompareCI;Ca.typedInstanceCreator=Us.core.typedInstanceCreator;Ca.singleton=Us.core.singleton;Ca.mapFromArrayOfPairs=Us.core.mapFromArrayOfPairs;Ca.now=Us.core.now});var R0=Y(tr=>{"use strict";_();Object.defineProperty(tr,"__esModule",{value:!0});tr.wsfNode=tr.operatorNode=tr.lambdaNode=tr.lambdaParam=tr.paramNode=tr.paramDefault=tr.paramName=tr.flattenLambdaArgs=tr.letNode=tr.letVar=tr.varNode=tr.indexedArg=tr.flattenLetArgs=tr.appNode=tr.arrayNode=tr.literalNode=tr.formulaRootAnnotation=tr.localNameDeclAnnotation=tr.localNameUseAnnotation=tr.formulaSpan=tr.multiLineComment=tr.singleLineComment=tr.formula=tr.cellRefBad=tr.cellRefCol=tr.cellRefRow=tr.cellRefRange=tr.cellRefSingle=tr.cellRefError=tr.pos=tr.badQualifier=tr.sheetRangeQualifier=tr.identQualifier=tr.sheetQualifier=tr.documentQualifier=tr.relativeQualifier=tr.errorQualifier=tr.BadType=tr.StructRefKind=tr.SpecialRefId=tr.NamePartKind=tr.NodeKind=tr.appHeadNameAnnotation=tr.AnnotationKind=tr.CommentKind=tr.PosKind=tr.CellRefKind=tr.QualifierKind=tr.SyntaxFeature=tr.RefStyle=void 0;tr.getDepthUpperBound=tr.badSequenceNode=tr.badCharsNode=tr.missingNode=tr.identNode=tr.structRef=tr.badRef=tr.missingRef=tr.thisRowOpRef=tr.commaOpRef=tr.rangeOpRef=tr.columnRef=tr.specialRef=tr.structRefNode=tr.fieldRef=tr.fieldRefNode=tr.cellRefNode=tr.contextNameNode=tr.headNamePart=tr.flattenNameParts=tr.fieldRefNamePart=tr.cellRefNamePart=tr.identNamePart=tr.nameNode=tr.parenNode=void 0;var IM=br(),iR=og(),_Y=Ep(),TQe=Ep(),bQe;(function(e){e[e.R1C1=1]="R1C1",e[e.A1=2]="A1"})(bQe=tr.RefStyle||(tr.RefStyle={}));var PQe;(function(e){e.Comments="Comments",e.Statements="Statements"})(PQe=tr.SyntaxFeature||(tr.SyntaxFeature={}));var oR;(function(e){e.Error="ErrorQualifier",e.Relative="RelativeQualifier",e.Document="DocumentQualifier",e.Sheet="SheetQualifier",e.Ident="IdentQualifier",e.SheetRange="SheetRangeQualifier",e.Bad="BadQualifier"})(oR=tr.QualifierKind||(tr.QualifierKind={}));var Kb;(function(e){e.Error="CellRefError",e.Single="CellRefSingle",e.Range="CellRefRange",e.Row="CellRefRow",e.Col="CellRefCol",e.Bad="CellRefBad"})(Kb=tr.CellRefKind||(tr.CellRefKind={}));var EQe;(function(e){e.Abs="Abs",e.Rel="Rel"})(EQe=tr.PosKind||(tr.PosKind={}));var TY;(function(e){e.SingleLine="SingleLineComment",e.MultiLine="MultiLineComment"})(TY=tr.CommentKind||(tr.CommentKind={}));var MM;(function(e){e.LocalNameUse="LocalNameUse",e.LocalNameDecl="LocalNameDecl",e.AppHeadName="AppHeadName",e.FormulaRoot="FormulaRoot"})(MM=tr.AnnotationKind||(tr.AnnotationKind={}));tr.appHeadNameAnnotation={kind:MM.AppHeadName};var Ri;(function(e){e.Literal="Literal",e.Array="Array",e.App="App",e.Let="Let",e.Lambda="Lambda",e.Paren="Paren",e.Name="Name",e.CellRef="CellRef",e.FieldRef="FieldRef",e.StructRef="StructRef",e.Missing="Missing",e.BadChars="BadChars",e.BadSequence="BadSequence",e.Operator="Operator",e.WSF="WSF",e.Var="Var",e.Param="Param",e.ContextName="ContextName",e.Ident="Ident",e.ParamName="ParamName",e.ParamDef="ParamDef",e.FieldRefRHS="FieldRefRHS",e.StructRefRHS="StructRefRHS"})(Ri=tr.NodeKind||(tr.NodeKind={}));var qA;(function(e){e.IdentNamePart="IdentNamePart",e.CellRefNamePart="CellRefNamePart",e.FieldRefNamePart="FieldRefNamePart"})(qA=tr.NamePartKind||(tr.NamePartKind={}));var LA;(function(e){e[e.All=1]="All",e[e.Data=2]="Data",e[e.Headers=3]="Headers",e[e.Totals=4]="Totals",e[e.ThisRow=5]="ThisRow"})(LA=tr.SpecialRefId||(tr.SpecialRefId={}));var jh;(function(e){e.SpecialRef="SpecialStructRef",e.ColumnRef="ColumnStructRef",e.RangeOpRef="RangeOpStructRef",e.CommaOpRef="CommaOpStructRef",e.ThisRowOpRef="ThisRowOpStructRef",e.MissingRef="MissingStructRef",e.BadRef="BadStructRef"})(jh=tr.StructRefKind||(tr.StructRefKind={}));var NQe;(function(e){e.Unexpected="Unexpected",e.Qualifier="Qualifier",e.NumberLiteral="NumberLiteral",e.StringLiteral="StringLiteral",e.ErrorLiteral="ErrorLiteral",e.FieldName="FieldName",e.ParamName="ParamName",e.StructRef="StructRef",e.FieldRef="FieldRef"})(NQe=tr.BadType||(tr.BadType={}));function AQe(e){return e===void 0&&(e=0),{kind:oR.Error,isQuoted:!1,isClosed:!0,isTerminated:!0,label:e}}tr.errorQualifier=AQe;function OQe(e){return e===void 0&&(e=0),{kind:oR.Relative,isQuoted:!1,isClosed:!0,isTerminated:!0,label:e}}tr.relativeQualifier=OQe;function kQe(e,r,n,a){return n===void 0&&(n=!1),a===void 0&&(a=0),{kind:oR.Document,isQuoted:n,isClosed:!0,isTerminated:!0,label:a,document:e,path:r}}tr.documentQualifier=kQe;function FQe(e,r,n,a){return n===void 0&&(n=!1),a===void 0&&(a=0),{kind:oR.Sheet,isQuoted:n,isClosed:!0,isTerminated:!0,label:a,sheet:e,document:r}}tr.sheetQualifier=FQe;function IQe(e,r,n){return r===void 0&&(r=!1),n===void 0&&(n=0),{kind:oR.Ident,isQuoted:r,isClosed:!0,isTerminated:!0,label:n,name:e}}tr.identQualifier=IQe;function MQe(e,r,n,a,o){return a===void 0&&(a=!1),o===void 0&&(o=0),{kind:oR.SheetRange,isQuoted:a,isClosed:!0,isTerminated:!0,label:o,sheet1:e,sheet2:r,document:n}}tr.sheetRangeQualifier=MQe;function wQe(e,r,n,a,o){return r===void 0&&(r=!1),n===void 0&&(n=!0),a===void 0&&(a=!0),o===void 0&&(o=0),{kind:oR.Bad,isQuoted:r,isClosed:n,isTerminated:a,label:o,chars:e}}tr.badQualifier=wQe;function DQe(e,r){return{kind:e,index:r}}tr.pos=DQe;function xQe(e){e===void 0&&(e=0);var r=!1;return{kind:Kb.Error,label:e,isBracketed:r}}tr.cellRefError=xQe;function LQe(e,r,n,a){return n===void 0&&(n=!1),a===void 0&&(a=0),{kind:Kb.Single,label:a,row:e,col:r,isBracketed:n}}tr.cellRefSingle=LQe;function BQe(e,r,n){n===void 0&&(n=0);var a=e.isBracketed||r.isBracketed;return{kind:Kb.Range,label:n,ref1:e,ref2:r,isBracketed:a}}tr.cellRefRange=BQe;function qQe(e,r,n,a){return n===void 0&&(n=!1),a===void 0&&(a=0),{kind:Kb.Row,label:a,row1:e,row2:r,isBracketed:n}}tr.cellRefRow=qQe;function UQe(e,r,n,a){return n===void 0&&(n=!1),a===void 0&&(a=0),{kind:Kb.Col,label:a,col1:e,col2:r,isBracketed:n}}tr.cellRefCol=UQe;function GQe(e,r,n){return r===void 0&&(r=!1),n===void 0&&(n=0),{kind:Kb.Bad,label:n,chars:e,isBracketed:r}}tr.cellRefBad=GQe;function KQe(e,r,n,a){return{node:e,spans:r,annotations:n,depthUpperBound:a??Zme(e)}}tr.formula=KQe;function VQe(e,r){return r===void 0&&(r=0),{kind:TY.SingleLine,label:r,chars:e,isClosed:!0}}tr.singleLineComment=VQe;function WQe(e,r,n){return r===void 0&&(r=!0),n===void 0&&(n=0),{kind:TY.MultiLine,label:n,chars:e,isClosed:r}}tr.multiLineComment=WQe;function jQe(e,r,n,a,o,u){return(0,iR.assertNatural)("calc.lang.formulaSpan",e),(0,iR.assertInteger)("calc.lang.formulaSpan",r),r<e&&(0,iR.assertFalse)("calc.lang.formulaSpan: expected end >= ".concat(e,"; given ").concat(r)),{start:e,end:r,pre:n,post:a,preComments:o,postComments:u}}tr.formulaSpan=jQe;function HQe(e,r,n){return{kind:MM.LocalNameUse,name:e,whole:r,label:n}}tr.localNameUseAnnotation=HQe;function QQe(e,r,n){return n===void 0&&(n=[]),{kind:MM.LocalNameDecl,name:e,whole:r,uses:n}}tr.localNameDeclAnnotation=QQe;function zQe(e,r){return{kind:MM.FormulaRoot,contextNames:e,syntaxFeatures:r}}tr.formulaRootAnnotation=zQe;function YQe(e,r,n){return r===void 0&&(r=!0),n===void 0&&(n=0),{kind:Ri.Literal,label:n,oper:e,isClosed:r}}tr.literalNode=YQe;function JQe(e,r,n){return r===void 0&&(r=!0),n===void 0&&(n=0),{kind:Ri.Array,label:n,nodes:e,isClosed:r}}tr.arrayNode=JQe;function XQe(e,r,n,a){return n===void 0&&(n=!0),a===void 0&&(a=0),{kind:Ri.App,label:a,head:e,args:r,isClosed:n}}tr.appNode=XQe;function ZQe(e){return Array.isArray(e)}function RY(e){return e.kind!==void 0}function Qme(e){for(var r=[],n=0,a=e;n<a.length;n++){var o=a[n],u=o.arg,t=o.index;(0,iR.assertIndex)("calc.lang.flattenNumberedArgs: idx",t,e.length),(0,iR.assertTrue)("calc.lang.flattenNumberedArgs: repetition",r[t]===void 0),r[t]=u}return r}function zme(e,r,n){return Qme((0,TQe.safeConcat)(IM.__spreadArray(IM.__spreadArray([],r===void 0?[]:[r],!0),n,!0),e.map(function(a){var o=a.name,u=a.binder;return[o,u]})))}tr.flattenLetArgs=zme;function BA(e,r){return(0,iR.assertNatural)("calc.lang.indexedArg: index",r),{arg:e,index:r}}tr.indexedArg=BA;function $Qe(e,r){return r===void 0&&(r=0),{kind:Ri.Var,label:r,name:e,wholeName:e.whole}}tr.varNode=$Qe;function Yme(e,r){return{name:e,binder:r}}tr.letVar=Yme;function eze(e,r,n,a,o,u){a===void 0&&(a=[]),o===void 0&&(o=!0),u===void 0&&(u=0);var t=r.map(function(c,l){return ZQe(c)?Yme(BA(c[0],l*2),BA(c[1],l*2+1)):c}).sort(function(c,l){return c.name.index-l.name.index}),d=n===void 0||!RY(n)?n:BA(n,t.length*2),s=zme(t,d,a);return{kind:Ri.Let,label:u,head:e,args:s,isClosed:o,vars:t,body:d,badArgs:a}}tr.letNode=eze;function Jme(e,r,n){return n===void 0&&(n=[]),Qme(IM.__spreadArray(IM.__spreadArray(IM.__spreadArray([],e.map(function(a){return a.name}),!0),r===void 0?[]:[r],!0),n,!0))}tr.flattenLambdaArgs=Jme;function rze(e,r,n,a){return n===void 0&&(n=!0),a===void 0&&(a=0),{kind:Ri.ParamName,label:a,name:e,isBracketed:r,isClosed:n}}tr.paramName=rze;function nze(e,r){return r===void 0&&(r=0),{kind:Ri.ParamDef,label:r,rhs:e}}tr.paramDefault=nze;function tze(e,r,n){return n===void 0&&(n=0),{kind:Ri.Param,label:n,name:e,wholeName:e.name.kind===Ri.Ident?e.name.whole:void 0,def:r,isOptional:e.isBracketed||r!==void 0}}tr.paramNode=tze;function Xme(e){return{name:e}}tr.lambdaParam=Xme;function aze(e,r,n,a,o,u){a===void 0&&(a=[]),o===void 0&&(o=!0),u===void 0&&(u=0);var t=r.map(function(c,l){return RY(c)?Xme(BA(c,l)):c}).sort(function(c,l){return c.name.index-l.name.index}),d=n===void 0||!RY(n)?n:BA(n,t.length),s=Jme(t,d,a);return{kind:Ri.Lambda,label:u,head:e,args:s,isClosed:o,params:t,body:d,badArgs:a}}tr.lambdaNode=aze;function ize(e,r){return r===void 0&&(r=0),{kind:Ri.Operator,label:r,id:e}}tr.operatorNode=ize;function oze(e,r,n){return n===void 0&&(n=0),{kind:Ri.WSF,label:n,id:e,whole:r}}tr.wsfNode=oze;function uze(e,r,n){return r===void 0&&(r=!0),n===void 0&&(n=0),{kind:Ri.Paren,label:n,node:e,isClosed:r}}tr.parenNode=uze;function sze(e,r,n){return n===void 0&&(n=0),{kind:Ri.Name,label:n,whole:e.asWhole,parts:e,qualifier:r}}tr.nameNode=sze;function lze(e,r,n,a){return r===void 0&&(r=!0),n===void 0&&(n=0),a===void 0&&(a=0),{kind:qA.IdentNamePart,label:n,qualifiedLabel:a,asWhole:e,canDenoteNamedObject:r}}tr.identNamePart=lze;function cze(e,r,n,a){return n===void 0&&(n=0),a===void 0&&(a=0),{kind:qA.CellRefNamePart,label:n,qualifiedLabel:a,asWhole:r,canDenoteNamedObject:!1,ref:e}}tr.cellRefNamePart=cze;function dze(e,r,n,a,o){return n===void 0&&(n=!0),a===void 0&&(a=0),o===void 0&&(o=0),(0,iR.assertTrue)("calc.lang.fieldRefNamePart",r.isClosed&&!r.isBracketed),{kind:qA.FieldRefNamePart,label:a,qualifiedLabel:o,asWhole:e.asWhole+"."+(r.field.kind===Ri.Ident?r.field.whole:r.field.chars),canDenoteNamedObject:n,lhs:e,rhs:r}}tr.fieldRefNamePart=dze;function fze(e){for(var r=[e],n=r[0];n.kind===qA.FieldRefNamePart;)r.push(n.lhs),n=n.lhs;return r.reverse(),{kind:n.kind,parts:r}}tr.flattenNameParts=fze;function pze(e){for(var r=e;r.kind===qA.FieldRefNamePart;)r=r.lhs;return r}tr.headNamePart=pze;function mze(e,r){return r===void 0&&(r=0),{kind:Ri.ContextName,label:r,whole:e}}tr.contextNameNode=mze;function gze(e,r,n){return n===void 0&&(n=0),{kind:Ri.CellRef,label:n,ref:e,qualifier:r}}tr.cellRefNode=gze;function vze(e,r,n,a){return n===void 0&&(n=!1),a===void 0&&(a=0),{kind:Ri.FieldRef,label:a,lhs:e,rhs:r,shouldBeBracketed:n}}tr.fieldRefNode=vze;function hze(e,r,n,a){return r===void 0&&(r=!1),n===void 0&&(n=!0),a===void 0&&(a=0),{kind:Ri.FieldRefRHS,label:a,field:e,isBracketed:r,isClosed:n}}tr.fieldRef=hze;function Sze(e,r,n){return n===void 0&&(n=0),{kind:Ri.StructRef,label:n,lhs:e,rhs:r}}tr.structRefNode=Sze;function yze(e,r,n,a){return r===void 0&&(r=!1),n===void 0&&(n=!0),a===void 0&&(a=0),{kind:jh.SpecialRef,label:a,id:e,isBracketed:r,isClosed:n}}tr.specialRef=yze;function Cze(e,r,n,a){return r===void 0&&(r=!1),n===void 0&&(n=!0),a===void 0&&(a=0),{kind:jh.ColumnRef,label:a,name:e,isBracketed:r,isClosed:n}}tr.columnRef=Cze;function _ze(e,r,n){return n===void 0&&(n=0),{kind:jh.RangeOpRef,label:n,lhs:e,rhs:r}}tr.rangeOpRef=_ze;function Rze(e,r){var n;r===void 0&&(r=0);for(var a=(n={},n[LA.All]=!1,n[LA.Data]=!1,n[LA.Headers]=!1,n[LA.Totals]=!1,n[LA.ThisRow]=!1,n),o=[],u=0,t=e;u<t.length;u++){var d=t[u];switch(d.kind){case jh.SpecialRef:a[d.id]=!0;break;case jh.ColumnRef:case jh.RangeOpRef:o.push(d);break}}return{kind:jh.CommaOpRef,label:r,refs:e,specialRefs:a,columnRefs:o}}tr.commaOpRef=Rze;function Tze(e,r){return r===void 0&&(r=0),{kind:jh.ThisRowOpRef,label:r,ref:e}}tr.thisRowOpRef=Tze;function bze(e){return e===void 0&&(e=0),{kind:jh.MissingRef,label:e}}tr.missingRef=bze;function Pze(e,r,n,a){return r===void 0&&(r=!1),n===void 0&&(n=!0),a===void 0&&(a=0),{kind:jh.BadRef,chars:e,isBracketed:r,isClosed:n,label:a}}tr.badRef=Pze;function Eze(e,r,n){return r===void 0&&(r=!0),n===void 0&&(n=0),{kind:Ri.StructRefRHS,label:n,isClosed:r,innerRef:e}}tr.structRef=Eze;function Nze(e,r){return r===void 0&&(r=0),{kind:Ri.Ident,label:r,whole:e}}tr.identNode=Nze;function Aze(e,r){return e===void 0&&(e=""),r===void 0&&(r=0),{kind:Ri.Missing,label:r,chars:e}}tr.missingNode=Aze;function Oze(e,r,n){return n===void 0&&(n=0),{kind:Ri.BadChars,label:n,type:e,chars:r}}tr.badCharsNode=Oze;function kze(e,r,n){return n===void 0&&(n=0),{kind:Ri.BadSequence,label:n,type:e,contents:r}}tr.badSequenceNode=kze;var Fze=50;function aR(e,r){if(r>Fze)return 1/0;switch(e.kind){case Ri.Array:{for(var n=0,a=0,o=e.nodes;a<o.length;a++)for(var u=o[a],t=0,d=u;t<d.length;t++){var s=d[t];n=(0,_Y.fastMax)(n,aR(s,r+1))}return n+1}case Ri.Param:return e.def===void 0?1:aR(e.def.rhs,r+1)+1;case Ri.Let:case Ri.Lambda:case Ri.App:{for(var n=aR(e.head,r+1),c=0,l=e.args;c<l.length;c++){var f=l[c];n=(0,_Y.fastMax)(n,aR(f,r+1))}return n+1}case Ri.Paren:return aR(e.node,r+1)+1;case Ri.FieldRef:return aR(e.lhs,r+1)+1;case Ri.Var:case Ri.Name:case Ri.CellRef:case Ri.StructRef:case Ri.Literal:case Ri.Operator:case Ri.WSF:case Ri.Missing:case Ri.BadChars:return 1;case Ri.BadSequence:{for(var n=0,p=0,m=e.contents;p<m.length;p++){var v=m[p];n=(0,_Y.fastMax)(n,aR(v,r+1))}return n+1}default:return(0,iR.assertNever)("calc.lang.getDepthUpperBound",e)}}function Zme(e){return aR(e,0)}tr.getDepthUpperBound=Zme});var Wb=Y(Np=>{"use strict";_();Object.defineProperty(Np,"__esModule",{value:!0});Np.successUndefined=Np.success=Np.javaScriptError=Np.isSuccess=Np.failure=Np.ResultKind=Np.ReasonKind=void 0;var Vb=Cn();Np.ReasonKind=Vb.result.ReasonKind;Np.ResultKind=Vb.result.ResultKind;Np.failure=Vb.result.failure;Np.isSuccess=Vb.result.isSuccess;Np.javaScriptError=Vb.result.javaScriptError;Np.success=Vb.result.success;Np.successUndefined=Vb.result.successUndefined});var $me=Y(Ap=>{"use strict";_();Object.defineProperty(Ap,"__esModule",{value:!0});Ap.ivlCompare=Ap.ivlExcept=Ap.ivlMeetsOrTouches=Ap.ivlMeets=Ap.ivlDistance=Ap.ivlMeet=Ap.ivlJoin=void 0;var jb=Cn();Ap.ivlJoin=jb.interval.ivlJoin;Ap.ivlMeet=jb.interval.ivlMeet;Ap.ivlDistance=jb.interval.ivlDistance;Ap.ivlMeets=jb.interval.ivlMeets;Ap.ivlMeetsOrTouches=jb.interval.ivlMeetsOrTouches;Ap.ivlExcept=jb.interval.ivlExcept;Ap.ivlCompare=jb.interval.ivlCompare});var rge=Y(tf=>{"use strict";_();Object.defineProperty(tf,"__esModule",{value:!0});tf.setFeatureGateDictionaryGetter=tf.overrideTypedFeatureGates=tf.isTypedChangeGateEnabled=tf.getTypedFeatureGate=tf.getFeatures=tf.isFeatureEnabled=tf.initFeatureConfiguration=tf.FeatureName=void 0;var UA=Cn();tf.FeatureName=UA.featureConfiguration.FeatureName;tf.initFeatureConfiguration=UA.featureConfiguration.initFeatureConfiguration;tf.isFeatureEnabled=UA.featureConfiguration.isFeatureEnabled;tf.getFeatures=UA.featureConfiguration.getFeatures;tf.getTypedFeatureGate=UA.featureConfiguration.getTypedFeatureGate;tf.isTypedChangeGateEnabled=UA.featureConfiguration.isTypedChangeGateEnabled;var ege=Ql();Object.defineProperty(tf,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return ege.overrideTypedFeatureGates}});Object.defineProperty(tf,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return ege.setFeatureGateDictionaryGetter}})});var KA=Y(Nc=>{"use strict";_();Object.defineProperty(Nc,"__esModule",{value:!0});Nc.getWorksheetFuncEnglishName=Nc.getWorksheetFuncType=Nc.getOperatorType=Nc.operatorStrings=Nc.OperatorId=Nc.higherOrderFunctionType=Nc.unknownFunctionType=Nc.WorksheetFuncId=void 0;var mn=lC(),ms=oB();Object.defineProperty(Nc,"WorksheetFuncId",{enumerable:!0,get:function(){return ms.WorksheetFuncId}});var uB=rge();Nc.unknownFunctionType=(0,mn.functionType)(0,254,[],[mn.SignatureType.All],[],mn.SignatureType.All,mn.SpecialPrecs.All,mn.FunctionFlags.None);function Ize(){var e=mn.OperKind.Number|mn.OperKind.String|mn.OperKind.Boolean|mn.OperKind.Rich|mn.OperKind.Error|mn.OperKind.Blank|((0,uB.isFeatureEnabled)(uB.FeatureName.CalcLambdaCellValues)?0:mn.OperKind.Range)|((0,uB.isFeatureEnabled)(uB.FeatureName.CalcLambdaArrayLifting)?0:mn.OperKind.Array),r=mn.OperKind.Number|mn.OperKind.String|mn.OperKind.Boolean|mn.OperKind.Rich|mn.OperKind.Error|mn.OperKind.Blank|mn.OperKind.Missing|mn.OperKind.Array|mn.OperKind.Range;return(0,mn.functionType)(1,255,[e],[r],[],mn.SignatureType.All,mn.SpecialPrecs.None,mn.FunctionFlags.Allow3dRef)}Nc.higherOrderFunctionType=Ize;var _s;(function(e){e[e.Add=1]="Add",e[e.Sub=2]="Sub",e[e.Mul=3]="Mul",e[e.Div=4]="Div",e[e.Pow=5]="Pow",e[e.Percent=6]="Percent",e[e.Neg=7]="Neg",e[e.Pos=8]="Pos",e[e.Concat=9]="Concat",e[e.Eq=10]="Eq",e[e.Ne=11]="Ne",e[e.Lt=12]="Lt",e[e.Le=13]="Le",e[e.Gt=14]="Gt",e[e.Ge=15]="Ge",e[e.Range=16]="Range",e[e.Isect=17]="Isect",e[e.Union=18]="Union",e[e.And=19]="And",e[e.Or=20]="Or",e[e.Xor=21]="Xor",e[e.Min=22]="Min",e[e.Max=23]="Max",e[e.At=24]="At",e[e.Pound=25]="Pound"})(_s=Nc.OperatorId||(Nc.OperatorId={}));Nc.operatorStrings=[void 0,"+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":",void 0,void 0,"&&","||","^^",void 0,void 0,"@","#"];var nge=mn.OperKind.Number|mn.OperKind.String|mn.OperKind.Boolean|mn.OperKind.Blank,tge=mn.OperKind.Number|mn.OperKind.String|mn.OperKind.Boolean|mn.OperKind.Blank,Hb=(0,mn.functionType)(2,2,[mn.OperKind.Number,mn.OperKind.Number],[],[],mn.OperKind.Number,mn.SpecialPrecs.None,mn.FunctionFlags.None),age=(0,mn.functionType)(1,1,[mn.OperKind.Number],[],[],mn.OperKind.Number,mn.SpecialPrecs.None,mn.FunctionFlags.None),Mze=(0,mn.functionType)(1,1,[nge],[],[],nge,mn.SpecialPrecs.None,mn.FunctionFlags.None),wze=(0,mn.functionType)(2,2,[mn.OperKind.String,mn.OperKind.String],[],[],mn.OperKind.String,mn.SpecialPrecs.None,mn.FunctionFlags.None),GA=(0,mn.functionType)(2,2,[tge,tge],[],[],mn.OperKind.Boolean,mn.SpecialPrecs.None,mn.FunctionFlags.None),Dze=(0,mn.functionType)(2,2,[mn.OperKind.Range,mn.OperKind.Range],[],[],mn.OperKind.Range,mn.SpecialPrecs.AllCells,mn.FunctionFlags.None),ige=(0,mn.functionType)(2,2,[mn.OperKind.Range,mn.OperKind.Range],[],[],mn.OperKind.Range,mn.SpecialPrecs.None,mn.FunctionFlags.None),bY=(0,mn.functionType)(2,2,[mn.OperKind.Boolean,mn.OperKind.Boolean],[],[],mn.OperKind.Boolean,mn.SpecialPrecs.None,mn.FunctionFlags.None),Rs=[];Rs[_s.Add]=Hb;Rs[_s.Sub]=Hb;Rs[_s.Mul]=Hb;Rs[_s.Div]=Hb;Rs[_s.Pow]=Hb;Rs[_s.Percent]=age;Rs[_s.Neg]=age;Rs[_s.At]=ms.worksheetFuncTypes[ms.WorksheetFuncId.SINGLE];Rs[_s.Pound]=ms.worksheetFuncTypes[ms.WorksheetFuncId.ANCHORARRAY];Rs[_s.Pos]=Mze;Rs[_s.Concat]=wze;Rs[_s.Eq]=GA;Rs[_s.Ne]=GA;Rs[_s.Lt]=GA;Rs[_s.Le]=GA;Rs[_s.Gt]=GA;Rs[_s.Ge]=GA;Rs[_s.Range]=Dze;Rs[_s.Isect]=ige;Rs[_s.Union]=ige;Rs[_s.And]=bY;Rs[_s.Or]=bY;Rs[_s.Xor]=bY;Rs[_s.Min]=Hb;Rs[_s.Max]=Hb;function xze(e){var r=Rs[e];return r??Nc.unknownFunctionType}Nc.getOperatorType=xze;function Lze(e){var r=ms.worksheetFuncTypes[e];return r??Nc.unknownFunctionType}Nc.getWorksheetFuncType=Lze;function Bze(e){return ms.worksheetFuncEnglishNames[e]}Nc.getWorksheetFuncEnglishName=Bze;function Od(e,r){var n=ms.worksheetFuncTypes[e];n!=null&&(n.staticPrecs=r)}Od(ms.WorksheetFuncId.ROW,mn.SpecialPrecs.OwnRow);Od(ms.WorksheetFuncId.COLUMN,mn.SpecialPrecs.OwnCol);Od(ms.WorksheetFuncId.SHEET,mn.SpecialPrecs.OwnDocSheets);Od(ms.WorksheetFuncId.SHEETS,mn.SpecialPrecs.OwnDocSheets);Od(ms.WorksheetFuncId.OFFSET,mn.SpecialPrecs.AllCells);Od(ms.WorksheetFuncId.INDIRECT,mn.SpecialPrecs.AllCells);Od(ms.WorksheetFuncId.SUMIF,mn.SpecialPrecs.AllCells);Od(ms.WorksheetFuncId.AVERAGEIF,mn.SpecialPrecs.AllCells);Od(ms.WorksheetFuncId.LOOKUP,mn.SpecialPrecs.AllCells);Od(ms.WorksheetFuncId.ADDRESS,mn.SpecialPrecs.RefStyle);Od(ms.WorksheetFuncId.FORMULATEXT,mn.SpecialPrecs.RefStyle);Od(ms.WorksheetFuncId.NOW,mn.SpecialPrecs.Time);Od(ms.WorksheetFuncId.TODAY,mn.SpecialPrecs.Time);Od(ms.WorksheetFuncId.RAND,mn.SpecialPrecs.Calc);Od(ms.WorksheetFuncId.RANDBETWEEN,mn.SpecialPrecs.Calc);Od(ms.WorksheetFuncId.RANDARRAY,mn.SpecialPrecs.Calc);Od(ms.WorksheetFuncId.SUBTOTAL,mn.SpecialPrecs.CellProps);Od(ms.WorksheetFuncId.CELL,mn.SpecialPrecs.CellProps|mn.SpecialPrecs.AllCells);Od(ms.WorksheetFuncId.INFO,mn.SpecialPrecs.None)});var t1=Y(hr=>{"use strict";_();var Qb;Object.defineProperty(hr,"__esModule",{value:!0});hr.isReadOperEqual=hr.isWriteOper=hr.isPrimitiveOper=hr.isRichOper=hr.isBlankOper=hr.isMissingOper=hr.isArrayOper=hr.isRangeOper=hr.isErrorOper=hr.isBooleanOper=hr.isStringOper=hr.isNumberOper=hr.shouldFieldRefBeBracketed=hr.isValidArgsLength=hr.getArgType=hr.isBooleanLiteralNode=hr.isNumberLiteralNode=hr.isMissingLiteralNode=hr.isMissingNode=hr.isUnqualifiedNameNode=hr.isWSFNode=hr.isOperatorNode=hr.getArguments=hr.gridCellRange=hr.sheetGridRangeAnchor=hr.gridRangeAnchor=hr.isSheetGridRangeEqual=hr.isSheetGridCellEqual=hr.isGridRangeEqual=hr.isGridCellEqual=hr.isNameScopeEqual=hr.sheetRangeToSheetIndex=hr.isSheetIndexEqual=hr.isDocumentLocEqual=hr.gridRangeSize=hr.gridRangeExcept=hr.gridRangeCompare=hr.gridCellImplicitIsect=hr.gridRangeIsects=hr.gridRangeIsect=hr.gridRangesJoin=hr.gridRangeJoinOpt=hr.gridRangeJoin=hr.forEachTileInRange=hr.forEachCellInRange=hr.isWellFormed=hr.isSheetGridRange=hr.isSheetIndex=hr.isSheetGridCell=hr.isGridCell=void 0;hr.applyComparison=hr.normalizeCommaOpRef=hr.isRangeOpNoMissing=hr.isRangeOpClosed=hr.isCommaOpNoBadOrMissing=hr.isCommaOpClosed=hr.isCommaOpRefWellFormed=hr.getBoundName=hr.getUserDefinedFuncName=hr.getWorksheetFuncId=hr.createFailureErrorClass=hr.internal=hr.unavailable=hr.notImplemented=hr.ReasonKind=hr.LangReasonKind=void 0;var pB=br(),n1=og(),Jl=sv();Object.defineProperty(hr,"isGridCell",{enumerable:!0,get:function(){return Jl.isGridCell}});Object.defineProperty(hr,"isSheetGridCell",{enumerable:!0,get:function(){return Jl.isSheetGridCell}});var Su=R0(),Gs=lC(),qze=Wb(),Op=Ep(),sB=$me(),VA=KA(),uge=sv();Object.defineProperty(hr,"isSheetIndex",{enumerable:!0,get:function(){return uge.isSheetIndex}});Object.defineProperty(hr,"isSheetGridRange",{enumerable:!0,get:function(){return uge.isSheetGridRange}});function Uze(e){return e.isWellFormed}hr.isWellFormed=Uze;function Gze(e,r){if((0,Jl.isGridCell)(e))return r(e,0,0);for(var n=e.row,a=e.rows,o=e.col,u=e.cols,t=0;t<a;t+=1)for(var d=0;d<u;d+=1)if(!r((0,Jl.gridCell)(n+t,o+d),t,d))return!1;return!0}hr.forEachCellInRange=Gze;function Kze(e,r,n){var a=e.row,o=e.rows,u=e.col,t=e.cols;(0,n1.assertPositiveInteger)("calc.lang.forEachTileInRange",r),(0,n1.assertIndex)("calc.lang.forEachTileInRange",a,Jl.sheetRows),(0,n1.assertIndex)("calc.lang.forEachTileInRange",u,Jl.sheetCols),(0,n1.assertPositiveLength)("calc.lang.forEachTileInRange",o,Jl.sheetRows-a),(0,n1.assertPositiveLength)("calc.lang.forEachTileInRange",t,Jl.sheetCols-u);for(var d=a;d<a+o;d+=r)for(var s=u;s<u+t;s+=r)if(!n((0,Jl.unsafeGridRange)(d,s,(0,Op.fastMin)(r,o+a-d),(0,Op.fastMin)(r,t+u-s))))return!1;return!0}hr.forEachTileInRange=Kze;function EY(e,r){var n=e.row,a=e.col,o=e.rows,u=e.cols,t=r.row,d=r.col,s=r.rows,c=r.cols,l=(0,Op.fastMin)(n,t),f=(0,Op.fastMin)(a,d),p=(0,Op.fastMax)(n+o,t+s)-l,m=(0,Op.fastMax)(a+u,d+c)-f;return(0,Jl.unsafeGridRange)(l,f,p,m)}hr.gridRangeJoin=EY;function Vze(e,r){return e?r?EY(e,r):e:r}hr.gridRangeJoinOpt=Vze;function Wze(e){return e.length===0&&(0,n1.assertFalse)("calc.runtime.gridRangesJoin: expected nonempty range array"),e.reduce(EY)}hr.gridRangesJoin=Wze;function jze(e,r){var n=e.row,a=e.col,o=e.rows,u=e.cols,t=r.row,d=r.col,s=r.rows,c=r.cols,l=(0,Op.fastMax)(n,t),f=(0,Op.fastMax)(a,d),p=(0,Op.fastMin)(n+o,t+s)-l,m=(0,Op.fastMin)(a+u,d+c)-f;if(!(p<=0||m<=0))return(0,Jl.unsafeGridRange)(l,f,p,m)}hr.gridRangeIsect=jze;function Hze(e,r){var n=e.row,a=e.col,o=e.rows,u=e.cols,t=r.row,d=r.col,s=r.rows,c=r.cols;return(0,Op.fastMax)(n,t)<(0,Op.fastMin)(n+o,t+s)&&(0,Op.fastMax)(a,d)<(0,Op.fastMin)(a+u,d+c)}hr.gridRangeIsects=Hze;function Qze(e,r){var n=e.row,a=e.col,o=r.row,u=r.col,t=r.rows,d=r.cols,s=o<=n&&n<o+t,c=u<=a&&a<u+d;if(s&&c)return(0,Jl.gridCell)(n,a);if(s&&d===1)return(0,Jl.gridCell)(n,u);if(c&&t===1)return(0,Jl.gridCell)(o,a);if(d===1&&t===1)return(0,Jl.gridCell)(o,u)}hr.gridCellImplicitIsect=Qze;function zze(e,r){var n=e.row,a=e.col,o=e.rows,u=e.cols,t=r.row,d=r.col,s=r.rows,c=r.cols,l=n+o,f=t+s,p=a+u,m=d+c;if(n===t&&l===f&&a===d&&p===m)return 0;if(n<=t&&l>=f&&a<=d&&p>=m)return 1;if(n>=t&&l<=f&&a>=d&&p<=m)return-1}hr.gridRangeCompare=zze;function Yze(e,r){var n=[e.row,e.row+e.rows],a=[e.col,e.col+e.cols],o=[r.row,r.row+r.rows],u=[r.col,r.col+r.cols],t=(0,sB.ivlCompare)(n,o),d=(0,sB.ivlCompare)(a,u);if(t!==void 0&&t<=0){var s=(0,sB.ivlExcept)(a,u);if(s!==void 0)return(0,Jl.gridRange)(e.row,s[0],e.rows,s[1]-s[0])}if(d!==void 0&&d<=0){var c=(0,sB.ivlExcept)(n,o);if(c!==void 0)return(0,Jl.gridRange)(c[0],e.col,c[1]-c[0],e.cols)}}hr.gridRangeExcept=Yze;function Jze(e){return e.rows*e.cols}hr.gridRangeSize=Jze;function NY(e,r){return e===r?!0:e.name===r.name&&e.path===r.path}hr.isDocumentLocEqual=NY;function AY(e,r){return NY(e.document,r.document)&&e.index===r.index}hr.isSheetIndexEqual=AY;function Xze(e){if(e.index===e.index2)return pB.__assign(pB.__assign({},e),{__isRange:!1})}hr.sheetRangeToSheetIndex=Xze;function Zze(e,r){return NY(e.document,r.document)&&e.index===r.index}hr.isNameScopeEqual=Zze;function sge(e,r){return e.row===r.row&&e.col===r.col}hr.isGridCellEqual=sge;function lge(e,r){return e.row===r.row&&e.col===r.col&&e.rows===r.rows&&e.cols===r.cols}hr.isGridRangeEqual=lge;function $ze(e,r){return AY(e.sheet,r.sheet)&&sge(e.range,r.range)}hr.isSheetGridCellEqual=$ze;function eYe(e,r){return AY(e.sheet,r.sheet)&&lge(e.range,r.range)}hr.isSheetGridRangeEqual=eYe;function cge(e){return(0,Jl.isGridCell)(e)?e:(0,Jl.unsafeGridRange)(e.row,e.col,1,1)}hr.gridRangeAnchor=cge;function rYe(e){return(0,Jl.isSheetGridCell)(e)?e:(0,Jl.sheetGridCell)(e.sheet,cge(e.range))}hr.sheetGridRangeAnchor=rYe;function nYe(e,r){var n=e.row,a=e.col,o=r.row,u=r.col;return(0,Jl.unsafeGridRange)((0,Op.fastMin)(n,o),(0,Op.fastMin)(a,u),Math.abs(o-n)+1,Math.abs(u-a)+1)}hr.gridCellRange=nYe;function tYe(e){return e.length===1&&dge(e[0])?0:e.length}var aYe=[];function iYe(e){return tYe(e)===0?aYe:e}hr.getArguments=iYe;function oYe(e){return e.kind===Su.NodeKind.Operator}hr.isOperatorNode=oYe;function uYe(e){return e.kind===Su.NodeKind.WSF}hr.isWSFNode=uYe;function sYe(e){return e.kind===Su.NodeKind.Name&&e.qualifier===void 0}hr.isUnqualifiedNameNode=sYe;function lYe(e){return e.kind===Su.NodeKind.Missing}hr.isMissingNode=lYe;function dge(e){return e.kind===Su.NodeKind.Literal&&gge(e.oper)}hr.isMissingLiteralNode=dge;function cYe(e){return e.kind===Su.NodeKind.Literal&&pge(e.oper)}hr.isNumberLiteralNode=cYe;function fge(e){return e.kind===Su.NodeKind.Literal&&mge(e.oper)}hr.isBooleanLiteralNode=fge;function dYe(e,r,n){var a=e.maxArgs,o=e.headTypes,u=e.restTypes,t=e.tailTypes;if((0,n1.assertPositiveInteger)("calc.runtime.getArgType: n",n),(0,n1.assertIndex)("calc.runtime.getArgType: i",r,n),r>=a)return Gs.SignatureType.None;if(r<o.length)return o[r];if(u.length===0)return Gs.SignatureType.None;if(r<o.length+u.length)return u[r-o.length];var d=(n-o.length)%u.length;return d>t.length?Gs.SignatureType.None:r>=n-d?t[r-(n-d)]:u[(r-o.length)%u.length]}hr.getArgType=dYe;function fYe(e,r){var n=e.minArgs,a=e.maxArgs,o=e.headTypes,u=e.restTypes,t=e.tailTypes;if(r<n||r>a)return!1;if(r<=o.length+u.length)return!0;if(u.length===0)return!1;var d=(r-o.length)%u.length;return d<=t.length}hr.isValidArgsLength=fYe;function pYe(e,r,n){return n.length>0&&r.field.kind===Su.NodeKind.Ident&&(fge(e)||e.kind===Su.NodeKind.Name||e.kind===Su.NodeKind.CellRef)}hr.shouldFieldRefBeBracketed=pYe;function pge(e){return e.kind===Gs.OperKind.Number}hr.isNumberOper=pge;function mYe(e){return e.kind===Gs.OperKind.String}hr.isStringOper=mYe;function mge(e){return e.kind===Gs.OperKind.Boolean}hr.isBooleanOper=mge;function gYe(e){return e.kind===Gs.OperKind.Error}hr.isErrorOper=gYe;function vYe(e){return e.kind===Gs.OperKind.Range}hr.isRangeOper=vYe;function hYe(e){return e.kind===Gs.OperKind.Array}hr.isArrayOper=hYe;function gge(e){return e.kind===Gs.OperKind.Missing}hr.isMissingOper=gge;function SYe(e){return e.kind===Gs.OperKind.Blank}hr.isBlankOper=SYe;function yYe(e){return e.kind===Gs.OperKind.Rich}hr.isRichOper=yYe;var vge=Gs.OperKind.Number|Gs.OperKind.String|Gs.OperKind.Boolean;function CYe(e){return(e.kind&vge)!==0}hr.isPrimitiveOper=CYe;var _Ye=vge|Gs.OperKind.Error|Gs.OperKind.Array|Gs.OperKind.Rich;function RYe(e){return(e.kind&_Ye)!==0}hr.isWriteOper=RYe;function hge(e,r,n,a){if(n.kind!==r.kind)return!1;switch(n.kind){case Gs.OperKind.Boolean:case Gs.OperKind.String:return n.value===r.value;case Gs.OperKind.Number:return e.cond2(n,r)===0;case Gs.OperKind.Error:return n.type===r.type;case Gs.OperKind.Rich:return a;case Gs.OperKind.Array:var o=r;if(n.cols!==o.cols||n.rows!==o.rows)return!1;for(var u=0;u<n.rows;u+=1)for(var t=n.opers[u],d=o.opers[u],s=0;s<n.cols;s+=1)if(!hge(e,d[s],t[s],a))return!1;return!0;case Gs.OperKind.Blank:return!0;default:return(0,n1.assertNever)("calc.lang.readOperEq",n)}}hr.isReadOperEqual=hge;var Sge;(function(e){e.NotImplemented="NotImplemented",e.Unavailable="Unavailable",e.Internal="Internal"})(Sge=hr.LangReasonKind||(hr.LangReasonKind={}));hr.ReasonKind=pB.__assign(pB.__assign({},qze.ReasonKind),Sge);function TYe(e){return{kind:hr.ReasonKind.NotImplemented,features:e}}hr.notImplemented=TYe;function bYe(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return e.length===0&&(0,n1.assertFalse)("calc.lang.unavailable: expected nonempty array"),{kind:hr.ReasonKind.Unavailable,objects:e}}hr.unavailable=bYe;function PYe(e){return{kind:hr.ReasonKind.Internal,message:e}}hr.internal=PYe;function EYe(e){var r=function(a){this.reason=a,this.name=e,this.stack=e,this.message=a.kind};return r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,r}hr.createFailureErrorClass=EYe;var lB="_xlfn.",cB="_xlws.";function NYe(e,r){var n=r;return n.length>lB.length&&e.stringCompareCI(n.substring(0,lB.length),lB)===0&&(n=n.substring(lB.length),n.length>cB.length&&e.stringCompareCI(n.substring(0,cB.length),cB)===0&&(n=n.substring(cB.length))),e.getWorksheetFuncId(n)}hr.getWorksheetFuncId=NYe;var dB="_xludf.";function AYe(e,r){var n=r;return n.length>dB.length&&e.stringCompareCI(n.substring(0,dB.length),dB)===0&&(n=n.substring(dB.length)),n}hr.getUserDefinedFuncName=AYe;var fB="_xlpm.";function OYe(e,r){var n=r;return n.length>fB.length&&e.stringCompareCI(n.substring(0,fB.length),fB)===0&&(n=n.substring(fB.length)),n}hr.getBoundName=OYe;function kYe(e){var r=e.specialRefs,n=Object.keys(r).reduce(function(a,o){return a+(r[Number(o)]?1:0)},0);return n===1||n===2&&r[Su.SpecialRefId.Data]&&(r[Su.SpecialRefId.Headers]||r[Su.SpecialRefId.Totals])}function FYe(e){return e.kind!==Su.StructRefKind.SpecialRef&&e.kind!==Su.StructRefKind.BadRef||e.isBracketed}function PY(e){return e.kind===Su.StructRefKind.MissingRef||e.kind===Su.StructRefKind.BadRef}function IYe(e){return e.columnRefs.length<=1&&e.refs.every(FYe)&&kYe(e)}hr.isCommaOpRefWellFormed=IYe;function MYe(e){return e.refs.every(wM)}hr.isCommaOpClosed=MYe;function wYe(e){return!e.refs.some(PY)}hr.isCommaOpNoBadOrMissing=wYe;function DYe(e){return wM(e.lhs)&&wM(e.rhs)}hr.isRangeOpClosed=DYe;function xYe(e){return!PY(e.lhs)&&!PY(e.rhs)}hr.isRangeOpNoMissing=xYe;function wM(e){switch(e.kind){case Su.StructRefKind.SpecialRef:return e.isClosed;case Su.StructRefKind.ColumnRef:return e.isClosed;case Su.StructRefKind.RangeOpRef:return wM(e.lhs)&&wM(e.rhs);case Su.StructRefKind.MissingRef:return!0;case Su.StructRefKind.BadRef:return e.isClosed}}var LYe=(Qb={},Qb[Su.SpecialRefId.All]=1,Qb[Su.SpecialRefId.Headers]=2,Qb[Su.SpecialRefId.Data]=3,Qb[Su.SpecialRefId.Totals]=4,Qb[Su.SpecialRefId.ThisRow]=5,Qb),oge=function(r){return r.kind===Su.StructRefKind.MissingRef?7:r.kind!==Su.StructRefKind.SpecialRef?6:LYe[r.id]};function BYe(e,r){return oge(e)-oge(r)}function qYe(e){for(var r={},n=[],a=0,o=e.refs;a<o.length;a++){var u=o[a];u.kind!==Su.StructRefKind.SpecialRef?n.push(u):r[u.id]===void 0&&(r[u.id]=!0,n.push(u))}return n.sort(BYe),n}hr.normalizeCommaOpRef=qYe;function UYe(e,r){switch(e){case VA.OperatorId.Eq:return r===0;case VA.OperatorId.Ne:return r!==0;case VA.OperatorId.Lt:return r<0;case VA.OperatorId.Gt:return r>0;case VA.OperatorId.Le:return r<=0;case VA.OperatorId.Ge:return r>=0}}hr.applyComparison=UYe});var zb=Y(Xl=>{"use strict";_();Object.defineProperty(Xl,"__esModule",{value:!0});Xl.values=Xl.stringStartsWith=Xl.stringEndsWith=Xl.repeat=Xl.prependErrorMessage=Xl.partialArray=Xl.messageFromError=Xl.mathLog2=Xl.isInteger=Xl.arrayFill=void 0;var a1=Cn();Xl.arrayFill=a1.util.arrayFill;Xl.isInteger=a1.util.isInteger;Xl.mathLog2=a1.util.mathLog2;Xl.messageFromError=a1.util.messageFromError;Xl.partialArray=a1.util.partialArray;Xl.prependErrorMessage=a1.util.prependErrorMessage;Xl.repeat=a1.util.repeat;Xl.stringEndsWith=a1.util.stringEndsWith;Xl.stringStartsWith=a1.util.stringStartsWith;Xl.values=a1.util.values});var Yb=Y(yu=>{"use strict";_();Object.defineProperty(yu,"__esModule",{value:!0});yu.surrogatePairToCodePoint=yu.stringFromCodePoint=yu.stringCodePointAt=yu.scanCodePointsBack=yu.scanCodePoints=yu.numCodeUnits=yu.makeGetCharCodeBits=yu.isLowSurrogate=yu.isHighSurrogate=yu.isAnySurrogate=yu.forEachClassInterval=yu.countCodePoints=yu.codePointIterator=yu.CharCodeBits=void 0;var nm=Cn();yu.CharCodeBits=nm.unicode.CharCodeBits;yu.codePointIterator=nm.unicode.codePointIterator;yu.countCodePoints=nm.unicode.countCodePoints;yu.forEachClassInterval=nm.unicode.forEachClassInterval;yu.isAnySurrogate=nm.unicode.isAnySurrogate;yu.isHighSurrogate=nm.unicode.isHighSurrogate;yu.isLowSurrogate=nm.unicode.isLowSurrogate;yu.makeGetCharCodeBits=nm.unicode.makeGetCharCodeBits;yu.numCodeUnits=nm.unicode.numCodeUnits;yu.scanCodePoints=nm.unicode.scanCodePoints;yu.scanCodePointsBack=nm.unicode.scanCodePointsBack;yu.stringCodePointAt=nm.unicode.stringCodePointAt;yu.stringFromCodePoint=nm.unicode.stringFromCodePoint;yu.surrogatePairToCodePoint=nm.unicode.surrogatePairToCodePoint});var mB=Y(Zf=>{"use strict";_();Object.defineProperty(Zf,"__esModule",{value:!0});Zf.KnownFormat=Zf.Calendar=Zf.NumberShape=Zf.DateOrder=Zf.CurrencyFormat=void 0;var GYe;(function(e){e.Paren="Paren",e.Lead="Lead",e.Intern="Intern",e.Trail="Trail"})(GYe=Zf.CurrencyFormat||(Zf.CurrencyFormat={}));var KYe;(function(e){e.MDY="MDY",e.DMY="DMY",e.YMD="YMD",e.MYD="MYD",e.DYM="DYM",e.YDM="YDM"})(KYe=Zf.DateOrder||(Zf.DateOrder={}));var VYe;(function(e){e.ASCII="ASCII",e.ArabicIndic="ArabicIndic",e.ExtendedArabicIndic="ExtendedArabicIndic",e.Devanagari="Devanagari",e.Bengali="Bengali",e.Gurmukhi="Gurmukhi",e.Gujarati="Gujarati",e.Oriya="Oriya",e.Tamil="Tamil",e.Telugu="Telugu",e.Kannada="Kannada",e.Malayalam="Malayalam",e.Thai="Thai",e.Lao="Lao",e.Tibetan="Tibetan",e.Myanmar="Myanmar",e.Ethiopic="Ethiopic",e.Khmer="Khmer",e.Mongolian="Mongolian",e.ChineseTrad1="ChineseTrad1",e.ChineseTrad2="ChineseTrad2",e.ChineseTrad3="ChineseTrad3",e.ChineseSimp1="ChineseSimp1",e.ChineseSimp2="ChineseSimp2",e.ChineseSimp3="ChineseSimp3",e.Japanese1="Japanese1",e.Japanese2="Japanese2",e.Japanese3="Japanese3",e.Korean1="Korean1",e.Korean2="Korean2",e.Korean3="Korean3",e.Korean4="Korean4"})(VYe=Zf.NumberShape||(Zf.NumberShape={}));var WYe;(function(e){e.Gregorian="Gregorian",e.GregorianUS="GregorianUS",e.Japan="Japan",e.Taiwan="Taiwan",e.Korea="Korea",e.Hijri="Hijri",e.Thai="Thai",e.Hebrew="Hebrew",e.GregorianMEFrench="GregorianMEFrench",e.GregorianArabic="GregorianArabic",e.GregorianXlitEnglish="GregorianXlitEnglish",e.GregorianXlitFrench="GregorianXlitFrench",e.Persian="Persian",e.UmAlQura="UmAlQura"})(WYe=Zf.Calendar||(Zf.Calendar={}));var jYe;(function(e){e[e.General=0]="General",e[e.NoComFixed0=-1]="NoComFixed0",e[e.NoComFixed=-2]="NoComFixed",e[e.Fixed0=-3]="Fixed0",e[e.Fixed=-4]="Fixed",e[e.Currency=-9]="Currency",e[e.CoCurrency=-10]="CoCurrency",e[e.CurrencyDec=-11]="CurrencyDec",e[e.CoCurrencyDec=-12]="CoCurrencyDec",e[e.Pct0=-13]="Pct0",e[e.Pct=-14]="Pct",e[e.Exp=-15]="Exp",e[e.Fract=-17]="Fract",e[e.FractBond=-18]="FractBond",e[e.MMDDYY=-19]="MMDDYY",e[e.DDMMMYY=-20]="DDMMMYY",e[e.DDMMM=-21]="DDMMM",e[e.MMMYY=-22]="MMMYY",e[e.HHMMAP=-23]="HHMMAP",e[e.HHMMSSAP=-24]="HHMMSSAP",e[e.HHMM=-25]="HHMM",e[e.HHMMSS=-26]="HHMMSS",e[e.MDYHMS=-27]="MDYHMS",e[e.USCoCurrency=-37]="USCoCurrency",e[e.USCoCurrencyDec=-39]="USCoCurrencyDec",e[e.Currency2=-5]="Currency2",e[e.CoCurrency2=-6]="CoCurrency2",e[e.CurrencyDec2=-7]="CurrencyDec2",e[e.CoCurrencyDec2=-8]="CoCurrencyDec2",e[e.Acct=-33]="Acct",e[e.AcctCur=-32]="AcctCur",e[e.AcctDec=-35]="AcctDec",e[e.AcctDecCur=-34]="AcctDecCur",e[e.MMSS=-28]="MMSS",e[e.AbsHMMSS=-31]="AbsHMMSS",e[e.SS0=-29]="SS0",e[e.Eng=-16]="Eng",e[e.Text=-30]="Text"})(jYe=Zf.KnownFormat||(Zf.KnownFormat={}))});var DM=Y(We=>{"use strict";_();Object.defineProperty(We,"__esModule",{value:!0});We.codePointExclamationMark=We.codePointEuroSign=We.codePointEqualsSign=We.codePointDoubleQuote=We.codePointDollarSign=We.codePointDigitZero=We.codePointDigitTwo=We.codePointDigitThree=We.codePointDigitSix=We.codePointDigitSeven=We.codePointDigitOne=We.codePointDigitNine=We.codePointDigitFour=We.codePointDigitFive=We.codePointDigitEight=We.codePointComma=We.codePointColon=We.codePointCircumflexAccent=We.codePointCapitalZ=We.codePointCapitalY=We.codePointCapitalX=We.codePointCapitalW=We.codePointCapitalV=We.codePointCapitalU=We.codePointCapitalT=We.codePointCapitalS=We.codePointCapitalR=We.codePointCapitalQ=We.codePointCapitalP=We.codePointCapitalO=We.codePointCapitalN=We.codePointCapitalM=We.codePointCapitalL=We.codePointCapitalK=We.codePointCapitalJ=We.codePointCapitalI=We.codePointCapitalH=We.codePointCapitalG=We.codePointCapitalF=We.codePointCapitalE=We.codePointCapitalD=We.codePointCapitalC=We.codePointCapitalB=We.codePointCapitalA=We.codePointCR=We.codePointBacktick=We.codePointBackslash=We.codePointAtSign=We.codePointAsterisk=We.codePointAmpersand=void 0;We.codePointSmallW=We.codePointSmallV=We.codePointSmallU=We.codePointSmallT=We.codePointSmallS=We.codePointSmallR=We.codePointSmallQ=We.codePointSmallP=We.codePointSmallO=We.codePointSmallN=We.codePointSmallM=We.codePointSmallL=We.codePointSmallK=We.codePointSmallJ=We.codePointSmallI=We.codePointSmallH=We.codePointSmallG=We.codePointSmallF=We.codePointSmallE=We.codePointSmallD=We.codePointSmallC=We.codePointSmallB=We.codePointSmallA=We.codePointSlash=We.codePointSingleQuote=We.codePointSemicolon=We.codePointRightSquareBracket=We.codePointRightParen=We.codePointRightCurlyBracket=We.codePointQuestionMark=We.codePointPlusSign=We.codePointPipe=We.codePointPercentSign=We.codePointMinusSign=We.codePointLessThanSign=We.codePointLeftSquareBracket=We.codePointLeftParen=We.codePointLeftCurlyBracket=We.codePointLF=We.codePointInvertedQuestionMark=We.codePointInvertedExclamationMark=We.codePointHash=We.codePointGreaterThanSign=We.codePointFullwidthLatinSmallZ=We.codePointFullwidthLatinSmallA=We.codePointFullwidthLatinCapitalZ=We.codePointFullwidthLatinCapitalA=We.codePointFullwidthDigitZero=We.codePointFullwidthDigitNine=We.codePointFullStop=void 0;We.codePointUnderscore=We.codePointTilde=We.codePointThaiDigitZero=We.codePointThaiDigitNine=We.codePointTab=We.codePointSpace=We.codePointSmallZ=We.codePointSmallY=We.codePointSmallX=void 0;var Zr=Cn();We.codePointAmpersand=Zr.codePoint.codePointAmpersand;We.codePointAsterisk=Zr.codePoint.codePointAsterisk;We.codePointAtSign=Zr.codePoint.codePointAtSign;We.codePointBackslash=Zr.codePoint.codePointBackslash;We.codePointBacktick=Zr.codePoint.codePointBacktick;We.codePointCR=Zr.codePoint.codePointCR;We.codePointCapitalA=Zr.codePoint.codePointCapitalA;We.codePointCapitalB=Zr.codePoint.codePointCapitalB;We.codePointCapitalC=Zr.codePoint.codePointCapitalC;We.codePointCapitalD=Zr.codePoint.codePointCapitalD;We.codePointCapitalE=Zr.codePoint.codePointCapitalE;We.codePointCapitalF=Zr.codePoint.codePointCapitalF;We.codePointCapitalG=Zr.codePoint.codePointCapitalG;We.codePointCapitalH=Zr.codePoint.codePointCapitalH;We.codePointCapitalI=Zr.codePoint.codePointCapitalI;We.codePointCapitalJ=Zr.codePoint.codePointCapitalJ;We.codePointCapitalK=Zr.codePoint.codePointCapitalK;We.codePointCapitalL=Zr.codePoint.codePointCapitalL;We.codePointCapitalM=Zr.codePoint.codePointCapitalM;We.codePointCapitalN=Zr.codePoint.codePointCapitalN;We.codePointCapitalO=Zr.codePoint.codePointCapitalO;We.codePointCapitalP=Zr.codePoint.codePointCapitalP;We.codePointCapitalQ=Zr.codePoint.codePointCapitalQ;We.codePointCapitalR=Zr.codePoint.codePointCapitalR;We.codePointCapitalS=Zr.codePoint.codePointCapitalS;We.codePointCapitalT=Zr.codePoint.codePointCapitalT;We.codePointCapitalU=Zr.codePoint.codePointCapitalU;We.codePointCapitalV=Zr.codePoint.codePointCapitalV;We.codePointCapitalW=Zr.codePoint.codePointCapitalW;We.codePointCapitalX=Zr.codePoint.codePointCapitalX;We.codePointCapitalY=Zr.codePoint.codePointCapitalY;We.codePointCapitalZ=Zr.codePoint.codePointCapitalZ;We.codePointCircumflexAccent=Zr.codePoint.codePointCircumflexAccent;We.codePointColon=Zr.codePoint.codePointColon;We.codePointComma=Zr.codePoint.codePointComma;We.codePointDigitEight=Zr.codePoint.codePointDigitEight;We.codePointDigitFive=Zr.codePoint.codePointDigitFive;We.codePointDigitFour=Zr.codePoint.codePointDigitFour;We.codePointDigitNine=Zr.codePoint.codePointDigitNine;We.codePointDigitOne=Zr.codePoint.codePointDigitOne;We.codePointDigitSeven=Zr.codePoint.codePointDigitSeven;We.codePointDigitSix=Zr.codePoint.codePointDigitSix;We.codePointDigitThree=Zr.codePoint.codePointDigitThree;We.codePointDigitTwo=Zr.codePoint.codePointDigitTwo;We.codePointDigitZero=Zr.codePoint.codePointDigitZero;We.codePointDollarSign=Zr.codePoint.codePointDollarSign;We.codePointDoubleQuote=Zr.codePoint.codePointDoubleQuote;We.codePointEqualsSign=Zr.codePoint.codePointEqualsSign;We.codePointEuroSign=Zr.codePoint.codePointEuroSign;We.codePointExclamationMark=Zr.codePoint.codePointExclamationMark;We.codePointFullStop=Zr.codePoint.codePointFullStop;We.codePointFullwidthDigitNine=Zr.codePoint.codePointFullwidthDigitNine;We.codePointFullwidthDigitZero=Zr.codePoint.codePointFullwidthDigitZero;We.codePointFullwidthLatinCapitalA=Zr.codePoint.codePointFullwidthLatinCapitalA;We.codePointFullwidthLatinCapitalZ=Zr.codePoint.codePointFullwidthLatinCapitalZ;We.codePointFullwidthLatinSmallA=Zr.codePoint.codePointFullwidthLatinSmallA;We.codePointFullwidthLatinSmallZ=Zr.codePoint.codePointFullwidthLatinSmallZ;We.codePointGreaterThanSign=Zr.codePoint.codePointGreaterThanSign;We.codePointHash=Zr.codePoint.codePointHash;We.codePointInvertedExclamationMark=Zr.codePoint.codePointInvertedExclamationMark;We.codePointInvertedQuestionMark=Zr.codePoint.codePointInvertedQuestionMark;We.codePointLF=Zr.codePoint.codePointLF;We.codePointLeftCurlyBracket=Zr.codePoint.codePointLeftCurlyBracket;We.codePointLeftParen=Zr.codePoint.codePointLeftParen;We.codePointLeftSquareBracket=Zr.codePoint.codePointLeftSquareBracket;We.codePointLessThanSign=Zr.codePoint.codePointLessThanSign;We.codePointMinusSign=Zr.codePoint.codePointMinusSign;We.codePointPercentSign=Zr.codePoint.codePointPercentSign;We.codePointPipe=Zr.codePoint.codePointPipe;We.codePointPlusSign=Zr.codePoint.codePointPlusSign;We.codePointQuestionMark=Zr.codePoint.codePointQuestionMark;We.codePointRightCurlyBracket=Zr.codePoint.codePointRightCurlyBracket;We.codePointRightParen=Zr.codePoint.codePointRightParen;We.codePointRightSquareBracket=Zr.codePoint.codePointRightSquareBracket;We.codePointSemicolon=Zr.codePoint.codePointSemicolon;We.codePointSingleQuote=Zr.codePoint.codePointSingleQuote;We.codePointSlash=Zr.codePoint.codePointSlash;We.codePointSmallA=Zr.codePoint.codePointSmallA;We.codePointSmallB=Zr.codePoint.codePointSmallB;We.codePointSmallC=Zr.codePoint.codePointSmallC;We.codePointSmallD=Zr.codePoint.codePointSmallD;We.codePointSmallE=Zr.codePoint.codePointSmallE;We.codePointSmallF=Zr.codePoint.codePointSmallF;We.codePointSmallG=Zr.codePoint.codePointSmallG;We.codePointSmallH=Zr.codePoint.codePointSmallH;We.codePointSmallI=Zr.codePoint.codePointSmallI;We.codePointSmallJ=Zr.codePoint.codePointSmallJ;We.codePointSmallK=Zr.codePoint.codePointSmallK;We.codePointSmallL=Zr.codePoint.codePointSmallL;We.codePointSmallM=Zr.codePoint.codePointSmallM;We.codePointSmallN=Zr.codePoint.codePointSmallN;We.codePointSmallO=Zr.codePoint.codePointSmallO;We.codePointSmallP=Zr.codePoint.codePointSmallP;We.codePointSmallQ=Zr.codePoint.codePointSmallQ;We.codePointSmallR=Zr.codePoint.codePointSmallR;We.codePointSmallS=Zr.codePoint.codePointSmallS;We.codePointSmallT=Zr.codePoint.codePointSmallT;We.codePointSmallU=Zr.codePoint.codePointSmallU;We.codePointSmallV=Zr.codePoint.codePointSmallV;We.codePointSmallW=Zr.codePoint.codePointSmallW;We.codePointSmallX=Zr.codePoint.codePointSmallX;We.codePointSmallY=Zr.codePoint.codePointSmallY;We.codePointSmallZ=Zr.codePoint.codePointSmallZ;We.codePointSpace=Zr.codePoint.codePointSpace;We.codePointTab=Zr.codePoint.codePointTab;We.codePointThaiDigitNine=Zr.codePoint.codePointThaiDigitNine;We.codePointThaiDigitZero=Zr.codePoint.codePointThaiDigitZero;We.codePointTilde=Zr.codePoint.codePointTilde;We.codePointUnderscore=Zr.codePoint.codePointUnderscore});var IY=Y(lv=>{"use strict";_();Object.defineProperty(lv,"__esModule",{value:!0});lv.parseSignedLiteral=lv.parseNumberLiteral=lv.parseUint=lv.isLineBreak=lv.isSpace=void 0;var Cge=Ep(),vB=og(),gB=zb(),$f=Yb(),Hh=mB(),xM=DM(),OY=t1(),HYe=xM.codePointSpace,_ge=xM.codePointLF,kY=xM.codePointMinusSign,Rge=xM.codePointPlusSign,QYe=xM.codePointSlash;function FY(e){return e===HYe||e===_ge}lv.isSpace=FY;function zYe(e){return e===_ge}lv.isLineBreak=zYe;function hB(e,r,n,a){(0,vB.assertIndex)("calc.parse.parseUint",r,16);for(var o=0,u=a,t=n.length;u<t;){var d=(0,$f.stringCodePointAt)(n,u);if(!e.isNumeral(d))break;var s=e.getOrdinal(d);o===0&&s!==0&&(t=(0,Cge.fastMin)(t,u+r)),o=o*10+s,u+=(0,$f.numCodeUnits)(d)}return u===t&&u<n.length&&e.isNumeral((0,$f.stringCodePointAt)(n,u))?[0,a]:[o,u]}lv.parseUint=hB;function YYe(e,r,n){var a=n;if(a<r.length&&e.stringCompareCI("E",r.substring(a,a+1))===0)a+=1;else if((0,gB.stringStartsWith)(r,"**",a))a+=2;else return[0,n];var o=!1;if(a<r.length){var u=(0,$f.stringCodePointAt)(r,a);((o=u===kY)||u===Rge)&&(a+=(0,$f.numCodeUnits)(u))}if(a>=r.length||!e.isNumeral((0,$f.stringCodePointAt)(r,a)))return!1;var t=2147483647,d=hB(e,10,r,a),s=d[0],c=d[1];return c===a||s>t?!1:[o?-s:s,c]}function yge(e,r,n,a){var o=a,u=32767,t=hB(e,5,n,o),d=t[0],s=t[1];if(s===o||d>u||(o=s,!(o<n.length&&n.charCodeAt(o)===QYe)))return!1;o+=1;var c=hB(e,5,n,o),l=c[0],f=c[1];if(f===o||l>u)return!1;if(o=f,l===0)return[!1,0,o];var p=r.div(r.fromNumber(d),r.fromNumber(l));return(0,vB.assertTrue)("calc.lang.tryTokenizeFrac",(0,OY.isNumberOper)(p)),[p,l,o]}function JYe(e,r,n){for(var a=n,o="",u=0;u<r.length;){var t=(0,$f.stringCodePointAt)(r,u);if(e.isNumeral(t)){var d=(0,$f.numCodeUnits)(t);o+=r.substring(u,u+d),u+=d,a-=1;continue}if(a===0||!e.isThousandsPosition(a))return;u+=e.thousandsSeparator.length}return o}function Tge(e,r,n,a,o,u,t){var d=a,s=0,c="",l,f=!1,p=!1,m=Hh.NumberShape.ASCII,v,h;if(!(!(0,gB.stringStartsWith)(n,e.decimalSeparator,a)&&!(a<n.length&&e.isNumeral((0,$f.stringCodePointAt)(n,a))))){for(var S=function(){if((u||o&&n.indexOf("%",d)>=0)&&(s-=2,l!==void 0)){var L=r.div(l,r.fromNumber(100));(0,vB.assertTrue)("calc.lang.parseNumberLiteral",(0,OY.isNumberOper)(L)),l=L,h=Hh.KnownFormat.Pct}if((0,Cge.fastAbs)(s)>=309)return{value:void 0,i:d,consumedThousands:f,consumedDecimal:p,numShape:m,format:h};var D=r.parse(e,!0,s,c);if(l!==void 0){var U=r.add(D,l);(0,vB.assertTrue)("calc.lang.parseNumberLiteral",(0,OY.isNumberOper)(U)),D=U}return{value:D,i:d,consumedThousands:f,consumedDecimal:p,numShape:m,format:h}};d<n.length;){var y=(0,$f.stringCodePointAt)(n,d);if(!e.isNumeral(y)||e.getOrdinal(y)!==0)break;(v=e.getNumberShape(y))!==Hh.NumberShape.ASCII&&(m=v),d+=(0,$f.numCodeUnits)(y)}if(t){var C=yge(e,r,n,d);if(C!==!1){var E=C[0],I=C[1],F=C[2];return d=F,E===!1?{value:void 0,i:d,consumedThousands:f,consumedDecimal:p,numShape:m,format:h}:(h=I>=10?Hh.KnownFormat.FractBond:Hh.KnownFormat.Fract,l=E,S())}}for(var w=d;d<n.length;){var y=(0,$f.stringCodePointAt)(n,d);if(e.isNumeral(y)){s+=1,(v=e.getNumberShape(y))!==Hh.NumberShape.ASCII&&(m=v),d+=(0,$f.numCodeUnits)(y);continue}if(o&&s>0&&(0,gB.stringStartsWith)(n,e.thousandsSeparator,d)){f=!0,d+=e.thousandsSeparator.length;continue}break}if(c+=n.substring(w,d),f){var B=JYe(e,c,s);if(B===void 0)return;c=B}if(a<d&&d<n.length&&FY(n.charCodeAt(d))){var C=yge(e,r,n,d+1);if(C!==!1){var E=C[0],I=C[1],F=C[2];return d=F,E===!1?{value:void 0,i:d,consumedThousands:f,consumedDecimal:p,numShape:m,format:h}:(h=I>=10?Hh.KnownFormat.FractBond:Hh.KnownFormat.Fract,l=E,S())}}var k=!1;if((0,gB.stringStartsWith)(n,e.decimalSeparator,d)&&(k=d===a,p=!0,d+=e.decimalSeparator.length),s===0)for(;d<n.length;){var y=(0,$f.stringCodePointAt)(n,d);if(!e.isNumeral(y)||e.getOrdinal(y)!==0)break;s-=1,(v=e.getNumberShape(y))!==Hh.NumberShape.ASCII&&(m=v),d+=(0,$f.numCodeUnits)(y)}for(w=d;d<n.length;){var y=(0,$f.stringCodePointAt)(n,d);if(!e.isNumeral(y))break;(v=e.getNumberShape(y))!==Hh.NumberShape.ASCII&&(m=v),d+=(0,$f.numCodeUnits)(y)}if(c+=n.substring(w,d),!(k&&d<=a+e.decimalSeparator.length)){var x=YYe(e,n,d);if(x!==!1){var G=x[0],F=x[1];s+=G,F!==d&&(h=Hh.KnownFormat.Exp),d=F}return x===!1?{value:void 0,i:d,consumedThousands:f,consumedDecimal:p,numShape:m,format:h}:S()}}}lv.parseNumberLiteral=Tge;function XYe(e,r,n,a,o){var u=a,t=!1;if(u<n.length){var d=n.charCodeAt(u);if((d===Rge||d===kY)&&(t=d===kY,u+=1,o))for(;u<n.length&&FY(n.charCodeAt(u));)u+=1}var s=Tge(e,r,n,u,!1,!1,!1);return(s==null?void 0:s.value)===void 0?[r.zero,a]:(u=s.i,[t?r.neg(s.value):s.value,u])}lv.parseSignedLiteral=XYe});var RB=Y(ep=>{"use strict";_();Object.defineProperty(ep,"__esModule",{value:!0});ep.wrapPosition=ep.parseQualifier=ep.parseGridRangeA1=ep.parseGridCellA1=ep.parseCellRef=ep.isR1C1IdentStart=ep.SpecialPos=void 0;var BM=sv(),LM=Ep(),kd=R0(),MY=IY(),Zb=DM(),Jb=zb(),xY=Yb(),CB=BM.sheetRows,LY=CB.toString(10).length,qM=BM.sheetCols,ZYe=qM.toString(26).length,Ege=qM.toString(10).length,Nge=Zb.codePointCapitalA,$Ye=Zb.codePointCapitalZ,wY=Zb.codePointSmallA,eJe=Zb.codePointSmallZ,rJe=Zb.codePointPlusSign,nJe=Zb.codePointMinusSign,DY=Zb.codePointColon;function bge(e){return e>=wY&&e<=eJe||e>=Nge&&e<=$Ye}function tJe(e){return(e>=wY?e-wY:e-Nge)+1}function aJe(e,r,n){for(var a=0,o=n,u=(0,LM.fastMin)(r.length,n+e);o<u;o+=1){var t=r.charCodeAt(o);if(!bge(t))break;a=a*26+tJe(t)}return o===u&&o<r.length&&bge(r.charCodeAt(o))?[0,n]:[a,o]}function iJe(e,r){return(0,Jb.stringStartsWith)(e,"$",r)?[kd.PosKind.Abs,r+1]:[kd.PosKind.Rel,r]}function Age(e,r,n,a){return function(o,u,t,d,s){var c=iJe(t,d),l=c[0],f=c[1],p=e(o,n,t,f),m=p[0],v=p[1];if(v>f){if(m<1||m>r)return l===kd.PosKind.Abs||(a===!0?typeof s=="object"&&s.kind===kd.PosKind.Abs||s===Xb.A1BadDollar:(0,Jb.stringStartsWith)(t,"$",v))?[Xb.A1BadDollar,!0,v]:void 0;var h=l===kd.PosKind.Rel?m-u:m;return[(0,kd.pos)(l,h-1),l===kd.PosKind.Abs,v]}return l===kd.PosKind.Abs&&(a===!0||v===t.length||!o.isNumeral((0,xY.stringCodePointAt)(t,v)))?[Xb.A1BadDollar,!0,v]:[void 0,!1,d]}}function Pge(e,r,n){var a=kge(e,r,n);return a-e}function _B(e,r,n,a){return function(o,u,t,d){var s=r?e?"R":o.rowLetter:e?"C":o.columnLetter;if(d>=t.length||o.stringCompareCI(s,t[d])!==0)return[void 0,!1,d];var c=d+s.length,l=(0,MY.parseUint)(o,a,t,c),f=l[0],p=l[1];if(p>c&&f>=1&&f<=n)return[(0,kd.pos)(kd.PosKind.Abs,f-1),!1,p];if((0,Jb.stringStartsWith)(t,o.rcLeftBracket,c)){if(c+=o.rcLeftBracket.length,(0,Jb.stringStartsWith)(t,o.rcRightBracket,c))return[(0,kd.pos)(kd.PosKind.Rel,Pge(u,0,n)),!0,c+o.rcRightBracket.length];var m=1,v=t.charCodeAt(c);v===rJe?c+=1:v===nJe&&(m=-1,c+=1);var h=(0,MY.parseUint)(o,a,t,c),S=h[0],y=h[1];if(y>c&&S<n&&(0,Jb.stringStartsWith)(t,o.rcRightBracket,y))return[(0,kd.pos)(kd.PosKind.Rel,Pge(u,S*m,n)),!0,y+o.rcRightBracket.length]}return[Xb.RCNoNum,!1,d+s.length]}}function WA(e,r,n,a,o,u,t){var d=a(e,r,u,t,void 0);if(d==null)return[void 0,void 0,t];var s=d[0],c=d[1],l=d[2];if(l>t){var f=o(e,n,u,l,s);if(f==null)return c?[s,void 0,l]:[void 0,void 0,t];var p=f[0],m=f[2];return m>l?[s,p,m]:[s,void 0,l]}var v=o(e,n,u,t,s);if(v==null)return[void 0,void 0,t];var h=v[0],S=v[2];return S>t?[void 0,h,S]:[void 0,void 0,t]}var SB=Age(MY.parseUint,CB,LY,!0),yB=Age(function(e,r,n,a){return aJe(r,n,a)},qM,ZYe,!1),oJe=_B(!1,!0,CB,LY),uJe=_B(!1,!1,qM,Ege),sJe=_B(!0,!0,CB,LY),lJe=_B(!0,!1,qM,Ege),Xb;(function(e){e[e.RCNoNum=0]="RCNoNum",e[e.A1BadDollar=1]="A1BadDollar"})(Xb=ep.SpecialPos||(ep.SpecialPos={}));function Oge(e,r){return typeof e!="object"&&typeof r!="object"}ep.isR1C1IdentStart=Oge;function cJe(e,r,n,a,o){var u=n.col,t=n.row,d=WA(e,u,t,yB,SB,a,o),s=d[0],c=d[1],l=d[2],f=typeof c=="object"&&c.kind===kd.PosKind.Abs||c===Xb.A1BadDollar||typeof s=="object"&&s.kind===kd.PosKind.Abs||s===Xb.A1BadDollar;if(c!=null&&s!=null||f||(c!=null||s!=null)&&(o-1>=0&&a.charCodeAt(o-1)===DY||l<a.length&&a.charCodeAt(l)===DY))return l<a.length&&e.isIdentContinue((0,xY.stringCodePointAt)(a,l))||r!==kd.RefStyle.A1&&!f?void 0:{refStyle:kd.RefStyle.A1,row:c,col:s,i:l}}function dJe(e,r,n,a,o){var u,t=n.col,d=n.row,s=!1,c=WA(e,d,t,oJe,uJe,a,o),l=c[0],f=c[1],p=c[2];if(l==null&&f==null&&(e.rowLetter!=="R"||e.columnLetter!=="C")&&(s=!0,u=WA(e,d,t,sJe,lJe,a,o),l=u[0],f=u[1],p=u[2]),(l!=null||f!=null)&&(p>=a.length||!Oge(l,f)||!e.isIdentContinue((0,xY.stringCodePointAt)(a,p))))return{refStyle:kd.RefStyle.R1C1,row:l,col:f,i:p,enLocale:s}}function fJe(e,r,n,a,o){var u=cJe(e,r,n,a,o);return u!==void 0?u:dJe(e,r,n,a,o)}ep.parseCellRef=fJe;function pJe(e,r){var n=WA(e,0,0,yB,SB,r,0),a=n[0],o=n[1],u=n[2];return typeof a=="object"&&typeof o=="object"&&u===r.length?(0,BM.gridCell)(o.index,a.index):void 0}ep.parseGridCellA1=pJe;function mJe(e,r){var n=WA(e,0,0,yB,SB,r,0),a=n[0],o=n[1],u=n[2];if(!(typeof a!="object"||typeof o!="object")){if(u===r.length)return(0,BM.gridCell)(o.index,a.index);if(r.charCodeAt(u)===DY){var t=WA(e,0,0,yB,SB,r,u+1),d=t[0],s=t[1],c=t[2];if(!(typeof d!="object"||typeof s!="object")&&c===r.length){var l=(0,LM.fastMin)(o.index,s.index),f=(0,LM.fastMin)(a.index,d.index);return(0,BM.gridRange)(l,f,(0,LM.fastMax)(o.index,s.index)+1-l,(0,LM.fastMax)(a.index,d.index)+1-f)}}}}ep.parseGridRangeA1=mJe;function gJe(e){var r=e.lastIndexOf("!");if(!(r<0||r===0||r===e.length-1)){var n=e.substring(0,r),a=e.substring(r+1);if(n.indexOf("'")<0)return{qualifier:n,unqualified:a};if(!(!(0,Jb.stringStartsWith)(n,"'")||!(0,Jb.stringEndsWith)(n,"'"))){for(var o=[],u=1;u<n.length-1;++u){var t=n.charAt(u);if(t!=="'"){o.push(t);continue}if(u+1>=n.length-1||n.charAt(u+1)!=="'")return;o.push(t),++u}return{qualifier:o.join(""),unqualified:a}}}}ep.parseQualifier=gJe;function kge(e,r,n){return e+r&n-1}ep.wrapPosition=kge});var GM=Y(ka=>{"use strict";_();Object.defineProperty(ka,"__esModule",{value:!0});ka.formatName=ka.formatGridRange=ka.quoteQualifier=ka.formatQualifier=ka.shouldQuoteQualifier=ka.canonicaliseRangePos=ka.formatRangePos=ka.canonicaliseCellPos=ka.formatCellPos=ka.canonicaliseColRange=ka.canonicaliseRowRange=ka.formatColRange=ka.formatRowRange=ka.canonicaliseCol=ka.canonicaliseRow=ka.formatCol=ka.formatRow=ka.resolvePosition=ka.canonicaliseBrackets=ka.columnName=void 0;var Zl=sv(),Ko=R0(),BY=RB(),vJe=og(),Ige=DM(),$b=Yb(),Fge=zb(),Mge=(0,Ko.pos)(Ko.PosKind.Abs,0),wge=(0,Ko.pos)(Ko.PosKind.Abs,Zl.sheetRows-1),hJe=Ige.codePointCapitalA,SJe=Ige.codePointFullStop;function Dge(e){for(var r=e+1,n="";r>0;){var a=(r-1)%26;n=String.fromCharCode(hJe+a)+n,r=Math.floor((r-a)/26)}return n}ka.columnName=Dge;function yJe(e,r){return e===Ko.RefStyle.R1C1&&r.kind===Ko.PosKind.Rel&&r.index!==0}ka.canonicaliseBrackets=yJe;function eP(e,r,n,a){if(r.kind===Ko.PosKind.Abs)return r.index;if(a)return(0,BY.wrapPosition)(e,r.index,n);var o=e+r.index;return 0<=o&&o<n?o:void 0}ka.resolvePosition=eP;function CJe(e,r,n){var a=eP(e,r,Zl.sheetCols,n);if(a!==void 0){var o=Dge(a);return r.kind===Ko.PosKind.Abs?"$"+o:o}}function _Je(e,r,n){var a=eP(e,r,Zl.sheetRows,n);if(a!==void 0){var o=(a+1).toFixed();return r.kind===Ko.PosKind.Abs?"$"+o:o}}function xge(e,r,n,a,o,u){var t=eP(n,a,o,u);if(t!==void 0){if(a.kind===Ko.PosKind.Abs)return r+(t+1).toFixed();var d=t-n;return d===0?r:r+e.rcLeftBracket+d.toFixed()+e.rcRightBracket}}function UY(e,r,n,a,o){return r===Ko.RefStyle.A1?_Je(n,a,o):xge(e,e.rowLetter,n,a,Zl.sheetRows,o)}ka.formatRow=UY;function GY(e,r,n,a,o){return r===Ko.RefStyle.A1?CJe(n,a,o):xge(e,e.columnLetter,n,a,Zl.sheetCols,o)}ka.formatCol=GY;function TB(e,r,n,a){if(n.kind===Ko.PosKind.Abs)return n;var o=eP(r,n,e,a);if(o!==void 0){var u=o-r;return u===n.index?n:(0,Ko.pos)(Ko.PosKind.Rel,u)}}ka.canonicaliseRow=TB.bind(void 0,Zl.sheetRows);ka.canonicaliseCol=TB.bind(void 0,Zl.sheetCols);function jA(e,r,n,a,o){var u=eP(e,r,a,o),t=eP(e,n,a,o);if(!(u===void 0||t===void 0))return u<=t?[r,n,u,t]:[n,r,t,u]}function Lge(e,r,n,a,o,u,t,d,s){var c=jA(u,t,d,n,s);if(c!==void 0){var l=c[0],f=c[1],p=c[2],m=c[3];if(r!==void 0&&p===0&&m===n-1&&t.kind===d.kind)return r(a,o,s);var v=e(a,o,u,l,s);if(v!==void 0){if(o===Ko.RefStyle.R1C1&&l.kind===f.kind&&l.index===f.index)return v;var h=e(a,o,u,f,s);if(h!==void 0)return v+":"+h}}}ka.formatRowRange=Lge.bind(void 0,UY,void 0,Zl.sheetRows);ka.formatColRange=Lge.bind(void 0,GY,function(e,r,n){return(0,ka.formatRowRange)(e,r,0,Mge,wge,n)},Zl.sheetCols);function Bge(e,r,n,a,o,u){var t=jA(n,a,o,r,u);if(t!==void 0){var d=t[0],s=t[1],c=t[2],l=t[3];if(e!==void 0&&c===0&&l===r-1&&a.kind===o.kind)return e;var f=TB(r,n,d,u),p=TB(r,n,s,u);if(!(f===void 0||p===void 0))return[!1,f,p]}}ka.canonicaliseRowRange=Bge.bind(void 0,void 0,Zl.sheetRows);ka.canonicaliseColRange=Bge.bind(void 0,[!0,Mge,wge],Zl.sheetCols);function bB(e,r,n,a,o,u){var t=UY(e,r,n.row,a,u),d=GY(e,r,n.col,o,u);if(!(t===void 0||d===void 0))return r===Ko.RefStyle.A1?d+t:t+d}ka.formatCellPos=bB;function RJe(e,r,n,a){var o=(0,ka.canonicaliseRow)(e.row,r,a),u=(0,ka.canonicaliseCol)(e.col,n,a);if(!(o===void 0||u===void 0))return{row:o,col:u}}ka.canonicaliseCellPos=RJe;function qge(e,r,n,a,o,u,t,d){var s=jA(n.row,a,u,Zl.sheetRows,d),c=jA(n.col,o,t,Zl.sheetCols,d);if(!(s===void 0||c===void 0)){var l=s[0],f=s[1],p=s[2],m=s[3],v=c[0],h=c[1],S=c[2],y=c[3];if(S===0&&y===Zl.sheetCols-1&&o.kind===t.kind)return(0,ka.formatRowRange)(e,r,n.row,l,f,d);if(p===0&&m===Zl.sheetRows-1&&a.kind===u.kind)return(0,ka.formatColRange)(e,r,n.col,v,h,d);var C=bB(e,r,n,l,v,d),E=bB(e,r,n,f,h,d);if(!(C===void 0||E===void 0))return C+":"+E}}ka.formatRangePos=qge;function TJe(e,r,n,a,o,u){var t=jA(e.row,r,a,Zl.sheetRows,u),d=jA(e.col,n,o,Zl.sheetCols,u);if(!(t===void 0||d===void 0)){var s=t[0],c=t[1],l=t[2],f=t[3],p=d[0],m=d[1],v=d[2],h=d[3],S=(0,ka.canonicaliseRow)(e.row,s,u),y=(0,ka.canonicaliseCol)(e.col,p,u),C=(0,ka.canonicaliseRow)(e.row,c,u),E=(0,ka.canonicaliseCol)(e.col,m,u);if(!(S===void 0||y===void 0||C===void 0||E===void 0))return v===0&&h===Zl.sheetCols-1&&n.kind===o.kind?{row1:S,row2:C,col1:void 0,col2:void 0}:l===0&&f===Zl.sheetRows-1&&r.kind===a.kind?{col1:y,col2:E,row1:void 0,row2:void 0}:{row1:S,col1:y,row2:C,col2:E}}}ka.canonicaliseRangePos=TJe;function qY(e,r){return r===SJe||e.isIdentContinue(r)}var bJe=/'/g;function UM(e,r){if(r.length===0)return!1;var n=0,a=(0,$b.stringCodePointAt)(r,n);if(!e.isIdentStart(a))return!1;n+=(0,$b.numCodeUnits)(a);for(var o=0,u=(0,$b.codePointIterator)(r,n);o<u.length;o++){var t=u[o];if(!qY(e,t))return!1}return!0}function PJe(e,r){var n=0;if(!(0,Fge.stringStartsWith)(r,e.leftBracket,n)||(n+=e.leftBracket.length,n===r.length))return!1;var a=(0,$b.stringCodePointAt)(r,n);if(!qY(e,a))return!1;for(n+=(0,$b.numCodeUnits)(a);;){if((0,Fge.stringStartsWith)(r,e.rightBracket,n)){n+=e.rightBracket.length;break}if(n===r.length)return!1;var o=(0,$b.stringCodePointAt)(r,n);if(!qY(e,o))return!1;n+=(0,$b.numCodeUnits)(o)}var u=r.indexOf(":",n);return u<0?UM(e,r.substring(n)):UM(e,r.substring(n,u))&&UM(e,r.substring(u+1))}function EJe(e,r){var n=e.leftBracket.length,a=e.rightBracket.length;return r.length<n+a||r.substring(0,n)!==e.leftBracket||r.substring(r.length-a)!==e.rightBracket?!1:UM(e,r.substring(n,r.length-a))}var NJe=(0,Zl.gridCell)(0,0);function PB(e,r,n){if(e.stringCompareCI(n,e.trueName)===0||e.stringCompareCI(n,e.falseName)===0)return!0;var a=(0,BY.parseCellRef)(e,r,NJe,n,0);if(a!==void 0){if(a.refStyle===Ko.RefStyle.A1){var o=a.i;if(o>=n.length&&e.getWorksheetFuncId(n.substring(0,o))===void 0)return!0}else if(!(0,BY.isR1C1IdentStart)(a.row,a.col))return!0}return!(UM(e,n)||PJe(e,n)||EJe(e,n))}ka.shouldQuoteQualifier=PB;function KY(e,r,n){return PB(e,r,n)?VY(n):n}ka.formatQualifier=KY;function VY(e){return"'".concat(e.replace(bJe,"''"),"'")}ka.quoteQualifier=VY;function AJe(e,r,n,a,o){n===void 0&&(n=Ko.RefStyle.A1);var u=r.cols===1&&r.rows===1?bB(e,n,(0,Zl.gridCell)(0,0),(0,Ko.pos)(Ko.PosKind.Rel,r.row),(0,Ko.pos)(Ko.PosKind.Rel,r.col),!1):qge(e,n,(0,Zl.gridCell)(0,0),(0,Ko.pos)(Ko.PosKind.Rel,r.row),(0,Ko.pos)(Ko.PosKind.Rel,r.col),(0,Ko.pos)(Ko.PosKind.Rel,r.row+r.rows-1),(0,Ko.pos)(Ko.PosKind.Rel,r.col+r.cols-1),!1);if((0,vJe.assertTrue)("calc.lang.formatGridRange",u!==void 0),a===void 0&&o===void 0)return u;if(a===void 0||o===void 0)return KY(e,n,a??o)+"!"+u;var t=a+":"+o;return(PB(e,n,a)||PB(e,n,o)?VY(t):t)+"!"+u}ka.formatGridRange=AJe;function OJe(e,r,n,a){return n===void 0&&(n=Ko.RefStyle.A1),a===void 0?r:KY(e,n,a)+"!"+r}ka.formatName=OJe});var KM=Y(Ti=>{"use strict";_();Object.defineProperty(Ti,"__esModule",{value:!0});Ti.resolvedDottedName=Ti.resolvedNever=Ti.resolvedStructRef=Ti.resolvedLocalName=Ti.resolvedUserDefinedFunc=Ti.resolvedCellRef=Ti.resolvedName=Ti.ResolvedKind=Ti.emptyIntersection=Ti.invalidStructRef=Ti.InvalidStructRefReason=Ti.invalidCellRef=Ti.InvalidCellRefReason=Ti.invalidQualifier=Ti.InvalidQualifierReason=Ti.noOriginSheet=Ti.ResolveReasonKind=Ti.resolveLocalsGrid=void 0;var WY=Wb(),rP=Ep();function kJe(e){return{originGridCell:(0,WY.success)(e.range),originSheet:(0,WY.success)(e.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}}Ti.resolveLocalsGrid=kJe;var HA;(function(e){e.NoOriginSheet="NoOriginSheet",e.InvalidQualifier="InvalidQualifier",e.InvalidCellRef="InvalidCellRef",e.InvalidStructRef="InvalidStructRef",e.EmptyIntersection="EmptyIntersection"})(HA=Ti.ResolveReasonKind||(Ti.ResolveReasonKind={}));function FJe(e){return{kind:HA.NoOriginSheet,origin:e}}Ti.noOriginSheet=FJe;var IJe;(function(e){e.UndefinedDocument="UndefinedDocument",e.UndefinedSheetName="UndefinedSheetName",e.SheetRangeName="SheetRangeName",e.DocumentCellRef="DocumentCellRef",e.BadQualifier="BadQualifier"})(IJe=Ti.InvalidQualifierReason||(Ti.InvalidQualifierReason={}));function MJe(e){return{kind:HA.InvalidQualifier,reason:e}}Ti.invalidQualifier=MJe;var wJe;(function(e){e.BadCellRef="BadCellRef"})(wJe=Ti.InvalidCellRefReason||(Ti.InvalidCellRefReason={}));function DJe(e){return{kind:HA.InvalidCellRef,reason:e}}Ti.invalidCellRef=DJe;var xJe;(function(e){e.UndefinedColumnName="UndefinedColumnName",e.UndefinedTableName="UndefinedTableName",e.InvalidOriginSheet="InvalidOriginSheet",e.InvalidOp="InvalidOp",e.MissingTableName="MissingTableName",e.NamedObjectNotTable="NamedObjectNotTable"})(xJe=Ti.InvalidStructRefReason||(Ti.InvalidStructRefReason={}));function LJe(e){return{kind:HA.InvalidStructRef,reason:e}}Ti.invalidStructRef=LJe;Ti.emptyIntersection={kind:HA.EmptyIntersection};var uR;(function(e){e.ResolvedName="ResolvedName",e.ResolvedCellRef="ResolvedCellRef",e.ResolvedUserDefinedFunc="ResolvedUserDefinedFunc",e.ResolvedLocalName="ResolvedLocalName",e.ResolvedStructRef="ResolvedStructRef",e.ResolvedNever="ResolvedNever",e.ResolvedDottedName="ResolvedDottedName"})(uR=Ti.ResolvedKind||(Ti.ResolvedKind={}));Ti.resolvedName=(0,rP.typedInstanceCreator)()(function(e,r,n){return{kind:uR.ResolvedName,node:e,resolution:r,precedents:n}});Ti.resolvedCellRef=(0,rP.typedInstanceCreator)()(function(e,r){return{kind:uR.ResolvedCellRef,node:e,resolution:r}});Ti.resolvedUserDefinedFunc=(0,rP.typedInstanceCreator)()(function(e,r,n,a){return{kind:uR.ResolvedUserDefinedFunc,node:e,resolution:r,precedents:n,name:a}});Ti.resolvedLocalName=(0,rP.typedInstanceCreator)()(function(e,r){return{kind:uR.ResolvedLocalName,node:e,resolution:r}});Ti.resolvedStructRef=(0,rP.typedInstanceCreator)()(function(e,r,n,a){return{kind:uR.ResolvedStructRef,node:e,table:r,resolution:n,precedents:a}});Ti.resolvedNever=(0,rP.typedInstanceCreator)()(function(e){return{kind:uR.ResolvedNever,node:e,resolution:WY.successUndefined}});Ti.resolvedDottedName=(0,rP.typedInstanceCreator)()(function(e,r,n){return{kind:uR.ResolvedDottedName,resolved:e,fields:r,precedents:n}})});var OB=Y(YA=>{"use strict";_();Object.defineProperty(YA,"__esModule",{value:!0});YA.createResolver=YA.resolveGridRef=void 0;var EB=br(),Uge=Ep(),QA=Ep(),AB=og(),BJe=GM(),qJe=R0(),tn=R0(),UJe=t1(),pC=t1(),jY=sv(),Vo=sv(),gn=Wb(),pt=KM();function NB(e){return(0,gn.isSuccess)(e)&&(0,QA.isNone)(e.value)?gn.successUndefined:e}function tm(e){return!(0,gn.isSuccess)(e)||e.value===void 0}function zA(e,r,n,a,o){return n.kind===qJe.PosKind.Abs?(0,gn.success)(n.index):(0,gn.isSuccess)(e)?(0,gn.success)((0,BJe.resolvePosition)(r(e.value),n,a,o)):e}var QY=function(r){var n=r.row;return n},zY=function(r){var n=r.col;return n};function HY(e,r,n){var a=zA(e,QY,r.row,Vo.sheetRows,n),o=zA(e,zY,r.col,Vo.sheetCols,n);return(0,gn.isSuccess)(a)?(0,gn.isSuccess)(o)?a.value===void 0||o.value===void 0?gn.successUndefined:(0,gn.success)((0,Vo.gridCell)(a.value,o.value)):o:a}function YY(e,r){if(r.kind===tn.CellRefKind.Error)return gn.successUndefined;var n=e.originGridCell,a=e.wrapCellReferences;switch(r.kind){case tn.CellRefKind.Single:return HY(n,r,a);case tn.CellRefKind.Range:{var o=HY(n,r.ref1,a),u=HY(n,r.ref2,a);return(0,gn.isSuccess)(o)?(0,gn.isSuccess)(u)?o.value===void 0||u.value===void 0?gn.successUndefined:(0,gn.success)((0,pC.gridCellRange)(o.value,u.value)):u:o}case tn.CellRefKind.Row:{var t=zA(n,QY,r.row1,Vo.sheetRows,a),d=zA(n,QY,r.row2,Vo.sheetRows,a);return(0,gn.isSuccess)(t)?(0,gn.isSuccess)(d)?t.value===void 0||d.value===void 0?gn.successUndefined:(0,gn.success)((0,pC.gridCellRange)((0,Vo.gridCell)(t.value,0),(0,Vo.gridCell)(d.value,Vo.sheetCols-1))):d:t}case tn.CellRefKind.Col:{var s=zA(n,zY,r.col1,Vo.sheetCols,a),c=zA(n,zY,r.col2,Vo.sheetCols,a);return(0,gn.isSuccess)(s)?(0,gn.isSuccess)(c)?s.value===void 0||c.value===void 0?gn.successUndefined:(0,gn.success)((0,pC.gridCellRange)((0,Vo.gridCell)(0,s.value),(0,Vo.gridCell)(Vo.sheetRows-1,c.value))):c:s}case tn.CellRefKind.Bad:return(0,gn.failure)((0,pt.invalidCellRef)(pt.InvalidCellRefReason.BadCellRef));default:return(0,AB.assertNever)("calc.runtime.resolverService.resolveGridRef",r)}}YA.resolveGridRef=YY;function GJe(e){function r(F,w){if(w===void 0){var B=F.originSheet;return(0,gn.isSuccess)(B)?[w,(0,gn.success)(B.value.document)]:[w,B]}var k=e.getDocumentLoc(w.path,w.document);if(!(0,gn.isSuccess)(k))return[w,k];if((0,QA.isNone)(k.value))return[w,(0,gn.failure)((0,pt.invalidQualifier)(pt.InvalidQualifierReason.UndefinedDocument))];var x=w.path==null?void 0:k.value.path,G=k.value.name;return[(0,tn.documentQualifier)(G,x,w.isQuoted,w.label),(0,gn.success)(k.value)]}function n(F,w){if(tm(w))return[F,w];var B=NB(e.getSheetIndex(w.value,F));if(!(0,gn.isSuccess)(B))return[F,B];if((0,QA.isNone)(B.value))return[F,(0,gn.failure)((0,pt.invalidQualifier)(pt.InvalidQualifierReason.UndefinedSheetName))];var k=e.getSheetName(w.value,B.value);return(0,gn.isSuccess)(k)?[k.value,(0,gn.success)((0,Vo.sheetIndex)(w.value,B.value))]:[F,k]}function a(F,w){var B=r(F,w.document),k=B[0],x=B[1],G=n(w.sheet,x),H=G[0],L=G[1];return[(0,tn.sheetQualifier)(H,k,w.isQuoted,w.label),L]}function o(F,w){var B=r(F,w.document),k=B[0],x=B[1],G=n(w.sheet1,x),H=G[0],L=G[1],D=n(w.sheet2,x),U=D[0],V=D[1],ne=H,J=U,$;if(tm(x))$=x;else if(tm(L))$=L;else if(tm(V))$=V;else{if((0,pC.isSheetIndexEqual)(L.value,V.value))return[(0,tn.sheetQualifier)(ne,k,w.isQuoted,w.label),(0,gn.success)((0,Vo.sheetIndex)(x.value,L.value.index))];var Z=e.getSheetRangeIndexes(L.value),ie=e.getSheetRangeIndexes(V.value);(0,gn.isSuccess)(Z)?(0,gn.isSuccess)(ie)?ie.value.position<Z.value.position&&(ne=U,J=H):$=ie:$=Z,$=(0,gn.success)((0,Vo.sheetRange)(x.value,L.value.index,V.value.index))}return[(0,tn.sheetRangeQualifier)(ne,J,k,w.isQuoted,w.label),$]}function u(F,w){switch(w.kind){case tn.QualifierKind.Error:return[w,gn.successUndefined];case tn.QualifierKind.Sheet:return a(F,w);case tn.QualifierKind.SheetRange:return o(F,w);case tn.QualifierKind.Document:return[w,(0,gn.failure)((0,pt.invalidQualifier)(pt.InvalidQualifierReason.SheetRangeName))];case tn.QualifierKind.Bad:return[w,(0,gn.failure)((0,pt.invalidQualifier)(pt.InvalidQualifierReason.BadQualifier))];default:return(0,AB.assertNever)("calc.runtime.resolverService.resolveCellRefQualifier",w)}}function t(F,w){var B,k=w.qualifier,x=w.ref,G=YY(F,x),H,L;if(k===void 0||k.kind===tn.QualifierKind.Relative){H=k;var D=F.originSheet;if(!(0,gn.isSuccess)(D))L=D;else{var U=D.value;U.index===void 0?L=(0,gn.failure)((0,pt.noOriginSheet)(U)):L=(0,gn.success)(U)}}else B=u(F,k),H=B[0],L=B[1];var V;return tm(G)?V=G:tm(L)?V=L:V=(0,gn.success)((0,Vo.sheetGridCube)(L.value,G.value)),(0,pt.resolvedCellRef)((0,tn.cellRefNode)(x,H,w.label),V)}function d(F,w){switch(w.kind){case tn.QualifierKind.Document:{var B=r(F,w),k=B[0],x=B[1];return[k,tm(x)?x:(0,gn.success)((0,Vo.documentScope)(x.value))]}case tn.QualifierKind.Sheet:return a(F,w);case tn.QualifierKind.SheetRange:return[w,(0,gn.failure)((0,pt.invalidQualifier)(pt.InvalidQualifierReason.SheetRangeName))];case tn.QualifierKind.Ident:{var G=(0,tn.sheetQualifier)(w.name,void 0),H=a(F,G),L=H[0],D=H[1];if(!(0,gn.isSuccess)(D)&&D.reason.kind!==pt.ResolveReasonKind.InvalidQualifier)return[w,D];if((0,gn.isSuccess)(D)&&D.value!==void 0)return[(0,tn.identQualifier)(L.sheet,w.isQuoted,w.label),D];var U=(0,tn.documentQualifier)(w.name),V=r(F,U),k=V[0],x=V[1];return[(0,tn.identQualifier)(k.document,w.isQuoted,w.label),tm(x)?x:(0,gn.success)((0,Vo.documentScope)(x.value))]}case tn.QualifierKind.Bad:return[w,(0,gn.failure)((0,pt.invalidQualifier)(pt.InvalidQualifierReason.BadQualifier))];default:return(0,AB.assertNever)("calc.runtime.resolverService.resolveNameQualifier",w)}}function s(F,w){switch(w.kind){case tn.QualifierKind.Document:return r(F,w);case tn.QualifierKind.Ident:{var B=(0,tn.documentQualifier)(w.name),k=r(F,B),x=k[0],G=k[1];return[(0,tn.identQualifier)(x.document,w.isQuoted,w.label),G]}default:return(0,AB.assertNever)("calc.runtime.resolverService.resolveUserDefinedFuncQualifier",w)}}function c(F,w,B){var k,x=w.qualifier,G=w.parts,H,L,D=[];if(x===void 0||x.kind===tn.QualifierKind.Relative){var U=F.originSheet;if(!(0,gn.isSuccess)(U))return(0,pt.resolvedName)(w,U,D);var V=U.value;if(B!==Vo.NameSource.StructRef){if(V.index===void 0)return(0,pt.resolvedName)(w,(0,gn.failure)((0,pt.noOriginSheet)(V)),D);D.push((0,jY.nameLoc)(V,G.asWhole));var ne=NB(e.getNameLoc(V,G.asWhole,B));if(!(0,gn.isSuccess)(ne))return(0,pt.resolvedName)(w,ne,D);if(ne.value)return(0,pt.resolvedName)((0,tn.nameNode)((0,tn.identNamePart)(ne.value.name,G.canDenoteNamedObject,G.label,G.qualifiedLabel),x,w.label),ne,D)}H=x,L=(0,gn.success)((0,Vo.documentScope)(V.document))}else k=d(F,x),H=k[0],L=k[1];var J=G,$;return tm(L)?$=L:(D.push((0,jY.nameLoc)(L.value,G.asWhole)),$=NB(e.getNameLoc(L.value,G.asWhole,B)),tm($)||(J=(0,tn.identNamePart)($.value.name,G.canDenoteNamedObject,G.label,G.qualifiedLabel))),(0,pt.resolvedName)((0,tn.nameNode)(J,H,w.label),$,D)}function l(F,w,B){B===void 0&&(B=!1);var k=e.getStructRefColumn(F,w.name);if(!(0,gn.isSuccess)(k))return{kind:tn.StructRefKind.ColumnRef,innerRef:w,resolution:k};var x=k.value;if((0,QA.isNone)(x))return{kind:tn.StructRefKind.ColumnRef,innerRef:w,resolution:(0,gn.failure)((0,pt.invalidStructRef)(pt.InvalidStructRefReason.UndefinedColumnName))};var G=x.range.range;return B&&(G=(0,Vo.gridRange)(G.row-(x.hasHeadersRow?1:0),G.col,G.rows+(x.hasHeadersRow?1:0)+(x.hasTotalsRow?1:0),G.cols)),{kind:tn.StructRefKind.ColumnRef,innerRef:(0,tn.columnRef)(x.name,w.isBracketed,w.isClosed,w.label),resolution:(0,gn.success)((0,Vo.sheetGridRange)(x.range.sheet,G))}}function f(F,w,B){if(B===tn.SpecialRefId.ThisRow){if(!(0,gn.isSuccess)(F.originGridCell))return F.originGridCell;var k=f(F,w,tn.SpecialRefId.Data);if(tm(k))return k;var x=k.value.range,G=F.originGridCell.value.row;return G<x.row||G>=x.row+x.rows?(0,gn.failure)(pt.emptyIntersection):(0,gn.success)((0,Vo.sheetGridRange)(k.value.sheet,(0,Vo.gridRange)(G,x.col,1,x.cols)))}return NB(e.getStructRefSpecialRef(w,B))}function p(F,w,B){switch(w.kind){case tn.StructRefKind.ColumnRef:return l(F,w,B);case tn.StructRefKind.MissingRef:return{kind:tn.StructRefKind.MissingRef,innerRef:w,resolution:gn.successUndefined}}}function m(F,w,B){var k;B===void 0&&(B=!1);var x=p(F,w.lhs,B),G=x.innerRef,H=x.resolution,L=p(F,w.rhs,B),D=L.innerRef,U=L.resolution,V=(0,tn.rangeOpRef)(G,D,w.label);if(!(0,gn.isSuccess)(H)&&H.reason.kind!==pt.ResolveReasonKind.InvalidStructRef)return{kind:tn.StructRefKind.RangeOpRef,innerRef:V,resolution:H};if(!(0,gn.isSuccess)(U)&&U.reason.kind!==pt.ResolveReasonKind.InvalidStructRef)return{kind:tn.StructRefKind.RangeOpRef,innerRef:V,resolution:U};if(!(0,gn.isSuccess)(H))return{kind:tn.StructRefKind.RangeOpRef,innerRef:V,resolution:H};if(!(0,gn.isSuccess)(U))return{kind:tn.StructRefKind.RangeOpRef,innerRef:V,resolution:U};var ne,J;if(H.value!==void 0)ne=H.value.sheet,J=(0,pC.gridRangeJoinOpt)(H.value.range,(k=U.value)===null||k===void 0?void 0:k.range);else if(U.value!==void 0)ne=U.value.sheet,J=U.value.range;else return{kind:tn.StructRefKind.RangeOpRef,innerRef:V,resolution:(0,gn.failure)((0,pt.invalidStructRef)(pt.InvalidStructRefReason.InvalidOp))};return{kind:tn.StructRefKind.RangeOpRef,innerRef:V,resolution:(0,gn.success)((0,Vo.sheetGridRange)(ne,J))}}function v(F,w,B){switch(B.kind){case tn.StructRefKind.ColumnRef:return l(w,B,!0);case tn.StructRefKind.SpecialRef:return{kind:tn.StructRefKind.SpecialRef,innerRef:B,resolution:f(F,w,B.id)};case tn.StructRefKind.RangeOpRef:return m(w,B,!0);case tn.StructRefKind.MissingRef:return{kind:tn.StructRefKind.MissingRef,innerRef:B,resolution:gn.successUndefined};case tn.StructRefKind.BadRef:return{kind:tn.StructRefKind.BadRef,innerRef:B,resolution:(0,gn.failure)((0,pt.invalidStructRef)(pt.InvalidStructRefReason.InvalidOp))}}}function h(F,w){var B=w.lhs,k=w.rhs,x=B,G,H;if(B!==void 0){var L=c(F,B,Vo.NameSource.StructRef),D=L.node,U=L.resolution,V=L.precedents,ne=U;if(!(0,gn.isSuccess)(ne))return(0,pt.resolvedStructRef)(w,void 0,ne,V);if((0,QA.isNone)(ne.value))return(0,pt.resolvedStructRef)(w,void 0,(0,gn.failure)((0,pt.invalidStructRef)(pt.InvalidStructRefReason.UndefinedTableName)),V);x=D,G=ne.value,H=V}else{var J=F.originGridCell,$=F.originSheet;if(!(0,gn.isSuccess)(J))return(0,pt.resolvedStructRef)(w,void 0,J,[]);if(!(0,gn.isSuccess)($))return(0,pt.resolvedStructRef)(w,void 0,$,[]);if($.value.index===void 0)return(0,pt.resolvedStructRef)(w,void 0,(0,gn.failure)((0,pt.invalidStructRef)(pt.InvalidStructRefReason.InvalidOriginSheet)),[]);var ne=e.getContainingTable((0,Vo.sheetGridCell)($.value,J.value));if(!(0,gn.isSuccess)(ne))return(0,pt.resolvedStructRef)(w,void 0,ne,[]);if((0,QA.isNone)(ne.value))return(0,pt.resolvedStructRef)(w,void 0,(0,gn.failure)((0,pt.invalidStructRef)(pt.InvalidStructRefReason.MissingTableName)),[]);G=ne.value,H=[G]}var Z=y(F,G,k),ie=Z.structRef,X=Z.resolution;return(0,pt.resolvedStructRef)(X.kind===gn.ResultKind.Failure&&X.reason.kind!==pt.ResolveReasonKind.EmptyIntersection?w:(0,tn.structRefNode)(x,ie,w.label),G,X,H)}function S(F,w,B){for(var k,x,G=B.refs.map(function(P){return v(F,w,P)}),H=(0,tn.commaOpRef)(G.map(function(P){return P.innerRef}),B.label),L=0,D=G;L<D.length;L++){var U=D[L].resolution;if(!(0,gn.isSuccess)(U)&&U.reason.kind!==pt.ResolveReasonKind.InvalidStructRef)return{commaOpRef:H,resolution:U}}for(var V=[],ne=0,J=G;ne<J.length;ne++){var $=J[ne];if(!(0,gn.isSuccess)($.resolution)||$.kind===tn.StructRefKind.BadRef)return{commaOpRef:H,resolution:$.resolution};V.push($.kind===tn.StructRefKind.SpecialRef?{kind:$.kind,resolution:$.resolution}:$.kind===tn.StructRefKind.MissingRef?{kind:$.kind,resolution:$.resolution}:{kind:$.kind,resolution:$.resolution})}if(!(0,pC.isCommaOpRefWellFormed)(B))return{commaOpRef:H,resolution:(0,gn.failure)((0,pt.invalidStructRef)(pt.InvalidStructRefReason.InvalidOp))};for(var Z,ie,X=0,Q=V;X<Q.length;X++){var $=Q[X];$.kind===tn.StructRefKind.SpecialRef&&(Z=(0,pC.gridRangeJoinOpt)(Z,(k=$.resolution.value)===null||k===void 0?void 0:k.range),ie===void 0&&(ie=(x=$.resolution.value)===null||x===void 0?void 0:x.sheet))}if(Z===void 0||ie===void 0)return{commaOpRef:H,resolution:gn.successUndefined};for(var b=0,R=V;b<R.length;b++){var $=R[b];if($.kind!==tn.StructRefKind.SpecialRef&&$.kind!==tn.StructRefKind.MissingRef&&(Z=(0,pC.gridRangeIsect)(Z,$.resolution.value.range),Z===void 0))return{commaOpRef:H,resolution:(0,gn.failure)((0,pt.invalidStructRef)(pt.InvalidStructRefReason.InvalidOp))}}return{commaOpRef:H,resolution:(0,gn.success)((0,Vo.sheetGridRange)(ie,Z))}}function y(F,w,B){var k;switch((k=B.innerRef)===null||k===void 0?void 0:k.kind){case tn.StructRefKind.ColumnRef:{var x=l(w,B.innerRef),G=x.innerRef,H=x.resolution;return{structRef:(0,tn.structRef)(G,B.isClosed,B.label),resolution:H}}case tn.StructRefKind.RangeOpRef:{var L=m(w,B.innerRef),G=L.innerRef,H=L.resolution;return{structRef:(0,tn.structRef)(G,B.isClosed,B.label),resolution:H}}case void 0:{var H=f(F,w,tn.SpecialRefId.Data);return{structRef:B,resolution:H}}case tn.StructRefKind.SpecialRef:{var H=f(F,w,B.innerRef.id);return{structRef:B,resolution:H}}case tn.StructRefKind.CommaOpRef:{var D=S(F,w,B.innerRef),G=D.commaOpRef,H=D.resolution;return{structRef:(0,tn.structRef)(G,B.isClosed,B.label),resolution:H}}case tn.StructRefKind.ThisRowOpRef:{var U=f(F,w,tn.SpecialRefId.ThisRow);if(tm(U)||B.innerRef.ref===void 0)return{structRef:B,resolution:U};var V=B.innerRef.ref.kind===tn.StructRefKind.ColumnRef?l(w,B.innerRef.ref):m(w,B.innerRef.ref),G=V.innerRef,ne=V.resolution,J=(0,tn.thisRowOpRef)(G,G.label);if(tm(ne))return{structRef:(0,tn.structRef)(J,B.isClosed,B.label),resolution:ne};var $=(0,pC.gridRangeIsect)(U.value.range,ne.value.range);return $?{structRef:(0,tn.structRef)(J,B.isClosed,B.label),resolution:(0,gn.success)((0,Vo.sheetGridRange)(U.value.sheet,$))}:{structRef:B,resolution:(0,gn.failure)((0,pt.invalidStructRef)(pt.InvalidStructRefReason.InvalidOp))}}case tn.StructRefKind.BadRef:return{structRef:B,resolution:(0,gn.failure)((0,pt.invalidStructRef)(pt.InvalidStructRefReason.InvalidOp))}}}function C(F,w){var B,k,x,G=w.qualifier,H=w.parts,L=(x=(k=F.config)===null||k===void 0?void 0:k.localeInfo)!==null&&x!==void 0?x:e.config.localeInfo,D,U,V;if(G===void 0){var ne=F.originSheet;if(!(0,gn.isSuccess)(ne))return(0,pt.resolvedUserDefinedFunc)(w,ne,[],H.asWhole);D=G,U=(0,gn.success)(ne.value.document)}else B=s(F,G),D=B[0],U=B[1];var J,$=H.asWhole;if(tm(U))J=U,V=[];else{$=(0,UJe.getUserDefinedFuncName)(L,H.asWhole);var Z=e.getUserDefinedFuncLoc(U.value,$);V=[(0,jY.userDefinedFuncLoc)(U.value,$)],(0,gn.isSuccess)(Z)?Z.value.length!==0?J=Z:J=gn.successUndefined:J=Z}return(0,pt.resolvedUserDefinedFunc)((0,tn.nameNode)((0,tn.identNamePart)(H.asWhole,H.canDenoteNamedObject,H.label,H.qualifiedLabel),D,w.label),J,V,$)}function E(F,w){var B=w[F.label];return(B==null?void 0:B.kind)===tn.AnnotationKind.LocalNameUse?(0,pt.resolvedLocalName)((0,tn.nameNode)((0,tn.identNamePart)(B.whole,F.canDenoteNamedObject,F.label,F.qualifiedLabel),void 0,F.qualifiedLabel),(0,gn.success)(B)):(0,pt.resolvedLocalName)((0,tn.nameNode)((0,tn.identNamePart)(F.asWhole,F.canDenoteNamedObject,F.label,F.qualifiedLabel),void 0,F.qualifiedLabel),gn.successUndefined)}function I(F,w,B){var k=w.qualifier,x=w.parts,G=[],H={names:new Array,udfs:new Array},L=B[w.label],D=(L==null?void 0:L.kind)===tn.AnnotationKind.AppHeadName;if(!k){var U=(0,tn.headNamePart)(x);if(U.kind===tn.NamePartKind.IdentNamePart){var V=E(U,B);if(V.resolution.value!==void 0){var ne=(0,tn.flattenNameParts)(x).parts,J=ne.slice(1),$=J.map(function(P){var A=P.rhs;return A.field.kind===tn.NodeKind.Ident?A.field.whole:void 0}).filter(function(P){return P!==void 0});if($.length===J.length)return(0,pt.resolvedDottedName)(V,$,H)}}}for(var Z;;){if(x.canDenoteNamedObject){var ie=(0,tn.nameNode)((0,tn.identNamePart)(x.asWhole,x.canDenoteNamedObject,x.label,x.qualifiedLabel),k,x.qualifiedLabel),X=c(F,ie,D?Vo.NameSource.AppHead:Vo.NameSource.Plain);if(Z=(0,pt.resolvedDottedName)(X,EB.__spreadArray([],G,!0).reverse(),H),(0,Uge.safePush)(H.names,X.precedents),!(0,gn.isSuccess)(X.resolution)&&X.resolution.reason.kind!==pt.ResolveReasonKind.InvalidQualifier||(0,gn.isSuccess)(X.resolution)&&X.resolution.value!==void 0)return Z;if(D&&(k===void 0||k.kind===tn.QualifierKind.Document||k.kind===tn.QualifierKind.Ident)){var Q=C(F,ie);if(Z=(0,pt.resolvedDottedName)(Q,EB.__spreadArray([],G,!0).reverse(),H),(0,Uge.safePush)(H.udfs,Q.precedents),!(0,gn.isSuccess)(Q.resolution)&&Q.resolution.reason.kind!==pt.ResolveReasonKind.InvalidQualifier||(0,gn.isSuccess)(Q.resolution)&&Q.resolution.value!==void 0)return Z}}if(x.kind===tn.NamePartKind.CellRefNamePart&&(k==null&&F.allowUnqualifiedCell||k!=null&&k.kind!==tn.QualifierKind.Document)){var b=(0,tn.cellRefNode)(x.ref,k!=null&&k.kind===tn.QualifierKind.Ident?(0,tn.sheetQualifier)(k.name):k,x.qualifiedLabel),R=t(F,b);return(0,pt.resolvedDottedName)(R,EB.__spreadArray([],G,!0).reverse(),H)}if(x.kind===tn.NamePartKind.FieldRefNamePart&&x.rhs.field.kind===tn.NodeKind.Ident){G.push(x.rhs.field.whole),x=x.lhs,D=!1;continue}return Z!==void 0?Z:(0,pt.resolvedDottedName)((0,pt.resolvedNever)((0,tn.nameNode)((0,tn.identNamePart)(x.asWhole,x.canDenoteNamedObject,x.label,x.qualifiedLabel),k,x.qualifiedLabel)),EB.__spreadArray([],G,!0).reverse(),H)}}return{resolveGridRef:YY,resolveCellRef:t,resolveName:c,resolveStructRef:h,resolveUserDefinedFunc:C,resolveDottedName:I}}YA.createResolver=GJe});var JY=Y(kB=>{"use strict";_();Object.defineProperty(kB,"__esModule",{value:!0});kB.Pledge=void 0;var KJe=Cn();kB.Pledge=KJe.pledge.Pledge});var $A=Y(Ht=>{"use strict";_();Object.defineProperty(Ht,"__esModule",{value:!0});Ht.reducePledge=Ht.reduceTopDown_Pledge=Ht.reduceBottomUp=Ht.reduceBottomUp_MaxDepth=Ht.reduceBottomUp_Pledge=Ht.PledgeReducer=Ht.reduceBottomUp_CPS=Ht.reduceBottomUp_Recursive=Ht.zipVisitor=Ht.ZipVisitor=Ht.depthVisitor=Ht.composeVisitor=Ht.ComposeVisitor=Ht.binaryVisitor=Ht.BinaryVisitor=Ht.DelegatingVisitor=Ht.voidVisitor=Ht.constVisitor=Ht.ConstVisitor=Ht.identityVisitor=Ht.IdentityVisitor=Ht.bindVisitor=Ht.visitCellRef=Ht.visitQualifier=Ht.visitAppHeadNode=Ht.visitWSFNode=Ht.visitOperatorNode=Ht.visitFormulaNode=void 0;var nP=br(),tP=og(),Vge=Ep(),dl=JY(),Gge=R0(),fn=R0();function IB(e,r){switch(r.kind){case fn.NodeKind.Literal:{var n=r.oper,a=r.isClosed,o=r.label;return e.literalNode(n,a,o)}case fn.NodeKind.Array:{var u=r.nodes,a=r.isClosed,o=r.label;return e.arrayNode(u,a,o)}case fn.NodeKind.App:{var t=r.head,d=r.args,a=r.isClosed,o=r.label;return e.appNode(t,d,a,o)}case fn.NodeKind.Let:{var t=r.head,s=r.vars,c=r.body,l=r.badArgs,a=r.isClosed,o=r.label;return e.letNode(t,s,c,l,a,o)}case fn.NodeKind.Lambda:{var t=r.head,f=r.params,c=r.body,l=r.badArgs,a=r.isClosed,o=r.label;return e.lambdaNode(t,f,c,l,a,o)}case fn.NodeKind.Paren:{var p=r.node,a=r.isClosed,o=r.label;return e.parenNode(p,a,o)}case fn.NodeKind.Name:{var m=r.parts,v=r.qualifier,o=r.label;return e.nameNode(m,v,o)}case fn.NodeKind.CellRef:{var h=r.ref,v=r.qualifier,o=r.label;return e.cellRefNode(h,v,o)}case fn.NodeKind.FieldRef:{var S=r.lhs,y=r.rhs,C=r.shouldBeBracketed,o=r.label;return e.fieldRefNode(S,y,C,o)}case fn.NodeKind.StructRef:{var S=r.lhs,y=r.rhs,o=r.label;return e.structRefNode(S,y,o)}case fn.NodeKind.Missing:{var E=r.chars,o=r.label;return e.missingNode(E,o)}case fn.NodeKind.BadChars:{var I=r.type,E=r.chars,o=r.label;return e.badCharsNode(I,E,o)}case fn.NodeKind.BadSequence:{var I=r.type,F=r.contents,o=r.label;return e.badSequenceNode(I,F,o)}default:return(0,tP.assertNever)("calc.lang.visitFormulaNode",r)}}Ht.visitFormulaNode=IB;function $Y(e,r){var n=r.id,a=r.label;return e.operatorNode(n,a)}Ht.visitOperatorNode=$Y;function XA(e,r){var n=r.id,a=r.whole,o=r.label;return e.wsfNode(n,a,o)}Ht.visitWSFNode=XA;function Wge(e,r){switch(r.kind){case fn.NodeKind.Operator:return $Y(e,r);case fn.NodeKind.WSF:return XA(e,r);default:return IB(e,r)}}Ht.visitAppHeadNode=Wge;function VJe(e,r){switch(r.kind){case fn.QualifierKind.Error:{var n=r.label;return e.errorQualifier(n)}case fn.QualifierKind.Relative:{var n=r.label;return e.relativeQualifier(n)}case fn.QualifierKind.Document:{var a=r.document,o=r.path,u=r.isQuoted,n=r.label;return e.documentQualifier(a,o,u,n)}case fn.QualifierKind.Sheet:{var t=r.sheet,d=r.document,u=r.isQuoted,n=r.label;return e.sheetQualifier(t,d,u,n)}case fn.QualifierKind.Ident:{var s=r.name,u=r.isQuoted,n=r.label;return e.identQualifier(s,u,n)}case fn.QualifierKind.SheetRange:{var c=r.sheet1,l=r.sheet2,f=r.document,u=r.isQuoted,n=r.label;return e.sheetRangeQualifier(c,l,f,u,n)}case fn.QualifierKind.Bad:{var p=r.chars,u=r.isQuoted,m=r.isClosed,v=r.isTerminated,n=r.label;return e.badQualifier(p,u,m,v,n)}default:return(0,tP.assertNever)("calc.lang.visitQualifier",r)}}Ht.visitQualifier=VJe;function WJe(e,r){switch(r.kind){case fn.CellRefKind.Error:{var n=r.label;return e.cellRefError(n)}case fn.CellRefKind.Single:{var a=r.row,o=r.col,u=r.isBracketed,n=r.label;return e.cellRefSingle(a,o,u,n)}case fn.CellRefKind.Range:{var t=r.ref1,d=r.ref2,n=r.label;return e.cellRefRange(t,d,n)}case fn.CellRefKind.Row:{var s=r.row1,c=r.row2,u=r.isBracketed,n=r.label;return e.cellRefRow(s,c,u,n)}case fn.CellRefKind.Col:{var l=r.col1,f=r.col2,u=r.isBracketed,n=r.label;return e.cellRefCol(l,f,u,n)}case fn.CellRefKind.Bad:{var p=r.chars,u=r.isBracketed,n=r.label;return e.cellRefBad(p,u,n)}default:return(0,tP.assertNever)("calc.lang.visitCellRef",r)}}Ht.visitCellRef=WJe;function ZA(e){return{literalNode:e.literalNode.bind(e),arrayNode:e.arrayNode.bind(e),appNode:e.appNode.bind(e),letNode:e.letNode.bind(e),lambdaNode:e.lambdaNode.bind(e),parenNode:e.parenNode.bind(e),nameNode:e.nameNode.bind(e),cellRefNode:e.cellRefNode.bind(e),fieldRefNode:e.fieldRefNode.bind(e),structRefNode:e.structRefNode.bind(e),missingNode:e.missingNode.bind(e),badSequenceNode:e.badSequenceNode.bind(e),badCharsNode:e.badCharsNode.bind(e),operatorNode:e.operatorNode.bind(e),wsfNode:e.wsfNode.bind(e)}}Ht.bindVisitor=ZA;var jge=function(){function e(){}return e.prototype.literalNode=function(r,n,a){return(0,fn.literalNode)(r,n,a)},e.prototype.arrayNode=function(r,n,a){return(0,fn.arrayNode)(r,n,a)},e.prototype.appNode=function(r,n,a,o){return(0,fn.appNode)(r,n,a,o)},e.prototype.letNode=function(r,n,a,o,u,t){return(0,fn.letNode)(r,n,a,o,u,t)},e.prototype.lambdaNode=function(r,n,a,o,u,t){return(0,fn.lambdaNode)(r,n,a,o,u,t)},e.prototype.parenNode=function(r,n,a){return(0,fn.parenNode)(r,n,a)},e.prototype.nameNode=function(r,n,a){return(0,fn.nameNode)(r,n,a)},e.prototype.cellRefNode=function(r,n,a){return(0,fn.cellRefNode)(r,n,a)},e.prototype.fieldRefNode=function(r,n,a,o){return(0,fn.fieldRefNode)(r,n,a,o)},e.prototype.structRefNode=function(r,n,a){return(0,fn.structRefNode)(r,n,a)},e.prototype.missingNode=function(r,n){return(0,fn.missingNode)(r,n)},e.prototype.badSequenceNode=function(r,n,a){return(0,Gge.badSequenceNode)(r,n,a)},e.prototype.badCharsNode=function(r,n,a){return(0,Gge.badCharsNode)(r,n,a)},e.prototype.operatorNode=function(r,n){return(0,fn.operatorNode)(r,n)},e.prototype.wsfNode=function(r,n,a){return(0,fn.wsfNode)(r,n,a)},e}();Ht.IdentityVisitor=jge;Ht.identityVisitor=ZA(new jge);var Hge=function(){function e(r){this.value=r}return e.prototype.literalNode=function(r,n,a){return this.value},e.prototype.arrayNode=function(r,n,a){return this.value},e.prototype.appNode=function(r,n,a,o){return this.value},e.prototype.letNode=function(r,n,a,o,u,t){return this.value},e.prototype.lambdaNode=function(r,n,a,o,u,t){return this.value},e.prototype.parenNode=function(r,n,a){return this.value},e.prototype.nameNode=function(r,n,a){return this.value},e.prototype.cellRefNode=function(r,n,a){return this.value},e.prototype.fieldRefNode=function(r,n,a,o){return this.value},e.prototype.structRefNode=function(r,n,a){return this.value},e.prototype.missingNode=function(r,n){return this.value},e.prototype.badSequenceNode=function(r,n,a){return this.value},e.prototype.badCharsNode=function(r,n,a){return this.value},e.prototype.operatorNode=function(r,n){return this.value},e.prototype.wsfNode=function(r,n,a){return this.value},e}();Ht.ConstVisitor=Hge;function eJ(e){return ZA(new Hge(e))}Ht.constVisitor=eJ;Ht.voidVisitor=eJ(void 0);var Qge=function(){function e(r){this.visitor=r}return e.prototype.literalNode=function(r,n,a){return this.visitor.literalNode(r,n,a)},e.prototype.arrayNode=function(r,n,a){return this.visitor.arrayNode(r,n,a)},e.prototype.appNode=function(r,n,a,o){return this.visitor.appNode(r,n,a,o)},e.prototype.letNode=function(r,n,a,o,u,t){return this.visitor.letNode(r,n,a,o,u,t)},e.prototype.lambdaNode=function(r,n,a,o,u,t){return this.visitor.lambdaNode(r,n,a,o,u,t)},e.prototype.parenNode=function(r,n,a){return this.visitor.parenNode(r,n,a)},e.prototype.nameNode=function(r,n,a){return this.visitor.nameNode(r,n,a)},e.prototype.cellRefNode=function(r,n,a){return this.visitor.cellRefNode(r,n,a)},e.prototype.fieldRefNode=function(r,n,a,o){return this.visitor.fieldRefNode(r,n,a,o)},e.prototype.structRefNode=function(r,n,a){return this.visitor.structRefNode(r,n,a)},e.prototype.missingNode=function(r,n){return this.visitor.missingNode(r,n)},e.prototype.badSequenceNode=function(r,n,a){return this.visitor.badSequenceNode(r,n,a)},e.prototype.badCharsNode=function(r,n,a){return this.visitor.badCharsNode(r,n,a)},e.prototype.operatorNode=function(r,n){return this.visitor.operatorNode(r,n)},e.prototype.wsfNode=function(r,n,a){return this.visitor.wsfNode(r,n,a)},e}();Ht.DelegatingVisitor=Qge;var zge=function(e){nP.__extends(r,e);function r(n,a){var o=e.call(this,n)||this;return o.reducer=function(u,t){return a(u,t)},o}return r.prototype.arrayNode=function(n,a,o){var u=this;return(0,tP.assertTrue)("calc.lang.binaryVisitor: non-empty array",n.length>0&&n[0].length>0),n.map(function(t){return t.reduce(u.reducer)}).reduce(this.reducer)},r.prototype.appNode=function(n,a,o,u){return a.reduce(this.reducer,n)},r.prototype.letNode=function(n,a,o,u,t,d){return nP.__spreadArray(nP.__spreadArray(nP.__spreadArray([],a.map(function(s){var c=s.binder;return c.arg}),!0),o===void 0?[]:[o.arg],!0),u.map(function(s){return s.arg}),!0).reduce(this.reducer,n)},r.prototype.lambdaNode=function(n,a,o,u,t,d){return nP.__spreadArray(nP.__spreadArray(nP.__spreadArray([],a.map(function(s){var c,l=s.name;return(c=l.arg.def)===null||c===void 0?void 0:c.rhs}).filter(Vge.isDefined),!0),o===void 0?[]:[o.arg],!0),u.map(function(s){return s.arg}),!0).reduce(this.reducer,n)},r.prototype.parenNode=function(n,a,o){return n},r.prototype.fieldRefNode=function(n,a,o,u){return n},r.prototype.badSequenceNode=function(n,a,o){return(0,tP.assertTrue)("calc.lang.binaryVisitor: non-empty bad-sequence",a.length>0),a.reduce(this.reducer)},r}(Qge);Ht.BinaryVisitor=zge;function Yge(e,r){return ZA(new zge(e,r))}Ht.binaryVisitor=Yge;var Jge=function(){function e(r,n){this.a=r,this.b=n}return e.prototype.literalNode=function(r,n,a){return this.b(this.a.literalNode(r,n,a))},e.prototype.arrayNode=function(r,n,a){return this.b(this.a.arrayNode(r,n,a))},e.prototype.appNode=function(r,n,a,o){return this.b(this.a.appNode(r,n,a,o))},e.prototype.letNode=function(r,n,a,o,u,t){return this.b(this.a.letNode(r,n,a,o,u,t))},e.prototype.lambdaNode=function(r,n,a,o,u,t){return this.b(this.a.lambdaNode(r,n,a,o,u,t))},e.prototype.parenNode=function(r,n,a){return this.b(this.a.parenNode(r,n,a))},e.prototype.nameNode=function(r,n,a){return this.b(this.a.nameNode(r,n,a))},e.prototype.cellRefNode=function(r,n,a){return this.b(this.a.cellRefNode(r,n,a))},e.prototype.fieldRefNode=function(r,n,a,o){return this.b(this.a.fieldRefNode(r,n,a,o))},e.prototype.structRefNode=function(r,n,a){return this.b(this.a.structRefNode(r,n,a))},e.prototype.missingNode=function(r,n){return this.b(this.a.missingNode(r,n))},e.prototype.badSequenceNode=function(r,n,a){return this.b(this.a.badSequenceNode(r,n,a))},e.prototype.badCharsNode=function(r,n,a){return this.b(this.a.badCharsNode(r,n,a))},e.prototype.operatorNode=function(r,n){return this.b(this.a.operatorNode(r,n))},e.prototype.wsfNode=function(r,n,a){return this.b(this.a.wsfNode(r,n,a))},e}();Ht.ComposeVisitor=Jge;function Xge(e,r){return ZA(new Jge(e,r))}Ht.composeVisitor=Xge;Ht.depthVisitor=Xge(Yge(eJ(0),Vge.fastMax),function(e){return e+1});var Zge=function(){function e(r){this.visitors=r,this.keys=Object.keys(r)}return e.prototype.literalNode=function(r,n,a){for(var o={},u=0,t=this.keys;u<t.length;u++){var d=t[u];o[d]=this.visitors[d].literalNode(r,n,a)}return o},e.prototype.arrayNode=function(r,n,a){for(var o={},u=0,t=this.keys;u<t.length;u++){var d=t[u];o[d]=this.visitors[d].arrayNode(r,n,a)}return o},e.prototype.appNode=function(r,n,a,o){for(var u={},t=0,d=this.keys;t<d.length;t++){var s=d[t];u[s]=this.visitors[s].appNode(r,n,a,o)}return u},e.prototype.letNode=function(r,n,a,o,u,t){for(var d={},s=0,c=this.keys;s<c.length;s++){var l=c[s];d[l]=this.visitors[l].letNode(r,n,a,o,u,t)}return d},e.prototype.lambdaNode=function(r,n,a,o,u,t){for(var d={},s=0,c=this.keys;s<c.length;s++){var l=c[s];d[l]=this.visitors[l].lambdaNode(r,n,a,o,u,t)}return d},e.prototype.parenNode=function(r,n,a){for(var o={},u=0,t=this.keys;u<t.length;u++){var d=t[u];o[d]=this.visitors[d].parenNode(r,n,a)}return o},e.prototype.nameNode=function(r,n,a){for(var o={},u=0,t=this.keys;u<t.length;u++){var d=t[u];o[d]=this.visitors[d].nameNode(r,n,a)}return o},e.prototype.cellRefNode=function(r,n,a){for(var o={},u=0,t=this.keys;u<t.length;u++){var d=t[u];o[d]=this.visitors[d].cellRefNode(r,n,a)}return o},e.prototype.fieldRefNode=function(r,n,a,o){for(var u={},t=0,d=this.keys;t<d.length;t++){var s=d[t];u[s]=this.visitors[s].fieldRefNode(r,n,a,o)}return u},e.prototype.structRefNode=function(r,n,a){for(var o={},u=0,t=this.keys;u<t.length;u++){var d=t[u];o[d]=this.visitors[d].structRefNode(r,n,a)}return o},e.prototype.missingNode=function(r,n){for(var a={},o=0,u=this.keys;o<u.length;o++){var t=u[o];a[t]=this.visitors[t].missingNode(r,n)}return a},e.prototype.badSequenceNode=function(r,n,a){for(var o={},u=0,t=this.keys;u<t.length;u++){var d=t[u];o[d]=this.visitors[d].badSequenceNode(r,n,a)}return o},e.prototype.badCharsNode=function(r,n,a){for(var o={},u=0,t=this.keys;u<t.length;u++){var d=t[u];o[d]=this.visitors[d].badCharsNode(r,n,a)}return o},e.prototype.operatorNode=function(r,n){for(var a={},o=0,u=this.keys;o<u.length;o++){var t=u[o];a[t]=this.visitors[t].operatorNode(r,n)}return a},e.prototype.wsfNode=function(r,n,a){for(var o={},u=0,t=this.keys;u<t.length;u++){var d=t[u];o[d]=this.visitors[d].wsfNode(r,n,a)}return o},e}();Ht.ZipVisitor=Zge;function jJe(e){return ZA(new Zge(e))}Ht.zipVisitor=jJe;function $ge(e,r){var n=function(u){switch(u.kind){case fn.NodeKind.Operator:return $Y(e,u);case fn.NodeKind.WSF:return XA(e,u);default:return a(u)}},a=function o(u){switch(u.kind){case fn.NodeKind.Literal:{var t=u.oper,d=u.isClosed,s=u.label;return e.literalNode(t,d,s)}case fn.NodeKind.Array:{var c=u.nodes,d=u.isClosed,s=u.label;return e.arrayNode(c.map(function(L){return L.map(o)}),d,s)}case fn.NodeKind.App:{var l=u.head,f=u.args,d=u.isClosed,s=u.label;return e.appNode(n(l),f.map(o),d,s)}case fn.NodeKind.Let:{var l=u.head,p=u.vars,m=u.body,v=u.badArgs,d=u.isClosed,s=u.label;return e.letNode(XA(e,l),p.map(function(D){var U=D.name,V=D.binder;return(0,fn.letVar)(U,(0,fn.indexedArg)(o(V.arg),V.index))}),m===void 0?void 0:(0,fn.indexedArg)(o(m.arg),m.index),v.map(function(D){return(0,fn.indexedArg)(o(D.arg),D.index)}),d,s)}case fn.NodeKind.Lambda:{var l=u.head,h=u.params,m=u.body,v=u.badArgs,d=u.isClosed,s=u.label;return e.lambdaNode(XA(e,l),h.map(function(V){var ne=V.name;return ne.arg.def===void 0?(0,fn.lambdaParam)(ne):(0,fn.lambdaParam)((0,fn.indexedArg)((0,fn.paramNode)(ne.arg.name,(0,fn.paramDefault)(o(ne.arg.def.rhs),ne.arg.def.label),ne.arg.label),ne.index))}),m===void 0?void 0:(0,fn.indexedArg)(o(m.arg),m.index),v.map(function(V){return(0,fn.indexedArg)(o(V.arg),V.index)}),d,s)}case fn.NodeKind.Paren:{var S=u.node,d=u.isClosed,s=u.label;return e.parenNode(o(S),d,s)}case fn.NodeKind.Name:{var y=u.parts,C=u.qualifier,s=u.label;return e.nameNode(y,C,s)}case fn.NodeKind.CellRef:{var E=u.ref,C=u.qualifier,s=u.label;return e.cellRefNode(E,C,s)}case fn.NodeKind.FieldRef:{var I=u.lhs,F=u.rhs,w=u.shouldBeBracketed,s=u.label;return e.fieldRefNode(o(I),F,w,s)}case fn.NodeKind.StructRef:{var I=u.lhs,F=u.rhs,s=u.label;return e.structRefNode(I,F,s)}case fn.NodeKind.Missing:{var B=u.chars,s=u.label;return e.missingNode(B,s)}case fn.NodeKind.BadChars:{var k=u.type,B=u.chars,s=u.label;return e.badCharsNode(k,B,s)}case fn.NodeKind.BadSequence:{var k=u.type,x=u.contents,s=u.label;return e.badSequenceNode(k,x.map(o),s)}default:return(0,tP.assertNever)("calc.lang.reduceBottomUp_Recursive",u)}};return a(r)}Ht.reduceBottomUp_Recursive=$ge;function HJe(e){for(var r=e;r!=null;)r=r();return r}function JA(e,r,n,a){var o=[],u=function(s){return o.push(s),t},t=function(){return o.length<r.length?n(e,r[o.length],u):a(o)};return t}function XY(e,r,n){return JA(e,r,sR,n)}function Kge(e,r,n,a){return function(){return r!==void 0?n(e,r,a):a(void 0)}}function QJe(e,r,n){switch(r.kind){case fn.NodeKind.Operator:{var a=r.id,o=r.label;return function(){return n(e.operatorNode(a,o))}}case fn.NodeKind.WSF:return ZY(e,r,n);default:return sR(e,r,n)}}function ZY(e,r,n){var a=r.id,o=r.whole,u=r.label;return function(){return n(e.wsfNode(a,o,u))}}function zJe(e,r,n){var a=r.name,o=r.binder;return sR(e,o.arg,function(u){return n((0,fn.letVar)(a,(0,fn.indexedArg)(u,o.index)))})}function YJe(e,r,n){var a=r.name,o=a.arg;return o.def===void 0?function(){return n((0,fn.lambdaParam)(a))}:sR(e,o.def.rhs,function(u){return n((0,fn.lambdaParam)((0,fn.indexedArg)((0,fn.paramNode)(o.name,(0,fn.paramDefault)(u,o.def.label),o.label),a.index)))})}function FB(e,r,n){var a=r.arg,o=r.index;return sR(e,a,function(u){return n((0,fn.indexedArg)(u,o))})}function sR(e,r,n){switch(r.kind){case fn.NodeKind.Literal:{var a=r.oper,o=r.isClosed,u=r.label;return function(){return n(e.literalNode(a,o,u))}}case fn.NodeKind.Array:{var t=r.nodes,d=r.isClosed,s=r.label;return JA(e,t,XY,function(z){return n(e.arrayNode(z,d,s))})}case fn.NodeKind.App:{var c=r.head,l=r.args,f=r.isClosed,p=r.label;return function(){return QJe(e,c,function(z){return XY(e,l,function(ee){return n(e.appNode(z,ee,f,p))})})}}case fn.NodeKind.Let:{var m=r.head,v=r.vars,h=r.body,S=r.badArgs,y=r.isClosed,C=r.label;return function(){return ZY(e,m,function(z){return JA(e,v,zJe,function(ee){return Kge(e,h,FB,function(ue){return JA(e,S,FB,function(ce){return n(e.letNode(z,ee,ue,ce,y,C))})})})})}}case fn.NodeKind.Lambda:{var E=r.head,I=r.params,F=r.body,w=r.badArgs,B=r.isClosed,k=r.label;return function(){return ZY(e,E,function(z){return function(){return JA(e,I,YJe,function(ee){return Kge(e,F,FB,function(ue){return JA(e,w,FB,function(ce){return n(e.lambdaNode(z,ee,ue,ce,B,k))})})})}})}}case fn.NodeKind.Paren:{var x=r.node,G=r.isClosed,H=r.label;return function(){return sR(e,x,function(z){return function(){return n(e.parenNode(z,G,H))}})}}case fn.NodeKind.Name:{var L=r.parts,D=r.qualifier,U=r.label;return function(){return n(e.nameNode(L,D,U))}}case fn.NodeKind.CellRef:{var V=r.ref,ne=r.qualifier,J=r.label;return function(){return n(e.cellRefNode(V,ne,J))}}case fn.NodeKind.FieldRef:{var $=r.lhs,Z=r.rhs,ie=r.shouldBeBracketed,X=r.label;return function(){return sR(e,$,function(z){return function(){return n(e.fieldRefNode(z,Z,ie,X))}})}}case fn.NodeKind.StructRef:{var Q=r.lhs,b=r.rhs,R=r.label;return function(){return n(e.structRefNode(Q,b,R))}}case fn.NodeKind.Missing:{var P=r.chars,A=r.label;return function(){return n(e.missingNode(P,A))}}case fn.NodeKind.BadChars:{var T=r.type,g=r.chars,O=r.label;return function(){return n(e.badCharsNode(T,g,O))}}case fn.NodeKind.BadSequence:{var M=r.type,K=r.contents,W=r.label;return XY(e,K,function(z){return n(e.badSequenceNode(M,z,W))})}default:return(0,tP.assertNever)("calc.lang.reduceBottomUp_CPS",r)}}function eve(e,r){var n;return HJe(sR(e,r,function(a){return void(n=a)})),n}Ht.reduceBottomUp_CPS=eve;var rve=function(){function e(r){var n=this;this.visitor=r,this.visitFormulaNode=function(a){return IB(n,a)},this.lazyVisitFormulaNode=function(a){return dl.Pledge.resolve(a).bind(n.visitFormulaNode)},this.visitAppHeadNode=function(a){return Wge(n,a)},this.lazyVisitAppHeadNode=function(a){return dl.Pledge.resolve(a).bind(n.visitAppHeadNode)},this.visitWSFNode=function(a){return XA(n,a)},this.lazyVisitWSFNode=function(a){return dl.Pledge.resolve(a).bind(n.visitWSFNode)},this.lazyVisitVar=function(a){var o=a.name,u=a.binder;return n.lazyVisitFormulaNode(u.arg).bind(function(t){return(0,fn.letVar)(o,(0,fn.indexedArg)(t,u.index))})},this.lazyVisitParam=function(a){var o=a.name,u=o.arg;return u.def===void 0?dl.Pledge.resolve((0,fn.lambdaParam)(o)):n.lazyVisitFormulaNode(u.def.rhs).bind(function(t){return(0,fn.lambdaParam)((0,fn.indexedArg)((0,fn.paramNode)(u.name,(0,fn.paramDefault)(t,u.def.label),u.label),o.index))})},this.lazyVisitIndexedArg=function(a){var o=a.arg,u=a.index;return n.lazyVisitFormulaNode(o).bind(function(t){return(0,fn.indexedArg)(t,u)})}}return e.prototype.literalNode=function(r,n,a){var o=this;return dl.Pledge.try(function(){return o.visitor.literalNode(r,n,a)})},e.prototype.arrayNode=function(r,n,a){var o=this;return dl.Pledge.all(r.map(function(u){return dl.Pledge.all(u.map(o.lazyVisitFormulaNode))})).bind(function(u){return o.visitor.arrayNode(u,n,a)})},e.prototype.appNode=function(r,n,a,o){var u=this;return this.lazyVisitAppHeadNode(r).bind(function(t){return dl.Pledge.all(n.map(u.lazyVisitFormulaNode)).bind(function(d){return u.visitor.appNode(t,d,a,o)})})},e.prototype.letNode=function(r,n,a,o,u,t){var d=this;return this.lazyVisitWSFNode(r).bind(function(s){return dl.Pledge.all(n.map(d.lazyVisitVar)).bind(function(c){return(a===void 0?dl.Pledge.resolve(void 0):d.lazyVisitIndexedArg(a)).bind(function(l){return dl.Pledge.all(o.map(d.lazyVisitIndexedArg)).bind(function(f){return d.visitor.letNode(s,c,l,f,u,t)})})})})},e.prototype.lambdaNode=function(r,n,a,o,u,t){var d=this;return this.lazyVisitWSFNode(r).bind(function(s){return dl.Pledge.all(n.map(d.lazyVisitParam)).bind(function(c){return(a===void 0?dl.Pledge.resolve(void 0):d.lazyVisitIndexedArg(a)).bind(function(l){return dl.Pledge.all(o.map(d.lazyVisitIndexedArg)).bind(function(f){return d.visitor.lambdaNode(s,c,l,f,u,t)})})})})},e.prototype.parenNode=function(r,n,a){var o=this;return this.lazyVisitFormulaNode(r).bind(function(u){return o.visitor.parenNode(u,n,a)})},e.prototype.nameNode=function(r,n,a){var o=this;return dl.Pledge.try(function(){return o.visitor.nameNode(r,n,a)})},e.prototype.cellRefNode=function(r,n,a){var o=this;return dl.Pledge.try(function(){return o.visitor.cellRefNode(r,n,a)})},e.prototype.fieldRefNode=function(r,n,a,o){var u=this;return this.lazyVisitFormulaNode(r).bind(function(t){return u.visitor.fieldRefNode(t,n,a,o)})},e.prototype.structRefNode=function(r,n,a){var o=this;return dl.Pledge.try(function(){return o.visitor.structRefNode(r,n,a)})},e.prototype.missingNode=function(r,n){var a=this;return dl.Pledge.try(function(){return a.visitor.missingNode(r,n)})},e.prototype.badSequenceNode=function(r,n,a){var o=this;return dl.Pledge.all(n.map(this.lazyVisitFormulaNode)).bind(function(u){return o.visitor.badSequenceNode(r,u,a)})},e.prototype.badCharsNode=function(r,n,a){var o=this;return dl.Pledge.try(function(){return o.visitor.badCharsNode(r,n,a)})},e.prototype.operatorNode=function(r,n){var a=this;return dl.Pledge.try(function(){return a.visitor.operatorNode(r,n)})},e.prototype.wsfNode=function(r,n,a){var o=this;return dl.Pledge.try(function(){return o.visitor.wsfNode(r,n,a)})},e}();Ht.PledgeReducer=rve;function JJe(e,r){return rJ(new rve(e),r)}Ht.reduceBottomUp_Pledge=JJe;var XJe=50;function nve(e,r,n){return n<=XJe?$ge(e,r):eve(e,r)}Ht.reduceBottomUp_MaxDepth=nve;function ZJe(e,r){return nve(e,r.node,r.depthUpperBound)}Ht.reduceBottomUp=ZJe;function rJ(e,r){return dl.Pledge.settleOrThrow(dl.Pledge.resolve(IB(e,r)))}Ht.reduceTopDown_Pledge=rJ;function $Je(e,r){return rJ(e,r.node)}Ht.reducePledge=$Je});var ove=Y(wB=>{"use strict";_();Object.defineProperty(wB,"__esModule",{value:!0});wB.adjustFormulaOrigin=void 0;var aJ=br(),e2=sv(),Zc=R0(),tve=t1(),r2=GM(),eXe=RB(),MB=Wb(),rXe=og(),nJ=KM(),nXe=OB(),ave=$A();function n2(e,r,n,a){if(n.kind===Zc.PosKind.Abs)return n;var o=(0,eXe.wrapPosition)(e,n.index,a),u=o-r;return u===n.index?n:(0,Zc.pos)(Zc.PosKind.Rel,u)}function tJ(e,r,n,a){var o=n2(r.row,n.row,a.row,e2.sheetRows),u=n2(r.col,n.col,a.col,e2.sheetCols),t=(0,r2.canonicaliseBrackets)(e,o)||(0,r2.canonicaliseBrackets)(e,u);return(0,Zc.cellRefSingle)(o,u,t,a.label)}function tXe(e,r,n,a){switch(a.kind){case Zc.CellRefKind.Error:case Zc.CellRefKind.Bad:return a;case Zc.CellRefKind.Single:return tJ(e,r,n,a);case Zc.CellRefKind.Range:{var o=tJ(e,r,n,a.ref1),u=tJ(e,r,n,a.ref2);return o===a.ref1&&u===a.ref2?a:(0,Zc.cellRefRange)(o,u,a.label)}case Zc.CellRefKind.Row:{var t=n2(r.row,n.row,a.row1,e2.sheetRows),d=n2(r.row,n.row,a.row2,e2.sheetRows),s=(0,r2.canonicaliseBrackets)(e,t)||(0,r2.canonicaliseBrackets)(e,d);return(0,Zc.cellRefRow)(t,d,s,a.label)}case Zc.CellRefKind.Col:{var c=n2(r.col,n.col,a.col1,e2.sheetCols),l=n2(r.col,n.col,a.col2,e2.sheetCols),s=(0,r2.canonicaliseBrackets)(e,c)||(0,r2.canonicaliseBrackets)(e,l);return(0,Zc.cellRefCol)(c,l,s,a.label)}}}var ive=(0,tve.createFailureErrorClass)("TransformRefsError"),aXe=function(e){aJ.__extends(r,e);function r(n,a,o,u){var t=e.call(this)||this;return t.fn=n,t.locals=o,t.annotations=u,t.resolver=(0,nXe.createResolver)(a),t}return r.prototype.nameNode=function(n,a,o){var u=(0,Zc.nameNode)(n,a,o),t=this.resolver.resolveDottedName(this.locals,u,this.annotations).resolved;if(t.kind===nJ.ResolvedKind.ResolvedCellRef){var d=(0,Zc.flattenNameParts)(n);(0,rXe.assertTrue)("calc.lang.adjustFormulaOrigin",d.kind===Zc.NamePartKind.CellRefNamePart);var s=d.parts,c=s[0],l=s[1],f=s.slice(2),p=function(v,h){var S=h.rhs,y=h.canDenoteNamedObject,C=h.label,E=h.qualifiedLabel;return(0,Zc.fieldRefNamePart)(v,S,y,C,E)};return(0,Zc.nameNode)(f.reduce(p,p((0,Zc.cellRefNamePart)(this.fn(c.ref),c.asWhole,c.label,c.qualifiedLabel),l)),a,o)}if(t.resolution.kind!==MB.ResultKind.Success&&t.resolution.reason.kind!==nJ.ResolveReasonKind.NoOriginSheet&&t.resolution.reason.kind!==nJ.ResolveReasonKind.InvalidQualifier)throw new ive(t.resolution.reason);return u},r.prototype.cellRefNode=function(n,a,o){return(0,Zc.cellRefNode)(this.fn(n),a,o)},r}(ave.IdentityVisitor);function iXe(e,r,n,a){var o=r.originGridCell.value;if((0,tve.isGridCellEqual)(o,n))return(0,MB.success)(a);try{var u=(0,ave.reduceBottomUp)(new aXe(tXe.bind(void 0,e.config.refStyle,o,n),e,r,a.annotations),a);return(0,MB.success)(aJ.__assign(aJ.__assign({},a),{node:u}))}catch(t){if(t instanceof ive)return(0,MB.failure)(t.reason);throw t}}wB.adjustFormulaOrigin=iXe});var uve=Y(DB=>{"use strict";_();Object.defineProperty(DB,"__esModule",{value:!0});DB.RedBlackMapTree=void 0;var oXe=Cn();DB.RedBlackMapTree=oXe.rbMapTree.RedBlackMapTree});var lve=Y(xB=>{"use strict";_();Object.defineProperty(xB,"__esModule",{value:!0});xB.buildAnnotations=void 0;var uXe=br(),sXe=og(),lXe=uve(),ug=JY(),sve=oB(),lR=R0(),iJ=t1(),i1=$A(),cXe=function(e){uXe.__extends(r,e);function r(n,a,o){var u=e.call(this,i1.voidVisitor)||this;return u.localeInfo=n,u.annotations=a,u.names=o,u}return r.prototype.appNode=function(n,a,o,u){var t=this;return ug.Pledge.try(function(){return n.kind===lR.NodeKind.Name&&(t.annotations[n.label]=lR.appHeadNameAnnotation),e.prototype.appNode.call(t,n,a,o,u)})},r.prototype.letNode=function(n,a,o,u){var t=this,d=n.id===sve.WorksheetFuncId.LETREC?!0:n.id===sve.WorksheetFuncId.LET?!1:(0,sXe.assertFalse)("calc.lang.buildAnnotations"),s=this.bindNames(a),c=s[a.length];return this.lazyVisitAppHeadNode(n).bind(function(l){return d?ug.Pledge.all(a.map(function(f){var p=f.binder;return ug.Pledge.try(function(){return(0,i1.visitFormulaNode)(c,p.arg)})})):ug.Pledge.all(a.map(function(f,p){var m=f.binder,v=s[p];return ug.Pledge.try(function(){return(0,i1.visitFormulaNode)(v,m.arg)})}))}).bind(function(l){return o===void 0?void 0:(0,i1.visitFormulaNode)(c,o.arg)}).bind(function(l){return ug.Pledge.all(u.map(function(f){return ug.Pledge.try(function(){return(0,i1.visitFormulaNode)(t,f.arg)})}))}).bind(function(l){})},r.prototype.lambdaNode=function(n,a,o,u){var t=this,d=this.bindNames(a),s=d[a.length];return this.lazyVisitAppHeadNode(n).bind(function(c){return ug.Pledge.all(a.map(function(l,f){var p=l.name;if(p.arg.def===void 0)return ug.Pledge.resolve(void 0);var m=d[f],v=p.arg.def;return ug.Pledge.try(function(){return(0,i1.visitFormulaNode)(m,v.rhs)})}))}).bind(function(c){return o===void 0?void 0:(0,i1.visitFormulaNode)(s,o.arg)}).bind(function(c){return ug.Pledge.all(u.map(function(l){return ug.Pledge.try(function(){return(0,i1.visitFormulaNode)(t,l.arg)})}))}).bind(function(c){})},r.prototype.bindNames=function(n){var a=this,o=[this];return n.reduce(function(u,t){var d=t.name;if(d.arg.wholeName===void 0)return o.push(new r(a.localeInfo,a.annotations,u)),u;var s=(0,iJ.getBoundName)(a.localeInfo,d.arg.wholeName),c=u.setValue(s,d.arg);return o.push(new r(a.localeInfo,a.annotations,c)),a.annotations[d.arg.label]=(0,lR.localNameDeclAnnotation)(s,d.arg.wholeName),c},this.names),o},r.prototype.nameNode=function(n,a,o){var u=this;return ug.Pledge.try(function(){if(a===void 0){var t=(0,lR.headNamePart)(n),d=u.names.getEntry((0,iJ.getBoundName)(u.localeInfo,t.asWhole));if(d!==void 0)if(d.value.kind===lR.NodeKind.ContextName)u.annotations[t.label]=(0,lR.localNameUseAnnotation)(d.key,d.value.whole,d.value.label);else{u.annotations[t.label]=(0,lR.localNameUseAnnotation)(d.key,d.value.wholeName,d.value.label);var s=u.annotations[d.value.label];s.uses.push({label:t.label})}}return e.prototype.nameNode.call(u,n,a,o)})},r}(i1.PledgeReducer);function dXe(e,r,n,a){var o=[];return(0,i1.reduceTopDown_Pledge)(new cXe(e,o,(n??[]).reduce(function(u,t){var d=(0,iJ.getBoundName)(e,t.whole);return u.setValue(d,t)},lXe.RedBlackMapTree.create(e.stringCompareCI))),r),o[r.label]=(0,lR.formulaRootAnnotation)(n,a),o}xB.buildAnnotations=dXe});var cve=Y(cv=>{"use strict";_();Object.defineProperty(cv,"__esModule",{value:!0});cv.enumerateKeysInOrder=cv.enumerateInOrder=cv.RootPointer=cv.ArrayMapTree=cv.floorToPowerOf2=void 0;var VM=Cn();cv.floorToPowerOf2=VM.arrayMapTree.floorToPowerOf2;cv.ArrayMapTree=VM.arrayMapTree.ArrayMapTree;cv.RootPointer=VM.arrayMapTree.RootPointer;cv.enumerateInOrder=VM.arrayMapTree.enumerateInOrder;cv.enumerateKeysInOrder=VM.arrayMapTree.enumerateKeysInOrder});var dve=Y(LB=>{"use strict";_();Object.defineProperty(LB,"__esModule",{value:!0});LB.Math=void 0;var fXe=function(e){if(e.imul&&e.fround&&e.clz32)return e;function r(u,t){t|=0;var d=(u&4194303)*t;return u&4290772992&&(d+=(u&4290772992)*t|0),d|0}var n=new Float32Array(1);function a(u){return n[0]=u,n[0]}function o(u){var t=u>>>0;return t===0?32:31-(e.log(t)/e.LN2|0)|0}return Object.create(e,{imul:{value:r},fround:{value:a},clz32:{value:o}})}(Math);LB.Math=fXe});var qB=Y(am=>{"use strict";_();Object.defineProperty(am,"__esModule",{value:!0});am.isSupported=am.fastMin=am.Base_LocaleDecimalSeparator=am.Base_LocaleGetOrdinal=am.Base_LocaleIsNumeral=am.setLocale=void 0;var BB=void 0;function pXe(e){BB=e}am.setLocale=pXe;var mXe=46;function gXe(e){return BB.isNumeral(e)?1:0}am.Base_LocaleIsNumeral=gXe;function vXe(e){return BB.getOrdinal(e)}am.Base_LocaleGetOrdinal=vXe;function hXe(){var e=BB.decimalSeparator;return e.length===0?mXe:e.charCodeAt(0)}am.Base_LocaleDecimalSeparator=hXe;function SXe(e,r){return e<r?e:r}am.fastMin=SXe;function yXe(){var e=new ArrayBuffer(2);return new Uint16Array(e)[0]=1,new Uint8Array(e)[0]===1}am.isSupported=yXe});var fve=Y(Ac=>{"use strict";_();Object.defineProperty(Ac,"__esModule",{value:!0});Object.defineProperty(Ac,"Base_LocaleDecimalSeparator",{enumerable:!0,get:function(){return oJ.Base_LocaleDecimalSeparator}});Object.defineProperty(Ac,"Base_LocaleGetOrdinal",{enumerable:!0,get:function(){return oJ.Base_LocaleGetOrdinal}});Object.defineProperty(Ac,"Base_LocaleIsNumeral",{enumerable:!0,get:function(){return oJ.Base_LocaleIsNumeral}});Ac.Math_tan=Ac.Math_sqrt=Ac.Math_sin=Ac.Math_log10=Ac.Math_log=Ac.Math_exp=Ac.Math_cos=Ac.Math_atan=void 0;var oJ=qB(),CXe=Math.sqrt;Ac.Math_sqrt=CXe;var _Xe=Math.log10||function(r){return Math.log(r)*Math.LOG10E};Ac.Math_log10=_Xe;var RXe=Math.log;Ac.Math_log=RXe;var TXe=Math.exp;Ac.Math_exp=TXe;var bXe=Math.sin;Ac.Math_sin=bXe;var PXe=Math.cos;Ac.Math_cos=PXe;var EXe=Math.tan;Ac.Math_tan=EXe;var NXe=Math.atan;Ac.Math_atan=NXe});var pve=Y(uJ=>{"use strict";_();Object.defineProperty(uJ,"__esModule",{value:!0});uJ.proc_exit=AXe;function AXe(e){throw new Error("unexpected process termination: "+e)}});var WM=Y(ur=>{"use strict";_();Object.defineProperty(ur,"__esModule",{value:!0});ur.stackSave=ur.stackRestore=ur.stackAlloc=ur.setThrew=ur.memory=ur._start=ur.__growWasmMemory=ur.__errno_location=ur.Mathpack_Zero=ur.Mathpack_ViewRound=ur.Mathpack_Trunc=ur.Mathpack_TenTo=ur.Mathpack_Tan=ur.Mathpack_TakeMathError=ur.Mathpack_Sub=ur.Mathpack_Sqrt=ur.Mathpack_Sin=ur.Mathpack_SFloat=ur.Mathpack_SFix=ur.Mathpack_RoundUp=ur.Mathpack_RoundDown=ur.Mathpack_Round=ur.Mathpack_Power=ur.Mathpack_Pi=ur.Mathpack_Pack=ur.Mathpack_One=ur.Mathpack_Neg=ur.Mathpack_Mul=ur.Mathpack_Log=ur.Mathpack_Ln=ur.Mathpack_LFix=ur.Mathpack_GetExp32=ur.Mathpack_FormatScientific=ur.Mathpack_FormatGetSign=ur.Mathpack_FormatGetExponent=ur.Mathpack_FormatGeneral=ur.Mathpack_FormatFixed=ur.Mathpack_Floor=ur.Mathpack_Float=ur.Mathpack_Fix=ur.Mathpack_Exp=ur.Mathpack_Equal=ur.Mathpack_Div=ur.Mathpack_Cos=ur.Mathpack_Cond2=ur.Mathpack_Cond=ur.Mathpack_Compare=ur.Mathpack_Ceil=ur.Mathpack_Atan2=ur.Mathpack_Atan=ur.Mathpack_Asin=ur.Mathpack_Add=ur.Mathpack_Acos=ur.Mathpack_Abs=ur.Dtr_Yr=ur.Dtr_Write=ur.Dtr_Wdy=ur.Dtr_UtcToLocal=ur.Dtr_ToTime=ur.Dtr_ToNumWithDuration=ur.Dtr_ToNum=ur.Dtr_ToDays=ur.Dtr_Sec=ur.Dtr_Rounding=ur.Dtr_Mon=ur.Dtr_Min=ur.Dtr_Hour=ur.Dtr_FromNum=ur.Dtr_FracSec=ur.Dtr_DaysPerMonth=ur.Dtr_Days=ur.Dtr_DOM=ur.Base_StrBufSize=ur.Base_StrBuf=void 0;var OXe=dve(),Qh=fve(),kXe=pve(),sJ=new ArrayBuffer(8),UB=new Int32Array(sJ),lhn=new Float32Array(sJ),mve=new Float64Array(sJ);function Hr(e){return UB[e]}function $l(e,r){UB[e]=r}function zh(){return mve[0]}function ra(e){mve[0]=e}function FXe(e,r){UB[0]=e,UB[1]=r}function IXe(e,r,n){var a=new e.Int8Array(n),o=new e.Int16Array(n),u=new e.Int32Array(n),t=new e.Uint8Array(n),d=new e.Uint16Array(n),s=new e.Uint32Array(n),c=new e.Float32Array(n),l=new e.Float64Array(n),f=e.Math.imul,p=e.Math.fround,m=e.Math.abs,v=e.Math.clz32,h=e.Math.min,S=e.Math.max,y=e.Math.floor,C=e.Math.ceil,G=e.Math.sqrt,g0=r.abort,E=e.NaN,I=e.Infinity,F=r.Base_LocaleIsNumeral,w=r.Base_LocaleGetOrdinal,B=r.Base_LocaleDecimalSeparator,k=r.Math_log10,x=r.Math_log,G=r.Math_sqrt,H=r.Math_sin,L=r.Math_cos,D=r.Math_tan,U=r.Math_atan,V=r.Math_exp,ne=r.proc_exit,J=20112,$=3716,Z=0;function ie(){}function X(){return 3104}function Q(){return 255}function b(q,ae,oe){e:{if(q>>>0<=ae>>>0){if(!oe)break e;for(;a[q|0]=t[ae|0],q=q+1|0,ae=ae+1|0,oe=oe+-1|0,!!oe;);break e}if(!oe)break e;for(q=q+oe|0,ae=ae+oe|0;q=q+-1|0,ae=ae+-1|0,a[q|0]=t[ae|0],oe=oe+-1|0,!!oe;);}}function R(q,ae){return q=q|0,ae=ae|0,(F(ae|0)|0)!=0|0}function P(q,ae){return q=q|0,ae=ae|0,w(ae|0)|0}function A(q){return q=q|0,B()|0}function T(q,ae,oe){return q=q|0,ae=ae|0,oe=oe|0,qW(q,ae,(oe|0)!=0)|0}function g(q,ae,oe,re,te){return q=+q,ae=ae|0,oe=oe|0,re=re|0,te=te|0,oe=f(oe,20)+3616|0,o[oe>>1]=0,ae=MN(oe,q,ae,(re|0)!=0,(te|0)!=0),u[922]=0,ae|0}function O(q){return q=q|0,o[f(q,20)+3616>>1]}function M(q){return q=q|0,o[f(q,20)+3618>>1]}function K(q){return q=q|0,u[f(q,20)+3620>>2]}function W(q){return q=q|0,o[f(q,20)+3624>>1]}function z(q){return q=q|0,o[f(q,20)+3626>>1]}function ee(q){return q=q|0,o[f(q,20)+3628>>1]}function ue(q){return q=q|0,o[f(q,20)+3630>>1]}function ce(q){return q=q|0,o[f(q,20)+3632>>1]}function he(q){return q=q|0,o[f(q,20)+3634>>1]}function de(q,ae,oe,re,te,ge,Te,Je,Xe,yr){q=q|0,ae=ae|0,oe=oe|0,re=re|0,te=te|0,ge=ge|0,Te=Te|0,Je=Je|0,Xe=Xe|0,yr=yr|0,yr=f(yr,20),o[yr+3634>>1]=Xe,o[yr+3632>>1]=Je,o[yr+3630>>1]=Te,o[yr+3628>>1]=ge,o[yr+3626>>1]=te,o[yr+3624>>1]=re,u[yr+3620>>2]=oe,o[yr+3618>>1]=ae,o[yr+3616>>1]=q}function pe(q,ae,oe){return q=q|0,ae=ae|0,oe=oe|0,u[920]=0,u[921]=0,BW(f(q,20)+3616|0,(ae|0)!=0,(oe|0)!=0),+l[460]}function _e(q,ae,oe,re,te){return q=q|0,ae=ae|0,oe=oe|0,re=re|0,te=te|0,u[920]=0,u[921]=0,pI(f(q,20)+3616|0,(ae|0)!=0,(oe|0)!=0,+(te|0),re),+l[460]}function Ce(){return u[919]}function Ne(q,ae,oe){return q=q|0,ae=ae|0,oe=oe|0,x_(f(q,20)+3616|0,(ae|0)!=0,(oe|0)!=0,3676)|0}function Le(q,ae,oe){return q=+q,ae=ae|0,oe=oe|0,wN(q,ae,oe),+l[460]}function Oe(q,ae,oe,re,te,ge,Te,Je){q=q|0,ae=ae|0,oe=oe|0,re=re|0,te=te|0,ge=ge|0,Te=Te|0,Je=Je|0;var Xe=0;return Xe=J-32|0,J=Xe,u[Xe+24>>2]=ge,u[Xe+16>>2]=re,u[Xe+8>>2]=ae,u[Xe+20>>2]=(te|0)>-1?f(te,20)+3616|0:0,u[Xe+12>>2]=(oe|0)>-1?f(oe,20)+3616|0:0,q=UW(f(q,20)+3616|0,(Te|0)!=0,(Je|0)!=0,Xe+8|0),J=Xe+32|0,q|0}function le(){return+l[375]}function me(){return+l[374]}function Pe(){return+l[370]}function Re(q,ae){return q=+q,ae=+ae,+Vy(q,ae)}function fe(q,ae){return q=+q,ae=+ae,+xS(q,ae)}function Se(q,ae){return q=+q,ae=+ae,+Ky(q,ae)}function be(q,ae){return q=+q,ae=+ae,+SI(q,ae)}function xe(q,ae){return q=+q,ae=+ae,+w_(q,ae)}function Ie(q){q=+q;var ae=0,oe=0;return ra(+q),ae=Hr(1)|0,Hr(0)|0,oe=ae&-65536,oe?(ae&2146435072)==2146435072?(u[922]=1,0):((oe|0)<1?-1:1)|0:0}function Ve(q,ae){q=+q,ae=+ae;var oe=0,re=0,te=0,ge=0,Te=0,Je=0,Xe=0;ra(+q),oe=Hr(1)|0,ge=Hr(0)|0,Te=oe,Xe=oe,ra(+ae),Je=Hr(1)|0,oe=Hr(0)|0,re=Je,te=-1;e:{r:{if((Te|0)<(re|0)||(te=1,(Xe|0)>(re|0)))break r;if(re=0,(oe|0)==(ge|0))break e;te=ge>>>0<oe>>>0?-1:1}oe=te,re=(Je&Te)>-1?oe:0-oe|0}return re|0}function Ze(){var q=0;return q=u[922],u[922]=0,q|0}function gr(q){return q=+q,+mI(q)}function cr(q){return q=+q,l[460]=q,hI(),+l[460]}function _r(q){return q=+q,l[460]=q,vI(),+l[460]}function xr(q){q=+q;var ae=0,oe=0;return ra(+q),ae=Hr(1)|0,oe=Hr(0)|0,ae=ae&2147483647,$l(0,oe|0),$l(1,ae|0),+zh()}function Or(q){q=+q;var ae=0,oe=0,re=0,te=0,ge=0,Te=0;return ra(+q),ae=Hr(1)|0,oe=Hr(0)|0,re=ae^-2147483648,$l(0,oe|0),$l(1,re|0),te=+zh(),ge=q,Te=(ae|0)==65535&oe>>>0>4294967295|ae>>>0>65535,+(Te?te:ge)}function Rr(q){return q=q|0,+(q>>>0)}function ir(q){return q=q|0,+(q|0)}function $e(q){return q=+q,ng(q)|0}function qe(q){return q=+q,yI(q)|0}function fr(q){return q=+q,l[460]=q,wS()|0}function lr(q,ae){return q=+q,ae=+ae,+Uy(q,ae)}function dn(q,ae){return q=+q,ae=+ae,+qy(q,ae)}function Un(q,ae){q=+q,ae=+ae;var oe=0;return q=jf(q,ae),ra(+q),oe=Hr(1)|0,Hr(0)|0,(oe&2146435072)==2146435072&&(u[922]=1,q=-1),+q}function Gr(q){return q=q|0,bh(q),+l[460]}function Br(q,ae){return q=+q,ae=+ae,+(IS(q,ae)|0)}function bt(q){q=+q;var ae=0;return ra(+q),ae=Hr(1)|0,Hr(0)|0,ae&2146435072}function Kr(q,ae){q=+q,ae=+ae;var oe=0,re=0,te=0;return ra(+q),oe=Hr(1)|0,re=Hr(0)|0,ra(+ae),te=Hr(1)|0,(re|0)==(Hr(0)|0)?oe=(oe|0)==(te|0):oe=0,oe|0}function Pt(q){q=+q;var ae=0;return ra(+q),ae=Hr(1)|0,Hr(0)|0,(ae&2146435072)==2146435072?(u[922]=1,-1):+ev(q)}function Mi(q){return q=+q,l[460]=q,xN(),+l[460]}function El(q){return q=+q,l[460]=q,Wy(),+l[460]}function Nl(q){return q=+q,l[460]=q,Hf(),+l[460]}function ys(q){return q=+q,l[460]=q,fb(),+l[460]}function _d(q){return q=+q,l[460]=q,CI(),+l[460]}function xu(q){return q=+q,l[460]=q,_I(),+l[460]}function pi(q){return q=+q,l[460]=q,tg(),+l[460]}function xa(q){return q=+q,+MS(q,0)}function $i(q){return q=+q,+MS(q,1)}function $o(q){return q=+q,l[460]=q,mb(),+l[460]}function ar(q,ae){return q=+q,ae=+ae,+cb(q,ae)}function ye(q,ae){q=+q,ae=ae|0;var oe=0,re=0,te=0,ge=0,Te=0;if(ra(+q),te=Hr(1)|0,Te=Hr(0)|0,(te&2146435072)==2146435072)return u[922]=1,-1;l[460]=q,re=te,ge=re&-65536,oe=3104;e:{if(!ge)break e;if((re&2146435072)==2146435072){u[922]=1,oe=3104;break e}if(oe=3104,(ge|0)>0||(re>>>0>=65536&&(u[921]=re^-2147483648),oe=3104,!Te&(te|0)==-2147483648))break e;o[1552]=45,oe=3106}return re=oe,ae=(ae|0)<255?ae:255,ae=gI(u[256],re,3614-re>>1,(ae|0)>0?ae:0),u[920]=0,u[921]=0,ae-3104>>1}function Rd(){return u[924]}function Ji(){return u[925]}function By(q,ae,oe){q=+q,ae=ae|0,oe=oe|0;var re=0,te=0,ge=0;re=J+-64|0,J=re,ra(+q),te=Hr(1)|0,Hr(0)|0;e:{if((te&2146435072)==2146435072){u[922]=1,oe=-1;break e}u[re+56>>2]=0,o[re+46>>1]=0,o[re+48>>1]=0,te=ae+oe|0,LS(q,re+56|0,re+16|0,te>>>0<15?te:15),ge=o[re+56>>1],te=o[re+58>>1],u[re+8>>2]=te,ae=ae+ge|0,u[re+12>>2]=ae,ae=ae+oe|0,(ae|0)<(te|0)&&(DS(re+16|0,re+12|0,re+8|0,ae),te=u[re+8>>2]);r:{if(!te){te=0,u[re+12>>2]=0,ae=0;break r}if(ae=u[re+12>>2],oe=oe+ae|0,(oe|0)<(te|0)&&(u[re+8>>2]=oe,te=oe),(te|0)>-1)break r;u[922]=1}u[924]=ae,u[925]=d[re+48>>1]>>>15^1,oe=te,te>>>0>=256&&(g0(),oe=u[re+8>>2]),b(3104,re+16|0,te<<1)}return J=re- -64|0,oe|0}function nr(q,ae,oe){q=+q,ae=ae|0,oe=oe|0;var re=0,te=0,ge=0,Te=0;te=J+-64|0,J=te,ra(+q),ge=Hr(1)|0,Hr(0)|0;e:{if((ge&2146435072)==2146435072){u[922]=1,re=-1;break e}u[te+56>>2]=0,o[te+46>>1]=0,o[te+48>>1]=0,LS(q,te+56|0,te+16|0,15),Te=o[te+56>>1],u[te+12>>2]=Te,ge=o[te+58>>1],u[te+8>>2]=ge,re=ae,(re|0)>=2&&(re=(Te|0)%(ae|0)|0,re=((Te|0)<1?ae:re?0:ae)+re|0),re=oe+re|0;r:{if((re|0)>=(ge|0))break r;for(DS(te+16|0,te+12|0,te+8|0,re),ge=u[te+8>>2],re=(re|0)<(ge|0)?re:ge;ge=re,(re|0)>=1&&(re=ge+-1|0,d[(te+16|0)+(re<<1)>>1]==48););if(u[te+8>>2]=ge,(ae|0)<2||(re=u[te+12>>2],(re|0)==(Te|0))||(Te=oe,oe=(re|0)%(ae|0)|0,((Te+oe|0)+((re|0)<1?ae:oe?0:ae)|0)>=(ge|0)))break r;g0(),ge=u[te+8>>2]}(ge|0)<=-1&&(u[922]=1),u[924]=u[te+12>>2],u[925]=d[te+48>>1]>>>15^1,re=ge,re>>>0>=256&&(g0(),re=u[te+8>>2]),b(3104,te+16|0,ge<<1)}return J=te- -64|0,re|0}function Rn(q,ae,oe){q=q|0,ae=ae|0,oe=oe|0;var re=0;return re=J-48|0,J=re,a[re+39|0]=0,oe=(oe|0)<15?oe:15,b(re+8|0,3104,oe<<1),o[re+40>>1]=ae+16384&32767|!q<<15,a[re+38|0]=oe,u[re>>2]=0,u[re+4>>2]=0,gb(u[256],re,re+8|0)&&(u[922]=1),J=re+48|0,+l[re>>3]}function IS(q,ae){var oe=0,re=0,te=0,ge=0,Te=0,Je=0;re=J-16|0,J=re,l[re+8>>3]=q,l[re>>3]=ae,ra(+q),oe=Hr(1)|0,te=Hr(0)|0,ge=oe,ra(+ae),oe=Hr(1)|0,Te=Hr(0)|0,Je=oe;e:{if(!((te|0)==(Te|0)&&(ge|0)==(oe|0))){if((Je+2097152&2146435072)-(ge&2146435072)>>>0<=5242879&&(q=ev(q),l[re+8>>3]=q,ra(+q),oe=Hr(1)|0,Hr(0)|0,ge=oe,q=ev(ae),l[re>>3]=q,ra(+q),oe=Hr(1)|0,Hr(0)|0,Je=oe),oe=1,te=(Je&ge)>-1,Te=te?re+8|0:re,ge=u[Te+4>>2],te=te?re:re+8|0,Je=u[te+4>>2],(ge|0)>(Je|0))break e;if((ge|0)<(Je|0)){oe=-1;break e}if(Te=u[Te>>2],te=u[te>>2],Te>>>0>te>>>0||(oe=-1,Te>>>0<te>>>0))break e}oe=0}return J=re+16|0,oe}function jf(q,ae){var oe=0,re=0,te=0,ge=0,Te=0,Je=0;if(te=3680,oe=J-48|0,J=oe,u[oe+40>>2]=0,o[oe+30>>1]=0,o[oe+32>>1]=0,l[460]=q,ge=ev(q),l[460]=ge,LS(ge,oe+40|0,oe,15),d[oe+42>>1]){re=ng(ae)<<16,re=(re|0)<0?100:re>>16,ra(+ae),Te=Hr(1)|0,Hr(0)|0,Je=Te&-65536;e:{if(!Je)break e;if((Te&2146435072)==2146435072){u[922]=1;break e}re=(Je|0)<1?0-re|0:re}re=o[oe+40>>1]+re|0;e:{r:{if((re|0)>=o[oe+42>>1])break r;if((re|0)<1){te=3e3;break e}if((re&255)>>>0>=t[oe+30|0])break r;a[oe+30|0]=re}gb(3100,3680,oe)}q=l[te>>3]}return J=oe+48|0,q}function qy(q,ae){var oe=0,re=0,te=0,ge=0,Te=0;ra(+q),oe=Hr(1)|0,Hr(0)|0,re=oe&-65536;e:{if(!re)break e;if((oe&2146435072)==2146435072){u[922]=1;break e}Te=(re|0)<1?-1:1}if(te=jf(q,ae),l[460]=q,l[460]=ev(q),ps(te),oe=u[921],oe>>>0>=65536){if((oe&2146435072)==2146435072)return u[922]=1,te;oe=ng(ae)<<16,oe=(oe|0)<0?309:oe>>16,ra(+ae),re=Hr(1)|0,Hr(0)|0,ge=re&-65536;e:{if(!ge)break e;if((re&2146435072)==2146435072){u[922]=1;break e}oe=(ge|0)<1?0-oe|0:oe}if((oe|0)<=-309)return Th(8),0;bh(0-oe|0);e:{if((Te|0)>-1||(oe=u[921],oe>>>0<65536))break e;u[921]=oe^-2147483648}sl(te),te=l[460]}return te}function Uy(q,ae){var oe=0,re=0,te=0,ge=0,Te=0;oe=J+-64|0,J=oe,u[oe+56>>2]=0,o[oe+46>>1]=0,o[oe+48>>1]=0,l[460]=q,ra(+q),re=Hr(1)|0,Hr(0)|0,te=re&-65536;e:{if(!te)break e;if((re&2146435072)==2146435072){u[922]=1;break e}r:{if((te|0)>0||(Te=32768,re>>>0<65536))break r;u[921]=re^-2147483648,q=l[460]}LS(q,oe+56|0,oe+16|0,15),d[oe+58>>1]||(o[oe+56>>1]=1),l[460]=ae,re=wS(),re=(re|0)<0?100:re;r:{te=u[921],ge=te&-65536;n:{if(!ge)break n;if((te&2146435072)==2146435072){u[922]=1;break n}if((ge|0)>0)break n;if(re=u[921],re>>>0>=65536&&(u[921]=re^-2147483648),re=wS(),(re|0)<=-1)break r;re=0-re|0}te=o[oe+56>>1],ge=re+te|0,re=o[oe+58>>1],(ge|0)<(re|0)&&(u[oe+12>>2]=re,u[oe+8>>2]=te,DS(oe+16|0,oe+8|0,oe+12|0,ge),re=u[oe+12>>2],o[oe+58>>1]=re,te=u[oe+8>>2],o[oe+56>>1]=te),a[oe+46|0]=re,o[oe+48>>1]=te+16384&32767|Te,gb(3100,3680,oe+16|0),q=l[460];break e}q=l[375]}return J=oe- -64|0,q}function MS(q,ae){var oe=0,re=0,te=0,ge=0;l[460]=q,ra(+q),re=Hr(1)|0,Hr(0)|0,te=re,oe=te&-65536,re=0;e:{if(!oe)break e;if((te&2146435072)==2146435072){u[922]=1,re=0;break e}re=(oe|0)<1}u[921]=te&2147483647,ps(l[374]);e:{if(te=u[921],oe=te&-65536,!oe)break e;if((te&2146435072)==2146435072){u[922]=1;break e}if((oe|0)<1)break e;return Th(8),0}ge=Ky(l[374],q),l[460]=Ky(l[372],ge),bd(ge),xN();e:{r:{if(oe=u[921],oe>>>0>=65536){if((oe&2146435072)!=2146435072)break r;u[922]=1}if(ae){if(u[920]=0,u[921]=0,!re)break e;return ae=u[741],u[920]=u[740],u[921]=ae,l[460]}if(oe=u[747],u[920]=u[746],u[921]=oe,ae=oe,re^1|oe>>>0<65536)break e;return u[921]=ae^-2147483648,l[460]}if(BS(q),mb(),!ae)break e;l[460]=Ky(l[373],l[460])}return l[460]}function cb(q,ae){var oe=0,re=0,te=0,ge=0,Te=0,Je=0,Xe=0;l[460]=q;e:{if(ra(+q),oe=Hr(1)|0,Hr(0)|0,oe>>>0>=65536){if((oe&2146435072)!=2146435072)break e;u[922]=1}l[460]=ae;r:{if(ra(+ae),oe=Hr(1)|0,Hr(0)|0,re=oe&-65536,re){if((oe&2146435072)!=2146435072)break r;u[922]=1}return Th(4),0}return Pd((re|0)<1?-1:1),bd(l[370]),ef(l[372]),l[460]}e:{if((oe|0)<=-1){ra(+ae),oe=Hr(1)|0,Hr(0)|0;r:{re=oe&-65536;n:{if(!re)break n;if((oe&2146435072)==2146435072){u[922]=1;break n}if((re|0)<1)break r}te=l[370];break e}te=l[370],ra(+te),oe=Hr(1)|0,re=Hr(0)|0,ge=oe^-2147483648,$l(0,re|0),$l(1,ge|0),te=(Te=+zh(),Je=te,Xe=(oe|0)==65535&re>>>0>4294967295|oe>>>0>65535,Xe?Te:Je);break e}te=l[375]}return jy(ae,q),mb(),sl(te),l[460]}function db(q,ae){return q=q|0,ae=ae|0,ae+-48|0}function w_(q,ae){var oe=0,re=0,te=0,ge=0;l[460]=ae,ra(+ae),oe=Hr(1)|0,Hr(0)|0,te=oe,u[921]=oe&2147483647,ae=l[460];e:{ra(+LN(l[371])),oe=Hr(1)|0,re=Hr(0)|0;r:{if((oe|0)==65535&re>>>0<=4294967295|oe>>>0<65535){l[460]=q,xN();break r}m0(),ra(+LN(ae)),oe=Hr(1)|0,re=Hr(0)|0;n:{if((oe|0)==65535&re>>>0>4294967295|oe>>>0>65535||(oe=rv(),(oe|0)==-1))break n;l[460]=q,GW(oe);break r}if(l[460]=q,ra(+q),re=Hr(1)|0,Hr(0)|0,oe=re,re=oe>>>16<<16,(re|0)>=1){Hf(),bd(ae),Wy();break r}if((re|0)>-1)break r;if(jy(l[374],ae),ge=ev(l[460]),l[460]=ge,m0(),ra(+LN(ge)),re=Hr(1)|0,(re|0)==65535&Hr(0)>>>0>4294967295|re>>>0>65535||(re=pb(),(re|0)==2147483647|!(re&1)))break e;if(l[460]=q,u[921]=oe&2147483647,Hf(),bd(ae),Wy(),oe=u[921],oe>>>0<65536)break r;u[921]=oe^-2147483648}if(te>>>16<<16>>16<=-1){if(te=u[922],te&1)return u[920]=0,u[921]=0,u[922]=te&-2,l[460];BS(l[374])}return l[460]}return u[922]=8,l[460]}function D_(q,ae,oe){var re=0,te=0,ge=0,Te=0,Je=0,Xe=0,yr=0,Nn=0,on=0,nt=0,Qa=0,ju=0,Ls=0;if(re=J-96|0,J=re,u[re+64>>2]=o[ae>>1],u[re+68>>2]=o[ae+2>>1],u[re+72>>2]=u[ae+4>>2],u[re+76>>2]=o[ae+8>>1],u[re+80>>2]=o[ae+10>>1],u[re+84>>2]=o[ae+12>>1],u[re+92>>2]=o[ae+14>>1]+-1,te=o[ae+18>>1],te>>>0<=3){e:{r:switch(te-1|0){case 0:te=f(o[ae+16>>1],100);break e;case 1:te=f(o[ae+16>>1],10);break e;case 2:break r;default:break e}te=o[ae+16>>1]}u[re+88>>2]=te}ae=0;e:{if(!Ut(re- -64|0,re+40|0))break e;Te=f(u[q>>2],60),Te=Be(Te,Te>>31,1e7,0),Xe=Z,ge=u[q+4>>2];r:{if(!ge||(Je=u[q+12>>2],!Je))break r;if(u[re+64>>2]=o[ge>>1],u[re+68>>2]=o[ge+2>>1],u[re+72>>2]=u[ge+4>>2],u[re+76>>2]=o[ge+8>>1],u[re+80>>2]=o[ge+10>>1],u[re+84>>2]=o[ge+12>>1],u[re+92>>2]=o[ge+14>>1]+-1,te=o[ge+18>>1],te>>>0<=3){n:{t:switch(te-1|0){case 0:te=f(o[ge+16>>1],100);break n;case 1:te=f(o[ge+16>>1],10);break n;case 2:break t;default:break n}te=o[ge+16>>1]}u[re+88>>2]=te}if(u[re+8>>2]=o[Je>>1],u[re+12>>2]=o[Je+2>>1],u[re+16>>2]=u[Je+4>>2],u[re+20>>2]=o[Je+8>>1],u[re+24>>2]=o[Je+10>>1],u[re+28>>2]=o[Je+12>>1],u[re+36>>2]=o[Je+14>>1]+-1,te=o[Je+18>>1],te>>>0<=3){n:{t:switch(te-1|0){case 0:te=f(o[Je+16>>1],100);break n;case 1:te=f(o[Je+16>>1],10);break n;case 2:break t;default:break n}te=o[Je+16>>1]}u[re+32>>2]=te}if(ge=u[re+44>>2],Je=ge,te=u[re+40>>2],!Td(re- -64|0,re+56|0,te,ge)||!Td(re+8|0,re+48|0,te,Je))break e;nt=u[re+40>>2],Nn=u[re+44>>2],Qa=Te,ju=q+16|0,Ls=q+8|0,Je=Xe,on=Je+u[re+52>>2]|0,te=Te,yr=te+u[re+48>>2]|0,yr>>>0<te>>>0&&(on=on+1|0),ge=yr,te=f(u[q+8>>2],60),yr=Be(te,te>>31,1e7,0),ge=ge+yr|0,te=Z+on|0,on=ge,te=ge>>>0<yr>>>0?te+1|0:te,yr=te,ge=Xe+u[re+60>>2]|0,Xe=Te+u[re+56>>2]|0,Xe>>>0<Te>>>0&&(ge=ge+1|0),q=f(u[q+16>>2],60),Te=Be(q,q>>31,1e7,0),Xe=Te+Xe|0,q=Z+ge|0,q=Xe>>>0<Te>>>0?q+1|0:q,Te=Xe;n:{if((te|0)<(q|0)||(te|0)<=(q|0)&&!(on>>>0>=Te>>>0)&&1){q=((Nn|0)<(q|0)?1:(Nn|0)<=(q|0)?nt>>>0>=Te>>>0?0:1:0)&((Nn|0)>(yr|0)?1:(Nn|0)>=(yr|0)?nt>>>0<on>>>0?0:1:0);break n}q=((Nn|0)<(q|0)?1:(Nn|0)<=(q|0)?nt>>>0>=Te>>>0?0:1:0)|((Nn|0)>(yr|0)?1:(Nn|0)>=(yr|0)?nt>>>0<on>>>0?0:1:0)}q=f(u[(q?ju:Ls)>>2],60),q=Be(q,q>>31,1e7,0),Te=Qa+q|0,te=Z+Je|0,te=Te>>>0<q>>>0?te+1|0:te,Xe=te}if(q=u[re+40>>2],te=u[re+44>>2]-(Xe+(q>>>0<Te>>>0)|0)|0,Te=q-Te|0,q=te,(q|0)<0||(q|0)<=0&&!(Te>>>0>=0)&&1)break e;DN(Te,q,re- -64|0),o[oe>>1]=u[re+64>>2],o[oe+2>>1]=u[re+68>>2],u[oe+4>>2]=u[re+72>>2],ae=1,o[oe+14>>1]=d[re+92>>1]+1,o[oe+8>>1]=u[re+76>>2],o[oe+10>>1]=u[re+80>>2],o[oe+12>>1]=u[re+84>>2],q=u[re+88>>2],o[oe+18>>1]=3,o[oe+16>>1]=q}return J=re+96|0,ae}function MN(q,ae,oe,re,te){var ge=0,Te=0,Je=0,Xe=0,yr=0,Nn=0,on=0,nt=0,Qa=0;e:{if(d[q>>1])break e;l[460]=ae,ra(+ae),ge=Hr(1)|0,Je=Hr(0)|0;r:{if(Nn=ge,Qa=ge&-65536,!Qa)break r;if((ge&2146435072)==2146435072){u[922]=1;break r}if((Qa|0)>=1)break r;return-2147467259}yr=u[770],on=u[771],Te=on,Xe=-1;r:{n:{if((ge|0)<(Te|0)||(Xe=1,(ge|0)>(Te|0)))break n;if(Te=Je,(yr|0)==(Te|0))break r;Xe=Te>>>0<yr>>>0?-1:1}if(Te=-2147467259,(((Nn&on)>-1?Xe:0-Xe|0)|0)==1)break e}r:{yr=u[772],Te=u[773],on=Te,Xe=-1;n:{if((ge|0)<(Te|0)||(Xe=1,(ge|0)>(on|0)))break n;if((Je|0)==(yr|0))break r;Xe=Je>>>0<yr>>>0?-1:1}if(yr=Xe,(((Te&Nn)>-1?yr:0-yr|0)|0)!=-1)break r;return-2147467259}r:{n:{t:{if(te|!Qa)break t;if((ge&2146435072)==2146435072){u[922]=1;break t}if((Qa|0)<1)break n}sl(l[u[(oe<<2)+1056>>2]>>3]),nt=l[460];break r}vI(),ps(ae),Nn=u[921],Je=Nn,ge=u[920],$l(0,ge|0),$l(1,Je|0),nt=+zh();n:{if(u[750]==(ge|0)&&u[751]==(Je|0)||(Te=u[921],Te>>>0<65536))break n;u[921]=Te^-2147483648,nt=l[460],ra(+nt),Je=Hr(1)|0,ge=Hr(0)|0}Nn=Je,yr=Je,Je=u[(oe<<2)+1056>>2],on=u[Je+4>>2],Te=u[Je>>2],Je=on,Xe=-1;n:{t:{if((yr|0)<(Je|0)||(Xe=1,(yr|0)>(Je|0)))break t;if((ge|0)==(Te|0)){l[460]=ae;break n}Xe=ge>>>0<Te>>>0?-1:1}if(yr=Xe,l[460]=ae,(((Nn&on)>-1?yr:0-yr|0)|0)==-1)break r}ps(l[374])}if(o[q+18>>1]=oe,ge=pb(),Te=-2147467259,Th(0))break e;r:{if(re){if((ge|0)>2957003)break e;ge=ge+1462|0;break r}if(ge+4346018>>>0>7304483)break e}o[q+14>>1]=((ge+6|0)%7|0)+1;r:{if(!(!te|ge)){u[q>>2]=67436;break r}if(!ge){u[q>>2]=788331,re=30;break r}n:{if((ge|0)<=-1){re=(ge^-1)/1461|0,Je=-4-(re<<2)|0,Te=(f(re,1461)+ge|0)+1461|0;break n}re=(ge+-1|0)/1461|0,Je=re<<2,Te=f(re,-1461)+ge|0}n:{if(te&&(Je|0)<=199)break n;if(re=Je+-101|0,Te=(((re|0)/100|0)-((re|0)/400|0)|0)+Te|0,(Te|0)>=1462){re=Je+1900|0,ge=re&3;t:{if(te){if(ge|(Je|0)<200)break t;ge=!((re>>>0)%100)&((re>>>0)%400|0)!=0;break t}if(ge)break t;ge=!((re|0)%100)&((re|0)%400|0)!=0}Je=Je+4|0,Te=((f(ge,12)|0)==12?-1460:-1461)+Te|0;break n}if((Te|0)>0)break n;Je=Je+-4|0,Te=Te+1461|0}re=Je+1900|0,ge=re&3;n:{if(te){if(ge|(Je|0)<200)break n;ge=!((re>>>0)%100)&((re>>>0)%400|0)!=0;break n}if(ge)break n;ge=!((re|0)%100)&((re|0)%400|0)!=0}for(Nn=f(ge,12),ge=Nn;te=ge,ge=ge+1|0,re=Te,Te=re-t[te+1072|0]|0,(Te|0)>0;);Te=te,te=te+-11|0,te=(Te-((Nn|0)<(te|0)?Nn:te)>>>0)/12|0,o[q>>1]=(te+Je|0)+1900,o[q+2>>1]=(f(te,-12)+ge|0)-Nn}if(u[q+4>>2]=re,l[460]=nt,m0(),re=u[921],re>>>0>=65536&&(u[921]=re^-2147483648),sl(nt),bd(l[379]),ae=l[460],re=rv(),o[q+8>>1]=re,Ph(re<<16>>16),re=u[921],re>>>0>=65536&&(u[921]=re^-2147483648),sl(ae),bd(l[380]),ae=l[460],re=rv(),o[q+10>>1]=re,Ph(re<<16>>16),re=u[921],re>>>0>=65536&&(u[921]=re^-2147483648),sl(ae),bd(l[380]),!oe)return oe=rv(),o[q+16>>1]=0,o[q+12>>1]=oe,0;ae=l[460],re=rv(),o[q+12>>1]=re,Ph(re<<16>>16),re=u[921],re>>>0>=65536&&(u[921]=re^-2147483648),sl(ae),bd(l[u[(oe<<2)+1152>>2]>>3]),l[460]=ev(l[460]),o[q+16>>1]=rv(),Te=0}return Te}function wN(q,ae,oe){l[460]=q,sl(l[u[(oe<<2)+1056>>2]>>3]);e:{r:{if(ae>>>0<=1){if(ae-1)break e;break r}bd(l[380])}bd(l[380])}bd(l[379]),m0()}function x_(q,ae,oe,re){var te=0,ge=0,Te=0,Je=0,Xe=0,yr=0,Nn=0,on=0;te=u[q+4>>2],yr=-2146827284,ge=d[q>>1],Te=o[q+2>>1];e:{if((Te|0)>=1){q=(Te+-1|0)/12|0;break e}q=(Te|0)/-12^-1}Je=ge+q<<16>>16;e:{if((Je|0)>9999|((oe?1900:-9999)+(ae?4:0)|0)>(Je|0)||(Te=Te+f(q,-12)<<16>>16,(Te+-1&65535)>>>0>11|(!te|(Je|0)==1900&(Te|0)==2&(te|0)==29?!oe:0)))break e;if(ge=Je+1e4|0,Xe=(ge|0)/4|0,q=Xe<<2,Nn=(q|0)%100|0,on=(q|0)%400|0,Xe=f(Xe,1461)+te|0,te=q+-1|0,te=((Xe+((te|0)/-100|0)|0)+((te|0)/400|0)|0)+-1|0,ge=(f(ge-q|0,12)+Te|0)+-1|0,ge)for(q=on?Nn?0:12:0,ge=ge+q|0;te=t[q+1072|0]+te|0,q=q+1|0,(ge|0)!=(q|0););r:{if(!(!oe&&!ae)){if(q=te+-4346385|0,!((Je|0)>1900|(Te|0)>=3))break r;q=te+-4346384|0;break r}q=te+-4346384|0}if(q>>>0>2958465)break e;u[re>>2]=q,yr=0}return yr}function pI(q,ae,oe,re,te){var ge=0,Te=0;Te=J-16|0,J=Te;e:{r:{n:{if((d[q+2>>1]+-32767&65535)>>>0>1){t:{if(o[q+18>>1]>=1){if(Pd(o[q+16>>1]),ef(l[u[(o[q+18>>1]<<2)+1152>>2]>>3]),ge=l[460],(te|0)==2){l[460]=re,sl(ge);break t}Pd(o[q+12>>1]),sl(ge);break t}if((te|0)==2){l[460]=re;break t}Pd(o[q+12>>1])}ef(l[380]),ge=l[460];t:{if((te|0)==1){l[460]=re;break t}Pd(o[q+10>>1])}sl(ge),ef(l[380]),ge=l[460];t:{if(!te){l[460]=re;break t}Pd(o[q+8>>1])}sl(ge),ef(l[379]),re=l[460];t:{if((x_(q,ae,oe,Te+12|0)|0)<0)break t;if(q=u[Te+12>>2],!ae)break n;if(Pd(q+-1462|0),(q|0)<1462)break t;if(q=u[921],ae=q&-65536,!ae)break r;if((q&2146435072)==2146435072){u[922]=1;break r}if((ae|0)>=1)break r}u[920]=0,u[921]=0}u[920]=0,u[921]=0,Th(8);break e}Ph(q)}sl(re)}J=Te+16|0}function BW(q,ae,oe){var re=0,te=0;te=J-16|0,J=te;e:{r:{n:{if((d[q+2>>1]+-32767&65535)>>>0>1){t:{if(o[q+18>>1]>=1){Pd(o[q+16>>1]),re=vb(l[u[(o[q+18>>1]<<2)+1152>>2]>>3]),Pd(o[q+12>>1]),sl(re);break t}Pd(o[q+12>>1])}re=vb(l[380]),Pd(o[q+10>>1]),sl(re),re=vb(l[380]),Pd(o[q+8>>1]),sl(re),re=vb(l[379]);t:{if((x_(q,ae,oe,te+12|0)|0)<0)break t;if(q=u[te+12>>2],!ae)break n;if(Pd(q+-1462|0),(q|0)<1462)break t;if(q=u[921],ae=q&-65536,!ae)break r;if((q&2146435072)==2146435072){u[922]=1;break r}if((ae|0)>=1)break r}u[920]=0,u[921]=0}u[920]=0,u[921]=0,Th(8);break e}Ph(q)}sl(re)}J=te+16|0}function qW(q,ae,oe){var re=0;re=ae&3;e:{if(oe){if(re|(ae|0)<2100)break e;re=!((ae>>>0)%100)&((ae>>>0)%400|0)!=0;break e}if(re)break e;re=!((ae|0)%100)&((ae|0)%400|0)!=0}return t[(((f(re,12)+q|0)+-1|0)%48|0)+1072|0]}function UW(q,ae,oe,re){var te=0,ge=0;if(te=J-32|0,J=te,D_(re,q,te+8|0)){re=u[te+12>>2],u[q>>2]=u[te+8>>2],u[q+4>>2]=re,u[q+16>>2]=u[te+24>>2],re=u[te+20>>2],u[q+8>>2]=u[te+16>>2],u[q+12>>2]=re,re=q;e:{if((x_(q,ae,oe,te+28|0)|0)>=0){q=((u[te+28>>2]+6|0)%7|0)+1|0;break e}u[te+28>>2]=-1,q=6}o[re+14>>1]=q,ge=1}return J=te+32|0,ge}function DN(q,ae,oe){var re=0,te=0,ge=0,Te=0,Je=0,Xe=0;ge=er(q,ae,711573504,201),te=ge,u[oe+28>>2]=(te+1>>>0)%7,Te=(te>>>0)/146097|0,re=te+f(Te,-146097)|0,Je=(f(re,100)+75>>>0)/3652425|0,Xe=f(Je,-36524)+re|0,re=(Xe>>>0)/1461|0,re=((f(Je,100)+f(Te,400)|0)+(re<<2)|0)+((f(Xe+f(re,-1461)|0,100)+75>>>0)/36525|0)|0,te=(((te+((re>>>0)/100|0)|0)-(re>>>2)|0)-((re>>>0)/400|0)|0)+f(re,-365)|0,ge=Be(ge,Z,-864e5,-1),q=er(q,ae,1e4,0)+ge|0,ae=re+1|0;e:{if(!(!((ae>>>0)%100)|ae&3&&(ae>>>0)%400|0)){ae=t[te+1168|0],ge=(ae<<1)+1536|0;break e}ae=t[te+1568|0],ge=(ae<<1)+1936|0}u[oe+12>>2]=(q>>>0)/36e5,u[oe+4>>2]=ae+1,u[oe>>2]=re+1601,ae=(q>>>0)/1e3|0,u[oe+20>>2]=(ae>>>0)%60,u[oe+16>>2]=((q>>>0)/6e4>>>0)%60,u[oe+24>>2]=q-f(ae,1e3),u[oe+8>>2]=(te-o[ge>>1]|0)+1}function Ut(q,ae){var oe=0,re=0,te=0,ge=0,Te=0,Je=0,Xe=0,yr=0,Nn=0,on=0,nt=0,Qa=0;ge=u[q+4>>2];e:{if((ge|0)<1||(yr=ge+-1|0,yr>>>0>11)||(oe=u[q>>2],re=oe+-1601|0,re>>>0>29226)||(Te=u[q+8>>2],(Te|0)<1))break e;Nn=u[q+24>>2],Je=oe&65535,te=1536;r:{if(!((Je>>>0)%400))break r;te=oe&3?1936:(Je>>>0)%100|0?1536:1936}if(Nn>>>0>999||(Je=u[q+20>>2],Je>>>0>59)||(on=u[q+16>>2],on>>>0>59)||(nt=u[q+12>>2],nt>>>0>23)||(Te=Te+-1|0,Te>>>0>=o[te+(ge<<1)>>1]-o[te+(yr<<1)>>1]>>>0))break e;te=re>>>2,ge=f(re,365),q=re&65535,re=(q>>>0)/400|0,Qa=(q>>>0)/100|0,oe=oe+-1600|0,Xe=oe&65535;r:{if((Xe>>>0)%400&&(q=1936,!((Xe>>>0)%100)|oe&3))break r;q=1536}Xe=1,oe=f(f(f(nt,60)+on|0,60)+Je|0,1e3)+Nn|0,q=o[(yr<<1)+q>>1]+(re+((Te+(ge+te|0)|0)-Qa|0)|0)|0,re=Be(q,q>>31,864e5,0),oe=oe+re|0,q=Z,u[ae>>2]=Be(oe,oe>>>0<re>>>0?q+1|0:q,1e4,0),u[ae+4>>2]=Z}return Xe}function Td(q,ae,oe,re){var te=0,ge=0,Te=0,Je=0,Xe=0;te=J-112|0,J=te,DN(oe,re,te+80|0);e:{r:{if(u[q>>2]){if(!Ut(q,ae))break e;break r}if(Te=u[q+8>>2],(Te|0)>5|!Te)break e;if(oe=u[q+4>>2],re=u[q+28>>2],ge=u[te+80>>2],u[te+56>>2]=1,u[te+52>>2]=oe,u[te+48>>2]=ge,u[te+60>>2]=u[q+12>>2],u[te+64>>2]=u[q+16>>2],u[te+68>>2]=u[q+20>>2],q=u[q+24>>2],u[te+76>>2]=0,u[te+72>>2]=q,!Ut(te+48|0,te+8|0)){ge=0;break e}q=re+8|0,oe=re+1|0,Je=(Te|0)<2,DN(u[te+8>>2],u[te+12>>2],te+16|0),Xe=te,ge=u[te+44>>2];n:{t:{if((re|0)<(ge|0)){q=q-ge|0;break t}if(q=1,(re|0)<=(ge|0))break n;q=oe-ge|0}u[Xe+56>>2]=q}n:{if(Je||(oe=q+7|0,u[te+56>>2]=oe,ge=1,!Ut(te+48|0,te+8|0)))break n;for(;;){if(DN(u[te+8>>2],u[te+12>>2],te+16|0),q=u[te+24>>2],ge=ge+1|0,(Te|0)==(ge|0))break n;if(oe=oe+7|0,u[te+56>>2]=oe,!Ut(te+48|0,te+8|0))break}}if(u[te+56>>2]=q,!Ut(te+48|0,te+8|0)){ge=0;break e}q=u[te+12>>2],u[ae>>2]=u[te+8>>2],u[ae+4>>2]=q}ge=1}return J=te+112|0,ge}function E4(q,ae,oe,re){var te=0,ge=0,Te=0,Je=0,Xe=0,yr=0,Nn=0,on=0,nt=0,Qa=0,ju=0,Ls=0;Je=J-16|0,J=Je,l[Je+8>>3]=q,ju=ae,ra(+q),ge=Hr(1)|0,Te=Hr(0)|0,te=ge,Xe=te,ge=te&2146435072;e:{if(!ge){a[oe+30|0]=0,o[oe+32>>1]=0,o[ae+2>>1]=0,ae=0;break e}if(yr=(ge>>>20)+-1022|0,ge=f(yr,39457)>>17,o[oe+32>>1]=ge+16385|te>>>16&32768,(re|0)<=14){if(re=(re+ge|0)+1|0,(re|0)<=-1){a[oe+30|0]=0,o[oe+32>>1]=0,o[ae+2>>1]=0,ae=0;break e}re=(re|0)<15?re:15}if(u[Je+8>>2]=Te<<11,u[Je+12>>2]=Xe<<11|Te>>>21|-2147483648,te=$g(Je+8|0,yr,ge^-1),(te|0)>=1)for(Te=oe+32|0;ge=d[Te>>1],o[Te>>1]=ge+1&32767|ge&32768,te=$g(Je+8|0,te,-1),(te|0)>0;);r:{if(!te){te=u[Je+8>>2],ge=u[Je+12>>2];break r}Te=u[Je+12>>2],Xe=0-te|0,ge=Te>>>Xe,u[Je+12>>2]=ge,te=Te<<te+32|u[Je+8>>2]>>>Xe,u[Je+8>>2]=te}Te=ge>>>0<(te>>>0<2576980377?429496730:429496729)>>>0?922:9223,te=Te+te|0,u[Je+8>>2]=te,te>>>0<Te>>>0&&(ge=ge+1|0,u[Je+12>>2]=ge);r:{if((re|0)<1){Te=oe;break r}for(Nn=te>>>16,on=d[Je+14>>1],nt=oe+32|0,Ls=(re|0)==15,Te=oe,Xe=1;;){yr=re;n:{t:{for(;;){if(re=f(Nn,10)+(f(te&65535,10)>>>16)>>>16,Qa=f(on,10)+(re+f(ge&65535,10)>>>16)>>>16|48,o[Te>>1]=Qa,ge=re+f(ge,10)|0,on=ge>>>16,te=f(te,10),Nn=te>>>16,(Xe^-1|(Qa|0)!=48)&1)break t;if(re=d[nt>>1],o[nt>>1]=re+-1&32767|re&32768,!Ls)break}Xe=1;break n}Te=Te+2|0,Xe=0}if(re=yr+-1|0,!((yr|0)>1))break}u[Je+12>>2]=ge,u[Je+8>>2]=te}re=Te-oe|0,te=re>>1;r:{if((re|0)<=29){if((ge|0)<=-1){o[Te>>1]=57,ge=te+1|0;break r}o[Te>>1]=48}for(;;){if(ge=te,(te|0)<1)break r;if(te=ge+-1|0,Te=Te+-2|0,d[Te>>1]!=48)break}}a[oe+30|0]=ge,o[ae+2>>1]=ge,ae=(d[oe+32>>1]&32767)+-16384|0}o[ju>>1]=ae,J=Je+16|0}function $g(q,ae,oe){var re=0,te=0,ge=0,Te=0,Je=0,Xe=0;re=J-16|0,J=re;e:{if(!oe||(Te=oe>>31,Te=Te+oe^Te,!Te))break e;for(oe=(oe|0)>0?1952:2448;;){if(te=Te&15,te){te=(te<<4)+oe|0,ge=o[te+8>>1],Xe=N4(l[q>>3],l[te>>3],re),ae=ae+ge|0;r:{if(o[re+14>>1]<=0){te=d[re+6>>1],ge=d[re+8>>1];break r}ge=u[re+4>>2],te=d[re+6>>1]<<1,o[re+6>>1]=te,Je=u[re+8>>2],u[re+12>>2]=u[re+12>>2]<<1|Je>>>31,ge=Je<<1|ge>>>31,u[re+8>>2]=ge,ae=ae+-1|0}r:{if((te&65535|(ge&1|(Xe|0)!=0))>>>0<32769||(te=u[re+8>>2],ge=te+1|0,u[re+8>>2]=ge,ge>>>0>=te>>>0)||(te=u[re+12>>2],ge=te+1|0,u[re+12>>2]=ge,ge>>>0>=te>>>0))break r;u[re+12>>2]=-2147483648,ae=ae+1|0}te=u[re+12>>2],u[q>>2]=u[re+8>>2],u[q+4>>2]=te}if(oe=oe+240|0,Te=Te>>4,!Te)break}}return J=re+16|0,ae}function N4(q,ae,oe){var re=0,te=0,ge=0,Te=0,Je=0,Xe=0,yr=0,Nn=0,on=0,nt=0,Qa=0,ju=0,Ls=0,ag=0,qS=0,RI=0;return ra(+ae),Te=Hr(1)|0,te=Hr(0)|0,Je=te&65535,ra(+q),nt=Hr(1)|0,re=Hr(0)|0,ge=nt,Nn=re&65535,ag=f(Nn,Je),o[oe>>1]=ag,on=re>>>16,Qa=f(on,Je),te=te>>>16,yr=f(te,Nn),qS=((Qa&65535)+(ag>>>16)|0)+(yr&65535)|0,o[oe+2>>1]=qS,ju=ge&65535,re=f(ju,Je),Xe=((re&65535)+(Qa>>>16)|0)+(yr>>>16)|0,yr=f(te,on),nt=Te&65535,Ls=f(nt,Nn),Qa=((Xe+(yr&65535)|0)+(Ls&65535)|0)+(qS>>>16)|0,o[oe+4>>1]=Qa,Te=Te>>>16,Xe=f(Te,Nn),RI=(Xe&65535)+(re>>>16)|0,re=ge>>>16,ge=f(re,Je),Je=f(nt,on),Nn=f(te,ju),yr=(((((RI+(ge&65535)|0)+(yr>>>16)|0)+(Ls>>>16)|0)+(Je&65535)|0)+(Nn&65535)|0)+(Qa>>>16)|0,o[oe+6>>1]=yr,Ls=(ge>>>16)+(Xe>>>16)|0,ge=f(Te,on),Xe=f(re,te),te=f(nt,ju),on=(((((Ls+(ge&65535)|0)+(Je>>>16)|0)+(Nn>>>16)|0)+(Xe&65535)|0)+(te&65535)|0)+(yr>>>16)|0,o[oe+8>>1]=on,Je=f(Te,ju),te=(((Je&65535)+(ge>>>16)|0)+(Xe>>>16)|0)+(te>>>16)|0,ge=f(re,nt),Xe=(te+(ge&65535)|0)+(on>>>16)|0,o[oe+10>>1]=Xe,Te=f(re,Te),re=(((Te&65535)+(Je>>>16)|0)+(ge>>>16)|0)+(Xe>>>16)|0,o[oe+12>>1]=re,o[oe+14>>1]=(re>>>16)+(Te>>>16),(ag|qS|Qa)&65535}function A4(q,ae,oe){var re=0,te=0,ge=0,Te=0;e:{if(re=t[oe+30|0],!re)break e;for(te=oe;Te=Te*10+ +(pr[u[u[q>>2]+4>>2]](q,d[te>>1])|0),te=te+2|0,ge=(re|0)>1,re=re+-1|0,!!ge;);ra(+Te),re=Hr(1)|0,q=Hr(0)|0,u[ae>>2]=q<<11,u[ae+4>>2]=((re&2097151)<<11|q>>>21)&2147481600|q>>>21|-2147483648,re=$g(ae,(re>>>20&2047)+-1022|0,((d[oe+32>>1]&32767)-t[oe+30|0]|0)+-16384|0),te=u[ae>>2];r:{if(!(te&3071)){q=te;break r}if(q=te+1024|0,u[ae>>2]=q,te>>>0<4294966272)break r;te=u[ae+4>>2],ge=te+1|0,u[ae+4>>2]=ge,re=(ge>>>0<te>>>0)+re|0}if((re|0)<=-1022)break e;return te=(re<<20)+1071644672|0,(te|0)<0?1:(re=u[ae+4>>2],u[ae>>2]=re<<21|q>>>11,u[ae+4>>2]=o[oe+32>>1]&-2147483648|(te|re>>>11&1048575),0)}return u[ae>>2]=0,u[ae+4>>2]=0,0}function ev(q){var ae=0,oe=0,re=0,te=0,ge=0,Te=0,Je=0,Xe=0;if(ae=J-16|0,J=ae,l[ae+8>>3]=q,ra(+q),oe=Hr(1)|0,re=Hr(0)|0,Te=oe,oe=oe&2146435072,oe){u[ae+8>>2]=re<<11,u[ae+12>>2]=Te<<11|re>>>21|-2147483648,re=(oe>>>20)+-1022|0,oe=f(re,39457)>>17,ge=oe+-14|0,te=$g(ae+8|0,re,14-oe|0),re=u[ae+8>>2];e:{if((te|0)>=((s[ae+12>>2]<(re>>>0<2147477094?-1243209483:-1243209484)>>>0?48:47)|0))break e;te=$g(ae+8|0,te,1),re=u[ae+8>>2],ge=oe+-15|0}oe=ge,ge=re,re=-2147483648>>>(te&31),ge=ge+re|0,u[ae+8>>2]=ge;e:{if(ge>>>0>=re>>>0||(Je=u[ae+12>>2],Xe=Je+1|0,u[ae+12>>2]=Xe,Xe>>>0>=Je>>>0))break e;u[ae+12>>2]=-2147483648,te=te+1|0}u[ae+8>>2]=ge&0-(re<<1),te=$g(ae+8|0,te,oe),oe=u[ae+8>>2];e:{if(!(oe&3071)){re=oe;break e}if(re=oe+1024|0,u[ae+8>>2]=re,oe>>>0<4294966272)break e;oe=u[ae+12>>2],ge=oe+1|0,u[ae+12>>2]=ge,te=(ge>>>0<oe>>>0)+te|0}e:{if((te|0)<=-1023){u[ae+8>>2]=0,u[ae+12>>2]=0;break e}if(oe=(te<<20)+1071644672|0,(oe|0)<=-1)break e;te=u[ae+12>>2],u[ae+8>>2]=te<<21|re>>>11,u[ae+12>>2]=te>>>11&1048575|(oe|Te&-2147483648)}q=l[ae+8>>3]}return J=ae+16|0,q}function Th(q){var ae=0;return ae=u[922],u[922]=q,ae}function wS(){var q=0,ae=0,oe=0;return q=u[920],ae=u[921],sl(1048576),sl(2146435072),o[1843]<0?(u[920]=q,u[921]=ae,-2147483648):(oe=rv(),u[920]=q,u[921]=ae,oe^-2147483648)}function mI(q){var ae=0,oe=0,re=0,te=0,ge=0;ra(+q),ae=Hr(1)|0,ge=Hr(0)|0,te=ae,oe=ae>>>20,ae=oe&2047,re=0;e:{if(ae>>>0<1023||(re=q,ae>>>0>1075))break e;if(oe=-1<<(19-oe&31),ae>>>0>=1044)return $l(0,oe&ge),$l(1,te|0),+zh();te=te&oe,$l(0,0),$l(1,te|0),re=+zh()}return re}function bh(q){var ae=0,oe=0,re=0;if(q+307>>>0<=615){u[920]=0,u[921]=-2147483648,re=$g(3680,1,q),oe=u[920],q=u[921];e:{if(!(oe&3071))break e;ae=u[921],q=u[920]+1024|0,q>>>0<1024&&(ae=ae+1|0),u[920]=q,u[921]=ae,oe=q,q=ae}u[920]=q<<21|oe>>>11,u[921]=(q>>>11&1048575|re<<20)+1071644672;return}(q|0)>=309&&(u[922]=1),u[920]=0,u[921]=0}function GW(q){var ae=0,oe=0;if(oe=o[1843],!(oe|q)){u[922]=u[922]&4?4:64;return}e:{if((oe|0)<1||(rv()|0)!=10)break e;if(ae=l[460],m0(),ps(ae),!d[1843]){bh(q);return}l[460]=ae}for(ae=1;;){if(q&1&&(ae=xS(l[460],ae)),q=q>>>1,q){bd(l[460]);continue}break}l[460]=ae}function Gy(q,ae,oe,re,te,ge){var Te=0,Je=0,Xe=0,yr=0,Nn=0,on=0,nt=0,Qa=0;Nn=J-16|0,J=Nn,Xe=(ae<<1)+q|0,on=Nn+12|0;e:{r:{n:{t:{if(Je=te?re:1,yr=(oe|0)<5&Je+3>>>0<8,yr)break t;a:{if((Je|0)>(oe|0))break a;if(re=oe+Je|0,(re|0)>=3){if((oe|0)<5|(Je|0)>-4)break t;if((re+-2|0)<(te|0))break a;break t}if((oe|0)<5)break t}if(nt=1,re=1,(oe|0)<7)break n;re=oe-(Je+97>>>0>196?6:5)|0;break n}if((oe|0)==1&&(re=0,!Je))break n;re=oe-((Je|0)<(oe|0)?(Je|0)<1?2-Je|0:1:0)|0}n:{if((re|0)<(te|0)){Te=1,te=0;t:{if((ae|0)<1)break t;a:{i:{if(!re){if(d[q>>1]>52)break i;break t}if((re|0)<1|(re|0)>=(ae|0))break t;if(d[(re<<1)+q>>1]<=52)break a;for(;;){if(te=re+-1|0,Te=(te<<1)+q|0,Qa=d[Te>>1]+1|0,o[Te>>1]=Qa,(Qa&65535)!=58)break a;if(re=te,!te)break}}o[q>>1]=49,te=1,Te=Je+1|0;break t}for(;te=re,(te|0)>=2&&(re=te+-1|0,d[(re<<1)+q>>1]==48););Te=Je}if((yr^-1)&(Te|0)>(oe|0)|nt)break n;break r}if(Te=Je,!nt)break r}u[on>>2]=32768,oe=q+2|0;n:{if((te|0)<2){re=oe;break n}if(re=oe+(te<<1)|0,re>>>0>=Xe>>>0){re=oe;break n}te=te+-1|0,u[on>>2]=te|32768,q=q+4|0,(ae<<1)+-4>>1>>>0<te>>>0&&g0(),b(q,oe,te<<1),o[oe>>1]=ge}re>>>0<Xe>>>0&&(o[re>>1]=69,re=re+2|0);n:{if(re>>>0>=Xe>>>0){te=re;break n}if(te=re+2|0,(Te|0)<=0){o[re>>1]=45,Te=1-Te|0;break n}o[re>>1]=43,Te=Te+-1|0}if((Te|0)<100|te>>>0>=Xe>>>0||(q=(Te>>>0)/100|0,o[te>>1]=q+48,Te=Te-f(q,100)|0,te=te+2|0),te>>>0<Xe>>>0&&(o[te>>1]=((Te|0)/10|0)+48,te=te+2|0),te>>>0>=Xe>>>0)break e;o[te>>1]=((Te|0)%10|0)+48,te=te+2|0;break e}if(!((te|0)<0|(te|0)>(Te|0))){if(re=(Te|0)>(ae|0)?ae:Te,oe=re-te|0,oe)for(ae=(te<<1)+q|0,te=0;o[ae+(te<<1)>>1]=48,te=te+1|0,(oe|0)!=(te|0););te=(re<<1)+q|0;break e}if(oe=te-Te|0,u[on>>2]=oe,(Te|0)>=1){if(Je=(Te|0)>(ae|0)?ae:Te,oe=Je<<1,yr=oe+q|0,re=(yr+(te<<1)|0)-oe|0,oe=re+-2|0,!(oe>>>0<q>>>0|re>>>0>=Xe>>>0))for(;o[re>>1]=d[oe>>1],re=re+-2|0,oe=oe+-2|0,oe>>>0>=yr>>>0;);(Te|0)<(ae|0)&&(o[yr>>1]=ge),ae=te-Je|0,q=Xe-yr>>1,te=yr+(((q|0)>(ae|0)?ae+1|0:q)<<1)|0;break e}re=((q-(Te<<1)|0)+(te<<1)|0)+2|0;r:{if(re>>>0>=Xe>>>0||(te=((te<<1)+q|0)+-2|0,te>>>0<q>>>0))break r;for(;o[re>>1]=d[te>>1],re=re+-2|0,te=te+-2|0,te>>>0>=q>>>0;);}(ae|0)>=1&&(o[q>>1]=48,q=q+2|0),q>>>0<Xe>>>0&&(o[q>>1]=ge,q=q+2|0),re=Xe-q>>1;r:{if(!Te||(ae=0-Te|0,ae=(re|0)<(ae|0)?re:ae,!ae))break r;for(te=0;o[(te<<1)+q>>1]=48,te=te+1|0,(ae|0)!=(te|0););}te=(((re|0)<(oe|0)?re:oe)<<1)+q|0}return J=Nn+16|0,te}function DS(q,ae,oe,re){var te=0,ge=0,Te=0;e:{r:{n:{t:{if(!re){if(d[q>>1]<=52)break t;break r}if((re|0)<1)break t;if((re|0)<15)break n}u[ae>>2]=1,u[oe>>2]=0;return}if(d[(re<<1)+q>>1]<=52)break e;for(;;){if(te=re+-1|0,ge=(te<<1)+q|0,Te=d[ge>>1]+1|0,o[ge>>1]=Te,(Te&65535)!=58)break e;if(re=te,!re)break}}o[q>>1]=49,u[ae>>2]=u[ae>>2]+1,u[oe>>2]=1;return}for(;ae=re,(re|0)>=2&&(re=ae+-1|0,d[(re<<1)+q>>1]==48););u[oe>>2]=ae}function gI(q,ae,oe,re){var te=0;te=J-16|0,J=te,q=pr[u[u[q>>2]+8>>2]](q)|0,u[te+8>>2]=0;e:{if(oe<<1>>>0<=33){if((oe|0)<1)break e;o[ae>>1]=0;break e}LS(l[460],te+8|0,ae,15),ae=Gy(ae,oe,re,o[te+8>>1],o[te+10>>1],q)}return J=te+16|0,ae}function vI(){var q=0,ae=0,oe=0;e:{if(oe=u[920],q=u[921],ae=q&-65536,ae){if((q&2146435072)==2146435072){u[922]=1,m0();return}if((ae|0)<1)break e}m0();return}m0(),(oe|0)==u[920]&&u[921]==(q|0)||ps(1)}function hI(){var q=0,ae=0,oe=0;e:{if(oe=u[920],q=u[921],ae=q&-65536,ae){if((q&2146435072)==2146435072){u[922]=1,m0();return}if((ae|0)>0)break e}m0();return}m0(),(oe|0)==u[920]&&u[921]==(q|0)||sl(1)}function sl(q){l[460]=SI(l[460],q)}function SI(q,ae){var oe=0;return q=q+ae,ra(+q),oe=Hr(1)|0,Hr(0)|0,(oe&2146435072)==2146435072&&(u[922]=1,q=l[375]),q}function ps(q){l[460]=Ky(l[460],q)}function Ky(q,ae){var oe=0;return q=q-ae,ra(+q),oe=Hr(1)|0,Hr(0)|0,(oe&2146435072)==2146435072&&(u[922]=1,q=l[375]),q}function bd(q){l[460]=xS(l[460],q)}function xS(q,ae){var oe=0,re=0,te=0,ge=0;return ra(+(q*ae)),oe=Hr(1)|0,ge=Hr(0)|0,re=oe&2146435072,0|(re|0)!=2146435072?(re=!(re|te),te=re?u[750]:ge,oe=re?u[751]:oe,$l(0,te|0),$l(1,oe|0),+zh()):(u[922]=1,oe=u[751],$l(0,u[750]),$l(1,oe|0),+zh())}function ef(q){l[460]=Vy(l[460],q)}function Vy(q,ae){var oe=0,re=0,te=0,ge=0,Te=0,Je=0;e:{if(ra(+ae),oe=Hr(1)|0,Hr(0)|0,!(oe&2146435072)){re=4;break e}if(re=1,ra(+(q/ae)),oe=Hr(1)|0,te=Hr(0)|0,ge=oe&2146435072,Te=ge,!0&(ge|0)==2146435072)break e;return re=!(Te|Je),te=re?u[750]:te,oe=re?u[751]:oe,$l(0,te|0),$l(1,oe|0),+zh()}return u[922]=re,oe=u[751],$l(0,u[750]),$l(1,oe|0),+zh()}function Ph(q){l[460]=q>>>0}function Pd(q){l[460]=q|0}function fb(){var q=0,ae=0;q=+k(+l[460]),l[460]=q,ra(+q),ae=Hr(1)|0,Hr(0)|0,(ae&2146435072)==2146435072&&(u[922]=8)}function Hf(){var q=0,ae=0;q=+x(+l[460]),l[460]=q,ra(+q),ae=Hr(1)|0,Hr(0)|0,(ae&2146435072)==2146435072&&(u[922]=8)}function rv(){return ng(l[460])}function ng(q){var ae=0,oe=0,re=0,te=0,ge=0;ra(+q),ae=Hr(1)|0,oe=Hr(0)|0,re=ae&2146435072,te=(re|0)==1106247680&te>>>0<0|re>>>0<1106247680,ae=ae&2147483647,ge=ae,$l(0,oe|0),$l(1,ae|0),q=+zh();e:{if(q<18446744073709552e3&q>=0){re=m(q)>=1?q>0?~~h(y(q/4294967296),4294967295)>>>0:~~C((q-+(~~q>>>0>>>0))/4294967296)>>>0:0,ae=~~q>>>0;break e}re=0,ae=0}return oe=te?ae:oe,ae=te?re:ge,!ae&oe>>>0<4294967295|ae>>>0<0?oe:-1}function pb(){return yI(l[460])}function yI(q){var ae=0,oe=0;return ra(+q),ae=Hr(1)|0,Hr(0)|0,ae=ae&2145386496,oe=(ae|0)==1105199104&oe>>>0<0|ae>>>0<1105199104,m(q)<2147483648?ae=~~q:ae=-2147483648,oe?ae:-2147483648}function xN(){var q=0,ae=0;q=+G(+l[460]),l[460]=q,ra(+q),ae=Hr(1)|0,Hr(0)|0,(ae&2146435072)==2146435072&&(u[922]=8)}function CI(){var q=0,ae=0,oe=0;e:{if(ae=l[460],ra(+ae),q=Hr(1)|0,Hr(0)|0,q=q&2145386496,(q|0)==1101004799&!0|q>>>0<1101004799&&(ae=+H(+ae),l[460]=ae,ra(+ae),q=Hr(1)|0,Hr(0)|0,(q&2146435072)!=2146435072))break e;u[922]=8}}function _I(){var q=0,ae=0,oe=0;e:{if(ae=l[460],ra(+ae),q=Hr(1)|0,Hr(0)|0,q=q&2145386496,(q|0)==1101004799&!0|q>>>0<1101004799&&(ae=+L(+ae),l[460]=ae,ra(+ae),q=Hr(1)|0,Hr(0)|0,(q&2146435072)!=2146435072))break e;u[922]=8}}function tg(){var q=0,ae=0,oe=0,re=0;oe=8,ae=l[460],ra(+ae),q=Hr(1)|0,Hr(0)|0,q=q&2145386496;e:{if((q|0)==1101004799&!0|q>>>0<1101004799&&(ae=+D(+ae),l[460]=ae,oe=4,ra(+ae),q=Hr(1)|0,Hr(0)|0,(q&2146435072)!=2146435072))break e;u[922]=oe}}function mb(){var q=0,ae=0;q=+U(+l[460]),l[460]=q,ra(+q),ae=Hr(1)|0,Hr(0)|0,(ae&2146435072)==2146435072&&(u[922]=8)}function m0(){l[460]=mI(l[460])}function Wy(){var q=0,ae=0;q=+V(+l[460]),l[460]=q,ra(+q),ae=Hr(1)|0,Hr(0)|0,(ae&2146435072)==2146435072&&(u[922]=1)}function gb(q,ae,oe){return A4(q,ae,oe)}function LS(q,ae,oe,re){E4(q,ae,oe,re)}function LN(q){return Ky(l[460],q)}function vb(q){return Vy(l[460],q)}function BS(q){l[460]=Vy(q,l[460])}function jy(q,ae){l[460]=Vy(q,ae)}function g0(){ne(1),g0()}function O4(q,ae){q=q|0,ae=ae|0,u[926]||(u[927]=ae,u[926]=q)}function k4(){return 3712}function F4(){return J|0}function we(q){return q=q|0,q=J-q&-16,J=q,q|0}function Ee(q){q=q|0,J=q}function Fe(q){return q=q|0,g0()|0}function De(q,ae){FXe(q|0,ae|0)}function ke(q,ae,oe,re){var te=0,ge=0,Te=0,Je=0,Xe=0,yr=0;return te=oe>>>16,ge=q>>>16,yr=f(te,ge),Te=oe&65535,Je=q&65535,Xe=f(Te,Je),ge=(Xe>>>16)+f(ge,Te)|0,te=(ge&65535)+f(te,Je)|0,q=(((f(ae,oe)+yr|0)+f(q,re)|0)+(ge>>>16)|0)+(te>>>16)|0,ae=Xe&65535|te<<16,Z=q,ae}function Me(q,ae,oe,re){var te=0,ge=0,Te=0;return te=ae>>31,q=q^te,Te=q-te|0,ge=ae>>31,ge=(ge^ae)-((q>>>0<te>>>0)+ge|0)|0,q=re>>31,oe=oe^q,te=re>>31,oe=Tr(Te,ge,oe-q|0,(te^re)-((oe>>>0<q>>>0)+te|0)|0),ae=ae^re,q=ae>>31,ae=ae>>31,oe=oe^ae,re=oe-ae|0,Z=(q^Z)-((oe>>>0<ae>>>0)+q|0)|0,re}function Be(q,ae,oe,re){return q=ke(q,ae,oe,re),q}function er(q,ae,oe,re){return q=Me(q,ae,oe,re),q}function Tr(q,ae,oe,re){var te=0,ge=0,Te=0,Je=0,Xe=0,yr=0,Nn=0,on=0,nt=0,Qa=0,ju=0;e:{r:{n:{t:{a:{i:{o:{u:{s:{l:{if(Te=ae,Te){if(te=oe,!te)break l;if(ge=re,!ge)break s;if(te=v(ge)-v(Te)|0,te>>>0<=31)break u;break r}if((re|0)==1&oe>>>0>=0|re>>>0>1)break r;return ae=(q>>>0)/(oe>>>0)|0,De(q-f(ae,oe)|0,0),Z=0,ae}if(te=re,!q)break o;if(!te||(ge=te+-1|0,ge&te))break i;return De(q,Te&ge),q=Te>>>(Lr(te)&31),Z=0,q}if(ge=te+-1|0,!(ge&te))break a;Xe=(v(te)+33|0)-v(Te)|0,yr=0-Xe|0;break n}Xe=te+1|0,yr=63-te|0;break n}return q=(Te>>>0)/(te>>>0)|0,De(0,Te-f(q,te)|0),Z=0,q}if(te=v(te)-v(Te)|0,te>>>0<31)break t;break r}if(De(q&ge,0),(te|0)==1)break e;return oe=Lr(te),re=q,q=oe&31,32<=(oe&63)>>>0?(te=0,q=ae>>>q):(te=ae>>>q,q=((1<<q)-1&ae)<<32-q|re>>>q),Z=te,q}Xe=te+1|0,yr=63-te|0}if(ge=ae,nt=q,te=Xe&63,Te=te&31,32<=(te&63)>>>0?(te=0,Je=ge>>>Te):(te=ge>>>Te,Je=((1<<Te)-1&ge)<<32-Te|nt>>>Te),ge=te,Te=q,te=yr&63,q=te&31,32<=(te&63)>>>0?(te=Te<<q,q=0):(te=(1<<q)-1&Te>>>32-q|ae<<q,q=Te<<q),ae=te,Xe)for(te=re+-1|0,Te=oe+-1|0,Te>>>0<4294967295&&(te=te+1|0),yr=te;te=ge<<1|Je>>>31,ge=Je<<1,nt=te,ge=ae>>>31|ge,on=ge,Je=yr-((Te>>>0<ge>>>0)+te|0)|0,te=Je>>31,Nn=Je>>31,ge=oe&Nn,Je=on-ge|0,ge=nt-((re&te)+(on>>>0<ge>>>0)|0)|0,te=ae<<1|q>>>31,q=Qa|q<<1,ae=te|ju,on=0,Nn=Nn&1,Qa=Nn,Xe=Xe+-1|0,!!Xe;);return De(Je,ge),te=ae<<1|q>>>31,q=Nn|q<<1,Z=te|on,q}De(q,ae),q=0,ae=0}return Z=ae,q}function Lr(q){return q?31-v(q+-1^q)|0:32}var pr=[null,R,P,A,db,ie];return{memory:Object.create(Object.prototype,{grow:{},buffer:{get:function(){return n}}}),Base_StrBuf:X,Base_StrBufSize:Q,Dtr_DaysPerMonth:T,Dtr_FromNum:g,Dtr_Yr:O,Dtr_Mon:M,Dtr_DOM:K,Dtr_Hour:W,Dtr_Min:z,Dtr_Sec:ee,Dtr_Wdy:ue,Dtr_FracSec:ce,Dtr_Rounding:he,Dtr_Write:de,Dtr_ToNum:pe,Dtr_ToNumWithDuration:_e,Dtr_Days:Ce,Dtr_ToDays:Ne,Dtr_ToTime:Le,Dtr_UtcToLocal:Oe,Mathpack_Zero:le,Mathpack_One:me,Mathpack_Pi:Pe,Mathpack_Div:Re,Mathpack_Mul:fe,Mathpack_Sub:Se,Mathpack_Add:be,Mathpack_Power:xe,Mathpack_Cond:Ie,Mathpack_Cond2:Ve,Mathpack_TakeMathError:Ze,Mathpack_Trunc:gr,Mathpack_Ceil:cr,Mathpack_Floor:_r,Mathpack_Abs:xr,Mathpack_Neg:Or,Mathpack_Float:Rr,Mathpack_SFloat:ir,Mathpack_Fix:$e,Mathpack_LFix:qe,Mathpack_SFix:fr,Mathpack_Round:lr,Mathpack_RoundUp:dn,Mathpack_RoundDown:Un,Mathpack_TenTo:Gr,Mathpack_Compare:Br,Mathpack_GetExp32:bt,Mathpack_Equal:Kr,Mathpack_ViewRound:Pt,Mathpack_Sqrt:Mi,Mathpack_Exp:El,Mathpack_Ln:Nl,Mathpack_Log:ys,Mathpack_Sin:_d,Mathpack_Cos:xu,Mathpack_Tan:pi,Mathpack_Asin:xa,Mathpack_Acos:$i,Mathpack_Atan:$o,Mathpack_Atan2:ar,Mathpack_FormatGeneral:ye,Mathpack_FormatGetExponent:Rd,Mathpack_FormatGetSign:Ji,Mathpack_FormatFixed:By,Mathpack_FormatScientific:nr,Mathpack_Pack:Rn,_start:ie,__errno_location:k4,setThrew:O4,stackSave:F4,stackAlloc:we,stackRestore:Ee,__growWasmMemory:Fe}}var gve=new ArrayBuffer(65536),kl=function(e){var r=new Uint8Array(e);return function(n,a){var o,u;if(typeof Buffer=="undefined")for(o=atob(a),u=0;u<o.length;u++)r[n+u]=o.charCodeAt(u);else for(o=Buffer.from(a,"base64"),u=0;u<o.length;u++)r[n+u]=o[u]}}(gve);kl(1024,"GAwAAAEAAAACAAAAAwAAAAAAAAAE");kl(1056,"6AsAAPALAAD4CwAAAAwAAB8dHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8dHx4fHh8fHh8eHw==");kl(1152,"sAsAAMgLAADACwAA0As=");kl(1199,"AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQECAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsAAAAAHwA8AFsAeQCYALYA1QD0ABIBMQFPAW4B");kl(1599,"AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwAAAAAAHwA7AFoAeACXALUA1ADzABEBMAFOAW0B");kl(1975,"oAQ=");kl(1991,"yAc=");kl(2007,"+go=");kl(2022,"QJwO");kl(2038,"UMMR");kl(2054,"JPQU");kl(2069,"gJaYGA==");kl(2085,"ILy+Gw==");kl(2101,"KGvuHg==");kl(2117,"+QKVIg==");kl(2132,"QLdDuiU=");kl(2148,"EKXU6Cg=");kl(2164,"KueEkSw=");kl(2179,"gPQg5rUv");kl(2195,"oDGpX+My");kl(2211,"BL/JG442AAAAAAAAAJ61cCuorcWdawAAAAAAAADXlUMOBY0pr6AAAAAAAAAA1abP/0kfeMLVAAAAAAAAAPz32oePeufXCgEAAAAAAACjFJvFFquz7z8BAAAAAAAAnjIjmcCtD4V1AQAAAAAAAOCM6YDJR7qTqgEAAAAAAADnptOoxbkCpN8BAAAAAAAAqhfmfyuhFrYUAgAAAAAAAJO/m4WRoijKSQIAAAAAAABrVSc5jfdw4H4CAAAAAAAARmGCNzUMLvmzAgAAAAAAADDJPOP/llKK6QIAAAAAAABmF7/W86aRmR4DAAAAAAAAjt75nfvrfqpTAwAAAAAAAM3MzMzMzMzM/f///wAAAAAK16NwPQrXo/r///8AAAAAO99PjZduEoP3////AAAAACxlGeJYF7fR8////wAAAAAjhEcbR6zFp/D///8AAAAAtmlsrwW9N4bt////AAAAALxCeuXVlL/W6f///wAAAAD9zmGEEXfMq+b///8AAAAAl6W0NkFfcInj////AAAAAL/V7b3O/ubb3////wAAAAD/qiTLC//rr9z///8AAAAAzIhQbwnMvIzZ////AAAAABMOtEtCEy7h1f///wAAAAAP2FwJNdwktNL///8AAAAA2aywOvd8HZDP////AAAAAFvhTcS+lJXmy////wAAAAC6lDlFrR6xz5b///8AAAAAWcF+sVN8Erth////AAAAAKXpOaUn6n+oLP///wAAAACmGQlrumDFl/f+//8AAAAAm1N1/fcCtIjC/v//AAAAAH3TZfC8NUP2jP7//wAAAACh5LxkfEbQ3Vf+//8AAAAAyYJTfG66ysci/v//AAAAAJOgc9uT4PSz7f3//wAAAAAwAMs42ycXorj9//8AAAAABswjVHeD/5GD/f//AAAAAGC8pD2p3oCDTv3//wAAAAC+TjFK7Dzl7Bj9//8AAAAA1+Eyz81fYNXj/P//AAAAADoZemMlQzHArvz//wAAAAAYLURU+yEJQAAAAAAAAOA/AAAAAAAAAEAYLURU+yH5PwAAAAAAAPA/");kl(3014,"WUAAAAAAAAAkQAAAAAAAQI9AAAAAAAAAOEAAAAAAAABOQClRzqDIRdg+IXQL5wZroz41IN+kpBFvPvZNfx3q2jg+AADA////30EAAAAAAADgwQQEAAAQBA==");kl(3728,"ME8=");var Yn=IXe({Math:OXe.Math,Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,NaN:NaN,Infinity:1/0},{abort:function(){throw new Error("abort")},Base_LocaleIsNumeral:Qh.Base_LocaleIsNumeral,Base_LocaleGetOrdinal:Qh.Base_LocaleGetOrdinal,Base_LocaleDecimalSeparator:Qh.Base_LocaleDecimalSeparator,Math_log10:Qh.Math_log10,Math_log:Qh.Math_log,Math_sqrt:Qh.Math_sqrt,Math_sin:Qh.Math_sin,Math_cos:Qh.Math_cos,Math_tan:Qh.Math_tan,Math_atan:Qh.Math_atan,Math_exp:Qh.Math_exp,proc_exit:kXe.proc_exit},gve),MXe=Yn.memory;ur.memory=MXe;var wXe=Yn.Base_StrBuf;ur.Base_StrBuf=wXe;var DXe=Yn.Base_StrBufSize;ur.Base_StrBufSize=DXe;var xXe=Yn.Dtr_DaysPerMonth;ur.Dtr_DaysPerMonth=xXe;var LXe=Yn.Dtr_FromNum;ur.Dtr_FromNum=LXe;var BXe=Yn.Dtr_Yr;ur.Dtr_Yr=BXe;var qXe=Yn.Dtr_Mon;ur.Dtr_Mon=qXe;var UXe=Yn.Dtr_DOM;ur.Dtr_DOM=UXe;var GXe=Yn.Dtr_Hour;ur.Dtr_Hour=GXe;var KXe=Yn.Dtr_Min;ur.Dtr_Min=KXe;var VXe=Yn.Dtr_Sec;ur.Dtr_Sec=VXe;var WXe=Yn.Dtr_Wdy;ur.Dtr_Wdy=WXe;var jXe=Yn.Dtr_FracSec;ur.Dtr_FracSec=jXe;var HXe=Yn.Dtr_Rounding;ur.Dtr_Rounding=HXe;var QXe=Yn.Dtr_Write;ur.Dtr_Write=QXe;var zXe=Yn.Dtr_ToNum;ur.Dtr_ToNum=zXe;var YXe=Yn.Dtr_ToNumWithDuration;ur.Dtr_ToNumWithDuration=YXe;var JXe=Yn.Dtr_Days;ur.Dtr_Days=JXe;var XXe=Yn.Dtr_ToDays;ur.Dtr_ToDays=XXe;var ZXe=Yn.Dtr_ToTime;ur.Dtr_ToTime=ZXe;var $Xe=Yn.Dtr_UtcToLocal;ur.Dtr_UtcToLocal=$Xe;var eZe=Yn.Mathpack_Zero;ur.Mathpack_Zero=eZe;var rZe=Yn.Mathpack_One;ur.Mathpack_One=rZe;var nZe=Yn.Mathpack_Pi;ur.Mathpack_Pi=nZe;var tZe=Yn.Mathpack_Div;ur.Mathpack_Div=tZe;var aZe=Yn.Mathpack_Mul;ur.Mathpack_Mul=aZe;var iZe=Yn.Mathpack_Sub;ur.Mathpack_Sub=iZe;var oZe=Yn.Mathpack_Add;ur.Mathpack_Add=oZe;var uZe=Yn.Mathpack_Power;ur.Mathpack_Power=uZe;var sZe=Yn.Mathpack_Cond;ur.Mathpack_Cond=sZe;var lZe=Yn.Mathpack_Cond2;ur.Mathpack_Cond2=lZe;var cZe=Yn.Mathpack_TakeMathError;ur.Mathpack_TakeMathError=cZe;var dZe=Yn.Mathpack_Trunc;ur.Mathpack_Trunc=dZe;var fZe=Yn.Mathpack_Ceil;ur.Mathpack_Ceil=fZe;var pZe=Yn.Mathpack_Floor;ur.Mathpack_Floor=pZe;var mZe=Yn.Mathpack_Abs;ur.Mathpack_Abs=mZe;var gZe=Yn.Mathpack_Neg;ur.Mathpack_Neg=gZe;var vZe=Yn.Mathpack_Float;ur.Mathpack_Float=vZe;var hZe=Yn.Mathpack_SFloat;ur.Mathpack_SFloat=hZe;var SZe=Yn.Mathpack_Fix;ur.Mathpack_Fix=SZe;var yZe=Yn.Mathpack_LFix;ur.Mathpack_LFix=yZe;var CZe=Yn.Mathpack_SFix;ur.Mathpack_SFix=CZe;var _Ze=Yn.Mathpack_Round;ur.Mathpack_Round=_Ze;var RZe=Yn.Mathpack_RoundUp;ur.Mathpack_RoundUp=RZe;var TZe=Yn.Mathpack_RoundDown;ur.Mathpack_RoundDown=TZe;var bZe=Yn.Mathpack_TenTo;ur.Mathpack_TenTo=bZe;var PZe=Yn.Mathpack_Compare;ur.Mathpack_Compare=PZe;var EZe=Yn.Mathpack_GetExp32;ur.Mathpack_GetExp32=EZe;var NZe=Yn.Mathpack_Equal;ur.Mathpack_Equal=NZe;var AZe=Yn.Mathpack_ViewRound;ur.Mathpack_ViewRound=AZe;var OZe=Yn.Mathpack_Sqrt;ur.Mathpack_Sqrt=OZe;var kZe=Yn.Mathpack_Exp;ur.Mathpack_Exp=kZe;var FZe=Yn.Mathpack_Ln;ur.Mathpack_Ln=FZe;var IZe=Yn.Mathpack_Log;ur.Mathpack_Log=IZe;var MZe=Yn.Mathpack_Sin;ur.Mathpack_Sin=MZe;var wZe=Yn.Mathpack_Cos;ur.Mathpack_Cos=wZe;var DZe=Yn.Mathpack_Tan;ur.Mathpack_Tan=DZe;var xZe=Yn.Mathpack_Asin;ur.Mathpack_Asin=xZe;var LZe=Yn.Mathpack_Acos;ur.Mathpack_Acos=LZe;var BZe=Yn.Mathpack_Atan;ur.Mathpack_Atan=BZe;var qZe=Yn.Mathpack_Atan2;ur.Mathpack_Atan2=qZe;var UZe=Yn.Mathpack_FormatGeneral;ur.Mathpack_FormatGeneral=UZe;var GZe=Yn.Mathpack_FormatGetExponent;ur.Mathpack_FormatGetExponent=GZe;var KZe=Yn.Mathpack_FormatGetSign;ur.Mathpack_FormatGetSign=KZe;var VZe=Yn.Mathpack_FormatFixed;ur.Mathpack_FormatFixed=VZe;var WZe=Yn.Mathpack_FormatScientific;ur.Mathpack_FormatScientific=WZe;var jZe=Yn.Mathpack_Pack;ur.Mathpack_Pack=jZe;var HZe=Yn._start;ur._start=HZe;var QZe=Yn.__errno_location;ur.__errno_location=QZe;var zZe=Yn.setThrew;ur.setThrew=zZe;var YZe=Yn.stackSave;ur.stackSave=YZe;var JZe=Yn.stackAlloc;ur.stackAlloc=JZe;var XZe=Yn.stackRestore;ur.stackRestore=XZe;var ZZe=Yn.__growWasmMemory;ur.__growWasmMemory=ZZe});var cJ=Y(Tn=>{"use strict";_();var t2;Object.defineProperty(Tn,"__esModule",{value:!0});Tn.pack=Tn.formatScientific=Tn.formatFixed=Tn.formatGeneral=Tn.atan2=Tn.atan=Tn.acos=Tn.asin=Tn.tan=Tn.cos=Tn.sin=Tn.log=Tn.ln=Tn.exp=Tn.sqrt=Tn.viewRound=Tn.cond2=Tn.cond=Tn.power=Tn.add=Tn.sub=Tn.mul=Tn.div=Tn.compare=Tn.tenTo=Tn.roundDown=Tn.roundUp=Tn.round=Tn.sfix=Tn.lfix=Tn.fix=Tn.float=Tn.neg=Tn.abs=Tn.floor=Tn.ceil=Tn.trunc=Tn.equal=Tn.exp32=Tn.pi=Tn.one=Tn.zero=Tn.mathError=Tn.MathErrorNum=void 0;var Wt=WM(),HM=qB(),vve=WM();function lJ(e,r){for(var n=new Uint16Array(vve.memory.buffer),a="",o=0;o<r;o+=1)a+=String.fromCharCode(n[e+(o<<1)>>1]);return a}function $Ze(e,r){for(var n=new Uint16Array(vve.memory.buffer),a=0;a<r.length;a+=1)n[e+(a<<1)>>1]=r.charCodeAt(a)}var rp;(function(e){e[e.None=0]="None",e[e.Over=1]="Over",e[e.Under=2]="Under",e[e.DivBy0=4]="DivBy0",e[e.Trans=8]="Trans",e[e._NA=16]="_NA",e[e._Val=32]="_Val",e[e._Num=64]="_Num"})(rp=Tn.MathErrorNum||(Tn.MathErrorNum={}));function jM(e){return{num:e}}var e$e=(t2={},t2[rp.Over]=jM(rp.Over),t2[rp.Under]=jM(rp.Under),t2[rp.DivBy0]=jM(rp.DivBy0),t2[rp.Trans]=jM(rp.Trans),t2);function o1(e){var r;return(r=e$e[e])!==null&&r!==void 0?r:jM(e)}Tn.mathError=o1;function im(e){return function(r){var n=e(r),a=(0,Wt.Mathpack_TakeMathError)();return a===rp.None?n:o1(a)}}function mC(e){return function(r,n){var a=e(r,n),o=(0,Wt.Mathpack_TakeMathError)();return o===rp.None?a:o1(o)}}Tn.zero=Wt.Mathpack_Zero;Tn.one=Wt.Mathpack_One;Tn.pi=Wt.Mathpack_Pi;Tn.exp32=Wt.Mathpack_GetExp32;function r$e(e,r){return(0,Wt.Mathpack_Equal)(e,r)!==0}Tn.equal=r$e;Tn.trunc=Wt.Mathpack_Trunc;Tn.ceil=im(Wt.Mathpack_Ceil);Tn.floor=im(Wt.Mathpack_Floor);Tn.abs=Wt.Mathpack_Abs;Tn.neg=Wt.Mathpack_Neg;function n$e(e){return e<0?(0,Wt.Mathpack_SFloat)(e):(0,Wt.Mathpack_Float)(e)}Tn.float=n$e;function t$e(e){return(0,Wt.Mathpack_Fix)(e)>>>0}Tn.fix=t$e;Tn.lfix=Wt.Mathpack_LFix;Tn.sfix=im(Wt.Mathpack_SFix);Tn.round=mC(Wt.Mathpack_Round);Tn.roundUp=mC(Wt.Mathpack_RoundUp);Tn.roundDown=mC(Wt.Mathpack_RoundDown);function a$e(e){if(e<-1e3)return 0;if(e>1e3||!isFinite(e))return o1(rp.Over);var r=(0,Wt.Mathpack_TenTo)(e),n=(0,Wt.Mathpack_TakeMathError)();return n===rp.None?r:o1(n)}Tn.tenTo=a$e;Tn.compare=Wt.Mathpack_Compare;Tn.div=mC(Wt.Mathpack_Div);Tn.mul=mC(Wt.Mathpack_Mul);Tn.sub=mC(Wt.Mathpack_Sub);Tn.add=mC(Wt.Mathpack_Add);Tn.power=mC(Wt.Mathpack_Power);function i$e(e){var r=(0,Wt.Mathpack_Cond)(e),n=(0,Wt.Mathpack_TakeMathError)();return n===rp.None?r:o1(n)}Tn.cond=i$e;Tn.cond2=Wt.Mathpack_Cond2;Tn.viewRound=im(Wt.Mathpack_ViewRound);Tn.sqrt=im(Wt.Mathpack_Sqrt);Tn.exp=im(Wt.Mathpack_Exp);Tn.ln=im(Wt.Mathpack_Ln);Tn.log=im(Wt.Mathpack_Log);Tn.sin=im(Wt.Mathpack_Sin);Tn.cos=im(Wt.Mathpack_Cos);Tn.tan=im(Wt.Mathpack_Tan);Tn.asin=im(Wt.Mathpack_Asin);Tn.acos=im(Wt.Mathpack_Acos);Tn.atan=im(Wt.Mathpack_Atan);Tn.atan2=mC(Wt.Mathpack_Atan2);function o$e(e,r,n){try{(0,HM.setLocale)(e);var a=(0,Wt.Mathpack_FormatGeneral)(r,n);return a<0?o1((0,Wt.Mathpack_TakeMathError)()):lJ((0,Wt.Base_StrBuf)(),a)}finally{(0,HM.setLocale)(void 0)}}Tn.formatGeneral=o$e;function u$e(e,r,n){var a=(0,Wt.Mathpack_FormatFixed)(e,r,n);if(a<0)return(0,Wt.Mathpack_TakeMathError)();var o=lJ((0,Wt.Base_StrBuf)(),a),u=(0,Wt.Mathpack_FormatGetExponent)(),t=(0,Wt.Mathpack_FormatGetSign)()!==0;return{sign:t,mantissa:o,exponent:u}}Tn.formatFixed=u$e;function s$e(e,r,n){var a=(0,Wt.Mathpack_FormatScientific)(e,r,n);if(a<0)return(0,Wt.Mathpack_TakeMathError)();var o=lJ((0,Wt.Base_StrBuf)(),a),u=(0,Wt.Mathpack_FormatGetExponent)(),t=(0,Wt.Mathpack_FormatGetSign)()!==0;return{sign:t,mantissa:o,exponent:u}}Tn.formatScientific=s$e;function l$e(e,r,n,a){try{(0,HM.setLocale)(e);var o=(0,HM.fastMin)(a.length,(0,Wt.Base_StrBufSize)());$Ze((0,Wt.Base_StrBuf)(),a.substring(0,o));var u=(0,Wt.Mathpack_Pack)(!!r,n,o),t=(0,Wt.Mathpack_TakeMathError)();return t!==rp.None?o1(t):isNaN(u)?o1(rp.Over):u}finally{(0,HM.setLocale)(void 0)}}Tn.pack=l$e});var yve=Y(fl=>{"use strict";_();Object.defineProperty(fl,"__esModule",{value:!0});fl.utcToLocal=fl.toTime=fl.TimeDivision=fl.toDays=fl.toNumWithDuration=fl.toNum=fl.fromNum=fl.dtr=fl.Rounding=fl.daysPerMonth=void 0;var Oc=WM(),QM=cJ();function c$e(e,r,n){return(0,Oc.Dtr_DaysPerMonth)(e,r,n?1:0)}fl.daysPerMonth=c$e;var d$e;(function(e){e[e.RoundSec=0]="RoundSec",e[e.Round10ths=1]="Round10ths",e[e.Round100ths=2]="Round100ths",e[e.Round1000ths=3]="Round1000ths"})(d$e=fl.Rounding||(fl.Rounding={}));function hve(e,r,n,a,o,u,t,d,s){return{yr:e,mon:r,dom:n,hour:a,min:o,sec:u,wdy:t,fracSec:d,rounding:s}}fl.dtr=hve;function Sve(e){return hve((0,Oc.Dtr_Yr)(e),(0,Oc.Dtr_Mon)(e),(0,Oc.Dtr_DOM)(e),(0,Oc.Dtr_Hour)(e),(0,Oc.Dtr_Min)(e),(0,Oc.Dtr_Sec)(e),(0,Oc.Dtr_Wdy)(e),(0,Oc.Dtr_FracSec)(e),(0,Oc.Dtr_Rounding)(e))}function a2(e,r){(0,Oc.Dtr_Write)(r.yr,r.mon,r.dom,r.hour,r.min,r.sec,r.wdy,r.fracSec,r.rounding,e)}function f$e(e,r,n,a){var o=r,u=0,t=(0,Oc.Dtr_FromNum)(e,o,u,n?1:0,a?1:0);return t===0?Sve(u):!1}fl.fromNum=f$e;function p$e(e,r,n){var a=0;a2(a,e);var o=(0,Oc.Dtr_ToNum)(a,r?1:0,n?1:0),u=(0,Oc.Mathpack_TakeMathError)();return u===QM.MathErrorNum.None?o:(0,QM.mathError)(u)}fl.toNum=p$e;function m$e(e,r,n,a,o){var u=0;a2(u,e);var t=a,d=(0,Oc.Dtr_ToNumWithDuration)(u,r?1:0,n?1:0,t,o),s=(0,Oc.Mathpack_TakeMathError)();return s===QM.MathErrorNum.None?d:(0,QM.mathError)(s)}fl.toNumWithDuration=m$e;function g$e(e,r,n){var a=0;a2(a,e);var o=(0,Oc.Dtr_ToDays)(a,r?1:0,n?1:0);return o===0?(0,Oc.Dtr_Days)():!1}fl.toDays=g$e;var v$e;(function(e){e[e.Hour=0]="Hour",e[e.Minute=1]="Minute",e[e.Second=2]="Second"})(v$e=fl.TimeDivision||(fl.TimeDivision={}));function h$e(e,r,n){var a=r,o=n,u=(0,Oc.Dtr_ToTime)(e,a,o),t=(0,Oc.Mathpack_TakeMathError)();return t===QM.MathErrorNum.None?u:!1}fl.toTime=h$e;function S$e(e,r,n,a){var o=0;a2(o,e);var u=1;r.standardDate!=null&&a2(u,r.standardDate);var t=2;r.daylightDate!=null&&a2(t,r.daylightDate);var d=(0,Oc.Dtr_UtcToLocal)(o,r.bias,r.standardDate!=null?u:-1,r.standardBias,r.daylightDate!=null?t:-1,r.daylightBias,n?1:0,a?1:0);return d===0?!1:Sve(o)}fl.utcToLocal=S$e});var dJ=Y(cR=>{"use strict";_();Object.defineProperty(cR,"__esModule",{value:!0});cR.isSupported=cR.dtr=cR.mathpack=void 0;var y$e=cJ();cR.mathpack=y$e;var C$e=yve();cR.dtr=C$e;var _$e=qB();Object.defineProperty(cR,"isSupported",{enumerable:!0,get:function(){return _$e.isSupported}});var R$e=WM();(0,R$e._start)()});var fJ=Y(af=>{"use strict";_();Object.defineProperty(af,"__esModule",{value:!0});af.xlDatepack=af.TimeGranularity=af.TimeDivision=af.dateTime=af.Rounding=af.tzUTC=af.tzData=void 0;var u1=dJ(),Cve=Gb(),T$e=Ep();af.tzData=(0,T$e.typedInstanceCreator)()(function(e,r,n,a,o){return{bias:e,standardDate:r,standardBias:n,daylightDate:a,daylightBias:o}});af.tzUTC=(0,af.tzData)(0,void 0,0,void 0,0);af.Rounding=u1.dtr.Rounding;af.dateTime=u1.dtr.dtr;af.TimeDivision=u1.dtr.TimeDivision;var b$e;(function(e){e[e.Year=0]="Year",e[e.Day=1]="Day",e[e.Instant=2]="Instant"})(b$e=af.TimeGranularity||(af.TimeGranularity={}));function P$e(e,r,n){return u1.dtr.fromNum(e.mathpack.toNumber(r),n,e.date1904,e.dateCompatibility)}function E$e(e,r){var n=u1.dtr.toNum(r,e.date1904,e.dateCompatibility);return typeof n=="number"?e.mathpack.fromNumber(n):Cve.numErrorOper}function N$e(e,r,n,a){var o=u1.dtr.toNumWithDuration(r,e.date1904,e.dateCompatibility,n,a);return typeof o=="number"?e.mathpack.fromNumber(o):Cve.numErrorOper}function A$e(e,r){return u1.dtr.toDays(r,e.date1904,e.dateCompatibility)}function O$e(e,r,n,a){return u1.dtr.toTime(e.mathpack.toNumber(r),n,a)}function k$e(e,r,n){return u1.dtr.utcToLocal(r,n,e.date1904,e.dateCompatibility)}af.xlDatepack={fromNum:P$e,toNum:E$e,toNumWithDuration:N$e,daysPerMonth:u1.dtr.daysPerMonth,toDays:A$e,toTime:O$e,utcToLocal:k$e}});var mJ=Y(GB=>{"use strict";_();Object.defineProperty(GB,"__esModule",{value:!0});GB.xlMathpack=void 0;var ii=dJ(),_ve=Gb(),dR=og(),F$e=lC(),pJ=Ep();function Wo(e){var r={kind:F$e.OperKind.Number,_valueXL:e};return r}var Rve=Wo(ii.mathpack.zero()),I$e=Wo(ii.mathpack.one()),M$e=Wo(ii.mathpack.pi());function $c(e){return e.num&ii.mathpack.MathErrorNum.DivBy0?_ve.div0ErrorOper:_ve.numErrorOper}function aP(e){return function(r){return(0,dR.assertFalse)("calc.lang.".concat(e,": error ").concat(JSON.stringify(r)))}}function kp(e,r,n){return function(a){var o=e(a._valueXL);return typeof o=="number"?r(o):n(o)}}function s1(e,r,n){return function(a,o){var u=e(a._valueXL,o._valueXL);return typeof u=="number"?r(u):n(u)}}var w$e=s1(function(e,r){return ii.mathpack.equal(r,2)?ii.mathpack.mul(e,e):ii.mathpack.power(e,r)},Wo,$c),D$e=kp(function(e){return ii.mathpack.div(e,100)},Wo,aP("xlPercent"));function x$e(e){return Tve(e)!==0?Wo(ii.mathpack.neg(e._valueXL)):e}function L$e(e,r,n){var a=r._valueXL,o=ii.mathpack.formatGeneral(e,a,n);return typeof o!="string"?(0,dR.assertFalse)("calc.lang.xlFormatGeneral: error ".concat(JSON.stringify(o))):o}function B$e(e,r,n){var a=e._valueXL,o=ii.mathpack.formatFixed(a,r,n);return typeof o!="object"?(0,dR.assertFalse)("calc.lang.xlFormatFixed: error ".concat(JSON.stringify(o))):o}function q$e(e,r,n){var a=e._valueXL,o=ii.mathpack.formatScientific(a,r,n);return typeof o!="object"?(0,dR.assertFalse)("calc.lang.xlFormatScientific: error ".concat(JSON.stringify(o))):o}function U$e(e,r,n,a){var o=ii.mathpack.pack(e,r,n,a);return typeof o!="number"?(0,dR.assertFalse)("calc.lang.xlParse: error ".concat(JSON.stringify(o))):Wo(o)}var G$e=kp(ii.mathpack.ceil,Wo,aP("xlCeil")),K$e=kp(ii.mathpack.floor,Wo,aP("xlFloor")),Tve=kp(ii.mathpack.cond,pJ.identity,aP("xlCond, isSupported = ".concat((0,ii.isSupported)()))),V$e=s1(ii.mathpack.cond2,pJ.identity,aP("xlCond2"));function W$e(e,r){var n=e._valueXL,a=r._valueXL;return ii.mathpack.exp32(n)-ii.mathpack.exp32(a)>=52428800?Rve:r}var j$e=kp(ii.mathpack.sfix,pJ.identity,aP("xlSfix")),H$e=kp(ii.mathpack.viewRound,Wo,aP("xlViewRound"));function Q$e(e){(0,dR.assertInteger)("calc.lang.xlTenTo",e);var r=ii.mathpack.tenTo(e);return typeof r=="number"?Wo(r):$c(r)}function z$e(e){return(0,dR.assertTrue)("calc.lang.xlFromNumber",isFinite(e)),Wo(e)}function Y$e(e){var r=e._valueXL;return(0,dR.assertTrue)("calc.lang.xlToNumber",isFinite(r)),r}GB.xlMathpack={zero:Rve,one:I$e,pi:M$e,add:s1(ii.mathpack.add,Wo,$c),sub:s1(ii.mathpack.sub,Wo,$c),mul:s1(ii.mathpack.mul,Wo,$c),div:s1(ii.mathpack.div,Wo,$c),power:w$e,percent:D$e,neg:x$e,compare:function(r,n){return ii.mathpack.compare(r._valueXL,n._valueXL)},formatGeneral:L$e,formatFixed:B$e,formatScientific:q$e,parse:U$e,trunc:function(r){return Wo(ii.mathpack.trunc(r._valueXL))},ceil:G$e,floor:K$e,abs:function(r){return Wo(ii.mathpack.abs(r._valueXL))},cond:Tve,cond2:V$e,fromNumber:z$e,toNumber:Y$e,sqrt:kp(ii.mathpack.sqrt,Wo,$c),exp:kp(ii.mathpack.exp,Wo,$c),ln:kp(ii.mathpack.ln,Wo,$c),log:kp(ii.mathpack.log,Wo,$c),sin:kp(ii.mathpack.sin,Wo,$c),cos:kp(ii.mathpack.cos,Wo,$c),tan:kp(ii.mathpack.tan,Wo,$c),asin:kp(ii.mathpack.asin,Wo,$c),acos:kp(ii.mathpack.acos,Wo,$c),atan:kp(ii.mathpack.atan,Wo,$c),atan2:s1(ii.mathpack.atan2,Wo,$c),round:s1(ii.mathpack.round,Wo,$c),roundUp:s1(ii.mathpack.roundUp,Wo,$c),roundDown:s1(ii.mathpack.roundDown,Wo,$c),tenTo:Q$e,checkAlmostCancellation:W$e,fix:function(r){return ii.mathpack.fix(r._valueXL)},lfix:function(r){return ii.mathpack.lfix(r._valueXL)},sfix:j$e,viewRound:H$e}});var yJ=Y(xn=>{"use strict";_();var of,iP,oP,ri,Yh,i2;Object.defineProperty(xn,"__esModule",{value:!0});xn.getEnglishLocaleInfo=xn.createWorksheetFuncNameCallbacks=xn.getEnglishWorksheetFuncIdToName=xn.operatorIdToName=xn.englishOperatorIdToName=xn.englishErrorTypeToName=xn.englishWorksheetFuncIdToName=xn.englishSysTimeFormat=xn.englishSysDateFormat=xn.englishPictureDbnum=xn.englishPictureColor=xn.englishPictureSingle=xn.englishPictureSpecial=xn.englishSpecialRefNames=xn.englishErrorNames=xn.isIdentContinue=xn.isIdentStart=xn.getNumberShape=xn.getOrdinal=xn.isNumeral=xn.PictureDbnum=xn.PictureColor=xn.PictureSingle=xn.PictureSpecial=xn.LCID=xn.Country=xn.localeInfo=xn.calcConfig=xn.ulsLogger=xn.NulLogger=xn.TraceLevel=xn.LogCategory=void 0;var vJ=Ol();Object.defineProperty(xn,"LogCategory",{enumerable:!0,get:function(){return vJ.LogCategory}});Object.defineProperty(xn,"TraceLevel",{enumerable:!0,get:function(){return vJ.TraceLevel}});Object.defineProperty(xn,"NulLogger",{enumerable:!0,get:function(){return vJ.NulLogger}});var Pve=Ep(),fR=og();Object.defineProperty(xn,"ulsLogger",{enumerable:!0,get:function(){return fR.ulsLogger}});var gC=KA(),s2=zb(),Eve=Yb(),Nve=CY(),J$e=cve(),Fp=Gb(),o2=R0(),kc=mB(),bve=fJ(),X$e=mJ();function Z$e(e,r,n,a,o,u,t){return r===void 0&&(r=o2.RefStyle.A1),n===void 0&&(n=X$e.xlMathpack),a===void 0&&(a=!1),o===void 0&&(o=!0),u===void 0&&(u=bve.tzUTC),t===void 0&&(t=bve.xlDatepack),{localeInfo:e,refStyle:r,mathpack:n,date1904:a,dateCompatibility:o,timezone:u,datepack:t}}xn.calcConfig=Z$e;function Ave(e,r,n,a,o,u,t,d,s,c,l,f,p,m,v,h,S,y,C,E,I,F,w,B,k,x,G,H,L,D,U,V,ne,J,$,Z,ie,X,Q,b,R,P,A,T,g,O,M,K,W,z,ee,ue,ce,he,de,pe,_e,Ce,Ne,Le,Oe,le,me,Pe,Re,fe,Se,be){return{getWorksheetFuncId:e,getWorksheetFuncName:r,isNumeral:n,getOrdinal:a,getNumberShape:o,isThousandsPosition:u,isIdentStart:t,isIdentContinue:d,stringCompareCI:s,errorNames:c,specialRefNames:l,trueName:f,falseName:p,rowLetter:m,columnLetter:v,leftBrace:h,rightBrace:S,leftBracket:y,rightBracket:C,rcLeftBracket:E,rcRightBracket:I,decimalSeparator:F,listSeparator:w,columnSeparator:B,rowSeparator:k,thousandsSeparator:x,statementSeparator:G,lcid:H,country:L,isThai:D,isEastAsia:U,isKorea:V,isJapan:ne,isChinaT:J,isChinaS:$,isComplexScript:Z,numberDecimals:ie,isExpSepBySpace:X,fractionSeparator:Q,isPercentSepBySpace:b,currencyFormat:R,isCurrencySymbolLead:P,isCurrencySepBySpace:A,currencySymbol:T,currencyDecimals:g,dateOrder:O,dateSeparator:M,dateAltSeparator:K,year4Digits:W,month2Digits:z,day2Digits:ee,longDateFormat:ue,timeSeparator:ce,timeAltSeparator:he,hour2Digits:de,clock24Hour:pe,isAMPMSepBySpace:_e,ampmSymbols:Ce,dayNameShort:Ne,dayNameLong:Le,monthNameShort:Oe,monthNameLong:le,pictureSpecial:me,pictureSingle:Pe,pictureColor:Re,pictureDbnum:fe,sysDateFormat:Se,sysTimeFormat:be}}xn.localeInfo=Ave;var Ove;(function(e){e[e.USA=1]="USA",e[e.UK=44]="UK",e[e.AUS=61]="AUS",e[e.NZ=64]="NZ",e[e.UNK=1]="UNK",e[e.CAN=2]="CAN",e[e.DUT=31]="DUT",e[e.FRN=33]="FRN",e[e.SPA=34]="SPA",e[e.ITN=39]="ITN",e[e.SWE=46]="SWE",e[e.GER=49]="GER",e[e.JPN=81]="JPN",e[e.MEX=52]="MEX",e[e.BRA=55]="BRA",e[e.LAM=3]="LAM",e[e.BEL=32]="BEL",e[e.SWZ=41]="SWZ",e[e.SWG=41]="SWG",e[e.SWF=41]="SWF",e[e.AUT=43]="AUT",e[e.DAN=45]="DAN",e[e.NOR=47]="NOR",e[e.POR=351]="POR",e[e.FIN=358]="FIN",e[e.ICE=354]="ICE",e[e.GRK=30]="GRK",e[e.TUR=90]="TUR",e[e.CZE=420]="CZE",e[e.HUN=36]="HUN",e[e.POL=48]="POL",e[e.RUS=7]="RUS",e[e.HEB=972]="HEB",e[e.ARB=966]="ARB",e[e.PER=981]="PER",e[e.ARB_Algeria=213]="ARB_Algeria",e[e.ARB_Bahrain=966]="ARB_Bahrain",e[e.ARB_Djibouti=253]="ARB_Djibouti",e[e.ARB_Egypt=20]="ARB_Egypt",e[e.ARB_Iraq=964]="ARB_Iraq",e[e.ARB_Jordan=962]="ARB_Jordan",e[e.ARB_Kuwait=965]="ARB_Kuwait",e[e.ARB_Lebanon=961]="ARB_Lebanon",e[e.ARB_Libya=218]="ARB_Libya",e[e.ARB_Mauritania=222]="ARB_Mauritania",e[e.ARB_Morocco=216]="ARB_Morocco",e[e.ARB_Oman=968]="ARB_Oman",e[e.ARB_Qatar=974]="ARB_Qatar",e[e.ARB_SaudiArabia=966]="ARB_SaudiArabia",e[e.ARB_Somalia=1]="ARB_Somalia",e[e.ARB_Sudan=249]="ARB_Sudan",e[e.ARB_Syria=963]="ARB_Syria",e[e.ARB_Tunisia=216]="ARB_Tunisia",e[e.ARB_UAE=971]="ARB_UAE",e[e.ARB_Yemen=969]="ARB_Yemen",e[e.KOR=82]="KOR",e[e.TW=886]="TW",e[e.PRC=86]="PRC",e[e.THA=66]="THA",e[e.VIET=84]="VIET"})(Ove=xn.Country||(xn.Country={}));var kve;(function(e){e[e.None=0]="None",e[e.USA=1033]="USA",e[e.Greek=1032]="Greek",e[e.Hungarian=1038]="Hungarian",e[e.Turkish=1055]="Turkish",e[e.Thailand=1054]="Thailand",e[e.Vietnam=1066]="Vietnam",e[e.Arabic=1025]="Arabic",e[e.Hebrew=1037]="Hebrew",e[e.Tamil=1097]="Tamil",e[e.Syriac=1114]="Syriac",e[e.Iraq=2049]="Iraq",e[e.Algerian=5121]="Algerian",e[e.Basque=1069]="Basque",e[e.PortBrazil=1046]="PortBrazil",e[e.Croatian=1050]="Croatian",e[e.Czech=1029]="Czech",e[e.Danish=1030]="Danish",e[e.Dutch=1043]="Dutch",e[e.Australian=3081]="Australian",e[e.CanadianEnglish=4105]="CanadianEnglish",e[e.British=2057]="British",e[e.Finnish=1035]="Finnish",e[e.French=1036]="French",e[e.FrenchCanadian=3084]="FrenchCanadian",e[e.Italian=1040]="Italian",e[e.NorskBokmal=1044]="NorskBokmal",e[e.NorskNynorsk=2068]="NorskNynorsk",e[e.Polish=1045]="Polish",e[e.PortIberian=2070]="PortIberian",e[e.Romanian=1048]="Romanian",e[e.Russian=1049]="Russian",e[e.Ukrainian=1058]="Ukrainian",e[e.Belarusian=1059]="Belarusian",e[e.SerbianCyrillic=3098]="SerbianCyrillic",e[e.SerbianLatin=2074]="SerbianLatin",e[e.Slovak=1051]="Slovak",e[e.Slovenian=1060]="Slovenian",e[e.SpanishModern=3082]="SpanishModern",e[e.Swedish=1053]="Swedish",e[e.HongKong=3076]="HongKong",e[e.ChinaT=1028]="ChinaT",e[e.Korea=1042]="Korea",e[e.Japan=1041]="Japan",e[e.China=2052]="China",e[e.ChinaStroke=133124]="ChinaStroke",e[e.Devihi=1125]="Devihi",e[e.Hindi=1081]="Hindi",e[e.German=1031]="German",e[e.Swiss=4108]="Swiss",e[e.SystemTime=62464]="SystemTime",e[e.SystemLongDate=63488]="SystemLongDate",e[e.EuroTrailing=1]="EuroTrailing",e[e.EuroLeading=2]="EuroLeading",e[e.LANG=1023]="LANG",e[e.COUNTRY=64512]="COUNTRY",e[e.OPTIONS=16711680]="OPTIONS"})(kve=xn.LCID||(xn.LCID={}));var u2;(function(e){e[e.AP1=0]="AP1",e[e.AP2=1]="AP2",e[e.AP3=2]="AP3",e[e.GeneralOldMAC=3]="GeneralOldMAC",e[e.General=4]="General",e[e.Currency=5]="Currency"})(u2=xn.PictureSpecial||(xn.PictureSpecial={}));var oi;(function(e){e[e.Sep=1]="Sep",e[e.Hash=2]="Hash",e[e.Zero=3]="Zero",e[e.Decimal=4]="Decimal",e[e.Percent=5]="Percent",e[e.Comma=6]="Comma",e[e.Colon=7]="Colon",e[e.DateSep=8]="DateSep",e[e.Slash=9]="Slash",e[e.Space=10]="Space",e[e.Minus=11]="Minus",e[e.Plus=12]="Plus",e[e.OpenParen=13]="OpenParen",e[e.CloseParen=14]="CloseParen",e[e.Extra=15]="Extra",e[e.Backslash=16]="Backslash",e[e.Star=17]="Star",e[e.Year=18]="Year",e[e.Month=19]="Month",e[e.Day=20]="Day",e[e.Hour=21]="Hour",e[e.Minute=22]="Minute",e[e.Second=23]="Second",e[e.E=24]="E",e[e.APDelim=25]="APDelim",e[e.Quote=26]="Quote",e[e.ColorStart=27]="ColorStart",e[e.ColorEnd=28]="ColorEnd",e[e.Text=29]="Text",e[e.Question=30]="Question",e[e.Underscore=31]="Underscore",e[e.Reign=32]="Reign",e[e.LocDay=33]="LocDay",e[e.Era=34]="Era",e[e.EraYear=35]="EraYear",e[e.Nen1=36]="Nen1",e[e.Gatsu1=37]="Gatsu1",e[e.Nichi1=38]="Nichi1",e[e.Nen2=39]="Nen2",e[e.Gatsu2=40]="Gatsu2",e[e.Nichi2=41]="Nichi2",e[e.BidiDate=42]="BidiDate",e[e.BidiNum=43]="BidiNum",e[e.DayTh=44]="DayTh",e[e.MonthTh=45]="MonthTh",e[e.YearTh=46]="YearTh",e[e.EngYearTh=47]="EngYearTh",e[e.ThYear=48]="ThYear",e[e.HourTh=49]="HourTh",e[e.MinuteTh=50]="MinuteTh",e[e.SecondTh=51]="SecondTh",e[e.ZeroTh=52]="ZeroTh"})(oi=xn.PictureSingle||(xn.PictureSingle={}));var l1;(function(e){e[e.Black=0]="Black",e[e.White=1]="White",e[e.Red=2]="Red",e[e.Green=3]="Green",e[e.Blue=4]="Blue",e[e.Yellow=5]="Yellow",e[e.Magenta=6]="Magenta",e[e.Cyan=7]="Cyan",e[e.Color=8]="Color"})(l1=xn.PictureColor||(xn.PictureColor={}));var zM;(function(e){e[e.DBNUM1=0]="DBNUM1",e[e.DBNUM2=1]="DBNUM2",e[e.DBNUM3=2]="DBNUM3",e[e.DBNUM4=3]="DBNUM4"})(zM=xn.PictureDbnum||(xn.PictureDbnum={}));function hJ(e){var r=e|0;if(r<128)return r>=48&&r<58;var n=r&2147483632,a=r&15;switch(n){case 1632:case 1776:return a<=9;case 2400:case 2528:case 2656:case 2784:case 2912:case 3040:case 3168:case 3296:case 3424:return a>=6&&a<=15;case 3664:case 3792:case 3872:case 4160:return a<=9;case 4960:return a>=9;case 4976:return a<=1;case 6112:case 6160:return a<=9;default:return!1}}xn.isNumeral=hJ;function Fve(e){var r=e|0;if(r<128)return(r<48||r>=58)&&(0,fR.assertFalse)("calc.config.getOrdinal"),r&15;var n=r&2147483632,a=r&15,o;switch(n){case 1632:case 1776:o=a;break;case 2400:case 2528:case 2656:case 2784:case 2912:case 3040:case 3168:case 3296:case 3424:o=a-6;break;case 3664:case 3792:case 3872:case 4160:o=a;break;case 4960:o=a-8;break;case 4976:o=a+8;break;case 6112:case 6160:o=a;break;default:return(0,fR.assertFalse)("calc.config.getOrdinal")}return(o<0||o>9||r===4968)&&(0,fR.assertFalse)("calc.config.getOrdinal"),o}xn.getOrdinal=Fve;function Ive(e){var r=e|0;if(r<128)return(r<48||r>=58)&&(0,fR.assertFalse)("calc.config.getNumberShape"),kc.NumberShape.ASCII;switch(hJ(r)||(0,fR.assertFalse)("calc.config.getNumberShape"),r&2147483632){case 1632:return kc.NumberShape.ArabicIndic;case 1776:return kc.NumberShape.ExtendedArabicIndic;case 2400:return kc.NumberShape.Devanagari;case 2528:return kc.NumberShape.Bengali;case 2656:return kc.NumberShape.Gurmukhi;case 2784:return kc.NumberShape.Gujarati;case 2912:return kc.NumberShape.Oriya;case 3040:return kc.NumberShape.Tamil;case 3168:return kc.NumberShape.Telugu;case 3296:return kc.NumberShape.Kannada;case 3424:return kc.NumberShape.Malayalam;case 3664:return kc.NumberShape.Thai;case 3792:return kc.NumberShape.Lao;case 3872:return kc.NumberShape.Tibetan;case 4160:return kc.NumberShape.Myanmar;case 4960:case 4976:return kc.NumberShape.Ethiopic;case 6112:return kc.NumberShape.Khmer;case 6160:return kc.NumberShape.Mongolian;default:return(0,fR.assertFalse)("calc.config.getNumberShape")}}xn.getNumberShape=Ive;function Mve(e){return((0,Nve.getCharCodeBits)(e)&Eve.CharCodeBits.IdentStartClass)!==0}xn.isIdentStart=Mve;function wve(e){return((0,Nve.getCharCodeBits)(e)&Eve.CharCodeBits.IdentContinueClass)!==0}xn.isIdentContinue=wve;xn.englishErrorNames=(0,s2.partialArray)((of={},of[Fp.ErrorType.NULL]="#NULL!",of[Fp.ErrorType.DIV0]="#DIV/0!",of[Fp.ErrorType.VALUE]="#VALUE!",of[Fp.ErrorType.REF]="#REF!",of[Fp.ErrorType.NAME]="#NAME?",of[Fp.ErrorType.NUM]="#NUM!",of[Fp.ErrorType.NA]="#N/A",of[Fp.ErrorType.GETTING_DATA]="#GETTING_DATA",of[Fp.ErrorType.SPILL]="#SPILL!",of[Fp.ErrorType.CONNECT]="#CONNECT!",of[Fp.ErrorType.BLOCKED]="#BLOCKED!",of[Fp.ErrorType.UNKNOWN]="#UNKNOWN!",of[Fp.ErrorType.FIELD]="#FIELD!",of[Fp.ErrorType.CALC]="#CALC!",of[Fp.ErrorType.BUSY]="#BUSY!",of[Fp.ErrorType.EXTERNAL]="#EXTERNAL!",of));xn.englishSpecialRefNames=(0,s2.partialArray)((iP={},iP[o2.SpecialRefId.All]="#All",iP[o2.SpecialRefId.Data]="#Data",iP[o2.SpecialRefId.Headers]="#Headers",iP[o2.SpecialRefId.Totals]="#Totals",iP[o2.SpecialRefId.ThisRow]="#This Row",iP));xn.englishPictureSpecial=(0,s2.partialArray)((oP={},oP[u2.AP1]="AM/PM",oP[u2.AP2]="A/P",oP[u2.AP3]="\u4E0A\u5348/\u4E0B\u5348",oP[u2.General]="General",oP[u2.Currency]="$",oP));xn.englishPictureSingle=(0,s2.partialArray)((ri={},ri[oi.Sep]=";",ri[oi.Hash]="#",ri[oi.Zero]="0",ri[oi.Decimal]=".",ri[oi.Percent]="%",ri[oi.Comma]=",",ri[oi.Colon]=":",ri[oi.DateSep]="/",ri[oi.Slash]="/",ri[oi.Space]=" ",ri[oi.Minus]="-",ri[oi.Plus]="+",ri[oi.OpenParen]="(",ri[oi.CloseParen]=")",ri[oi.Backslash]="\\",ri[oi.Star]="*",ri[oi.Year]="y",ri[oi.Month]="m",ri[oi.Day]="d",ri[oi.Hour]="h",ri[oi.Minute]="m",ri[oi.Second]="s",ri[oi.E]="E",ri[oi.APDelim]="/",ri[oi.Quote]='"',ri[oi.ColorStart]="[",ri[oi.ColorEnd]="]",ri[oi.Text]="@",ri[oi.Question]="?",ri[oi.Underscore]="_",ri[oi.Reign]="r",ri[oi.LocDay]="a",ri[oi.Era]="g",ri[oi.EraYear]="e",ri[oi.BidiDate]="B",ri[oi.BidiNum]="N",ri[oi.DayTh]="\u0E27",ri[oi.MonthTh]="\u0E14",ri[oi.YearTh]="\u0E1B",ri[oi.EngYearTh]="b",ri[oi.ThYear]="\u0E04",ri[oi.HourTh]="\u0E0A",ri[oi.MinuteTh]="\u0E19",ri[oi.SecondTh]="\u0E17",ri[oi.ZeroTh]="\u0E50",ri));xn.englishPictureColor=(0,s2.partialArray)((Yh={},Yh[l1.Black]="Black",Yh[l1.White]="White",Yh[l1.Red]="Red",Yh[l1.Green]="Green",Yh[l1.Blue]="Blue",Yh[l1.Yellow]="Yellow",Yh[l1.Magenta]="Magenta",Yh[l1.Cyan]="Cyan",Yh[l1.Color]="Color",Yh));xn.englishPictureDbnum=(0,s2.partialArray)((i2={},i2[zM.DBNUM1]="DBNum1",i2[zM.DBNUM2]="DBNum2",i2[zM.DBNUM3]="DBNum3",i2[zM.DBNUM4]="DBNum4",i2));xn.englishSysDateFormat="dddd, mmmm dd, yyyy";xn.englishSysTimeFormat="h:mm:ss AM/PM";var KB=void 0;function $$e(e){var r=SJ()[e];return r===void 0?"wsf:".concat(e):r}xn.englishWorksheetFuncIdToName=$$e;function eer(e){var r=xn.englishErrorNames[e];return r===void 0?"error.type:".concat(e):r}xn.englishErrorTypeToName=eer;function rer(e){if(e===gC.OperatorId.Isect)return" ";if(e===gC.OperatorId.Union)return",";var r=gC.operatorStrings[e];return r===void 0?"op:".concat(e):r}xn.englishOperatorIdToName=rer;function ner(e,r,n){return r===gC.OperatorId.Isect?n:r===gC.OperatorId.Union?e.listSeparator:gC.operatorStrings[r]}xn.operatorIdToName=ner;var ter=/_/g;function SJ(){if(KB==null){KB=[];for(var e=0,r=(0,Pve.numEnumArray)(gC.WorksheetFuncId);e<r.length;e++){var n=r[e],a=(0,gC.getWorksheetFuncEnglishName)(n),o=a??gC.WorksheetFuncId[n].replace(ter,".");KB[n]=o}}return KB}xn.getEnglishWorksheetFuncIdToName=SJ;function aer(e,r){var n=[];return r.forEach(function(a,o){a!=null&&n.push([a,o])}),J$e.ArrayMapTree.create(e).setValues(n)}function Dve(e,r){var n=aer(e,r);return{getWorksheetFuncId:function(o){return n.getValue(o)},getWorksheetFuncName:function(o){var u=r[o];return u??(0,fR.assertFalse)("calc.config.getWorksheetFuncName: unknown function ID ".concat(o))}}}xn.createWorksheetFuncNameCallbacks=Dve;var gJ=void 0;function ier(){return gJ==null&&(gJ=oer()),gJ}xn.getEnglishLocaleInfo=ier;function oer(){var e="en-US",r=SJ(),n=(0,Pve.makeStringCompareCI)(e),a=Dve(n,r),o=a.getWorksheetFuncId,u=a.getWorksheetFuncName;return Ave(o,u,hJ,Fve,Ive,function(t){return t>0&&t%3===0},Mve,wve,n,xn.englishErrorNames,xn.englishSpecialRefNames,"TRUE","FALSE","R","C","{","}","[","]","[","]",".",",",",",";",",",";",kve.USA,Ove.USA,!1,!1,!1,!1,!1,!1,!1,2,!1," ",!1,kc.CurrencyFormat.Paren,!0,!1,"$",2,kc.DateOrder.MDY,"/","-",!0,!1,!1,!0,":",void 0,!1,!1,!0,["AM","PM"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],xn.englishPictureSpecial,xn.englishPictureSingle,xn.englishPictureColor,xn.englishPictureDbnum,xn.englishSysDateFormat,xn.englishSysTimeFormat)}});var CJ=Y(l2=>{"use strict";_();Object.defineProperty(l2,"__esModule",{value:!0});l2.formatScientificLeft=l2.numberComponents=void 0;var uer=Ep();l2.numberComponents=(0,uer.typedInstanceCreator)()(function(e,r,n){return{sign:e,mantissa:r,exponent:n}});function ser(e,r){if(r<=1)return r;var n=e%r;return n===0?r:n<0?n+r:n}l2.formatScientificLeft=ser});var xve=Y(VB=>{"use strict";_();Object.defineProperty(VB,"__esModule",{value:!0});VB.relabelFormula=void 0;var om=br(),vt=R0(),ler=$A();function cer(){var e=1;return function(){return e++}}function der(e,r){r===void 0&&(r=cer());var n=e.spans,a=e.annotations,o=e.depthUpperBound,u=[],t=[],d=[],s=[];function c(b){var R=r(),P=n[b];P!=null&&(u[R]=P);var A=a[b];return A!=null&&(t[R]=A),d[b]=R,s[R]=b,R}function l(b){return om.__assign(om.__assign({},b),{label:c(b.label)})}function f(b){if(b.kind===vt.CellRefKind.Range){var R=b;return(0,vt.cellRefRange)(f(R.ref1),f(R.ref2),c(b.label))}return om.__assign(om.__assign({},b),{label:c(b.label)})}function p(b){return b!=null?(0,vt.documentQualifier)(b.document,b.path,b.isQuoted,c(b.label)):void 0}function m(b){if(b!=null)return b.kind===vt.QualifierKind.Sheet||b.kind===vt.QualifierKind.SheetRange?om.__assign(om.__assign({},b),{document:p(b.document),label:c(b.label)}):om.__assign(om.__assign({},b),{label:c(b.label)})}function v(b){if(b!=null)return b.kind===vt.QualifierKind.Sheet||b.kind===vt.QualifierKind.SheetRange?om.__assign(om.__assign({},b),{document:p(b.document),label:c(b.label)}):om.__assign(om.__assign({},b),{label:c(b.label)})}function h(b){var R=(0,vt.flattenNameParts)(b),P=function(ce,he){var de=he.rhs,pe=he.canDenoteNamedObject,_e=he.label,Ce=he.qualifiedLabel;return(0,vt.fieldRefNamePart)(ce,y(de),pe,c(_e),c(Ce))};if(R.kind===vt.NamePartKind.IdentNamePart){var A=R.parts,T=A[0],g=A.slice(1),O=(0,vt.identNamePart)(T.asWhole,T.canDenoteNamedObject,c(T.label),c(T.qualifiedLabel));return g.reduce(P,O)}var M=R.parts,K=M[0],W=M[1],z=M.slice(2),ee=(0,vt.cellRefNamePart)(f(K.ref),K.asWhole,c(K.label),c(K.qualifiedLabel));return z.reduce(P,P(ee,W))}function S(b){switch(b.kind){case vt.NodeKind.Ident:return F(b);case vt.NodeKind.Missing:return(0,vt.missingNode)(b.chars,c(b.label));case vt.NodeKind.BadChars:return(0,vt.badCharsNode)(b.type,b.chars,c(b.label))}}function y(b){return(0,vt.fieldRef)(S(b.field),b.isBracketed,b.isClosed,c(b.label))}function C(b){switch(b==null?void 0:b.kind){case void 0:return;case vt.StructRefKind.SpecialRef:return(0,vt.specialRef)(b.id,b.isBracketed,b.isClosed,c(b.label));case vt.StructRefKind.ColumnRef:return(0,vt.columnRef)(b.name,b.isBracketed,b.isClosed,c(b.label));case vt.StructRefKind.RangeOpRef:return(0,vt.rangeOpRef)(C(b.lhs),C(b.rhs),c(b.label));case vt.StructRefKind.CommaOpRef:return(0,vt.commaOpRef)(b.refs.map(C),c(b.label));case vt.StructRefKind.ThisRowOpRef:return(0,vt.thisRowOpRef)(b.ref!==void 0?C(b.ref):void 0,c(b.label));case vt.StructRefKind.MissingRef:return(0,vt.missingRef)(c(b.label));case vt.StructRefKind.BadRef:return(0,vt.badRef)(b.chars,b.isBracketed,b.isClosed,c(b.label))}}function E(b,R,P){return(0,vt.nameNode)(h(b),v(R),c(P))}function I(b){var R=b.parts,P=b.qualifier,A=b.label;return E(R,P,A)}function F(b){var R=b.whole,P=b.label;return(0,vt.identNode)(R,c(P))}function w(b){var R=b.name,P=b.label;return(0,vt.varNode)(F(R),c(P))}function B(b){switch(b.kind){case vt.NodeKind.Ident:return F(b);case vt.NodeKind.Missing:return(0,vt.missingNode)(b.chars,c(b.label));case vt.NodeKind.BadChars:return(0,vt.badCharsNode)(b.type,b.chars,c(b.label))}}function k(b){var R=(0,vt.paramName)(B(b.name.name),b.name.isBracketed,b.name.isClosed,c(b.name.label)),P=b.def===void 0?void 0:(0,vt.paramDefault)(b.def.rhs,c(b.def.label));return(0,vt.paramNode)(R,P,c(b.label))}function x(b){return(0,vt.structRef)(C(b.innerRef),b.isClosed,c(b.label))}for(var G={literalNode:function(R,P,A){return(0,vt.literalNode)(R,P,c(A))},arrayNode:function(R,P,A){return(0,vt.arrayNode)(R,P,c(A))},appNode:function(R,P,A,T){return(0,vt.appNode)(R,P,A,c(T))},letNode:function(R,P,A,T,g,O){return(0,vt.letNode)(R,P.map(function(M){var K=M.name,W=M.binder;return(0,vt.letVar)((0,vt.indexedArg)(w(K.arg),K.index),W)}),A,T,g,c(O))},lambdaNode:function(R,P,A,T,g,O){return(0,vt.lambdaNode)(R,P.map(function(M){var K=M.name;return(0,vt.lambdaParam)((0,vt.indexedArg)(k(K.arg),K.index))}),A,T,g,c(O))},parenNode:function(R,P,A){return(0,vt.parenNode)(R,P,c(A))},nameNode:function(R,P,A){return E(R,P,A)},cellRefNode:function(R,P,A){return(0,vt.cellRefNode)(f(R),m(P),c(A))},fieldRefNode:function(R,P,A,T){return(0,vt.fieldRefNode)(R,y(P),A,c(T))},structRefNode:function(R,P,A){return(0,vt.structRefNode)(R===void 0?void 0:I(R),x(P),c(A))},missingNode:function(R,P){return(0,vt.missingNode)(R,c(P))},badSequenceNode:function(R,P,A){return(0,vt.badSequenceNode)(R,P,c(A))},badCharsNode:function(R,P,A){return(0,vt.badCharsNode)(R,P,c(A))},operatorNode:function(R,P){return(0,vt.operatorNode)(R,c(P))},wsfNode:function(R,P,A){return(0,vt.wsfNode)(R,P,c(A))}},H=(0,vt.formula)((0,ler.reduceBottomUp)(G,e),u,t,o),L=0,D=Object.keys(t);L<D.length;L++){var U=D[L],V=Number(U),ne=t[V];switch(ne==null?void 0:ne.kind){case vt.AnnotationKind.LocalNameUse:t[V]=(0,vt.localNameUseAnnotation)(ne.name,ne.whole,d[ne.label]);break;case vt.AnnotationKind.LocalNameDecl:t[V]=(0,vt.localNameDeclAnnotation)(ne.name,ne.whole,ne.uses.map(function(b){var R=b.label;return{label:d[R]}}));break}}for(var J=0,$=Object.keys(u).map(Number);J<$.length;J++){var Z=$[J],ie=u[Z],X=ie==null?void 0:ie.preComments,Q=ie==null?void 0:ie.postComments;(X||Q)&&(u[Z]=om.__assign(om.__assign({},ie),{preComments:X?X.map(l):void 0,postComments:Q?Q.map(l):void 0}))}return{formula:H,oldToNewLabel:d,newToOldLabel:s}}VB.relabelFormula=der});var Uve=Y(jB=>{"use strict";_();Object.defineProperty(jB,"__esModule",{value:!0});jB.ieeeMathpack=void 0;var WB=Gb(),fer=Ep(),pR=CJ(),per=DM(),mer=zb(),Lve=og(),ger=lC(),ver=Yb(),Bve=per.codePointDigitZero;function tp(e){var r={kind:ger.OperKind.Number,_valueIEEE:e};return r}var uP=tp(0),her=tp(1),Ser=tp(Math.PI);function np(e){return isFinite(e)?tp(e):WB.numErrorOper}function yer(e,r){var n=e._valueIEEE,a=r._valueIEEE;return a===0?WB.div0ErrorOper:np(n/a)}function Cer(e,r){var n=e._valueIEEE,a=r._valueIEEE,o=Math.pow(n,a);return isFinite(o)?tp(o):isNaN(o)?WB.div0ErrorOper:WB.numErrorOper}function _J(e,r){var n=e._valueIEEE,a=r._valueIEEE;return n<a?-1:n>a?1:0}function _er(e,r,n){var a=e.decimalSeparator,o=r._valueIEEE,u=String(o).replace("e","E");return a!=="."&&(u=u.replace(".",a)),u}function Rer(e){for(var r=0;r<e.length;r+=1)if(e.charCodeAt(r)!==Bve)return!1;return!0}function sP(e,r){var n=r===void 0?e.toExponential():e.toExponential(r),a=n.indexOf("e"),o=!(0,mer.stringStartsWith)(n,"-"),u=n.substring(o?0:1,a).replace(".",""),t=parseInt(n.substring(a+1),10)+1;return Rer(u)?{sign:o,mantissa:"",exponent:0}:{sign:o,mantissa:u,exponent:t}}function Ter(e,r,n){var a,o=e._valueIEEE,u=sP(o),t=u.sign,d=u.mantissa,s=u.exponent,c=n+(s+r);if(c===0){var l=parseFloat("5e"+String(s-1));if(Math.abs(o)>=l)return(0,pR.numberComponents)(t,"1",s+r+1)}if(c<1)return(0,pR.numberComponents)(!0,"",0);c<=21&&(a=sP(o,c-1),t=a.sign,d=a.mantissa,s=a.exponent,c=n+(s+r));var f=d.substring(0,c);return(0,pR.numberComponents)(t,f,f.length===0?0:s+r)}function ber(e,r,n){var a,o=e._valueIEEE,u=sP(o),t=u.sign,d=u.mantissa,s=u.exponent,c=(0,pR.formatScientificLeft)(s,r),l=c+n;if((0,Lve.assertTrue)("calc.lang.ieeeFormatScientific",l>0),l===0){var f=parseFloat("5e"+String(s-1));if(Math.abs(o)>=f)return(0,pR.numberComponents)(t,"",s+1)}if(l<1)return(0,pR.numberComponents)(!0,"",0);l<=21&&(a=sP(o,l-1),t=a.sign,d=a.mantissa,s=a.exponent,c=(0,pR.formatScientificLeft)(s,r),l=c+n);var p=d.substring(0,l);return(0,pR.numberComponents)(t,p,p.length===0?0:s)}var Per=["0","1","2","3","4","5","6","7","8","9"];function Eer(e,r){for(var n=e.getOrdinal,a="",o=0,u=(0,ver.codePointIterator)(r);o<u.length;o++){var t=u[o];a+=Per[n(t)]}return a}function Ner(e,r,n,a){return tp(+((r?"":"-")+"0."+Eer(e,a)+"E"+String(n)))}function YM(e){var r=e._valueIEEE;return tp(r<0?Math.ceil(r):Math.floor(r))}function qve(e){var r=e._valueIEEE;return tp(Math.floor(r))}function Aer(e){var r=e._valueIEEE;return tp(Math.ceil(r))}function Oer(e,r){var n=e._valueIEEE;if(n===0)return uP;var a=sP(n).exponent,o=YM(r)._valueIEEE+a;if(o===0){var u=parseFloat("5e"+String(a-1));if(Math.abs(n)>=u)return np((n<0?-1:1)*parseFloat("10e"+String(a-1)))}return o<1?uP:o>21?e:np(parseFloat(n.toExponential(o-1)))}function RJ(e){return e.substring(0,1)+"."+e.substring(1)}function ker(e,r){if(e.length<=r)return RJ(e);for(var n=e.substring(0,r),a=0,o=n.length-1;o>=0&&n.charCodeAt(o)-Bve===9;o-=1)a+=1;if(a===n.length)return"10";var u=n.substring(0,n.length-a-1)+String.fromCharCode(n.charCodeAt(n.length-a-1)+1);return RJ(u)}function Fer(e,r){var n=e._valueIEEE;if(n===0)return uP;var a=sP(n),o=a.sign,u=a.mantissa,t=a.exponent,d=YM(r)._valueIEEE+t;return d<1?np(parseFloat((o?"":"-")+"10e"+String(t-1-d))):d>21?e:np(parseFloat((o?"":"-")+ker(u,d)+"e"+String(t-1)))}function Ier(e,r){var n=e._valueIEEE;if(n===0)return uP;var a=sP(n),o=a.sign,u=a.mantissa,t=a.exponent,d=YM(r)._valueIEEE+t;if(d<1)return uP;if(d>21)return e;var s=u.substring(0,d);return np(parseFloat((o?"":"-")+RJ(s)+"e"+String(t-1)))}function Mer(e){return(0,Lve.assertInteger)("calc.lang.ieeeTenTo",e),np(Math.pow(10,e))}function wer(e){var r=e._valueIEEE,n=Math.abs(r);return n>=4294967296?4294967295:Math.floor(n)}function Der(e){var r=YM(e)._valueIEEE;return r<-2147483648||r>2147483647?-2147483648:r}function xer(e){var r=qve(e)._valueIEEE;return r<-2147483648?-2147483648:r>2147483647?2147483647:r}jB.ieeeMathpack={zero:uP,one:her,pi:Ser,add:function(r,n){return np(r._valueIEEE+n._valueIEEE)},sub:function(r,n){return np(r._valueIEEE-n._valueIEEE)},mul:function(r,n){return np(r._valueIEEE*n._valueIEEE)},div:yer,power:Cer,percent:function(r){return tp(r._valueIEEE/100)},neg:function(r){return tp(-r._valueIEEE)},compare:_J,formatGeneral:_er,formatFixed:Ter,formatScientific:ber,parse:Ner,trunc:YM,ceil:Aer,floor:qve,abs:function(r){return tp(Math.abs(r._valueIEEE))},cond:function(r){return _J(r,uP)},cond2:_J,fromNumber:tp,toNumber:function(r){return r._valueIEEE},sqrt:function(r){return np(Math.sqrt(r._valueIEEE))},exp:function(r){return np(Math.exp(r._valueIEEE))},ln:function(r){return np(Math.log(r._valueIEEE))},log:function(r){return np(Math.log(r._valueIEEE)/Math.LN10)},sin:function(r){return tp(Math.sin(r._valueIEEE))},cos:function(r){return tp(Math.cos(r._valueIEEE))},tan:function(r){return tp(Math.tan(r._valueIEEE))},asin:function(r){return np(Math.asin(r._valueIEEE))},acos:function(r){return np(Math.acos(r._valueIEEE))},atan:function(r){return np(Math.atan(r._valueIEEE))},atan2:function(r,n){return tp(Math.atan2(n._valueIEEE,r._valueIEEE))},round:Oer,roundUp:Fer,roundDown:Ier,tenTo:Mer,checkAlmostCancellation:function(r,n){return n},fix:wer,lfix:Der,sfix:xer,viewRound:fer.identity}});var Gve=Y(c1=>{"use strict";_();Object.defineProperty(c1,"__esModule",{value:!0});c1.kindAnonymizers=c1.anonymizeMagnitude=c1.anonymizeFormulaString=c1.anonymize=void 0;var HB=Cn();c1.anonymize=HB.anonymizer.anonymize;c1.anonymizeFormulaString=HB.anonymizer.anonymizeFormulaString;c1.anonymizeMagnitude=HB.anonymizer.anonymizeMagnitude;c1.kindAnonymizers=HB.anonymizer.kindAnonymizers});var Vve=Y(c2=>{"use strict";_();Object.defineProperty(c2,"__esModule",{value:!0});c2.entry=c2.makeEmptyTable=void 0;var Kve=Cn();c2.makeEmptyTable=Kve.table.makeEmptyTable;c2.entry=Kve.table.entry});var TJ=Y(mR=>{"use strict";_();Object.defineProperty(mR,"__esModule",{value:!0});mR.printLocalsName=mR.printLocalsGrid=mR.createSimplePrintGlobals=void 0;var QB=sv(),T0=Wb(),Ler=t1(),Ber=function(){function e(r){this.config=r}return e.prototype.getDocumentLoc=function(r,n){return(0,T0.success)((0,QB.documentLoc)(r,n))},e.prototype.getSheetIndex=function(r,n){return(0,T0.success)(n)},e.prototype.getSheetName=function(r,n){return(0,T0.success)(n)},e.prototype.getNameLoc=function(r,n){return(0,T0.success)(n.indexOf(".")>=0?void 0:(0,QB.nameLoc)(r,n))},e.prototype.getUserDefinedFuncLoc=function(r,n){return(0,T0.success)([(0,QB.userDefinedFuncLoc)(r,n)])},e.prototype.getSheetRangeIndexes=function(r){if(r.index===void 0)return(0,T0.failure)((0,Ler.notImplemented)(["simplePrintGlobals.getSheetRangeIndexes"]));var n=[r.index];return r.index2!==r.index&&n.push(r.index2),(0,T0.success)((0,QB.sheetRangeIndexes)(n,0))},e.prototype.getContainingTable=function(r){return T0.successUndefined},e.prototype.getStructRefColumn=function(r,n){return T0.successUndefined},e.prototype.getStructRefSpecialRef=function(r,n){return T0.successUndefined},e.prototype.getNamedRanges=function(r){return(0,T0.success)([])},e}();function qer(e){return new Ber(e)}mR.createSimplePrintGlobals=qer;function Uer(e,r,n){return{config:n??void 0,lexicalSource:e,originGridCell:(0,T0.success)(r.range),originSheet:(0,T0.success)(r.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1,printAbsoluteReferences:!1}}mR.printLocalsGrid=Uer;function Ger(e,r,n){return{config:n??void 0,lexicalSource:e,originGridCell:(0,T0.success)(r.range),originSheet:(0,T0.success)(r.sheet),allowUnqualifiedCell:!1,wrapCellReferences:!0,printAbsoluteReferences:!0}}mR.printLocalsName=Ger});var Yve=Y(p2=>{"use strict";_();Object.defineProperty(p2,"__esModule",{value:!0});p2.createPrinter=p2.anonymizeFormula=void 0;var vC=br(),On=R0(),Wve=Gb(),JM=KA(),cP=og(),Cu=t1(),dv=sv(),ZM=yJ(),Qve=Gve(),d1=GM(),YB=zb(),hC=KM(),Ker=OB(),Fl=Wb(),d2=$A(),XM=lC(),Ver=Vve(),bJ=TJ(),SC=Yb(),Wer=/"/g,jer=(0,dv.sheetGridCell)((0,dv.sheetIndex)((0,dv.documentLoc)(void 0,"Book1"),0),(0,dv.gridCell)(0,0));function PJ(e){if(!(0,Fl.isSuccess)(e)&&e.reason.kind!==hC.ResolveReasonKind.NoOriginSheet&&e.reason.kind!==hC.ResolveReasonKind.InvalidQualifier&&e.reason.kind!==hC.ResolveReasonKind.InvalidCellRef&&e.reason.kind!==hC.ResolveReasonKind.InvalidStructRef&&e.reason.kind!==hC.ResolveReasonKind.EmptyIntersection)throw new lP(e.reason)}var Lu;(function(e){e[e.Original=0]="Original",e[e.Bracketed=1]="Bracketed",e[e.Unbracketed=2]="Unbracketed"})(Lu||(Lu={}));function EJ(e){for(var r=[],n=[],a=0,o=e;a<o.length;a++){var u=o[a];u.length>0&&(0,SC.numCodeUnits)((0,SC.stringCodePointAt)(u,0))===u.length?r[(0,SC.stringCodePointAt)(u,0)]=!0:n.push(u)}return function(t,d){var s=(0,SC.stringCodePointAt)(t,d);if(r[s]===!0)return!0;for(var c=0,l=n;c<l.length;c++){var f=l[c];if((0,YB.stringStartsWith)(t,f,d))return!0}return!1}}function jve(e,r){for(var n="",a=0;a<e.length;){r(e,a)&&(n+="'");var o=(0,SC.stringCodePointAt)(e,a);n+=(0,SC.stringFromCodePoint)(o),a+=(0,SC.numCodeUnits)(o)}return n}function Her(e,r){for(var n=0;n<e.length;){if(r(e,n))return!0;n+=(0,SC.numCodeUnits)((0,SC.stringCodePointAt)(e,n))}return!1}var Qer={literalNode:function(r,n,a){return a},arrayNode:function(r,n,a){return a},appNode:function(r,n,a,o){return o},letNode:function(r,n,a,o,u,t){return t},lambdaNode:function(r,n,a,o,u,t){return t},parenNode:function(r,n,a){return a},nameNode:function(r,n,a){return a},cellRefNode:function(r,n,a){return a},fieldRefNode:function(r,n,a,o){return o},structRefNode:function(r,n,a){return a},missingNode:function(r,n){return n},badSequenceNode:function(r,n,a){return a},badCharsNode:function(r,n,a){return a},operatorNode:function(r,n){return n},wsfNode:function(r,n,a){return a}},zer=vC.__assign(vC.__assign({},(0,d2.constVisitor)(void 0)),{operatorNode:function(r){return r}}),Yer=function(){function e(r,n,a,o){var u=this,t,d,s,c;this.root=a,this.anonymize=o,this.anon=function(p){return u.anonymize?(0,Qve.anonymizeFormulaString)(p):p},this.locals=n,this.localeInfo=(d=(t=n.config)===null||t===void 0?void 0:t.localeInfo)!==null&&d!==void 0?d:r.config.localeInfo,this.mathpack=r.config.mathpack,this.refStyle=(c=(s=n.config)===null||s===void 0?void 0:s.refStyle)!==null&&c!==void 0?c:r.config.refStyle,this.resolver=(0,Ker.createResolver)(r),this.spans=a.spans,this.annotations=a.annotations;var l=["'",this.localeInfo.leftBracket,this.localeInfo.rightBracket,"#","@"],f=vC.__spreadArray(vC.__spreadArray([],l,!0),["	","\n","\r"," ","!",'"',"$","%","&","(",")","*","+",this.localeInfo.listSeparator,"-",".","/",":",";","<","=",">","?","\\","^","_","`","{","}","~"],!1);this.isStructRefEscapable=EJ(l),this.isStructRefBracketedThisRef=EJ(f),this.isFieldRefEscapable=EJ(["'",this.localeInfo.leftBracket,this.localeInfo.rightBracket])}return e.prototype.print=function(){var r=new d2.ZipVisitor({str:this,label:Qer,op:zer});return"="+this.pre(this.root.node.label,"")+(0,d2.reduceBottomUp)(r,this.root).str+this.postIfComments(this.root.node.label)},e.prototype.pre=function(r,n){var a,o;return this.anonymize?n:(o=(a=this.spans[r])===null||a===void 0?void 0:a.pre)!==null&&o!==void 0?o:n},e.prototype.post=function(r,n){var a,o;return this.anonymize?n:(o=(a=this.spans[r])===null||a===void 0?void 0:a.post)!==null&&o!==void 0?o:n},e.prototype.preIfComments=function(r){if(this.anonymize)return"";var n=this.spans[r];return(n==null?void 0:n.preComments)!=null&&n.preComments.length>0?n.pre:""},e.prototype.postIfComments=function(r){if(this.anonymize)return"";var n=this.spans[r];return(n==null?void 0:n.postComments)!=null&&n.postComments.length>0?n.post:""},e.prototype.printRef=function(r,n){var a="";switch(r.kind){case On.StructRefKind.SpecialRef:{(n===Lu.Original&&r.isBracketed||n===Lu.Bracketed)&&(a+=this.localeInfo.leftBracket);var o=this.localeInfo.specialRefNames[r.id];if(o==null)throw new lP((0,Cu.internal)("No locale data for specialRefName"));a+=o,(n===Lu.Original&&r.isBracketed&&r.isClosed||n===Lu.Bracketed)&&(a+=this.localeInfo.rightBracket);break}case On.StructRefKind.ColumnRef:{var u=r.name.length===0||(0,YB.stringStartsWith)(r.name," ")||(0,YB.stringEndsWith)(r.name," ");(n===Lu.Original&&r.isBracketed||n===Lu.Bracketed||n===Lu.Unbracketed&&u)&&(a+=this.localeInfo.leftBracket);var t=jve(r.name,this.isStructRefEscapable);a+=this.anon(t),(n===Lu.Original&&r.isBracketed&&r.isClosed||n===Lu.Bracketed||n===Lu.Unbracketed&&u)&&(a+=this.localeInfo.rightBracket);break}case On.StructRefKind.RangeOpRef:{a+=this.printRef(r.lhs,n===Lu.Original?n:Lu.Bracketed)+":"+this.printRef(r.rhs,n===Lu.Original?n:Lu.Bracketed);break}case On.StructRefKind.MissingRef:break;case On.StructRefKind.BadRef:r.isBracketed&&(a+=this.localeInfo.leftBracket),a+=this.anon(r.chars),r.isBracketed&&r.isClosed&&(a+=this.localeInfo.rightBracket);break}return a},e.prototype.printThisRowOpRef=function(r){var n="@";return r&&(r.kind===On.StructRefKind.ColumnRef?n+=this.printRef(r,r.isClosed?Her(r.name,this.isStructRefBracketedThisRef)?Lu.Bracketed:Lu.Unbracketed:Lu.Original):n+=this.printRef(r,(0,Cu.isRangeOpClosed)(r)&&(0,Cu.isRangeOpNoMissing)(r)?Lu.Bracketed:Lu.Original)),n},e.prototype.printApplication=function(r,n,a){var o=this,u=n.map(function(t,d,s){return o.pre(t.label,d===0||t.str===""?"":" ")+t.str+(d===s.length-1?o.post(t.label,""):o.postIfComments(t.label))});return r.str+"("+u.join(this.localeInfo.listSeparator)+(a?")":"")},e.prototype.printCellRef=function(r){var n=r.ref,a=r.qualifier;return(a!==void 0?(0,d2.visitQualifier)(this,a)+this.postIfComments(a.label):"")+(0,d2.visitCellRef)(this,n)},e.prototype.printName=function(r){var n=r.whole,a=r.qualifier;return(a!==void 0?(0,d2.visitQualifier)(this,a)+this.postIfComments(a.label):"")+this.anon(n)},e.prototype.printUnanonymisedDocQual=function(r){if(r===void 0)return"";var n=r.path,a=r.document;return(n??"")+this.localeInfo.leftBracket+a+this.localeInfo.rightBracket},e.prototype.printOptionalParamName=function(r){return r.kind===On.NodeKind.Ident?this.anon((0,Cu.getBoundName)(this.localeInfo,r.whole)):this.pre(r.label,"")+this.anon(r.chars)+this.post(r.label,"")},e.prototype.literalNode=function(r,n,a){switch(r.kind){case XM.OperKind.String:return'"'+this.anon(r.value).replace(Wer,'""')+'"';case XM.OperKind.Boolean:return r.value?this.localeInfo.trueName:this.localeInfo.falseName;case XM.OperKind.Number:var o=21;return this.anon(this.mathpack.formatGeneral(this.localeInfo,r,o));case XM.OperKind.Missing:return"";case XM.OperKind.Error:var u=this.localeInfo.errorNames[r.type];if(u==null)throw new lP((0,Cu.internal)("No locale data for error type ".concat(r.type)));return u;default:return(0,cP.assertNever)("calc.lang.printFormula",r)}},e.prototype.missingNode=function(r,n){return this.anon(r)},e.prototype.arrayNode=function(r,n,a){var o=this;return this.localeInfo.leftBrace+r.map(function(u){return u.map(function(t){return o.preIfComments(t.label)+t.str+o.postIfComments(t.label)}).join(o.localeInfo.columnSeparator)}).join(this.localeInfo.rowSeparator)+(n?this.localeInfo.rightBrace:"")},e.prototype.appNode=function(r,n,a,o){if(r.op!==void 0){if(n.length===1){var u=n[0];switch(r.op){case JM.OperatorId.Percent:return u.str+this.pre(r.label,"")+r.str;case JM.OperatorId.Pound:return u.str+this.preIfComments(r.label)+r.str;default:return r.str+this.post(r.label,"")+u.str}}if(n.length===2){var t=n[0],d=n[1],s=" ",c=" ";switch(r.op){case JM.OperatorId.Range:s=c="";break;case JM.OperatorId.Isect:c="";break;case JM.OperatorId.Union:s="";break}return t.str+this.pre(r.label,s)+r.str+this.post(r.label,c)+d.str}return(0,cP.assertFalse)("calc.lang.printFormula: invalid number of operator args")}return this.printApplication(r,n,a)},e.prototype.letNode=function(r,n,a,o,u,t){var d=this,s=n.map(function(c){var l=c.name,f=c.binder;return(0,On.letVar)((0,On.indexedArg)({str:d.anon((0,Cu.getBoundName)(d.localeInfo,l.arg.wholeName)),label:l.arg.label,op:void 0},l.index),f)});return this.printApplication(r,(0,On.flattenLetArgs)(s,a,o),u)},e.prototype.lambdaNode=function(r,n,a,o,u,t){var d=this,s=n.map(function(c){var l=c.name,f=(l.arg.name.isBracketed?d.localeInfo.leftBracket:"")+d.printOptionalParamName(l.arg.name.name)+(l.arg.name.isBracketed&&l.arg.name.isClosed?d.localeInfo.rightBracket:"");return l.arg.def!==void 0&&(f+=d.pre(l.arg.def.label," ")+":="+d.pre(l.arg.def.rhs.label,l.arg.def.rhs.str===""?"":" ")+l.arg.def.rhs.str),(0,On.lambdaParam)((0,On.indexedArg)({str:f,label:l.arg.label,op:void 0},l.index))});return this.printApplication(r,(0,On.flattenLambdaArgs)(s,a,o),u)},e.prototype.parenNode=function(r,n,a){return"("+this.pre(r.label,"")+r.str+this.post(r.label,"")+(n?")":"")},e.prototype.nameNode=function(r,n,a){var o=this.resolver.resolveDottedName(this.locals,(0,On.nameNode)(r,n,a),this.annotations),u=o.resolved,t=o.fields;return PJ(u.resolution),u.kind===hC.ResolvedKind.ResolvedCellRef?vC.__spreadArray([this.printCellRef(u.node)],t.map(this.anon),!0).join("."):u.kind===hC.ResolvedKind.ResolvedLocalName&&u.resolution.value!==void 0?vC.__spreadArray([this.anon(u.resolution.value.name)],t.map(this.anon),!0).join("."):u.kind===hC.ResolvedKind.ResolvedUserDefinedFunc?vC.__spreadArray([this.anon(u.name)],t.map(this.anon),!0).join("."):vC.__spreadArray([this.printName(u.node)],t.map(this.anon),!0).join(".")},e.prototype.cellRefNode=function(r,n,a){var o=this.resolver.resolveCellRef(this.locals,(0,On.cellRefNode)(r,n,a)),u=o.node,t=o.resolution;return PJ(t),this.printCellRef(u)},e.prototype.fieldRefNode=function(r,n,a,o){var u=r.str,t=a,d=n.isBracketed||t?this.localeInfo.leftBracket:"",s=n.isBracketed&&n.isClosed||t?this.localeInfo.rightBracket:"",c=n.field.kind===On.NodeKind.Ident?jve(n.field.whole,this.isFieldRefEscapable):n.field.chars;return n.field.kind!==On.NodeKind.Ident?u+=this.pre(n.label,""):u+=this.preIfComments(n.label),u+="."+d+this.anon(c)+s+this.post(n.label,""),u},e.prototype.structRefNode=function(r,n,a){var o=this,u,t=this.resolver.resolveStructRef(this.locals,(0,On.structRefNode)(r,n,a)),d=t.node,s=t.table,c=t.resolution;PJ(c);var l=d.rhs.innerRef,f=d.lhs;f===void 0&&s!==void 0&&d.rhs.isClosed&&!((l==null?void 0:l.kind)===On.StructRefKind.ColumnRef||(l==null?void 0:l.kind)===On.StructRefKind.ThisRowOpRef&&((u=l.ref)===null||u===void 0?void 0:u.kind)===On.StructRefKind.ColumnRef)&&(f=(0,On.nameNode)((0,On.identNamePart)(s.name)));var p=f!==void 0?this.printName(f):"";if(l===void 0&&d.rhs.isClosed&&f!==void 0)return p;switch(p+=this.localeInfo.leftBracket,l==null?void 0:l.kind){case On.StructRefKind.ColumnRef:case On.StructRefKind.SpecialRef:if(l.kind===On.StructRefKind.SpecialRef&&l.id===On.SpecialRefId.ThisRow&&l.isClosed){p+=this.printThisRowOpRef(void 0);break}p+=this.printRef(l,l.isClosed?Lu.Unbracketed:Lu.Original);break;case On.StructRefKind.RangeOpRef:{var m=(0,Cu.isRangeOpClosed)(l)&&(0,Cu.isRangeOpNoMissing)(l),v=m?Lu.Bracketed:Lu.Original;p+=this.printRef(l,v);break}case On.StructRefKind.CommaOpRef:{var m=(0,Cu.isCommaOpRefWellFormed)(l)&&(0,Cu.isCommaOpClosed)(l)&&(0,Cu.isCommaOpNoBadOrMissing)(l);if(m&&l.specialRefs[On.SpecialRefId.ThisRow]){p+=this.printThisRowOpRef(l.columnRefs.length===0?void 0:l.columnRefs[0]);break}var h=m?(0,Cu.normalizeCommaOpRef)(l):l.refs,S=m?h.length===1?Lu.Unbracketed:Lu.Bracketed:Lu.Original;p+=h.map(function(C){return o.printRef(C,S)}).join(this.localeInfo.listSeparator);break}case On.StructRefKind.ThisRowOpRef:p+=this.printThisRowOpRef(l.ref);break;case On.StructRefKind.BadRef:p+=this.printRef(l,Lu.Original);break}return d.rhs.isClosed&&(p+=this.localeInfo.rightBracket),p},e.prototype.badSequenceNode=function(r,n,a){var o=this;return n.map(function(u){return o.pre(u.label,"")+u.str+o.post(u.label,"")}).join("")},e.prototype.badCharsNode=function(r,n,a){return this.anon(n)},e.prototype.operatorNode=function(r,n){var a=(0,ZM.operatorIdToName)(this.localeInfo,r,"");if(a===void 0)throw new lP((0,Cu.internal)("Invalid operator"));return a},e.prototype.wsfNode=function(r,n,a){return this.localeInfo.getWorksheetFuncName(r)},e.prototype.cellRefError=function(){var r=this.localeInfo.errorNames[Wve.ErrorType.REF];if(r==null)throw new lP((0,Cu.internal)("No locale data for #REF"));return r},e.prototype.cellRefSingle=function(r,n,a){var o=(0,d1.formatCellPos)(this.localeInfo,this.refStyle,this.locals.originGridCell.value,r,n,this.locals.wrapCellReferences);return o!==void 0?this.anon(o):this.cellRefError()},e.prototype.cellRefRange=function(r,n){var a=(0,d1.formatRangePos)(this.localeInfo,this.refStyle,this.locals.originGridCell.value,r.row,r.col,n.row,n.col,this.locals.wrapCellReferences);return a!==void 0?this.anon(a):this.cellRefError()},e.prototype.cellRefRow=function(r,n,a){var o=(0,d1.formatRowRange)(this.localeInfo,this.refStyle,this.locals.originGridCell.value.row,r,n,this.locals.wrapCellReferences);return o!==void 0?this.anon(o):this.cellRefError()},e.prototype.cellRefCol=function(r,n,a){var o=(0,d1.formatColRange)(this.localeInfo,this.refStyle,this.locals.originGridCell.value.col,r,n,this.locals.wrapCellReferences);return o!==void 0?this.anon(o):this.cellRefError()},e.prototype.cellRefBad=function(r,n){return this.anon(r)},e.prototype.errorQualifier=function(){var r=this.localeInfo.errorNames[Wve.ErrorType.REF];if(r==null)throw new lP((0,Cu.internal)("No locale data for #REF"));return r},e.prototype.relativeQualifier=function(){return"!"},e.prototype.documentQualifier=function(r,n,a){return(0,d1.quoteQualifier)(this.anon(this.printUnanonymisedDocQual((0,On.documentQualifier)(r,n))))+"!"},e.prototype.sheetQualifier=function(r,n,a){return(0,d1.formatQualifier)(this.localeInfo,this.refStyle,this.anon(this.printUnanonymisedDocQual(n)+r))+"!"},e.prototype.identQualifier=function(r,n){return(0,d1.formatQualifier)(this.localeInfo,this.refStyle,this.anon(r))+"!"},e.prototype.sheetRangeQualifier=function(r,n,a,o){var u=this.anon(this.printUnanonymisedDocQual(a)+r),t=this.anon(n),d=u+":"+t;return((0,d1.shouldQuoteQualifier)(this.localeInfo,this.refStyle,u)||(0,d1.shouldQuoteQualifier)(this.localeInfo,this.refStyle,t)?(0,d1.quoteQualifier)(d):d)+"!"},e.prototype.badQualifier=function(r,n,a,o){return this.anon(r)},e}(),lP=(0,Cu.createFailureErrorClass)("PrintFormulaError"),Jh=(0,Cu.createFailureErrorClass)("PrintRangeError");function zve(e,r,n,a){a===void 0&&(a=!1);try{return(0,Fl.success)(new Yer(e,r,n,a).print())}catch(o){return o instanceof lP?(0,Fl.failure)(o.reason):(0,Fl.failure)((0,Fl.javaScriptError)(o))}}function Jer(e,r,n){try{var a=n.kind===dv.LexicalKind.Cell||n.kind===dv.LexicalKind.Range?(0,bJ.printLocalsGrid)(n,(0,Cu.sheetGridRangeAnchor)(n.range)):n.kind===dv.LexicalKind.NameManager?(0,bJ.printLocalsName)(n,jer):(0,cP.assertNever)("calc.lang.anonymizeFormula",n),o=zve((0,bJ.createSimplePrintGlobals)((0,ZM.calcConfig)((0,ZM.getEnglishLocaleInfo)(),On.RefStyle.A1,e.mathpack)),a,r,!0);if(o.kind===Fl.ResultKind.Success)return o.value;if(o.reason.kind===Fl.ReasonKind.JavaScriptError)throw o.reason.error}catch(t){var u="calc.lang.anonymizeFormula: Format failed: "+(0,YB.messageFromError)(t);cP.ulsLogger.ULS.traceTag(556863706,ZM.LogCategory.msoulscat_ES_EWAJS,ZM.TraceLevel.Warning,u)}return(0,Qve.anonymize)(r)}p2.anonymizeFormula=Jer;function f2(e,r){return e===void 0?(0,On.pos)(On.PosKind.Abs,r):(0,On.pos)(On.PosKind.Rel,r-e)}function Hve(e,r){return(0,On.cellRefSingle)(f2(e==null?void 0:e.row,r.row),f2(e==null?void 0:e.col,r.col))}function Xer(e,r,n){return(0,On.cellRefRow)(f2(e==null?void 0:e.row,r),f2(e==null?void 0:e.row,r+n-1))}function Zer(e,r,n){return(0,On.cellRefCol)(f2(e==null?void 0:e.col,r),f2(e==null?void 0:e.col,r+n-1))}function $er(e,r){if(r.col===0&&r.cols===dv.sheetCols)return Xer(e,r.row,r.rows);if(r.row===0&&r.rows===dv.sheetRows)return Zer(e,r.col,r.cols);var n=(0,Cu.gridRangeAnchor)(r),a=Hve(e,n);if((0,Cu.isGridCell)(r))return a;var o=(0,dv.gridCell)(r.row+r.rows-1,r.col+r.cols-1),u=Hve(e,o);return(0,On.cellRefRange)(a,u)}function err(e,r,n){var a=r.originSheet.value,o=r.printAbsoluteReferences?void 0:r.originGridCell.value,u=$er(o,n.range),t;if(a.index===void 0||!(0,Cu.isSheetIndexEqual)(a,n.sheet)){var d=e.getSheetName(n.sheet.document,n.sheet.index);if(!(0,Fl.isSuccess)(d))throw new Jh(d.reason);t=(0,On.sheetQualifier)(d.value)}return(0,On.cellRefNode)(u,t)}function zB(e){return(0,Fl.isSuccess)(e)?((0,cP.assertTrue)("calc.lang.printRangeStructRef: NameLoc can't be no-table",e.value!=null),(0,Fl.success)(e.value)):e.reason.kind===hC.ResolveReasonKind.InvalidStructRef?(0,cP.assertFalse)("calc.lang.printRangeStructRef: NameLoc can't be InvalidStructRef"):(0,Fl.failure)(e.reason)}function rrr(e,r,n){var a=n.sheet,o=n.range,u=e.getContainingTable((0,dv.sheetGridCell)(a,(0,Cu.gridRangeAnchor)(o)));if(!(0,Fl.isSuccess)(u))throw new Jh(u.reason);if(u.value!=null){var t=u.value,d=zB(e.getStructRefSpecialRef(t,On.SpecialRefId.All));if(!(0,Fl.isSuccess)(d))throw new Jh(d.reason);var s=d.value.range,c=d.value.sheet,l=(0,Cu.gridRangeCompare)(s,o);if(!(l===void 0||l<0)){var f=zB(e.getStructRefSpecialRef(t,On.SpecialRefId.Data));if(!(0,Fl.isSuccess)(f))throw new Jh(f.reason);var p=f.value.range,m=r.originGridCell.value,v=r.originSheet.value,h=v.index!==void 0&&(0,Cu.isSheetIndexEqual)(v,c),S=h&&(0,Cu.gridRangeIsects)(s,m)?void 0:(0,On.nameNode)((0,On.identNamePart)(t.name)),y=S??(0,On.nameNode)((0,On.identNamePart)(t.name)),C=p.cols>1&&o.col===p.col&&o.cols===p.cols,E=function(){var L=zB(e.getStructRefColumn(t,o.col));if(!(0,Fl.isSuccess)(L))throw new Jh(L.reason);if(o.cols===1)return(0,On.columnRef)(L.value.name);var D=zB(e.getStructRefColumn(t,o.col+o.cols-1));if(!(0,Fl.isSuccess)(D))throw new Jh(D.reason);return(0,On.rangeOpRef)((0,On.columnRef)(L.value.name),(0,On.columnRef)(D.value.name))};if(o.row===s.row&&o.rows===s.rows)return(0,On.structRefNode)(y,(0,On.structRef)(C?(0,On.specialRef)(On.SpecialRefId.All):(0,On.commaOpRef)([(0,On.specialRef)(On.SpecialRefId.All,!0),E()])));if(o.rows===1&&o.row===m.row&&o.row>=p.row&&o.row<p.row+p.rows)return(0,On.structRefNode)(o.cols===1?S:y,(0,On.structRef)((0,On.thisRowOpRef)(C?void 0:E())));if(o.row===p.row&&o.rows===p.rows)return C?(0,On.structRefNode)(y,(0,On.structRef)(void 0)):(0,On.structRefNode)(o.cols===1?S:y,(0,On.structRef)(E()));var I=o.row===s.row&&o.row+o.rows===p.row,F=o.row===p.row+p.rows&&o.row+o.rows===s.row+s.rows;if(I||F){var w=(0,On.specialRef)(I?On.SpecialRefId.Headers:On.SpecialRefId.Totals,!C);return(0,On.structRefNode)(y,(0,On.structRef)(C?w:(0,On.commaOpRef)([w,E()])))}var B=o.row===s.row&&s.row<p.row&&o.row+o.rows===p.row+p.rows,k=o.row===p.row&&s.row+s.rows>p.row+p.rows&&o.row+o.rows===s.row+s.rows;if(B||k){var x=(0,On.specialRef)(B?On.SpecialRefId.Headers:On.SpecialRefId.Data,!0),G=(0,On.specialRef)(B?On.SpecialRefId.Data:On.SpecialRefId.Totals,!0);return(0,On.structRefNode)(y,(0,On.structRef)(C?(0,On.commaOpRef)([x,G]):(0,On.commaOpRef)([x,G,E()])))}}}}function nrr(e,r,n,a){var o=r.originSheet.value,u=e.getNamedRanges(n);if(!(0,Fl.isSuccess)(u))throw new Jh(u.reason);if(u.value.length!==0){var t=function(p){return p.index!==void 0&&(o.index===void 0||!(0,Cu.isSheetIndexEqual)(p,o))},d=u.value.filter(function(f){var p=f.scope;return p.index===void 0?(0,Cu.isDocumentLocEqual)(p.document,n.sheet.document):(0,Cu.isSheetIndexEqual)(p,n.sheet)}).filter(function(f){var p=f.scope,m=f.name;if(p.index!==void 0||o.index===void 0)return!0;var v=o,h=e.getNameLoc(v,m,dv.NameSource.Plain);if(!(0,Fl.isSuccess)(h))throw new Jh(h.reason);return h.value==null}).filter(function(f){var p=f.scope,m=f.name;return t(p)||!a.contains(m)});if(d.length!==0){var s=d.length===1?d[0]:vC.__spreadArray([],d,!0).sort(function(f,p){return e.config.localeInfo.stringCompareCI(f.name,p.name)})[0],c;if(t(s.scope)){var l=e.getSheetName(s.scope.document,s.scope.index);if(!(0,Fl.isSuccess)(l))throw new Jh(l.reason);c=(0,On.sheetQualifier)(l.value)}return(0,On.nameNode)((0,On.identNamePart)(s.name),c)}}}function trr(e,r,n,a){var o,u;a===void 0&&(a=(0,Ver.makeEmptyTable)());try{var t=r.originSheet.value;if(!(0,Cu.isDocumentLocEqual)(t.document,n.sheet.document))throw new Jh((0,Cu.notImplemented)(["printRange cross-document"]));return(0,Fl.success)((u=(o=nrr(e,r,n,a))!==null&&o!==void 0?o:rrr(e,r,n))!==null&&u!==void 0?u:err(e,r,n))}catch(d){return d instanceof Jh?(0,Fl.failure)(d.reason):(0,Fl.failure)((0,Fl.javaScriptError)(d))}}var arr={getNamedRanges:function(){return(0,cP.assertFalse)("calc.lang.prettyPrinter: default getNamedRanges")}};function irr(e){var r,n,a;return{config:e.config,getDocumentLoc:e.getDocumentLoc.bind(e),getSheetIndex:e.getSheetIndex.bind(e),getSheetName:e.getSheetName.bind(e),getNameLoc:e.getNameLoc.bind(e),getUserDefinedFuncLoc:e.getUserDefinedFuncLoc.bind(e),getSheetRangeIndexes:e.getSheetRangeIndexes.bind(e),getContainingTable:e.getContainingTable.bind(e),getStructRefColumn:e.getStructRefColumn.bind(e),getStructRefSpecialRef:(r=e.getStructRefSpecialRef)===null||r===void 0?void 0:r.bind(e),getNamedRanges:(a=(n=e.getNamedRanges)===null||n===void 0?void 0:n.bind(e))!==null&&a!==void 0?a:arr.getNamedRanges}}function orr(e){var r=irr(e);return{printFormula:function(a,o){return zve(e,a,o)},printRange:function(a,o,u){return trr(r,a,o,u)}}}p2.createPrinter=orr});var Zve=Y(un=>{"use strict";_();Object.defineProperty(un,"__esModule",{value:!0});un.fieldRef=un.fieldRefNamePart=un.nameNode=un.lambdaNode=un.letNode=un.poundNode=un.atNode=un.maxNode=un.minNode=un.xorNode=un.orNode=un.andNode=un.unionNode=un.isectNode=un.rangeNode=un.geNode=un.gtNode=un.leNode=un.ltNode=un.neNode=un.eqNode=un.concatNode=un.posNode=un.negNode=un.percentNode=un.powNode=un.divNode=un.mulNode=un.subNode=un.addNode=un.badBracketNode=un.badQualNode=un.badCellRefNode=un.badParamNameNode=un.badFieldNameNode=un.badErrorLiteralNode=un.badStringLiteralNode=un.badNumberLiteralNode=un.badUnexpCharsNode=un.badFieldRefNode=un.badStructRefNode=un.badUnexpSeqNode=un.absPos=un.relPos=un.expectTrue=un.isNameLocEqual=un.createSingleRange=un.sheet1=un.sheet1Name=un.document1=void 0;var JB=sv(),urr=t1(),Xi=R0(),Ks=KA();un.document1=(0,JB.documentLoc)(void 0,"Book1");un.sheet1Name="Sheet1";un.sheet1=(0,JB.sheetIndex)(un.document1,0);function srr(e,r){var n=(0,JB.gridCell)(e,r);return(0,JB.sheetGridCell)(un.sheet1,n)}un.createSingleRange=srr;function lrr(e,r,n){return(0,urr.isNameScopeEqual)(r.scope,n.scope)&&e.stringCompareCI(r.name,n.name)===0}un.isNameLocEqual=lrr;function crr(e){expect(e).toBeTruthy()}un.expectTrue=crr;function drr(e){return(0,Xi.pos)(Xi.PosKind.Rel,e)}un.relPos=drr;function frr(e){return(0,Xi.pos)(Xi.PosKind.Abs,e)}un.absPos=frr;function Jve(e,r){return r===void 0&&(r=0),(0,Xi.badSequenceNode)(Xi.BadType.Unexpected,e,r)}un.badUnexpSeqNode=Jve;function prr(e,r){return r===void 0&&(r=0),(0,Xi.badSequenceNode)(Xi.BadType.StructRef,e,r)}un.badStructRefNode=prr;function mrr(e,r){return r===void 0&&(r=0),(0,Xi.badSequenceNode)(Xi.BadType.FieldRef,e,r)}un.badFieldRefNode=mrr;function NJ(e,r){return r===void 0&&(r=0),(0,Xi.badCharsNode)(Xi.BadType.Unexpected,e,r)}un.badUnexpCharsNode=NJ;function grr(e,r){return r===void 0&&(r=0),(0,Xi.badCharsNode)(Xi.BadType.NumberLiteral,e,r)}un.badNumberLiteralNode=grr;function vrr(e,r){return r===void 0&&(r=0),(0,Xi.badCharsNode)(Xi.BadType.StringLiteral,e,r)}un.badStringLiteralNode=vrr;function hrr(e,r){return r===void 0&&(r=0),(0,Xi.badCharsNode)(Xi.BadType.ErrorLiteral,e,r)}un.badErrorLiteralNode=hrr;function Srr(e,r){return r===void 0&&(r=0),(0,Xi.badCharsNode)(Xi.BadType.FieldName,e,r)}un.badFieldNameNode=Srr;function yrr(e,r){return r===void 0&&(r=0),(0,Xi.badCharsNode)(Xi.BadType.ParamName,e,r)}un.badParamNameNode=yrr;function Crr(e,r,n,a){return r===void 0&&(r=e.indexOf("[")>=0),n===void 0&&(n=0),a===void 0&&(a=0),(0,Xi.cellRefNode)((0,Xi.cellRefBad)(e,r,n),void 0,a)}un.badCellRefNode=Crr;function _rr(e,r){return r===void 0&&(r=0),(0,Xi.badCharsNode)(Xi.BadType.Qualifier,e,r)}un.badQualNode=_rr;function Rrr(e,r){r===void 0&&(r=!0);var n=[NJ("["),e];return r&&n.push(NJ("]")),Jve(n)}un.badBracketNode=Rrr;function Vs(e){return function(r){return r===void 0&&(r=0),(0,Xi.operatorNode)(e,r)}}un.addNode=Vs(Ks.OperatorId.Add);un.subNode=Vs(Ks.OperatorId.Sub);un.mulNode=Vs(Ks.OperatorId.Mul);un.divNode=Vs(Ks.OperatorId.Div);un.powNode=Vs(Ks.OperatorId.Pow);un.percentNode=Vs(Ks.OperatorId.Percent);un.negNode=Vs(Ks.OperatorId.Neg);un.posNode=Vs(Ks.OperatorId.Pos);un.concatNode=Vs(Ks.OperatorId.Concat);un.eqNode=Vs(Ks.OperatorId.Eq);un.neNode=Vs(Ks.OperatorId.Ne);un.ltNode=Vs(Ks.OperatorId.Lt);un.leNode=Vs(Ks.OperatorId.Le);un.gtNode=Vs(Ks.OperatorId.Gt);un.geNode=Vs(Ks.OperatorId.Ge);un.rangeNode=Vs(Ks.OperatorId.Range);un.isectNode=Vs(Ks.OperatorId.Isect);un.unionNode=Vs(Ks.OperatorId.Union);un.andNode=Vs(Ks.OperatorId.And);un.orNode=Vs(Ks.OperatorId.Or);un.xorNode=Vs(Ks.OperatorId.Xor);un.minNode=Vs(Ks.OperatorId.Min);un.maxNode=Vs(Ks.OperatorId.Max);un.atNode=Vs(Ks.OperatorId.At);un.poundNode=Vs(Ks.OperatorId.Pound);function Trr(e){return Array.isArray(e)}function brr(e){return e.kind!==void 0}function Prr(e,r,n,a,o,u){a===void 0&&(a=[]);var t=r.map(function(d){return Trr(d)?[d[0].kind===Xi.NodeKind.Ident?(0,Xi.varNode)(d[0]):d[0],d[1]]:d});return(0,Xi.letNode)(e,t,n,a,o,u)}un.letNode=Prr;function Err(e,r,n,a,o,u){a===void 0&&(a=[]);var t=r.map(function(d){return!brr(d)||d.kind===Xi.NodeKind.Param?d:(0,Xi.paramNode)((0,Xi.paramName)(d,!1),void 0)});return(0,Xi.lambdaNode)(e,t,n,a,o,u)}un.lambdaNode=Err;function Nrr(e,r,n){var a=typeof e=="string"?(0,Xi.identNamePart)(e,!0):e;return(0,Xi.nameNode)(a,r,n)}un.nameNode=Nrr;function Arr(e,r,n,a,o){var u=typeof r=="string"?Xve(r,!1,!0):r;return(0,Xi.fieldRefNamePart)(e,u,n,a,o)}un.fieldRefNamePart=Arr;function Xve(e,r,n,a){return(0,Xi.fieldRef)(typeof e=="string"?(0,Xi.identNode)(e):e,r,n,a)}un.fieldRef=Xve});var $ve=Y(Il=>{"use strict";_();Object.defineProperty(Il,"__esModule",{value:!0});Il.VerticalAlignment=Il.HorizontalAlignment=Il.BorderLineType=Il.PatternType=Il.FillKind=Il.FontVerticalAlignment=Il.FontUnderline=void 0;var $M=Ep(),Orr;(function(e){e.None="None",e.Single="Single",e.Double="Double",e.SingleAccounting="SingleAccounting",e.DoubleAccounting="DoubleAccounting"})(Orr=Il.FontUnderline||(Il.FontUnderline={}));(0,$M.staticAssertSame)();var krr;(function(e){e.None="None",e.Subscript="Subscript",e.Superscript="Superscript"})(krr=Il.FontVerticalAlignment||(Il.FontVerticalAlignment={}));(0,$M.staticAssertSame)();var Frr;(function(e){e.Pattern="Pattern",e.Gradient="Gradient"})(Frr=Il.FillKind||(Il.FillKind={}));var Irr;(function(e){e.None="None",e.Solid="Solid",e.MediumGray="MediumGray",e.DarkGray="DarkGray",e.LightGray="LightGray",e.DarkHorizontal="DarkHorizontal",e.DarkVertical="DarkVertical",e.DarkDown="DarkDown",e.DarkUp="DarkUp",e.DarkGrid="DarkGrid",e.DarkTrellis="DarkTrellis",e.LightHorizontal="LightHorizontal",e.LightVertical="LightVertical",e.LightDown="LightDown",e.LightUp="LightUp",e.LightGrid="LightGrid",e.LightTrellis="LightTrellis",e.Gray125="Gray125",e.Gray0625="Gray0625"})(Irr=Il.PatternType||(Il.PatternType={}));var Mrr;(function(e){e.None="None",e.Thin="Thin",e.Medium="Medium",e.Dashed="Dashed",e.Dotted="Dotted",e.Thick="Thick",e.Double="Double",e.Hair="Hair",e.MediumDashed="MediumDashed",e.DashDot="DashDot",e.MediumDashDot="MediumDashDot",e.DashDotDot="DashDotDot",e.MediumDashDotDot="MediumDashDotDot",e.SlantDashDot="SlantDashDot"})(Mrr=Il.BorderLineType||(Il.BorderLineType={}));(0,$M.staticAssertSame)();var wrr;(function(e){e.Automatic="Automatic",e.Left="Left",e.Center="Center",e.Right="Right",e.Fill="Fill",e.Justify="Justify",e.CenterAcrossSelection="CenterAcrossSelection",e.Distributed="Distributed",e.JustifyDistributed="JustifyDistributed"})(wrr=Il.HorizontalAlignment||(Il.HorizontalAlignment={}));(0,$M.staticAssertSame)();var Drr;(function(e){e.Top="Top",e.Center="Center",e.Bottom="Bottom",e.Justify="Justify",e.Distributed="Distributed"})(Drr=Il.VerticalAlignment||(Il.VerticalAlignment={}));(0,$M.staticAssertSame)()});var et=Y(Qt=>{"use strict";_();Object.defineProperty(Qt,"__esModule",{value:!0});Qt.styleServiceTypes=Qt.testUtil=Qt.printServiceTypes=Qt.printService=Qt.mathpackIEEE=Qt.relabel=Qt.visitor=Qt.mathpack=Qt.signature=Qt.literalParse=Qt.resolveServiceTypes=Qt.resolveService=Qt.util=Qt.numfmt=Qt.formulaModule=Qt.datepack=Qt.mathpackXL=Qt.config=Qt.cellParse=Qt.cellFormat=Qt.annotations=Qt.adjust=Qt.worksheetFuncTypesModule=Qt.getCharCodeBits=Qt.location=Qt.value=Qt.types=Qt.PackageName=void 0;Qt.PackageName="excel-online-calc-lang";Qt.types=lC();Qt.value=Gb();Qt.location=sv();var xrr=CY();Object.defineProperty(Qt,"getCharCodeBits",{enumerable:!0,get:function(){return xrr.getCharCodeBits}});Qt.worksheetFuncTypesModule=oB();Qt.adjust=ove();Qt.annotations=lve();Qt.cellFormat=GM();Qt.cellParse=RB();Qt.config=yJ();Qt.mathpackXL=mJ();Qt.datepack=fJ();Qt.formulaModule=R0();Qt.numfmt=mB();Qt.util=t1();Qt.resolveService=OB();Qt.resolveServiceTypes=KM();Qt.literalParse=IY();Qt.signature=KA();Qt.mathpack=CJ();Qt.visitor=$A();Qt.relabel=xve();Qt.mathpackIEEE=Uve();Qt.printService=Yve();Qt.printServiceTypes=TJ();Qt.testUtil=Zve();Qt.styleServiceTypes=$ve()});var gs=Y(Et=>{_();Object.defineProperty(Et,"__esModule",{value:!0});Et.userDefinedFuncLoc=Et.unsafeGridRange=Et.structRefColumnLoc=Et.sheetRows=Et.sheetRangeIndexes=Et.sheetRange=Et.sheetIndex=Et.sheetGridRange=Et.sheetGridCube=Et.sheetGridCell=Et.sheetCols=Et.originCell=Et.nameScope=Et.nameLoc=Et.lexicalSourceWSF=Et.lexicalSourceUDF=Et.lexicalSourceRange=Et.lexicalSourceName=Et.lexicalSourceGrid=Et.lexicalSourceCell=Et.isSheetIndex=Et.isSheetGridRange=Et.isSheetGridCell=Et.isGridCell=Et.gridRange=Et.gridCell=Et.documentScope=Et.documentLoc=Et.allSheetsRange=Et.NameSource=Et.LexicalKind=void 0;var nu=et(),Lrr=nu.location.LexicalKind;Et.LexicalKind=Lrr;var Brr=nu.location.NameSource;Et.NameSource=Brr;var qrr=nu.location.allSheetsRange;Et.allSheetsRange=qrr;var Urr=nu.location.documentLoc;Et.documentLoc=Urr;var Grr=nu.location.documentScope;Et.documentScope=Grr;var Krr=nu.location.gridCell;Et.gridCell=Krr;var Vrr=nu.location.gridRange;Et.gridRange=Vrr;var Wrr=nu.location.isGridCell;Et.isGridCell=Wrr;var jrr=nu.location.isSheetGridCell;Et.isSheetGridCell=jrr;var Hrr=nu.location.isSheetGridRange;Et.isSheetGridRange=Hrr;var Qrr=nu.location.isSheetIndex;Et.isSheetIndex=Qrr;var zrr=nu.location.lexicalSourceCell;Et.lexicalSourceCell=zrr;var Yrr=nu.location.lexicalSourceGrid;Et.lexicalSourceGrid=Yrr;var Jrr=nu.location.lexicalSourceName;Et.lexicalSourceName=Jrr;var Xrr=nu.location.lexicalSourceWSF;Et.lexicalSourceWSF=Xrr;var Zrr=nu.location.lexicalSourceUDF;Et.lexicalSourceUDF=Zrr;var $rr=nu.location.lexicalSourceRange;Et.lexicalSourceRange=$rr;var enr=nu.location.nameLoc;Et.nameLoc=enr;var rnr=nu.location.nameScope;Et.nameScope=rnr;var nnr=nu.location.originCell;Et.originCell=nnr;var tnr=nu.location.sheetCols;Et.sheetCols=tnr;var anr=nu.location.sheetGridCell;Et.sheetGridCell=anr;var inr=nu.location.sheetGridCube;Et.sheetGridCube=inr;var onr=nu.location.sheetGridRange;Et.sheetGridRange=onr;var unr=nu.location.sheetIndex;Et.sheetIndex=unr;var snr=nu.location.sheetRange;Et.sheetRange=snr;var lnr=nu.location.sheetRangeIndexes;Et.sheetRangeIndexes=lnr;var cnr=nu.location.sheetRows;Et.sheetRows=cnr;var dnr=nu.location.structRefColumnLoc;Et.structRefColumnLoc=dnr;var fnr=nu.location.unsafeGridRange;Et.unsafeGridRange=fnr;var pnr=nu.location.userDefinedFuncLoc;Et.userDefinedFuncLoc=pnr});var f1=Y(Gt=>{_();Object.defineProperty(Gt,"__esModule",{value:!0});Gt.valueErrorOper=Gt.unknownErrorOper=Gt.trueOper=Gt.stringOper=Gt.spillErrorOper=Gt.refErrorOper=Gt.rangeSeqOper=Gt.range3DOper=Gt.precedents=Gt.numErrorOper=Gt.nullErrorOper=Gt.nameErrorOper=Gt.naErrorOper=Gt.missingOper=Gt.gettingDataErrorOper=Gt.fieldErrorOper=Gt.falseOper=Gt.externalErrorOper=Gt.errorOper=Gt.div0ErrorOper=Gt.connectErrorOper=Gt.cellStringLimit=Gt.calcErrorOper=Gt.busyErrorOper=Gt.booleanOper=Gt.blockedErrorOper=Gt.blankOper=Gt.arrayOper=Gt.PrecsBound=Gt.ErrorType=void 0;var _u=et(),mnr=_u.value.ErrorType;Gt.ErrorType=mnr;var gnr=_u.value.PrecsBound;Gt.PrecsBound=gnr;var vnr=_u.value.arrayOper;Gt.arrayOper=vnr;var hnr=_u.value.blankOper;Gt.blankOper=hnr;var Snr=_u.value.booleanOper;Gt.booleanOper=Snr;var ynr=_u.value.cellStringLimit;Gt.cellStringLimit=ynr;var Cnr=_u.value.div0ErrorOper;Gt.div0ErrorOper=Cnr;var _nr=_u.value.errorOper;Gt.errorOper=_nr;var Rnr=_u.value.falseOper;Gt.falseOper=Rnr;var Tnr=_u.value.gettingDataErrorOper;Gt.gettingDataErrorOper=Tnr;var bnr=_u.value.spillErrorOper;Gt.spillErrorOper=bnr;var Pnr=_u.value.connectErrorOper;Gt.connectErrorOper=Pnr;var Enr=_u.value.blockedErrorOper;Gt.blockedErrorOper=Enr;var Nnr=_u.value.unknownErrorOper;Gt.unknownErrorOper=Nnr;var Anr=_u.value.fieldErrorOper;Gt.fieldErrorOper=Anr;var Onr=_u.value.calcErrorOper;Gt.calcErrorOper=Onr;var knr=_u.value.busyErrorOper;Gt.busyErrorOper=knr;var Fnr=_u.value.externalErrorOper;Gt.externalErrorOper=Fnr;var Inr=_u.value.missingOper;Gt.missingOper=Inr;var Mnr=_u.value.naErrorOper;Gt.naErrorOper=Mnr;var wnr=_u.value.nameErrorOper;Gt.nameErrorOper=wnr;var Dnr=_u.value.nullErrorOper;Gt.nullErrorOper=Dnr;var xnr=_u.value.numErrorOper;Gt.numErrorOper=xnr;var Lnr=_u.value.precedents;Gt.precedents=Lnr;var Bnr=_u.value.range3DOper;Gt.range3DOper=Bnr;var qnr=_u.value.rangeSeqOper;Gt.rangeSeqOper=qnr;var Unr=_u.value.refErrorOper;Gt.refErrorOper=Unr;var Gnr=_u.value.stringOper;Gt.stringOper=Gnr;var Knr=_u.value.trueOper;Gt.trueOper=Knr;var Vnr=_u.value.valueErrorOper;Gt.valueErrorOper=Vnr});var Qu=Y(or=>{_();Object.defineProperty(or,"__esModule",{value:!0});or.wsfNode=or.varNode=or.thisRowOpRef=or.structRefNode=or.structRef=or.specialRef=or.singleLineComment=or.sheetRangeQualifier=or.sheetQualifier=or.relativeQualifier=or.rangeOpRef=or.pos=or.parenNode=or.paramNode=or.paramName=or.paramDefault=or.operatorNode=or.nameNode=or.multiLineComment=or.missingRef=or.missingNode=or.localNameUseAnnotation=or.localNameDeclAnnotation=or.literalNode=or.letVar=or.letNode=or.lambdaParam=or.lambdaNode=or.indexedArg=or.identQualifier=or.identNode=or.identNamePart=or.headNamePart=or.getDepthUpperBound=or.formulaSpan=or.formulaRootAnnotation=or.formula=or.flattenNameParts=or.flattenLetArgs=or.flattenLambdaArgs=or.fieldRefNode=or.fieldRefNamePart=or.fieldRef=or.errorQualifier=or.documentQualifier=or.contextNameNode=or.commaOpRef=or.columnRef=or.cellRefSingle=or.cellRefRow=or.cellRefRange=or.cellRefNode=or.cellRefNamePart=or.cellRefError=or.cellRefCol=or.cellRefBad=or.badSequenceNode=or.badRef=or.badQualifier=or.badCharsNode=or.arrayNode=or.appNode=or.appHeadNameAnnotation=or.SyntaxFeature=or.StructRefKind=or.SpecialRefId=or.RefStyle=or.QualifierKind=or.PosKind=or.NodeKind=or.NamePartKind=or.CommentKind=or.CellRefKind=or.BadType=or.AnnotationKind=void 0;var jn=et(),Wnr=jn.formulaModule.SyntaxFeature;or.SyntaxFeature=Wnr;var jnr=jn.formulaModule.AnnotationKind;or.AnnotationKind=jnr;var Hnr=jn.formulaModule.BadType;or.BadType=Hnr;var Qnr=jn.formulaModule.CellRefKind;or.CellRefKind=Qnr;var znr=jn.formulaModule.CommentKind;or.CommentKind=znr;var Ynr=jn.formulaModule.NamePartKind;or.NamePartKind=Ynr;var Jnr=jn.formulaModule.NodeKind;or.NodeKind=Jnr;var Xnr=jn.formulaModule.PosKind;or.PosKind=Xnr;var Znr=jn.formulaModule.QualifierKind;or.QualifierKind=Znr;var $nr=jn.formulaModule.RefStyle;or.RefStyle=$nr;var etr=jn.formulaModule.SpecialRefId;or.SpecialRefId=etr;var rtr=jn.formulaModule.StructRefKind;or.StructRefKind=rtr;var ntr=jn.formulaModule.appHeadNameAnnotation;or.appHeadNameAnnotation=ntr;var ttr=jn.formulaModule.appNode;or.appNode=ttr;var atr=jn.formulaModule.arrayNode;or.arrayNode=atr;var itr=jn.formulaModule.badQualifier;or.badQualifier=itr;var otr=jn.formulaModule.badRef;or.badRef=otr;var utr=jn.formulaModule.cellRefBad;or.cellRefBad=utr;var str=jn.formulaModule.cellRefCol;or.cellRefCol=str;var ltr=jn.formulaModule.cellRefError;or.cellRefError=ltr;var ctr=jn.formulaModule.cellRefNamePart;or.cellRefNamePart=ctr;var dtr=jn.formulaModule.cellRefNode;or.cellRefNode=dtr;var ftr=jn.formulaModule.cellRefRange;or.cellRefRange=ftr;var ptr=jn.formulaModule.cellRefRow;or.cellRefRow=ptr;var mtr=jn.formulaModule.cellRefSingle;or.cellRefSingle=mtr;var gtr=jn.formulaModule.columnRef;or.columnRef=gtr;var vtr=jn.formulaModule.commaOpRef;or.commaOpRef=vtr;var htr=jn.formulaModule.documentQualifier;or.documentQualifier=htr;var Str=jn.formulaModule.errorQualifier;or.errorQualifier=Str;var ytr=jn.formulaModule.fieldRef;or.fieldRef=ytr;var Ctr=jn.formulaModule.fieldRefNamePart;or.fieldRefNamePart=Ctr;var _tr=jn.formulaModule.contextNameNode;or.contextNameNode=_tr;var Rtr=jn.formulaModule.fieldRefNode;or.fieldRefNode=Rtr;var Ttr=jn.formulaModule.flattenLambdaArgs;or.flattenLambdaArgs=Ttr;var btr=jn.formulaModule.flattenLetArgs;or.flattenLetArgs=btr;var Ptr=jn.formulaModule.flattenNameParts;or.flattenNameParts=Ptr;var Etr=jn.formulaModule.formula;or.formula=Etr;var Ntr=jn.formulaModule.formulaRootAnnotation;or.formulaRootAnnotation=Ntr;var Atr=jn.formulaModule.multiLineComment;or.multiLineComment=Atr;var Otr=jn.formulaModule.singleLineComment;or.singleLineComment=Otr;var ktr=jn.formulaModule.formulaSpan;or.formulaSpan=ktr;var Ftr=jn.formulaModule.headNamePart;or.headNamePart=Ftr;var Itr=jn.formulaModule.identNamePart;or.identNamePart=Itr;var Mtr=jn.formulaModule.identQualifier;or.identQualifier=Mtr;var wtr=jn.formulaModule.indexedArg;or.indexedArg=wtr;var Dtr=jn.formulaModule.lambdaNode;or.lambdaNode=Dtr;var xtr=jn.formulaModule.lambdaParam;or.lambdaParam=xtr;var Ltr=jn.formulaModule.letNode;or.letNode=Ltr;var Btr=jn.formulaModule.letVar;or.letVar=Btr;var qtr=jn.formulaModule.literalNode;or.literalNode=qtr;var Utr=jn.formulaModule.localNameDeclAnnotation;or.localNameDeclAnnotation=Utr;var Gtr=jn.formulaModule.localNameUseAnnotation;or.localNameUseAnnotation=Gtr;var Ktr=jn.formulaModule.missingRef;or.missingRef=Ktr;var Vtr=jn.formulaModule.nameNode;or.nameNode=Vtr;var Wtr=jn.formulaModule.operatorNode;or.operatorNode=Wtr;var jtr=jn.formulaModule.paramDefault;or.paramDefault=jtr;var Htr=jn.formulaModule.paramName;or.paramName=Htr;var Qtr=jn.formulaModule.paramNode;or.paramNode=Qtr;var ztr=jn.formulaModule.parenNode;or.parenNode=ztr;var Ytr=jn.formulaModule.pos;or.pos=Ytr;var Jtr=jn.formulaModule.rangeOpRef;or.rangeOpRef=Jtr;var Xtr=jn.formulaModule.relativeQualifier;or.relativeQualifier=Xtr;var Ztr=jn.formulaModule.sheetQualifier;or.sheetQualifier=Ztr;var $tr=jn.formulaModule.sheetRangeQualifier;or.sheetRangeQualifier=$tr;var ear=jn.formulaModule.specialRef;or.specialRef=ear;var rar=jn.formulaModule.structRef;or.structRef=rar;var nar=jn.formulaModule.structRefNode;or.structRefNode=nar;var tar=jn.formulaModule.thisRowOpRef;or.thisRowOpRef=tar;var aar=jn.formulaModule.wsfNode;or.wsfNode=aar;var iar=jn.formulaModule.getDepthUpperBound;or.getDepthUpperBound=iar;var oar=jn.formulaModule.missingNode;or.missingNode=oar;var uar=jn.formulaModule.identNode;or.identNode=uar;var sar=jn.formulaModule.varNode;or.varNode=sar;var lar=jn.formulaModule.badCharsNode;or.badCharsNode=lar;var car=jn.formulaModule.badSequenceNode;or.badSequenceNode=car});var sg=Y(uf=>{_();Object.defineProperty(uf,"__esModule",{value:!0});uf.unknownFunctionType=uf.operatorStrings=uf.higherOrderFunctionType=uf.getWorksheetFuncType=uf.getWorksheetFuncEnglishName=uf.getOperatorType=uf.WorksheetFuncId=uf.OperatorId=void 0;var gR=et(),dar=gR.signature.OperatorId;uf.OperatorId=dar;var far=gR.signature.WorksheetFuncId;uf.WorksheetFuncId=far;var par=gR.signature.getOperatorType;uf.getOperatorType=par;var mar=gR.signature.getWorksheetFuncEnglishName;uf.getWorksheetFuncEnglishName=mar;var gar=gR.signature.getWorksheetFuncType;uf.getWorksheetFuncType=gar;var har=gR.signature.higherOrderFunctionType;uf.higherOrderFunctionType=har;var Sar=gR.signature.operatorStrings;uf.operatorStrings=Sar;var yar=gR.signature.unknownFunctionType;uf.unknownFunctionType=yar});var XB=Y(Oi=>{_();Object.defineProperty(Oi,"__esModule",{value:!0});Oi.shouldQuoteQualifier=Oi.resolvePosition=Oi.quoteQualifier=Oi.formatRowRange=Oi.formatRow=Oi.formatRangePos=Oi.formatQualifier=Oi.formatName=Oi.formatGridRange=Oi.formatColRange=Oi.formatCol=Oi.formatCellPos=Oi.columnName=Oi.canonicaliseRowRange=Oi.canonicaliseRow=Oi.canonicaliseRangePos=Oi.canonicaliseColRange=Oi.canonicaliseCol=Oi.canonicaliseCellPos=Oi.canonicaliseBrackets=void 0;var ed=et(),Car=ed.cellFormat.canonicaliseBrackets;Oi.canonicaliseBrackets=Car;var _ar=ed.cellFormat.canonicaliseCellPos;Oi.canonicaliseCellPos=_ar;var Rar=ed.cellFormat.canonicaliseCol;Oi.canonicaliseCol=Rar;var Tar=ed.cellFormat.canonicaliseColRange;Oi.canonicaliseColRange=Tar;var bar=ed.cellFormat.canonicaliseRangePos;Oi.canonicaliseRangePos=bar;var Par=ed.cellFormat.canonicaliseRow;Oi.canonicaliseRow=Par;var Ear=ed.cellFormat.canonicaliseRowRange;Oi.canonicaliseRowRange=Ear;var Nar=ed.cellFormat.columnName;Oi.columnName=Nar;var Aar=ed.cellFormat.formatCellPos;Oi.formatCellPos=Aar;var Oar=ed.cellFormat.formatCol;Oi.formatCol=Oar;var kar=ed.cellFormat.formatColRange;Oi.formatColRange=kar;var Far=ed.cellFormat.formatGridRange;Oi.formatGridRange=Far;var Iar=ed.cellFormat.formatName;Oi.formatName=Iar;var Mar=ed.cellFormat.formatQualifier;Oi.formatQualifier=Mar;var war=ed.cellFormat.formatRangePos;Oi.formatRangePos=war;var Dar=ed.cellFormat.formatRow;Oi.formatRow=Dar;var xar=ed.cellFormat.formatRowRange;Oi.formatRowRange=xar;var Lar=ed.cellFormat.quoteQualifier;Oi.quoteQualifier=Lar;var Bar=ed.cellFormat.resolvePosition;Oi.resolvePosition=Bar;var qar=ed.cellFormat.shouldQuoteQualifier;Oi.shouldQuoteQualifier=qar});var ehe=Y(Ip=>{_();Object.defineProperty(Ip,"__esModule",{value:!0});Ip.wrapPosition=Ip.parseQualifier=Ip.parseGridRangeA1=Ip.parseGridCellA1=Ip.parseCellRef=Ip.isR1C1IdentStart=Ip.SpecialPos=void 0;var dP=et(),Uar=dP.cellParse.SpecialPos;Ip.SpecialPos=Uar;var Gar=dP.cellParse.isR1C1IdentStart;Ip.isR1C1IdentStart=Gar;var Kar=dP.cellParse.parseCellRef;Ip.parseCellRef=Kar;var Var=dP.cellParse.parseGridCellA1;Ip.parseGridCellA1=Var;var War=dP.cellParse.parseGridRangeA1;Ip.parseGridRangeA1=War;var jar=dP.cellParse.parseQualifier;Ip.parseQualifier=jar;var Har=dP.cellParse.wrapPosition;Ip.wrapPosition=Har});var zu=Y(Pr=>{_();Object.defineProperty(Pr,"__esModule",{value:!0});Pr.unavailable=Pr.shouldFieldRefBeBracketed=Pr.sheetRangeToSheetIndex=Pr.sheetGridRangeAnchor=Pr.notImplemented=Pr.normalizeCommaOpRef=Pr.isWriteOper=Pr.isWellFormed=Pr.isWSFNode=Pr.isValidArgsLength=Pr.isUnqualifiedNameNode=Pr.isStringOper=Pr.isSheetIndexEqual=Pr.isSheetIndex=Pr.isSheetGridRangeEqual=Pr.isSheetGridRange=Pr.isSheetGridCellEqual=Pr.isSheetGridCell=Pr.isRichOper=Pr.isReadOperEqual=Pr.isRangeOper=Pr.isRangeOpNoMissing=Pr.isRangeOpClosed=Pr.isPrimitiveOper=Pr.isOperatorNode=Pr.isNumberOper=Pr.isNumberLiteralNode=Pr.isNameScopeEqual=Pr.isMissingOper=Pr.isMissingNode=Pr.isGridRangeEqual=Pr.isGridCellEqual=Pr.isGridCell=Pr.isErrorOper=Pr.isDocumentLocEqual=Pr.isCommaOpRefWellFormed=Pr.isCommaOpNoBadOrMissing=Pr.isCommaOpClosed=Pr.isBooleanOper=Pr.isBooleanLiteralNode=Pr.isBlankOper=Pr.isArrayOper=Pr.internal=Pr.gridRangesJoin=Pr.gridRangeSize=Pr.gridRangeJoinOpt=Pr.gridRangeJoin=Pr.gridRangeIsects=Pr.gridRangeIsect=Pr.gridRangeExcept=Pr.gridRangeCompare=Pr.gridRangeAnchor=Pr.gridCellRange=Pr.gridCellImplicitIsect=Pr.getWorksheetFuncId=Pr.getUserDefinedFuncName=Pr.getBoundName=Pr.getArguments=Pr.getArgType=Pr.forEachTileInRange=Pr.forEachCellInRange=Pr.createFailureErrorClass=Pr.ReasonKind=Pr.LangReasonKind=void 0;var Nt=et(),Qar=Nt.util.LangReasonKind;Pr.LangReasonKind=Qar;var zar=Nt.util.ReasonKind;Pr.ReasonKind=zar;var Yar=Nt.util.createFailureErrorClass;Pr.createFailureErrorClass=Yar;var Jar=Nt.util.forEachCellInRange;Pr.forEachCellInRange=Jar;var Xar=Nt.util.forEachTileInRange;Pr.forEachTileInRange=Xar;var Zar=Nt.util.getArgType;Pr.getArgType=Zar;var $ar=Nt.util.getArguments;Pr.getArguments=$ar;var eir=Nt.util.getBoundName;Pr.getBoundName=eir;var rir=Nt.util.getUserDefinedFuncName;Pr.getUserDefinedFuncName=rir;var nir=Nt.util.getWorksheetFuncId;Pr.getWorksheetFuncId=nir;var tir=Nt.util.gridCellImplicitIsect;Pr.gridCellImplicitIsect=tir;var air=Nt.util.gridCellRange;Pr.gridCellRange=air;var iir=Nt.util.gridRangeAnchor;Pr.gridRangeAnchor=iir;var oir=Nt.util.gridRangeCompare;Pr.gridRangeCompare=oir;var uir=Nt.util.gridRangeExcept;Pr.gridRangeExcept=uir;var sir=Nt.util.gridRangeIsect;Pr.gridRangeIsect=sir;var lir=Nt.util.gridRangeIsects;Pr.gridRangeIsects=lir;var cir=Nt.util.gridRangeJoin;Pr.gridRangeJoin=cir;var dir=Nt.util.gridRangeJoinOpt;Pr.gridRangeJoinOpt=dir;var fir=Nt.util.gridRangeSize;Pr.gridRangeSize=fir;var pir=Nt.util.gridRangesJoin;Pr.gridRangesJoin=pir;var mir=Nt.util.internal;Pr.internal=mir;var gir=Nt.util.isArrayOper;Pr.isArrayOper=gir;var vir=Nt.util.isBlankOper;Pr.isBlankOper=vir;var hir=Nt.util.isBooleanLiteralNode;Pr.isBooleanLiteralNode=hir;var Sir=Nt.util.isBooleanOper;Pr.isBooleanOper=Sir;var yir=Nt.util.isCommaOpClosed;Pr.isCommaOpClosed=yir;var Cir=Nt.util.isCommaOpNoBadOrMissing;Pr.isCommaOpNoBadOrMissing=Cir;var _ir=Nt.util.isCommaOpRefWellFormed;Pr.isCommaOpRefWellFormed=_ir;var Rir=Nt.util.isDocumentLocEqual;Pr.isDocumentLocEqual=Rir;var Tir=Nt.util.isErrorOper;Pr.isErrorOper=Tir;var bir=Nt.util.isGridCell;Pr.isGridCell=bir;var Pir=Nt.util.isGridCellEqual;Pr.isGridCellEqual=Pir;var Eir=Nt.util.isGridRangeEqual;Pr.isGridRangeEqual=Eir;var Nir=Nt.util.isMissingNode;Pr.isMissingNode=Nir;var Air=Nt.util.isMissingOper;Pr.isMissingOper=Air;var Oir=Nt.util.isNameScopeEqual;Pr.isNameScopeEqual=Oir;var kir=Nt.util.isNumberLiteralNode;Pr.isNumberLiteralNode=kir;var Fir=Nt.util.isNumberOper;Pr.isNumberOper=Fir;var Iir=Nt.util.isOperatorNode;Pr.isOperatorNode=Iir;var Mir=Nt.util.isPrimitiveOper;Pr.isPrimitiveOper=Mir;var wir=Nt.util.isRangeOpClosed;Pr.isRangeOpClosed=wir;var Dir=Nt.util.isRangeOpNoMissing;Pr.isRangeOpNoMissing=Dir;var xir=Nt.util.isRangeOper;Pr.isRangeOper=xir;var Lir=Nt.util.isReadOperEqual;Pr.isReadOperEqual=Lir;var Bir=Nt.util.isRichOper;Pr.isRichOper=Bir;var qir=Nt.util.isSheetGridCell;Pr.isSheetGridCell=qir;var Uir=Nt.util.isSheetGridCellEqual;Pr.isSheetGridCellEqual=Uir;var Gir=Nt.util.isSheetGridRange;Pr.isSheetGridRange=Gir;var Kir=Nt.util.isSheetGridRangeEqual;Pr.isSheetGridRangeEqual=Kir;var Vir=Nt.util.isSheetIndex;Pr.isSheetIndex=Vir;var Wir=Nt.util.isSheetIndexEqual;Pr.isSheetIndexEqual=Wir;var jir=Nt.util.sheetRangeToSheetIndex;Pr.sheetRangeToSheetIndex=jir;var Hir=Nt.util.isStringOper;Pr.isStringOper=Hir;var Qir=Nt.util.isUnqualifiedNameNode;Pr.isUnqualifiedNameNode=Qir;var zir=Nt.util.isValidArgsLength;Pr.isValidArgsLength=zir;var Yir=Nt.util.isWSFNode;Pr.isWSFNode=Yir;var Jir=Nt.util.isWellFormed;Pr.isWellFormed=Jir;var Xir=Nt.util.isWriteOper;Pr.isWriteOper=Xir;var Zir=Nt.util.normalizeCommaOpRef;Pr.normalizeCommaOpRef=Zir;var $ir=Nt.util.notImplemented;Pr.notImplemented=$ir;var eor=Nt.util.sheetGridRangeAnchor;Pr.sheetGridRangeAnchor=eor;var ror=Nt.util.shouldFieldRefBeBracketed;Pr.shouldFieldRefBeBracketed=ror;var nor=Nt.util.unavailable;Pr.unavailable=nor});var tu=Y(St=>{_();Object.defineProperty(St,"__esModule",{value:!0});St.ulsLogger=St.operatorIdToName=St.localeInfo=St.isNumeral=St.isIdentStart=St.isIdentContinue=St.getOrdinal=St.getNumberShape=St.getEnglishWorksheetFuncIdToName=St.getEnglishLocaleInfo=St.englishWorksheetFuncIdToName=St.englishSysTimeFormat=St.englishSysDateFormat=St.englishSpecialRefNames=St.englishPictureSpecial=St.englishPictureSingle=St.englishPictureDbnum=St.englishPictureColor=St.englishOperatorIdToName=St.englishErrorTypeToName=St.englishErrorNames=St.createWorksheetFuncNameCallbacks=St.calcConfig=St.TraceLevel=St.PictureSpecial=St.PictureSingle=St.PictureDbnum=St.PictureColor=St.NulLogger=St.LogCategory=St.LCID=St.Country=void 0;var jo=et(),tor=jo.config.Country;St.Country=tor;var aor=jo.config.LCID;St.LCID=aor;var ior=jo.config.LogCategory;St.LogCategory=ior;var oor=jo.config.NulLogger;St.NulLogger=oor;var uor=jo.config.PictureColor;St.PictureColor=uor;var sor=jo.config.PictureDbnum;St.PictureDbnum=sor;var lor=jo.config.PictureSingle;St.PictureSingle=lor;var cor=jo.config.PictureSpecial;St.PictureSpecial=cor;var dor=jo.config.TraceLevel;St.TraceLevel=dor;var por=jo.config.calcConfig;St.calcConfig=por;var mor=jo.config.createWorksheetFuncNameCallbacks;St.createWorksheetFuncNameCallbacks=mor;var gor=jo.config.englishErrorNames;St.englishErrorNames=gor;var vor=jo.config.englishErrorTypeToName;St.englishErrorTypeToName=vor;var hor=jo.config.englishOperatorIdToName;St.englishOperatorIdToName=hor;var Sor=jo.config.englishPictureColor;St.englishPictureColor=Sor;var yor=jo.config.englishPictureDbnum;St.englishPictureDbnum=yor;var Cor=jo.config.englishPictureSingle;St.englishPictureSingle=Cor;var _or=jo.config.englishPictureSpecial;St.englishPictureSpecial=_or;var Ror=jo.config.englishSpecialRefNames;St.englishSpecialRefNames=Ror;var Tor=jo.config.englishSysDateFormat;St.englishSysDateFormat=Tor;var bor=jo.config.englishSysTimeFormat;St.englishSysTimeFormat=bor;var Por=jo.config.englishWorksheetFuncIdToName;St.englishWorksheetFuncIdToName=Por;var Eor=jo.config.getEnglishLocaleInfo;St.getEnglishLocaleInfo=Eor;var Nor=jo.config.getEnglishWorksheetFuncIdToName;St.getEnglishWorksheetFuncIdToName=Nor;var Aor=jo.config.getNumberShape;St.getNumberShape=Aor;var Oor=jo.config.getOrdinal;St.getOrdinal=Oor;var kor=jo.config.isIdentContinue;St.isIdentContinue=kor;var For=jo.config.isIdentStart;St.isIdentStart=For;var Ior=jo.config.isNumeral;St.isNumeral=Ior;var Mor=jo.config.localeInfo;St.localeInfo=Mor;var wor=jo.config.operatorIdToName;St.operatorIdToName=wor;var Dor=jo.config.ulsLogger;St.ulsLogger=Dor});var e3=Y(sf=>{_();Object.defineProperty(sf,"__esModule",{value:!0});sf.maxRetriesForLoadingScript=sf.isCalcInit=sf.initCalcThread=sf.initCalcInThread=sf.initCalcCalled=sf.initCalc=sf.getCalcAbsUrlOrThrow=sf.getCalcAbsUrl=void 0;var vR=Cn(),xor=vR.config.getCalcAbsUrl;sf.getCalcAbsUrl=xor;var Lor=vR.config.getCalcAbsUrlOrThrow;sf.getCalcAbsUrlOrThrow=Lor;var Bor=vR.config.initCalc;sf.initCalc=Bor;var qor=vR.config.initCalcCalled;sf.initCalcCalled=qor;var Uor=vR.config.initCalcInThread;sf.initCalcInThread=Uor;var Gor=vR.config.initCalcThread;sf.initCalcThread=Gor;var Kor=vR.config.isCalcInit;sf.isCalcInit=Kor;var Vor=vR.config.maxRetriesForLoadingScript;sf.maxRetriesForLoadingScript=Vor});var ZB=Y(m2=>{_();Object.defineProperty(m2,"__esModule",{value:!0});m2.resolveGridRef=m2.createResolver=void 0;var rhe=et(),Wor=rhe.resolveService.createResolver;m2.createResolver=Wor;var jor=rhe.resolveService.resolveGridRef;m2.resolveGridRef=jor});var g2=Y(ro=>{_();Object.defineProperty(ro,"__esModule",{value:!0});ro.resolvedUserDefinedFunc=ro.resolvedStructRef=ro.resolvedNever=ro.resolvedName=ro.resolvedLocalName=ro.resolvedDottedName=ro.resolvedCellRef=ro.resolveLocalsGrid=ro.noOriginSheet=ro.invalidStructRef=ro.invalidQualifier=ro.invalidCellRef=ro.emptyIntersection=ro.ResolvedKind=ro.ResolveReasonKind=ro.InvalidStructRefReason=ro.InvalidQualifierReason=ro.InvalidCellRefReason=void 0;var lf=et(),Hor=lf.resolveServiceTypes.InvalidCellRefReason;ro.InvalidCellRefReason=Hor;var Qor=lf.resolveServiceTypes.InvalidQualifierReason;ro.InvalidQualifierReason=Qor;var zor=lf.resolveServiceTypes.InvalidStructRefReason;ro.InvalidStructRefReason=zor;var Yor=lf.resolveServiceTypes.ResolveReasonKind;ro.ResolveReasonKind=Yor;var Jor=lf.resolveServiceTypes.ResolvedKind;ro.ResolvedKind=Jor;var Xor=lf.resolveServiceTypes.emptyIntersection;ro.emptyIntersection=Xor;var Zor=lf.resolveServiceTypes.invalidCellRef;ro.invalidCellRef=Zor;var $or=lf.resolveServiceTypes.invalidQualifier;ro.invalidQualifier=$or;var eur=lf.resolveServiceTypes.invalidStructRef;ro.invalidStructRef=eur;var rur=lf.resolveServiceTypes.noOriginSheet;ro.noOriginSheet=rur;var nur=lf.resolveServiceTypes.resolveLocalsGrid;ro.resolveLocalsGrid=nur;var tur=lf.resolveServiceTypes.resolvedCellRef;ro.resolvedCellRef=tur;var aur=lf.resolveServiceTypes.resolvedDottedName;ro.resolvedDottedName=aur;var iur=lf.resolveServiceTypes.resolvedLocalName;ro.resolvedLocalName=iur;var our=lf.resolveServiceTypes.resolvedName;ro.resolvedName=our;var uur=lf.resolveServiceTypes.resolvedNever;ro.resolvedNever=uur;var sur=lf.resolveServiceTypes.resolvedStructRef;ro.resolvedStructRef=sur;var lur=lf.resolveServiceTypes.resolvedUserDefinedFunc;ro.resolvedUserDefinedFunc=lur});var Ml=Y(zt=>{_();Object.defineProperty(zt,"__esModule",{value:!0});zt.zipVisitor=zt.voidVisitor=zt.visitWSFNode=zt.visitQualifier=zt.visitOperatorNode=zt.visitFormulaNode=zt.visitCellRef=zt.visitAppHeadNode=zt.reduceTopDown_Pledge=zt.reducePledge=zt.reduceBottomUp_Recursive=zt.reduceBottomUp_Pledge=zt.reduceBottomUp_MaxDepth=zt.reduceBottomUp_CPS=zt.reduceBottomUp=zt.identityVisitor=zt.depthVisitor=zt.constVisitor=zt.composeVisitor=zt.bindVisitor=zt.binaryVisitor=zt.ZipVisitor=zt.PledgeReducer=zt.IdentityVisitor=zt.DelegatingVisitor=zt.ConstVisitor=zt.ComposeVisitor=zt.BinaryVisitor=void 0;var Yu=et(),cur=Yu.visitor.BinaryVisitor;zt.BinaryVisitor=cur;var dur=Yu.visitor.ComposeVisitor;zt.ComposeVisitor=dur;var fur=Yu.visitor.ConstVisitor;zt.ConstVisitor=fur;var pur=Yu.visitor.DelegatingVisitor;zt.DelegatingVisitor=pur;var mur=Yu.visitor.IdentityVisitor;zt.IdentityVisitor=mur;var gur=Yu.visitor.PledgeReducer;zt.PledgeReducer=gur;var vur=Yu.visitor.ZipVisitor;zt.ZipVisitor=vur;var hur=Yu.visitor.binaryVisitor;zt.binaryVisitor=hur;var Sur=Yu.visitor.bindVisitor;zt.bindVisitor=Sur;var yur=Yu.visitor.composeVisitor;zt.composeVisitor=yur;var Cur=Yu.visitor.constVisitor;zt.constVisitor=Cur;var _ur=Yu.visitor.depthVisitor;zt.depthVisitor=_ur;var Rur=Yu.visitor.identityVisitor;zt.identityVisitor=Rur;var Tur=Yu.visitor.reduceBottomUp;zt.reduceBottomUp=Tur;var bur=Yu.visitor.reduceBottomUp_CPS;zt.reduceBottomUp_CPS=bur;var Pur=Yu.visitor.reduceBottomUp_MaxDepth;zt.reduceBottomUp_MaxDepth=Pur;var Eur=Yu.visitor.reduceBottomUp_Pledge;zt.reduceBottomUp_Pledge=Eur;var Nur=Yu.visitor.reduceBottomUp_Recursive;zt.reduceBottomUp_Recursive=Nur;var Aur=Yu.visitor.reducePledge;zt.reducePledge=Aur;var Our=Yu.visitor.reduceTopDown_Pledge;zt.reduceTopDown_Pledge=Our;var kur=Yu.visitor.visitAppHeadNode;zt.visitAppHeadNode=kur;var Fur=Yu.visitor.visitCellRef;zt.visitCellRef=Fur;var Iur=Yu.visitor.visitFormulaNode;zt.visitFormulaNode=Iur;var Mur=Yu.visitor.visitOperatorNode;zt.visitOperatorNode=Mur;var wur=Yu.visitor.visitQualifier;zt.visitQualifier=wur;var Dur=Yu.visitor.visitWSFNode;zt.visitWSFNode=Dur;var xur=Yu.visitor.voidVisitor;zt.voidVisitor=xur;var Lur=Yu.visitor.zipVisitor;zt.zipVisitor=Lur});var r3=Y(v2=>{_();Object.defineProperty(v2,"__esModule",{value:!0});v2.createPrinter=v2.anonymizeFormula=void 0;var nhe=et(),Bur=nhe.printService.anonymizeFormula;v2.anonymizeFormula=Bur;var qur=nhe.printService.createPrinter;v2.createPrinter=qur});var n3=Y(hR=>{_();Object.defineProperty(hR,"__esModule",{value:!0});hR.printLocalsName=hR.printLocalsGrid=hR.createSimplePrintGlobals=void 0;var AJ=et(),Uur=AJ.printServiceTypes.createSimplePrintGlobals;hR.createSimplePrintGlobals=Uur;var Gur=AJ.printServiceTypes.printLocalsGrid;hR.printLocalsGrid=Gur;var Kur=AJ.printServiceTypes.printLocalsName;hR.printLocalsName=Kur});var ahe=Y(h2=>{_();Object.defineProperty(h2,"__esModule",{value:!0});h2.numberComponents=h2.formatScientificLeft=void 0;var the=et(),Vur=the.mathpack.formatScientificLeft;h2.formatScientificLeft=Vur;var Wur=the.mathpack.numberComponents;h2.numberComponents=Wur});var ihe=Y($B=>{_();Object.defineProperty($B,"__esModule",{value:!0});$B.ieeeMathpack=void 0;var jur=et(),Hur=jur.mathpackIEEE.ieeeMathpack;$B.ieeeMathpack=Hur});var OJ=Y(eq=>{_();Object.defineProperty(eq,"__esModule",{value:!0});eq.xlMathpack=void 0;var Qur=et(),zur=Qur.mathpackXL.xlMathpack;eq.xlMathpack=zur});var rq=Y(Mp=>{_();Object.defineProperty(Mp,"__esModule",{value:!0});Mp.xlDatepack=Mp.tzUTC=Mp.tzData=Mp.dateTime=Mp.TimeGranularity=Mp.TimeDivision=Mp.Rounding=void 0;var fP=et(),Yur=fP.datepack.Rounding;Mp.Rounding=Yur;var Jur=fP.datepack.TimeDivision;Mp.TimeDivision=Jur;var Xur=fP.datepack.TimeGranularity;Mp.TimeGranularity=Xur;var Zur=fP.datepack.dateTime;Mp.dateTime=Zur;var $ur=fP.datepack.tzData;Mp.tzData=$ur;var esr=fP.datepack.tzUTC;Mp.tzUTC=esr;var rsr=fP.datepack.xlDatepack;Mp.xlDatepack=rsr});var pv=Y(fv=>{_();Object.defineProperty(fv,"__esModule",{value:!0});fv.functionType=fv.SpecialPrecs=fv.SignatureType=fv.OperKind=fv.FunctionFlags=void 0;var t3=et(),nsr=t3.types.FunctionFlags;fv.FunctionFlags=nsr;var tsr=t3.types.OperKind;fv.OperKind=tsr;var asr=t3.types.SignatureType;fv.SignatureType=asr;var isr=t3.types.SpecialPrecs;fv.SpecialPrecs=isr;var osr=t3.types.functionType;fv.functionType=osr});var ohe=Y(nq=>{_();Object.defineProperty(nq,"__esModule",{value:!0});nq.buildAnnotations=void 0;var usr=et(),ssr=usr.annotations.buildAnnotations;nq.buildAnnotations=ssr});var uhe=Y(tq=>{_();Object.defineProperty(tq,"__esModule",{value:!0});tq.relabelFormula=void 0;var lsr=et(),csr=lsr.relabel.relabelFormula;tq.relabelFormula=csr});var dhe=Y(bs=>{_();Object.defineProperty(bs,"__esModule",{value:!0});bs.value=bs.util=bs.signature=bs.math=bs.location=bs.formula=bs.date=bs.config=void 0;var dsr=wl(Jc()),S2=wl(Di()),Ts=wl(gs()),Bu=wl(f1()),Jn=wl(Qu()),a3=wl(sg()),Xh=wl(XB()),aq=wl(ehe()),Va=wl(zu()),cf=wl(tu()),kJ=wl(e3()),she=wl(ZB()),df=wl(g2()),ff=wl(Ml()),fsr=wl(r3()),FJ=wl(n3()),lhe=wl(ahe()),psr=wl(ihe()),msr=wl(OJ()),pP=wl(rq()),y2=wl(pv()),gsr=wl(ohe()),vsr=wl(uhe());function che(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,n=new WeakMap;return(che=function(o){return o?n:r})(e)}function wl(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var n=che(r);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(u!=="default"&&Object.prototype.hasOwnProperty.call(e,u)){var t=o?Object.getOwnPropertyDescriptor(e,u):null;t&&(t.get||t.set)?Object.defineProperty(a,u,t):a[u]=e[u]}return a.default=e,n&&n.set(e,a),a}var IJ;bs.location=IJ;(function(e){e.LexicalKind=Ts.LexicalKind,e.NameSource=Ts.NameSource,e.sheetRows=Ts.sheetRows,e.sheetCols=Ts.sheetCols,e.lexicalSourceCell=Ts.lexicalSourceCell,e.lexicalSourceRange=Ts.lexicalSourceRange,e.lexicalSourceGrid=Ts.lexicalSourceGrid,e.lexicalSourceName=Ts.lexicalSourceName,e.lexicalSourceWSF=Ts.lexicalSourceWSF,e.lexicalSourceUDF=Ts.lexicalSourceUDF,e.documentLoc=Ts.documentLoc,e.structRefColumnLoc=Ts.structRefColumnLoc,e.sheetIndex=Ts.sheetIndex,e.sheetRange=Ts.sheetRange,e.gridCell=Ts.gridCell,e.gridRange=Ts.gridRange,e.allSheetsRange=Ts.allSheetsRange,e.sheetRangeIndexes=Ts.sheetRangeIndexes,e.sheetGridCell=Ts.sheetGridCell,e.sheetGridRange=Ts.sheetGridRange,e.sheetGridCube=Ts.sheetGridCube,e.originCell=Ts.originCell,e.documentScope=Ts.documentScope,e.nameLoc=Ts.nameLoc,e.nameScope=Ts.nameScope,e.userDefinedFuncLoc=Ts.userDefinedFuncLoc})(IJ||(bs.location=IJ={}));var MJ;bs.value=MJ;(function(e){e.SpecialPrecs=y2.SpecialPrecs,e.PrecsBound=Bu.PrecsBound,e.OperKind=y2.OperKind,e.trueOper=Bu.trueOper,e.falseOper=Bu.falseOper,e.ErrorType=Bu.ErrorType,e.precedents=Bu.precedents,e.stringOper=Bu.stringOper,e.booleanOper=Bu.booleanOper,e.errorOper=Bu.errorOper,e.nullErrorOper=Bu.nullErrorOper,e.div0ErrorOper=Bu.div0ErrorOper,e.valueErrorOper=Bu.valueErrorOper,e.refErrorOper=Bu.refErrorOper,e.nameErrorOper=Bu.nameErrorOper,e.numErrorOper=Bu.numErrorOper,e.naErrorOper=Bu.naErrorOper,e.gettingDataErrorOper=Bu.gettingDataErrorOper,e.spillErrorOper=Bu.spillErrorOper,e.connectErrorOper=Bu.connectErrorOper,e.blockedErrorOper=Bu.blockedErrorOper,e.unknownErrorOper=Bu.unknownErrorOper,e.fieldErrorOper=Bu.fieldErrorOper,e.calcErrorOper=Bu.calcErrorOper,e.busyErrorOper=Bu.busyErrorOper,e.externalErrorOper=Bu.externalErrorOper,e.arrayOper=Bu.arrayOper,e.rangeSeqOper=Bu.rangeSeqOper,e.range3DOper=Bu.range3DOper,e.missingOper=Bu.missingOper,e.blankOper=Bu.blankOper})(MJ||(bs.value=MJ={}));var wJ;bs.formula=wJ;(function(e){e.RefStyle=Jn.RefStyle,e.SyntaxFeature=Jn.SyntaxFeature,e.QualifierKind=Jn.QualifierKind,e.CellRefKind=Jn.CellRefKind,e.PosKind=Jn.PosKind,e.CommentKind=Jn.CommentKind,e.NodeKind=Jn.NodeKind,e.NamePartKind=Jn.NamePartKind,e.SpecialRefId=Jn.SpecialRefId,e.StructRefKind=Jn.StructRefKind,e.BadType=Jn.BadType,e.errorQualifier=Jn.errorQualifier,e.relativeQualifier=Jn.relativeQualifier,e.documentQualifier=Jn.documentQualifier,e.sheetQualifier=Jn.sheetQualifier,e.identQualifier=Jn.identQualifier,e.sheetRangeQualifier=Jn.sheetRangeQualifier,e.badQualifier=Jn.badQualifier,e.pos=Jn.pos,e.cellRefError=Jn.cellRefError,e.cellRefSingle=Jn.cellRefSingle,e.cellRefRange=Jn.cellRefRange,e.cellRefRow=Jn.cellRefRow,e.cellRefCol=Jn.cellRefCol,e.cellRefBad=Jn.cellRefBad,e.formula=Jn.formula,e.multiLineComment=Jn.multiLineComment,e.singleLineComment=Jn.singleLineComment,e.formulaSpan=Jn.formulaSpan,e.literalNode=Jn.literalNode,e.arrayNode=Jn.arrayNode,e.appNode=Jn.appNode,e.flattenLetArgs=Jn.flattenLetArgs,e.indexedArg=Jn.indexedArg,e.letVar=Jn.letVar,e.letNode=Jn.letNode,e.flattenLambdaArgs=Jn.flattenLambdaArgs,e.paramName=Jn.paramName,e.paramDefault=Jn.paramDefault,e.paramNode=Jn.paramNode,e.lambdaParam=Jn.lambdaParam,e.lambdaNode=Jn.lambdaNode,e.operatorNode=Jn.operatorNode,e.wsfNode=Jn.wsfNode,e.parenNode=Jn.parenNode,e.nameNode=Jn.nameNode,e.identNamePart=Jn.identNamePart,e.cellRefNamePart=Jn.cellRefNamePart,e.fieldRefNamePart=Jn.fieldRefNamePart,e.contextNameNode=Jn.contextNameNode,e.cellRefNode=Jn.cellRefNode,e.fieldRefNode=Jn.fieldRefNode,e.fieldRef=Jn.fieldRef,e.structRefNode=Jn.structRefNode,e.structRef=Jn.structRef,e.specialRef=Jn.specialRef,e.columnRef=Jn.columnRef,e.rangeOpRef=Jn.rangeOpRef,e.commaOpRef=Jn.commaOpRef,e.thisRowOpRef=Jn.thisRowOpRef,e.missingRef=Jn.missingRef,e.badRef=Jn.badRef,e.varNode=Jn.varNode,e.identNode=Jn.identNode,e.missingNode=Jn.missingNode,e.badCharsNode=Jn.badCharsNode,e.badSequenceNode=Jn.badSequenceNode,e.flattenNameParts=Jn.flattenNameParts,e.headNamePart=Jn.headNamePart,e.AnnotationKind=Jn.AnnotationKind,e.appHeadNameAnnotation=Jn.appHeadNameAnnotation,e.formulaRootAnnotation=Jn.formulaRootAnnotation,e.localNameUseAnnotation=Jn.localNameUseAnnotation,e.localNameDeclAnnotation=Jn.localNameDeclAnnotation})(wJ||(bs.formula=wJ={}));var DJ;bs.signature=DJ;(function(e){e.SignatureType=y2.SignatureType,e.FunctionFlags=y2.FunctionFlags,e.OperatorId=a3.OperatorId,e.WorksheetFuncId=a3.WorksheetFuncId,e.SpecialPrecs=y2.SpecialPrecs,e.functionType=y2.functionType,e.unknownFunctionType=a3.unknownFunctionType,e.getOperatorType=a3.getOperatorType,e.getWorksheetFuncType=a3.getWorksheetFuncType})(DJ||(bs.signature=DJ={}));var xJ;bs.util=xJ;(function(e){e.isSheetIndex=Va.isSheetIndex,e.isSheetGridRange=Va.isSheetGridRange,e.isGridCell=Va.isGridCell,e.isSheetGridCell=Va.isSheetGridCell,e.forEachCellInRange=Va.forEachCellInRange,e.forEachTileInRange=Va.forEachTileInRange,e.gridRangeJoin=Va.gridRangeJoin,e.gridRangeJoinOpt=Va.gridRangeJoinOpt,e.gridRangesJoin=Va.gridRangesJoin,e.gridRangeIsect=Va.gridRangeIsect,e.gridRangeIsects=Va.gridRangeIsects,e.gridCellImplicitIsect=Va.gridCellImplicitIsect,e.gridRangeCompare=Va.gridRangeCompare,e.gridRangeExcept=Va.gridRangeExcept,e.gridRangeSize=Va.gridRangeSize,e.isDocumentLocEqual=Va.isDocumentLocEqual,e.isSheetIndexEqual=Va.isSheetIndexEqual,e.isNameScopeEqual=Va.isNameScopeEqual,e.isGridCellEqual=Va.isGridCellEqual,e.isGridRangeEqual=Va.isGridRangeEqual,e.isSheetGridCellEqual=Va.isSheetGridCellEqual,e.isSheetGridRangeEqual=Va.isSheetGridRangeEqual,e.isWellFormed=Va.isWellFormed,e.isUnqualifiedNameNode=Va.isUnqualifiedNameNode,e.isOperatorNode=Va.isOperatorNode,e.isWSFNode=Va.isWSFNode,e.gridRangeAnchor=Va.gridRangeAnchor,e.sheetGridRangeAnchor=Va.sheetGridRangeAnchor,e.gridCellRange=Va.gridCellRange,e.getArguments=Va.getArguments,e.getArgType=Va.getArgType,e.isValidArgsLength=Va.isValidArgsLength,e.isNumberOper=Va.isNumberOper,e.isStringOper=Va.isStringOper,e.isBooleanOper=Va.isBooleanOper,e.isErrorOper=Va.isErrorOper,e.isRangeOper=Va.isRangeOper,e.isArrayOper=Va.isArrayOper,e.isMissingOper=Va.isMissingOper,e.isBlankOper=Va.isBlankOper,e.isRichOper=Va.isRichOper,e.isPrimitiveOper=Va.isPrimitiveOper,e.isWriteOper=Va.isWriteOper,e.isReadOperEqual=Va.isReadOperEqual,e.ResultKind=S2.ResultKind,e.success=S2.success,e.failure=S2.failure,e.successUndefined=S2.successUndefined,e.isSuccess=S2.isSuccess,e.ReasonKind=Va.ReasonKind,e.notImplemented=Va.notImplemented,e.unavailable=Va.unavailable,e.internal=Va.internal,e.javaScriptError=S2.javaScriptError,e.createFailureErrorClass=Va.createFailureErrorClass,e.columnName=Xh.columnName,e.resolvePosition=Xh.resolvePosition,e.formatRow=Xh.formatRow,e.formatCol=Xh.formatCol,e.formatRowRange=Xh.formatRowRange,e.formatColRange=Xh.formatColRange,e.formatCellPos=Xh.formatCellPos,e.formatRangePos=Xh.formatRangePos,e.formatQualifier=Xh.formatQualifier,e.formatGridRange=Xh.formatGridRange,e.formatName=Xh.formatName,e.parseGridCellA1=aq.parseGridCellA1,e.parseGridRangeA1=aq.parseGridRangeA1,e.parseQualifier=aq.parseQualifier,e.wrapPosition=aq.wrapPosition,e.resolveLocalsGrid=df.resolveLocalsGrid,e.ResolveReasonKind=df.ResolveReasonKind,e.noOriginSheet=df.noOriginSheet,e.invalidQualifier=df.invalidQualifier,e.InvalidQualifierReason=df.InvalidQualifierReason,e.invalidCellRef=df.invalidCellRef,e.InvalidCellRefReason=df.InvalidCellRefReason,e.invalidStructRef=df.invalidStructRef,e.InvalidStructRefReason=df.InvalidStructRefReason,e.emptyIntersection=df.emptyIntersection,e.ResolvedKind=df.ResolvedKind,e.resolvedName=df.resolvedName,e.resolvedCellRef=df.resolvedCellRef,e.resolvedUserDefinedFunc=df.resolvedUserDefinedFunc,e.resolvedLocalName=df.resolvedLocalName,e.resolvedStructRef=df.resolvedStructRef,e.resolvedNever=df.resolvedNever,e.resolvedDottedName=df.resolvedDottedName,e.createResolver=she.createResolver,e.resolveGridRef=she.resolveGridRef,e.visitFormulaNode=ff.visitFormulaNode,e.visitOperatorNode=ff.visitOperatorNode,e.visitWSFNode=ff.visitWSFNode,e.visitAppHeadNode=ff.visitAppHeadNode,e.visitQualifier=ff.visitQualifier,e.visitCellRef=ff.visitCellRef,e.IdentityVisitor=ff.IdentityVisitor,e.identityVisitor=ff.identityVisitor,e.ConstVisitor=ff.ConstVisitor,e.constVisitor=ff.constVisitor,e.voidVisitor=ff.voidVisitor,e.DelegatingVisitor=ff.DelegatingVisitor,e.BinaryVisitor=ff.BinaryVisitor,e.binaryVisitor=ff.binaryVisitor,e.ComposeVisitor=ff.ComposeVisitor,e.composeVisitor=ff.composeVisitor,e.reduceBottomUp=ff.reduceBottomUp,e.reducePledge=ff.reducePledge,e.buildAnnotations=gsr.buildAnnotations,e.createSimplePrintGlobals=FJ.createSimplePrintGlobals,e.printLocalsGrid=FJ.printLocalsGrid,e.printLocalsName=FJ.printLocalsName,e.createPrinter=fsr.createPrinter,e.relabelFormula=vsr.relabelFormula})(xJ||(bs.util=xJ={}));var LJ;bs.config=LJ;(function(e){e.LogCategory=cf.LogCategory,e.TraceLevel=cf.TraceLevel,e.NulLogger=cf.NulLogger,e.ulsLogger=cf.ulsLogger,e.localeInfo=cf.localeInfo,e.LCID=cf.LCID,e.Country=cf.Country,e.PictureSpecial=cf.PictureSpecial,e.PictureSingle=cf.PictureSingle,e.PictureColor=cf.PictureColor,e.PictureDbnum=cf.PictureDbnum,e.calcConfig=cf.calcConfig,e.initCalc=kJ.initCalc,e.getEnglishLocaleInfo=cf.getEnglishLocaleInfo,e.englishWorksheetFuncIdToName=cf.englishWorksheetFuncIdToName,e.englishErrorTypeToName=cf.englishErrorTypeToName,e.englishOperatorIdToName=cf.englishOperatorIdToName,e.operatorIdToName=cf.operatorIdToName,e.createWorksheetFuncNameCallbacks=cf.createWorksheetFuncNameCallbacks,e.isCalcInit=kJ.isCalcInit,e.getCalcAbsUrl=kJ.getCalcAbsUrl,e.FeatureName=dsr.FeatureName})(LJ||(bs.config=LJ={}));var BJ;bs.math=BJ;(function(e){e.numberComponents=lhe.numberComponents,e.ieeeMathpack=psr.ieeeMathpack,e.xlMathpack=msr.xlMathpack,e.formatScientificLeft=lhe.formatScientificLeft})(BJ||(bs.math=BJ={}));var qJ;bs.date=qJ;(function(e){e.TimeDivision=pP.TimeDivision,e.Rounding=pP.Rounding,e.tzData=pP.tzData,e.tzUTC=pP.tzUTC,e.dateTime=pP.dateTime,e.TimeGranularity=pP.TimeGranularity,e.xlDatepack=pP.xlDatepack})(qJ||(bs.date=qJ={}))});var um=Y(rd=>{"use strict";_();Object.defineProperty(rd,"__esModule",{value:!0});rd.assertPositiveLength=rd.assertPositiveInteger=rd.assertInteger=rd.assertIndex=rd.assertNatural=rd.assertNever=rd.assertFalse=rd.assertTrue=rd.ulsLogger=void 0;var yC=Cn();rd.ulsLogger=yC.assertions.ulsLogger;rd.assertTrue=yC.assertions.assertTrue;rd.assertFalse=yC.assertions.assertFalse;rd.assertNever=yC.assertions.assertNever;rd.assertNatural=yC.assertions.assertNatural;rd.assertIndex=yC.assertions.assertIndex;rd.assertInteger=yC.assertions.assertInteger;rd.assertPositiveInteger=yC.assertions.assertPositiveInteger;rd.assertPositiveLength=yC.assertions.assertPositiveLength});var C2=Y(_a=>{"use strict";_();Object.defineProperty(_a,"__esModule",{value:!0});_a.now=_a.mapFromArrayOfPairs=_a.singleton=_a.typedInstanceCreator=_a.makeStringCompareCI=_a.fastAbs=_a.fastMax=_a.fastMin=_a.pair=_a.filterOutNones=_a.isNone=_a.isDefined=_a.safeConcat=_a.safePush=_a.strEnumArray=_a.numEnumMap=_a.numEnumArray=_a.cloneStringMap=_a.makeStringMap=_a.identity=_a.staticAssertIsOptional=_a.staticAssertIs=_a.staticAssertSame=_a.staticAssertExtends=_a.makeNewtypeIso=void 0;var Ws=Cn();_a.makeNewtypeIso=Ws.core.makeNewtypeIso;_a.staticAssertExtends=Ws.core.staticAssertExtends;_a.staticAssertSame=Ws.core.staticAssertSame;_a.staticAssertIs=Ws.core.staticAssertIs;_a.staticAssertIsOptional=Ws.core.staticAssertIsOptional;_a.identity=Ws.core.identity;_a.makeStringMap=Ws.core.makeStringMap;_a.cloneStringMap=Ws.core.cloneStringMap;_a.numEnumArray=Ws.core.numEnumArray;_a.numEnumMap=Ws.core.numEnumMap;_a.strEnumArray=Ws.core.strEnumArray;_a.safePush=Ws.core.safePush;_a.safeConcat=Ws.core.safeConcat;_a.isDefined=Ws.core.isDefined;_a.isNone=Ws.core.isNone;_a.filterOutNones=Ws.core.filterOutNones;_a.pair=Ws.core.pair;_a.fastMin=Ws.core.fastMin;_a.fastMax=Ws.core.fastMax;_a.fastAbs=Ws.core.fastAbs;_a.makeStringCompareCI=Ws.core.makeStringCompareCI;_a.typedInstanceCreator=Ws.core.typedInstanceCreator;_a.singleton=Ws.core.singleton;_a.mapFromArrayOfPairs=Ws.core.mapFromArrayOfPairs;_a.now=Ws.core.now});var UJ=Y(yt=>{"use strict";_();Object.defineProperty(yt,"__esModule",{value:!0});yt.ulsLogger=yt.operatorIdToName=yt.localeInfo=yt.isNumeral=yt.isIdentStart=yt.isIdentContinue=yt.getOrdinal=yt.getNumberShape=yt.getEnglishWorksheetFuncIdToName=yt.getEnglishLocaleInfo=yt.englishWorksheetFuncIdToName=yt.englishSysTimeFormat=yt.englishSysDateFormat=yt.englishSpecialRefNames=yt.englishPictureSpecial=yt.englishPictureSingle=yt.englishPictureDbnum=yt.englishPictureColor=yt.englishOperatorIdToName=yt.englishErrorTypeToName=yt.englishErrorNames=yt.createWorksheetFuncNameCallbacks=yt.calcConfig=yt.TraceLevel=yt.PictureSpecial=yt.PictureSingle=yt.PictureDbnum=yt.PictureColor=yt.NulLogger=yt.LogCategory=yt.LCID=yt.Country=void 0;var Ho=et();yt.Country=Ho.config.Country;yt.LCID=Ho.config.LCID;yt.LogCategory=Ho.config.LogCategory;yt.NulLogger=Ho.config.NulLogger;yt.PictureColor=Ho.config.PictureColor;yt.PictureDbnum=Ho.config.PictureDbnum;yt.PictureSingle=Ho.config.PictureSingle;yt.PictureSpecial=Ho.config.PictureSpecial;yt.TraceLevel=Ho.config.TraceLevel;yt.calcConfig=Ho.config.calcConfig;yt.createWorksheetFuncNameCallbacks=Ho.config.createWorksheetFuncNameCallbacks;yt.englishErrorNames=Ho.config.englishErrorNames;yt.englishErrorTypeToName=Ho.config.englishErrorTypeToName;yt.englishOperatorIdToName=Ho.config.englishOperatorIdToName;yt.englishPictureColor=Ho.config.englishPictureColor;yt.englishPictureDbnum=Ho.config.englishPictureDbnum;yt.englishPictureSingle=Ho.config.englishPictureSingle;yt.englishPictureSpecial=Ho.config.englishPictureSpecial;yt.englishSpecialRefNames=Ho.config.englishSpecialRefNames;yt.englishSysDateFormat=Ho.config.englishSysDateFormat;yt.englishSysTimeFormat=Ho.config.englishSysTimeFormat;yt.englishWorksheetFuncIdToName=Ho.config.englishWorksheetFuncIdToName;yt.getEnglishLocaleInfo=Ho.config.getEnglishLocaleInfo;yt.getEnglishWorksheetFuncIdToName=Ho.config.getEnglishWorksheetFuncIdToName;yt.getNumberShape=Ho.config.getNumberShape;yt.getOrdinal=Ho.config.getOrdinal;yt.isIdentContinue=Ho.config.isIdentContinue;yt.isIdentStart=Ho.config.isIdentStart;yt.isNumeral=Ho.config.isNumeral;yt.localeInfo=Ho.config.localeInfo;yt.operatorIdToName=Ho.config.operatorIdToName;yt.ulsLogger=Ho.config.ulsLogger});var SR=Y(p1=>{"use strict";_();Object.defineProperty(p1,"__esModule",{value:!0});p1.kindAnonymizers=p1.anonymizeMagnitude=p1.anonymizeFormulaString=p1.anonymize=void 0;var iq=Cn();p1.anonymize=iq.anonymizer.anonymize;p1.anonymizeFormulaString=iq.anonymizer.anonymizeFormulaString;p1.anonymizeMagnitude=iq.anonymizer.anonymizeMagnitude;p1.kindAnonymizers=iq.anonymizer.kindAnonymizers});var uq=Y(nd=>{"use strict";_();var mi,Fa;Object.defineProperty(nd,"__esModule",{value:!0});nd.convertDiagnosticToNLMessage=nd.baseNLErrors=nd.formatDiagnostic=nd.baseErrors=nd.TypeSourceKind=nd.TypeError=nd.SyntaxError=void 0;var oq=UJ(),hsr=SR(),Ir;(function(e){e.Unclosed_application="Unclosed_application",e.Unclosed_paren="Unclosed_paren",e.Unclosed_bracket="Unclosed_bracket",e.Unclosed_array="Unclosed_array",e.Unclosed_literal="Unclosed_literal",e.Unclosed_comment="Unclosed_comment",e.Invalid_number_literal="Invalid_number_literal",e.Invalid_string_literal="Invalid_string_literal",e.Invalid_error_literal="Invalid_error_literal",e.Invalid_function_name="Invalid_function_name",e.Invalid_name="Invalid_name",e.Illegal_array_literal_element="Illegal_array_literal_element",e.Empty_array_literal="Empty_array_literal",e.Irregular_array_shape="Irregular_array_shape",e.Empty_parenthesis="Empty_parenthesis",e.Missing_operation_argument="Missing_operation_argument",e.Bad_node="Bad_node",e.Invalid_qualifier="Invalid_qualifier",e.Invalid_cell_ref="Invalid_cell_ref",e.Invalid_binder="Invalid_binder",e.Missing_binder="Missing_binder",e.Duplicate_binder="Duplicate_binder",e.Invalid_body="Invalid_body",e.Mandatory_binder_after_optional="Mandatory_binder_after_optional",e.Missing_default_expression="Missing_default_expression",e.Binder_requires_brackets="Binder_requires_brackets",e.Invalid_field_name="Invalid_field_name",e.Missing_field_name="Missing_field_name",e.Empty_formula="Empty_formula",e.Invalid_rel_sheet_qualifier_in_cell="Invalid_rel_sheet_qualifier_in_cell",e.Invalid_rel_sheet_qualifier_in_name="Invalid_rel_sheet_qualifier_in_name",e.Invalid_unqualified_cell="Invalid_unqualified_cell",e.Unexpected_closing_paren="Unexpected_closing_paren",e.Unexpected_closing_brace="Unexpected_closing_brace",e.Unexpected_closing_bracket="Unexpected_closing_bracket",e.Unexpected_character="Unexpected_character",e.Unexpected_field_ref="Unexpected_field_ref",e.Unexpected_dot="Unexpected_dot",e.Invalid_struct_ref_table_name="Invalid_struct_ref_table_name",e.Invalid_struct_ref_comma_parts="Invalid_struct_ref_comma_parts",e.Invalid_struct_ref_missing_part="Invalid_struct_ref_missing_part",e.Invalid_struct_ref_bad_part="Invalid_struct_ref_bad_part",e.Excess_higher_order_function_arguments="Excess_higher_order_function_arguments"})(Ir=nd.SyntaxError||(nd.SyntaxError={}));var b0;(function(e){e.Types_not_related="Types_not_related",e.Unexpected_application_head="Unexpected_application_head",e.Unexpected_application_head_with_fix="Unexpected_application_head_with_fix",e.Incorrect_number_of_operator_arguments="Incorrect_number_of_operator_arguments",e.Excess_function_arguments="Excess_function_arguments",e.Insufficient_function_arguments="Insufficient_function_arguments"})(b0=nd.TypeError||(nd.TypeError={}));var GJ;(function(e){e.WSFArgument="WSFArgument",e.OperatorArgument="OperatorArgument"})(GJ=nd.TypeSourceKind||(nd.TypeSourceKind={}));nd.baseErrors=(mi={},mi[Ir.Unclosed_application]={kind:Ir.Unclosed_application},mi[Ir.Unclosed_paren]={kind:Ir.Unclosed_paren},mi[Ir.Unclosed_bracket]={kind:Ir.Unclosed_bracket},mi[Ir.Unclosed_array]={kind:Ir.Unclosed_array},mi[Ir.Unclosed_literal]={kind:Ir.Unclosed_literal},mi[Ir.Unclosed_comment]={kind:Ir.Unclosed_comment},mi[Ir.Invalid_number_literal]={kind:Ir.Invalid_number_literal},mi[Ir.Invalid_string_literal]={kind:Ir.Invalid_string_literal},mi[Ir.Invalid_error_literal]={kind:Ir.Invalid_error_literal},mi[Ir.Invalid_function_name]={kind:Ir.Invalid_function_name},mi[Ir.Invalid_name]={kind:Ir.Invalid_name},mi[Ir.Illegal_array_literal_element]={kind:Ir.Illegal_array_literal_element},mi[Ir.Empty_array_literal]={kind:Ir.Empty_array_literal},mi[Ir.Irregular_array_shape]={kind:Ir.Irregular_array_shape},mi[Ir.Empty_parenthesis]={kind:Ir.Empty_parenthesis},mi[Ir.Bad_node]={kind:Ir.Bad_node},mi[Ir.Invalid_qualifier]={kind:Ir.Invalid_qualifier},mi[Ir.Invalid_cell_ref]={kind:Ir.Invalid_cell_ref},mi[Ir.Invalid_binder]={kind:Ir.Invalid_binder},mi[Ir.Missing_binder]={kind:Ir.Missing_binder},mi[Ir.Duplicate_binder]={kind:Ir.Duplicate_binder},mi[Ir.Invalid_body]={kind:Ir.Invalid_body},mi[Ir.Mandatory_binder_after_optional]={kind:Ir.Mandatory_binder_after_optional},mi[Ir.Missing_default_expression]={kind:Ir.Missing_default_expression},mi[Ir.Binder_requires_brackets]={kind:Ir.Binder_requires_brackets},mi[Ir.Invalid_field_name]={kind:Ir.Invalid_field_name},mi[Ir.Missing_field_name]={kind:Ir.Missing_field_name},mi[Ir.Empty_formula]={kind:Ir.Empty_formula},mi[Ir.Invalid_rel_sheet_qualifier_in_cell]={kind:Ir.Invalid_rel_sheet_qualifier_in_cell},mi[Ir.Invalid_rel_sheet_qualifier_in_name]={kind:Ir.Invalid_rel_sheet_qualifier_in_name},mi[Ir.Invalid_unqualified_cell]={kind:Ir.Invalid_unqualified_cell},mi[Ir.Unexpected_closing_paren]={kind:Ir.Unexpected_closing_paren},mi[Ir.Unexpected_closing_brace]={kind:Ir.Unexpected_closing_brace},mi[Ir.Unexpected_closing_bracket]={kind:Ir.Unexpected_closing_bracket},mi[Ir.Unexpected_field_ref]={kind:Ir.Unexpected_field_ref},mi[Ir.Unexpected_dot]={kind:Ir.Unexpected_dot},mi[Ir.Invalid_struct_ref_table_name]={kind:Ir.Invalid_struct_ref_table_name},mi[Ir.Invalid_struct_ref_comma_parts]={kind:Ir.Invalid_struct_ref_comma_parts},mi[Ir.Invalid_struct_ref_missing_part]={kind:Ir.Invalid_struct_ref_missing_part},mi[Ir.Invalid_struct_ref_bad_part]={kind:Ir.Invalid_struct_ref_bad_part},mi[b0.Unexpected_application_head]={kind:b0.Unexpected_application_head},mi[b0.Unexpected_application_head_with_fix]={kind:b0.Unexpected_application_head_with_fix},mi);function Ssr(e){var r=e.kind,n=e.argIndex;switch(e.kind){case GJ.WSFArgument:return JSON.stringify({kind:r,funcId:(0,oq.englishWorksheetFuncIdToName)(e.funcId),argIndex:n});case GJ.OperatorArgument:return JSON.stringify({kind:r,opId:(0,oq.englishOperatorIdToName)(e.opId),argIndex:n})}}function ysr(e){switch(e.kind){case b0.Insufficient_function_arguments:case b0.Excess_function_arguments:return"".concat(e.kind,": ").concat((0,oq.englishWorksheetFuncIdToName)(e.funcId));case Ir.Missing_operation_argument:case b0.Incorrect_number_of_operator_arguments:return"".concat(e.kind,": ").concat((0,oq.englishOperatorIdToName)(e.opId));case Ir.Unexpected_character:return"".concat(e.kind,": ").concat((0,hsr.anonymizeFormulaString)(e.text));case b0.Types_not_related:return"".concat(e.kind,": ").concat(Ssr(e.typeSource));default:return e.kind}}nd.formatDiagnostic=ysr;var yR="The formulas has an error";nd.baseNLErrors=(Fa={},Fa[Ir.Unclosed_application]="The formula is missing a parenthesis",Fa[Ir.Unclosed_paren]="The formula is missing a parenthesis",Fa[Ir.Unclosed_bracket]="The formula is missing a bracket",Fa[Ir.Unclosed_array]="The formula is missing a brace",Fa[Ir.Unclosed_literal]="The formula is missing a quote",Fa[Ir.Unclosed_comment]="The formula comment is missing an end",Fa[Ir.Invalid_number_literal]="The formula has an invalid number",Fa[Ir.Invalid_string_literal]="The formula has an invalid string",Fa[Ir.Invalid_error_literal]="The formula has an invalid value",Fa[Ir.Invalid_function_name]="The formula has an invalid function name",Fa[Ir.Invalid_name]="The formula has an invalid name",Fa[Ir.Illegal_array_literal_element]="The formula has an invalid value",Fa[Ir.Empty_array_literal]="The formula has an empty array",Fa[Ir.Irregular_array_shape]="The formula has an incorrectly shaped array",Fa[Ir.Empty_parenthesis]="The formula is missing values between parentheses",Fa[Ir.Missing_operation_argument]="The formula has an extra operator",Fa[Ir.Bad_node]=yR,Fa[Ir.Invalid_qualifier]="The formula has an invalid sheet reference",Fa[Ir.Invalid_cell_ref]="The formula has an invalid cell reference",Fa[Ir.Invalid_binder]=yR,Fa[Ir.Missing_binder]=yR,Fa[Ir.Duplicate_binder]=yR,Fa[Ir.Invalid_body]=yR,Fa[Ir.Mandatory_binder_after_optional]=yR,Fa[Ir.Missing_default_expression]=yR,Fa[Ir.Binder_requires_brackets]=yR,Fa[Ir.Invalid_field_name]="The formula has an invalid field name",Fa[Ir.Missing_field_name]="The formula is missing a field name",Fa[Ir.Empty_formula]="The formula is empty",Fa[Ir.Invalid_rel_sheet_qualifier_in_cell]="The formula has an incorrect reference",Fa[Ir.Invalid_rel_sheet_qualifier_in_name]="The formula has an incorrect reference",Fa[Ir.Invalid_unqualified_cell]="The formula has an incorrect reference",Fa[Ir.Unexpected_closing_paren]="The formula has an extra parenthesis",Fa[Ir.Unexpected_closing_brace]="The formula has an extra brace",Fa[Ir.Unexpected_closing_bracket]="The formula has an extra bracket",Fa[Ir.Unexpected_character]="The formula has some extra characters",Fa[Ir.Unexpected_field_ref]="The formula has an extra field",Fa[Ir.Unexpected_dot]="The formula has an extra dot",Fa[Ir.Invalid_struct_ref_table_name]="The formula has a malformed table name in a structured reference",Fa[Ir.Invalid_struct_ref_comma_parts]="The formula has a structured reference with commas that has issues between its brackets",Fa[Ir.Invalid_struct_ref_missing_part]="The formula has a structured reference with missing references between its brackets",Fa[Ir.Invalid_struct_ref_bad_part]="The formula has a bad reference in a structured reference",Fa[Ir.Excess_higher_order_function_arguments]="The formula has a function call with too many arguments",Fa[b0.Types_not_related]="The formula has an operation using data that cannot be mixed together",Fa[b0.Unexpected_application_head]="The formula has a malformed function call",Fa[b0.Unexpected_application_head_with_fix]="The formula has a malformed function call",Fa[b0.Incorrect_number_of_operator_arguments]="The formula has an operation with the wrong number of arguments",Fa[b0.Excess_function_arguments]="The formula has a function call with too many arguments",Fa[b0.Insufficient_function_arguments]="The formula has a function call with missing arguments",Fa);function Csr(e){return nd.baseNLErrors[e.kind]}nd.convertDiagnosticToNLMessage=Csr});var fhe=Y(sq=>{"use strict";_();Object.defineProperty(sq,"__esModule",{value:!0});sq.RedBlackMapTree=void 0;var _sr=Cn();sq.RedBlackMapTree=_sr.rbMapTree.RedBlackMapTree});var m1=Y(Er=>{"use strict";_();Object.defineProperty(Er,"__esModule",{value:!0});Er.isSheetGridRange=Er.isSheetGridCellEqual=Er.isSheetGridCell=Er.isRichOper=Er.isReadOperEqual=Er.isRangeOper=Er.isRangeOpNoMissing=Er.isRangeOpClosed=Er.isPrimitiveOper=Er.isOperatorNode=Er.isNumberOper=Er.isNumberLiteralNode=Er.isNameScopeEqual=Er.isMissingOper=Er.isMissingLiteralNode=Er.isMissingNode=Er.isGridRangeEqual=Er.isGridCellEqual=Er.isGridCell=Er.isErrorOper=Er.isDocumentLocEqual=Er.isCommaOpRefWellFormed=Er.isCommaOpNoBadOrMissing=Er.isCommaOpClosed=Er.isBooleanOper=Er.isBooleanLiteralNode=Er.isBlankOper=Er.isArrayOper=Er.internal=Er.gridRangesJoin=Er.gridRangeSize=Er.gridRangeJoinOpt=Er.gridRangeJoin=Er.gridRangeIsects=Er.gridRangeIsect=Er.gridRangeExcept=Er.gridRangeCompare=Er.gridRangeAnchor=Er.gridCellRange=Er.gridCellImplicitIsect=Er.getWorksheetFuncId=Er.getUserDefinedFuncName=Er.getBoundName=Er.getArguments=Er.getArgType=Er.forEachTileInRange=Er.forEachCellInRange=Er.createFailureErrorClass=Er.ReasonKind=Er.LangReasonKind=void 0;Er.unavailable=Er.shouldFieldRefBeBracketed=Er.sheetGridRangeAnchor=Er.notImplemented=Er.normalizeCommaOpRef=Er.isWriteOper=Er.isWellFormed=Er.isWSFNode=Er.isValidArgsLength=Er.isUnqualifiedNameNode=Er.isStringOper=Er.isSheetIndexEqual=Er.isSheetIndex=Er.isSheetGridRangeEqual=void 0;var At=et();Er.LangReasonKind=At.util.LangReasonKind;Er.ReasonKind=At.util.ReasonKind;Er.createFailureErrorClass=At.util.createFailureErrorClass;Er.forEachCellInRange=At.util.forEachCellInRange;Er.forEachTileInRange=At.util.forEachTileInRange;Er.getArgType=At.util.getArgType;Er.getArguments=At.util.getArguments;Er.getBoundName=At.util.getBoundName;Er.getUserDefinedFuncName=At.util.getUserDefinedFuncName;Er.getWorksheetFuncId=At.util.getWorksheetFuncId;Er.gridCellImplicitIsect=At.util.gridCellImplicitIsect;Er.gridCellRange=At.util.gridCellRange;Er.gridRangeAnchor=At.util.gridRangeAnchor;Er.gridRangeCompare=At.util.gridRangeCompare;Er.gridRangeExcept=At.util.gridRangeExcept;Er.gridRangeIsect=At.util.gridRangeIsect;Er.gridRangeIsects=At.util.gridRangeIsects;Er.gridRangeJoin=At.util.gridRangeJoin;Er.gridRangeJoinOpt=At.util.gridRangeJoinOpt;Er.gridRangeSize=At.util.gridRangeSize;Er.gridRangesJoin=At.util.gridRangesJoin;Er.internal=At.util.internal;Er.isArrayOper=At.util.isArrayOper;Er.isBlankOper=At.util.isBlankOper;Er.isBooleanLiteralNode=At.util.isBooleanLiteralNode;Er.isBooleanOper=At.util.isBooleanOper;Er.isCommaOpClosed=At.util.isCommaOpClosed;Er.isCommaOpNoBadOrMissing=At.util.isCommaOpNoBadOrMissing;Er.isCommaOpRefWellFormed=At.util.isCommaOpRefWellFormed;Er.isDocumentLocEqual=At.util.isDocumentLocEqual;Er.isErrorOper=At.util.isErrorOper;Er.isGridCell=At.util.isGridCell;Er.isGridCellEqual=At.util.isGridCellEqual;Er.isGridRangeEqual=At.util.isGridRangeEqual;Er.isMissingNode=At.util.isMissingNode;Er.isMissingLiteralNode=At.util.isMissingLiteralNode;Er.isMissingOper=At.util.isMissingOper;Er.isNameScopeEqual=At.util.isNameScopeEqual;Er.isNumberLiteralNode=At.util.isNumberLiteralNode;Er.isNumberOper=At.util.isNumberOper;Er.isOperatorNode=At.util.isOperatorNode;Er.isPrimitiveOper=At.util.isPrimitiveOper;Er.isRangeOpClosed=At.util.isRangeOpClosed;Er.isRangeOpNoMissing=At.util.isRangeOpNoMissing;Er.isRangeOper=At.util.isRangeOper;Er.isReadOperEqual=At.util.isReadOperEqual;Er.isRichOper=At.util.isRichOper;Er.isSheetGridCell=At.util.isSheetGridCell;Er.isSheetGridCellEqual=At.util.isSheetGridCellEqual;Er.isSheetGridRange=At.util.isSheetGridRange;Er.isSheetGridRangeEqual=At.util.isSheetGridRangeEqual;Er.isSheetIndex=At.util.isSheetIndex;Er.isSheetIndexEqual=At.util.isSheetIndexEqual;Er.isStringOper=At.util.isStringOper;Er.isUnqualifiedNameNode=At.util.isUnqualifiedNameNode;Er.isValidArgsLength=At.util.isValidArgsLength;Er.isWSFNode=At.util.isWSFNode;Er.isWellFormed=At.util.isWellFormed;Er.isWriteOper=At.util.isWriteOper;Er.normalizeCommaOpRef=At.util.normalizeCommaOpRef;Er.notImplemented=At.util.notImplemented;Er.sheetGridRangeAnchor=At.util.sheetGridRangeAnchor;Er.shouldFieldRefBeBracketed=At.util.shouldFieldRefBeBracketed;Er.unavailable=At.util.unavailable});var CC=Y(mv=>{"use strict";_();Object.defineProperty(mv,"__esModule",{value:!0});mv.functionType=mv.SpecialPrecs=mv.SignatureType=mv.OperKind=mv.FunctionFlags=void 0;var i3=et();mv.FunctionFlags=i3.types.FunctionFlags;mv.OperKind=i3.types.OperKind;mv.SignatureType=i3.types.SignatureType;mv.SpecialPrecs=i3.types.SpecialPrecs;mv.functionType=i3.types.functionType});var wp=Y(sr=>{"use strict";_();Object.defineProperty(sr,"__esModule",{value:!0});sr.localNameUseAnnotation=sr.localNameDeclAnnotation=sr.literalNode=sr.letVar=sr.letNode=sr.lambdaParam=sr.lambdaNode=sr.indexedArg=sr.identQualifier=sr.identNamePart=sr.headNamePart=sr.formulaSpan=sr.multiLineComment=sr.singleLineComment=sr.formulaRootAnnotation=sr.formula=sr.flattenNameParts=sr.flattenLetArgs=sr.flattenLambdaArgs=sr.fieldRefNode=sr.fieldRefNamePart=sr.fieldRef=sr.errorQualifier=sr.documentQualifier=sr.commaOpRef=sr.columnRef=sr.cellRefSingle=sr.cellRefRow=sr.cellRefRange=sr.cellRefNode=sr.cellRefNamePart=sr.cellRefError=sr.cellRefCol=sr.cellRefBad=sr.badRef=sr.badQualifier=sr.arrayNode=sr.appNode=sr.appHeadNameAnnotation=sr.StructRefKind=sr.SpecialRefId=sr.RefStyle=sr.QualifierKind=sr.PosKind=sr.NodeKind=sr.NamePartKind=sr.CellRefKind=sr.BadType=sr.AnnotationKind=sr.SyntaxFeature=void 0;sr.badSequenceNode=sr.badCharsNode=sr.varNode=sr.identNode=sr.missingNode=sr.getDepthUpperBound=sr.wsfNode=sr.thisRowOpRef=sr.contextNameNode=sr.structRefNode=sr.structRef=sr.specialRef=sr.sheetRangeQualifier=sr.sheetQualifier=sr.relativeQualifier=sr.rangeOpRef=sr.pos=sr.parenNode=sr.paramNode=sr.paramName=sr.paramDefault=sr.operatorNode=sr.nameNode=sr.missingRef=void 0;var Xn=et();sr.SyntaxFeature=Xn.formulaModule.SyntaxFeature;sr.AnnotationKind=Xn.formulaModule.AnnotationKind;sr.BadType=Xn.formulaModule.BadType;sr.CellRefKind=Xn.formulaModule.CellRefKind;sr.NamePartKind=Xn.formulaModule.NamePartKind;sr.NodeKind=Xn.formulaModule.NodeKind;sr.PosKind=Xn.formulaModule.PosKind;sr.QualifierKind=Xn.formulaModule.QualifierKind;sr.RefStyle=Xn.formulaModule.RefStyle;sr.SpecialRefId=Xn.formulaModule.SpecialRefId;sr.StructRefKind=Xn.formulaModule.StructRefKind;sr.appHeadNameAnnotation=Xn.formulaModule.appHeadNameAnnotation;sr.appNode=Xn.formulaModule.appNode;sr.arrayNode=Xn.formulaModule.arrayNode;sr.badQualifier=Xn.formulaModule.badQualifier;sr.badRef=Xn.formulaModule.badRef;sr.cellRefBad=Xn.formulaModule.cellRefBad;sr.cellRefCol=Xn.formulaModule.cellRefCol;sr.cellRefError=Xn.formulaModule.cellRefError;sr.cellRefNamePart=Xn.formulaModule.cellRefNamePart;sr.cellRefNode=Xn.formulaModule.cellRefNode;sr.cellRefRange=Xn.formulaModule.cellRefRange;sr.cellRefRow=Xn.formulaModule.cellRefRow;sr.cellRefSingle=Xn.formulaModule.cellRefSingle;sr.columnRef=Xn.formulaModule.columnRef;sr.commaOpRef=Xn.formulaModule.commaOpRef;sr.documentQualifier=Xn.formulaModule.documentQualifier;sr.errorQualifier=Xn.formulaModule.errorQualifier;sr.fieldRef=Xn.formulaModule.fieldRef;sr.fieldRefNamePart=Xn.formulaModule.fieldRefNamePart;sr.fieldRefNode=Xn.formulaModule.fieldRefNode;sr.flattenLambdaArgs=Xn.formulaModule.flattenLambdaArgs;sr.flattenLetArgs=Xn.formulaModule.flattenLetArgs;sr.flattenNameParts=Xn.formulaModule.flattenNameParts;sr.formula=Xn.formulaModule.formula;sr.formulaRootAnnotation=Xn.formulaModule.formulaRootAnnotation;sr.singleLineComment=Xn.formulaModule.singleLineComment;sr.multiLineComment=Xn.formulaModule.multiLineComment;sr.formulaSpan=Xn.formulaModule.formulaSpan;sr.headNamePart=Xn.formulaModule.headNamePart;sr.identNamePart=Xn.formulaModule.identNamePart;sr.identQualifier=Xn.formulaModule.identQualifier;sr.indexedArg=Xn.formulaModule.indexedArg;sr.lambdaNode=Xn.formulaModule.lambdaNode;sr.lambdaParam=Xn.formulaModule.lambdaParam;sr.letNode=Xn.formulaModule.letNode;sr.letVar=Xn.formulaModule.letVar;sr.literalNode=Xn.formulaModule.literalNode;sr.localNameDeclAnnotation=Xn.formulaModule.localNameDeclAnnotation;sr.localNameUseAnnotation=Xn.formulaModule.localNameUseAnnotation;sr.missingRef=Xn.formulaModule.missingRef;sr.nameNode=Xn.formulaModule.nameNode;sr.operatorNode=Xn.formulaModule.operatorNode;sr.paramDefault=Xn.formulaModule.paramDefault;sr.paramName=Xn.formulaModule.paramName;sr.paramNode=Xn.formulaModule.paramNode;sr.parenNode=Xn.formulaModule.parenNode;sr.pos=Xn.formulaModule.pos;sr.rangeOpRef=Xn.formulaModule.rangeOpRef;sr.relativeQualifier=Xn.formulaModule.relativeQualifier;sr.sheetQualifier=Xn.formulaModule.sheetQualifier;sr.sheetRangeQualifier=Xn.formulaModule.sheetRangeQualifier;sr.specialRef=Xn.formulaModule.specialRef;sr.structRef=Xn.formulaModule.structRef;sr.structRefNode=Xn.formulaModule.structRefNode;sr.contextNameNode=Xn.formulaModule.contextNameNode;sr.thisRowOpRef=Xn.formulaModule.thisRowOpRef;sr.wsfNode=Xn.formulaModule.wsfNode;sr.getDepthUpperBound=Xn.formulaModule.getDepthUpperBound;sr.missingNode=Xn.formulaModule.missingNode;sr.identNode=Xn.formulaModule.identNode;sr.varNode=Xn.formulaModule.varNode;sr.badCharsNode=Xn.formulaModule.badCharsNode;sr.badSequenceNode=Xn.formulaModule.badSequenceNode});var g1=Y(za=>{"use strict";_();Object.defineProperty(za,"__esModule",{value:!0});za.valueErrorOper=za.trueOper=za.stringOper=za.refErrorOper=za.rangeSeqOper=za.range3DOper=za.precedents=za.numErrorOper=za.nullErrorOper=za.nameErrorOper=za.naErrorOper=za.missingOper=za.gettingDataErrorOper=za.fieldErrorOper=za.falseOper=za.errorOper=za.div0ErrorOper=za.cellStringLimit=za.booleanOper=za.blankOper=za.arrayOper=za.PrecsBound=za.ErrorType=void 0;var Dl=et();za.ErrorType=Dl.value.ErrorType;za.PrecsBound=Dl.value.PrecsBound;za.arrayOper=Dl.value.arrayOper;za.blankOper=Dl.value.blankOper;za.booleanOper=Dl.value.booleanOper;za.cellStringLimit=Dl.value.cellStringLimit;za.div0ErrorOper=Dl.value.div0ErrorOper;za.errorOper=Dl.value.errorOper;za.falseOper=Dl.value.falseOper;za.fieldErrorOper=Dl.value.fieldErrorOper;za.gettingDataErrorOper=Dl.value.gettingDataErrorOper;za.missingOper=Dl.value.missingOper;za.naErrorOper=Dl.value.naErrorOper;za.nameErrorOper=Dl.value.nameErrorOper;za.nullErrorOper=Dl.value.nullErrorOper;za.numErrorOper=Dl.value.numErrorOper;za.precedents=Dl.value.precedents;za.range3DOper=Dl.value.range3DOper;za.rangeSeqOper=Dl.value.rangeSeqOper;za.refErrorOper=Dl.value.refErrorOper;za.stringOper=Dl.value.stringOper;za.trueOper=Dl.value.trueOper;za.valueErrorOper=Dl.value.valueErrorOper});var _R=Y(pf=>{"use strict";_();Object.defineProperty(pf,"__esModule",{value:!0});pf.unknownFunctionType=pf.operatorStrings=pf.higherOrderFunctionType=pf.getWorksheetFuncType=pf.getWorksheetFuncEnglishName=pf.getOperatorType=pf.WorksheetFuncId=pf.OperatorId=void 0;var CR=et();pf.OperatorId=CR.signature.OperatorId;pf.WorksheetFuncId=CR.signature.WorksheetFuncId;pf.getOperatorType=CR.signature.getOperatorType;pf.getWorksheetFuncEnglishName=CR.signature.getWorksheetFuncEnglishName;pf.getWorksheetFuncType=CR.signature.getWorksheetFuncType;pf.higherOrderFunctionType=CR.signature.higherOrderFunctionType;pf.operatorStrings=CR.signature.operatorStrings;pf.unknownFunctionType=CR.signature.unknownFunctionType});var lg=Y(Dp=>{"use strict";_();Object.defineProperty(Dp,"__esModule",{value:!0});Dp.successUndefined=Dp.success=Dp.javaScriptError=Dp.isSuccess=Dp.failure=Dp.ResultKind=Dp.ReasonKind=void 0;var mP=Cn();Dp.ReasonKind=mP.result.ReasonKind;Dp.ResultKind=mP.result.ResultKind;Dp.failure=mP.result.failure;Dp.isSuccess=mP.result.isSuccess;Dp.javaScriptError=mP.result.javaScriptError;Dp.success=mP.result.success;Dp.successUndefined=mP.result.successUndefined});var lq=Y(Ot=>{"use strict";_();Object.defineProperty(Ot,"__esModule",{value:!0});Ot.userDefinedFuncLoc=Ot.unsafeGridRange=Ot.structRefColumnLoc=Ot.sheetRows=Ot.sheetRangeIndexes=Ot.sheetRange=Ot.sheetIndex=Ot.sheetGridRange=Ot.sheetGridCube=Ot.sheetGridCell=Ot.sheetCols=Ot.originCell=Ot.nameScope=Ot.nameLoc=Ot.lexicalSourceUDF=Ot.lexicalSourceWSF=Ot.lexicalSourceRange=Ot.lexicalSourceName=Ot.lexicalSourceGrid=Ot.lexicalSourceCell=Ot.isSheetIndex=Ot.isSheetGridRange=Ot.isSheetGridCell=Ot.isGridCell=Ot.gridRange=Ot.gridCell=Ot.documentScope=Ot.documentLoc=Ot.allSheetsRange=Ot.NameSource=Ot.LexicalKind=void 0;var au=et();Ot.LexicalKind=au.location.LexicalKind;Ot.NameSource=au.location.NameSource;Ot.allSheetsRange=au.location.allSheetsRange;Ot.documentLoc=au.location.documentLoc;Ot.documentScope=au.location.documentScope;Ot.gridCell=au.location.gridCell;Ot.gridRange=au.location.gridRange;Ot.isGridCell=au.location.isGridCell;Ot.isSheetGridCell=au.location.isSheetGridCell;Ot.isSheetGridRange=au.location.isSheetGridRange;Ot.isSheetIndex=au.location.isSheetIndex;Ot.lexicalSourceCell=au.location.lexicalSourceCell;Ot.lexicalSourceGrid=au.location.lexicalSourceGrid;Ot.lexicalSourceName=au.location.lexicalSourceName;Ot.lexicalSourceRange=au.location.lexicalSourceRange;Ot.lexicalSourceWSF=au.location.lexicalSourceWSF;Ot.lexicalSourceUDF=au.location.lexicalSourceUDF;Ot.nameLoc=au.location.nameLoc;Ot.nameScope=au.location.nameScope;Ot.originCell=au.location.originCell;Ot.sheetCols=au.location.sheetCols;Ot.sheetGridCell=au.location.sheetGridCell;Ot.sheetGridCube=au.location.sheetGridCube;Ot.sheetGridRange=au.location.sheetGridRange;Ot.sheetIndex=au.location.sheetIndex;Ot.sheetRange=au.location.sheetRange;Ot.sheetRangeIndexes=au.location.sheetRangeIndexes;Ot.sheetRows=au.location.sheetRows;Ot.structRefColumnLoc=au.location.structRefColumnLoc;Ot.unsafeGridRange=au.location.unsafeGridRange;Ot.userDefinedFuncLoc=au.location.userDefinedFuncLoc});var phe=Y(cq=>{"use strict";_();Object.defineProperty(cq,"__esModule",{value:!0});cq.Pledge=void 0;var Rsr=Cn();cq.Pledge=Rsr.pledge.Pledge});var VJ=Y(R2=>{"use strict";_();Object.defineProperty(R2,"__esModule",{value:!0});R2.checkFormula=R2.checkFormulaWithDiagnostics=void 0;var RR=br(),gP=um(),pq=C2(),rt=uq(),mhe=fhe(),mf=m1(),co=CC(),Bn=wp(),dq=g1(),gv=_R(),_2=lg(),Tsr=lq(),td=phe(),KJ={};function ec(e,r){return{context:e,result:r}}function bsr(e){return function(r){return r.kind===Bn.NodeKind.Literal&&e(r.oper)}}var Psr=co.OperKind.String|co.OperKind.Boolean|co.OperKind.Error,Esr=bsr(function(e){return(e.kind&Psr)!==0});function Nsr(e){return e>dq.ErrorType.GETTING_DATA&&e!==dq.ErrorType.BUSY&&e!==dq.ErrorType.EXTERNAL}function Rt(e,r,n,a){a===void 0&&(a=!1),a||(e.errorData=e.reportError(r,n,e.errorData))}function vhe(e,r){return r===co.OperKind.Range?(e&co.OperKind.Range)!==0:!0}function Asr(e,r){return td.Pledge.try(function(){var n;if(r.kind===Bn.NodeKind.BadSequence){switch(r.type){case Bn.BadType.Unexpected:Rt(e,r,rt.baseErrors.Bad_node,r.contents.some(function(a){return a.kind===Bn.NodeKind.BadChars||a.kind===Bn.NodeKind.BadSequence}));break;case Bn.BadType.StructRef:Rt(e,(n=r.contents[0])!==null&&n!==void 0?n:r,rt.baseErrors.Invalid_struct_ref_table_name);break;case Bn.BadType.FieldRef:Rt(e,r,rt.baseErrors.Unexpected_field_ref);return}return td.Pledge.all(r.contents.map(function(a){return _C(e,a)}))}switch(r.type){case Bn.BadType.Unexpected:switch(r.chars){case")":return Rt(e,r,rt.baseErrors.Unexpected_closing_paren);case e.localeInfo.rightBrace:return Rt(e,r,rt.baseErrors.Unexpected_closing_brace);case e.localeInfo.rightBracket:return Rt(e,r,rt.baseErrors.Unexpected_closing_bracket);case".":return Rt(e,r,rt.baseErrors.Unexpected_dot);default:return Rt(e,r,{kind:rt.SyntaxError.Unexpected_character,text:r.chars})}case Bn.BadType.NumberLiteral:return Rt(e,r,rt.baseErrors.Invalid_number_literal);case Bn.BadType.StringLiteral:return Rt(e,r,rt.baseErrors.Invalid_string_literal);case Bn.BadType.ErrorLiteral:return Rt(e,r,rt.baseErrors.Invalid_error_literal);case Bn.BadType.FieldName:case Bn.BadType.ParamName:return Rt(e,r,rt.baseErrors.Bad_node);case Bn.BadType.Qualifier:return Rt(e,r,rt.baseErrors.Invalid_qualifier);default:(0,gP.assertNever)("calc.analyze.diagnoseBadNode",r)}})}function Osr(e,r){if(r.kind===Bn.NodeKind.Literal)switch(Rt(e,r,rt.baseErrors.Unclosed_literal,r.isClosed),r.oper.kind){case co.OperKind.Number:case co.OperKind.Boolean:case co.OperKind.String:case co.OperKind.Error:return;case co.OperKind.Missing:break;default:return(0,gP.assertNever)("calc.analyze.checker.checkArrayElement: literal kind",r.oper)}Rt(e,r,rt.baseErrors.Illegal_array_literal_element)}function ksr(e,r){return td.Pledge.try(function(){Rt(e,r,rt.baseErrors.Unclosed_array,r.isClosed);var n=r.nodes.length>0&&!(r.nodes.length===1&&r.nodes[0].length===1&&(0,mf.isMissingNode)(r.nodes[0][0]));if(Rt(e,r,rt.baseErrors.Empty_array_literal,n),!n)return ec(e,co.OperKind.Array);for(var a=r.nodes[0].length,o=0;o<r.nodes.length;o+=1){var u=r.nodes[o],t=u.length;Rt(e,r,rt.baseErrors.Irregular_array_shape,t===a);for(var d=0;d<t;d+=1)Osr(e,u[d])}return ec(e,co.OperKind.Array)})}function mq(e,r,n,a,o){return td.Pledge.try(function(){if(e.earlyExit&&!e.isOk())throw KJ;return _C(e,r,o)}).bind(function(u){return vhe(u.result,n)||((0,gP.assertTrue)("calc.analyze.checker.check: typeSource passed",a!==void 0),Rt(e,r,{kind:rt.TypeError.Types_not_related,typeGiven:u.result,typeExpected:n,typeSource:a})),u.result=n,u})}function Fsr(e,r){return td.Pledge.try(function(){var n=r.head,a=r.args,o=n.id,u=(0,gv.getOperatorType)(o),t=a.length,d=t===u.minArgs;return Rt(e,n,{kind:rt.TypeError.Incorrect_number_of_operator_arguments,opId:o},d),td.Pledge.all(a.map(function(s,c){return td.Pledge.try(function(){return mq(e,s,(0,mf.getArgType)(u,c,t),{kind:rt.TypeSourceKind.OperatorArgument,opId:o,argIndex:c,numArgsGiven:t},{kind:rt.SyntaxError.Missing_operation_argument,opId:o})})})).bind(function(s){return d&&!a.some(mf.isMissingNode)?ec(e,u.returnType):ec(e,co.SignatureType.All)})})}function ghe(e,r,n){if(n.kind===Bn.NodeKind.Ident){var a=(0,mf.getBoundName)(e.localeInfo,n.whole);return Rt(e,n,rt.baseErrors.Invalid_binder,a.indexOf(".")<0),Rt(e,n,rt.baseErrors.Duplicate_binder,!r.contains(a)),r.setValue(a,!0)}return Rt(e,n,n.kind===Bn.NodeKind.Missing?rt.baseErrors.Missing_binder:rt.baseErrors.Invalid_binder),r}function Isr(e,r){var n=r.head.id,a=(0,mf.getArguments)(r.args).length;switch(n){case gv.WorksheetFuncId.IF:var o=e.locals.lexicalKind===Tsr.LexicalKind.NameManager?1:2;a<o&&Rt(e,fq(r),{kind:rt.TypeError.Insufficient_function_arguments,funcId:n,numArgsGiven:a,numArgsExpected:o});return;case gv.WorksheetFuncId._UDF:return Rt(e,r,rt.baseErrors.Unexpected_application_head);case gv.WorksheetFuncId.LET:case gv.WorksheetFuncId.LETREC:{(0,gP.assertTrue)("calc.analyze.applySpecificWorksheetFunctionChecks",r.kind===Bn.NodeKind.Let);for(var u=mhe.RedBlackMapTree.create(e.localeInfo.stringCompareCI),t=0,d=r.vars;t<d.length;t++){var s=d[t].name;u=ghe(e,u,s.arg.name)}for(var c=0,l=r.badArgs;c<l.length;c++){var f=l[c];Rt(e,f.arg,rt.baseErrors.Invalid_binder)}Rt(e,fq(r),{kind:rt.TypeError.Insufficient_function_arguments,funcId:n,numArgsGiven:a,numArgsExpected:(0,pq.fastMax)(3,a+1+a%2)},a>=3&&r.body!==void 0);break}case gv.WorksheetFuncId.LAMBDA:{(0,gP.assertTrue)("calc.analyze.applySpecificWorksheetFunctionChecks",r.kind===Bn.NodeKind.Lambda);for(var u=mhe.RedBlackMapTree.create(e.localeInfo.stringCompareCI),p=!1,m=0,v=r.params;m<v.length;m++){var h=v[m].name;Rt(e,h.arg.name,rt.baseErrors.Unclosed_bracket,h.arg.name.isClosed),h.arg.def!==void 0&&Rt(e,h.arg.name,rt.baseErrors.Binder_requires_brackets,h.arg.name.isBracketed),h.arg.isOptional?p=!0:Rt(e,h.arg,rt.baseErrors.Mandatory_binder_after_optional,!p),u=ghe(e,u,h.arg.name.name)}for(var S=0,y=r.badArgs;S<y.length;S++){var f=y[S];Rt(e,f.arg,rt.baseErrors.Invalid_binder)}var C=a>=1&&r.body!==void 0;C?r.body!==void 0&&(0,mf.isMissingLiteralNode)(r.body.arg)&&Rt(e,r.body.arg,rt.baseErrors.Invalid_body):Rt(e,fq(r),{kind:rt.TypeError.Insufficient_function_arguments,funcId:n,numArgsGiven:a,numArgsExpected:a+1});break}}}var fq=function(r){return r.args.length===0?r:r.args[r.args.length-1]};function Msr(e,r){return td.Pledge.try(function(){var n=r.head.id,a=(0,gv.getWorksheetFuncType)(n),o=a.minArgs,u=a.maxArgs,t=a.headTypes,d=a.restTypes,s=a.tailTypes,c=a.flags,l=r.args,f=l.length,p=(0,mf.getArguments)(r.args),m=p.length;if(Rt(e,r.head,rt.baseErrors.Invalid_function_name,(c&co.FunctionFlags.OnlyParsedDuringLoad)===0||e.locals.workbookLoad),m<o)switch(n){case gv.WorksheetFuncId.IF:case gv.WorksheetFuncId.LET:case gv.WorksheetFuncId.LETREC:case gv.WorksheetFuncId.LAMBDA:break;default:var v=l[f-1];Rt(e,v===void 0?r:v,{kind:rt.TypeError.Insufficient_function_arguments,funcId:n,numArgsGiven:m,numArgsExpected:o});break}if(m>u){var h=l[f-1];Rt(e,h===void 0?r:h,{kind:rt.TypeError.Excess_function_arguments,funcId:n,numArgsGiven:m,numArgsExpected:u})}else if(d.length>1&&m>t.length+d.length){var S=(m-t.length)%d.length;S>s.length&&Rt(e,fq(r),{kind:rt.TypeError.Insufficient_function_arguments,funcId:n,numArgsGiven:m,numArgsExpected:m+(d.length-S)})}var y;if(r.kind===Bn.NodeKind.App)y=(0,mf.getArguments)(r.args).map(function(F,w){return mq(e,F,(0,mf.getArgType)(a,w,m),{kind:rt.TypeSourceKind.WSFArgument,funcId:n,argIndex:w,numArgsGiven:m})});else if(r.kind===Bn.NodeKind.Let){var C=r.vars.map(function(F){var w=F.binder;return w.arg}),E=r.body?[r.body.arg]:[];y=RR.__spreadArray(RR.__spreadArray([],C,!0),E,!0).map(function(F){return _C(e,F)})}else{var I=r.params.map(function(w){var B,k=w.name;return(B=k.arg.def)===null||B===void 0?void 0:B.rhs}).filter(pq.isDefined),E=r.body?[r.body.arg]:[];y=RR.__spreadArray(RR.__spreadArray([],I.map(function(w){return _C(e,w,rt.baseErrors.Missing_default_expression)}),!0),E.map(function(w){return _C(e,w)}),!0)}return td.Pledge.all(y).bind(function(F){return Isr(e,r),ec(e,a.returnType)})})}function wsr(e,r){return td.Pledge.try(function(){var n=r.head,a=r.args,o=a.length,u=(0,mf.getArguments)(a),t=u.length,d=a[o-1],s=(0,gv.higherOrderFunctionType)().maxArgs-1;return t>s&&Rt(e,d===void 0?r:d,{kind:rt.SyntaxError.Excess_higher_order_function_arguments,numArgsGiven:t,numArgsExpected:s}),td.Pledge.all(a.map(function(c){return mq(e,c,co.SignatureType.All,void 0)})).bind(function(c){return _C(e,n).bind(function(l){return vhe(l.result,co.OperKind.Range)||l.result&(co.OperKind.Array|co.OperKind.Rich)||Rt(e,n,Esr(n)||n.kind===Bn.NodeKind.Array?rt.baseErrors.Unexpected_application_head:rt.baseErrors.Unexpected_application_head_with_fix),ec(e,co.SignatureType.All)})})})}function Dsr(e,r){return td.Pledge.try(function(){if(Rt(e,r,rt.baseErrors.Unclosed_application,r.isClosed),(0,mf.isWSFNode)(r.head)){var n=r;return Msr(e,n)}if((0,mf.isOperatorNode)(r.head)){var a=r;return Fsr(e,a)}var o=r;return wsr(e,o)})}function _C(e,r,n){return td.Pledge.try(function(){var a,o,u,t,d,s,c,l;if(e.earlyExit&&!e.isOk())throw KJ;switch(r.kind){case Bn.NodeKind.App:case Bn.NodeKind.Let:case Bn.NodeKind.Lambda:return Dsr(e,r);case Bn.NodeKind.Array:return ksr(e,r);case Bn.NodeKind.BadChars:case Bn.NodeKind.BadSequence:return Asr(e,r).bind(function(){return ec(e,co.SignatureType.All)});case Bn.NodeKind.Missing:return n!==!1&&Rt(e,r,n??rt.baseErrors.Bad_node),ec(e,co.SignatureType.All);case Bn.NodeKind.CellRef:return!e.locals.allowRelativeQualifier&&((a=r.qualifier)===null||a===void 0?void 0:a.kind)===Bn.QualifierKind.Relative?(Rt(e,r,rt.baseErrors.Invalid_rel_sheet_qualifier_in_cell),ec(e,co.SignatureType.All)):!e.locals.allowUnqualifiedCell&&r.qualifier===void 0?(Rt(e,r,rt.baseErrors.Invalid_unqualified_cell),ec(e,co.SignatureType.All)):((o=r.qualifier)===null||o===void 0?void 0:o.kind)===Bn.QualifierKind.Document||((u=r.qualifier)===null||u===void 0?void 0:u.kind)===Bn.QualifierKind.Bad?(Rt(e,r,rt.baseErrors.Invalid_qualifier),ec(e,co.SignatureType.All)):r.ref.kind===Bn.CellRefKind.Bad?(Rt(e,r,rt.baseErrors.Invalid_cell_ref),ec(e,co.SignatureType.All)):ec(e,co.OperKind.Range);case Bn.NodeKind.Literal:return Rt(e,r,rt.baseErrors.Unclosed_literal,r.isClosed),(0,mf.isErrorOper)(r.oper)&&Rt(e,r,rt.baseErrors.Invalid_error_literal,!Nsr(r.oper.type)),ec(e,r.oper.kind|((0,mf.isErrorOper)(r.oper)&&r.oper.type===dq.ErrorType.REF?co.OperKind.Range:0));case Bn.NodeKind.Name:{if(!e.locals.allowRelativeQualifier&&((t=r.qualifier)===null||t===void 0?void 0:t.kind)===Bn.QualifierKind.Relative)return Rt(e,r,rt.baseErrors.Invalid_rel_sheet_qualifier_in_name),ec(e,co.SignatureType.All);if(!e.locals.workbookLoad&&((d=r.qualifier)===null||d===void 0?void 0:d.kind)===Bn.QualifierKind.Document&&!r.qualifier.isQuoted||((s=r.qualifier)===null||s===void 0?void 0:s.kind)===Bn.QualifierKind.SheetRange||((c=r.qualifier)===null||c===void 0?void 0:c.kind)===Bn.QualifierKind.Bad)return Rt(e,r,rt.baseErrors.Invalid_qualifier),ec(e,co.SignatureType.All);var f=(0,Bn.flattenNameParts)(r.parts).parts,p=e.annotations[f[0].label],m=e.annotations[r.label];return(p==null?void 0:p.kind)===Bn.AnnotationKind.LocalNameUse?Rt(e,r,rt.baseErrors.Invalid_name,f.every(function(h){return h.kind!==Bn.NamePartKind.FieldRefNamePart||h.rhs.field.kind===Bn.NodeKind.Ident})):(m==null?void 0:m.kind)===Bn.AnnotationKind.LocalNameDecl||Rt(e,r,rt.baseErrors.Invalid_name,f.reduceRight(function(h,S){var y=h.anyCanDenoteNamedObject,C=h.rhsValid;return{anyCanDenoteNamedObject:y||S.canDenoteNamedObject&&C,rhsValid:C&&(S.kind!==Bn.NamePartKind.FieldRefNamePart||S.rhs.field.kind===Bn.NodeKind.Ident)}},{anyCanDenoteNamedObject:!1,rhsValid:!0}).anyCanDenoteNamedObject),ec(e,co.SignatureType.All)}case Bn.NodeKind.Paren:return Rt(e,r,rt.baseErrors.Unclosed_paren,r.isClosed),Rt(e,r,rt.baseErrors.Empty_parenthesis,!(0,mf.isMissingNode)(r.node)),_C(e,r.node,!1);case Bn.NodeKind.FieldRef:return Rt(e,r,rt.baseErrors.Unclosed_bracket,r.rhs.isClosed),Rt(e,r,rt.baseErrors.Unexpected_field_ref,!(0,mf.isMissingNode)(r.lhs)&&!(0,mf.isNumberLiteralNode)(r.lhs)),r.rhs.field.kind!==Bn.NodeKind.Ident&&Rt(e,r.rhs.field,r.rhs.field.kind===Bn.NodeKind.Missing?rt.baseErrors.Missing_field_name:rt.baseErrors.Invalid_field_name),_C(e,r.lhs,!1).bind(function(h){return ec(e,co.SignatureType.All)});case Bn.NodeKind.StructRef:if(Rt(e,r,rt.baseErrors.Invalid_struct_ref_table_name,r.lhs===void 0&&e.locals.allowImplicitTable||((l=r.lhs)===null||l===void 0?void 0:l.kind)===Bn.NodeKind.Name&&r.lhs.parts.kind===Bn.NamePartKind.IdentNamePart&&r.lhs.parts.canDenoteNamedObject),r.rhs.innerRef!==void 0){Rt(e,r.rhs.innerRef,rt.baseErrors.Invalid_struct_ref_comma_parts,r.rhs.innerRef.kind!==Bn.StructRefKind.CommaOpRef||(0,mf.isCommaOpRefWellFormed)(r.rhs.innerRef));var v=function h(S){switch(S==null?void 0:S.kind){case void 0:break;case Bn.StructRefKind.RangeOpRef:h(S.lhs),h(S.rhs);break;case Bn.StructRefKind.CommaOpRef:S.refs.forEach(h);break;case Bn.StructRefKind.SpecialRef:case Bn.StructRefKind.ColumnRef:Rt(e,S,rt.baseErrors.Unclosed_bracket,S.isClosed);break;case Bn.StructRefKind.ThisRowOpRef:h(S.ref);break;case Bn.StructRefKind.MissingRef:Rt(e,S,rt.baseErrors.Invalid_struct_ref_missing_part);break;case Bn.StructRefKind.BadRef:Rt(e,S,rt.baseErrors.Unclosed_bracket,S.isClosed),Rt(e,S,rt.baseErrors.Invalid_struct_ref_bad_part);break}};v(r.rhs.innerRef)}return Rt(e,r,rt.baseErrors.Unclosed_bracket,r.rhs.isClosed),(r.lhs===void 0?td.Pledge.resolve(void 0):_C(e,r.lhs)).bind(function(h){return ec(e,co.SignatureType.All)});default:return(0,gP.assertNever)("calc.analyze.checker.infer: unhandled formula case",r)}})}function xsr(e,r){var n=r.annotations[r.node.label];if((n==null?void 0:n.kind)!==Bn.AnnotationKind.FormulaRoot||n.syntaxFeatures===void 0||!n.syntaxFeatures[Bn.SyntaxFeature.Comments])return;function a(t){for(var d=0,s=t;d<s.length;d++){var c=s[d];Rt(e,c,rt.baseErrors.Unclosed_comment,c.isClosed)}}function o(t){var d=r.spans[t];d!=null&&(d.preComments&&a(d.preComments),d.postComments&&a(d.postComments))}function u(t){return td.Pledge.try(function(){switch(o(t.label),t.kind){case Bn.NodeKind.Literal:case Bn.NodeKind.Missing:case Bn.NodeKind.BadChars:break;case Bn.NodeKind.App:case Bn.NodeKind.Let:case Bn.NodeKind.Lambda:return t.head.kind===Bn.NodeKind.Operator&&o(t.head.label),td.Pledge.all(t.args.map(u));case Bn.NodeKind.Array:return td.Pledge.all((0,pq.safeConcat)([],t.nodes.map(function(d){return d.map(u)})));case Bn.NodeKind.BadSequence:return td.Pledge.all(t.contents.map(u));case Bn.NodeKind.CellRef:case Bn.NodeKind.Name:t.qualifier&&o(t.qualifier.label);break;case Bn.NodeKind.Paren:return u(t.node);case Bn.NodeKind.FieldRef:return o(t.rhs.label),o(t.rhs.field.label),u(t.lhs);case Bn.NodeKind.StructRef:return t.lhs?u(t.lhs):void 0;case Bn.NodeKind.Var:o(t.name.label);break;case Bn.NodeKind.Param:if(o(t.name.label),o(t.name.name.label),t.def)return o(t.def.label),u(t.def.rhs);break;default:return(0,gP.assertNever)("calc.analyze.checker.comments",t)}})}td.Pledge.settleOrThrow(u(r.node))}var Lsr={ok:!0,isOk:pq.identity,collect:function(r,n,a){return!1}};function Bsr(){return{ok:void 0,isOk:function(r){return r===void 0},collect:function(r,n,a){var o,u=a??[];return((o=u[r.label])!==null&&o!==void 0?o:u[r.label]=[]).push(n),u}}}function hhe(e,r,n,a,o){var u,t,d=n.annotations;o===void 0&&(o=!0);var s={globals:e,locals:r,localeInfo:(t=(u=r.config)===null||u===void 0?void 0:u.localeInfo)!==null&&t!==void 0?t:e.config.localeInfo,annotations:d,reportError:a.collect,isOk:function(){return a.isOk(s.errorData)},earlyExit:o,errorData:a.ok};return s}function She(e,r){try{var n=td.Pledge.settleOrThrow(mq(e,r.node,co.SignatureType.All,void 0,rt.baseErrors.Empty_formula));return xsr(e,r),n}catch(a){if(a===KJ)return ec(e,co.SignatureType.All);throw a}}function qsr(e,r,n){try{var a=Bsr(),o=hhe(e,r,n,a,!1),u=She(o,n),t=u.context.errorData;return(0,_2.success)([RR.__assign(RR.__assign({},n),{isWellFormed:t===void 0}),t])}catch(d){return(0,_2.failure)((0,_2.javaScriptError)(d))}}R2.checkFormulaWithDiagnostics=qsr;function Usr(e,r,n){try{var a=hhe(e,r,n,Lsr),o=She(a,n),u=o.context.errorData;return(0,_2.success)(RR.__assign(RR.__assign({},n),{isWellFormed:u}))}catch(t){return(0,_2.failure)((0,_2.javaScriptError)(t))}}R2.checkFormula=Usr});var gq=Y(Yt=>{"use strict";_();Object.defineProperty(Yt,"__esModule",{value:!0});Yt.zipVisitor=Yt.voidVisitor=Yt.visitWSFNode=Yt.visitQualifier=Yt.visitOperatorNode=Yt.visitFormulaNode=Yt.visitCellRef=Yt.visitAppHeadNode=Yt.reduceTopDown_Pledge=Yt.reducePledge=Yt.reduceBottomUp_Recursive=Yt.reduceBottomUp_Pledge=Yt.reduceBottomUp_MaxDepth=Yt.reduceBottomUp_CPS=Yt.reduceBottomUp=Yt.identityVisitor=Yt.depthVisitor=Yt.constVisitor=Yt.composeVisitor=Yt.bindVisitor=Yt.binaryVisitor=Yt.ZipVisitor=Yt.PledgeReducer=Yt.IdentityVisitor=Yt.DelegatingVisitor=Yt.ConstVisitor=Yt.ComposeVisitor=Yt.BinaryVisitor=void 0;var Ju=et();Yt.BinaryVisitor=Ju.visitor.BinaryVisitor;Yt.ComposeVisitor=Ju.visitor.ComposeVisitor;Yt.ConstVisitor=Ju.visitor.ConstVisitor;Yt.DelegatingVisitor=Ju.visitor.DelegatingVisitor;Yt.IdentityVisitor=Ju.visitor.IdentityVisitor;Yt.PledgeReducer=Ju.visitor.PledgeReducer;Yt.ZipVisitor=Ju.visitor.ZipVisitor;Yt.binaryVisitor=Ju.visitor.binaryVisitor;Yt.bindVisitor=Ju.visitor.bindVisitor;Yt.composeVisitor=Ju.visitor.composeVisitor;Yt.constVisitor=Ju.visitor.constVisitor;Yt.depthVisitor=Ju.visitor.depthVisitor;Yt.identityVisitor=Ju.visitor.identityVisitor;Yt.reduceBottomUp=Ju.visitor.reduceBottomUp;Yt.reduceBottomUp_CPS=Ju.visitor.reduceBottomUp_CPS;Yt.reduceBottomUp_MaxDepth=Ju.visitor.reduceBottomUp_MaxDepth;Yt.reduceBottomUp_Pledge=Ju.visitor.reduceBottomUp_Pledge;Yt.reduceBottomUp_Recursive=Ju.visitor.reduceBottomUp_Recursive;Yt.reducePledge=Ju.visitor.reducePledge;Yt.reduceTopDown_Pledge=Ju.visitor.reduceTopDown_Pledge;Yt.visitAppHeadNode=Ju.visitor.visitAppHeadNode;Yt.visitCellRef=Ju.visitor.visitCellRef;Yt.visitFormulaNode=Ju.visitor.visitFormulaNode;Yt.visitOperatorNode=Ju.visitor.visitOperatorNode;Yt.visitQualifier=Ju.visitor.visitQualifier;Yt.visitWSFNode=Ju.visitor.visitWSFNode;Yt.voidVisitor=Ju.visitor.voidVisitor;Yt.zipVisitor=Ju.visitor.zipVisitor});var WJ=Y(no=>{"use strict";_();Object.defineProperty(no,"__esModule",{value:!0});no.resolvedUserDefinedFunc=no.resolvedStructRef=no.resolvedNever=no.resolvedName=no.resolvedLocalName=no.resolvedDottedName=no.resolvedCellRef=no.resolveLocalsGrid=no.noOriginSheet=no.invalidStructRef=no.invalidQualifier=no.invalidCellRef=no.emptyIntersection=no.ResolvedKind=no.ResolveReasonKind=no.InvalidStructRefReason=no.InvalidQualifierReason=no.InvalidCellRefReason=void 0;var gf=et();no.InvalidCellRefReason=gf.resolveServiceTypes.InvalidCellRefReason;no.InvalidQualifierReason=gf.resolveServiceTypes.InvalidQualifierReason;no.InvalidStructRefReason=gf.resolveServiceTypes.InvalidStructRefReason;no.ResolveReasonKind=gf.resolveServiceTypes.ResolveReasonKind;no.ResolvedKind=gf.resolveServiceTypes.ResolvedKind;no.emptyIntersection=gf.resolveServiceTypes.emptyIntersection;no.invalidCellRef=gf.resolveServiceTypes.invalidCellRef;no.invalidQualifier=gf.resolveServiceTypes.invalidQualifier;no.invalidStructRef=gf.resolveServiceTypes.invalidStructRef;no.noOriginSheet=gf.resolveServiceTypes.noOriginSheet;no.resolveLocalsGrid=gf.resolveServiceTypes.resolveLocalsGrid;no.resolvedCellRef=gf.resolveServiceTypes.resolvedCellRef;no.resolvedDottedName=gf.resolveServiceTypes.resolvedDottedName;no.resolvedLocalName=gf.resolveServiceTypes.resolvedLocalName;no.resolvedName=gf.resolveServiceTypes.resolvedName;no.resolvedNever=gf.resolveServiceTypes.resolvedNever;no.resolvedStructRef=gf.resolveServiceTypes.resolvedStructRef;no.resolvedUserDefinedFunc=gf.resolveServiceTypes.resolvedUserDefinedFunc});var jJ=Y(T2=>{"use strict";_();Object.defineProperty(T2,"__esModule",{value:!0});T2.resolveGridRef=T2.createResolver=void 0;var yhe=et();T2.createResolver=yhe.resolveService.createResolver;T2.resolveGridRef=yhe.resolveService.resolveGridRef});var zJ=Y(hq=>{"use strict";_();Object.defineProperty(hq,"__esModule",{value:!0});hq.autocorrectFormula=void 0;var QJ=br(),ad=wp(),o3=m1(),v1=um(),vP=lg(),u3=gq(),HJ=WJ(),Gsr=jJ(),RC={getDocumentLoc:function(){return(0,v1.assertFalse)("calc.analyze.autocorrectFormula: default getDocumentLoc")},getSheetIndex:function(){return(0,v1.assertFalse)("calc.analyze.autocorrectFormula: default getSheetIndex")},getSheetName:function(){return(0,v1.assertFalse)("calc.analyze.autocorrectFormula: default getSheetName")},getNameLoc:function(){return(0,v1.assertFalse)("calc.analyze.autocorrectFormula: default getNameLoc")},getUserDefinedFuncLoc:function(){return(0,v1.assertFalse)("calc.analyze.autocorrectFormula: default getUserDefinedFuncLoc")},getSheetRangeIndexes:function(){return(0,v1.assertFalse)("calc.analyze.autocorrectFormula: default getSheetRangeIndexes")},getContainingTable:function(){return(0,v1.assertFalse)("calc.analyze.autocorrectFormula: default getContainingTable")},getStructRefColumn:function(){return(0,v1.assertFalse)("calc.analyze.autocorrectFormula: default getStructRefColumn")},getStructRefSpecialRef:function(){return(0,v1.assertFalse)("calc.analyze.autocorrectFormula: default getStructRefSpecialRef")}};function Ksr(e){var r,n,a,o,u,t,d,s,c,l,f,p,m,v,h,S,y,C;return{config:e.config,getDocumentLoc:(n=(r=e.getDocumentLoc)===null||r===void 0?void 0:r.bind(e))!==null&&n!==void 0?n:RC.getDocumentLoc,getSheetIndex:(o=(a=e.getSheetIndex)===null||a===void 0?void 0:a.bind(e))!==null&&o!==void 0?o:RC.getSheetIndex,getSheetName:(t=(u=e.getSheetName)===null||u===void 0?void 0:u.bind(e))!==null&&t!==void 0?t:RC.getSheetName,getNameLoc:(s=(d=e.getNameLoc)===null||d===void 0?void 0:d.bind(e))!==null&&s!==void 0?s:RC.getNameLoc,getUserDefinedFuncLoc:(l=(c=e.getUserDefinedFuncLoc)===null||c===void 0?void 0:c.bind(e))!==null&&l!==void 0?l:RC.getUserDefinedFuncLoc,getSheetRangeIndexes:(p=(f=e.getSheetRangeIndexes)===null||f===void 0?void 0:f.bind(e))!==null&&p!==void 0?p:RC.getSheetRangeIndexes,getContainingTable:(v=(m=e.getContainingTable)===null||m===void 0?void 0:m.bind(e))!==null&&v!==void 0?v:RC.getContainingTable,getStructRefColumn:(S=(h=e.getStructRefColumn)===null||h===void 0?void 0:h.bind(e))!==null&&S!==void 0?S:RC.getStructRefColumn,getStructRefSpecialRef:(C=(y=e.getStructRefSpecialRef)===null||y===void 0?void 0:y.bind(e))!==null&&C!==void 0?C:RC.getStructRefSpecialRef}}var vq=(0,o3.createFailureErrorClass)("AutocorrectError"),Vsr=QJ.__assign(QJ.__assign({},(0,u3.binaryVisitor)((0,u3.constVisitor)(!1),function(e,r){return e||r})),{badSequenceNode:function(r,n,a){return!0},badCharsNode:function(r,n,a){return!0}}),Wsr=function(e){QJ.__extends(r,e);function r(n,a,o){var u=e.call(this)||this;return u.f=o,u.seenUnclosed=!1,u.seenParen=!1,u.seenMissingOperand=!1,u.globals=Ksr(n),u.locals=a,u.resolver=(0,Gsr.createResolver)(u.globals),u}return r.prototype.autocorrect=function(){return(0,u3.reduceBottomUp)(Vsr,this.f)?this.f.node:(0,u3.reduceBottomUp)(this,this.f)},r.prototype.literalNode=function(n,a,o){return a||(this.seenUnclosed=!0),(0,ad.literalNode)(n,a,o)},r.prototype.nameNode=function(n,a,o){var u=(0,ad.nameNode)(n,a,o),t=(0,ad.flattenNameParts)(n);if(t.kind===ad.NamePartKind.CellRefNamePart){var d=this.resolver.resolveDottedName(this.locals,u,this.f.annotations).resolved;if(d.kind===HJ.ResolvedKind.ResolvedCellRef){var s=d.node,c=s.ref,l=s.qualifier,f=s.label,p=this.cellRefNode(c,l,f).ref;(0,v1.assertTrue)("calc.analyze.autocorrectFormula",t.kind===ad.NamePartKind.CellRefNamePart);var m=t.parts,v=m[0],h=m[1],S=m.slice(2),y=function(E,I){var F=I.rhs,w=I.canDenoteNamedObject,B=I.label,k=I.qualifiedLabel;return(0,ad.fieldRefNamePart)(E,F,w,B,k)};return(0,ad.nameNode)(S.reduce(y,y((0,ad.cellRefNamePart)(p,v.asWhole,v.label,v.qualifiedLabel),h)),a,f)}if(d.resolution.kind!==vP.ResultKind.Success&&d.resolution.reason.kind!==HJ.ResolveReasonKind.NoOriginSheet&&d.resolution.reason.kind!==HJ.ResolveReasonKind.InvalidQualifier)throw new vq(d.resolution.reason)}return u},r.prototype.arrayNode=function(n,a,o){return a||(this.seenUnclosed=!0),(0,ad.arrayNode)(n,a,o)},r.prototype.appNode=function(n,a,o,u){var t=this.appNodeBase(n,o,u);return o||(this.seenUnclosed=!0),(0,o3.isOperatorNode)(n)||(this.seenParen=!0),(0,o3.isOperatorNode)(n)&&a.some(o3.isMissingNode)&&(this.seenMissingOperand=!0),(0,ad.appNode)(n,a,t,u)},r.prototype.letNode=function(n,a,o,u,t,d){var s=this.appNodeBase(n,t,d);return t||(this.seenUnclosed=!0),this.seenParen=!0,(0,ad.letNode)(n,a,o,u,s,d)},r.prototype.lambdaNode=function(n,a,o,u,t,d){var s=this.appNodeBase(n,t,d);return t||(this.seenUnclosed=!0),this.seenParen=!0,(0,ad.lambdaNode)(n,a,o,u,s,d)},r.prototype.parenNode=function(n,a,o){return a||(this.seenUnclosed=!0),this.seenParen=!0,(0,ad.parenNode)(n,a,o)},r.prototype.cellRefNode=function(n,a,o){var u=this.globals.config.localeInfo;return n.isBracketed&&u.rcLeftBracket==="("&&(this.seenParen=!0),this.locals.allowUnqualifiedCell||a!==void 0?(0,ad.cellRefNode)(n,a,o):(0,ad.cellRefNode)(n,this.qualifyCellRef(),o)},r.prototype.fieldRefNode=function(n,a,o,u){return a.isClosed||(this.seenUnclosed=!0),(0,ad.fieldRefNode)(n,a,o,u)},r.prototype.structRefNode=function(n,a,o){return a.isClosed||(this.seenUnclosed=!0),(0,ad.structRefNode)(n,a,o)},r.prototype.qualifyCellRef=function(){var n=this.locals.originSheet;if(!(0,vP.isSuccess)(n))throw new vq(n.reason);if(n.value.index!==void 0){var a=this.globals.getSheetName(n.value.document,n.value.index);if(!(0,vP.isSuccess)(a))throw new vq(a.reason);var o=void 0;return(0,ad.sheetQualifier)(a.value,o)}},r.prototype.appNodeBase=function(n,a,o){return a||!(0,o3.isOperatorNode)(n)&&this.isFormulaRoot(o)&&!this.seenParen&&!this.seenUnclosed&&!this.seenMissingOperand},r.prototype.isFormulaRoot=function(n){var a;return((a=this.f.annotations[n])===null||a===void 0?void 0:a.kind)===ad.AnnotationKind.FormulaRoot},r}(u3.IdentityVisitor);function jsr(e,r,n){try{var a=n.spans,o=n.annotations,u=n.depthUpperBound,t=new Wsr(e,r,n).autocorrect();return(0,vP.success)((0,ad.formula)(t,a,o,u))}catch(d){return d instanceof vq?(0,vP.failure)(d.reason):(0,vP.failure)((0,vP.javaScriptError)(d))}}hq.autocorrectFormula=jsr});var YJ=Y(sm=>{"use strict";_();Object.defineProperty(sm,"__esModule",{value:!0});sm.analyzeLocalsName=sm.analyzeLocalsGrid=sm.createAnalyzeGlobals=sm.staticPrecedents=sm.summarizeFormulaDiagnostics=sm.diagnostics=void 0;var Hsr=lq(),Che=uq();sm.diagnostics=Che;var Sq=lg();function Qsr(e){if(e!==void 0){var r={};return Object.keys(e).forEach(function(n){e[Number(n)].forEach(function(a){var o,u=Che.formatDiagnostic(a);r[u]=((o=r[u])!==null&&o!==void 0?o:0)+1})}),r}}sm.summarizeFormulaDiagnostics=Qsr;function zsr(e,r,n,a,o,u,t){return{cells:e,names:r,udfs:n,special:a,ownSpecial:o,bound:u,resolutions:t}}sm.staticPrecedents=zsr;function Ysr(e,r){return{config:e,getSheetName:r}}sm.createAnalyzeGlobals=Ysr;function Jsr(e,r,n,a){return a===void 0&&(a=!1),{config:n??void 0,lexicalKind:e,originGridCell:(0,Sq.success)(r.range),originSheet:(0,Sq.success)(r.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!0,wrapCellReferences:!1,workbookLoad:a}}sm.analyzeLocalsGrid=Jsr;function Xsr(e,r,n){return n===void 0&&(n=!1),{config:r??void 0,lexicalKind:Hsr.LexicalKind.NameManager,originGridCell:(0,Sq.success)(e.range),originSheet:(0,Sq.success)(e.sheet),allowRelativeQualifier:!0,allowUnqualifiedCell:!1,allowImplicitTable:!1,wrapCellReferences:!0,workbookLoad:n}}sm.analyzeLocalsName=Xsr});var The=Y(Cq=>{"use strict";_();Object.defineProperty(Cq,"__esModule",{value:!0});Cq.resolveStaticPrecedents=void 0;var Zsr=br(),TC=um(),yq=C2(),PC=lg(),b2=wp(),s3=lq(),$sr=jJ(),h1=WJ(),l3=_R(),P2=CC(),_he=m1(),elr=g1(),Rhe=gq(),rlr=YJ(),bC={getDocumentLoc:function(){return(0,TC.assertFalse)("calc.analyze.resolveStaticPrecedents: default getDocumentLoc")},getSheetIndex:function(){return(0,TC.assertFalse)("calc.analyze.resolveStaticPrecedents: default getSheetIndex")},getSheetName:function(){return(0,TC.assertFalse)("calc.analyze.resolveStaticPrecedents: default getSheetName")},getNameLoc:function(){return(0,TC.assertFalse)("calc.analyze.resolveStaticPrecedents: default getNameLoc")},getUserDefinedFuncLoc:function(){return(0,TC.assertFalse)("calc.analyze.resolveStaticPrecedents: default getUserDefinedFuncLoc")},getSheetRangeIndexes:function(){return(0,TC.assertFalse)("calc.analyze.resolveStaticPrecedents: default getSheetRangeIndexes")},getContainingTable:function(){return(0,TC.assertFalse)("calc.analyze.resolveStaticPrecedents: default getContainingTable")},getStructRefColumn:function(){return(0,TC.assertFalse)("calc.analyze.resolveStaticPrecedents: default getStructRefColumn")},getStructRefSpecialRef:function(){return(0,TC.assertFalse)("calc.analyze.resolveStaticPrecedents: default getStructRefSpecialRef")}};function nlr(e){var r,n,a,o,u,t,d,s,c,l,f,p,m,v,h,S,y,C;return{config:e.config,getDocumentLoc:(n=(r=e.getDocumentLoc)===null||r===void 0?void 0:r.bind(e))!==null&&n!==void 0?n:bC.getDocumentLoc,getSheetIndex:(o=(a=e.getSheetIndex)===null||a===void 0?void 0:a.bind(e))!==null&&o!==void 0?o:bC.getSheetIndex,getSheetName:(t=(u=e.getSheetName)===null||u===void 0?void 0:u.bind(e))!==null&&t!==void 0?t:bC.getSheetName,getNameLoc:(s=(d=e.getNameLoc)===null||d===void 0?void 0:d.bind(e))!==null&&s!==void 0?s:bC.getNameLoc,getUserDefinedFuncLoc:(l=(c=e.getUserDefinedFuncLoc)===null||c===void 0?void 0:c.bind(e))!==null&&l!==void 0?l:bC.getUserDefinedFuncLoc,getSheetRangeIndexes:(p=(f=e.getSheetRangeIndexes)===null||f===void 0?void 0:f.bind(e))!==null&&p!==void 0?p:bC.getSheetRangeIndexes,getContainingTable:(v=(m=e.getContainingTable)===null||m===void 0?void 0:m.bind(e))!==null&&v!==void 0?v:bC.getContainingTable,getStructRefColumn:(S=(h=e.getStructRefColumn)===null||h===void 0?void 0:h.bind(e))!==null&&S!==void 0?S:bC.getStructRefColumn,getStructRefSpecialRef:(C=(y=e.getStructRefSpecialRef)===null||y===void 0?void 0:y.bind(e))!==null&&C!==void 0?C:bC.getStructRefSpecialRef}}var JJ=(0,_he.createFailureErrorClass)("ResolveStaticPrecedentsError"),tlr=function(e){Zsr.__extends(r,e);function r(n,a,o){var u=e.call(this)||this;return u.locals=a,u.annotations=o,u.cells=[],u.names=[],u.udfs=[],u.nameSpecial=P2.SpecialPrecs.None,u.ownSpecial=P2.SpecialPrecs.None,u.resolutions=[],u.globals=nlr(n),u.resolver=(0,$sr.createResolver)(u.globals),u}return r.prototype.appNode=function(n,a,o,u){var t=this;if(n.kind===b2.NodeKind.WSF){var d=n.id,s=(0,l3.getWorksheetFuncType)(d).staticPrecs;switch(d){case l3.WorksheetFuncId.LOOKUP:case l3.WorksheetFuncId.SUMIF:case l3.WorksheetFuncId.AVERAGEIF:var c=function(p){var m=p.label,v=t.resolutions[m],h=(v==null?void 0:v.kind)===h1.ResolvedKind.ResolvedCellRef||(v==null?void 0:v.kind)===h1.ResolvedKind.ResolvedStructRef?v.resolution:void 0;return(h==null?void 0:h.kind)===PC.ResultKind.Success?h.value:void 0},l=function(p,m){var v=c(p),h=c(m);return v!==void 0&&h!==void 0&&(0,s3.isSheetGridRange)(v)&&(0,s3.isSheetGridRange)(h)&&(0,_he.isDocumentLocEqual)(v.sheet.document,h.sheet.document)&&v.range.rows===h.range.rows&&v.range.cols===h.range.cols};(a.length<3||a[2].kind===b2.NodeKind.Literal||a[2].kind===b2.NodeKind.Array||l(a[2],d===l3.WorksheetFuncId.LOOKUP?a[1]:a[0]))&&(s&=~P2.SpecialPrecs.AllCells);break}s!==P2.SpecialPrecs.None&&(this.ownSpecial|=s)}return e.prototype.appNode.call(this,n,a,o,u)},r.prototype.nameNode=function(n,a,o){var u=this.resolver.resolveDottedName(this.locals,(0,b2.nameNode)(n,a,o),this.annotations);this.resolutions[o]=u,(0,yq.safePush)(this.names,u.precedents.names),(0,yq.safePush)(this.udfs,u.precedents.udfs);var t=u.resolved;switch(t.kind){case h1.ResolvedKind.ResolvedName:if(!(0,PC.isSuccess)(t.resolution)){this.handleResolutionError(t.resolution.reason);break}t.resolution.value!==void 0&&(this.nameSpecial|=P2.SpecialPrecs.All);break;case h1.ResolvedKind.ResolvedUserDefinedFunc:if(!(0,PC.isSuccess)(t.resolution)){this.handleResolutionError(t.resolution.reason);break}break;case h1.ResolvedKind.ResolvedCellRef:this.pushResolvedGridRef(t.resolution);break}return e.prototype.nameNode.call(this,n,a,o)},r.prototype.cellRefNode=function(n,a,o){var u=this.resolver.resolveCellRef(this.locals,(0,b2.cellRefNode)(n,a,o));this.resolutions[o]=u;var t=u.resolution;return this.pushResolvedGridRef(t),e.prototype.cellRefNode.call(this,n,a,o)},r.prototype.structRefNode=function(n,a,o){var u=this.resolver.resolveStructRef(this.locals,(0,b2.structRefNode)(n,a,o));this.resolutions[o]=u,(0,yq.safePush)(this.names,u.precedents);var t=u.resolution;return this.pushResolvedGridRef(t),e.prototype.structRefNode.call(this,n,a,o)},r.prototype.pushResolvedGridRef=function(n){if(n.kind!==PC.ResultKind.Success)return this.handleResolutionError(n.reason);if(n.value!==void 0){var a=n.value;if((0,s3.isSheetGridRange)(a))this.cells.push(a);else{this.ownSpecial|=P2.SpecialPrecs.OwnDocSheets;var o=this.globals.getSheetRangeIndexes(a.sheet);if(!(0,PC.isSuccess)(o))throw new JJ(o.reason);(0,yq.safePush)(this.cells,o.value.sheets.map(function(u){return(0,s3.sheetGridRange)((0,s3.sheetIndex)(a.sheet.document,u),a.range)}))}}},r.prototype.handleResolutionError=function(n){switch(n.kind){case h1.ResolveReasonKind.NoOriginSheet:case h1.ResolveReasonKind.InvalidStructRef:case h1.ResolveReasonKind.InvalidCellRef:case h1.ResolveReasonKind.InvalidQualifier:case h1.ResolveReasonKind.EmptyIntersection:return}throw new JJ(n)},r}(Rhe.IdentityVisitor);function alr(e,r,n){try{var a=new tlr(e,r,n.annotations);return(0,Rhe.reduceBottomUp)(a,n),(0,PC.success)((0,rlr.staticPrecedents)(a.cells,a.names,a.udfs,a.nameSpecial|a.ownSpecial,a.ownSpecial,elr.PrecsBound.Upper,a.resolutions))}catch(o){return o instanceof JJ?(0,PC.failure)(o.reason):(0,PC.failure)((0,PC.javaScriptError)(o))}}Cq.resolveStaticPrecedents=alr});var Phe=Y(_q=>{"use strict";_();Object.defineProperty(_q,"__esModule",{value:!0});_q.createAnalyzer=void 0;var bhe=VJ(),ilr=zJ(),olr=The();function ulr(e){return{checkFormula:function(n,a){return(0,bhe.checkFormula)(e,n,a)},checkFormulaWithDiagnostics:function(n,a){return(0,bhe.checkFormulaWithDiagnostics)(e,n,a)},autocorrectFormula:function(n,a){return(0,ilr.autocorrectFormula)(e,n,a)},resolveStaticPrecedents:function(n,a){return(0,olr.resolveStaticPrecedents)(e,n,a)}}}_q.createAnalyzer=ulr});var ZJ=Y(Zh=>{"use strict";_();Object.defineProperty(Zh,"__esModule",{value:!0});Zh.notFormulaString=Zh.ReasonKind=Zh.parseLocals=Zh.createParseGlobals=void 0;var Ehe=br(),slr=m1(),llr=lg();function clr(e){return{config:e}}Zh.createParseGlobals=clr;function dlr(e,r,n,a,o){return{config:n??void 0,lexicalKind:e,originGridCell:(0,llr.success)(r),contextNames:a,syntaxFeatures:o}}Zh.parseLocals=dlr;var XJ;(function(e){e.NotFormulaString="NotFormulaString"})(XJ||(XJ={}));Zh.ReasonKind=Ehe.__assign(Ehe.__assign({},slr.ReasonKind),XJ);function flr(e){return{kind:Zh.ReasonKind.NotFormulaString,message:e}}Zh.notFormulaString=flr});var hP=Y(Ru=>{"use strict";_();Object.defineProperty(Ru,"__esModule",{value:!0});Ru.surrogatePairToCodePoint=Ru.stringFromCodePoint=Ru.stringCodePointAt=Ru.scanCodePointsBack=Ru.scanCodePoints=Ru.numCodeUnits=Ru.makeGetCharCodeBits=Ru.isLowSurrogate=Ru.isHighSurrogate=Ru.isAnySurrogate=Ru.forEachClassInterval=Ru.countCodePoints=Ru.codePointIterator=Ru.CharCodeBits=void 0;var lm=Cn();Ru.CharCodeBits=lm.unicode.CharCodeBits;Ru.codePointIterator=lm.unicode.codePointIterator;Ru.countCodePoints=lm.unicode.countCodePoints;Ru.forEachClassInterval=lm.unicode.forEachClassInterval;Ru.isAnySurrogate=lm.unicode.isAnySurrogate;Ru.isHighSurrogate=lm.unicode.isHighSurrogate;Ru.isLowSurrogate=lm.unicode.isLowSurrogate;Ru.makeGetCharCodeBits=lm.unicode.makeGetCharCodeBits;Ru.numCodeUnits=lm.unicode.numCodeUnits;Ru.scanCodePoints=lm.unicode.scanCodePoints;Ru.scanCodePointsBack=lm.unicode.scanCodePointsBack;Ru.stringCodePointAt=lm.unicode.stringCodePointAt;Ru.stringFromCodePoint=lm.unicode.stringFromCodePoint;Ru.surrogatePairToCodePoint=lm.unicode.surrogatePairToCodePoint});var E2=Y(Ge=>{"use strict";_();Object.defineProperty(Ge,"__esModule",{value:!0});Ge.codePointExclamationMark=Ge.codePointEuroSign=Ge.codePointEqualsSign=Ge.codePointDoubleQuote=Ge.codePointDollarSign=Ge.codePointDigitZero=Ge.codePointDigitTwo=Ge.codePointDigitThree=Ge.codePointDigitSix=Ge.codePointDigitSeven=Ge.codePointDigitOne=Ge.codePointDigitNine=Ge.codePointDigitFour=Ge.codePointDigitFive=Ge.codePointDigitEight=Ge.codePointComma=Ge.codePointColon=Ge.codePointCircumflexAccent=Ge.codePointCapitalZ=Ge.codePointCapitalY=Ge.codePointCapitalX=Ge.codePointCapitalW=Ge.codePointCapitalV=Ge.codePointCapitalU=Ge.codePointCapitalT=Ge.codePointCapitalS=Ge.codePointCapitalR=Ge.codePointCapitalQ=Ge.codePointCapitalP=Ge.codePointCapitalO=Ge.codePointCapitalN=Ge.codePointCapitalM=Ge.codePointCapitalL=Ge.codePointCapitalK=Ge.codePointCapitalJ=Ge.codePointCapitalI=Ge.codePointCapitalH=Ge.codePointCapitalG=Ge.codePointCapitalF=Ge.codePointCapitalE=Ge.codePointCapitalD=Ge.codePointCapitalC=Ge.codePointCapitalB=Ge.codePointCapitalA=Ge.codePointCR=Ge.codePointBacktick=Ge.codePointBackslash=Ge.codePointAtSign=Ge.codePointAsterisk=Ge.codePointAmpersand=void 0;Ge.codePointSmallW=Ge.codePointSmallV=Ge.codePointSmallU=Ge.codePointSmallT=Ge.codePointSmallS=Ge.codePointSmallR=Ge.codePointSmallQ=Ge.codePointSmallP=Ge.codePointSmallO=Ge.codePointSmallN=Ge.codePointSmallM=Ge.codePointSmallL=Ge.codePointSmallK=Ge.codePointSmallJ=Ge.codePointSmallI=Ge.codePointSmallH=Ge.codePointSmallG=Ge.codePointSmallF=Ge.codePointSmallE=Ge.codePointSmallD=Ge.codePointSmallC=Ge.codePointSmallB=Ge.codePointSmallA=Ge.codePointSlash=Ge.codePointSingleQuote=Ge.codePointSemicolon=Ge.codePointRightSquareBracket=Ge.codePointRightParen=Ge.codePointRightCurlyBracket=Ge.codePointQuestionMark=Ge.codePointPlusSign=Ge.codePointPipe=Ge.codePointPercentSign=Ge.codePointMinusSign=Ge.codePointLessThanSign=Ge.codePointLeftSquareBracket=Ge.codePointLeftParen=Ge.codePointLeftCurlyBracket=Ge.codePointLF=Ge.codePointInvertedQuestionMark=Ge.codePointInvertedExclamationMark=Ge.codePointHash=Ge.codePointGreaterThanSign=Ge.codePointFullwidthLatinSmallZ=Ge.codePointFullwidthLatinSmallA=Ge.codePointFullwidthLatinCapitalZ=Ge.codePointFullwidthLatinCapitalA=Ge.codePointFullwidthDigitZero=Ge.codePointFullwidthDigitNine=Ge.codePointFullStop=void 0;Ge.codePointRightSingleQuotationMark=Ge.codePointLeftSingleQuotationMark=Ge.codePointUnderscore=Ge.codePointTilde=Ge.codePointThaiDigitZero=Ge.codePointThaiDigitNine=Ge.codePointTab=Ge.codePointSpace=Ge.codePointSmallZ=Ge.codePointSmallY=Ge.codePointSmallX=void 0;var Yr=Cn();Ge.codePointAmpersand=Yr.codePoint.codePointAmpersand;Ge.codePointAsterisk=Yr.codePoint.codePointAsterisk;Ge.codePointAtSign=Yr.codePoint.codePointAtSign;Ge.codePointBackslash=Yr.codePoint.codePointBackslash;Ge.codePointBacktick=Yr.codePoint.codePointBacktick;Ge.codePointCR=Yr.codePoint.codePointCR;Ge.codePointCapitalA=Yr.codePoint.codePointCapitalA;Ge.codePointCapitalB=Yr.codePoint.codePointCapitalB;Ge.codePointCapitalC=Yr.codePoint.codePointCapitalC;Ge.codePointCapitalD=Yr.codePoint.codePointCapitalD;Ge.codePointCapitalE=Yr.codePoint.codePointCapitalE;Ge.codePointCapitalF=Yr.codePoint.codePointCapitalF;Ge.codePointCapitalG=Yr.codePoint.codePointCapitalG;Ge.codePointCapitalH=Yr.codePoint.codePointCapitalH;Ge.codePointCapitalI=Yr.codePoint.codePointCapitalI;Ge.codePointCapitalJ=Yr.codePoint.codePointCapitalJ;Ge.codePointCapitalK=Yr.codePoint.codePointCapitalK;Ge.codePointCapitalL=Yr.codePoint.codePointCapitalL;Ge.codePointCapitalM=Yr.codePoint.codePointCapitalM;Ge.codePointCapitalN=Yr.codePoint.codePointCapitalN;Ge.codePointCapitalO=Yr.codePoint.codePointCapitalO;Ge.codePointCapitalP=Yr.codePoint.codePointCapitalP;Ge.codePointCapitalQ=Yr.codePoint.codePointCapitalQ;Ge.codePointCapitalR=Yr.codePoint.codePointCapitalR;Ge.codePointCapitalS=Yr.codePoint.codePointCapitalS;Ge.codePointCapitalT=Yr.codePoint.codePointCapitalT;Ge.codePointCapitalU=Yr.codePoint.codePointCapitalU;Ge.codePointCapitalV=Yr.codePoint.codePointCapitalV;Ge.codePointCapitalW=Yr.codePoint.codePointCapitalW;Ge.codePointCapitalX=Yr.codePoint.codePointCapitalX;Ge.codePointCapitalY=Yr.codePoint.codePointCapitalY;Ge.codePointCapitalZ=Yr.codePoint.codePointCapitalZ;Ge.codePointCircumflexAccent=Yr.codePoint.codePointCircumflexAccent;Ge.codePointColon=Yr.codePoint.codePointColon;Ge.codePointComma=Yr.codePoint.codePointComma;Ge.codePointDigitEight=Yr.codePoint.codePointDigitEight;Ge.codePointDigitFive=Yr.codePoint.codePointDigitFive;Ge.codePointDigitFour=Yr.codePoint.codePointDigitFour;Ge.codePointDigitNine=Yr.codePoint.codePointDigitNine;Ge.codePointDigitOne=Yr.codePoint.codePointDigitOne;Ge.codePointDigitSeven=Yr.codePoint.codePointDigitSeven;Ge.codePointDigitSix=Yr.codePoint.codePointDigitSix;Ge.codePointDigitThree=Yr.codePoint.codePointDigitThree;Ge.codePointDigitTwo=Yr.codePoint.codePointDigitTwo;Ge.codePointDigitZero=Yr.codePoint.codePointDigitZero;Ge.codePointDollarSign=Yr.codePoint.codePointDollarSign;Ge.codePointDoubleQuote=Yr.codePoint.codePointDoubleQuote;Ge.codePointEqualsSign=Yr.codePoint.codePointEqualsSign;Ge.codePointEuroSign=Yr.codePoint.codePointEuroSign;Ge.codePointExclamationMark=Yr.codePoint.codePointExclamationMark;Ge.codePointFullStop=Yr.codePoint.codePointFullStop;Ge.codePointFullwidthDigitNine=Yr.codePoint.codePointFullwidthDigitNine;Ge.codePointFullwidthDigitZero=Yr.codePoint.codePointFullwidthDigitZero;Ge.codePointFullwidthLatinCapitalA=Yr.codePoint.codePointFullwidthLatinCapitalA;Ge.codePointFullwidthLatinCapitalZ=Yr.codePoint.codePointFullwidthLatinCapitalZ;Ge.codePointFullwidthLatinSmallA=Yr.codePoint.codePointFullwidthLatinSmallA;Ge.codePointFullwidthLatinSmallZ=Yr.codePoint.codePointFullwidthLatinSmallZ;Ge.codePointGreaterThanSign=Yr.codePoint.codePointGreaterThanSign;Ge.codePointHash=Yr.codePoint.codePointHash;Ge.codePointInvertedExclamationMark=Yr.codePoint.codePointInvertedExclamationMark;Ge.codePointInvertedQuestionMark=Yr.codePoint.codePointInvertedQuestionMark;Ge.codePointLF=Yr.codePoint.codePointLF;Ge.codePointLeftCurlyBracket=Yr.codePoint.codePointLeftCurlyBracket;Ge.codePointLeftParen=Yr.codePoint.codePointLeftParen;Ge.codePointLeftSquareBracket=Yr.codePoint.codePointLeftSquareBracket;Ge.codePointLessThanSign=Yr.codePoint.codePointLessThanSign;Ge.codePointMinusSign=Yr.codePoint.codePointMinusSign;Ge.codePointPercentSign=Yr.codePoint.codePointPercentSign;Ge.codePointPipe=Yr.codePoint.codePointPipe;Ge.codePointPlusSign=Yr.codePoint.codePointPlusSign;Ge.codePointQuestionMark=Yr.codePoint.codePointQuestionMark;Ge.codePointRightCurlyBracket=Yr.codePoint.codePointRightCurlyBracket;Ge.codePointRightParen=Yr.codePoint.codePointRightParen;Ge.codePointRightSquareBracket=Yr.codePoint.codePointRightSquareBracket;Ge.codePointSemicolon=Yr.codePoint.codePointSemicolon;Ge.codePointSingleQuote=Yr.codePoint.codePointSingleQuote;Ge.codePointSlash=Yr.codePoint.codePointSlash;Ge.codePointSmallA=Yr.codePoint.codePointSmallA;Ge.codePointSmallB=Yr.codePoint.codePointSmallB;Ge.codePointSmallC=Yr.codePoint.codePointSmallC;Ge.codePointSmallD=Yr.codePoint.codePointSmallD;Ge.codePointSmallE=Yr.codePoint.codePointSmallE;Ge.codePointSmallF=Yr.codePoint.codePointSmallF;Ge.codePointSmallG=Yr.codePoint.codePointSmallG;Ge.codePointSmallH=Yr.codePoint.codePointSmallH;Ge.codePointSmallI=Yr.codePoint.codePointSmallI;Ge.codePointSmallJ=Yr.codePoint.codePointSmallJ;Ge.codePointSmallK=Yr.codePoint.codePointSmallK;Ge.codePointSmallL=Yr.codePoint.codePointSmallL;Ge.codePointSmallM=Yr.codePoint.codePointSmallM;Ge.codePointSmallN=Yr.codePoint.codePointSmallN;Ge.codePointSmallO=Yr.codePoint.codePointSmallO;Ge.codePointSmallP=Yr.codePoint.codePointSmallP;Ge.codePointSmallQ=Yr.codePoint.codePointSmallQ;Ge.codePointSmallR=Yr.codePoint.codePointSmallR;Ge.codePointSmallS=Yr.codePoint.codePointSmallS;Ge.codePointSmallT=Yr.codePoint.codePointSmallT;Ge.codePointSmallU=Yr.codePoint.codePointSmallU;Ge.codePointSmallV=Yr.codePoint.codePointSmallV;Ge.codePointSmallW=Yr.codePoint.codePointSmallW;Ge.codePointSmallX=Yr.codePoint.codePointSmallX;Ge.codePointSmallY=Yr.codePoint.codePointSmallY;Ge.codePointSmallZ=Yr.codePoint.codePointSmallZ;Ge.codePointSpace=Yr.codePoint.codePointSpace;Ge.codePointTab=Yr.codePoint.codePointTab;Ge.codePointThaiDigitNine=Yr.codePoint.codePointThaiDigitNine;Ge.codePointThaiDigitZero=Yr.codePoint.codePointThaiDigitZero;Ge.codePointTilde=Yr.codePoint.codePointTilde;Ge.codePointUnderscore=Yr.codePoint.codePointUnderscore;Ge.codePointLeftSingleQuotationMark=Yr.codePoint.codePointLeftSingleQuotationMark;Ge.codePointRightSingleQuotationMark=Yr.codePoint.codePointRightSingleQuotationMark});var c3=Y(cm=>{"use strict";_();Object.defineProperty(cm,"__esModule",{value:!0});cm.wrapPosition=cm.parseGridRangeA1=cm.parseGridCellA1=cm.parseCellRef=cm.isR1C1IdentStart=cm.SpecialPos=void 0;var N2=et();cm.SpecialPos=N2.cellParse.SpecialPos;cm.isR1C1IdentStart=N2.cellParse.isR1C1IdentStart;cm.parseCellRef=N2.cellParse.parseCellRef;cm.parseGridCellA1=N2.cellParse.parseGridCellA1;cm.parseGridRangeA1=N2.cellParse.parseGridRangeA1;cm.wrapPosition=N2.cellParse.wrapPosition});var vv=Y(zr=>{"use strict";_();Object.defineProperty(zr,"__esModule",{value:!0});zr.rangeOperatorToken=zr.geOperatorToken=zr.leOperatorToken=zr.neOperatorToken=zr.gtOperatorToken=zr.ltOperatorToken=zr.eqOperatorToken=zr.concatOperatorToken=zr.percentOperatorToken=zr.powOperatorToken=zr.divOperatorToken=zr.mulOperatorToken=zr.subOperatorToken=zr.addOperatorToken=zr.operatorToken=zr.identOrBooleanToken=zr.literalToken=zr.cellRefR1C1Token=zr.cellRefA1Token=zr.specialRefToken=zr.assignSepToken=zr.dotSepToken=zr.qualSepToken=zr.rowSepToken=zr.colSepToken=zr.listSepToken=zr.rightSQuoteToken=zr.rightBraceToken=zr.rightBracketToken=zr.rightParenToken=zr.leftSQuoteToken=zr.leftBraceToken=zr.leftBracketToken=zr.leftParenToken=zr.identToken=zr.multiLineCommentToken=zr.singleLineCommentToken=zr.escapeToken=zr.unexpectedToken=zr.spacesToken=zr.endToken=zr.badErrorOper=zr.isBadErrorOper=zr.badNumberOper=zr.isNumberLikeOper=zr.isBadNumberOper=zr.TokenOperKind=zr.SepId=zr.DelimId=zr.TokenKind=void 0;zr.appendToken=zr.poundOperatorToken=zr.atOperatorToken=void 0;var ap=_R(),A2=wp(),Nhe=g1(),Ohe=CC(),plr=hP(),d3=E2(),Ahe=c3(),mlr=d3.codePointAsterisk,glr=d3.codePointMinusSign,vlr=d3.codePointPlusSign,hlr=d3.codePointSlash,Slr=d3.codePointSpace,Ps;(function(e){e[e.End=1]="End",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Sep=4]="Sep",e[e.Operator=5]="Operator",e[e.Spaces=6]="Spaces",e[e.Ident=7]="Ident",e[e.CellRef=8]="CellRef",e[e.Literal=9]="Literal",e[e.SpecialRef=10]="SpecialRef",e[e.Unexpected=11]="Unexpected",e[e.Escape=12]="Escape",e[e.SingleLineComment=13]="SingleLineComment",e[e.MultiLineComment=14]="MultiLineComment"})(Ps=zr.TokenKind||(zr.TokenKind={}));var EC;(function(e){e[e.Paren=1]="Paren",e[e.Bracket=2]="Bracket",e[e.Brace=3]="Brace",e[e.SQuote=4]="SQuote"})(EC=zr.DelimId||(zr.DelimId={}));var SP;(function(e){e[e.List=1]="List",e[e.Row=2]="Row",e[e.Col=3]="Col",e[e.Qual=4]="Qual",e[e.Dot=5]="Dot",e[e.Assign=6]="Assign"})(SP=zr.SepId||(zr.SepId={}));var O2;(function(e){e.BadNumber="BadNumber",e.BadError="BadError"})(O2=zr.TokenOperKind||(zr.TokenOperKind={}));function ylr(e){return e.kind===O2.BadNumber}zr.isBadNumberOper=ylr;function khe(e){return e.kind===O2.BadNumber||e.kind===Ohe.OperKind.Number}zr.isNumberLikeOper=khe;zr.badNumberOper={kind:O2.BadNumber};function Clr(e){return e.kind===O2.BadError}zr.isBadErrorOper=Clr;zr.badErrorOper={kind:O2.BadError};function k2(e,r,n,a){return{kind:e,start:r,chars:n,isIdentContinue:a}}var _lr=function(r){return k2(Ps.End,r,"",!1)};zr.endToken=_lr;var Rlr=function(r,n){return k2(Ps.Spaces,r,n,!1)};zr.spacesToken=Rlr;var Tlr=function(r,n){return k2(Ps.Unexpected,r,n,!1)};zr.unexpectedToken=Tlr;var blr=function(r,n){return k2(Ps.Escape,r,n,!1)};zr.escapeToken=blr;var Plr=function(r,n){return k2(Ps.SingleLineComment,r,n,!1)};zr.singleLineCommentToken=Plr;var Elr=function(r,n,a){return{kind:Ps.MultiLineComment,start:r,chars:n,isIdentContinue:!1,isClosed:a}};zr.multiLineCommentToken=Elr;var Nlr=function(r,n){return k2(Ps.Ident,r,n,!0)};zr.identToken=Nlr;function P0(e,r,n,a){return{kind:e,start:r,chars:n,isIdentContinue:!1,value:a}}var Alr=function(r){return P0(Ps.Left,r,"(",EC.Paren)};zr.leftParenToken=Alr;var Olr=function(r,n){return P0(Ps.Left,r,n,EC.Bracket)};zr.leftBracketToken=Olr;var klr=function(r,n){return P0(Ps.Left,r,n,EC.Brace)};zr.leftBraceToken=klr;var Flr=function(r){return P0(Ps.Left,r,"'",EC.SQuote)};zr.leftSQuoteToken=Flr;var Ilr=function(r){return P0(Ps.Right,r,")",EC.Paren)};zr.rightParenToken=Ilr;var Mlr=function(r,n){return P0(Ps.Right,r,n,EC.Bracket)};zr.rightBracketToken=Mlr;var wlr=function(r,n){return P0(Ps.Right,r,n,EC.Brace)};zr.rightBraceToken=wlr;var Dlr=function(r){return P0(Ps.Right,r,"'",EC.SQuote)};zr.rightSQuoteToken=Dlr;var xlr=function(r,n){return P0(Ps.Sep,r,n,SP.List)};zr.listSepToken=xlr;var Llr=function(r,n){return P0(Ps.Sep,r,n,SP.Col)};zr.colSepToken=Llr;var Blr=function(r,n){return P0(Ps.Sep,r,n,SP.Row)};zr.rowSepToken=Blr;var qlr=function(r){return P0(Ps.Sep,r,"!",SP.Qual)};zr.qualSepToken=qlr;var Ulr=function(r){return P0(Ps.Sep,r,".",SP.Dot)};zr.dotSepToken=Ulr;var Glr=function(r){return P0(Ps.Sep,r,":=",SP.Assign)};zr.assignSepToken=Glr;var Klr=function(r,n,a){return P0(Ps.SpecialRef,r,n,a)};zr.specialRefToken=Klr;function Fhe(e,r,n,a,o,u,t){return{kind:Ps.CellRef,start:e,chars:r,isIdentContinue:n,row:a,col:o,refStyle:u,isBadLocale:t}}function Vlr(e,r,n,a){var o=(n==null||typeof n=="object"&&n.kind===A2.PosKind.Rel)&&(a==null||typeof a=="object"&&a.kind===A2.PosKind.Rel),u=!1;return Fhe(e,r,o,n,a,A2.RefStyle.A1,u)}zr.cellRefA1Token=Vlr;function Wlr(e,r,n,a,o){o===void 0&&(o=!1);var u=(n===Ahe.SpecialPos.RCNoNum||n==null||n.kind===A2.PosKind.Abs)&&(a===Ahe.SpecialPos.RCNoNum||a==null||a.kind===A2.PosKind.Abs);return Fhe(e,r,u,n,a,A2.RefStyle.R1C1,o)}zr.cellRefR1C1Token=Wlr;function jlr(e){for(var r=0,n=(0,plr.codePointIterator)(e);r<n.length;r++){var a=n[r];if(a===vlr||a===glr||a===mlr||a===Slr||a===hlr)return!1}return!0}function $J(e,r,n,a){a===void 0&&(a=!0);var o=n.kind===Ohe.OperKind.Boolean||khe(n)&&jlr(r);return{kind:Ps.Literal,start:e,chars:r,isIdentContinue:o,oper:n,hasRight:a}}zr.literalToken=$J;function Hlr(e,r,n){return e.stringCompareCI(e.falseName,n)===0?$J(r,n,Nhe.falseOper):e.stringCompareCI(e.trueName,n)===0?$J(r,n,Nhe.trueOper):(0,zr.identToken)(r,n)}zr.identOrBooleanToken=Hlr;function Ihe(e,r,n){return{kind:Ps.Operator,start:e,chars:r,isIdentContinue:!1,value:n}}zr.operatorToken=Ihe;function xp(e){var r=ap.operatorStrings[e];if(r==null)throw new Error("operatorTokenMaker: invalid operator ".concat(e));return function(n){return Ihe(n,r,e)}}zr.addOperatorToken=xp(ap.OperatorId.Add);zr.subOperatorToken=xp(ap.OperatorId.Sub);zr.mulOperatorToken=xp(ap.OperatorId.Mul);zr.divOperatorToken=xp(ap.OperatorId.Div);zr.powOperatorToken=xp(ap.OperatorId.Pow);zr.percentOperatorToken=xp(ap.OperatorId.Percent);zr.concatOperatorToken=xp(ap.OperatorId.Concat);zr.eqOperatorToken=xp(ap.OperatorId.Eq);zr.ltOperatorToken=xp(ap.OperatorId.Lt);zr.gtOperatorToken=xp(ap.OperatorId.Gt);zr.neOperatorToken=xp(ap.OperatorId.Ne);zr.leOperatorToken=xp(ap.OperatorId.Le);zr.geOperatorToken=xp(ap.OperatorId.Ge);zr.rangeOperatorToken=xp(ap.OperatorId.Range);zr.atOperatorToken=xp(ap.OperatorId.At);zr.poundOperatorToken=xp(ap.OperatorId.Pound);function Qlr(e,r,n){return n.push(r),r.start+e}zr.appendToken=Qlr});var S1=Y(sa=>{"use strict";_();Object.defineProperty(sa,"__esModule",{value:!0});sa.concat=sa.flatten=sa.middle=sa.right=sa.left=sa.tuple=sa.many1=sa.many=sa.reduce=sa.applyTake=sa.takePeek=sa.peek=sa.take=sa.fails=sa.succeeds=sa.opt=sa.any=sa.withState=sa.apply=sa.bind=sa.parseFail=sa.parseSucceed=sa.warnSucceedOrFail=sa.setDebugging=sa.lazy=sa.runParser=void 0;var whe=um(),Dhe=SR(),Mhe=lg(),zlr=C2();function Ylr(e){for(var r=e;r!=null;)r=r();return r}function Jlr(e,r,n,a){var o;function u(c,l){o=(0,Mhe.success)({output:c,index:l})}function t(){o=(0,Mhe.failure)(void 0)}if(Ylr(e(r,n,a,u,t)),o==null){var d=(0,Dhe.anonymize)(r),s="calc.parse.runParser: internal error: parser did not call resolve or reject on ".concat(d);return(0,whe.assertFalse)(s)}return o}sa.runParser=Jlr;function Xlr(e){var r;return function(a,o,u,t,d){var s=r??(r=e());return function(){return s(a,o,u,t,d)}}}sa.lazy=Xlr;var eX=!1;function Zlr(e){eX=e}sa.setDebugging=Zlr;function $lr(e,r){return function(a,o,u,t,d){return e(a,o,u,function(s,c){return eX&&console.warn("".concat(r," succeeded, returning index ").concat(c," (of ").concat(a.length,") with"),s),t(s,c)},function(){return eX&&console.warn("".concat(r," failed at index ").concat(o," (of ").concat(a.length,")")),d})}}sa.warnSucceedOrFail=$lr;function xhe(e){return function(n,a,o,u,t){return u(e,a)}}sa.parseSucceed=xhe;var ecr=function(r,n,a,o,u){return u};function Lhe(){return ecr}sa.parseFail=Lhe;function Bhe(e,r){return function(a,o,u,t,d){return e(a,o,u,function(s,c){return r(u,s)(a,c,u,t,d)},d)}}sa.bind=Bhe;function F2(e,r){return function(a,o,u,t,d){return e(a,o,u,function(s,c){return t(r(u,s),c)},d)}}sa.apply=F2;function rcr(e){return function(r,n,a,o,u){return e(a)(r,n,a,o,u)}}sa.withState=rcr;function ncr(e,r){return function(a,o,u,t,d){return e(a,o,u,t,function(){return r(a,o,u,t,d)})}}function tcr(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return e.length===0?Lhe():e.reduce(ncr)}sa.any=tcr;function acr(e,r){return function(a,o,u,t,d){return e(a,o,u,t,function(){return t(r,o)})}}sa.opt=acr;function icr(e){return function(n,a,o,u,t){return e(n,a,o,function(){return u(!0,a)},t)}}sa.succeeds=icr;function ocr(e){return function(n,a,o,u,t){return e(n,a,o,t,function(){return u(!0,a)})}}sa.fails=ocr;function qhe(e,r){return function(a,o,u,t,d){var s=a[o];if(s==null)return d;var c=e(u,s);return c==null?d:t(c,o+r)}}function ucr(e){return qhe(e,1)}sa.take=ucr;function scr(e){return qhe(e,0)}sa.peek=scr;function lcr(e){return function(n,a,o,u,t){var d=n[a],s=n[a+1];if(d==null||s==null)return t;var c=e(o,d,s);return c==null?t:u(c,a+1)}}sa.takePeek=lcr;function ccr(e,r){return function(a,o,u,t,d){return e(a,o,u,function(s,c){var l=r(u,s);return l==null?d:t(l,c)},d)}}sa.applyTake=ccr;function Uhe(e,r,n){return function(o,u,t,d,s){var c=n,l=u;function f(){return e(o,l,t,p,m)}function p(v,h){if(h<=l){var S=(0,Dhe.anonymize)(o),y="calc.parse.reduce: internal error: no progress made at index ".concat(l," on ").concat(S);return(0,whe.assertFalse)(y)}return c=r(t,v,c),l=h,f}function m(){return d(c,l)}return f}}sa.reduce=Uhe;function rX(e,r){function n(a,o,u){return u.push(o),u}return Uhe(e,n,r)}function dcr(e,r){return r===void 0?function(a,o,u,t,d){return rX(e,[])(a,o,u,t,d)}:function(a,o,u,t,d){return e(a,o,u,function(s,c){return rX(r,[s])(a,c,u,t,d)},function(){return t([],o)})}}sa.many=dcr;function fcr(e,r){return r===void 0&&(r=e),Bhe(e,function(n,a){return rX(r,[a])})}sa.many1=fcr;function f3(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];if(e.length===0)return xhe([]);if(e.length===1)return F2(e[0],function(a,o){return[o]});var n=e.length;return function(o,u,t,d,s){var c=u,l=[];function f(){return e[l.length](o,c,t,p,s)}function p(m,v){return c=v,l.push(m),l.length<n?f:d(l,c)}return f}}sa.tuple=f3;function pcr(e,r){return F2(f3(e,r),function(n,a){var o=a[0];return o})}sa.left=pcr;function mcr(e,r){return F2(f3(e,r),function(n,a){var o=a[1];return o})}sa.right=mcr;function gcr(e,r,n){return F2(f3(e,r,n),function(a,o){var u=o[1];return u})}sa.middle=gcr;function Ghe(e){return F2(e,function(r,n){return(0,zlr.safeConcat)([],n)})}sa.flatten=Ghe;function vcr(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return Ghe(f3.apply(void 0,e))}sa.concat=vcr});var $h=Y(Hn=>{"use strict";_();Object.defineProperty(Hn,"__esModule",{value:!0});Hn.parseBracketedTokens=Hn.parseIdentContinue=Hn.parseEnd=Hn.parseEscape=Hn.parseAtOp=Hn.parseRangeOp=Hn.parseDotSepTokenNotFollowedByLeftBracket=Hn.parseRightBracket=Hn.parseLeftBracket=Hn.parseRightSQuote=Hn.parseLeftSQuote=Hn.parseRightBrace=Hn.parseLeftBrace=Hn.parseRightParen=Hn.parseLeftParen=Hn.parseAssignToken=Hn.parseDotSepToken=Hn.parseQualSep=Hn.parseColSep=Hn.parseRowSep=Hn.parseListSep=Hn.parseCharIndex=Hn.parseSpacesOnly=Hn.parseWhitespace=Hn.isWhitespaceToken=Hn.isCommentToken=Hn.isBracketToken=Hn.isRightBracketToken=Hn.isLeftBracketToken=Hn.isRefErrorToken=Hn.isAtOpToken=Hn.isRangeOpToken=Hn.isListSepToken=Hn.isDotSepToken=void 0;var hcr=SR(),Scr=um(),ycr=g1(),Khe=_R(),ki=vv(),Xu=S1(),Ccr=CC();function Vhe(e){return e.kind===ki.TokenKind.Sep&&e.value===ki.SepId.Dot}Hn.isDotSepToken=Vhe;function _cr(e){return e.kind===ki.TokenKind.Sep&&e.value===ki.SepId.List}Hn.isListSepToken=_cr;function Whe(e){return e.kind===ki.TokenKind.Operator&&e.value===Khe.OperatorId.Range}Hn.isRangeOpToken=Whe;function jhe(e){return e.kind===ki.TokenKind.Operator&&e.value===Khe.OperatorId.At}Hn.isAtOpToken=jhe;function Rcr(e){return e.kind===ki.TokenKind.Literal&&e.oper.kind===Ccr.OperKind.Error&&e.oper.type===ycr.ErrorType.REF}Hn.isRefErrorToken=Rcr;function Hhe(e){return e.kind===ki.TokenKind.Left&&e.value===ki.DelimId.Bracket}Hn.isLeftBracketToken=Hhe;function Tcr(e){return e.kind===ki.TokenKind.Right&&e.value===ki.DelimId.Bracket}Hn.isRightBracketToken=Tcr;function Qhe(e){return(e.kind===ki.TokenKind.Left||e.kind===ki.TokenKind.Right)&&e.value===ki.DelimId.Bracket}Hn.isBracketToken=Qhe;function bcr(e){return e.kind===ki.TokenKind.SingleLineComment||e.kind===ki.TokenKind.MultiLineComment}Hn.isCommentToken=bcr;function zhe(e){return e.kind===ki.TokenKind.Spaces||e.kind===ki.TokenKind.SingleLineComment||e.kind===ki.TokenKind.MultiLineComment}Hn.isWhitespaceToken=zhe;Hn.parseWhitespace=(0,Xu.many)((0,Xu.take)(function(e,r){return zhe(r)?r:void 0}));Hn.parseSpacesOnly=(0,Xu.opt)((0,Xu.take)(function(e,r){return r.kind===ki.TokenKind.Spaces?r.chars:void 0}),"");var Pcr=function(r,n,a,o,u){var t=r[n];if(t==null){var d="calc.parse.pStart: internal error: expected token at ".concat(n," in ").concat((0,hcr.anonymize)(r));return(0,Scr.assertFalse)(d)}return o(t.start,n)};Hn.parseCharIndex=Pcr;function I2(e){return(0,Xu.take)(function(r,n){return n.kind===ki.TokenKind.Sep&&n.value===e?n:void 0})}function Rq(e){return(0,Xu.take)(function(r,n){return n.kind===ki.TokenKind.Left&&n.value===e?n:void 0})}function Tq(e){return(0,Xu.take)(function(r,n){return n.kind===ki.TokenKind.Right&&n.value===e?n:void 0})}Hn.parseListSep=I2(ki.SepId.List);Hn.parseRowSep=I2(ki.SepId.Row);Hn.parseColSep=I2(ki.SepId.Col);Hn.parseQualSep=I2(ki.SepId.Qual);Hn.parseDotSepToken=I2(ki.SepId.Dot);Hn.parseAssignToken=I2(ki.SepId.Assign);Hn.parseLeftParen=Rq(ki.DelimId.Paren);Hn.parseRightParen=Tq(ki.DelimId.Paren);Hn.parseLeftBrace=Rq(ki.DelimId.Brace);Hn.parseRightBrace=Tq(ki.DelimId.Brace);Hn.parseLeftSQuote=Rq(ki.DelimId.SQuote);Hn.parseRightSQuote=Tq(ki.DelimId.SQuote);Hn.parseLeftBracket=Rq(ki.DelimId.Bracket);Hn.parseRightBracket=Tq(ki.DelimId.Bracket);Hn.parseDotSepTokenNotFollowedByLeftBracket=(0,Xu.takePeek)(function(e,r,n){return Vhe(r)&&!Hhe(n)?r:void 0});Hn.parseRangeOp=(0,Xu.take)(function(e,r){return Whe(r)?r:void 0});Hn.parseAtOp=(0,Xu.take)(function(e,r){return jhe(r)?r:void 0});Hn.parseEscape=(0,Xu.take)(function(e,r){return r.kind===ki.TokenKind.Escape?r:void 0});Hn.parseEnd=(0,Xu.take)(function(e,r){return r.kind===ki.TokenKind.End?r:void 0});Hn.parseIdentContinue=(0,Xu.apply)((0,Xu.many1)((0,Xu.take)(function(e,r){return r.isIdentContinue?r:void 0})),function(e,r){var n=r[0];return r.length===1?n:(0,ki.identToken)(n.start,r.map(function(a){return a.chars}).join(""))});var Ecr=(0,Xu.take)(function(e,r){return!Qhe(r)&&r.kind!==ki.TokenKind.End?r:void 0}),Yhe=(0,Xu.lazy)(function(){return(0,Xu.flatten)((0,Xu.many)((0,Xu.any)((0,Xu.many1)(Ecr),(0,Xu.concat)((0,Xu.tuple)(Hn.parseLeftBracket),Yhe,(0,Xu.opt)((0,Xu.tuple)(Hn.parseRightBracket),[])))))});Hn.parseBracketedTokens=(0,Xu.apply)((0,Xu.tuple)(Hn.parseLeftBracket,Yhe,Hn.parseCharIndex,(0,Xu.opt)(Hn.parseRightBracket,void 0)),function(e,r){var n=r[0],a=r[1],o=r[2],u=r[3];return a.push((0,ki.endToken)(o)),[a,u!==void 0]})});var NC=Y(Fd=>{"use strict";_();Object.defineProperty(Fd,"__esModule",{value:!0});Fd.cellRefMustBeCellRefNode=Fd.withDelim=Fd.addSpan=Fd.addWhitespace=Fd.getSpan=Fd.getNodeSpan=Fd.makeState=Fd.ListSep=void 0;var Jhe=br(),Ncr=SR(),Xhe=um(),bq=vv(),nX=wp(),Acr=$h(),Zhe;(function(e){e[e.Union=1]="Union",e[e.Arg=2]="Arg"})(Zhe=Fd.ListSep||(Fd.ListSep={}));function Ocr(e,r,n,a,o){var u;return{localeInfo:e,mathpack:r,refStyle:n,lexicalKind:a,origin:o,delim:{delimId:void 0,listSep:Zhe.Union,stack:(u={},u[bq.DelimId.Paren]=!1,u[bq.DelimId.Brace]=!1,u[bq.DelimId.Bracket]=!1,u)},cellRefMustBeCellRefNode:!1,label:1,spans:[]}}Fd.makeState=Ocr;function kcr(e,r){var n=e.spans[r.label];if(n==null){var a="calc.parse.getNodeSpan: internal error: expected node to have a span; given ".concat((0,Ncr.anonymize)(r));(0,Xhe.assertFalse)(a)}return n}Fd.getNodeSpan=kcr;function Fcr(e,r){var n=e.spans[r];return(0,Xhe.assertTrue)("calc.parse.getSpan: internal error: expected label to have a span",n!=null),n}Fd.getSpan=Fcr;function Icr(e,r){var n=$he(e,r.start,r.start+r.chars.length,"","");return r.kind===bq.TokenKind.SingleLineComment?(0,nX.singleLineComment)(r.chars,n):(0,nX.multiLineComment)(r.chars,r.isClosed,n)}var Mcr=[];function tX(e,r){var n=typeof r=="string"?Mcr:r.filter(Acr.isCommentToken);return[typeof r=="string"?r:r.map(function(a){return a.chars}).join(""),n.length>0?n.map(function(a){return Icr(e,a)}):void 0]}Fd.addWhitespace=tX;function $he(e,r,n,a,o){var u=e.label;e.label+=1;var t=tX(e,a),d=t[0],s=t[1],c=tX(e,o),l=c[0],f=c[1];return e.spans[u]=(0,nX.formulaSpan)(r,n,d,l,s,f),u}Fd.addSpan=$he;function eSe(e,r,n){return function(a,o,u,t,d){var s=e(u);return n(a,o,u,function(c,l){return r(u,s),t(c,l)},function(){return r(u,s),d})}}function wcr(e,r){var n=e.delimId,a=e.listSep;return eSe(function(o){var u,t=o.delim;return o.delim={delimId:n,listSep:a,stack:Jhe.__assign(Jhe.__assign({},t.stack),(u={},u[n]=!0,u))},t},function(o,u){return o.delim=u},r)}Fd.withDelim=wcr;function Dcr(e){return eSe(function(r){var n=r.cellRefMustBeCellRefNode;return r.cellRefMustBeCellRefNode=!0,n},function(r,n){return r.cellRefMustBeCellRefNode=n},e)}Fd.cellRefMustBeCellRefNode=Dcr});var Pq=Y(vf=>{"use strict";_();Object.defineProperty(vf,"__esModule",{value:!0});vf.setFeatureGateDictionaryGetter=vf.overrideTypedFeatureGates=vf.isTypedChangeGateEnabled=vf.getTypedFeatureGate=vf.getFeatures=vf.isFeatureEnabled=vf.initFeatureConfiguration=vf.FeatureName=void 0;var M2=Cn();vf.FeatureName=M2.featureConfiguration.FeatureName;vf.initFeatureConfiguration=M2.featureConfiguration.initFeatureConfiguration;vf.isFeatureEnabled=M2.featureConfiguration.isFeatureEnabled;vf.getFeatures=M2.featureConfiguration.getFeatures;vf.getTypedFeatureGate=M2.featureConfiguration.getTypedFeatureGate;vf.isTypedChangeGateEnabled=M2.featureConfiguration.isTypedChangeGateEnabled;var rSe=Ql();Object.defineProperty(vf,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return rSe.overrideTypedFeatureGates}});Object.defineProperty(vf,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return rSe.setFeatureGateDictionaryGetter}})});var RP=Y(Id=>{"use strict";_();var Eq;Object.defineProperty(Id,"__esModule",{value:!0});Id.runOperatorPrecedenceParser=Id.isWSFNode=Id.maybeWSFTerm=Id.structRefTerm=Id.fieldRefTerm=Id.argsTerm=Id.lambdaArgsTerm=Id.TermKind=void 0;var xcr=br(),p3=SR(),AC=um(),Ia=wp(),qu=_R(),Es=vv(),xt=S1(),Mo=NC(),yP=m1(),fSe=$h(),aX=lg(),iX=Pq(),hf;(function(e){e.LambdaArgsTerm="LambdaArgsTerm",e.ArgsTerm="ArgsTerm",e.FieldRefTerm="FieldRefTerm",e.StructRefTerm="StructRefTerm",e.MaybeWSFTerm="MaybeWSFTerm"})(hf=Id.TermKind||(Id.TermKind={}));function Lcr(e,r,n,a){return{kind:hf.LambdaArgsTerm,nodes:e,isClosed:r,start:n,end:a}}Id.lambdaArgsTerm=Lcr;function Bcr(e,r,n,a){return{kind:hf.ArgsTerm,nodes:e,isClosed:r,start:n,end:a}}Id.argsTerm=Bcr;function pSe(e,r,n,a){return{kind:hf.FieldRefTerm,hasDotPreSpace:e,rhs:r,start:n,end:a}}Id.fieldRefTerm=pSe;function qcr(e,r,n){return{kind:hf.StructRefTerm,rhs:e,start:r,end:n}}Id.structRefTerm=qcr;function Ucr(e,r){return{kind:hf.MaybeWSFTerm,node:e,whole:r}}Id.maybeWSFTerm=Ucr;function Nq(e){return e.kind!==Es.TokenKind.Operator&&e.kind!==Es.TokenKind.Sep&&e.kind!==Es.TokenKind.End&&e.kind!==Es.TokenKind.Spaces&&e.kind!==Es.TokenKind.SingleLineComment&&e.kind!==Es.TokenKind.MultiLineComment&&!(e.kind in hf)}function Aq(e){return e.kind===Es.TokenKind.Spaces||e.kind===Es.TokenKind.SingleLineComment||e.kind===Es.TokenKind.MultiLineComment}function mSe(e,r){return r=r.kind===hf.MaybeWSFTerm?r.node:r,Nq(r)?(0,Mo.getNodeSpan)(e,r).start:r.start}var CP=(0,xt.many)((0,xt.take)(function(e,r){return Aq(r)?r:void 0})),Gcr=(0,xt.many1)((0,xt.take)(function(e,r){return Aq(r)?r:void 0})),Kcr=(0,xt.peek)(function(e,r){return r}),eS=function(r,n,a,o,u){var t=r[n];if(t==null){var d="calc.parse.pStart: internal error: expected term at ".concat(n," in ").concat((0,p3.anonymize)(r));return(0,AC.assertFalse)(d)}return o(mSe(a,t),n)};function _P(e){return(0,xt.apply)((0,xt.tuple)(CP,eS,(0,xt.take)(e),eS,CP),function(r,n){var a=n[0],o=n[1],u=n[2],t=n[3],d=n[4];return(0,Ia.operatorNode)(u,(0,Mo.addSpan)(r,o,t,a,d))})}function gSe(e){return(0,xt.apply)((0,xt.tuple)(CP,eS,(0,xt.take)(e),eS),function(r,n){var a=n[0],o=n[1],u=n[2],t=n[3];return(0,Ia.operatorNode)(u,(0,Mo.addSpan)(r,o,t,a,""))})}function vSe(e){return(0,xt.apply)((0,xt.tuple)(eS,(0,xt.take)(e),eS,CP),function(r,n){var a=n[0],o=n[1],u=n[2],t=n[3];return(0,Ia.operatorNode)(o,(0,Mo.addSpan)(r,a,u,"",t))})}var Vcr=_P(function(e,r){return r.kind===Es.TokenKind.Operator&&(r.value===qu.OperatorId.Add||r.value===qu.OperatorId.Sub)?r.value:void 0}),hSe=vSe(function(e,r){if(r.kind===Es.TokenKind.Operator){if(r.value===qu.OperatorId.Add)return qu.OperatorId.Pos;if(r.value===qu.OperatorId.Sub)return qu.OperatorId.Neg}}),uX=vSe(function(e,r){return r.kind===Es.TokenKind.Operator&&r.value===qu.OperatorId.At?r.value:void 0}),Wcr=gSe(function(e,r){return r.kind===Es.TokenKind.Operator&&r.value===qu.OperatorId.Pound?r.value:void 0}),jcr=(0,xt.take)(function(e,r){return r.kind===hf.StructRefTerm?r:void 0}),Hcr=_P(function(e,r){return r.kind===Es.TokenKind.Operator&&(r.value===qu.OperatorId.Mul||r.value===qu.OperatorId.Div)?r.value:void 0}),Qcr=_P(function(e,r){return r.kind===Es.TokenKind.Operator&&r.value===qu.OperatorId.Pow?r.value:void 0}),zcr=gSe(function(e,r){return r.kind===Es.TokenKind.Operator&&r.value===qu.OperatorId.Percent?r.value:void 0}),Ycr=_P(function(e,r){return r.kind===Es.TokenKind.Operator&&r.value===qu.OperatorId.Concat?r.value:void 0}),Jcr=_P(function(e,r){return r.kind===Es.TokenKind.Operator&&r.value>=qu.OperatorId.Eq&&r.value<=qu.OperatorId.Ge?r.value:void 0}),Xcr=_P(function(e,r){return r.kind===Es.TokenKind.Operator&&r.value===qu.OperatorId.Range?r.value:void 0}),Zcr=_P(function(e,r){return r.kind===Es.TokenKind.Operator&&r.value===qu.OperatorId.Union?r.value:void 0}),$cr=(0,xt.applyTake)((0,xt.tuple)(Gcr,Kcr),function(e,r){var n=r[0],a=r[1];if(a.kind!==Es.TokenKind.End&&(a.kind!==Es.TokenKind.Operator||a.value===qu.OperatorId.At)&&!(a.kind===Es.TokenKind.Sep&&(0,fSe.isDotSepToken)(a))){if(!(n.length===1&&n[0].kind===Es.TokenKind.Spaces))return n;var o=mSe(e,a),u=(0,Mo.addSpan)(e,o,o,n[0].chars,"");return(0,Ia.operatorNode)(qu.OperatorId.Isect,u)}}),SSe=(0,xt.take)(function(e,r){return r.kind===Es.TokenKind.Sep&&(0,fSe.isDotSepToken)(r)?r:void 0}),edr=(0,xt.take)(function(e,r){return r.kind===hf.ArgsTerm?r:void 0}),rdr=(0,xt.take)(function(e,r){return r.kind===hf.LambdaArgsTerm?r:void 0}),ndr=(0,xt.take)(function(e,r){return r.kind===hf.ArgsTerm||r.kind===hf.FieldRefTerm?r:void 0}),tdr=(Eq={},Eq[qu.WorksheetFuncId.LETREC]=iX.FeatureName.CalcLetRecFunction,Eq[qu.WorksheetFuncId.LAMBDA]=iX.FeatureName.CalcLambdaFunction,Eq);function sX(e,r){if(r.kind===hf.MaybeWSFTerm&&r.whole!==void 0){var n=(0,yP.getWorksheetFuncId)(e,r.whole);if(n===void 0)return;(0,AC.assertTrue)("calc.parse.parseWSFName: unexpected UDF",n!==qu.WorksheetFuncId._UDF);var a=tdr[n];return a!==void 0&&!(0,iX.isFeatureEnabled)(a)?void 0:(0,Ia.wsfNode)(n,r.whole,r.node.label)}}Id.isWSFNode=sX;var adr=(0,xt.take)(function(e,r){return sX(e.localeInfo,r)}),idr=(0,xt.take)(function(e,r){var n=sX(e.localeInfo,r);return(n==null?void 0:n.id)===qu.WorksheetFuncId.LAMBDA?n:void 0});function odr(e,r){return!!((0,yP.isUnqualifiedNameNode)(r)||e===Ia.RefStyle.A1&&r.kind===Ia.NodeKind.CellRef&&r.qualifier===void 0&&r.ref.kind===Ia.CellRefKind.Single&&r.ref.col.kind===Ia.PosKind.Rel&&r.ref.row.kind===Ia.PosKind.Rel)}var nSe=(0,xt.apply)((0,xt.tuple)(idr,rdr),function(e,r){for(var n=r[0],a=r[1],o=(0,Mo.getNodeSpan)(e,n).start,u=a.nodes,t=n.id,d=[],s,c=[],l=0;l<u.length;l+=1){var f=u[l];f.kind===Ia.NodeKind.Param?d.push((0,Ia.lambdaParam)((0,Ia.indexedArg)(f,l))):l===u.length-1?s=(0,Ia.indexedArg)(f,l):c.push((0,Ia.indexedArg)(f,l))}var p=(0,Mo.addSpan)(e,o,a.end,"","");return(0,Ia.lambdaNode)(n,d,s,c,a.isClosed,p)}),tSe=(0,xt.apply)((0,xt.tuple)(adr,edr),function(e,r){var n=r[0],a=r[1],o=(0,Mo.getNodeSpan)(e,n).start,u=a.nodes;switch(n.id){case qu.WorksheetFuncId.LET:case qu.WorksheetFuncId.LETREC:{for(var t=n.id,d=[],s=[],c=void 0,l=0;l<u.length;l+=1){var f=u[l];if(l===u.length-1){c=(0,Ia.indexedArg)(f,l);continue}if(l+1<u.length&&(0,yP.isUnqualifiedNameNode)(f)&&!(l+3<u.length&&!odr(e.refStyle,u[l+2])&&(0,yP.isUnqualifiedNameNode)(u[l+1]))){d.push((0,Ia.letVar)((0,Ia.indexedArg)((0,Ia.varNode)((0,Ia.identNode)(f.whole,f.parts.label),f.label),l),(0,Ia.indexedArg)(u[l+1],l+1))),l+=1;continue}s.push((0,Ia.indexedArg)(f,l))}var p=(0,Mo.addSpan)(e,o,a.end,"","");return(0,Ia.letNode)(n,d,c,s,a.isClosed,p)}case qu.WorksheetFuncId.LAMBDA:return(0,AC.assertFalse)("calc.parse.parseWSFApp: unexpected LAMBDA+ArgTerm")}return oX(e,n,u,a.isClosed,o,a.end)});function ySe(e,r,n){return(0,xt.apply)((0,xt.tuple)((0,xt.many)(e),r),function(a,o){var u=o[0],t=o[1];return u.reduceRight(n(a),t)})}function rS(e,r,n){return(0,xt.apply)((0,xt.tuple)(e,(0,xt.many)(r)),function(a,o){var u=o[0],t=o[1];return t.reduce(n(a),u)})}var udr=function(r){return Array.isArray(r)};function TR(e){return function(r,n){var a,o=n[0],u=n[1];if(udr(o)){var t=(0,Mo.getNodeSpan)(e,r);(0,AC.assertTrue)("calc.parse.makeAppNodeInfix",t.post.length===0),a=(0,Mo.addWhitespace)(e,o),t.post=a[0],t.postComments=a[1];var d=(0,Mo.getNodeSpan)(e,u),s=(0,Mo.addSpan)(e,t.start,d.end,"","");return(0,Ia.badSequenceNode)(Ia.BadType.Unexpected,[r,u],s)}var c=(0,Mo.getNodeSpan)(e,r).start,l=(0,Mo.getNodeSpan)(e,u).end,f=(0,Mo.addSpan)(e,c,l,"","");return(0,Ia.appNode)(o,[r,u],!0,f)}}function oX(e,r,n,a,o,u){var t=(0,Mo.addSpan)(e,o,u,"","");return(0,Ia.appNode)(r,n,a,t)}function lX(e){return function(r,n){var a=(0,Mo.getNodeSpan)(e,r).start;switch(n.kind){case hf.ArgsTerm:return oX(e,r,n.nodes,n.isClosed,a,n.end);case hf.FieldRefTerm:{var o=(0,Mo.addSpan)(e,a,n.end,"",""),u=(0,Mo.getNodeSpan)(e,n.rhs),t=u.start,d=u.end,s=u.pre;if((0,yP.isNumberLiteralNode)(r)){var c=(0,Mo.addSpan)(e,t,t,"",""),l=(0,Ia.missingNode)("",c),f=n.rhs.label,p=(0,Mo.addSpan)(e,t,d,"",""),m=(0,Ia.fieldRef)(n.rhs.field,n.rhs.isBracketed,n.rhs.isClosed,p),v=!1;return(0,Ia.badSequenceNode)(Ia.BadType.FieldRef,[r,(0,Ia.fieldRefNode)(l,m,v,f)],o)}var h=!n.rhs.isBracketed&&(0,yP.shouldFieldRefBeBracketed)(r,n.rhs,s);return(0,Ia.fieldRefNode)(r,n.rhs,h,o)}case hf.StructRefTerm:{var o=(0,Mo.addSpan)(e,a,n.end,"","");switch(r.kind){case Ia.NodeKind.Name:return(0,Ia.structRefNode)(r,n.rhs,o);case Ia.NodeKind.Missing:return(0,Ia.structRefNode)(void 0,n.rhs,o)}return(0,Ia.badSequenceNode)(Ia.BadType.StructRef,[r,(0,Ia.structRefNode)(void 0,n.rhs,(0,Mo.addSpan)(e,n.start,n.end,"",""))],o)}case Ia.NodeKind.Operator:return oX(e,n,[r],!0,a,(0,Mo.getNodeSpan)(e,n).end)}}}function CSe(e){var r=!0;return function(n,a){var o=(0,Mo.getNodeSpan)(e,a).start,u=(0,Mo.getNodeSpan)(e,n).end,t=(0,Mo.addSpan)(e,o,u,"","");if((a.id===qu.OperatorId.Pos||a.id===qu.OperatorId.Neg)&&r&&(r=!1,(0,yP.isNumberLiteralNode)(n)&&(0,Mo.getNodeSpan)(e,a).post==="")){var d=a.id===qu.OperatorId.Pos?n.oper:e.mathpack.neg(n.oper);return(0,Ia.literalNode)(d,!0,t)}return(0,Ia.appNode)(a,[n],!0,t)}}var aSe=(0,xt.take)(function(e,r){return r.kind===hf.MaybeWSFTerm?r.node:Nq(r)?r:void 0}),sdr=(0,xt.apply)((0,xt.tuple)(CP,SSe,eS,CP),function(e,r){var n=r[0],a=r[1],o=r[2],u=r[3];return(0,Ia.badCharsNode)(Ia.BadType.Unexpected,a.chars,(0,Mo.addSpan)(e,a.start,o,n,u))}),ldr=(0,xt.apply)((0,xt.tuple)(eS,CP,SSe,eS),function(e,r){var n=r[0],a=r[1],o=r[2],u=r[3],t=(0,Mo.addSpan)(e,u,u,"",""),d=(0,Mo.addSpan)(e,o.start,u,a,""),s=(0,Ia.fieldRef)((0,Ia.missingNode)("",t),!1,!0,d);return pSe(a.length>0,s,n,u)}),cdr=(0,xt.lazy)(function(){return(0,xt.apply)((0,xt.tuple)(eS,(0,xt.many)((0,xt.any)(nSe,tSe,aSe,sdr),(0,xt.any)(nSe,tSe,aSe,(0,xt.right)((0,xt.succeeds)(uX),Oq))),eS),function(e,r){var n=r[0],a=r[1],o=r[2];if(a.length===1)return a[0];var u=(0,Mo.addSpan)(e,n,o,"","");return a.length===0?(0,Ia.missingNode)("",u):(0,Ia.badSequenceNode)(Ia.BadType.Unexpected,a,u)})}),ddr=(0,xt.lazy)(function(){return(0,xt.any)((0,xt.right)((0,xt.succeeds)(uX),Oq),(0,xt.right)((0,xt.succeeds)(hSe),_Se),cdr)}),iSe=rS(ddr,(0,xt.any)(Wcr,jcr),lX),oSe=rS(iSe,(0,xt.tuple)(Xcr,iSe),TR),fdr=rS(oSe,(0,xt.tuple)($cr,oSe),TR),pdr=rS(fdr,(0,xt.any)(ndr,ldr),lX),Oq=ySe(uX,pdr,CSe),mdr=rS(Oq,(0,xt.tuple)(Zcr,Oq),TR),_Se=ySe(hSe,mdr,CSe),uSe=rS(_Se,zcr,lX),sSe=rS(uSe,(0,xt.tuple)(Qcr,uSe),TR),lSe=rS(sSe,(0,xt.tuple)(Hcr,sSe),TR),cSe=rS(lSe,(0,xt.tuple)(Vcr,lSe),TR),dSe=rS(cSe,(0,xt.tuple)(Ycr,cSe),TR),gdr=rS(dSe,(0,xt.tuple)(Jcr,dSe),TR);function vdr(e,r){var n=r.length-1;if(n<1){var a="calc.parse.runTermParser: internal error: expected at least 1 term";return(0,AC.assertFalse)(a)}if(r[n].kind!==Es.TokenKind.End){var a="calc.parse.runTermParser: internal error: array[n].kind !== End in ".concat((0,p3.anonymize)(r));return(0,AC.assertFalse)(a)}if(n===1&&Nq(r[0]))return r[0];if(Aq(r[0])){var a="calc.parse.runTermParser: internal error: array[0].kind === Spaces/comment in ".concat((0,p3.anonymize)(r));return(0,AC.assertFalse)(a)}if(Aq(r[n-1])){var a="calc.parse.runTermParser: internal error: array[n-1].kind === Spaces/comment in ".concat((0,p3.anonymize)(r));return(0,AC.assertFalse)(a)}for(;;){var o=(0,xt.runParser)(gdr,r,0,e);if((0,aX.isSuccess)(o)&&o.value.index>=n)return o.value.output;if(!(0,aX.isSuccess)(o)||o.value.index===0||o.value.index===1&&Nq(r[0])){var u=(0,aX.isSuccess)(o)?o.value.index:0,a="calc.parse.runTermParser: internal error: consumed ".concat(u," out of ").concat(n," in ").concat((0,p3.anonymize)(r));return(0,AC.assertFalse)(a)}r=xcr.__spreadArray([o.value.output],r.slice(o.value.index),!0),n=r.length-1}}Id.runOperatorPrecedenceParser=vdr});var kq=Y(w2=>{"use strict";_();Object.defineProperty(w2,"__esModule",{value:!0});w2.parseFieldRef=w2.isUnbracketedField=void 0;var TP=wp(),dX=vv(),cg=S1(),hdr=RP(),m3=NC(),OC=$h(),Sdr=lg(),cX=hP(),fX=E2(),ydr=fX.codePointQuestionMark,RSe=fX.codePointBackslash,Cdr=fX.codePointUnderscore,TSe=255;function bSe(e,r){function n(u){return u!==ydr&&u!==RSe&&e.isIdentContinue(u)}function a(u){return u!==Cdr&&u!==RSe&&(e.isIdentStart(u)||e.isNumeral(u))}if(r.length===0)return!1;var o=(0,cX.stringCodePointAt)(r,0);return a(o)?(0,cX.codePointIterator)(r,(0,cX.numCodeUnits)(o)).every(n):!1}w2.isUnbracketedField=bSe;var _dr=(0,cg.take)(function(e,r){return!(0,OC.isBracketToken)(r)&&r.kind!==dX.TokenKind.Escape&&r.kind!==dX.TokenKind.End?r.chars:void 0}),Rdr=(0,cg.take)(function(e,r){return r.kind===dX.TokenKind.Ident&&(r.chars===e.localeInfo.leftBracket||r.chars===e.localeInfo.rightBracket||r.chars==="'")?r.chars:void 0}),Tdr=(0,cg.any)(_dr,(0,cg.right)(OC.parseEscape,Rdr)),bdr=(0,cg.apply)((0,cg.tuple)((0,cg.many)(Tdr),OC.parseEnd),function(e,r){var n=r[0],a=r[1];return n.join("")}),Pdr=(0,cg.applyTake)(OC.parseBracketedTokens,function(e,r){var n=r[0],a=r[1],o=(0,cg.runParser)(bdr,n,0,e);if((0,Sdr.isSuccess)(o)){var u=n[0].start,t=n[n.length-1].start,d=o.value.output;if(d.length>TSe){var s=n.map(function(c){return c.chars}).join("");return[(0,TP.badCharsNode)(TP.BadType.FieldName,s,(0,m3.addSpan)(e,u,t,"","")),!1,!0]}return[(0,TP.identNode)(d,(0,m3.addSpan)(e,u,t,"","")),!0,a]}}),Edr=(0,cg.apply)(OC.parseIdentContinue,function(e,r){var n=r.start,a=r.start+r.chars.length;return!bSe(e.localeInfo,r.chars)||r.chars.length>TSe?[(0,TP.badCharsNode)(TP.BadType.FieldName,r.chars,(0,m3.addSpan)(e,n,a,"","")),!1,!0]:[(0,TP.identNode)(r.chars,(0,m3.addSpan)(e,n,a,"","")),!1,!0]});w2.parseFieldRef=(0,cg.apply)((0,cg.tuple)(OC.parseCharIndex,OC.parseWhitespace,OC.parseDotSepToken,(0,cg.any)(Edr,Pdr),OC.parseCharIndex),function(e,r){var n=r[0],a=r[1],o=r[2],u=r[3],t=u[0],d=u[1],s=u[2],c=r[4],l=(0,m3.addSpan)(e,o.start,c,a,""),f=(0,TP.fieldRef)(t,d,s,l);return(0,hdr.fieldRefTerm)(a.length>0,f,n,c)})});var PSe=Y(Gi=>{"use strict";_();Object.defineProperty(Gi,"__esModule",{value:!0});Gi.shouldQuoteQualifier=Gi.resolvePosition=Gi.quoteQualifier=Gi.formatRowRange=Gi.formatRow=Gi.formatRangePos=Gi.formatQualifier=Gi.formatGridRange=Gi.formatColRange=Gi.formatCol=Gi.formatCellPos=Gi.columnName=Gi.canonicaliseRowRange=Gi.canonicaliseRow=Gi.canonicaliseRangePos=Gi.canonicaliseColRange=Gi.canonicaliseCol=Gi.canonicaliseCellPos=Gi.canonicaliseBrackets=void 0;var Md=et();Gi.canonicaliseBrackets=Md.cellFormat.canonicaliseBrackets;Gi.canonicaliseCellPos=Md.cellFormat.canonicaliseCellPos;Gi.canonicaliseCol=Md.cellFormat.canonicaliseCol;Gi.canonicaliseColRange=Md.cellFormat.canonicaliseColRange;Gi.canonicaliseRangePos=Md.cellFormat.canonicaliseRangePos;Gi.canonicaliseRow=Md.cellFormat.canonicaliseRow;Gi.canonicaliseRowRange=Md.cellFormat.canonicaliseRowRange;Gi.columnName=Md.cellFormat.columnName;Gi.formatCellPos=Md.cellFormat.formatCellPos;Gi.formatCol=Md.cellFormat.formatCol;Gi.formatColRange=Md.cellFormat.formatColRange;Gi.formatGridRange=Md.cellFormat.formatGridRange;Gi.formatQualifier=Md.cellFormat.formatQualifier;Gi.formatRangePos=Md.cellFormat.formatRangePos;Gi.formatRow=Md.cellFormat.formatRow;Gi.formatRowRange=Md.cellFormat.formatRowRange;Gi.quoteQualifier=Md.cellFormat.quoteQualifier;Gi.resolvePosition=Md.cellFormat.resolvePosition;Gi.shouldQuoteQualifier=Md.cellFormat.shouldQuoteQualifier});var gX=Y(Fq=>{"use strict";_();Object.defineProperty(Fq,"__esModule",{value:!0});Fq.parseQualifier=void 0;var y1=wp(),ui=S1(),FC=NC(),Tu=$h(),kC=vv(),Ndr=E2(),Adr=CC(),OSe=PSe(),Odr=um();function kSe(e){return e.kind===kC.TokenKind.Literal&&e.oper.kind===Adr.OperKind.Boolean}function kdr(e){return e.kind===kC.TokenKind.Literal&&(0,kC.isNumberLikeOper)(e.oper)}var Fdr=Ndr.codePointFullStop,pX=(0,ui.opt)((0,ui.takePeek)(function(e,r,n){return r.kind===kC.TokenKind.Spaces&&!(0,Tu.isWhitespaceToken)(n)?r.chars:void 0}),""),Idr=(0,ui.take)(function(e,r){return r.isIdentContinue&&!kSe(r)&&r.chars.length>0&&r.chars.charCodeAt(0)!==Fdr?r.chars:void 0}),FSe=(0,ui.take)(function(e,r){return r.isIdentContinue||(0,Tu.isDotSepToken)(r)?r.chars:void 0}),ESe=(0,ui.apply)((0,ui.many1)(Idr,FSe),function(e,r){return r.join("")}),NSe=(0,ui.take)(function(e,r){return r.kind===kC.TokenKind.Ident?r.chars:void 0}),mX=function(r,n){var a;return((a=n.path)!==null&&a!==void 0?a:"")+r.leftBracket+n.document+r.rightBracket};function ISe(e,r,n,a,o,u){var t,d;if(r==null)a==null?(t=(0,y1.identQualifier)(n,o,u),d=n):(t=(0,y1.sheetRangeQualifier)(n,a,void 0,o,u),d="".concat(n,":").concat(a));else{var s=mX(e.localeInfo,r);a==null?(t=(0,y1.sheetQualifier)(n,r,o,u),d="".concat(s).concat(n)):(t=(0,y1.sheetRangeQualifier)(n,a,r,o,u),d="".concat(s).concat(n,":").concat(a))}return[t,o?(0,OSe.quoteQualifier)(d):d]}var ASe=(0,ui.take)(function(e,r){return r.kind===kC.TokenKind.Ident||(0,Tu.isRangeOpToken)(r)?r.chars:void 0}),MSe=(0,ui.apply)((0,ui.tuple)(Tu.parseCharIndex,(0,ui.many)(ASe),Tu.parseLeftBracket,(0,ui.many1)(ASe),Tu.parseRightBracket,Tu.parseCharIndex),function(e,r){var n=r[0],a=r[1],o=r[2],u=r[3],t=r[4],d=r[5],s=a.join(""),c=u.join("");return(0,y1.documentQualifier)(c,s!==""?s:void 0,!0,(0,FC.addSpan)(e,n,d,"",""))}),wSe=(0,ui.apply)((0,ui.tuple)(Tu.parseCharIndex,Tu.parseLeftBracket,(0,ui.many1)(FSe),Tu.parseRightBracket,Tu.parseCharIndex),function(e,r){var n=r[0],a=r[1],o=r[2],u=r[3],t=r[4],d=o.join("");return(0,y1.documentQualifier)(d,void 0,!1,(0,FC.addSpan)(e,n,t,"",""))}),Mdr=(0,ui.apply)((0,ui.tuple)(Tu.parseCharIndex,(0,ui.opt)(wSe,void 0),ESe,(0,ui.opt)((0,ui.right)(Tu.parseRangeOp,ESe),void 0),Tu.parseCharIndex),function(e,r){var n=r[0],a=r[1],o=r[2],u=r[3],t=r[4];return ISe(e,a,o,u,!1,(0,FC.addSpan)(e,n,t,"",""))}),wdr=(0,ui.apply)((0,ui.tuple)(Tu.parseLeftSQuote,(0,ui.opt)(MSe,void 0),NSe,(0,ui.opt)((0,ui.right)(Tu.parseRangeOp,NSe),void 0),Tu.parseRightSQuote,Tu.parseCharIndex),function(e,r){var n=r[0],a=r[1],o=r[2],u=r[3],t=r[4],d=r[5];return ISe(e,a,o,u,!0,(0,FC.addSpan)(e,n.start,d,"",""))}),Ddr=(0,ui.apply)(wSe,function(e,r){return[r,mX(e.localeInfo,r)]}),xdr=(0,ui.apply)((0,ui.tuple)(Tu.parseLeftSQuote,MSe,Tu.parseRightSQuote),function(e,r){var n=r[0],a=r[1],o=r[2];return[a,(0,OSe.quoteQualifier)(mX(e.localeInfo,a))]}),Ldr=(0,ui.take)(function(e,r){return r.kind===kC.TokenKind.End||r.kind===kC.TokenKind.Right&&r.value===kC.DelimId.SQuote?void 0:r.chars}),Bdr=(0,ui.apply)((0,ui.tuple)(Tu.parseLeftSQuote,(0,ui.many)(Ldr),(0,ui.opt)((0,ui.tuple)(Tu.parseRightSQuote,(0,ui.opt)((0,ui.tuple)(Tu.parseQualSep,pX),[void 0,""])),[void 0,[void 0,""]]),Tu.parseCharIndex),function(e,r){var n=r[0],a=r[1],o=r[2],u=o[0],t=o[1],d=t[0],s=t[1],c=r[3],l=u!==void 0,f=d!==void 0,p="'".concat(a.join("")).concat(l?"'":"").concat(f?"!":""),m=(0,FC.addSpan)(e,n.start,c-s.length,"",s);return[(0,y1.badQualifier)(p,!0,l,f,m),p]}),qdr=(0,ui.takePeek)(function(e,r,n){if((0,Tu.isRefErrorToken)(r)){var a=(0,FC.addSpan)(e,r.start,n.start,"","");return[(0,y1.errorQualifier)(a),r.chars]}}),Udr=(0,ui.peek)(function(e,r){var n=(0,FC.addSpan)(e,r.start,r.start,"","");return[(0,y1.relativeQualifier)(n),""]}),Gdr=(0,ui.apply)((0,ui.tuple)((0,ui.any)(Mdr,wdr,Ddr,xdr,Udr),Tu.parseQualSep,pX),function(e,r){var n=r[0],a=n[0],o=n[1],u=r[1],t=r[2],d=(0,FC.getNodeSpan)(e,a);return d.end+=1,(0,Odr.assertTrue)("calc.parse.parseGoodQualifier",d.post.length===0),d.post=t,[a,"".concat(o,"!")]}),Kdr=(0,ui.take)(function(e,r){return r.isIdentContinue||(0,Tu.isDotSepToken)(r)||kSe(r)||kdr(r)?r.chars:void 0}),Vdr=(0,ui.apply)((0,ui.tuple)(Tu.parseCharIndex,(0,ui.many)(Kdr),Tu.parseQualSep,Tu.parseCharIndex,pX),function(e,r){var n=r[0],a=r[1],o=r[2],u=r[3],t=r[4],d="".concat(a.join(""),"!"),s=(0,FC.addSpan)(e,n,u,"",t);return[(0,y1.badQualifier)(d,!1,!0,!0,s),d]});Fq.parseQualifier=(0,ui.any)(qdr,Gdr,Vdr,Bdr)});var TX=Y(C1=>{"use strict";_();Object.defineProperty(C1,"__esModule",{value:!0});C1.parseRef=C1.parseUnqualBadRef=C1.isCompleteCellRefToken=void 0;var DSe=br(),Wdr=SR(),Mq=um(),Lt=wp(),hX=g1(),D2=c3(),Sf=vv(),Zi=S1(),g3=RP(),wo=NC(),jdr=m1(),dg=$h(),Hdr=gX(),Qdr=CC(),BSe=hP(),zdr=kq();function SX(e,r){return e.refStyle===r.refStyle&&!r.isBadLocale&&r.row!==D2.SpecialPos.A1BadDollar&&r.col!==D2.SpecialPos.A1BadDollar}function qSe(e){return e.refStyle===Lt.RefStyle.R1C1||typeof e.row=="object"&&typeof e.col=="object"}function Ydr(e){return e.refStyle===Lt.RefStyle.A1&&e.row==null&&typeof e.col=="object"&&e.col.kind===Lt.PosKind.Rel}function Jdr(e,r){return r.refStyle===Lt.RefStyle.A1&&e.refStyle===Lt.RefStyle.A1&&r.isIdentContinue||r.refStyle===Lt.RefStyle.R1C1&&(0,D2.isR1C1IdentStart)(r.row,r.col)}function yX(e,r){return r.kind===Sf.TokenKind.CellRef&&SX(e,r)&&qSe(r)}C1.isCompleteCellRefToken=yX;var Xdr=(0,Lt.pos)(Lt.PosKind.Rel,0);function Iq(e){return e===D2.SpecialPos.RCNoNum?Xdr:e}function wq(e,r){if(e.row!==D2.SpecialPos.A1BadDollar&&e.col!==D2.SpecialPos.A1BadDollar){var n=e.refStyle===Lt.RefStyle.R1C1&&!e.isIdentContinue;if(e.row!=null&&e.col!=null)return(0,Lt.cellRefSingle)(Iq(e.row),Iq(e.col),n,r);if(e.row!=null){var a=Iq(e.row);return(0,Lt.cellRefRow)(a,a,n,r)}if(e.col!=null){var o=Iq(e.col);return(0,Lt.cellRefCol)(o,o,n,r)}}var u="calc.parse.cellRefToken2cellRef: bad token ".concat((0,Wdr.anonymize)(e));return(0,Mq.assertFalse)(u)}function CX(e,r){return r.isIdentContinue&&e.localeInfo.isIdentStart((0,BSe.stringCodePointAt)(r.chars,0))}var Zdr=(0,Zi.take)(function(e,r){return yX(e,r)&&!CX(e,r)||(0,dg.isRefErrorToken)(r)?r:void 0}),xSe=(0,Zi.take)(function(e,r){return yX(e,r)&&CX(e,r)?r:void 0}),$dr=(0,Zi.apply)((0,Zi.tuple)((0,Zi.any)(Zdr,(0,Zi.withState)(function(e){return e.cellRefMustBeCellRefNode?xSe:(0,Zi.left)(xSe,(0,Zi.fails)((0,Zi.any)(dg.parseIdentContinue,dg.parseDotSepTokenNotFollowedByLeftBracket)))})),dg.parseCharIndex),function(e,r){var n=r[0],a=r[1],o=n.kind===Sf.TokenKind.CellRef?wq(n,(0,wo.addSpan)(e,n.start,a,"","")):(0,Lt.cellRefError)((0,wo.addSpan)(e,n.start,a,"","")),u=n.kind===Sf.TokenKind.CellRef?n.chars:void 0;return(0,g3.maybeWSFTerm)((0,Lt.cellRefNode)(o,void 0,(0,wo.addSpan)(e,n.start,a,"","")),u)});function efr(e,r,n){return n.kind===Sf.TokenKind.Left&&n.value===Sf.DelimId.Paren&&r.isIdentContinue&&(0,jdr.getWorksheetFuncId)(e.localeInfo,r.chars)!=null}var LSe=(0,Zi.takePeek)(function(e,r,n){return r.kind===Sf.TokenKind.CellRef&&SX(e,r)&&!efr(e,r,n)&&!n.isIdentContinue?[r,n.start]:void 0}),rfr=(0,Zi.bind)((0,Zi.tuple)(LSe,dg.parseSpacesOnly,dg.parseRangeOp,dg.parseSpacesOnly,LSe),function(e,r){var n=r[0],a=n[0],o=n[1],u=r[1],t=r[2],d=r[3],s=r[4],c=s[0],l=s[1],f=(0,wo.addSpan)(e,a.start,o,"",u),p=(0,wo.addSpan)(e,c.start,l,d,""),m=wq(a,f),v=wq(c,p),h=void 0;if(m.kind===Lt.CellRefKind.Single&&v.kind===Lt.CellRefKind.Single){var S=(0,wo.addSpan)(e,a.start,l,"","");h=(0,Lt.cellRefRange)(m,v,S)}else if(u.length===0&&d.length===0){if(m.kind===Lt.CellRefKind.Row&&v.kind===Lt.CellRefKind.Row){var y=m.isBracketed||v.isBracketed,S=(0,wo.addSpan)(e,a.start,l,"","");h=(0,Lt.cellRefRow)(m.row1,v.row1,y,S)}else if(m.kind===Lt.CellRefKind.Col&&v.kind===Lt.CellRefKind.Col){var y=m.isBracketed||v.isBracketed,S=(0,wo.addSpan)(e,a.start,l,"","");h=(0,Lt.cellRefCol)(m.col1,v.col1,y,S)}}if(h==null)return(0,Zi.parseFail)();var C=(0,g3.maybeWSFTerm)((0,Lt.cellRefNode)(h,void 0,(0,wo.addSpan)(e,a.start,l,"","")),void 0);return a.isIdentContinue&&c.isIdentContinue?(0,Zi.peek)(function(E,I){return I.kind===Sf.TokenKind.Sep&&I.value===Sf.SepId.Qual?void 0:C}):(0,Zi.parseSucceed)(C)}),_X=(0,Zi.any)(rfr,$dr);C1.parseUnqualBadRef=(0,Zi.apply)((0,Zi.take)(function(e,r){return r.kind===Sf.TokenKind.CellRef?r:void 0}),function(e,r){var n=r.start+r.chars.length,a=r.refStyle===Lt.RefStyle.R1C1&&!r.isIdentContinue;return(0,g3.maybeWSFTerm)((0,Lt.cellRefNode)((0,Lt.cellRefBad)(r.chars,a,(0,wo.addSpan)(e,r.start,n,"","")),void 0,(0,wo.addSpan)(e,r.start,n,"","")),r.chars)});function nfr(e,r,n){return n.length===0||r.length===1&&r[0].kind===Sf.TokenKind.Literal||n.some(function(a,o){return o%2===0?a.kind!==Sf.TokenKind.Sep:a.kind===Sf.TokenKind.Sep||!(0,zdr.isUnbracketedField)(e.localeInfo,a.chars)})}var tfr="_xlpm";function afr(e,r){var n,a,o,u,t,d,s,c=r[0],l=r[1],f=r[2],p=r[3],m=c[0],v=c.length===1&&((n=l[0])===null||n===void 0?void 0:n.kind)===Sf.TokenKind.Sep,h=m.kind!==Sf.TokenKind.CellRef||Ydr(m)||Jdr(e,m)&&v;if(f||nfr(e,c,l)){var S=DSe.__spreadArray(DSe.__spreadArray([],c,!0),l,!0).map(function(ie){return ie.chars}).join(""),y=(0,wo.addSpan)(e,m.start,p,"",""),C=(0,wo.addSpan)(e,m.start,p,"",""),E=(0,Lt.identNamePart)(S,h,y,C),I=(0,Lt.nameNode)(E,void 0,(0,wo.addSpan)(e,m.start,p,"",""));return(0,g3.maybeWSFTerm)(I,I.whole)}var F=h,w,B=0,k=(o=(a=l[B])===null||a===void 0?void 0:a.start)!==null&&o!==void 0?o:p,x=(0,wo.addSpan)(e,m.start,k,"",""),G=(0,wo.addSpan)(e,m.start,k,"","");if(c.length===1&&m.kind===Sf.TokenKind.CellRef)if(!SX(e,m))F=!1,w=(0,Lt.identNamePart)(m.chars,F,x,G);else if(!qSe(m))w=(0,Lt.identNamePart)(m.chars,F,x,G);else{var H=(0,wo.addSpan)(e,m.start,k,"",""),L=wq(m,H);w=(0,Lt.cellRefNamePart)(L,m.chars,x,G)}else{var D=c.map(function(ie){return ie.chars}).join("");e.localeInfo.stringCompareCI(D,tfr)===0&&B+1<l.length&&(D+="."+l[B+1].chars,B+=2),w=(0,Lt.identNamePart)(D,F,x,G)}for(var U=w;B+1<l.length;B+=2){var V=l[B],ne=l[B+1],J=(t=(u=l[B+2])===null||u===void 0?void 0:u.start)!==null&&t!==void 0?t:p;U=(0,Lt.fieldRefNamePart)(U,(0,Lt.fieldRef)((0,Lt.identNode)(ne.chars,(0,wo.addSpan)(e,ne.start,J,"","")),!1,!0,(0,wo.addSpan)(e,V.start,J,"","")),B+2>=l.length?h:F,(0,wo.addSpan)(e,m.start,J,"",""),(0,wo.addSpan)(e,m.start,J,"",""))}if(B<l.length){var V=l[B],J=(s=(d=l[B+1])===null||d===void 0?void 0:d.start)!==null&&s!==void 0?s:p,$=(0,Lt.fieldRef)((0,Lt.missingNode)("",(0,wo.addSpan)(e,J,J,"","")),!1,!0,(0,wo.addSpan)(e,V.start,J,"",""));U=(0,Lt.fieldRefNamePart)(U,$,h,(0,wo.addSpan)(e,m.start,J,"",""),(0,wo.addSpan)(e,m.start,J,"","")),B+=1}(0,Mq.assertTrue)("calc.parse.pUnqualName: i == tailTokens",B===l.length),U.kind===Lt.NamePartKind.CellRefNamePart&&(0,Mq.assertFalse)("calc.parse.pUnqualName: expected lhs.kind !== NamePartKind.CellRefNamePart");var Z=(0,Lt.nameNode)(U,void 0,(0,wo.addSpan)(e,m.start,p,"",""));return(0,g3.maybeWSFTerm)(Z,Z.whole)}var ifr=(0,Zi.take)(function(e,r){return r.kind===Sf.TokenKind.Ident&&e.localeInfo.isIdentStart((0,BSe.stringCodePointAt)(r.chars,0))||r.kind===Sf.TokenKind.CellRef&&CX(e,r)?r:void 0}),ofr=(0,Zi.take)(function(e,r){return r.kind===Sf.TokenKind.Literal&&r.oper.kind===Qdr.OperKind.Boolean?r:void 0}),ufr=(0,Zi.any)(ifr,(0,Zi.left)(ofr,(0,Zi.succeeds)(dg.parseDotSepTokenNotFollowedByLeftBracket))),sfr=(0,Zi.peek)(function(e,r){return(0,dg.isLeftBracketToken)(r)}),lfr=(0,Zi.tuple)((0,Zi.many1)(ufr,dg.parseIdentContinue),(0,Zi.many)((0,Zi.any)(dg.parseIdentContinue,dg.parseDotSepTokenNotFollowedByLeftBracket)),sfr,dg.parseCharIndex),RX=(0,Zi.apply)(lfr,afr),vX=(0,Zi.opt)((0,Zi.any)(_X,RX,C1.parseUnqualBadRef),{node:void 0}),cfr=(0,Zi.any)(_X,(0,Zi.right)((0,Zi.fails)(RX),C1.parseUnqualBadRef));function dfr(e,r,n){for(var a=r;;){var o=(0,wo.getSpan)(e,a.qualifiedLabel);if(o.start=n,a.kind===Lt.NamePartKind.FieldRefNamePart)a=a.lhs;else break}return r}var ffr=(0,Zi.bind)(Hdr.parseQualifier,function(e,r){var n=r[0],a=r[1];return(0,Zi.apply)(n.kind===Lt.QualifierKind.SheetRange?(0,wo.cellRefMustBeCellRefNode)(n.isQuoted?vX:cfr):n.kind===Lt.QualifierKind.Error?(0,wo.cellRefMustBeCellRefNode)(vX):vX,function(o,u){var t=u.node;if(t==null)return n.kind===Lt.QualifierKind.Error?(0,Lt.literalNode)(hX.refErrorOper,!0,n.label):(0,Lt.badCharsNode)(Lt.BadType.Qualifier,a,n.label);var d=(0,wo.getNodeSpan)(o,n).start,s=(0,wo.getNodeSpan)(o,t).end;if(t.kind===Lt.NodeKind.Name){var c=(0,wo.addSpan)(o,d,s,"","");if(n.kind===Lt.QualifierKind.Error){var l=(0,Lt.literalNode)(hX.refErrorOper,!0,n.label);return(0,Lt.badSequenceNode)(Lt.BadType.Unexpected,[l,t],c)}return(0,Mq.assertTrue)("calc.parse.pQualRef: sheet-range-name quoted",n.kind!==Lt.QualifierKind.SheetRange||n.isQuoted),n.kind===Lt.QualifierKind.SheetRange&&n.document===void 0&&(n=(0,Lt.identQualifier)("".concat(n.sheet1,":").concat(n.sheet2),n.isQuoted,n.label)),(0,Lt.nameNode)(dfr(o,t.parts,d),n,c)}var f=(0,wo.addSpan)(o,d,s,"","");return n.kind===Lt.QualifierKind.Ident&&(n=(0,Lt.sheetQualifier)(n.name,void 0,n.isQuoted,n.label)),(0,Lt.cellRefNode)(t.ref,n,f)})}),pfr=(0,Zi.apply)((0,Zi.any)(_X,RX),function(e,r){return r.node.kind===Lt.NodeKind.CellRef&&r.node.ref.kind===Lt.CellRefKind.Error?(0,Lt.literalNode)(hX.refErrorOper,!0,r.node.label):r});C1.parseRef=(0,Zi.any)(ffr,pfr)});var bX=Y(Dq=>{"use strict";_();Object.defineProperty(Dq,"__esModule",{value:!0});Dq.parseLiteral=void 0;var IC=wp(),x2=vv(),bP=S1(),mfr=RP(),gfr=NC(),USe=$h(),vfr=g1(),GSe=m1(),KSe=CC();function hfr(e){return e.refStyle===IC.RefStyle.A1&&e.col==null&&typeof e.row=="object"&&e.row.kind===IC.PosKind.Rel}var Sfr=(0,bP.take)(function(e,r){return r.kind===x2.TokenKind.Literal&&r.oper.kind!==KSe.OperKind.Boolean?r:r.kind===x2.TokenKind.CellRef&&hfr(r)?(0,x2.literalToken)(r.start,r.chars,e.mathpack.fromNumber(r.row.index+e.origin.row+1)):void 0}),yfr=(0,bP.take)(function(e,r){return r.kind===x2.TokenKind.Literal&&r.oper.kind===KSe.OperKind.Boolean?r:void 0});Dq.parseLiteral=(0,bP.apply)((0,bP.tuple)((0,bP.any)(Sfr,(0,bP.left)(yfr,(0,bP.fails)(USe.parseDotSepTokenNotFollowedByLeftBracket))),USe.parseCharIndex),function(e,r){var n=r[0],a=r[1],o=(0,gfr.addSpan)(e,n.start,a,"","");if((0,x2.isBadNumberOper)(n.oper))return(0,IC.badCharsNode)(IC.BadType.NumberLiteral,n.chars,o);if((0,x2.isBadErrorOper)(n.oper))return(0,IC.badCharsNode)(IC.BadType.ErrorLiteral,n.chars,o);if((0,GSe.isStringOper)(n.oper)&&n.oper.value.length>vfr.cellStringLimit)return(0,IC.badCharsNode)(IC.BadType.StringLiteral,n.chars,o);var u=(0,IC.literalNode)(n.oper,n.hasRight,o);return(0,GSe.isBooleanOper)(n.oper)?(0,mfr.maybeWSFTerm)(u,n.chars):u})});var NX=Y(xq=>{"use strict";_();Object.defineProperty(xq,"__esModule",{value:!0});xq.parseStructRef=void 0;var Cfr=br(),jt=S1(),_fr=RP(),gi=$h(),hv=wp(),Sv=NC(),_1=vv(),Rfr=lg(),jSe=(0,jt.take)(function(e,r){return r.isIdentContinue||r.kind===_1.TokenKind.Spaces?r:void 0}),Tfr=(0,jt.apply)((0,jt.many1)(jSe),function(e,r){var n=r[0];return r.length===1?n:(0,_1.identToken)(n.start,r.map(function(a){return a.kind===_1.TokenKind.Escape?"":a.chars}).join(""))}),HSe=(0,jt.take)(function(e,r){return r.isIdentContinue||r.kind===_1.TokenKind.Spaces||r.kind===_1.TokenKind.Escape||(0,gi.isListSepToken)(r)||(0,gi.isRangeOpToken)(r)?r:void 0}),QSe=(0,jt.apply)((0,jt.many1)(HSe),function(e,r){var n=r[0];return r.length===1?n:(0,_1.identToken)(n.start,r.map(function(a){return a.kind===_1.TokenKind.Escape?"":a.chars}).join(""))}),zSe=(0,jt.take)(function(e,r){return r.kind===_1.TokenKind.SpecialRef?r:void 0}),bfr=(0,jt.apply)((0,jt.tuple)(gi.parseCharIndex,zSe,gi.parseCharIndex),function(e,r){var n=r[0],a=r[1],o=r[2];return(0,hv.specialRef)(a.value,!1,!0,(0,Sv.addSpan)(e,n,o,"",""))}),Pfr=(0,jt.apply)((0,jt.tuple)(gi.parseCharIndex,gi.parseLeftBracket,zSe,(0,jt.opt)(gi.parseRightBracket,void 0),gi.parseCharIndex),function(e,r){var n=r[0],a=r[1],o=r[2],u=r[3],t=r[4];return(0,hv.specialRef)(o.value,!0,u!==void 0,(0,Sv.addSpan)(e,n,t,"",""))}),YSe=(0,jt.any)(bfr,Pfr),Efr=(0,jt.apply)((0,jt.tuple)(gi.parseCharIndex,Tfr,gi.parseCharIndex),function(e,r){var n=r[0],a=r[1],o=r[2];return(0,hv.columnRef)(a.chars,!1,!0,(0,Sv.addSpan)(e,n,o,"",""))}),JSe=(0,jt.apply)((0,jt.tuple)(gi.parseCharIndex,gi.parseLeftBracket,(0,jt.opt)(QSe,void 0),(0,jt.opt)(gi.parseRightBracket,void 0),gi.parseCharIndex),function(e,r){var n,a=r[0],o=r[1],u=r[2],t=r[3],d=r[4];return(0,hv.columnRef)((n=u==null?void 0:u.chars)!==null&&n!==void 0?n:"",!0,t!==void 0,(0,Sv.addSpan)(e,a,d,"",""))}),Nfr=(0,jt.apply)((0,jt.tuple)(gi.parseCharIndex,QSe,gi.parseCharIndex),function(e,r){var n=r[0],a=r[1],o=r[2];return(0,hv.columnRef)(a.chars,!1,!0,(0,Sv.addSpan)(e,n,o,"",""))}),PX=(0,jt.any)(Efr,JSe),XSe=(0,jt.apply)(gi.parseCharIndex,function(e,r){return(0,hv.missingRef)((0,Sv.addSpan)(e,r,r,"",""))}),VSe=(0,jt.any)(PX,XSe),ZSe=(0,jt.take)(function(e,r){return r.chars==="#"?r:void 0}),Afr=(0,jt.apply)((0,jt.many1)(ZSe,jSe),function(e,r){return(0,_1.unexpectedToken)(r[0].start,r.map(function(n){return n.chars}).join(""))}),Ofr=(0,jt.apply)((0,jt.many1)(ZSe,HSe),function(e,r){return(0,_1.unexpectedToken)(r[0].start,r.map(function(n){return n.chars}).join(""))}),kfr=(0,jt.apply)((0,jt.tuple)(gi.parseCharIndex,Afr,gi.parseCharIndex),function(e,r){var n=r[0],a=r[1],o=r[2];return(0,hv.badRef)(a.chars,!1,!0,(0,Sv.addSpan)(e,n,o,"",""))}),Ffr=(0,jt.apply)((0,jt.tuple)(gi.parseCharIndex,gi.parseLeftBracket,Ofr,(0,jt.opt)(gi.parseRightBracket,void 0),gi.parseCharIndex),function(e,r){var n=r[0],a=r[1],o=r[2],u=r[3],t=r[4];return(0,hv.badRef)(o.chars,!0,u!==void 0,(0,Sv.addSpan)(e,n,t,"",""))}),$Se=(0,jt.any)(kfr,Ffr),EX=(0,jt.apply)((0,jt.tuple)(gi.parseCharIndex,VSe,gi.parseRangeOp,VSe,gi.parseCharIndex),function(e,r){var n=r[0],a=r[1],o=r[2],u=r[3],t=r[4];return(0,hv.rangeOpRef)(a,u,(0,Sv.addSpan)(e,n,t,"",""))}),Ifr=(0,jt.any)(EX,PX),WSe=(0,jt.any)(YSe,$Se,EX,PX,XSe),Mfr=(0,jt.apply)((0,jt.tuple)(gi.parseCharIndex,WSe,(0,jt.many1)((0,jt.tuple)(gi.parseListSep,WSe)),gi.parseCharIndex),function(e,r){var n=r[0],a=r[1],o=r[2],u=r[3];return(0,hv.commaOpRef)(Cfr.__spreadArray([a],o.map(function(t){var d=t[0],s=t[1];return s}),!0),(0,Sv.addSpan)(e,n,u,"",""))}),wfr=(0,jt.apply)((0,jt.tuple)(gi.parseCharIndex,gi.parseAtOp,(0,jt.opt)(Ifr,void 0),gi.parseCharIndex),function(e,r){var n=r[0],a=r[1],o=r[2],u=r[3];return(0,hv.thisRowOpRef)(o,(0,Sv.addSpan)(e,n,u,"",""))}),Dfr=(0,jt.apply)(gi.parseSpacesOnly,function(){}),xfr=(0,jt.any)((0,jt.left)(Dfr,gi.parseEnd),(0,jt.left)(Nfr,gi.parseEnd),(0,jt.left)(Mfr,gi.parseEnd),(0,jt.left)(wfr,gi.parseEnd),(0,jt.left)(EX,gi.parseEnd),(0,jt.left)(YSe,gi.parseEnd),(0,jt.left)($Se,gi.parseEnd),(0,jt.left)(JSe,gi.parseEnd));xq.parseStructRef=(0,jt.applyTake)((0,jt.tuple)(gi.parseCharIndex,gi.parseBracketedTokens,gi.parseCharIndex),function(e,r){var n=r[0],a=r[1],o=a[0],u=a[1],t=r[2],d=(0,jt.runParser)(xfr,o,0,e);return(0,Rfr.isSuccess)(d)?(0,_fr.structRefTerm)((0,hv.structRef)(d.value.output,u,(0,Sv.addSpan)(e,n,t,"","")),n,t):void 0})});var e1e=Y(Lq=>{"use strict";_();Object.defineProperty(Lq,"__esModule",{value:!0});Lq.buildAnnotations=void 0;var Lfr=et();Lq.buildAnnotations=Lfr.annotations.buildAnnotations});var AX=Y(nS=>{"use strict";_();Object.defineProperty(nS,"__esModule",{value:!0});nS.parseSpParam=nS.runFormulaParser=nS.parseFormula=void 0;var r1e=SR(),v3=um(),rc=wp(),Bq=wp(),qq=_R(),Zu=vv(),Qn=S1(),h3=RP(),$u=NC(),Fi=$h(),Uq=TX(),Bfr=bX(),u1e=kq(),s1e=NX(),n1e=lg(),qfr=e1e(),t1e=hP(),Ufr=Cn(),Gfr=c3(),Gq=Pq(),Kfr=m1(),Vfr=g1(),PP=(0,Qn.apply)((0,Qn.tuple)(Fi.parseWhitespace,(0,Qn.lazy)(function(){return nS.parseFormula}),Fi.parseWhitespace),function(e,r){var n,a,o=r[0],u=r[1],t=r[2],d=(0,$u.getNodeSpan)(e,u);return(0,v3.assertTrue)("calc.parse.parseSpFormula",!(d.pre.length>0&&o.length>0)),(0,v3.assertTrue)("calc.parse.parseSpFormula",!(d.post.length>0&&t.length>0)),o.length>0&&(n=(0,$u.addWhitespace)(e,o),d.pre=n[0],d.preComments=n[1]),t.length>0&&(a=(0,$u.addWhitespace)(e,t),d.post=a[0],d.postComments=a[1]),u}),Wfr=(0,Qn.apply)((0,Qn.tuple)(Fi.parseLeftParen,(0,$u.withDelim)({delimId:Zu.DelimId.Paren,listSep:$u.ListSep.Union},PP),(0,Qn.opt)(Fi.parseRightParen,void 0),Fi.parseCharIndex),function(e,r){var n=r[0],a=r[1],o=r[2],u=r[3];return(0,rc.parenNode)(a,o!==void 0,(0,$u.addSpan)(e,n.start,u,"",""))}),a1e=(0,Qn.many1)(PP,(0,Qn.right)(Fi.parseColSep,PP)),jfr=(0,Qn.many1)(a1e,(0,Qn.right)(Fi.parseRowSep,a1e)),Hfr=(0,Qn.apply)((0,Qn.tuple)(Fi.parseLeftBrace,(0,$u.withDelim)({delimId:Zu.DelimId.Brace,listSep:$u.ListSep.Union},jfr),(0,Qn.opt)(Fi.parseRightBrace,void 0),Fi.parseCharIndex),function(e,r){var n=r[0],a=r[1],o=r[2],u=r[3];return(0,rc.arrayNode)(a,o!==void 0,(0,$u.addSpan)(e,n.start,u,"",""))});function i1e(e){return(0,Qn.takePeek)(function(r,n,a){return e(n)?(0,rc.badCharsNode)(rc.BadType.Unexpected,n.chars,(0,$u.addSpan)(r,n.start,a.start,"","")):void 0})}var Qfr=(0,Qn.apply)((0,Qn.tuple)(Fi.parseCharIndex,i1e(Fi.isLeftBracketToken),(0,$u.withDelim)({delimId:Zu.DelimId.Bracket,listSep:$u.ListSep.Union},PP),(0,Qn.opt)(i1e(Fi.isRightBracketToken),void 0),Fi.parseCharIndex),function(e,r){var n=r[0],a=r[1],o=r[2],u=r[3],t=r[4],d=[a,o];return u!=null&&d.push(u),(0,rc.badSequenceNode)(rc.BadType.Unexpected,d,(0,$u.addSpan)(e,n,t,"",""))}),zfr=(0,Qn.takePeek)(function(e,r,n){switch(r.kind){case Zu.TokenKind.End:case Zu.TokenKind.Operator:case Zu.TokenKind.Spaces:case Zu.TokenKind.SingleLineComment:case Zu.TokenKind.MultiLineComment:return;case Zu.TokenKind.Sep:if(r.value===Zu.SepId.Dot)return;if(r.value===Zu.SepId.Qual||r.value===Zu.SepId.Assign)break;if(e.delim.delimId===Zu.DelimId.Brace||r.value!==Zu.SepId.Col&&r.value!==Zu.SepId.Row)return;break;case Zu.TokenKind.Right:if(r.value!==Zu.DelimId.SQuote&&e.delim.stack[r.value])return;break}return(0,rc.badCharsNode)(rc.BadType.Unexpected,r.chars,(0,$u.addSpan)(e,r.start,n.start,"",""))}),Yfr=(0,Qn.any)(Uq.parseRef,Bfr.parseLiteral,Wfr,Hfr,u1e.parseFieldRef,s1e.parseStructRef,Qfr,Uq.parseUnqualBadRef,zfr);function l1e(e){return(0,Qn.tuple)(Fi.parseLeftParen,(0,$u.withDelim)({delimId:Zu.DelimId.Paren,listSep:$u.ListSep.Arg},(0,Qn.apply)((0,Qn.many1)(e,(0,Qn.right)(Fi.parseListSep,e)),function(r,n){return n.map(function(a){return a.kind===rc.NodeKind.Missing?(0,rc.literalNode)(Vfr.missingOper,!0,a.label):a})})),(0,Qn.opt)(Fi.parseRightParen,void 0),Fi.parseCharIndex)}var Jfr=(0,Qn.apply)(l1e(PP),function(e,r){var n=r[0],a=r[1],o=r[2],u=r[3];return(0,h3.argsTerm)(a,o!==void 0,n.start,u)}),Xfr=(0,Qn.apply)(l1e((0,Qn.any)((0,Qn.lazy)(function(){return nS.parseSpParam}),PP)),function(e,r){var n=r[0],a=r[1],o=r[2],u=r[3];return(0,h3.lambdaArgsTerm)(a,o!==void 0,n.start,u)}),Zfr=(0,Qn.take)(function(e,r){return r.kind===Zu.TokenKind.Operator&&(r.value===qq.OperatorId.Percent||r.value===qq.OperatorId.Pound)?r:void 0});function $fr(e,r){return r.kind===Zu.TokenKind.Sep&&r.value===Zu.SepId.List&&e.delim.listSep===$u.ListSep.Union?(0,Zu.operatorToken)(r.start,e.localeInfo.listSeparator,qq.OperatorId.Union):void 0}var epr=(0,Qn.take)(function(e,r){return r.kind===Zu.TokenKind.Operator||(0,Fi.isDotSepToken)(r)?r:$fr(e,r)}),rpr=(0,Qn.many)((0,Qn.take)(function(e,r){return(0,Fi.isWhitespaceToken)(r)?r:void 0})),o1e=(0,Qn.any)((0,Qn.concat)((0,Qn.bind)((0,Qn.any)(Yfr,Zfr),function(e,r){var n=(0,h3.isWSFNode)(e.localeInfo,r);return(n==null?void 0:n.id)===qq.WorksheetFuncId.LAMBDA?(0,Qn.concat)((0,Qn.parseSucceed)([r]),(0,Qn.opt)((0,Qn.tuple)(Xfr),[])):(0,Qn.parseSucceed)([r])}),(0,Qn.many)((0,Qn.any)(Jfr,u1e.parseFieldRef,s1e.parseStructRef))),(0,Qn.tuple)(epr)),npr=(0,Qn.flatten)((0,Qn.many1)(o1e,(0,Qn.concat)(rpr,o1e)));nS.parseFormula=(0,Qn.apply)((0,Qn.tuple)((0,Qn.opt)(npr,void 0),Fi.parseCharIndex),function(e,r){var n=r[0],a=r[1];if(n==null){var o=(0,$u.addSpan)(e,a,a,"","");return(0,rc.missingNode)("",o)}var u=n;return u.push((0,Zu.endToken)(a)),(0,h3.runOperatorPrecedenceParser)(e,u)});function tpr(e,r,n,a,o,u,t,d){var s,c=d.length-1;if(c<0){var l="calc.parse.runTokenParser: internal error: expected at least 1 token";return(0,v3.assertFalse)(l)}if(d[c].kind!==Zu.TokenKind.End){var l="calc.parse.runTokenParser: internal error: array[n] !== End in ".concat((0,r1e.anonymize)(d));return(0,v3.assertFalse)(l)}var f=(0,$u.makeState)(e,r,n,a,o),p=(0,Qn.runParser)(PP,d,0,f);if(!(0,n1e.isSuccess)(p)||p.value.index<c){var m=(0,n1e.isSuccess)(p)?p.value.index:0,l="calc.parse.runTokenParser: internal error: consumed ".concat(m," out of ").concat(c," in ").concat((0,r1e.anonymize)(d));return(0,v3.assertFalse)(l)}var v=p.value.output,h=f.spans,S=(0,qfr.buildAnnotations)(e,v,u,t===void 0?void 0:(s={},s[Bq.SyntaxFeature.Comments]=t[Bq.SyntaxFeature.Comments]===!0,s[Bq.SyntaxFeature.Statements]=t[Bq.SyntaxFeature.Statements]===!0,s));return(0,rc.formula)(v,h,S)}nS.runFormulaParser=tpr;var apr=Ufr.codePoint.codePointFullStop;function ipr(e,r){if(!e.localeInfo.isIdentStart((0,t1e.stringCodePointAt)(r,0))||!(0,t1e.codePointIterator)(r).every(function(o){return o===apr||e.localeInfo.isIdentContinue(o)}))return!1;var n=(0,Gfr.parseCellRef)(e.localeInfo,e.refStyle,e.origin,r,0);if(n!==void 0&&n.i===r.length){var a=n.refStyle===rc.RefStyle.A1?(0,Zu.cellRefA1Token)(0,r,n.row,n.col):(0,Zu.cellRefR1C1Token)(0,r,n.row,n.col,n.enLocale);if((0,Uq.isCompleteCellRefToken)(e,a))return!1}return!0}var opr=(0,Qn.apply)((0,Qn.many1)((0,Qn.take)(function(e,r){return r.isIdentContinue||(0,Fi.isDotSepToken)(r)?r:void 0})),function(e,r){var n=r[0].start,a=r.map(function(u){return u.chars}).join(""),o=(0,$u.addSpan)(e,n,n+a.length,"","");return ipr(e,a)?(0,rc.identNode)(a,o):(0,rc.badCharsNode)(rc.BadType.ParamName,a,o)}),upr=(0,Qn.applyTake)((0,Qn.tuple)(Fi.parseCharIndex,Fi.parseLeftBracket,Fi.parseCharIndex,Fi.parseSpacesOnly,(0,Qn.opt)(opr,void 0),Fi.parseSpacesOnly,Fi.parseCharIndex,(0,Qn.opt)(Fi.parseRightBracket,void 0),Fi.parseCharIndex),function(e,r){var n=r[0],a=r[1],o=r[2],u=r[3],t=r[4],d=r[5],s=r[6],c=r[7],l=r[8];if(t!==void 0){var f=(0,$u.getNodeSpan)(e,t);f.pre=u,f.post=d}var p=t??(0,rc.missingNode)(u+d,(0,$u.addSpan)(e,o,s,"",""));return(0,rc.paramName)(p,!0,c!==void 0,(0,$u.addSpan)(e,n,l,"",""))}),spr=(0,Qn.lazy)(function(){return(0,Gq.isFeatureEnabled)(Gq.FeatureName.CalcLambdaOptionalParameters)?upr:(0,Qn.parseFail)()}),lpr=(0,Qn.applyTake)((0,Qn.tuple)(Fi.parseCharIndex,Uq.parseRef,Fi.parseCharIndex),function(e,r){var n=r[0],a=r[1],o=r[2],u=a.kind===h3.TermKind.MaybeWSFTerm?a.node:a;if((0,Kfr.isUnqualifiedNameNode)(u))return(0,rc.paramName)((0,rc.identNode)(u.whole,u.label),!1,!0,(0,$u.addSpan)(e,n,o,"",""))}),cpr=(0,Qn.apply)((0,Qn.tuple)(Fi.parseWhitespace,Fi.parseCharIndex,Fi.parseAssignToken,Fi.parseWhitespace,(0,Qn.lazy)(function(){return nS.parseFormula}),Fi.parseCharIndex),function(e,r){var n,a=r[0],o=r[1],u=r[2],t=r[3],d=r[4],s=r[5],c=(0,$u.getNodeSpan)(e,d);return n=(0,$u.addWhitespace)(e,t),c.pre=n[0],c.preComments=n[1],(0,rc.paramDefault)(d,(0,$u.addSpan)(e,o,s,a,""))}),dpr=(0,Qn.lazy)(function(){return(0,Gq.isFeatureEnabled)(Gq.FeatureName.CalcLambdaDefaultParameters)?cpr:(0,Qn.parseFail)()});nS.parseSpParam=(0,Qn.applyTake)((0,Qn.tuple)(Fi.parseWhitespace,Fi.parseCharIndex,(0,Qn.bind)((0,Qn.any)(lpr,spr),function(e,r){return r.isClosed?(0,Qn.apply)((0,Qn.opt)(dpr,void 0),function(n,a){return[r,a]}):(0,Qn.parseSucceed)([r,void 0])}),Fi.parseCharIndex,Fi.parseWhitespace,(0,Qn.peek)(function(e,r){return r})),function(e,r){var n=r[0],a=r[1],o=r[2],u=o[0],t=o[1],d=r[3],s=r[4],c=r[5];if(t!==void 0||c.kind===Zu.TokenKind.End&&u.isBracketed||(0,Fi.isListSepToken)(c)&&u.isClosed)return(0,rc.paramNode)(u,t,(0,$u.addSpan)(e,a,d,n,s))})});var Kq=Y(nc=>{"use strict";_();Object.defineProperty(nc,"__esModule",{value:!0});nc.values=nc.stringStartsWith=nc.stringEndsWith=nc.repeat=nc.prependErrorMessage=nc.partialArray=nc.messageFromError=nc.mathLog2=nc.isInteger=nc.arrayFill=void 0;var R1=Cn();nc.arrayFill=R1.util.arrayFill;nc.isInteger=R1.util.isInteger;nc.mathLog2=R1.util.mathLog2;nc.messageFromError=R1.util.messageFromError;nc.partialArray=R1.util.partialArray;nc.prependErrorMessage=R1.util.prependErrorMessage;nc.repeat=R1.util.repeat;nc.stringEndsWith=R1.util.stringEndsWith;nc.stringStartsWith=R1.util.stringStartsWith;nc.values=R1.util.values});var g1e=Y(bR=>{"use strict";_();Object.defineProperty(bR,"__esModule",{value:!0});bR.parseResultHelper=bR.ExtractLetVisitor=bR.CaretInsideArrayNodeIdentityVisitor=void 0;var Vq=br(),OX=um(),es=wp(),S3=UJ(),fpr=_R(),y3=lg(),E0=gq(),c1e=C2(),d1e=Kq(),ppr=CC(),mpr=g1(),gpr=Ql(),f1e=function(e){Vq.__extends(r,e);function r(n,a){var o=e.call(this)||this;return o.parsedFormulaTree=n,o.caretPosition=a,o.isInsideArrayNode=!1,o.autoCompleteFixForArrayNodesEnabled=(0,gpr.isChangeGateEnabled)("OfficeVSO:7896479_autoCompleteFixForArrayNodesEnabled"),o}return r.prototype.arrayNode=function(n,a,o){var u=e.prototype.arrayNode.call(this,n,a,o);return this.autoCompleteFixForArrayNodesEnabled&&this.caretInNode(u)&&(this.isInsideArrayNode=!0),u},r.prototype.caretInNode=function(n){if(n===void 0)return!1;var a=this.parsedFormulaTree.spans[n.label];return a!==void 0&&this.caretPosition>=a.start&&this.caretPosition<=a.end},r}(E0.IdentityVisitor);bR.CaretInsideArrayNodeIdentityVisitor=f1e;function MC(e,r){var n=e[r];return(0,OX.assertTrue)("ParseResultHelper.getFormulaSpan: expected span to be defined",n!==void 0),n}var p1e=function(e){Vq.__extends(r,e);function r(n,a){var o=e.call(this,n,a)||this;return o.references=[],o}return r.prototype.letNode=function(n,a,o,u,t,d){if(this.caretInNode(o==null?void 0:o.arg))this.pushNames(a);else for(var s=0;s<a.length;s+=1){var c=a[s].binder;if(this.caretInNode(c.arg)){this.pushNames(n.id===fpr.WorksheetFuncId.LET?a.slice(0,s):a);break}}return e.prototype.letNode.call(this,n,a,o,u,t,d)},r.prototype.lambdaNode=function(n,a,o,u,t,d){if(this.caretInNode(o==null?void 0:o.arg))this.pushNames(a);else for(var s=0;s<a.length;s+=1){var c=a[s].name;if(c.arg.def!==void 0&&this.caretInNode(c.arg.def.rhs)){this.pushNames(a.slice(0,s));break}}return e.prototype.lambdaNode.call(this,n,a,o,u,t,d)},r.prototype.pushNames=function(n){(0,c1e.safePush)(this.references,n.map(function(a){var o=a.name;return o.arg.wholeName}).filter(c1e.isDefined).reverse())},r}(f1e);bR.ExtractLetVisitor=p1e;function vpr(e,r){if((0,y3.isSuccess)(e))try{var n=new p1e(e.value,r);return(0,E0.reduceBottomUp)(n,e.value),n.references.reverse()}catch(o){var a="ParseResultHelper.extractLetVariables: unhandled error ".concat((0,d1e.messageFromError)(o));return OX.ulsLogger.ULS.traceTag(540645343,S3.LogCategory.msoulscat_ES_EWAJS,S3.TraceLevel.Warning,a),[]}}function hpr(e,r,n,a,o){if(n===void 0&&(n=!1),!!(0,y3.isSuccess)(e)){var u=[];return m1e(e,["range","namedRange","letName","literal","function","structRefRange"],function(t,d){var s=MC(e.value.spans,d.label),c={kind:t,ref:d,span:s};u.push(c)},r,n,a,o),u.sort(function(t,d){var s;return(s=t.span.start-d.span.start)!==0||(s=d.span.end-t.span.end)!==0?s:0}),u}}function m1e(e,r,n,a,o,u,t){if(o===void 0&&(o=!1),!(0,y3.isSuccess)(e))return!1;try{Spr(e.value,a??(0,S3.getEnglishLocaleInfo)(),r,n,o,u,t)}catch(s){var d="ParseResultHelper.traverse: unhandled error ".concat((0,d1e.messageFromError)(s));OX.ulsLogger.ULS.traceTag(540645344,S3.LogCategory.msoulscat_ES_EWAJS,S3.TraceLevel.Warning,d)}return!0}bR.parseResultHelper={isSuccess:y3.isSuccess,traverse:m1e,extractReferences:hpr,extractLetVariables:vpr};function Spr(e,r,n,a,o,u,t){if(e==null||a==null)return;var d={};C();var s={};{var c=0,l=[],f=Vq.__assign(Vq.__assign({},E0.voidVisitor),{letNode:function(k,x,G,H,L,D){for(var U=0,V=x;U<V.length;U++){var ne=V[U].name;s[ne.arg.label]=c}l.push({letCount:c,span:MC(e.spans,D)}),c+=1},lambdaNode:function(k,x,G,H,L,D){for(var U=0,V=x;U<V.length;U++){var ne=V[U].name;s[ne.arg.label]=c}l.push({letCount:c,span:MC(e.spans,D)}),c+=1}});(0,E0.reduceBottomUp)(f,e),l.sort(function(B,k){return B.span.start-k.span.start});for(var p={},m=0;m<l.length;m+=1)p[l[m].letCount]=m;for(var v=0,h=Object.keys(s).map(Number);v<h.length;v++){var S=h[v];s[S]=p[s[S]]}}var y={literalNode:function(k,x,G){var H=E0.identityVisitor.literalNode(k,x,G);return E("literal")&&a("literal",{label:G,value:H,valueKind:k.kind}),H},missingNode:function(k,x){var G=E0.identityVisitor.missingNode(k,x);return E("literal")&&a("literal",{label:x,value:(0,es.literalNode)(mpr.missingOper,!0,x),valueKind:ppr.OperKind.Missing}),G},arrayNode:function(k,x,G){return E0.identityVisitor.arrayNode(k,x,G)},appNode:function(k,x,G,H){var L=E0.identityVisitor.appNode(k,x,G,H);return w(k,x,G,H),L},letNode:function(k,x,G,H,L,D){var U=(0,es.letNode)(k,x,G,H,L,D);w(k,U.args,L,D);for(var V=0,ne=x;V<ne.length;V++){var J=ne[V].name;E("letName")&&a("letName",{label:J.arg.label,name:J.arg.wholeName,number:s[J.arg.label],qualifier:void 0})}return U},lambdaNode:function(k,x,G,H,L,D){var U=(0,es.lambdaNode)(k,x,G,H,L,D);w(k,U.args,L,D);for(var V=0,ne=x;V<ne.length;V++){var J=ne[V].name;E("letName")&&a("letName",{label:J.arg.name.name.label,name:J.arg.wholeName,number:s[J.arg.label],qualifier:void 0})}return U},parenNode:function(k,x,G){return E0.identityVisitor.parenNode(k,x,G)},nameNode:function(k,x,G){var H=(0,es.nameNode)(k,x,G),L=e.annotations[k.label],D=e.annotations[G];if((D==null?void 0:D.kind)!==es.AnnotationKind.AppHeadName){if((L==null?void 0:L.kind)===es.AnnotationKind.LocalNameUse){var U=s[L.label];E("letName")&&U!=null&&a("letName",{label:G,name:L.name,number:U,qualifier:void 0})}else if(E("namedRange")){var V=H.whole.split(".");a("namedRange",{label:G,name:V[0],names:V.slice(1),qualifier:I(H)})}}return H},cellRefNode:function(k,x,G){var H=(0,es.cellRefNode)(k,x,G);return E("range")&&F(H),H},fieldRefNode:function(k,x,G,H){return E0.identityVisitor.fieldRefNode(k,x,G,H)},structRefNode:function(k,x,G){var H=(0,es.structRefNode)(k,x,G);if(E("structRefRange")){if(t==null||u==null)return H;var L=t.resolveStructRef(u,H).resolution;if(!(0,y3.isSuccess)(L)||L.value===void 0)return H;var D=L.value;a("structRefRange",{label:G,type:"range",top:(0,es.pos)(es.PosKind.Rel,D.range.row),left:(0,es.pos)(es.PosKind.Rel,D.range.col),bottom:(0,es.pos)(es.PosKind.Rel,D.range.row+D.range.rows-1),right:(0,es.pos)(es.PosKind.Rel,D.range.col+D.range.cols-1),span:MC(e.spans,G),qualifier:k!==void 0?I(k):void 0,name:k!==void 0?k.whole:void 0})}return H},badSequenceNode:function(k,x,G){return E0.identityVisitor.badSequenceNode(k,x,G)},badCharsNode:function(k,x,G){return E0.identityVisitor.badCharsNode(k,x,G)},operatorNode:function(k,x){return E0.identityVisitor.operatorNode(k,x)},wsfNode:function(k,x,G){return E0.identityVisitor.wsfNode(k,x,G)}};(0,E0.reduceBottomUp)(y,e);function C(){n!=null?n.forEach(function(B){d[B]=!0}):d["*"]=!0}function E(B){return d[B]||d["*"]}function I(B){if(B.qualifier!=null){var k={};switch(B.qualifier.kind){case es.QualifierKind.Sheet:var x=B.qualifier;k.type="Sheet",k.sheet=x.sheet,x.document!=null&&(k.document=x.document.document,x.document.path!=null&&(k.documentPath=x.document.path));break;case es.QualifierKind.SheetRange:var G=B.qualifier;k.type="SheetRange",k.sheet1=G.sheet1,k.sheet2=G.sheet2,G.document!=null&&(k.document=G.document.document,G.document.path!=null&&(k.documentPath=G.document.path));break;case es.QualifierKind.Ident:var H=B.qualifier;k.type="Ident",k.name=H.name;break;case es.QualifierKind.Document:var L=B.qualifier;k.type="Document",k.document=L.document,L.path!=null&&(k.documentPath=L.path);break;default:break}return k}}function F(B){if(!(e==null||a==null))switch(B.ref.kind){case es.CellRefKind.Error:break;case es.CellRefKind.Col:var k=B.ref;a("range",{label:B.label,type:"col",startIndex:k.col1,endIndex:k.col2,span:MC(e.spans,k.label),qualifier:I(B)});break;case es.CellRefKind.Row:var x=B.ref;a("range",{label:B.label,type:"row",startIndex:x.row1,endIndex:x.row2,span:MC(e.spans,x.label),qualifier:I(B)});break;case es.CellRefKind.Single:var G=B.ref;a("range",{label:B.label,type:"cell",row:G.row,col:G.col,span:MC(e.spans,G.label),qualifier:I(B)});break;case es.CellRefKind.Range:var H=B.ref;a("range",{label:B.label,type:"range",top:H.ref1.row,left:H.ref1.col,bottom:H.ref2.row,right:H.ref2.col,topLeftSpan:MC(e.spans,H.ref1.label),bottomRightSpan:MC(e.spans,H.ref2.label),qualifier:I(B)});break}}function w(B,k,x,G){if(a!=null)switch(B.kind){case es.NodeKind.Operator:E("operator")&&a("operator",{label:G,value:B.id});break;case es.NodeKind.WSF:case es.NodeKind.Name:E("function")&&a("function",{label:G,name:B.whole,isClosed:x,args:[]});break}}}});var v1e=Y(yv=>{"use strict";_();Object.defineProperty(yv,"__esModule",{value:!0});yv.parseUint=yv.parseSignedLiteral=yv.parseNumberLiteral=yv.isLineBreak=yv.isSpace=void 0;var C3=et();yv.isSpace=C3.literalParse.isSpace;yv.isLineBreak=C3.literalParse.isLineBreak;yv.parseNumberLiteral=C3.literalParse.parseNumberLiteral;yv.parseSignedLiteral=C3.literalParse.parseSignedLiteral;yv.parseUint=C3.literalParse.parseUint});var kX=Y(T1=>{"use strict";_();Object.defineProperty(T1,"__esModule",{value:!0});T1.scanEscapedWhile=T1.getEscapedSkip=T1.scanWhile=T1.makeProgressAsserter=void 0;var ypr=um(),Wq=hP(),Cpr=Kq();function _pr(e,r){var n=r-1;return function(a){if(a<=n){var o="".concat(e,": internal error: no progress made at index ").concat(a);return(0,ypr.assertFalse)(o)}n=a}}T1.makeProgressAsserter=_pr;function Rpr(e,r,n){for(var a=r;a<e.length&&n(e,a);)a+=(0,Wq.numCodeUnits)((0,Wq.stringCodePointAt)(e,a));return[e.substring(r,a),a]}T1.scanWhile=Rpr;function h1e(e,r,n,a,o){return n(e,r)?1:(0,Cpr.stringStartsWith)(e,a,r)&&r+a.length<e.length&&o(e,r+a.length)?2:0}T1.getEscapedSkip=h1e;function Tpr(e,r,n,a,o){for(var u=[],t=r,d=r;d<e.length;){var s=h1e(e,d,n,a,o);if(s===0)break;s===2&&(t!==d&&u.push(e.substring(t,d)),t=d+a.length,d+=a.length),d+=(0,Wq.numCodeUnits)((0,Wq.stringCodePointAt)(e,d))}return t!==d&&u.push(e.substring(t,d)),[u.join(""),d]}T1.scanEscapedWhile=Tpr});var LX=Y(Qq=>{"use strict";_();Object.defineProperty(Qq,"__esModule",{value:!0});Qq.tokenizeFormula=void 0;var R1e=um(),jr=vv(),FX=g1(),bpr=c3(),L2=v1e(),Ppr=C2(),IX=wp(),Cv=kX(),ip=hP(),wd=E2(),Uu=Kq(),S1e=Pq(),Epr=$h(),wX=wd.codePointAsterisk,T1e=wd.codePointAtSign,Hq=wd.codePointColon,DX=wd.codePointDoubleQuote,MX=wd.codePointExclamationMark,xX=wd.codePointHash,Npr=wd.codePointLeftParen,b1e=wd.codePointQuestionMark,Apr=wd.codePointRightParen,EP=wd.codePointSingleQuote,Opr=wd.codePointFullStop,kpr=wd.codePointDigitZero,jq=wd.codePointSlash,Fpr=wd.codePointMinusSign,y1e=wd.codePointSpace,Ipr=wd.codePointInvertedExclamationMark,Mpr=wd.codePointInvertedQuestionMark,wpr=wd.codePointLeftSingleQuotationMark,Dpr=wd.codePointRightSingleQuotationMark,_3;function xpr(e){if(!_3){_3=(0,Ppr.makeStringMap)();for(var r=0,n=Object.getOwnPropertyNames(P1e);r<n.length;r++){var a=n[r];_3[a.charCodeAt(0)]=!0}for(var o=0,u=Object.getOwnPropertyNames(E1e);o<u.length;o++){var t=u[o];_3[t.charCodeAt(0)]=!0}}return _3[e]===!0}var P1e={"+":jr.addOperatorToken,"-":jr.subOperatorToken,"*":jr.mulOperatorToken,"/":jr.divOperatorToken,"^":jr.powOperatorToken,"%":jr.percentOperatorToken,"&":jr.concatOperatorToken,"=":jr.eqOperatorToken,"<":jr.ltOperatorToken,">":jr.gtOperatorToken,":":jr.rangeOperatorToken,".":jr.dotSepToken,"@":jr.atOperatorToken,"#":jr.poundOperatorToken},E1e={"<>":jr.neOperatorToken,"<=":jr.leOperatorToken,">=":jr.geOperatorToken};function C1e(e,r,n){if(r<e.length-1){var a=E1e[e.substring(r,r+2)];if(a!=null)return(0,jr.appendToken)(2,a(r),n)}var o=P1e[e.charAt(r)];if(o!=null)return(0,jr.appendToken)(1,o(r),n);var u="calc.parse.tokenizeOperator: internal error: expected operator";return(0,R1e.assertFalse)(u)}function Lpr(e,r,n,a,o){var u=(0,L2.parseNumberLiteral)(e,r,n,a,!1,!1,!1);if(u!==void 0){var t=u.value,d=u.i,s=n.substring(a,d);return(0,jr.appendToken)(d-a,(0,jr.literalToken)(a,s,t??jr.badNumberOper,!0),o),d}}var Bpr=function(r,n){return r.charCodeAt(n)!==DX},qpr=function(r,n){return r.charCodeAt(n)===DX};function Upr(e,r,n){var a=(0,Cv.scanEscapedWhile)(e,r+1,Bpr,'"',qpr),o=a[0],u=a[1],t=e.substring(r,u+1);return u<e.length?(0,jr.appendToken)(u+1-r,(0,jr.literalToken)(r,t,(0,FX.stringOper)(o),!0),n):(0,jr.appendToken)(u-r,(0,jr.literalToken)(r,t,(0,FX.stringOper)(o),!1),n)}function Gpr(e,r,n,a){for(var o=1;o<e.errorNames.length;o+=1){var u=e.errorNames[o];if(u!=null){var t=r.substring(n,n+u.length);if(e.stringCompareCI(u,t)===0)return(0,jr.appendToken)(u.length,(0,jr.literalToken)(n,t,(0,FX.errorOper)(o)),a)}}for(var d=n+1,s=!1;d<r.length;){var c=(0,ip.stringCodePointAt)(r,d);if(d===n+1&&(c===Ipr||c===Mpr)){d+=1;continue}if(d>n+1&&(c===jq||c===Fpr||c===y1e)&&!s){s=!0,d+=1;continue}if(d>n+1&&c===Opr){d+=1;continue}if(d>n+1&&c===kpr){d+=1,d<r.length&&r.charCodeAt(d)===MX&&(d+=1);break}if(c===MX||c===b1e){d!==n+1&&(d+=1);break}if(e.isIdentContinue(c)&&!e.isNumeral(c)){d+=(0,ip.numCodeUnits)(c);continue}if(c===wpr||c===Dpr){d+=1;continue}break}for(;d>n+1&&r.charCodeAt(d-1)===y1e;)--d;if(d>n+1){var t=r.substring(n,d);return(0,jr.appendToken)(d-n,(0,jr.literalToken)(n,t,jr.badErrorOper),a)}}function Kpr(e,r,n,a){for(var o=1;o<e.specialRefNames.length;o+=1){var u=e.specialRefNames[o];if(u!=null){var t=r.substring(n,n+u.length);if(e.stringCompareCI(u,t)===0)return(0,jr.appendToken)(u.length,(0,jr.specialRefToken)(n,t,o),a)}}}function _1e(e,r,n){var a=r.charCodeAt(n);return!(0,L2.isSpace)(a)&&a!==EP&&a!==xX&&a!==Hq&&a!==T1e&&!(0,Uu.stringStartsWith)(r,e.listSeparator,n)&&!(0,Uu.stringStartsWith)(r,e.leftBracket,n)&&!(0,Uu.stringStartsWith)(r,e.rightBracket,n)}var N1e=function(r,n){return(0,L2.isSpace)((0,ip.stringCodePointAt)(r,n))},Vpr=function(r,n){return!(0,L2.isLineBreak)((0,ip.stringCodePointAt)(r,n))},Wpr=function(r,n){return!(n+1<r.length&&r.charCodeAt(n)===wX&&r.charCodeAt(n+1)===jq)};function jpr(e,r,n,a){for(var o=n,u=0,t=function(h,S){return _1e(e,h,S)},d=function(h,S){return!_1e(e,h,S)},s=(0,Cv.makeProgressAsserter)("calc.parse.tokenizeBracketedRef",o);o<r.length;){s(o);var c=(0,ip.stringCodePointAt)(r,o);if(a.length>0&&a[a.length-1].kind===jr.TokenKind.Escape&&d(r,o)){o=(0,jr.appendToken)((0,ip.numCodeUnits)(c),(0,jr.identToken)(o,(0,ip.stringFromCodePoint)(c)),a);continue}if(c===T1e){o=(0,jr.appendToken)(1,(0,jr.atOperatorToken)(o),a);continue}if(c===xX){var l=Kpr(e,r,o,a);if(l!=null){o=l;continue}}if(c===EP){o=(0,jr.appendToken)(1,(0,jr.escapeToken)(o,"'"),a);continue}if((0,Uu.stringStartsWith)(r,e.rightBracket,o)){if(o=(0,jr.appendToken)(e.rightBracket.length,(0,jr.rightBracketToken)(o,e.rightBracket),a),u-=1,u===0)return o;continue}if(t(r,o)){var f=(0,Cv.scanWhile)(r,o,t),p=f[0],l=f[1];o=(0,jr.appendToken)(l-o,(0,jr.identToken)(o,p),a);continue}if((0,L2.isSpace)(c)){var m=(0,Cv.scanWhile)(r,o,N1e),p=m[0],l=m[1];o=(0,jr.appendToken)(l-o,(0,jr.spacesToken)(o,p),a);continue}if(c===Hq){o=(0,jr.appendToken)(1,(0,jr.rangeOperatorToken)(o),a);continue}if((0,Uu.stringStartsWith)(r,e.listSeparator,o)){o=(0,jr.appendToken)(e.listSeparator.length,(0,jr.listSepToken)(o,e.listSeparator),a);continue}if((0,Uu.stringStartsWith)(r,e.leftBracket,o)&&u<2){o=(0,jr.appendToken)(e.leftBracket.length,(0,jr.leftBracketToken)(o,e.leftBracket),a),u+=1;continue}o=(0,jr.appendToken)((0,ip.numCodeUnits)(c),(0,jr.unexpectedToken)(o,(0,ip.stringFromCodePoint)(c)),a)}return o}function Hpr(e,r,n){var a=r.charCodeAt(n);return a!==EP&&a!==Hq&&a!==wX&&a!==b1e&&!(0,Uu.stringStartsWith)(r,e.leftBracket,n)&&!(0,Uu.stringStartsWith)(r,e.rightBracket,n)}function Qpr(e,r,n,a){for(var o=(0,jr.appendToken)(1,(0,jr.leftSQuoteToken)(n),a),u=function(m,v){return Hpr(e,m,v)},t=function(m,v){return m.charCodeAt(v)===EP},d=(0,Cv.makeProgressAsserter)("calc.parse.tokenizeQuotedQualifier",o);o<r.length;){d(o);var s=(0,ip.stringCodePointAt)(r,o);if(s===EP&&!(o+1<r.length&&r.charCodeAt(o+1)===EP))return(0,jr.appendToken)(1,(0,jr.rightSQuoteToken)(o),a);if(s===Hq){o=(0,jr.appendToken)(1,(0,jr.rangeOperatorToken)(o),a);continue}if((0,Uu.stringStartsWith)(r,e.leftBracket,o)){o=(0,jr.appendToken)(e.leftBracket.length,(0,jr.leftBracketToken)(o,e.leftBracket),a);continue}if((0,Uu.stringStartsWith)(r,e.rightBracket,o)){o=(0,jr.appendToken)(e.rightBracket.length,(0,jr.rightBracketToken)(o,e.rightBracket),a);continue}if((0,Cv.getEscapedSkip)(r,o,u,"'",t)>0){var c=(0,Cv.scanEscapedWhile)(r,o,u,"'",t),l=c[0],f=c[1];o=(0,jr.appendToken)(f-o,(0,jr.identToken)(o,l),a);continue}o=(0,jr.appendToken)((0,ip.numCodeUnits)(s),(0,jr.unexpectedToken)(o,(0,ip.stringFromCodePoint)(s)),a)}return o}function zpr(e,r,n,a,o,u){var t=(0,bpr.parseCellRef)(e,r,n,a,o);if(t!=null){var d=t.i,s=a.substring(d,o),c=t.refStyle===IX.RefStyle.A1?(0,jr.cellRefA1Token)(o,s,t.row,t.col):(0,jr.cellRefR1C1Token)(o,s,t.row,t.col,t.enLocale);return(0,jr.appendToken)(d-o,c,u)}}function Ypr(e,r,n,a){var o=a.length-1,u=a[o];if(u==null)return!0;if(u.kind===jr.TokenKind.Sep&&u.value===jr.SepId.Dot)return!1;if((0,Uu.stringStartsWith)(r,e.decimalSeparator,n)){for(;u!=null&&(0,Epr.isWhitespaceToken)(u);)u=a[--o];return u==null?!0:u.kind!==jr.TokenKind.Ident&&u.kind!==jr.TokenKind.CellRef&&u.kind!==jr.TokenKind.Right&&(u.kind!==jr.TokenKind.Literal||(0,jr.isNumberLikeOper)(u.oper))}return e.isNumeral((0,ip.stringCodePointAt)(r,n))}function Jpr(e,r,n,a,o,u,t){for(var d=[],s=[],c=u,l=(t==null?void 0:t[IX.SyntaxFeature.Comments])===!0,f=(t==null?void 0:t[IX.SyntaxFeature.Statements])===!0,p=!(0,Uu.stringStartsWith)(e.statementSeparator,e.columnSeparator)&&!(0,Uu.stringStartsWith)(e.statementSeparator,e.rowSeparator),m=!(0,Uu.stringStartsWith)(e.statementSeparator,e.listSeparator)&&!(0,Uu.stringStartsWith)(e.statementSeparator,e.decimalSeparator),v=(0,Cv.makeProgressAsserter)("calc.parse.tokenize",c);c<o.length;){v(c);var h=zpr(e,n,a,o,c,d);if(h!=null){c=h;continue}var S=(0,ip.stringCodePointAt)(o,c),y=s.length>0&&s[s.length-1].delim===jr.DelimId.Brace;if(Ypr(e,o,c,d)){var C=Lpr(e,r,o,c,d);if(C!=null){c=C;continue}}if(S===DX){c=Upr(o,c,d);continue}if(e.isIdentContinue(S)&&!(0,Uu.stringStartsWith)(o,e.listSeparator,c)&&!(y&&(0,Uu.stringStartsWith)(o,e.columnSeparator,c))&&!(y&&(0,Uu.stringStartsWith)(o,e.rowSeparator,c))){var E=(0,Cv.scanWhile)(o,c,function(J,$){return e.isIdentContinue((0,ip.stringCodePointAt)(J,$))}),I=E[0],F=E[1];c=(0,jr.appendToken)(F-c,(0,jr.identOrBooleanToken)(e,c,I),d);continue}if(S===xX){var w=Gpr(e,o,c,d);if(w!=null){c=w;continue}c=C1e(o,c,d);continue}if((0,L2.isSpace)(S)){var B=(0,Cv.scanWhile)(o,c,N1e),I=B[0],k=B[1];c=(0,jr.appendToken)(k-c,(0,jr.spacesToken)(c,I),d);continue}if(S===Npr){s.push({delim:jr.DelimId.Paren,lastParen:s.length,lastBrace:s.length>0?s[s.length-1].lastBrace:void 0}),c=(0,jr.appendToken)(1,(0,jr.leftParenToken)(c),d);continue}if(S===Apr){var x=s.length>0?s[s.length-1].lastParen:void 0;x!==void 0&&(s.length=x),c=(0,jr.appendToken)(1,(0,jr.rightParenToken)(c),d);continue}if((0,Uu.stringStartsWith)(o,e.leftBrace,c)){s.push({delim:jr.DelimId.Brace,lastParen:s.length>0?s[s.length-1].lastParen:void 0,lastBrace:s.length}),c=(0,jr.appendToken)(e.leftBrace.length,(0,jr.leftBraceToken)(c,e.leftBrace),d);continue}if((0,Uu.stringStartsWith)(o,e.rightBrace,c)){var G=s.length>0?s[s.length-1].lastBrace:void 0;G!==void 0&&(s.length=G),c=(0,jr.appendToken)(e.rightBrace.length,(0,jr.rightBraceToken)(c,e.rightBrace),d);continue}if((0,Uu.stringStartsWith)(o,e.leftBracket,c)){c=jpr(e,o,c,d);continue}if((0,Uu.stringStartsWith)(o,e.rightBracket,c)){c=(0,jr.appendToken)(e.rightBracket.length,(0,jr.rightBracketToken)(c,e.rightBracket),d);continue}if(y){if(f&&p&&(0,Uu.stringStartsWith)(o,e.statementSeparator,c))break;if((0,Uu.stringStartsWith)(o,e.columnSeparator,c)){c=(0,jr.appendToken)(e.columnSeparator.length,(0,jr.colSepToken)(c,e.columnSeparator),d);continue}if((0,Uu.stringStartsWith)(o,e.rowSeparator,c)){c=(0,jr.appendToken)(e.rowSeparator.length,(0,jr.rowSepToken)(c,e.rowSeparator),d);continue}}if(f&&(0,Uu.stringStartsWith)(o,e.statementSeparator,c)&&(m||s.length===0))break;if((0,Uu.stringStartsWith)(o,e.listSeparator,c)){c=(0,jr.appendToken)(e.listSeparator.length,(0,jr.listSepToken)(c,e.listSeparator),d);continue}if(S===MX){c=(0,jr.appendToken)(1,(0,jr.qualSepToken)(c),d);continue}if(S===EP){c=Qpr(e,o,c,d);continue}if(S===jq&&c+1<o.length&&l){var H=o.charCodeAt(c+1);if(H===jq){var L=(0,Cv.scanWhile)(o,c,Vpr),I=L[0],D=L[1];c=(0,jr.appendToken)(D-c,(0,jr.singleLineCommentToken)(c,I),d);continue}if(H===wX){var U=(0,Cv.scanWhile)(o,c+2,Wpr),I=U[0],V=U[1],ne=(0,Uu.stringStartsWith)(o,"*/",V);(0,R1e.assertTrue)("calc.parse.tokenize: /**/",ne||V===o.length),V+=ne?2:0,I="/*"+I+(ne?"*/":""),c=(0,jr.appendToken)(V-c,(0,jr.multiLineCommentToken)(c,I,ne),d);continue}}if(xpr(S)){if((0,Uu.stringStartsWith)(o,":=",c)&&(0,S1e.isFeatureEnabled)(S1e.FeatureName.CalcLambdaDefaultParameters)){c=(0,jr.appendToken)(2,(0,jr.assignSepToken)(c),d);continue}c=C1e(o,c,d);continue}c=(0,jr.appendToken)((0,ip.numCodeUnits)(S),(0,jr.unexpectedToken)(c,(0,ip.stringFromCodePoint)(S)),d)}return[d,c]}function Xpr(e,r,n,a){for(var o=e[r],u=r+1;u<e.length;u+=1){var t=e[u];if(t.kind!==n)break;o=a(o,t)}return[o,u]}function Zpr(e,r,n,a,o,u,t){for(var d=Jpr(e,r,n,a,o,u,t),s=d[0],c=d[1],l=[],f=0;f<s.length;){var p=s[f];if(p.kind===jr.TokenKind.Unexpected){var m=Xpr(s,f,jr.TokenKind.Unexpected,function(S,y){var C=S,E=y;return(0,jr.unexpectedToken)(C.start,C.chars+E.chars)}),v=m[0],h=m[1];l.push(v),f=h;continue}l.push(p),f+=1}return l.push((0,jr.endToken)(c)),l}Qq.tokenizeFormula=Zpr});var O1e=Y(Yq=>{"use strict";_();var B2;Object.defineProperty(Yq,"__esModule",{value:!0});Yq.createParser=void 0;var $pr=LX(),e0r=AX(),r0r=ZJ(),n0r=m1(),NP=lg(),zq=E2(),t0r=zq.codePointEqualsSign,a0r=zq.codePointPlusSign,i0r=zq.codePointMinusSign,o0r=zq.codePointAtSign,u0r=(B2={},B2[t0r]=1,B2[a0r]=0,B2[i0r]=0,B2[o0r]=-1,B2);function A1e(e,r,n,a){var o,u,t,d,s=(u=(o=r.config)===null||o===void 0?void 0:o.localeInfo)!==null&&u!==void 0?u:e.config.localeInfo,c=(d=(t=r.config)===null||t===void 0?void 0:t.refStyle)!==null&&d!==void 0?d:e.config.refStyle,l=e.config.mathpack,f=(0,$pr.tokenizeFormula)(s,l,c,r.originGridCell.value,n,a,r.syntaxFeatures),p=(0,e0r.runFormulaParser)(s,l,c,r.lexicalKind,r.originGridCell.value,r.contextNames,r.syntaxFeatures,f);return(0,NP.success)(p)}function s0r(e,r,n,a){a===void 0&&(a=0);try{var o=a>=0&&a<n.length?u0r[n.charCodeAt(a)]:void 0;return o==null?(0,NP.failure)((0,r0r.notFormulaString)("first character is not '=', '+', '-' or '@'")):o<0?(0,NP.failure)((0,n0r.notImplemented)(["Lotus 1-2-3 syntax"])):A1e(e,r,n,a+o)}catch(u){return(0,NP.failure)((0,NP.javaScriptError)(u))}}function l0r(e,r,n,a){a===void 0&&(a=0);try{return A1e(e,r,n,a)}catch(o){return(0,NP.failure)((0,NP.javaScriptError)(o))}}function c0r(e){return{parseFormula:function(n,a,o){return s0r(e,n,a,o)},parseFormulaExpression:function(n,a,o){return l0r(e,n,a,o)}}}Yq.createParser=c0r});var N0=Y(si=>{"use strict";_();Object.defineProperty(si,"__esModule",{value:!0});si.util=si.tokenizeFormulaModule=si.token=si.parseStructRefModule=si.parserState=si.parserService=si.parseResultHelperModule=si.parseRefModule=si.parser=si.parseQualifierModule=si.parseOperators=si.parseLiteralModule=si.parseFormulaModule=si.parseFieldRefModule=si.parseCommon=si.parseServiceTypes=si.analyzeServiceTypes=si.diagnostics=si.checker=si.autocorrect=si.analyzeService=si.PackageName=void 0;si.PackageName="excel-online-calc-syntax";si.analyzeService=Phe();si.autocorrect=zJ();si.checker=VJ();si.diagnostics=uq();si.analyzeServiceTypes=YJ();si.parseServiceTypes=ZJ();si.parseCommon=$h();si.parseFieldRefModule=kq();si.parseFormulaModule=AX();si.parseLiteralModule=bX();si.parseOperators=RP();si.parseQualifierModule=gX();si.parser=S1();si.parseRefModule=TX();si.parseResultHelperModule=g1e();si.parserService=O1e();si.parserState=NC();si.parseStructRefModule=NX();si.token=vv();si.tokenizeFormulaModule=LX();si.util=kX()});var AP=Y(b1=>{_();Object.defineProperty(b1,"__esModule",{value:!0});b1.parseLocals=b1.notFormulaString=b1.createParseGlobals=b1.ReasonKind=void 0;var Jq=N0(),d0r=Jq.parseServiceTypes.ReasonKind;b1.ReasonKind=d0r;var f0r=Jq.parseServiceTypes.createParseGlobals;b1.createParseGlobals=f0r;var p0r=Jq.parseServiceTypes.notFormulaString;b1.notFormulaString=p0r;var m0r=Jq.parseServiceTypes.parseLocals;b1.parseLocals=m0r});var Zq=Y(Xq=>{_();Object.defineProperty(Xq,"__esModule",{value:!0});Xq.createParser=void 0;var g0r=N0(),v0r=g0r.parserService.createParser;Xq.createParser=v0r});var ER=Y(PR=>{_();Object.defineProperty(PR,"__esModule",{value:!0});PR.parseResultHelper=PR.ExtractLetVisitor=PR.CaretInsideArrayNodeIdentityVisitor=void 0;var BX=N0(),h0r=BX.parseResultHelperModule.ExtractLetVisitor;PR.ExtractLetVisitor=h0r;var S0r=BX.parseResultHelperModule.CaretInsideArrayNodeIdentityVisitor;PR.CaretInsideArrayNodeIdentityVisitor=S0r;var y0r=BX.parseResultHelperModule.parseResultHelper;PR.parseResultHelper=y0r});var F1e=Y(R3=>{_();Object.defineProperty(R3,"__esModule",{value:!0});R3.parse=void 0;var $q=UX(AP()),C0r=UX(Zq()),_0r=UX(ER());function k1e(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,n=new WeakMap;return(k1e=function(o){return o?n:r})(e)}function UX(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var n=k1e(r);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(u!=="default"&&Object.prototype.hasOwnProperty.call(e,u)){var t=o?Object.getOwnPropertyDescriptor(e,u):null;t&&(t.get||t.set)?Object.defineProperty(a,u,t):a[u]=e[u]}return a.default=e,n&&n.set(e,a),a}var qX;R3.parse=qX;(function(e){e.createParseGlobals=$q.createParseGlobals,e.ReasonKind=$q.ReasonKind,e.parseLocals=$q.parseLocals,e.notFormulaString=$q.notFormulaString,e.createParser=C0r.createParser,e.parseResultHelper=_0r.parseResultHelper})(qX||(R3.parse=qX={}))});var OP=Y(dm=>{_();Object.defineProperty(dm,"__esModule",{value:!0});dm.summarizeFormulaDiagnostics=dm.staticPrecedents=dm.diagnostics=dm.createAnalyzeGlobals=dm.analyzeLocalsName=dm.analyzeLocalsGrid=void 0;var q2=N0(),R0r=q2.analyzeServiceTypes.analyzeLocalsGrid;dm.analyzeLocalsGrid=R0r;var T0r=q2.analyzeServiceTypes.analyzeLocalsName;dm.analyzeLocalsName=T0r;var b0r=q2.analyzeServiceTypes.createAnalyzeGlobals;dm.createAnalyzeGlobals=b0r;var P0r=q2.analyzeServiceTypes.diagnostics;dm.diagnostics=P0r;var E0r=q2.analyzeServiceTypes.summarizeFormulaDiagnostics;dm.summarizeFormulaDiagnostics=E0r;var N0r=q2.analyzeServiceTypes.staticPrecedents;dm.staticPrecedents=N0r});var U2=Y(eU=>{_();Object.defineProperty(eU,"__esModule",{value:!0});eU.createAnalyzer=void 0;var A0r=N0(),O0r=A0r.analyzeService.createAnalyzer;eU.createAnalyzer=O0r});var w1e=Y(T3=>{_();Object.defineProperty(T3,"__esModule",{value:!0});T3.analyze=void 0;var G2=M1e(OP()),k0r=M1e(U2());function I1e(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,n=new WeakMap;return(I1e=function(o){return o?n:r})(e)}function M1e(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var n=I1e(r);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(u!=="default"&&Object.prototype.hasOwnProperty.call(e,u)){var t=o?Object.getOwnPropertyDescriptor(e,u):null;t&&(t.get||t.set)?Object.defineProperty(a,u,t):a[u]=e[u]}return a.default=e,n&&n.set(e,a),a}var GX;T3.analyze=GX;(function(e){e.analyzeLocalsGrid=G2.analyzeLocalsGrid,e.analyzeLocalsName=G2.analyzeLocalsName,e.diagnostics=G2.diagnostics,e.summarizeFormulaDiagnostics=G2.summarizeFormulaDiagnostics,e.staticPrecedents=G2.staticPrecedents,e.createAnalyzeGlobals=G2.createAnalyzeGlobals,e.createAnalyzer=k0r.createAnalyzer})(GX||(T3.analyze=GX={}))});var K2=Y(tc=>{"use strict";_();Object.defineProperty(tc,"__esModule",{value:!0});tc.values=tc.stringStartsWith=tc.stringEndsWith=tc.repeat=tc.prependErrorMessage=tc.partialArray=tc.messageFromError=tc.mathLog2=tc.isInteger=tc.arrayFill=void 0;var P1=Cn();tc.arrayFill=P1.util.arrayFill;tc.isInteger=P1.util.isInteger;tc.mathLog2=P1.util.mathLog2;tc.messageFromError=P1.util.messageFromError;tc.partialArray=P1.util.partialArray;tc.prependErrorMessage=P1.util.prependErrorMessage;tc.repeat=P1.util.repeat;tc.stringEndsWith=P1.util.stringEndsWith;tc.stringStartsWith=P1.util.stringStartsWith;tc.values=P1.util.values});var KX=Y(La=>{"use strict";_();Object.defineProperty(La,"__esModule",{value:!0});La.valueErrorOper=La.trueOper=La.stringOper=La.refErrorOper=La.rangeSeqOper=La.range3DOper=La.precedents=La.numErrorOper=La.nullErrorOper=La.nameErrorOper=La.naErrorOper=La.missingOper=La.gettingDataErrorOper=La.spillErrorOper=La.fieldErrorOper=La.falseOper=La.errorOper=La.div0ErrorOper=La.cellStringLimit=La.booleanOper=La.blankOper=La.arrayOper=La.PrecsBound=La.ErrorType=void 0;var pl=et();La.ErrorType=pl.value.ErrorType;La.PrecsBound=pl.value.PrecsBound;La.arrayOper=pl.value.arrayOper;La.blankOper=pl.value.blankOper;La.booleanOper=pl.value.booleanOper;La.cellStringLimit=pl.value.cellStringLimit;La.div0ErrorOper=pl.value.div0ErrorOper;La.errorOper=pl.value.errorOper;La.falseOper=pl.value.falseOper;La.fieldErrorOper=pl.value.fieldErrorOper;La.spillErrorOper=pl.value.spillErrorOper;La.gettingDataErrorOper=pl.value.gettingDataErrorOper;La.missingOper=pl.value.missingOper;La.naErrorOper=pl.value.naErrorOper;La.nameErrorOper=pl.value.nameErrorOper;La.nullErrorOper=pl.value.nullErrorOper;La.numErrorOper=pl.value.numErrorOper;La.precedents=pl.value.precedents;La.range3DOper=pl.value.range3DOper;La.rangeSeqOper=pl.value.rangeSeqOper;La.refErrorOper=pl.value.refErrorOper;La.stringOper=pl.value.stringOper;La.trueOper=pl.value.trueOper;La.valueErrorOper=pl.value.valueErrorOper});var tS=Y(Nr=>{"use strict";_();Object.defineProperty(Nr,"__esModule",{value:!0});Nr.isSheetGridRangeEqual=Nr.isSheetGridRange=Nr.isSheetGridCellEqual=Nr.isSheetGridCell=Nr.isRichOper=Nr.isReadOperEqual=Nr.isRangeOper=Nr.isRangeOpNoMissing=Nr.isRangeOpClosed=Nr.isPrimitiveOper=Nr.isOperatorNode=Nr.isNumberOper=Nr.isNumberLiteralNode=Nr.isNameScopeEqual=Nr.isMissingOper=Nr.isMissingNode=Nr.isGridRangeEqual=Nr.isGridCellEqual=Nr.isGridCell=Nr.isErrorOper=Nr.isDocumentLocEqual=Nr.isCommaOpRefWellFormed=Nr.isCommaOpNoBadOrMissing=Nr.isCommaOpClosed=Nr.isBooleanOper=Nr.isBooleanLiteralNode=Nr.isBlankOper=Nr.isArrayOper=Nr.internal=Nr.gridRangesJoin=Nr.gridRangeSize=Nr.gridRangeJoinOpt=Nr.gridRangeJoin=Nr.gridRangeIsects=Nr.gridRangeIsect=Nr.gridRangeExcept=Nr.gridRangeCompare=Nr.gridRangeAnchor=Nr.gridCellRange=Nr.gridCellImplicitIsect=Nr.getWorksheetFuncId=Nr.getUserDefinedFuncName=Nr.getBoundName=Nr.getArguments=Nr.getArgType=Nr.forEachTileInRange=Nr.forEachCellInRange=Nr.createFailureErrorClass=Nr.ReasonKind=Nr.LangReasonKind=void 0;Nr.applyComparison=Nr.unavailable=Nr.shouldFieldRefBeBracketed=Nr.sheetGridRangeAnchor=Nr.notImplemented=Nr.normalizeCommaOpRef=Nr.isWriteOper=Nr.isWellFormed=Nr.isWSFNode=Nr.isValidArgsLength=Nr.isUnqualifiedNameNode=Nr.isStringOper=Nr.isSheetIndexEqual=Nr.isSheetIndex=void 0;var kt=et();Nr.LangReasonKind=kt.util.LangReasonKind;Nr.ReasonKind=kt.util.ReasonKind;Nr.createFailureErrorClass=kt.util.createFailureErrorClass;Nr.forEachCellInRange=kt.util.forEachCellInRange;Nr.forEachTileInRange=kt.util.forEachTileInRange;Nr.getArgType=kt.util.getArgType;Nr.getArguments=kt.util.getArguments;Nr.getBoundName=kt.util.getBoundName;Nr.getUserDefinedFuncName=kt.util.getUserDefinedFuncName;Nr.getWorksheetFuncId=kt.util.getWorksheetFuncId;Nr.gridCellImplicitIsect=kt.util.gridCellImplicitIsect;Nr.gridCellRange=kt.util.gridCellRange;Nr.gridRangeAnchor=kt.util.gridRangeAnchor;Nr.gridRangeCompare=kt.util.gridRangeCompare;Nr.gridRangeExcept=kt.util.gridRangeExcept;Nr.gridRangeIsect=kt.util.gridRangeIsect;Nr.gridRangeIsects=kt.util.gridRangeIsects;Nr.gridRangeJoin=kt.util.gridRangeJoin;Nr.gridRangeJoinOpt=kt.util.gridRangeJoinOpt;Nr.gridRangeSize=kt.util.gridRangeSize;Nr.gridRangesJoin=kt.util.gridRangesJoin;Nr.internal=kt.util.internal;Nr.isArrayOper=kt.util.isArrayOper;Nr.isBlankOper=kt.util.isBlankOper;Nr.isBooleanLiteralNode=kt.util.isBooleanLiteralNode;Nr.isBooleanOper=kt.util.isBooleanOper;Nr.isCommaOpClosed=kt.util.isCommaOpClosed;Nr.isCommaOpNoBadOrMissing=kt.util.isCommaOpNoBadOrMissing;Nr.isCommaOpRefWellFormed=kt.util.isCommaOpRefWellFormed;Nr.isDocumentLocEqual=kt.util.isDocumentLocEqual;Nr.isErrorOper=kt.util.isErrorOper;Nr.isGridCell=kt.util.isGridCell;Nr.isGridCellEqual=kt.util.isGridCellEqual;Nr.isGridRangeEqual=kt.util.isGridRangeEqual;Nr.isMissingNode=kt.util.isMissingNode;Nr.isMissingOper=kt.util.isMissingOper;Nr.isNameScopeEqual=kt.util.isNameScopeEqual;Nr.isNumberLiteralNode=kt.util.isNumberLiteralNode;Nr.isNumberOper=kt.util.isNumberOper;Nr.isOperatorNode=kt.util.isOperatorNode;Nr.isPrimitiveOper=kt.util.isPrimitiveOper;Nr.isRangeOpClosed=kt.util.isRangeOpClosed;Nr.isRangeOpNoMissing=kt.util.isRangeOpNoMissing;Nr.isRangeOper=kt.util.isRangeOper;Nr.isReadOperEqual=kt.util.isReadOperEqual;Nr.isRichOper=kt.util.isRichOper;Nr.isSheetGridCell=kt.util.isSheetGridCell;Nr.isSheetGridCellEqual=kt.util.isSheetGridCellEqual;Nr.isSheetGridRange=kt.util.isSheetGridRange;Nr.isSheetGridRangeEqual=kt.util.isSheetGridRangeEqual;Nr.isSheetIndex=kt.util.isSheetIndex;Nr.isSheetIndexEqual=kt.util.isSheetIndexEqual;Nr.isStringOper=kt.util.isStringOper;Nr.isUnqualifiedNameNode=kt.util.isUnqualifiedNameNode;Nr.isValidArgsLength=kt.util.isValidArgsLength;Nr.isWSFNode=kt.util.isWSFNode;Nr.isWellFormed=kt.util.isWellFormed;Nr.isWriteOper=kt.util.isWriteOper;Nr.normalizeCommaOpRef=kt.util.normalizeCommaOpRef;Nr.notImplemented=kt.util.notImplemented;Nr.sheetGridRangeAnchor=kt.util.sheetGridRangeAnchor;Nr.shouldFieldRefBeBracketed=kt.util.shouldFieldRefBeBracketed;Nr.unavailable=kt.util.unavailable;Nr.applyComparison=kt.util.applyComparison});var V2=Y(Ra=>{"use strict";_();Object.defineProperty(Ra,"__esModule",{value:!0});Ra.now=Ra.mapFromArrayOfPairs=Ra.singleton=Ra.typedInstanceCreator=Ra.makeStringCompareCI=Ra.fastAbs=Ra.fastMax=Ra.fastMin=Ra.pair=Ra.filterOutNones=Ra.isNone=Ra.isDefined=Ra.safeConcat=Ra.safePush=Ra.strEnumArray=Ra.numEnumMap=Ra.numEnumArray=Ra.cloneStringMap=Ra.makeStringMap=Ra.identity=Ra.staticAssertIsOptional=Ra.staticAssertIs=Ra.staticAssertSame=Ra.staticAssertExtends=Ra.makeNewtypeIso=void 0;var js=Cn();Ra.makeNewtypeIso=js.core.makeNewtypeIso;Ra.staticAssertExtends=js.core.staticAssertExtends;Ra.staticAssertSame=js.core.staticAssertSame;Ra.staticAssertIs=js.core.staticAssertIs;Ra.staticAssertIsOptional=js.core.staticAssertIsOptional;Ra.identity=js.core.identity;Ra.makeStringMap=js.core.makeStringMap;Ra.cloneStringMap=js.core.cloneStringMap;Ra.numEnumArray=js.core.numEnumArray;Ra.numEnumMap=js.core.numEnumMap;Ra.strEnumArray=js.core.strEnumArray;Ra.safePush=js.core.safePush;Ra.safeConcat=js.core.safeConcat;Ra.isDefined=js.core.isDefined;Ra.isNone=js.core.isNone;Ra.filterOutNones=js.core.filterOutNones;Ra.pair=js.core.pair;Ra.fastMin=js.core.fastMin;Ra.fastMax=js.core.fastMax;Ra.fastAbs=js.core.fastAbs;Ra.makeStringCompareCI=js.core.makeStringCompareCI;Ra.typedInstanceCreator=js.core.typedInstanceCreator;Ra.singleton=js.core.singleton;Ra.mapFromArrayOfPairs=js.core.mapFromArrayOfPairs;Ra.now=js.core.now});var _v=Y(Lp=>{"use strict";_();Object.defineProperty(Lp,"__esModule",{value:!0});Lp.successUndefined=Lp.success=Lp.javaScriptError=Lp.isSuccess=Lp.failure=Lp.ResultKind=Lp.ReasonKind=void 0;var kP=Cn();Lp.ReasonKind=kP.result.ReasonKind;Lp.ResultKind=kP.result.ResultKind;Lp.failure=kP.result.failure;Lp.isSuccess=kP.result.isSuccess;Lp.javaScriptError=kP.result.javaScriptError;Lp.success=kP.result.success;Lp.successUndefined=kP.result.successUndefined});var E1=Y(Jr=>{"use strict";_();Object.defineProperty(Jr,"__esModule",{value:!0});Jr.evalFormatLocalsGrid=Jr.createFormatGlobals=Jr.NumberFormatSource=Jr.otherEdit=Jr.numberEdit=Jr.stringEdit=Jr.formulaEdit=Jr.EditKind=Jr.renderedValueToString=Jr.renderInfiniteWidth=Jr.memoizedRenderCallback=Jr.renderCallback=Jr.isHashesValue=Jr.renderedValue=Jr.formattedValue=Jr.hashesValue=Jr.formattedUnitFlexible=Jr.formattedUnitBlank=Jr.formattedUnitString=Jr.formattedUnitGeneral=Jr.FormattedUnitKind=Jr.Clip=Jr.GetTimeKind=Jr.Alignment=Jr.NamedColor=Jr.FormatCurrency=Jr.isFormatCultureEqual=Jr.isSystemCultureTag=Jr.CultureTag=Jr.BidiDate=Jr.FormatValueType=Jr.formatLocIFormat=Jr.formatLocKnownFormat=Jr.FormatLocKind=Jr.previousFormatFailure=Jr.aggregationError=Jr.fractionOverflow=Jr.dateOverflow=Jr.tooWide=Jr.noFormatPart=Jr.notFormatString=Jr.notValueString=Jr.ReasonKind=Jr.FormatReasonKind=void 0;var D1e=br(),L1e=tS(),F0r=V2(),x1e=_v(),B1e;(function(e){e.NotValueString="NotValueString",e.NotFormatString="NotFormatString",e.NoFormatPart="NoFormatPart",e.TooWide="TooWide",e.DateOverflow="DateOverflow",e.FractionOverflow="FractionOverflow",e.AggregationError="AggregationError",e.PreviousFormatFailure="PreviousFormatFailure"})(B1e=Jr.FormatReasonKind||(Jr.FormatReasonKind={}));Jr.ReasonKind=D1e.__assign(D1e.__assign({},L1e.LangReasonKind),B1e);function I0r(e){return{kind:Jr.ReasonKind.NotValueString,message:e}}Jr.notValueString=I0r;function M0r(e){return{kind:Jr.ReasonKind.NotFormatString,message:e}}Jr.notFormatString=M0r;Jr.noFormatPart={kind:Jr.ReasonKind.NoFormatPart};function w0r(e){return{kind:Jr.ReasonKind.TooWide,clip:e}}Jr.tooWide=w0r;Jr.dateOverflow={kind:Jr.ReasonKind.DateOverflow};Jr.fractionOverflow={kind:Jr.ReasonKind.FractionOverflow};Jr.aggregationError={kind:Jr.ReasonKind.AggregationError};function D0r(e){return{kind:Jr.ReasonKind.PreviousFormatFailure,format:e}}Jr.previousFormatFailure=D0r;var WX;(function(e){e.FormatString="FormatString",e.KnownFormat="KnownFormat",e.IFormat="IFormat"})(WX=Jr.FormatLocKind||(Jr.FormatLocKind={}));function x0r(e,r){return{kind:WX.KnownFormat,document:e,knownFormat:r}}Jr.formatLocKnownFormat=x0r;function L0r(e,r){return{kind:WX.IFormat,document:e,iformat:r}}Jr.formatLocIFormat=L0r;var B0r;(function(e){e.General="General",e.Number="Number",e.Currency="Currency",e.Accounting="Accounting",e.Date="Date",e.Time="Time",e.Percentage="Percentage",e.Fraction="Fraction",e.Scientific="Scientific",e.Text="Text",e.Custom="Custom"})(B0r=Jr.FormatValueType||(Jr.FormatValueType={}));var q0r;(function(e){e.English="English",e.Lunar="Lunar"})(q0r=Jr.BidiDate||(Jr.BidiDate={}));var VX;(function(e){e.SysDate="sysdate",e.SysTime="systime",e.Euro1="euro1",e.Euro2="euro2",e.GenLower="genlower",e.GenUpper="genupper",e.NomLower="nomlower",e.Bitcoin1="xbt1",e.Bitcoin2="xbt2",e.Gannen="gannen"})(VX=Jr.CultureTag||(Jr.CultureTag={}));function U0r(e){return e===VX.SysDate||e===VX.SysTime}Jr.isSystemCultureTag=U0r;function G0r(e,r){return e.culture===r.culture&&e.numberShape===r.numberShape&&e.nationalNumberInput===r.nationalNumberInput&&e.calendar===r.calendar&&e.localCalendarInput===r.localCalendarInput&&e.tag===r.tag}Jr.isFormatCultureEqual=G0r;var K0r;(function(e){e[e.LocaleInfo=0]="LocaleInfo"})(K0r=Jr.FormatCurrency||(Jr.FormatCurrency={}));var V0r;(function(e){e.Black="Black",e.White="White",e.Red="Red",e.Green="Green",e.Blue="Blue",e.Yellow="Yellow",e.Magenta="Magenta",e.Cyan="Cyan"})(V0r=Jr.NamedColor||(Jr.NamedColor={}));var q1e;(function(e){e.Left="Left",e.Center="Center",e.Right="Right"})(q1e=Jr.Alignment||(Jr.Alignment={}));var W0r;(function(e){e.ValueCell="ValueCell",e.Volatile="Volatile",e.NonVolatile="NonVolatile"})(W0r=Jr.GetTimeKind||(Jr.GetTimeKind={}));var U1e;(function(e){e[e.MaxChars=2]="MaxChars",e[e.CellWidth=4]="CellWidth",e[e.None=0]="None",e[e.All=6]="All"})(U1e=Jr.Clip||(Jr.Clip={}));var FP;(function(e){e.String="String",e.Blank="Blank",e.General="General",e.Flexible="Flexible"})(FP=Jr.FormattedUnitKind||(Jr.FormattedUnitKind={}));function j0r(e,r,n,a,o,u){return{kind:FP.General,num:e,decimalSeparator:r,includeSign:n,numberShape:a,expNumberShape:o,builtin:u}}Jr.formattedUnitGeneral=j0r;function H0r(e){return{kind:FP.String,str:e}}Jr.formattedUnitString=H0r;function Q0r(e){return{kind:FP.Blank,str:e}}Jr.formattedUnitBlank=Q0r;function z0r(e){return{kind:FP.Flexible,str:e}}Jr.formattedUnitFlexible=z0r;function jX(e,r,n,a){return{units:e,color:r,alignment:n,clip:a}}function Y0r(e,r){return jX(e,r,q1e.Center,U1e.All)}Jr.hashesValue=Y0r;Jr.formattedValue=jX;Jr.renderedValue=jX;function J0r(e){return!Array.isArray(e.units)}Jr.isHashesValue=J0r;function G1e(e,r,n){return{renderWidth:e,bestFit:n,getTextWidth:r}}Jr.renderCallback=G1e;function X0r(e){var r=(0,F0r.makeStringMap)(),n=function(o){if(r[o]!=null)return r[o];var u=e.getTextWidth(o);return r[o]=u,u};return G1e(e.renderWidth,n,e.bestFit)}Jr.memoizedRenderCallback=X0r;Jr.renderInfiniteWidth={renderWidth:1/0,bestFit:!1,getTextWidth:function(r){return r.length}};function Z0r(e){for(var r="",n=0,a=e.units;n<a.length;n++){var o=a[n];switch(o.kind){case FP.String:r+=o.str;break;case FP.Blank:for(var u=0;u<o.str.length;u+=1)r+=" ";break}}return r}Jr.renderedValueToString=Z0r;var b3;(function(e){e.Formula="Formula",e.String="String",e.Number="Number",e.Other="Other"})(b3=Jr.EditKind||(Jr.EditKind={}));function $0r(e){return{kind:b3.Formula,fmla:e}}Jr.formulaEdit=$0r;function emr(e,r){return{kind:b3.String,value:e,tick:r}}Jr.stringEdit=emr;function rmr(e,r){return{kind:b3.Number,value:e,format:r}}Jr.numberEdit=rmr;function nmr(e){return{kind:b3.Other,value:e}}Jr.otherEdit=nmr;var tmr;(function(e){e.Builtin="Builtin",e.CustomString="CustomString",e.CustomBytecode="CustomBytecode",e.System="System"})(tmr=Jr.NumberFormatSource||(Jr.NumberFormatSource={}));function amr(e,r){return{config:e,getTime:r}}Jr.createFormatGlobals=amr;function imr(e,r){var n=(0,L1e.sheetGridRangeAnchor)(e.range),a=(0,x1e.success)(n.range),o=(0,x1e.success)(n.sheet);return{config:r??void 0,lexicalSource:e,originGridCell:a,originSheet:o,allowUnqualifiedCell:!0,wrapCellReferences:!1}}Jr.evalFormatLocalsGrid=imr});var nU=Y(N1=>{"use strict";_();Object.defineProperty(N1,"__esModule",{value:!0});N1.parseUint=N1.parseSignedLiteral=N1.parseNumberLiteral=N1.isSpace=void 0;var rU=et();N1.isSpace=rU.literalParse.isSpace;N1.parseNumberLiteral=rU.literalParse.parseNumberLiteral;N1.parseSignedLiteral=rU.literalParse.parseSignedLiteral;N1.parseUint=rU.literalParse.parseUint});var A1=Y(Rv=>{"use strict";_();Object.defineProperty(Rv,"__esModule",{value:!0});Rv.NumberShape=Rv.KnownFormat=Rv.DateOrder=Rv.CurrencyFormat=Rv.Calendar=void 0;var P3=et();Rv.Calendar=P3.numfmt.Calendar;Rv.CurrencyFormat=P3.numfmt.CurrencyFormat;Rv.DateOrder=P3.numfmt.DateOrder;Rv.KnownFormat=P3.numfmt.KnownFormat;Rv.NumberShape=P3.numfmt.NumberShape});var W2=Y(Ct=>{"use strict";_();Object.defineProperty(Ct,"__esModule",{value:!0});Ct.ulsLogger=Ct.operatorIdToName=Ct.localeInfo=Ct.isNumeral=Ct.isIdentStart=Ct.isIdentContinue=Ct.getOrdinal=Ct.getNumberShape=Ct.getEnglishWorksheetFuncIdToName=Ct.getEnglishLocaleInfo=Ct.englishWorksheetFuncIdToName=Ct.englishSysTimeFormat=Ct.englishSysDateFormat=Ct.englishSpecialRefNames=Ct.englishPictureSpecial=Ct.englishPictureSingle=Ct.englishPictureDbnum=Ct.englishPictureColor=Ct.englishOperatorIdToName=Ct.englishErrorTypeToName=Ct.englishErrorNames=Ct.createWorksheetFuncNameCallbacks=Ct.calcConfig=Ct.TraceLevel=Ct.PictureSpecial=Ct.PictureSingle=Ct.PictureDbnum=Ct.PictureColor=Ct.NulLogger=Ct.LogCategory=Ct.LCID=Ct.Country=void 0;var Qo=et();Ct.Country=Qo.config.Country;Ct.LCID=Qo.config.LCID;Ct.LogCategory=Qo.config.LogCategory;Ct.NulLogger=Qo.config.NulLogger;Ct.PictureColor=Qo.config.PictureColor;Ct.PictureDbnum=Qo.config.PictureDbnum;Ct.PictureSingle=Qo.config.PictureSingle;Ct.PictureSpecial=Qo.config.PictureSpecial;Ct.TraceLevel=Qo.config.TraceLevel;Ct.calcConfig=Qo.config.calcConfig;Ct.createWorksheetFuncNameCallbacks=Qo.config.createWorksheetFuncNameCallbacks;Ct.englishErrorNames=Qo.config.englishErrorNames;Ct.englishErrorTypeToName=Qo.config.englishErrorTypeToName;Ct.englishOperatorIdToName=Qo.config.englishOperatorIdToName;Ct.englishPictureColor=Qo.config.englishPictureColor;Ct.englishPictureDbnum=Qo.config.englishPictureDbnum;Ct.englishPictureSingle=Qo.config.englishPictureSingle;Ct.englishPictureSpecial=Qo.config.englishPictureSpecial;Ct.englishSpecialRefNames=Qo.config.englishSpecialRefNames;Ct.englishSysDateFormat=Qo.config.englishSysDateFormat;Ct.englishSysTimeFormat=Qo.config.englishSysTimeFormat;Ct.englishWorksheetFuncIdToName=Qo.config.englishWorksheetFuncIdToName;Ct.getEnglishLocaleInfo=Qo.config.getEnglishLocaleInfo;Ct.getEnglishWorksheetFuncIdToName=Qo.config.getEnglishWorksheetFuncIdToName;Ct.getNumberShape=Qo.config.getNumberShape;Ct.getOrdinal=Qo.config.getOrdinal;Ct.isIdentContinue=Qo.config.isIdentContinue;Ct.isIdentStart=Qo.config.isIdentStart;Ct.isNumeral=Qo.config.isNumeral;Ct.localeInfo=Qo.config.localeInfo;Ct.operatorIdToName=Qo.config.operatorIdToName;Ct.ulsLogger=Qo.config.ulsLogger});var O1=Y(id=>{"use strict";_();Object.defineProperty(id,"__esModule",{value:!0});id.assertPositiveLength=id.assertPositiveInteger=id.assertInteger=id.assertIndex=id.assertNatural=id.assertNever=id.assertFalse=id.assertTrue=id.ulsLogger=void 0;var wC=Cn();id.ulsLogger=wC.assertions.ulsLogger;id.assertTrue=wC.assertions.assertTrue;id.assertFalse=wC.assertions.assertFalse;id.assertNever=wC.assertions.assertNever;id.assertNatural=wC.assertions.assertNatural;id.assertIndex=wC.assertions.assertIndex;id.assertInteger=wC.assertions.assertInteger;id.assertPositiveInteger=wC.assertions.assertPositiveInteger;id.assertPositiveLength=wC.assertions.assertPositiveLength});var tU=Y(bu=>{"use strict";_();Object.defineProperty(bu,"__esModule",{value:!0});bu.surrogatePairToCodePoint=bu.stringFromCodePoint=bu.stringCodePointAt=bu.scanCodePointsBack=bu.scanCodePoints=bu.numCodeUnits=bu.makeGetCharCodeBits=bu.isLowSurrogate=bu.isHighSurrogate=bu.isAnySurrogate=bu.forEachClassInterval=bu.countCodePoints=bu.codePointIterator=bu.CharCodeBits=void 0;var fm=Cn();bu.CharCodeBits=fm.unicode.CharCodeBits;bu.codePointIterator=fm.unicode.codePointIterator;bu.countCodePoints=fm.unicode.countCodePoints;bu.forEachClassInterval=fm.unicode.forEachClassInterval;bu.isAnySurrogate=fm.unicode.isAnySurrogate;bu.isHighSurrogate=fm.unicode.isHighSurrogate;bu.isLowSurrogate=fm.unicode.isLowSurrogate;bu.makeGetCharCodeBits=fm.unicode.makeGetCharCodeBits;bu.numCodeUnits=fm.unicode.numCodeUnits;bu.scanCodePoints=fm.unicode.scanCodePoints;bu.scanCodePointsBack=fm.unicode.scanCodePointsBack;bu.stringCodePointAt=fm.unicode.stringCodePointAt;bu.stringFromCodePoint=fm.unicode.stringFromCodePoint;bu.surrogatePairToCodePoint=fm.unicode.surrogatePairToCodePoint});var E3=Y(je=>{"use strict";_();Object.defineProperty(je,"__esModule",{value:!0});je.codePointExclamationMark=je.codePointEuroSign=je.codePointEqualsSign=je.codePointDoubleQuote=je.codePointDollarSign=je.codePointDigitZero=je.codePointDigitTwo=je.codePointDigitThree=je.codePointDigitSix=je.codePointDigitSeven=je.codePointDigitOne=je.codePointDigitNine=je.codePointDigitFour=je.codePointDigitFive=je.codePointDigitEight=je.codePointComma=je.codePointColon=je.codePointCircumflexAccent=je.codePointCapitalZ=je.codePointCapitalY=je.codePointCapitalX=je.codePointCapitalW=je.codePointCapitalV=je.codePointCapitalU=je.codePointCapitalT=je.codePointCapitalS=je.codePointCapitalR=je.codePointCapitalQ=je.codePointCapitalP=je.codePointCapitalO=je.codePointCapitalN=je.codePointCapitalM=je.codePointCapitalL=je.codePointCapitalK=je.codePointCapitalJ=je.codePointCapitalI=je.codePointCapitalH=je.codePointCapitalG=je.codePointCapitalF=je.codePointCapitalE=je.codePointCapitalD=je.codePointCapitalC=je.codePointCapitalB=je.codePointCapitalA=je.codePointCR=je.codePointBacktick=je.codePointBackslash=je.codePointAtSign=je.codePointAsterisk=je.codePointAmpersand=void 0;je.codePointSmallW=je.codePointSmallV=je.codePointSmallU=je.codePointSmallT=je.codePointSmallS=je.codePointSmallR=je.codePointSmallQ=je.codePointSmallP=je.codePointSmallO=je.codePointSmallN=je.codePointSmallM=je.codePointSmallL=je.codePointSmallK=je.codePointSmallJ=je.codePointSmallI=je.codePointSmallH=je.codePointSmallG=je.codePointSmallF=je.codePointSmallE=je.codePointSmallD=je.codePointSmallC=je.codePointSmallB=je.codePointSmallA=je.codePointSlash=je.codePointSingleQuote=je.codePointSemicolon=je.codePointRightSquareBracket=je.codePointRightParen=je.codePointRightCurlyBracket=je.codePointQuestionMark=je.codePointPlusSign=je.codePointPipe=je.codePointPercentSign=je.codePointMinusSign=je.codePointLessThanSign=je.codePointLeftSquareBracket=je.codePointLeftParen=je.codePointLeftCurlyBracket=je.codePointLF=je.codePointInvertedQuestionMark=je.codePointInvertedExclamationMark=je.codePointHash=je.codePointGreaterThanSign=je.codePointFullwidthLatinSmallZ=je.codePointFullwidthLatinSmallA=je.codePointFullwidthLatinCapitalZ=je.codePointFullwidthLatinCapitalA=je.codePointFullwidthDigitZero=je.codePointFullwidthDigitNine=je.codePointFullStop=void 0;je.codePointUnderscore=je.codePointTilde=je.codePointThaiDigitZero=je.codePointThaiDigitNine=je.codePointTab=je.codePointSpace=je.codePointSmallZ=je.codePointSmallY=je.codePointSmallX=void 0;var $r=Cn();je.codePointAmpersand=$r.codePoint.codePointAmpersand;je.codePointAsterisk=$r.codePoint.codePointAsterisk;je.codePointAtSign=$r.codePoint.codePointAtSign;je.codePointBackslash=$r.codePoint.codePointBackslash;je.codePointBacktick=$r.codePoint.codePointBacktick;je.codePointCR=$r.codePoint.codePointCR;je.codePointCapitalA=$r.codePoint.codePointCapitalA;je.codePointCapitalB=$r.codePoint.codePointCapitalB;je.codePointCapitalC=$r.codePoint.codePointCapitalC;je.codePointCapitalD=$r.codePoint.codePointCapitalD;je.codePointCapitalE=$r.codePoint.codePointCapitalE;je.codePointCapitalF=$r.codePoint.codePointCapitalF;je.codePointCapitalG=$r.codePoint.codePointCapitalG;je.codePointCapitalH=$r.codePoint.codePointCapitalH;je.codePointCapitalI=$r.codePoint.codePointCapitalI;je.codePointCapitalJ=$r.codePoint.codePointCapitalJ;je.codePointCapitalK=$r.codePoint.codePointCapitalK;je.codePointCapitalL=$r.codePoint.codePointCapitalL;je.codePointCapitalM=$r.codePoint.codePointCapitalM;je.codePointCapitalN=$r.codePoint.codePointCapitalN;je.codePointCapitalO=$r.codePoint.codePointCapitalO;je.codePointCapitalP=$r.codePoint.codePointCapitalP;je.codePointCapitalQ=$r.codePoint.codePointCapitalQ;je.codePointCapitalR=$r.codePoint.codePointCapitalR;je.codePointCapitalS=$r.codePoint.codePointCapitalS;je.codePointCapitalT=$r.codePoint.codePointCapitalT;je.codePointCapitalU=$r.codePoint.codePointCapitalU;je.codePointCapitalV=$r.codePoint.codePointCapitalV;je.codePointCapitalW=$r.codePoint.codePointCapitalW;je.codePointCapitalX=$r.codePoint.codePointCapitalX;je.codePointCapitalY=$r.codePoint.codePointCapitalY;je.codePointCapitalZ=$r.codePoint.codePointCapitalZ;je.codePointCircumflexAccent=$r.codePoint.codePointCircumflexAccent;je.codePointColon=$r.codePoint.codePointColon;je.codePointComma=$r.codePoint.codePointComma;je.codePointDigitEight=$r.codePoint.codePointDigitEight;je.codePointDigitFive=$r.codePoint.codePointDigitFive;je.codePointDigitFour=$r.codePoint.codePointDigitFour;je.codePointDigitNine=$r.codePoint.codePointDigitNine;je.codePointDigitOne=$r.codePoint.codePointDigitOne;je.codePointDigitSeven=$r.codePoint.codePointDigitSeven;je.codePointDigitSix=$r.codePoint.codePointDigitSix;je.codePointDigitThree=$r.codePoint.codePointDigitThree;je.codePointDigitTwo=$r.codePoint.codePointDigitTwo;je.codePointDigitZero=$r.codePoint.codePointDigitZero;je.codePointDollarSign=$r.codePoint.codePointDollarSign;je.codePointDoubleQuote=$r.codePoint.codePointDoubleQuote;je.codePointEqualsSign=$r.codePoint.codePointEqualsSign;je.codePointEuroSign=$r.codePoint.codePointEuroSign;je.codePointExclamationMark=$r.codePoint.codePointExclamationMark;je.codePointFullStop=$r.codePoint.codePointFullStop;je.codePointFullwidthDigitNine=$r.codePoint.codePointFullwidthDigitNine;je.codePointFullwidthDigitZero=$r.codePoint.codePointFullwidthDigitZero;je.codePointFullwidthLatinCapitalA=$r.codePoint.codePointFullwidthLatinCapitalA;je.codePointFullwidthLatinCapitalZ=$r.codePoint.codePointFullwidthLatinCapitalZ;je.codePointFullwidthLatinSmallA=$r.codePoint.codePointFullwidthLatinSmallA;je.codePointFullwidthLatinSmallZ=$r.codePoint.codePointFullwidthLatinSmallZ;je.codePointGreaterThanSign=$r.codePoint.codePointGreaterThanSign;je.codePointHash=$r.codePoint.codePointHash;je.codePointInvertedExclamationMark=$r.codePoint.codePointInvertedExclamationMark;je.codePointInvertedQuestionMark=$r.codePoint.codePointInvertedQuestionMark;je.codePointLF=$r.codePoint.codePointLF;je.codePointLeftCurlyBracket=$r.codePoint.codePointLeftCurlyBracket;je.codePointLeftParen=$r.codePoint.codePointLeftParen;je.codePointLeftSquareBracket=$r.codePoint.codePointLeftSquareBracket;je.codePointLessThanSign=$r.codePoint.codePointLessThanSign;je.codePointMinusSign=$r.codePoint.codePointMinusSign;je.codePointPercentSign=$r.codePoint.codePointPercentSign;je.codePointPipe=$r.codePoint.codePointPipe;je.codePointPlusSign=$r.codePoint.codePointPlusSign;je.codePointQuestionMark=$r.codePoint.codePointQuestionMark;je.codePointRightCurlyBracket=$r.codePoint.codePointRightCurlyBracket;je.codePointRightParen=$r.codePoint.codePointRightParen;je.codePointRightSquareBracket=$r.codePoint.codePointRightSquareBracket;je.codePointSemicolon=$r.codePoint.codePointSemicolon;je.codePointSingleQuote=$r.codePoint.codePointSingleQuote;je.codePointSlash=$r.codePoint.codePointSlash;je.codePointSmallA=$r.codePoint.codePointSmallA;je.codePointSmallB=$r.codePoint.codePointSmallB;je.codePointSmallC=$r.codePoint.codePointSmallC;je.codePointSmallD=$r.codePoint.codePointSmallD;je.codePointSmallE=$r.codePoint.codePointSmallE;je.codePointSmallF=$r.codePoint.codePointSmallF;je.codePointSmallG=$r.codePoint.codePointSmallG;je.codePointSmallH=$r.codePoint.codePointSmallH;je.codePointSmallI=$r.codePoint.codePointSmallI;je.codePointSmallJ=$r.codePoint.codePointSmallJ;je.codePointSmallK=$r.codePoint.codePointSmallK;je.codePointSmallL=$r.codePoint.codePointSmallL;je.codePointSmallM=$r.codePoint.codePointSmallM;je.codePointSmallN=$r.codePoint.codePointSmallN;je.codePointSmallO=$r.codePoint.codePointSmallO;je.codePointSmallP=$r.codePoint.codePointSmallP;je.codePointSmallQ=$r.codePoint.codePointSmallQ;je.codePointSmallR=$r.codePoint.codePointSmallR;je.codePointSmallS=$r.codePoint.codePointSmallS;je.codePointSmallT=$r.codePoint.codePointSmallT;je.codePointSmallU=$r.codePoint.codePointSmallU;je.codePointSmallV=$r.codePoint.codePointSmallV;je.codePointSmallW=$r.codePoint.codePointSmallW;je.codePointSmallX=$r.codePoint.codePointSmallX;je.codePointSmallY=$r.codePoint.codePointSmallY;je.codePointSmallZ=$r.codePoint.codePointSmallZ;je.codePointSpace=$r.codePoint.codePointSpace;je.codePointTab=$r.codePoint.codePointTab;je.codePointThaiDigitNine=$r.codePoint.codePointThaiDigitNine;je.codePointThaiDigitZero=$r.codePoint.codePointThaiDigitZero;je.codePointTilde=$r.codePoint.codePointTilde;je.codePointUnderscore=$r.codePoint.codePointUnderscore});var N3=Y(NR=>{"use strict";_();var od,A0;Object.defineProperty(NR,"__esModule",{value:!0});NR.insertCommas=NR.convertNumberShape=NR.convertDigitsShape=void 0;var omr=tS(),QX=O1(),j2=tU(),YX=E3(),hn=A1(),HX=_v(),aU=YX.codePointDigitZero,K1e=YX.codePointDigitNine,umr=YX.codePointDigitOne,smr=(od={},od[hn.NumberShape.ArabicIndic]={zero:1632,one:1633},od[hn.NumberShape.ExtendedArabicIndic]={zero:1776,one:1777},od[hn.NumberShape.Devanagari]={zero:2406,one:2407},od[hn.NumberShape.Bengali]={zero:2534,one:2535},od[hn.NumberShape.Gurmukhi]={zero:2662,one:2663},od[hn.NumberShape.Gujarati]={zero:2790,one:2791},od[hn.NumberShape.Oriya]={zero:2918,one:2919},od[hn.NumberShape.Tamil]={zero:48,one:3047},od[hn.NumberShape.Telugu]={zero:3174,one:3175},od[hn.NumberShape.Kannada]={zero:3302,one:3303},od[hn.NumberShape.Malayalam]={zero:3430,one:3431},od[hn.NumberShape.Thai]={zero:3664,one:3665},od[hn.NumberShape.Lao]={zero:3792,one:3793},od[hn.NumberShape.Tibetan]={zero:3872,one:3873},od[hn.NumberShape.Myanmar]={zero:4160,one:4161},od[hn.NumberShape.Ethiopic]={zero:48,one:4969},od[hn.NumberShape.Khmer]={zero:6112,one:6113},od[hn.NumberShape.Mongolian]={zero:6160,one:6161},od),lmr=(A0={},A0[hn.NumberShape.Japanese1]={digits:[12295,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806},A0[hn.NumberShape.Japanese2]={digits:[12295,22769,24336,21442,22235,20237,20845,19971,20843,20061],ten:25342,hundred:30334,thousand:38433,tenThousand:33836,hundredMillion:20740,trillion:20806},A0[hn.NumberShape.Japanese3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806},A0[hn.NumberShape.Korean1]={digits:[65296,19968,20108,19977,22235,20116,63953,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806},A0[hn.NumberShape.Korean2]={digits:[63922,22777,36019,63851,22235,20237,63953,19971,20843,20061],ten:63859,hundred:30334,thousand:38433,tenThousand:33836,hundredMillion:20740,trillion:20806},A0[hn.NumberShape.Korean3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806},A0[hn.NumberShape.Korean4]={digits:[50689,51068,51060,49340,49324,50724,50977,52832,54036,44396],ten:49901,hundred:48177,thousand:52380,tenThousand:47564,hundredMillion:50613,trillion:51312},A0[hn.NumberShape.ChineseSimp1]={digits:[9675,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20159,trillion:20806},A0[hn.NumberShape.ChineseSimp2]={digits:[38646,22777,36144,21441,32902,20237,38470,26578,25420,29590],ten:25342,hundred:20336,thousand:20191,tenThousand:19975,hundredMillion:20159,trillion:20806},A0[hn.NumberShape.ChineseSimp3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20159,trillion:20806},A0[hn.NumberShape.ChineseTrad1]={digits:[9675,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:33836,hundredMillion:20740,trillion:20806},A0[hn.NumberShape.ChineseTrad2]={digits:[38646,22777,36019,21443,32902,20237,38520,26578,25420,29590],ten:25342,hundred:20336,thousand:20191,tenThousand:33836,hundredMillion:20740,trillion:20806},A0[hn.NumberShape.ChineseTrad3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:33836,hundredMillion:20740,trillion:20806},A0);function zX(e,r){if(r===hn.NumberShape.ASCII)return e;switch(r){case hn.NumberShape.ArabicIndic:case hn.NumberShape.ExtendedArabicIndic:case hn.NumberShape.Devanagari:case hn.NumberShape.Bengali:case hn.NumberShape.Gurmukhi:case hn.NumberShape.Gujarati:case hn.NumberShape.Oriya:case hn.NumberShape.Tamil:case hn.NumberShape.Telugu:case hn.NumberShape.Kannada:case hn.NumberShape.Malayalam:case hn.NumberShape.Thai:case hn.NumberShape.Lao:case hn.NumberShape.Tibetan:case hn.NumberShape.Myanmar:case hn.NumberShape.Ethiopic:case hn.NumberShape.Khmer:case hn.NumberShape.Mongolian:{for(var n="",a=smr[r],o=0;o<e.length;o+=1){var u=e.charCodeAt(o);(0,QX.assertTrue)("calc.numfmt.convertDigitsShape",aU<=u&&u<=K1e),u===aU?n+=(0,j2.stringFromCodePoint)(a.zero):n+=(0,j2.stringFromCodePoint)(a.one+(u-umr))}return n}case hn.NumberShape.ChineseTrad1:case hn.NumberShape.ChineseTrad2:case hn.NumberShape.ChineseTrad3:case hn.NumberShape.ChineseSimp1:case hn.NumberShape.ChineseSimp2:case hn.NumberShape.ChineseSimp3:case hn.NumberShape.Japanese1:case hn.NumberShape.Japanese2:case hn.NumberShape.Japanese3:case hn.NumberShape.Korean1:case hn.NumberShape.Korean2:case hn.NumberShape.Korean3:case hn.NumberShape.Korean4:{for(var n="",a=lmr[r],o=0;o<e.length;o+=1){var u=e.charCodeAt(o);(0,QX.assertTrue)("calc.numfmt.convertDigitsShape",aU<=u&&u<=K1e),n+=(0,j2.stringFromCodePoint)(a.digits[u-aU])}return n}}}NR.convertDigitsShape=zX;function cmr(e,r,n){var a=e.decimalSeparator;if(n===hn.NumberShape.ASCII)return(0,HX.success)(r);switch(n){case hn.NumberShape.ArabicIndic:case hn.NumberShape.ExtendedArabicIndic:case hn.NumberShape.Devanagari:case hn.NumberShape.Bengali:case hn.NumberShape.Gurmukhi:case hn.NumberShape.Gujarati:case hn.NumberShape.Oriya:case hn.NumberShape.Tamil:case hn.NumberShape.Telugu:case hn.NumberShape.Kannada:case hn.NumberShape.Malayalam:case hn.NumberShape.Thai:case hn.NumberShape.Lao:case hn.NumberShape.Tibetan:case hn.NumberShape.Myanmar:case hn.NumberShape.Ethiopic:case hn.NumberShape.Khmer:case hn.NumberShape.Mongolian:{var o=r.indexOf(a),u=zX(r.substring(0,o<0?void 0:o),n),t=o<0?"":a,d=o<0?"":zX(r.substring(o+a.length),n);return(0,HX.success)(u+t+d)}case hn.NumberShape.ChineseTrad1:case hn.NumberShape.ChineseTrad2:case hn.NumberShape.ChineseTrad3:case hn.NumberShape.ChineseSimp1:case hn.NumberShape.ChineseSimp2:case hn.NumberShape.ChineseSimp3:case hn.NumberShape.Japanese1:case hn.NumberShape.Japanese2:case hn.NumberShape.Japanese3:case hn.NumberShape.Korean1:case hn.NumberShape.Korean2:case hn.NumberShape.Korean3:case hn.NumberShape.Korean4:return(0,HX.failure)((0,omr.notImplemented)(["convertNumberShape: ideographic shape ".concat(String(n))]));default:return(0,QX.assertNever)("calc.numfmt.convertNumberShape",n)}}NR.convertNumberShape=cmr;function dmr(e,r,n){if(r==="")return"";for(var a=(0,j2.countCodePoints)(r,0,r.length),o="",u=0,t=0;u<r.length;){var d=(0,j2.stringCodePointAt)(r,u),s=(0,j2.numCodeUnits)(d);o+=r.substring(u,u+s),u+=s,t+=1,e.isThousandsPosition(n+(a-t))&&(o+=e.thousandsSeparator)}return o}NR.insertCommas=dmr});var H2=Y(rs=>{"use strict";_();var AR;Object.defineProperty(rs,"__esModule",{value:!0});rs.englishXLSXKnownFormat=rs.isKnownFormatDefined=rs.getKnownFormat=rs.buildMMDDYYFormat=rs.buildSingle=rs.buildCurrencyFormat=rs.buildFractionFormat=rs.buildScientificFormat=rs.buildPercentFormat=rs.buildNumberFormat=rs.getColor=rs.getSingle=rs.getSpecial=void 0;var V1e=br(),en=A1(),Xr=W2(),fmr=N3(),rZ=O1(),MP=K2();function uU(e,r){var n,a=(n=e.pictureSpecial[r])!==null&&n!==void 0?n:Xr.englishPictureSpecial[r];return(0,rZ.assertTrue)("calc.numfmt.knownFormat: getSpecial",a!==void 0),a}rs.getSpecial=uU;function No(e,r){var n,a=(n=e.pictureSingle[r])!==null&&n!==void 0?n:Xr.englishPictureSingle[r];return(0,rZ.assertTrue)("calc.numfmt.knownFormat: getSingle",a!==void 0),a}rs.getSingle=No;function H1e(e,r){var n,a=(n=e.pictureColor[r])!==null&&n!==void 0?n:Xr.englishPictureColor[r];return(0,rZ.assertTrue)("calc.numfmt.knownFormat: getColor",a!==void 0),a}rs.getColor=H1e;function IP(e,r,n,a){var o="";if(n>1){var u=(0,MP.repeat)(No(e,Xr.PictureSingle.Hash),n-1);o+=r?(0,fmr.insertCommas)({isThousandsPosition:function(d){return d>0&&d%3===0},thousandsSeparator:No(e,Xr.PictureSingle.Comma)},u,1):u}return o+="0",a>0&&(o+=No(e,Xr.PictureSingle.Decimal),o+=(0,MP.repeat)("0",a)),o}rs.buildNumberFormat=IP;function XX(e,r){var n="";return n+="0",r>0&&(n+=No(e,Xr.PictureSingle.Decimal),n+=(0,MP.repeat)("0",r)),e.isPercentSepBySpace&&(n+=No(e,Xr.PictureSingle.Space)),n+=No(e,Xr.PictureSingle.Percent),n}rs.buildPercentFormat=XX;function ZX(e,r,n,a){var o="";return o+=IP(e,!1,r,n),e.isExpSepBySpace&&(o+=No(e,Xr.PictureSingle.Space)),o+=No(e,Xr.PictureSingle.E),o+="+",o+=(0,MP.repeat)("0",a),o}rs.buildScientificFormat=ZX;function oU(e,r){var n=No(e,Xr.PictureSingle.Quote);return n+r+n}function $X(e,r){var n="";n+=No(e,Xr.PictureSingle.Hash);var a=e.fractionSeparator;return a===No(e,Xr.PictureSingle.Comma)?n+=oU(e,a):a===" "?n+=No(e,Xr.PictureSingle.Space):n+=oU(e,a),n+=(0,MP.repeat)(No(e,Xr.PictureSingle.Question),r),n+=No(e,Xr.PictureSingle.Slash),n+=(0,MP.repeat)(No(e,Xr.PictureSingle.Question),r),n}rs.buildFractionFormat=$X;function pmr(e,r){var n="";return n+=oU(e,"-"),r>0&&(n+=(0,MP.repeat)(No(e,Xr.PictureSingle.Question),r)),n}function pm(e,r,n,a,o,u,t){t===void 0&&(t=!1);for(var d=e.isCurrencySymbolLead,s=e.currencyFormat,c=e.isCurrencySepBySpace,l=t?0:o?3:1,f=IP(e,!0,4,n),p="",m=function(S){S!==0&&(p+=No(e,Xr.PictureSingle.Sep)),S===1&&r&&(p+=No(e,Xr.PictureSingle.ColorStart)+H1e(e,Xr.PictureColor.Red)+No(e,Xr.PictureSingle.ColorEnd));var y=function(){return S===2?pmr(e,n):S===3?No(e,Xr.PictureSingle.Text):f},C=function(){return S!==3?Ns(e,Xr.PictureSingle.Star,Xr.PictureSingle.Space):""},E=function(){var H="";if(d)switch(s){case en.CurrencyFormat.Paren:H+=Ns(e,Xr.PictureSingle.Underscore,Xr.PictureSingle.OpenParen);break;case en.CurrencyFormat.Trail:H+=Ns(e,Xr.PictureSingle.Underscore,Xr.PictureSingle.Minus);break;case en.CurrencyFormat.Intern:H+=Ns(e,Xr.PictureSingle.Underscore,Xr.PictureSingle.Space);break}else{switch(s){case en.CurrencyFormat.Trail:H+=Ns(e,Xr.PictureSingle.Underscore,Xr.PictureSingle.Minus);break;case en.CurrencyFormat.Paren:case en.CurrencyFormat.Intern:H+=Ns(e,Xr.PictureSingle.Underscore,Xr.PictureSingle.Space);break}s!==en.CurrencyFormat.Lead&&(H+=C())}return H},I=function(){if(d)switch(s){case en.CurrencyFormat.Lead:return Ns(e,Xr.PictureSingle.Underscore,Xr.PictureSingle.Minus);case en.CurrencyFormat.Intern:return Ns(e,Xr.PictureSingle.Underscore,Xr.PictureSingle.Space)}else switch(s){case en.CurrencyFormat.Lead:return Ns(e,Xr.PictureSingle.Underscore,Xr.PictureSingle.Minus);case en.CurrencyFormat.Paren:case en.CurrencyFormat.Intern:return Ns(e,Xr.PictureSingle.Underscore,Xr.PictureSingle.Space)}return""},F=function(){return S===1?No(e,Xr.PictureSingle.OpenParen):""},w=function(){return S===3&&!d?"":S===1?No(e,Xr.PictureSingle.CloseParen):Ns(e,Xr.PictureSingle.Underscore,Xr.PictureSingle.CloseParen)},B=function(){var H="";if(S!==1)switch(s){case en.CurrencyFormat.Intern:!d&&S!==3&&(H+=Ns(e,Xr.PictureSingle.Underscore,Xr.PictureSingle.Minus));break;case en.CurrencyFormat.Lead:case en.CurrencyFormat.Trail:if(s===en.CurrencyFormat.Lead&&!o)break;H+=Ns(e,Xr.PictureSingle.Underscore,Xr.PictureSingle.Minus);break}else H+=No(e,Xr.PictureSingle.Minus);return o&&!d&&s===en.CurrencyFormat.Lead&&(H+=C()),H},k=function(){var H="";return a&&!d&&c&&(H+=No(e,Xr.PictureSingle.Space)),a&&(H+=u??uU(e,Xr.PictureSpecial.Currency)),d&&c&&(H+=No(e,Xr.PictureSingle.Space)),H},x=function(){var H="";return S!==3&&(d?(a&&(H+=k()),o&&(H+=C())):H+=k()),H};if(o&&(p+=E()),d)switch(s){case en.CurrencyFormat.Paren:o||(p+=F()),p+=x(),o&&(p+=F()),p+=y(),p+=w();break;case en.CurrencyFormat.Lead:p+=B(),p+=x(),p+=y();break;case en.CurrencyFormat.Intern:p+=x(),p+=B(),p+=y();break;case en.CurrencyFormat.Trail:p+=x(),p+=y(),p+=B();break}else switch(s){case en.CurrencyFormat.Paren:p+=F(),p+=y(),o&&(p+=w()),p+=x(),o||(p+=w());break;case en.CurrencyFormat.Lead:p+=B(),p+=y(),p+=x();break;case en.CurrencyFormat.Intern:p+=y(),p+=B(),p+=x();break;case en.CurrencyFormat.Trail:p+=y(),p+=x(),p+=B();break}o&&(p+=I())},v=0;v<=l;v+=1)m(v);return p}rs.buildCurrencyFormat=pm;function Ns(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return r.map(function(a){return typeof a=="string"?a:No(e,a)}).join("")}rs.buildSingle=Ns;var mmr=(AR={},AR[en.DateOrder.MDY]=[1,0,2],AR[en.DateOrder.DMY]=[0,1,2],AR[en.DateOrder.YMD]=[2,1,0],AR[en.DateOrder.MYD]=[1,2,0],AR[en.DateOrder.DYM]=[0,2,1],AR[en.DateOrder.YDM]=[2,0,1],AR);function iU(e,r){var n=r?e.hour2Digits&&!e.clock24Hour:e.hour2Digits;return Ns(e,n?Xr.PictureSingle.Hour:"",Xr.PictureSingle.Hour,Xr.PictureSingle.Colon,Xr.PictureSingle.Minute,Xr.PictureSingle.Minute)}function W1e(e,r){return iU(e,r)+Ns(e,Xr.PictureSingle.Colon,Xr.PictureSingle.Second,Xr.PictureSingle.Second)}function j1e(e){var r="";return e.isAMPMSepBySpace&&(r+=No(e,Xr.PictureSingle.Space)),r+=uU(e,Xr.PictureSpecial.AP1),r}function eZ(e,r){r===void 0&&(r=!1);for(var n=e.month2Digits,a=e.day2Digits,o=r||e.year4Digits,u=Ns(e,o?Xr.PictureSingle.Year:"",o?Xr.PictureSingle.Year:"",Xr.PictureSingle.Year,Xr.PictureSingle.Year),t=Ns(e,n?Xr.PictureSingle.Month:"",Xr.PictureSingle.Month),d=Ns(e,a?Xr.PictureSingle.Day:"",Xr.PictureSingle.Day),s=[d,t,u],c=mmr[e.dateOrder],l="",f=0;f<3;f+=1)l+=s[c[f]],f<2&&(l+=No(e,Xr.PictureSingle.DateSep));return l}rs.buildMMDDYYFormat=eZ;function JX(e,r,n){var a=e.day2Digits,o=e.country===Xr.Country.GER,u=e.dateSeparator==="/"&&e.dateAltSeparator!==" ",t="";return r&&(t+=Ns(e,a?Xr.PictureSingle.Day:"",Xr.PictureSingle.Day),u?t+=e.dateAltSeparator:(t+=No(e,Xr.PictureSingle.DateSep),o&&(t+=No(e,Xr.PictureSingle.Space)))),t+=Ns(e,Xr.PictureSingle.Month,Xr.PictureSingle.Month,Xr.PictureSingle.Month),n&&(u?t+=e.dateAltSeparator:o?t+=No(e,Xr.PictureSingle.Space):t+=No(e,Xr.PictureSingle.DateSep),t+=Ns(e,Xr.PictureSingle.Year,Xr.PictureSingle.Year)),t}function gmr(e,r){switch(r){case en.KnownFormat.General:return uU(e,Xr.PictureSpecial.General);case en.KnownFormat.NoComFixed0:return IP(e,!1,1,0);case en.KnownFormat.NoComFixed:return IP(e,!1,1,2);case en.KnownFormat.Fixed0:return IP(e,!0,4,0);case en.KnownFormat.Fixed:return IP(e,!0,4,2);case en.KnownFormat.Currency:return pm(e,!1,0,!0,!1);case en.KnownFormat.CoCurrency:return pm(e,!0,0,!0,!1);case en.KnownFormat.CurrencyDec:return pm(e,!1,2,!0,!1);case en.KnownFormat.CoCurrencyDec:return pm(e,!0,2,!0,!1);case en.KnownFormat.Pct0:return XX(e,0);case en.KnownFormat.Pct:return XX(e,2);case en.KnownFormat.Exp:return ZX(e,1,2,2);case en.KnownFormat.Fract:return $X(e,1);case en.KnownFormat.FractBond:return $X(e,2);case en.KnownFormat.MMDDYY:return eZ(e);case en.KnownFormat.DDMMMYY:return JX(e,!0,!0);case en.KnownFormat.DDMMM:return JX(e,!0,!1);case en.KnownFormat.MMMYY:return JX(e,!1,!0);case en.KnownFormat.HHMMAP:return iU(e,!0)+j1e(e);case en.KnownFormat.HHMMSSAP:return W1e(e,!0)+j1e(e);case en.KnownFormat.HHMM:return iU(e,!1);case en.KnownFormat.HHMMSS:return W1e(e,!1);case en.KnownFormat.MDYHMS:return Ns(e,eZ(e),Xr.PictureSingle.Space,iU(e,!1));case en.KnownFormat.USCoCurrency:case en.KnownFormat.USCoCurrencyDec:return pm(V1e.__assign(V1e.__assign({},e),{isCurrencySymbolLead:!0,isCurrencySepBySpace:!1,currencyFormat:en.CurrencyFormat.Paren}),!0,r===en.KnownFormat.USCoCurrencyDec?2:0,!0,!1,e.isChinaT?oU(e,"US$"):"$");case en.KnownFormat.Currency2:return pm(e,!1,0,!1,!1);case en.KnownFormat.CoCurrency2:return pm(e,!0,0,!1,!1);case en.KnownFormat.CurrencyDec2:return pm(e,!1,2,!1,!1);case en.KnownFormat.CoCurrencyDec2:return pm(e,!0,2,!1,!1);case en.KnownFormat.Acct:return pm(e,!1,0,!1,!0);case en.KnownFormat.AcctDec:return pm(e,!1,2,!1,!0);case en.KnownFormat.AcctCur:return pm(e,!1,0,!0,!0);case en.KnownFormat.AcctDecCur:return pm(e,!1,2,!0,!0);case en.KnownFormat.MMSS:return Ns(e,Xr.PictureSingle.Minute,Xr.PictureSingle.Minute,Xr.PictureSingle.Colon,Xr.PictureSingle.Second,Xr.PictureSingle.Second);case en.KnownFormat.AbsHMMSS:return Ns(e,Xr.PictureSingle.ColorStart,Xr.PictureSingle.Hour,Xr.PictureSingle.ColorEnd,Xr.PictureSingle.Colon,Xr.PictureSingle.Minute,Xr.PictureSingle.Minute,Xr.PictureSingle.Colon,Xr.PictureSingle.Second,Xr.PictureSingle.Second);case en.KnownFormat.SS0:return Ns(e,Xr.PictureSingle.Minute,Xr.PictureSingle.Minute,Xr.PictureSingle.Colon,Xr.PictureSingle.Second,Xr.PictureSingle.Second,Xr.PictureSingle.Decimal,"0");case en.KnownFormat.Eng:return ZX(e,3,1,1);case en.KnownFormat.Text:return No(e,Xr.PictureSingle.Text)}}rs.getKnownFormat=gmr;function vmr(e,r){switch(e){case en.KnownFormat.USCoCurrency:case en.KnownFormat.USCoCurrencyDec:return r.isEastAsia;default:return!0}}rs.isKnownFormatDefined=vmr;rs.englishXLSXKnownFormat={0:en.KnownFormat.General,1:en.KnownFormat.NoComFixed0,2:en.KnownFormat.NoComFixed,3:en.KnownFormat.Fixed0,4:en.KnownFormat.Fixed,5:en.KnownFormat.Currency,6:en.KnownFormat.CoCurrency,7:en.KnownFormat.CurrencyDec,8:en.KnownFormat.CoCurrencyDec,9:en.KnownFormat.Pct0,10:en.KnownFormat.Pct,11:en.KnownFormat.Exp,12:en.KnownFormat.Fract,13:en.KnownFormat.FractBond,14:en.KnownFormat.MMDDYY,15:en.KnownFormat.DDMMMYY,16:en.KnownFormat.DDMMM,17:en.KnownFormat.MMMYY,18:en.KnownFormat.HHMMAP,19:en.KnownFormat.HHMMSSAP,20:en.KnownFormat.HHMM,21:en.KnownFormat.HHMMSS,22:en.KnownFormat.MDYHMS,37:en.KnownFormat.Currency2,38:en.KnownFormat.CoCurrency2,39:en.KnownFormat.CurrencyDec2,40:en.KnownFormat.CoCurrencyDec2,41:en.KnownFormat.Acct,42:en.KnownFormat.AcctCur,43:en.KnownFormat.AcctDec,44:en.KnownFormat.AcctDecCur,45:en.KnownFormat.MMSS,46:en.KnownFormat.AbsHMMSS,47:en.KnownFormat.SS0,48:en.KnownFormat.Eng,49:en.KnownFormat.Text}});var cU=Y(lU=>{"use strict";_();Object.defineProperty(lU,"__esModule",{value:!0});lU.parseConstInternal=void 0;var sU=br(),hmr=nU(),Smr=tS(),k1=A1(),Q1e=H2(),kR=E3(),OR=_v(),ymr=kR.codePointDollarSign,Cmr=kR.codePointBackslash,z1e=kR.codePointPercentSign,Y1e=kR.codePointSpace,J1e=kR.codePointLeftParen,_mr=kR.codePointMinusSign,X1e=kR.codePointPlusSign,Rmr=kR.codePointRightParen;function Z1e(e,r,n,a){if(!(r===" "||r==="")){var o=r==="$";if(e.isEastAsia){if(a<n.length&&n.charCodeAt(a)===ymr&&!o)return{currency:1,i:a+1};if(a+2<n.length&&e.stringCompareCI(n.substring(a,a+3),"US$")===0)return{currency:e.isChinaT?1:2,i:a+3};if((r==="\xA5"&&e.isJapan||r==="\u20A9"&&e.isKorea)&&a<n.length&&n.charCodeAt(a)===Cmr)return{currency:0,i:a+1};if(e.isChinaT&&a+2<n.length&&e.stringCompareCI(n.substring(a,a+3),"NT$")===0)return{currency:2,i:a+3}}if(a+r.length<=n.length&&e.stringCompareCI(n.substring(a,a+r.length),r)===0)return{currency:0,i:a+r.length}}}function $1e(e,r,n,a,o,u){var t,d=0,s=!1,c=!1,l=!1,f=e.isCurrencySymbolLead,p=e.currencySymbol;o!==0&&(f=o===1,p="\u20AC");for(var m=0;m<n.length;){if(t===void 0&&f){var v=Z1e(e,p,n,m);if(v!==void 0){t=v.currency,m=v.i;continue}}var h=n.charCodeAt(m);switch(h){case z1e:m+=1,d+=1;continue;case Y1e:m+=1;continue;case J1e:case _mr:case X1e:if(m+=1,c)return(0,OR.success)(void 0);c=!0,h===J1e&&(s=!0),l=h!==X1e;continue}break}var S=(0,hmr.parseNumberLiteral)(e,r,n,m,!0,d>0||a,u);if(S===void 0||S.value===void 0)return(0,OR.success)(void 0);m=S.i;for(var y=l?r.neg(S.value):S.value;m<n.length;){if(t===void 0&&!f){var v=Z1e(e,p,n,m);if(v!==void 0){t=v.currency,m=v.i;continue}}var h=n.charCodeAt(m);switch(h){case z1e:m+=1,d+=1;continue;case Y1e:m+=1;continue;case Rmr:if(m+=1,!s)return(0,OR.success)(void 0);s=!1;continue}break}if(m!==n.length||s||d>1||t!==void 0&&d>0)return(0,OR.success)(void 0);var C;if(S.format!==void 0)C=S.format;else if(t===1)C=S.consumedDecimal?k1.KnownFormat.USCoCurrencyDec:k1.KnownFormat.USCoCurrency;else if(t===2){var E='"NT$"#,##0_);("NT$"#,##0)',I='"NT$"#,##0.00_);("NT$"#,##0.00)',F='"US$"#,##0_);("US$"#,##0)',w='"US$"#,##0.00_);("US$"#,##0.00)';e.isChinaT?C=S.consumedDecimal?I:E:C=S.consumedDecimal?w:F}else{if(S.numShape!==k1.NumberShape.ASCII)return(0,OR.failure)((0,Smr.notImplemented)(["parseConstInternal ifmt for non-ASCII"]));if(t!==void 0)switch(o){case 0:C=S.consumedDecimal?k1.KnownFormat.CoCurrencyDec:k1.KnownFormat.CoCurrency;break;case 1:C=(0,Q1e.buildCurrencyFormat)(sU.__assign(sU.__assign({},e),{isCurrencySymbolLead:!0,isCurrencySepBySpace:!0}),!0,S.consumedDecimal?2:0,!0,!1,"[$\u20AC-x-euro2]");break;case 2:C=(0,Q1e.buildCurrencyFormat)(sU.__assign(sU.__assign({},e),{isCurrencySymbolLead:!1,isCurrencySepBySpace:!0}),!0,S.consumedDecimal?2:0,!0,!1,"[$\u20AC-x-euro1]");break}else d>0?C=S.consumedDecimal?k1.KnownFormat.Pct:k1.KnownFormat.Pct0:S.consumedThousands?C=S.consumedDecimal?k1.KnownFormat.Fixed:k1.KnownFormat.Fixed0:C=k1.KnownFormat.General}return(0,OR.success)({value:y,format:C})}function Tmr(e,r,n,a,o,u){if(!o)return $1e(e,r,n,a,0,u);for(var t=0;t<=2;t+=1){var d=$1e(e,r,n,a,t,u);if(!(0,OR.isSuccess)(d)||d.value!==void 0)return d;if(t===0&&n.indexOf("\u20AC")<0)break}return(0,OR.success)(void 0)}lU.parseConstInternal=Tmr});var nZ=Y(Bp=>{"use strict";_();Object.defineProperty(Bp,"__esModule",{value:!0});Bp.xlDatepack=Bp.tzUTC=Bp.tzData=Bp.dateTime=Bp.TimeGranularity=Bp.TimeDivision=Bp.Rounding=void 0;var wP=et();Bp.Rounding=wP.datepack.Rounding;Bp.TimeDivision=wP.datepack.TimeDivision;Bp.TimeGranularity=wP.datepack.TimeGranularity;Bp.dateTime=wP.datepack.dateTime;Bp.tzData=wP.datepack.tzData;Bp.tzUTC=wP.datepack.tzUTC;Bp.xlDatepack=wP.datepack.xlDatepack});var SU=Y(z2=>{"use strict";_();var A3;Object.defineProperty(z2,"__esModule",{value:!0});z2.parseDateInternal=z2.initParseDateGlobals=void 0;var bmr=br(),aS=W2(),pU=E1(),Pmr=V2(),Dd=tS(),xP=tU(),hU=E3(),eye=nU(),xd=O1(),As=A1(),DC=nZ(),Q2=K2(),ht=_v(),Emr=hU.codePointSlash,mU=hU.codePointSpace,aZ=hU.codePointMinusSign,Nmr=hU.codePointColon,Amr={getTime:function(){return(0,xd.assertFalse)("calc.numfmt.parseDateInternal: default getTime")}};function Omr(e){var r,n;return{config:e.config,getTime:(n=(r=e.getTime)===null||r===void 0?void 0:r.bind(e))!==null&&n!==void 0?n:Amr.getTime}}z2.initParseDateGlobals=Omr;function DP(e,r){return(0,xd.assertTrue)("calc.numfmt.monthToken",Tv(e,1,12)),{kind:0,value:e,bidiDate:r}}var kmr=bmr.__spreadArray([],new Array(12),!0).map(function(e,r){return DP(r+1)}),dU=function(r){return kmr[r]},rye=function(r){return DP(r+1,pU.BidiDate.English)},Fmr=function(r){return DP(r+1,pU.BidiDate.Lunar)},tye=[!0,!1].map(function(e){return{kind:1,am:e}}),Imr=tye[0],Mmr=tye[1],tZ=function(r){return r===0?Imr:Mmr};function aye(e,r,n){return(0,xd.assertTrue)("calc.numfmt.numberToken",(0,Q2.isInteger)(e)&&Tv(e,-9999,9999)&&Tv(r,1,4)),{kind:2,value:e,digits:r,numShape:n}}var fU=function(r){return r===3||r===4},iye=function(r,n){return r.lcid===aS.LCID.Hungarian&&n===2},gU=function(r){return r<=1},nye=function(r){return r<=2},wmr=["\u4E0A\u5348","\u4E0B\u5348"],Dmr=(A3={},A3[aS.Country.FRN]=[["Jun",DP(6)],["Jul",DP(7)]],A3[aS.Country.DUT]=[["Mrt",DP(3)]],A3[aS.Country.GER]=[["Mrz",DP(3)]],A3),xmr=["\u0645\u062D\u0631\u0645","\u0635\u0641\u0631","\u0631\u0628\u064A\u0639 \u0627\u0644\u0627\u0648\u0644","\u0631\u0628\u064A\u0639 \u0627\u0644\u062B\u0627\u0646\u064A","\u062C\u0645\u0627\u062F\u0649 \u0627\u0644\u0627\u0648\u0644\u0649","\u062C\u0645\u0627\u062F\u0649 \u0627\u0644\u062B\u0627\u0646\u064A\u0629","\u0631\u062C\u0628","\u0634\u0639\u0628\u0627\u0646","\u0631\u0645\u0636\u0627\u0646","\u0634\u0648\u0627\u0644","\u0630\u0648 \u0627\u0644\u0642\u0639\u062F\u0629","\u0630\u0648 \u0627\u0644\u062D\u062C\u0629"];function Tv(e,r,n){return e>=r&&e<=n}function Lmr(e,r){for(var n=0,a=(0,xP.codePointIterator)(r);n<a.length;n++){var o=a[n];if(e.isNumeral(o))return!0}return!1}function Bmr(e,r){for(var n=As.NumberShape.ASCII,a=0,o=(0,xP.codePointIterator)(r);a<o.length;a++){var u=o[a],t=e.getNumberShape(u);t!==As.NumberShape.ASCII&&(n=t)}return n}function qmr(e){var r=1930,n=30;return 1900+(e<n?100:0)+e}function oye(e,r){var n=e.getTime(DC.TimeGranularity.Year,r);if(!(0,ht.isSuccess)(n))return n;var a=e.config,o=a.datepack.fromNum(a,n.value,DC.Rounding.RoundSec);return(0,xd.assertTrue)("calc.numfmt.parseDateInternal: current year fromNum",o!==!1),(0,ht.success)(o.yr)}function vU(e,r,n,a){return a+r.length<=n.length&&e.stringCompareCI(r,n.substring(a,a+r.length))===0}function O3(e,r,n,a,o,u){for(var t=r.indexOf(" ",n),d=0;d<a.length;d+=1){var s=a[d],c=(0,Pmr.fastMin)(o,s.length);if(t>=0&&s.indexOf(" ")<0&&t-n>=c&&t-n<=s.length){var l=s.substring(0,t-n);if(vU(e,l,r,n))return[u(d),n+l.length]}for(var f=void 0,p=c;p<=s.length;p+=1){var l=s.substring(0,p);if(!vU(e,l,r,n))break;f=n+l.length}if(f!==void 0)return[u(d),f]}}function k3(e,r,n,a,o){for(var u=0;u<a.length;u+=1){var t=a[u];if(vU(e,t,r,n))return[o(u),n+t.length]}}function Umr(e,r,n){var a=Dmr[e.country];if(a!==void 0)for(var o=0,u=a;o<u.length;o++){var t=u[o],d=t[0],s=t[1];if(vU(e,d,r,n))return[s,n+d.length]}var c;if(e.isEastAsia){if(c=O3(e,r,n,(0,aS.getEnglishLocaleInfo)().monthNameLong,3,dU),c!==void 0)return c}else if(e.isComplexScript){if(c=k3(e,r,n,e.monthNameLong,dU),c!==void 0||(c=k3(e,r,n,e.monthNameShort,dU),c!==void 0)||(c=k3(e,r,n,(0,aS.getEnglishLocaleInfo)().monthNameLong,rye),c!==void 0)||(c=k3(e,r,n,(0,aS.getEnglishLocaleInfo)().monthNameShort,rye),c!==void 0))return c}else if(c=O3(e,r,n,e.monthNameLong,3,dU),c!==void 0)return c;return(e.lcid&aS.LCID.LANG)===(aS.LCID.Arabic&aS.LCID.LANG)&&(c=k3(e,r,n,xmr,Fmr),c!==void 0)||(c=O3(e,r,n,e.ampmSymbols,1,tZ),c!==void 0)||(c=O3(e,r,n,(0,aS.getEnglishLocaleInfo)().ampmSymbols,1,tZ),c!==void 0)||(e.isChinaS||e.isChinaT)&&(c=O3(e,r,n,wmr,1,tZ),c!==void 0)?c:[void 0,n]}function Gmr(e,r,n,a){var o,u,t=n,d=r.charCodeAt(t)===aZ;d&&(t+=1);var s,c,l;if(a===5){if(o=(0,eye.parseUint)(e,4,t+4<r.length?r.substring(0,t+4):r,t),s=o[0],c=o[1],l=c-t,(0,xd.assertTrue)("calc.numfmt.parseDateInternal: 0 < digits <= 4",Tv(l,1,4)),l===4){for(var f=void 0;c<r.length&&e.isNumeral(f=(0,xP.stringCodePointAt)(r,c));)c+=(0,xP.numCodeUnits)(f);s=Math.round(s/10),l=3}}else if(u=(0,eye.parseUint)(e,4,r,t),s=u[0],c=u[1],l=c-t,l>4||l>2&&s<100)return[void 0,n];if(l===0)return[void 0,n];var p=Bmr(e,r.substring(t,c));return t=c,[aye(d?-s:s,l,p),t]}function Kmr(e,r,n,a){var o=0,u=n;if(r.charCodeAt(u)===mU)for(o=1;r.charCodeAt(u)===mU;)u+=1;return e.timeAltSeparator!=null&&e.timeAltSeparator!==e.timeSeparator&&a===3&&(0,Q2.stringStartsWith)(r,e.timeAltSeparator,u)?(o=4,u+=e.timeAltSeparator.length):(0,Q2.stringStartsWith)(r,e.dateSeparator,u)?(o=2,u+=e.dateSeparator.length):(0,Q2.stringStartsWith)(r,e.timeSeparator,u)?(o=3,u+=e.timeSeparator.length):(0,Q2.stringStartsWith)(r,e.decimalSeparator,u)&&a===3?(o=5,u+=e.decimalSeparator.length):r.charCodeAt(u)===Emr||r.charCodeAt(u)===aZ?(o=2,u+=1):r.charCodeAt(u)===Nmr?(o=3,u+=1):(0,Q2.stringStartsWith)(r,", ",u)&&(o=6,u+=2),o===1&&(e.dateSeparator===" "?o=2:e.timeSeparator===" "?o=3:e.decimalSeparator===" "&&a===3&&(o=5)),[o,u]}function Vmr(e,r,n){for(var a=e.localeInfo,o=e.dateCompatibility,u=9,t=[],d=n==null?void 0:n.bidiDate,s=As.NumberShape.ASCII,c=n==null?void 0:n.culture,l,f=!1,p=!1,m=0;m<r.length;){if(t.length>=u)return(0,ht.success)(void 0);var v=void 0;if(a.isNumeral((0,xP.stringCodePointAt)(r,m))||!o&&m+1<r.length&&r.charCodeAt(m)===aZ&&a.isNumeral((0,xP.stringCodePointAt)(r,m+1))){var h=Gmr(a,r,m,l),S=h[0],y=h[1];if(S===void 0)return(0,ht.success)(void 0);m=y,S.numShape!==As.NumberShape.ASCII&&(s=S.numShape),v=S}else{if(r.charCodeAt(m)===mU)return(0,ht.failure)((0,Dd.notImplemented)(["absurd date/time string with leading space"]));var C=Umr(a,r,m),E=C[0],I=C[1];if(E===void 0)return(0,ht.success)(void 0);if(m=I,E.kind===0){if(f)return(0,ht.success)(void 0);f=!0,E.bidiDate!==void 0&&(d=E.bidiDate)}if(E.kind===1){if(p||(p=!0,t.length===0||t[t.length-1].sep!==1))return(0,ht.success)(void 0);l=t[t.length-1].sep=3}v=E}var F=Kmr(a,r,m,l),w=F[0],B=F[1];for(m=B;m<r.length&&r.charCodeAt(m)===mU;)m+=1;t.push({tok:v,sep:w}),l=w}return(0,xd.assertTrue)("calc.numfmt.parseDateInternal: > 0 tokens",t.length!==0),(0,ht.success)({tokens:t,bidiDate:d,numShape:s,culture:c})}function Wmr(e,r){for(var n=e.localeInfo,a,o,u=0;u<r.length;u+=1)if(fU(r[u].sep)){a={start:u,end:u+1};break}var t,d,s,c,l;if(a!==void 0){if(a.start!==0&&!(r[a.start-1].sep===1||iye(n,r[a.start-1].sep)))return(0,ht.success)(void 0);for(;a.end<r.length&&fU(r[a.end-1].sep);)a.end+=1;if(a.end<r.length&&r[a.end-1].sep===5){a.end+=1;var f=r[a.end-1];if(f.tok.kind!==2)return(0,ht.success)(void 0);var p=f.tok;if(c=f,a.end<r.length&&fU(r[a.end-1].sep)){a.end+=1;var m=r[a.end-1];if(m.tok.kind!==1)return(0,ht.failure)((0,Dd.notImplemented)(["non-AM/PM after FracSec"]));var v=m.tok;l=m}}else{var m=r[a.end-1];if(m.tok.kind===1){var v=m.tok;l=m}}for(var h=a.end-a.start-(c!==void 0?1:0)-(l!==void 0?1:0),u=0;u<h;u+=1)if(r[a.start+u].tok.kind!==2)return(0,ht.failure)((0,Dd.notImplemented)(["non-number in H/M/S component"]));switch(h){case 0:return(0,xd.assertFalse)("calc.numfmt.parseDateInternal: 0 time");case 1:(0,xd.assertTrue)("calc.numfmt.parseDateInternal: 1 time => !fracSec",c===void 0),t=r[a.start];break;case 2:c===void 0?(t=r[a.start],d=r[a.start+1]):(d=r[a.start],s=r[a.start+1]);break;case 3:t=r[a.start],d=r[a.start+1],s=r[a.start+2];break;default:return(0,ht.success)(void 0)}for(var u=a.end;u<r.length;u+=1)if(fU(r[u].sep))return(0,ht.success)(void 0);if(a.end===r.length){var S=r[a.end-1].sep;if(!(gU(S)||l!==void 0&&S===5))return(0,ht.failure)((0,Dd.notImplemented)(["trailing sep after time"]))}else{var y=r[a.end-1].sep;if(!(gU(y)||y===6))return(0,ht.failure)((0,Dd.notImplemented)(["unexpected sep between time and date"]))}if(a.start===0)a.end!==r.length&&(o={start:a.end,end:r.length});else if(a.end===r.length)o={start:0,end:a.start};else return(0,ht.failure)((0,Dd.notImplemented)(["date part split around time part"]))}else o={start:0,end:r.length};return(0,ht.success)({time:a,date:o,hour:t,min:d,sec:s,fracSec:c,ampm:l})}function jmr(e,r){for(var n=r.start;n<r.end;n+=1)if(e[n].tok.kind===0)return n}function Hmr(e,r,n,a){var o=e.config,u=o.localeInfo,t=o.dateCompatibility,d=o.datepack,s,c,l,f=!1;if(a!==void 0){var p=a.end-a.start;if(p<2||p>3)return(0,ht.success)(void 0);var m=n[a.start],v=m.tok,h=m.sep,S=n[a.start+1],y=S.tok,C=S.sep,E=n[a.end-1],I=E.tok,F=E.sep;if((0,xd.assertTrue)("calc.numfmt.parseDateInternal: all not AM/PM",v.kind!==1&&y.kind!==1&&I.kind!==1),!gU(F)&&!iye(u,F))return(0,ht.success)(void 0);var w=jmr(n,a)!==void 0;if(f=w,w)if(nye(h)&&nye(C))if(v.kind===0){if(p>2)return(0,ht.success)(void 0);c=v,(0,xd.assertTrue)("calc.numfmt.parseDateInternal: yr not Month",I.kind!==0),s=I}else if(y.kind===0)l=v,c=y,p===3&&((0,xd.assertTrue)("calc.numfmt.parseDateInternal: yr not Month",I.kind!==0),s=I);else return(0,ht.success)(void 0);else{if(p!==3||gU(C))return(0,ht.success)(void 0);var k=u.longDateFormat?v:y,x=u.longDateFormat?y:v;if(k.kind!==0)return(0,ht.success)(void 0);(0,xd.assertTrue)("calc.numfmt.parseDateInternal: Int1 dom & yr not Month",x.kind!==0&&I.kind!==0),l=x,c=k,s=I}else if((0,xd.assertTrue)("calc.numfmt.parseDateInternal: all not Month",v.kind!==0&&y.kind!==0&&I.kind!==0),p===2&&h===2)switch(f=!0,u.dateOrder){case As.DateOrder.MDY:c=v,s=I;break;case As.DateOrder.YMD:Tv(v.value,1,12)?(c=v,l=I):(s=v,c=I);break;case As.DateOrder.DMY:Tv(I.value,1,12)?(l=v,c=I):(c=v,s=I);break;default:return(0,ht.failure)((0,Dd.notImplemented)(["date parse date order"]))}else{if(p<3||h!==2||C!==2)return(0,ht.success)(void 0);var B=v.value>999||!t&&v.value>99?As.DateOrder.YMD:u.dateOrder;switch(B){case As.DateOrder.MDY:c=v,l=y,s=I;break;case As.DateOrder.YMD:s=v,c=y,l=I;break;case As.DateOrder.DMY:l=v,c=y,s=I;break;default:return(0,ht.failure)((0,Dd.notImplemented)(["date parse date order"]))}}}var G=!1;if(u.dateOrder!==As.DateOrder.DMY&&l===void 0&&c!==void 0&&Tv(c.value,1,12)&&s!==void 0&&Tv(s.value,1,31)){var H=oye(e,r);if(!(0,ht.isSuccess)(H))return H;s.value<=d.daysPerMonth(c.value,H.value,t)&&(l=s,s=aye(H.value,4,As.NumberShape.ASCII),G=!0)}return(0,ht.success)({yr:s,mon:c,dom:l,useMonthName:f,usingCurrentYear:G})}function Qmr(e,r,n,a,o,u,t,d,s,c){var l,f=e.config,p=f.mathpack,m=f.datepack,v=f.dateCompatibility,h,S,y;if(a!==void 0||o!==void 0||n!==void 0){if((0,xd.assertTrue)("calc.numfmt.parseDateInternal: dom || yr",o!==void 0||n!==void 0),(0,xd.assertTrue)("calc.numfmt.parseDateInternal: mon",a!==void 0),S=a.value,!Tv(S,1,12))return(0,ht.success)(void 0);if(n===void 0){var C=oye(e,r);if(!(0,ht.isSuccess)(C))return C;h=C.value}else Tv(n.value,0,99)?h=qmr(n.value):h=n.value;if(!Tv(h,1900,9999)||(y=(l=o==null?void 0:o.value)!==null&&l!==void 0?l:1,!Tv(y,1,m.daysPerMonth(S,h,v))))return(0,ht.success)(void 0)}else{var E=m.fromNum(f,p.zero,DC.Rounding.RoundSec);(0,xd.assertTrue)("calc.numfmt.parseDateInternal: zeroDtr fromNum",E!==!1),h=E.yr,S=E.mon,y=E.dom}var I=0,F=0,w=0,B=0,k=DC.Rounding.RoundSec,x=0,G,H=!0;if(u!==void 0){if(u.value<0)return(0,ht.failure)((0,Dd.notImplemented)(["negative hour"]));if(u.value>23){if(G!==void 0)return(0,ht.success)(void 0);x=u.value,G=DC.TimeDivision.Hour}else I=u.value}if(t!==void 0){if(t.value<0)return(0,ht.failure)((0,Dd.notImplemented)(["negative minute"]));if(t.value>59){if(G!==void 0)return(0,ht.success)(void 0);x=t.value,G=DC.TimeDivision.Minute}else F=t.value}if(d!==void 0){if(d.value<0)return(0,ht.failure)((0,Dd.notImplemented)(["negative second"]));if(d.value>59){if(G!==void 0)return(0,ht.success)(void 0);x=d.value,G=DC.TimeDivision.Second}else w=d.value}if(s!==void 0){if(s.value<0)return(0,ht.failure)((0,Dd.notImplemented)(["negative fractional second"]));(0,xd.assertTrue)("calc.numfmt.parseDateInternal: fracSec.digits",s.digits>=1&&s.digits<=3),k=s.digits,(0,xd.assertTrue)("calc.numfmt.parseDateInternal: fracSec.value",s.value<(k===3?1001:k===2?100:10)),B=s.value}if(c!==void 0){if(G!==void 0||I>12)return(0,ht.success)(void 0);c.am?I===12&&(I=0):I<12&&(I+=12)}var L=(0,DC.dateTime)(h,S,y,I,F,w,1,B,k),D=G!==void 0?m.toNumWithDuration(f,L,G,x):m.toNum(f,L);return(0,Dd.isErrorOper)(D)?(0,ht.success)(void 0):(0,ht.success)({value:D,duration:G})}function zmr(e,r,n,a,o,u,t,d,s,c,l,f){if(e!==As.NumberShape.ASCII)return(0,ht.failure)((0,Dd.notImplemented)(["parseDateInternal ifmt for non-ASCII"]));if(t)return(d==null?void 0:d.sep)===4?(0,ht.failure)((0,Dd.notImplemented)(["parseDateInternal ifmt for alternate time separator"])):c!==void 0?(0,ht.success)(As.KnownFormat.SS0):f!==void 0?f===DC.TimeDivision.Hour&&l===void 0&&!r?(0,ht.success)(As.KnownFormat.AbsHMMSS):(0,ht.success)(As.KnownFormat.General):r?(0,ht.success)(As.KnownFormat.MDYHMS):l!==void 0?(0,ht.success)(s!==void 0?As.KnownFormat.HHMMSSAP:As.KnownFormat.HHMMAP):(0,ht.success)(s!==void 0?As.KnownFormat.HHMMSS:As.KnownFormat.HHMM);if((0,xd.assertTrue)("calc.numfmt.parseDateInternal: !haveTime => haveDate",r),!o)return(0,ht.success)(As.KnownFormat.MMDDYY);var p=n!==void 0&&!u;return(0,ht.success)(a===void 0?As.KnownFormat.MMMYY:p?As.KnownFormat.DDMMMYY:As.KnownFormat.DDMMM)}function Ymr(e,r,n,a){var o=e.config,u=o.localeInfo;if(!u.isEastAsia&&!Lmr(u,r))return(0,ht.success)(void 0);if(u.isEastAsia)return(0,ht.failure)((0,Dd.notImplemented)(["parse East Asia date"]));if(u.isThai){var t=r.indexOf("b");if(t<0&&(t=r.indexOf("B")),t>=0&&t+1<r.length&&u.isNumeral((0,xP.stringCodePointAt)(r,t+1)))return(0,ht.failure)((0,Dd.notImplemented)(["parse Thai Buddhist date"]))}var d=Vmr(o,r,n);if(!(0,ht.isSuccess)(d)||d.value===void 0)return d;var s=d.value,c=s.tokens,l=s.bidiDate,f=s.numShape,p=s.culture;if(l===pU.BidiDate.Lunar)return(0,ht.failure)((0,Dd.notImplemented)(["Lunar calendar"]));if(p!==void 0&&(p.localCalendarInput||p.tag===pU.CultureTag.Gannen))return(0,ht.failure)((0,Dd.notImplemented)(["parse date: possible local calendar"]));var m=Wmr(o,c);if(!(0,ht.isSuccess)(m)||m.value===void 0)return m;var v=m.value,h=v.time,S=v.date,y=v.hour,C=v.min,E=v.sec,I=v.fracSec,F=v.ampm,w=Hmr(e,a,c,S);if(!(0,ht.isSuccess)(w)||w.value===void 0)return w;var B=w.value,k=B.yr,x=B.mon,G=B.dom,H=B.useMonthName,L=B.usingCurrentYear,D=Qmr(e,a,k,x,G,y==null?void 0:y.tok,C==null?void 0:C.tok,E==null?void 0:E.tok,I==null?void 0:I.tok,F==null?void 0:F.tok);if(!(0,ht.isSuccess)(D)||D.value===void 0)return D;var U=D.value,V=U.value,ne=U.duration,J=zmr(f,S!==void 0,k,G,H,L,h!==void 0,C,E,I,F,ne);return(0,ht.isSuccess)(J)?(0,ht.success)({value:V,format:J.value}):J}z2.parseDateInternal=Ymr});var yU=Y(J2=>{"use strict";_();Object.defineProperty(J2,"__esModule",{value:!0});J2.shouldInstallFormat=J2.parseEdit=void 0;var iZ=K2(),Y2=KX(),ac=E1(),Jmr=cU(),uye=SU(),fg=_v();function Xmr(e){var r=e.charAt(0);return r==="="||r==="+"||r==="-"||r==="@"}function sye(e){var r=(0,iZ.stringStartsWith)(e,"'"),n=r?e.substring(1):e;return n.length>Y2.cellStringLimit?(0,fg.failure)((0,ac.notValueString)("cell text too long")):(0,fg.success)((0,ac.stringEdit)((0,Y2.stringOper)(n),r))}function Zmr(e,r){if(e.stringCompareCI(r,e.trueName)===0)return Y2.trueOper;if(e.stringCompareCI(r,e.falseName)===0)return Y2.falseOper;for(var n=1;n<e.errorNames.length;n+=1){var a=e.errorNames[n];if(a!=null&&e.stringCompareCI(a,r)===0)return(0,Y2.errorOper)(n)}}function lye(e,r,n){return(0,uye.parseDateInternal)((0,uye.initParseDateGlobals)(e),r,n,ac.GetTimeKind.ValueCell)}function cye(e,r,n){var a=e.config,o=a.localeInfo,u=a.mathpack,t=!0,d=o.isEastAsia&&n.valueType===ac.FormatValueType.Percentage&&t,s=!1;switch(n.valueType){case ac.FormatValueType.Number:case ac.FormatValueType.Currency:case ac.FormatValueType.Percentage:case ac.FormatValueType.Fraction:case ac.FormatValueType.Scientific:case ac.FormatValueType.Accounting:s=!0;break}return(0,Jmr.parseConstInternal)(o,u,r,d,!0,s)}function $mr(e,r,n){var a=Zmr(e.config.localeInfo,r);if(a!==void 0)return(0,fg.success)((0,ac.otherEdit)(a));for(var o=n.valueType===ac.FormatValueType.Date||n.valueType===ac.FormatValueType.Time?[lye,cye]:[cye,lye],u=0,t=o;u<t.length;u++){var d=t[u],s=d(e,r,n);if(!(0,fg.isSuccess)(s))return s;if(s.value!==void 0){var c=s.value,l=c.value,f=c.format;return(0,fg.success)((0,ac.numberEdit)(l,f))}}return(0,fg.success)(void 0)}function egr(e,r,n){try{if(n.valueType===ac.FormatValueType.Text)return sye(r);if(r==="")return(0,fg.success)((0,ac.otherEdit)(Y2.blankOper));if(r.length>1&&(0,iZ.stringStartsWith)(r,"="))return(0,fg.success)((0,ac.formulaEdit)(r));if(!(0,iZ.stringStartsWith)(r,"'")){var a=$mr(e,r,n);if(!(0,fg.isSuccess)(a))return a;if(a.value!==void 0)return(0,fg.success)(a.value)}return r.length>1&&Xmr(r)?(0,fg.success)((0,ac.formulaEdit)(r)):sye(r)}catch(o){return(0,fg.failure)((0,fg.javaScriptError)(o))}}J2.parseEdit=egr;function rgr(e,r){return(e==null?void 0:e.valueType)!==ac.FormatValueType.Number&&r.valueType!==ac.FormatValueType.Number&&(e==null?void 0:e.valueType)!==r.valueType}function ngr(e,r){return e===r||r.source!==ac.NumberFormatSource.Builtin?!1:r.valueType===ac.FormatValueType.General?!0:rgr(e,r)}J2.shouldInstallFormat=ngr});var dye=Y(Cr=>{"use strict";_();Object.defineProperty(Cr,"__esModule",{value:!0});Cr.operatorNode=Cr.nameNode=Cr.missingRef=Cr.localNameUseAnnotation=Cr.localNameDeclAnnotation=Cr.literalNode=Cr.letVar=Cr.letNode=Cr.lambdaParam=Cr.lambdaNode=Cr.indexedArg=Cr.identQualifier=Cr.identNamePart=Cr.headNamePart=Cr.formulaSpan=Cr.formulaRootAnnotation=Cr.formula=Cr.flattenNameParts=Cr.flattenLetArgs=Cr.flattenLambdaArgs=Cr.fieldRefNode=Cr.fieldRefNamePart=Cr.fieldRef=Cr.errorQualifier=Cr.documentQualifier=Cr.commaOpRef=Cr.columnRef=Cr.cellRefSingle=Cr.cellRefRow=Cr.cellRefRange=Cr.cellRefNode=Cr.cellRefNamePart=Cr.cellRefError=Cr.cellRefCol=Cr.cellRefBad=Cr.badRef=Cr.badQualifier=Cr.arrayNode=Cr.appNode=Cr.appHeadNameAnnotation=Cr.StructRefKind=Cr.SpecialRefId=Cr.RefStyle=Cr.QualifierKind=Cr.PosKind=Cr.NodeKind=Cr.NamePartKind=Cr.CellRefKind=Cr.BadType=Cr.AnnotationKind=void 0;Cr.getDepthUpperBound=Cr.wsfNode=Cr.thisRowOpRef=Cr.structRefNode=Cr.structRef=Cr.specialRef=Cr.sheetRangeQualifier=Cr.sheetQualifier=Cr.relativeQualifier=Cr.rangeOpRef=Cr.pos=Cr.parenNode=Cr.paramNode=Cr.paramName=Cr.paramDefault=void 0;var Tt=et();Cr.AnnotationKind=Tt.formulaModule.AnnotationKind;Cr.BadType=Tt.formulaModule.BadType;Cr.CellRefKind=Tt.formulaModule.CellRefKind;Cr.NamePartKind=Tt.formulaModule.NamePartKind;Cr.NodeKind=Tt.formulaModule.NodeKind;Cr.PosKind=Tt.formulaModule.PosKind;Cr.QualifierKind=Tt.formulaModule.QualifierKind;Cr.RefStyle=Tt.formulaModule.RefStyle;Cr.SpecialRefId=Tt.formulaModule.SpecialRefId;Cr.StructRefKind=Tt.formulaModule.StructRefKind;Cr.appHeadNameAnnotation=Tt.formulaModule.appHeadNameAnnotation;Cr.appNode=Tt.formulaModule.appNode;Cr.arrayNode=Tt.formulaModule.arrayNode;Cr.badQualifier=Tt.formulaModule.badQualifier;Cr.badRef=Tt.formulaModule.badRef;Cr.cellRefBad=Tt.formulaModule.cellRefBad;Cr.cellRefCol=Tt.formulaModule.cellRefCol;Cr.cellRefError=Tt.formulaModule.cellRefError;Cr.cellRefNamePart=Tt.formulaModule.cellRefNamePart;Cr.cellRefNode=Tt.formulaModule.cellRefNode;Cr.cellRefRange=Tt.formulaModule.cellRefRange;Cr.cellRefRow=Tt.formulaModule.cellRefRow;Cr.cellRefSingle=Tt.formulaModule.cellRefSingle;Cr.columnRef=Tt.formulaModule.columnRef;Cr.commaOpRef=Tt.formulaModule.commaOpRef;Cr.documentQualifier=Tt.formulaModule.documentQualifier;Cr.errorQualifier=Tt.formulaModule.errorQualifier;Cr.fieldRef=Tt.formulaModule.fieldRef;Cr.fieldRefNamePart=Tt.formulaModule.fieldRefNamePart;Cr.fieldRefNode=Tt.formulaModule.fieldRefNode;Cr.flattenLambdaArgs=Tt.formulaModule.flattenLambdaArgs;Cr.flattenLetArgs=Tt.formulaModule.flattenLetArgs;Cr.flattenNameParts=Tt.formulaModule.flattenNameParts;Cr.formula=Tt.formulaModule.formula;Cr.formulaRootAnnotation=Tt.formulaModule.formulaRootAnnotation;Cr.formulaSpan=Tt.formulaModule.formulaSpan;Cr.headNamePart=Tt.formulaModule.headNamePart;Cr.identNamePart=Tt.formulaModule.identNamePart;Cr.identQualifier=Tt.formulaModule.identQualifier;Cr.indexedArg=Tt.formulaModule.indexedArg;Cr.lambdaNode=Tt.formulaModule.lambdaNode;Cr.lambdaParam=Tt.formulaModule.lambdaParam;Cr.letNode=Tt.formulaModule.letNode;Cr.letVar=Tt.formulaModule.letVar;Cr.literalNode=Tt.formulaModule.literalNode;Cr.localNameDeclAnnotation=Tt.formulaModule.localNameDeclAnnotation;Cr.localNameUseAnnotation=Tt.formulaModule.localNameUseAnnotation;Cr.missingRef=Tt.formulaModule.missingRef;Cr.nameNode=Tt.formulaModule.nameNode;Cr.operatorNode=Tt.formulaModule.operatorNode;Cr.paramDefault=Tt.formulaModule.paramDefault;Cr.paramName=Tt.formulaModule.paramName;Cr.paramNode=Tt.formulaModule.paramNode;Cr.parenNode=Tt.formulaModule.parenNode;Cr.pos=Tt.formulaModule.pos;Cr.rangeOpRef=Tt.formulaModule.rangeOpRef;Cr.relativeQualifier=Tt.formulaModule.relativeQualifier;Cr.sheetQualifier=Tt.formulaModule.sheetQualifier;Cr.sheetRangeQualifier=Tt.formulaModule.sheetRangeQualifier;Cr.specialRef=Tt.formulaModule.specialRef;Cr.structRef=Tt.formulaModule.structRef;Cr.structRefNode=Tt.formulaModule.structRefNode;Cr.thisRowOpRef=Tt.formulaModule.thisRowOpRef;Cr.wsfNode=Tt.formulaModule.wsfNode;Cr.getDepthUpperBound=Tt.formulaModule.getDepthUpperBound});var fye=Y(to=>{"use strict";_();Object.defineProperty(to,"__esModule",{value:!0});to.resolvedUserDefinedFunc=to.resolvedStructRef=to.resolvedNever=to.resolvedName=to.resolvedLocalName=to.resolvedDottedName=to.resolvedCellRef=to.resolveLocalsGrid=to.noOriginSheet=to.invalidStructRef=to.invalidQualifier=to.invalidCellRef=to.emptyIntersection=to.ResolvedKind=to.ResolveReasonKind=to.InvalidStructRefReason=to.InvalidQualifierReason=to.InvalidCellRefReason=void 0;var yf=et();to.InvalidCellRefReason=yf.resolveServiceTypes.InvalidCellRefReason;to.InvalidQualifierReason=yf.resolveServiceTypes.InvalidQualifierReason;to.InvalidStructRefReason=yf.resolveServiceTypes.InvalidStructRefReason;to.ResolveReasonKind=yf.resolveServiceTypes.ResolveReasonKind;to.ResolvedKind=yf.resolveServiceTypes.ResolvedKind;to.emptyIntersection=yf.resolveServiceTypes.emptyIntersection;to.invalidCellRef=yf.resolveServiceTypes.invalidCellRef;to.invalidQualifier=yf.resolveServiceTypes.invalidQualifier;to.invalidStructRef=yf.resolveServiceTypes.invalidStructRef;to.noOriginSheet=yf.resolveServiceTypes.noOriginSheet;to.resolveLocalsGrid=yf.resolveServiceTypes.resolveLocalsGrid;to.resolvedCellRef=yf.resolveServiceTypes.resolvedCellRef;to.resolvedDottedName=yf.resolveServiceTypes.resolvedDottedName;to.resolvedLocalName=yf.resolveServiceTypes.resolvedLocalName;to.resolvedName=yf.resolveServiceTypes.resolvedName;to.resolvedNever=yf.resolveServiceTypes.resolvedNever;to.resolvedStructRef=yf.resolveServiceTypes.resolvedStructRef;to.resolvedUserDefinedFunc=yf.resolveServiceTypes.resolvedUserDefinedFunc});var mye=Y(X2=>{"use strict";_();Object.defineProperty(X2,"__esModule",{value:!0});X2.resolveGridRef=X2.createResolver=void 0;var pye=et();X2.createResolver=pye.resolveService.createResolver;X2.resolveGridRef=pye.resolveService.resolveGridRef});var oZ=Y(Cf=>{"use strict";_();Object.defineProperty(Cf,"__esModule",{value:!0});Cf.unknownFunctionType=Cf.operatorStrings=Cf.higherOrderFunctionType=Cf.getWorksheetFuncType=Cf.getWorksheetFuncEnglishName=Cf.getOperatorType=Cf.WorksheetFuncId=Cf.OperatorId=void 0;var FR=et();Cf.OperatorId=FR.signature.OperatorId;Cf.WorksheetFuncId=FR.signature.WorksheetFuncId;Cf.getOperatorType=FR.signature.getOperatorType;Cf.getWorksheetFuncEnglishName=FR.signature.getWorksheetFuncEnglishName;Cf.getWorksheetFuncType=FR.signature.getWorksheetFuncType;Cf.higherOrderFunctionType=FR.signature.higherOrderFunctionType;Cf.operatorStrings=FR.signature.operatorStrings;Cf.unknownFunctionType=FR.signature.unknownFunctionType});var CU=Y(bv=>{"use strict";_();Object.defineProperty(bv,"__esModule",{value:!0});bv.functionType=bv.SpecialPrecs=bv.SignatureType=bv.OperKind=bv.FunctionFlags=void 0;var F3=et();bv.FunctionFlags=F3.types.FunctionFlags;bv.OperKind=F3.types.OperKind;bv.SignatureType=F3.types.SignatureType;bv.SpecialPrecs=F3.types.SpecialPrecs;bv.functionType=F3.types.functionType});var gye=Y(Jt=>{"use strict";_();Object.defineProperty(Jt,"__esModule",{value:!0});Jt.zipVisitor=Jt.voidVisitor=Jt.visitWSFNode=Jt.visitQualifier=Jt.visitOperatorNode=Jt.visitFormulaNode=Jt.visitCellRef=Jt.visitAppHeadNode=Jt.reduceTopDown_Pledge=Jt.reducePledge=Jt.reduceBottomUp_Recursive=Jt.reduceBottomUp_Pledge=Jt.reduceBottomUp_MaxDepth=Jt.reduceBottomUp_CPS=Jt.reduceBottomUp=Jt.identityVisitor=Jt.depthVisitor=Jt.constVisitor=Jt.composeVisitor=Jt.bindVisitor=Jt.binaryVisitor=Jt.ZipVisitor=Jt.PledgeReducer=Jt.IdentityVisitor=Jt.DelegatingVisitor=Jt.ConstVisitor=Jt.ComposeVisitor=Jt.BinaryVisitor=void 0;var ns=et();Jt.BinaryVisitor=ns.visitor.BinaryVisitor;Jt.ComposeVisitor=ns.visitor.ComposeVisitor;Jt.ConstVisitor=ns.visitor.ConstVisitor;Jt.DelegatingVisitor=ns.visitor.DelegatingVisitor;Jt.IdentityVisitor=ns.visitor.IdentityVisitor;Jt.PledgeReducer=ns.visitor.PledgeReducer;Jt.ZipVisitor=ns.visitor.ZipVisitor;Jt.binaryVisitor=ns.visitor.binaryVisitor;Jt.bindVisitor=ns.visitor.bindVisitor;Jt.composeVisitor=ns.visitor.composeVisitor;Jt.constVisitor=ns.visitor.constVisitor;Jt.depthVisitor=ns.visitor.depthVisitor;Jt.identityVisitor=ns.visitor.identityVisitor;Jt.reduceBottomUp=ns.visitor.reduceBottomUp;Jt.reduceBottomUp_CPS=ns.visitor.reduceBottomUp_CPS;Jt.reduceBottomUp_MaxDepth=ns.visitor.reduceBottomUp_MaxDepth;Jt.reduceBottomUp_Pledge=ns.visitor.reduceBottomUp_Pledge;Jt.reduceBottomUp_Recursive=ns.visitor.reduceBottomUp_Recursive;Jt.reducePledge=ns.visitor.reducePledge;Jt.reduceTopDown_Pledge=ns.visitor.reduceTopDown_Pledge;Jt.visitAppHeadNode=ns.visitor.visitAppHeadNode;Jt.visitCellRef=ns.visitor.visitCellRef;Jt.visitFormulaNode=ns.visitor.visitFormulaNode;Jt.visitOperatorNode=ns.visitor.visitOperatorNode;Jt.visitQualifier=ns.visitor.visitQualifier;Jt.visitWSFNode=ns.visitor.visitWSFNode;Jt.voidVisitor=ns.visitor.voidVisitor;Jt.zipVisitor=ns.visitor.zipVisitor});var vye=Y(_U=>{"use strict";_();Object.defineProperty(_U,"__esModule",{value:!0});_U.Pledge=void 0;var tgr=Cn();_U.Pledge=tgr.pledge.Pledge});var sZ=Y($2=>{"use strict";_();var pg,iu;Object.defineProperty($2,"__esModule",{value:!0});$2.evalFormat=$2.evalFormatImpl=void 0;var hye=br(),ml=O1(),F1=tS(),RU=dye(),Ke=E1(),uZ=fye(),agr=mye(),oa=oZ(),I3=CU(),igr=V2(),xl=A1(),up=_v(),_ye=gye(),op=vye(),Pv=(0,igr.typedInstanceCreator)()(function(e,r,n,a){return{strong:e,format:r,valueType:n,decimals:a}}),w3={},I1=(0,F1.createFailureErrorClass)("InferenceError"),mg={getDocumentLoc:function(){return(0,ml.assertFalse)("calc.numfmt.evalFormula: default getDocumentLoc")},getSheetIndex:function(){return(0,ml.assertFalse)("calc.numfmt.evalFormula: default getSheetIndex")},getSheetName:function(){return(0,ml.assertFalse)("calc.numfmt.evalFormula: default getSheetName")},getNameLoc:function(){return(0,ml.assertFalse)("calc.numfmt.evalFormula: default getNameLoc")},getUserDefinedFuncLoc:function(){return(0,ml.assertFalse)("calc.numfmt.evalFormula: default getUserDefinedFuncLoc")},getSheetRangeIndexes:function(){return(0,ml.assertFalse)("calc.numfmt.evalFormula: default getSheetRangeIndexes")},getCellFormat:function(){return(0,ml.assertFalse)("calc.numfmt.evalFormula: default getCellFormat")},getKnownFormat:function(){return(0,ml.assertFalse)("calc.numfmt.evalFormula: default getKnownFormat")},getIformat:function(){return(0,ml.assertFalse)("calc.numfmt.evalFormula: default getIformat")},getFormatString:function(){return(0,ml.assertFalse)("calc.numfmt.evalFormula: default getFormatString")},getContainingTable:function(){return(0,ml.assertFalse)("calc.numfmt.evalFormula: default getContainingTable")},getStructRefColumn:function(){return(0,ml.assertFalse)("calc.numfmt.evalFormula: default getStructRefColumn")},getStructRefSpecialRef:function(){return(0,ml.assertFalse)("calc.numfmt.evalFormula: default getStructRefSpecialRef")}};function ogr(e){var r,n,a,o,u,t,d,s,c,l,f,p,m,v,h,S,y,C,E,I,F,w,B,k,x,G;return{config:e.config,getDocumentLoc:(n=(r=e.getDocumentLoc)===null||r===void 0?void 0:r.bind(e))!==null&&n!==void 0?n:mg.getDocumentLoc,getSheetIndex:(o=(a=e.getSheetIndex)===null||a===void 0?void 0:a.bind(e))!==null&&o!==void 0?o:mg.getSheetIndex,getSheetName:(t=(u=e.getSheetName)===null||u===void 0?void 0:u.bind(e))!==null&&t!==void 0?t:mg.getSheetName,getNameLoc:(s=(d=e.getNameLoc)===null||d===void 0?void 0:d.bind(e))!==null&&s!==void 0?s:mg.getNameLoc,getUserDefinedFuncLoc:(l=(c=e.getUserDefinedFuncLoc)===null||c===void 0?void 0:c.bind(e))!==null&&l!==void 0?l:mg.getUserDefinedFuncLoc,getSheetRangeIndexes:(p=(f=e.getSheetRangeIndexes)===null||f===void 0?void 0:f.bind(e))!==null&&p!==void 0?p:mg.getSheetRangeIndexes,getCellFormat:(v=(m=e.getCellFormat)===null||m===void 0?void 0:m.bind(e))!==null&&v!==void 0?v:mg.getCellFormat,getKnownFormat:(S=(h=e.getKnownFormat)===null||h===void 0?void 0:h.bind(e))!==null&&S!==void 0?S:mg.getKnownFormat,getIformat:(C=(y=e.getIformat)===null||y===void 0?void 0:y.bind(e))!==null&&C!==void 0?C:mg.getIformat,getFormatString:(I=(E=e.getFormatString)===null||E===void 0?void 0:E.bind(e))!==null&&I!==void 0?I:mg.getFormatString,getContainingTable:(w=(F=e.getContainingTable)===null||F===void 0?void 0:F.bind(e))!==null&&w!==void 0?w:mg.getContainingTable,getStructRefColumn:(k=(B=e.getStructRefColumn)===null||B===void 0?void 0:B.bind(e))!==null&&k!==void 0?k:mg.getStructRefColumn,getStructRefSpecialRef:(G=(x=e.getStructRefSpecialRef)===null||x===void 0?void 0:x.bind(e))!==null&&G!==void 0?G:mg.getStructRefSpecialRef}}function Rye(e,r){var n,a,o=ogr(e);return{globals:o,locals:r,config:e.config,localeInfo:(a=(n=r.config)===null||n===void 0?void 0:n.localeInfo)!==null&&a!==void 0?a:e.config.localeInfo,mathpack:e.config.mathpack,get document(){var u=r.originSheet;if(!(0,up.isSuccess)(u))throw new I1(u);return u.value.document},get defaultFormat(){var u=Z2(this,xl.KnownFormat.General);return Pv(!1,u,u.valueType,u.decimals)},get unitlessFormat(){var u=Z2(this,xl.KnownFormat.General);return Pv(!0,u,u.valueType,u.decimals)},resolver:(0,agr.createResolver)(o),multOrDivTainted:!1}}var D3=(pg={},pg[Ke.FormatValueType.General]=0,pg[Ke.FormatValueType.Number]=1,pg[Ke.FormatValueType.Currency]=2,pg[Ke.FormatValueType.Accounting]=2,pg[Ke.FormatValueType.Percentage]=3,pg[Ke.FormatValueType.Date]=4,pg[Ke.FormatValueType.Time]=5,pg[Ke.FormatValueType.Fraction]=6,pg[Ke.FormatValueType.Scientific]=7,pg[Ke.FormatValueType.Text]=8,pg[Ke.FormatValueType.Custom]=9,pg),qp;(function(e){e[e.Propagate=-2147483648]="Propagate",e[e.Ignore=-2147483647]="Ignore"})(qp||(qp={}));var ugr=(iu={},iu[oa.WorksheetFuncId.INT]=qp.Propagate,iu[oa.WorksheetFuncId.MOD]=qp.Propagate,iu[oa.WorksheetFuncId.ROUND]=qp.Propagate,iu[oa.WorksheetFuncId.SUM]=qp.Propagate,iu[oa.WorksheetFuncId.TRUNC]=qp.Propagate,iu[oa.WorksheetFuncId.AVERAGE]=qp.Propagate,iu[oa.WorksheetFuncId.MAX]=qp.Propagate,iu[oa.WorksheetFuncId.MEDIAN]=qp.Propagate,iu[oa.WorksheetFuncId.MIN]=qp.Propagate,iu[oa.WorksheetFuncId.ROUNDUP]=qp.Propagate,iu[oa.WorksheetFuncId.ROUNDDOWN]=qp.Propagate,iu[oa.WorksheetFuncId.NPV]=xl.KnownFormat.CoCurrencyDec,iu[oa.WorksheetFuncId.PV]=xl.KnownFormat.CoCurrencyDec,iu[oa.WorksheetFuncId.FV]=xl.KnownFormat.CoCurrencyDec,iu[oa.WorksheetFuncId.PMT]=xl.KnownFormat.CoCurrencyDec,iu[oa.WorksheetFuncId.RATE]=xl.KnownFormat.Pct0,iu[oa.WorksheetFuncId.MIRR]=xl.KnownFormat.Pct0,iu[oa.WorksheetFuncId.IRR]=xl.KnownFormat.Pct0,iu[oa.WorksheetFuncId.DATE]=xl.KnownFormat.MMDDYY,iu[oa.WorksheetFuncId.TIME]=xl.KnownFormat.HHMMAP,iu[oa.WorksheetFuncId.NOW]=xl.KnownFormat.MDYHMS,iu[oa.WorksheetFuncId.SLN]=xl.KnownFormat.CoCurrencyDec,iu[oa.WorksheetFuncId.SYD]=xl.KnownFormat.CoCurrencyDec,iu[oa.WorksheetFuncId.DDB]=xl.KnownFormat.CoCurrencyDec,iu[oa.WorksheetFuncId.IPMT]=xl.KnownFormat.CoCurrencyDec,iu[oa.WorksheetFuncId.PPMT]=xl.KnownFormat.CoCurrencyDec,iu[oa.WorksheetFuncId.TODAY]=xl.KnownFormat.MMDDYY,iu[oa.WorksheetFuncId.VDB]=xl.KnownFormat.CoCurrencyDec,iu[oa.WorksheetFuncId.DB]=xl.KnownFormat.CoCurrencyDec,iu);function sgr(e){var r;return(r=ugr[e])!==null&&r!==void 0?r:qp.Ignore}var lgr=[[Ke.FormatValueType.General,Ke.FormatValueType.Number,Ke.FormatValueType.Currency,Ke.FormatValueType.Percentage,Ke.FormatValueType.Date,Ke.FormatValueType.Time,Ke.FormatValueType.Fraction,Ke.FormatValueType.Scientific,Ke.FormatValueType.Text,Ke.FormatValueType.Custom],[Ke.FormatValueType.General,Ke.FormatValueType.Number,Ke.FormatValueType.Currency,Ke.FormatValueType.Percentage,Ke.FormatValueType.Date,Ke.FormatValueType.Time,Ke.FormatValueType.Number,Ke.FormatValueType.Scientific,Ke.FormatValueType.Text,Ke.FormatValueType.Custom],[Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.Currency,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.Currency,Ke.FormatValueType.Currency,Ke.FormatValueType.Text,Ke.FormatValueType.Custom],[Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.Percentage,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.Percentage,Ke.FormatValueType.Percentage,Ke.FormatValueType.Text,Ke.FormatValueType.Custom],[Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.Date,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.Text,Ke.FormatValueType.Custom],[Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.Time,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.Text,Ke.FormatValueType.Custom],[Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.Fraction,Ke.FormatValueType.Scientific,Ke.FormatValueType.Text,Ke.FormatValueType.Custom],[Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.Scientific,Ke.FormatValueType.Text,Ke.FormatValueType.Custom],[Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.Text,Ke.FormatValueType.Custom],[Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.Custom]],cgr=[[Ke.FormatValueType.General,Ke.FormatValueType.Number,Ke.FormatValueType.Currency,Ke.FormatValueType.General,Ke.FormatValueType.Date,Ke.FormatValueType.Time,Ke.FormatValueType.Fraction,Ke.FormatValueType.Scientific,Ke.FormatValueType.Text,Ke.FormatValueType.Custom],[Ke.FormatValueType.General,Ke.FormatValueType.Number,Ke.FormatValueType.Currency,Ke.FormatValueType.Number,Ke.FormatValueType.Date,Ke.FormatValueType.Time,Ke.FormatValueType.Fraction,Ke.FormatValueType.Scientific,Ke.FormatValueType.Text,Ke.FormatValueType.Custom],[Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.Currency,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.Currency,Ke.FormatValueType.Currency,Ke.FormatValueType.Text,Ke.FormatValueType.Custom],[Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.Percentage,Ke.FormatValueType.Date,Ke.FormatValueType.Time,Ke.FormatValueType.Percentage,Ke.FormatValueType.Scientific,Ke.FormatValueType.Text,Ke.FormatValueType.Custom],[Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.Date,Ke.FormatValueType.Date,Ke.FormatValueType.Text,Ke.FormatValueType.Custom],[Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.Time,Ke.FormatValueType.Time,Ke.FormatValueType.Text,Ke.FormatValueType.Custom],[Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.Fraction,Ke.FormatValueType.Scientific,Ke.FormatValueType.Text,Ke.FormatValueType.Custom],[Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.Scientific,Ke.FormatValueType.Text,Ke.FormatValueType.Custom],[Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.Text,Ke.FormatValueType.Custom],[Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.General,Ke.FormatValueType.Custom]];function Tye(e,r){if(typeof r!="number")return r;var n=e.globals.getIformat(e.document,r);if(!(0,up.isSuccess)(n))throw new I1(n.reason);return n.value}function Z2(e,r){var n=e.globals.getKnownFormat(e.document,r);if(!(0,up.isSuccess)(n))throw new I1(n.reason);return n.value}function bye(e,r){if(typeof r=="number")return r;var n=e.globals.getFormatString(e.document,r.formatString);if(!(0,up.isSuccess)(n))throw new I1(n.reason);return n.value!==void 0?n.value:r}function M3(e,r,n){(0,ml.assertTrue)("calc.numfmt.evalFormula: well-formed bin op",r.length===2);var a=r[0],o=r[1];return n(e,a,o)}function Pye(e,r,n,a){var o=n[0],u=a[0],t=D3[o.valueType],d=D3[u.valueType],s=t<=d?r[t][d]:r[d][t],c=D3[s],l=u.decimals>o.decimals?u.decimals:o.decimals;switch(c){case t:return Pv(!0,o.format,o.valueType,l);case d:return Pv(!0,u.format,u.valueType,l);default:return e.unitlessFormat}}function Sye(e,r,n){return Pye(e,cgr,r,n)}function dgr(e,r,n){var a=r[0],o=n[0];if(a.format===o.format&&a.valueType===o.valueType&&a.valueType===Ke.FormatValueType.Time)return Pv(!0,a.format,a.valueType,a.decimals);if(a.valueType===Ke.FormatValueType.Date&&o.valueType===Ke.FormatValueType.Time||a.valueType===Ke.FormatValueType.Time&&o.valueType===Ke.FormatValueType.Date){var u=Z2(e,xl.KnownFormat.MDYHMS),t=u.valueType,d=u.decimals;return Pv(!0,u,t,d)}return Pye(e,lgr,r,n)}var fgr=function(r){return r.unitlessFormat};function pgr(e,r,n){var a=r[0],o=n[0];return a.format===o.format?Pv(!0,a.format,a.valueType,a.decimals):e.unitlessFormat}function mgr(e,r,n){switch(r){case oa.OperatorId.Mul:case oa.OperatorId.Div:return e.multOrDivTainted=!0,M3(e,n,Sye);case oa.OperatorId.Pow:return M3(e,n,Sye);case oa.OperatorId.Add:case oa.OperatorId.Sub:return M3(e,n,dgr);case oa.OperatorId.Percent:{(0,ml.assertTrue)("calc.numfmt.evalFormat: well-formed unary op",n.length===1);var a=n[0],o=a[0],u=a[1];if(!(0,F1.isNumberLiteralNode)(u))return e.defaultFormat;var t=o.strong,d=o.decimals,s=Z2(e,xl.KnownFormat.Pct);return Pv(t,s,s.valueType,d)}case oa.OperatorId.Pound:case oa.OperatorId.At:return e.defaultFormat;case oa.OperatorId.Neg:case oa.OperatorId.Pos:{(0,ml.assertTrue)("calc.numfmt.evalFormat: well-formed unary op",n.length===1);var o=n[0][0];return o}case oa.OperatorId.Lt:case oa.OperatorId.Le:case oa.OperatorId.Eq:case oa.OperatorId.Ge:case oa.OperatorId.Gt:case oa.OperatorId.Ne:return M3(e,n,fgr);case oa.OperatorId.Isect:case oa.OperatorId.Union:case oa.OperatorId.Range:case oa.OperatorId.Concat:return M3(e,n,pgr);case oa.OperatorId.And:case oa.OperatorId.Or:case oa.OperatorId.Xor:case oa.OperatorId.Min:case oa.OperatorId.Max:throw new I1((0,F1.notImplemented)(["evalFormat for Yellow ops"]));default:return(0,ml.assertNever)("calc.numfmt.evalFormat: unexpected operator id",r)}}function yye(e){return D3[e]===D3[Ke.FormatValueType.General]}var ggr=function(){function e(r){var n=this;this.context=r,this.visitFormulaNode=function(a){return(0,_ye.visitFormulaNode)(n,a)},this.lazyVisitFormulaNode=function(a){return op.Pledge.resolve(a).bind(n.visitFormulaNode)}}return e.prototype.literalNode=function(r){switch(r.kind){case I3.OperKind.String:case I3.OperKind.Boolean:case I3.OperKind.Error:case I3.OperKind.Missing:return op.Pledge.resolve(this.context.defaultFormat);case I3.OperKind.Number:var n=21,a=this.context.mathpack.formatGeneral(this.context.localeInfo,this.context.mathpack.abs(r),n),o=a.indexOf(this.context.localeInfo.decimalSeparator),u=o>=0?a.length-o-1:0,t=Z2(this.context,xl.KnownFormat.General);return op.Pledge.resolve(Pv(!1,t,t.valueType,u));default:return(0,ml.assertNever)("calc.numfmt.evalFormat: unexpected literal oper",r)}},e.prototype.arrayNode=function(r){return op.Pledge.resolve(this.context.defaultFormat)},e.prototype.appNode=function(r,n){var a=this;if((0,F1.isOperatorNode)(r))return op.Pledge.all(n.map(function(f){return a.lazyVisitFormulaNode(f).bind(function(p){return[p,f]})})).bind(function(f){return mgr(a.context,r.id,f)});if((0,F1.isWSFNode)(r)){var o=r.id,u=sgr(o),t=(0,oa.getWorksheetFuncType)(o),d=(0,F1.getArguments)(n);if((0,ml.assertTrue)("calc.numfmt.evalFormula: well-formed WSF args",(0,F1.isValidArgsLength)(t,d.length)),u===qp.Ignore)return op.Pledge.resolve(this.context.defaultFormat);if(u===qp.Propagate)return d.length===0?op.Pledge.resolve(this.context.defaultFormat):op.Pledge.all(n.map(this.lazyVisitFormulaNode)).bind(function(f){var p=f[0],m=p.format,v=p.valueType,h=p.decimals,S=!yye(v);if(!p.strong&&S)return a.context.unitlessFormat;for(var y=S,C=1;C<f.length;C+=1){var E=f[C],I=!yye(E.valueType);if(!E.strong&&I)return a.context.unitlessFormat;y||(m=E.format,v=E.valueType,h=E.decimals,y=I)}return Pv(!0,m,v,h)});var s=Z2(this.context,u),c=s.valueType,l=s.decimals;return op.Pledge.resolve(Pv(!0,s,c,l))}return this.lazyVisitFormulaNode(r)},e.prototype.letNode=function(r,n,a,o){return op.Pledge.resolve(this.context.defaultFormat)},e.prototype.lambdaNode=function(r,n,a,o){return op.Pledge.resolve(this.context.defaultFormat)},e.prototype.parenNode=function(r){return this.lazyVisitFormulaNode(r)},e.prototype.nameNode=function(r,n){return op.Pledge.resolve(this.context.defaultFormat)},e.prototype.cellRefNode=function(r,n){var a=this.context.resolver.resolveCellRef(this.context.locals,(0,RU.cellRefNode)(r,n)).resolution;if(!(0,up.isSuccess)(a))throw(0,ml.assertTrue)("calc.numfmt.evalFormat: NoOriginSheet",a.reason.kind!==uZ.ResolveReasonKind.NoOriginSheet),new I1(a.reason);var o=a.value;if(o===void 0)throw w3;return(0,F1.isSheetGridRange)(o)?op.Pledge.resolve(Cye(this.context,o)):op.Pledge.resolve(this.context.unitlessFormat)},e.prototype.fieldRefNode=function(r,n){var a=this;return this.lazyVisitFormulaNode(r).bind(function(o){return a.context.defaultFormat})},e.prototype.structRefNode=function(r,n){var a=(0,RU.structRefNode)(r,n),o=this.context.resolver.resolveStructRef(this.context.locals,a).resolution;if(!(0,up.isSuccess)(o))throw(0,ml.assertTrue)("calc.numfmt.evalFormat: NoOriginSheet",o.reason.kind!==uZ.ResolveReasonKind.NoOriginSheet),o.reason.kind===uZ.ResolveReasonKind.EmptyIntersection?w3:new I1(o.reason);var u=o.value;if(u===void 0)throw w3;return op.Pledge.resolve(Cye(this.context,u))},e.prototype.missingNode=function(r){return(0,ml.assertFalse)("calc.numfmt.evalFormat: unexpected missing node")},e.prototype.badSequenceNode=function(r,n){return(0,ml.assertFalse)("calc.numfmt.evalFormat: unexpected bad node")},e.prototype.badCharsNode=function(r,n){return(0,ml.assertFalse)("calc.numfmt.evalFormat: unexpected bad node")},e.prototype.operatorNode=function(r,n){return op.Pledge.resolve((0,RU.operatorNode)(r,n))},e.prototype.wsfNode=function(r,n,a){return op.Pledge.resolve((0,RU.wsfNode)(r,n,a))},e}();function Eye(e,r){return(0,_ye.reducePledge)(new ggr(e),r)}function Cye(e,r){var n=(0,F1.sheetGridRangeAnchor)(r),a=e.globals.getCellFormat(n);if(!(0,up.isSuccess)(a))throw new I1(a.reason);var o=a.value,u=Tye(e,o);if(!(0,F1.isDocumentLocEqual)(n.sheet.document,e.document)&&(typeof o!="number"||u.source!==Ke.NumberFormatSource.Builtin))return e.defaultFormat;var t=u.valueType,d=u.decimals;return Pv(!0,o,t,d)}function vgr(e,r){var n=r.strong,a=r.format,o=r.valueType,u=r.decimals;if(!(o===Ke.FormatValueType.Number&&e.multOrDivTainted)){if(u>0&&n&&(o===Ke.FormatValueType.Number||o===Ke.FormatValueType.Currency||o===Ke.FormatValueType.Accounting||o===Ke.FormatValueType.Percentage)){var t=Tye(e,a);u!==t.decimals&&(a=t.synthesizeDecimals(u))}if(!(o===Ke.FormatValueType.General||!n))return a=bye(e,a),a}}function hgr(e,r,n){try{var a=Rye(e,r),o=Eye(a,n);return(0,up.success)(hye.__assign(hye.__assign({},o),{format:bye(a,o.format),mulOrDivTainted:a.multOrDivTainted}))}catch(u){return u instanceof I1?(0,up.failure)(u.reason):u===w3?up.successUndefined:(0,up.failure)((0,up.javaScriptError)(u))}}$2.evalFormatImpl=hgr;function Sgr(e,r,n){try{var a=Rye(e,r),o=Eye(a,n);return(0,up.success)(vgr(a,o))}catch(u){return u instanceof I1?(0,up.failure)(u.reason):u===w3?up.successUndefined:(0,up.failure)((0,up.javaScriptError)(u))}}$2.evalFormat=Sgr});var Aye=Y(eO=>{"use strict";_();Object.defineProperty(eO,"__esModule",{value:!0});eO.numberComponents=eO.formatScientificLeft=void 0;var Nye=et();eO.formatScientificLeft=Nye.mathpack.formatScientificLeft;eO.numberComponents=Nye.mathpack.numberComponents});var EU=Y(IR=>{"use strict";_();Object.defineProperty(IR,"__esModule",{value:!0});IR.renderHashesValue=IR.renderValue=IR.renderGeneral=void 0;var fo=E1(),kye=tS(),LP=O1(),x3=V2(),lZ=N3(),PU=K2(),Up=_v(),ygr=function(r){return r.kind!==fo.FormattedUnitKind.General},Oye=function(r){return r.kind!==fo.FormattedUnitKind.Flexible},mZ=255;function TU(e,r,n){if(r&fo.Clip.MaxChars&&n.length>mZ)return fo.Clip.MaxChars;if(r&fo.Clip.CellWidth&&e.renderWidth<1/0&&e.getTextWidth(n)>e.renderWidth)return fo.Clip.CellWidth}function cZ(e,r,n,a,o,u,t){var d=(0,x3.fastMax)(0,mZ-n.length-a.length),s=o.length===0?d:Math.floor(d/o.length);if(e.renderWidth!==1/0){var c=e.getTextWidth(o);c>0&&(s=(0,x3.fastMin)(s,(0,x3.fastMax)(Math.floor((e.renderWidth-e.getTextWidth(n+a))/c),0)))}var l=t(s),f=e.bestFit;if(f&&u&&(l===!1||l.indexOf("E")>=0)){for(var p=1,m=l;(m===!1||m.indexOf("E")>=0)&&s+p<=fZ;)m=t(s+p),p++;if(m!==!1)return m}var v;if(l===!1||(v=TU(e,r,n+l+a))===void 0){for(var h=l,S=s+1;S<s+50;S+=1){var y=t(S);if(y!==!1){if(y===h)break;var C=TU(e,r,n+y+a);if(C!==void 0){h===!1&&(h=C);break}h=y}}return(0,LP.assertTrue)("calc.numfmt.renderValue: false after upwards search",h!==!1),h}for(var E=v,S=s-1;S>=0;S-=1){var y=t(S);if(y===!1)break;var C=TU(e,r,n+y+a);if(C===void 0)return y;E=C}return E}var bU=(0,kye.createFailureErrorClass)("RenderHashesError"),dZ=(0,kye.createFailureErrorClass)("RenderError"),fZ=11;function pZ(e,r,n){var a=e.fromNumber(r.num),o=r.includeSign&&e.cond(a)<0?"-":"",u=o+e.formatGeneral(r,e.abs(a),n-o.length);if(u==="-0"&&(u="0"),u.length>n)return(0,Up.success)(!1);var t=u.indexOf("E");if(t>=0){var d=(0,lZ.convertNumberShape)(r,u.substring(0,t),r.expNumberShape);if(!(0,Up.isSuccess)(d))return d;var s=u.substring(t,t+2),c=(0,lZ.convertDigitsShape)(u.substring(t+2),r.expNumberShape);return(0,LP.assertTrue)("calc.numfmt.render: formatGeneral ePart",s==="E-"||s==="E+"),(0,Up.success)(d.value+s+c)}var l=(0,lZ.convertNumberShape)(r,u,r.numberShape);return(0,Up.isSuccess)(l)?(0,Up.success)(l.value):l}IR.renderGeneral=pZ;function Cgr(e,r,n){var a=r.units,o=r.color,u=r.alignment,t=r.clip,d=(0,fo.memoizedRenderCallback)(n),s;if(a.every(ygr))s=a;else if(d.renderWidth===1/0)s=a.map(function(H){if(H.kind!==fo.FormattedUnitKind.General)return H;var L=pZ(e,H,fZ);if(!(0,Up.isSuccess)(L))throw new dZ(L.reason);return(0,LP.assertTrue)("calc.numfmt.renderValue: false after format at defaultGenPrecision",L.value!==!1),(0,fo.formattedUnitString)(L.value)});else{for(var c="",l="",f=void 0,p=void 0,m=0;m<a.length;m+=1){var v=a[m];switch(v.kind){case fo.FormattedUnitKind.String:case fo.FormattedUnitKind.Blank:f!==void 0?l+=v.str:c+=v.str;break;case fo.FormattedUnitKind.General:(0,LP.assertTrue)("calc.numfmt.renderValue: expected a single General unit",f===void 0),f=m,p=v;break;case fo.FormattedUnitKind.Flexible:break}}(0,LP.assertTrue)("calc.numfmt.renderValue: genUnit",f!==void 0&&p!==void 0);var h=p,S=cZ(d,t,c,l,"0",h.builtin,function(H){var L=pZ(e,h,(0,x3.fastMin)(H,fZ));if(!(0,Up.isSuccess)(L))throw new dZ(L.reason);return L.value});if(typeof S=="number")throw new bU((0,fo.tooWide)(S));s=a.map(function(H){return H.kind===fo.FormattedUnitKind.General?(0,fo.formattedUnitString)(S):H})}var y;if(s.every(Oye))y=s;else if(d.renderWidth===1/0||d.bestFit)y=s.filter(Oye);else{for(var c="",l="",C,E=void 0,m=0;m<s.length;m+=1){var I=s[m];switch(I.kind){case fo.FormattedUnitKind.String:case fo.FormattedUnitKind.Blank:C!==void 0?l+=I.str:c+=I.str;break;case fo.FormattedUnitKind.Flexible:C=m,E=I;break}}(0,LP.assertTrue)("calc.numfmt.renderValue: lastFlexUnit",C!==void 0&&E!==void 0);var F=E,w=cZ(d,fo.Clip.All,c,l,E.str,!1,function(D){return(0,PU.repeat)(F.str,D)});if(typeof w=="number"){if(w&t)throw new bU((0,fo.tooWide)(w));w=""}var B=w.length/F.str.length;B=(0,x3.fastMax)(B-1,0);var k=(0,PU.repeat)(F.str,B);y=s.map(function(D,U){return D.kind!==fo.FormattedUnitKind.Flexible?D:(0,fo.formattedUnitString)(U===C?k:"")})}if(t!==fo.Clip.None){for(var x="",m=0;m<y.length;m+=1)x+=y[m].str;var G=TU(d,t,x);if(d.bestFit&&G===fo.Clip.CellWidth)return(0,fo.renderedValue)(y,o,u,t);if(G!==void 0)throw new bU((0,fo.tooWide)(G))}return(0,fo.renderedValue)(y,o,u,t)}function _gr(e,r,n){try{return(0,fo.isHashesValue)(r)?(0,Up.success)((0,fo.hashesValue)(r.units,r.color)):(0,Up.success)(Cgr(e,r,n))}catch(a){return a instanceof bU?(0,Up.success)((0,fo.hashesValue)(a.reason,r.color)):a instanceof dZ?(0,Up.failure)(a.reason):(0,Up.failure)((0,Up.javaScriptError)(a))}}IR.renderValue=_gr;function Rgr(e,r){try{var n=(0,fo.memoizedRenderCallback)(r),a=cZ(n,e.clip,"","","#",!1,function(u){return(0,PU.repeat)("#",u)});if(typeof a=="number")switch(a){case fo.Clip.MaxChars:a=(0,PU.repeat)("#",mZ);break;case fo.Clip.CellWidth:a="";break;default:return(0,LP.assertNever)("calc.numFmt.renderHashesValue",a)}var o=(0,fo.formattedUnitString)(a);return(0,Up.success)((0,fo.renderedValue)([o],e.color,e.alignment,e.clip))}catch(u){return(0,Up.failure)((0,Up.javaScriptError)(u))}}IR.renderHashesValue=Rgr});var Fye=Y(M1=>{"use strict";_();Object.defineProperty(M1,"__esModule",{value:!0});M1.kindAnonymizers=M1.anonymizeMagnitude=M1.anonymizeFormulaString=M1.anonymize=void 0;var NU=Cn();M1.anonymize=NU.anonymizer.anonymize;M1.anonymizeFormulaString=NU.anonymizer.anonymizeFormulaString;M1.anonymizeMagnitude=NU.anonymizer.anonymizeMagnitude;M1.kindAnonymizers=NU.anonymizer.kindAnonymizers});var vZ=Y(rO=>{"use strict";_();var Ba;Object.defineProperty(rO,"__esModule",{value:!0});rO.convertKnownLCID=rO.getBundledLocaleInfo=void 0;var Ya=W2(),Iye=O1(),Mye={ar:[["\u064A\u0646\u0627\u064A\u0631","\u0641\u0628\u0631\u0627\u064A\u0631","\u0645\u0627\u0631\u0633","\u0623\u0628\u0631\u064A\u0644","\u0645\u0627\u064A\u0648","\u064A\u0648\u0646\u064A\u0648","\u064A\u0648\u0644\u064A\u0648","\u0623\u063A\u0633\u0637\u0633","\u0633\u0628\u062A\u0645\u0628\u0631","\u0623\u0643\u062A\u0648\u0628\u0631","\u0646\u0648\u0641\u0645\u0628\u0631","\u062F\u064A\u0633\u0645\u0628\u0631"],["\u064A\u0646\u0627\u064A\u0631","\u0641\u0628\u0631\u0627\u064A\u0631","\u0645\u0627\u0631\u0633","\u0623\u0628\u0631\u064A\u0644","\u0645\u0627\u064A\u0648","\u064A\u0648\u0646\u064A\u0648","\u064A\u0648\u0644\u064A\u0648","\u0623\u063A\u0633\u0637\u0633","\u0633\u0628\u062A\u0645\u0628\u0631","\u0623\u0643\u062A\u0648\u0628\u0631","\u0646\u0648\u0641\u0645\u0628\u0631","\u062F\u064A\u0633\u0645\u0628\u0631"],["\u0627\u0644\u0623\u062D\u062F","\u0627\u0644\u0625\u062B\u0646\u064A\u0646","\u0627\u0644\u062B\u0644\u0627\u062B\u0627\u0621","\u0627\u0644\u0623\u0631\u0628\u0639\u0627\u0621","\u0627\u0644\u062E\u0645\u064A\u0633","\u0627\u0644\u062C\u0645\u0639\u0629","\u0627\u0644\u0633\u0628\u062A"],["\u0627\u0644\u0623\u062D\u062F","\u0627\u0644\u0625\u062B\u0646\u064A\u0646","\u0627\u0644\u062B\u0644\u0627\u062B\u0627\u0621","\u0627\u0644\u0623\u0631\u0628\u0639\u0627\u0621","\u0627\u0644\u062E\u0645\u064A\u0633","\u0627\u0644\u062C\u0645\u0639\u0629","\u0627\u0644\u0633\u0628\u062A"],["\u0635","\u0645"],"z"],en:[["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["AM","PM"],"z"],es:[["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","set","oct.","nov.","dic."],["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],["do.","lu.","ma.","mi.","ju.","vi.","s\xE1."],["domingo","lunes","martes","mi\xE9rcoles","jueves","viernes","s\xE1bado"],["a. m.","p. m."],"z"],fr:[["janv.","f\xE9vr.","mars","avr.","mai","juin","juil.","ao\xFBt","sept.","oct.","nov.","d\xE9c."],["janvier","f\xE9vrier","mars","avril","mai","juin","juillet","ao\xFBt","septembre","octobre","novembre","d\xE9cembre"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],"en","z"],zh:[["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708"],["\u4E00\u6708","\u4E8C\u6708","\u4E09\u6708","\u56DB\u6708","\u4E94\u6708","\u516D\u6708","\u4E03\u6708","\u516B\u6708","\u4E5D\u6708","\u5341\u6708","\u5341\u4E00\u6708","\u5341\u4E8C\u6708"],["\u9031\u65E5","\u9031\u4E00","\u9031\u4E8C","\u9031\u4E09","\u9031\u56DB","\u9031\u4E94","\u9031\u516D"],["\u661F\u671F\u65E5","\u661F\u671F\u4E00","\u661F\u671F\u4E8C","\u661F\u671F\u4E09","\u661F\u671F\u56DB","\u661F\u671F\u4E94","\u661F\u671F\u516D"],["\u4E0A\u5348","\u4E0B\u5348"],"s"],de:[["Jan","Feb","Mrz","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],["Januar","Februar","M\xE4rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],["So","Mo","Di","Mi","Do","Fr","Sa"],["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],"en","z"],hr:[["sij","vlj","o\u017Eu","tra","svi","lip","srp","kol","ruj","lis","stu","pro"],["sije\u010Danj","velja\u010Da","o\u017Eujak","travanj","svibanj","lipanj","srpanj","kolovoz","rujan","listopad","studeni","prosinac"],["ned","pon","uto","sri","\u010Det","pet","sub"],["nedjelja","ponedjeljak","utorak","srijeda","\u010Detvrtak","petak","subota"],"en","z"],nl:[["jan","feb","mrt","apr","mei","jun","jul","aug","sep","okt","nov","dec"],["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],["zo","ma","di","wo","do","vr","za"],["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],"en","z"],sv:[["jan","feb","mar","apr","maj","jun","jul","aug","sep","okt","nov","dec"],["januari","februari","mars","april","maj","juni","juli","augusti","september","oktober","november","december"],["s\xF6n","m\xE5n","tis","ons","tor","fre","l\xF6r"],["s\xF6ndag","m\xE5ndag","tisdag","onsdag","torsdag","fredag","l\xF6rdag"],"en","z"],it:[["gen","feb","mar","apr","mag","giu","lug","ago","set","ott","nov","dic"],["gennaio","febbraio","marzo","aprile","maggio","giugno","luglio","agosto","settembre","ottobre","novembre","dicembre"],["dom","lun","mar","mer","gio","ven","sab"],["domenica","luned\xEC","marted\xEC","mercoled\xEC","gioved\xEC","venerd\xEC","sabato"],"en","z"],ro:[["ian.","feb.","mar.","apr.","mai","iun.","iul.","aug.","sept.","oct.","nov.","dec."],["ianuarie","februarie","martie","aprilie","mai","iunie","iulie","august","septembrie","octombrie","noiembrie","decembrie"],["dum.","lun.","mar.","mie.","joi","vin.","s\xE2m."],["duminic\u0103","luni","mar\u021Bi","miercuri","joi","vineri","s\xE2mb\u0103t\u0103"],["a.m.","p.m."],"z"],ru:[["\u044F\u043D\u0432","\u0444\u0435\u0432","\u043C\u0430\u0440","\u0430\u043F\u0440","\u043C\u0430\u0439","\u0438\u044E\u043D","\u0438\u044E\u043B","\u0430\u0432\u0433","\u0441\u0435\u043D","\u043E\u043A\u0442","\u043D\u043E\u044F","\u0434\u0435\u043A"],["\u042F\u043D\u0432\u0430\u0440\u044C","\u0424\u0435\u0432\u0440\u0430\u043B\u044C","\u041C\u0430\u0440\u0442","\u0410\u043F\u0440\u0435\u043B\u044C","\u041C\u0430\u0439","\u0418\u044E\u043D\u044C","\u0418\u044E\u043B\u044C","\u0410\u0432\u0433\u0443\u0441\u0442","\u0421\u0435\u043D\u0442\u044F\u0431\u0440\u044C","\u041E\u043A\u0442\u044F\u0431\u0440\u044C","\u041D\u043E\u044F\u0431\u0440\u044C","\u0414\u0435\u043A\u0430\u0431\u0440\u044C"],["\u0412\u0441","\u041F\u043D","\u0412\u0442","\u0421\u0440","\u0427\u0442","\u041F\u0442","\u0421\u0431"],["\u0432\u043E\u0441\u043A\u0440\u0435\u0441\u0435\u043D\u044C\u0435","\u043F\u043E\u043D\u0435\u0434\u0435\u043B\u044C\u043D\u0438\u043A","\u0432\u0442\u043E\u0440\u043D\u0438\u043A","\u0441\u0440\u0435\u0434\u0430","\u0447\u0435\u0442\u0432\u0435\u0440\u0433","\u043F\u044F\u0442\u043D\u0438\u0446\u0430","\u0441\u0443\u0431\u0431\u043E\u0442\u0430"],"en","z"],sr:[["jan","feb","mar","apr","maj","jun","jul","avg","sep","okt","nov","dec"],["januar","februar","mart","april","maj","jun","jul","avgust","septembar","oktobar","novembar","decembar"],["ned","pon","uto","sre","\u010Det","pet","sub"],["nedelja","ponedeljak","utorak","sreda","\u010Detvrtak","petak","subota"],["pre podne","po podne"],"z"],uk:[["\u0421\u0456\u0447","\u041B\u044E\u0442","\u0411\u0435\u0440","\u041A\u0432\u0456","\u0422\u0440\u0430","\u0427\u0435\u0440","\u041B\u0438\u043F","\u0421\u0435\u0440","\u0412\u0435\u0440","\u0416\u043E\u0432","\u041B\u0438\u0441","\u0413\u0440\u0443"],["\u0441\u0456\u0447\u0435\u043D\u044C","\u043B\u044E\u0442\u0438\u0439","\u0431\u0435\u0440\u0435\u0437\u0435\u043D\u044C","\u043A\u0432\u0456\u0442\u0435\u043D\u044C","\u0442\u0440\u0430\u0432\u0435\u043D\u044C","\u0447\u0435\u0440\u0432\u0435\u043D\u044C","\u043B\u0438\u043F\u0435\u043D\u044C","\u0441\u0435\u0440\u043F\u0435\u043D\u044C","\u0432\u0435\u0440\u0435\u0441\u0435\u043D\u044C","\u0436\u043E\u0432\u0442\u0435\u043D\u044C","\u043B\u0438\u0441\u0442\u043E\u043F\u0430\u0434","\u0433\u0440\u0443\u0434\u0435\u043D\u044C"],["\u041D\u0434","\u041F\u043D","\u0412\u0442","\u0421\u0440","\u0427\u0442","\u041F\u0442","\u0421\u0431"],["\u043D\u0435\u0434\u0456\u043B\u044F","\u043F\u043E\u043D\u0435\u0434\u0456\u043B\u043E\u043A","\u0432\u0456\u0432\u0442\u043E\u0440\u043E\u043A","\u0441\u0435\u0440\u0435\u0434\u0430","\u0447\u0435\u0442\u0432\u0435\u0440","\u043F'\u044F\u0442\u043D\u0438\u0446\u044F","\u0441\u0443\u0431\u043E\u0442\u0430"],"en","z"],bg:[["\u044F\u043D\u0443","\u0444\u0435\u0432","\u043C\u0430\u0440","\u0430\u043F\u0440","\u043C\u0430\u0439","\u044E\u043D\u0438","\u044E\u043B\u0438","\u0430\u0432\u0433","\u0441\u0435\u043F","\u043E\u043A\u0442","\u043D\u043E\u0435","\u0434\u0435\u043A"],["\u044F\u043D\u0443\u0430\u0440\u0438","\u0444\u0435\u0432\u0440\u0443\u0430\u0440\u0438","\u043C\u0430\u0440\u0442","\u0430\u043F\u0440\u0438\u043B","\u043C\u0430\u0439","\u044E\u043D\u0438","\u044E\u043B\u0438","\u0430\u0432\u0433\u0443\u0441\u0442","\u0441\u0435\u043F\u0442\u0435\u043C\u0432\u0440\u0438","\u043E\u043A\u0442\u043E\u043C\u0432\u0440\u0438","\u043D\u043E\u0435\u043C\u0432\u0440\u0438","\u0434\u0435\u043A\u0435\u043C\u0432\u0440\u0438"],["\u043D\u0435\u0434","\u043F\u043E\u043D","\u0432\u0442","\u0441\u0440","\u0447\u0435\u0442\u0432","\u043F\u0435\u0442","\u0441\u044A\u0431"],["\u043D\u0435\u0434\u0435\u043B\u044F","\u043F\u043E\u043D\u0435\u0434\u0435\u043B\u043D\u0438\u043A","\u0432\u0442\u043E\u0440\u043D\u0438\u043A","\u0441\u0440\u044F\u0434\u0430","\u0447\u0435\u0442\u0432\u044A\u0440\u0442\u044A\u043A","\u043F\u0435\u0442\u044A\u043A","\u0441\u044A\u0431\u043E\u0442\u0430"],"en","z"],cs:[["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII"],["leden","\xFAnor","b\u0159ezen","duben","kv\u011Bten","\u010Derven","\u010Dervenec","srpen","z\xE1\u0159\xED","\u0159\xEDjen","listopad","prosinec"],["ne","po","\xFAt","st","\u010Dt","p\xE1","so"],["ned\u011Ble","pond\u011Bl\xED","\xFAter\xFD","st\u0159eda","\u010Dtvrtek","p\xE1tek","sobota"],["dop.","odp."],"z"],da:["sv",["januar","februar","marts","april","maj","juni","juli","august","september","oktober","november","december"],["s\xF8","ma","ti","on","to","fr","l\xF8"],["s\xF8ndag","mandag","tirsdag","onsdag","torsdag","fredag","l\xF8rdag"],"sv","z"],el:[["\u0399\u03B1\u03BD","\u03A6\u03B5\u03B2","\u039C\u03B1\u03C1","\u0391\u03C0\u03C1","\u039C\u03B1\u03CA","\u0399\u03BF\u03C5\u03BD","\u0399\u03BF\u03C5\u03BB","\u0391\u03C5\u03B3","\u03A3\u03B5\u03C0","\u039F\u03BA\u03C4","\u039D\u03BF\u03B5","\u0394\u03B5\u03BA"],["\u0399\u03B1\u03BD\u03BF\u03C5\u03AC\u03C1\u03B9\u03BF\u03C2","\u03A6\u03B5\u03B2\u03C1\u03BF\u03C5\u03AC\u03C1\u03B9\u03BF\u03C2","\u039C\u03AC\u03C1\u03C4\u03B9\u03BF\u03C2","\u0391\u03C0\u03C1\u03AF\u03BB\u03B9\u03BF\u03C2","\u039C\u03AC\u03B9\u03BF\u03C2","\u0399\u03BF\u03CD\u03BD\u03B9\u03BF\u03C2","\u0399\u03BF\u03CD\u03BB\u03B9\u03BF\u03C2","\u0391\u03CD\u03B3\u03BF\u03C5\u03C3\u03C4\u03BF\u03C2","\u03A3\u03B5\u03C0\u03C4\u03AD\u03BC\u03B2\u03C1\u03B9\u03BF\u03C2","\u039F\u03BA\u03C4\u03CE\u03B2\u03C1\u03B9\u03BF\u03C2","\u039D\u03BF\u03AD\u03BC\u03B2\u03C1\u03B9\u03BF\u03C2","\u0394\u03B5\u03BA\u03AD\u03BC\u03B2\u03C1\u03B9\u03BF\u03C2"],["\u039A\u03C5\u03C1","\u0394\u03B5\u03C5","\u03A4\u03C1\u03B9","\u03A4\u03B5\u03C4","\u03A0\u03B5\u03BC","\u03A0\u03B1\u03C1","\u03A3\u03B1\u03B2"],["\u039A\u03C5\u03C1\u03B9\u03B1\u03BA\u03AE","\u0394\u03B5\u03C5\u03C4\u03AD\u03C1\u03B1","\u03A4\u03C1\u03AF\u03C4\u03B7","\u03A4\u03B5\u03C4\u03AC\u03C1\u03C4\u03B7","\u03A0\u03AD\u03BC\u03C0\u03C4\u03B7","\u03A0\u03B1\u03C1\u03B1\u03C3\u03BA\u03B5\u03C5\u03AE","\u03A3\u03AC\u03B2\u03B2\u03B1\u03C4\u03BF"],["\u03C0\u03BC","\u03BC\u03BC"],"z"],et:[["jaan","veebr","m\xE4rts","apr","mai","juuni","juuli","aug","sept","okt","nov","dets"],["jaanuar","veebruar","m\xE4rts","aprill","mai","juuni","juuli","august","september","oktoober","november","detsember"],["P","E","T","K","N","R","L"],["p\xFChap\xE4ev","esmasp\xE4ev","teisip\xE4ev","kolmap\xE4ev","neljap\xE4ev","reede","laup\xE4ev"],"en","z"],fi:[["tammi","helmi","maalis","huhti","touko","kes\xE4","hein\xE4","elo","syys","loka","marras","joulu"],["tammikuu","helmikuu","maaliskuu","huhtikuu","toukokuu","kes\xE4kuu","hein\xE4kuu","elokuu","syyskuu","lokakuu","marraskuu","joulukuu"],["su","ma","ti","ke","to","pe","la"],["sunnuntai","maanantai","tiistai","keskiviikko","torstai","perjantai","lauantai"],["ap.","ip."],"z"],he:[["\u05D9\u05E0\u05D5","\u05E4\u05D1\u05E8","\u05DE\u05E8\u05E5","\u05D0\u05E4\u05E8","\u05DE\u05D0\u05D9","\u05D9\u05D5\u05E0","\u05D9\u05D5\u05DC","\u05D0\u05D5\u05D2","\u05E1\u05E4\u05D8","\u05D0\u05D5\u05E7","\u05E0\u05D5\u05D1","\u05D3\u05E6\u05DE"],["\u05D9\u05E0\u05D5\u05D0\u05E8","\u05E4\u05D1\u05E8\u05D5\u05D0\u05E8","\u05DE\u05E8\u05E5","\u05D0\u05E4\u05E8\u05D9\u05DC","\u05DE\u05D0\u05D9","\u05D9\u05D5\u05E0\u05D9","\u05D9\u05D5\u05DC\u05D9","\u05D0\u05D5\u05D2\u05D5\u05E1\u05D8","\u05E1\u05E4\u05D8\u05DE\u05D1\u05E8","\u05D0\u05D5\u05E7\u05D8\u05D5\u05D1\u05E8","\u05E0\u05D5\u05D1\u05DE\u05D1\u05E8","\u05D3\u05E6\u05DE\u05D1\u05E8"],["\u05D9\u05D5\u05DD\xA0\u05D0","\u05D9\u05D5\u05DD\xA0\u05D1","\u05D9\u05D5\u05DD\xA0\u05D2","\u05D9\u05D5\u05DD\xA0\u05D3","\u05D9\u05D5\u05DD\xA0\u05D4","\u05D9\u05D5\u05DD\xA0\u05D5","\u05E9\u05D1\u05EA"],["\u05D9\u05D5\u05DD\xA0\u05E8\u05D0\u05E9\u05D5\u05DF","\u05D9\u05D5\u05DD\xA0\u05E9\u05E0\u05D9","\u05D9\u05D5\u05DD\xA0\u05E9\u05DC\u05D9\u05E9\u05D9","\u05D9\u05D5\u05DD\xA0\u05E8\u05D1\u05D9\u05E2\u05D9","\u05D9\u05D5\u05DD\xA0\u05D7\u05DE\u05D9\u05E9\u05D9","\u05D9\u05D5\u05DD\xA0\u05E9\u05D9\u05E9\u05D9","\u05E9\u05D1\u05EA"],"en","z"],hu:[["jan.","febr.","m\xE1rc.","\xE1pr.","m\xE1j.","j\xFAn.","j\xFAl.","aug.","szept.","okt.","nov.","dec."],["janu\xE1r","febru\xE1r","m\xE1rcius","\xE1prilis","m\xE1jus","j\xFAnius","j\xFAlius","augusztus","szeptember","okt\xF3ber","november","december"],["V","H","K","Sze","Cs","P","Szo"],["vas\xE1rnap","h\xE9tf\u0151","kedd","szerda","cs\xFCt\xF6rt\xF6k","p\xE9ntek","szombat"],["de.","du."],"z"],id:[["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"],["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],["Mgg","Sen","Sel","Rab","Kam","Jum","Sab"],["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"],"en","z"],ja:[["1","2","3","4","5","6","7","8","9","10","11","12"],["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708"],["\u65E5","\u6708","\u706B","\u6C34","\u6728","\u91D1","\u571F"],["\u65E5\u66DC\u65E5","\u6708\u66DC\u65E5","\u706B\u66DC\u65E5","\u6C34\u66DC\u65E5","\u6728\u66DC\u65E5","\u91D1\u66DC\u65E5","\u571F\u66DC\u65E5"],["\u5348\u524D","\u5348\u5F8C"],"j"],ko:["ja",["1\uC6D4","2\uC6D4","3\uC6D4","4\uC6D4","5\uC6D4","6\uC6D4","7\uC6D4","8\uC6D4","9\uC6D4","10\uC6D4","11\uC6D4","12\uC6D4"],["\uC77C","\uC6D4","\uD654","\uC218","\uBAA9","\uAE08","\uD1A0"],["\uC77C\uC694\uC77C","\uC6D4\uC694\uC77C","\uD654\uC694\uC77C","\uC218\uC694\uC77C","\uBAA9\uC694\uC77C","\uAE08\uC694\uC77C","\uD1A0\uC694\uC77C"],["\uC624\uC804","\uC624\uD6C4"],"k"],lt:[["saus.","vas.","kov.","bal.","geg.","bir\u017E.","liep.","rugp.","rugs.","spal.","lapkr.","gruod."],["sausis","vasaris","kovas","balandis","gegu\u017E\u0117","bir\u017Eelis","liepa","rugpj\u016Btis","rugs\u0117jis","spalis","lapkritis","gruodis"],["sk","pr","an","tr","kt","pn","\u0161t"],["sekmadienis","pirmadienis","antradienis","tre\u010Diadienis","ketvirtadienis","penktadienis","\u0161e\u0161tadienis"],["prie\u0161piet","popiet"],"z"],lv:[["janv.","febr.","marts","apr.","maijs","j\u016Bn.","j\u016Bl.","aug.","sept.","okt.","nov.","dec."],["janv\u0101ris","febru\u0101ris","marts","apr\u012Blis","maijs","j\u016Bnijs","j\u016Blijs","augusts","septembris","oktobris","novembris","decembris"],["sv\u0113td.","pirmd.","otrd.","tre\u0161d.","ceturtd.","piektd.","sestd."],["sv\u0113tdiena","pirmdiena","otrdiena","tre\u0161diena","ceturtdiena","piektdiena","sestdiena"],["priek\u0161p.","p\u0113cp."],"z"],nb:[["jan","feb","mar","apr","mai","jun","jul","aug","sep","okt","nov","des"],["januar","februar","mars","april","mai","juni","juli","august","september","oktober","november","desember"],["s\xF8n","man","tir","ons","tor","fre","l\xF8r"],"da","ro","z"],pl:[["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","pa\u017A","lis","gru"],["stycze\u0144","luty","marzec","kwiecie\u0144","maj","czerwiec","lipiec","sierpie\u0144","wrzesie\u0144","pa\u017Adziernik","listopad","grudzie\u0144"],["niedz.","pon.","wt.","\u015Br.","czw.","pt.","sob."],["niedziela","poniedzia\u0142ek","wtorek","\u015Broda","czwartek","pi\u0105tek","sobota"],"en","z"],pt:[["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],["janeiro","fevereiro","mar\xE7o","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"],["dom","seg","ter","qua","qui","sex","s\xE1b"],["domingo","segunda-feira","ter\xE7a-feira","quarta-feira","quinta-feira","sexta-feira","s\xE1bado"],"en","z"],sk:["ja",["janu\xE1r","febru\xE1r","marec","apr\xEDl","m\xE1j","j\xFAn","j\xFAl","august","september","okt\xF3ber","november","december"],["ne","po","ut","st","\u0161t","pi","so"],["nede\u013Ea","pondelok","utorok","streda","\u0161tvrtok","piatok","sobota"],"en","z"],sl:[["jan.","feb.","mar.","apr.","maj","jun.","jul.","avg.","sep.","okt.","nov.","dec."],["januar","februar","marec","april","maj","junij","julij","avgust","september","oktober","november","december"],["ned.","pon.","tor.","sre.","\u010Det.","pet.","sob."],["nedelja","ponedeljek","torek","sreda","\u010Detrtek","petek","sobota"],["dop.","pop."],"z"],th:[["\u0E21.\u0E04.","\u0E01.\u0E1E.","\u0E21\u0E35.\u0E04.","\u0E40\u0E21.\u0E22.","\u0E1E.\u0E04.","\u0E21\u0E34.\u0E22.","\u0E01.\u0E04.","\u0E2A.\u0E04.","\u0E01.\u0E22.","\u0E15.\u0E04.","\u0E1E.\u0E22.","\u0E18.\u0E04."],["\u0E21\u0E01\u0E23\u0E32\u0E04\u0E21","\u0E01\u0E38\u0E21\u0E20\u0E32\u0E1E\u0E31\u0E19\u0E18\u0E4C","\u0E21\u0E35\u0E19\u0E32\u0E04\u0E21","\u0E40\u0E21\u0E29\u0E32\u0E22\u0E19","\u0E1E\u0E24\u0E29\u0E20\u0E32\u0E04\u0E21","\u0E21\u0E34\u0E16\u0E38\u0E19\u0E32\u0E22\u0E19","\u0E01\u0E23\u0E01\u0E0E\u0E32\u0E04\u0E21","\u0E2A\u0E34\u0E07\u0E2B\u0E32\u0E04\u0E21","\u0E01\u0E31\u0E19\u0E22\u0E32\u0E22\u0E19","\u0E15\u0E38\u0E25\u0E32\u0E04\u0E21","\u0E1E\u0E24\u0E28\u0E08\u0E34\u0E01\u0E32\u0E22\u0E19","\u0E18\u0E31\u0E19\u0E27\u0E32\u0E04\u0E21"],["\u0E2D\u0E32.","\u0E08.","\u0E2D.","\u0E1E.","\u0E1E\u0E24.","\u0E28.","\u0E2A."],["\u0E2D\u0E32\u0E17\u0E34\u0E15\u0E22\u0E4C","\u0E08\u0E31\u0E19\u0E17\u0E23\u0E4C","\u0E2D\u0E31\u0E07\u0E04\u0E32\u0E23","\u0E1E\u0E38\u0E18","\u0E1E\u0E24\u0E2B\u0E31\u0E2A\u0E1A\u0E14\u0E35","\u0E28\u0E38\u0E01\u0E23\u0E4C","\u0E40\u0E2A\u0E32\u0E23\u0E4C"],"en","z"],tr:[["Oca","\u015Eub","Mar","Nis","May","Haz","Tem","A\u011Fu","Eyl","Eki","Kas","Ara"],["Ocak","\u015Eubat","Mart","Nisan","May\u0131s","Haziran","Temmuz","A\u011Fustos","Eyl\xFCl","Ekim","Kas\u0131m","Aral\u0131k"],["Paz","Pzt","Sal","\xC7ar","Per","Cum","Cmt"],["Pazar","Pazartesi","Sal\u0131","\xC7ar\u015Famba","Per\u015Fembe","Cuma","Cumartesi"],["\xD6\xD6","\xD6S"],"z"],vi:[["Thg1","Thg2","Thg3","Thg4","Thg5","Thg6","Thg7","Thg8","Thg9","Thg10","Thg11","Thg12"],["Tha\u0301ng Gi\xEAng","Tha\u0301ng Hai","Tha\u0301ng Ba","Tha\u0301ng T\u01B0","Tha\u0301ng N\u0103m","Tha\u0301ng Sa\u0301u","Tha\u0301ng Ba\u0309y","Tha\u0301ng Ta\u0301m","Tha\u0301ng Chi\u0301n","Tha\u0301ng M\u01B0\u01A1\u0300i","Tha\u0301ng M\u01B0\u01A1\u0300i M\xF4\u0323t","Tha\u0301ng M\u01B0\u01A1\u0300i Hai"],["CN","T2","T3","T4","T5","T6","T7"],["Chu\u0309 Nh\xE2\u0323t","Th\u01B0\u0301 Hai","Th\u01B0\u0301 Ba","Th\u01B0\u0301 T\u01B0","Th\u01B0\u0301 N\u0103m","Th\u01B0\u0301 Sa\u0301u","Th\u01B0\u0301 Ba\u0309y"],["SA","CH"],"z"],ta:[["\u0B9C\u0BA9\u0BB5\u0BB0\u0BBF","\u0BAA\u0BBF\u0BAA\u0BCD\u0BB0\u0BB5\u0BB0\u0BBF","\u0BAE\u0BBE\u0BB0\u0BCD\u0B9A\u0BCD","\u0B8F\u0BAA\u0BCD\u0BB0\u0BB2\u0BCD","\u0BAE\u0BC7","\u0B9C\u0BC2\u0BA9\u0BCD","\u0B9C\u0BC2\u0BB2\u0BC8","\u0B86\u0B95\u0BB8\u0BCD\u0B9F\u0BCD","\u0B9A\u0BC6\u0BAA\u0BCD\u0B9F\u0BAE\u0BCD\u0BAA\u0BB0\u0BCD","\u0B85\u0B95\u0BCD\u0B9F\u0BCB\u0BAA\u0BB0\u0BCD","\u0BA8\u0BB5\u0BAE\u0BCD\u0BAA\u0BB0\u0BCD","\u0B9F\u0BBF\u0B9A\u0BAE\u0BCD\u0BAA\u0BB0\u0BCD"],["\u0B9C\u0BA9\u0BB5\u0BB0\u0BBF","\u0BAA\u0BBF\u0BAA\u0BCD\u0BB0\u0BB5\u0BB0\u0BBF","\u0BAE\u0BBE\u0BB0\u0BCD\u0B9A\u0BCD","\u0B8F\u0BAA\u0BCD\u0BB0\u0BB2\u0BCD","\u0BAE\u0BC7","\u0B9C\u0BC2\u0BA9\u0BCD","\u0B9C\u0BC2\u0BB2\u0BC8","\u0B86\u0B95\u0BB8\u0BCD\u0B9F\u0BCD","\u0B9A\u0BC6\u0BAA\u0BCD\u0B9F\u0BAE\u0BCD\u0BAA\u0BB0\u0BCD","\u0B85\u0B95\u0BCD\u0B9F\u0BCB\u0BAA\u0BB0\u0BCD","\u0BA8\u0BB5\u0BAE\u0BCD\u0BAA\u0BB0\u0BCD","\u0B9F\u0BBF\u0B9A\u0BAE\u0BCD\u0BAA\u0BB0\u0BCD"],["\u0B9E\u0BBE\u0BAF\u0BBF\u0BB1\u0BC1","\u0BA4\u0BBF\u0B99\u0BCD\u0B95\u0BB3\u0BCD","\u0B9A\u0BC6\u0BB5\u0BCD\u0BB5\u0BBE\u0BAF\u0BCD","\u0BAA\u0BC1\u0BA4\u0BA9\u0BCD","\u0BB5\u0BBF\u0BAF\u0BBE\u0BB4\u0BA9\u0BCD","\u0BB5\u0BC6\u0BB3\u0BCD\u0BB3\u0BBF","\u0B9A\u0BA9\u0BBF"],["\u0B9E\u0BBE\u0BAF\u0BBF\u0BB1\u0BCD\u0BB1\u0BC1\u0B95\u0BCD\u0B95\u0BBF\u0BB4\u0BAE\u0BC8","\u0BA4\u0BBF\u0B99\u0BCD\u0B95\u0BB3\u0BCD\u0B95\u0BBF\u0BB4\u0BAE\u0BC8","\u0B9A\u0BC6\u0BB5\u0BCD\u0BB5\u0BBE\u0BAF\u0BCD\u0B95\u0BCD\u0B95\u0BBF\u0BB4\u0BAE\u0BC8","\u0BAA\u0BC1\u0BA4\u0BA9\u0BCD\u0B95\u0BBF\u0BB4\u0BAE\u0BC8","\u0BB5\u0BBF\u0BAF\u0BBE\u0BB4\u0B95\u0BCD\u0B95\u0BBF\u0BB4\u0BAE\u0BC8","\u0BB5\u0BC6\u0BB3\u0BCD\u0BB3\u0BBF\u0B95\u0BCD\u0B95\u0BBF\u0BB4\u0BAE\u0BC8","\u0B9A\u0BA9\u0BBF\u0B95\u0BCD\u0B95\u0BBF\u0BB4\u0BAE\u0BC8"],["\u0B95\u0BBE\u0BB2\u0BC8","\u0BAE\u0BBE\u0BB2\u0BC8"],"z"],syr:[["\u070F\u071F\u0722\xA0\u070F\u0712","\u072B\u0712\u071B","\u0710\u0715\u072A","\u0722\u071D\u0723\u0722","\u0710\u071D\u072A","\u071A\u0719\u071D\u072A\u0722","\u072C\u0721\u0718\u0719","\u0710\u0712","\u0710\u071D\u0720\u0718\u0720","\u070F\u072C\u072B\xA0\u070F\u0710","\u070F\u072C\u072B\xA0\u070F\u0712","\u070F\u071F\u0722\xA0\u070F\u0710"],["\u071F\u0722\u0718\u0722\xA0\u0710\u071A\u072A\u071D","\u072B\u0712\u071B","\u0710\u0715\u072A","\u0722\u071D\u0723\u0722","\u0710\u071D\u072A","\u071A\u0719\u071D\u072A\u0722","\u072C\u0721\u0718\u0719","\u0710\u0712","\u0710\u071D\u0720\u0718\u0720","\u072C\u072B\u072A\u071D\xA0\u0729\u0715\u071D\u0721","\u072C\u072B\u072A\u071D\xA0\u0710\u071A\u072A\u071D","\u071F\u0722\u0718\u0722\xA0\u0729\u0715\u071D\u0721"],["\u070F\u0710\xA0\u070F\u0712\u072B","\u070F\u0712\xA0\u070F\u0712\u072B","\u070F\u0713\xA0\u070F\u0712\u072B","\u070F\u0715\xA0\u070F\u0712\u072B","\u070F\u0717\xA0\u070F\u0712\u072B","\u070F\u0725\u072A\u0718\u0712","\u070F\u072B\u0712"],["\u071A\u0715\xA0\u0712\u072B\u0712\u0710","\u072C\u072A\u071D\u0722\xA0\u0712\u072B\u0712\u0710","\u072C\u0720\u072C\u0710\xA0\u0712\u072B\u0712\u0710","\u0710\u072A\u0712\u0725\u0710\xA0\u0712\u072B\u0712\u0710","\u071A\u0721\u072B\u0710\xA0\u0712\u072B\u0712\u0710","\u0725\u072A\u0718\u0712\u072C\u0710","\u072B\u0712\u072C\u0710"],["\u0729.\u071B","\u0712.\u071B"],"z"],eu:[["urt.","ots.","mar.","api.","mai.","eka.","uzt.","abu.","ira.","urr.","aza.","abe."],["urtarrila","otsaila","martxoa","apirila","maiatza","ekaina","uztaila","abuztua","iraila","urria","azaroa","abendua"],["ig.","al.","ar.","az.","og.","or.","lr."],["igandea","astelehena","asteartea","asteazkena","osteguna","ostirala","larunbata"],"en","z"],be:[["\u0441\u0442\u0443\u0434\u0437","\u043B\u044E\u0442","\u0441\u0430\u043A","\u043A\u0440\u0430\u0441","\u043C\u0430\u0439","\u0447\u044D\u0440\u0432","\u043B\u0456\u043F","\u0436\u043D","\u0432\u0435\u0440","\u043A\u0430\u0441\u0442\u0440","\u043B\u0456\u0441\u0442","\u0441\u043D\u0435\u0436"],["\u0441\u0442\u0443\u0434\u0437\u0435\u043D\u044C","\u043B\u044E\u0442\u044B","\u0441\u0430\u043A\u0430\u0432\u0456\u043A","\u043A\u0440\u0430\u0441\u0430\u0432\u0456\u043A","\u043C\u0430\u0439","\u0447\u044D\u0440\u0432\u0435\u043D\u044C","\u043B\u0456\u043F\u0435\u043D\u044C","\u0436\u043D\u0456\u0432\u0435\u043D\u044C","\u0432\u0435\u0440\u0430\u0441\u0435\u043D\u044C","\u043A\u0430\u0441\u0442\u0440\u044B\u0447\u043D\u0456\u043A","\u043B\u0456\u0441\u0442\u0430\u043F\u0430\u0434","\u0441\u043D\u0435\u0436\u0430\u043D\u044C"],["\u043D\u0434","\u043F\u043D","\u0430\u045E\u0442","\u0441\u0440","\u0447\u0446","\u043F\u0442","\u0441\u0431"],["\u043D\u044F\u0434\u0437\u0435\u043B\u044F","\u043F\u0430\u043D\u044F\u0434\u0437\u0435\u043B\u0430\u043A","\u0430\u045E\u0442\u043E\u0440\u0430\u043A","\u0441\u0435\u0440\u0430\u0434\u0430","\u0447\u0430\u0446\u0432\u0435\u0440","\u043F\u044F\u0442\u043D\u0456\u0446\u0430","\u0441\u0443\u0431\u043E\u0442\u0430"],"en","z"],dv:[["\u0796\u07A6\u0782\u07A6\u0788\u07A6\u0783\u07A9","\u078A\u07AC\u0784\u07B0\u0783\u07AA\u0787\u07A6\u0783\u07A9","\u0789\u07A7\u0783\u0797\u07B0","\u0787\u07AD\u0795\u07B0\u0783\u07A8\u078D\u07B0","\u0789\u07AC\u0787\u07A8","\u0796\u07AB\u0782\u07B0","\u0796\u07AA\u078D\u07A6\u0787\u07A8","\u0787\u07AE\u078E\u07A6\u0790\u07B0\u0793\u07B0","\u0790\u07AC\u0795\u07B0\u0793\u07AC\u0789\u07B0\u0784\u07A6\u0783","\u0787\u07AE\u0786\u07B0\u0793\u07AF\u0784\u07A6\u0783","\u0782\u07AE\u0788\u07AC\u0789\u07B0\u0784\u07A6\u0783","\u0791\u07A8\u0790\u07AC\u0789\u07B0\u0784\u07A6\u0783"],["\u0796\u07A6\u0782\u07A6\u0788\u07A6\u0783\u07A9","\u078A\u07AC\u0784\u07B0\u0783\u07AA\u0787\u07A6\u0783\u07A9","\u0789\u07A7\u0783\u0797\u07B0","\u0787\u07AD\u0795\u07B0\u0783\u07A8\u078D\u07B0","\u0789\u07AC\u0787\u07A8","\u0796\u07AB\u0782\u07B0","\u0796\u07AA\u078D\u07A6\u0787\u07A8","\u0787\u07AE\u078E\u07A6\u0790\u07B0\u0793\u07B0","\u0790\u07AC\u0795\u07B0\u0793\u07AC\u0789\u07B0\u0784\u07A6\u0783","\u0787\u07AE\u0786\u07B0\u0793\u07AF\u0784\u07A6\u0783","\u0782\u07AE\u0788\u07AC\u0789\u07B0\u0784\u07A6\u0783","\u0791\u07A8\u0790\u07AC\u0789\u07B0\u0784\u07A6\u0783"],["\u0787\u07A7\u078B\u07A9\u0787\u07B0\u078C\u07A6","\u0780\u07AF\u0789\u07A6","\u0787\u07A6\u0782\u07B0\u078E\u07A7\u0783\u07A6","\u0784\u07AA\u078B\u07A6","\u0784\u07AA\u0783\u07A7\u0790\u07B0\u078A\u07A6\u078C\u07A8","\u0780\u07AA\u0786\u07AA\u0783\u07AA","\u0780\u07AE\u0782\u07A8\u0780\u07A8\u0783\u07AA"],["\u0787\u07A7\u078B\u07A9\u0787\u07B0\u078C\u07A6","\u0780\u07AF\u0789\u07A6","\u0787\u07A6\u0782\u07B0\u078E\u07A7\u0783\u07A6","\u0784\u07AA\u078B\u07A6","\u0784\u07AA\u0783\u07A7\u0790\u07B0\u078A\u07A6\u078C\u07A8","\u0780\u07AA\u0786\u07AA\u0783\u07AA","\u0780\u07AE\u0782\u07A8\u0780\u07A8\u0783\u07AA"],["\u0789\u0786","\u0789\u078A"],"z"],hi:[["\u091C\u0928\u0935\u0930\u0940","\u092B\u0930\u0935\u0930\u0940","\u092E\u093E\u0930\u094D\u091A","\u0905\u092A\u094D\u0930\u0948\u0932","\u092E\u0908","\u091C\u0942\u0928","\u091C\u0941\u0932\u093E\u0908","\u0905\u0917\u0938\u094D\u0924","\u0938\u093F\u0924\u092E\u094D\u092C\u0930","\u0905\u0915\u094D\u0924\u0942\u092C\u0930","\u0928\u0935\u092E\u094D\u092C\u0930","\u0926\u093F\u0938\u092E\u094D\u092C\u0930"],["\u091C\u0928\u0935\u0930\u0940","\u092B\u0930\u0935\u0930\u0940","\u092E\u093E\u0930\u094D\u091A","\u0905\u092A\u094D\u0930\u0948\u0932","\u092E\u0908","\u091C\u0942\u0928","\u091C\u0941\u0932\u093E\u0908","\u0905\u0917\u0938\u094D\u0924","\u0938\u093F\u0924\u092E\u094D\u092C\u0930","\u0905\u0915\u094D\u0924\u0942\u092C\u0930","\u0928\u0935\u092E\u094D\u092C\u0930","\u0926\u093F\u0938\u092E\u094D\u092C\u0930"],["\u0930\u0935\u093F.","\u0938\u094B\u092E.","\u092E\u0902\u0917\u0932.","\u092C\u0941\u0927.","\u0917\u0941\u0930\u0941.","\u0936\u0941\u0915\u094D\u0930.","\u0936\u0928\u093F."],["\u0930\u0935\u093F\u0935\u093E\u0930","\u0938\u094B\u092E\u0935\u093E\u0930","\u092E\u0902\u0917\u0932\u0935\u093E\u0930","\u092C\u0941\u0927\u0935\u093E\u0930","\u0917\u0941\u0930\u0941\u0935\u093E\u0930","\u0936\u0941\u0915\u094D\u0930\u0935\u093E\u0930","\u0936\u0928\u093F\u0935\u093E\u0930"],["\u092A\u0942\u0930\u094D\u0935\u093E\u0939\u094D\u0928","\u0905\u092A\u0930\u093E\u0939\u094D\u0928"],"z"],fil:[["Ene","Peb","Mar","Abr","May","Hun","Hul","Ago","Set","Okt","Nob","Dis"],["Enero","Pebrero","Marso","Abril","Mayo","Hunyo","Hulyo","Agosto","Setyembre","Oktubre","Nobyembre","Disyembre"],["Lin","Lun","Mar","Miy","Huw","Biy","Sab"],["Linggo","Lunes","Martes","Miyerkules","Huwebes","Biyernes","Sabado"],"en","z"],ms:[["Jan","Feb","Mac","Apr","Mei","Jun","Jul","Ogo","Sep","Okt","Nov","Dis"],["Januari","Februari","Mac","April","Mei","Jun","Julai","Ogos","September","Oktober","November","Disember"],["Ahd","Isn","Sel","Rab","Kha","Jum","Sab"],["Ahad","Isnin","Selasa","Rabu","Khamis","Jumaat","Sabtu"],["PG","PTG"],"z"],"ar-SA":"ar","ar-IQ":[["\u0643\u0627\u0646\u0648\u0646\xA0\u0627\u0644\u062B\u0627\u0646\u064A","\u0634\u0628\u0627\u0637","\u0622\u0630\u0627\u0631","\u0646\u064A\u0633\u0627\u0646","\u0623\u064A\u0627\u0631","\u062D\u0632\u064A\u0631\u0627\u0646","\u062A\u0645\u0648\u0632","\u0622\u0628","\u0623\u064A\u0644\u0648\u0644","\u062A\u0634\u0631\u064A\u0646\xA0\u0627\u0644\u0623\u0648\u0644","\u062A\u0634\u0631\u064A\u0646\xA0\u0627\u0644\u062B\u0627\u0646\u064A","\u0643\u0627\u0646\u0648\u0646\xA0\u0627\u0644\u0623\u0648\u0644"],["\u0643\u0627\u0646\u0648\u0646\xA0\u0627\u0644\u062B\u0627\u0646\u064A","\u0634\u0628\u0627\u0637","\u0622\u0630\u0627\u0631","\u0646\u064A\u0633\u0627\u0646","\u0623\u064A\u0627\u0631","\u062D\u0632\u064A\u0631\u0627\u0646","\u062A\u0645\u0648\u0632","\u0622\u0628","\u0623\u064A\u0644\u0648\u0644","\u062A\u0634\u0631\u064A\u0646\xA0\u0627\u0644\u0623\u0648\u0644","\u062A\u0634\u0631\u064A\u0646\xA0\u0627\u0644\u062B\u0627\u0646\u064A","\u0643\u0627\u0646\u0648\u0646\xA0\u0627\u0644\u0623\u0648\u0644"],"ar","ar","ar","z"],"ar-DZ":"ar","ar-EG":"ar","en-US":"en","en-AU":"en","en-BZ":"en","en-CA":"en","en-029":"en","en-HK":"en","en-IN":"en","en-ID":"en","en-IE":"en","en-JM":"en","en-MY":"en","en-NZ":"en","en-PH":"en","en-SG":"en","en-ZA":"en","en-TT":"en","en-GB":"en","en-ZW":"en","en-AS":"en","en-KE":"en","en-KW":"en","en-NL":"en","en-CH":"en","en-001":"en","en-VU":"en","en-MX":"en","en-IO":"en","en-IL":"en","en-PK":"en","en-NG":"en","en-UK":"en","es-ES":[["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sep.","oct.","nov.","dic."],"es","es","es","en","z"],"es-AR":["es-ES","es",["dom.","lun.","mar.","mi\xE9.","jue.","vie.","s\xE1b."],"es",["a.\xA0m.","p.\xA0m."],"z"],"es-BO":["es-ES","es","es-AR","es","es-AR","z"],"es-CL":[["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sept.","oct.","nov.","dic."],"es","es-AR","es","es-AR","z"],"es-CO":["es-ES","es","es-AR","es","es-AR","z"],"es-CR":["es-ES","es","es-AR","es","es-AR","z"],"es-DO":["es-ES","es","es-AR","es","es-AR","z"],"es-EC":["es-ES","es","es-AR","es","es-AR","z"],"es-SV":["es-ES","es","es-AR","es","es-AR","z"],"es-GT":["es-ES","es","es-AR","es","es-AR","z"],"es-HN":["es-ES","es","es-AR","es","es-AR","z"],"es-419":["es-ES","es","es-AR","es","ro","z"],"es-MX":["es-ES","es","es-AR","es","es","z"],"es-NI":["es-ES","es","es-AR","es","es-AR","z"],"es-PA":["es-ES","es","es-AR","es","es-AR","z"],"es-PY":["es-CL","es","es-AR","es","es-CL","z"],"es-PE":[["Ene.","Feb.","Mar.","Abr.","May.","Jun.","Jul.","Ago.","Set.","Oct.","Nov.","Dic."],["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Setiembre","Octubre","Noviembre","Diciembre"],"es-AR","es","es-AR","z"],"es-PR":["es-ES","es","es-AR","es","es-AR","z"],"es-ES_tradnl":["es-ES","es","es","es","es-ES","z"],"es-US":[["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],"es",["dom","lun","mar","mi\xE9","jue","vie","s\xE1b"],"es","en","z"],"es-UY":["es","es-PE","es-AR","es","es-AR","z"],"es-VE":["es-CL","es","es-AR","es","es-CL","z"],"es-CU":["es-ES","es","es-AR","es","ro","z"],"fr-FR":"fr","fr-BE":"fr","fr-CM":["fr","fr","fr","fr",["mat.","soir"],"z"],"fr-CA":"fr","fr-029":"fr","fr-CD":"fr","fr-CI":"fr","fr-HT":"fr","fr-LU":"fr","fr-ML":"fr","fr-MC":"fr","fr-MA":[["jan.","f\xE9v.","mar.","avr.","mai","jui.","juil.","ao\xFBt","sept.","oct.","nov.","d\xE9c."],"fr","fr","fr","en","z"],"fr-RE":"fr","fr-SN":"fr","fr-CH":"fr","zh-CN":["zh","zh",["\u5468\u65E5","\u5468\u4E00","\u5468\u4E8C","\u5468\u4E09","\u5468\u56DB","\u5468\u4E94","\u5468\u516D"],"zh","zh","s"],"zh-SG":[["\u4E00\u6708","\u4E8C\u6708","\u4E09\u6708","\u56DB\u6708","\u4E94\u6708","\u516D\u6708","\u4E03\u6708","\u516B\u6708","\u4E5D\u6708","\u5341\u6708","\u5341\u4E00\u6708","\u5341\u4E8C\u6708"],"zh","zh-CN","zh","zh","s"],"zh-HK":["zh-SG","zh","zh","zh","zh-SG","t"],"zh-MO":["zh-SG","zh","zh","zh","zh-SG","t"],"zh-TW":["zh-SG","zh","zh","zh","zh-SG","t"],"de-DE":"de","de-AT":[["J\xE4n","Feb","M\xE4r","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],["J\xE4nner","Februar","M\xE4rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."],"de","en","z"],"de-LI":[["Jan","Feb","M\xE4r","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],"de","de-AT","de","en","z"],"de-LU":["de-LI","de","de-AT","de","de-LI","z"],"de-CH":["de-LI","de","de-AT","de","de-LI","z"],"hr-HR":"hr","hr-BA":[["sij","velj","o\u017Eu","tra","svi","lip","srp","kol","ruj","lis","stu","pro"],"hr","hr","hr","en","z"],"nl-NL":"nl","nl-BE":"nl","sv-SE":"sv","sv-FI":[["jan.","feb.","mars","apr.","maj","juni","juli","aug.","sep.","okt.","nov.","dec."],"sv","sv","sv",["fm","em"],"z"],"it-IT":"it","it-CH":"it","ro-RO":"ro","ro-MD":["ro","ro",["Du","Lu","Mar","Mie","Jo","Vi","S\xE2"],"ro","ro","z"],"ru-RU":"ru","ru-MD-x-genlower":[["\u044F\u043D\u0432.","\u0444\u0435\u0432\u0440.","\u043C\u0430\u0440\u0442","\u0430\u043F\u0440.","\u043C\u0430\u0439","\u0438\u044E\u043D\u044C","\u0438\u044E\u043B\u044C","\u0430\u0432\u0433.","\u0441\u0435\u043D\u0442.","\u043E\u043A\u0442.","\u043D\u043E\u044F\u0431.","\u0434\u0435\u043A."],["\u044F\u043D\u0432\u0430\u0440\u044F","\u0444\u0435\u0432\u0440\u0430\u043B\u044F","\u043C\u0430\u0440\u0442\u0430","\u0430\u043F\u0440\u0435\u043B\u044F","\u043C\u0430\u044F","\u0438\u044E\u043D\u044F","\u0438\u044E\u043B\u044F","\u0430\u0432\u0433\u0443\u0441\u0442\u0430","\u0441\u0435\u043D\u0442\u044F\u0431\u0440\u044F","\u043E\u043A\u0442\u044F\u0431\u0440\u044F","\u043D\u043E\u044F\u0431\u0440\u044F","\u0434\u0435\u043A\u0430\u0431\u0440\u044F"],"ru","ru","en","z"],"sr-Latn-RS":"sr","sr-Latn-BA":[["jan","feb","mart","apr","maj","jun","jul","avg","sept","okt","nov","dec"],"sr","hr","hr",["prije podne","po podne"],"z"],"sr-Latn-CS":[["jan.","feb.","mart","apr.","maj","jun","jul","avg.","sept.","okt.","nov.","dec."],"sr",["ned.","pon.","uto.","sre.","\u010Det.","pet.","sub."],"sr","en","z"],"uk-UA-x-genlower":["uk",["\u0441\u0456\u0447\u043D\u044F","\u043B\u044E\u0442\u043E\u0433\u043E","\u0431\u0435\u0440\u0435\u0437\u043D\u044F","\u043A\u0432\u0456\u0442\u043D\u044F","\u0442\u0440\u0430\u0432\u043D\u044F","\u0447\u0435\u0440\u0432\u043D\u044F","\u043B\u0438\u043F\u043D\u044F","\u0441\u0435\u0440\u043F\u043D\u044F","\u0432\u0435\u0440\u0435\u0441\u043D\u044F","\u0436\u043E\u0432\u0442\u043D\u044F","\u043B\u0438\u0441\u0442\u043E\u043F\u0430\u0434\u0430","\u0433\u0440\u0443\u0434\u043D\u044F"],"uk","uk","uk","z"],"uk-UA":"uk","bg-BG":"bg","cs-CZ":"cs","da-DK":["sv","da","da","da","sv","z"],"el-GR":"el","et-EE":"et","fi-FI":"fi","he-IL":"he","hu-HU":"hu","id-ID":"id","ja-JP":"ja","ko-KR":["ja","ko","ko","ko","ko","k"],"lt-LT":"lt","lv-LV":"lv","nb-NO":["nb","nb","nb","da","nb","z"],"pl-PL":"pl","pt-BR":"pt","pt-PT":"pt","sk-SK":["ja","sk","sk","sk","en","z"],"sl-SI":"sl","th-TH":"th","tr-TR":"tr","vi-VN":"vi","ta-IN":"ta","syr-SY":"syr","eu-ES":"eu","be-BY-x-genlower":["be",["\u0441\u0442\u0443\u0434\u0437\u0435\u043D\u044F","\u043B\u044E\u0442\u0430\u0433\u0430","\u0441\u0430\u043A\u0430\u0432\u0456\u043A\u0430","\u043A\u0440\u0430\u0441\u0430\u0432\u0456\u043A\u0430","\u043C\u0430\u044F","\u0447\u044D\u0440\u0432\u0435\u043D\u044F","\u043B\u0456\u043F\u0435\u043D\u044F","\u0436\u043D\u0456\u045E\u043D\u044F","\u0432\u0435\u0440\u0430\u0441\u043D\u044F","\u043A\u0430\u0441\u0442\u0440\u044B\u0447\u043D\u0456\u043A\u0430","\u043B\u0456\u0441\u0442\u0430\u043F\u0430\u0434\u0430","\u0441\u043D\u0435\u0436\u043D\u044F"],"be","be","be","z"],"be-BY":"be","dv-MV":"dv","hi-IN":"hi","fil-PH":"fil","ms-MY":"ms"};function Tgr(){for(var e={},r=["monthNameShort","monthNameLong","dayNameShort","dayNameLong","ampmSymbols"],n=0,a=Object.keys(Mye);n<a.length;n++){var o=a[n],u=Mye[o];if(typeof u=="string"){var t=e[u];(0,Iye.assertTrue)("calc.numfmt.buildBundledLocaleData: ref prior culture",t!==void 0),e[o]=t;continue}var d=u.slice(0,5).map(function(E,I){if(typeof E=="string"){var F=e[E];return(0,Iye.assertTrue)("calc.numfmt.buildBundledLocaleData: ref prior culture 2",F!==void 0),F[r[I]]}return E}),s=d[0],c=d[1],l=d[2],f=d[3],p=d[4],m=u[5],v=m==="k",h=m==="j",S=m==="t",y=m==="s",C=v||h||S||y;e[o]={monthNameShort:s,monthNameLong:c,dayNameShort:l,dayNameLong:f,ampmSymbols:p,isEastAsia:C,isKorea:v,isJapan:h,isChinaT:S,isChinaS:y}}return e}var gZ;function bgr(e){var r=e.culture,n=e.tag;if(typeof r!="number"){var a=r;return n!==void 0&&(r!==""&&(a+="-"),a+="x-"+String(n)),gZ===void 0&&(gZ=Tgr()),gZ[a]}}rO.getBundledLocaleInfo=bgr;var Pgr=(Ba={},Ba[Ya.LCID.USA]="en-US",Ba[Ya.LCID.Greek]="el-GR",Ba[Ya.LCID.Hungarian]="hu-HU",Ba[Ya.LCID.Turkish]="tr-TR",Ba[Ya.LCID.Thailand]="th-TH",Ba[Ya.LCID.Vietnam]="vi-VN",Ba[Ya.LCID.Arabic]="ar-SA",Ba[Ya.LCID.Hebrew]="he-IL",Ba[Ya.LCID.Tamil]="ta-IN",Ba[Ya.LCID.Syriac]="syr-SY",Ba[Ya.LCID.Iraq]="ar-IQ",Ba[Ya.LCID.Algerian]="ar-DZ",Ba[Ya.LCID.Basque]="eu-ES",Ba[Ya.LCID.PortBrazil]="pt-BR",Ba[Ya.LCID.Croatian]="hr-HR",Ba[Ya.LCID.Czech]="cs-CZ",Ba[Ya.LCID.Danish]="da-DK",Ba[Ya.LCID.Dutch]="nl-NL",Ba[Ya.LCID.Australian]="en-AU",Ba[Ya.LCID.CanadianEnglish]="en-CA",Ba[Ya.LCID.British]="en-GB",Ba[Ya.LCID.Finnish]="fi-FI",Ba[Ya.LCID.French]="fr-FR",Ba[Ya.LCID.FrenchCanadian]="fr-CA",Ba[Ya.LCID.Italian]="it-IT",Ba[Ya.LCID.NorskBokmal]="nb-NO",Ba[Ya.LCID.NorskNynorsk]="nn-NO",Ba[Ya.LCID.Polish]="pl-PL",Ba[Ya.LCID.PortIberian]="pt-PT",Ba[Ya.LCID.Romanian]="ro-RO",Ba[Ya.LCID.Russian]="ru-RU",Ba[Ya.LCID.Ukrainian]="uk-UA",Ba[Ya.LCID.Belarusian]="be-BY",Ba[Ya.LCID.SerbianCyrillic]="sr-Cyrl-CS",Ba[Ya.LCID.SerbianLatin]="sr-Latn-CS",Ba[Ya.LCID.Slovak]="sk-SK",Ba[Ya.LCID.Slovenian]="sl-SI",Ba[Ya.LCID.SpanishModern]="es-ES",Ba[Ya.LCID.Swedish]="sv-SE",Ba[Ya.LCID.HongKong]="zh-HK",Ba[Ya.LCID.ChinaT]="zh-TW",Ba[Ya.LCID.Korea]="ko-KR",Ba[Ya.LCID.Japan]="ja-JP",Ba[Ya.LCID.China]="zh-CN",Ba[Ya.LCID.Devihi]="dv-MV",Ba[Ya.LCID.Hindi]="hi-IN",Ba[Ya.LCID.German]="de-DE",Ba[Ya.LCID.Swiss]="fr-CH",Ba);function Egr(e){var r;return typeof e=="string"?e:(r=Pgr[e])!==null&&r!==void 0?r:e}rO.convertKnownLCID=Egr});var EZ=Y(w1=>{"use strict";_();var L3,B3,q3,nO,MR,wR,DR,Ao,Gp,xR;Object.defineProperty(w1,"__esModule",{value:!0});w1.changeFormatDecimals=w1.applyFormat=w1.createFormat=w1.NumberFormatImpl=void 0;var BP=br(),ve=W2(),fa=O1(),qn=tS(),vr=E1(),sp=tU(),Ngr=KX(),Ld=oZ(),AU=nU(),Hs=K2(),Agr=Aye(),Pu=V2(),Ogr=tS(),gg=N3(),iS=E3(),Pn=A1(),BR=nZ(),kgr=EU(),qP=CU(),gl=_v(),U3=Fye(),wye=vZ(),hZ=iS.codePointMinusSign,Dye=iS.codePointPlusSign,Fgr=iS.codePointDigitZero,Igr=iS.codePointHash,Mgr=iS.codePointFullStop,xye=iS.codePointDigitOne,wgr=iS.codePointDigitTwo,SZ=iS.codePointLeftParen,Lye=iS.codePointRightParen,Dgr=iS.codePointSmallT,xgr=iS.codePointBackslash,Lgr={decimalSeparator:"NOTUSED"};function G3(e,r,n,a){var o=e.formatFixed(r,0,0),u=o.mantissa,t=o.exponent;(0,fa.assertTrue)("calc.numfmt.dtrInteger: mantissa len <= exponent",u.length<=t),(0,fa.assertTrue)("calc.numfmt.dtrInteger: mantissa || !exponent",u.length!==0||t===0);var d=(0,gg.convertDigitsShape)(t<n?(0,Hs.repeat)("0",n-t):"",a),s=(0,gg.convertNumberShape)(Lgr,u+(0,Hs.repeat)("0",t-u.length),a);if(!(0,gl.isSuccess)(s))throw new ic(s.reason);return d+s.value}function Bgr(e,r,n,a,o){var u=e.formatFixed(r,0,0),t=u.mantissa,d=u.exponent;(0,fa.assertTrue)("calc.numfmt.dtrFracSeconds: mantissa len <= exponent",t.length<=d),(0,fa.assertTrue)("calc.numfmt.dtrFracSeconds: mantissa || !exponent",t.length!==0||d===0);var s=(d<n?(0,Hs.repeat)("0",n-d):"")+t+(0,Hs.repeat)("0",d-t.length),c=s.substring(0,a);return(0,gg.convertDigitsShape)(c,o)}function tO(e,r){var n=e.formatFixed(r,0,0),a=n.mantissa,o=n.exponent;return(0,fa.assertTrue)("calc.numfmt.formatInt: mantissa len <= exponent",a.length<=o),(0,fa.assertTrue)("calc.numfmt.formatInt: mantissa || !exponent",a.length!==0||o===0),a===""?"0":a.length<o?a+(0,Hs.repeat)("0",o-a.length):a}function qgr(e){for(var r=[],n=0;n<e.length;n+=1){var a=e[n];switch(a.kind){case vr.FormattedUnitKind.Blank:case vr.FormattedUnitKind.String:{for(var o=a.str;n+1<e.length;){var u=e[n+1];if(u.kind!==a.kind)break;o+=u.str,n+=1}r.push({kind:a.kind,str:o});break}case vr.FormattedUnitKind.Flexible:case vr.FormattedUnitKind.General:r.push(a);break}}return r}var Ugr=function(r){return r.kind===vr.FormattedUnitKind.Flexible};function Ggr(e,r){return e===r||e!==void 0&&r!==void 0&&(0,vr.isFormatCultureEqual)(e,r)}var Kgr=(L3={},L3[1]=Pn.NumberShape.ChineseTrad1,L3[2]=Pn.NumberShape.ChineseTrad2,L3[3]=Pn.NumberShape.ChineseTrad3,L3),Vgr=(B3={},B3[1]=Pn.NumberShape.ChineseSimp1,B3[2]=Pn.NumberShape.ChineseSimp2,B3[3]=Pn.NumberShape.ChineseSimp3,B3),Wgr=(q3={},q3[1]=Pn.NumberShape.Japanese1,q3[2]=Pn.NumberShape.Japanese2,q3[3]=Pn.NumberShape.Japanese3,q3),jgr=(nO={},nO[1]=Pn.NumberShape.Korean1,nO[2]=Pn.NumberShape.Korean2,nO[3]=Pn.NumberShape.Korean3,nO[4]=Pn.NumberShape.Korean4,nO);function Hgr(e){return ve.PictureColor[e]}function Qgr(e){return ve.PictureColor[e]}function zgr(e){return e+1}function Ygr(e){return e-1}var ud;(function(e){e[e.Ne=0]="Ne",e[e.Le=1]="Le",e[e.Ge=2]="Ge",e[e.Eq=3]="Eq",e[e.Lt=4]="Lt",e[e.Gt=5]="Gt"})(ud||(ud={}));var yZ=(0,Hs.partialArray)((MR={},MR[ud.Ne]="<>",MR[ud.Le]="<=",MR[ud.Ge]=">=",MR[ud.Eq]="=",MR[ud.Lt]="<",MR[ud.Gt]=">",MR)),Jgr=(wR={},wR[ud.Ne]=Ld.OperatorId.Ne,wR[ud.Le]=Ld.OperatorId.Le,wR[ud.Ge]=Ld.OperatorId.Ge,wR[ud.Eq]=Ld.OperatorId.Eq,wR[ud.Lt]=Ld.OperatorId.Lt,wR[ud.Gt]=Ld.OperatorId.Gt,wR),Xgr=(DR={},DR[Ld.OperatorId.Ne]=ud.Ne,DR[Ld.OperatorId.Le]=ud.Le,DR[Ld.OperatorId.Ge]=ud.Ge,DR[Ld.OperatorId.Eq]=ud.Eq,DR[Ld.OperatorId.Lt]=ud.Lt,DR[Ld.OperatorId.Gt]=ud.Gt,DR),an;(function(e){e[e.AMPM=100]="AMPM",e[e.AMPMFE=101]="AMPMFE",e[e.General=102]="General",e[e.Currency=103]="Currency",e[e.Color=200]="Color",e[e.Dbnum=201]="Dbnum",e[e.Cond=202]="Cond",e[e.CurrCode=203]="CurrCode",e[e.Char=300]="Char",e[e.StrLit=301]="StrLit",e[e.Numeral=302]="Numeral",e[e.PrefixDigTh=303]="PrefixDigTh",e[e.LatinDate=304]="LatinDate",e[e.BidiDate=305]="BidiDate",e[e.Exp=306]="Exp"})(an||(an={}));function UP(e,r,n,a){for(var o=0;o<r.length;o+=1){var u=r[o];if(u!=null&&!(a+u.length>n.length)){var t=n.substring(a,a+u.length);if(e.stringCompareCI(u,t)===0)return Number(o)}}}function Bye(e,r,n,a){for(var o=0;o<r.length;o+=1){var u=r[o];if(u!=null&&(0,Hs.stringStartsWith)(n,u,a))return Number(o)}return UP(e,r,n,a)}function Ft(e,r){var n;return(n=e[r])!==null&&n!==void 0?n:""}function Zgr(e,r,n,a){for(var o=n.substring(a,a+(0,sp.numCodeUnits)((0,sp.stringCodePointAt)(n,a))),u=0;u<r.length;u+=1){var t=r[u];if(t!=null&&t.length!==0){var d=t.substring(0,(0,sp.numCodeUnits)((0,sp.stringCodePointAt)(t,0)));if(e.stringCompareCI(o,d)===0)return!0}}return!1}function qye(e,r){var n=r.indexOf(Ft(e.pictureSingle,ve.PictureSingle.APDelim));return n<0&&(n=r.length>>1),[r.substring(0,n),r.substring(n+1)]}var CZ="$",OU="-",$gr=",",evr="x-",rvr=/^[0-9A-F]{1,8}$/i,nvr=/^(?:([a-z]{2,}(?:-[A-Z0-9](?:[A-Z0-9]+|(?=,)|$)(?:_[A-Z0-9]+)?)*)(?:-x-([a-z]+))?|x-([a-z0-9]+))?(?:,([0-9A-F]{1,4}))?$/i,Uye=(0,Hs.partialArray)((Ao={},Ao[1]=Pn.NumberShape.ASCII,Ao[2]=Pn.NumberShape.ArabicIndic,Ao[3]=Pn.NumberShape.ExtendedArabicIndic,Ao[4]=Pn.NumberShape.Devanagari,Ao[5]=Pn.NumberShape.Bengali,Ao[6]=Pn.NumberShape.Gurmukhi,Ao[7]=Pn.NumberShape.Gujarati,Ao[8]=Pn.NumberShape.Oriya,Ao[9]=Pn.NumberShape.Tamil,Ao[10]=Pn.NumberShape.Telugu,Ao[11]=Pn.NumberShape.Kannada,Ao[12]=Pn.NumberShape.Malayalam,Ao[13]=Pn.NumberShape.Thai,Ao[14]=Pn.NumberShape.Lao,Ao[15]=Pn.NumberShape.Tibetan,Ao[16]=Pn.NumberShape.Myanmar,Ao[17]=Pn.NumberShape.Ethiopic,Ao[18]=Pn.NumberShape.Khmer,Ao[19]=Pn.NumberShape.Mongolian,Ao[27]=Pn.NumberShape.Japanese1,Ao[28]=Pn.NumberShape.Japanese2,Ao[29]=Pn.NumberShape.Japanese3,Ao[30]=Pn.NumberShape.ChineseSimp1,Ao[31]=Pn.NumberShape.ChineseSimp2,Ao[32]=Pn.NumberShape.ChineseSimp3,Ao[33]=Pn.NumberShape.ChineseTrad1,Ao[34]=Pn.NumberShape.ChineseTrad2,Ao[35]=Pn.NumberShape.ChineseTrad3,Ao[36]=Pn.NumberShape.Korean1,Ao[37]=Pn.NumberShape.Korean2,Ao[38]=Pn.NumberShape.Korean3,Ao[39]=Pn.NumberShape.Korean4,Ao)),Gye=(0,Hs.partialArray)((Gp={},Gp[1]=Pn.Calendar.Gregorian,Gp[2]=Pn.Calendar.GregorianUS,Gp[3]=Pn.Calendar.Japan,Gp[4]=Pn.Calendar.Taiwan,Gp[5]=Pn.Calendar.Korea,Gp[6]=Pn.Calendar.Hijri,Gp[7]=Pn.Calendar.Thai,Gp[8]=Pn.Calendar.Hebrew,Gp[9]=Pn.Calendar.GregorianMEFrench,Gp[10]=Pn.Calendar.GregorianArabic,Gp[11]=Pn.Calendar.GregorianXlitEnglish,Gp[12]=Pn.Calendar.GregorianXlitFrench,Gp[22]=Pn.Calendar.Persian,Gp[23]=Pn.Calendar.UmAlQura,Gp)),tvr=Object.keys(vr.CultureTag).reduce(function(e,r){var n=vr.CultureTag[r];return e[String(n)]=n,e},Object.create(null));function _Z(e){return e.toString(16).toUpperCase()}function Kye(e){return+("0x"+e)}var avr={culture:"en-US",tag:void 0},ivr={culture:"fr-FR",tag:void 0},ovr={culture:"ar-IQ",tag:void 0},uvr={culture:"ar-SA",tag:void 0},svr={culture:"ar-DZ",tag:void 0},RZ={culture:"th-TH",tag:void 0},Vye=543,TZ=(xR={},xR[ve.PictureSingle.Hour]=BR.TimeDivision.Hour,xR[ve.PictureSingle.HourTh]=BR.TimeDivision.Hour,xR[ve.PictureSingle.Minute]=BR.TimeDivision.Minute,xR[ve.PictureSingle.MinuteTh]=BR.TimeDivision.Minute,xR[ve.PictureSingle.Second]=BR.TimeDivision.Second,xR[ve.PictureSingle.SecondTh]=BR.TimeDivision.Second,xR);function kU(e){return e.kind===400?e.formattedStr:void 0}var Hye={kind:an.General};function Qye(e){return e.length===1&&e[0].kind===an.General}function lvr(e){return e.length===1&&e[0].kind===ve.PictureSingle.Text}function cvr(e){return e.numVal&&e.nonZero&&e.digitTokens}var K3={code:[Hye],color:void 0,dbnum:void 0,dtrRounding:BR.Rounding.RoundSec};function Wye(e){return e.color===void 0&&e.dbnum===void 0&&Qye(e.code)}function dvr(e){return e.color===void 0&&e.dbnum===void 0&&lvr(e.code)}var jye=255,fvr=255,pvr=32,bZ=127,FU=1,V3=2,PZ={},LR=(0,qn.createFailureErrorClass)("ApplyHashesError"),ic=(0,qn.createFailureErrorClass)("ApplyError"),_n=(0,qn.createFailureErrorClass)("InitError"),zye=function(){function e(r,n){this.config=r,this.hasPercent=!1,this.hasDate=!1,this.hasTime=!1,this.posBeforeText=!0,this.onlyOneNumberPart=!0,this.parts=[void 0,void 0,void 0,void 0],this.hasTokenCurrCode=!1,n.old===void 0?(this.logFormatString=(0,U3.anonymizeFormulaString)(n.formatString),this.source=n.source,this.parseString(n.formatString)):(this.hasPercent=n.old.hasPercent,this.hasDate=n.old.hasDate,this.hasTime=n.old.hasTime,this.posBeforeText=n.old.posBeforeText,this.onlyOneNumberPart=n.old.onlyOneNumberPart,this.parts=n.synth,this.hasTokenCurrCode=n.old.hasTokenCurrCode,this.thisCurrCode=n.old.thisCurrCode,this.thisCurrencySymbol=n.old.thisCurrencySymbol,this.applyCurrCode=n.old.applyCurrCode,this.condPos=n.old.condPos,this.condNeg=n.old.condNeg,this.logFormatString=n.logFormatString,this.source=vr.NumberFormatSource.CustomString,this.checkBytecode()),this.formatString=this.printFormatString(),this.valueType=this.determineValueType(),this.decimals=this.determineDecimals(),this.bidiDate=this.determineBidiDate()}return Object.defineProperty(e.prototype,"isPercent",{get:function(){return this.hasPercent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDate",{get:function(){return this.hasDate},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTime",{get:function(){return this.hasTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTextOnly",{get:function(){return!this.posBeforeText},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"culture",{get:function(){return this.thisCurrCode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currencySymbol",{get:function(){return this.thisCurrencySymbol},enumerable:!1,configurable:!0}),e.prototype.apply=function(r,n,a,o){try{return(0,gl.success)(this.applyImpl(r,n,a,o))}catch(u){return u instanceof ic?(0,gl.failure)(u.reason):(0,gl.failure)((0,gl.javaScriptError)((0,Hs.prependErrorMessage)(u,"(while applying format ".concat(this.logFormatString,")"))))}},e.prototype.applyImpl=function(r,n,a,o){var u,t=this.config,d=t.mathpack,s=t.localeInfo;if(this.valueType===vr.FormatValueType.General){var c=void 0;if((0,qn.isStringOper)(r))return(0,vr.formattedValue)([(0,vr.formattedUnitString)(r.value)],c,n,a);if(!o&&d.cond(r)===0)return(0,vr.formattedValue)([],c,n,a);var l=(0,vr.formattedUnitGeneral)(d.toNumber(r),s.decimalSeparator,!0,Pn.NumberShape.ASCII,Pn.NumberShape.ASCII,!0);return(0,vr.formattedValue)([l],c,n,a)}for(var f=!1;;){var p=void 0;try{var m=void 0,v=!1,h=[];if((0,qn.isStringOper)(r))m=3;else{var S=d.cond(r);this.condPos!==void 0||this.condNeg!==void 0?(u=this.getPart(r),m=u.partKind,v=u.forceNeg):m=S<0?1:S>0?0:2,S<0&&(this.onlyOneNumberPart||v)&&h.push((0,vr.formattedUnitString)("-"))}p=this.parts[m];var c=p.color,y=p.dbnum,C=p.code,E=p.dtrRounding;if(!o&&m===2&&p===this.parts[0]&&!f)return(0,vr.formattedValue)([],c,n,a);var I=this.getNumShape(y);this.applyPart({dtrRounding:E,dbnum:y,forceNeg:v,units:h,numShape:I,bidiDate:void 0},C,r,void 0);var F=a|(m===3&&!(Wye(p)||dvr(p))?vr.Clip.MaxChars:vr.Clip.None),w=h.some(Ugr)?vr.Alignment.Left:n;return(0,vr.formattedValue)(qgr(h),c,w,F)}catch(B){if(B===PZ){(0,fa.assertTrue)("calc.numfmt.NumberFormatImpl: applyImpl restart",!(0,qn.isStringOper)(r)&&d.cond(r)!==0),r=d.zero,f=!0;continue}if(B instanceof LR)return(0,vr.hashesValue)(B.reason,p==null?void 0:p.color);throw B}}},e.prototype.applyPart=function(r,n,a,o){for(var u,t,d=this,s,c,l=this.config,f=l.mathpack,p=l.datepack,m=l.localeInfo,v=(c=(s=this.applyCurrCode)===null||s===void 0?void 0:s.calendar)!==null&&c!==void 0?c:Pn.Calendar.Gregorian,h,S=function(){if(h!==void 0)return h;(0,fa.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart getDtr value",!(0,qn.isStringOper)(a));var _d=d.config,xu=_d.date1904,pi=_d.dateCompatibility;if(!pi&&f.cond(a)<0)throw new LR(vr.dateOverflow);if(pi&&f.cond(a)<0)throw xu?new ic((0,qn.notImplemented)(["negative date 1904"])):new LR(vr.dateOverflow);var xa=p.fromNum(d.config,f.abs(a),r.dtrRounding);if(xa===!1)throw new LR(vr.dateOverflow);switch(v){case Pn.Calendar.Gregorian:case Pn.Calendar.GregorianUS:case Pn.Calendar.GregorianMEFrench:case Pn.Calendar.GregorianArabic:case Pn.Calendar.GregorianXlitEnglish:case Pn.Calendar.GregorianXlitFrench:break;case Pn.Calendar.Thai:xa.yr+=Vye;break;default:throw new ic((0,qn.notImplemented)(["calendar: "+v]))}return(0,fa.assertTrue)("calc.numfmt.NumberFormatImpl: components within range",xa.yr>=0&&xa.mon>=1&&xa.mon<=12&&xa.dom>=0&&xa.dom<=31&&xa.hour>=0&&xa.hour<=23&&xa.min>=0&&xa.min<=59&&xa.sec>=0&&xa.sec<=59&&xa.fracSec>=0&&xa.wdy>=1&&xa.wdy<=7),h=xa},y=function(){if(h!==void 0)throw new ic((0,qn.notImplemented)(["use of value after date component"]));return a},C=!1,E=r.numShape,I=r.units,F=0;F<n.length;F+=1){var w=n[F];switch(w.kind){case an.General:{C=!0;var B=y();if((0,qn.isStringOper)(B))I.push((0,vr.formattedUnitString)(B.value));else{var k=f.abs(B);if(f.cond(B)<0&&f.formatGeneral(m,k,1)==="0")throw new ic((0,qn.notImplemented)(["potential LRestart in interval (-0.5,0)"]));var x=(0,vr.formattedUnitGeneral)(f.toNumber(k),m.decimalSeparator,!1,E,this.getNumShape(void 0),this.valueType===vr.FormatValueType.General);if(r.dbnum!==void 0){var G=(0,kgr.renderGeneral)(f,x,255);if(!(0,gl.isSuccess)(G))throw new ic(G.reason);(0,fa.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart General renderRes",G.value!==!1),I.push((0,vr.formattedUnitString)(G.value));break}I.push(x)}break}case ve.PictureSingle.Text:{var H=y();(0,fa.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Text value",(0,qn.isStringOper)(H)),I.push((0,vr.formattedUnitString)(H.value));break}case an.Exp:case ve.PictureSingle.Slash:case 400:I.push((0,vr.formattedUnitString)(w.formattedStr));break;case ve.PictureSingle.Star:I.push((0,vr.formattedUnitFlexible)(w.escaped));break;case ve.PictureSingle.Underscore:I.push((0,vr.formattedUnitBlank)(w.escaped));break;case an.StrLit:I.push((0,vr.formattedUnitString)(w.escaped));break;case ve.PictureSingle.Percent:I.push((0,vr.formattedUnitString)(w.formattedStr));break;case an.Numeral:I.push((0,vr.formattedUnitString)(w.formattedStr));break;case an.Currency:I.push((0,vr.formattedUnitString)(m.currencySymbol));break;case an.CurrCode:{var L=w.currencySymbol,D=w.currCode;(0,fa.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart system tag",!(0,vr.isSystemCultureTag)(D==null?void 0:D.tag)),L!==void 0&&I.push((0,vr.formattedUnitString)(L));break}case 405:I.push((0,vr.formattedUnitString)(m.dateSeparator));break;case 406:w.printAsTimeSep?I.push((0,vr.formattedUnitString)(m.timeSeparator)):I.push((0,vr.formattedUnitString)(w.formattedStr));break;case 403:{var U=y();(0,fa.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num value",!(0,qn.isStringOper)(U)),(0,fa.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num numState",o===void 0);var V=w.numDigLeft,ne=w.numDigDec,J=w.numPercent,$=w.numThousands,Z=2*J-3*$,ie=f.formatFixed(U,Z,ne),X=ie.mantissa,Q=ie.exponent;if((0,fa.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num mantissa || !exponent",X.length!==0||Q===0),(0,fa.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num mantissa len",X.length<=Q+ne),f.cond(U)<0&&(this.onlyOneNumberPart||r.forceNeg)&&X.length===0)throw PZ;this.applyPart(r,w.codeBefore,f.zero,void 0),this.applyPart(r,w.code,f.zero,{comma:w.comma,fractionDenom:!1,decimal:!1,digits:X,digitsExp:Q,numDigLeft:V});break}case 402:{var b=y();(0,fa.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp value",!(0,qn.isStringOper)(b)),(0,fa.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp numState",o===void 0);var R=w.numMantDigLeft,P=w.numMantDigDec,A=R===0&&P===0,T=f.formatScientific(b,R,P),X=T.mantissa,Q=T.exponent;(0,fa.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp mantissa || !exponent",X.length!==0||Q===0||A);var g=(0,Agr.formatScientificLeft)(Q,R);(0,fa.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp mantissa len",X.length<=g+P),this.applyPart(r,w.codeMant,f.zero,{comma:w.commaMant,fractionDenom:!1,decimal:!1,digits:X,digitsExp:g,numDigLeft:w.numMantDigLeft}),this.applyPart(r,w.codeBetween,f.zero,void 0);var O=X===""&&!A?0:Q-g;O<0?I.push((0,vr.formattedUnitString)("-")):w.isNeg||I.push((0,vr.formattedUnitString)("+"));var M=tO(f,f.fromNumber(O));this.applyPart(r,w.codeExp,f.zero,{comma:w.commaMant,fractionDenom:!1,decimal:!1,digits:M,digitsExp:M.length,numDigLeft:w.numExpDigLeft});break}case 401:{var K=y();(0,fa.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Fraction value",!(0,qn.isStringOper)(K)),(0,fa.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Fraction numState",o===void 0);var J=w.numPercent,$=w.numThousands,W=w.numIntDigLeft,z=w.numNumerDig,ee=w.numDenomDig,ue=w.commaInt,ce=w.denomValue,Z=2*J-3*$,he=f.tenTo(Z),de=(0,qn.isErrorOper)(he)?he:f.mul(f.abs(K),he);if((0,qn.isErrorOper)(de))throw new ic((0,qn.notImplemented)(["overflow on fraction exp adjust"]));var pe=function(xa){for(var $i=xa;$i<I.length;$i+=1){var $o=I[$i];$o.kind===vr.FormattedUnitKind.String&&(I[$i]=(0,vr.formattedUnitBlank)($o.str))}},_e=w.anyZeroNumer,Ce=void 0,Ne=void 0,Le=void 0;if(w.codeInt!==void 0){var Oe=f.trunc(de),le=f.sub(de,Oe);if((0,fa.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart fracPart sub",(0,qn.isNumberOper)(le)),u=this.formFraction(le,ce,ee),Ce=u.numer,Ne=u.denom,(0,fa.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart numer <= denom",f.cond2(Ce,Ne)<=0),f.cond2(Ce,Ne)===0){Ce=f.zero;var me=f.add(Oe,f.one);(0,fa.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart bumped error",(0,qn.isNumberOper)(me)),Oe=me}f.cond(Ce)!==0&&(_e=!0);var Pe=tO(f,Oe),Re={comma:ue,fractionDenom:!1,decimal:!1,digits:Pe,digitsExp:Pe.length,numDigLeft:W},fe=I.length;this.applyPart(r,w.codeInt,f.zero,Re),Le=I.length,(0,fa.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Fraction lastDigInt",w.lastDigInt!==void 0);var Se=f.cond(Oe)!==0||!_e||w.lastDigInt===ve.PictureSingle.Zero;Se?this.applyPart(r,w.codeBetween1,f.zero,void 0):(w.lastDigInt!==ve.PictureSingle.Question&&(I.length=fe),this.applyPart(r,w.codeBetween1,f.zero,void 0),pe(fe),w.firstDigNumer!==ve.PictureSingle.Question&&(I.length=fe))}else{if(t=this.formFraction(de,ce,ee),Ce=t.numer,Ne=t.denom,f.cond(K)<0&&(this.onlyOneNumberPart||r.forceNeg)&&f.cond(Ce)===0)throw PZ;_e=!0,Le=I.length}var be=tO(f,Ce),xe={comma:!1,fractionDenom:!1,decimal:!1,digits:be,digitsExp:be.length,numDigLeft:z};this.applyPart(r,w.codeNumer,f.zero,xe),this.applyPart(r,w.codeBetween2,f.zero,void 0);var Ie=tO(f,Ne),Ve={comma:!1,fractionDenom:!0,decimal:xe.decimal,digits:Ie,digitsExp:Ie.length,numDigLeft:ee};this.applyPart(r,w.codeDenom,f.zero,Ve),_e||(w.anyQuestionNumer||w.firstDigDenom===ve.PictureSingle.Question?pe(Le):I.length=Le);break}case ve.PictureSingle.Decimal:{(0,fa.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Decimal numState",o!==void 0),o.digitsExp>0&&(o.numDigLeft=o.digitsExp,this.dumpDigLeft(r,o,o.digitsExp)),o.decimal=!0,I.push((0,vr.formattedUnitString)(m.decimalSeparator));break}case ve.PictureSingle.Hash:case ve.PictureSingle.Zero:case ve.PictureSingle.Question:{(0,fa.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart H/Z/Q numState",o!==void 0);var Ze=w.count;if(o.decimal||o.fractionDenom&&w.kind===ve.PictureSingle.Question){if(o.fractionDenom&&F!==n.length-1)throw new ic((0,qn.notImplemented)(["left-align bug in denominator"]));if(o.digitsExp<0){var gr=(0,Pu.fastMin)(Ze,-o.digitsExp),cr=(0,gg.convertDigitsShape)((0,Hs.repeat)("0",gr),E);I.push((0,vr.formattedUnitString)(cr)),o.digitsExp+=gr,Ze-=gr}{var _r=(0,Pu.fastMin)(Ze,o.digits.length),cr=(0,gg.convertDigitsShape)(o.digits.substring(0,_r),E);I.push((0,vr.formattedUnitString)(cr)),o.digits=o.digits.substring(_r),Ze-=_r}if(w.kind!==ve.PictureSingle.Hash&&Ze>0){var cr=(0,gg.convertDigitsShape)((0,Hs.repeat)("0",Ze),E);I.push(w.kind===ve.PictureSingle.Question?(0,vr.formattedUnitBlank)(cr):(0,vr.formattedUnitString)(cr))}break}if(o.numDigLeft>o.digitsExp){var gr=(0,Pu.fastMin)(Ze,o.numDigLeft-o.digitsExp);if(w.kind!==ve.PictureSingle.Hash){var cr=(0,gg.convertDigitsShape)((0,Hs.repeat)("0",gr),E);o.comma&&(cr=(0,gg.insertCommas)(m,cr,o.numDigLeft-gr)),I.push(w.kind===ve.PictureSingle.Question?(0,vr.formattedUnitBlank)(cr):(0,vr.formattedUnitString)(cr))}Ze-=gr,o.numDigLeft-=gr}else Ze+=o.digitsExp-o.numDigLeft,o.numDigLeft=o.digitsExp;this.dumpDigLeft(r,o,Ze);break}case an.PrefixDigTh:m.isThai&&(E=r.numShape=Pn.NumberShape.Thai);break;case an.LatinDate:this.hasTokenCurrCode||(r.bidiDate=vr.BidiDate.English);break;case an.BidiDate:throw new ic((0,qn.notImplemented)(["TokenKind.BidiDate"]));case ve.PictureSingle.HourTh:case ve.PictureSingle.MinuteTh:case ve.PictureSingle.SecondTh:case ve.PictureSingle.Hour:case ve.PictureSingle.Minute:case ve.PictureSingle.Second:{var xr=w.kind===ve.PictureSingle.HourTh||w.kind===ve.PictureSingle.MinuteTh||w.kind===ve.PictureSingle.SecondTh,Or=xr&&!this.hasTokenCurrCode?Pn.NumberShape.Thai:E;if(w.isAbs){var Rr=y();if((0,fa.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart H/M/S value",!(0,qn.isStringOper)(Rr)),xr&&this.hasTokenCurrCode)throw new ic((0,qn.notImplemented)(["fcAbsHourTh && fIntlNum bug"]));var ir=p.toTime(this.config,f.abs(Rr),TZ[w.kind],r.dtrRounding);if(ir===!1)throw new ic((0,qn.notImplemented)(["absolute time overflow"]));I.push((0,vr.formattedUnitString)(G3(f,f.fromNumber(ir),w.count,Or)))}else{var $e=S(),qe=void 0;if(w.kind===ve.PictureSingle.Minute||w.kind===ve.PictureSingle.MinuteTh)qe=$e.min;else if(w.kind===ve.PictureSingle.Second||w.kind===ve.PictureSingle.SecondTh)qe=$e.sec;else if(qe=$e.hour,w.isAMPM){if(w.kind===ve.PictureSingle.HourTh)throw new ic((0,qn.notImplemented)(["fc12HourTh/fc12Hour2Th forgotten"]));qe>12&&(qe-=12),qe===0&&(qe=12)}I.push((0,vr.formattedUnitString)(G3(f,f.fromNumber(qe),w.count,Or)))}break}case an.AMPM:case an.AMPMFE:{var fr=void 0;if((0,qn.isStringOper)(a)?fr=!0:fr=S().hour<12,(!this.hasTokenCurrCode||w.kind===an.AMPMFE)&&(w.kind===an.AMPMFE||m.isEastAsia||w.pictureKind===ve.PictureSpecial.AP2)){var lr=qye(m,w.tokenStr);I.push((0,vr.formattedUnitString)(lr[fr?0:1]));break}var dn=this.getBundledLocaleInfo("localised AM/PM string",Pn.Calendar.Gregorian,this.applyCurrCode);I.push((0,vr.formattedUnitString)(dn.ampmSymbols[fr?0:1]));break}case 404:{var Un=S();(0,fa.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart FracSeconds rounding",Un.rounding>=w.rounding);var Gr=Bgr(f,f.fromNumber(Un.fracSec),Un.rounding,w.rounding,E);I.push((0,vr.formattedUnitString)(m.decimalSeparator+Gr));break}case ve.PictureSingle.Era:throw new ic((0,qn.notImplemented)(["PictureSingle.Era"]));case ve.PictureSingle.EraYear:throw new ic((0,qn.notImplemented)(["PictureSingle.EraYear"]));case ve.PictureSingle.YearTh:case ve.PictureSingle.EngYearTh:case ve.PictureSingle.ThYear:case ve.PictureSingle.Year:{var Or=(w.kind===ve.PictureSingle.YearTh||w.kind===ve.PictureSingle.ThYear)&&!this.hasTokenCurrCode?Pn.NumberShape.Thai:E,Br=(w.kind===ve.PictureSingle.YearTh||w.kind===ve.PictureSingle.EngYearTh)&&!this.hasTokenCurrCode,bt=S().yr+(Br?Vye:0),qe=w.count>2?bt:bt%100;I.push((0,vr.formattedUnitString)(G3(f,f.fromNumber(qe),w.count,Or)));break}case ve.PictureSingle.Month:case ve.PictureSingle.MonthTh:{var Kr=S().mon;switch(w.count){case 1:case 2:{var Or=w.kind===ve.PictureSingle.MonthTh&&!this.hasTokenCurrCode?Pn.NumberShape.Thai:E;I.push((0,vr.formattedUnitString)(G3(f,f.fromNumber(Kr),w.count,Or)));break}case 3:case 4:case 5:{var Pt=void 0;if(r.bidiDate===vr.BidiDate.English?Pt=(0,ve.getEnglishLocaleInfo)():Pt=this.getBundledLocaleInfo("localised month string",v,w.kind===ve.PictureSingle.MonthTh&&!this.hasTokenCurrCode?RZ:this.applyCurrCode),w.count===3)I.push((0,vr.formattedUnitString)(Pt.monthNameShort[Kr-1]));else if(w.count===4||r.bidiDate===vr.BidiDate.English)I.push((0,vr.formattedUnitString)(Pt.monthNameLong[Kr-1]));else{var Mi=Pt.monthNameLong[Kr-1];I.push((0,vr.formattedUnitString)(Mi.substring(0,(0,sp.numCodeUnits)((0,sp.stringCodePointAt)(Mi,0)))))}break}}break}case ve.PictureSingle.Day:case ve.PictureSingle.DayTh:case ve.PictureSingle.LocDay:{var xr=w.kind===ve.PictureSingle.DayTh;if(w.count<3){var Or=xr&&!this.hasTokenCurrCode?Pn.NumberShape.Thai:E,El=S().dom;I.push((0,vr.formattedUnitString)(G3(f,f.fromNumber(El),w.count,Or)))}else{var Nl=S().wdy,Pt=void 0;if(r.bidiDate===vr.BidiDate.English||!this.hasTokenCurrCode&&m.isEastAsia&&w.kind===ve.PictureSingle.Day?Pt=(0,ve.getEnglishLocaleInfo)():Pt=this.getBundledLocaleInfo("localised day string",v,xr&&!this.hasTokenCurrCode?RZ:this.applyCurrCode),xr&&this.hasTokenCurrCode&&w.count===3)throw new ic((0,qn.notImplemented)(["fcDay3Th && fIntlNum bug"]));var cr=w.count===3?Pt.dayNameShort[Nl-1]:Pt.dayNameLong[Nl-1];I.push((0,vr.formattedUnitString)(cr))}break}case 407:(0,fa.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart SysFormat numState",o===void 0),this.applyPart(r,w.codeSysFormat,a,o);break;default:return(0,fa.assertNever)("calc.numfmt.NumberFormatImpl: applyPart code",w)}}C&&y()},e.prototype.dumpDigLeft=function(r,n,a){var o=this.config.localeInfo,u=r.units,t=r.numShape,d=a;{var s=(0,Pu.fastMin)(d,n.digits.length),c=(0,gg.convertDigitsShape)(n.digits.substring(0,s),t);n.comma&&(c=(0,gg.insertCommas)(o,c,n.numDigLeft-s)),u.push((0,vr.formattedUnitString)(c)),n.digits=n.digits.substring(s),d-=s,n.digitsExp-=s,n.numDigLeft-=s}if(d>0){var c=(0,gg.convertDigitsShape)((0,Hs.repeat)("0",d),t);n.comma&&(c=(0,gg.insertCommas)(o,c,n.numDigLeft-d)),u.push((0,vr.formattedUnitString)(c)),n.digitsExp-=d,n.numDigLeft-=d}},e.prototype.getPart=function(r){for(var n=this.config.mathpack,a=0;a<2;a+=1){var o=a,u=void 0;if(a===0){if(u=this.condPos,u===void 0&&n.cond(r)>0)return{partKind:o,forceNeg:!1}}else{if(this.parts[o]===this.parts[0])throw new LR(vr.noFormatPart);if(this.parts[0].code.length===0)throw new ic((0,qn.notImplemented)(['emulation of ";[COND]foo" bug']));if(u=this.condNeg,u===void 0){if(this.parts[2]===this.parts[0])return(0,fa.assertTrue)("calc.numfmt.NumberFormatImpl: getPart condPos",this.condPos!==void 0),{partKind:o,forceNeg:n.cond(this.condPos.operand)>0||this.condPos.operator===Ld.OperatorId.Eq};if(n.cond(r)<0)return{partKind:o,forceNeg:!1}}}if(u!==void 0){var t=u.operator,d=u.operand,s=n.sub(r,d);if((0,qn.isErrorOper)(s))throw new ic((0,qn.notImplemented)(["overflow in condition check"]));if((0,Ogr.applyComparison)(t,n.cond2(r,d)))switch(t){case Ld.OperatorId.Eq:return{partKind:o,forceNeg:!1};case Ld.OperatorId.Ne:case Ld.OperatorId.Gt:case Ld.OperatorId.Ge:return{partKind:o,forceNeg:!0};case Ld.OperatorId.Lt:return{partKind:o,forceNeg:n.cond(d)>0};case Ld.OperatorId.Le:return{partKind:o,forceNeg:n.cond(d)>=0}}}}var c=2;if(this.parts[c]===this.parts[0])throw new LR(vr.noFormatPart);return{partKind:c,forceNeg:!0}},e.prototype.getNumShape=function(r){var n=this.applyCurrCode,a=n==null?void 0:n.numberShape;if(a!==void 0)return a;if(r===void 0)return Pn.NumberShape.ASCII;var o=this.getBundledLocaleInfo("localised DBNUM culture",Pn.Calendar.Gregorian,n);return o.isEastAsia&&(o.isKorea?a=jgr[r]:o.isJapan?a=Wgr[r]:o.isChinaT?a=Kgr[r]:o.isChinaS&&(a=Vgr[r])),a??Pn.NumberShape.ASCII},e.prototype.formFraction=function(r,n,a){var o,u,t=this.config.mathpack;if(n!==void 0){var d=t.fromNumber(137438953472);if((0,qn.isErrorOper)(t.sub(r,d)))throw new ic((0,qn.notImplemented)(["overflow in fraction threshold check"]));if(t.cond2(r,d)<0){var s=t.mul(r,t.fromNumber(1.0000000000000002));(0,fa.assertTrue)("calc.numfmt.NumberFormatImpl: formFraction nudged error",(0,qn.isNumberOper)(s)),r=s}var c=n,l=t.toNumber(c)<<1,f=t.mul(r,t.fromNumber(l));if(!(0,qn.isNumberOper)(f))throw new ic((0,qn.notImplemented)(["overflow in fraction denom mul"]));var p=t.lfix(f);if(p<0||p>=65535)throw new LR(vr.fractionOverflow);var m=t.fromNumber(p+1>>1);return{numer:m,denom:c}}var v;switch(a){case 1:v=10;break;case 2:v=100;break;case 3:v=1e3;break;case 4:v=1e4;break;case 5:v=1e5;break;case 6:v=1e6;break;default:v=1e7;break}var h=t.fix(r);if(h>=2147483647)throw new LR(vr.fractionOverflow);for(var S=r,y=1,C=1,E=0,I=0;;){var F=y*h;I+=F;var w=E*h;C+=w;var B=F>2147483647||w>2147483647;if(B||C>=v){E===1&&h===2&&t.cond2(S,t.trunc(S))===0&&(y+=1);break}o=[I,y],y=o[0],I=o[1],u=[C,E],E=u[0],C=u[1];var k=t.sub(S,t.trunc(S));if((0,fa.assertTrue)("calc.numfmt.NumberFormatImpl: formFraction frac sub",(0,qn.isNumberOper)(k)),t.cond(k)===0)break;var x=t.div(t.one,k);if((0,qn.isErrorOper)(x))throw new ic((0,qn.notImplemented)(["overflow in fraction inversion"]));if(S=x,(h=t.fix(S))>2147483647)break}return E===0&&(E=y=1),{numer:t.fromNumber(y),denom:t.fromNumber(E)}},e.prototype.synthesizeDecimals=function(r){for(var n=this,a=(0,Pu.fastMax)(0,(0,Pu.fastMin)(r,bZ)),o=[],u=function(l){var f=t.parts[l];if((l===1||l===2)&&f===t.parts[0])return o.push(o[0]),"continue";if(l===3)return o.push(f===t.parts[0]?o[0]:f),"continue";var p=f.code,m=f.color,v=f.dbnum,h=f.dtrRounding,S=p.map(function(C){if(C.kind===403){var E=C.numDigLeft,I=C.numPercent,F=C.numThousands,w=C.comma,B=C.codeBefore,k={kind:403,numDigLeft:E,numDigDec:a,numPercent:I,numThousands:F,comma:w,code:n.adjustDecimals(l,C.numDigDec,C.code,a),codeBefore:B};return k}if(C.kind===402){var x=C.isNeg,G=C.numMantDigLeft,H=C.numExpDigLeft,L=C.commaMant,D=C.codeBetween,U=C.codeExp,k={kind:402,isNeg:x,numMantDigLeft:G,numMantDigDec:a,numExpDigLeft:H,commaMant:L,codeMant:n.adjustDecimals(l,C.numMantDigDec,C.codeMant,a),codeBetween:D,codeExp:U};return k}return C}),y={code:S,color:m,dbnum:v,dtrRounding:h};o.push(y)},t=this,d=0;d<=3;d+=1)u(d);try{var s=new e(this.config,{old:this,logFormatString:"synthesizeDecimals(dec=".concat(a," on ").concat(this.logFormatString,")"),synth:o});if(s.formatString.length>jye)throw new _n(this.notFormatString("format string too long: max length"));return s}catch(c){if(c instanceof _n)return this;throw c}},e.prototype.adjustDecimals=function(r,n,a,o){var u;if(o===n)return a;for(var t=!1,d=void 0,s=void 0,c=void 0,l=0;l<a.length;l+=1){var f=a[l];switch(f.kind){case ve.PictureSingle.Decimal:c===void 0&&(c=l);break;case ve.PictureSingle.Hash:case ve.PictureSingle.Question:case ve.PictureSingle.Zero:c!==void 0?s=l:(d=l,f.kind===ve.PictureSingle.Question&&(t=!0));break}}var p=function(H){return H===ve.PictureSingle.Percent||H===an.Currency||H===an.CurrCode||H===ve.PictureSingle.Star};if(o===0){if(c===void 0)return a;var m=0,v=0;d===void 0?s!==void 0&&(m=c+1,v=s+1):(m=c,v=(s??c)+1);for(var h=a.slice(0,m),l=m;l<v;l+=1)p(a[l].kind)&&h.push(a[l]);return(0,Pu.safePush)(h,a.slice(v)),h}if(n>o){(0,fa.assertTrue)("calc.numfmt.NumberFormatImpl: adjustDecimals dec",c!==void 0);var S=void 0;(function(G){G[G.AfterDigs=0]="AfterDigs",G[G.Dropping=1]="Dropping",G[G.Keeping=2]="Keeping"})(S||(S={}));for(var y=S.AfterDigs,C=[],E=n-o,l=a.length-1;l>=0;l-=1){l<=c&&(y=S.Keeping);var f=a[l];if(y===S.AfterDigs&&(f.kind===ve.PictureSingle.Hash||f.kind===ve.PictureSingle.Question||f.kind===ve.PictureSingle.Zero)&&(y=S.Dropping),y===S.Keeping||y===S.AfterDigs||p(f.kind)){C.push(f);continue}if(f.kind===ve.PictureSingle.Hash||f.kind===ve.PictureSingle.Question||f.kind===ve.PictureSingle.Zero){var I=(0,Pu.fastMin)(E,f.count);I<f.count&&C.push({kind:f.kind,count:f.count-I}),E-=I,E===0&&(y=S.Keeping)}}return C.reverse(),C}if(r===2&&t&&s===void 0)return a;var F=o-n;if(s!==void 0){var w=a.slice(),f=w[s];return w[s]={kind:f.kind,count:f.count+F},w}var B=a.slice(),k=(u=c??d)!==null&&u!==void 0?u:B.length-1,x=[];return c===void 0&&x.push({kind:ve.PictureSingle.Decimal}),x.push({kind:ve.PictureSingle.Zero,count:F}),B.splice.apply(B,BP.__spreadArray([k+1,0],x,!1)),B},e.prototype.parseString=function(r){if(this.source!==vr.NumberFormatSource.CustomBytecode&&r.length>jye)throw new _n(this.notFormatString("format string too long: max length"));for(var n=!1,a=!1,o=0,u=!1,t=0;t<=3&&!u;t+=1){var d=this.tokenize(r.substring(o)),s=d.cond,c=d.currencySymbol,l=d.hasTokenCurrCode,f=this.convertTokToSun(d),p=f.currCode,m=f.hasPercent,v=f.hasDate,h=f.hasTime,S=this.classifySunPartKind(f,t===3?3:0),y=this.convertSunToCode(f),C=y.part,E=y.applyCurrCode;if(o+=d.consumed,u=d.eos,m&&(this.hasPercent=!0),v&&(this.hasDate=!0),h&&(this.hasTime=!0),l){if(t!==0&&(!this.hasTokenCurrCode||!Ggr(this.thisCurrCode,p)))throw new _n((0,qn.notImplemented)(["inconsistent CurrCode in number parts"]));this.hasTokenCurrCode||(this.hasTokenCurrCode=!0,this.thisCurrCode=p)}if(E!==void 0&&this.applyCurrCode===void 0&&(this.applyCurrCode=E),c!==void 0&&this.thisCurrencySymbol===void 0&&(this.thisCurrencySymbol=c),this.source===vr.NumberFormatSource.System&&((0,fa.assertTrue)("calc.numfmt.NumberFormatImpl.parseString: system ipart",t===0),!u||S===3))throw new _n(this.notFormatString("system format with more than one part"));if((S===3||t===0&&S===1)&&(n=!0,this.parts[3]=C,S===3)){if(s!==void 0)throw new _n(this.notFormatString("condition in text part"));if(p!==void 0)throw new _n((0,qn.notImplemented)(["CurrCode in text part"]));break}if(a=!0,this.parts[t]=C,this.onlyOneNumberPart=t===0,t===0)this.parts[1]=C,this.parts[2]=C,this.condPos=s;else if(t===1)this.condNeg=s;else if(s!==void 0)throw new _n(this.notFormatString("condition in zero part"))}if(!u)throw new _n(this.notFormatString("too many parts"));a||(this.parts[0]=K3,this.parts[1]=K3,this.parts[2]=K3,this.posBeforeText=!1),n||(this.parts[3]=K3),a&&!n&&this.onlyOneNumberPart&&this.condPos!==void 0&&!Qye(this.parts[0].code)&&(this.parts[1]=K3,this.onlyOneNumberPart=!1),(0,fa.assertTrue)("calc.numfmt.NumberFormatImpl.parseString: every part set",this.parts.every(function(I){return I!==void 0})),this.checkBytecode()},e.prototype.tokenize=function(r){for(var n=this.config.localeInfo,a={color:void 0,dbnum:void 0,dbnumForbidden:!1,cond:void 0,hasTokenCurrCode:!1,currCode:void 0,currencySymbol:void 0,tokens:[],consumed:0,eos:!0},o,u,t;a.consumed<r.length&&a.eos;){var d=this.readToken(a,r,a.consumed),s=o;switch(o=d,a.consumed+=d.tokenStr.length,d.kind){case ve.PictureSingle.Sep:a.eos=!1;continue;case an.Color:if(a.color!==void 0)throw new _n(this.notFormatString("more than one color"));if(a.tokens.length!==0)throw new _n((0,qn.notImplemented)(["colour in middle of format"]));a.color=d.color;continue;case an.Dbnum:if(a.dbnum!==void 0)throw new _n(this.notFormatString("more than one DBNUM"));if(a.dbnumForbidden)throw new _n(this.notFormatString("DBNUM after token which forbids it (% or E)"));if(a.tokens.length!==0)throw new _n((0,qn.notImplemented)(["DBNUM in middle of format"]));a.dbnum=d.dbnum;continue;case an.Cond:if(a.cond!==void 0)throw new _n(this.notFormatString("more than one condition"));if(a.tokens.length!==0)throw new _n((0,qn.notImplemented)(["condition in middle of format"]));a.cond=d.cond;continue;case an.CurrCode:if(u!==void 0)throw new _n(this.notFormatString("more than one currency code in section"));u=d;break;case an.Currency:t=d;break;case an.AMPM:case an.AMPMFE:case ve.PictureSingle.Colon:case ve.PictureSingle.DateSep:case an.LatinDate:case an.BidiDate:case ve.PictureSingle.Year:case ve.PictureSingle.Month:case ve.PictureSingle.Day:case ve.PictureSingle.Hour:case ve.PictureSingle.Minute:case ve.PictureSingle.Second:case ve.PictureSingle.Reign:case ve.PictureSingle.LocDay:case ve.PictureSingle.Era:case ve.PictureSingle.EraYear:case ve.PictureSingle.EngYearTh:case ve.PictureSingle.DayTh:case ve.PictureSingle.MonthTh:case ve.PictureSingle.YearTh:case ve.PictureSingle.ThYear:case ve.PictureSingle.HourTh:case ve.PictureSingle.MinuteTh:case ve.PictureSingle.SecondTh:{if((s==null?void 0:s.kind)===d.kind){s.count+=d.count;continue}break}}a.tokens.push(d)}return u!==void 0?(a.hasTokenCurrCode=!0,a.currCode=u.currCode,a.currencySymbol=u.currencySymbol):t!==void 0&&a.currencySymbol===void 0&&(a.currencySymbol=vr.FormatCurrency.LocaleInfo),a.dbnum===4&&!n.isKorea&&(a.currCode!==void 0||n.isThai)&&(a.dbnum=void 0),a},e.prototype.readToken=function(r,n,a){var o=this.config,u=o.mathpack,t=o.localeInfo,d=UP(t,t.pictureSpecial,n,a);if(d!==void 0){var s=d,c=Ft(t.pictureSpecial,s);t.isJapan&&s===ve.PictureSpecial.GeneralOldMAC&&(s=ve.PictureSpecial.General);var l=n.substring(a,a+c.length);switch(s){case ve.PictureSpecial.AP1:case ve.PictureSpecial.AP2:return{kind:an.AMPM,tokenStr:l,count:1,pictureKind:s};case ve.PictureSpecial.AP3:return{kind:an.AMPMFE,tokenStr:l,count:1};case ve.PictureSpecial.General:return{kind:an.General,tokenStr:l};case ve.PictureSpecial.Currency:return{kind:an.Currency,tokenStr:l};default:break}}var f=(0,sp.stringCodePointAt)(n,a),p=(0,sp.numCodeUnits)(f),m=n.substring(a,a+p),v=Bye(t,t.pictureSingle,n,a);if(v!==void 0){var s=v;if((t.isJapan||t.isChinaT)&&(s===ve.PictureSingle.E||s===ve.PictureSingle.EraYear)){var h=void 0,S=void 0;a+p+1<n.length&&((h=n.charCodeAt(a+p))===hZ||h===Dye)&&((S=n.charCodeAt(a+p+1))===Fgr||S===Igr||S===Mgr)?s=ve.PictureSingle.E:s=ve.PictureSingle.EraYear}if(s===ve.PictureSingle.BidiDate||s===ve.PictureSingle.EngYearTh){var h=void 0;if(a+p<n.length&&((h=n.charCodeAt(a+p))===xye||h===wgr))return{kind:h===xye?an.LatinDate:an.BidiDate,tokenStr:n.substring(a,a+p+1),count:1};s=ve.PictureSingle.EngYearTh}if(s===ve.PictureSingle.BidiNum)throw new _n(this.notFormatString("bidi num not allowed"));switch(s){case ve.PictureSingle.Star:case ve.PictureSingle.Underscore:{if(a+p>=n.length)throw new _n(this.notFormatString("unterminated "+m));var h=(0,sp.stringCodePointAt)(n,a+p),y=(0,sp.numCodeUnits)(h),C=(0,sp.stringFromCodePoint)(h),l=n.substring(a,a+p+y);return{kind:s,tokenStr:l,escaped:C}}case ve.PictureSingle.Backslash:return this.readToken_Backslash(n,a,p);case ve.PictureSingle.Quote:{var E=n.indexOf(m,a+p);if(E<0)throw new _n(this.notFormatString("unterminated quoted string"));var I=n.substring(a+p,E),l=n.substring(a,E+p),F=UP(t,t.pictureSpecial,I,0);return F!==void 0&&F===ve.PictureSpecial.Currency&&Ft(t.pictureSpecial,F).length===I.length?{kind:an.Currency,tokenStr:l}:{kind:an.StrLit,tokenStr:l,escaped:I}}case ve.PictureSingle.E:{if(t.isEastAsia){if(r.dbnum!==void 0)throw new _n(this.notFormatString("invalid DBNUM with exp"));if(r.dbnumForbidden)throw new _n((0,qn.notImplemented)(["multiple DBNUM-forbidden tokens (% or E)"]));r.dbnumForbidden=!0}if(a+p>=n.length)throw new _n(this.notFormatString("unterminated exp"));var h=n.charCodeAt(a+p);if(h!==Dye&&h!==hZ)throw new _n(this.notFormatString("exp not followed by sign"));var l=n.substring(a,a+p+1);return{kind:an.Exp,tokenStr:l,eStr:m,isNeg:h===hZ}}case ve.PictureSingle.Hash:case ve.PictureSingle.Year:case ve.PictureSingle.Month:case ve.PictureSingle.Day:case ve.PictureSingle.Hour:case ve.PictureSingle.Minute:case ve.PictureSingle.Second:case ve.PictureSingle.YearTh:case ve.PictureSingle.MonthTh:case ve.PictureSingle.DayTh:case ve.PictureSingle.HourTh:case ve.PictureSingle.MinuteTh:case ve.PictureSingle.SecondTh:case ve.PictureSingle.EngYearTh:case ve.PictureSingle.ThYear:case ve.PictureSingle.Question:case ve.PictureSingle.Comma:case ve.PictureSingle.Reign:case ve.PictureSingle.LocDay:case ve.PictureSingle.Era:case ve.PictureSingle.EraYear:{if(s===ve.PictureSingle.Reign&&!(t.isJapan||t.isChinaT))break;for(var w=p,B=1;(0,Hs.stringStartsWith)(n,m,a+w)&&UP(t,t.pictureSpecial,n,a+w)===void 0;)w+=p,B+=1;if(s===ve.PictureSingle.LocDay&&B<3)break;var l=n.substring(a,a+w);return{kind:s,tokenStr:l,count:B}}case ve.PictureSingle.Sep:case ve.PictureSingle.Text:case ve.PictureSingle.Decimal:case ve.PictureSingle.Slash:case ve.PictureSingle.Minus:case ve.PictureSingle.Plus:return{kind:s,tokenStr:m};case ve.PictureSingle.Space:return{kind:an.Char,tokenStr:m,escaped:m};case ve.PictureSingle.Colon:return{kind:s,tokenStr:m,count:1};case ve.PictureSingle.Percent:if(t.isEastAsia){if(r.dbnum!==void 0)throw new _n(this.notFormatString("invalid DBNUM with pct"));if(r.dbnumForbidden)throw new _n((0,qn.notImplemented)(["multiple DBNUM-forbidden tokens (% or E)"]));r.dbnumForbidden=!0}return{kind:ve.PictureSingle.Percent,tokenStr:m};case ve.PictureSingle.DateSep:return m===Ft(t.pictureSingle,ve.PictureSingle.Slash)?{kind:ve.PictureSingle.Slash,tokenStr:m}:m===Ft(t.pictureSingle,ve.PictureSingle.Minus)?{kind:ve.PictureSingle.Minus,tokenStr:m}:{kind:ve.PictureSingle.DateSep,tokenStr:m,count:1};case ve.PictureSingle.ColorStart:{var k=Ft(t.pictureSingle,ve.PictureSingle.ColorEnd),x=n.indexOf(k,a+p);if(x<0)throw new _n(this.notFormatString("unterminated ["));var G=n.substring(a+p,x),l=n.substring(a,x+k.length),H=UP(t,yZ,G,0);if(H!==void 0){for(var L=Ft(yZ,H),D=L.length;D<G.length&&(0,AU.isSpace)(G.charCodeAt(D));)D+=1;var U=(0,AU.parseSignedLiteral)(t,u,G,D,!1);if(U[1]===D)throw new _n((0,qn.notImplemented)(["invalid number in condition"]));if(U[1]!==G.length)throw new _n((0,qn.notImplemented)(["trailing junk after condition"]));return{kind:an.Cond,tokenStr:l,cond:{operator:Jgr[H],operand:U[0]}}}var V=UP(t,t.pictureColor,G,0);if(V!==void 0){var ne=Ft(t.pictureColor,V);if(V!==ve.PictureColor.Color){if(ne.length!==G.length)throw new _n((0,qn.notImplemented)(["trailing junk after named color"]));return{kind:an.Color,tokenStr:l,color:Hgr(V)}}if(V===ve.PictureColor.Color){for(var J=ne.length;J<G.length&&(0,AU.isSpace)(G.charCodeAt(J));)J+=1;var $=(0,AU.parseUint)(t,4,G,J),Z=$[0],ie=$[1];if(ie===J)throw new _n(this.notFormatString("missing number for numbered color"));if(ie!==G.length)throw new _n((0,qn.notImplemented)(["trailing junk after numbered color"]));if(Z<1||Z>56)throw new _n(this.notFormatString("out-of-range numbered color"));return{kind:an.Color,tokenStr:l,color:Z+8}}}var X=UP(t,t.pictureDbnum,G,0);if(X!==void 0){var Q=Ft(t.pictureDbnum,X);if(Q.length!==G.length)throw new _n((0,qn.notImplemented)(["trailing junk after DBNUM"]));return{kind:an.Dbnum,tokenStr:l,dbnum:zgr(X)}}return(0,Hs.stringStartsWith)(G,CZ)?BP.__assign({kind:an.CurrCode,tokenStr:l},this.parseCurrCode(G.substring(CZ.length))):{kind:s,tokenStr:m}}case ve.PictureSingle.ColorEnd:return{kind:s,tokenStr:m};case ve.PictureSingle.OpenParen:case ve.PictureSingle.CloseParen:return{kind:s,tokenStr:m,escaped:m};case ve.PictureSingle.Extra:case ve.PictureSingle.APDelim:case ve.PictureSingle.Nen1:case ve.PictureSingle.Gatsu1:case ve.PictureSingle.Nichi1:case ve.PictureSingle.Nen2:case ve.PictureSingle.Gatsu2:case ve.PictureSingle.Nichi2:break;case ve.PictureSingle.Zero:case ve.PictureSingle.ZeroTh:break;default:return(0,fa.assertNever)("calc.numfmt.NumberFormatImpl: readToken single picKind",s)}}if(t.isNumeral(f)){if(t.getNumberShape(f)!==Pn.NumberShape.ASCII)throw new _n((0,qn.notImplemented)(["non-ASCII digits"]));var b=t.getOrdinal(f);if(b===0){for(var R=p,B=1;(0,Hs.stringStartsWith)(n,m,a+R);)R+=p,B+=1;var l=n.substring(a,a+R);return{kind:ve.PictureSingle.Zero,tokenStr:l,count:B}}return{kind:an.Numeral,tokenStr:m,ordinal:b}}switch(f){case SZ:return{kind:ve.PictureSingle.OpenParen,tokenStr:m,escaped:m};case Lye:return{kind:ve.PictureSingle.CloseParen,tokenStr:m,escaped:m};case xgr:return this.readToken_Backslash(n,a,p);case Dgr:if(t.isThai)return{kind:an.PrefixDigTh,tokenStr:m};break}return{kind:an.Char,tokenStr:m,escaped:m}},e.prototype.readToken_Backslash=function(r,n,a){if(n+a>=r.length)throw new _n(this.notFormatString("unterminated backslash"));var o=(0,sp.stringCodePointAt)(r,n+a),u=(0,sp.numCodeUnits)(o),t=(0,sp.stringFromCodePoint)(o),d=r.substring(n,n+a+u);return o===SZ||o===Lye?{kind:o===SZ?ve.PictureSingle.OpenParen:ve.PictureSingle.CloseParen,tokenStr:d,escaped:t}:{kind:an.Char,tokenStr:d,escaped:t}},e.prototype.convertTokToSun=function(r){var n=this,a,o=r.color,u=r.dbnum,t=r.cond,d=r.currCode,s=r.tokens,c=this.config.localeInfo,l={suns:[],dtrRounding:BR.Rounding.RoundSec,color:o,dbnum:u,currCode:d,hasPercent:!1,hasDate:!1,hasTime:!1,get isEmpty(){return this.suns.length===0&&t===void 0&&o===void 0&&u===void 0&&d===void 0}},f=c.stringCompareCI(Ft(c.pictureSingle,ve.PictureSingle.Month),Ft(c.pictureSingle,ve.PictureSingle.Minute))===0,p=!1,m=0,v=0,h=!1,S=!1,y,C=!1,E=!1,I,F,w,B,k=0,x=function(Le,Oe){var le=TZ[Le];if(Oe){if(S)throw new _n(n.notFormatString("more than one absolute time"));if(y!==void 0&&le>=y)throw new _n(n.notFormatString("absolute time must be largest division"));S=!0}else if(S&&le<=y)throw new _n((0,qn.notImplemented)(["larger time division after absolute time"]));(y===void 0||le<y)&&(y=le)};function G(Ne,Le,Oe){var le=y;if(x(Ne,Le),Ne===ve.PictureSingle.Hour||Ne===ve.PictureSingle.HourTh)C=!0,w=Oe,B=void 0;else if(Ne===ve.PictureSingle.Second||Ne===ve.PictureSingle.SecondTh)if(B!==void 0&&!S){var me=B.code[0];(0,fa.assertTrue)("calc.numfmt.NumberFormatImpl: onTime ambigCode",me.kind===ve.PictureSingle.Month);var Pe=ve.PictureSingle.Minute,Re=me.count;(0,fa.assertTrue)("calc.numfmt.NumberFormatImpl: onTime ambigCount",Re===1||Re===2);var fe=!1;x(Pe,fe),m-=1,v+=1,B.code=[{kind:Pe,count:Re,isAbs:fe}],B=void 0}else le===void 0&&(C=!0);else C=!1}function H(Ne){var Le=Ft(c.pictureSingle,Ne.kind);return{kind:406,printAsTimeSep:m>0||v>0,formattedStr:Le}}function L(Ne){var Le=Ft(c.pictureSingle,Ne.kind);return Le===Ft(c.pictureSingle,ve.PictureSingle.DateSep)?{kind:405}:Le===Ft(c.pictureSingle,ve.PictureSingle.Colon)?H(Ne):{kind:400,formattedStr:Le}}for(var D=0;D<s.length;D+=1){var U=s[D];switch(U.kind){case an.AMPM:case an.AMPMFE:case ve.PictureSingle.Colon:case ve.PictureSingle.DateSep:case ve.PictureSingle.Year:case ve.PictureSingle.Month:case ve.PictureSingle.Day:case ve.PictureSingle.Hour:case ve.PictureSingle.Minute:case ve.PictureSingle.Second:case ve.PictureSingle.Reign:case ve.PictureSingle.LocDay:case ve.PictureSingle.Era:case ve.PictureSingle.EraYear:case ve.PictureSingle.EngYearTh:case an.LatinDate:case an.BidiDate:case ve.PictureSingle.DayTh:case ve.PictureSingle.MonthTh:case ve.PictureSingle.YearTh:case ve.PictureSingle.ThYear:case ve.PictureSingle.HourTh:case ve.PictureSingle.MinuteTh:case ve.PictureSingle.SecondTh:{var V={kind:1,code:[]};switch(l.suns.push(V),h=!0,U.kind){case an.LatinDate:case an.BidiDate:if(D!==0&&!(D===1&&s[0].kind===an.CurrCode))throw new _n(this.notFormatString("bidi date must be first"));V.code.push(U);break;case ve.PictureSingle.DateSep:V.code.push({kind:405});break;case ve.PictureSingle.Colon:V.code.push(H(U));break;case ve.PictureSingle.Reign:m+=1,c.isJapan&&U.count>=2&&V.code.push({kind:ve.PictureSingle.Era,count:3}),V.code.push({kind:ve.PictureSingle.EraYear,count:c.isChinaT?1:2});break;case ve.PictureSingle.Era:m+=1,V.code.push({kind:ve.PictureSingle.Era,count:(0,Pu.fastMin)(3,U.count)});break;case ve.PictureSingle.EraYear:m+=1,V.code.push({kind:ve.PictureSingle.EraYear,count:(0,Pu.fastMin)(2,U.count)});break;case ve.PictureSingle.Year:case ve.PictureSingle.YearTh:case ve.PictureSingle.EngYearTh:case ve.PictureSingle.ThYear:B=void 0,m+=1,V.code.push({kind:U.kind,count:U.count<=2?2:4});break;case ve.PictureSingle.Month:{if(f&&U.count<=2){if(C){var ne=ve.PictureSingle.Minute,J=!1;G(ne,J,V),v+=1,V.code.push({kind:ne,count:U.count,isAbs:J}),C=!1;break}B=V}else B=void 0;m+=1,V.code.push({kind:U.kind,count:(0,Pu.fastMin)(5,U.count)});break}case ve.PictureSingle.MonthTh:{m+=1,V.code.push({kind:U.kind,count:(0,Pu.fastMin)(4,U.count)});break}case ve.PictureSingle.Day:case ve.PictureSingle.DayTh:B=void 0,m+=1,V.code.push({kind:U.kind,count:(0,Pu.fastMin)(4,U.count)});break;case ve.PictureSingle.LocDay:B=void 0,m+=1,V.code.push({kind:ve.PictureSingle.LocDay,count:U.count===3?3:4});break;case ve.PictureSingle.Hour:case ve.PictureSingle.HourTh:case ve.PictureSingle.Minute:case ve.PictureSingle.MinuteTh:case ve.PictureSingle.Second:case ve.PictureSingle.SecondTh:{var J=!1;G(U.kind,J,V),v+=1;var $=(0,Pu.fastMin)(2,U.count);U.kind===ve.PictureSingle.Hour||U.kind===ve.PictureSingle.HourTh?V.code.push({kind:U.kind,count:$,isAbs:J,isAMPM:!1}):V.code.push({kind:U.kind,count:$,isAbs:J});break}case an.AMPM:case an.AMPMFE:if(S)throw new _n(this.notFormatString("AM/PM after absolute time"));if(U.count>1)throw new _n((0,qn.notImplemented)(["multiple AM/PM symbols"]));if(w!==void 0){var Z=w.code[0];Z.isAMPM=!0,w=void 0}E=!0,V.code.push(U);break;default:return(0,fa.assertNever)("calc.numfmt.NumberFormatImpl: convertTokToSun tok as date",U)}break}case ve.PictureSingle.Decimal:case an.Numeral:case ve.PictureSingle.Hash:case ve.PictureSingle.Zero:case ve.PictureSingle.Question:case ve.PictureSingle.Comma:{if(h){if(U.kind!==ve.PictureSingle.Decimal&&U.kind!==ve.PictureSingle.Comma)throw new _n(this.notFormatString("number picture in date/time format"));var ie={kind:1,code:[]};l.suns.push(ie);var X=s[D+1];if(U.kind===ve.PictureSingle.Decimal&&(X==null?void 0:X.kind)===ve.PictureSingle.Zero){var Q=X.count;if(Q>3)throw new _n(this.notFormatString("invalid number of fractional seconds"));D+=1,G(ve.PictureSingle.Second,!1,ie),v+=1,ie.code.push({kind:404,rounding:Q}),l.dtrRounding=(0,Pu.fastMax)(l.dtrRounding,Q)}else ie.code.push(L(U));break}if(U.kind===ve.PictureSingle.Comma){var b=Ft(c.pictureSingle,U.kind),R={kind:7,code:[{kind:400,formattedStr:b}]};l.suns.push(R);break}var P=function(Oe){return Oe===an.Numeral||Oe===ve.PictureSingle.Hash||Oe===ve.PictureSingle.Zero||Oe===ve.PictureSingle.Question},V={kind:0,code:[],numDigLeft:0,numDigDec:0,numPercent:0,numThousands:0,comma:!1,decimal:!1,numVal:!1,nonZero:!1,get digitTokens(){return this.anyHash||this.anyQuestion},get reallyNum(){return this.anyHash||this.anyQuestion||this.anyZero},lastDig:void 0,firstDig:void 0,anyHash:!1,anyQuestion:!1,anyZero:!1};l.suns.push(V),I===void 0&&(I=V),F=V;var A=void 0;for(D-=1;D+1<s.length;D+=1){var T=s[D+1],g=!0;switch(T.kind){case ve.PictureSingle.Decimal:p=V.decimal=!0,V.code.push(T),A=void 0;break;case an.Numeral:V.code.push({kind:T.kind,formattedStr:T.tokenStr,ordinal:T.ordinal}),V.numVal=V.nonZero=!0,A=void 0;break;case ve.PictureSingle.Hash:case ve.PictureSingle.Zero:case ve.PictureSingle.Question:if(V.decimal?V.numDigDec+=T.count:V.numDigLeft+=T.count,V.firstDig===void 0&&(V.firstDig=T.kind),V.lastDig=T.kind,T.kind===ve.PictureSingle.Hash?V.anyHash=!0:T.kind===ve.PictureSingle.Question?V.anyQuestion=!0:(V.anyZero=!0,V.numVal=!0),A!==void 0&&A.kind===T.kind)A.count+=T.count;else{var Z={kind:T.kind,count:T.count};V.code.push(Z),A=Z}break;case ve.PictureSingle.Comma:var X=(a=s[D+2])===null||a===void 0?void 0:a.kind;if(P(X))p||(V.comma=!0);else{var $=T.count,O=Ft(c.pictureSingle,ve.PictureSingle.Space),M=Ft(c.pictureSingle,ve.PictureSingle.Comma);O===M&&(!c.isCurrencySymbolLead&&c.isCurrencySepBySpace&&X===an.Currency||c.isPercentSepBySpace&&X===ve.PictureSingle.Percent)&&(V.code.push({kind:400,formattedStr:O}),$-=1),$>0&&(V.numThousands+=$)}break;default:g=!1;break}if(!g)break}break}case ve.PictureSingle.Percent:{k+=1;var V={kind:3,code:[{kind:ve.PictureSingle.Percent,formattedStr:U.tokenStr}]};l.suns.push(V),l.hasPercent=!0;break}case an.Exp:{var V={kind:4,code:[{kind:an.Exp,formattedStr:U.eStr,isNeg:U.isNeg}],isNeg:U.isNeg};l.suns.push(V);break}case an.General:{var V={kind:6,code:[U]};l.suns.push(V);break}case ve.PictureSingle.Text:{var V={kind:5,code:[U]};l.suns.push(V);break}case ve.PictureSingle.Slash:{if(h){var K={kind:1,code:[L(U)]};l.suns.push(K);break}var V={kind:2,code:[{kind:ve.PictureSingle.Slash,formattedStr:U.tokenStr}]};l.suns.push(V);break}case ve.PictureSingle.Star:case an.PrefixDigTh:case ve.PictureSingle.Underscore:case an.Currency:case an.CurrCode:case an.StrLit:{var V={kind:7,code:[U]};l.suns.push(V);break}case ve.PictureSingle.ColorEnd:case ve.PictureSingle.Plus:{var V={kind:7,code:[{kind:400,formattedStr:U.tokenStr}]};l.suns.push(V);break}case ve.PictureSingle.OpenParen:case ve.PictureSingle.CloseParen:case an.Char:{var V={kind:7,code:[{kind:400,formattedStr:U.escaped}]};l.suns.push(V);break}case ve.PictureSingle.Minus:{if(h){var W={kind:1,code:[L(U)]};l.suns.push(W);break}var b=Ft(c.pictureSingle,U.kind),V={kind:7,code:[{kind:400,formattedStr:b}]};l.suns.push(V);break}case ve.PictureSingle.ColorStart:{for(var z=0,V={kind:1,code:[]};D+1<s.length&&z!==2;D+=1){var ee=s[D+1];switch(ee.kind){case ve.PictureSingle.ColorEnd:if(z!==1)throw new _n(this.notFormatString("unexpected closing ]"));z=2;continue;case ve.PictureSingle.Hour:case ve.PictureSingle.HourTh:case ve.PictureSingle.Month:case ve.PictureSingle.Minute:case ve.PictureSingle.Second:{if(ee.kind===ve.PictureSingle.Month&&!f)break;var ne=ee.kind===ve.PictureSingle.Month?ve.PictureSingle.Minute:ee.kind,J=!0;G(ne,J,V),v+=1;var $=(0,Pu.fastMin)(2,ee.count);ne===ve.PictureSingle.Hour||ne===ve.PictureSingle.HourTh?V.code.push({kind:ne,count:$,isAbs:J,isAMPM:!1}):V.code.push({kind:ne,count:$,isAbs:J}),h=!0,z=1;continue}case an.Char:if(ee.tokenStr===Ft(c.pictureSingle,ve.PictureSingle.Space))continue;break;default:break}throw new _n(this.notFormatString("unexpected token after ["))}if(z!==2)throw new _n((0,qn.notImplemented)(["semicolon inside [ ]"]));l.suns.push(V);break}default:return(0,fa.assertNever)("calc.numfmt.NumberFormatImpl: convertTokToSun tok",U)}if(l.suns.length>=2){var ue=l.suns[l.suns.length-2],ce=l.suns[l.suns.length-1];if(ue.kind===7&&ce.kind===7){var he=ue.code;(0,Pu.safePush)(he,ce.code),l.suns.pop()}}}if(I!==void 0&&(I.numThousands=F.numThousands,I.numPercent=k),E&&w!==void 0){var Z=w.code[0];Z.isAMPM=!0}if(S)for(var de=0,pe=l.suns;de<pe.length;de++){var V=pe[de];if(V.kind===1)for(var _e=0,Ce=V.code;_e<Ce.length;_e++){var Z=Ce[_e];switch(Z.kind){case ve.PictureSingle.Hour:case ve.PictureSingle.HourTh:case ve.PictureSingle.Minute:case ve.PictureSingle.MinuteTh:case ve.PictureSingle.Second:case ve.PictureSingle.SecondTh:Z.isAbs=TZ[Z.kind]===y;break}}}if(l.suns.length>pvr)throw new _n(this.notFormatString("format string too long: SUNs limit"));return l.hasDate=m>0,l.hasTime=v>0,l},e.prototype.classifySunPartKind=function(r,n){for(var a=r.suns,o=r.isEmpty,u=r.hasDate,t=r.hasTime,d=n===2,s=n===3,c=!d&&!s,l=0,f=a;l<f.length;l++){var p=f[l];switch(p.kind){case 0:case 2:case 3:case 4:d=!0;break;case 5:s=!0;break;case 6:continue;case 7:case 1:break;default:return(0,fa.assertNever)("calc.numfmt.NumberFormatImpl: classifySunPartKind sun",p)}c=!1}if((d?1:0)+(u||t?1:0)+(s?1:0)>1)throw new _n(this.notFormatString("cannot mix number/date/text"));return d||u||t?2:s?3:c&&!o?1:n},e.prototype.convertSunToCode=function(r){var n=r.suns,a=r.isEmpty,o=r.dtrRounding,u=r.color,t=r.dbnum,d=r.currCode,s=this.config.localeInfo,c=[];function l(A){for(var T=A-1;T>=0;T-=1){var g=n[T];if(g.kind===0)return[T,g]}}function f(A){for(var T=A+1;T<n.length;T+=1){var g=n[T];if(g.kind===0)return[T,g]}}for(var p,m=!1,v=0,h=0;h<n.length;h+=1){var S=n[h];switch(S.kind){case 5:if(p===5)break;if(p!==void 0)throw new _n(this.notFormatString("@ after other control"));p=5;break;case 6:if(p!==void 0)throw new _n(this.notFormatString("General after other control"));if(m)throw new _n(this.notFormatString("General after number"));p=6;break;case 0:if(m=!0,p===6)throw new _n(this.notFormatString("number after General"));break;case 2:if(p!==void 0)throw new _n(this.notFormatString("/ after other control"));if(s.isEastAsia&&t!==void 0)throw new _n(this.notFormatString("/ not allowed with DBNUM"));p=2;var y=l(h);if(y===void 0)throw new _n(this.notFormatString("no number before /"));var C=this.mergeNumSuns(n,v,y[0]),E=C[0],I=C[1],F=C[2],w=f(h);if(w===void 0)throw new _n(this.notFormatString("no number after /"));var B=n.slice(y[0]+1,w[0]),k=f(w[0])!==void 0;(0,Pu.safePush)(c,this.flattenSuns(E)),(0,Pu.safePush)(c,this.buildFractCode(I,F,y[1],B,w[1],k)),v=w[0]+1;break;case 4:if(p!==void 0)throw new _n(this.notFormatString("E after other control"));p=4;var x=this.mergeNumSuns(n,v,h),G=x[0],H=x[1],L=x[2];if(H===void 0)throw new _n(this.notFormatString("no number before E"));var D=this.mergeNumSuns(n,h+1,n.length),U=D[0],V=D[1],ne=D[2];if(V===void 0)throw new _n(this.notFormatString("no number after E"));(0,Pu.safePush)(c,this.flattenSuns(G)),(0,Pu.safePush)(c,this.buildExpCode(S.isNeg,H,BP.__spreadArray(BP.__spreadArray(BP.__spreadArray([],L,!0),[n[h]],!1),U,!0),V)),(0,Pu.safePush)(c,this.flattenSuns(ne)),v=n.length;break;case 3:case 7:case 1:break;default:return(0,fa.assertNever)("calc.numfmt.NumberFormatImpl: convertSunToCode sun",S)}}if(p===void 0){var J=this.mergeNumSuns(n,v,n.length),E=J[0],$=J[1],Z=J[2];$!==void 0?(0,Pu.safePush)(c,this.buildNumberCode(E,$)):(0,Pu.safePush)(c,this.flattenSuns(E)),(0,Pu.safePush)(c,this.flattenSuns(Z)),v=n.length}(0,Pu.safePush)(c,this.flattenSuns(n.slice(v))),n.length===0&&!a&&c.push(Hye);var ie=d==null?void 0:d.tag;if((0,vr.isSystemCultureTag)(ie)){var X=ie===vr.CultureTag.SysDate?s.sysDateFormat:s.sysTimeFormat,Q=new e(this.config,{old:void 0,formatString:X,source:vr.NumberFormatSource.System}),b=Q.parts[0],R={code:[{kind:407,codeSysFormat:b.code,codeThisFormat:c}],color:b.color,dbnum:b.dbnum,dtrRounding:b.dtrRounding};return{part:R,applyCurrCode:Q.thisCurrCode}}var P={code:c,color:u,dbnum:t,dtrRounding:o};return{part:P,applyCurrCode:d}},e.prototype.flattenSuns=function(r){return(0,Pu.safeConcat)([],r.map(function(n){return n.code}))},e.prototype.buildExpCode=function(r,n,a,o){if(o.comma)throw new _n(this.notFormatString("comma following E"));var u=n.numDigDec;if(u>bZ)throw new _n(this.notFormatString("too many decimal digits"));var t=this.bumpDigitsForComma(n),d=t.code,s=t.comma,c=t.numDigLeft;return[{kind:402,isNeg:r,numMantDigLeft:c,numMantDigDec:u,numExpDigLeft:o.numDigLeft,commaMant:s,codeMant:d,codeBetween:this.flattenSuns(a),codeExp:this.flattenSuns([o])}]},e.prototype.buildNumberCode=function(r,n){var a=n.numDigDec;if(a>bZ)throw new _n(this.notFormatString("too many decimal digits"));var o=this.bumpDigitsForComma(n),u=o.code,t=o.comma,d=o.numDigLeft;return[{kind:403,numDigLeft:d,numDigDec:a,numPercent:n.numPercent,numThousands:n.numThousands,comma:t,codeBefore:this.flattenSuns(r),code:u}]},e.prototype.buildFractCode=function(r,n,a,o,u,t){var d,s,c,l=this.config.mathpack;if(a.comma)throw new _n(this.notFormatString("comma in numerator"));if(a.decimal)throw new _n((0,qn.notImplemented)(["decimals in numerator"]));if(u.comma)throw new _n(this.notFormatString("comma in denominator"));if(u.decimal)throw new _n(this.notFormatString("decimals in denominator"));if(a.numDigDec!==0)throw new _n(this.notFormatString("decimals in numerator"));if(cvr(u))throw new _n(this.notFormatString("literal and placeholder digits mixed in denominator"));if(t)throw new _n((0,qn.notImplemented)(["fraction number formats with trailing numbers"]));var f=!1,p=0,m;if(r!==void 0){if(!r.reallyNum)throw new _n((0,qn.notImplemented)(["fixed numerals in fraction integer part"]));if(r.decimal)throw new _n((0,qn.notImplemented)(["decimal in fraction integer part"]));if(r.numDigDec!==0)throw new _n(this.notFormatString("decimals in fraction integer part"));if(r.numVal&&r.nonZero)throw new _n((0,qn.notImplemented)(["numerals in fraction integer part"]));d=this.bumpDigitsForComma(r),m=d.code,f=d.comma,p=d.numDigLeft}var v=(s=r==null?void 0:r.numPercent)!==null&&s!==void 0?s:a.numPercent,h=(c=r==null?void 0:r.numThousands)!==null&&c!==void 0?c:a.numThousands;if(h>0)throw new _n((0,qn.notImplemented)(["fraction number formats with thousands"]));var S=u.code,y=u.numDigLeft,C=u.firstDig,E;if(u.numVal&&u.nonZero){if(t)throw new _n((0,qn.notImplemented)(["fraction number formats with specified denominator and trailing numbers"]));if(u.code.length>5)throw new _n((0,qn.notImplemented)(["too many digits in denominator"]));for(var I=0,F=0;F<u.code.length;F+=1){var w=u.code[F];switch(w.kind){case an.Numeral:I=I*10+w.ordinal;break;case ve.PictureSingle.Zero:if(F===0)throw new _n((0,qn.notImplemented)(["leading zero in denominator"]));I=I*10;break;default:return(0,fa.assertFalse)("calc.numfmt.NumberFormatImpl: buildFractCode denomCode")}}if(I>32767)throw new _n((0,qn.notImplemented)(["overflow in denominator not emulated"]));S=[{kind:ve.PictureSingle.Hash,count:1}],y=1,C=void 0,E=l.fromNumber(I)}return[{kind:401,numIntDigLeft:p,numPercent:v,numThousands:h,numNumerDig:a.numDigLeft,numDenomDig:y,commaInt:f,codeInt:m,codeBetween1:this.flattenSuns(n),codeNumer:a.code,codeBetween2:this.flattenSuns(o),codeDenom:S,denomValue:E,lastDigInt:r!==void 0?r.lastDig:void 0,firstDigNumer:a.firstDig,firstDigDenom:C,anyZeroNumer:a.anyZero,anyQuestionNumer:a.anyQuestion}]},e.prototype.mergeNumSuns=function(r,n,a){for(var o=[],u=[],t,d=n;d<r.length&&d<a;d+=1){var s=r[d];t!==void 0?s.kind===0?(t.decimal?t.numDigDec+=s.numDigLeft+s.numDigDec:(t.numDigLeft+=s.numDigLeft,t.numDigDec+=s.numDigDec),t.comma=t.comma||s.comma,t.decimal=t.decimal||s.decimal,t.numVal=t.numVal||s.numVal,t.nonZero=t.nonZero||s.nonZero,s.lastDig!==void 0&&(t.lastDig=s.lastDig),t.firstDig===void 0&&(t.firstDig=s.firstDig),t.anyHash=t.anyHash||s.anyHash,t.anyQuestion=t.anyQuestion||s.anyQuestion,t.anyZero=t.anyZero||s.anyZero,(0,Pu.safePush)(t.code,this.flattenSuns(u)),u.length=0,(0,Pu.safePush)(t.code,s.code)):u.push(s):s.kind===0?t=s:o.push(s)}return[o,t,u]},e.prototype.bumpDigitsForComma=function(r){if(!r.comma||this.anyLegalCommaPosition(r))return r;for(var n=r.numDigLeft%3,a=(n===0?r.numDigLeft===0?3:r.numDigLeft:r.numDigLeft+3-n)+1,o=0;o<r.code.length;o+=1){var u=r.code[o];switch(u.kind){case ve.PictureSingle.Hash:{var t=r.code.slice();return t[o]=BP.__assign(BP.__assign({},u),{count:u.count+(a-r.numDigLeft)}),{code:t,comma:!0,numDigLeft:a}}case ve.PictureSingle.Zero:case ve.PictureSingle.Question:case ve.PictureSingle.Decimal:{var t=r.code.slice();return t.splice(o,0,{kind:ve.PictureSingle.Hash,count:a-r.numDigLeft}),{code:t,comma:!0,numDigLeft:a}}}}throw new _n((0,qn.notImplemented)(["comma with pure number literal"]))},e.prototype.anyLegalCommaPosition=function(r){if(r.numDigLeft<4)return!1;for(var n=function(s){var c=s==null?void 0:s.kind;return c===ve.PictureSingle.Hash||c===ve.PictureSingle.Zero||c===ve.PictureSingle.Question},a=r.numDigLeft,o=0;o<r.code.length;o+=1){var u=r.code[o];if(u.kind===ve.PictureSingle.Decimal)return!1;if(n(u)){for(var t=0;t<u.count;t+=1)if(a-=1,a>0&&a%3===0&&(t+1<u.count||n(r.code[o+1])))return!0}}return!1},e.prototype.parseCurrCode=function(r){var n=this.config.localeInfo,a,o,u;{var t=r.indexOf(OU);if(r.length!==0&&t!==0){if(a=t<0?r:r.substring(0,t),a.length>61)throw new _n(this.notFormatString("currencySymbol too long"));for(var d=0,s=(0,sp.codePointIterator)(a);d<s.length;d++){var c=s[d];if(n.isNumeral(c)&&n.getNumberShape(c)!==Pn.NumberShape.ASCII)throw new _n((0,qn.notImplemented)(["non-ASCII digits in currencySymbol"]))}}t>=0&&(u=r.substring(t+OU.length))}if(u!==void 0&&(o=this.parseFormatCulture(u),o===void 0))throw new _n((0,qn.notImplemented)(["unhandled CurrCode: "+(0,U3.anonymizeFormulaString)(r)]));if((0,vr.isSystemCultureTag)(o==null?void 0:o.tag)){if(a!==void 0)throw new _n(this.notFormatString("currencySymbol with sysdate/systime"));if(this.source===vr.NumberFormatSource.System)throw new _n(this.notFormatString("system format referenced circularly within system format"))}return{currencySymbol:a,currCode:o}},e.prototype.parseFormatCulture=function(r){var n,a,o={culture:"",numberShape:void 0,nationalNumberInput:!1,calendar:void 0,localCalendarInput:!1,tag:void 0},u=r.match(nvr);if(u!=null){o.culture=(n=u[1])!==null&&n!==void 0?n:"";var t=(a=u[2])!==null&&a!==void 0?a:u[3];if(t!=null){if(o.tag=tvr[t.toLowerCase()],o.tag===void 0)throw new _n((0,qn.notImplemented)(["unknown CurrCode tag: "+(0,U3.anonymizeFormulaString)(r)]));switch(o.tag){case vr.CultureTag.SysDate:case vr.CultureTag.SysTime:case vr.CultureTag.Euro1:case vr.CultureTag.Euro2:case vr.CultureTag.Bitcoin1:case vr.CultureTag.Bitcoin2:if(o.culture!=="")throw new _n(this.notFormatString("CultureTag ".concat(String(o.tag)," cannot have culture")));break;case vr.CultureTag.GenLower:case vr.CultureTag.GenUpper:case vr.CultureTag.NomLower:case vr.CultureTag.Gannen:if(o.culture==="")throw new _n(this.notFormatString("CultureTag ".concat(String(o.tag)," must have culture")));break}}var d=u[4];if(d!=null){var s=Kye(d),c=(s&32512)>>8;if(c!==0&&(o.numberShape=Uye[c],o.numberShape===void 0))throw new _n((0,qn.notImplemented)(["unknown number shape ".concat(c," in culture: ").concat((0,U3.anonymizeFormulaString)(r))]));o.nationalNumberInput=(s&32768)!==0;var l=s&127;if(l!==0&&(o.calendar=Gye[l],o.calendar===void 0))throw new _n((0,qn.notImplemented)(["unknown calendar ".concat(l," in culture: ").concat((0,U3.anonymizeFormulaString)(r))]));o.localCalendarInput=(s&128)!==0}return o}if(rvr.test(r)){var f=Kye(r);switch(f){case ve.LCID.SystemLongDate:o.tag=vr.CultureTag.SysDate;break;case ve.LCID.SystemTime:o.tag=vr.CultureTag.SysTime;break;case ve.LCID.EuroTrailing:o.tag=vr.CultureTag.Euro1;break;case ve.LCID.EuroLeading:o.tag=vr.CultureTag.Euro2;break;default:(f&64512)===64512&&(o.tag=vr.CultureTag.GenLower),(f&64512)===63488&&(o.tag=vr.CultureTag.GenUpper),(f&64512)===62464&&(o.tag=vr.CultureTag.NomLower),o.tag!==void 0&&(f&=-63489),o.culture=(0,wye.convertKnownLCID)(f);break}return o}},e.prototype.determineValueType=function(){for(var r=this.config.localeInfo,n={accountFill:!1,fvt:void 0},a=0,o=this.parts;a<o.length;a++){var u=o[a];n.accountFill=!1;var t=this.determineValueTypeCodes(n,u.code);if(t!==void 0)return t;if(n.accountFill&&(n.fvt===vr.FormatValueType.Number||n.fvt===vr.FormatValueType.Currency))return vr.FormatValueType.Accounting;if(n.fvt!==void 0)return n.fvt}return n.fvt!==void 0?n.fvt:this.formatString===Ft(r.pictureSpecial,ve.PictureSpecial.General)?vr.FormatValueType.General:vr.FormatValueType.Custom},e.prototype.determineValueTypeCodes=function(r,n){for(var a=this.config.localeInfo,o=0;o<n.length;o+=1){var u=n[o];switch(u.kind){case an.General:break;case ve.PictureSingle.Text:return vr.FormatValueType.Text;case ve.PictureSingle.Star:r.accountFill=!0;break;case 400:case an.Exp:case ve.PictureSingle.Slash:case an.StrLit:case ve.PictureSingle.Percent:case ve.PictureSingle.Underscore:case an.Numeral:case 405:case 406:break;case an.Currency:r.fvt=vr.FormatValueType.Currency;break;case an.CurrCode:u.currencySymbol!==void 0&&(r.fvt=vr.FormatValueType.Currency);break;case 403:{r.fvt=u.numPercent===1&&u.numThousands===0?vr.FormatValueType.Percentage:vr.FormatValueType.Number;var t=u.codeBefore,d=0;if(a.isEastAsia){if(d<t.length&&kU(t[d])==="("&&(d+=1),d<t.length&&kU(t[d])==="US$")return vr.FormatValueType.Currency;if(a.isChinaT){if(d<t.length&&kU(t[d])==="NT$")return vr.FormatValueType.Currency}else if(d<t.length&&kU(t[d])==="$")return vr.FormatValueType.Currency}var s=void 0;if((s=this.determineValueTypeCodes(r,u.codeBefore.slice(d)))!==void 0||(s=this.determineValueTypeCodes(r,u.code))!==void 0)return s;break}case 402:{r.fvt=vr.FormatValueType.Scientific;var s=void 0;if((s=this.determineValueTypeCodes(r,u.codeMant))!==void 0||(s=this.determineValueTypeCodes(r,u.codeBetween))!==void 0||(s=this.determineValueTypeCodes(r,u.codeExp))!==void 0)return s;break}case 401:{r.fvt=vr.FormatValueType.Fraction;var s=void 0;if(u.codeInt!==void 0&&(s=this.determineValueTypeCodes(r,u.codeInt))!==void 0||(s=this.determineValueTypeCodes(r,u.codeBetween1))!==void 0||(s=this.determineValueTypeCodes(r,u.codeNumer))!==void 0||(s=this.determineValueTypeCodes(r,u.codeBetween2))!==void 0||(s=this.determineValueTypeCodes(r,u.codeDenom))!==void 0)return s;break}case ve.PictureSingle.Decimal:case ve.PictureSingle.Hash:case ve.PictureSingle.Zero:case ve.PictureSingle.Question:break;case an.PrefixDigTh:case an.LatinDate:case an.BidiDate:break;case ve.PictureSingle.HourTh:case ve.PictureSingle.MinuteTh:case ve.PictureSingle.SecondTh:case ve.PictureSingle.Hour:case ve.PictureSingle.Minute:case ve.PictureSingle.Second:case 404:return vr.FormatValueType.Time;case an.AMPM:case an.AMPMFE:break;case ve.PictureSingle.Era:case ve.PictureSingle.EraYear:case ve.PictureSingle.YearTh:case ve.PictureSingle.EngYearTh:case ve.PictureSingle.ThYear:case ve.PictureSingle.MonthTh:case ve.PictureSingle.DayTh:case ve.PictureSingle.Year:case ve.PictureSingle.Month:case ve.PictureSingle.Day:case ve.PictureSingle.LocDay:return vr.FormatValueType.Date;case 407:return this.determineValueTypeCodes(r,u.codeThisFormat);default:return(0,fa.assertNever)("calc.numfmt.NumberFormatImpl: determineValueTypeCodes code",u)}}},e.prototype.determineDecimals=function(){for(var r=this.parts[0],n=0,a=r.code;n<a.length;n++){var o=a[n];switch(o.kind){case 403:return o.numDigDec;case 402:return o.numMantDigDec}}return 0},e.prototype.determineBidiDate=function(){var r=Ft(this.config.localeInfo.pictureSingle,ve.PictureSingle.BidiDate);if((0,Hs.stringStartsWith)(this.formatString,r+"1"))return vr.BidiDate.English;if((0,Hs.stringStartsWith)(this.formatString,r+"2"))return vr.BidiDate.Lunar},e.prototype.printFormatString=function(){var r=this.config.localeInfo,n=this.parts,a=n[0],o=n[1],u=n[2],t=n[3],d=!(Wye(t)||t===a),s=this.posBeforeText||!d,c="";return s&&(c+=this.printPart(a,this.condPos),o!==a&&(c+=Ft(r.pictureSingle,ve.PictureSingle.Sep),c+=this.printPart(o,this.condNeg),u!==a&&(c+=Ft(r.pictureSingle,ve.PictureSingle.Sep),c+=this.printPart(u,void 0)))),d&&(s&&(c+=Ft(r.pictureSingle,ve.PictureSingle.Sep)),c+=this.printPart(t,void 0)),c},e.prototype.printPart=function(r,n){var a=this.config,o=a.mathpack,u=a.localeInfo,t="";if(r.color!==void 0&&(t+=Ft(u.pictureSingle,ve.PictureSingle.ColorStart)+(typeof r.color=="number"?Ft(u.pictureColor,ve.PictureColor.Color)+String(r.color-8):Ft(u.pictureColor,Qgr(r.color)))+Ft(u.pictureSingle,ve.PictureSingle.ColorEnd)),n!==void 0){var d=21;t+=Ft(u.pictureSingle,ve.PictureSingle.ColorStart)+Ft(yZ,Xgr[n.operator])+o.formatGeneral(u,n.operand,d)+Ft(u.pictureSingle,ve.PictureSingle.ColorEnd)}return r.dbnum!==void 0&&(t+=Ft(u.pictureSingle,ve.PictureSingle.ColorStart)+Ft(u.pictureDbnum,Ygr(r.dbnum))+Ft(u.pictureSingle,ve.PictureSingle.ColorEnd)),t+=this.printCodes({seenDig:!1,wasPrevDig:!1},r.code,void 0),t},e.prototype.printCodes=function(r,n,a){var o=this.config,u=o.mathpack,t=o.localeInfo,d="",s;if(a!==void 0&&a.numThousands>0){for(var c=0;c<n.length;c+=1){var l=n[c].kind;(l===ve.PictureSingle.Zero||l===ve.PictureSingle.Hash||l===ve.PictureSingle.Question||l===ve.PictureSingle.Decimal||l===an.Numeral)&&(s=c)}(0,fa.assertTrue)("calc.numfmt.NumberFormatImpl: printCodes thousandsAfter",s!==void 0)}for(var f=function(S){return S===ve.PictureSingle.Hash||S===ve.PictureSingle.Zero||S===ve.PictureSingle.Question},p=function(S){var y=n[S],C=r.wasPrevDig;switch(r.wasPrevDig=!1,y.kind){case an.General:d+=Ft(t.pictureSpecial,ve.PictureSpecial.General);break;case ve.PictureSingle.Decimal:a!==void 0&&(a.decimal=!0),r.wasPrevDig=!0,d+=Ft(t.pictureSingle,ve.PictureSingle.Decimal);break;case ve.PictureSingle.Hash:case ve.PictureSingle.Zero:case ve.PictureSingle.Question:{r.seenDig=!0,r.wasPrevDig=!0;var E=y.kind===ve.PictureSingle.Zero?"0":Ft(t.pictureSingle,y.kind),I=(0,Hs.repeat)(E,y.count);if(a===void 0||a.decimal){d+=I;break}if(a.comma){var F=a.numDigLeft-y.count;d+=(0,gg.insertCommas)({isThousandsPosition:function(T){var g;return T>0&&T%3===0&&(T>F||f((g=n[S+1])===null||g===void 0?void 0:g.kind))},thousandsSeparator:Ft(t.pictureSingle,ve.PictureSingle.Comma)},I,F)}else d+=I;a.numDigLeft-=y.count;break}case an.Numeral:r.wasPrevDig=!0,d+=y.formattedStr;break;case 402:d+=m.printCodes(r,y.codeMant,{comma:y.commaMant,numThousands:0,decimal:!1,numDigLeft:y.numMantDigLeft})+m.printCodes(r,y.codeBetween,void 0)+m.printCodes(r,y.codeExp,{comma:!1,numThousands:0,decimal:!1,numDigLeft:y.numExpDigLeft});break;case 403:d+=m.printCodes(r,y.codeBefore,void 0)+m.printCodes(r,y.code,{comma:y.comma,numThousands:y.numThousands,decimal:!1,numDigLeft:y.numDigLeft});break;case 401:{var w=y.codeInt===void 0?"":m.printCodes(r,y.codeInt,{comma:y.commaInt,numThousands:0,decimal:!1,numDigLeft:y.numIntDigLeft}),B=m.printCodes(r,y.codeBetween1,void 0),k=m.printCodes(r,y.codeNumer,{comma:!1,numThousands:0,decimal:!1,numDigLeft:y.numNumerDig}),x=m.printCodes(r,y.codeBetween2,void 0),G=m.printCodes(r,y.codeDenom,{comma:!1,numThousands:y.numThousands,decimal:!1,numDigLeft:y.numDenomDig});d+=w+B+k+x+(y.denomValue!==void 0?tO(u,y.denomValue):G);break}case 400:{var H=Ft(t.pictureSingle,ve.PictureSingle.Backslash),L=Bye(t,t.pictureSingle,y.formattedStr,0),D=Zgr(t,t.pictureSpecial,y.formattedStr,0);if(L!==void 0&&L!==ve.PictureSingle.Extra&&L!==ve.PictureSingle.Zero)switch(L){case ve.PictureSingle.Comma:var U=n[S+1];if(C){var V=Ft(t.pictureSingle,ve.PictureSingle.Space);if(y.formattedStr!==V||U===void 0||!(!t.isCurrencySymbolLead&&t.isCurrencySepBySpace&&U.kind===an.Currency)&&!(t.isPercentSepBySpace&&U.kind===ve.PictureSingle.Percent)){d+=H;break}}if((U==null?void 0:U.kind)===400&&(U==null?void 0:U.formattedStr)===y.formattedStr){d+=H;break}break;case ve.PictureSingle.Decimal:d+=H;break;case ve.PictureSingle.Slash:r.seenDig&&(d+=H);break;case ve.PictureSingle.Space:case ve.PictureSingle.Minus:case ve.PictureSingle.Plus:case ve.PictureSingle.OpenParen:case ve.PictureSingle.CloseParen:break;case ve.PictureSingle.DateSep:Ft(t.pictureSingle,ve.PictureSingle.DateSep)!==Ft(t.pictureSingle,ve.PictureSingle.Minus)&&(d+=H);break;default:d+=H;break}else(D||t.isNumeral((0,sp.stringCodePointAt)(y.formattedStr,0)))&&(d+=H);d+=y.formattedStr;break}case an.Exp:d+=y.formattedStr+(y.isNeg?"-":"+");break;case an.StrLit:{var H=Ft(t.pictureSingle,ve.PictureSingle.Quote);(0,fa.assertTrue)("calc.numfmt.NumberFormatImpl: printCodes StrLit",y.escaped.indexOf(H)<0),d+=H+y.escaped+H;break}case ve.PictureSingle.Slash:d+=Ft(t.pictureSingle,ve.PictureSingle.Slash);break;case ve.PictureSingle.Percent:d+=Ft(t.pictureSingle,ve.PictureSingle.Percent);break;case ve.PictureSingle.Star:d+=Ft(t.pictureSingle,ve.PictureSingle.Star)+y.escaped;break;case ve.PictureSingle.Underscore:d+=Ft(t.pictureSingle,ve.PictureSingle.Underscore)+y.escaped;break;case an.PrefixDigTh:d+="t";break;case an.Currency:d+=Ft(t.pictureSpecial,ve.PictureSpecial.Currency);break;case an.CurrCode:if(d+=Ft(t.pictureSingle,ve.PictureSingle.ColorStart),d+=CZ,y.currencySymbol!==void 0&&(d+=y.currencySymbol),y.currCode!==void 0){var ne=y.currCode,J=ne.culture,$=ne.numberShape,Z=ne.nationalNumberInput,ie=ne.calendar,X=ne.localCalendarInput,Q=ne.tag;switch(d+=OU,typeof J){case"number":{var b=J;switch((0,fa.assertTrue)("calc.numfmt.NumberFormatImpl: printCodes lcid",$===void 0&&!Z&&ie===void 0&&!X),Q){case void 0:break;case vr.CultureTag.GenLower:b|=64512;break;case vr.CultureTag.GenUpper:b|=63488;break;case vr.CultureTag.NomLower:b|=62464;break;default:(0,fa.assertFalse)("calc.numfmt.NumberFormatImpl: printCodes lcid2")}var R=_Z(b);/^[a-f]{1,7}$/i.test(R)&&(R="0"+R),d+=R;break}case"string":{d+=J,Q!==void 0&&(J!==""&&(d+=OU),d+=evr,d+=String(Q));var P=0;$!==void 0&&(P|=Uye.indexOf($)<<8),Z&&(P|=32768),ie!==void 0&&(P|=Gye.indexOf(ie)),X&&(P|=128),P!==0&&(d+=$gr,d+=_Z(P));break}}}d+=Ft(t.pictureSingle,ve.PictureSingle.ColorEnd);break;case ve.PictureSingle.Text:d+=Ft(t.pictureSingle,ve.PictureSingle.Text);break;case an.LatinDate:d+=Ft(t.pictureSingle,ve.PictureSingle.BidiDate)+"1";break;case an.BidiDate:d+=Ft(t.pictureSingle,ve.PictureSingle.BidiDate)+"2";break;case 404:d+=Ft(t.pictureSingle,ve.PictureSingle.Decimal)+(0,Hs.repeat)("0",y.rounding);break;case 405:d+=Ft(t.pictureSingle,ve.PictureSingle.DateSep);break;case 406:d+=Ft(t.pictureSingle,ve.PictureSingle.Colon);break;case ve.PictureSingle.Era:case ve.PictureSingle.EraYear:case ve.PictureSingle.Year:case ve.PictureSingle.YearTh:case ve.PictureSingle.EngYearTh:case ve.PictureSingle.ThYear:case ve.PictureSingle.Month:case ve.PictureSingle.MonthTh:case ve.PictureSingle.Day:case ve.PictureSingle.DayTh:case ve.PictureSingle.LocDay:d+=(0,Hs.repeat)(Ft(t.pictureSingle,y.kind),y.count);break;case ve.PictureSingle.Hour:case ve.PictureSingle.HourTh:case ve.PictureSingle.Minute:case ve.PictureSingle.MinuteTh:case ve.PictureSingle.Second:case ve.PictureSingle.SecondTh:if(y.isAbs){d+=Ft(t.pictureSingle,ve.PictureSingle.ColorStart)+(0,Hs.repeat)(Ft(t.pictureSingle,y.kind),y.count)+Ft(t.pictureSingle,ve.PictureSingle.ColorEnd);break}d+=(0,Hs.repeat)(Ft(t.pictureSingle,y.kind),y.count);break;case an.AMPM:case an.AMPMFE:y.kind===an.AMPMFE||t.isEastAsia||y.pictureKind===ve.PictureSpecial.AP2?d+=y.tokenStr:d+=Ft(t.pictureSpecial,y.pictureKind);break;case 407:d+=m.printCodes(r,y.codeThisFormat,void 0);break;default:return{value:(0,fa.assertNever)("calc.numfmt.NumberFormatImpl: printCodes code",y)}}S===s&&(d+=(0,Hs.repeat)(Ft(t.pictureSingle,ve.PictureSingle.Comma),a.numThousands))},m=this,c=0;c<n.length;c+=1){var v=p(c);if(typeof v=="object")return v.value}return d},e.prototype.countBytecodeBuffer=function(r){for(var n,a,o=this.config,u=o.mathpack,t=o.localeInfo,d=0,s=0;s<r.length;s+=1){var c=r[s],l=FU;switch(c.kind){case ve.PictureSingle.Percent:case an.Numeral:case 400:case ve.PictureSingle.Star:case ve.PictureSingle.Underscore:l+=V3;break;case an.StrLit:l+=1+V3*c.escaped.length;break;case 404:case ve.PictureSingle.Hash:case ve.PictureSingle.Zero:case ve.PictureSingle.Question:case an.Exp:l+=1;break;case ve.PictureSingle.Hour:case ve.PictureSingle.HourTh:case ve.PictureSingle.Minute:case ve.PictureSingle.MinuteTh:case ve.PictureSingle.Second:case ve.PictureSingle.SecondTh:c.isAbs&&(l+=1);break;case 401:if(l+=5,c.codeInt!==void 0&&(l+=this.countBytecodeBuffer(c.codeInt)),l+=this.countBytecodeBuffer(c.codeBetween1),l+=this.countBytecodeBuffer(c.codeNumer),l+=this.countBytecodeBuffer(c.codeBetween2),l+=this.countBytecodeBuffer(c.codeDenom),c.denomValue!==void 0){l-=2;var f=tO(u,c.denomValue).length;l+=2+V3*f}c.commaInt&&(l+=FU);break;case 402:l+=3,l+=this.countBytecodeBuffer(c.codeMant),l+=this.countBytecodeBuffer(c.codeBetween),l+=this.countBytecodeBuffer(c.codeExp),c.commaMant&&(l+=FU);break;case 403:l+=3,l+=this.countBytecodeBuffer(c.codeBefore),l+=this.countBytecodeBuffer(c.code),c.comma&&(l+=FU);break;case 407:l=0,l+=this.countBytecodeBuffer(c.codeThisFormat);break;case an.CurrCode:l+=V3*(((a=(n=c.currencySymbol)===null||n===void 0?void 0:n.length)!==null&&a!==void 0?a:0)+1),l+=8;break;case an.AMPM:{var p=t.isEastAsia||c.pictureKind===ve.PictureSpecial.AP2?qye(t,c.tokenStr):t.ampmSymbols;l+=2+V3*(p[0].length+p[1].length)}break;case an.AMPMFE:break;case an.General:case ve.PictureSingle.Decimal:case ve.PictureSingle.Slash:case an.PrefixDigTh:case an.Currency:case ve.PictureSingle.Text:case an.LatinDate:case an.BidiDate:case 405:case 406:case ve.PictureSingle.Era:case ve.PictureSingle.EraYear:case ve.PictureSingle.Year:case ve.PictureSingle.YearTh:case ve.PictureSingle.EngYearTh:case ve.PictureSingle.ThYear:case ve.PictureSingle.Month:case ve.PictureSingle.MonthTh:case ve.PictureSingle.Day:case ve.PictureSingle.DayTh:case ve.PictureSingle.LocDay:break;default:return(0,fa.assertNever)("calc.numfmt.NumberFormatImpl: printCodes code",c)}d+=l}return d},e.prototype.countBytecodePart=function(r){var n=r.code,a=r.color,o=r.dbnum,u=r.dtrRounding,t=0;return a!==void 0&&(t+=2),o!==void 0&&(t+=2),u!==0&&(t+=2),t+=this.countBytecodeBuffer(n),t},e.prototype.countBytecode=function(){for(var r=0,n=0;n<=3;n+=1){(n===0&&this.condPos!==void 0||n===1&&this.condNeg!==void 0)&&(r+=10);for(var a=this.parts[n],o=!1,u=0;u<n;u+=1)if(this.parts[u]===a){o=!0;break}o||(r+=this.countBytecodePart(a))}return r},e.prototype.checkBytecode=function(){if(this.countBytecode()>fvr)throw new _n(this.notFormatString("format string too long: bytecode limit"));if(this.countBytecode()>247)throw new _n((0,qn.notImplemented)(["format string too long: close to bytecode limit"]))},e.prototype.getBundledLocaleInfo=function(r,n,a){var o=a;switch(n){case Pn.Calendar.GregorianUS:o=avr;break;case Pn.Calendar.GregorianMEFrench:o=ivr;break;case Pn.Calendar.GregorianArabic:o=ovr;break;case Pn.Calendar.GregorianXlitEnglish:o=uvr;break;case Pn.Calendar.GregorianXlitFrench:o=svr;break;case Pn.Calendar.UmAlQura:case Pn.Calendar.Hijri:break;case Pn.Calendar.Thai:o=RZ;break}if((o==null?void 0:o.culture)!==void 0&&o.culture!==""){var u=(0,wye.getBundledLocaleInfo)(o);if(u===void 0)throw new ic(this.notImplementedCulture(r,o.culture));return u}return this.config.localeInfo},e.prototype.notFormatString=function(r){return(0,vr.notFormatString)("".concat(r," (source=").concat(String(this.source),"): ").concat(this.logFormatString))},e.prototype.notImplementedCulture=function(r,n){var a=typeof n=="number"?"lcid:".concat(_Z(n)):"lang:".concat(n);return(0,qn.notImplemented)(["".concat(r,": culture = ").concat(a)])},e}();w1.NumberFormatImpl=zye;function mvr(e,r,n){try{return(0,gl.success)(new zye(e.config,{old:void 0,formatString:r,source:n}))}catch(a){return a instanceof _n?(0,gl.failure)(a.reason):(0,gl.failure)((0,gl.javaScriptError)(a))}}w1.createFormat=mvr;function gvr(e){if(e.length===0)return!1;var r=(0,sp.stringCodePointAt)(e,0);return r>=1424&&r<=1535||r===8207||r>=64285&&r<=64335||r>=1536&&r<=1791||r>=1872&&r<=1919||r>=2208&&r<=2303||r>=64336&&r<=65023||r>=65136&&r<=65279}function vvr(e,r,n,a){try{var o=void 0,u=void 0,t=void 0,d=e.config.localeInfo;switch(n.kind){case qP.OperKind.String:o=gvr(n.value)?vr.Alignment.Right:vr.Alignment.Left,u=vr.Clip.None,t=n;break;case qP.OperKind.Number:o=r.isTextOnly?vr.Alignment.Left:vr.Alignment.Right,u=vr.Clip.All,t=n;break;case qP.OperKind.Boolean:o=vr.Alignment.Center,u=vr.Clip.All,t=(0,Ngr.stringOper)(n.value?d.trueName:d.falseName);break;case qP.OperKind.Blank:return(0,gl.success)((0,vr.formattedValue)([],void 0,vr.Alignment.Left,vr.Clip.All));case qP.OperKind.Error:var s=d.errorNames[n.type];return s==null?(0,gl.failure)((0,qn.internal)("No locale data for error type ".concat(n.type))):(0,gl.success)((0,vr.formattedValue)([(0,vr.formattedUnitString)(s)],void 0,vr.Alignment.Center,vr.Clip.All));case qP.OperKind.Array:return(0,gl.failure)((0,qn.notImplemented)(["Array applyFormat"]));case qP.OperKind.Rich:return(0,gl.failure)((0,qn.notImplemented)(["Rich applyFormat"]))}return r.apply(t,o,u,a)}catch(c){return(0,gl.failure)((0,gl.javaScriptError)(c))}}w1.applyFormat=vvr;function hvr(e,r){try{switch(e.valueType){case vr.FormatValueType.General:return(0,gl.failure)((0,qn.notImplemented)(["changeDecimals General"]));case vr.FormatValueType.Number:case vr.FormatValueType.Currency:case vr.FormatValueType.Accounting:case vr.FormatValueType.Percentage:case vr.FormatValueType.Scientific:if(e.decimals===0&&r<0)return gl.successUndefined;var n=(0,Pu.fastMax)(0,e.decimals+r),a=e.synthesizeDecimals(n);return a.formatString===e.formatString?gl.successUndefined:(0,gl.success)(a);default:return gl.successUndefined}}catch(o){return(0,gl.failure)((0,gl.javaScriptError)(o))}}w1.changeFormatDecimals=hvr});var OZ=Y(mm=>{"use strict";_();Object.defineProperty(mm,"__esModule",{value:!0});mm.toXLNumber=mm.applyValueEdit=mm.getValueEditOperKind=mm.renderFormat=mm.getFormatString=mm.initUtilGlobals=void 0;var Svr=tS(),qR=E1(),yvr=A1(),xC=_v(),NZ=O1(),Cvr=yU(),_vr=H2(),AZ={getKnownFormat:function(){return(0,NZ.assertFalse)("calc.numfmt: default getKnownFormat")},getIformat:function(){return(0,NZ.assertFalse)("calc.numfmt: default getIformat")},getFormatString:function(){return(0,NZ.assertFalse)("calc.numfmt: default getFormatString")}};function Rvr(e){var r,n,a,o,u,t;return{config:e.config,getKnownFormat:(n=(r=e.getKnownFormat)===null||r===void 0?void 0:r.bind(e))!==null&&n!==void 0?n:AZ.getKnownFormat,getIformat:(o=(a=e.getIformat)===null||a===void 0?void 0:a.bind(e))!==null&&o!==void 0?o:AZ.getIformat,getFormatString:(t=(u=e.getFormatString)===null||u===void 0?void 0:u.bind(e))!==null&&t!==void 0?t:AZ.getFormatString}}mm.initUtilGlobals=Rvr;function Tvr(e,r,n,a,o){var u=r.getFormatString(n,a);return(0,xC.isSuccess)(u)?u.value!==void 0?r.getIformat(n,u.value):e.createFormat(a,o):u}mm.getFormatString=Tvr;function bvr(e,r,n){var a=(0,Svr.isStringOper)(n)?qR.Clip.None:qR.Clip.All,o=r.apply(n,qR.Alignment.Right,a,!0);if(!(0,xC.isSuccess)(o))return o;var u=e.renderValue(o.value,qR.renderInfiniteWidth);return(0,xC.isSuccess)(u)?(0,qR.isHashesValue)(u.value)?(0,xC.success)(u.value.units):(0,xC.success)((0,qR.renderedValueToString)(u.value)):u}mm.renderFormat=bvr;function Pvr(e){return e.value.kind}mm.getValueEditOperKind=Pvr;function Evr(e,r,n,a){var o=n;if(a.kind===qR.EditKind.Number&&a.format!==yvr.KnownFormat.General){var u=a.format,t=typeof u=="string"?u:(0,_vr.getKnownFormat)(r,u),d=typeof u!="string",s=e.createFormat(t,d);if(!(0,xC.isSuccess)(s))return s;var c=s.value;(0,Cvr.shouldInstallFormat)(c,n)&&(o=c)}return e.applyFormat(o,a.value,!0)}mm.applyValueEdit=Evr;function Nvr(e,r,n){var a=r.parseGeneral(n,!1,!0,qR.GetTimeKind.NonVolatile);return(0,xC.isSuccess)(a)?a.value==null?(0,xC.failure)(null):(0,xC.success)(e.toNumber(a.value.value)):a}mm.toXLNumber=Nvr});var kZ=Y(MU=>{"use strict";_();Object.defineProperty(MU,"__esModule",{value:!0});MU.renderFormulaBar=void 0;var Avr=E1(),aO=tS(),Ovr=H2(),Jye=O1(),IU=OZ(),Yye=A1(),GP=CU(),Fc=_v();function kvr(e,r,n,a,o){var u=r.config,t=u.mathpack,d=u.localeInfo;if(t.cond(a)<0)return(0,Fc.success)(void 0);var s="",c=t.fix(a)!==0||o.isDate,l=a;if(c){var f=t.trunc(a),p=(0,IU.getFormatString)(e,r,n,(0,Ovr.buildMMDDYYFormat)(d,!0),Avr.NumberFormatSource.CustomString);if(!(0,Fc.isSuccess)(p))return p;var m=(0,IU.renderFormat)(e,p.value,f);if(!(0,Fc.isSuccess)(m))return m;if(typeof m.value!="string")return(0,Fc.success)(void 0);s+=m.value;var v=t.sub(a,f);(0,Jye.assertTrue)("calc.numfmt.renderFormulaBar: sub error",!(0,aO.isErrorOper)(v)),l=v}if(t.cond(l)>0||o.isTime){c&&(s+="  ");var h=r.getKnownFormat(n,d.clock24Hour?Yye.KnownFormat.HHMMSS:Yye.KnownFormat.HHMMSSAP);if(!(0,Fc.isSuccess)(h))return h;var m=(0,IU.renderFormat)(e,h.value,l);if(!(0,Fc.isSuccess)(m))return m;if(typeof m.value!="string")return(0,Fc.success)(void 0);s+=m.value}return(0,Fc.success)(s)}function Fvr(e,r,n,a,o){if(o.isDate||o.isTime){var u=kvr(e,(0,IU.initUtilGlobals)(r),n,a,o);if(!(0,Fc.isSuccess)(u))return u;if(u.value!==void 0){var t=u.value;return u}}var d=21,s=r.config,c=s.mathpack,l=s.localeInfo;if(o.isPercent){var f=c.mul(a,c.fromNumber(100));return(0,aO.isErrorOper)(f)?(0,Fc.failure)((0,aO.notImplemented)(["renderFormulaBar % overflow"])):(0,Fc.success)(c.formatGeneral(l,f,d)+"%")}return(0,Fc.success)(c.formatGeneral(l,a,d))}function Ivr(e,r,n,a,o,u){try{var t=r.config.localeInfo;switch(a.kind){case GP.OperKind.Number:return Fvr(e,r,n,a,o);case GP.OperKind.String:return(0,Fc.success)(u?"'"+a.value:a.value);case GP.OperKind.Boolean:return(0,Fc.success)(a.value?t.trueName:t.falseName);case GP.OperKind.Error:var d=t.errorNames[a.type];return d==null?(0,Fc.failure)((0,aO.internal)("No locale data for error type ".concat(a.type))):(0,Fc.success)(d);case GP.OperKind.Array:return(0,Fc.failure)((0,aO.notImplemented)(["Array renderFormulaBar"]));case GP.OperKind.Rich:return(0,Fc.failure)((0,aO.notImplemented)(["Rich renderFormulaBar"]));case GP.OperKind.Blank:return(0,Fc.success)("");default:return(0,Jye.assertNever)("calc.numfmt.renderFormulaBar: never value",a)}}catch(s){return(0,Fc.failure)((0,Fc.javaScriptError)(s))}}MU.renderFormulaBar=Ivr});var FZ=Y(iO=>{"use strict";_();Object.defineProperty(iO,"__esModule",{value:!0});iO.parseDate=iO.parseGeneral=void 0;var Mvr=cU(),wU=SU(),W3=_v();function wvr(e,r,n,a,o){try{var u=e.config,t=u.localeInfo,d=u.mathpack,s=(0,Mvr.parseConstInternal)(t,d,r,n,a,!1);return!(0,W3.isSuccess)(s)||s.value!==void 0?s:(0,wU.parseDateInternal)((0,wU.initParseDateGlobals)(e),r,void 0,o)}catch(c){return(0,W3.failure)((0,W3.javaScriptError)(c))}}iO.parseGeneral=wvr;function Dvr(e,r,n){try{return(0,wU.parseDateInternal)((0,wU.initParseDateGlobals)(e),r,void 0,n)}catch(a){return(0,W3.failure)((0,W3.javaScriptError)(a))}}iO.parseDate=Dvr});var eCe=Y(DU=>{"use strict";_();Object.defineProperty(DU,"__esModule",{value:!0});DU.createNumberFormatter=void 0;var Xye=E1(),IZ=EZ(),xvr=yU(),Zye=EU(),Lvr=sZ(),Bvr=kZ(),$ye=FZ();function qvr(e){return{createFormat:function(n,a){return(0,IZ.createFormat)(e,n,typeof a!="boolean"?a:a?Xye.NumberFormatSource.Builtin:Xye.NumberFormatSource.CustomString)},applyFormat:function(n,a,o){return(0,IZ.applyFormat)(e,n,a,o)},changeFormatDecimals:IZ.changeFormatDecimals,renderValue:function(n,a){return(0,Zye.renderValue)(e.config.mathpack,n,a)},renderHashesValue:function(n,a){return(0,Zye.renderHashesValue)(n,a)},renderFormulaBar:function(n,a,o,u){return(0,Bvr.renderFormulaBar)(this,e,n,a,o,u)},parseGeneral:function(n,a,o,u){return(0,$ye.parseGeneral)(e,n,a,o,u)},parseDate:function(n,a){return(0,$ye.parseDate)(e,n,a)},parseEdit:function(n,a){return(0,xvr.parseEdit)(e,n,a)},evalFormat:function(n,a){return(0,Lvr.evalFormat)(e,n,a)}}}DU.createNumberFormatter=qvr});var nCe=Y(KP=>{"use strict";_();Object.defineProperty(KP,"__esModule",{value:!0});KP.getRibbonFormat=KP.RibbonFormat=void 0;var rCe=br(),Ta=W2(),LC=A1(),oc=H2(),uc;(function(e){e.GalleryGeneral="GalleryGeneral",e.GalleryNumber="GalleryNumber",e.GalleryCurrency="GalleryCurrency",e.GalleryAccounting="GalleryAccounting",e.GalleryShortDate="GalleryShortDate",e.GalleryLongDate="GalleryLongDate",e.GalleryTime="GalleryTime",e.GalleryPercentage="GalleryPercentage",e.GalleryFraction="GalleryFraction",e.GalleryScientific="GalleryScientific",e.GalleryText="GalleryText",e.ButtonComma="ButtonComma",e.ButtonPercentage="ButtonPercentage",e.ButtonAccounting="ButtonAccounting",e.KeyboardGeneral="KeyboardGeneral",e.KeyboardNumber="KeyboardNumber",e.KeyboardCurrency="KeyboardCurrency",e.KeyboardDate="KeyboardDate",e.KeyboardTime="KeyboardTime",e.KeyboardPercentage="KeyboardPercentage",e.KeyboardScientific="KeyboardScientific"})(uc=KP.RibbonFormat||(KP.RibbonFormat={}));function xU(e,r){return(0,oc.buildSingle)(e,Ta.PictureSingle.ColorStart,"$-",r,Ta.PictureSingle.ColorEnd)}function Uvr(e,r,n){var a,o,u=((o=(a=n==null?void 0:n.culture)===null||a===void 0?void 0:a.calendar)!==null&&o!==void 0?o:LC.Calendar.Gregorian)===LC.Calendar.Gregorian;switch(r){case uc.GalleryGeneral:case uc.KeyboardGeneral:return(0,oc.getKnownFormat)(e,LC.KnownFormat.General);case uc.GalleryNumber:return(0,oc.buildNumberFormat)(e,!1,1,e.currencyDecimals);case uc.KeyboardNumber:return(0,oc.buildNumberFormat)(e,!0,4,e.currencyDecimals);case uc.GalleryCurrency:{var t=rCe.__assign(rCe.__assign({},e),{currencyFormat:e.currencyFormat===LC.CurrencyFormat.Paren?LC.CurrencyFormat.Lead:e.currencyFormat});return(0,oc.buildCurrencyFormat)(t,!1,e.currencyDecimals,!0,!1,void 0,!0)}case uc.KeyboardCurrency:return(0,oc.buildCurrencyFormat)(e,!0,e.currencyDecimals,!0,!1);case uc.GalleryAccounting:case uc.ButtonAccounting:return(0,oc.buildCurrencyFormat)(e,!1,e.currencyDecimals,!0,!0);case uc.GalleryShortDate:return u?(0,oc.getKnownFormat)(e,LC.KnownFormat.MMDDYY):(0,oc.buildSingle)(e,Ta.PictureSingle.Month,Ta.PictureSingle.DateSep,Ta.PictureSingle.Day,Ta.PictureSingle.Sep,Ta.PictureSingle.Text);case uc.GalleryLongDate:return u?xU(e,"x-sysdate")+(0,oc.buildSingle)(e,Ta.PictureSingle.Day,Ta.PictureSingle.Day,Ta.PictureSingle.Day,Ta.PictureSingle.Day,", ",Ta.PictureSingle.Month,Ta.PictureSingle.Month,Ta.PictureSingle.Month,Ta.PictureSingle.Month," ",Ta.PictureSingle.Day,Ta.PictureSingle.Day,", ",Ta.PictureSingle.Year,Ta.PictureSingle.Year,Ta.PictureSingle.Year,Ta.PictureSingle.Year):(0,oc.buildSingle)(e,Ta.PictureSingle.Month,Ta.PictureSingle.DateSep,Ta.PictureSingle.Day,Ta.PictureSingle.DateSep,Ta.PictureSingle.Year,Ta.PictureSingle.Year,Ta.PictureSingle.Sep,Ta.PictureSingle.Text);case uc.GalleryTime:return xU(e,"x-systime")+(0,oc.buildSingle)(e,Ta.PictureSingle.Hour,Ta.PictureSingle.Colon,Ta.PictureSingle.Minute,Ta.PictureSingle.Minute,Ta.PictureSingle.Colon,Ta.PictureSingle.Second,Ta.PictureSingle.Second," ")+(0,oc.getSpecial)(e,Ta.PictureSpecial.AP1);case uc.KeyboardDate:return xU(e,"en-US")+(0,oc.buildSingle)(e,Ta.PictureSingle.Day,"-",Ta.PictureSingle.Month,Ta.PictureSingle.Month,Ta.PictureSingle.Month,"-",Ta.PictureSingle.Year,Ta.PictureSingle.Year,Ta.PictureSingle.Sep,Ta.PictureSingle.Text);case uc.KeyboardTime:return xU(e,"en-US")+(0,oc.buildSingle)(e,Ta.PictureSingle.Hour,Ta.PictureSingle.Colon,Ta.PictureSingle.Minute,Ta.PictureSingle.Minute," ",(0,oc.getSpecial)(e,Ta.PictureSpecial.AP1),Ta.PictureSingle.Sep,Ta.PictureSingle.Text);case uc.GalleryPercentage:return(0,oc.buildPercentFormat)(e,e.currencyDecimals);case uc.ButtonPercentage:case uc.KeyboardPercentage:return(0,oc.getKnownFormat)(e,LC.KnownFormat.Pct0);case uc.GalleryFraction:return(0,oc.getKnownFormat)(e,LC.KnownFormat.Fract);case uc.GalleryScientific:case uc.KeyboardScientific:return(0,oc.buildScientificFormat)(e,1,e.currencyDecimals,2);case uc.GalleryText:return(0,oc.getKnownFormat)(e,LC.KnownFormat.Text);case uc.ButtonComma:return(0,oc.buildCurrencyFormat)(e,!1,e.currencyDecimals,!1,!0)}}KP.getRibbonFormat=Uvr});var tCe=Y(LU=>{"use strict";_();Object.defineProperty(LU,"__esModule",{value:!0});LU.commonFormats=void 0;LU.commonFormats=["#","##","###","########\\ \\ \\ \\ \\ \\ \\ \\ ","###,###","###\\ ###","###\\-##\\-####","##,###.##\\ \\ \\ ","#,###","#,###.#","#,###.##","#,###_)","#,###_)_ ","#.##","#.##%","#.#%","#;\\(\\ \\ @\\ \\ \\ \\)",'#"\\""\\""\\""\\"\\ ??/??',"#\\ ###",";;",";;;","@\\ ","\\ #######\\ \\ \\ \\ ","\\ \\ @","\\(###\\)\\ ###\\-####","\\(\\ ###\\ \\)\\ ###\\-####","\\:","__@","[$$]#,##0_);\\([$$]#,##0\\);[$$]#,##0_);@_)","[$$]#,##0.0_);\\([$$]#,##0.0\\);[$$]#,##0.0_);@_)","[$$-1009]#,##0.00","[$$-1009]#,##0;[Red]\\-[$$-1009]#,##0","[$$-409]#,##0","[$$-409]#,##0.00","[$$-409]#,##0.00_);\\([$$-409]#,##0.00\\)",'_([$$-409]* #,##0.00_);_([$$-409]* \\(#,##0.00\\);_([$$-409]* "-"??_);_(@_)',"[$$-409]#,##0.0000","[$$-409]#,##0.0000_);\\([$$-409]#,##0.0000\\)","[$$-409]#,##0.00_);[Red]\\([$$-409]#,##0.00\\)","[$$-409]#,##0;[Red][$$-409]#,##0","[$$-409]#,##0_);[Red]\\([$$-409]#,##0\\)","[$$-C09]#,##0.00","[$$-C09]#,##0.000","[$$-C09]#,##0.0000","[$$-C09]#,##0.00000","[$\xA3-809]#,##0","[$\xA3-809]#,##0.00","[$\xA3-809]#,##0.00;[Red]\\-[$\xA3-809]#,##0.00","[$\xA3-809]#,##0;[Red][$\xA3-809]#,##0","[$\xA5-411]#,##0","[$\u20AC-2]\\ #,##0.00","[$\u20AC-2]\\ #,##0.00_);[Red]\\([$\u20AC-2]\\ #,##0.00\\)","[$\u20AC-2]\\ #,##0_);[Red]\\([$\u20AC-2]\\ #,##0\\)",'"$"#,##0','"$"#,##0;\\("$"#,##0\\)','"$"#,##0;\\-"$"#,##0','"$"#,##0_);\\("$"#,##0\\)','"$"#,##0_);\\("$"#,##0\\);"-"??_)','"$"#,##0_);\\("$"#,##0\\);\\ \\-\\ ','"$"\\ #,##0;\\("$"\\ #,##0\\)',"\\$#,##0_);\\(\\$#,##0\\)",'_ "$"\\ * #,##0_ ;_ "$"\\ * \\-#,##0_ ;_ "$"\\ * "-"??_ ;_ @_ ','_ "$"\\ * #,##0_ ;_ "$"\\ * \\-#,##0_ ;_ "$"\\ * "-"_ ;_ @_ ','_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"??_);_(@_)','_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)','_("$"\\ * #,##0_);_("$"\\ * \\(#,##0\\);_("$"\\ * "-"_);_(@_)','_-"$"* #,##0_-;\\-"$"* #,##0_-;_-"$"* "-"_-;_-@_-','"$"#,##0_%_);\\("$"#,##0\\)_%;"$"#,##0_%_);@_%_)','"$"#,##0.0','"$"#.00','"$"0.0','"$"#,##0.0,_);\\("$"#,##0.0,\\)','"$"#,##0.0;\\("$"#,##0.0\\);','"$"#,##0.0_);\\("$"#,##0.0\\)','"$"\\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','_ "$"\\ * #,##0.0_ ;_ "$"\\ * \\-#,##0.0_ ;_ "$"\\ * "-"??_ ;_ @_ ','_("$"* #,##0.0_);_("$"* \\(#,##0.0\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.0_);_("$"* \\(#,##0.0\\);_("$"* "-"?_);_(@_)','_("$"* #,##0.0_);_("$"* \\(#,##0.0\\);_("$"* "-"_);_(@_)','_-"$"* #,##0.0_-;\\-"$"* #,##0.0_-;_-"$"* "-"_-;_-@_-','"$"#,##0.0_%_);\\("$"#,##0.0\\)_%;"$"#,##0.0_%_);@_%_)','"$"#,##0.00','"$"#.000','"$"\\ #,##0.00','"$"#,##0.00,_);\\("$"#,##0.00,\\)','"$"#,##0.00;\\("$"#,##0.00\\)','"$"#,##0.00;\\-"$"#,##0.00','"$"#,##0.00_);\\("$"#,##0.00\\)','"$"\\ \\ \\ #,##0.00_);\\("$"\\ \\ \\ #,##0.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','_ "$"\\ * #,##0.00_ ;_ "$"\\ * \\-#,##0.00_ ;_ "$"\\ * "-"??_ ;_ @_ ','_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"????_);_(@_)','_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"???_);_(@_)','_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"_);_(@_)','_("$"\\ * #,##0.00_);_("$"\\ * \\(#,##0.00\\);_("$"\\ * "-"??_);_(@_)','_-"$"* #,##0.00_-;\\-"$"* #,##0.00_-;_-"$"* "-"??_-;_-@_-','"$"#,##0.00_%_);\\("$"#,##0.00\\)_%;"$"#,##0.00_%_);@_%_)','"$"#,##0.000','"$"0.000','"$"0000','"$"#,##0.000_);\\("$"#,##0.0\\)','"$"#,##0.000_);\\("$"#,##0.00\\)','"$"#,##0.000_);\\("$"#,##0.000\\)','_("$"* #,##0.000_);_("$"* \\(#,##0.000\\);_("$"* "-"???_);_(@_)','_("$"* #,##0.000_);_("$"* \\(#,##0.000\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.000_);_("$"* \\(#,##0.000\\);_("$"* "-"_);_(@_)','"$"#,##0.0000','"$"0.0000','"$"#,##0.0000_);\\("$"#,##0.00\\)','"$"#,##0.0000_);\\("$"#,##0.0000\\)','_("$"* #,##0.0000_);_("$"* \\(#,##0.0000\\);_("$"* "-"????_);_(@_)','_("$"* #,##0.0000_);_("$"* \\(#,##0.0000\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.0000_);_("$"* \\(#,##0.0000\\);_("$"* "-"_);_(@_)','"$"#,##0.00000','"$"#,##0.00000_);\\("$"#,##0.000\\)','"$"#,##0.00000_);\\("$"#,##0.00000\\)','_("$"* #,##0.00000_);_("$"* \\(#,##0.00000\\);_("$"* "-"?????_);_(@_)','_("$"* #,##0.00000_);_("$"* \\(#,##0.00000\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.00000_);_("$"* \\(#,##0.00000\\);_("$"* "-"_);_(@_)','"$"#,##0.000000','"$"#,##0.000000_);\\("$"#,##0.000000\\)','_("$"* #,##0.000000_);_("$"* \\(#,##0.000000\\);_("$"* "-"??????_);_(@_)','_("$"* #,##0.000000_);_("$"* \\(#,##0.000000\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.000000_);_("$"* \\(#,##0.000000\\);_("$"* "-"_);_(@_)','"$"#,##0.0000000','"$"#,##0.0000000_);\\("$"#,##0.0000000\\)','_("$"* #,##0.0000000_);_("$"* \\(#,##0.0000000\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.0000000_);_("$"* \\(#,##0.0000000\\);_("$"* "-"_);_(@_)','"$"#,##0.00000000','"$"#,##0.00000000_);\\("$"#,##0.00000000\\)','_("$"* #,##0.00000000_);_("$"* \\(#,##0.00000000\\);_("$"* "-"??_);_(@_)','"$"#,##0.000000000_);\\("$"#,##0.000000000\\)','_("$"* #,##0.000000000_);_("$"* \\(#,##0.000000000\\);_("$"* "-"??_);_(@_)','"$"#,##0.0000000000_);\\("$"#,##0.0000000000\\)','"$"#,##0.0000000;[Red]\\-"$"#,##0.0000000','"$"#,##0.0000000_);[Red]\\("$"#,##0.0000000\\)','"$"#,##0.000000_);[Red]\\("$"#,##0.000000\\)','"$"#,##0.000000_);[Red]\\("$"#,##0.000000\\);"- "_)','"$"#,##0.00000;[Red]\\-"$"#,##0.00000','"$"#,##0.00000_);[Red]\\("$"#,##0.00000\\)','"$"#,##0.0000;[Red]\\-"$"#,##0.0000','"$"#,##0.0000_);[Red]\\("$"#,##0.0000\\)','"$"#,##0.0000_);[Red]\\("$"#,##0.0000\\);"- "_)','"$"#,##0.000" /GJ"','"$"#,##0.000_);[Red]\\("$"#,##0.000\\)','"$"#,##0.00" /GJ"','"$"#,##0.00" /mmbtu"','"$"#,##0.00" /MWh"','"$"#,##0.00;[Red]"$"#,##0.00','"$"#,##0.00;[Red]\\-"$"#,##0.00','"$"#,##0.00_);[Red]\\("$"#,##0.00\\)','"$"#,##0.00_);[Red]\\("$"#,##0.00\\);','"$"#,##0.00_);[Red]\\("$"#,##0.00\\);"- "_)','"$"#,##0.00_);[Red]\\("$"#,##0.00\\);"-"','"$"* #,##0.00;[Red]\\ \\("$"* #,##0.00\\)','"$"\\ #,##0.00;[Red]"$"\\ \\-#,##0.00','"$"\\ #,##0.00_);[Red]\\("$"\\ #,##0.00\\)','"$"\\ \\ #,##0.00_);[Red]\\("$"\\ \\ #,##0.00\\)',"\\$#,##0.00;[Red]\\$\\(#,##0.00\\);\\-",'"$"0.0"MM"','"$"#,##0.0;[Red]\\("$"#,##0.0\\)','"$"#,##0.0;[Red]\\-"$"#,##0.0','"$"#,##0.0_);[Red]\\("$"#,##0.0\\)','"$"#,##0.0_);[Red]\\("$"#,##0.0\\);','"$"#,##0.0_);[Red]\\("$"#,##0.0\\);"- "_)','"$"\\ \\ #,##0.0_);[Red]\\("$"\\ \\ #,##0.0\\)','"$"0" / kW"','"$"0"MM"','"$"#,##0\\ "/MW"','"$"#,##0\\ "/MWh"','"$"#,##0\\ "/MWH"','"$"#,##0;[Red]"$"#,##0','"$"#,##0;[Red]\\-"$"#,##0','"$"#,##0_);[Red]\\("$"#,##0\\)','"$"#,##0_);[Red]\\("$"#,##0\\);"- "_)','"$"#,##0_);[Red]\\<"$"#,##0\\>','"$"\\ #,##0;[Red]\\-"$"\\ #,##0','"$"\\ #,##0_);[Red]\\("$"\\ #,##0\\)','"$"\\ \\ #,##0_);[Red]\\("$"\\ \\ #,##0\\)','"$"\\ \\ \\ #,##0_);[Red]"$"\\ \\ \\ \\(#,##0\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ #,##0_);[Red]"$"\\ \\ \\ \\(#,##0\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','_("$"* #,##0_);[Red]_("$"* \\(#,##0\\);_("$"* "-"??_);_(@_)','_("$"* #,##0_);[Red]_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',"[$CAD]\\ #,##0.000","[$CAD]\\ #,##0.000_);\\([$CAD]\\ #,##0.000\\)","[$R$ -416]#,##0_);\\([$R$ -416]#,##0\\)","[$R$ -416]#,##0.00_);\\([$R$ -416]#,##0.00\\)","[$R$-416]#,##0.0000_);[Red]\\([$R$-416]#,##0.0000\\)","[$R$-416]#,##0.000_);[Red]\\([$R$-416]#,##0.000\\)","[$R$-416]#,##0.00_);[Red]\\([$R$-416]#,##0.00\\)","[$R$-416]#,##0_);[Red]\\([$R$-416]#,##0\\)",'"\xA3"#,##0','"\xA3"#,##0;\\-"\xA3"#,##0',"\\\xA3#,##0_);\\(\\\xA3#,##0\\)",'_ "\xA3"* #,##0_ ;_ "\xA3"* \\-#,##0_ ;_ "\xA3"* "-"_ ;_ @_ ','_("\xA3"* #,##0_);_("\xA3"* \\(#,##0\\);_("\xA3"* "-"_);_(@_)','_-"\xA3"* #,##0_-;\\-"\xA3"* #,##0_-;_-"\xA3"* "-"_-;_-@_-','"\xA3"#,##0.0',"\\\xA3#,##0.0_);\\(\\\xA3#,##0.0\\)",'"\xA3"#,##0.00','"\xA3"#,##0.00;\\-"\xA3"#,##0.00',"\\\xA3#,##0.00_);\\(\\\xA3#,##0.00\\)",'_ "\xA3"* #,##0.00_ ;_ "\xA3"* \\-#,##0.00_ ;_ "\xA3"* "-"??_ ;_ @_ ','_("\xA3"* #,##0.00_);_("\xA3"* \\(#,##0.00\\);_("\xA3"* "-"??_);_(@_)','_-"\xA3"* #,##0.00_-;\\-"\xA3"* #,##0.00_-;_-"\xA3"* "-"??_-;_-@_-',"\\\xA3#,##0.000_);\\(\\\xA3#,##0.000\\)","\\\xA3#,##0.0000_);\\(\\\xA3#,##0.0000\\)",'_-"\xA3"* #,##0.0000_-;\\-"\xA3"* #,##0.0000_-;_-"\xA3"* "-"??_-;_-@_-','"\xA3"#,##0.00;[Red]\\-"\xA3"#,##0.00','"\xA3"#,##0.00_);[Red]\\("\xA3"#,##0.00\\)',"\\\xA3#,##0.00_);[Red]\\(\\\xA3#,##0.00\\)","\\\xA3#,##0.0_);[Red]\\(\\\xA3#,##0.0\\)",'"\xA3"#,##0;[Red]\\-"\xA3"#,##0','"\xA3"#,##0_);[Red]\\("\xA3"#,##0\\)',"\\\xA3#,##0_);[Red]\\(\\\xA3#,##0\\)","###\\ ###\\ ###\\ ###.0","###0","#,###.0#","#,###_);\\(#,##0\\);\\ \\-_ ","#,###___);\\(#,##0\\);\\ \\-\\ __","#,##0.##","#,##0.####","#,##0_)","#.0%","#0",'"#"\\ 0',"\\(0\\)",'0%;_("-"\\)',"0%\\ \\ ","0.",'0"  "',"0_)","0_;",'0" $/MWh"','#,##0"\xA3"_);\\(#,##0"\xA3"\\)','_ * #,##0_)"\xA3"_ ;_ * \\(#,##0\\)"\xA3"_ ;_ * "-"_)"\xA3"_ ;_ @_ ','_ * #,##0_)_\xA3_ ;_ * \\(#,##0\\)_\xA3_ ;_ * "-"_)_\xA3_ ;_ @_ ','#,##0"\xA3"_);[Red]\\(#,##0"\xA3"\\)',"#,###.00###","#,###.00###\\ \\ \\ ","#,##0.;\\-#,##0.","#,##0.0","#,##0.0___;","#,##0;\\(#,##0\\)","#,##0;\\(#,##0\\);\\-\\-","#,##0;\\-#,##0",'#,##0;\\-#,##0;"-"',"#,##0\\ ;\\(#,##0\\)","#,##0_ ;\\-#,##0\\ ","#,##0_ \\ ;\\(#,##0\\ \\ \\)","#,##0_);\\(#,##0\\);",'#,##0_);\\(#,##0\\);\\ "  -"',"#,##0_);\\(#,##0\\);\\ \\-\\ ","#,##0_);\\(#,##0\\);\\ \\-\\ \\ ","#,##0_);\\(#,##0\\);\\ \\-\\ \\ \\ \\ ","#,##0_);\\(#,##0\\);\\-","#,##0_);\\(#,##0\\);\\-\\ \\ ","#,##0_);\\(#,##0\\);\\-_)","#,##0_);\\(#,##0\\);\\-_)_ _ ","#,##0_);\\(#,##0\\);_ \\-\\ \\ ","#,##0_);\\(#,##0\\)\\ ;\\-_)_ _ ","#,##0_);\\(#,##0\\)\\-","#,##0_)_ ;\\(#,##0\\)\\ ;\\ \\-_ _)","#,##0_)_ ;\\(#,##0\\)\\ ;\\-_)_ _ ","#,##0___);\\(#,##0\\);\\ \\-\\ __","#,##0___);\\(#,##0\\);\\ \\-__\\ \\ ","#,##0___);\\(#,##0\\);___-\\ \\ ","#,##0___);\\(#,##0\\)_;\\ \\-__\\ \\ ","#,##0___);\\(#,##0\\)___;\\ \\-__\\ \\ ","#,##0_____);\\(#,##0\\);_____-\\ \\ ","#,##0_________);\\(#,##0\\);_________-\\ \\ ","#,#00",".00",'"**"_(* #,##0_);_(* \\(#,##0\\);_(* "-"??_);_(@_)','"*"_(* #,##0_);_(* \\(#,##0\\);_(* "-"??_);_(@_)','"\\"#,##0;"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;"\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;"\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;"\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;"\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;\\-"\\"#,##0',"\\(#,##0_)\\);\\(#,##0\\)",'_ * #,##0_ ;_ * "\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * "\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * "\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * "\\""\\""\\""\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * "\\""\\""\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * "\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * \\-#,##0_ ;_ * "-"??_ ;_ @_ ','_ * #,##0_ ;_ * \\-#,##0_ ;_ * "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* \\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ',"_##,##0_);\\(#,##0\\);\\-_)_ _ ","_##,##0_);\\(#,##0\\)\\ ;\\-_)_ _ ","_(##0_);\\(##0\\)_ ;\\-_)_ _ ",'_(#,##0_);\\(#,##0\\);"-    "','_(* #,##0_);_(* \\(#,##0\\);_(* "-"???_);_(@_)','_(* #,##0_);_(* \\(#,##0\\);_(* "-"??_);_(@_)','_(* #,##0_);_(* \\(#,##0\\);_(* "-"?_);_(@_)','_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)','_(* #,##0_);_(* \\(#,##0\\);_(* ""??_);_(@_)','_-* #,##0_-;\\-* #,##0_-;_-* "-"??_-;_-@_-','_-* #,##0_-;\\-* #,##0_-;_-* "-"_-;_-@_-','_-* #,##0_-;_-* #,##0\\-;_-* "-"??_-;_-@_-','_-"\\"* #,##0_-;\\-"\\"* #,##0_-;_-"\\"* "-"_-;_-@_-',"0%\\-0%","0.0","0.0%",'0.0%;_(* "-"_)','0.0%;_("-"\\)','0.0%;_("-"_)','0.0%;_(\\ "-"_)',"0.0%\\ \\)",'0.0%\\-;_("-"_)','0.0"  "','0.0"%"','0.0_ "  "',"0.0_)","0.0_;","0.0____","0;\\-0;","0;\\-0;;","0;\\-0;;@\\ ","0_ ;\\-0\\ ","0_);\\(0\\)","00","###0_%_);\\(#,##0\\)_%;#,##0_%_);@_%_)","#,###.0_);\\(#,##0.0\\);\\ \\-\\ _ ","#,##0.00#","#,##0.00###","#,##0.00__;","#,##0_%_);\\(#,##0\\)_%;#,##0_%_);@_%_)","#,##0_);\\(#,##0\\);#,##0_);@_)",'"@ "\\&0.00%','"@ "0.00%','_(* #,##0_);_(* \\(#,##0\\);_(* "0"??_);_(@_)',"0%_);\\(0%\\);0%_);@_%_)","0.00#%",'0.00%;_(* "-"_)','0.00%;_("-"\\)',"0.00;;",'0.00"  "',"0.00_)","0_%_);\\(0\\)_%;0_%_);@_%_)","000","000#",'#,##0.00" $";\\-#,##0.00" $"',"#,##0.00\\ [$DM-407]","#,##0.00\\ [$EUR-407]",'#,##0.00" $";[Red]\\-#,##0.00" $"','#,##0.00"\xA3"_);\\(#,##0.00"\xA3"\\)','_ * #,##0.00_)"\xA3"_ ;_ * \\(#,##0.00\\)"\xA3"_ ;_ * "-"??_)"\xA3"_ ;_ @_ ','_ * #,##0.00_)_\xA3_ ;_ * \\(#,##0.00\\)_\xA3_ ;_ * "-"??_)_\xA3_ ;_ @_ ','#,##0.00"\xA3"_);[Red]\\(#,##0.00"\xA3"\\)',"##0.000","#,##0.0%_);\\(#,##0.0%\\);","#,##0.0_);\\(#,##0.0\\)","#,##0.0_);\\(#,##0.0\\);\\ \\-\\ \\ ","#,##0.0_);\\(#,##0.0\\);_ \\ \\-","#,##0.0____\\);\\(#,##0.0\\);___ \\-\\ \\ ","#,##0.0_______);\\(#,##0.0\\);______\\ \\-\\ \\ ","#,##0.0________\\);\\(#,##0.0\\);_______ \\-\\ \\ ","#,##0.0________\\);\\(#,##0.0\\);________\\ \\-\\ \\ ","#,##0.0_________);\\(#,##0.0\\);\\ \\-\\ \\ ","#,##0.0_________);\\(#,##0.0\\);________\\ \\-\\ \\ ","#,##0.000","#,##0.000___;",".0000",".0000%",'_(* #,##0.0_);_(* \\(#,##0.0\\);_(* "-"??_);_(@_)','_(* #,##0.0_);_(* \\(#,##0.0\\);_(* "-"?_);_(@_)','_(* #,##0.0_);_(* \\(#,##0.0\\);_(* "-"_);_(@_)','_-* #,##0.0_-;\\-* #,##0.0_-;_-* "-"??_-;_-@_-','_-* #,##0.0_-;\\-* #,##0.0_-;_-* "-"_-;_-@_-',"0.0%;\\(0.0\\)%;\\ \\-\\ \\ ",'0.0%;\\-0.0%;\\ "-"_%;@_%',"0.0%\\ ;\\(0.0\\)%\\ ;\\-\\ \\ \\ ","0.0%\\);\\(0.0\\)%;\\ \\-","0.0%_);\\(0.0%\\)","0.0%_);\\(0.0\\)%;\\ \\-","0.0%_;\\(0.0\\)%;\\ \\-\\ \\ \\ ","0.0_%;\\(0.0\\)%;\\ \\-\\ \\ \\ ","0.0_);\\(0.0\\)","0.000","0.000%",'0.000%;_("-"\\)',"0.000_)","0.000_;","0000","##0.000\\ \\\xA2","#,##0.00_);\\(#,##0.0\\)","#,##0.0000","#,##0.0000___;","0.0000","0.0000%",'0.0000%;_(* "-"_)','0.0000%;_("-"\\)','0.0000"  "',"0.0000\\ %","0.0000_)","00\\-000","00\\-000_)","00000","###0.00_);\\(#,##0.00\\)","#,##0.0%_);\\(#,##0.0%\\);0.0%_);@_%_)","#,##0.0_%_);\\(#,##0.0\\)_%;#,##0.0_%_);@_%_)","#,##0.0_);\\(#,##0.0\\);#,##0.0_);@_)","#,##0.00%_);\\(#,##0.00%\\)","#,##0.00;#,##0.00;","#,##0.00;\\(#,##0.00\\)","#,##0.00;\\(#,##0.00\\);\\-\\-","#,##0.00_);\\(#,##0.00\\);\\ \\-\\ ","#,##0.00_);\\(#,##0.00\\);\\-","#,##0.00_);\\(#,##0.00\\);\\-\\ \\ ","#,##0.00_);\\(#,##0.00\\);_ \\ \\-","#,##0.00_);\\(#,##0.00\\);_ \\-\\ \\ ","#,##0.00__\\);\\(#,##0.00\\);__\\ \\ \\-","#,##0.00___);\\(#,##0.00\\);___ \\ \\-","#,##0.00___);\\(#,##0.00_);\\ \\-\\ \\ \\ ","#,##0.00000","#,##0.00000___;",'"\\"#,##0.00;"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\"\\-#,##0.00','"\\"#,##0.00;\\-"\\"#,##0.00','_ * #,##0.00_ ;_ * "\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ * #,##0.00_ ;_ * "\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ * #,##0.00_ ;_ * "\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ * #,##0.00_ ;_ * "\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ * #,##0.00_ ;_ * "\\""\\""\\""\\"\\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ * #,##0.00_ ;_ * \\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* \\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"????_);_(@_)','_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)','_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"?_);_(@_)','_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"_);_(@_)','_-* #,##0.00_-;\\-* #,##0.00_-;_-* "-"??_-;_-@_-','_-* #,##0.00_-;\\-* #,##0.00_-;_-* "-"_-;_-@_-','_-* #,##0.00_-;_-* #,##0.00\\-;_-* "-"??_-;_-@_-','_-"\\"* #,##0.00_-;\\-"\\"* #,##0.00_-;_-"\\"* "-"??_-;_-@_-',"0.0%_);\\(0.0%\\);0.0%_);@_%_)","0.0\\%_);\\(0.0\\%\\);0.0\\%_);@_%_)","0.00%_);\\(0.00%\\)","0.00;\\-0.00;","0.00_);\\(0.00\\)","0.00000","0.00000%",'0.00000"  "',"0.00000_)","000000","#,###.000_);\\(#,##0.000\\);\\ \\-\\ _ ","#,##0.000000","0.000000","0.000000%","0.000000_)","#,##0.000;\\(#,##0.000\\)","#,##0.000;\\(#,##0.000\\);\\-\\-","#,##0.000_);\\(#,##0.000\\)","#,##0.000_);\\(#,##0.000\\);\\ \\-\\ \\ ","#,##0.000_);\\(#,##0.000\\);\\-","#,##0.000_);\\(#,##0.000\\);_ \\-\\ \\ ","#,##0.0000000",'_(* #,##0.000_);_(* \\(#,##0.000\\);_(* "-"???_);_(@_)','_(* #,##0.000_);_(* \\(#,##0.000\\);_(* "-"??_);_(@_)','_(* #,##0.000_);_(* \\(#,##0.000\\);_(* "-"?_);_(@_)','_(* #,##0.000_);_(* \\(#,##0.000\\);_(* "-"_);_(@_)','_-* #,##0.000_-;\\-* #,##0.000_-;_-* "-"??_-;_-@_-',"_00000000","0.000_);\\(0.000\\)","0.0000000","0.0000000%","0.0000000_)","0000\\ \\-\\ 0000","00000000","#,###.0000_);\\(#,##0.0000\\);\\ \\-\\ _ ","#,##0.00_%_);\\(#,##0.00\\)_%;#,##0.00_%_);@_%_)","#,##0.00000000","0.00%_);\\(0.00%\\);0.00%_);@_%_)","0.00000000","0.00000000%","0.00000000_)","000\\-00\\-0000","000000000","#,##0.0000;\\(#,##0.0000\\)","#,##0.0000;\\-#,##0.0000","#,##0.0000_);\\(#,##0.0000\\)","#,##0.0000_);\\(#,##0.0000\\);_ \\-\\ \\ ","#,##0.0000_);\\(#,##0.0000_)","#,##0.0000___);\\(#,##0.0000_);\\ \\-\\ \\ \\ ","#,##0.000000000","\\(000\\)000\\-0000",'_(* #,##0.0000_);_(* \\(#,##0.0000\\);_(* "-"????_);_(@_)','_(* #,##0.0000_);_(* \\(#,##0.0000\\);_(* "-"??_);_(@_)','_(* #,##0.0000_);_(* \\(#,##0.0000\\);_(* "-"?_);_(@_)','_(* #,##0.0000_);_(* \\(#,##0.0000\\);_(* "-"_);_(@_)','_-* #,##0.0000_-;\\-* #,##0.0000_-;_-* "-"??_-;_-@_-',"0.0000_);\\(0.0000\\)","0.000000000","0.000000000%","0.000000000_)","0000000000","#,###.00000_);\\(#,##0.00000\\);\\ \\-\\ _ ","#,##0.0000000000","0.0000000000","0.0000000000_)","#,##0.00000_);\\(#,##0.00000\\)","#,##0.00000000000",'_(* #,##0.00000_);_(* \\(#,##0.00000\\);_(* "-"?????_);_(@_)','_(* #,##0.00000_);_(* \\(#,##0.00000\\);_(* "-"??_);_(@_)','_(* #,##0.00000_);_(* \\(#,##0.00000\\);_(* "-"_);_(@_)','_-* #,##0.00000_-;\\-* #,##0.00000_-;_-* "-"??_-;_-@_-',"0.00000_);\\(0.00000\\)","0.00000000000","0.00000000000_)","#,###.000000_);\\(#,##0.000000\\);\\ \\-\\ _ ","0.000000000000","#,##0.000000_);\\(#,##0.000000\\)",'_(* #,##0.000000_);_(* \\(#,##0.000000\\);_(* "-"??_);_(@_)','0.000000%;\\-0.000000%;\\ "-"_%;@_%',"0.0000000000000","0.0000000000000_)","0.00000000000000%","#,##0.0000000_);\\(#,##0.0000000\\)",'_(* #,##0.0000000_);_(* \\(#,##0.0000000\\);_(* "-"??_);_(@_)',"0.0000000_);\\(0.0000000\\)","0.000000000000000%","0.0000000000000000","#,##0.00000000_);\\(#,##0.00000000\\)",'_(* #,##0.00000000_);_(* \\(#,##0.00000000\\);_(* "-"??_);_(@_)',"0.00000000000000000","0.00000000000000000%","0.000000000000000000","0.000000000000000000%","#,##0.000000000_);\\(#,##0.000000000\\)",'_(* #,##0.000000000_);_(* \\(#,##0.000000000\\);_(* "-"??_);_(@_)',"#,##0.00000000000000000000","#,##0.0000000000_);\\(#,##0.0000000000\\)",'_(* #,##0.0000000000_);_(* \\(#,##0.0000000000\\);_(* "-"_);_(@_)',"0.0000000000000000000000","0.0000000000000000000000%",'_(* #,##0.000000000000_);_(* \\(#,##0.000000000000\\);_(* "-"_);_(@_)',"0.0000000000000000000000000","0.00000000000000000000000000",'_(* #,##0.0000000000000_);_(* \\(#,##0.0000000000000\\);_(* "-"_);_(@_)',"0.000000000000000000000000000","0.0000000000000000000000000000",'_(* #,##0.00000000000000_);_(* \\(#,##0.00000000000000\\);_(* "-"??_);_(@_)','_(* #,##0.00000000000000_);_(* \\(#,##0.00000000000000\\);_(* "-"_);_(@_)',"0.000000000000000000000000000000","0.00000000000000000000000000000000","#,##0.0000000000000000_);\\(#,##0.0000000000000000\\)","0.000000000000000000000000000000000","0.0000000000000000000000000000000000","0.00000000000000000000000000000000000","#,##0.00000000000000000000_);[Red]\\(#,##0.00000000000000000000\\)","#,##0.0000000000000_);[Red]\\(#,##0.0000000000000\\)","#,##0.000000000000_);[Red]\\(#,##0.000000000000\\)","#,##0.00000000000_);[Red]\\(#,##0.00000000000\\)","#,##0.0000000000_);[Red]\\(#,##0.0000000000\\)","#,##0.00000000_);[Red]\\(#,##0.00000000\\)","#,##0.0000000_);[Red]\\(#,##0.0000000\\)","#,##0.000000_);[Red]\\(#,##0.000000\\)","0.000000\\x_);\\(0.000000\\x\\)","0.00000E+00","#,##0.00000_);[Red]\\(#,##0.00000\\)","0.00000_);[Red]\\(0.00000\\)","0.0000E+00","###0.0000_);[Red]\\(###0.0000\\)","#,##0.0000\\ ;[Red]\\(#,##0.0000\\)","#,##0.0000_ ;[Red]\\-#,##0.0000\\ ","#,##0.0000_);[Red]\\(#,##0.0000\\)","0.0000%;[Red]\\-0.0000%","0.0000%\\ ;[Red]\\(0.0000%\\)","0.0000;[Red]0.0000","0.0000_ ;[Red]\\-0.0000\\ ","0.0000_);[Red]\\(0.0000\\)","0.0000\\x_);\\(0.0000\\x\\)","0.000E+00","0.000E+00_)",'0.000" MWh/GJ"',"###0.000_);[Red]\\(###0.000\\)","#,##0.000;[Red]\\(#,##0.000\\)","#,##0.000;[Red]\\(#,##0.000\\);\\-","#,##0.000\\ ;[Red]\\(#,##0.000\\)","#,##0.000_);[Red]\\(#,##0.000\\)","0.000;[Red]0.000","0.000_);[Red]\\(0.000\\)","0.000_);[Red]\\-0.000_)","#,##0.0_%_);\\(#,##0.0\\)_%;[White]#,##0.0_%_);@_%_)",'0.00%" Capitalization Rate"','0.00%" Discount Rate"','_-* #,##0.00\\ "DM"_-;\\-* #,##0.00\\ "DM"_-;_-* "-"??\\ "DM"_-;_-@_-','_-* #,##0.00\\ _D_M_-;\\-* #,##0.00\\ _D_M_-;_-* "-"??\\ _D_M_-;_-@_-','#,##0.00" F"_);\\(#,##0.00" F"\\)','_-* #,##0.00\\ "F"_-;\\-* #,##0.00\\ "F"_-;_-* "-"??\\ "F"_-;_-@_-','_-* #,##0.00\\ _F_-;\\-* #,##0.00\\ _F_-;_-* "-"??\\ _F_-;_-@_-','0.00" GJ//MWh"','0.00" GJ/MWh"','0.00\\ "MW"','0.00%" of Avg LTD"','0.00%" of Sales"','0.00%" perpetual annual growth"','_-* #,##0.00\\ "Pts"_-;\\-* #,##0.00\\ "Pts"_-;_-* "-"??\\ "Pts"_-;_-@_-','_-* #,##0.00\\ _P_t_s_-;\\-* #,##0.00\\ _P_t_s_-;_-* "-"??\\ _P_t_s_-;_-@_-',"###0.00_);[Red]\\(###0.00\\)","#,##0.00%_);[Red]\\(#,##0.00%\\)","#,##0.00;[Red]#,##0.00",'#,##0.00;[Red]"-"#,##0.00',"#,##0.00;[Red]\\(#,##0.00\\)","#,##0.00;[Red]\\(#,##0.00\\);\\-","#,##0.00\\ ;[Red]\\(#,##0.00\\)","#,##0.00\\ \\);[Red]\\(#,##0.00\\)","#,##0.00_ ;[Red]\\-#,##0.00\\ ",'#,##0.00_);[Red]\\(#,##0.00\\);"-"','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\"\\-#,##0.00','"\\"#,##0.00;[Red]\\-"\\"#,##0.00','_(* #,##0.00_);[Red]_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',"0.00%;[Red]\\(0.00%\\)","0.00%\\ ;[Red]\\(0.00%\\)","0.00%\\ ;[Red]\\(0.00%\\);\\-","0.00;[Red]0.00","0.00_ ;[Red]\\-0.00\\ ","0.00_);[Red]\\(0.00\\)","0.00_);[Red]\\(0.00\\);;","#,##0.00_);[Red]\\(#,##0.00\\)*1000","0.00\\x",'_(* #,##0.00\\x\\ \\ ;_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',"0.00\\x_);\\(0.00\\x\\)","_(##0_);\\(##0\\)_1;\\-_)_ _ ",'""0.0%" --> 61.5% of Sales 1st 5 yrs.; steady state thereafter"','00\\ "Coal Upgrade"',"0.0E+00",'0.0" GJ/MWh"','00\\ "Hydro"','00\\ "Incremental"','0.0" mmbtu//MWh"','0.0%" of beg. Net PPE + Intgble Amort."','0.0%" of Sales"','0.0%" of Total Assets"',"#,##0.0_);[Red]\\(#,##0\\)","###0.0_);[Red]\\(###0.0\\)","#,##0.0;[Red]\\(#,##0.0\\)","#,##0.0;[Red]\\(#,##0.0\\);\\-","#,##0.0;[Red]\\-#,##0.0","#,##0.0\\ ;[Red]\\(#,##0.0\\)","#,##0.0_ ;[Red]\\-#,##0.0\\ ","#,##0.0_);[Red]\\(#,##0.0\\)","#,##0.0_);[Red]\\(#,##0.0\\);","#,##0.0_);[Red]\\(#,##0.0\\);\\-","0.0%;[Red]\\(0.0%\\)","0.0%\\ ;[Red]\\(0.0%\\)","0.0%_);[Red]\\(0.0%\\)","0.0_);[Red]\\(0.0\\)","0.0_);[Red]\\-0.0_)","#,##0.0_);[Red]\\(#,##0.0\\)*1000",'0.0"x"','0.0\\ "x"',"0.0\\x","#,##0.0\\x_);\\(#,##0.0\\x\\)","#,##0.0\\x_);\\(#,##0.0\\x\\);",'0.0\\x_)_);"NM"_x_)_);0.0\\x_)_);@_%_)',"#,##0.0\\x_);[Red]\\(#,##0.0\\x\\);",'0%\\ "Beg. Net PPE + Intangibles"','0" Days"','_-* #,##0\\ "DM"_-;\\-* #,##0\\ "DM"_-;_-* "-"\\ "DM"_-;_-@_-','_-* #,##0\\ _D_M_-;\\-* #,##0\\ _D_M_-;_-* "-"\\ _D_M_-;_-@_-',"#,##0_e","0.E+00","0E+00","0\\ \\f",'_-* #,##0\\ "F"_-;\\-* #,##0\\ "F"_-;_-* "-"\\ "F"_-;_-@_-','_-* #,##0\\ _F_-;\\-* #,##0\\ _F_-;_-* "-"\\ _F_-;_-@_-','#,##0" GJ/D"','0\\ "Hydro"','0" / kW"','0\\ "Last Year"','#,##0" MMBTUs";\\-#,##0" MMBTUs"','0" months"','0\\ "mos"','0" MW"','#,##0" MWh";\\-#,##0" MWh"','#,##0" MWh/D"','#,##0_)"MWH";[Red]\\("$"#,##0\\);"- "_)','#,##0_)"mW";[Red]\\("$"#,##0\\);"- "_)','0\\ " of"','0%" of Sales"','_-* #,##0\\ "Pts"_-;\\-* #,##0\\ "Pts"_-;_-* "-"\\ "Pts"_-;_-@_-','_-* #,##0\\ _P_t_s_-;\\-* #,##0\\ _P_t_s_-;_-* "-"\\ _P_t_s_-;_-@_-',"#,##0_r_)",'#,##0"r"_)',"###0_);[Red]\\(#,##0\\)","##,##0;[Red]\\(##,##0\\)","#,##0;[Red]#,##0",'#,##0;[Red]"-"#,##0',"#,##0;[Red]\\(#,##0\\)","#,##0;[Red]\\(#,##0\\);\\-","#,##0;[Red]\\-#,##0","#,##0;[Red]\\-#,##0;\\-","#,##0\\ ;[Red]\\(#,##0\\)","#,##0_ ;[Red]\\-#,##0\\ ","#,##0_);[Red]\\(#,##0\\);","#,##0_);[Red]\\(#,##0\\);;",'#,##0_);[Red]\\(#,##0\\);"-   "','#,##0_);[Red]\\(#,##0\\);"- "_)','#,##0_);[Red]\\(#,##0\\);"-"',"#,##0_);[Red]\\(#,##0\\);\\-","#,##0_);[Red]\\<#,##0\\>","#.0,,;[Red]\\(#.0,,\\)",'"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\"\\-#,##0','"\\"#,##0;[Red]\\-"\\"#,##0','_(* #,##0_);[Red]* \\(#,##0\\);_(* "-"_);_(@_)','_(* #,##0_);[Red]\\(* \\(#,##0\\);_(* "-"_);_(@_)',"0%\\ ;[Red]\\(0%\\)",'0%\\ ;[Red]\\(0%\\)\\ ;"-  "',"0%\\);[Red]\\(0%\\)","0%_);[Red]\\(0%\\)","0;[Red]0","0_);[Red]\\(0\\)","0_);[Red]\\(0\\);;","0_);[Red]\\-0_)","#,##0_);[Red]\\(#,##0,\\)*1000",'0%" Tax Rate"','0\\ "Wind"','0\\ "WTG"','0" Year"','0" years"',"0\\ \\y\\e\\a\\r\\s",'0"  Years"',"\\10000000","#?/12","#\\ ?/32","#\\ ?/32;[Red]\\(#?/32\\)","#\\ ?/32;[Red]\\(#\\ ?/32\\)","#\\ ?/4","#\\ ?/64","[<=9999999]###\\-####;\\(###\\)\\ ###\\-####",'"and"\\ 0\\ "-->6-year average"','"As of "\\ mm/dd/yy','"As of "mmmm\\ dd\\,\\ yyyy','"As of"\\ mmmm\\ dd\\,\\ yyyy','"As of "mmmm\\ d\\,\\ yyyy','"Ave. Debt Bal. * "0.00%" cost * (1-t)"','#\\ "BP"','_(\\C"$"* #,##0.00000_);_(\\C"$"* \\(#,##0.00000\\);_(\\C"$"* "0"_);_(@_)','\\C"$"#,##0_);\\(\\C"$"#,##0\\)','_(\\C"$"* #,##0_);_(\\C"$"* \\(#,##0\\);_(\\C"$"* "0"_);_(@_)','\\C"$"\\ #,##0\\);[Red]\\(\\C"$"\\ #,##0\\)','"Canada Cash Desk Economics (CDN$) for"\\ mmm\\-yy\\ "as of:"','"Change since "mmmm\\ dd\\,\\ yyyy','"Changes Since "mmmm\\ dd\\,\\ yyyy','_ "CHF"\\ * #,##0.00_ ;_ "CHF"\\ * \\-#,##0.00_ ;_ "CHF"\\ * "-"??_ ;_ @_ ','"Converted at "_(* #,##0.0000_);_(* \\(#,##0.0000\\);_(* "-"??_);_(@_)','"Cr$"\\ #,##0_);\\("Cr$"\\ #,##0\\)','"Current Day ("mm/dd/yy") Theoretical Sensitivities"\\ ','"Curves Loaded for"\\ \\ mm/dd/yy','"DATE:"\\ dd\\-mmm\\-yy','"DATE="mm/dd/yy','#\\ "Day"',"dd","ddd","dddd","ddd\\ \\-\\ dd","ddd\\-dd","dddd\\ d\\ mmmm\\ yyyy","ddd\\-dd\\-mmm\\-yy","ddd\\ dd\\ mmm\\ yyyy\\ hh:mm","dd\\-ddd\\-yy","dddd\\ mmmm\\ dd\\ ","dddd\\,\\ mmmm\\ dd\\,\\ yyyy","dddd\\,\\ mmmm\\ d\\,\\ yyyy","dddd\\,\\ mmmm\\,\\ d\\,\\ yyyy","dddd\\,mmmm\\,d\\,yyyy","ddd\\,\\ mmm\\ d","ddd\\-mmm\\-dd","ddd\\ yy/mm/dd","dd\\-mmm_)","dd\\-mmm\\-yy","dd\\-mmm\\-yy_)","dd\\-mmm\\-yy_);[Red]dd\\-mmm\\-yy_)","dd\\ mmm\\ yyyy","dd\\-mmm\\-yyyy","ddmmyy",'"Detail of New Transactions By Originator - "mmmm\\,\\ yyyy','"Discount Rate of"\\ 0.00%',"d\\-mmm\\,ddd",'d\\-mmm\\-yy\\ "Cycle 6"',"d/mmm/yyyy","d\\-mmm\\-yyyy",'d\\-mmm\\-yyyy\\ "Cycle 6"',"d/m/yy\\ h:mm","d\\.m\\.yy\\ h:mm",'"down"\\ 0.0','"DR="0.00%','"Effective Date: "\\ dd\\-mmm\\-yyyy','"EQUITY CASH FLOW PV AT "#0.00"%"','"First Period Days =  "\\ 0','"Fuel Cost:"\\ 0.00',"General\\ ","General_)","General;[Red]\\-General","General_);[Red]\\-General_)","h","hh:mm","hh:mm\\ AM/PM","hh:mm\\ AM/PM_)","hh:mm:ss","[h]:mm",'h:mm:ss"\\""\\""\\""\\"\\ AM/PM','"Include";;"Exclude"','" K-"#','_ "kr"\\ * #,##0.00_ ;_ "kr"\\ * \\-#,##0.00_ ;_ "kr"\\ * "-"??_ ;_ @_ ','_ "kr"\\ * #,##0_ ;_ "kr"\\ * \\-#,##0_ ;_ "kr"\\ * "-"_ ;_ @_ ','"LTD Through "mmmm\\ dd\\,\\ yyyy','##"m"',"m","m/d","m/dd/yyyy","m/d/yy","m/d/yy_%_)","m\\-d\\-yy","m/d/yy\\ h:mm","m/d/yy\\ h:mm\\ AM/PM","m\\/d\\/yyyy","m/d/yyyy\\ h:mm:ss","mm","mm/dd","mmdd","mm/dd/ddd","mm/dd/yy","mm/dd/yy_)","mm\\-dd\\-yy","mmddyy","mm/dd/yy\\ hh:mm","mm\\-dd\\-yy\\ hmm\\ AM/PM","mm/dd/yyyy",'mm"/"dd"/"yyyy',"mm\\-dd\\-yyyy","mm\\-dd\\-yyyy\\ ","mm\\/dd\\/yyyy","mm/dd/yyyy\\ hh:mm\\ AM/PM","mm/dd/yyyy\\ hh:mmAM/PM","mm\\-dd\\-yyyy\\ \\ hh:mm:ss\\ AM/PM\\ \\ ","mm\\-dd\\-yyyy\\ hh:mm:ss\\ AM/PM","mmm","mmm\\ d","mmm\\-dd","mmm\\-dd\\ \\ \\ h:mm\\ AM/PM","mmm\\ dd\\ yy_;","mmm\\-dd\\-yy","mmm\\-dd\\-yy\\ h:mm\\ AM/PM","mmm\\ dd\\ yyyy;","mmmddyyyy","mmm\\ dd\\ yyyy\\ hh:mm\\ AM/PM","mmm\\-d\\-yy","mmm\\-d\\-yy\\ ","mmm\\ d\\,\\ yyyy","mmmm","mmmm\\ d",'mmmm\\ dd","\\ yyyy',"mmmm\\ dd\\,\\ yyyy","mmmm\\ dd\\,\\ yyyy\\ \\ h:mm\\ AM/PM","\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ mmmm\\ d\\,\\ yyyy","mmmm\\ d\\,\\ yyyy","mmmmm","mm\\-mmm\\-yy","mmmm\\-yy","mmmm\\ yyyy","mmmm\\-yyyy","mmm\\ yy","mmm\\-yy_)","mmm\\.yy","mmm\\ yyyy","mmm\\,\\ yyyy","mmm\\-yyyy","mmm\\-yyyy_)","mm/yy","mm\\-yy","mm/yyyy","mm\\-yyyy",'"MTD Through "mmmm\\ dd\\,\\ yyyy',"m/yy","m\\/yy","m/yyyy","\\n\\o\\t\\ \\Q0",'"On";;"Off"','_("P"* #,##0.00_);_("P"* \\(#,##0.00\\);_("P"* "-"??_);_(@_)','_("P"\\ * #,##0.00_);_("P"\\ * \\(#,##0.00\\);_("P"\\ * "-"??_);_(@_)','_("P"* #,##0_);_("P"* \\(#,##0\\);_("P"* "-"_);_(@_)','_("P"\\ * #,##0_);_("P"\\ * \\(#,##0\\);_("P"\\ * "-"_);_(@_)','"Pmts per Year = "0',"\\P\\P\\ #,##0.00000_);\\(\\P\\P\\ #,##0.00000_)",'_("Ps. "* #,##0.00_);_("Ps. "* \\(#,##0.00\\);_("Ps. "* "-"??_);_(@_)','"Ps. "#,##0.00_);[Red]\\("Ps. "#,##0.00\\)','_("Ps. "* #,##0_);_("Ps. "* \\(#,##0\\);_("Ps. "* "-"_);_(@_)',"\\Q\\ 0","\\Q0",'_("R$"* #,##0.00_);_("R$"* \\(#,##0.00\\);_("R$"* "-"??_);_(@_)','_("R$"* #,##0_);_("R$"* \\(#,##0\\);_("R$"* "-"_);_(@_)',"[Red]#,##0;\\-#,##0","[Red]#,##0.0;[Blue]\\<#,##0.0\\>",'_-"Rs."* #,##0.00_-;\\-"Rs."* #,##0.00_-;_-"Rs."* "-"??_-;_-@_-','_-"Rs."* #,##0_-;\\-"Rs."* #,##0_-;_-"Rs."* "-"_-;_-@_-','_-"S/."\\ * #,##0.00_-;\\-"S/."\\ * #,##0.00_-;_-"S/."\\ * "-"??_-;_-@_-','_-"S/."\\ * #,##0_-;\\-"S/."\\ * #,##0_-;_-"S/."\\ * "-"_-;_-@_-','"Sales growth declines from "0.0%" to 10% in yr 5"','"Sensitivity Change from Prior Day ("mm/dd/yy")"','_ "SFr."* #,##0.00_ ;_ "SFr."* \\-#,##0.00_ ;_ "SFr."* "-"??_ ;_ @_ ','"SFr."#,##0;[Red]"SFr."\\-#,##0','"SFr."#,##0;"SFr."\\-#,##0','_ "SFr."* #,##0_ ;_ "SFr."* \\-#,##0_ ;_ "SFr."* "-"_ ;_ @_ ','"Stmt Date "m/d/yy','"Through "mmmm\\ dd\\,\\ yyyy','_(\\U"$"* #,##0_);_(\\U"$"* \\(#,##0\\);_(\\U"$"* "0"_);_(@_)','"up"\\ 0.0','"VS"\\ mmm\\-yy',"\\W#,##0","\\W#,##0.0",'"Wire Date "m/d/yy','"with "0%" tax"',"#\\x","\\X",'"Yes";;"No"','"Yes"_%_);;"No"_%_)','"YTD Through "mmmm\\ dd\\,\\ yyyy',"yyddmm","yy/m","yy/mm","yy\\-mm\\-dd","yymmdd",'yy"\\""\\""\\"\\-mm"\\""\\""\\"\\-dd"\\""\\""\\""\\"\\ h:mm',"yy\\ mmm","yy\\ mmm\\ dd","yyyy","yyyyddmm","yyyy/mm","yyyy\\.mm\\.dd","yyyy\\-mm\\-dd\\ hh:mm","yyyy/mm/dd\\ hh:mm:ss:ss","yyyy\\-mm\\-dd\\ hh:mm:ss\\.ss","yyyy\\ \\-\\ mmm","yyyy\\-mmm","yyyy\\-mmm\\-dd","yyyymmmdd","yyyy\\ mmmm"]});var gm=Y(po=>{"use strict";_();Object.defineProperty(po,"__esModule",{value:!0});po.util=po.unicode=po.testData=po.serviceTypes=po.ribbonFormat=po.render=po.parsedate=po.parseconst=po.parse=po.localeData=po.knownFormat=po.impl=po.formulaBar=po.formatService=po.eval=po.edit=po.PackageName=void 0;po.PackageName="excel-online-calc-numfmt";po.edit=yU();po.eval=sZ();po.formatService=eCe();po.formulaBar=kZ();po.impl=EZ();po.knownFormat=H2();po.localeData=vZ();po.parse=FZ();po.parseconst=cU();po.parsedate=SU();po.render=EU();po.ribbonFormat=nCe();po.serviceTypes=E1();po.testData=tCe();po.unicode=N3();po.util=OZ()});var Ll=Y(bn=>{_();Object.defineProperty(bn,"__esModule",{value:!0});bn.tooWide=bn.stringEdit=bn.renderedValueToString=bn.renderedValue=bn.renderInfiniteWidth=bn.renderCallback=bn.previousFormatFailure=bn.otherEdit=bn.numberEdit=bn.notValueString=bn.notFormatString=bn.noFormatPart=bn.memoizedRenderCallback=bn.isSystemCultureTag=bn.isHashesValue=bn.isFormatCultureEqual=bn.hashesValue=bn.fractionOverflow=bn.formulaEdit=bn.formattedValue=bn.formattedUnitString=bn.formattedUnitGeneral=bn.formattedUnitFlexible=bn.formattedUnitBlank=bn.formatLocKnownFormat=bn.formatLocIFormat=bn.evalFormatLocalsGrid=bn.dateOverflow=bn.createFormatGlobals=bn.aggregationError=bn.ReasonKind=bn.NumberFormatSource=bn.NamedColor=bn.GetTimeKind=bn.FormattedUnitKind=bn.FormatValueType=bn.FormatReasonKind=bn.FormatLocKind=bn.FormatCurrency=bn.EditKind=bn.CultureTag=bn.Clip=bn.BidiDate=bn.Alignment=void 0;var vi=gm(),Gvr=vi.serviceTypes.Alignment;bn.Alignment=Gvr;var Kvr=vi.serviceTypes.BidiDate;bn.BidiDate=Kvr;var Vvr=vi.serviceTypes.Clip;bn.Clip=Vvr;var Wvr=vi.serviceTypes.CultureTag;bn.CultureTag=Wvr;var jvr=vi.serviceTypes.EditKind;bn.EditKind=jvr;var Hvr=vi.serviceTypes.FormatCurrency;bn.FormatCurrency=Hvr;var Qvr=vi.serviceTypes.FormatReasonKind;bn.FormatReasonKind=Qvr;var zvr=vi.serviceTypes.FormatValueType;bn.FormatValueType=zvr;var Yvr=vi.serviceTypes.FormattedUnitKind;bn.FormattedUnitKind=Yvr;var Jvr=vi.serviceTypes.GetTimeKind;bn.GetTimeKind=Jvr;var Xvr=vi.serviceTypes.NamedColor;bn.NamedColor=Xvr;var Zvr=vi.serviceTypes.NumberFormatSource;bn.NumberFormatSource=Zvr;var $vr=vi.serviceTypes.ReasonKind;bn.ReasonKind=$vr;var ehr=vi.serviceTypes.aggregationError;bn.aggregationError=ehr;var rhr=vi.serviceTypes.createFormatGlobals;bn.createFormatGlobals=rhr;var nhr=vi.serviceTypes.dateOverflow;bn.dateOverflow=nhr;var thr=vi.serviceTypes.evalFormatLocalsGrid;bn.evalFormatLocalsGrid=thr;var ahr=vi.serviceTypes.formattedUnitBlank;bn.formattedUnitBlank=ahr;var ihr=vi.serviceTypes.formattedUnitFlexible;bn.formattedUnitFlexible=ihr;var ohr=vi.serviceTypes.formattedUnitGeneral;bn.formattedUnitGeneral=ohr;var uhr=vi.serviceTypes.formattedUnitString;bn.formattedUnitString=uhr;var shr=vi.serviceTypes.formattedValue;bn.formattedValue=shr;var lhr=vi.serviceTypes.formulaEdit;bn.formulaEdit=lhr;var chr=vi.serviceTypes.fractionOverflow;bn.fractionOverflow=chr;var dhr=vi.serviceTypes.hashesValue;bn.hashesValue=dhr;var fhr=vi.serviceTypes.isFormatCultureEqual;bn.isFormatCultureEqual=fhr;var phr=vi.serviceTypes.isHashesValue;bn.isHashesValue=phr;var mhr=vi.serviceTypes.isSystemCultureTag;bn.isSystemCultureTag=mhr;var ghr=vi.serviceTypes.memoizedRenderCallback;bn.memoizedRenderCallback=ghr;var vhr=vi.serviceTypes.noFormatPart;bn.noFormatPart=vhr;var hhr=vi.serviceTypes.notFormatString;bn.notFormatString=hhr;var Shr=vi.serviceTypes.notValueString;bn.notValueString=Shr;var yhr=vi.serviceTypes.numberEdit;bn.numberEdit=yhr;var Chr=vi.serviceTypes.otherEdit;bn.otherEdit=Chr;var _hr=vi.serviceTypes.previousFormatFailure;bn.previousFormatFailure=_hr;var Rhr=vi.serviceTypes.FormatLocKind;bn.FormatLocKind=Rhr;var Thr=vi.serviceTypes.formatLocKnownFormat;bn.formatLocKnownFormat=Thr;var bhr=vi.serviceTypes.formatLocIFormat;bn.formatLocIFormat=bhr;var Phr=vi.serviceTypes.renderCallback;bn.renderCallback=Phr;var Ehr=vi.serviceTypes.renderInfiniteWidth;bn.renderInfiniteWidth=Ehr;var Nhr=vi.serviceTypes.renderedValue;bn.renderedValue=Nhr;var Ahr=vi.serviceTypes.renderedValueToString;bn.renderedValueToString=Ahr;var Ohr=vi.serviceTypes.stringEdit;bn.stringEdit=Ohr;var khr=vi.serviceTypes.tooWide;bn.tooWide=khr});var H3=Y(Ev=>{_();Object.defineProperty(Ev,"__esModule",{value:!0});Ev.NumberShape=Ev.KnownFormat=Ev.DateOrder=Ev.CurrencyFormat=Ev.Calendar=void 0;var j3=et(),Fhr=j3.numfmt.Calendar;Ev.Calendar=Fhr;var Ihr=j3.numfmt.CurrencyFormat;Ev.CurrencyFormat=Ihr;var Mhr=j3.numfmt.DateOrder;Ev.DateOrder=Mhr;var whr=j3.numfmt.KnownFormat;Ev.KnownFormat=whr;var Dhr=j3.numfmt.NumberShape;Ev.NumberShape=Dhr});var MZ=Y(ts=>{_();Object.defineProperty(ts,"__esModule",{value:!0});ts.isKnownFormatDefined=ts.getSpecial=ts.getSingle=ts.getKnownFormat=ts.getColor=ts.englishXLSXKnownFormat=ts.buildSingle=ts.buildScientificFormat=ts.buildPercentFormat=ts.buildNumberFormat=ts.buildMMDDYYFormat=ts.buildFractionFormat=ts.buildCurrencyFormat=void 0;var vg=gm(),xhr=vg.knownFormat.buildCurrencyFormat;ts.buildCurrencyFormat=xhr;var Lhr=vg.knownFormat.buildFractionFormat;ts.buildFractionFormat=Lhr;var Bhr=vg.knownFormat.buildMMDDYYFormat;ts.buildMMDDYYFormat=Bhr;var qhr=vg.knownFormat.buildNumberFormat;ts.buildNumberFormat=qhr;var Uhr=vg.knownFormat.buildPercentFormat;ts.buildPercentFormat=Uhr;var Ghr=vg.knownFormat.buildScientificFormat;ts.buildScientificFormat=Ghr;var Khr=vg.knownFormat.buildSingle;ts.buildSingle=Khr;var Vhr=vg.knownFormat.englishXLSXKnownFormat;ts.englishXLSXKnownFormat=Vhr;var Whr=vg.knownFormat.getColor;ts.getColor=Whr;var jhr=vg.knownFormat.getKnownFormat;ts.getKnownFormat=jhr;var Hhr=vg.knownFormat.getSingle;ts.getSingle=Hhr;var Qhr=vg.knownFormat.getSpecial;ts.getSpecial=Qhr;var zhr=vg.knownFormat.isKnownFormatDefined;ts.isKnownFormatDefined=zhr});var Q3=Y(oO=>{_();Object.defineProperty(oO,"__esModule",{value:!0});oO.getRibbonFormat=oO.RibbonFormat=void 0;var aCe=gm(),Yhr=aCe.ribbonFormat.RibbonFormat;oO.RibbonFormat=Yhr;var Jhr=aCe.ribbonFormat.getRibbonFormat;oO.getRibbonFormat=Jhr});var wZ=Y(uO=>{_();Object.defineProperty(uO,"__esModule",{value:!0});uO.shouldInstallFormat=uO.parseEdit=void 0;var iCe=gm(),Xhr=iCe.edit.parseEdit;uO.parseEdit=Xhr;var Zhr=iCe.edit.shouldInstallFormat;uO.shouldInstallFormat=Zhr});var qU=Y(BU=>{_();Object.defineProperty(BU,"__esModule",{value:!0});BU.createNumberFormatter=void 0;var $hr=gm(),eSr=$hr.formatService.createNumberFormatter;BU.createNumberFormatter=eSr});var oCe=Y(vm=>{_();Object.defineProperty(vm,"__esModule",{value:!0});vm.toXLNumber=vm.renderFormat=vm.initUtilGlobals=vm.getValueEditOperKind=vm.getFormatString=vm.applyValueEdit=void 0;var sO=gm(),rSr=sO.util.applyValueEdit;vm.applyValueEdit=rSr;var nSr=sO.util.getFormatString;vm.getFormatString=nSr;var tSr=sO.util.getValueEditOperKind;vm.getValueEditOperKind=tSr;var aSr=sO.util.initUtilGlobals;vm.initUtilGlobals=aSr;var iSr=sO.util.renderFormat;vm.renderFormat=iSr;var oSr=sO.util.toXLNumber;vm.toXLNumber=oSr});var lCe=Y(Y3=>{_();Object.defineProperty(Y3,"__esModule",{value:!0});Y3.numfmt=void 0;var Ii=VP(Ll()),z3=VP(H3()),DZ=VP(MZ()),uCe=VP(Q3()),uSr=VP(wZ()),sSr=VP(qU()),xZ=VP(oCe());function sCe(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,n=new WeakMap;return(sCe=function(o){return o?n:r})(e)}function VP(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var n=sCe(r);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(u!=="default"&&Object.prototype.hasOwnProperty.call(e,u)){var t=o?Object.getOwnPropertyDescriptor(e,u):null;t&&(t.get||t.set)?Object.defineProperty(a,u,t):a[u]=e[u]}return a.default=e,n&&n.set(e,a),a}var LZ;Y3.numfmt=LZ;(function(e){e.FormatReasonKind=Ii.FormatReasonKind,e.ReasonKind=Ii.ReasonKind,e.notValueString=Ii.notValueString,e.notFormatString=Ii.notFormatString,e.noFormatPart=Ii.noFormatPart,e.tooWide=Ii.tooWide,e.aggregationError=Ii.aggregationError,e.dateOverflow=Ii.dateOverflow,e.fractionOverflow=Ii.fractionOverflow,e.previousFormatFailure=Ii.previousFormatFailure,e.FormatLocKind=Ii.FormatLocKind,e.formatLocKnownFormat=Ii.formatLocKnownFormat,e.formatLocIFormat=Ii.formatLocIFormat,e.FormatValueType=Ii.FormatValueType,e.BidiDate=Ii.BidiDate,e.CultureTag=Ii.CultureTag,e.FormatCurrency=Ii.FormatCurrency,e.NamedColor=Ii.NamedColor,e.Alignment=Ii.Alignment,e.GetTimeKind=Ii.GetTimeKind,e.Clip=Ii.Clip,e.FormattedUnitKind=Ii.FormattedUnitKind,e.formattedUnitGeneral=Ii.formattedUnitGeneral,e.formattedUnitString=Ii.formattedUnitString,e.formattedUnitBlank=Ii.formattedUnitBlank,e.formattedUnitFlexible=Ii.formattedUnitFlexible,e.formattedValue=Ii.formattedValue,e.renderedValue=Ii.renderedValue,e.hashesValue=Ii.hashesValue,e.isHashesValue=Ii.isHashesValue,e.renderCallback=Ii.renderCallback,e.memoizedRenderCallback=Ii.memoizedRenderCallback,e.renderInfiniteWidth=Ii.renderInfiniteWidth,e.renderedValueToString=Ii.renderedValueToString,e.EditKind=Ii.EditKind,e.formulaEdit=Ii.formulaEdit,e.stringEdit=Ii.stringEdit,e.numberEdit=Ii.numberEdit,e.otherEdit=Ii.otherEdit,e.NumberFormatSource=Ii.NumberFormatSource,e.createFormatGlobals=Ii.createFormatGlobals,e.evalFormatLocalsGrid=Ii.evalFormatLocalsGrid,e.KnownFormat=z3.KnownFormat,e.CurrencyFormat=z3.CurrencyFormat,e.DateOrder=z3.DateOrder,e.NumberShape=z3.NumberShape,e.Calendar=z3.Calendar,e.getKnownFormat=DZ.getKnownFormat,e.isKnownFormatDefined=DZ.isKnownFormatDefined,e.englishXLSXKnownFormat=DZ.englishXLSXKnownFormat,e.RibbonFormat=uCe.RibbonFormat,e.getRibbonFormat=uCe.getRibbonFormat,e.shouldInstallFormat=uSr.shouldInstallFormat,e.createNumberFormatter=sSr.createNumberFormatter,e.getValueEditOperKind=xZ.getValueEditOperKind,e.applyValueEdit=xZ.applyValueEdit,e.toXLNumber=xZ.toXLNumber})(LZ||(Y3.numfmt=LZ={}))});var Ic=Y(It=>{"use strict";_();Object.defineProperty(It,"__esModule",{value:!0});It.userDefinedFuncLoc=It.unsafeGridRange=It.structRefColumnLoc=It.sheetRows=It.sheetRangeIndexes=It.sheetRange=It.sheetIndex=It.sheetGridRange=It.sheetGridCube=It.sheetGridCell=It.sheetCols=It.originCell=It.nameScope=It.nameLoc=It.lexicalSourceUDF=It.lexicalSourceWSF=It.lexicalSourceRange=It.lexicalSourceName=It.lexicalSourceGrid=It.lexicalSourceCell=It.isSheetIndex=It.isSheetGridRange=It.isSheetGridCell=It.isGridCell=It.gridRange=It.gridCell=It.documentScope=It.documentLoc=It.allSheetsRange=It.NameSource=It.LexicalKind=void 0;var ou=et();It.LexicalKind=ou.location.LexicalKind;It.NameSource=ou.location.NameSource;It.allSheetsRange=ou.location.allSheetsRange;It.documentLoc=ou.location.documentLoc;It.documentScope=ou.location.documentScope;It.gridCell=ou.location.gridCell;It.gridRange=ou.location.gridRange;It.isGridCell=ou.location.isGridCell;It.isSheetGridCell=ou.location.isSheetGridCell;It.isSheetGridRange=ou.location.isSheetGridRange;It.isSheetIndex=ou.location.isSheetIndex;It.lexicalSourceCell=ou.location.lexicalSourceCell;It.lexicalSourceGrid=ou.location.lexicalSourceGrid;It.lexicalSourceName=ou.location.lexicalSourceName;It.lexicalSourceRange=ou.location.lexicalSourceRange;It.lexicalSourceWSF=ou.location.lexicalSourceWSF;It.lexicalSourceUDF=ou.location.lexicalSourceUDF;It.nameLoc=ou.location.nameLoc;It.nameScope=ou.location.nameScope;It.originCell=ou.location.originCell;It.sheetCols=ou.location.sheetCols;It.sheetGridCell=ou.location.sheetGridCell;It.sheetGridCube=ou.location.sheetGridCube;It.sheetGridRange=ou.location.sheetGridRange;It.sheetIndex=ou.location.sheetIndex;It.sheetRange=ou.location.sheetRange;It.sheetRangeIndexes=ou.location.sheetRangeIndexes;It.sheetRows=ou.location.sheetRows;It.structRefColumnLoc=ou.location.structRefColumnLoc;It.unsafeGridRange=ou.location.unsafeGridRange;It.userDefinedFuncLoc=ou.location.userDefinedFuncLoc});var cCe=Y(UR=>{"use strict";_();Object.defineProperty(UR,"__esModule",{value:!0});UR.RTree=UR.RTKind=UR.copyExcept=void 0;var BZ=Cn();UR.copyExcept=BZ.rTree.copyExcept;UR.RTKind=BZ.rTree.RTKind;UR.RTree=BZ.rTree.RTree});var _f=Y(ba=>{"use strict";_();Object.defineProperty(ba,"__esModule",{value:!0});ba.now=ba.mapFromArrayOfPairs=ba.singleton=ba.typedInstanceCreator=ba.makeStringCompareCI=ba.fastAbs=ba.fastMax=ba.fastMin=ba.pair=ba.filterOutNones=ba.isNone=ba.isDefined=ba.safeConcat=ba.safePush=ba.strEnumArray=ba.numEnumMap=ba.numEnumArray=ba.cloneStringMap=ba.makeStringMap=ba.identity=ba.staticAssertIsOptional=ba.staticAssertIs=ba.staticAssertSame=ba.staticAssertExtends=ba.makeNewtypeIso=void 0;var Qs=Cn();ba.makeNewtypeIso=Qs.core.makeNewtypeIso;ba.staticAssertExtends=Qs.core.staticAssertExtends;ba.staticAssertSame=Qs.core.staticAssertSame;ba.staticAssertIs=Qs.core.staticAssertIs;ba.staticAssertIsOptional=Qs.core.staticAssertIsOptional;ba.identity=Qs.core.identity;ba.makeStringMap=Qs.core.makeStringMap;ba.cloneStringMap=Qs.core.cloneStringMap;ba.numEnumArray=Qs.core.numEnumArray;ba.numEnumMap=Qs.core.numEnumMap;ba.strEnumArray=Qs.core.strEnumArray;ba.safePush=Qs.core.safePush;ba.safeConcat=Qs.core.safeConcat;ba.isDefined=Qs.core.isDefined;ba.isNone=Qs.core.isNone;ba.filterOutNones=Qs.core.filterOutNones;ba.pair=Qs.core.pair;ba.fastMin=Qs.core.fastMin;ba.fastMax=Qs.core.fastMax;ba.fastAbs=Qs.core.fastAbs;ba.makeStringCompareCI=Qs.core.makeStringCompareCI;ba.typedInstanceCreator=Qs.core.typedInstanceCreator;ba.singleton=Qs.core.singleton;ba.mapFromArrayOfPairs=Qs.core.mapFromArrayOfPairs;ba.now=Qs.core.now});var ao=Y(Ar=>{"use strict";_();Object.defineProperty(Ar,"__esModule",{value:!0});Ar.isSheetGridRangeEqual=Ar.isSheetGridRange=Ar.isSheetGridCellEqual=Ar.isSheetGridCell=Ar.isRichOper=Ar.isReadOperEqual=Ar.isRangeOper=Ar.isRangeOpNoMissing=Ar.isRangeOpClosed=Ar.isPrimitiveOper=Ar.isOperatorNode=Ar.isNumberOper=Ar.isNumberLiteralNode=Ar.isNameScopeEqual=Ar.isMissingOper=Ar.isMissingNode=Ar.isGridRangeEqual=Ar.isGridCellEqual=Ar.isGridCell=Ar.isErrorOper=Ar.isDocumentLocEqual=Ar.isCommaOpRefWellFormed=Ar.isCommaOpNoBadOrMissing=Ar.isCommaOpClosed=Ar.isBooleanOper=Ar.isBooleanLiteralNode=Ar.isBlankOper=Ar.isArrayOper=Ar.internal=Ar.gridRangesJoin=Ar.gridRangeSize=Ar.gridRangeJoinOpt=Ar.gridRangeJoin=Ar.gridRangeIsects=Ar.gridRangeIsect=Ar.gridRangeExcept=Ar.gridRangeCompare=Ar.gridRangeAnchor=Ar.gridCellRange=Ar.gridCellImplicitIsect=Ar.getWorksheetFuncId=Ar.getUserDefinedFuncName=Ar.getBoundName=Ar.getArguments=Ar.getArgType=Ar.forEachTileInRange=Ar.forEachCellInRange=Ar.createFailureErrorClass=Ar.ReasonKind=Ar.LangReasonKind=void 0;Ar.applyComparison=Ar.unavailable=Ar.shouldFieldRefBeBracketed=Ar.sheetGridRangeAnchor=Ar.notImplemented=Ar.normalizeCommaOpRef=Ar.isWriteOper=Ar.isWellFormed=Ar.isWSFNode=Ar.isValidArgsLength=Ar.isUnqualifiedNameNode=Ar.isStringOper=Ar.isSheetIndexEqual=Ar.isSheetIndex=void 0;var Mt=et();Ar.LangReasonKind=Mt.util.LangReasonKind;Ar.ReasonKind=Mt.util.ReasonKind;Ar.createFailureErrorClass=Mt.util.createFailureErrorClass;Ar.forEachCellInRange=Mt.util.forEachCellInRange;Ar.forEachTileInRange=Mt.util.forEachTileInRange;Ar.getArgType=Mt.util.getArgType;Ar.getArguments=Mt.util.getArguments;Ar.getBoundName=Mt.util.getBoundName;Ar.getUserDefinedFuncName=Mt.util.getUserDefinedFuncName;Ar.getWorksheetFuncId=Mt.util.getWorksheetFuncId;Ar.gridCellImplicitIsect=Mt.util.gridCellImplicitIsect;Ar.gridCellRange=Mt.util.gridCellRange;Ar.gridRangeAnchor=Mt.util.gridRangeAnchor;Ar.gridRangeCompare=Mt.util.gridRangeCompare;Ar.gridRangeExcept=Mt.util.gridRangeExcept;Ar.gridRangeIsect=Mt.util.gridRangeIsect;Ar.gridRangeIsects=Mt.util.gridRangeIsects;Ar.gridRangeJoin=Mt.util.gridRangeJoin;Ar.gridRangeJoinOpt=Mt.util.gridRangeJoinOpt;Ar.gridRangeSize=Mt.util.gridRangeSize;Ar.gridRangesJoin=Mt.util.gridRangesJoin;Ar.internal=Mt.util.internal;Ar.isArrayOper=Mt.util.isArrayOper;Ar.isBlankOper=Mt.util.isBlankOper;Ar.isBooleanLiteralNode=Mt.util.isBooleanLiteralNode;Ar.isBooleanOper=Mt.util.isBooleanOper;Ar.isCommaOpClosed=Mt.util.isCommaOpClosed;Ar.isCommaOpNoBadOrMissing=Mt.util.isCommaOpNoBadOrMissing;Ar.isCommaOpRefWellFormed=Mt.util.isCommaOpRefWellFormed;Ar.isDocumentLocEqual=Mt.util.isDocumentLocEqual;Ar.isErrorOper=Mt.util.isErrorOper;Ar.isGridCell=Mt.util.isGridCell;Ar.isGridCellEqual=Mt.util.isGridCellEqual;Ar.isGridRangeEqual=Mt.util.isGridRangeEqual;Ar.isMissingNode=Mt.util.isMissingNode;Ar.isMissingOper=Mt.util.isMissingOper;Ar.isNameScopeEqual=Mt.util.isNameScopeEqual;Ar.isNumberLiteralNode=Mt.util.isNumberLiteralNode;Ar.isNumberOper=Mt.util.isNumberOper;Ar.isOperatorNode=Mt.util.isOperatorNode;Ar.isPrimitiveOper=Mt.util.isPrimitiveOper;Ar.isRangeOpClosed=Mt.util.isRangeOpClosed;Ar.isRangeOpNoMissing=Mt.util.isRangeOpNoMissing;Ar.isRangeOper=Mt.util.isRangeOper;Ar.isReadOperEqual=Mt.util.isReadOperEqual;Ar.isRichOper=Mt.util.isRichOper;Ar.isSheetGridCell=Mt.util.isSheetGridCell;Ar.isSheetGridCellEqual=Mt.util.isSheetGridCellEqual;Ar.isSheetGridRange=Mt.util.isSheetGridRange;Ar.isSheetGridRangeEqual=Mt.util.isSheetGridRangeEqual;Ar.isSheetIndex=Mt.util.isSheetIndex;Ar.isSheetIndexEqual=Mt.util.isSheetIndexEqual;Ar.isStringOper=Mt.util.isStringOper;Ar.isUnqualifiedNameNode=Mt.util.isUnqualifiedNameNode;Ar.isValidArgsLength=Mt.util.isValidArgsLength;Ar.isWSFNode=Mt.util.isWSFNode;Ar.isWellFormed=Mt.util.isWellFormed;Ar.isWriteOper=Mt.util.isWriteOper;Ar.normalizeCommaOpRef=Mt.util.normalizeCommaOpRef;Ar.notImplemented=Mt.util.notImplemented;Ar.sheetGridRangeAnchor=Mt.util.sheetGridRangeAnchor;Ar.shouldFieldRefBeBracketed=Mt.util.shouldFieldRefBeBracketed;Ar.unavailable=Mt.util.unavailable;Ar.applyComparison=Mt.util.applyComparison});var UZ=Y(lO=>{"use strict";_();Object.defineProperty(lO,"__esModule",{value:!0});lO.makeGridRangeTable=lO.gridRangeDistance=void 0;var lSr=cCe(),dCe=_f(),qZ=ao();function fCe(e,r){var n=e.row,a=e.col,o=e.rows,u=e.cols,t=r.row,d=r.col,s=r.rows,c=r.cols,l=(0,dCe.fastAbs)(n-t+(o-s)*.5),f=(0,dCe.fastAbs)(a-d+(u-c)*.5);return l+f}lO.gridRangeDistance=fCe;function cSr(){return lSr.RTree.create(qZ.gridRangeJoin,qZ.gridRangeIsects,qZ.gridRangeCompare,fCe)}lO.makeGridRangeTable=cSr});var J3=Y(UU=>{"use strict";_();Object.defineProperty(UU,"__esModule",{value:!0});UU.RedBlackMapTree=void 0;var dSr=Cn();UU.RedBlackMapTree=dSr.rbMapTree.RedBlackMapTree});var zo=Y(sd=>{"use strict";_();Object.defineProperty(sd,"__esModule",{value:!0});sd.assertPositiveLength=sd.assertPositiveInteger=sd.assertInteger=sd.assertIndex=sd.assertNatural=sd.assertNever=sd.assertFalse=sd.assertTrue=sd.ulsLogger=void 0;var BC=Cn();sd.ulsLogger=BC.assertions.ulsLogger;sd.assertTrue=BC.assertions.assertTrue;sd.assertFalse=BC.assertions.assertFalse;sd.assertNever=BC.assertions.assertNever;sd.assertNatural=BC.assertions.assertNatural;sd.assertIndex=BC.assertions.assertIndex;sd.assertInteger=BC.assertions.assertInteger;sd.assertPositiveInteger=BC.assertions.assertPositiveInteger;sd.assertPositiveLength=BC.assertions.assertPositiveLength});var cO=Y(In=>{"use strict";_();Object.defineProperty(In,"__esModule",{value:!0});In.tooWide=In.stringEdit=In.renderedValueToString=In.renderedValue=In.renderInfiniteWidth=In.renderCallback=In.previousFormatFailure=In.otherEdit=In.numberEdit=In.notValueString=In.notFormatString=In.noFormatPart=In.memoizedRenderCallback=In.isSystemCultureTag=In.isHashesValue=In.isFormatCultureEqual=In.hashesValue=In.fractionOverflow=In.formulaEdit=In.formattedValue=In.formattedUnitString=In.formattedUnitGeneral=In.formattedUnitFlexible=In.formattedUnitBlank=In.evalFormatLocalsGrid=In.dateOverflow=In.createFormatGlobals=In.aggregationError=In.ReasonKind=In.NumberFormatSource=In.NamedColor=In.GetTimeKind=In.FormattedUnitKind=In.FormatValueType=In.FormatReasonKind=In.FormatCurrency=In.EditKind=In.CultureTag=In.Clip=In.BidiDate=In.Alignment=void 0;var xi=gm();In.Alignment=xi.serviceTypes.Alignment;In.BidiDate=xi.serviceTypes.BidiDate;In.Clip=xi.serviceTypes.Clip;In.CultureTag=xi.serviceTypes.CultureTag;In.EditKind=xi.serviceTypes.EditKind;In.FormatCurrency=xi.serviceTypes.FormatCurrency;In.FormatReasonKind=xi.serviceTypes.FormatReasonKind;In.FormatValueType=xi.serviceTypes.FormatValueType;In.FormattedUnitKind=xi.serviceTypes.FormattedUnitKind;In.GetTimeKind=xi.serviceTypes.GetTimeKind;In.NamedColor=xi.serviceTypes.NamedColor;In.NumberFormatSource=xi.serviceTypes.NumberFormatSource;In.ReasonKind=xi.serviceTypes.ReasonKind;In.aggregationError=xi.serviceTypes.aggregationError;In.createFormatGlobals=xi.serviceTypes.createFormatGlobals;In.dateOverflow=xi.serviceTypes.dateOverflow;In.evalFormatLocalsGrid=xi.serviceTypes.evalFormatLocalsGrid;In.formattedUnitBlank=xi.serviceTypes.formattedUnitBlank;In.formattedUnitFlexible=xi.serviceTypes.formattedUnitFlexible;In.formattedUnitGeneral=xi.serviceTypes.formattedUnitGeneral;In.formattedUnitString=xi.serviceTypes.formattedUnitString;In.formattedValue=xi.serviceTypes.formattedValue;In.formulaEdit=xi.serviceTypes.formulaEdit;In.fractionOverflow=xi.serviceTypes.fractionOverflow;In.hashesValue=xi.serviceTypes.hashesValue;In.isFormatCultureEqual=xi.serviceTypes.isFormatCultureEqual;In.isHashesValue=xi.serviceTypes.isHashesValue;In.isSystemCultureTag=xi.serviceTypes.isSystemCultureTag;In.memoizedRenderCallback=xi.serviceTypes.memoizedRenderCallback;In.noFormatPart=xi.serviceTypes.noFormatPart;In.notFormatString=xi.serviceTypes.notFormatString;In.notValueString=xi.serviceTypes.notValueString;In.numberEdit=xi.serviceTypes.numberEdit;In.otherEdit=xi.serviceTypes.otherEdit;In.previousFormatFailure=xi.serviceTypes.previousFormatFailure;In.renderCallback=xi.serviceTypes.renderCallback;In.renderInfiniteWidth=xi.serviceTypes.renderInfiniteWidth;In.renderedValue=xi.serviceTypes.renderedValue;In.renderedValueToString=xi.serviceTypes.renderedValueToString;In.stringEdit=xi.serviceTypes.stringEdit;In.tooWide=xi.serviceTypes.tooWide});var Bd=Y(Kp=>{"use strict";_();Object.defineProperty(Kp,"__esModule",{value:!0});Kp.successUndefined=Kp.success=Kp.javaScriptError=Kp.isSuccess=Kp.failure=Kp.ResultKind=Kp.ReasonKind=void 0;var WP=Cn();Kp.ReasonKind=WP.result.ReasonKind;Kp.ResultKind=WP.result.ResultKind;Kp.failure=WP.result.failure;Kp.isSuccess=WP.result.isSuccess;Kp.javaScriptError=WP.result.javaScriptError;Kp.success=WP.result.success;Kp.successUndefined=WP.result.successUndefined});var GU=Y(io=>{"use strict";_();Object.defineProperty(io,"__esModule",{value:!0});io.resolvedUserDefinedFunc=io.resolvedStructRef=io.resolvedNever=io.resolvedName=io.resolvedLocalName=io.resolvedDottedName=io.resolvedCellRef=io.resolveLocalsGrid=io.noOriginSheet=io.invalidStructRef=io.invalidQualifier=io.invalidCellRef=io.emptyIntersection=io.ResolvedKind=io.ResolveReasonKind=io.InvalidStructRefReason=io.InvalidQualifierReason=io.InvalidCellRefReason=void 0;var Rf=et();io.InvalidCellRefReason=Rf.resolveServiceTypes.InvalidCellRefReason;io.InvalidQualifierReason=Rf.resolveServiceTypes.InvalidQualifierReason;io.InvalidStructRefReason=Rf.resolveServiceTypes.InvalidStructRefReason;io.ResolveReasonKind=Rf.resolveServiceTypes.ResolveReasonKind;io.ResolvedKind=Rf.resolveServiceTypes.ResolvedKind;io.emptyIntersection=Rf.resolveServiceTypes.emptyIntersection;io.invalidCellRef=Rf.resolveServiceTypes.invalidCellRef;io.invalidQualifier=Rf.resolveServiceTypes.invalidQualifier;io.invalidStructRef=Rf.resolveServiceTypes.invalidStructRef;io.noOriginSheet=Rf.resolveServiceTypes.noOriginSheet;io.resolveLocalsGrid=Rf.resolveServiceTypes.resolveLocalsGrid;io.resolvedCellRef=Rf.resolveServiceTypes.resolvedCellRef;io.resolvedDottedName=Rf.resolveServiceTypes.resolvedDottedName;io.resolvedLocalName=Rf.resolveServiceTypes.resolvedLocalName;io.resolvedName=Rf.resolveServiceTypes.resolvedName;io.resolvedNever=Rf.resolveServiceTypes.resolvedNever;io.resolvedStructRef=Rf.resolveServiceTypes.resolvedStructRef;io.resolvedUserDefinedFunc=Rf.resolveServiceTypes.resolvedUserDefinedFunc});var hg=Y(Gn=>{"use strict";_();Object.defineProperty(Gn,"__esModule",{value:!0});Gn.runtimePositionFirstOrderFunc=Gn.runtimePositionFormulaRoot=Gn.runtimePositionLambdaParam=Gn.runtimePositionLambdaRoot=Gn.runtimePositionLetVal=Gn.breaked=Gn.paused=Gn.limitExceeded=Gn.previousNameFailure=Gn.previousFailure=Gn.cellCycle=Gn.nameCycle=Gn.evalLocals=Gn.evalGlobals=Gn.userDefinedFunc=Gn.stopped=Gn.cellFormula=Gn.cellWellFormedFormula=Gn.pendingValue=Gn.finalValue=Gn.illFormedFormula=Gn.LimitKind=Gn.StepAction=Gn.RuntimePositionKind=Gn.stackValue=Gn.Interrupt=Gn.CellKind=Gn.interval=Gn.compileLocalsName=Gn.compileLocalsGrid=Gn.createCompileGlobals=Gn.ReasonKind=void 0;var KU=br(),pCe=zo(),KZ=_f(),mCe=ao(),fSr=Ic(),pSr=cO(),X3=Bd(),mSr=GU(),GZ;(function(e){e.Timeout="Timeout",e.Breakpoint="Breakpoint",e.Stopped="Stopped",e.NameCycle="NameCycle",e.CellCycle="CellCycle",e.PreviousFailure="PreviousFailure",e.PreviousNameFailure="PreviousNameFailure",e.LimitExceeded="LimitExceeded",e.IllFormedFormula="IllFormedFormula"})(GZ||(GZ={}));Gn.ReasonKind=KU.__assign(KU.__assign(KU.__assign(KU.__assign({},mCe.ReasonKind),GZ),pSr.FormatReasonKind),mSr.ResolveReasonKind);function gSr(e){return{config:e}}Gn.createCompileGlobals=gSr;function vSr(e,r,n){return{config:n??void 0,lexicalKind:e,originGridCell:(0,X3.success)(r),allowUnqualifiedCell:!0,emitStepInfo:!1}}Gn.compileLocalsGrid=vSr;function hSr(e,r){return{config:r??void 0,lexicalKind:fSr.LexicalKind.NameManager,originGridCell:(0,X3.success)(e),allowUnqualifiedCell:!1,emitStepInfo:!1}}Gn.compileLocalsName=hSr;Gn.interval=(0,KZ.typedInstanceCreator)()(function(e,r){return(0,pCe.assertPositiveInteger)("calc.runtime.interval: end",r),(0,pCe.assertIndex)("calc.runtime.interval: start",e,r),{start:e,end:r}});var VZ;(function(e){e.FinalValue="FinalValue",e.PendingValue="PendingValue"})(VZ=Gn.CellKind||(Gn.CellKind={}));var gCe;(function(e){e[e.Continue=1]="Continue",e[e.Stop=2]="Stop"})(gCe=Gn.Interrupt||(Gn.Interrupt={}));Gn.stackValue=(0,KZ.typedInstanceCreator)()(function(e,r){return{label:e,value:r}});var dO;(function(e){e.LetVar="LetVar",e.LambdaRoot="LambdaRoot",e.LambdaParam="LambdaParam",e.FormulaRoot="FormulaRoot",e.FirstOrderFunc="FirstOrderFunc"})(dO=Gn.RuntimePositionKind||(Gn.RuntimePositionKind={}));var SSr;(function(e){e.Continue="Continue",e.Break="Break"})(SSr=Gn.StepAction||(Gn.StepAction={}));var ySr;(function(e){e[e.CellChain=0]="CellChain",e[e.NameChain=1]="NameChain",e[e.LambdaCalls=2]="LambdaCalls",e[e.LambdaDepth=3]="LambdaDepth"})(ySr=Gn.LimitKind||(Gn.LimitKind={}));function CSr(e,r,n){return{kind:Gn.ReasonKind.IllFormedFormula,message:e,mode:r,diagnostics:n}}Gn.illFormedFormula=CSr;function _Sr(e){return{kind:VZ.FinalValue,oper:e}}Gn.finalValue=_Sr;function RSr(e){return{kind:VZ.PendingValue,anchor:e}}Gn.pendingValue=RSr;function TSr(e,r){return{source:e,formula:r}}Gn.cellWellFormedFormula=TSr;function bSr(e,r){return{source:e,formula:r}}Gn.cellFormula=bSr;Gn.stopped={kind:Gn.ReasonKind.Stopped};function PSr(e,r){return{arity:e,func:r}}Gn.userDefinedFunc=PSr;function ESr(e,r,n,a,o,u,t,d,s,c,l,f,p,m,v,h,S,y,C,E,I,F,w,B,k,x,G,H,L,D){return{config:e,getDocumentLoc:r,getSheetIndex:n,getSheetName:a,getSheetRangeIndexes:o,getNameLoc:u,getUserDefinedFuncLoc:t,getCellValue:d,getCellValues:s,getWorksheetFunc:c,getUserDefinedFunc:l,getNameFormula:f,getCellFormula:p,getUsedRange:m,interruptToken:[gCe.Continue],tryGetHiddenRows:v,tryGetHiddenCols:h,isInFilterMode:S,getKnownFormat:y,getIformat:C,getFormatString:E,getRandom:I,getTime:F,schedulerConfig:L??{},limits:D??{},setCellValue:w,setCellValues:B,setCellFailure:k,getContainingTable:x,getStructRefColumn:G,getStructRefSpecialRef:H,getIntersectingTables:function(){return(0,X3.failure)((0,mCe.notImplemented)(["getIntersectingTables"]))}}}Gn.evalGlobals=ESr;Gn.evalLocals=(0,KZ.typedInstanceCreator)()(function(e,r,n,a,o,u,t,d,s,c,l){return{lexicalSource:e,originGridCell:r,originSheet:n,calcingArray:a,reflectionGridCell:o,reflectionSheet:u,implicitIntersect:t,allowUnqualifiedCell:d,wrapCellReferences:s,followHyperlinks:c,contextNames:l}});function NSr(e){return{kind:Gn.ReasonKind.NameCycle,names:e}}Gn.nameCycle=NSr;function ASr(e){return{kind:Gn.ReasonKind.CellCycle,cells:e}}Gn.cellCycle=ASr;function OSr(e){return{kind:Gn.ReasonKind.PreviousFailure,range:e}}Gn.previousFailure=OSr;function kSr(e){return{kind:Gn.ReasonKind.PreviousNameFailure,name:e}}Gn.previousNameFailure=kSr;function FSr(e){return{kind:Gn.ReasonKind.LimitExceeded,limit:e}}Gn.limitExceeded=FSr;function ISr(e){return{kind:X3.ResultKind.Paused,reason:Gn.ReasonKind.Timeout,resume:e}}Gn.paused=ISr;function MSr(e){return{kind:X3.ResultKind.Breaked,resume:e}}Gn.breaked=MSr;function wSr(e,r){return{kind:dO.LetVar,varNamePosition:e,varBinderPosition:r}}Gn.runtimePositionLetVal=wSr;function DSr(e,r,n){return{kind:dO.LambdaRoot,lambdaNodePosition:e,head:r,args:n}}Gn.runtimePositionLambdaRoot=DSr;function xSr(e,r){return{kind:dO.LambdaParam,paramNodePosition:e,paramNamePosition:r}}Gn.runtimePositionLambdaParam=xSr;Gn.runtimePositionFormulaRoot={kind:dO.FormulaRoot};Gn.runtimePositionFirstOrderFunc={kind:dO.FirstOrderFunc}});var D1=Y(hm=>{"use strict";_();Object.defineProperty(hm,"__esModule",{value:!0});hm.recordNameCycle=hm.appendVisitedName=hm.emptyVisitedNames=hm.recordCellCycle=hm.appendVisitedCell=hm.emptyVisitedCells=void 0;var vCe=J3(),hCe=hg(),LSr=zo();function SCe(e,r,n){return e===void 0?r===void 0?0:-1:r===void 0?1:n(e,r)}function VU(e,r){return e<r?-1:e===r?0:1}function yCe(e,r){return typeof e=="string"?typeof r!="string"?1:VU(e,r):typeof r=="string"||e<r?-1:e===r?0:1}function CCe(e,r){var n;return(n=VU(e.name,r.name))!==0?n:SCe(e.path,r.path,VU)}function BSr(e,r){var n;return(n=e.range.col-r.range.col)!==0||(n=e.range.row-r.range.row)!==0||(n=yCe(e.sheet.index,r.sheet.index))!==0?n:CCe(e.sheet.document,r.sheet.document)}function qSr(e,r){var n;return(n=VU(e.name,r.name))!==0||(n=SCe(e.scope.index,r.scope.index,yCe))!==0?n:CCe(e.scope.document,r.scope.document)}function _Ce(e,r){return{current:e,map:r}}hm.emptyVisitedCells=_Ce(void 0,vCe.RedBlackMapTree.create(BSr));function USr(e,r){return(0,LSr.assertTrue)("calc.runtime.appendVisitedCell",r.previous===e.current),_Ce(r,e.map.setValue(r.cell,r))}hm.appendVisitedCell=USr;function GSr(e,r){for(var n=[],a=(0,hCe.cellCycle)(n),o=r;n.push(o.cell),o.cycle=a,o!==e;o=o.previous);return n.reverse(),a}hm.recordCellCycle=GSr;function RCe(e,r){return{current:e,map:r}}hm.emptyVisitedNames=RCe(void 0,vCe.RedBlackMapTree.create(qSr));function KSr(e,r){var n={name:r,previous:e.current};return RCe(n,e.map.setValue(r,n))}hm.appendVisitedName=KSr;function VSr(e,r){for(var n=[],a=r;n.push(a.name),a!==e;a=a.previous);return n.reverse(),(0,hCe.nameCycle)(n)}hm.recordNameCycle=VSr});var Nv=Y(Oo=>{"use strict";_();Object.defineProperty(Oo,"__esModule",{value:!0});Oo.strictArray2D=Oo.singletonArray2D=Oo.rowArray2D=Oo.jaggedArray=Oo.constantArray2D=Oo.constantArray=Oo.colArray2D=Oo.broadcastArray2D=Oo.broadcastArray=Oo.array2DToJaggedArray=Oo.array2DForall2=Oo.array2DForall=Oo.StrictSparseArray2D=Oo.StrictArray2D=Oo.NonstrictSparseArray2D=Oo.NonstrictArray2D=void 0;var Vp=Cn();Oo.NonstrictArray2D=Vp.arrayUtils.NonstrictArray2D;Oo.NonstrictSparseArray2D=Vp.arrayUtils.NonstrictSparseArray2D;Oo.StrictArray2D=Vp.arrayUtils.StrictArray2D;Oo.StrictSparseArray2D=Vp.arrayUtils.StrictSparseArray2D;Oo.array2DForall=Vp.arrayUtils.array2DForall;Oo.array2DForall2=Vp.arrayUtils.array2DForall2;Oo.array2DToJaggedArray=Vp.arrayUtils.array2DToJaggedArray;Oo.broadcastArray=Vp.arrayUtils.broadcastArray;Oo.broadcastArray2D=Vp.arrayUtils.broadcastArray2D;Oo.colArray2D=Vp.arrayUtils.colArray2D;Oo.constantArray=Vp.arrayUtils.constantArray;Oo.constantArray2D=Vp.arrayUtils.constantArray2D;Oo.jaggedArray=Vp.arrayUtils.jaggedArray;Oo.rowArray2D=Vp.arrayUtils.rowArray2D;Oo.singletonArray2D=Vp.arrayUtils.singletonArray2D;Oo.strictArray2D=Vp.arrayUtils.strictArray2D});var _o=Y(qa=>{"use strict";_();Object.defineProperty(qa,"__esModule",{value:!0});qa.calcErrorOper=qa.valueErrorOper=qa.trueOper=qa.stringOper=qa.refErrorOper=qa.rangeSeqOper=qa.range3DOper=qa.precedents=qa.numErrorOper=qa.nullErrorOper=qa.nameErrorOper=qa.naErrorOper=qa.missingOper=qa.gettingDataErrorOper=qa.fieldErrorOper=qa.falseOper=qa.errorOper=qa.div0ErrorOper=qa.cellStringLimit=qa.booleanOper=qa.blankOper=qa.arrayOper=qa.PrecsBound=qa.ErrorType=void 0;var vl=et();qa.ErrorType=vl.value.ErrorType;qa.PrecsBound=vl.value.PrecsBound;qa.arrayOper=vl.value.arrayOper;qa.blankOper=vl.value.blankOper;qa.booleanOper=vl.value.booleanOper;qa.cellStringLimit=vl.value.cellStringLimit;qa.div0ErrorOper=vl.value.div0ErrorOper;qa.errorOper=vl.value.errorOper;qa.falseOper=vl.value.falseOper;qa.fieldErrorOper=vl.value.fieldErrorOper;qa.gettingDataErrorOper=vl.value.gettingDataErrorOper;qa.missingOper=vl.value.missingOper;qa.naErrorOper=vl.value.naErrorOper;qa.nameErrorOper=vl.value.nameErrorOper;qa.nullErrorOper=vl.value.nullErrorOper;qa.numErrorOper=vl.value.numErrorOper;qa.precedents=vl.value.precedents;qa.range3DOper=vl.value.range3DOper;qa.rangeSeqOper=vl.value.rangeSeqOper;qa.refErrorOper=vl.value.refErrorOper;qa.stringOper=vl.value.stringOper;qa.trueOper=vl.value.trueOper;qa.valueErrorOper=vl.value.valueErrorOper;qa.calcErrorOper=vl.value.calcErrorOper});var WZ=Y(ld=>{"use strict";_();Object.defineProperty(ld,"__esModule",{value:!0});ld.breakTransition=ld.nextTransition=ld.nextOnSuccessReceiver=ld.callMachineTransition=ld.TransitionKind=ld.MachineRuntime=ld.MachineCycle=ld.VoidMachine=ld.AllMachine=void 0;var qC=Cn();ld.AllMachine=qC.machine.AllMachine;ld.VoidMachine=qC.machine.VoidMachine;ld.MachineCycle=qC.machine.MachineCycle;ld.MachineRuntime=qC.machine.MachineRuntime;ld.TransitionKind=qC.machine.TransitionKind;ld.callMachineTransition=qC.machine.callMachineTransition;ld.nextOnSuccessReceiver=qC.machine.nextOnSuccessReceiver;ld.nextTransition=qC.machine.nextTransition;ld.breakTransition=qC.machine.breakTransition});var Bl=Y(Av=>{"use strict";_();Object.defineProperty(Av,"__esModule",{value:!0});Av.functionType=Av.SpecialPrecs=Av.SignatureType=Av.OperKind=Av.FunctionFlags=void 0;var Z3=et();Av.FunctionFlags=Z3.types.FunctionFlags;Av.OperKind=Z3.types.OperKind;Av.SignatureType=Z3.types.SignatureType;Av.SpecialPrecs=Z3.types.SpecialPrecs;Av.functionType=Z3.types.functionType});var cd=Y(sc=>{"use strict";_();Object.defineProperty(sc,"__esModule",{value:!0});sc.refToVal=sc.ArrayMachine=sc.ThenMachine=sc.isMachineCall=sc.machineCall=sc.MachineCallKind=sc.readOperType=sc.singleReadOperType=void 0;var WSr=br(),jZ=_o(),jSr=zo(),WU=WZ(),jP=ao(),GR=Bd(),Sg=Bl();WSr.__exportStar(WZ(),sc);sc.singleReadOperType=Sg.OperKind.Number|Sg.OperKind.String|Sg.OperKind.Boolean|Sg.OperKind.Error|Sg.OperKind.Blank|Sg.OperKind.Rich;sc.readOperType=sc.singleReadOperType|Sg.OperKind.Array;var HZ;(function(e){e.MachineCall="MachineCall"})(HZ=sc.MachineCallKind||(sc.MachineCallKind={}));function HSr(e){return{kind:HZ.MachineCall,machine:e}}sc.machineCall=HSr;function jU(e){return e.kind===HZ.MachineCall}sc.isMachineCall=jU;var QSr=function(){function e(r,n,a){this.context=r,this.f1=n,this.f2=a,this.runStatus=!1,this.oper1=void 0,this.oper2=void 0}return e.prototype.next=function(){var r;try{if(this.oper1===void 0){var n=this.f1();if(jU(n))return(0,WU.callMachineTransition)(n.machine,this);this.oper1=n}if(this.oper2===void 0){var a=this.f2(this.oper1);if(jU(a))return(0,WU.callMachineTransition)(a.machine,this);this.oper2=a}return(0,GR.success)(this.oper2)}catch(o){return(r=this.context.handleEvaluationError(o))!==null&&r!==void 0?r:(0,GR.failure)((0,GR.javaScriptError)(o))}},e.prototype.receiveResult=function(r){return(0,GR.isSuccess)(r)?(this.oper1===void 0?this.oper1=r.value:this.oper2===void 0&&(this.oper2=r.value),this.next()):r},e}();sc.ThenMachine=QSr;var zSr=function(){function e(r,n,a,o){this.context=r,this.rows=n,this.cols=a,this.func=o,this.runStatus=!1,this.toDeref=void 0,this.row=[],this.opers=[]}return e.prototype.next=function(){var r;try{if(this.toDeref!==void 0){var n=this.context.coerceOper(TCe(this.context,this.toDeref,!0),sc.readOperType);(0,jSr.assertTrue)("calc.runtime.ArrayMachine.next",!(0,jP.isMissingOper)(n)&&!(0,jP.isRangeOper)(n)),(0,jP.isArrayOper)(n)&&(n=n.opers[0][0]),this.row.push(n),this.row.length===this.cols&&(this.opers.push(this.row),this.row=[]),this.toDeref=void 0}if(this.opers.length>=this.rows)return(0,GR.success)((0,jZ.arrayOper)(this.rows,this.cols,this.opers));var a=this.func(this.opers.length,this.row.length);return jU(a)?(0,WU.callMachineTransition)(a.machine,this):(this.toDeref=a,WU.nextTransition)}catch(o){return(r=this.context.handleEvaluationError(o))!==null&&r!==void 0?r:(0,GR.failure)((0,GR.javaScriptError)(o))}},e.prototype.receiveResult=function(r){return(0,GR.isSuccess)(r)?(this.toDeref=r.value,this.next()):r},e}();sc.ArrayMachine=zSr;function TCe(e,r,n){if(!(0,jP.isRangeOper)(r))return r;if(!(0,jP.isSheetIndex)(r.sheets))return jZ.valueErrorOper;if(!n)return r.ranges.length===1&&(0,jP.isGridCell)(r.ranges[0])?e.dereferenceOper(r,Sg.SignatureType.All&~Sg.OperKind.Range):e.dereferenceOper(r,Sg.OperKind.Array);var a=e.dereferenceOper(r,Sg.SignatureType.All&~(Sg.OperKind.Range|Sg.OperKind.Array));return(0,jP.isArrayOper)(a)?jZ.naErrorOper:a}sc.refToVal=TCe});var $3=Y(_t=>{"use strict";_();Object.defineProperty(_t,"__esModule",{value:!0});_t.ulsLogger=_t.operatorIdToName=_t.localeInfo=_t.isNumeral=_t.isIdentStart=_t.isIdentContinue=_t.getOrdinal=_t.getNumberShape=_t.getEnglishWorksheetFuncIdToName=_t.getEnglishLocaleInfo=_t.englishWorksheetFuncIdToName=_t.englishSysTimeFormat=_t.englishSysDateFormat=_t.englishSpecialRefNames=_t.englishPictureSpecial=_t.englishPictureSingle=_t.englishPictureDbnum=_t.englishPictureColor=_t.englishOperatorIdToName=_t.englishErrorTypeToName=_t.englishErrorNames=_t.createWorksheetFuncNameCallbacks=_t.calcConfig=_t.TraceLevel=_t.PictureSpecial=_t.PictureSingle=_t.PictureDbnum=_t.PictureColor=_t.NulLogger=_t.LogCategory=_t.LCID=_t.Country=void 0;var Yo=et();_t.Country=Yo.config.Country;_t.LCID=Yo.config.LCID;_t.LogCategory=Yo.config.LogCategory;_t.NulLogger=Yo.config.NulLogger;_t.PictureColor=Yo.config.PictureColor;_t.PictureDbnum=Yo.config.PictureDbnum;_t.PictureSingle=Yo.config.PictureSingle;_t.PictureSpecial=Yo.config.PictureSpecial;_t.TraceLevel=Yo.config.TraceLevel;_t.calcConfig=Yo.config.calcConfig;_t.createWorksheetFuncNameCallbacks=Yo.config.createWorksheetFuncNameCallbacks;_t.englishErrorNames=Yo.config.englishErrorNames;_t.englishErrorTypeToName=Yo.config.englishErrorTypeToName;_t.englishOperatorIdToName=Yo.config.englishOperatorIdToName;_t.englishPictureColor=Yo.config.englishPictureColor;_t.englishPictureDbnum=Yo.config.englishPictureDbnum;_t.englishPictureSingle=Yo.config.englishPictureSingle;_t.englishPictureSpecial=Yo.config.englishPictureSpecial;_t.englishSpecialRefNames=Yo.config.englishSpecialRefNames;_t.englishSysDateFormat=Yo.config.englishSysDateFormat;_t.englishSysTimeFormat=Yo.config.englishSysTimeFormat;_t.englishWorksheetFuncIdToName=Yo.config.englishWorksheetFuncIdToName;_t.getEnglishLocaleInfo=Yo.config.getEnglishLocaleInfo;_t.getEnglishWorksheetFuncIdToName=Yo.config.getEnglishWorksheetFuncIdToName;_t.getNumberShape=Yo.config.getNumberShape;_t.getOrdinal=Yo.config.getOrdinal;_t.isIdentContinue=Yo.config.isIdentContinue;_t.isIdentStart=Yo.config.isIdentStart;_t.isNumeral=Yo.config.isNumeral;_t.localeInfo=Yo.config.localeInfo;_t.operatorIdToName=Yo.config.operatorIdToName;_t.ulsLogger=Yo.config.ulsLogger});var qd=Y(Mc=>{"use strict";_();Object.defineProperty(Mc,"__esModule",{value:!0});Mc.arrayLift=Mc.makeStrict=Mc.gridRangeAnchorHash=Mc.broadcastWriteOper=Mc.isEmptyStringOper=Mc.emptyStringOper=Mc.traceErrorOper=Mc.writeOperType=Mc.singleWriteOperType=void 0;var KR=Nv(),QU=_o(),ew=ao(),YSr=Ic(),HU=_f(),bCe=cd(),O0=Bl(),JSr=zo(),PCe=$3();Mc.singleWriteOperType=O0.OperKind.Number|O0.OperKind.String|O0.OperKind.Boolean|O0.OperKind.Error|O0.OperKind.Rich;Mc.writeOperType=Mc.singleWriteOperType|O0.OperKind.Array;function XSr(e,r,n){var a="".concat(e,": generated Excel error, type ").concat(r,"; ").concat(n);JSr.ulsLogger.ULS.traceTag(596120270,PCe.LogCategory.msoulscat_ES_EWAJS,PCe.TraceLevel.Verbose,a)}Mc.traceErrorOper=XSr;Mc.emptyStringOper=(0,QU.stringOper)("");function ZSr(e){return(0,ew.isStringOper)(e)&&e.value===""}Mc.isEmptyStringOper=ZSr;function $Sr(e,r,n){var a=(0,ew.isArrayOper)(n)?(0,KR.broadcastArray)(n.rows,n.cols,e,r,n.opers,QU.naErrorOper):(0,KR.constantArray)(e,r,n);return(0,QU.arrayOper)(e,r,a)}Mc.broadcastWriteOper=$Sr;function e1r(e){return YSr.sheetCols*e.row+e.col}Mc.gridRangeAnchorHash=e1r;function r1r(e){var r=function(a){return a&~(O0.OperKind.Array|O0.OperKind.Range)};return(0,O0.functionType)(e.minArgs,e.maxArgs,e.headTypes.map(r),e.restTypes.map(r),e.tailTypes.map(r),e.returnType,e.staticPrecs,e.flags)}Mc.makeStrict=r1r;function n1r(e,r,n,a,o){switch(a.kind){case O0.OperKind.Missing:case O0.OperKind.Blank:return(0,KR.constantArray2D)(r,n,e.zero);case O0.OperKind.Array:return o&O0.OperKind.Array?(0,KR.constantArray2D)(r,n,a):(0,KR.broadcastArray2D)(r,n,new KR.StrictArray2D(a.rows,a.cols,a.opers),QU.naErrorOper);case O0.OperKind.Range:return(0,KR.constantArray2D)(r,n,a);default:return(0,KR.constantArray2D)(r,n,a)}}function t1r(e,r,n,a){for(var o=0,u=0,t=0;t<a.length;t+=1){var d=a[t];(0,ew.isArrayOper)(d)&&!((0,ew.getArgType)(r,t,a.length)&O0.OperKind.Array)?(o=(0,HU.fastMax)(o,d.rows),u=(0,HU.fastMax)(u,d.cols)):(o=(0,HU.fastMax)(o,1),u=(0,HU.fastMax)(u,1))}var s=a.map(function(c,l,f){return n1r(e.mathpack,o,u,c,(0,ew.getArgType)(r,l,f.length))});return(0,bCe.machineCall)(new bCe.ArrayMachine(e,o,u,function(c,l){return n(s.map(function(f){return f.get(c,l)}))}))}Mc.arrayLift=t1r});var MCe=Y(Ud=>{"use strict";_();Object.defineProperty(Ud,"__esModule",{value:!0});Ud.IterativeRecalcState=Ud.cellRead=Ud.cellWrite=Ud.rangeWrite=Ud.TransactionLogMessageKind=Ud.TransactionLog=Ud.WriteResultKind=void 0;var ECe=br(),NCe=Ic(),a1r=UZ(),OCe=_f(),zU=D1(),ACe=qd(),i1r=ao(),x1;(function(e){e[e.Next=0]="Next",e[e.Done=1]="Done",e[e.CellWriteLimitReached=2]="CellWriteLimitReached",e[e.CellCycle=3]="CellCycle"})(x1=Ud.WriteResultKind||(Ud.WriteResultKind={}));var o1r=function(){function e(r){this.state=r}return e.prototype.forEachMeets=function(r,n){var a=this.state[r.sheet.index];a!==void 0&&a.forEachMeets(r.range,n)},e.prototype.setValue=function(r,n){var a,o,u=(o=this.state[r.sheet.index])!==null&&o!==void 0?o:(0,a1r.makeGridRangeTable)();return new e(ECe.__assign(ECe.__assign({},this.state),(a={},a[r.sheet.index]=u.setValue(r.range,n),a)))},e.empty=function(){return new e({})},e}(),kCe=function(){function e(){this.log=[]}return e.prototype.extract=function(){return this.log},e.prototype.lookup=function(r){var n=[];return this.current!==void 0&&(this.current.previousVersions.forEachMeets(r,function(a,o){return n.push(o),!0}),e.meets(r,this.current.range)&&n.push(this.current)),n},Object.defineProperty(e.prototype,"current",{get:function(){return this.log[this.log.length-1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.log.length},enumerable:!1,configurable:!0}),e.prototype.insert=function(r,n){if(this.current===void 0){this.log.push({version:0,range:r,message:n,previousVersions:o1r.empty()});return}var a={version:this.current.version+1,range:r,message:n,previousVersions:this.current.previousVersions.setValue(this.current.range,this.current)};this.log.push(a)},e.prototype.rollBack=function(r){if(this.current===void 0)return!1;var n=void 0;return this.current.previousVersions.forEachMeets(r,function(a,o){return(n===void 0||o.version<n.version)&&(n=o),!0}),n===void 0?e.meets(r,this.current.range)?(this.truncLog(this.log.length-1),!0):!1:(this.truncLog(n.version),!0)},e.prototype.truncLog=function(r){this.log.length=(0,OCe.fastMax)(r,0)},e.meets=function(r,n){return r.sheet.index!==n.sheet.index?!1:(0,i1r.gridRangeIsects)(r.range,n.range)},e}();Ud.TransactionLog=kCe;var fO;(function(e){e[e.RangeWrite=0]="RangeWrite",e[e.CellWrite=1]="CellWrite",e[e.CellRead=2]="CellRead"})(fO=Ud.TransactionLogMessageKind||(Ud.TransactionLogMessageKind={}));function FCe(e,r){return{kind:fO.RangeWrite,range:e,opers:r}}Ud.rangeWrite=FCe;function ICe(e,r){return{kind:fO.CellWrite,cell:e,oper:r}}Ud.cellWrite=ICe;Ud.cellRead={kind:fO.CellRead};var u1r={kind:x1.CellWriteLimitReached},s1r=function(){function e(r){this.transactionLog=new kCe,this.anchorVisitCounts={},this.workStack=[[r,zU.emptyVisitedCells]]}return e.prototype.registerVisibleCells=function(r){for(var n=0,a=r;n<a.length;n++){var o=a[n];this.ensureNeedsVisit(o)}return{kind:x1.Next,address:this.address}},e.prototype.registerDynamicDependency=function(r){for(var n=0,a=r;n<a.length;n++){var o=a[n],u={cell:o,previous:this.visitedCells.current,cycle:void 0},t=this.visitedCells.map.getValue(o);if(t!==void 0)return(0,zU.recordCellCycle)(t,this.visitedCells.current),{kind:x1.CellCycle,cycle:t.cycle};this.workStack.push([o,(0,zU.appendVisitedCell)(this.visitedCells,u)]),this.ensureNeedsVisit(o)}return{kind:x1.Next,address:this.address}},e.prototype.registerRead=function(){return this.transactionLog.lookup(this.address).length===0&&this.transactionLog.insert(this.address,Ud.cellRead),this.next()},e.prototype.writeRange=function(r){var n=this.address,a=n.sheet,o=n.range,u=o.row,t=o.col,d=(0,NCe.sheetGridRange)(a,(0,NCe.gridRange)(u,t,r.length,r[0].length));return this.write(d,FCe(d,r))},e.prototype.writeCell=function(r){return this.write(this.address,ICe(this.address,r))},Object.defineProperty(e.prototype,"address",{get:function(){return this.workStack[this.workStack.length-1][0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visitedCells",{get:function(){return this.workStack[this.workStack.length-1][1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"grid",{get:function(){return this.transactionLog},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"remainingWork",{get:function(){return this.workStack},enumerable:!1,configurable:!0}),e.prototype.incrementCellWriteCount=function(r){var n=this.ensureNeedsVisit(r);if(n[1]+=1,n[1]>10)return u1r},e.prototype.ensureNeedsVisit=function(r){var n,a=this.anchorVisitCounts[r.sheet.index];return a===void 0&&(a=this.anchorVisitCounts[r.sheet.index]={}),a[(0,ACe.gridRangeAnchorHash)(r.range)]=(n=a[(0,ACe.gridRangeAnchorHash)(r.range)])!==null&&n!==void 0?n:[r,0]},e.prototype.write=function(r,n){if(this.transactionLog.rollBack(r))return{kind:x1.Next,address:this.address};var a=this.incrementCellWriteCount(this.address);return a!==void 0?a:(this.transactionLog.insert(r,n),this.next())},e.prototype.next=function(){for(;this.workStack.length>1;)if(this.workStack.pop(),this.transactionLog.lookup(this.address).length===0)return{kind:x1.Next,address:this.address};if(this.transactionLog.lookup(this.address).length===0)return{kind:x1.Next,address:this.address};var r=this.unevaluatedVisibleRanges();if((0,OCe.safePush)(this.workStack,r),r.length>0)return{kind:x1.Next,address:this.address};for(var n=[],a=[],o=0,u=this.transactionLog.extract();o<u.length;o++){var t=u[o];switch(t.message.kind){case fO.CellWrite:n.push([t.message.cell,t.message.oper]);break;case fO.RangeWrite:a.push([t.range,t.message.opers]);break}}return{kind:x1.Done,cellWrites:n,rangeWrites:a}},e.prototype.unevaluatedVisibleRanges=function(){var r=[];for(var n in this.anchorVisitCounts)for(var a in this.anchorVisitCounts[n]){var o=this.anchorVisitCounts[n][a][0];this.transactionLog.lookup(o).length===0&&r.push([o,zU.emptyVisitedCells])}return r},e}();Ud.IterativeRecalcState=s1r});var zs=Y(bi=>{"use strict";_();Object.defineProperty(bi,"__esModule",{value:!0});bi.CellEvaluationResultKind=bi.ES5IterableStackFrame=bi.ES5IterableStackValue=bi.stackFrameList=bi.stackMapList=bi.emptyStackEnv=bi.LazyOper=bi.evalLocalsSlice=bi.evalLocalsFirstOrderFunc=bi.evalLocalsLambda=bi.evalLocalsName=bi.evalLocalsGrid=bi.evalUsage=bi.bottomEvalPrecedents=bi.handleEvaluationError=bi.throwEvaluationError=bi.EvaluationError=bi.unevaluated=bi.RuntimeInternalReasonKind=void 0;var xCe=br(),UC=hg(),zZ=ao(),wCe=Ic(),l1r=zo(),DCe=_o(),YU=cd(),c1r=Bl(),yg=Bd(),d1r=J3(),YZ;(function(e){e.Unevaluated="Unevaluated"})(YZ=bi.RuntimeInternalReasonKind||(bi.RuntimeInternalReasonKind={}));function f1r(e){return e.length===0&&(0,l1r.assertFalse)("calc.runtime.unevaluated: expected nonempty array"),{kind:YZ.Unevaluated,anchors:e}}bi.unevaluated=f1r;bi.EvaluationError=(0,zZ.createFailureErrorClass)("EvaluationError");function LCe(e){throw new bi.EvaluationError(e)}bi.throwEvaluationError=LCe;var p1r=function(){function e(r){this.machine=r,this.runStatus=!1}return e.prototype.next=function(){return(0,YU.callMachineTransition)(this.machine,this)},e.prototype.receiveResult=function(r){if(!(0,yg.isSuccess)(r))return r;switch(r.value.kind){case QZ.ReadFailure:return r.value.failure;case QZ.WroteFailure:return(0,yg.failure)((0,UC.previousFailure)(r.value.source.range))}return yg.successUndefined},e}();function m1r(e,r,n){var a;switch(n.kind){case YZ.Unevaluated:{if(r.map.getCount()+1>((a=e.globals.limits.maxCellChain)!==null&&a!==void 0?a:1/0))return(0,yg.failure)((0,UC.limitExceeded)(UC.LimitKind.CellChain));var o=n.anchors.map(function(u){return new p1r(e.createCellEvaluationMachine(e,void 0,r,u))});return(0,YU.callMachineTransition)(new YU.AllMachine(o),(0,YU.nextOnSuccessReceiver)())}default:return(0,yg.failure)(n)}}bi.handleEvaluationError=m1r;function g1r(){return(0,DCe.precedents)([],[],[],c1r.SpecialPrecs.None,DCe.PrecsBound.Lower)}bi.bottomEvalPrecedents=g1r;function v1r(e,r){return{lambdaCalls:e,lambdaDepth:r}}bi.evalUsage=v1r;function h1r(e){var r=(0,zZ.sheetGridRangeAnchor)(e.range),n=(0,yg.success)(r.range),a=(0,yg.success)(r.sheet);return(0,UC.evalLocals)(e,n,a,e.kind===wCe.LexicalKind.Range,n,a,e.kind===wCe.LexicalKind.Cell,!0,!1,(0,yg.success)(!1),void 0)}bi.evalLocalsGrid=h1r;function S1r(e,r){var n=e.name.scope,a;if(n.index!==void 0)a=(0,yg.success)(n);else{var o=r.originSheet;if(!(0,yg.isSuccess)(o))return LCe(o.reason);a=(0,zZ.isDocumentLocEqual)(o.value.document,n.document)?o:(0,yg.success)(n)}var u=r.originGridCell;return(0,UC.evalLocals)(e,u,a,r.calcingArray,u,a,!1,!1,!0,(0,yg.success)(!1),void 0)}bi.evalLocalsName=S1r;function y1r(e,r){return(0,UC.evalLocals)(e.lexicalSource,e.originGridCell,e.originSheet,r.calcingArray,r.reflectionGridCell,r.reflectionSheet,r.implicitIntersect,e.allowUnqualifiedCell,e.wrapCellReferences,(0,yg.success)(!1),void 0)}bi.evalLocalsLambda=y1r;function C1r(e,r){var n=r.originGridCell,a=r.originSheet,o=r.calcingArray,u=r.reflectionGridCell,t=r.reflectionSheet,d=r.implicitIntersect,s=r.allowUnqualifiedCell,c=r.wrapCellReferences,l=r.followHyperlinks;return(0,UC.evalLocals)(e,n,a,o,u,t,d,s,c,l,void 0)}bi.evalLocalsFirstOrderFunc=C1r;function _1r(e){var r=e.lexicalSource,n=e.originGridCell,a=e.originSheet,o=e.calcingArray,u=e.reflectionGridCell,t=e.reflectionSheet,d=e.implicitIntersect,s=e.allowUnqualifiedCell,c=e.wrapCellReferences,l=e.followHyperlinks,f=e.contextNames;return(0,UC.evalLocals)(r,n,a,o,u,t,d,s,c,l,f)}bi.evalLocalsSlice=_1r;var BCe=function(){function e(r){this.fallback=r}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value===void 0?this.fallback():this._value},set:function(n){this._value=n},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"valueOrUndefined",{get:function(){return this._value},enumerable:!1,configurable:!0}),e}();bi.LazyOper=BCe;bi.emptyStackEnv=d1r.RedBlackMapTree.create(function(e,r){return e-r});function R1r(e,r,n){return{labels:e,numPushed:r,next:n}}bi.stackMapList=R1r;function T1r(e,r,n,a,o){var u;return{stackDepth:1+((u=o==null?void 0:o.stackDepth)!==null&&u!==void 0?u:0),lexicalSource:e,position:r,localValues:new qCe(n,a),caller:o}}bi.stackFrameList=T1r;var qCe=function(){function e(r,n){this.stackEnv=r,this.stackMap=n}return e.prototype.iterator=function(){var r,n,a,o,u,t;return xCe.__generator(this,function(d){switch(d.label){case 0:r=this.stackEnv.getCount()-1,n=this.stackMap,d.label=1;case 1:if(n===void 0)return[3,6];a=n.numPushed-1,d.label=2;case 2:return a>=0?(o=n.labels[a],u=this.stackEnv.getValue(r--),o===void 0||u===void 0?[3,4]:(t=u instanceof BCe?u.valueOrUndefined:u,t===void 0?[3,4]:[4,(0,UC.stackValue)(o,t)])):[3,5];case 3:d.sent(),d.label=4;case 4:return a--,[3,2];case 5:return n=n.next,[3,1];case 6:return[2]}})},e}();bi.ES5IterableStackValue=qCe;var b1r=function(){function e(r){this.leafFrame=r}return e.prototype.iterator=function(){var r;return xCe.__generator(this,function(n){switch(n.label){case 0:r=this.leafFrame,n.label=1;case 1:return r===void 0?[3,4]:[4,r];case 2:n.sent(),n.label=3;case 3:return r=r.caller,[3,1];case 4:return[2]}})},e}();bi.ES5IterableStackFrame=b1r;var QZ;(function(e){e[e.ReadFailure=0]="ReadFailure",e[e.ReadOper=1]="ReadOper",e[e.WroteFailure=2]="WroteFailure",e[e.WroteOper=3]="WroteOper"})(QZ=bi.CellEvaluationResultKind||(bi.CellEvaluationResultKind={}))});var HP=Y(Tf=>{"use strict";_();Object.defineProperty(Tf,"__esModule",{value:!0});Tf.setFeatureGateDictionaryGetter=Tf.overrideTypedFeatureGates=Tf.isTypedChangeGateEnabled=Tf.getTypedFeatureGate=Tf.getFeatures=Tf.isFeatureEnabled=Tf.initFeatureConfiguration=Tf.FeatureName=void 0;var pO=Cn();Tf.FeatureName=pO.featureConfiguration.FeatureName;Tf.initFeatureConfiguration=pO.featureConfiguration.initFeatureConfiguration;Tf.isFeatureEnabled=pO.featureConfiguration.isFeatureEnabled;Tf.getFeatures=pO.featureConfiguration.getFeatures;Tf.getTypedFeatureGate=pO.featureConfiguration.getTypedFeatureGate;Tf.isTypedChangeGateEnabled=pO.featureConfiguration.isTypedChangeGateEnabled;var UCe=Ql();Object.defineProperty(Tf,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return UCe.overrideTypedFeatureGates}});Object.defineProperty(Tf,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return UCe.setFeatureGateDictionaryGetter}})});var XU=Y(JU=>{"use strict";_();Object.defineProperty(JU,"__esModule",{value:!0});JU.coerceOper=void 0;var P1r=qd(),E1r=zs(),Kd=Bl(),Gd=_o(),N1r=cO(),rw=ao(),A1r=Bd(),O1r=qd(),k1r=zo(),F1r=HP();function GCe(e,r){return r&Kd.OperKind.Number?e.zero:r&Kd.OperKind.String?O1r.emptyStringOper:r&Kd.OperKind.Boolean?Gd.falseOper:Gd.valueErrorOper}function KCe(e,r,n){var a=e.globals.config,o=a.localeInfo,u=a.mathpack;if(n&r.kind)return r;if((0,rw.isNumberOper)(r)){if(n&Kd.OperKind.String){var t=20;return(0,Gd.stringOper)(u.formatGeneral(o,r,t))}return n&Kd.OperKind.Boolean?(0,Gd.booleanOper)(u.cond(r)!==0):n&Kd.OperKind.Array?(0,Gd.arrayOper)(1,1,[[r]]):Gd.valueErrorOper}if((0,rw.isStringOper)(r)){if(n&Kd.OperKind.Number){if(r.value.length===0||r.value.length>255)return Gd.valueErrorOper;var d=e.numberFormatter.parseGeneral(r.value,!1,!0,N1r.GetTimeKind.NonVolatile);return(0,A1r.isSuccess)(d)||(0,E1r.throwEvaluationError)(d.reason),d.value!==void 0?d.value.value:Gd.valueErrorOper}if(n&Kd.OperKind.Boolean){if(o.stringCompareCI(r.value,o.trueName)===0)return Gd.trueOper;if(o.stringCompareCI(r.value,o.falseName)===0)return Gd.falseOper;if(!(0,F1r.isTypedChangeGateEnabled)("Microsoft.Office.Excel.CoerceStringToArray"))return Gd.valueErrorOper}return n&Kd.OperKind.Array?(0,Gd.arrayOper)(1,1,[[r]]):Gd.valueErrorOper}if((0,rw.isBooleanOper)(r))return n&Kd.OperKind.Number?r.value?u.one:u.zero:n&Kd.OperKind.String?(0,Gd.stringOper)(r.value?o.trueName:o.falseName):n&Kd.OperKind.Array?(0,Gd.arrayOper)(1,1,[[r]]):Gd.valueErrorOper;switch(r.kind){case Kd.OperKind.Error:return r;case Kd.OperKind.Missing:return n&Kd.OperKind.Blank?Gd.blankOper:GCe(u,n);case Kd.OperKind.Blank:return GCe(u,n);case Kd.OperKind.Rich:return KCe(e,r.getFallback(),n);case Kd.OperKind.Range:case Kd.OperKind.Array:return Gd.valueErrorOper;default:return(0,k1r.assertNever)("calc.runtime.coerceOper",r)}}function I1r(e,r,n){var a=KCe(e,r,n);return(0,rw.isErrorOper)(a)&&!(0,rw.isErrorOper)(r)&&(0,P1r.traceErrorOper)("calc.runtime.coerceOper",a.type,"kind = ".concat(r.kind)),a}JU.coerceOper=I1r});var GC=Y(L1=>{"use strict";_();Object.defineProperty(L1,"__esModule",{value:!0});L1.kindAnonymizers=L1.anonymizeMagnitude=L1.anonymizeFormulaString=L1.anonymize=void 0;var ZU=Cn();L1.anonymize=ZU.anonymizer.anonymize;L1.anonymizeFormulaString=ZU.anonymizer.anonymizeFormulaString;L1.anonymizeMagnitude=ZU.anonymizer.anonymizeMagnitude;L1.kindAnonymizers=ZU.anonymizer.kindAnonymizers});var nw=Y($U=>{"use strict";_();Object.defineProperty($U,"__esModule",{value:!0});$U.Pledge=void 0;var M1r=Cn();$U.Pledge=M1r.pledge.Pledge});var oS=Y(Ma=>{"use strict";_();var JZ,XZ;Object.defineProperty(Ma,"__esModule",{value:!0});Ma.transformBottomUp=Ma.isOperTerm=Ma.postStepTerm=Ma.callMachineTerm=Ma.callFirstOrderFuncTerm=Ma.callLambdaTerm=Ma.callNameTerm=Ma.noopTerm=Ma.conditionalTerm=Ma.readStackTerm=Ma.structRefTerm=Ma.cellRefTerm=Ma.udfTerm=Ma.nameTerm=Ma.appTerm=Ma.letTerm=Ma.lambdaTerm=Ma.arrayTerm=Ma.isOperatorName=Ma.worksheetFunctionNameToId=Ma.worksheetFunctionIdToName=Ma.operatorNameToId=Ma.operatorIdToName=Ma.TermKind=void 0;var ZZ=br(),eG=_f(),tw=zo(),Ov=nw(),as;(function(e){e[e.Array=-2147483648]="Array",e[e.Lambda=-2147483647]="Lambda",e[e.Let=-2147483646]="Let",e[e.App=-2147483645]="App",e[e.Name=-2147483644]="Name",e[e.Udf=-2147483643]="Udf",e[e.CellRef=-2147483642]="CellRef",e[e.ReadStack=-2147483641]="ReadStack",e[e.Conditional=-2147483640]="Conditional",e[e.StructRef=-2147483639]="StructRef",e[e.Noop=-2147483638]="Noop",e[e.CallLambda=-2147483637]="CallLambda",e[e.CallName=-2147483636]="CallName",e[e.CallFirstOrderFunc=-2147483635]="CallFirstOrderFunc",e[e.CallMachine=-2147483634]="CallMachine",e[e.PostStep=-2147483633]="PostStep"})(as=Ma.TermKind||(Ma.TermKind={}));Ma.operatorIdToName=(JZ=(0,eG.makeNewtypeIso)(eG.identity,eG.identity),JZ.wrap),Ma.operatorNameToId=JZ.unwrap;Ma.worksheetFunctionIdToName=(XZ=(0,eG.makeNewtypeIso)(function(e){return-e},function(e){return-e}),XZ.wrap),Ma.worksheetFunctionNameToId=XZ.unwrap;function w1r(e){return e>0}Ma.isOperatorName=w1r;function Wp(e,r){var n={kind:e,data:void 0,children:void 0,position:r};return n}function VCe(e,r,n,a){var o=Wp(as.Array,a);return o.children=n,o.data={rows:e,cols:r},o}Ma.arrayTerm=VCe;function WCe(e,r,n,a,o,u,t){(0,tw.assertTrue)("calc.runtime.lambdaTerm",u.length===o.length+1),(0,tw.assertTrue)("calc.runtime.lambdaTerm",n.length===r),(0,tw.assertTrue)("calc.runtime.lambdaTerm",a.length===r);var d=Wp(as.Lambda,t);return d.children=u,d.data={maxArity:r,minArity:e,paramNodeLabels:n,paramNameLabels:a,defIdxs:o},d}Ma.lambdaTerm=WCe;function jCe(e,r,n,a,o){(0,tw.assertTrue)("calc.runtime.letTerm",e.length===n.length);var u=Wp(as.Let,o);return u.children=ZZ.__spreadArray(ZZ.__spreadArray([],e,!0),[a],!1),u.data={rec:r,varLabels:n},u}Ma.letTerm=jCe;function HCe(e,r,n,a,o){var u=Wp(as.App,o);return u.children=a,u.data={funName:e,funType:r,isFormulaRoot:n},u}Ma.appTerm=HCe;function QCe(e,r,n,a,o){var u=Wp(as.Name,o);return u.data={name:e,qualifier:r,source:n},u.children=a,u}Ma.nameTerm=QCe;function zCe(e,r,n,a){var o=Wp(as.Udf,a);return o.data={name:e,qualifier:r},o.children=n,o}Ma.udfTerm=zCe;function D1r(e,r,n){var a=Wp(as.CellRef,n);return a.data={ref:e,qualifier:r},a}Ma.cellRefTerm=D1r;function x1r(e,r){var n=Wp(as.StructRef,r);return n.data=e,n}Ma.structRefTerm=x1r;function L1r(e,r){var n=Wp(as.ReadStack,r);return n.data=e,n}Ma.readStackTerm=L1r;function YCe(e,r,n,a,o,u){var t=Wp(as.Conditional,u);return t.children=ZZ.__spreadArray([a],o,!0),t.data={funName:e,funType:r,isFormulaRoot:n},t}Ma.conditionalTerm=YCe;function JCe(e,r){var n=Wp(as.Noop,r);return n.children=e,n}Ma.noopTerm=JCe;function B1r(e,r,n){var a=Wp(as.CallName,n);return a.children=r,a.data={loc:e},a}Ma.callNameTerm=B1r;function q1r(e,r,n,a,o){var u=Wp(as.CallLambda,void 0);return u.children=o,u.data={capturedLocals:e,capturedStackEnv:r,capturedStackMap:n,caller:a},u}Ma.callLambdaTerm=q1r;function U1r(e,r,n){var a=Wp(as.CallFirstOrderFunc,void 0);return a.children=n,a.data={source:e,caller:r},a}Ma.callFirstOrderFuncTerm=U1r;function G1r(e,r){var n=Wp(as.CallMachine,r);return n.data={machine:e},n}Ma.callMachineTerm=G1r;Ma.postStepTerm=Wp(as.PostStep,void 0);function XCe(e){return e.kind>0}Ma.isOperTerm=XCe;function K1r(e,r){function n(o){if(XCe(o))return Ov.Pledge.resolve(o);switch(o.kind){case as.Let:return Ov.Pledge.all(o.children.map(a)).bind(function(u){var t=u.slice(0,u.length-1);return jCe(t,o.data.rec,o.data.varLabels,u[u.length-1],o.position)});case as.App:return Ov.Pledge.all(o.children.map(a)).bind(function(u){return HCe(o.data.funName,o.data.funType,o.data.isFormulaRoot,u,o.position)});case as.Conditional:return Ov.Pledge.all(o.children.map(a)).bind(function(u){var t=u[0],d=u.slice(1);return YCe(o.data.funName,o.data.funType,o.data.isFormulaRoot,t,d,o.position)});case as.Lambda:return Ov.Pledge.all(o.children.map(a)).bind(function(u){return WCe(o.data.minArity,o.data.maxArity,o.data.paramNodeLabels,o.data.paramNameLabels,o.data.defIdxs,u,o.position)});case as.Array:return Ov.Pledge.all(o.children.map(function(u){return Ov.Pledge.all(u.map(a))})).bind(function(u){return VCe(o.data.rows,o.data.cols,u,o.position)});case as.Name:return(o.children===void 0?Ov.Pledge.resolve(void 0):a(o.children)).bind(function(u){return QCe(o.data.name,o.data.qualifier,o.data.source,u,o.position)});case as.Udf:return(o.children===void 0?Ov.Pledge.resolve(void 0):a(o.children)).bind(function(u){return zCe(o.data.name,o.data.qualifier,u,o.position)});case as.CellRef:case as.StructRef:case as.ReadStack:return Ov.Pledge.resolve(o);case as.Noop:return a(o.children).bind(function(u){return JCe(u,o.position)});default:return(0,tw.assertNever)("calc.runtime.transformBottomUp",o)}}function a(o){return Ov.Pledge.resolve(o).bind(n).bind(r)}return Ov.Pledge.settleOrThrow(a(e))}Ma.transformBottomUp=K1r});var mO=Y(Sr=>{"use strict";_();Object.defineProperty(Sr,"__esModule",{value:!0});Sr.operatorNode=Sr.nameNode=Sr.missingRef=Sr.localNameUseAnnotation=Sr.localNameDeclAnnotation=Sr.literalNode=Sr.letVar=Sr.letNode=Sr.lambdaParam=Sr.lambdaNode=Sr.indexedArg=Sr.identQualifier=Sr.identNamePart=Sr.headNamePart=Sr.formulaSpan=Sr.formulaRootAnnotation=Sr.formula=Sr.flattenNameParts=Sr.flattenLetArgs=Sr.flattenLambdaArgs=Sr.fieldRefNode=Sr.fieldRefNamePart=Sr.fieldRef=Sr.errorQualifier=Sr.documentQualifier=Sr.commaOpRef=Sr.columnRef=Sr.cellRefSingle=Sr.cellRefRow=Sr.cellRefRange=Sr.cellRefNode=Sr.cellRefNamePart=Sr.cellRefError=Sr.cellRefCol=Sr.cellRefBad=Sr.badRef=Sr.badQualifier=Sr.arrayNode=Sr.appNode=Sr.appHeadNameAnnotation=Sr.StructRefKind=Sr.SpecialRefId=Sr.RefStyle=Sr.QualifierKind=Sr.PosKind=Sr.NodeKind=Sr.NamePartKind=Sr.CellRefKind=Sr.BadType=Sr.AnnotationKind=void 0;Sr.missingNode=Sr.identNode=Sr.varNode=Sr.getDepthUpperBound=Sr.wsfNode=Sr.thisRowOpRef=Sr.structRefNode=Sr.structRef=Sr.specialRef=Sr.sheetRangeQualifier=Sr.sheetQualifier=Sr.relativeQualifier=Sr.rangeOpRef=Sr.pos=Sr.parenNode=Sr.paramNode=Sr.paramName=Sr.paramDefault=void 0;var mt=et();Sr.AnnotationKind=mt.formulaModule.AnnotationKind;Sr.BadType=mt.formulaModule.BadType;Sr.CellRefKind=mt.formulaModule.CellRefKind;Sr.NamePartKind=mt.formulaModule.NamePartKind;Sr.NodeKind=mt.formulaModule.NodeKind;Sr.PosKind=mt.formulaModule.PosKind;Sr.QualifierKind=mt.formulaModule.QualifierKind;Sr.RefStyle=mt.formulaModule.RefStyle;Sr.SpecialRefId=mt.formulaModule.SpecialRefId;Sr.StructRefKind=mt.formulaModule.StructRefKind;Sr.appHeadNameAnnotation=mt.formulaModule.appHeadNameAnnotation;Sr.appNode=mt.formulaModule.appNode;Sr.arrayNode=mt.formulaModule.arrayNode;Sr.badQualifier=mt.formulaModule.badQualifier;Sr.badRef=mt.formulaModule.badRef;Sr.cellRefBad=mt.formulaModule.cellRefBad;Sr.cellRefCol=mt.formulaModule.cellRefCol;Sr.cellRefError=mt.formulaModule.cellRefError;Sr.cellRefNamePart=mt.formulaModule.cellRefNamePart;Sr.cellRefNode=mt.formulaModule.cellRefNode;Sr.cellRefRange=mt.formulaModule.cellRefRange;Sr.cellRefRow=mt.formulaModule.cellRefRow;Sr.cellRefSingle=mt.formulaModule.cellRefSingle;Sr.columnRef=mt.formulaModule.columnRef;Sr.commaOpRef=mt.formulaModule.commaOpRef;Sr.documentQualifier=mt.formulaModule.documentQualifier;Sr.errorQualifier=mt.formulaModule.errorQualifier;Sr.fieldRef=mt.formulaModule.fieldRef;Sr.fieldRefNamePart=mt.formulaModule.fieldRefNamePart;Sr.fieldRefNode=mt.formulaModule.fieldRefNode;Sr.flattenLambdaArgs=mt.formulaModule.flattenLambdaArgs;Sr.flattenLetArgs=mt.formulaModule.flattenLetArgs;Sr.flattenNameParts=mt.formulaModule.flattenNameParts;Sr.formula=mt.formulaModule.formula;Sr.formulaRootAnnotation=mt.formulaModule.formulaRootAnnotation;Sr.formulaSpan=mt.formulaModule.formulaSpan;Sr.headNamePart=mt.formulaModule.headNamePart;Sr.identNamePart=mt.formulaModule.identNamePart;Sr.identQualifier=mt.formulaModule.identQualifier;Sr.indexedArg=mt.formulaModule.indexedArg;Sr.lambdaNode=mt.formulaModule.lambdaNode;Sr.lambdaParam=mt.formulaModule.lambdaParam;Sr.letNode=mt.formulaModule.letNode;Sr.letVar=mt.formulaModule.letVar;Sr.literalNode=mt.formulaModule.literalNode;Sr.localNameDeclAnnotation=mt.formulaModule.localNameDeclAnnotation;Sr.localNameUseAnnotation=mt.formulaModule.localNameUseAnnotation;Sr.missingRef=mt.formulaModule.missingRef;Sr.nameNode=mt.formulaModule.nameNode;Sr.operatorNode=mt.formulaModule.operatorNode;Sr.paramDefault=mt.formulaModule.paramDefault;Sr.paramName=mt.formulaModule.paramName;Sr.paramNode=mt.formulaModule.paramNode;Sr.parenNode=mt.formulaModule.parenNode;Sr.pos=mt.formulaModule.pos;Sr.rangeOpRef=mt.formulaModule.rangeOpRef;Sr.relativeQualifier=mt.formulaModule.relativeQualifier;Sr.sheetQualifier=mt.formulaModule.sheetQualifier;Sr.sheetRangeQualifier=mt.formulaModule.sheetRangeQualifier;Sr.specialRef=mt.formulaModule.specialRef;Sr.structRef=mt.formulaModule.structRef;Sr.structRefNode=mt.formulaModule.structRefNode;Sr.thisRowOpRef=mt.formulaModule.thisRowOpRef;Sr.wsfNode=mt.formulaModule.wsfNode;Sr.getDepthUpperBound=mt.formulaModule.getDepthUpperBound;Sr.varNode=mt.formulaModule.varNode;Sr.identNode=mt.formulaModule.identNode;Sr.missingNode=mt.formulaModule.missingNode});var Sm=Y(bf=>{"use strict";_();Object.defineProperty(bf,"__esModule",{value:!0});bf.unknownFunctionType=bf.operatorStrings=bf.higherOrderFunctionType=bf.getWorksheetFuncType=bf.getWorksheetFuncEnglishName=bf.getOperatorType=bf.WorksheetFuncId=bf.OperatorId=void 0;var VR=et();bf.OperatorId=VR.signature.OperatorId;bf.WorksheetFuncId=VR.signature.WorksheetFuncId;bf.getOperatorType=VR.signature.getOperatorType;bf.getWorksheetFuncEnglishName=VR.signature.getWorksheetFuncEnglishName;bf.getWorksheetFuncType=VR.signature.getWorksheetFuncType;bf.higherOrderFunctionType=VR.signature.higherOrderFunctionType;bf.operatorStrings=VR.signature.operatorStrings;bf.unknownFunctionType=VR.signature.unknownFunctionType});var $Z=Y(Xt=>{"use strict";_();Object.defineProperty(Xt,"__esModule",{value:!0});Xt.zipVisitor=Xt.voidVisitor=Xt.visitWSFNode=Xt.visitQualifier=Xt.visitOperatorNode=Xt.visitFormulaNode=Xt.visitCellRef=Xt.visitAppHeadNode=Xt.reduceTopDown_Pledge=Xt.reducePledge=Xt.reduceBottomUp_Recursive=Xt.reduceBottomUp_Pledge=Xt.reduceBottomUp_MaxDepth=Xt.reduceBottomUp_CPS=Xt.reduceBottomUp=Xt.identityVisitor=Xt.depthVisitor=Xt.constVisitor=Xt.composeVisitor=Xt.bindVisitor=Xt.binaryVisitor=Xt.ZipVisitor=Xt.PledgeReducer=Xt.IdentityVisitor=Xt.DelegatingVisitor=Xt.ConstVisitor=Xt.ComposeVisitor=Xt.BinaryVisitor=void 0;var is=et();Xt.BinaryVisitor=is.visitor.BinaryVisitor;Xt.ComposeVisitor=is.visitor.ComposeVisitor;Xt.ConstVisitor=is.visitor.ConstVisitor;Xt.DelegatingVisitor=is.visitor.DelegatingVisitor;Xt.IdentityVisitor=is.visitor.IdentityVisitor;Xt.PledgeReducer=is.visitor.PledgeReducer;Xt.ZipVisitor=is.visitor.ZipVisitor;Xt.binaryVisitor=is.visitor.binaryVisitor;Xt.bindVisitor=is.visitor.bindVisitor;Xt.composeVisitor=is.visitor.composeVisitor;Xt.constVisitor=is.visitor.constVisitor;Xt.depthVisitor=is.visitor.depthVisitor;Xt.identityVisitor=is.visitor.identityVisitor;Xt.reduceBottomUp=is.visitor.reduceBottomUp;Xt.reduceBottomUp_CPS=is.visitor.reduceBottomUp_CPS;Xt.reduceBottomUp_MaxDepth=is.visitor.reduceBottomUp_MaxDepth;Xt.reduceBottomUp_Pledge=is.visitor.reduceBottomUp_Pledge;Xt.reduceBottomUp_Recursive=is.visitor.reduceBottomUp_Recursive;Xt.reducePledge=is.visitor.reducePledge;Xt.reduceTopDown_Pledge=is.visitor.reduceTopDown_Pledge;Xt.visitAppHeadNode=is.visitor.visitAppHeadNode;Xt.visitCellRef=is.visitor.visitCellRef;Xt.visitFormulaNode=is.visitor.visitFormulaNode;Xt.visitOperatorNode=is.visitor.visitOperatorNode;Xt.visitQualifier=is.visitor.visitQualifier;Xt.visitWSFNode=is.visitor.visitWSFNode;Xt.voidVisitor=is.visitor.voidVisitor;Xt.zipVisitor=is.visitor.zipVisitor});var tG=Y(jR=>{"use strict";_();var rG;Object.defineProperty(jR,"__esModule",{value:!0});jR.createCompiler=jR.compiledFormulaTerm=jR.compiledFormula=void 0;var KC=br(),V1r=GC(),k0=zo(),W1r=oS(),oo=oS(),j1r=hg(),$Ce=qd(),Pf=mO(),VC=ao(),Eu=Sm(),H1r=J3(),e$=_o(),nG=Bd(),WR=$Z(),Q1r=_f(),Ys=nw(),ZCe=Ic(),e_e=(0,VC.createFailureErrorClass)("CompileError"),r$=(0,$Ce.makeStrict)((0,Eu.getWorksheetFuncType)(Eu.WorksheetFuncId.IF)),z1r=(0,$Ce.makeStrict)((0,Eu.getWorksheetFuncType)(Eu.WorksheetFuncId.CHOOSE));function Y1r(e){return(0,oo.isOperTerm)(e)&&(0,VC.isWriteOper)(e)}var J1r=function(){function e(r){var n=this;this.context=r,this.visitFormulaNode=function(a){return(0,WR.visitFormulaNode)(n,a)},this.lazyVisitFormulaNode=function(a){return Ys.Pledge.resolve(a).bind(n.visitFormulaNode)}}return e.prototype.literalNode=function(r,n,a){return Ys.Pledge.resolve(this.noopTerm(r,a))},e.prototype.arrayNode=function(r,n,a){var o=this;return Ys.Pledge.all(r.map(function(u){return Ys.Pledge.all(u.map(o.lazyVisitFormulaNode))})).bind(function(u){return o.toArrayTerm(u,a)})},e.prototype.toArrayTerm=function(r,n){var a=r.length,o=r[0]===void 0?0:r[0].length,u=r.map(function(t){return t.map(function(d){return d.kind===oo.TermKind.Noop?d.children:d})});return u.every(function(t){return t.every(Y1r)})?this.noopTerm((0,e$.arrayOper)(a,o,u),n):(0,oo.arrayTerm)(a,o,r,n)},e.prototype.appNode=function(r,n,a,o){var u=this,t,d=((t=this.context.annotations[o])===null||t===void 0?void 0:t.kind)===Pf.AnnotationKind.FormulaRoot;if((0,VC.isOperatorNode)(r)){var s=(0,Eu.getOperatorType)(r.id);return Ys.Pledge.all(n.map(this.lazyVisitFormulaNode)).bind(function(v){return(0,oo.appTerm)((0,oo.operatorIdToName)(r.id),s,d,v,o)})}var c=(0,VC.getArguments)(n);if((0,VC.isWSFNode)(r)){var l=r.id;switch(l){case Eu.WorksheetFuncId.IFERROR:case Eu.WorksheetFuncId.IFNA:{(0,k0.assertTrue)("calc.runtime.toIfPredicateTerm: expected wff",c.length===2);var f=c[0],p=c[1],m=new e(KC.__assign(KC.__assign({},this.context),{numNames:this.context.numNames+1}));return Ys.Pledge.all([this.lazyVisitFormulaNode(f),Ys.Pledge.try(function(){return(0,WR.visitFormulaNode)(m,p)})]).bind(function(v){var h=v[0],S=v[1];return u.toIfPredicateTerm(l===Eu.WorksheetFuncId.IFERROR?Eu.WorksheetFuncId.ISERROR:Eu.WorksheetFuncId.ISNA,h,S,o)})}case Eu.WorksheetFuncId._UDF:return(0,k0.assertFalse)("calc.runtime.appNode: expected wff (not UDF)")}return Ys.Pledge.all(c.map(this.lazyVisitFormulaNode)).bind(function(v){switch(l){case Eu.WorksheetFuncId.IF:return u.toIfTerm(v,o);case Eu.WorksheetFuncId.CHOOSE:return u.toChooseTerm(v,o)}var h=(0,Eu.getWorksheetFuncType)(l);return(0,oo.appTerm)((0,oo.worksheetFunctionIdToName)(l),h,!1,v,o)})}return this.lazyVisitFormulaNode(r).bind(function(v){return Ys.Pledge.all(c.map(u.lazyVisitFormulaNode)).bind(function(h){return u.toAppTerm(v,h,o)})})},e.prototype.toIfPredicateTerm=function(r,n,a,o){var u=(0,oo.readStackTerm)(0,void 0),t=(0,oo.conditionalTerm)((0,oo.worksheetFunctionIdToName)(Eu.WorksheetFuncId.IF),r$,!1,(0,oo.appTerm)((0,oo.worksheetFunctionIdToName)(r),(0,Eu.getWorksheetFuncType)(r),!1,[u],void 0),[a,u],void 0);return(0,oo.letTerm)([n],!1,[void 0],t,o)},e.prototype.toIfTerm=function(r,n){switch(r.length){case 3:return(0,oo.conditionalTerm)((0,oo.worksheetFunctionIdToName)(Eu.WorksheetFuncId.IF),r$,!1,r[0],[r[1],r[2]],n);case 2:return(0,oo.conditionalTerm)((0,oo.worksheetFunctionIdToName)(Eu.WorksheetFuncId.IF),r$,!1,r[0],[r[1],e$.falseOper],n);case 1:throw new e_e((0,VC.notImplemented)(["single-argument IF"]));default:return(0,k0.assertFalse)("calc.runtime.toIfTerm: expected wff")}},e.prototype.toChooseTerm=function(r,n){return(0,k0.assertTrue)("calc.runtime.toChooseTerm: expected wff",r.length>=1),(0,oo.conditionalTerm)((0,oo.worksheetFunctionIdToName)(Eu.WorksheetFuncId.CHOOSE),z1r,!1,r[0],r.slice(1),n)},e.prototype.toAppTerm=function(r,n,a){return(0,oo.appTerm)((0,oo.worksheetFunctionIdToName)(Eu.WorksheetFuncId._UDF),(0,Eu.higherOrderFunctionType)(),!1,KC.__spreadArray([r],n,!0),a)},e.prototype.letNode=function(r,n,a,o,u,t){var d=this,s=r.id===Eu.WorksheetFuncId.LETREC?!0:r.id===Eu.WorksheetFuncId.LET?!1:(0,k0.assertFalse)("calc.runtime.compile");(0,k0.assertTrue)("calc.runtime.letNode: expected wff",a!==void 0);var c=this.bindNames(n),l=c[n.length],f=n.map(function(m){var v=m.name;return v.arg.label}),p;return s?p=Ys.Pledge.all(n.map(function(m){var v=m.binder;return Ys.Pledge.try(function(){return(0,WR.visitFormulaNode)(l,v.arg)})})):p=Ys.Pledge.all(n.map(function(m,v){var h=m.binder,S=c[v];return Ys.Pledge.try(function(){return(0,WR.visitFormulaNode)(S,h.arg)})})),p.bind(function(m){return(0,WR.visitFormulaNode)(l,a.arg).bind(function(v){return(0,oo.letTerm)(m.map(function(h,S){return d.noopTerm(h,(0,j1r.runtimePositionLetVal)(n[S].name.arg.label,n[S].binder.arg.label))}),s,f,v,t)})})},e.prototype.lambdaNode=function(r,n,a,o,u,t){(0,k0.assertTrue)("calc.runtime.lambdaNode: expected wff",a!==void 0);var d=this.bindNames(n),s=d[n.length],c=n.reduce(function(m,v,h){var S=v.name;return(0,Q1r.fastMax)(m,S.arg.isOptional?0:h+1)},0),l=n.length,f=n.map(function(m){var v=m.name;return v.arg.label}),p=n.map(function(m){var v=m.name;return v.arg.name.name.label});return Ys.Pledge.all(n.map(function(m,v){var h=m.name;if(h.arg.def===void 0)return Ys.Pledge.resolve(void 0);var S=d[v],y=h.arg.def.rhs;return Ys.Pledge.try(function(){return(0,WR.visitFormulaNode)(S,y)})})).bind(function(m){return(0,WR.visitFormulaNode)(s,a.arg).bind(function(v){var h=m.map(function(C,E){return[C,E]}).filter(function(C){return C[0]!==void 0}),S=h.map(function(C){var E=C[1];return E}),y=KC.__spreadArray(KC.__spreadArray([],h.map(function(C){var E=C[0];return E}),!0),[v],!1);return(0,oo.lambdaTerm)(c,l,f,p,S,y,t)})})},e.prototype.bindNames=function(r){var n=this,a=this.context.numNames,o=[this];return r.reduce(function(u,t,d){var s=t.name;(0,k0.assertTrue)("calc.runtime.bindNames: expected wff",s.arg.wholeName!==void 0);var c=u.setValue((0,VC.getBoundName)(n.context.localeInfo,s.arg.wholeName),a+d);return o.push(new e(KC.__assign(KC.__assign({},n.context),{names:c,numNames:a+d+1}))),c},this.context.names),o},e.prototype.parenNode=function(r,n,a){var o=this;return this.lazyVisitFormulaNode(r).bind(function(u){return o.noopTerm(u,a)})},e.prototype.nameNode=function(r,n,a){var o,u=((o=this.context.annotations[a])===null||o===void 0?void 0:o.kind)===Pf.AnnotationKind.AppHeadName;return Ys.Pledge.resolve(this.toNameTerm(r,n,u))},e.prototype.toNameTerm=function(r,n,a){var o=this,u=this.context,t=u.locals,d=u.names,s=u.numNames;if(!n){var c=(0,Pf.flattenNameParts)(r);if(c.kind===Pf.NamePartKind.IdentNamePart){var l=c.parts,f=l[0],p=l.slice(1),m=d.getEntry((0,VC.getBoundName)(this.context.localeInfo,f.asWhole));if(m!==void 0){var v=m.value,h=(0,oo.readStackTerm)(s-v-1,f.qualifiedLabel);return Ys.Pledge.resolve(p.reduce(function(y,C){return(0,k0.assertTrue)("calc.runtime.toNameTerm: expected wff",C.rhs.field.kind===Pf.NodeKind.Ident),o.toFieldRefTerm(y,C.rhs.field.whole,C.qualifiedLabel)},h))}}}var S=function y(C,E){var I=Ys.Pledge.resolve(void 0);if(E.kind===Pf.NamePartKind.FieldRefNamePart&&E.rhs.field.kind===Pf.NodeKind.Ident){var F=E.rhs.field.whole;I=Ys.Pledge.try(function(){return y(!1,E.lhs)}).bind(function(w){return w===void 0?void 0:o.toFieldRefTerm(w,F,E.qualifiedLabel)})}return E.kind===Pf.NamePartKind.CellRefNamePart&&(n==null&&t.allowUnqualifiedCell||n!=null&&n.kind!==Pf.QualifierKind.Document)&&(I=Ys.Pledge.resolve((0,oo.cellRefTerm)(E.ref,n!=null&&n.kind===Pf.QualifierKind.Ident?(0,Pf.sheetQualifier)(n.name):n,E.qualifiedLabel))),E.canDenoteNamedObject&&(C&&(!n||n.kind===Pf.QualifierKind.Document||n.kind===Pf.QualifierKind.Ident)&&(I=I.bind(function(w){return(0,oo.udfTerm)(E.asWhole,n,w,E.qualifiedLabel)})),I=I.bind(function(w){return(0,oo.nameTerm)(E.asWhole,n,C?ZCe.NameSource.AppHead:ZCe.NameSource.Plain,w,E.qualifiedLabel)})),I};return S(a,r).bind(function(y){return y!==void 0?y:(0,k0.assertFalse)("calc.runtime.compile: expected wff NameNode")})},e.prototype.cellRefNode=function(r,n,a){return Ys.Pledge.resolve((0,oo.cellRefTerm)(r,n,a))},e.prototype.fieldRefNode=function(r,n,a,o){var u=this;(0,k0.assertTrue)("calc.runtime.compile: expected wff FieldRef",n.field.kind===Pf.NodeKind.Ident);var t=n.field.whole;return this.lazyVisitFormulaNode(r).bind(function(d){return u.toFieldRefTerm(d,t,o)})},e.prototype.toFieldRefTerm=function(r,n,a){var o=Eu.WorksheetFuncId.FIELDVALUE;return(0,oo.appTerm)((0,oo.worksheetFunctionIdToName)(o),(0,Eu.getWorksheetFuncType)(o),!1,[r,(0,e$.stringOper)(n)],a)},e.prototype.noopTerm=function(r,n){return this.context.locals.emitStepInfo?(0,W1r.noopTerm)(r,n):r},e.prototype.structRefNode=function(r,n,a){return Ys.Pledge.resolve((0,oo.structRefTerm)((0,Pf.structRefNode)(r,n,a),a))},e.prototype.missingNode=function(r,n){return(0,k0.assertFalse)("calc.runtime.compile: unexpected missing node")},e.prototype.badSequenceNode=function(r,n,a){return(0,k0.assertFalse)("calc.runtime.compile: unexpected bad node")},e.prototype.badCharsNode=function(r,n,a){return(0,k0.assertFalse)("calc.runtime.compile: unexpected bad node")},e.prototype.operatorNode=function(r,n){return Ys.Pledge.resolve((0,Pf.operatorNode)(r,n))},e.prototype.wsfNode=function(r,n,a){return Ys.Pledge.resolve((0,Pf.wsfNode)(r,n,a))},e}(),X1r=(rG={},rG[Eu.OperatorId.At]=Eu.WorksheetFuncId.SINGLE,rG[Eu.OperatorId.Pound]=Eu.WorksheetFuncId.ANCHORARRAY,rG);function Z1r(e){if(!(0,oo.isOperTerm)(e)&&e.kind===oo.TermKind.App&&(0,oo.isOperatorName)(e.data.funName)){var r=X1r[(0,oo.operatorNameToId)(e.data.funName)];if(r!==void 0)return(0,oo.appTerm)((0,oo.worksheetFunctionIdToName)(r),(0,Eu.getWorksheetFuncType)(r),e.data.isFormulaRoot,e.children,e.position)}return e}var $1r=[Z1r],eyr=function(r,n){return n(r)},ryr=function(r){return $1r.reduce(eyr,r)};function nyr(e){return(0,oo.transformBottomUp)(e,ryr)}function r_e(e,r){var n=KC.__assign(KC.__assign({},e),{term:r});return n}jR.compiledFormula=r_e;function tyr(e,r){return typeof r.term!="object"?(0,k0.assertFalse)("".concat(e,": expected known compiled formula type; given ").concat((0,V1r.anonymize)(r))):r.term}jR.compiledFormulaTerm=tyr;function ayr(e,r){var n=r.annotations[r.node.label],a=H1r.RedBlackMapTree.create(e.stringCompareCI);if((n==null?void 0:n.kind)===Pf.AnnotationKind.FormulaRoot){var o=n.contextNames,u=o===void 0?[]:o,t=u.reduce(function(d,s,c){return d.setValue((0,VC.getBoundName)(e,s.whole),c)},a);return{names:t,numNames:u.length}}return{names:a,numNames:0}}function iyr(e,r,n){var a,o;try{var u=(o=(a=r.config)===null||a===void 0?void 0:a.localeInfo)!==null&&o!==void 0?o:e.config.localeInfo,t=ayr(u,n),d=t.names,s=t.numNames,c={globals:e,locals:r,localeInfo:u,annotations:n.annotations,names:d,numNames:s},l=(0,WR.reducePledge)(new J1r(c),n),f=nyr(l);return(0,nG.success)(r_e(n,f))}catch(p){return p instanceof e_e?(0,nG.failure)(p.reason):(0,nG.failure)((0,nG.javaScriptError)(p))}}function oyr(e){return{compileFormula:function(n,a){return iyr(e,n,a)}}}jR.createCompiler=oyr});var lG=Y(B1=>{"use strict";_();Object.defineProperty(B1,"__esModule",{value:!0});B1.dereferenceOpers=B1.dereferenceOper=B1.dereference=B1.getCellValuesAsArray=void 0;var oG=zo(),aG=HP(),n$=Nv(),uG=GC(),i_e=hg(),WC=zs(),uyr=cd(),iG=qd(),syr=Ol(),kv=_o(),lyr=_f(),HR=ao(),gO=Ic(),cyr=D1(),n_e=Bl(),sG=Bd(),dyr=16;function o_e(e,r){var n=r.map.getValue(e);if(n!==void 0){var a=(0,cyr.recordCellCycle)(n,r.current);return(0,WC.throwEvaluationError)(a)}}function t_e(e,r,n){e.precedents.cells.push(r);var a=e.globals.getCellValue(r);if(a.kind===sG.ResultKind.Failure)return(0,WC.throwEvaluationError)(a.reason);var o=a.value;if(o.kind===i_e.CellKind.FinalValue)return o.oper;o_e(o.anchor,e.visitedCells),n.push(o.anchor)}function fyr(e,r,n,a,o){var u=[],t=a.length,d=0;(0,oG.assertTrue)("calc.runtime.deference: readIntoArray2D number of rows",t===n.rows);for(var s=0;s<t;s+=1){u.push([]);var c=a[s].length;(0,oG.assertTrue)("calc.runtime.deference: readIntoArray2D number of cols",c===n.cols),d=s===0?c:(0,lyr.fastMin)(c,d);for(var l=0;l<c;l+=1){var f=a[s][l];i_e.CellKind.FinalValue===f.kind?u[s][l]=f.oper:(o_e(f.anchor,e.visitedCells),(0,oG.assertTrue)("calc.runtime.deference: readIntoArray2D correct sheet",(0,HR.isSheetIndexEqual)(f.anchor.sheet,r.sheet)),o.push(f.anchor),u[s][l]=kv.refErrorOper)}}return new n$.StrictSparseArray2D(r.range.rows,r.range.cols,t,d,u,kv.blankOper)}function u_e(e,r,n,a){e.precedents.cells.push(r);var o;if(!a||(0,HR.gridRangeSize)(r.range)<=dyr)o=r;else{var u=e.globals.getUsedRange(r.sheet),t=void 0;(0,sG.isSuccess)(u)?t=u.value==null?void 0:u.value.range:(0,WC.throwEvaluationError)(u.reason);var d=t===void 0?void 0:(0,HR.gridRangeIsect)(r.range,(0,gO.gridRange)(0,0,t.row+t.rows,t.col+t.cols));if(d===void 0)return new n$.StrictSparseArray2D(r.range.rows,r.range.cols,0,0,[],kv.blankOper);o=(0,gO.sheetGridRange)(r.sheet,d)}var s=e.globals.getCellValues(o);if(s.kind===sG.ResultKind.Failure)return(0,WC.throwEvaluationError)(s.reason);var c=n.length,l=fyr(e,r,o.range,s.value,n);if(c===n.length)return l}B1.getCellValuesAsArray=u_e;function a_e(e,r,n){var a=u_e(e,r,n,!1);if(a!=null)return(0,kv.arrayOper)(a.rows,a.cols,a.rows===a.denseRows&&a.cols===a.denseCols?a.denseElements:(0,n$.array2DToJaggedArray)(a))}function t$(e,r,n,a){if(n&n_e.OperKind.Range||!(0,HR.isRangeOper)(r))return r;var o=r.sheets;if(!(0,HR.isSheetIndex)(o))return(0,iG.traceErrorOper)("calc.runtime.dereference",kv.ErrorType.REF,"3D range, oper = ".concat((0,uG.anonymize)(r))),kv.refErrorOper;if(r.ranges.length!==1)return(0,iG.traceErrorOper)("calc.runtime.dereference",kv.ErrorType.VALUE,"union range, oper = ".concat((0,uG.anonymize)(r))),kv.valueErrorOper;var u=r.ranges[0];if(n&uyr.singleReadOperType){if((0,HR.isGridCell)(u))return t_e(e,(0,gO.sheetGridCell)(o,u),a);if(e.locals.implicitIntersect&&(0,aG.isFeatureEnabled)(aG.FeatureName.CalcLegacyImplicitIntersection)&&!(0,aG.isFeatureEnabled)(aG.FeatureName.CalcPreventSpillingHack)){var t=e.locals.originGridCell;if(!(0,sG.isSuccess)(t))return(0,WC.throwEvaluationError)(t.reason);var d=(0,HR.gridCellImplicitIsect)(t.value,u);return d==null?((0,iG.traceErrorOper)("calc.runtime.dereference",kv.ErrorType.VALUE,"empty intersection, oper = ".concat((0,uG.anonymize)(r))),kv.valueErrorOper):t_e(e,(0,gO.sheetGridCell)(o,d),a)}return a_e(e,(0,gO.sheetGridRange)(o,u),a)}return n&n_e.OperKind.Array?a_e(e,(0,gO.sheetGridRange)(o,u),a):((0,iG.traceErrorOper)("calc.runtime.dereference",kv.ErrorType.VALUE,"bad target type ".concat(n)),kv.valueErrorOper)}B1.dereference=t$;function pyr(e,r,n){var a=[],o=t$(e,r,n,a);if(o==null){if(a.length>0)return(0,WC.throwEvaluationError)((0,WC.unevaluated)(a));var u=(0,uG.anonymize)(r),t="calc.runtime.dereferenceOper: internal error: expected nonempty anchors; oper = ".concat(u);return oG.ulsLogger.ULS.assertTag(595980819,syr.LogCategory.msoulscat_ES_EWAJS,!1,t)}return o}B1.dereferenceOper=pyr;function myr(e,r,n){for(var a=[],o=0;o<r.length;o+=1){var u=t$(e,r[o],(0,HR.getArgType)(n,o,r.length),a);u!=null&&(r[o]=u)}if(a.length>0)return(0,WC.throwEvaluationError)((0,WC.unevaluated)(a))}B1.dereferenceOpers=myr});var QP=Y(uS=>{"use strict";_();Object.defineProperty(uS,"__esModule",{value:!0});uS.isRangeValues=uS.rangeValues=uS.DerefOperKind=uS.machine=void 0;var gyr=cd();uS.machine=gyr;var a$;(function(e){e.RangeValues="RangeValues"})(a$=uS.DerefOperKind||(uS.DerefOperKind={}));function vyr(e){return{kind:a$.RangeValues,arrays:e}}uS.rangeValues=vyr;function hyr(e){return e.kind===a$.RangeValues}uS.isRangeValues=hyr});var s$=Y(lp=>{"use strict";_();Object.defineProperty(lp,"__esModule",{value:!0});lp.applyOperator=lp.cmpNum=lp.cmpStr=lp.cmpBool=lp.cmpInt=void 0;var QR=GC(),aw=qd(),i$=$3(),dd=_o(),o$=zo(),ql=Sm(),q1=Bl(),Syr=Ic(),Fv=ao(),s_e=qd();lp.cmpInt=Fv.applyComparison;function cG(e,r,n){return(0,lp.cmpInt)(e,r.value-n.value)}lp.cmpBool=cG;function dG(e,r,n,a){return(0,lp.cmpInt)(r,e.stringCompareCI(n.value,a.value))}lp.cmpStr=dG;function fG(e,r,n,a){return(0,lp.cmpInt)(r,e.compare(n,a))}lp.cmpNum=fG;function yyr(e,r,n,a){var o=e.config,u=o.localeInfo,t=o.mathpack;if(n.kind!==a.kind){if((0,Fv.isBlankOper)(n))switch(a.kind){case q1.OperKind.Number:return fG(t,r,t.zero,a);case q1.OperKind.String:return dG(u,r,s_e.emptyStringOper,a);case q1.OperKind.Boolean:return cG(r,dd.falseOper,a)}if((0,Fv.isBlankOper)(a))switch(n.kind){case q1.OperKind.Number:return fG(t,r,n,t.zero);case q1.OperKind.String:return dG(u,r,n,s_e.emptyStringOper);case q1.OperKind.Boolean:return cG(r,n,dd.falseOper)}return(0,lp.cmpInt)(r,n.kind-a.kind)}switch(n.kind){case q1.OperKind.Number:return fG(t,r,n,a);case q1.OperKind.String:return dG(u,r,n,a);case q1.OperKind.Boolean:return cG(r,n,a);case q1.OperKind.Blank:return(0,lp.cmpInt)(r,0);default:return!1}}function u$(e,r,n){if(!(0,Fv.isSheetIndex)(r.sheets)){(0,aw.traceErrorOper)(e,dd.ErrorType.VALUE,"3D reference, range1 = ".concat((0,QR.anonymize)(r)));return}if(!(0,Fv.isSheetIndex)(n.sheets)){(0,aw.traceErrorOper)(e,dd.ErrorType.VALUE,"3D reference, range2 = ".concat((0,QR.anonymize)(n)));return}if(!(0,Fv.isDocumentLocEqual)(r.sheets.document,n.sheets.document)){var a="different document, range1 = ".concat((0,QR.anonymize)(r),", range2 = ").concat((0,QR.anonymize)(n));(0,aw.traceErrorOper)(e,dd.ErrorType.VALUE,a);return}var o=r.sheets.index,u=n.sheets.index;if(o!==u){var a="different sheet, range1 = ".concat((0,QR.anonymize)(r),", range2 = ").concat((0,QR.anonymize)(n));(0,aw.traceErrorOper)(e,dd.ErrorType.VALUE,a);return}return(0,Syr.sheetIndex)(r.sheets.document,r.sheets.index)}function Cyr(e,r){var n=u$("calc.runtime.applyRangeOp",e,r);if(n==null)return dd.valueErrorOper;var a=(0,Fv.gridRangesJoin)(e.ranges),o=(0,Fv.gridRangesJoin)(r.ranges),u=[(0,Fv.gridRangeJoin)(a,o)];return(0,dd.rangeSeqOper)(n,u)}function _yr(e,r){var n=u$("calc.runtime.applyUnionOp",e,r);return n==null?dd.valueErrorOper:(0,dd.rangeSeqOper)(n,e.ranges.concat(r.ranges))}function Ryr(e,r){var n=u$("calc.runtime.applyIsectOp",e,r);if(n==null)return dd.valueErrorOper;for(var a=[],o=0;o<e.ranges.length;o+=1)for(var u=0;u<r.ranges.length;u+=1){var t=(0,Fv.gridRangeIsect)(e.ranges[o],r.ranges[u]);t!=null&&a.push(t)}if(a.length===0){var d="empty intersection, range1 = ".concat((0,QR.anonymize)(e),", range2 = ").concat((0,QR.anonymize)(r));return(0,aw.traceErrorOper)("calc.runtime.applyIsectOp",dd.ErrorType.NULL,d),dd.nullErrorOper}return(0,dd.rangeSeqOper)(n,a)}function Tyr(e,r,n,a){a===void 0&&(a=!1);var o=e.config.mathpack;if(n.length===1){var u=n[0];switch(r){case ql.OperatorId.Percent:return o.percent(u);case ql.OperatorId.Neg:return o.neg(u);case ql.OperatorId.Pos:return u;default:{var t="bad application of ".concat(r," to 1 argument"),d="calc.runtime.applyOperator: ".concat(t);return o$.ulsLogger.ULS.assertTag(593372496,i$.LogCategory.msoulscat_ES_EWAJS,!1,d)}}}if(n.length===2){var u=n[0],s=n[1];switch(r){case ql.OperatorId.Add:{var c=o.add(u,s);return a&&(0,Fv.isNumberOper)(c)?o.checkAlmostCancellation(u,c):c}case ql.OperatorId.Sub:{var c=o.sub(u,s);return a&&(0,Fv.isNumberOper)(c)?o.checkAlmostCancellation(u,c):c}case ql.OperatorId.Mul:return o.mul(u,s);case ql.OperatorId.Div:return o.div(u,s);case ql.OperatorId.Pow:return o.power(u,s);case ql.OperatorId.Concat:return(0,dd.stringOper)((u.value+s.value).substring(0,dd.cellStringLimit));case ql.OperatorId.Eq:case ql.OperatorId.Ne:case ql.OperatorId.Lt:case ql.OperatorId.Le:case ql.OperatorId.Gt:case ql.OperatorId.Ge:return(0,dd.booleanOper)(yyr(e,r,u,s));case ql.OperatorId.Range:return Cyr(u,s);case ql.OperatorId.Isect:return Ryr(u,s);case ql.OperatorId.Union:return _yr(u,s);case ql.OperatorId.And:return(0,dd.booleanOper)(u.value&&s.value);case ql.OperatorId.Or:return(0,dd.booleanOper)(u.value||s.value);case ql.OperatorId.Xor:return(0,dd.booleanOper)(u.value!==s.value);case ql.OperatorId.Min:return o.cond2(u,s)<=0?u:s;case ql.OperatorId.Max:return o.cond2(u,s)>=0?u:s;default:{var l="bad application of ".concat(r," to 2 arguments"),f="calc.runtime.applyOperator: ".concat(l);return o$.ulsLogger.ULS.assertTag(593372497,i$.LogCategory.msoulscat_ES_EWAJS,!1,f)}}}var p="bad application of ".concat(r," to ").concat(n.length," arguments"),m="calc.runtime.applyOperator: ".concat(p);return o$.ulsLogger.ULS.assertTag(593372498,i$.LogCategory.msoulscat_ES_EWAJS,!1,m)}lp.applyOperator=Tyr});var l$=Y(U1=>{"use strict";_();Object.defineProperty(U1,"__esModule",{value:!0});U1.parseLocals=U1.notFormulaString=U1.createParseGlobals=U1.ReasonKind=void 0;var pG=N0();U1.ReasonKind=pG.parseServiceTypes.ReasonKind;U1.createParseGlobals=pG.parseServiceTypes.createParseGlobals;U1.notFormulaString=pG.parseServiceTypes.notFormulaString;U1.parseLocals=pG.parseServiceTypes.parseLocals});var c$=Y(Iv=>{"use strict";_();Object.defineProperty(Iv,"__esModule",{value:!0});Iv.summarizeFormulaDiagnostics=Iv.diagnostics=Iv.createAnalyzeGlobals=Iv.analyzeLocalsName=Iv.analyzeLocalsGrid=void 0;var iw=N0();Iv.analyzeLocalsGrid=iw.analyzeServiceTypes.analyzeLocalsGrid;Iv.analyzeLocalsName=iw.analyzeServiceTypes.analyzeLocalsName;Iv.createAnalyzeGlobals=iw.analyzeServiceTypes.createAnalyzeGlobals;Iv.diagnostics=iw.analyzeServiceTypes.diagnostics;Iv.summarizeFormulaDiagnostics=iw.analyzeServiceTypes.summarizeFormulaDiagnostics});var l_e=Y(mG=>{"use strict";_();Object.defineProperty(mG,"__esModule",{value:!0});mG.adjustFormulaOrigin=void 0;var byr=et();mG.adjustFormulaOrigin=byr.adjust.adjustFormulaOrigin});var jC=Y(vO=>{"use strict";_();Object.defineProperty(vO,"__esModule",{value:!0});vO.LambdaOper=vO.RecordOper=void 0;var c_e=_o(),d_e=Bl(),Pyr=function(){function e(r,n){n===void 0&&(n=c_e.valueErrorOper),this._fields=r,this._fallback=n,this.kind=d_e.OperKind.Rich}return e.prototype.getFallback=function(){return this._fallback},e.prototype.getField=function(r){return this._fields.getValue(r)},e}();vO.RecordOper=Pyr;var Eyr=function(){function e(r,n,a,o,u,t,d,s,c,l){this.minArity=r,this.maxArity=n,this.lambdaNodeLabel=a,this.paramNodeLabels=o,this.paramNameLabels=u,this.locals=t,this.stackEnv=d,this.stackMap=s,this.defIdxs=c,this.defsAndBody=l,this.kind=d_e.OperKind.Rich}return e.prototype.getFallback=function(){return c_e.valueErrorOper},e.prototype.getField=function(r){},e}();vO.LambdaOper=Eyr});var f_e=Y(ym=>{"use strict";_();Object.defineProperty(ym,"__esModule",{value:!0});ym.toXLNumber=ym.renderFormat=ym.initUtilGlobals=ym.getValueEditOperKind=ym.getFormatString=ym.applyValueEdit=void 0;var hO=gm();ym.applyValueEdit=hO.util.applyValueEdit;ym.getFormatString=hO.util.getFormatString;ym.getValueEditOperKind=hO.util.getValueEditOperKind;ym.initUtilGlobals=hO.util.initUtilGlobals;ym.renderFormat=hO.util.renderFormat;ym.toXLNumber=hO.util.toXLNumber});var ow=Y(lc=>{"use strict";_();Object.defineProperty(lc,"__esModule",{value:!0});lc.values=lc.stringStartsWith=lc.stringEndsWith=lc.repeat=lc.prependErrorMessage=lc.partialArray=lc.messageFromError=lc.mathLog2=lc.isInteger=lc.arrayFill=void 0;var G1=Cn();lc.arrayFill=G1.util.arrayFill;lc.isInteger=G1.util.isInteger;lc.mathLog2=G1.util.mathLog2;lc.messageFromError=G1.util.messageFromError;lc.partialArray=G1.util.partialArray;lc.prependErrorMessage=G1.util.prependErrorMessage;lc.repeat=G1.util.repeat;lc.stringEndsWith=G1.util.stringEndsWith;lc.stringStartsWith=G1.util.stringStartsWith;lc.values=G1.util.values});var p_e=Y(zR=>{"use strict";_();Object.defineProperty(zR,"__esModule",{value:!0});zR.printLocalsName=zR.printLocalsGrid=zR.createSimplePrintGlobals=void 0;var d$=et();zR.createSimplePrintGlobals=d$.printServiceTypes.createSimplePrintGlobals;zR.printLocalsGrid=d$.printServiceTypes.printLocalsGrid;zR.printLocalsName=d$.printServiceTypes.printLocalsName});var h$=Y(CO=>{"use strict";_();Object.defineProperty(CO,"__esModule",{value:!0});CO.FunctionDispatcher=CO.UdfOper=void 0;var Nyr=GC(),Cm=zo(),Ayr=Nv(),g$=hg(),Oyr=hg(),mo=zs(),kyr=QP(),Fyr=s$(),Iyr=oS(),f$=oS(),v$=oS(),m_e=oS(),p$=oS(),SO=oS(),Myr=qd(),gG=qd(),uw=_f(),wyr=$3(),g_e=Ic(),Cg=Ic(),Dyr=ao(),jp=ao(),vG=mO(),YR=GU(),xyr=l$(),Lyr=_o(),_g=_o(),Byr=c$(),qyr=l_e(),Uyr=jC(),hG=Sm(),m$=cd(),sw=cO(),v_e=f_e(),Os=Bl(),yO=lG(),Gyr=XU(),Do=Bd(),Kyr=ow(),Vyr=p_e(),SG=HP(),S_e=function(){function e(r,n){this.kind=Os.OperKind.Rich,this.loc=r,this.arity=n.arity,this.func=n.func}return e.prototype.getFallback=function(){return(0,Cm.assertFalse)("calc.runtime.UdfOper.getFallback")},e.prototype.getField=function(r){return(0,Cm.assertFalse)("calc.runtime.UdfOper.getField")},e}();CO.UdfOper=S_e;function h_e(e,r,n,a){(0,Cm.assertTrue)("calc.runtime.compileCallLambda",r.length>=e.minArity&&r.length<=e.maxArity);for(var o=r.slice();o.length<e.maxArity;)o.push(Lyr.missingOper);for(var u=o.slice(),t=0;t<e.defIdxs.length;t+=1){var d=e.defIdxs[t],s=e.defsAndBody[t],c=u[d];(0,v$.isOperTerm)(c)&&(0,Dyr.isMissingOper)(c)&&(u[d]=s)}var l=e.defsAndBody[e.defsAndBody.length-1],f=(0,f$.letTerm)(a?u.map(function(p,m){return(0,f$.noopTerm)(p,(0,g$.runtimePositionLambdaParam)(e.paramNodeLabels[m],e.paramNameLabels[m]))}):u,!1,e.paramNodeLabels,l,(0,g$.runtimePositionLambdaRoot)(e.lambdaNodeLabel,e,o));return(0,f$.callLambdaTerm)(e.locals,e.stackEnv,e.stackMap,n,f)}var WRn=CO.FunctionDispatcher=function(){function e(r,n,a,o,u,t,d,s){this.context=r,this.stepConfig=n,this.locals=a,this.caller=o,this.precedents=u,this.visitedCells=t,this.visitedNames=d,this.usage=s,this.internalSource=void 0;var c=r.globals.config.refStyle;this.config={localeInfo:r.globals.config.localeInfo,get refStyle(){return u.special|=Os.SpecialPrecs.RefStyle,c},mathpack:r.globals.config.mathpack,date1904:r.globals.config.date1904,dateCompatibility:r.globals.config.dateCompatibility,timezone:r.globals.config.timezone,datepack:r.globals.config.datepack},this.mathpack=this.config.mathpack,this.datepack=this.config.datepack}return Object.defineProperty(e.prototype,"globals",{get:function(){return this.context.globals},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numberFormatter",{get:function(){return this.context.numberFormatter},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"internalCaller",{get:function(){return(0,Cm.assertTrue)("calc.runtime.FunctionDispatcher.internalCaller",this.internalSource!==void 0),(0,mo.stackFrameList)(this.internalSource,e.internalPosition,mo.emptyStackEnv,void 0,this.caller)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"internalContext",{get:function(){var n=this.internalCaller;return{stack:new mo.ES5IterableStackFrame(n)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"calcingArray",{get:function(){return this.locals.calcingArray},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originGridCell",{get:function(){var n=this.locals.originGridCell;return(0,Do.isSuccess)(n)?n.value:(0,mo.throwEvaluationError)(n.reason)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originSheet",{get:function(){var n=this.locals.originSheet;return(0,Do.isSuccess)(n)?n.value:(0,mo.throwEvaluationError)(n.reason)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reflectionGridCell",{get:function(){var n=this.locals.reflectionGridCell;return(0,Do.isSuccess)(n)?n.value:(0,mo.throwEvaluationError)(n.reason)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reflectionSheet",{get:function(){var n=this.locals.reflectionSheet;return(0,Do.isSuccess)(n)?n.value:(0,mo.throwEvaluationError)(n.reason)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"followHyperlinks",{get:function(){var n=this.locals.followHyperlinks;return(0,Do.isSuccess)(n)?n.value:(0,mo.throwEvaluationError)(n.reason)},enumerable:!1,configurable:!0}),e.prototype.makeChildDispatcher=function(r){return new e(this.context,this.stepConfig,this.locals,r,this.precedents,this.visitedCells,this.visitedNames,this.usage)},e.prototype.useAsFuncContext=function(r){return(0,Cm.assertTrue)("calc.runtime.FunctionDispatcher.useAsFuncContext: caller shouldn't be set",this.internalSource===void 0),r!==void 0&&(this.internalSource=r),this},e.prototype.applyFunction=function(r,n){var a=this.makeChildDispatcher(this.internalCaller),o=(0,hG.getWorksheetFuncType)(r),u=n.some(jp.isRangeOper),t=u?n.slice(0):n;return(0,yO.dereferenceOpers)(a,t,o),a.termToFuncResult(a.dispatchFunction((0,SO.worksheetFunctionIdToName)(r),o,!1,t))},e.prototype.applyLambda=function(r,n){return this.termToFuncResult(h_e(r,n,this.internalCaller,this.stepConfig!=null))},e.prototype.handleEvaluationError=function(r){if(r instanceof mo.EvaluationError)return(0,mo.handleEvaluationError)(this.context,this.visitedCells,r.reason)},e.prototype.applyOperatorOrFunction=function(r,n,a){if((0,SO.isOperatorName)(r))return(0,Fyr.applyOperator)(this.globals,(0,SO.operatorNameToId)(r),n,a);var o=(0,SO.worksheetFunctionNameToId)(r);if(o===hG.WorksheetFuncId._UDF){if(n[0]instanceof Uyr.LambdaOper){var u=n[0],t=n.slice(1);return t.length>=u.minArity&&t.length<=u.maxArity?((0,Cm.assertTrue)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction: caller shouldn't be set",this.internalSource===void 0),h_e(u,t,this.caller,this.stepConfig!=null)):_g.valueErrorOper}if(n[0]instanceof S_e){var d=n[0];if(n.length-1!==d.arity)return _g.valueErrorOper;var s=d.func(this.useAsFuncContext((0,g_e.lexicalSourceUDF)(d.loc)),n.slice(1));if(s.kind===Os.OperKind.Error){var c="UDF function return value";(0,gG.traceErrorOper)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",s.type,c)}return this.funcContextResultToTerm(s)}switch(n[0].kind){case Os.OperKind.Error:return n[0];case Os.OperKind.Number:return _g.valueErrorOper;case Os.OperKind.Rich:return(0,mo.throwEvaluationError)((0,jp.notImplemented)(["Rich UDF head"]));case Os.OperKind.String:case Os.OperKind.Boolean:case Os.OperKind.Blank:case Os.OperKind.Missing:return _g.refErrorOper;case Os.OperKind.Array:return(0,SG.isFeatureEnabled)(SG.FeatureName.CalcLambdaArrayLifting)?(0,Cm.assertFalse)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction: unexpected array UDF head"):(0,mo.throwEvaluationError)((0,jp.notImplemented)(["Array UDF head"]));case Os.OperKind.Range:return(0,SG.isFeatureEnabled)(SG.FeatureName.CalcLambdaCellValues)?(0,Cm.assertFalse)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction: unexpected range UDF head"):(0,mo.throwEvaluationError)((0,jp.notImplemented)(["Range UDF head"]));default:return(0,Cm.assertNever)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",n[0])}}var l=this.globals.getWorksheetFunc(o);if(l.kind===Do.ResultKind.Failure)return(0,mo.throwEvaluationError)(l.reason);var f=l.value;if(f==null){var c="nonexistent worksheet function ".concat(o);return(0,gG.traceErrorOper)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",_g.ErrorType.NAME,c),_g.nameErrorOper}try{var s=f(this.useAsFuncContext((0,g_e.lexicalSourceWSF)(o)),n);if(s.kind===Os.OperKind.Error){var c="worksheet function ".concat(o," return value");(0,gG.traceErrorOper)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",s.type,c)}return this.funcContextResultToTerm(s)}catch(p){throw(0,Kyr.prependErrorMessage)(p,"(in WSF ".concat((0,wyr.englishWorksheetFuncIdToName)(o),")"))}},e.prototype.termToFuncResult=function(r){switch(r.kind){case p$.TermKind.CallLambda:case p$.TermKind.CallFirstOrderFunc:return(0,m$.machineCall)(this.context.createCallTermEvaluationMachine(this.context,this.stepConfig,this.locals,this.precedents,this.visitedCells,this.visitedNames,this.usage,r));case p$.TermKind.CallMachine:return(0,m$.machineCall)(r.data.machine)}return r},e.prototype.funcContextResultToTerm=function(r){return(0,Cm.assertTrue)("calc.runtime.FunctionDispatcher.funcContextResultToTerm",this.internalSource!==void 0),(0,m$.isMachineCall)(r)?(0,Iyr.callFirstOrderFuncTerm)(this.internalSource,this.caller,(0,m_e.callMachineTerm)(r.machine,e.internalPosition)):r},e.prototype.dispatchFunction=function(r,n,a,o){var u=this;if(!(0,jp.isValidArgsLength)(n,o.length)){var t=JSON.stringify(n),d="bad application of ".concat(JSON.stringify(r)," to ").concat(o.length," arguments, ftype = ").concat(t),s="calc.runtime.FunctionDispatcher.dispatchFunction: ".concat(d);return(0,Cm.assertFalse)(s)}for(var c=o.length,l=Os.SignatureType.None,f=0;f<c;f+=1){var p=o[f],m=p.kind;m&(0,jp.getArgType)(n,f,c)||(l|=m),(0,jp.isRangeOper)(p)&&!(n.flags&Os.FunctionFlags.Allow3dRef)&&!(0,jp.isSheetIndex)(p.sheets)&&(l|=m)}if(l===Os.SignatureType.None)return this.applyOperatorOrFunction(r,o,a);if(l&Os.OperKind.Array){var v=function(I){var F=u.makeChildDispatcher(u.caller);return F.termToFuncResult(F.dispatchFunction(r,n,!1,I))},h=(0,Myr.arrayLift)(this.useAsFuncContext(void 0),n,v,o).machine;return(0,m_e.callMachineTerm)(h,void 0)}l&=~Os.OperKind.Array;for(var S=[],f=0;f<c;f+=1){var y=o[f];if(l&y.kind){var C=(0,jp.getArgType)(n,f,c);if(y=this.coerceOper(y,C),(0,jp.isErrorOper)(y)&&!(C&Os.OperKind.Error))return y;if((0,jp.isRangeOper)(y)&&!(n.flags&Os.FunctionFlags.Allow3dRef)&&!(0,jp.isSheetIndex)(y.sheets)){var d="3D reference, oper = ".concat((0,Nyr.anonymize)(y));return(0,gG.traceErrorOper)("calc.runtime.FunctionDispatcher.dispatchFunction",_g.ErrorType.VALUE,d),_g.valueErrorOper}}S[f]=y}return this.applyOperatorOrFunction(r,S,a)},e.prototype.getAvailableFormula=function(r){var n=this.globals.getCellFormula(r);if(!(0,Do.isSuccess)(n))return(0,mo.throwEvaluationError)(n.reason);if(!(0,uw.isNone)(n.value))return n.value},e.prototype.getNameFormula=function(r,n,a){var o,u=(o=this.context.resolver.resolveName(this.locals,(0,vG.nameNode)((0,vG.identNamePart)(n,!0),r),a),o.resolution),t=o.precedents;if((0,uw.safePush)(this.precedents.names,t),!(0,Do.isSuccess)(u))switch(u.reason.kind){case YR.ResolveReasonKind.NoOriginSheet:case YR.ResolveReasonKind.InvalidQualifier:return;default:return(0,mo.throwEvaluationError)(u.reason)}var d=u.value;if(d){var s=this.globals.getNameFormula(d,a);(0,Do.isSuccess)(s)||(0,mo.throwEvaluationError)(s.reason);var c=s.value;if(!(0,uw.isNone)(c))return[d,c.node]}},e.prototype.getCellRef=function(r,n,a,o){var u={originGridCell:(0,Do.success)(a.range),originSheet:(0,Do.success)(a.sheet),allowUnqualifiedCell:!0,wrapCellReferences:o},t=this.context.resolver.resolveCellRef(u,(0,vG.cellRefNode)(n,r)).resolution;if(!(0,Do.isSuccess)(t))switch(t.reason.kind){case YR.ResolveReasonKind.NoOriginSheet:case YR.ResolveReasonKind.InvalidQualifier:return;default:return(0,mo.throwEvaluationError)(t.reason)}var d=t.value;if(d)return(0,_g.range3DOper)(d.sheet,d.range)},e.prototype.getStructRef=function(r,n,a){var o,u={originGridCell:(0,Do.success)(a.range),originSheet:(0,Do.success)(a.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1},t=(o=this.context.resolver.resolveStructRef(u,(0,vG.structRefNode)(r,n)),o.resolution),d=o.precedents;if((0,uw.safePush)(this.precedents.names,d),!(0,Do.isSuccess)(t))switch(t.reason.kind){case YR.ResolveReasonKind.NoOriginSheet:case YR.ResolveReasonKind.InvalidQualifier:case YR.ResolveReasonKind.InvalidStructRef:case YR.ResolveReasonKind.EmptyIntersection:return;default:return(0,mo.throwEvaluationError)(t.reason)}var s=t.value;if(s)return(0,_g.range3DOper)(s.sheet,s.range)},e.prototype.dereferenceOper=function(r,n){return(0,yO.dereferenceOper)(this,r,n)},e.prototype.dereferenceOpers=function(r,n){(0,yO.dereferenceOpers)(this,r,n)},e.prototype.getCellFormula=function(r){this.precedents.cells.push(r);var n=this.globals.getCellValue(r);return(0,Do.isSuccess)(n)?this.getAvailableFormula(r):(0,mo.throwEvaluationError)(n.reason)},e.prototype.getSheetIndex=function(r,n){var a=this.globals.getSheetIndex(r,n);return(0,Do.isSuccess)(a)?(this.precedents.special|=Os.SpecialPrecs.OwnDocSheets,a.value==null?void 0:(0,Cg.sheetIndex)(r,a.value)):(0,mo.throwEvaluationError)(a.reason)},e.prototype.getSheetRangePosition=function(r){this.precedents.special|=Os.SpecialPrecs.OwnDocSheets;var n=this.globals.getSheetRangeIndexes(r);return(0,Do.isSuccess)(n)?n.value.position:(0,mo.throwEvaluationError)(n.reason)},e.prototype.getSheetRangeIndexes=function(r){if(r.index!==void 0&&r.index===r.index2)return[r.index];this.precedents.special|=Os.SpecialPrecs.OwnDocSheets;var n=this.globals.getSheetRangeIndexes(r);return(0,Do.isSuccess)(n)?n.value.sheets:(0,mo.throwEvaluationError)(n.reason)},e.prototype.dereferenceAllOpersInner=function(r,n,a){var o=this;a===void 0&&(a=!1);for(var u=[],t=[],d=function(p){var m=r[p];if(!(0,jp.isRangeOper)(m))return t.push(m),"continue";for(var v=[],h=function(F){var w=(0,yO.getCellValuesAsArray)(o,F,u,!0);w!==void 0&&v.push(n(w,F))},S=s.getSheetRangeIndexes(m.sheets),y=function(F){for(var w=(0,Cg.sheetIndex)(m.sheets.document,S[F]),B=function(H){var L,D=m.ranges[H];if(!a)return h((0,Cg.sheetGridRange)(w,D)),"continue";var U=s.globals.tryGetHiddenRows(w,D.row,D.row+D.rows);if(!(0,Do.isSuccess)(U))return{value:(0,mo.throwEvaluationError)(U.reason)};var V=U.value;if(V.length===0)return h((0,Cg.sheetGridRange)(w,D)),"continue";for(var ne=function(R,P){var A=(0,Cg.gridRange)(R,D.col,P-R,D.cols);h((0,Cg.sheetGridRange)(w,A))},J=0;J<V.length;J+=1){var $=(L=V[J],L.start),Z=L.end,ie=J===0?D.row:V[J-1].end;(0,Cm.assertTrue)("calc.runtime.FunctionDispatcher.dereferenceAllOpersInner: valid interval",ie<=$&&$<Z&&Z<=D.row+D.rows),ie!==$&&ne(ie,$);var X=(0,Cg.gridRange)($,D.col,Z-$,D.cols);s.precedents.cells.push((0,Cg.sheetGridRange)(w,X))}var Q=V[V.length-1].end;Q!==D.row+D.rows&&ne(Q,D.row+D.rows)},k=0;k<m.ranges.length;k+=1){var x=B(k);if(typeof x=="object")return x}},C=0;C<S.length;C+=1){var E=y(C);if(typeof E=="object")return E}t.push({kind:kyr.DerefOperKind.RangeValues,arrays:v})},s=this,c=0;c<r.length;c+=1){var l=d(c);if(typeof l=="object")return l.value}return u.length>0?(0,mo.throwEvaluationError)((0,mo.unevaluated)(u)):t},e.prototype.dereferenceAllOpers=function(r,n){return this.dereferenceAllOpersInner(r,uw.identity,n)},e.prototype.dereferenceAllOpersAndFormulae=function(r,n){var a=this;return this.dereferenceAllOpersInner(r,function(o,u){return new Ayr.NonstrictSparseArray2D(o.rows,o.cols,o.denseRows,o.denseCols,function(t,d){var s=o.get(t,d),c=(0,Cg.sheetGridCell)(u.sheet,(0,Cg.gridCell)(u.range.row+t,u.range.col+d));return[s,a.getAvailableFormula(c)]},function(){return[o.getSparse(),void 0]}).strict()},n)},e.prototype.parseFormula=function(r,n,a,o){var u=this.context.parser.parseFormula((0,xyr.parseLocals)(a.lexicalKind,n,{refStyle:r}),o);if(!(0,Do.isSuccess)(u))return u;var t=this.context.analyzer.checkFormula(a,u.value);if(!(0,Do.isSuccess)(t))return t;if(!(0,jp.isWellFormed)(t.value))return(0,Do.failure)((0,Oyr.illFormedFormula)("ill-formed indirect formula","indirect"));var d=t.value;return t},e.prototype.getRandom=function(){this.precedents.special|=Os.SpecialPrecs.Calc;var r=this.internalContext,n=this.globals.getRandom(r);return(0,Do.isSuccess)(n)||(0,mo.throwEvaluationError)(n.reason),n.value},e.prototype.getTime=function(r){this.precedents.special|=Os.SpecialPrecs.Time;var n=this.globals.getTime(r,sw.GetTimeKind.Volatile);return(0,Do.isSuccess)(n)||(0,mo.throwEvaluationError)(n.reason),n.value},e.prototype.coerceOper=function(r,n){return(0,Gyr.coerceOper)(this,r,n)},e.prototype.parseGeneral=function(r,n){var a,o=this.numberFormatter.parseGeneral(r,!1,n,sw.GetTimeKind.NonVolatile);return(0,Do.isSuccess)(o)||(0,mo.throwEvaluationError)(o.reason),(a=o.value)===null||a===void 0?void 0:a.value},e.prototype.parseDate=function(r){var n,a=this.numberFormatter.parseDate(r,sw.GetTimeKind.NonVolatile);return(0,Do.isSuccess)(a)||(0,mo.throwEvaluationError)(a.reason),(n=a.value)===null||n===void 0?void 0:n.value},e.prototype.getBinaryOperator=function(r){var n=this,a=(0,hG.getOperatorType)(r),o=[_g.falseOper,_g.falseOper];return function(u,t){o[0]=u,o[1]=t,(0,yO.dereferenceOpers)(n,o,a);var d=n.dispatchFunction((0,SO.operatorIdToName)(r),a,!1,o);return(0,Cm.assertTrue)("calc.runtime.FunctionDispatcher.getBinaryOperator",(0,v$.isOperTerm)(d)),d}},e.prototype.getUnaryOperator=function(r){var n=this,a=(0,hG.getOperatorType)(r),o=[_g.falseOper];return function(u){o[0]=u,(0,yO.dereferenceOpers)(n,o,a);var t=n.dispatchFunction((0,SO.operatorIdToName)(r),a,!1,o);return(0,Cm.assertTrue)("calc.runtime.FunctionDispatcher.getUnaryOperator",(0,v$.isOperTerm)(t)),t}},e.prototype.isInFilterMode=function(r){this.precedents.special|=Os.SpecialPrecs.InFilterMode;for(var n=0,a=r;n<a.length;n++){var o=a[n];if((0,jp.isRangeOper)(o))for(var u=0,t=this.getSheetRangeIndexes(o.sheets);u<t.length;u++){var d=t[u],s=this.globals.isInFilterMode((0,Cg.sheetIndex)(o.sheets.document,d));if(!(0,Do.isSuccess)(s))return(0,mo.throwEvaluationError)(s.reason);if(s.value)return!0}}return!1},e.prototype.printFormula=function(r,n){var a=(0,Cg.sheetGridCell)(r.source.range.sheet,n),o=(0,qyr.adjustFormulaOrigin)(this.globals,(0,Byr.analyzeLocalsGrid)(Cg.LexicalKind.Cell,(0,jp.sheetGridRangeAnchor)(r.source.range)),n,r.formula);if(!(0,Do.isSuccess)(o))return(0,mo.throwEvaluationError)(o.reason);var u=this.context.printer.printFormula((0,Vyr.printLocalsGrid)(r.source,a,{refStyle:this.config.refStyle}),o.value);return(0,Do.isSuccess)(u)?u.value:(0,mo.throwEvaluationError)(u.reason)},e.prototype.applyFormat=function(r,n,a,o){var u;if(typeof n=="number"){var t=this.globals.getKnownFormat(r,n);if(!(0,Do.isSuccess)(t))return(0,mo.throwEvaluationError)(t.reason);u=t.value}else{var d=(0,v_e.getFormatString)(this.context.numberFormatter,this.globals,r,n,o);if(!(0,Do.isSuccess)(d))switch(d.reason.kind){case sw.FormatReasonKind.PreviousFormatFailure:case sw.FormatReasonKind.NotFormatString:return;default:return(0,mo.throwEvaluationError)(d.reason)}u=d.value}var s=(0,v_e.renderFormat)(this.context.numberFormatter,u,a);if(!(0,Do.isSuccess)(s))return(0,mo.throwEvaluationError)(s.reason);if(typeof s.value=="string")return s.value},e.internalPosition=g$.runtimePositionFirstOrderFunc,e}()});var RG=Y(V1=>{"use strict";_();Object.defineProperty(V1,"__esModule",{value:!0});V1.EvaluationRuntime=V1.runtimeTimer=V1.calculateNextDeadline=V1.createSchedule=void 0;var yG=zo(),K1=hg(),_G=_f(),CG=cd(),Wyr=ow(),jyr=Bd();function Hyr(e){var r=e.yieldIntervalMs,n=e.totalTimeMs==null?void 0:(0,_G.now)()+e.totalTimeMs,a=e.scheduleFunction!=null?e.scheduleFunction:function(o){return setTimeout(o,0)};return{yieldIntervalMs:r,endTimeMs:n,scheduleFunction:a}}V1.createSchedule=Hyr;function lw(e){if(!(e.yieldIntervalMs===void 0&&e.endTimeMs===void 0)){if(e.yieldIntervalMs===void 0)return e.endTimeMs;var r=(0,_G.now)()+e.yieldIntervalMs;return e.endTimeMs===void 0?r:(0,_G.fastMin)(e.endTimeMs,r)}}V1.calculateNextDeadline=lw;function Qyr(){return{doTimeout:function(r){return r!==void 0&&(0,_G.now)()>=r}}}V1.runtimeTimer=Qyr;var zyr={kind:K1.ReasonKind.Timeout},Yyr={kind:K1.ReasonKind.Breakpoint},Jyr=function(){function e(r,n){(0,yG.assertPositiveInteger)("calc.runtime.EvaluationRuntime",n.length),this.context=r,this.machineRuntimes=n.map(function(a){return new CG.MachineRuntime(a)}),this.results=[]}return e.prototype.evaluateAsync=function(r){var n=this;if(this.context.globals.interruptToken[0]===K1.Interrupt.Stop)return this.generatePartialResults(),Promise.resolve(this.results);if(this.context.timer.doTimeout(r.endTimeMs))return this.generatePartialResults(),Promise.resolve(this.results);try{var a=this.evaluate(lw(r));return Array.isArray(a)?Promise.resolve(a):((0,yG.assertTrue)("calc.runtime.EvaluationRuntime.evaluateAsync",a.kind===K1.ReasonKind.Timeout),new Promise(function(o,u){return r.scheduleFunction(function(){try{o(n.evaluateAsync(r))}catch(t){u(t)}})}))}catch(o){return Promise.reject(o)}},e.prototype.evaluateSync=function(r){var n=this,a=function o(u){if(n.context.globals.interruptToken[0]===K1.Interrupt.Stop||n.context.timer.doTimeout(r.endTimeMs))return n.generatePartialResults(),n.results;var t=n.evaluate(u);if(Array.isArray(t))return t;switch(t.kind){case K1.ReasonKind.Timeout:return(0,K1.paused)(function(d){return o(d??lw(r))});case K1.ReasonKind.Breakpoint:return(0,K1.breaked)(function(){return o(lw(r))});default:return(0,yG.assertNever)("calc.runtime.EvaluationRuntime.evaluateSync",t)}};return a(lw(r))},e.prototype.evaluate=function(r){var n=this,a=function(){return n.context.timer.doTimeout(r)};try{for(;this.results.length<this.machineRuntimes.length;){var o=this.machineRuntimes[this.results.length].run(a);if(o.kind===CG.TransitionKind.Next)return zyr;if(o.kind===CG.TransitionKind.Break)return Yyr;this.pushResult(o)}return this.results}catch(t){var u="calc.runtime.EvaluationRuntime.evaluate: unhandled error ".concat((0,Wyr.messageFromError)(t));return(0,yG.assertFalse)(u)}},e.prototype.pushResult=function(r){return this.results.push(r),CG.nextTransition},e.prototype.generatePartialResults=function(){for(;this.results.length<this.machineRuntimes.length;)this.results.push((0,jyr.failure)(K1.stopped))},e}();V1.EvaluationRuntime=Jyr});var NG=Y(EG=>{"use strict";_();Object.defineProperty(EG,"__esModule",{value:!0});EG.createCellEvaluationMachine=void 0;var TG=zo(),y_e=hg(),bG=zs(),C_e=zs(),Xyr=cd(),__e=Bd(),Zyr=D1(),$yr=D1(),eCr=Ic(),b_e=nw(),rCr=_o(),PG=GC(),JR=ao(),nCr=qd(),R_e=jC(),T_e=HP(),tCr=function(){function e(r,n,a,o){this.context=r,this.stepConfig=n,this.visitedCells=a,this.cell=o}return e.prototype.evalCell=function(){var r=this.context.globals.getCellValue(this.cell);if(r.kind===__e.ResultKind.Failure)return{kind:bG.CellEvaluationResultKind.ReadFailure,failure:r};var n=r.value;if(n.kind===y_e.CellKind.FinalValue)return{kind:bG.CellEvaluationResultKind.ReadOper};var a=this.context.globals.getCellFormula(n.anchor);if(a.kind===__e.ResultKind.Failure){var o="calc.runtime.CellEvaluationMachine.next: unexpected Failure from getCellFormula";return(0,TG.assertFalse)(o)}var u=a.value;if(u==null){var t="client error: expected getCellFormula(".concat((0,PG.anonymize)(n.anchor),") != null"),o="calc.runtime.CellEvaluationMachine.next: ".concat(t);return(0,TG.assertFalse)(o)}var d=this.visitAnchor(u),s=this.context.createFormulaEvaluationMachine(this.context,this.stepConfig,(0,C_e.evalLocalsGrid)(d.source),d.precedents,(0,$yr.appendVisitedCell)(this.visitedCells,d),Zyr.emptyVisitedNames,Xyr.readOperType,u.formula);return b_e.Pledge.fromMachine(s).bind(this.receiveSuccess(d)).catch(this.receiveFailure(d))},e.prototype.visitAnchor=function(r){var n=(0,JR.sheetGridRangeAnchor)(r.source.range),a=this.visitedCells.map.getValue(n);if(a!=null){var o="unexpected visitValue at ".concat((0,PG.anonymize)(n),"; given ").concat((0,PG.anonymize)(a)),u="calc.runtime.CellEvaluationMachine.visitAnchor: ".concat(o);return(0,TG.assertFalse)(u)}return{cell:n,cycle:void 0,previous:this.visitedCells.current,source:r.source,precedents:(0,C_e.bottomEvalPrecedents)()}},e.prototype.receiveSuccess=function(r){var n=this;return function(a){if((0,JR.isRangeOper)(a)||(0,JR.isMissingOper)(a)){var o="expected ReadOper; given ".concat((0,PG.anonymize)(a)),u="calc.runtime.CellEvaluationMachine.receiveSuccess: ".concat(o);return(0,TG.assertFalse)(u)}return n.writeSuccess(r.source,a,r.precedents)}},e.prototype.receiveFailure=function(r){var n=this;return function(a){var o=a.kind===y_e.ReasonKind.PreviousFailure&&r.cycle!==void 0?r.cycle:a;return n.writeFailure(r.source,o,r.precedents)}},e.prototype.writeSuccess=function(r,n,a){return this.setCellValue(r,n,a),{kind:bG.CellEvaluationResultKind.WroteOper,source:r}},e.prototype.writeFailure=function(r,n,a){return this.context.globals.setCellFailure(r.range,n,a),{kind:bG.CellEvaluationResultKind.WroteFailure,source:r}},e.prototype.setCellValue=function(r,n,a){var o=this.context.globals.config.mathpack.zero,u=(0,JR.isBlankOper)(n)?o:n;if(r.kind===eCr.LexicalKind.Cell){if((0,JR.isArrayOper)(u)){var t=u.opers[0]===void 0?rCr.naErrorOper:u.opers[0][0],d=(0,JR.isBlankOper)(t)?o:t;return this.isLambdaEnabled(r,d,a)?this.context.globals.setCellValue(r.range,d,a):void 0}return this.isLambdaEnabled(r,u,a)?this.context.globals.setCellValue(r.range,u,a):void 0}var s=r.range.range,c=(0,nCr.broadcastWriteOper)(s.rows,s.cols,u).opers,l=function(m){return(0,JR.isBlankOper)(m)?o:m},f=c.map(function(p){return p.map(l)});if(this.isLambdaEnabled(r,f,a))return this.context.globals.setCellValues(r.range,f,a)},e.prototype.isLambdaEnabled=function(r,n,a){return!(Array.isArray(n)?n.some(function(o){return o.some(function(u){return u instanceof R_e.LambdaOper})}):n instanceof R_e.LambdaOper)||(0,T_e.isFeatureEnabled)(T_e.FeatureName.CalcLambdaCellValues)?!0:(this.context.globals.setCellFailure(r.range,(0,JR.notImplemented)(["LAMBDA cell values"]),a),!1)},e}();function aCr(e,r,n,a){return b_e.Pledge.try(function(){return new tCr(e,r,n,a).evalCell()})}EG.createCellEvaluationMachine=aCr});var kG=Y(TO=>{"use strict";_();Object.defineProperty(TO,"__esModule",{value:!0});TO.createCallTermEvaluationMachine=TO.createFormulaEvaluationMachine=void 0;var XR=zo(),QC=hg(),iCr=zs(),oCr=zs(),O_e=zs(),uCr=zs(),cw=zs(),Ef=zs(),S$=_f(),y$=cd(),sS=Bd(),P_e=D1(),sCr=Ic(),lCr=Ic(),hl=_o(),HC=GC(),zC=ao(),E_e=qd(),cCr=jC(),N_e=HP(),Li=oS(),C$=h$(),AG=lG(),R$=Bl(),_$=XU(),k_e=tG(),W1=qd(),_O=GU(),RO=mO(),OG=Sm(),dCr=function(){return(0,Ef.throwEvaluationError)((0,zC.notImplemented)(["LETREC cycle"]))};function fCr(e,r,n,a,o){var u=(0,O_e.stackFrameList)(e,r,n,a,o);return{stack:new uCr.ES5IterableStackFrame(u)}}function A_e(e,r){return{context:e,holeIndex:0,locals:r}}var F_e=function(){function e(r,n,a,o,u,t,d,s,c,l,f){this.context=r,this.stepConfig=n,this.locals=a,this.precedents=o,this.visitedCells=u,this.visitedNames=t,this.usage=d,this.target=s,this.isNested=c,this.runStatus=!1,this.stackEnv=cw.emptyStackEnv,this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=void 0,this.continuation=[],l.kind!==Li.TermKind.CallLambda&&l.kind!==Li.TermKind.CallFirstOrderFunc?(this.term=n!=null?(0,Li.noopTerm)(l,void 0):l,this.caller=void 0):((0,XR.assertTrue)("calc.runtime.FormulaEvaluationMachine.constructor: no preStep for CallTerm",l.position===void 0),this.term=l,this.caller=l.data.caller.caller),this.initialLambdaDepth=d.lambdaDepth,f.length>0&&(this.stackEnv=f.reduce(function(p,m){var v=m.value;return p.setValue(p.getCount(),v)},this.stackEnv),this.stackMapLabels=f.map(function(p){var m=p.label;return m}),this.stackMapNumPushed=f.length)}return Object.defineProperty(e.prototype,"globals",{get:function(){return this.context.globals},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numberFormatter",{get:function(){return this.context.numberFormatter},enumerable:!1,configurable:!0}),e.prototype.next=function(){try{return this.doNext()}catch(r){if(r instanceof Ef.EvaluationError)return(0,Ef.handleEvaluationError)(this.context,this.visitedCells,r.reason);throw r}},e.prototype.receiveResult=function(r){return(0,sS.isSuccess)(r)?this.updateTermTransition(r.value):r},e.prototype.doNext=function(){if((0,Li.isOperTerm)(this.term)){var r=this.continuation;if(r.length===0){(0,XR.assertTrue)("calc.runtime.FormulaEvaluationMachine.doNext: lambdaDepth correctly decremented",this.usage.lambdaDepth===this.initialLambdaDepth);var n=(0,AG.dereferenceOper)(this,this.term,this.target),a=(0,_$.coerceOper)(this,n,this.target);return this.precedents.bound=hl.PrecsBound.Exact,(0,N_e.isFeatureEnabled)(N_e.FeatureName.CalcPreventSpillingHack)&&!this.isNested&&this.locals.lexicalSource.kind===lCr.LexicalKind.Cell&&(0,zC.isArrayOper)(a)&&(a.rows!==1||a.cols!==1)?(0,sS.failure)((0,zC.notImplemented)(["spilling"])):(0,sS.success)(a)}var o=r[r.length-1];return this.applyContinuation(this.term,o)}return this.reduceFormula(this.term)},e.prototype.applyContinuation=function(r,n){var a,o=n.context;switch(o.kind){case Li.TermKind.App:{var u=n.holeIndex,t=o.children.length,d=n.locals;return d[u]=r,u+1<t?this.nextHoleTransition(n,o.children[u+1]):this.dispatchFunction(d,o.data,o.position)}case Li.TermKind.Conditional:{var u=n.holeIndex;if(u===0){var s=(0,Li.worksheetFunctionNameToId)(o.data.funName),c=s===OG.WorksheetFuncId.IF?R$.OperKind.Boolean:R$.OperKind.Number,l=(0,AG.dereferenceOper)(this,r,c);if((0,zC.isArrayOper)(l))return n.locals=[l],this.nextHoleTransition(n,o.children[u+1]);if((0,zC.isRichOper)(l))return(0,sS.failure)((0,zC.notImplemented)(["IF/CHOOSE with a rich value condition"]));if(l=(0,_$.coerceOper)(this,l,c),s===OG.WorksheetFuncId.IF&&(0,zC.isBooleanOper)(l))return this.popContextTransition(o.children[l.value?1:2]);if(s===OG.WorksheetFuncId.CHOOSE&&(0,zC.isNumberOper)(l)){var f=this.context.globals.config.mathpack.fix(l);if(f<1||f>o.children.length-1){var p="CHOOSE; out of bounds option = ".concat((0,HC.anonymize)(f));return(0,W1.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.applyContinuation",hl.ErrorType.VALUE,p),this.popContextTransition(hl.valueErrorOper)}return this.popContextTransition(o.children[f])}return(0,XR.assertTrue)("calc.runtime.FormulaEvaluationMachine.applyContinuation",(0,zC.isErrorOper)(l)),this.popContextTransition(l)}var d=n.locals;return d[u]=r,u+1<o.children.length?this.nextHoleTransition(n,o.children[u+1]):this.dispatchFunction(d,o.data,o.position)}case Li.TermKind.CallName:{var m=n.locals;return this.locals=m.locals,this.caller=m.caller,this.restoreStack(m),this.visitedNames=m.visitedNames,this.popContextTransition(r)}case Li.TermKind.Let:{var u=n.holeIndex,v=o.children.length-1;if(u>=v){var m=n.locals;return this.restoreStack(m),this.popContextTransition(r)}if(o.data.rec){var h=this.stackEnv.getCount()-v+u;this.stackEnv.getValue(h).value=r,this.stackEnv=this.stackEnv.setValue(h,r)}else this.stackEnv=this.stackEnv.setValue(this.stackEnv.getCount(),r),this.stackMapNumPushed+=1;return u+1>=v&&this.isLetTcoPossible()?this.popContextTransition(o.children[u+1]):this.nextHoleTransition(n,o.children[u+1])}case Li.TermKind.Array:{var S=(0,AG.dereferenceOper)(this,r,E_e.writeOperType),y=o.data,C=y.rows,E=y.cols,I=n.holeIndex,F=I%E,w=E===F+1,B=(I-F)/E,k=n.locals;if(k[B][F]=(0,_$.coerceOper)(this,S,E_e.writeOperType),C===B+1&&w)return this.popContextTransition((0,hl.arrayOper)(C,E,k));var x=w?B+1:B,G=w?0:F+1;return this.nextHoleTransition(n,o.children[x][G])}case Li.TermKind.CallLambda:{var m=n.locals;return this.locals=m.locals,this.caller=m.caller,this.restoreStack(m),this.usage.lambdaDepth-=1,this.popContextTransition(r)}case Li.TermKind.CallFirstOrderFunc:{var m=n.locals;return this.locals=m.locals,this.caller=m.caller,this.restoreStack(m),this.popContextTransition(r)}case Li.TermKind.PostStep:{var H=n.locals;return(a=this.stepConfig)===null||a===void 0||a.postStep(H,r),this.popContextTransition(r)}default:return(0,XR.assertNever)("calc.runtime.FormulaEvaluationMachine.applyContinuation",o)}},e.prototype.reduceFormula=function(r){var n,a;switch(r.kind){case Li.TermKind.CellRef:return this.updateTermTransition(this.evalCellRefTerm(r));case Li.TermKind.StructRef:return this.updateTermTransition(this.evalStructRefTerm(r));case Li.TermKind.App:{var o=r.data.funName;if(!(0,Li.isOperatorName)(o)){var u=(0,Li.worksheetFunctionNameToId)(o);if(u!==OG.WorksheetFuncId._UDF){var t=this.globals.getWorksheetFunc(u);if(t.kind===sS.ResultKind.Failure)return(0,Ef.throwEvaluationError)(t.reason)}}if(r.children.length===0){var d=new C$.FunctionDispatcher(this.context,this.stepConfig,this.locals,this.stackFrameList(r.position),this.precedents,this.visitedCells,this.visitedNames,this.usage),s=d.dispatchFunction(o,r.data.funType,r.data.isFormulaRoot,[]);return this.updateTermTransition(s)}return this.pushContextTransition(r,r.children[0],[])}case Li.TermKind.CallLambda:{var c=this.isCallLambdaTcoPossible();if(this.usage.lambdaCalls[0]+1>((n=this.globals.limits.maxLambdaCalls)!==null&&n!==void 0?n:1/0))return(0,Ef.throwEvaluationError)((0,QC.limitExceeded)(QC.LimitKind.LambdaCalls));if(!c&&this.usage.lambdaDepth+1>((a=this.globals.limits.maxLambdaDepth)!==null&&a!==void 0?a:1/0))return(0,Ef.throwEvaluationError)((0,QC.limitExceeded)(QC.LimitKind.LambdaDepth));c||(this.usage.lambdaDepth+=1),this.usage.lambdaCalls[0]+=1;var l=this.stackEnv;this.stackEnv=r.data.capturedStackEnv;var f=this.stackMapList();this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=r.data.capturedStackMap;var p=this.locals;this.locals=(0,Ef.evalLocalsLambda)(r.data.capturedLocals,this.locals);var m=this.caller;return this.switchCaller(r.data.caller,c),c?this.updateTermTransition(r.children):this.pushContextTransition(r,r.children,{locals:p,caller:m,stackEnv:l,stackMap:f})}case Li.TermKind.CallFirstOrderFunc:{var p=this.locals;this.locals=(0,iCr.evalLocalsFirstOrderFunc)(r.data.source,this.locals);var m=this.caller;this.switchCaller(r.data.caller,!1);var l=this.stackEnv;this.stackEnv=cw.emptyStackEnv;var f=this.stackMapList();return this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=void 0,this.pushContextTransition(r,r.children,{locals:p,caller:m,stackEnv:l,stackMap:f})}case Li.TermKind.CallMachine:return(0,y$.callMachineTransition)(r.data.machine,this);case Li.TermKind.Conditional:return this.pushContextTransition(r,r.children[0],void 0);case Li.TermKind.Let:{var v=r.children.length-1;if(v===0)return this.updateTermTransition(r.children[0]);var l=this.stackEnv,f=this.stackMapList();if(this.stackMapLabels=r.data.varLabels,this.stackMapNumPushed=0,this.stackMapNext=f,r.data.rec){for(var h=0;h<v;h+=1)this.stackEnv=this.stackEnv.setValue(this.stackEnv.getCount(),new cw.LazyOper(dCr));this.stackMapNumPushed+=v}return this.pushContextTransition(r,r.children[0],{stackEnv:l,stackMap:f})}case Li.TermKind.Name:return this.updateTermTransition(this.evalNameTerm(r));case Li.TermKind.CallName:{var S=r.data.loc,y=this.checkForNameCycle(S),C=this.stackFrameList(r.position),p=this.locals;this.locals=(0,Ef.evalLocalsName)((0,sCr.lexicalSourceName)(S),p);var m=this.caller;this.switchCaller(C,!1);var l=this.stackEnv;this.stackEnv=cw.emptyStackEnv;var f=this.stackMapList();this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=void 0;var E=this.visitedNames;return this.visitedNames=y,this.pushContextTransition(r,r.children,{locals:p,caller:m,stackEnv:l,stackMap:f,visitedNames:E})}case Li.TermKind.Udf:return this.updateTermTransition(this.evalUdfTerm(r));case Li.TermKind.ReadStack:{var I=this.stackEnv.getValue(this.stackEnv.getCount()-1-r.data);return(0,XR.assertTrue)("calc.runtime.FormulaEvaluationMachine.reduceFormula: ReadStack oper",I!==void 0),this.updateTermTransition(I instanceof cw.LazyOper?I.value:I)}case Li.TermKind.Array:return this.pushContextTransition(r,r.children[0][0],r.children.map(function(){return[]}));case Li.TermKind.Lambda:return this.updateTermTransition(new cCr.LambdaOper(r.data.minArity,r.data.maxArity,r.position,r.data.paramNodeLabels,r.data.paramNameLabels,this.locals,this.stackEnv,this.stackMapList(),r.data.defIdxs,r.children));case Li.TermKind.Noop:return this.updateTermTransition(r.children);default:return(0,XR.assertNever)("calc.runtime.FormulaEvaluationMachine.reduceFormula",r)}},e.prototype.dispatchFunction=function(r,n,a){var o=n.funName,u=n.funType,t=n.isFormulaRoot;(0,AG.dereferenceOpers)(this,r,u);var d=new C$.FunctionDispatcher(this.context,this.stepConfig,this.locals,this.stackFrameList(a),this.precedents,this.visitedCells,this.visitedNames,this.usage),s=d.dispatchFunction(o,u,t,r);return this.popContextTransition(s)},e.prototype.stackFrameList=function(r){return(0,O_e.stackFrameList)(this.locals.lexicalSource,r,this.stackEnv,this.stackMapList(),this.caller)},e.prototype.stackMapList=function(){return this.stackMapLabels!==void 0&&this.stackMapNumPushed!==0?(0,oCr.stackMapList)(this.stackMapLabels,this.stackMapNumPushed,this.stackMapNext):this.stackMapNext},e.prototype.noopTerm=function(r,n){return this.stepConfig!=null?(0,Li.noopTerm)(r,n):r},e.prototype.pushContextTransition=function(r,n,a){var o=A_e(r,a);return this.continuation.push(o),this.updateTermTransition(n)},e.prototype.popContextTransition=function(r){return this.continuation.pop(),this.updateTermTransition(r)},e.prototype.nextHoleTransition=function(r,n){var a=r;return a.holeIndex+=1,this.updateTermTransition(n)},e.prototype.updateTermTransition=function(r){if(this.term=r,this.stepConfig!=null&&!(0,Li.isOperTerm)(r)&&r.position!==void 0&&r.kind!==Li.TermKind.Name&&r.kind!==Li.TermKind.Udf){var n=fCr(this.locals.lexicalSource,r.position,this.stackEnv,this.stackMapList(),this.caller);this.continuation.push(A_e(Li.postStepTerm,n));var a=this.stepConfig.preStep(n);if(a===QC.StepAction.Break)return y$.breakTransition}return y$.nextTransition},e.prototype.switchCaller=function(r,n){(0,XR.assertTrue)("calc.runtime.FormulaEvaluationMachine.switchCaller: correct nesting",r.caller===this.caller),n||(this.caller=r)},e.prototype.restoreStack=function(r){var n,a=r.stackEnv,o=r.stackMap;this.stackEnv=a,this.stackMapLabels=o==null?void 0:o.labels,this.stackMapNumPushed=(n=o==null?void 0:o.numPushed)!==null&&n!==void 0?n:0,this.stackMapNext=o==null?void 0:o.next},e.prototype.isLetTcoPossible=function(){var r=this.continuation[this.continuation.length-2];if(r===void 0)return!1;var n=r.context;if(n.kind===Li.TermKind.Let){var a=r.holeIndex,o=n.children.length-1;return a>=o}return n.kind===Li.TermKind.CallLambda||n.kind===Li.TermKind.CallName},e.prototype.isCallLambdaTcoPossible=function(){var r=this.continuation[this.continuation.length-1];if(r===void 0)return!1;var n=r.context;return n.kind===Li.TermKind.CallLambda},e.prototype.getNameFormulaAsTerm=function(r,n){var a=this.globals.getNameFormula(r,n);if(a.kind===sS.ResultKind.Failure)return(0,Ef.throwEvaluationError)(a.reason);var o=a.value;if(o!=null)return(0,k_e.compiledFormulaTerm)("calc.runtime.FormulaEvaluationMachine.getNameFormulaAsTerm",o)},e.prototype.checkForNameCycle=function(r){var n,a=this.visitedNames,o=a.map.getValue(r);if(o!==void 0){var u=(0,P_e.recordNameCycle)(o,a.current);return(0,Ef.throwEvaluationError)(u)}return this.visitedNames.map.getCount()+1>((n=this.globals.limits.maxNameChain)!==null&&n!==void 0?n:1/0)?(0,Ef.throwEvaluationError)((0,QC.limitExceeded)(QC.LimitKind.NameChain)):(0,P_e.appendVisitedName)(this.visitedNames,r)},e.prototype.evalNameTerm=function(r){var n=this.context.resolver.resolveName(this.locals,(0,RO.nameNode)((0,RO.identNamePart)(r.data.name,!0),r.data.qualifier),r.data.source),a=n.resolution,o=n.precedents;if((0,S$.safePush)(this.precedents.names,o),!(0,sS.isSuccess)(a)){if(a.reason.kind===_O.ResolveReasonKind.NoOriginSheet){var u="error ref, no sheet, qualifier = ".concat((0,HC.anonymize)(r.data.qualifier));return(0,W1.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalName",hl.ErrorType.REF,u),this.noopTerm(hl.refErrorOper,r.position)}var t=r.children;return a.reason.kind===_O.ResolveReasonKind.InvalidQualifier&&t!==void 0?t:(0,Ef.throwEvaluationError)(a.reason)}var d=a.value,s;if(d===void 0||(s=this.getNameFormulaAsTerm(d,r.data.source))===void 0){var t=r.children;if(t===void 0){var u="error ref, qualifier = ".concat((0,HC.anonymize)(r.data.qualifier));return(0,W1.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalName",hl.ErrorType.NAME,u),this.noopTerm(hl.nameErrorOper,r.position)}return t}return(0,Li.callNameTerm)(d,this.noopTerm(s,QC.runtimePositionFormulaRoot),r.position)},e.prototype.evalCellRefTerm=function(r){var n=this.context.resolver.resolveCellRef(this.locals,(0,RO.cellRefNode)(r.data.ref,r.data.qualifier)).resolution;if(!(0,sS.isSuccess)(n)){if(n.reason.kind===_O.ResolveReasonKind.NoOriginSheet){var a="error ref, no sheet, qualifier = ".concat((0,HC.anonymize)(r.data.qualifier));return(0,W1.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",hl.ErrorType.REF,a),hl.refErrorOper}return(0,Ef.throwEvaluationError)(n.reason)}var o=n.value;if(!o){var a="error ref, qualifier = ".concat((0,HC.anonymize)(r.data.qualifier));return(0,W1.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",hl.ErrorType.REF,a),hl.refErrorOper}return(0,hl.range3DOper)(o.sheet,o.range)},e.prototype.evalStructRefTerm=function(r){var n=this.context.resolver.resolveStructRef(this.locals,r.data),a=n.resolution,o=n.precedents;if((0,S$.safePush)(this.precedents.names,o),!(0,sS.isSuccess)(a)){if(a.reason.kind===_O.ResolveReasonKind.NoOriginSheet){var u="error ref, no sheet, struct ref = ".concat((0,HC.anonymize)(r.data));return(0,W1.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",hl.ErrorType.REF,u),hl.refErrorOper}if(a.reason.kind===_O.ResolveReasonKind.EmptyIntersection){var u="error ref, empty intersection, struct ref = ".concat((0,HC.anonymize)(r.data));return(0,W1.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",hl.ErrorType.VALUE,u),hl.valueErrorOper}return(0,Ef.throwEvaluationError)(a.reason)}var t=a.value;if(!t){var u="error ref, struct ref = ".concat((0,HC.anonymize)(r.data));return(0,W1.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",hl.ErrorType.REF,u),hl.refErrorOper}return(0,hl.range3DOper)(t.sheet,t.range)},e.prototype.evalUdfTerm=function(r){var n=this.context.resolver.resolveUserDefinedFunc(this.locals,(0,RO.nameNode)((0,RO.identNamePart)(r.data.name,!0),r.data.qualifier)),a=n.resolution,o=n.precedents;if((0,S$.safePush)(this.precedents.udfs,o),!(0,sS.isSuccess)(a)){var u=r.children;if(a.reason.kind===_O.ResolveReasonKind.InvalidQualifier&&u!==void 0)return u;(0,Ef.throwEvaluationError)(a.reason)}var t=a.value;if(!t){var u=r.children;if(u===void 0){var d="UDF resolution, qualifier = ".concat((0,HC.anonymize)(r.data.qualifier));return(0,W1.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalUdfTerm",hl.ErrorType.NAME,d),this.noopTerm(hl.nameErrorOper,r.position)}return u}if(t.length>1){var d="UDF resolution, ambiguous name";return(0,W1.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalUdfTerm",hl.ErrorType.NAME,d),this.noopTerm(hl.nameErrorOper,r.position)}var s=t[0],c=this.globals.getUserDefinedFunc(s);return(0,sS.isSuccess)(c)||(0,Ef.throwEvaluationError)(c.reason),new C$.UdfOper(s,c.value)},e}();function pCr(e,r,n,a,o,u,t,d){var s,c=n.contextNames,l=c===void 0?[]:c,f=d.annotations[d.node.label],p=(s=(f==null?void 0:f.kind)===RO.AnnotationKind.FormulaRoot?f.contextNames:void 0)!==null&&s!==void 0?s:[];return(0,XR.assertTrue)("calc.runtime.FormulaEvaluationMachine.createFormulaEvaluationMachine: contextNames",p.length===l.length&&l.every(function(m,v){return m.label===p[v].label})),new F_e(e,r,n,a,o,u,(0,Ef.evalUsage)([0],0),t,!1,(0,Li.noopTerm)((0,k_e.compiledFormulaTerm)("calc.runtime.createFormulaEvaluationMachine",d),QC.runtimePositionFormulaRoot),l)}TO.createFormulaEvaluationMachine=pCr;function mCr(e,r,n,a,o,u,t,d){return new F_e(e,r,n,a,o,u,(0,Ef.evalUsage)(t.lambdaCalls,t.lambdaDepth),R$.SignatureType.All,!0,d,[])}TO.createCallTermEvaluationMachine=mCr});var T$=Y(FG=>{"use strict";_();Object.defineProperty(FG,"__esModule",{value:!0});FG.createAnalyzer=void 0;var gCr=N0();FG.createAnalyzer=gCr.analyzeService.createAnalyzer});var b$=Y(bO=>{"use strict";_();Object.defineProperty(bO,"__esModule",{value:!0});bO.createPrinter=bO.anonymizeFormula=void 0;var I_e=et();bO.anonymizeFormula=I_e.printService.anonymizeFormula;bO.createPrinter=I_e.printService.createPrinter});var P$=Y(PO=>{"use strict";_();Object.defineProperty(PO,"__esModule",{value:!0});PO.resolveGridRef=PO.createResolver=void 0;var M_e=et();PO.createResolver=M_e.resolveService.createResolver;PO.resolveGridRef=M_e.resolveService.resolveGridRef});var MG=Y(IG=>{"use strict";_();Object.defineProperty(IG,"__esModule",{value:!0});IG.createNumberFormatter=void 0;var vCr=gm();IG.createNumberFormatter=vCr.formatService.createNumberFormatter});var E$=Y(wG=>{"use strict";_();Object.defineProperty(wG,"__esModule",{value:!0});wG.createParser=void 0;var hCr=N0();wG.createParser=hCr.parserService.createParser});var D_e=Y(xG=>{"use strict";_();Object.defineProperty(xG,"__esModule",{value:!0});xG.createNameEvaluationMachine=void 0;var SCr=GC(),yCr=zo(),CCr=Bd(),dw=nw(),w_e=Ic(),_Cr=Bl(),DG=zs(),N$=D1(),RCr=function(){function e(r,n,a,o){this.context=r,this.stepConfig=n,this.name=a,this.origin=o}return e.prototype.evalName=function(){var r=this.context.globals.getNameFormula(this.name,w_e.NameSource.Plain);if(r.kind===CCr.ResultKind.Failure)return dw.Pledge.reject(r.reason);var n=r.value;if(n==null)return dw.Pledge.resolve(void 0);var a=(0,DG.bottomEvalPrecedents)(),o=this.context.createFormulaEvaluationMachine(this.context,this.stepConfig,(0,DG.evalLocalsName)((0,w_e.lexicalSourceName)(this.name),(0,DG.evalLocalsGrid)(this.origin)),a,N$.emptyVisitedCells,(0,N$.appendVisitedName)(N$.emptyVisitedNames,this.name),_Cr.SignatureType.All,n);return dw.Pledge.fromMachine(o).catch(this.receiveFailure())},e.prototype.receiveFailure=function(){return function(r){if(r.kind===DG.RuntimeInternalReasonKind.Unevaluated){var n="unexpected reason ".concat((0,SCr.anonymize)(r)),a="calc.runtime.NameEvaluationMachine.receiveFailure: ".concat(n);return(0,yCr.assertFalse)(a)}return dw.Pledge.reject(r)}},e}();function TCr(e,r,n,a){return dw.Pledge.try(function(){return new RCr(e,r,n,a).evalName()})}xG.createNameEvaluationMachine=TCr});var j_e=Y(Hp=>{"use strict";_();Object.defineProperty(Hp,"__esModule",{value:!0});Hp.createEvaluator=Hp.evalName=Hp.evalCellsAsync=Hp.evalCells=Hp.evalFormula=Hp.evaluationMachineContext=Hp.runtimeEvaluationContext=void 0;var bCr=T$(),PCr=GC(),ECr=zo(),A$=Bd(),NCr=b$(),ACr=P$(),x_e=ao(),OCr=MG(),kCr=E$(),B_e=NG(),O$=kG(),FCr=D_e(),ZR=RG(),L_e=zs(),ICr=cd(),MCr=cd(),LG=hg(),k$=D1();function BG(e){return{globals:e,timer:(0,ZR.runtimeTimer)(),machineContext:q_e(e)}}Hp.runtimeEvaluationContext=BG;function q_e(e){return{globals:e,resolver:(0,ACr.createResolver)(e),numberFormatter:(0,OCr.createNumberFormatter)(e),parser:(0,kCr.createParser)(e),printer:(0,NCr.createPrinter)(e),analyzer:(0,bCr.createAnalyzer)(e),createCellEvaluationMachine:B_e.createCellEvaluationMachine,createFormulaEvaluationMachine:O$.createFormulaEvaluationMachine,createCallTermEvaluationMachine:O$.createCallTermEvaluationMachine}}Hp.evaluationMachineContext=q_e;function F$(e){if(Array.isArray(e)){var r=e[0];if(r.kind===A$.ResultKind.Success){if((0,x_e.isRangeOper)(r.value)||(0,x_e.isMissingOper)(r.value)){var n="expected ReadOper; given ".concat((0,PCr.anonymize)(r)),a="calc.runtime.evalFormula: ".concat(n);return(0,ECr.assertFalse)(a)}return r}return r}return e.kind===A$.ResultKind.Paused?(0,LG.paused)(function(o){return F$(e.resume(o))}):(0,LG.breaked)(function(){return F$(e.resume())})}function U_e(e,r,n){var a,o=BG(e),u=(0,L_e.bottomEvalPrecedents)(),t=(0,O$.createFormulaEvaluationMachine)(o.machineContext,r.stepConfig,(0,L_e.evalLocalsSlice)(r),u,k$.emptyVisitedCells,k$.emptyVisitedNames,MCr.readOperType,n),d=new ZR.EvaluationRuntime(o,[t]),s=(0,ZR.createSchedule)((a=r.schedulerConfig)!==null&&a!==void 0?a:e.schedulerConfig);return F$(d.evaluateSync(s))}Hp.evalFormula=U_e;function G_e(e,r,n){for(var a=BG(e),o=[],u=0;u<n.length;u+=1)o.push(new ICr.VoidMachine((0,B_e.createCellEvaluationMachine)(a.machineContext,r,k$.emptyVisitedCells,n[u])));return new ZR.EvaluationRuntime(a,o)}function K_e(e,r,n){var a;if(n.length===0)return[];var o=G_e(e,r.stepConfig,n),u=(0,ZR.createSchedule)((a=r.schedulerConfig)!==null&&a!==void 0?a:e.schedulerConfig);return o.evaluateSync(u)}Hp.evalCells=K_e;function V_e(e,r,n){var a;if(n.length===0)return Promise.resolve([]);var o=G_e(e,void 0,n),u=(0,ZR.createSchedule)((a=r.schedulerConfig)!==null&&a!==void 0?a:e.schedulerConfig);return o.evaluateAsync(u)}Hp.evalCellsAsync=V_e;function I$(e){return Array.isArray(e)?e[0]:e.kind===A$.ResultKind.Paused?(0,LG.paused)(function(r){return I$(e.resume(r))}):(0,LG.breaked)(function(){return I$(e.resume())})}function W_e(e,r,n,a){var o,u=BG(e),t=(0,FCr.createNameEvaluationMachine)(u.machineContext,r.stepConfig,n,a),d=new ZR.EvaluationRuntime(u,[t]),s=(0,ZR.createSchedule)((o=r.schedulerConfig)!==null&&o!==void 0?o:e.schedulerConfig);return I$(d.evaluateSync(s))}Hp.evalName=W_e;function wCr(e){return{evalFormula:function(n,a){return U_e(e,n,a)},evalCells:function(n,a){return K_e(e,n,a)},evalName:function(n,a,o){return W_e(e,n,a,o)},evalCellsAsync:function(n,a){return V_e(e,n,a)}}}Hp.createEvaluator=wCr});var H_e=Y($R=>{"use strict";_();Object.defineProperty($R,"__esModule",{value:!0});$R.featureEnabledDummyCallback=$R.ConsoleLogger=$R.AssertLogger=void 0;var M$=Cn();$R.AssertLogger=M$.testConfig.AssertLogger;$R.ConsoleLogger=M$.testConfig.ConsoleLogger;$R.featureEnabledDummyCallback=M$.testConfig.featureEnabledDummyCallback});var Q_e=Y(sn=>{"use strict";_();Object.defineProperty(sn,"__esModule",{value:!0});sn.fieldRef=sn.fieldRefNamePart=sn.lambdaNode=sn.letNode=sn.nameNode=sn.xorNode=sn.unionNode=sn.subNode=sn.sheet1Name=sn.sheet1=sn.relPos=sn.rangeNode=sn.powNode=sn.poundNode=sn.posNode=sn.percentNode=sn.orNode=sn.negNode=sn.neNode=sn.mulNode=sn.minNode=sn.maxNode=sn.ltNode=sn.leNode=sn.isectNode=sn.isNameLocEqual=sn.gtNode=sn.geNode=sn.expectTrue=sn.eqNode=sn.document1=sn.divNode=sn.createSingleRange=sn.concatNode=sn.badUnexpCharsNode=sn.badStructRefNode=sn.badStringLiteralNode=sn.badUnexpSeqNode=sn.badQualNode=sn.badParamNameNode=sn.badNumberLiteralNode=sn.badFieldRefNode=sn.badFieldNameNode=sn.badErrorLiteralNode=sn.badCellRefNode=sn.badBracketNode=sn.atNode=sn.andNode=sn.addNode=sn.absPos=void 0;var Ua=et();sn.absPos=Ua.testUtil.absPos;sn.addNode=Ua.testUtil.addNode;sn.andNode=Ua.testUtil.andNode;sn.atNode=Ua.testUtil.atNode;sn.badBracketNode=Ua.testUtil.badBracketNode;sn.badCellRefNode=Ua.testUtil.badCellRefNode;sn.badErrorLiteralNode=Ua.testUtil.badErrorLiteralNode;sn.badFieldNameNode=Ua.testUtil.badFieldNameNode;sn.badFieldRefNode=Ua.testUtil.badFieldRefNode;sn.badNumberLiteralNode=Ua.testUtil.badNumberLiteralNode;sn.badParamNameNode=Ua.testUtil.badParamNameNode;sn.badQualNode=Ua.testUtil.badQualNode;sn.badUnexpSeqNode=Ua.testUtil.badUnexpSeqNode;sn.badStringLiteralNode=Ua.testUtil.badStringLiteralNode;sn.badStructRefNode=Ua.testUtil.badStructRefNode;sn.badUnexpCharsNode=Ua.testUtil.badUnexpCharsNode;sn.concatNode=Ua.testUtil.concatNode;sn.createSingleRange=Ua.testUtil.createSingleRange;sn.divNode=Ua.testUtil.divNode;sn.document1=Ua.testUtil.document1;sn.eqNode=Ua.testUtil.eqNode;sn.expectTrue=Ua.testUtil.expectTrue;sn.geNode=Ua.testUtil.geNode;sn.gtNode=Ua.testUtil.gtNode;sn.isNameLocEqual=Ua.testUtil.isNameLocEqual;sn.isectNode=Ua.testUtil.isectNode;sn.leNode=Ua.testUtil.leNode;sn.ltNode=Ua.testUtil.ltNode;sn.maxNode=Ua.testUtil.maxNode;sn.minNode=Ua.testUtil.minNode;sn.mulNode=Ua.testUtil.mulNode;sn.neNode=Ua.testUtil.neNode;sn.negNode=Ua.testUtil.negNode;sn.orNode=Ua.testUtil.orNode;sn.percentNode=Ua.testUtil.percentNode;sn.posNode=Ua.testUtil.posNode;sn.poundNode=Ua.testUtil.poundNode;sn.powNode=Ua.testUtil.powNode;sn.rangeNode=Ua.testUtil.rangeNode;sn.relPos=Ua.testUtil.relPos;sn.sheet1=Ua.testUtil.sheet1;sn.sheet1Name=Ua.testUtil.sheet1Name;sn.subNode=Ua.testUtil.subNode;sn.unionNode=Ua.testUtil.unionNode;sn.xorNode=Ua.testUtil.xorNode;sn.nameNode=Ua.testUtil.nameNode;sn.letNode=Ua.testUtil.letNode;sn.lambdaNode=Ua.testUtil.lambdaNode;sn.fieldRefNamePart=Ua.testUtil.fieldRefNamePart;sn.fieldRef=Ua.testUtil.fieldRef});var qG=Y(He=>{"use strict";_();Object.defineProperty(He,"__esModule",{value:!0});He.codePointExclamationMark=He.codePointEuroSign=He.codePointEqualsSign=He.codePointDoubleQuote=He.codePointDollarSign=He.codePointDigitZero=He.codePointDigitTwo=He.codePointDigitThree=He.codePointDigitSix=He.codePointDigitSeven=He.codePointDigitOne=He.codePointDigitNine=He.codePointDigitFour=He.codePointDigitFive=He.codePointDigitEight=He.codePointComma=He.codePointColon=He.codePointCircumflexAccent=He.codePointCapitalZ=He.codePointCapitalY=He.codePointCapitalX=He.codePointCapitalW=He.codePointCapitalV=He.codePointCapitalU=He.codePointCapitalT=He.codePointCapitalS=He.codePointCapitalR=He.codePointCapitalQ=He.codePointCapitalP=He.codePointCapitalO=He.codePointCapitalN=He.codePointCapitalM=He.codePointCapitalL=He.codePointCapitalK=He.codePointCapitalJ=He.codePointCapitalI=He.codePointCapitalH=He.codePointCapitalG=He.codePointCapitalF=He.codePointCapitalE=He.codePointCapitalD=He.codePointCapitalC=He.codePointCapitalB=He.codePointCapitalA=He.codePointCR=He.codePointBacktick=He.codePointBackslash=He.codePointAtSign=He.codePointAsterisk=He.codePointAmpersand=void 0;He.codePointSmallW=He.codePointSmallV=He.codePointSmallU=He.codePointSmallT=He.codePointSmallS=He.codePointSmallR=He.codePointSmallQ=He.codePointSmallP=He.codePointSmallO=He.codePointSmallN=He.codePointSmallM=He.codePointSmallL=He.codePointSmallK=He.codePointSmallJ=He.codePointSmallI=He.codePointSmallH=He.codePointSmallG=He.codePointSmallF=He.codePointSmallE=He.codePointSmallD=He.codePointSmallC=He.codePointSmallB=He.codePointSmallA=He.codePointSlash=He.codePointSingleQuote=He.codePointSemicolon=He.codePointRightSquareBracket=He.codePointRightParen=He.codePointRightCurlyBracket=He.codePointQuestionMark=He.codePointPlusSign=He.codePointPipe=He.codePointPercentSign=He.codePointMinusSign=He.codePointLessThanSign=He.codePointLeftSquareBracket=He.codePointLeftParen=He.codePointLeftCurlyBracket=He.codePointLF=He.codePointInvertedQuestionMark=He.codePointInvertedExclamationMark=He.codePointHash=He.codePointGreaterThanSign=He.codePointFullwidthLatinSmallZ=He.codePointFullwidthLatinSmallA=He.codePointFullwidthLatinCapitalZ=He.codePointFullwidthLatinCapitalA=He.codePointFullwidthDigitZero=He.codePointFullwidthDigitNine=He.codePointFullStop=void 0;He.codePointUnderscore=He.codePointTilde=He.codePointThaiDigitZero=He.codePointThaiDigitNine=He.codePointTab=He.codePointSpace=He.codePointSmallZ=He.codePointSmallY=He.codePointSmallX=void 0;var rn=Cn();He.codePointAmpersand=rn.codePoint.codePointAmpersand;He.codePointAsterisk=rn.codePoint.codePointAsterisk;He.codePointAtSign=rn.codePoint.codePointAtSign;He.codePointBackslash=rn.codePoint.codePointBackslash;He.codePointBacktick=rn.codePoint.codePointBacktick;He.codePointCR=rn.codePoint.codePointCR;He.codePointCapitalA=rn.codePoint.codePointCapitalA;He.codePointCapitalB=rn.codePoint.codePointCapitalB;He.codePointCapitalC=rn.codePoint.codePointCapitalC;He.codePointCapitalD=rn.codePoint.codePointCapitalD;He.codePointCapitalE=rn.codePoint.codePointCapitalE;He.codePointCapitalF=rn.codePoint.codePointCapitalF;He.codePointCapitalG=rn.codePoint.codePointCapitalG;He.codePointCapitalH=rn.codePoint.codePointCapitalH;He.codePointCapitalI=rn.codePoint.codePointCapitalI;He.codePointCapitalJ=rn.codePoint.codePointCapitalJ;He.codePointCapitalK=rn.codePoint.codePointCapitalK;He.codePointCapitalL=rn.codePoint.codePointCapitalL;He.codePointCapitalM=rn.codePoint.codePointCapitalM;He.codePointCapitalN=rn.codePoint.codePointCapitalN;He.codePointCapitalO=rn.codePoint.codePointCapitalO;He.codePointCapitalP=rn.codePoint.codePointCapitalP;He.codePointCapitalQ=rn.codePoint.codePointCapitalQ;He.codePointCapitalR=rn.codePoint.codePointCapitalR;He.codePointCapitalS=rn.codePoint.codePointCapitalS;He.codePointCapitalT=rn.codePoint.codePointCapitalT;He.codePointCapitalU=rn.codePoint.codePointCapitalU;He.codePointCapitalV=rn.codePoint.codePointCapitalV;He.codePointCapitalW=rn.codePoint.codePointCapitalW;He.codePointCapitalX=rn.codePoint.codePointCapitalX;He.codePointCapitalY=rn.codePoint.codePointCapitalY;He.codePointCapitalZ=rn.codePoint.codePointCapitalZ;He.codePointCircumflexAccent=rn.codePoint.codePointCircumflexAccent;He.codePointColon=rn.codePoint.codePointColon;He.codePointComma=rn.codePoint.codePointComma;He.codePointDigitEight=rn.codePoint.codePointDigitEight;He.codePointDigitFive=rn.codePoint.codePointDigitFive;He.codePointDigitFour=rn.codePoint.codePointDigitFour;He.codePointDigitNine=rn.codePoint.codePointDigitNine;He.codePointDigitOne=rn.codePoint.codePointDigitOne;He.codePointDigitSeven=rn.codePoint.codePointDigitSeven;He.codePointDigitSix=rn.codePoint.codePointDigitSix;He.codePointDigitThree=rn.codePoint.codePointDigitThree;He.codePointDigitTwo=rn.codePoint.codePointDigitTwo;He.codePointDigitZero=rn.codePoint.codePointDigitZero;He.codePointDollarSign=rn.codePoint.codePointDollarSign;He.codePointDoubleQuote=rn.codePoint.codePointDoubleQuote;He.codePointEqualsSign=rn.codePoint.codePointEqualsSign;He.codePointEuroSign=rn.codePoint.codePointEuroSign;He.codePointExclamationMark=rn.codePoint.codePointExclamationMark;He.codePointFullStop=rn.codePoint.codePointFullStop;He.codePointFullwidthDigitNine=rn.codePoint.codePointFullwidthDigitNine;He.codePointFullwidthDigitZero=rn.codePoint.codePointFullwidthDigitZero;He.codePointFullwidthLatinCapitalA=rn.codePoint.codePointFullwidthLatinCapitalA;He.codePointFullwidthLatinCapitalZ=rn.codePoint.codePointFullwidthLatinCapitalZ;He.codePointFullwidthLatinSmallA=rn.codePoint.codePointFullwidthLatinSmallA;He.codePointFullwidthLatinSmallZ=rn.codePoint.codePointFullwidthLatinSmallZ;He.codePointGreaterThanSign=rn.codePoint.codePointGreaterThanSign;He.codePointHash=rn.codePoint.codePointHash;He.codePointInvertedExclamationMark=rn.codePoint.codePointInvertedExclamationMark;He.codePointInvertedQuestionMark=rn.codePoint.codePointInvertedQuestionMark;He.codePointLF=rn.codePoint.codePointLF;He.codePointLeftCurlyBracket=rn.codePoint.codePointLeftCurlyBracket;He.codePointLeftParen=rn.codePoint.codePointLeftParen;He.codePointLeftSquareBracket=rn.codePoint.codePointLeftSquareBracket;He.codePointLessThanSign=rn.codePoint.codePointLessThanSign;He.codePointMinusSign=rn.codePoint.codePointMinusSign;He.codePointPercentSign=rn.codePoint.codePointPercentSign;He.codePointPipe=rn.codePoint.codePointPipe;He.codePointPlusSign=rn.codePoint.codePointPlusSign;He.codePointQuestionMark=rn.codePoint.codePointQuestionMark;He.codePointRightCurlyBracket=rn.codePoint.codePointRightCurlyBracket;He.codePointRightParen=rn.codePoint.codePointRightParen;He.codePointRightSquareBracket=rn.codePoint.codePointRightSquareBracket;He.codePointSemicolon=rn.codePoint.codePointSemicolon;He.codePointSingleQuote=rn.codePoint.codePointSingleQuote;He.codePointSlash=rn.codePoint.codePointSlash;He.codePointSmallA=rn.codePoint.codePointSmallA;He.codePointSmallB=rn.codePoint.codePointSmallB;He.codePointSmallC=rn.codePoint.codePointSmallC;He.codePointSmallD=rn.codePoint.codePointSmallD;He.codePointSmallE=rn.codePoint.codePointSmallE;He.codePointSmallF=rn.codePoint.codePointSmallF;He.codePointSmallG=rn.codePoint.codePointSmallG;He.codePointSmallH=rn.codePoint.codePointSmallH;He.codePointSmallI=rn.codePoint.codePointSmallI;He.codePointSmallJ=rn.codePoint.codePointSmallJ;He.codePointSmallK=rn.codePoint.codePointSmallK;He.codePointSmallL=rn.codePoint.codePointSmallL;He.codePointSmallM=rn.codePoint.codePointSmallM;He.codePointSmallN=rn.codePoint.codePointSmallN;He.codePointSmallO=rn.codePoint.codePointSmallO;He.codePointSmallP=rn.codePoint.codePointSmallP;He.codePointSmallQ=rn.codePoint.codePointSmallQ;He.codePointSmallR=rn.codePoint.codePointSmallR;He.codePointSmallS=rn.codePoint.codePointSmallS;He.codePointSmallT=rn.codePoint.codePointSmallT;He.codePointSmallU=rn.codePoint.codePointSmallU;He.codePointSmallV=rn.codePoint.codePointSmallV;He.codePointSmallW=rn.codePoint.codePointSmallW;He.codePointSmallX=rn.codePoint.codePointSmallX;He.codePointSmallY=rn.codePoint.codePointSmallY;He.codePointSmallZ=rn.codePoint.codePointSmallZ;He.codePointSpace=rn.codePoint.codePointSpace;He.codePointTab=rn.codePoint.codePointTab;He.codePointThaiDigitNine=rn.codePoint.codePointThaiDigitNine;He.codePointThaiDigitZero=rn.codePoint.codePointThaiDigitZero;He.codePointTilde=rn.codePoint.codePointTilde;He.codePointUnderscore=rn.codePoint.codePointUnderscore});var w$=Y(Nu=>{"use strict";_();Object.defineProperty(Nu,"__esModule",{value:!0});Nu.surrogatePairToCodePoint=Nu.stringFromCodePoint=Nu.stringCodePointAt=Nu.scanCodePointsBack=Nu.scanCodePoints=Nu.numCodeUnits=Nu.makeGetCharCodeBits=Nu.isLowSurrogate=Nu.isHighSurrogate=Nu.isAnySurrogate=Nu.forEachClassInterval=Nu.countCodePoints=Nu.codePointIterator=Nu.CharCodeBits=void 0;var _m=Cn();Nu.CharCodeBits=_m.unicode.CharCodeBits;Nu.codePointIterator=_m.unicode.codePointIterator;Nu.countCodePoints=_m.unicode.countCodePoints;Nu.forEachClassInterval=_m.unicode.forEachClassInterval;Nu.isAnySurrogate=_m.unicode.isAnySurrogate;Nu.isHighSurrogate=_m.unicode.isHighSurrogate;Nu.isLowSurrogate=_m.unicode.isLowSurrogate;Nu.makeGetCharCodeBits=_m.unicode.makeGetCharCodeBits;Nu.numCodeUnits=_m.unicode.numCodeUnits;Nu.scanCodePoints=_m.unicode.scanCodePoints;Nu.scanCodePointsBack=_m.unicode.scanCodePointsBack;Nu.stringCodePointAt=_m.unicode.stringCodePointAt;Nu.stringFromCodePoint=_m.unicode.stringFromCodePoint;Nu.surrogatePairToCodePoint=_m.unicode.surrogatePairToCodePoint});var fw=Y(UG=>{"use strict";_();Object.defineProperty(UG,"__esModule",{value:!0});UG.WildExp=void 0;var x$=qG(),D$=w$(),eT;(function(e){e[e.OP_DOT=-1]="OP_DOT",e[e.OP_DOTSTAR=-2]="OP_DOTSTAR"})(eT||(eT={}));var z_e=x$.codePointTilde,Y_e=x$.codePointQuestionMark,J_e=x$.codePointAsterisk,DCr=function(){function e(r,n,a){a===void 0&&(a=!1),this.localeInfo=r,this.source=n,this.appendWildcard=a,this.bytecode=[],this.blocks=[];for(var o="",u=0;u<n.length;u+=1){var t=n.charCodeAt(u);if(t===z_e&&u+1<n.length){var d=(0,D$.stringCodePointAt)(n,u+1);o+=(0,D$.stringFromCodePoint)(d),u+=(0,D$.numCodeUnits)(d);continue}if(t!==z_e){if(t===Y_e||t===J_e){this.pushBlock(o),o="",this.pushMeta(t);continue}o+=n.charAt(u)}}this.bytecode.length===0&&(this.simplePattern=o),this.pushBlock(o),a&&this.pushMeta(J_e)}return e.prototype.pushBlock=function(r){if(r!==""){var n=this.blocks.length;this.blocks.push(r),this.bytecode.push(n);for(var a=1;a<r.length;a+=1)this.bytecode.push(eT.OP_DOT)}},e.prototype.pushMeta=function(r){r===Y_e?this.bytecode.push(eT.OP_DOT):this.bytecode.push(eT.OP_DOTSTAR)},e.prototype.test=function(r){if(this.simplePattern!==void 0)return this.testSimple(r,this.simplePattern);var n=Object.create(null);this.addState(n,0);for(var a=0;a<r.length;a+=1){var o=Object.keys(n);if(n=Object.create(null),o.length===0)return!1;for(var u=0;u<o.length;u+=1){var t=Number(o[u]);if(t!==this.bytecode.length){var d=this.bytecode[t];switch(d){case eT.OP_DOT:this.addState(n,t+1);break;case eT.OP_DOTSTAR:this.addState(n,t);break;default:var s=this.blocks[d];a+s.length<=r.length&&this.localeInfo.stringCompareCI(s,r.substring(a,a+s.length))===0&&this.addState(n,t+1)}}}}return this.bytecode.length in n},e.prototype.addState=function(r,n){r[n]=!0;for(var a=this.bytecode,o=n;o<a.length&&a[o]===eT.OP_DOTSTAR;o+=1)r[o+1]=!0},e.prototype.testSimple=function(r,n){return n.length<=r.length&&(n.length===r.length||this.appendWildcard)&&this.localeInfo.stringCompareCI(n,r.substring(0,n.length))===0},e}();UG.WildExp=DCr});var L$=Y(rT=>{"use strict";_();Object.defineProperty(rT,"__esModule",{value:!0});rT.applyCriteria=rT.compileCriteria=rT.parseCriteria=void 0;var GG=_o(),cc=Sm(),xCr=Nv(),X_e=_f(),pw=s$(),F0=ao(),LCr=zo(),BCr=fw(),mw=qd(),KG=Bl(),qCr={"=":cc.OperatorId.Eq,"<":cc.OperatorId.Lt,">":cc.OperatorId.Gt},UCr={"<>":cc.OperatorId.Ne,"<=":cc.OperatorId.Le,">=":cc.OperatorId.Ge};function GCr(e){if(e.length>=2){var r=UCr[e.substring(0,2)];if(r!==void 0)return[r,e.substring(2)]}if(e.length>=1){var r=qCr[e.substring(0,1)];if(r!==void 0)return[r,e.substring(1)]}return[void 0,e]}function KCr(e,r){var n=e.config.localeInfo;if(n.stringCompareCI(r,n.trueName)===0)return GG.trueOper;if(n.stringCompareCI(r,n.falseName)===0)return GG.falseOper;for(var a=1;a<n.errorNames.length;a+=1){var o=n.errorNames[a];if(o!=null&&n.stringCompareCI(o,r)===0)return(0,GG.errorOper)(a)}var u=e.parseGeneral(r,!1);return u!==void 0?u:(0,GG.stringOper)(r)}function Z_e(e,r){if(!(0,F0.isStringOper)(r))return r;var n=GCr(r.value),a=n[0],o=n[1],u=KCr(e,o),t={kind:"FilterExpression",operator:a,operand:u};return t}rT.parseCriteria=Z_e;function $_e(e,r){var n=r.kind==="FilterExpression"?r:{kind:"FilterExpression",operator:cc.OperatorId.Eq,operand:r},a=e.config,o=a.mathpack,u=a.localeInfo;function t(f,p){return function(m){var v=(0,F0.isRichOper)(m)?m.getFallback():m;if((0,F0.isNumberOper)(v))return(0,pw.cmpNum)(o,f,v,p);if((0,F0.isStringOper)(v)&&f===cc.OperatorId.Eq){var h=e.parseGeneral(v.value,!1);return h!==void 0?(0,pw.cmpNum)(o,f,h,p):!1}return f===cc.OperatorId.Ne}}function d(f,p){return function(m){var v=(0,F0.isRichOper)(m)?m.getFallback():m;return(0,F0.isBooleanOper)(v)?(0,pw.cmpBool)(f,v,p):f===cc.OperatorId.Ne}}function s(f,p){return function(m){var v=(0,F0.isRichOper)(m)?m.getFallback():m;return(0,F0.isErrorOper)(v)?(0,pw.cmpInt)(f,v.type-p.type):f===cc.OperatorId.Ne}}function c(f,p){switch(f){case cc.OperatorId.Eq:case cc.OperatorId.Ne:var m=new BCr.WildExp(u,p.value);return function(v){var h=(0,F0.isRichOper)(v)?v.getFallback():v;if(!(0,F0.isStringOper)(h))return f===cc.OperatorId.Ne;var S=m.test(h.value);return S===(f===cc.OperatorId.Eq)};case cc.OperatorId.Lt:case cc.OperatorId.Gt:case cc.OperatorId.Le:case cc.OperatorId.Ge:return function(v){var h=(0,F0.isRichOper)(v)?v.getFallback():v;return(0,F0.isStringOper)(h)?(0,pw.cmpStr)(u,f,h,p):!1}}}if(n.operator===cc.OperatorId.Ne&&(0,mw.isEmptyStringOper)(n.operand))return function(f){return!(0,F0.isBlankOper)(f)};if(n.operator===cc.OperatorId.Eq&&(0,mw.isEmptyStringOper)(n.operand))return F0.isBlankOper;if(n.operator!==void 0&&(0,mw.isEmptyStringOper)(n.operand))return function(f){return!1};if(n.operator===void 0&&(0,mw.isEmptyStringOper)(n.operand))return function(f){return(0,F0.isBlankOper)(f)||(0,mw.isEmptyStringOper)(f)};var l=n.operator===void 0?cc.OperatorId.Eq:n.operator;switch(n.operand.kind){case KG.OperKind.Number:return t(l,n.operand);case KG.OperKind.Boolean:return d(l,n.operand);case KG.OperKind.String:return c(l,n.operand);case KG.OperKind.Error:return s(l,n.operand);default:return(0,LCr.assertNever)("calc.funcs.criteria.compileCriteria",n.operand)}}rT.compileCriteria=$_e;function VCr(e,r,n,a){var o=$_e(e,Z_e(e,n)),u=r,t=a===void 0?u:a,d=function(f,p){var m=u.get(f,p);return o(m)?t.get(f,p):void 0},s=function(){var f=u.getSparse();return o(f)?t.getSparse():void 0},c=new xCr.NonstrictSparseArray2D(t.rows,t.cols,(0,X_e.fastMax)(u.denseRows,t.denseRows),(0,X_e.fastMax)(u.denseCols,t.denseCols),d,s);return c}rT.applyCriteria=VCr});var q$=Y(j1=>{"use strict";_();Object.defineProperty(j1,"__esModule",{value:!0});j1.reduceDerefOpers=j1.isPrimitiveCoercedOper=j1.isCoercedArrayOper=j1.coercedArrayOper=void 0;var WCr=QP(),jCr=Nv(),B$=zo(),EO=Bl();function HCr(e,r,n){return(0,B$.assertNatural)("calc.runtime.coercedArrayOper",e),(0,B$.assertNatural)("calc.runtime.coercedArrayOper",r),n.length!==e?(0,B$.assertFalse)("calc.runtime.coercedArrayOper: Inconsistent row number"):{kind:EO.OperKind.Array,rows:e,cols:r,opers:n}}j1.coercedArrayOper=HCr;function QCr(e){return e.kind===EO.OperKind.Array}j1.isCoercedArrayOper=QCr;var zCr=EO.OperKind.Number|EO.OperKind.String|EO.OperKind.Boolean;function YCr(e){var r=e.kind;return typeof r=="number"&&(r&zCr)!==0}j1.isPrimitiveCoercedOper=YCr;function JCr(e,r,n,a,o){var u=function(c,l,f,p){if((l==null?void 0:l.kind)===EO.OperKind.Array){for(var m=new jCr.StrictArray2D(l.rows,l.cols,l.opers),v=c,h=0;h<f;h+=1)v=t(v,m);return v}var S=p&&o!==void 0?o:n,y=S(e,l);return y==null?c:r(c,y,f)};function t(s,c){for(var l=s,f=0;f<c.rows;f+=1)for(var p=0;p<c.cols;p+=1){var m=c.get(f,p);m!==void 0&&(l=u(l,m,1,!0))}return l}function d(s,c){for(var l=s,f=c.getSparse(),p=c.cols-c.denseCols,m=0;m<c.denseRows;m+=1){for(var v=0;v<c.denseCols;v+=1){var h=c.get(m,v);h!==void 0&&(l=u(l,h,1,!1))}p>0&&f!==void 0&&(l=u(l,f,p,!1))}var S=(c.rows-c.denseRows)*c.cols;return S>0&&f!==void 0&&(l=u(l,f,S,!1)),l}return a.reduce(function(s,c){return(0,WCr.isRangeValues)(c)?c.arrays.reduce(d,s):u(s,c,1,!1)},void 0)}j1.reduceDerefOpers=JCr});var Mv=Y(Js=>{"use strict";_();Object.defineProperty(Js,"__esModule",{value:!0});Js.validateArraySize=Js.numMod=Js.validDateRange=Js.chkNumMultiOper=Js.chkDateOper=Js.atpm1904to1900Days=Js.chkNumOper=Js.assertString=Js.assertNumber=Js.wrap2=Js.wrap1=void 0;var Rg=_o(),eRe=cd(),U$=zo(),lS=ao(),VG=Nv(),Qp=Bl(),nT=Bd(),XCr=zs();function ZCr(e){return function(r,n){return e(r)(n[0])}}Js.wrap1=ZCr;function $Cr(e){return function(r,n){return e(r)(n[0],n[1])}}Js.wrap2=$Cr;var e_r=function(r){return(0,lS.isNumberOper)(r)?r:(0,U$.assertFalse)("calc.funcs.assertNumber")};Js.assertNumber=e_r;var r_r=function(r){return(0,lS.isStringOper)(r)?r:(0,U$.assertFalse)("calc.funcs.assertString")};Js.assertString=r_r;function rRe(e,r){var n=(0,eRe.refToVal)(e,r,!1),a=(0,lS.isRichOper)(n)?n.getFallback():n;switch(a.kind){case Qp.OperKind.Number:return a;case Qp.OperKind.Boolean:return Rg.valueErrorOper;case Qp.OperKind.String:var o=e.coerceOper(a,Qp.OperKind.Number);return(0,lS.isNumberOper)(o)?o:Rg.valueErrorOper;case Qp.OperKind.Error:return a;case Qp.OperKind.Array:return Rg.valueErrorOper;case Qp.OperKind.Missing:return Rg.naErrorOper;case Qp.OperKind.Blank:return e.mathpack.zero;default:return(0,U$.assertNever)("calc.funcs.chkNumOper",a)}}Js.chkNumOper=rRe;Js.atpm1904to1900Days=1462;function n_r(e,r){var n=rRe(e,r);if((0,lS.isErrorOper)(n))return n;var a=e.mathpack;return a.cond(n)<0||(n=a.floor(n),!tRe(e,n))?Rg.numErrorOper:(e.config.date1904&&!(0,lS.isStringOper)(r)&&(n=a.add(a.fromNumber(Js.atpm1904to1900Days),n)),n)}Js.chkDateOper=n_r;function nRe(e,r){switch(r.kind){case Qp.OperKind.Number:return(0,nT.success)(new VG.StrictSparseArray2D(1,1,1,1,[[r]],Rg.blankOper));case Qp.OperKind.String:var n=e.coerceOper(r,Qp.OperKind.Number);return(0,lS.isErrorOper)(n)?(0,nT.failure)(Rg.valueErrorOper):(0,nT.success)(new VG.StrictSparseArray2D(1,1,1,1,[[n]],Rg.blankOper));case Qp.OperKind.Blank:return(0,nT.success)(new VG.StrictSparseArray2D(1,1,1,1,[[e.mathpack.zero]],Rg.blankOper));case Qp.OperKind.Missing:return(0,nT.failure)(Rg.naErrorOper);case Qp.OperKind.Error:return(0,nT.failure)(r);case Qp.OperKind.Range:var a=(0,eRe.refToVal)(e,r,!1);return nRe(e,a);case Qp.OperKind.Array:return(0,nT.success)(new VG.StrictSparseArray2D(r.rows,r.cols,r.rows,r.cols,r.opers,Rg.blankOper));default:return(0,nT.failure)(Rg.valueErrorOper)}}Js.chkNumMultiOper=nRe;var t_r=0,a_r=2958465,i_r=0,o_r=2957003;function tRe(e,r){var n,a,o=e.mathpack,u=o.lfix(r);return e.config.date1904?(n=i_r,a=o_r):(n=t_r,a=a_r),u>=n&&u<=a}Js.validDateRange=tRe;function u_r(e,r,n){var a=e.div(r,n);if((0,lS.isErrorOper)(a))return a;var o=e.mul(e.trunc(a),n);if((0,lS.isErrorOper)(o))return o;var u=e.sub(r,o);return!(0,lS.isErrorOper)(u)&&e.cond(r)<0?e.abs(u):u}Js.numMod=u_r;function s_r(e,r){if(e*r>1048576)return(0,XCr.throwEvaluationError)((0,lS.notImplemented)(["Very large array size"]))}Js.validateArraySize=s_r});var J$=Y(cn=>{"use strict";_();Object.defineProperty(cn,"__esModule",{value:!0});cn.devsq=cn.avedev=cn.rank_avg=cn.rank=cn.aggregate=cn.subtotal=cn.mode_mult=cn.mode=cn.varpa=cn.vara=cn.varp=cn.var_=cn.stdevpa=cn.stdeva=cn.stdevp=cn.stdev=cn.trimmean=cn.median=cn.quartile_exc=cn.quartile=cn.percentile_exc=cn.percentile=cn.small=cn.large=cn.xor=cn.or=cn.and=cn.minifs=cn.maxifs=cn.mina=cn.maxa=cn.min=cn.max=cn.countifs=cn.countif=cn.counta=cn.countblank=cn.count=cn.textjoin=cn.concat=cn.averagea=cn.averageifs=cn.averageif=cn.average=cn.product=cn.sumifs=cn.sumif=cn.sumsq=cn.sum=void 0;var jG=br(),yl=zo(),ni=_o(),Mn=ao(),YC=QP(),WG=Ic(),vw=L$(),aRe=_f(),iRe=Sm(),Cl=q$(),Sl=Mv(),l_r=qd(),Gu=Bl(),zp=Bd(),G$=$Z();function dc(e,r){var n=(0,Mn.isRichOper)(r)?r.getFallback():r;switch(n.kind){case Gu.OperKind.Number:return n;case Gu.OperKind.Boolean:case Gu.OperKind.String:return;case Gu.OperKind.Error:return n;case Gu.OperKind.Missing:case Gu.OperKind.Blank:return;default:return(0,yl.assertNever)("calc.funcs.arithmeticOperationCoerce",n)}}function Sw(e,r){var n=(0,Mn.isRichOper)(r)?r.getFallback():r;switch(n.kind){case Gu.OperKind.Boolean:return n.value?e.mathpack.one:e.mathpack.zero;case Gu.OperKind.Number:return n;case Gu.OperKind.String:return e.mathpack.zero;case Gu.OperKind.Error:return n;case Gu.OperKind.Missing:case Gu.OperKind.Blank:return;default:return(0,yl.assertNever)("calc.funcs.arithmeticAOperationCoerce",n)}}function c_r(e,r){var n=(0,Mn.isRichOper)(r)?r.getFallback():r;return(0,Mn.isStringOper)(n)?e.mathpack.zero:dc(e,n)}function tT(e){return function(n,a,o){if(n!==void 0&&(0,Mn.isErrorOper)(n))return n;if((0,yl.assertTrue)("calc.funcs.numberReducer",n===void 0||(0,Mn.isNumberOper)(n)),(0,Mn.isErrorOper)(a))return a;(0,yl.assertTrue)("calc.funcs.numberReducer",(0,Mn.isNumberOper)(a));var u,t;n===void 0?(u=a,t=o-1):(u=n,t=o);for(var d=0;d<t;d+=1){var s=e(u,a);if((0,Mn.isErrorOper)(s))return s;u=s}return u}}function V$(e){return function(r,n,a){return e.count+=a,n}}function d_r(e){for(var r=e.length-1;r>=0;r-=1){var n=e[r];if(!(n===void 0||!(0,YC.isRangeValues)(n)))for(var a=n.arrays.length-1;a>=0;a-=1){var o=n.arrays[a];if(o.rows>o.denseRows||o.cols>o.denseCols){var u=o.getSparse();if((u==null?void 0:u.kind)===Gu.OperKind.Number)return u}for(var t=o.denseRows-1;t>=0;t-=1)for(var d=o.denseCols-1;d>=0;d-=1){var u=o.get(t,d);if((u==null?void 0:u.kind)===Gu.OperKind.Number)return u}}}}function sRe(e,r,n){if(!(0,Mn.isNumberOper)(n))return n;var a=d_r(r);return(a==null?void 0:a.kind)!==Gu.OperKind.Number?n:e.mathpack.checkAlmostCancellation(a,n)}function lRe(e,r,n){var a=(0,Cl.reduceDerefOpers)(r,tT(r.mathpack.add),dc,n);return a==null?r.mathpack.zero:(e&&(a=sRe(r,n,a)),a)}var cRe=lRe.bind(void 0,!1),dRe=lRe.bind(void 0,!0);function f_r(e,r){var n=e.dereferenceAllOpers(r);return dRe(e,n)}cn.sum=f_r;function p_r(e,r){var n=e.dereferenceAllOpers(r),a=HG(dc),o=(0,Cl.reduceDerefOpers)(e,tT(e.mathpack.add),a,n);return o??e.mathpack.zero}cn.sumsq=p_r;function hw(e){return(0,Mn.isRangeOper)(e)&&e.ranges.length!==1}function fRe(e,r,n){if(hw(r))return(0,zp.failure)(ni.valueErrorOper);if(n===void 0){var a=e.dereferenceAllOpers([r])[0];return(0,zp.success)({values:a,valuesToFilter:a})}if(hw(n))return(0,zp.failure)(ni.valueErrorOper);var o=S_r(r,n),u=o.actualEvalRange,t=o.actualFilterRange,d=u.ranges[0],s=t.ranges[0],c=e.dereferenceAllOpers([u])[0];if(d.col===s.col&&d.row===s.row)return(0,zp.success)({values:c,valuesToFilter:c});var l=e.dereferenceAllOpers([t])[0];return(0,zp.success)({values:c,valuesToFilter:l})}function pRe(e,r){var n=r[0],a=r[1],o=r[2],u=fRe(e,n,o);if(!(0,zp.isSuccess)(u))return u.reason;var t=u.value,d=t.values,s=t.valuesToFilter,c=[(0,YC.rangeValues)([(0,vw.applyCriteria)(e,d.arrays[0],a,s.arrays[0])])];return cRe(e,c)}cn.sumif=pRe;function yw(e,r,n,a){n===void 0&&(n=!1),a===void 0&&(a=!1);var o=r[0];if(hw(o))return(0,zp.failure)(ni.valueErrorOper);var u,t;if(n){var d=r[1],s=e.dereferenceAllOpers([o])[0];u=(0,vw.applyCriteria)(e,s.arrays[0],d),t=2}else{var c=e.dereferenceAllOpers([o])[0];u=c.arrays[0],t=1}for(var l=t;l<r.length;l+=2){var f=r[l],p=r[l+1];if(hw(f)||f.ranges[0].cols!==o.ranges[0].cols||f.ranges[0].rows!==o.ranges[0].rows)return(0,zp.failure)(ni.valueErrorOper);var s=e.dereferenceAllOpers([f])[0];u=(0,vw.applyCriteria)(e,s.arrays[0],p,u)}return a&&(u=u.strict()),(0,zp.success)((0,YC.rangeValues)([u]))}function m_r(e,r){if(r.length===3)return pRe(e,[r[1],r[2],r[0]]);var n=yw(e,r);return(0,zp.isSuccess)(n)?cRe(e,[n.value]):n.reason}cn.sumifs=m_r;function mRe(e,r){var n=(0,Cl.reduceDerefOpers)(e,tT(e.mathpack.mul),dc,r);return n??e.mathpack.zero}function g_r(e,r){var n=e.dereferenceAllOpers(r);return mRe(e,n)}cn.product=g_r;function gRe(e,r,n,a,o,u){var t=(0,Cl.reduceDerefOpers)(o,tT(o.mathpack.add),e,u,r);if(t==null)return a;if(n&&(t=sRe(o,u,t)),(0,Mn.isErrorOper)(t))return t;var d={count:0},s=(0,Cl.reduceDerefOpers)(o,V$(d),e,u,r);(0,yl.assertTrue)("calc.funcs.averageCoerceInner",(0,Mn.isNumberOper)(t)&&(s==null?void 0:s.kind)===Gu.OperKind.Number&&d.count>0);var c=o.mathpack.div(t,o.mathpack.fromNumber(d.count));return(0,Mn.isErrorOper)(c)?c:[c,d.count]}function W$(e,r,n,a,o){var u=gRe(e,r,n,ni.div0ErrorOper,a,o);return Array.isArray(u)?u[0]:u}var vRe=W$.bind(void 0,dc,void 0,!1),hRe=W$.bind(void 0,dc,void 0,!0),v_r=W$.bind(void 0,Sw,c_r,!0);function h_r(e,r){var n=e.dereferenceAllOpers(r);return hRe(e,n)}cn.average=h_r;function S_r(e,r){var n=e.ranges[0],a=r.ranges[0],o=(0,aRe.fastMin)(n.cols,WG.sheetCols-a.col),u=(0,aRe.fastMin)(n.rows,WG.sheetRows-a.row),t=(0,WG.gridRange)(n.row,n.col,u,o),d=(0,ni.range3DOper)(e.sheets,t),s=(0,WG.gridRange)(a.row,a.col,u,o),c=(0,ni.range3DOper)(r.sheets,s);return{actualEvalRange:d,actualFilterRange:c}}function SRe(e,r){var n=r[0],a=r[1],o=r[2],u=fRe(e,n,o);if(!(0,zp.isSuccess)(u))return u.reason;var t=u.value,d=t.values,s=t.valuesToFilter,c=[(0,YC.rangeValues)([(0,vw.applyCriteria)(e,d.arrays[0],a,s.arrays[0]).strict()])];return vRe(e,c)}cn.averageif=SRe;function y_r(e,r){if(r.length===3)return SRe(e,[r[1],r[2],r[0]]);var n=yw(e,r,void 0,!0);return(0,zp.isSuccess)(n)?vRe(e,[n.value]):n.reason}cn.averageifs=y_r;function C_r(e,r){var n=e.dereferenceAllOpers(r);return v_r(e,n)}cn.averagea=C_r;function yRe(e,r,n,a,o){for(var u=void 0,t=function(){return u},d=0,s="",c=function(y,C){return y.coerceOper(C,Gu.OperKind.String)},l=function(y,C,E){if(y!==void 0&&(0,Mn.isErrorOper)(y))return y;for(var I=0;I<E;I+=1){if(u!==void 0&&r.length>0&&(!n||u.value.length>0)){var F=r[d];if(d=(d+1)%r.length,s.length+F.value.length>ni.cellStringLimit)return ni.valueErrorOper;s+=F.value}if((0,Mn.isErrorOper)(C))return C;if((0,yl.assertTrue)("calc.funcs.concatInner: expected string in reducer",(0,Mn.isStringOper)(C)),s.length+C.value.length>ni.cellStringLimit)return ni.valueErrorOper;if(s+=C.value,u=C,C.value===""&&(r.length===0||n))break}return C},f=0;f<o.length;f+=1){var p=a[f];if((0,Mn.isRangeOper)(p)&&p.ranges.length>1)return ni.valueErrorOper;var m=(0,Cl.reduceDerefOpers)(e,l,c,o.slice(f,f+1));if(m!==void 0&&(0,Mn.isErrorOper)(m))return m;(0,yl.assertTrue)("calc.funcs.concatInner: expected string from reduce",m!==void 0&&(0,Mn.isStringOper)(m))}var v=t();if(n&&v!==void 0&&v.value===""&&r.length>0&&s.length>0){var h=r[(d+r.length-1)%r.length];s=s.substring(0,s.length-h.value.length)}return(0,ni.stringOper)(s)}function __r(e,r){var n=e.dereferenceAllOpers(r);return yRe(e,[],!0,r,n)}cn.concat=__r;function R_r(e,r){var n=r[0],a=r[1],o=r.slice(2),u=[];if(!(0,Mn.isMissingOper)(n)){if((0,Mn.isRangeOper)(n)&&n.ranges.length>1)return ni.valueErrorOper;var t=function(l,f){return l.coerceOper(f,Gu.OperKind.String)},d=(0,Cl.reduceDerefOpers)(e,YG(u,Sl.assertString),t,e.dereferenceAllOpers([n]));if(d!==void 0&&(0,Mn.isErrorOper)(d))return d;(0,yl.assertTrue)("calc.funcs.textjoin: expected string from reduce",d!==void 0&&(0,Mn.isStringOper)(d))}var s=(0,Mn.isMissingOper)(a)||a.value;return yRe(e,u,s,o,e.dereferenceAllOpers(o))}cn.textjoin=R_r;function QG(e,r,n){var a={count:0};return(0,Cl.reduceDerefOpers)(r,V$(a),e,n),r.mathpack.fromNumber(a.count)}function T_r(e,r){var n=(0,Mn.isRichOper)(r)?r.getFallback():r;return(0,Mn.isNumberOper)(n)?n:void 0}var CRe=QG.bind(void 0,T_r);function b_r(e,r){var n=e.dereferenceAllOpers(r);return CRe(e,n)}cn.count=b_r;function P_r(e,r){var n=(0,Mn.isRichOper)(r)?r.getFallback():r;return(0,Mn.isBlankOper)(n)||(0,l_r.isEmptyStringOper)(n)?n:void 0}var E_r=QG.bind(void 0,P_r);function N_r(e,r){var n=r[0];if(!(0,Mn.isSheetIndex)(n.sheets)||n.ranges.length!==1)return ni.valueErrorOper;var a=e.dereferenceAllOpers(r);return E_r(e,a)}cn.countblank=N_r;function A_r(e,r){var n=(0,Mn.isRichOper)(r)?r.getFallback():r;return(0,Mn.isPrimitiveOper)(n)||(0,Mn.isErrorOper)(n)?n:void 0}var _Re=QG.bind(void 0,A_r);function O_r(e,r){var n=e.dereferenceAllOpers(r);return _Re(e,n)}cn.counta=O_r;var RRe=QG.bind(void 0,function(e,r){return r});function TRe(e,r){var n=r[0],a=r[1];if(hw(n))return ni.valueErrorOper;var o=e.dereferenceAllOpers([n])[0],u=[(0,YC.rangeValues)([(0,vw.applyCriteria)(e,o.arrays[0],a)])];return RRe(e,u)}cn.countif=TRe;function k_r(e,r){if(r.length===2)return TRe(e,r);var n=yw(e,r,!0);return(0,zp.isSuccess)(n)?RRe(e,[n.value]):n.reason}cn.countifs=k_r;var bRe=function(r,n,a){return r.mathpack.cond2(n,a)>0},PRe=function(r,n,a){return r.mathpack.cond2(n,a)<0};function zG(e,r,n,a,o){var u=function(s,c,l){return s===void 0?c:(0,Mn.isErrorOper)(s)?s:((0,yl.assertTrue)("calc.funcs.minMaxCoerceInner",(0,Mn.isNumberOper)(s)),(0,Mn.isErrorOper)(c)?c:((0,yl.assertTrue)("calc.funcs.minMaxCoerceInner",(0,Mn.isNumberOper)(c)),e(a,s,c)?s:c))},t=(0,Cl.reduceDerefOpers)(a,u,r,o,n);return t??a.mathpack.zero}var j$=zG.bind(void 0,bRe,dc,void 0),H$=zG.bind(void 0,PRe,dc,void 0),F_r=zG.bind(void 0,bRe,Sw,dc),I_r=zG.bind(void 0,PRe,Sw,dc);function M_r(e,r){var n=e.dereferenceAllOpers(r);return j$(e,n)}cn.max=M_r;function w_r(e,r){var n=e.dereferenceAllOpers(r);return H$(e,n)}cn.min=w_r;function D_r(e,r){var n=e.dereferenceAllOpers(r);return F_r(e,n)}cn.maxa=D_r;function x_r(e,r){var n=e.dereferenceAllOpers(r);return I_r(e,n)}cn.mina=x_r;function L_r(e,r){var n=yw(e,r);return(0,zp.isSuccess)(n)?j$(e,[n.value]):n.reason}cn.maxifs=L_r;function B_r(e,r){var n=yw(e,r);return(0,zp.isSuccess)(n)?H$(e,[n.value]):n.reason}cn.minifs=B_r;function q_r(e,r){var n=(0,Mn.isRichOper)(r)?r.getFallback():r;switch(n.kind){case Gu.OperKind.Boolean:return n;case Gu.OperKind.Number:return(0,ni.booleanOper)(e.mathpack.cond(n)!==0);case Gu.OperKind.String:return;case Gu.OperKind.Error:return n;case Gu.OperKind.Missing:case Gu.OperKind.Blank:return;default:return(0,yl.assertNever)("calc.funcs.aggregationFuncs: booleanOperationCoerce",n)}}function Q$(e,r,n){var a=function(t,d,s){return t!==void 0&&(0,Mn.isErrorOper)(t)?t:(0,Mn.isErrorOper)(d)?d:((0,yl.assertTrue)("calc.funcs.booleanInner",(t===void 0||(0,Mn.isBooleanOper)(t))&&(0,Mn.isBooleanOper)(d)),(0,ni.booleanOper)(e(t==null?void 0:t.value,d.value,s)))},o=(0,Cl.reduceDerefOpers)(r,a,q_r,n);return o??ni.valueErrorOper}var U_r=Q$.bind(void 0,function(e,r){return e!==!1&&r}),G_r=Q$.bind(void 0,function(e,r){return e===!0||r}),K_r=Q$.bind(void 0,function(e,r,n){return r?((e===!0?1:0)+n)%2===1:e===!0});function V_r(e,r){var n=e.dereferenceAllOpers(r);return U_r(e,n)}cn.and=V_r;function W_r(e,r){var n=e.dereferenceAllOpers(r);return G_r(e,n)}cn.or=W_r;function j_r(e,r){var n=e.dereferenceAllOpers(r);return K_r(e,n)}cn.xor=j_r;function YG(e,r){return function(n,a,o){if(n!==void 0&&(0,Mn.isErrorOper)(n))return n;if(!(0,Mn.isErrorOper)(a))for(var u=r(a),t=0;t<o;t+=1)e.push(u);return a}}function ERe(e,r,n,a){var o=[],u=(0,Cl.reduceDerefOpers)(r,YG(o,Sl.assertNumber),dc,[n]);if(u==null)return ni.numErrorOper;if((0,Mn.isErrorOper)(u))return u;var t=r.mathpack;if(t.cond2(a,t.one)<0||t.cond2(a,t.fromNumber(o.length))>0)return ni.numErrorOper;var d=o.sort(t.cond2);if(e){var s=(0,Sl.assertNumber)(t.add((0,Sl.assertNumber)(t.sub(t.fromNumber(o.length),a)),t.one));return d[t.lfix(s)-1]}return d[t.lfix(a)-1]}var NRe=ERe.bind(void 0,!0),ARe=ERe.bind(void 0,!1);function H_r(e,r){var n=e.dereferenceAllOpers(r),a=n[0],o=n[1];return NRe(e,a,o)}cn.large=H_r;function Q_r(e,r){var n=e.dereferenceAllOpers(r),a=n[0],o=n[1];return ARe(e,a,o)}cn.small=Q_r;function Cw(e,r,n,a){var o=e.mathpack,u=[],t=(0,Cl.reduceDerefOpers)(e,YG(u,Sl.assertNumber),dc,r);if(t==null)return ni.numErrorOper;if((0,Mn.isErrorOper)(t))return t;if((0,Mn.isErrorOper)(n))return n;if(o.cond(n)<0||o.cond2(n,o.one)>0)return ni.numErrorOper;var d=u.sort(o.cond2),s=(0,Sl.assertNumber)(o.sub(o.fromNumber(d.length),o.one)),c=(0,Sl.assertNumber)(o.add(o.fromNumber(d.length),o.one)),l=a?(0,Sl.assertNumber)(o.mul(s,n)):(0,Sl.assertNumber)(o.sub((0,Sl.assertNumber)(o.mul(c,n)),o.one));if(o.cond(l)<0||o.cond2(l,s)>0)return ni.numErrorOper;var f=o.lfix(l),p=(0,Sl.assertNumber)(o.sub(l,o.fromNumber(f)));if(o.cond(p)===0)return d[f];var m=o.sub(d[f+1],d[f]);return(0,Mn.isErrorOper)(m)?m:o.add(d[f],(0,Sl.assertNumber)(o.mul(m,p)))}var ORe=function(r,n,a){return Cw(r,[n],a,!0)};function z_r(e,r){var n=e.dereferenceAllOpers(r),a=n[0],o=n[1];return ORe(e,a,o)}cn.percentile=z_r;var kRe=function(r,n,a){return Cw(r,[n],a,!1)};function Y_r(e,r){var n=e.dereferenceAllOpers(r),a=n[0],o=n[1];return kRe(e,a,o)}cn.percentile_exc=Y_r;function FRe(e,r){var n=e.mathpack;if(n.cond(r)<0||n.cond2(r,n.fromNumber(5))>=0)return ni.numErrorOper;var a=n.lfix(r);return n.div(n.fromNumber(a),n.fromNumber(4))}var IRe=function(r,n,a){return Cw(r,[n],FRe(r,a),!0)};function J_r(e,r){var n=e.dereferenceAllOpers(r),a=n[0],o=n[1];return IRe(e,a,o)}cn.quartile=J_r;var MRe=function(r,n,a){return Cw(r,[n],FRe(r,a),!1)};function X_r(e,r){var n=e.dereferenceAllOpers(r),a=n[0],o=n[1];return MRe(e,a,o)}cn.quartile_exc=X_r;function wRe(e,r){return Cw(e,r,e.mathpack.fromNumber(.5),!0)}function Z_r(e,r){var n=e.dereferenceAllOpers(r);return wRe(e,n)}cn.median=Z_r;function $_r(e,r){var n=e.dereferenceAllOpers(r),a=n[0],o=n[1],u=[],t=(0,Cl.reduceDerefOpers)(e,YG(u,Sl.assertNumber),dc,[a]);if(t==null)return ni.numErrorOper;if((0,Mn.isErrorOper)(t))return t;var d=e.mathpack;if(d.cond(o)<0||d.cond2(o,d.one)>=0)return ni.numErrorOper;u=u.sort(d.cond2);var s=d.lfix((0,Sl.assertNumber)(d.div((0,Sl.assertNumber)(d.mul(d.fromNumber(u.length),o)),d.fromNumber(2))));(0,yl.assertTrue)("calc.funcs.trimmean",s+s<u.length);var c=u[s],l=u[u.length-1-s],f=0,p=0,m=(0,Cl.reduceDerefOpers)(e,tT(e.mathpack.add),function(S,y){var C=dc(S,y);if(C===void 0)return C;(0,yl.assertTrue)("calc.funcs.trimmean: unexpected error",(0,Mn.isNumberOper)(C));var E=S.mathpack;if(E.cond2(C,c)<0){f+=1;return}if(E.cond2(C,l)>0){p+=1;return}return C},[a]);(0,yl.assertTrue)("calc.funcs.trimmean: found no elements",m!==void 0&&(0,Mn.isNumberOper)(m)),(0,yl.assertTrue)("calc.funcs.trimmean: trimmed too many",f<=s&&p<=s);for(var v=m;f<s;f+=1){var h=d.sub(v,c);if((0,Mn.isErrorOper)(h))return h;v=h}for(;p<s;p+=1){var h=d.sub(v,l);if((0,Mn.isErrorOper)(h))return h;v=h}return d.div(v,d.fromNumber(u.length-s-s))}cn.trimmean=$_r;function HG(e){return function(r,n){var a=e(r,n);return a!==void 0&&(0,Mn.isNumberOper)(a)?r.mathpack.mul(a,a):a}}function oRe(e,r){return function(n,a){var o=e(n,a);if((o==null?void 0:o.kind)!==Gu.OperKind.Number)return o;var u=n.mathpack,t=u.sub(o,r);return(0,Mn.isErrorOper)(t)?t:u.mul(t,t)}}function DRe(e,r,n,a){var o={count:0},u=(0,Cl.reduceDerefOpers)(n,V$(o),e,a,r);if(u==null)return ni.div0ErrorOper;(0,yl.assertTrue)("calc.funcs.varFirstPass: unexpected count type",o.count>=1);var t=tT(n.mathpack.add),d=(0,Cl.reduceDerefOpers)(n,t,e,a,r),s=(0,Cl.reduceDerefOpers)(n,t,HG(e),a,r===void 0?void 0:HG(r));if((0,yl.assertTrue)("calc.funcs.varFirstPass: expected sum",d!=null),(0,yl.assertTrue)("calc.funcs.varFirstPass: expected sumSq",s!=null),(0,Mn.isErrorOper)(d))return d;if((0,Mn.isErrorOper)(s))return s;(0,yl.assertTrue)("calc.funcs.varFirstPass: unexpected oper type",(0,Mn.isNumberOper)(d)&&(0,Mn.isNumberOper)(s));var c=n.mathpack,l=c.div(d,c.fromNumber(o.count));return(0,Mn.isErrorOper)(l)?l:[o.count,d,s,l]}function xRe(e,r,n,a,o){var u=tT(n.mathpack.add),t=(0,Cl.reduceDerefOpers)(n,u,oRe(e,o),a,r===void 0?void 0:oRe(r,o));return(0,yl.assertTrue)("calc.funcs.varSecondPass: unexpected error",(t==null?void 0:t.kind)===Gu.OperKind.Number),t}function LRe(e,r,n,a){var o=DRe(e,r,n,a);if(!Array.isArray(o))return o;var u=n.mathpack,t=o[0],d=o[1],s=o[2],c=o[3];if(t<2)return ni.div0ErrorOper;var l=u.mul(d,d);if((0,Mn.isErrorOper)(l))return l;var f=(0,Sl.assertNumber)(u.div(l,u.fromNumber(t))),p=(0,Sl.assertNumber)(u.sub(s,f));if(u.cond(c)===0)return u.cond(p)<0?u.zero:u.div(p,u.fromNumber(t-1));if(u.cond(p)>=0){var m=(0,Sl.assertNumber)(u.div(p,u.fromNumber(t-1))),v=21219957905e-324;if(u.cond2(m,u.fromNumber(v))>0){var h=u.div(f,s),S=(0,Mn.isErrorOper)(h)?h:u.sub(h,u.one);if(!(0,Mn.isErrorOper)(S)&&u.cond2(u.abs(S),u.fromNumber(.01))>0){var y=u.div(c,m),C=(0,Mn.isErrorOper)(y)?y:u.sub(u.abs(y),u.fromNumber(1e3));if(!(0,Mn.isErrorOper)(C)&&u.cond(C)<0)return m}}}var E=xRe(e,r,n,a,c);return u.cond(E)<0?u.zero:u.div(E,u.fromNumber(t-1))}function BRe(e,r,n,a){var o=DRe(e,r,n,a);if(!Array.isArray(o))return o;var u=n.mathpack,t=o[0],d=o[1],s=o[2],c=o[3];if(t<1)return ni.div0ErrorOper;var l=u.mul(d,d);if((0,Mn.isErrorOper)(l))return l;var f=u.mul(s,u.fromNumber(t));if((0,Mn.isErrorOper)(f))return f;var p=(0,Sl.assertNumber)(u.sub(f,l));if(u.cond(c)===0)return u.cond(p)<0?u.zero:u.div(p,u.fromNumber(t*t));if(u.cond(p)>=0){var m=(0,Sl.assertNumber)(u.div(p,u.fromNumber(t*t))),v=21219957905e-324;if(u.cond2(m,u.fromNumber(v))>0){var h=u.div((0,Sl.assertNumber)(u.div(l,u.fromNumber(t))),s),S=(0,Mn.isErrorOper)(h)?h:u.sub(h,u.one);if(!(0,Mn.isErrorOper)(S)&&u.cond2(u.abs(S),u.fromNumber(.01))>0){var y=u.div(c,m),C=(0,Mn.isErrorOper)(y)?y:u.sub(u.abs(y),u.fromNumber(1e3));if(!(0,Mn.isErrorOper)(C)&&u.cond(C)<0)return m}}}var E=xRe(e,r,n,a,c);return u.cond(E)<0?u.zero:u.div(E,u.fromNumber(t))}var z$=LRe.bind(void 0,dc,void 0),Y$=BRe.bind(void 0,dc,void 0),qRe=LRe.bind(void 0,Sw,dc),URe=BRe.bind(void 0,Sw,dc);function JG(e){return function(r,n){var a=e(r,n);return(0,Mn.isNumberOper)(a)?r.mathpack.sqrt(a):a}}var GRe=JG(z$),KRe=JG(Y$),eRr=JG(qRe),rRr=JG(URe);function nRr(e,r){var n=e.dereferenceAllOpers(r);return GRe(e,n)}cn.stdev=nRr;function tRr(e,r){var n=e.dereferenceAllOpers(r);return KRe(e,n)}cn.stdevp=tRr;function aRr(e,r){var n=e.dereferenceAllOpers(r);return eRr(e,n)}cn.stdeva=aRr;function iRr(e,r){var n=e.dereferenceAllOpers(r);return rRr(e,n)}cn.stdevpa=iRr;function oRr(e,r){var n=e.dereferenceAllOpers(r);return z$(e,n)}cn.var_=oRr;function uRr(e,r){var n=e.dereferenceAllOpers(r);return Y$(e,n)}cn.varp=uRr;function sRr(e,r){var n=e.dereferenceAllOpers(r);return qRe(e,n)}cn.vara=sRr;function lRr(e,r){var n=e.dereferenceAllOpers(r);return URe(e,n)}cn.varpa=lRr;var K$=[hRe,CRe,_Re,j$,H$,mRe,GRe,KRe,dRe,z$,Y$];function cRr(e){return function(r,n,a){if(r!==void 0&&(0,Mn.isErrorOper)(r))return r;if((0,Mn.isNumberOper)(n))for(var o=0;o<a;o+=1)e.push({value:n,index:e.length});return n}}function VRe(e,r){var n=[],a=(0,Cl.reduceDerefOpers)(e,cRr(n),dc,r);if(a==null)return ni.naErrorOper;if((0,Mn.isErrorOper)(a))return a;var o=e.mathpack,u=n.sort(function(h,S){return o.cond2(h.value,S.value)}),t=1,d=0,s=1/0,c=[];function l(h){t=1,s=h.index}function f(h){h.index<s&&(s=h.index),t+=1}var p=function(S){var y=S.value;t>d?(d=t,c.length=0,c.push({value:y,index:s})):t===d&&c.push({value:y,index:s})},m=function(S,y){return o.cond2(S.value,y.value)===0};l(u[0]);for(var v=1;v<u.length;v+=1)m(u[v-1],u[v])?f(u[v]):(p(u[v-1]),l(u[v]));return p(u[u.length-1]),d<2?ni.naErrorOper:((0,yl.assertTrue)("calc.funcs.modeInner: unexpected error",c.length!==0),c.sort(function(h,S){return h.index-S.index}))}function WRe(e,r){var n=VRe(e,r);return Array.isArray(n)?n[0].value:n}function dRr(e,r){return WRe(e,r)}cn.mode=dRr;function fRr(e,r){var n=VRe(e,r);return Array.isArray(n)?(0,ni.arrayOper)(n.length,1,n.map(function(a){return[a.value]})):n}cn.mode_mult=fRr;var pRr=(0,G$.binaryVisitor)(jG.__assign(jG.__assign({},(0,G$.constVisitor)(!1)),{wsfNode:function(r){return r===iRe.WorksheetFuncId.SUBTOTAL||r===iRe.WorksheetFuncId.AGGREGATE}}),function(e,r){return e||r});function mRr(e){return(0,G$.reduceBottomUp)(pRr,e)}function jRe(e){if(!(0,YC.isRangeValues)(e))return e;var r=e.arrays.map(function(n){return n.map(function(a){var o=a[0],u=a[1];return u!==void 0&&mRr(u.formula)?void 0:o})});return(0,YC.rangeValues)(r)}function gRr(e,r){var n=r[0],a=r.slice(1),o=e.mathpack,u=o.sfix(n),t=K$.length,d=100;if(!(u>=1&&u<=t)&&!(u>=101&&u<=t+d))return ni.valueErrorOper;var s=u>d||e.isInFilterMode(a),c=e.dereferenceAllOpersAndFormulae(a,s).map(jRe),l=K$[u%d-1];return l(e,c)}cn.subtotal=gRr;var gw=jG.__spreadArray(jG.__spreadArray([],K$,!0),[wRe,WRe],!1),uRe=[NRe,ARe,ORe,IRe,kRe,MRe];function vRr(e,r){var n=r[0],a=r[1],o=r[2],u=r[3],t=r.slice(4),d=e.mathpack,s=d.sfix(n),c=d.sfix(a);if(!(s>=1&&s<=gw.length+uRe.length)||!(c>=0&&c<=7))return ni.valueErrorOper;var l=(c&1)===1,f=(c&2)===2,p=(c&4)!==4;function m(B){var k=p?e.dereferenceAllOpersAndFormulae(B,l).map(jRe):e.dereferenceAllOpers(B,l);return f&&(k=k.map(function(x){if((0,Cl.isPrimitiveCoercedOper)(x))return x;if((0,YC.isRangeValues)(x)){var G=x.arrays.map(function(L){return L.map(function(D){return D===void 0||(0,Mn.isErrorOper)(D)?void 0:D})});return(0,YC.rangeValues)(G)}if((0,Cl.isCoercedArrayOper)(x)){var H=x.opers.map(function(L){return L.map(function(D){return D===void 0||(0,Mn.isErrorOper)(D)?void 0:D})});return(0,Cl.coercedArrayOper)(x.rows,x.cols,H)}return x})),k}if(s>gw.length){if(u===void 0||t.length>0)return ni.valueErrorOper;var v=Gu.OperKind.Number,h=e.coerceOper(e.dereferenceOper(u,v),v);if((0,Mn.isErrorOper)(h)||(0,Mn.isRangeOper)(o)&&!(0,Mn.isSheetIndex)(o.sheets))return ni.valueErrorOper;var S=m([o])[0],y=gw.length,C=uRe[s-y-1];return C(e,S,h)}for(var E=2;E<r.length;E+=1){var I=r[E];if(!I||!(0,Mn.isRangeOper)(I)||!(0,Mn.isSheetIndex)(I.sheets))return ni.valueErrorOper}var F=m(r.slice(2));(0,yl.assertTrue)("calc.funcs.aggregate: requested non-array function with unexpected number",s>=1&&s<=gw.length);var w=gw[s-1];return w(e,F)}cn.aggregate=vRr;function hRr(e,r){return HRe(e,r,!1)}cn.rank=hRr;function SRr(e,r){return HRe(e,r,!0)}cn.rank_avg=SRr;function HRe(e,r,n){var a=r[0],o=r[1],u=r[2],t=u===void 0?ni.falseOper:u,d=t.value?1:-1,s=0,c=0,l=e.mathpack,f=function(S,y,C){if(S!==void 0)return S;if((0,Mn.isErrorOper)(y))return y;var E=l.cond2(a,(0,Sl.assertNumber)(y));E===0?s+=C:E===d&&(c+=C)},p=(0,Cl.reduceDerefOpers)(e,f,dc,e.dereferenceAllOpers([o]));if(p!==void 0)return p;if(s===0)return ni.naErrorOper;var m=l.fromNumber(c+1);if(n){var v=l.div(l.fromNumber(s-1),l.fromNumber(2));return l.add(m,(0,Sl.assertNumber)(v))}return m}function yRr(e){return function(r,n){var a=e(r,n);return(a==null?void 0:a.kind)===Gu.OperKind.Number?r.mathpack.abs(a):a}}function CRr(e,r){return function(n,a){var o=e(n,a);return(o==null?void 0:o.kind)===Gu.OperKind.Number?n.mathpack.sub(o,r):o}}function QRe(e,r,n){var a=gRe(dc,void 0,!0,ni.numErrorOper,r,n);if(!Array.isArray(a))return a;var o=a[0],u=a[1],t=(0,Cl.reduceDerefOpers)(r,tT(r.mathpack.add),e(CRr(dc,o)),n);return(0,yl.assertTrue)("calc.funcs.sumDevAndCount",t!==void 0),(0,Mn.isErrorOper)(t)?t:[(0,Sl.assertNumber)(t),u]}function _Rr(e,r){var n=e.dereferenceAllOpers(r),a=QRe(yRr,e,n);if(!Array.isArray(a))return a;var o=a[0],u=a[1];return e.mathpack.div(o,e.mathpack.fromNumber(u))}cn.avedev=_Rr;function RRr(e,r){var n=e.dereferenceAllOpers(r),a=QRe(HG,e,n);if(!Array.isArray(a))return a;var o=a[0];return o}cn.devsq=RRr});var X$=Y(Yp=>{"use strict";_();Object.defineProperty(Yp,"__esModule",{value:!0});Yp.xlDatepack=Yp.tzUTC=Yp.tzData=Yp.dateTime=Yp.TimeGranularity=Yp.TimeDivision=Yp.Rounding=void 0;var zP=et();Yp.Rounding=zP.datepack.Rounding;Yp.TimeDivision=zP.datepack.TimeDivision;Yp.TimeGranularity=zP.datepack.TimeGranularity;Yp.dateTime=zP.datepack.dateTime;Yp.tzData=zP.datepack.tzData;Yp.tzUTC=zP.datepack.tzUTC;Yp.xlDatepack=zP.datepack.xlDatepack});var iee=Y(hi=>{"use strict";_();Object.defineProperty(hi,"__esModule",{value:!0});hi.yearFrac=hi.networkdays=hi.networkdays_intl=hi.eomonth=hi.edate=hi.workday=hi.workday_intl=hi.days=hi.datedif=hi.days360=hi.time=hi.date=hi.weeknum=hi.isoweeknum=hi.weekday=hi.second=hi.minute=hi.hour=hi.day=hi.month=hi.year=void 0;var YP=br(),Pi=_o(),ks=X$(),na=Mv(),Ki=ao(),TRr=Bd(),Jp=Bl(),bRr=zo();function NO(e,r,n){var a=n[0],o=r.datepack,u=r.config,t=o.fromNum(u,a,ks.Rounding.RoundSec);return t===!1?Pi.numErrorOper:r.mathpack.fromNumber(e(t))}hi.year=NO.bind(void 0,function(e){return e.yr});hi.month=NO.bind(void 0,function(e){return e.mon});hi.day=NO.bind(void 0,function(e){return e.dom});hi.hour=NO.bind(void 0,function(e){return e.hour});hi.minute=NO.bind(void 0,function(e){return e.min});hi.second=NO.bind(void 0,function(e){return e.sec});function XRe(e,r,n){var a=r[0],o=r[1];n===void 0&&(n=!1);var u=e.config,t=e.mathpack,d=e.datepack,s=d.fromNum(YP.__assign(YP.__assign({},u),{date1904:u.date1904&&!n}),a,ks.Rounding.RoundSec);if(s===!1)return Pi.numErrorOper;var c=o!==void 0?t.sfix(o):1,l;switch(c){case 1:case 17:l=s.wdy;break;case 2:case 11:l=s.wdy===1?7:s.wdy-1;break;case 3:l=s.wdy===1?6:s.wdy-2;break;case 12:l=(s.wdy+4)%7+1;break;case 13:l=(s.wdy+3)%7+1;break;case 14:l=(s.wdy+2)%7+1;break;case 15:l=(s.wdy+1)%7+1;break;case 16:l=s.wdy%7+1;break;default:return Pi.numErrorOper}return t.fromNumber(l)}function PRr(e,r){return XRe(e,r)}hi.weekday=PRr;function zRe(e,r,n){if(!r){var a=e.lfix(n);if(a===0||a===1)return e.fromNumber(52)}return Pi.numErrorOper}function ERr(e,r,n){if(r===void 0||(0,Ki.isMissingOper)(r))return[n?2:1,n];var a=(0,na.chkNumOper)(e,r);if(!(0,Ki.isErrorOper)(a)){var o=e.mathpack.sfix(a);if(n){if(o===1||o===2)return[o,n]}else{if(o===1||o===2)return[o,n];if(o>=11&&o<=16)return[o-9,n];if(o===17)return[1,n];if(o===21)return[2,!0]}}return[void 0,n]}function NRr(e,r,n,a){var o=e.mathpack,u=e.datepack,t=e.config,d=YP.__assign({},a),s=(r+6-d.wdy)%7;if(d.mon===12&&d.dom+s>=35)return o.one;d.dom=4,d.mon=1;var c=u.toDays(t,d);if((0,bRr.assertTrue)("calc.funcs.weeknumISOAmendments",c!==!1),c=(c-1)%7+1,(c-r+7)%7<3){var l=(0,na.assertNumber)(o.sub(n,o.one));if(o.cond(l)===0){var f=d.yr-1,p=f%4===0&&(f%100!==0||f%400===0);return r===c||p&&(r-c+7)%7===6?o.fromNumber(53):o.fromNumber(52)}return l}return n}function ZRe(e,r,n){var a=n[0],o=n[1],u=(0,na.chkDateOper)(r,a);if((0,Ki.isErrorOper)(u))return u;var t=ERr(r,o,e),d=t[0],s=t[1];if(d===void 0)return Pi.numErrorOper;var c=r.mathpack,l=r.datepack,f=r.config,p=YP.__assign(YP.__assign({},f),{date1904:!1}),m=l.fromNum(p,u,ks.Rounding.RoundSec);if(m===!1)return zRe(c,p.dateCompatibility,u);var v=(0,ks.dateTime)(m.yr,1,1,0,0,0,0,0,ks.Rounding.RoundSec),h=l.toNum(p,v);if((0,Ki.isErrorOper)(h))return zRe(c,p.dateCompatibility,u);var S=XRe(r,[h],!0);if((0,Ki.isErrorOper)(S))return S;var y=(0,na.assertNumber)(c.add((0,na.assertNumber)(c.sub(S,c.fromNumber(d))),c.fromNumber(7))),C=(0,na.assertNumber)((0,na.numMod)(c,y,c.fromNumber(7))),E=(0,na.assertNumber)(c.add(c.floor((0,na.assertNumber)(c.div((0,na.assertNumber)(c.add((0,na.assertNumber)(c.sub(u,h)),C)),c.fromNumber(7)))),c.one));return s?NRr(r,d,E,m):E}hi.isoweeknum=ZRe.bind(void 0,!0);hi.weeknum=ZRe.bind(void 0,!1);var YRe=-32768,Z$=32767,XG=1900,ARr=9999;function ORr(e,r){var n=r[0],a=r[1],o=r[2],u=e.mathpack,t=e.datepack,d=e.config,s=u.sfix(n);if(s>ARr)return Pi.numErrorOper;var c=u.sfix(a);if(c>Z$||c<YRe)return Pi.numErrorOper;var l=u.sfix(o);(l>Z$||l<YRe)&&(l=Z$),d.dateCompatibility?s<XG&&(s+=1900):s<XG&&!(s===1899&&c===12&&l>=30)&&(s+=1900);var f=(0,ks.dateTime)(s,c,l,0,0,0,0,0,ks.Rounding.RoundSec);return t.toNum(d,f)}hi.date=ORr;var kRr=1,FRr=12,IRr=30;function MRr(e,r){var n=r[0],a=r[1],o=r[2],u=e.mathpack,t=e.datepack,d=e.config,s=u.sfix(n);if(s>32767)return Pi.numErrorOper;var c=u.sfix(a);if(c>32767)return Pi.numErrorOper;var l=u.sfix(o);if(l>32767)return Pi.numErrorOper;var f,p,m;d.dateCompatibility?(f=d.date1904?1904:1900,p=kRr,m=d.date1904?1:0):(f=1899,p=FRr,m=IRr);var v=(0,ks.dateTime)(f,p,m,s,c,l,0,0,ks.Rounding.RoundSec),h=t.toNum(d,v);return(0,Ki.isErrorOper)(h)?h:u.cond(h)<0?Pi.numErrorOper:u.sub(h,u.trunc(h))}hi.time=MRr;function wRr(e,r){var n,a=r[0],o=r[1],u=r[2],t=e.mathpack,d=e.datepack,s=e.config,c=(n=u==null?void 0:u.value)!==null&&n!==void 0?n:!1,l=d.fromNum(s,a,ks.Rounding.RoundSec);if(l===!1)return Pi.naErrorOper;var f=l.dom===31||!c&&l.mon===2&&l.dom===d.daysPerMonth(2,l.yr,s.dateCompatibility)?30:l.dom,p=t.fromNumber((l.yr-XG)*360+l.mon*30+f),m=d.fromNum(s,o,ks.Rounding.RoundSec);if(m===!1)return Pi.naErrorOper;var v=m.dom===31&&(c||l.dom===30)?30:m.dom,h=t.fromNumber((m.yr-XG)*360+m.mon*30+v);return t.sub(h,p)}hi.days360=wRr;function DRr(e,r){var n=r[0],a=r[1],o=r[2].value;if(o.length>2||o.length===0)return Pi.numErrorOper;var u=e.mathpack,t=e.datepack,d=e.config,s=u.lfix(n),c=t.fromNum(d,n,ks.Rounding.RoundSec);if(c===!1)return Pi.numErrorOper;var l=e.mathpack.lfix(a),f=t.fromNum(d,a,ks.Rounding.RoundSec);if(f===!1||s>l)return Pi.numErrorOper;var p=f.dom,m=f.mon,v=f.yr;c.dom>p&&(m-=1,m===0&&(m=12,v-=1),p+=t.daysPerMonth(m,v,d.dateCompatibility)),c.mon>m&&(m+=12,v-=1);var h=function(E,I){return d.localeInfo.stringCompareCI(E,I)===0};if(h(o,"Y"))return u.fromNumber(v-c.yr);if(h(o,"M"))return u.fromNumber((v-c.yr)*12+(m-c.mon));if(h(o,"D"))return u.fromNumber(l-s);if(h(o,"MD"))return u.fromNumber(p-c.dom);if(h(o,"YM"))return u.fromNumber(m-c.mon);if(h(o,"YD")){for(var S=0,y=c.mon;y<m;y+=1)S+=t.daysPerMonth(y,c.yr,d.dateCompatibility);return u.fromNumber(S+(p-c.dom))}return Pi.numErrorOper}hi.datedif=DRr;function JRe(e,r){var n;if((0,Ki.isStringOper)(r)){var a=r.value.replace(/^\s+/,"");if(n=e.coerceOper((0,Pi.stringOper)(a),Jp.OperKind.Number),(0,Ki.isErrorOper)(n))return n}else n=r;return(0,na.chkDateOper)(e,n)}function xRr(e,r){var n=r[0],a=r[1];if((0,Ki.isStringOper)(n)&&n.value.length>255||(0,Ki.isStringOper)(a)&&a.value.length>255)return Pi.valueErrorOper;var o=JRe(e,n);if((0,Ki.isErrorOper)(o))return o;var u=JRe(e,a);return(0,Ki.isErrorOper)(u)?u:e.mathpack.sub(o,u)}hi.days=xRr;function eee(e,r,n){return n?(0,na.assertNumber)(e.sub(r,e.fromNumber(na.atpm1904to1900Days))):r}function ZG(e,r){return(e>>r%7&1)!==0}var Au;(function(e){e[e.None=0]="None",e[e.Saturday=1]="Saturday",e[e.Sunday=2]="Sunday",e[e.Monday=4]="Monday",e[e.Tuesday=8]="Tuesday",e[e.Wednesday=16]="Wednesday",e[e.Thursday=32]="Thursday",e[e.Friday=64]="Friday"})(Au||(Au={}));function tee(e){switch(e){case 1:return Au.Saturday|Au.Sunday;case 2:return Au.Sunday|Au.Monday;case 3:return Au.Monday|Au.Tuesday;case 4:return Au.Tuesday|Au.Wednesday;case 5:return Au.Wednesday|Au.Thursday;case 6:return Au.Thursday|Au.Friday;case 7:return Au.Friday|Au.Saturday;case 11:return Au.Sunday;case 12:return Au.Monday;case 13:return Au.Tuesday;case 14:return Au.Wednesday;case 15:return Au.Thursday;case 16:return Au.Friday;case 17:return Au.Saturday;default:return!1}}function aee(e){var r=2;if(e.length!==7)return!1;for(var n=Au.None,a=0;a<e.length;a+=1)if(e[a]==="1")n=n|1<<(a+r)%7;else if(e[a]!=="0")return!1;return n}function LRr(e){for(var r=[],n=e.getSparse(),a=e.cols-e.denseCols,o=0;o<e.denseRows;o+=1){for(var u=0;u<e.denseCols;u+=1){var t=e.get(o,u);t!==void 0&&r.push(t)}if(a>0&&n!==void 0)for(var d=0;d<a;d+=1)r.push(n)}var s=(e.rows-e.denseRows)*e.cols;if(s>0&&n!==void 0)for(var o=0;o<s;o+=1)r.push(n);return r}function ree(e,r){var n=r[0],a=r[1],o=r[2],u=r[3],t=Au.Saturday|Au.Sunday,d=(0,na.chkDateOper)(e,n);if((0,Ki.isErrorOper)(d))return d;var s=(0,na.chkNumOper)(e,a);if((0,Ki.isErrorOper)(s))return s;var c=e.mathpack,l=e.config;s=c.floor(s);var f=c.cond(s)>0?c.one:c.fromNumber(-1),p=c.abs(s),m=(0,na.assertNumber)(c.add(d,s));if(!(0,na.validDateRange)(e,m))return Pi.numErrorOper;if(c.cond(p)===0)return eee(c,d,l.date1904);var v=null,h=[];if(o){if(!(0,Ki.isMissingOper)(o)){if((0,Ki.isNumberOper)(o)){var S=tee(c.lfix(o));if(S===!1)return Pi.numErrorOper;t=S}else if((0,Ki.isStringOper)(o)){var y=aee(o.value);if(y===!1)return Pi.valueErrorOper;t=y}else return Pi.numErrorOper;if(t===127)return Pi.valueErrorOper}if(u&&!(0,Ki.isMissingOper)(u)){var C=(0,na.chkNumMultiOper)(e,u);if(!(0,TRr.isSuccess)(C))return C.reason;v=C.value}}for(var E=v==null?[]:LRr(v),I=E.length-1;I>=0;I-=1){var F=E[I];switch(F.kind){case Jp.OperKind.Number:case Jp.OperKind.String:case Jp.OperKind.Blank:var w=(0,na.chkDateOper)(e,F);if((0,Ki.isErrorOper)(w))return w;h[I]=w;break;case Jp.OperKind.Error:return F;default:return Pi.valueErrorOper}}for(;c.cond(p)>0;){d=(0,na.assertNumber)(c.add(d,f));var B=c.lfix(d);if(!ZG(t,B)){for(var k=!0,I=0;I<E.length;I+=1)if(c.cond2(h[I],d)===0){k=!1;break}k&&(p=(0,na.assertNumber)(c.sub(p,c.one)))}}return d=eee(c,d,l.date1904),(0,na.validDateRange)(e,d)?d:Pi.numErrorOper}hi.workday_intl=ree;function BRr(e,r){var n=r[0],a=r[1],o=r[2];return o?ree(e,[n,a,Pi.missingOper,o]):ree(e,[n,a])}hi.workday=BRr;function qRr(e,r,n,a,o,u){var t=e.lfix(a),d=e.lfix(o),s=e.lfix(u);return r.toNum(n,(0,ks.dateTime)(s,d,t,0,0,0,0,0,ks.Rounding.RoundSec))}var URr=1900,GRr=-9999;function KRr(e,r,n,a){var o=e.mathpack,u=e.datepack,t=e.config,d=YP.__assign(YP.__assign({},t),{date1904:!1}),s=u.fromNum(d,r,ks.Rounding.RoundSec);if(s===!1)return s;var c=o.fromNumber(s.dom),l=o.fromNumber(s.mon),f=o.fromNumber(12),p=o.fromNumber(s.yr);if(o.cond(n)>=0){p=(0,na.assertNumber)(o.add(o.floor((0,na.assertNumber)(o.div(n,f))),p));var m=(0,na.assertNumber)((0,na.numMod)(o,n,f)),v=(0,na.assertNumber)(o.add(m,l));o.cond2(v,f)===1&&(p=(0,na.assertNumber)(o.add(p,o.one))),l=(0,na.assertNumber)((0,na.numMod)(o,v,f))}else{var h=o.neg(n),S=o.floor((0,na.assertNumber)(o.div(h,f)));p=(0,na.assertNumber)(o.sub(p,S));var m=(0,na.assertNumber)((0,na.numMod)(o,h,f));if(o.cond2(m,l)>=0)p=(0,na.assertNumber)(o.sub(p,o.one)),l=(0,na.assertNumber)(o.add((0,na.assertNumber)(o.sub(l,m)),f));else{var y=(0,na.assertNumber)(o.sub(l,m));l=(0,na.assertNumber)((0,na.numMod)(o,y,f))}}o.cond(l)===0&&(l=f);var C=o.lfix(l);switch(C){case 4:case 6:case 9:case 11:var E=o.fromNumber(30);o.cond2(c,E)>0&&(c=E);break;case 2:o.cond2(c,o.fromNumber(28))>0&&(c=o.fromNumber(u.daysPerMonth(2,o.toNumber(p),!1)));break}a&&(c=o.fromNumber(u.daysPerMonth(C,o.toNumber(p),!1)));var I=o.lfix(p);if(I<(d.dateCompatibility?URr:GRr))return!1;var F=qRr(o,u,d,c,l,p);return(0,Ki.isErrorOper)(F)?!1:F}function $Re(e,r,n){var a=n[0],o=n[1],u=(0,na.chkDateOper)(r,a);if((0,Ki.isErrorOper)(u))return u;var t=(0,na.chkNumOper)(r,o);if((0,Ki.isErrorOper)(t))return t;var d=r.mathpack,s=r.config;d.cond(t)>0?t=d.floor(t):t=d.ceil(t);var c=!e,l=t,f=KRr(r,u,l,c);return f===!1?Pi.numErrorOper:eee(d,f,s.date1904)}hi.edate=$Re.bind(void 0,!0);hi.eomonth=$Re.bind(void 0,!1);function VRr(e,r,n,a,o,u){var t,d=e.mathpack;if(u===void 0||(0,Ki.isMissingOper)(u))t=Au.Saturday|Au.Sunday;else if((0,Ki.isStringOper)(u)){var s=aee(u.value);if(s===!1)return Pi.valueErrorOper;t=s}else{var c=(0,na.chkNumOper)(e,u);if((0,Ki.isErrorOper)(c))return Pi.valueErrorOper;var l=tee(d.lfix(c));if(l===!1)return Pi.numErrorOper;t=l}var f=d.fromNumber(n),p=d.fromNumber(a),m=e.dereferenceOper(o,Jp.OperKind.Array);if(!(0,Ki.isArrayOper)(m))return Pi.valueErrorOper;var v=[];function h(k){if(d.cond2(k,f)>=0&&d.cond2(k,p)<=0){var x=d.lfix(k);ZG(t,x)||v.push(k)}}for(var S=0;S<m.rows;S+=1)for(var y=0;y<m.cols;y+=1){var C=m.opers[S][y];switch(C.kind){case Jp.OperKind.Number:case Jp.OperKind.String:var E=(0,na.chkDateOper)(e,C);if((0,Ki.isErrorOper)(E))return E;h(E);break;case Jp.OperKind.Blank:break;case Jp.OperKind.Error:return C;default:return Pi.valueErrorOper}}var I=r;if(v.length!==0){var F=v.sort(function(k,x){return d.cond2(k,x)}),w=F[0];I=(0,na.assertNumber)(d.sub(I,d.one));for(var S=0;S<F.length;S+=1){var B=F[S];d.cond2(B,w)!==0&&(w=B,I=(0,na.assertNumber)(d.sub(I,d.one)))}}return I}function nee(e,r){var n=r[0],a=r[1],o=r[2],u=r[3],t=e.mathpack,d,s=Au.Saturday|Au.Sunday,c=5;function l(H){s=H,c=7;for(var L=s;L!==0;)(L&1)===1&&(c-=1),L=L>>1}if(o!==void 0&&!(0,Ki.isMissingOper)(o))if((0,Ki.isStringOper)(o)){var f=aee(o.value);if(f===!1)return Pi.valueErrorOper;l(f)}else{var p=(0,na.chkNumOper)(e,o);if((0,Ki.isErrorOper)(p))return Pi.valueErrorOper;var m=tee(t.lfix(p));if(m===!1)return Pi.numErrorOper;l(m)}var v=u??Pi.missingOper,h=(0,na.chkDateOper)(e,n);if((0,Ki.isErrorOper)(h))return h;var S=(0,na.chkDateOper)(e,a);if((0,Ki.isErrorOper)(S))return S;var y=t.lfix(h),C=t.lfix(S),E;y>C?(E=y,y=C,C=E,d=-1):d=1,E=y%7,E=C%7;for(var I=0,F=y<C?y:C,w=y<C?C:y;F%7!==0&&F!==w;)ZG(s,F)||(I+=1),F+=1;for(;w%7!==6&&F!==w;)ZG(s,w)||(I+=1),w-=1;if(w===F&&(s>>F%7&1)!==1&&(I+=1),y>C){var B=F;F=w,w=B}var k=t.fromNumber(c*Math.floor((w+1-F)/7)+I);switch(v.kind){case Jp.OperKind.Number:case Jp.OperKind.String:var x=(0,na.chkDateOper)(e,v);if((0,Ki.isErrorOper)(x))return x;E=t.lfix(x),E>=y&&E<=C&&E%7>=2&&(k=(0,na.assertNumber)(t.sub(k,t.one)));break;case Jp.OperKind.Range:case Jp.OperKind.Array:var G=VRr(e,k,y,C,v,o);if((0,Ki.isErrorOper)(G))return G;k=G;break;case Jp.OperKind.Error:return v;case Jp.OperKind.Missing:break;default:return Pi.valueErrorOper}return t.mul(t.fromNumber(d),k)}hi.networkdays_intl=nee;function WRr(e,r){var n=r[0],a=r[1],o=r[2];return o?nee(e,[n,a,Pi.missingOper,o]):nee(e,[n,a])}hi.networkdays=WRr;function jRr(e,r,n,a){var o=e.mathpack,u=e.datepack,t=e.config,d=o.fromNumber(360),s=o.fromNumber(365),c=o.fromNumber(366);switch(r){case Vd.BasisActual:var l=u.fromNum(t,n,ks.Rounding.RoundSec);if(l===!1)return!1;var f=l.dom,p=l.mon,m=l.yr,v=u.fromNum(t,a,ks.Rounding.RoundSec);if(v===!1)return!1;var h=v.dom,S=v.mon,y=v.yr,C=y-1;if(m===y)return u.daysPerMonth(2,m,t.dateCompatibility)===29?c:s;if(C===m&&(p>S||p===S&&f>=h)){if(u.daysPerMonth(2,m,t.dateCompatibility)===29){var E=u.toNum(t,(0,ks.dateTime)(m,2,29,0,0,0,0,0,ks.Rounding.RoundSec));return(0,Ki.isErrorOper)(E)?!1:o.cond2(E,n)>=0?c:s}if(u.daysPerMonth(2,y,t.dateCompatibility)===29){var E=u.toNum(t,(0,ks.dateTime)(m,2,29,0,0,0,0,0,ks.Rounding.RoundSec));return(0,Ki.isErrorOper)(E)?!1:o.cond2(E,a)<=0?c:s}return s}for(var I=0,F=m;F<=y;F+=1)u.daysPerMonth(2,F,t.dateCompatibility)===29?I+=366:I+=365;var w=o.fromNumber(y-m+1);return(0,na.assertNumber)(o.div(o.fromNumber(I),w));case Vd.Basis30360:case Vd.BasisActual360:case Vd.BasisE30360:return d;case Vd.BasisActual365:return s;default:return d}}function eTe(e,r,n,a,o,u,t){var d=e.mathpack,s=(n-r)*360,c=(o-a)*30;return d.fromNumber(t-u+c+s)}function HRr(e,r,n){var a=e.datepack,o=e.config,u=a.fromNum(o,r,ks.Rounding.RoundSec);if(u===!1)return!1;var t=u.dom,d=u.mon,s=u.yr,c=a.fromNum(o,n,ks.Rounding.RoundSec);if(c===!1)return!1;var l=c.dom,f=c.mon,p=c.yr;return t===31&&(t=30),l===31&&(l=30),eTe(e,s,p,d,f,t,l)}function $$(e,r,n,a){var o=e.datepack,u=e.config,t=o.daysPerMonth(n,a,u.dateCompatibility);return r===t}function QRr(e,r,n,a,o){var u=e.datepack,t=e.config,d=u.fromNum(t,r,ks.Rounding.RoundSec);if(d===!1)return!1;var s=d.dom,c=d.mon,l=d.yr,f=u.fromNum(t,n,ks.Rounding.RoundSec);if(f===!1)return!1;var p=f.dom,m=f.mon,v=f.yr;return p===2&&$$(e,p,m,v)&&(s===2&&$$(e,s,c,l)||a===3)&&(p=30),p===31&&(s>=30||a===3)&&(p=30),s===31&&(s=30),o&&c===2&&$$(e,s,c,l)&&(s=30),eTe(e,l,v,c,m,s,p)}function zRr(e,r,n,a,o){var u=e.mathpack,t=u.cond2(r,n);switch(t){case 1:break;case 0:return u.zero;case-1:switch(a){case Vd.Basis30360:return QRr(e,r,n,o,!0);case Vd.BasisActual360:case Vd.BasisActual365:case Vd.BasisActual:return(0,na.assertNumber)(u.sub(n,r));case Vd.BasisE30360:return HRr(e,r,n)}break}return!1}var Vd;(function(e){e[e.DefaultBasis=0]="DefaultBasis",e[e.Basis30360=0]="Basis30360",e[e.BasisActual=1]="BasisActual",e[e.BasisActual360=2]="BasisActual360",e[e.BasisActual365=3]="BasisActual365",e[e.BasisE30360=4]="BasisE30360"})(Vd||(Vd={}));function YRr(e,r){var n=Vd.DefaultBasis;if(r===void 0||(0,Ki.isMissingOper)(r))return n;var a=(0,na.chkNumOper)(e,r);if((0,Ki.isErrorOper)(a))return a;var o=e.mathpack;switch(n=o.lfix(o.floor(a)),n){case Vd.Basis30360:case Vd.BasisActual:case Vd.BasisActual360:case Vd.BasisActual365:case Vd.BasisE30360:return n;default:return Pi.numErrorOper}}function JRr(e,r){var n=r[0],a=r[1],o=r[2],u=Vd.DefaultBasis;if(o!==void 0){var t=YRr(e,o);if(typeof t!="number")return t;u=t}var d=(0,na.chkDateOper)(e,n);if((0,Ki.isErrorOper)(d))return d;var s=(0,na.chkDateOper)(e,a);if((0,Ki.isErrorOper)(s))return s;var c=e.mathpack;if(c.cond2(d,s)>0){var l=d;d=s,s=l}var f=zRr(e,d,s,u,0);if(f===!1)return Pi.numErrorOper;var p=jRr(e,u,d,s);return p===!1?Pi.numErrorOper:c.div(f,p)}hi.yearFrac=JRr});var uee=Y(AO=>{"use strict";_();Object.defineProperty(AO,"__esModule",{value:!0});AO.gestep=AO.delta=void 0;var rTe=Mv(),oee=ao();function nTe(e,r){var n=r[0],a=r[1],o=a===void 0||(0,oee.isMissingOper)(a)?e.mathpack.zero:(0,rTe.chkNumOper)(e,a);if((0,oee.isErrorOper)(o))return o;var u=(0,rTe.chkNumOper)(e,n);return(0,oee.isErrorOper)(u)?u:[u,o]}function XRr(e,r){var n=nTe(e,r);if(!Array.isArray(n))return n;var a=n[0],o=n[1],u=e.mathpack;return u.cond2(a,o)===0?u.one:u.zero}AO.delta=XRr;function ZRr(e,r){var n=nTe(e,r);if(!Array.isArray(n))return n;var a=n[0],o=n[1],u=e.mathpack;return u.cond2(a,o)>=0?u.one:u.zero}AO.gestep=ZRr});var see=Y(Rm=>{"use strict";_();Object.defineProperty(Rm,"__esModule",{value:!0});Rm.info=Rm.error_type=Rm.type=Rm.n_=Rm.t_=Rm.na=void 0;var kO=_o(),$Rr=cd(),H1=ao(),eTr=zo(),OO=Bl(),rTr=qd(),nTr=zs();function tTr(e,r){return kO.naErrorOper}Rm.na=tTr;function tTe(e,r){if((0,H1.isRangeOper)(r)){if((0,H1.isSheetIndex)(r.sheets)){var n=(0,kO.rangeSeqOper)(r.sheets,[(0,H1.gridRangeAnchor)(r.ranges[0])]);return e.dereferenceOper(n,$Rr.readOperType)}return kO.valueErrorOper}return r}function aTr(e,r){var n=r[0],a=tTe(e,n);return(0,H1.isStringOper)(a)||(0,H1.isErrorOper)(a)?a:rTr.emptyStringOper}Rm.t_=aTr;function iTr(e,r){var n=r[0],a=tTe(e,n);if((0,H1.isNumberOper)(a)||(0,H1.isErrorOper)(a))return a;var o=e.mathpack;return(0,H1.isBooleanOper)(a)&&a.value?o.one:o.zero}Rm.n_=iTr;function oTr(e,r){var n=r[0],a=e.mathpack;switch(n.kind){case OO.OperKind.Number:return a.fromNumber(1);case OO.OperKind.String:return a.fromNumber(2);case OO.OperKind.Boolean:return a.fromNumber(4);case OO.OperKind.Error:return a.fromNumber(16);case OO.OperKind.Array:return a.fromNumber(64);case OO.OperKind.Rich:return a.fromNumber(128);default:return(0,eTr.assertNever)("calc.funcs.type",n)}}Rm.type=oTr;function uTr(e,r){var n=r[0];return(0,H1.isErrorOper)(n)?(n.type>kO.ErrorType.CALC&&(0,nTr.throwEvaluationError)((0,H1.notImplemented)(["ERROR.TYPE for "+String(n.type)])),e.mathpack.fromNumber(n.type)):kO.naErrorOper}Rm.error_type=uTr;function sTr(e,r){return kO.valueErrorOper}Rm.info=sTr});var lee=Y(aT=>{"use strict";_();Object.defineProperty(aT,"__esModule",{value:!0});aT.arity=aT.makearray=aT.apply=void 0;var FO=_o(),iTe=jC(),oTe=cd(),$G=cd(),aTe=zs(),JC=ao(),lTr=Mv();function uTe(e,r,n){var a=(0,oTe.refToVal)(e,r,!0);return a instanceof iTe.LambdaOper?n!==void 0&&!(n>=a.minArity&&n<=a.maxArity)?FO.naErrorOper:a:(0,JC.isErrorOper)(a)?a:FO.refErrorOper}function cTr(e,r){var n=r[0],a=r.slice(1),o=uTe(e,n,a.length);return(0,JC.isErrorOper)(o)?o:e.applyLambda(o,a)}aT.apply=cTr;function dTr(e,r){var n=r[0],a=r[1],o=r[2],u=uTe(e,o,2);if((0,JC.isErrorOper)(u))return u;var t=e.mathpack,d=(0,JC.isMissingOper)(n)?1:t.fix(n),s=(0,JC.isMissingOper)(a)?1:t.fix(a);if(d<1||s<1)return FO.valueErrorOper;(0,lTr.validateArraySize)(d,s);var c=[FO.falseOper,FO.falseOper];return(0,$G.machineCall)(new $G.ArrayMachine(e,d,s,function(l,f){return(0,$G.machineCall)(new $G.ThenMachine(e,function(){var p=e.mathpack;return c[0]=p.fromNumber(l+1),c[1]=p.fromNumber(f+1),e.applyLambda(u,c)},function(p){return(0,JC.isRangeOper)(p)?(0,aTe.throwEvaluationError)((0,JC.notImplemented)(["MAKEARRAY with nested RangeOper"])):(0,JC.isArrayOper)(p)?(0,aTe.throwEvaluationError)((0,JC.notImplemented)(["MAKEARRAY with nested ArrayOper"])):p}))}))}aT.makearray=dTr;function fTr(e,r){var n=(0,oTe.refToVal)(e,r[0],!0);return n instanceof iTe.LambdaOper?e.mathpack.fromNumber(n.maxArity):FO.naErrorOper}aT.arity=fTr});var pee=Y(Xp=>{"use strict";_();Object.defineProperty(Xp,"__esModule",{value:!0});Xp.not=Xp.false_=Xp.true_=Xp.switch_=Xp.ifs=Xp.choose=Xp.if_=void 0;var IO=_o(),_w=zo(),fee=qd(),r9=Sm(),fd=ao(),e9=zs(),Q1=Bl(),pTr=(0,fee.makeStrict)((0,r9.getWorksheetFuncType)(r9.WorksheetFuncId.IFS)),sTe=(0,fee.makeStrict)((0,r9.getWorksheetFuncType)(r9.WorksheetFuncId.SWITCH));function mTr(e,r){var n=r[0];(0,_w.assertTrue)("calc.funcs.if: condition is not a boolean",(0,fd.isBooleanOper)(n));var a=r[n.value?1:2];return(0,_w.assertTrue)("calc.funcs.if: result is undefined",a!==void 0),a}Xp.if_=mTr;function gTr(e,r){var n=r[0];(0,_w.assertTrue)("calc.funcs.choose",(0,fd.isNumberOper)(n));var a=e.mathpack.fix(n);return a<1||a>r.length-1?IO.valueErrorOper:r[a]}Xp.choose=gTr;function cee(e,r,n,a){var o=a.slice();return e.dereferenceOpers(o,r),(0,fee.arrayLift)(e,r,function(u){for(var t=[],d=0;d<u.length;d+=1){var s=(0,fd.getArgType)(r,d,u.length);t[d]=e.coerceOper(u[d],s)}return n(e,t)},o)}function lTe(e,r){for(var n=0;n<r.length;n+=2){var a=r[n];if((0,fd.isArrayOper)(a)){var o=r.slice(n);return cee(e,pTr,lTe,o)}if((0,fd.isErrorOper)(a))return a;if((0,_w.assertTrue)("calc.funcs.ifs",(0,fd.isBooleanOper)(a)),a.value)return r[n+1]}return IO.naErrorOper}Xp.ifs=lTe;function vTr(e,r){var n=e.mathpack,a=e.localeInfo;switch(r.kind){case Q1.OperKind.Number:return function(o){return(0,fd.isRichOper)(o)?(0,e9.throwEvaluationError)((0,fd.notImplemented)(["SWITCH with a rich value case"])):(0,fd.isNumberOper)(o)&&n.compare(r,o)===0};case Q1.OperKind.String:return function(o){return(0,fd.isRichOper)(o)?(0,e9.throwEvaluationError)((0,fd.notImplemented)(["SWITCH with a rich value case"])):(0,fd.isStringOper)(o)&&a.stringCompareCI(r.value,o.value)===0};case Q1.OperKind.Boolean:return function(o){return(0,fd.isRichOper)(o)?(0,e9.throwEvaluationError)((0,fd.notImplemented)(["SWITCH with a rich value case"])):(0,fd.isBooleanOper)(o)&&r.value===o.value};case Q1.OperKind.Rich:return(0,e9.throwEvaluationError)((0,fd.notImplemented)(["SWITCH with a rich value condition"]));default:return(0,_w.assertNever)("calc.funcs.makeSwitchComparer",r)}}function dee(e,r){var n=r[0];if((0,fd.isArrayOper)(n))return cee(e,sTe,dee,r);if((0,fd.isErrorOper)(n))return n;for(var a=vTr(e.config,n),o=1;o<r.length-1;o+=2){var u=Q1.OperKind.Error|Q1.OperKind.Rich|Q1.OperKind.Number|Q1.OperKind.Boolean|Q1.OperKind.String|Q1.OperKind.Array,t=e.coerceOper(e.dereferenceOper(r[o],u),u);if((0,fd.isArrayOper)(t))return cee(e,sTe,dee,r);if((0,fd.isErrorOper)(t))return t;if(a(t))return r[o+1]}var d=r.length%2===0;return d?r[r.length-1]:IO.naErrorOper}Xp.switch_=dee;function hTr(e,r){return IO.trueOper}Xp.true_=hTr;function STr(e,r){return IO.falseOper}Xp.false_=STr;function yTr(e,r){var n=r[0];return(0,IO.booleanOper)(!n.value)}Xp.not=yTr});var u9=Y(Nf=>{"use strict";_();Object.defineProperty(Nf,"__esModule",{value:!0});Nf.vlookup=Nf.hlookup=Nf.lookup=Nf.match=Nf.linearSearch=Nf.binarySearch=Nf.makeLookupComparer=Nf.index=void 0;var wc=Sm(),Vi=_o(),dTe=QP(),Ul=ao(),i9=zo(),n9=zs(),CTr=fw(),MO=Ic(),mee=Nv(),Rw=_f(),Xs=Bl();function _Tr(e,r){var n=r[0],a=r[1],o=r[2],u=r[3],t=e.mathpack,d=t.sfix(a);if(d<0)return Vi.valueErrorOper;var s=o===void 0?void 0:t.sfix(o);if(s!==void 0&&s<0)return Vi.valueErrorOper;var c=u===void 0?0:t.sfix(u)-1;if(c<0)return Vi.valueErrorOper;var l,f;switch(n.kind){case Xs.OperKind.Range:if(!(0,Ul.isSheetIndex)(n.sheets))return Vi.valueErrorOper;if(c>=n.ranges.length)return Vi.refErrorOper;var p=n.ranges[c];if(s===void 0)if(p.rows===1)l=0,f=d-1;else{if(p.cols!==1)return Vi.refErrorOper;l=d-1,f=-1}else l=d-1,f=s-1;if(l>=p.rows||f>=p.cols)return Vi.refErrorOper;var m=(0,MO.gridRange)(p.row+(0,Rw.fastMax)(l,0),p.col+(0,Rw.fastMax)(f,0),l===-1?p.rows:1,f===-1?p.cols:1);return(0,Vi.rangeSeqOper)(n.sheets,[m]);case Xs.OperKind.Array:return c>0||(s===void 0?n.rows===1?(l=0,f=d-1):(l=d-1,f=-1):(l=d-1,f=s-1),l>=n.rows||f>=n.cols)?Vi.refErrorOper:l===-1&&f===-1?n:l===-1?(0,Vi.arrayOper)(n.rows,1,n.opers.map(function(v){return[v[f]]})):f===-1?(0,Vi.arrayOper)(1,n.cols,[n.opers[l]]):n.opers[l][f];default:return(0,i9.assertNever)("calc.funcs.lookupFuncs: INDEX",n)}}Nf.index=_Tr;var vee=function(r){return r<0?wc.OperatorId.Lt:r>0?wc.OperatorId.Gt:wc.OperatorId.Eq},RTr=function(r,n,a){return vee(r.cond2(n,a))},TTr=function(r,n){return vee(r-n)};function hee(e,r,n){n===void 0&&(n=!1);var a=!0,o=e.config,u=o.localeInfo,t=o.mathpack,d;switch(r.kind){case Xs.OperKind.Number:d=function(l){return{correctType:a,sgnT:RTr(t,l,r)}};break;case Xs.OperKind.String:if(n){var s=new CTr.WildExp(u,r.value);d=function(l){return{correctType:a,sgnT:s.test(l.value)?wc.OperatorId.Eq:wc.OperatorId.Ne}}}else d=function(l){return{correctType:a,sgnT:vee(u.stringCompareCI(l.value,r.value))}};break;case Xs.OperKind.Boolean:d=function(l){return{correctType:a,sgnT:TTr(l.value,r.value)}};break;case Xs.OperKind.Rich:return(0,n9.throwEvaluationError)((0,Ul.notImplemented)(["lookup with rich value condition"]));case Xs.OperKind.Blank:d=function(){return{correctType:a,sgnT:wc.OperatorId.Eq}};break;default:return(0,i9.assertNever)("calc.funcs.makeLookupComparer",r)}return function(c){var l=(0,Ul.isRichOper)(c)?c.getFallback():c;return r.kind!==l.kind?{correctType:!1,sgnT:wc.OperatorId.Ne}:d(l)}}Nf.makeLookupComparer=hee;function o9(e,r,n){for(var a=!1,o=0,u=n.length-1,t=Math.floor((o+u)/2),d=o,s=u,c=hee(e,r);;){var l=n.get(t),f=c(l).sgnT;if(f===wc.OperatorId.Ne){if(t<s){for(var p=t+1;p<=s;p+=1)if(f=c(n.get(p)).sgnT,f!==wc.OperatorId.Ne){t=p;break}}f===wc.OperatorId.Ne&&(t=Math.floor((d+s)/2),f=wc.OperatorId.Gt)}if(f===wc.OperatorId.Eq){if(t<u){t+=1,a=!0,d=t,s=t;continue}return t}if(f===wc.OperatorId.Lt?d=t+1:s=t-1,d<=s){t=Math.floor((d+s)/2);continue}if(a)t-=1;else if(f===wc.OperatorId.Gt&&(t-=1,t>=o)){d=t,s=t;continue}return t}}Nf.binarySearch=o9;function t9(e,r,n,a){for(var o=-1,u=a===wc.OperatorId.Eq,t=hee(e,r,u),d=0;d<n.length;d+=1){var s=n.get(d),c=t(s),l=c.correctType,f=c.sgnT;if(l){if(f===wc.OperatorId.Eq)return d;if(f!==wc.OperatorId.Ne&&f===a)return o;o=d}d===n.denseLength&&(d=(0,Rw.fastMax)(d,n.length-2))}return a!==wc.OperatorId.Eq?o:n.length}Nf.linearSearch=t9;function fTe(e){switch(e.kind){case Xs.OperKind.Number:return Vi.naErrorOper;case Xs.OperKind.Range:return(0,Ul.isSheetIndex)(e.sheets)?e.ranges.length>1?Vi.naErrorOper:e:Vi.valueErrorOper;case Xs.OperKind.Array:return e}}function bTr(e,r){switch(r.kind){case Xs.OperKind.Number:return r;case Xs.OperKind.Range:if(!(0,Ul.isSheetIndex)(r.sheets))return Vi.valueErrorOper;if(r.ranges.length>1)return Vi.refErrorOper;var n=r.ranges;return e.calcingArray?(0,n9.throwEvaluationError)((0,Ul.notImplemented)(["HLOOKUP/VLOOKUP ref argument 3 in array formula"])):n[0].rows>1||n[0].cols>1?(0,n9.throwEvaluationError)((0,Ul.notImplemented)(["HLOOKUP/VLOOKUP non-singleton ref argument 3"])):r;case Xs.OperKind.Array:return(0,n9.throwEvaluationError)((0,Ul.notImplemented)(["HLOOKUP/VLOOKUP array argument 3"]))}}function pTe(e,r){var n;switch(r.kind){case Xs.OperKind.Number:return r;case dTe.DerefOperKind.RangeValues:n=r.arrays[0].get(0,0);break;case Xs.OperKind.Array:n=r.opers[0][0];break;default:return(0,i9.assertNever)("calc.funcs.lookupFuncs.getNumFromRef",r)}return n=e.coerceOper(n,Xs.OperKind.Number),(0,Ul.isErrorOper)(n)?Vi.refErrorOper:n}function PTr(e){switch(e.kind){case Xs.OperKind.Number:return e;case Xs.OperKind.Range:if(!(0,Ul.isSheetIndex)(e.sheets))return Vi.valueErrorOper;if(e.ranges.length>1)return Vi.refErrorOper;var r=e.ranges[0];return r.rows!==1||r.cols!==1?Vi.refErrorOper:e}}function mTe(e){switch(e.kind){case Xs.OperKind.Number:return Vi.naErrorOper;case Xs.OperKind.Rich:return Vi.naErrorOper;case Xs.OperKind.Range:if(!(0,Ul.isSheetIndex)(e.sheets))return Vi.valueErrorOper;if(e.ranges.length>1)return Vi.naErrorOper;var r=e.ranges[0];return r.rows!==1&&r.cols!==1?Vi.naErrorOper:e;case Xs.OperKind.Array:return e.rows!==1&&e.cols!==1?Vi.naErrorOper:e}}function See(e){switch(e.kind){case dTe.DerefOperKind.RangeValues:return e.arrays[0];case Xs.OperKind.Array:return new mee.StrictSparseArray2D(e.rows,e.cols,e.rows,e.cols,e.opers,Vi.blankOper)}}function gee(e,r){switch(r.kind){case Xs.OperKind.Range:var n=r.sheets,a=r.ranges[0];return new mee.NonstrictSparseArray2D(a.rows,a.cols,a.rows,a.cols,function(o,u){var t=(0,MO.gridCell)(a.row+o,a.col+u),d=e.dereferenceAllOpers([(0,Vi.rangeSeqOper)(n,[t])])[0];return d.arrays[0].get(0,0)},function(){return(0,i9.assertFalse)("calc.funcs.lookupFuncs: rangeOrArrayOperToLazyArray2D")});case Xs.OperKind.Array:return new mee.StrictSparseArray2D(r.rows,r.cols,r.rows,r.cols,r.opers,Vi.blankOper)}}function ETr(e,r){var n=r[0],a=r[1],o=r[2],u=o===void 0?e.mathpack.one:o,t=e.mathpack,d=PTr(u);if((0,Ul.isErrorOper)(d))return d;var s=e.dereferenceAllOpers([d])[0],c=pTe(e,s);if((0,Ul.isErrorOper)(c))return c;var l=mTe(a);if((0,Ul.isErrorOper)(l))return l;var f=e.dereferenceAllOpers([l])[0],p=See(f),m=p.rows===1,v=a9(p,m),h=-1;return t.cond(c)>0?h=o9(e,n,v):t.cond(c)===0?h=t9(e,n,v,wc.OperatorId.Eq):h=t9(e,n,v,wc.OperatorId.Lt),h<0||h>=v.length?Vi.naErrorOper:e.mathpack.fromNumber(h+1)}Nf.match=ETr;function cTe(e){if((0,Ul.isRangeOper)(e)){var r=e.ranges[0];return r.cols>r.rows}return e.cols>e.rows}function NTr(e,r,n){if((0,Ul.isRangeOper)(n)){var a=n.ranges[0],o=(0,MO.gridRange)(a.row,a.col,(0,Rw.fastMin)(r?1:e,MO.sheetRows-a.row),(0,Rw.fastMin)(r?e:1,MO.sheetCols-a.col));return(0,Vi.range3DOper)(n.sheets,o)}return n}function ATr(e,r){var n=r[0],a=r[1],o=r[2],u=fTe(a);if((0,Ul.isErrorOper)(u))return u;var t=cTe(u),d=vTe(u,t),s=e.dereferenceAllOpers([d])[0],c=a9(See(s),t),l=o9(e,n,c);if(l<0)return Vi.naErrorOper;if(o!==void 0){var f=mTe(o);if((0,Ul.isErrorOper)(f))return f;var p=cTe(f),m=NTr(c.length,p,f),v=a9(gee(e,m),p);return l>=v.length?(0,Ul.isArrayOper)(f)?Vi.naErrorOper:Vi.blankOper:v.get(l)}var h=gee(e,u);return t?h.get(h.rows-1,l):h.get(l,h.cols-1)}Nf.lookup=ATr;function gTe(e,r,n){var a=r[0],o=r[1],u=r[2],t=r[3],d=t===void 0?Vi.trueOper:t,s=fTe(o);if((0,Ul.isErrorOper)(s))return s;var c=vTe(s,n),l=e.dereferenceAllOpers([c])[0],f=a9(See(l),n),p=!d.value,m=p?t9(e,a,f,wc.OperatorId.Eq):o9(e,a,f);if(m<0||m>=f.length)return Vi.naErrorOper;var v=bTr(e,u);if((0,Ul.isErrorOper)(v))return v;var h=e.dereferenceAllOpers([v])[0],S=pTe(e,h);if((0,Ul.isErrorOper)(S))return S;var y=e.mathpack.sfix(S)-1,C=gee(e,s);return y<0?Vi.valueErrorOper:y>=(n?C.rows:C.cols)?Vi.refErrorOper:n?C.get(y,m):C.get(m,y)}function OTr(e,r){return gTe(e,r,!0)}Nf.hlookup=OTr;function kTr(e,r){return gTe(e,r,!1)}Nf.vlookup=kTr;function a9(e,r){var n=e.getSparse.bind(e);return r?{length:e.cols,denseLength:e.denseCols,get:function(o){return e.get(0,o)},getSparse:n}:{length:e.rows,denseLength:e.denseRows,get:function(o){return e.get(o,0)},getSparse:n}}function vTe(e,r){if((0,Ul.isRangeOper)(e)){var n=e.ranges[0],a=(0,MO.gridRange)(n.row,n.col,r?1:n.rows,r?n.cols:1);return(0,Vi.rangeSeqOper)(e.sheets,[a])}return e}});var s9=Y(Zn=>{"use strict";_();Object.defineProperty(Zn,"__esModule",{value:!0});Zn.sqrtpi=Zn.factdouble=Zn.fact=Zn.quotient=Zn.radians=Zn.degrees=Zn.sign=Zn.abs=Zn.odd=Zn.even=Zn.floor_precise=Zn.floor_math=Zn.floor=Zn.ceiling_precise=Zn.ceiling_math=Zn.ceiling=Zn.mround=Zn.rounddown=Zn.roundup=Zn.trunc=Zn.round=Zn.int=Zn.atan2=Zn.atan=Zn.acos=Zn.asin=Zn.tan=Zn.cos=Zn.sin=Zn.log=Zn.log10=Zn.ln=Zn.power=Zn.exp=Zn.sqrt=Zn.pi=void 0;var Ku=Mv(),XC=_o(),fc=ao();function FTr(e,r){return e.mathpack.pi}Zn.pi=FTr;Zn.sqrt=(0,Ku.wrap1)(function(e){return e.mathpack.sqrt});Zn.exp=(0,Ku.wrap1)(function(e){return e.mathpack.exp});Zn.power=(0,Ku.wrap2)(function(e){return e.mathpack.power});Zn.ln=(0,Ku.wrap1)(function(e){return e.mathpack.ln});Zn.log10=(0,Ku.wrap1)(function(e){return e.mathpack.log});function ITr(e,r){var n=r[0],a=r[1],o=e.mathpack;if(a===void 0)return o.log(n);var u=o.ln(n);if((0,fc.isErrorOper)(u))return u;var t=o.ln(a);return(0,fc.isErrorOper)(t)?t:o.div(u,t)}Zn.log=ITr;Zn.sin=(0,Ku.wrap1)(function(e){return e.mathpack.sin});Zn.cos=(0,Ku.wrap1)(function(e){return e.mathpack.cos});Zn.tan=(0,Ku.wrap1)(function(e){return e.mathpack.tan});Zn.asin=(0,Ku.wrap1)(function(e){return e.mathpack.asin});Zn.acos=(0,Ku.wrap1)(function(e){return e.mathpack.acos});Zn.atan=(0,Ku.wrap1)(function(e){return e.mathpack.atan});Zn.atan2=(0,Ku.wrap2)(function(e){return e.mathpack.atan2});function MTr(e,r){var n=r[0],a=e.mathpack;return a.cond2(a.abs(n),a.fromNumber(1e15))<0&&(n=a.viewRound(n)),a.floor(n)}Zn.int=MTr;Zn.round=(0,Ku.wrap2)(function(e){return e.mathpack.round});function wTr(e,r){var n=r[0],a=r[1],o=a===void 0?e.mathpack.zero:a;return e.mathpack.roundDown(n,o)}Zn.trunc=wTr;Zn.roundup=(0,Ku.wrap2)(function(e){return e.mathpack.roundUp});Zn.rounddown=(0,Ku.wrap2)(function(e){return e.mathpack.roundDown});function DTr(e,r){var n=r[0],a=r[1],o=(0,Ku.chkNumOper)(e,n);if((0,fc.isErrorOper)(o))return o;var u=(0,Ku.chkNumOper)(e,a);if((0,fc.isErrorOper)(u))return u;var t=e.mathpack;if(t.cond(u)===0)return t.zero;if(t.cond(o)!==0&&t.cond(o)<0!=t.cond(u)<0)return XC.numErrorOper;var d=t.div(o,u);if((0,fc.isErrorOper)(d))return XC.numErrorOper;var s=t.floor(d),c=(0,Ku.assertNumber)(t.sub(d,s)),l=t.fromNumber(.499999999999995);if(t.cond2(c,l)<0)return t.mul(s,u);var f=t.add(s,t.one);return(0,fc.isErrorOper)(f)?f:t.mul(f,u)}Zn.mround=DTr;function yee(e,r,n){var a=e.cond(r),o=e.cond(n);if(a>0&&o<0)return XC.numErrorOper;if(a===0||o===0)return e.zero;var u=e.div(r,n);return(0,fc.isErrorOper)(u)?u:e.mul(e.ceil(e.viewRound(u)),n)}function Cee(e,r,n){var a=e.cond(r),o=e.cond(n);if(a>0&&o<0)return XC.numErrorOper;if(a===0&&o===0)return r;var u=e.div(r,n);return(0,fc.isErrorOper)(u)?u:e.mul(e.floor(e.viewRound(u)),n)}function xTr(e,r){var n=r[0],a=r[1];return yee(e.mathpack,n,a)}Zn.ceiling=xTr;function LTr(e,r){var n=r[0],a=r[1],o=r[2],u=e.mathpack,t=a===void 0||(0,fc.isMissingOper)(a)?u.one:u.abs(a),d=o===void 0||(0,fc.isMissingOper)(o)?u.zero:o;return u.cond(d)!==0&&u.cond(n)<0&&(t=u.neg(t)),u.cond(t)===0?u.zero:yee(u,n,t)}Zn.ceiling_math=LTr;function BTr(e,r){var n=r[0],a=r[1],o=e.mathpack,u=a===void 0||(0,fc.isMissingOper)(a)?o.one:o.abs(a);return o.cond(u)===0?o.zero:yee(o,n,u)}Zn.ceiling_precise=BTr;function qTr(e,r){var n=r[0],a=r[1];return Cee(e.mathpack,n,a)}Zn.floor=qTr;function UTr(e,r){var n=r[0],a=r[1],o=r[2],u=e.mathpack,t=a===void 0||(0,fc.isMissingOper)(a)?u.one:u.abs(a),d=o===void 0||(0,fc.isMissingOper)(o)?u.zero:o;return u.cond(d)!==0&&u.cond(n)<0&&(t=u.neg(t)),u.cond(t)===0?u.zero:Cee(u,n,t)}Zn.floor_math=UTr;function GTr(e,r){var n=r[0],a=r[1],o=e.mathpack,u=a===void 0||(0,fc.isMissingOper)(a)?o.one:o.abs(a);return o.cond(u)===0?o.zero:Cee(o,n,u)}Zn.floor_precise=GTr;function hTe(e,r,n){var a=n[0],o=r.mathpack;if(o.cond(a)>=0){var u=o.ceil(a);return o.cond2((0,Ku.assertNumber)((0,Ku.numMod)(o,u,o.fromNumber(2))),o.one)===0===e?o.add(u,o.one):u}var t=o.floor(a);return o.cond2((0,Ku.assertNumber)((0,Ku.numMod)(o,t,o.fromNumber(2))),o.one)===0===e?o.sub(t,o.one):t}Zn.even=hTe.bind(void 0,!0);Zn.odd=hTe.bind(void 0,!1);Zn.abs=(0,Ku.wrap1)(function(e){return e.mathpack.abs});function KTr(e,r){var n=r[0],a=e.mathpack;return a.fromNumber(a.cond(n))}Zn.sign=KTr;function VTr(e,r){var n=r[0],a=e.mathpack,o=(0,Ku.assertNumber)(a.div(a.fromNumber(180),a.pi));return a.mul(n,o)}Zn.degrees=VTr;function WTr(e,r){var n=r[0],a=e.mathpack,o=(0,Ku.assertNumber)(a.div(a.pi,a.fromNumber(180)));return a.mul(n,o)}Zn.radians=WTr;function jTr(e,r){var n=r[0],a=r[1],o=(0,Ku.chkNumOper)(e,n);if((0,fc.isErrorOper)(o))return o;var u=(0,Ku.chkNumOper)(e,a);if((0,fc.isErrorOper)(u))return u;var t=e.mathpack;if(t.cond(u)===0)return XC.div0ErrorOper;var d=t.div(o,u);return(0,fc.isErrorOper)(d)?XC.numErrorOper:t.cond(d)>0?t.floor(d):t.ceil(d)}Zn.quotient=jTr;function HTr(e,r){var n=r[0],a=e.mathpack,o=a.sfix(n);if(a.cond(n)<0||o>170)return XC.numErrorOper;for(var u=a.one,t=o;t>0;t-=1){if((0,fc.isErrorOper)(u))return u;u=a.mul(a.fromNumber(t),u)}return u}Zn.fact=HTr;function QTr(e,r){var n=r[0],a=(0,Ku.chkNumOper)(e,n);if((0,fc.isErrorOper)(a))return a;var o=e.mathpack,u=o.floor(a);if(o.cond2(u,o.fromNumber(-1))<0||o.cond2(u,o.fromNumber(300))>0)return XC.numErrorOper;for(var t=o.one,d=o.toNumber(u),s=d;s>1;s-=2){if((0,fc.isErrorOper)(t))return t;t=o.mul(o.fromNumber(s),t)}return t}Zn.factdouble=QTr;function zTr(e,r){var n=r[0],a=(0,Ku.chkNumOper)(e,n);if((0,fc.isErrorOper)(a))return a;var o=e.mathpack;if(o.cond(a)<0)return XC.numErrorOper;var u=o.mul(o.pi,a);return(0,fc.isErrorOper)(u)?u:o.sqrt(u)}Zn.sqrtpi=zTr});var STe=Y(wv=>{"use strict";_();Object.defineProperty(wv,"__esModule",{value:!0});wv.NumberShape=wv.KnownFormat=wv.DateOrder=wv.CurrencyFormat=wv.Calendar=void 0;var Tw=et();wv.Calendar=Tw.numfmt.Calendar;wv.CurrencyFormat=Tw.numfmt.CurrencyFormat;wv.DateOrder=Tw.numfmt.DateOrder;wv.KnownFormat=Tw.numfmt.KnownFormat;wv.NumberShape=Tw.numfmt.NumberShape});var yTe=Y(os=>{"use strict";_();Object.defineProperty(os,"__esModule",{value:!0});os.isKnownFormatDefined=os.getSpecial=os.getSingle=os.getKnownFormat=os.getColor=os.englishXLSXKnownFormat=os.buildSingle=os.buildScientificFormat=os.buildPercentFormat=os.buildNumberFormat=os.buildMMDDYYFormat=os.buildFractionFormat=os.buildCurrencyFormat=void 0;var Tg=gm();os.buildCurrencyFormat=Tg.knownFormat.buildCurrencyFormat;os.buildFractionFormat=Tg.knownFormat.buildFractionFormat;os.buildMMDDYYFormat=Tg.knownFormat.buildMMDDYYFormat;os.buildNumberFormat=Tg.knownFormat.buildNumberFormat;os.buildPercentFormat=Tg.knownFormat.buildPercentFormat;os.buildScientificFormat=Tg.knownFormat.buildScientificFormat;os.buildSingle=Tg.knownFormat.buildSingle;os.englishXLSXKnownFormat=Tg.knownFormat.englishXLSXKnownFormat;os.getColor=Tg.knownFormat.getColor;os.getKnownFormat=Tg.knownFormat.getKnownFormat;os.getSingle=Tg.knownFormat.getSingle;os.getSpecial=Tg.knownFormat.getSpecial;os.isKnownFormatDefined=Tg.knownFormat.isKnownFormatDefined});var Tee=Y(Tm=>{"use strict";_();Object.defineProperty(Tm,"__esModule",{value:!0});Tm.timevalue=Tm.datevalue=Tm.value=Tm.dollar=Tm.fixed=Tm.text=void 0;var Zp=_o(),CTe=zo(),YTr=s9(),wO=STe(),JTr=qG(),Dv=ao(),_ee=yTe(),z1=Bl(),Ree=cO(),_Te=JTr.codePointSpace;function XTr(e,r){var n=r[0],a=r[1].value,o=(0,Dv.isRichOper)(n)?n.getFallback():n;if((0,Dv.isStringOper)(o)&&o.value.length>255||a.length>255)return Zp.valueErrorOper;var u;switch(o.kind){case z1.OperKind.String:{var t=e.coerceOper(o,z1.OperKind.Number);u=(0,Dv.isNumberOper)(t)?t:o;break}case z1.OperKind.Number:u=o;break;case z1.OperKind.Boolean:{var t=e.coerceOper(o,z1.OperKind.String);(0,CTe.assertTrue)("calc.funcs.text",(0,Dv.isStringOper)(t)),u=t;break}case z1.OperKind.Error:return Zp.valueErrorOper}var d=e.applyFormat(e.originSheet.document,a,u,Ree.NumberFormatSource.CustomString);return d!==void 0?(0,Zp.stringOper)(d):Zp.valueErrorOper}Tm.text=XTr;function RTe(e,r,n,a){if(n===void 0||(0,Dv.isMissingOper)(n)){var o=a??2;return{formatValue:r,formatDecimals:o}}var u=e.config.mathpack;if(u.cond(n)<0){var t=0,d=(0,YTr.round)(e,[r,n]);return(0,CTe.assertTrue)("calc.funcs.fixedDollarRound",(0,Dv.isNumberOper)(d)||(0,Dv.isErrorOper)(d)),{formatValue:d,formatDecimals:t}}var s=u.sfix(n);return s<0||s>127?{formatValue:Zp.valueErrorOper,formatDecimals:0}:{formatValue:r,formatDecimals:s}}function ZTr(e,r){var n,a=r[0],o=r[1],u=r[2],t=RTe(e,a,o,void 0),d=t.formatValue,s=t.formatDecimals;if((0,Dv.isErrorOper)(d))return d;var c;(n=u==null?void 0:u.value)!==null&&n!==void 0&&n?c=s===0?wO.KnownFormat.NoComFixed0:s===2?wO.KnownFormat.NoComFixed:(0,_ee.buildNumberFormat)(e.config.localeInfo,!1,1,s):c=s===0?wO.KnownFormat.Fixed0:s===2?wO.KnownFormat.Fixed:(0,_ee.buildNumberFormat)(e.config.localeInfo,!0,4,s);var l=e.applyFormat(e.originSheet.document,c,d,Ree.NumberFormatSource.CustomBytecode);return l!==void 0?(0,Zp.stringOper)(l):Zp.valueErrorOper}Tm.fixed=ZTr;function $Tr(e,r){var n=r[0],a=r[1],o=e.config.localeInfo,u=RTe(e,n,a,o.isEastAsia?o.currencyDecimals:void 0),t=u.formatValue,d=u.formatDecimals;if((0,Dv.isErrorOper)(t))return t;var s=d===0?wO.KnownFormat.Currency:d===2?wO.KnownFormat.CurrencyDec:(0,_ee.buildCurrencyFormat)(o,!1,d,!0,!1),c=e.applyFormat(e.originSheet.document,s,t,Ree.NumberFormatSource.CustomBytecode);return c!==void 0&&c.length>0&&c.charCodeAt(c.length-1)===_Te?(0,Zp.stringOper)(c.substring(0,c.length-1)):c!==void 0?(0,Zp.stringOper)(c):Zp.valueErrorOper}Tm.dollar=$Tr;function TTe(e){for(var r=0;r<e.length&&e.charCodeAt(r)===_Te;)r+=1;return e.substring(r)}function ebr(e,r){var n=r[0];switch(n.kind){case z1.OperKind.Boolean:return Zp.valueErrorOper;case z1.OperKind.Number:return n;case z1.OperKind.String:return n.value.length>255?Zp.valueErrorOper:e.coerceOper((0,Zp.stringOper)(TTe(n.value)),z1.OperKind.Number)}}Tm.value=ebr;function bTe(e,r){var n;return!(0,Dv.isStringOper)(r)||r.value.length>255?Zp.valueErrorOper:(n=e.parseDate(TTe(r.value)))!==null&&n!==void 0?n:Zp.valueErrorOper}function rbr(e,r){var n=r[0],a=bTe(e,n);return(0,Dv.isErrorOper)(a)?a:e.mathpack.trunc(a)}Tm.datevalue=rbr;function nbr(e,r){var n=r[0],a=bTe(e,n);return(0,Dv.isErrorOper)(a)?a:e.mathpack.sub(a,e.mathpack.trunc(a))}Tm.timevalue=nbr});var Pee=Y(Jo=>{"use strict";_();Object.defineProperty(Jo,"__esModule",{value:!0});Jo.formulatext=Jo.isformula=Jo.isodd=Jo.iseven=Jo.isomitted=Jo.islambda=Jo.isref=Jo.isnumber=Jo.istext=Jo.isnontext=Jo.isna=Jo.islogical=Jo.isblank=Jo.iserr=Jo.iserror=void 0;var Dc=_o(),I0=ao(),l9=Ic(),tbr=Nv(),abr=cd(),ibr=jC(),bee=Mv();function obr(e,r){var n=r[0];return(0,Dc.booleanOper)((0,I0.isErrorOper)(n))}Jo.iserror=obr;function ubr(e,r){var n=r[0];return(0,Dc.booleanOper)((0,I0.isErrorOper)(n)&&n.type!==Dc.ErrorType.NA)}Jo.iserr=ubr;function sbr(e,r){var n=r[0];return(0,Dc.booleanOper)((0,I0.isBlankOper)(n))}Jo.isblank=sbr;function lbr(e,r){var n=r[0];return(0,Dc.booleanOper)((0,I0.isBooleanOper)(n))}Jo.islogical=lbr;function cbr(e,r){var n=r[0];return(0,Dc.booleanOper)((0,I0.isErrorOper)(n)&&n.type===Dc.ErrorType.NA)}Jo.isna=cbr;function dbr(e,r){var n=r[0];return(0,Dc.booleanOper)(!(0,I0.isStringOper)(n))}Jo.isnontext=dbr;function fbr(e,r){var n=r[0];return(0,Dc.booleanOper)((0,I0.isStringOper)(n))}Jo.istext=fbr;function pbr(e,r){var n=r[0];return(0,Dc.booleanOper)((0,I0.isNumberOper)(n))}Jo.isnumber=pbr;function mbr(e,r){var n=r[0];return(0,Dc.booleanOper)((0,I0.isRangeOper)(n))}Jo.isref=mbr;function gbr(e,r){var n=(0,abr.refToVal)(e,r[0],!0);return(0,Dc.booleanOper)(n instanceof ibr.LambdaOper)}Jo.islambda=gbr;function vbr(e,r){var n=r[0];return(0,Dc.booleanOper)((0,I0.isMissingOper)(n))}Jo.isomitted=vbr;function PTe(e,r){var n=r[0],a=(0,bee.chkNumOper)(e,n);if((0,I0.isErrorOper)(a))return a;var o=e.mathpack,u=10000000000000003e-26,t=(0,bee.assertNumber)(o.add(o.abs(a),o.fromNumber(u))),d=(0,bee.assertNumber)(o.div(o.floor(t),o.fromNumber(2)));return(0,Dc.booleanOper)(o.cond2(d,o.floor(d))===0)}Jo.iseven=PTe;function hbr(e,r){var n=PTe(e,r);return(0,I0.isBooleanOper)(n)?(0,Dc.booleanOper)(!n.value):n}Jo.isodd=hbr;function ETe(e,r,n){if(!(0,I0.isSheetIndex)(r.sheets))return Dc.valueErrorOper;var a=r.ranges[0];if(e.calcingArray||!(0,I0.isGridCell)(a)){var o=r.sheets;return(0,Dc.arrayOper)(a.rows,a.cols,(0,tbr.jaggedArray)(a.rows,a.cols,function(t,d){var s=(0,l9.sheetGridCell)(o,(0,l9.gridCell)(a.row+t,a.col+d));return n(e.getCellFormula(s),s)}))}var u=(0,I0.sheetGridRangeAnchor)((0,l9.sheetGridRange)(r.sheets,a));return n(e.getCellFormula(u),u)}function Sbr(e,r){var n=r[0];return ETe(e,n,function(a){return(0,Dc.booleanOper)(a!==void 0)})}Jo.isformula=Sbr;function ybr(e,r){var n=r[0];return ETe(e,n,function(a,o){if(a===void 0)return Dc.naErrorOper;var u=e.printFormula(a,o.range);return a.source.kind===l9.LexicalKind.Cell?(0,Dc.stringOper)(u):(0,Dc.stringOper)("{"+u+"}")})}Jo.formulatext=ybr});var Nee=Y(pc=>{"use strict";_();Object.defineProperty(pc,"__esModule",{value:!0});pc.single=pc.transpose=pc.offset=pc.sheet=pc.sheets=pc.column=pc.row=pc.columns=pc.rows=pc.areas=void 0;var Rl=_o(),_l=ao(),d9=Ic(),c9=_f(),Cbr=zo(),Eee=Nv();function _br(e,r){var n=r[0];return(0,_l.isSheetIndex)(n.sheets)?e.mathpack.fromNumber(n.ranges.length):Rl.valueErrorOper}pc.areas=_br;function Rbr(e,r){var n=r[0],a=e.mathpack;return(0,_l.isArrayOper)(n)?a.fromNumber(n.rows):(0,_l.isSheetIndex)(n.sheets)?n.ranges.length>1?Rl.refErrorOper:a.fromNumber(n.ranges[0].rows):Rl.valueErrorOper}pc.rows=Rbr;function Tbr(e,r){var n=r[0],a=e.mathpack;return(0,_l.isArrayOper)(n)?a.fromNumber(n.cols):(0,_l.isSheetIndex)(n.sheets)?n.ranges.length>1?Rl.refErrorOper:a.fromNumber(n.ranges[0].cols):Rl.valueErrorOper}pc.columns=Tbr;function NTe(e,r){if(!r)return[e.reflectionGridCell,!e.calcingArray];if(!(0,_l.isSheetIndex)(r.sheets))return Rl.valueErrorOper;if(r.ranges.length>1)return Rl.refErrorOper;var n=r.ranges[0];return[n,(0,_l.isGridCell)(n)]}function bbr(e,r){var n=r[0],a=NTe(e,n);if(!Array.isArray(a))return a;var o=a[0],u=a[1],t=e.mathpack;return u?t.fromNumber(o.row+1):(0,Rl.arrayOper)(o.rows,1,(0,Eee.jaggedArray)(o.rows,1,function(d){return t.fromNumber(o.row+d+1)}))}pc.row=bbr;function Pbr(e,r){var n=r[0],a=NTe(e,n);if(!Array.isArray(a))return a;var o=a[0],u=a[1],t=e.mathpack;return u?t.fromNumber(o.col+1):(0,Rl.arrayOper)(1,o.cols,(0,Eee.jaggedArray)(1,o.cols,function(d,s){return t.fromNumber(o.col+s+1)}))}pc.column=Pbr;function Ebr(e,r){var n=r[0],a=e.mathpack;return n?(0,_l.isArrayOper)(n)?Rl.naErrorOper:a.fromNumber(e.getSheetRangeIndexes(n.sheets).length):a.fromNumber(e.getSheetRangeIndexes((0,d9.allSheetsRange)(e.reflectionSheet.document)).length)}pc.sheets=Ebr;function Nbr(e,r){var n=r[0],a=e.mathpack;if(!n){var o=e.reflectionSheet;return o.index===void 0?Rl.naErrorOper:a.fromNumber(e.getSheetRangePosition(o)+1)}if((0,_l.isStringOper)(n)){var u=e.getSheetIndex(e.reflectionSheet.document,n.value);return u===void 0?Rl.naErrorOper:a.fromNumber(e.getSheetRangePosition(u)+1)}return(0,_l.isRangeOper)(n)?a.fromNumber(e.getSheetRangePosition(n.sheets)+1):(0,_l.isArrayOper)(n)?Rl.naErrorOper:(0,Cbr.assertNever)("calc.funcs.sheet",n)}pc.sheet=Nbr;function Abr(e,r){var n=r[0],a=r[1],o=r[2],u=r[3],t=r[4];if(!(0,_l.isSheetIndex)(n.sheets)||n.ranges.length!==1)return Rl.valueErrorOper;var d=e.mathpack,s=n.ranges[0],c=s.row,l=s.col,f=s.rows,p=s.cols,m=c;(0,_l.isNumberOper)(a)&&(m+=d.lfix(a));var v=l;(0,_l.isNumberOper)(o)&&(v+=d.lfix(o));var h=m+f-1;if(u!==void 0&&(0,_l.isNumberOper)(u)){var S=d.cond(u);if(S===0)return Rl.refErrorOper;h=m+d.lfix(u)-(S>0?1:-1)}var y=v+p-1;if(t!==void 0&&(0,_l.isNumberOper)(t)){var S=d.cond(t);if(S===0)return Rl.refErrorOper;y=v+d.lfix(t)-(S>0?1:-1)}var C=(0,c9.fastMin)(m,h),E=(0,c9.fastMin)(v,y),I=(0,c9.fastMax)(m,h)-C+1,F=(0,c9.fastMax)(v,y)-E+1;return C<0||E<0||C+I>d9.sheetRows||E+F>d9.sheetCols?Rl.refErrorOper:(0,Rl.rangeSeqOper)(n.sheets,[(0,d9.gridRange)(C,E,I,F)])}pc.offset=Abr;function Obr(e,r){var n=r[0];return(0,_l.isArrayOper)(n)?(0,Rl.arrayOper)(n.cols,n.rows,(0,Eee.jaggedArray)(n.cols,n.rows,function(a,o){return n.opers[o][a]})):n}pc.transpose=Obr;function kbr(e,r){var n=r[0];if((0,_l.isPrimitiveOper)(n)||(0,_l.isMissingOper)(n)||(0,_l.isBlankOper)(n)||(0,_l.isRichOper)(n))return n;if((0,_l.isArrayOper)(n))return n.opers[0][0];if(!(0,_l.isSheetIndex)(n.sheets))return Rl.refErrorOper;if(n.ranges.length!==1)return Rl.valueErrorOper;var a=e.originGridCell,o=(0,_l.gridCellImplicitIsect)(a,n.ranges[0]);return o===void 0?Rl.valueErrorOper:(0,Rl.rangeSeqOper)(n.sheets,[o])}pc.single=kbr});var Aee=Y(DO=>{"use strict";_();Object.defineProperty(DO,"__esModule",{value:!0});DO.record=DO.fieldvalue=void 0;var Fbr=_o(),Ibr=ao(),Mbr=J3(),wbr=jC();function Dbr(e,r){var n=r[0],a=r[1].value;if((0,Ibr.isRichOper)(n)){var o=n.getField(a);if(o!==void 0)return o}return Fbr.fieldErrorOper}DO.fieldvalue=Dbr;function xbr(e,r){for(var n=r[0],a=e.config.localeInfo,o=Mbr.RedBlackMapTree.create(a.stringCompareCI),u=1;u<r.length;u+=2){var t=r[u].value,d=r[u+1];o=o.setValue(t,d)}return new wbr.RecordOper(o,n)}DO.record=xbr});var ATe=Y(Wi=>{"use strict";_();Object.defineProperty(Wi,"__esModule",{value:!0});Wi.shouldQuoteQualifier=Wi.resolvePosition=Wi.quoteQualifier=Wi.formatRowRange=Wi.formatRow=Wi.formatRangePos=Wi.formatQualifier=Wi.formatGridRange=Wi.formatColRange=Wi.formatCol=Wi.formatCellPos=Wi.columnName=Wi.canonicaliseRowRange=Wi.canonicaliseRow=Wi.canonicaliseRangePos=Wi.canonicaliseColRange=Wi.canonicaliseCol=Wi.canonicaliseCellPos=Wi.canonicaliseBrackets=void 0;var Wd=et();Wi.canonicaliseBrackets=Wd.cellFormat.canonicaliseBrackets;Wi.canonicaliseCellPos=Wd.cellFormat.canonicaliseCellPos;Wi.canonicaliseCol=Wd.cellFormat.canonicaliseCol;Wi.canonicaliseColRange=Wd.cellFormat.canonicaliseColRange;Wi.canonicaliseRangePos=Wd.cellFormat.canonicaliseRangePos;Wi.canonicaliseRow=Wd.cellFormat.canonicaliseRow;Wi.canonicaliseRowRange=Wd.cellFormat.canonicaliseRowRange;Wi.columnName=Wd.cellFormat.columnName;Wi.formatCellPos=Wd.cellFormat.formatCellPos;Wi.formatCol=Wd.cellFormat.formatCol;Wi.formatColRange=Wd.cellFormat.formatColRange;Wi.formatGridRange=Wd.cellFormat.formatGridRange;Wi.formatQualifier=Wd.cellFormat.formatQualifier;Wi.formatRangePos=Wd.cellFormat.formatRangePos;Wi.formatRow=Wd.cellFormat.formatRow;Wi.formatRowRange=Wd.cellFormat.formatRowRange;Wi.quoteQualifier=Wd.cellFormat.quoteQualifier;Wi.resolvePosition=Wd.cellFormat.resolvePosition;Wi.shouldQuoteQualifier=Wd.cellFormat.shouldQuoteQualifier});var f9=Y(Af=>{"use strict";_();Object.defineProperty(Af,"__esModule",{value:!0});Af.vstack=Af.hstack=Af.drop=Af.take=Af.rangeOrArrayToVal=Af.sequence=Af.indirect=Af.address=void 0;var MTe=_o(),Fs=_o(),M0=Ic(),cp=mO(),OTe=ATe(),mc=ao(),Lbr=Sm(),wTe=zo(),Bbr=ow(),Oee=Bd(),kee=Bl(),qbr=zs(),JP=_f(),xO=Nv(),Ubr=QP(),DTe=Mv();function Gbr(e,r){var n=r[0],a=r[1],o=r[2],u=r[3],t=r[4],d=e.mathpack,s=(o==null?void 0:o.kind)===kee.OperKind.Number?d.sfix(o)-1:0;if(s<0||s>3)return Fs.valueErrorOper;var c=(s&1)!==0,l=(s&2)!==0,f=(u==null?void 0:u.kind)!==kee.OperKind.Boolean||u.value?cp.RefStyle.A1:cp.RefStyle.R1C1,p=function(I,F,w){return f===cp.RefStyle.R1C1&&I?-F<w&&w<F:1<=w&&w<=F},m=d.sfix(n);if(!p(l,M0.sheetRows,m)||!(0,mc.isNumberOper)(a))return Fs.valueErrorOper;var v=d.sfix(a);if(!p(c,M0.sheetCols,v))return Fs.valueErrorOper;var h=(0,M0.gridCell)(m<0?M0.sheetRows-1:0,v<0?M0.sheetCols-1:0),S=(0,cp.pos)(l?cp.PosKind.Rel:cp.PosKind.Abs,f===cp.RefStyle.R1C1&&l?m:m-1),y=(0,cp.pos)(c?cp.PosKind.Rel:cp.PosKind.Abs,f===cp.RefStyle.R1C1&&c?v:v-1),C=(0,OTe.formatCellPos)(e.config.localeInfo,f,h,S,y,!1);return(0,wTe.assertTrue)("calc.funcs.address: cell wrapped",C!==void 0),(t==null?void 0:t.kind)===kee.OperKind.String?t.value===""?(0,Fs.stringOper)("!"+C):t.value.length>255?Fs.valueErrorOper:(0,Fs.stringOper)((0,OTe.formatQualifier)(e.config.localeInfo,e.config.refStyle,t.value)+"!"+C):(0,Fs.stringOper)(C)}Af.address=Gbr;function Kbr(e,r){var n,a=r[0].value,o=r[1],u=!((n=o==null?void 0:o.value)!==null&&n!==void 0)||n?cp.RefStyle.A1:cp.RefStyle.R1C1;if(a.length>255||(0,Bbr.stringStartsWith)(a," "))return Fs.valueErrorOper;var t=(0,M0.originCell)(e.originSheet,e.originGridCell),d=!0,s={lexicalKind:M0.LexicalKind.Indirect,originGridCell:(0,Oee.success)(t.range),originSheet:(0,Oee.success)(t.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!1,wrapCellReferences:d,workbookLoad:!1},c=e.parseFormula(u,t.range,s,"="+a);if(!(0,Oee.isSuccess)(c))return Fs.refErrorOper;for(var l=c.value.node,f=!1,p=!1;;){if(!f&&l.kind===cp.NodeKind.App&&(0,mc.isOperatorNode)(l.head)&&l.head.id===Lbr.OperatorId.Pound&&l.args.length===1&&(f=!0,l=l.args[0]),!p&&l.kind===cp.NodeKind.Name){var m=e.getNameFormula(l.qualifier,l.whole,M0.NameSource.Indirect);if(m===void 0)return Fs.refErrorOper;t=(0,M0.originCell)(t.sheet,(0,M0.gridCell)(0,0)),l=m[1],p=!0;continue}if(l.kind===cp.NodeKind.CellRef){var v=e.getCellRef(l.qualifier,l.ref,t,d);return v===void 0||!(0,mc.isSheetIndex)(v.sheets)?Fs.refErrorOper:f?(0,qbr.throwEvaluationError)((0,mc.notImplemented)(["# operator in INDIRECT"])):v}if(l.kind===cp.NodeKind.StructRef){if(l.lhs===void 0)return Fs.refErrorOper;var v=e.getStructRef(l.lhs,l.rhs,t);return v===void 0||f?Fs.refErrorOper:v}return Fs.refErrorOper}}Af.indirect=Kbr;var Vbr=function(r,n){var a=n[0],o=n[1],u=n[2],t=n[3],d=r.mathpack,s=(0,mc.isMissingOper)(a)?1:d.sfix(a),c=o===void 0||(0,mc.isMissingOper)(o)?1:d.sfix(o);if(s<0||s>M0.sheetRows||c<0||c>M0.sheetRows)return Fs.valueErrorOper;if((0,DTe.validateArraySize)(s,c),s===0||c===0)return Fs.calcErrorOper;for(var l=u===void 0||(0,mc.isMissingOper)(u)?d.fromNumber(1):u,f=t===void 0||(0,mc.isMissingOper)(t)?d.fromNumber(1):t,p=l,m=[],v=0;v<s;v++){for(var h=[],S=0;S<c;S++)if(h.push(p),!(0,mc.isErrorOper)(p)){var y=d.add(p,f);p=(0,mc.isErrorOper)(y)?y:d.checkAlmostCancellation(f,y)}m.push(h)}return(0,Fs.arrayOper)(s,c,m)};Af.sequence=Vbr;var xTe=function(){function e(r){this.oper=r;var n=r.ranges[0],a=n.rows,o=n.cols;this.rows=a,this.cols=o}return e.prototype.slice=function(r,n,a,o){var u=this.oper.ranges[0],t=u.row,d=u.col;return(0,Fs.range3DOper)(this.oper.sheets,(0,M0.gridRange)(t+r,d+a,n,o))},e}(),LTe=function(){function e(r){this.oper=r,this.rows=r.opers.length,this.cols=r.opers[0].length}return e.prototype.slice=function(r,n,a,o){return(0,Fs.arrayOper)(n,o,this.oper.opers.slice(r,r+n).map(function(u){return u.slice(a,a+o)}))},e}();function Fee(e){return(0,mc.isRangeOper)(e)?e.ranges.length>1?Fs.valueErrorOper:((0,wTe.assertTrue)("calc.funcs.takeDrop: not 3D ref",(0,mc.isSheetIndex)(e.sheets)),e):e}Af.rangeOrArrayToVal=Fee;function kTe(e,r){if((0,JP.fastAbs)(e)<r){var n=(0,JP.fastAbs)(e);return e<0?{start:r-n,count:n}:{start:0,count:n}}return{start:0,count:r}}function FTe(e,r){if((0,JP.fastAbs)(e)<r){var n=r-(0,JP.fastAbs)(e);return e<0?{start:0,count:n}:{start:e,count:n}}return{start:0,count:0}}var Wbr=function(r,n){var a=n[0],o=n[1],u=n[2],t=r.mathpack,d=Fee(a);if(!(0,mc.isArrayOper)(d)&&!(0,mc.isRangeOper)(d))return d;var s=(0,mc.isRangeOper)(d)?new xTe(d):new LTe(d),c=(0,mc.isMissingOper)(o)?s.rows:t.lfix(o),l=u===void 0||(0,mc.isMissingOper)(u)?s.cols:t.lfix(u),f=kTe(c,s.rows),p=f.start,m=f.count,v=kTe(l,s.cols),h=v.start,S=v.count;return m===0||S===0?Fs.calcErrorOper:s.slice(p,m,h,S)};Af.take=Wbr;var jbr=function(r,n){var a=n[0],o=n[1],u=n[2],t=r.mathpack,d=Fee(a);if(!(0,mc.isArrayOper)(d)&&!(0,mc.isRangeOper)(d))return d;var s=(0,mc.isRangeOper)(d)?new xTe(d):new LTe(d),c=(0,mc.isMissingOper)(o)?0:t.lfix(o),l=u===void 0||(0,mc.isMissingOper)(u)?0:t.lfix(u),f=FTe(c,s.rows),p=f.start,m=f.count,v=FTe(l,s.cols),h=v.start,S=v.count;return m===0||S===0?Fs.calcErrorOper:s.slice(p,m,h,S)};Af.drop=jbr;var Hbr=function(r,n){return BTe(r,n,!0)};Af.hstack=Hbr;var Qbr=function(r,n){return BTe(r,n,!1)};Af.vstack=Qbr;function ITe(e){return new xO.NonstrictArray2D(e.cols,e.rows,function(r,n){return e.get(n,r)})}function zbr(e,r,n){return e.cols>=r?e:new xO.NonstrictSparseArray2D(e.rows,r,e.rows,e.cols,e.get.bind(e),n)}var Ybr=function(){return MTe.naErrorOper};function BTe(e,r,n){var a=e.dereferenceAllOpers(r),o=a.map(function(f){return(0,Ubr.isRangeValues)(f)?f.arrays:[(0,xO.strictArray2D)(f.rows,f.cols,f.opers)]}),u=(0,JP.safeConcat)([],o).map(function(f){return n?ITe(f):f}),t=u.reduce(function(f,p){return(0,JP.fastMax)(p.cols,f)},0),d=u.reduce(function(f,p){return f+p.rows},0);if(t>M0.sheetRows||d>M0.sheetRows)return MTe.numErrorOper;(0,DTe.validateArraySize)(d,t);var s=(0,JP.safeConcat)([],u.map(function(f){return zbr(f,t,Ybr)}).map(xO.array2DToJaggedArray)),c=(0,xO.strictArray2D)(s.length,s[0].length,s),l=n?ITe(c):c;return(0,Fs.arrayOper)(l.rows,l.cols,(0,xO.array2DToJaggedArray)(l))}});var p9=Y(Ja=>{"use strict";_();Object.defineProperty(Ja,"__esModule",{value:!0});Ja.textAfter=Ja.textBefore=Ja.textSplit=Ja.substitute=Ja.search=Ja.replace=Ja.find=Ja.proper=Ja.upper=Ja.lower=Ja.unicode=Ja.code=Ja.unichar=Ja.char=Ja.clean=Ja.trim=Ja.rept=Ja.exact=Ja.concatenate=Ja.len=Ja.mid=Ja.left=Ja.right=void 0;var gc=ao(),Bt=_o(),xee=zs(),Of=w$(),Jbr=fw(),Pw=qG(),UTe=ow(),GTe=Bl(),Xbr=qd(),Mee=zo(),Zbr=_f(),$br=Mv(),Iee=Pw.codePointSpace,ePr=Pw.codePointCapitalA,rPr=Pw.codePointCapitalZ,nPr=Pw.codePointSmallA,tPr=Pw.codePointSmallZ,Lee=2147483647;function KTe(e,r){return r===void 0?1:e.cond(r)<0?Bt.valueErrorOper:e.sfix(r)}function aPr(e,r){var n,a=r[0].value,o=r[1];if(o!==void 0&&(0,gc.isErrorOper)(o))return o;var u=KTe(e.mathpack,o);if(typeof u!="number"&&(0,gc.isErrorOper)(u))return Bt.valueErrorOper;var t=(n=(0,Of.scanCodePointsBack)(a,a.length,u))!==null&&n!==void 0?n:0;return(0,Bt.stringOper)(a.substring(t))}Ja.right=aPr;function iPr(e,r){var n,a=r[0].value,o=r[1];if(o!==void 0&&(0,gc.isErrorOper)(o))return o;var u=KTe(e.mathpack,o);if(typeof u!="number"&&(0,gc.isErrorOper)(u))return Bt.valueErrorOper;var t=(n=(0,Of.scanCodePoints)(a,0,u))!==null&&n!==void 0?n:a.length;return(0,Bt.stringOper)(a.substring(0,t))}Ja.left=iPr;function oPr(e,r){var n,a,o=r[0].value,u=r[1],t=r[2],d=e.mathpack,s=d.fix(u)-1,c=d.fix(t);if(d.cond(u)<0||s<0||d.cond(t)<0||c<0)return Bt.valueErrorOper;var l=(n=(0,Of.scanCodePoints)(o,0,s))!==null&&n!==void 0?n:o.length,f=(a=(0,Of.scanCodePoints)(o,l,c))!==null&&a!==void 0?a:o.length;return(0,Bt.stringOper)(o.substring(l,f))}Ja.mid=oPr;function uPr(e,r){var n=r[0].value;return e.mathpack.fromNumber((0,Of.countCodePoints)(n,0,n.length))}Ja.len=uPr;function sPr(e,r){for(var n="",a=0;a<r.length;a+=1){var o=r[a].value;if(n.length+o.length>Bt.cellStringLimit){n+=o.substring(0,Bt.cellStringLimit-n.length);break}n+=o}return(0,Bt.stringOper)(n)}Ja.concatenate=sPr;function lPr(e,r){var n=r[0],a=r[1];return((0,gc.isRichOper)(n)||(0,gc.isRichOper)(a))&&(0,xee.throwEvaluationError)((0,gc.notImplemented)(["EXACT rich argument"])),(0,Bt.booleanOper)(n.value===a.value)}Ja.exact=lPr;function cPr(e,r){var n=r[0].value,a=r[1],o=e.mathpack,u=o.fix(a);return o.cond(a)<0||u>Lee?Bt.valueErrorOper:n===""?Xbr.emptyStringOper:u*n.length>Bt.cellStringLimit?Bt.valueErrorOper:(0,Bt.stringOper)((0,UTe.repeat)(n,u))}Ja.rept=cPr;function dPr(e,r){for(var n=r[0].value,a="",o=0;o<n.length;){for(;o<n.length&&n.charCodeAt(o)===Iee;)o+=1;for(var u=o;o<n.length;){var t=n.charCodeAt(o)===Iee;if(o+=1,t)break}a+=n.substring(u,o)}return a.length>0&&a.charCodeAt(a.length-1)===Iee&&(a=a.substring(0,a.length-1)),(0,Bt.stringOper)(a)}Ja.trim=dPr;function fPr(e,r){for(var n=r[0].value,a="",o=0;o<n.length;o+=1){var u=n.charCodeAt(o);(u>=256||(u&127)>=32)&&(a+=n.charAt(o))}return(0,Bt.stringOper)(a)}Ja.clean=fPr;function pPr(e,r){var n=r[0],a=e.mathpack.sfix(n);return a<1||a>255?Bt.valueErrorOper:(0,Bt.stringOper)(String.fromCharCode(a))}Ja.char=pPr;function mPr(e,r){var n=r[0],a=e.mathpack,o=a.lfix(a.trunc(n));if(a.cond2(n,a.one)<0||o>=1114112)return Bt.valueErrorOper;var u=64976,t=65007,d=65535,s=65534;return o<=65535&&(0,Of.isAnySurrogate)(o)||o>=u&&o<=t||(o&d)>=s?Bt.naErrorOper:(0,Bt.stringOper)((0,Of.stringFromCodePoint)(o))}Ja.unichar=mPr;function gPr(e,r){var n=r[0].value;if(n.length===0)return Bt.valueErrorOper;var a=n.charCodeAt(0);return a>255?(0,xee.throwEvaluationError)((0,gc.notImplemented)(["CODE for codepoints > 255"])):e.mathpack.fromNumber(a)}Ja.code=gPr;function vPr(e,r){var n=r[0].value;if(n.length===0)return Bt.valueErrorOper;var a=n.charCodeAt(0),o=e.mathpack;if(!(0,Of.isAnySurrogate)(a))return o.fromNumber(a);if(n.length===1)return Bt.valueErrorOper;var u=n.charCodeAt(1),t=(0,Of.surrogatePairToCodePoint)(a,u);return t===void 0?Bt.valueErrorOper:o.fromNumber(t)}Ja.unicode=vPr;function hPr(e){for(var r=0;r<e.length;r+=1)if(e.charCodeAt(r)>=128)return!1;return!0}function qTe(e){return e>=ePr&&e<=rPr||e>=nPr&&e<=tPr}function Bee(e,r,n){return e===""?e:hPr(e)?n():(0,xee.throwEvaluationError)((0,gc.notImplemented)([r+" for non-ASCII input"]))}function SPr(e,r){var n=r[0].value;return(0,Bt.stringOper)(Bee(n,"LOWER",n.toLowerCase.bind(n)))}Ja.lower=SPr;function yPr(e,r){var n=r[0].value;return(0,Bt.stringOper)(Bee(n,"UPPER",n.toUpperCase.bind(n)))}Ja.upper=yPr;function CPr(e,r){var n=r[0].value;return(0,Bt.stringOper)(Bee(n,"PROPER",function(){for(var a=n.toLowerCase(),o="",u=0;;){for(var t=u;u<a.length&&!qTe(a.charCodeAt(u));)u+=1;if(o+=a.substring(t,u),u===a.length)break;var d=u,s=(0,Of.stringCodePointAt)(a,u);for(o+=(0,Of.stringFromCodePoint)(s).toUpperCase(),u+=(0,Of.numCodeUnits)(s);u<a.length&&qTe(a.charCodeAt(u));)u+=1;o+=a.substring(d+1,u)}return o}))}Ja.proper=CPr;function _Pr(e,r){var n,a=r[0].value,o=r[1].value,u=r[2],t=u!==void 0?e.mathpack.sfix(u)-1:0;if(t<0||t>=Lee)return Bt.valueErrorOper;var d=(n=(0,Of.scanCodePoints)(o,0,t))!==null&&n!==void 0?n:o.length,s=o.indexOf(a,d);return s>=0?e.mathpack.fromNumber((0,Of.countCodePoints)(o,0,s)+1):Bt.valueErrorOper}Ja.find=_Pr;function RPr(e,r){var n,a,o=r[0].value,u=r[1],t=r[2],d=r[3].value,s=e.mathpack.sfix(u)-1;if(s<0||s>=Bt.cellStringLimit)return Bt.valueErrorOper;var c=e.mathpack.sfix(t);if(c<0||c>Bt.cellStringLimit)return Bt.valueErrorOper;var l=(n=(0,Of.scanCodePoints)(o,0,s))!==null&&n!==void 0?n:o.length,f=(a=(0,Of.scanCodePoints)(o,l,c))!==null&&a!==void 0?a:o.length,p=o.slice(0,l),m=o.slice(f);return p.length+d.length+m.length>Bt.cellStringLimit?Bt.valueErrorOper:(0,Bt.stringOper)(p+d+m)}Ja.replace=RPr;function TPr(e,r){var n,a=r[0].value,o=r[1].value,u=r[2],t=u!==void 0?e.mathpack.sfix(u)-1:0;if(t<0||t>=Lee)return Bt.valueErrorOper;for(var d=(n=(0,Of.scanCodePoints)(o,0,t))!==null&&n!==void 0?n:o.length,s=new Jbr.WildExp(e.config.localeInfo,a,!0);d<o.length;d+=1)if(s.test(o.slice(d)))return e.mathpack.fromNumber((0,Of.countCodePoints)(o,0,d)+1);return Bt.valueErrorOper}Ja.search=TPr;function bPr(e,r){var n=r[0],a=r[1].value,o=r[2].value,u=r[3],t=n.value,d=1/0;if(u!==void 0){var s=e.coerceOper(u,GTe.OperKind.Number);if((0,gc.isErrorOper)(s))return s;if(d=e.mathpack.sfix(s),d<1||d>2147483646)return Bt.valueErrorOper}var c=a.length;if(c>0){for(var l="",f=0,p=0;d>=0&&(p=t.indexOf(a,p))!==-1;)if(d-=1,d===1/0||d===0){var m=t.slice(f,p);if(l.length+m.length+o.length>Bt.cellStringLimit)return Bt.valueErrorOper;l+=m,l+=o,p+=c,f=p}else p+=1;var v=t.slice(f);return l.length+v.length>Bt.cellStringLimit?Bt.valueErrorOper:(l+=v,(0,Bt.stringOper)(l))}return n}Ja.substitute=bPr;function wee(e,r,n){if(r===void 0||(0,gc.isMissingOper)(r))return[];if((0,gc.isStringOper)(r))return n&&r.value.length===0?Bt.valueErrorOper:[r.value];for(var a=[],o=0;o<r.rows;++o)for(var u=r.opers[o],t=0;t<u.length;++t){var d=u[t],s=e.coerceOper(d,GTe.OperKind.String);if((0,gc.isErrorOper)(s))return s;var c=(0,$br.assertString)(s).value;if(n&&c.length===0)return Bt.valueErrorOper;a.push(c)}return a.sort(function(l,f){return l.length-f.length}),a}function Dee(e,r,n){for(var a=0,o=n;a<o.length;a++){var u=o[a];if((0,UTe.stringStartsWith)(e,u,r))return u}}function PPr(e,r,n,a,o){for(var u,t=0,d=0,s=[],c;t<=r.length;){var l=void 0,f=void 0;if(d<r.length&&(l=Dee(r,d,n),f=l===void 0?Dee(r,d,a):void 0),(0,Mee.assertTrue)("calc.runtime.textsplit: current in bounds",d<=r.length),l!==void 0||f!==void 0||d===r.length){var p=d-t;(p>0||!o)&&(c===void 0&&(c=[],s.push(c)),c.push((0,Bt.stringOper)(r.slice(t,d))),f!==void 0&&(c=void 0));var m=((u=l??f)!==null&&u!==void 0?u:"1").length;(0,Mee.assertTrue)("calc.runtime.textsplit: matchLength > 0",m>0),d+=m,t=d}else++d}return s}var EPr=function(r,n){var a=n[0],o=n[1],u=n[2],t=n[3],d=n[4],s=n[5],c=a.value;if(c.length===0)return Bt.valueErrorOper;var l=wee(r,o,!0);if(!Array.isArray(l))return l;var f=wee(r,u,!0);if(!Array.isArray(f))return f;var p=t===void 0||(0,gc.isMissingOper)(t)?!1:t.value,m;if(d===void 0||(0,gc.isMissingOper)(d))m=!1;else{var v=r.mathpack.lfix(d);if(v!==0&&v!==1)return Bt.valueErrorOper;m=v===1}var h=s===void 0||(0,gc.isMissingOper)(s)?Bt.naErrorOper:s;if((0,gc.isArrayOper)(h))return Bt.valueErrorOper;var S=c;if(m&&(S=c.toLowerCase(),l=l.map(function(E){return E.toLowerCase()}),f=f.map(function(E){return E.toLowerCase()})),l.length===0&&f.length===0)return Bt.valueErrorOper;var y=PPr(c,S,l,f,p);if(!Array.isArray(y))return y;if(y.length===0)return Bt.calcErrorOper;var C=y.reduce(function(E,I){return(0,Zbr.fastMax)(I.length,E)},0);return(0,Mee.assertTrue)("calc.runtime.textsplit: non-zero cols",C>0),(0,Bt.arrayOper)(y.length,C,y.map(function(E){for(;E.length<C;)E.push(h);return E}))};Ja.textSplit=EPr;function NPr(e,r,n,a,o,u,t){var d=e,s=r;if(n===0)return a>0?[0,0]:[d.length,d.length];var c=d.length-n;if(c<0)return t;o&&(d=d.toLowerCase(),s=s.map(function(h){return h.toLowerCase()}));var l=a,f=0,p=d.length,m=1;for(a<0&&(m=-1,f=p);f<=p&&f>=0;){var v=Dee(d,f,s);if(v!==void 0){if(l-=m,l===0)return[f,v.length];f+=m*(v.length-1)}f+=m}return u&&a-m===0?m===1?[d.length,0]:[0,0]:t}function APr(e,r,n,a,o,u,t){var d=r.value,s=a===void 0||(0,gc.isMissingOper)(a)?1:e.mathpack.sfix(a),c=wee(e,n,!1);if(!Array.isArray(c))return c;var l=c.reduce(function(C,E){return E.length<C?E.length:C},c[0].length),f=-(d.length-l+1),p=d.length-l+1;if(a!==void 0&&!(0,gc.isMissingOper)(a)&&(l!==0&&!(s>=f&&s<=p)||s===0))return Bt.valueErrorOper;var m;if(o===void 0||(0,gc.isMissingOper)(o))m=!1;else{var v=e.mathpack.lfix(o);if(v!==0&&v!==1)return Bt.valueErrorOper;m=v===1}var h;if(u===void 0||(0,gc.isMissingOper)(u))h=!1;else{var S=e.mathpack.lfix(u);if(S!==0&&S!==1)return Bt.valueErrorOper;h=S===1}var y=t===void 0||(0,gc.isMissingOper)(t)?Bt.naErrorOper:t;return NPr(d,c,l,s,m,h,y)}function VTe(e,r,n,a,o,u,t,d){var s=APr(r,n,a,o,u,t,d);if(Array.isArray(s)){var c=s[0],l=s[1];return e===bw.TEXTBEFORE?(0,Bt.stringOper)(n.value.slice(0,c)):(0,Bt.stringOper)(n.value.slice(c+l))}return s}var bw;(function(e){e[e.TEXTBEFORE=1]="TEXTBEFORE",e[e.TEXTAFTER=2]="TEXTAFTER"})(bw||(bw={}));var OPr=function(r,n){var a=n[0],o=n[1],u=n[2],t=n[3],d=n[4],s=n[5];return VTe(bw.TEXTBEFORE,r,a,o,u,t,d,s)};Ja.textBefore=OPr;var kPr=function(r,n){var a=n[0],o=n[1],u=n[2],t=n[3],d=n[4],s=n[5];return VTe(bw.TEXTAFTER,r,a,o,u,t,d,s)};Ja.textAfter=kPr});var Uee=Y(Y1=>{"use strict";_();Object.defineProperty(Y1,"__esModule",{value:!0});Y1.today=Y1.now=Y1.randbetween=Y1.rand=void 0;var FPr=_o(),m9=Mv(),qee=ao(),WTe=X$();function IPr(e,r){return e.getRandom()}Y1.rand=IPr;function MPr(e,r){var n=r[0],a=r[1],o=(0,m9.chkNumOper)(e,n),u=(0,m9.chkNumOper)(e,a);if((0,qee.isErrorOper)(o))return o;if((0,qee.isErrorOper)(u))return u;var t=e.mathpack;if(t.cond2(o,u)>0)return FPr.numErrorOper;var d=e.getRandom(),s=t.ceil(o),c=t.floor(u),l=t.sub(c,s);return(0,qee.isErrorOper)(l)?l:t.add(t.floor((0,m9.assertNumber)(t.mul((0,m9.assertNumber)(t.add(l,t.one)),d))),s)}Y1.randbetween=MPr;function wPr(e,r){return e.getTime(WTe.TimeGranularity.Instant)}Y1.now=wPr;function DPr(e,r){return e.getTime(WTe.TimeGranularity.Day)}Y1.today=DPr});var Gee=Y(g9=>{"use strict";_();Object.defineProperty(g9,"__esModule",{value:!0});g9.hyperlink=void 0;function xPr(e,r){var n=r[0],a=r[1];return e.followHyperlinks?n:a??n}g9.hyperlink=xPr});var Wee=Y(S9=>{"use strict";_();Object.defineProperty(S9,"__esModule",{value:!0});S9.getWorksheetFunc=void 0;var ta=J$(),xc=iee(),jTe=uee(),LO=see(),Kee=lee(),XP=pee(),Nw=u9(),uo=s9(),BO=Tee(),w0=Pee(),J1=Nee(),v9=Aee(),HTe=f9(),pd=p9(),h9=Uee(),LPr=Gee(),ZC=HP(),Ye=Sm(),Ew=f9(),Vee=p9(),ze={};ze[Ye.WorksheetFuncId.SUM]=ta.sum;ze[Ye.WorksheetFuncId.PRODUCT]=ta.product;ze[Ye.WorksheetFuncId.AVERAGE]=ta.average;ze[Ye.WorksheetFuncId.COUNTBLANK]=ta.countblank;ze[Ye.WorksheetFuncId.MAX]=ta.max;ze[Ye.WorksheetFuncId.MIN]=ta.min;ze[Ye.WorksheetFuncId.AND]=ta.and;ze[Ye.WorksheetFuncId.COUNTA]=ta.counta;ze[Ye.WorksheetFuncId.OR]=ta.or;ze[Ye.WorksheetFuncId.CONCAT]=ta.concat;ze[Ye.WorksheetFuncId.AVERAGEIF]=ta.averageif;ze[Ye.WorksheetFuncId.AVERAGEIFS]=ta.averageifs;ze[Ye.WorksheetFuncId.COUNT]=ta.count;ze[Ye.WorksheetFuncId.COUNTIF]=ta.countif;ze[Ye.WorksheetFuncId.COUNTIFS]=ta.countifs;ze[Ye.WorksheetFuncId.MEDIAN]=ta.median;ze[Ye.WorksheetFuncId.SUMSQ]=ta.sumsq;ze[Ye.WorksheetFuncId.SUMIF]=ta.sumif;ze[Ye.WorksheetFuncId.SUMIFS]=ta.sumifs;ze[Ye.WorksheetFuncId.LARGE]=ta.large;ze[Ye.WorksheetFuncId.SMALL]=ta.small;ze[Ye.WorksheetFuncId.RANK]=ta.rank;ze[Ye.WorksheetFuncId.RANK_EQ]=ta.rank;ze[Ye.WorksheetFuncId.RANK_AVG]=ta.rank_avg;ze[Ye.WorksheetFuncId.PERCENTILE]=ta.percentile;ze[Ye.WorksheetFuncId.PERCENTILE_INC]=ta.percentile;ze[Ye.WorksheetFuncId.PERCENTILE_EXC]=ta.percentile_exc;ze[Ye.WorksheetFuncId.QUARTILE]=ta.quartile;ze[Ye.WorksheetFuncId.QUARTILE_INC]=ta.quartile;ze[Ye.WorksheetFuncId.QUARTILE_EXC]=ta.quartile_exc;ze[Ye.WorksheetFuncId.TRIMMEAN]=ta.trimmean;ze[Ye.WorksheetFuncId.AVERAGEA]=ta.averagea;ze[Ye.WorksheetFuncId.MAXA]=ta.maxa;ze[Ye.WorksheetFuncId.MINA]=ta.mina;ze[Ye.WorksheetFuncId.MAXIFS]=ta.maxifs;ze[Ye.WorksheetFuncId.MINIFS]=ta.minifs;ze[Ye.WorksheetFuncId.XOR]=ta.xor;ze[Ye.WorksheetFuncId.AGGREGATE]=ta.aggregate;ze[Ye.WorksheetFuncId.SUBTOTAL]=ta.subtotal;ze[Ye.WorksheetFuncId.VAR]=ta.var_;ze[Ye.WorksheetFuncId.VAR_S]=ta.var_;ze[Ye.WorksheetFuncId.VARP]=ta.varp;ze[Ye.WorksheetFuncId.VAR_P]=ta.varp;ze[Ye.WorksheetFuncId.STDEV]=ta.stdev;ze[Ye.WorksheetFuncId.STDEV_S]=ta.stdev;ze[Ye.WorksheetFuncId.STDEVP]=ta.stdevp;ze[Ye.WorksheetFuncId.STDEV_P]=ta.stdevp;ze[Ye.WorksheetFuncId.VARA]=ta.vara;ze[Ye.WorksheetFuncId.VARPA]=ta.varpa;ze[Ye.WorksheetFuncId.STDEVA]=ta.stdeva;ze[Ye.WorksheetFuncId.STDEVPA]=ta.stdevpa;ze[Ye.WorksheetFuncId.AVEDEV]=ta.avedev;ze[Ye.WorksheetFuncId.DEVSQ]=ta.devsq;ze[Ye.WorksheetFuncId.MODE]=ta.mode;ze[Ye.WorksheetFuncId.MODE_SNGL]=ta.mode;ze[Ye.WorksheetFuncId.MODE_MULT]=ta.mode_mult;ze[Ye.WorksheetFuncId.TEXTJOIN]=ta.textjoin;ze[Ye.WorksheetFuncId.YEAR]=xc.year;ze[Ye.WorksheetFuncId.MONTH]=xc.month;ze[Ye.WorksheetFuncId.DAY]=xc.day;ze[Ye.WorksheetFuncId.HOUR]=xc.hour;ze[Ye.WorksheetFuncId.MINUTE]=xc.minute;ze[Ye.WorksheetFuncId.SECOND]=xc.second;ze[Ye.WorksheetFuncId.WEEKNUM]=xc.weeknum;ze[Ye.WorksheetFuncId.ISOWEEKNUM]=xc.isoweeknum;ze[Ye.WorksheetFuncId.WEEKDAY]=xc.weekday;ze[Ye.WorksheetFuncId.DATE]=xc.date;ze[Ye.WorksheetFuncId.TIME]=xc.time;ze[Ye.WorksheetFuncId.DAYS360]=xc.days360;ze[Ye.WorksheetFuncId.DAYS]=xc.days;ze[Ye.WorksheetFuncId.DATEDIF]=xc.datedif;ze[Ye.WorksheetFuncId.WORKDAY]=xc.workday;ze[Ye.WorksheetFuncId.WORKDAY_INTL]=xc.workday_intl;ze[Ye.WorksheetFuncId.EDATE]=xc.edate;ze[Ye.WorksheetFuncId.EOMONTH]=xc.eomonth;ze[Ye.WorksheetFuncId.NETWORKDAYS]=xc.networkdays;ze[Ye.WorksheetFuncId.NETWORKDAYS_INTL]=xc.networkdays_intl;ze[Ye.WorksheetFuncId.YEARFRAC]=xc.yearFrac;ze[Ye.WorksheetFuncId.DELTA]=jTe.delta;ze[Ye.WorksheetFuncId.GESTEP]=jTe.gestep;ze[Ye.WorksheetFuncId.NA]=LO.na;ze[Ye.WorksheetFuncId.T]=LO.t_;ze[Ye.WorksheetFuncId.N]=LO.n_;ze[Ye.WorksheetFuncId.TYPE]=LO.type;ze[Ye.WorksheetFuncId.ERROR_TYPE]=LO.error_type;ze[Ye.WorksheetFuncId.INFO]=LO.info;ze[Ye.WorksheetFuncId.IF]=XP.if_;ze[Ye.WorksheetFuncId.IFS]=XP.ifs;ze[Ye.WorksheetFuncId.SWITCH]=XP.switch_;ze[Ye.WorksheetFuncId.TRUE]=XP.true_;ze[Ye.WorksheetFuncId.FALSE]=XP.false_;ze[Ye.WorksheetFuncId.NOT]=XP.not;ze[Ye.WorksheetFuncId.CHOOSE]=XP.choose;ze[Ye.WorksheetFuncId.INDEX]=Nw.index;ze[Ye.WorksheetFuncId.MATCH]=Nw.match;ze[Ye.WorksheetFuncId.LOOKUP]=Nw.lookup;ze[Ye.WorksheetFuncId.HLOOKUP]=Nw.hlookup;ze[Ye.WorksheetFuncId.VLOOKUP]=Nw.vlookup;ze[Ye.WorksheetFuncId.ABS]=uo.abs;ze[Ye.WorksheetFuncId.CEILING]=uo.ceiling;ze[Ye.WorksheetFuncId.ECMA_CEILING]=uo.ceiling;ze[Ye.WorksheetFuncId.DEGREES]=uo.degrees;ze[Ye.WorksheetFuncId.FLOOR]=uo.floor;ze[Ye.WorksheetFuncId.RADIANS]=uo.radians;ze[Ye.WorksheetFuncId.ROUND]=uo.round;ze[Ye.WorksheetFuncId.ROUNDUP]=uo.roundup;ze[Ye.WorksheetFuncId.ROUNDDOWN]=uo.rounddown;ze[Ye.WorksheetFuncId.EVEN]=uo.even;ze[Ye.WorksheetFuncId.SIGN]=uo.sign;ze[Ye.WorksheetFuncId.PI]=uo.pi;ze[Ye.WorksheetFuncId.SQRT]=uo.sqrt;ze[Ye.WorksheetFuncId.EXP]=uo.exp;ze[Ye.WorksheetFuncId.POWER]=uo.power;ze[Ye.WorksheetFuncId.LN]=uo.ln;ze[Ye.WorksheetFuncId.LOG10]=uo.log10;ze[Ye.WorksheetFuncId.LOG]=uo.log;ze[Ye.WorksheetFuncId.SIN]=uo.sin;ze[Ye.WorksheetFuncId.COS]=uo.cos;ze[Ye.WorksheetFuncId.TAN]=uo.tan;ze[Ye.WorksheetFuncId.ASIN]=uo.asin;ze[Ye.WorksheetFuncId.ACOS]=uo.acos;ze[Ye.WorksheetFuncId.ATAN]=uo.atan;ze[Ye.WorksheetFuncId.ATAN2]=uo.atan2;ze[Ye.WorksheetFuncId.FACT]=uo.fact;ze[Ye.WorksheetFuncId.SQRTPI]=uo.sqrtpi;ze[Ye.WorksheetFuncId.FACTDOUBLE]=uo.factdouble;ze[Ye.WorksheetFuncId.INT]=uo.int;ze[Ye.WorksheetFuncId.TRUNC]=uo.trunc;ze[Ye.WorksheetFuncId.ODD]=uo.odd;ze[Ye.WorksheetFuncId.MROUND]=uo.mround;ze[Ye.WorksheetFuncId.QUOTIENT]=uo.quotient;ze[Ye.WorksheetFuncId.FLOOR_MATH]=uo.floor_math;ze[Ye.WorksheetFuncId.FLOOR_PRECISE]=uo.floor_precise;ze[Ye.WorksheetFuncId.CEILING_MATH]=uo.ceiling_math;ze[Ye.WorksheetFuncId.CEILING_PRECISE]=uo.ceiling_precise;ze[Ye.WorksheetFuncId.ISO_CEILING]=uo.ceiling_precise;ze[Ye.WorksheetFuncId.TEXT]=BO.text;ze[Ye.WorksheetFuncId.FIXED]=BO.fixed;ze[Ye.WorksheetFuncId.DOLLAR]=BO.dollar;ze[Ye.WorksheetFuncId.VALUE]=BO.value;ze[Ye.WorksheetFuncId.DATEVALUE]=BO.datevalue;ze[Ye.WorksheetFuncId.TIMEVALUE]=BO.timevalue;ze[Ye.WorksheetFuncId.ISERROR]=w0.iserror;ze[Ye.WorksheetFuncId.ISERR]=w0.iserr;ze[Ye.WorksheetFuncId.ISBLANK]=w0.isblank;ze[Ye.WorksheetFuncId.ISLOGICAL]=w0.islogical;ze[Ye.WorksheetFuncId.ISNA]=w0.isna;ze[Ye.WorksheetFuncId.ISNONTEXT]=w0.isnontext;ze[Ye.WorksheetFuncId.ISTEXT]=w0.istext;ze[Ye.WorksheetFuncId.ISNUMBER]=w0.isnumber;ze[Ye.WorksheetFuncId.ISREF]=w0.isref;ze[Ye.WorksheetFuncId.ISEVEN]=w0.iseven;ze[Ye.WorksheetFuncId.ISODD]=w0.isodd;ze[Ye.WorksheetFuncId.ISFORMULA]=w0.isformula;ze[Ye.WorksheetFuncId.FORMULATEXT]=w0.formulatext;ze[Ye.WorksheetFuncId.ROWS]=J1.rows;ze[Ye.WorksheetFuncId.COLUMNS]=J1.columns;ze[Ye.WorksheetFuncId.AREAS]=J1.areas;ze[Ye.WorksheetFuncId.SHEETS]=J1.sheets;ze[Ye.WorksheetFuncId.ROW]=J1.row;ze[Ye.WorksheetFuncId.COLUMN]=J1.column;ze[Ye.WorksheetFuncId.SHEET]=J1.sheet;ze[Ye.WorksheetFuncId.OFFSET]=J1.offset;ze[Ye.WorksheetFuncId.TRANSPOSE]=J1.transpose;ze[Ye.WorksheetFuncId.SINGLE]=J1.single;ze[Ye.WorksheetFuncId.ADDRESS]=HTe.address;ze[Ye.WorksheetFuncId.INDIRECT]=HTe.indirect;ze[Ye.WorksheetFuncId.LEFT]=pd.left;ze[Ye.WorksheetFuncId.RIGHT]=pd.right;ze[Ye.WorksheetFuncId.MID]=pd.mid;ze[Ye.WorksheetFuncId.LEN]=pd.len;ze[Ye.WorksheetFuncId.CONCATENATE]=pd.concatenate;ze[Ye.WorksheetFuncId.EXACT]=pd.exact;ze[Ye.WorksheetFuncId.REPT]=pd.rept;ze[Ye.WorksheetFuncId.TRIM]=pd.trim;ze[Ye.WorksheetFuncId.CLEAN]=pd.clean;ze[Ye.WorksheetFuncId.CHAR]=pd.char;ze[Ye.WorksheetFuncId.UNICHAR]=pd.unichar;ze[Ye.WorksheetFuncId.CODE]=pd.code;ze[Ye.WorksheetFuncId.UNICODE]=pd.unicode;ze[Ye.WorksheetFuncId.LOWER]=pd.lower;ze[Ye.WorksheetFuncId.UPPER]=pd.upper;ze[Ye.WorksheetFuncId.PROPER]=pd.proper;ze[Ye.WorksheetFuncId.FIND]=pd.find;ze[Ye.WorksheetFuncId.REPLACE]=pd.replace;ze[Ye.WorksheetFuncId.SEARCH]=pd.search;ze[Ye.WorksheetFuncId.SUBSTITUTE]=pd.substitute;ze[Ye.WorksheetFuncId.RAND]=h9.rand;ze[Ye.WorksheetFuncId.RANDBETWEEN]=h9.randbetween;ze[Ye.WorksheetFuncId.NOW]=h9.now;ze[Ye.WorksheetFuncId.TODAY]=h9.today;ze[Ye.WorksheetFuncId.HYPERLINK]=LPr.hyperlink;ze[Ye.WorksheetFuncId.FIELDVALUE]=v9.fieldvalue;ze[Ye.WorksheetFuncId._FV]=v9.fieldvalue;var QTe=!1;function BPr(){QTe=!0,(0,ZC.isFeatureEnabled)(ZC.FeatureName.CalcRecordFunctions)&&(ze[Ye.WorksheetFuncId.RECORD]=v9.record),(0,ZC.isFeatureEnabled)(ZC.FeatureName.CalcNestedRecordFunction)&&(ze[Ye.WorksheetFuncId.NESTEDRECORD]=v9.record),(0,ZC.isFeatureEnabled)(ZC.FeatureName.CalcLambdaBasicFunctions)&&(ze[Ye.WorksheetFuncId.ARITY]=Kee.arity,ze[Ye.WorksheetFuncId.APPLY]=Kee.apply,ze[Ye.WorksheetFuncId.ISLAMBDA]=w0.islambda),(0,ZC.isFeatureEnabled)(ZC.FeatureName.CalcLambdaHelperFunctions)&&(ze[Ye.WorksheetFuncId.MAKEARRAY]=Kee.makearray,ze[Ye.WorksheetFuncId.ISOMITTED]=w0.isomitted),(0,ZC.getTypedFeatureGate)("Microsoft.Office.Excel.CalcTsFuncsFirstSlice")&&(ze[Ye.WorksheetFuncId.TAKE]=Ew.take,ze[Ye.WorksheetFuncId.DROP]=Ew.drop,ze[Ye.WorksheetFuncId.SEQUENCE]=Ew.sequence,ze[Ye.WorksheetFuncId.TEXTBEFORE]=Vee.textBefore,ze[Ye.WorksheetFuncId.TEXTAFTER]=Vee.textAfter,ze[Ye.WorksheetFuncId.TEXTSPLIT]=Vee.textSplit,ze[Ye.WorksheetFuncId.HSTACK]=Ew.hstack,ze[Ye.WorksheetFuncId.VSTACK]=Ew.vstack)}function qPr(e){return QTe||BPr(),ze[e]}S9.getWorksheetFunc=qPr});var zTe=Y(kf=>{"use strict";_();Object.defineProperty(kf,"__esModule",{value:!0});kf.maxRetriesForLoadingScript=kf.isCalcInit=kf.initCalcThread=kf.initCalcInThread=kf.initCalcCalled=kf.initCalc=kf.getCalcAbsUrlOrThrow=kf.getCalcAbsUrl=void 0;var iT=Cn();kf.getCalcAbsUrl=iT.config.getCalcAbsUrl;kf.getCalcAbsUrlOrThrow=iT.config.getCalcAbsUrlOrThrow;kf.initCalc=iT.config.initCalc;kf.initCalcCalled=iT.config.initCalcCalled;kf.initCalcInThread=iT.config.initCalcInThread;kf.initCalcThread=iT.config.initCalcThread;kf.isCalcInit=iT.config.isCalcInit;kf.maxRetriesForLoadingScript=iT.config.maxRetriesForLoadingScript});var YTe=Y(X1=>{"use strict";_();Object.defineProperty(X1,"__esModule",{value:!0});X1.randomElement=X1.randomShuffled=X1.randomIndex=X1.randomFloat=void 0;var y9=Cn();X1.randomFloat=y9.testUtil.randomFloat;X1.randomIndex=y9.testUtil.randomIndex;X1.randomShuffled=y9.testUtil.randomShuffled;X1.randomElement=y9.testUtil.randomElement});var JTe=Y(C9=>{"use strict";_();Object.defineProperty(C9,"__esModule",{value:!0});C9.createArrayLogger=void 0;var UPr=Cn();C9.createArrayLogger=UPr.arrayLogger.createArrayLogger});var mbe=Y(Pa=>{"use strict";_();Object.defineProperty(Pa,"__esModule",{value:!0});Pa.randomCellEvaluationTest=Pa.randomTestSheetContents=Pa.randomTestCellContents=Pa.randomTestFormula=Pa.runCellEvaluationTest=Pa.runMockCellEvaluationTest=Pa.makeRandomizedTimer=Pa.abstractEvalCells=Pa.sheet=Pa.document=Pa.makeDirtyCellContents=Pa.makeFailedCellContents=Pa.makeFinalCellContents=Pa.TestCellState=Pa.SpecialContents=Pa.locationFormula=Pa.locationValue=Pa.parsed=Pa.compiled=Pa.makeTestContext=void 0;var Ow=br(),Lv=zo(),GPr=Nv(),KPr=H_e(),XTe=c$(),Hd=hg(),abe=zs(),jee=RG(),VPr=tG(),ZTe=Q_e(),WPr=Wee(),md=Ic(),jd=ao(),jPr=l$(),ibe=E$(),$Te=$3(),HPr=zTe(),xv=mO(),qO=_o(),Aw=Sm(),QPr=P$(),zPr=cd(),obe=T$(),YPr=D1(),JPr=MG(),Wa=Bd(),Bv=YTe(),XPr=b$(),ZPr=JTe(),$Pr=NG(),eEr=kG();function rEr(e,r,n){var a=(0,ZPr.createArrayLogger)();(0,HPr.initCalc)(a,e??KPr.featureEnabledDummyCallback);var o=(0,$Te.calcConfig)(r??(0,$Te.getEnglishLocaleInfo)(),void 0,n),u={config:o},t={config:o},d={config:o},s=(0,ibe.createParser)(u),c=(0,obe.createAnalyzer)(d),l=(0,VPr.createCompiler)(t);return{logger:a,config:o,compileGlobals:t,parser:s,analyzer:c,compiler:l}}Pa.makeTestContext=rEr;function Hee(e,r,n,a,o){o===void 0&&(o=!1);var u=r.kind===md.LexicalKind.NameManager?(0,XTe.analyzeLocalsName)((0,md.sheetGridCell)(Pa.sheet,n)):(0,XTe.analyzeLocalsGrid)(r.kind,(0,md.sheetGridCell)(Pa.sheet,n)),t=e.analyzer.checkFormula(u,a);if((0,Wa.isSuccess)(t)&&(0,jd.isWellFormed)(t.value)){var d=r.kind===md.LexicalKind.NameManager?(0,Hd.compileLocalsName)(n):(0,Hd.compileLocalsGrid)(r.kind,n),s=e.compiler.compileFormula(o?Ow.__assign(Ow.__assign({},d),{emitStepInfo:o}):d,t.value);if(s.kind===Wa.ResultKind.Success)return s.value;throw new Error("unexpected result ".concat(JSON.stringify(s)))}throw new Error("not well formed formula ".concat(JSON.stringify(t)))}Pa.compiled=Hee;function nEr(e,r,n,a,o,u,t){a===void 0&&(a=xv.RefStyle.A1),o===void 0&&(o=r.kind!==md.LexicalKind.NameManager?(0,jd.gridRangeAnchor)(r.range.range):(0,Lv.assertFalse)("must pass origin for LexicalSourceName")),u===void 0&&(u=!1);var d=e.parser.parseFormula((0,jPr.parseLocals)(r.kind,o,{refStyle:a},t),n);if(d.kind!==Wa.ResultKind.Success)throw new Error("unexpected result ".concat(JSON.stringify(d)));return Hee(e,r,o,d.value,u)}Pa.parsed=nEr;function tEr(e,r){return{cell:e,oper:r}}Pa.locationValue=tEr;function aEr(e,r){var n=(0,xv.formula)(r,[],[],1);return{source:e,formula:n}}Pa.locationFormula=aEr;var Zs;(function(e){e.ValueMocked="ValueMocked",e.ValueUnavailable="ValueUnavailable",e.FormulaUnavailable="FormulaUnavailable",e.EvalNotImplemented="EvalNotImplemented",e.EvalJavaScriptError="EvalJavaScriptError"})(Zs=Pa.SpecialContents||(Pa.SpecialContents={}));var vc;(function(e){e.Dirty="Dirty",e.Final="Final",e.Failed="Failed"})(vc=Pa.TestCellState||(Pa.TestCellState={}));var iEr=function(){var e=(0,abe.bottomEvalPrecedents)();return e.bound=qO.PrecsBound.Exact,e}();function Qee(e,r,n){return{oper:e,reason:r,state:n,precedents:iEr}}function _9(e){return Qee(e,void 0,vc.Final)}Pa.makeFinalCellContents=_9;function oEr(e,r){return Qee(e,r,vc.Failed)}Pa.makeFailedCellContents=oEr;function ube(e){return Qee(e,void 0,vc.Dirty)}Pa.makeDirtyCellContents=ube;function oT(e){var r=e.row,n=e.col;return"R".concat(r+1,"C").concat(n+1)}function sbe(e,r){return typeof r=="number"?(0,xv.literalNode)(e.config.mathpack.fromNumber(r)):r===Zs.EvalNotImplemented?(0,xv.appNode)((0,xv.wsfNode)(Aw.WorksheetFuncId.RAND,"RAND"),[]):r===Zs.EvalJavaScriptError?(0,xv.appNode)((0,xv.wsfNode)(Aw.WorksheetFuncId.NOW,"NOW"),[]):Array.isArray(r)?(0,xv.appNode)((0,xv.wsfNode)(Aw.WorksheetFuncId.SUM,"SUM"),r.map(sbe.bind(void 0,e))):(0,xv.cellRefNode)((0,xv.cellRefSingle)((0,ZTe.absPos)(r.row),(0,ZTe.absPos)(r.col)))}Pa.document={path:void 0,name:"Book1"};Pa.sheet=(0,md.sheetIndex)(Pa.document,0);function uEr(e,r){var n={},a={};function o(F){var w=n[F];return w==null&&(w=_9(qO.blankOper),n[F]=w),w}for(var u in r){var t=r[u];if(t!=null){var d=t[0],s=t[1];if(typeof s=="number"){var c=o(u);c.oper=e.config.mathpack.fromNumber(s)}else if(Array.isArray(s)||s===Zs.EvalNotImplemented||s===Zs.EvalJavaScriptError){var c=o(u);c.state=vc.Dirty;var l=(0,xv.formula)(sbe(e,s),[],[],2);a[u]=Hee(e,(0,md.lexicalSourceCell)((0,md.sheetGridCell)(Pa.sheet,d)),d,l)}else if(s===Zs.ValueMocked||s===Zs.FormulaUnavailable){var c=o(u);c.state=vc.Dirty}else s===Zs.ValueUnavailable||(0,Lv.assertNever)("calc.runtime.makeCellEvaluationTest, tc",s)}}function f(F,w){return(0,abe.throwEvaluationError)((0,jd.notImplemented)(["RAND"]))}function p(F,w){throw new Error("JavaScript error")}function m(F){if(F===Aw.WorksheetFuncId.SUM){var w=(0,WPr.getWorksheetFunc)(F);return w!=null?(0,Wa.success)(w):(0,Wa.failure)((0,jd.notImplemented)(["SUM"]))}return(0,Wa.success)(F===Aw.WorksheetFuncId.RAND?f:p)}function v(F){var w=oT(F.range),B=r[w];if(B!=null&&B[1]===Zs.ValueUnavailable)return(0,Wa.failure)((0,jd.unavailable)(["value at ".concat(w)]));var k=n[w];return k==null?(0,Wa.success)((0,Hd.finalValue)(qO.blankOper)):k.state===vc.Final?(0,Wa.success)((0,Hd.finalValue)(k.oper)):k.state===vc.Failed?(0,Wa.failure)((0,Hd.previousFailure)(F)):(0,Wa.success)((0,Hd.pendingValue)(F))}function h(F){var w=F.sheet,B=F.range,k=B.row,x=B.col,G=B.rows,H=B.cols,L=void 0,D=(0,GPr.jaggedArray)(G,H,function(U,V){var ne=I.getCellValue((0,md.sheetGridCell)(w,(0,md.gridCell)(U+k,V+x)));return ne.kind===Wa.ResultKind.Failure?(L==null&&(L=ne),(0,Hd.finalValue)(qO.blankOper)):ne.value});return L??(0,Wa.success)(D)}function S(F){var w=oT(F.range),B=r[w];if(B!=null&&B[1]===Zs.FormulaUnavailable)return(0,Wa.failure)((0,jd.unavailable)(["formula at ".concat(w)]));var k=a[w];return k!=null?(0,Wa.success)((0,Hd.cellFormula)((0,md.lexicalSourceCell)(F),k)):(0,Wa.success)(void 0)}function y(F,w){var B=oT(F.range),k=n[B];if(k==null||k.state!==vc.Dirty){var x="expected dirty cell at ".concat(JSON.stringify(F)," but have ").concat(JSON.stringify(k),"; given ").concat(JSON.stringify(w));(0,Lv.assertFalse)("calc.runtime.makeCellEvaluationTest.setCellValue: ".concat(x))}k.oper=w,k.state=vc.Final}function C(F,w){if(!(0,jd.isSheetGridCell)(F)){var B="expected cell; given range ".concat(JSON.stringify(F));return(0,Lv.assertFalse)("calc.runtime.makeCellEvaluationTest.setCellFailure: ".concat(B))}var k=oT(F.range),x=n[k];if(x==null||x.state!==vc.Dirty){var B="expected dirty cell at ".concat(JSON.stringify(F)," but have ").concat(JSON.stringify(x),"; given ").concat(JSON.stringify(w));(0,Lv.assertFalse)("calc.runtime.makeCellEvaluationTest.setCellFailure: ".concat(B))}x.reason=w.kind,x.state=vc.Failed}function E(F){return(0,Wa.success)((0,md.sheetGridRange)(F,(0,md.gridRange)(0,0,md.sheetRows,md.sheetCols)))}var I={config:e.config,getDocumentLoc:function(w,B){return(0,Wa.success)(Pa.document)},getSheetIndex:function(w,B){return(0,Wa.success)(Pa.sheet.index)},getSheetName:function(w,B){return(0,Wa.success)("Sheet1")},getSheetRangeIndexes:function(w){return(0,Wa.success)((0,md.sheetRangeIndexes)([Pa.sheet.index],0))},getNameLoc:function(w,B){return(0,Wa.failure)((0,jd.unavailable)(["name at ".concat(JSON.stringify((0,md.nameLoc)(w,B)))]))},getUserDefinedFuncLoc:function(w,B){return(0,Wa.success)([])},getCellValue:v,getCellValues:h,getWorksheetFunc:m,getUserDefinedFunc:function(){return(0,Wa.failure)((0,jd.unavailable)(["getUserDefinedFunc"]))},getNameFormula:function(w){return(0,Wa.failure)((0,jd.unavailable)(["name at ".concat(JSON.stringify(w))]))},getCellFormula:S,interruptToken:[Hd.Interrupt.Continue],tryGetHiddenRows:function(w,B,k){return(0,Wa.success)([])},tryGetHiddenCols:function(w,B,k){return(0,Wa.success)([])},isInFilterMode:function(w){return(0,Wa.success)(!1)},getKnownFormat:function(){return(0,Wa.failure)((0,jd.notImplemented)(["getKnownFormat"]))},getIformat:function(){return(0,Wa.failure)((0,jd.notImplemented)(["getIformat"]))},getFormatString:function(){return(0,Wa.failure)((0,jd.notImplemented)(["getFormatString"]))},getRandom:function(){return(0,Wa.failure)((0,jd.notImplemented)(["getRandom"]))},getTime:function(){return(0,Wa.failure)((0,jd.notImplemented)(["getTime"]))},schedulerConfig:{},limits:{},setCellValue:y,setCellValues:function(w,B){throw new Error("unexpected call to setCellValues")},setCellFailure:C,getUsedRange:E,getContainingTable:function(){return(0,Wa.failure)((0,jd.notImplemented)(["getContainingTable"]))},getIntersectingTables:function(){return(0,Wa.failure)((0,jd.notImplemented)(["getIntersectingTables"]))},getStructRefColumn:function(){return(0,Wa.failure)((0,jd.notImplemented)(["getStructRefColumn"]))},getStructRefSpecialRef:function(){return(0,Wa.failure)((0,jd.notImplemented)(["getStructRefSpecialRef"]))}};return[Pa.sheet,n,I]}function lbe(e,r,n){var a={};for(var o in r){var u=r[o];if(u!=null){var t=u[1];if(typeof t=="number"){var d=_9(e.config.mathpack.fromNumber(t));a[o]=d}else if(Array.isArray(t)||t===Zs.FormulaUnavailable||t===Zs.EvalNotImplemented||t===Zs.EvalJavaScriptError){var d=ube(qO.blankOper);a[o]=d}else t===Zs.ValueUnavailable||t===Zs.ValueMocked||(0,Lv.assertNever)("calc.runtime.abstractEvalCells, tc",t)}}function s(h,S){if(h.state!==vc.Dirty){var y="expected dirty cellContent; given ".concat(JSON.stringify(h));(0,Lv.assertFalse)("calc.runtime.makeCellEvaluationTest.setContentFailed: ".concat(y))}h.reason=S,h.state=vc.Failed}function c(h,S){if(h.state!==vc.Dirty){var y="expected dirty cellContent; given ".concat(JSON.stringify(h));(0,Lv.assertFalse)("calc.runtime.makeCellEvaluationTest.setContentFinal: ".concat(y))}h.oper=S,h.state=vc.Final}var l={},f=[];function p(h,S){if(typeof S=="number")return(0,Wa.success)(e.config.mathpack.fromNumber(S));if(S===Zs.EvalNotImplemented)return(0,Wa.failure)({kind:Hd.ReasonKind.NotImplemented});if(S===Zs.EvalJavaScriptError)return(0,Wa.failure)({kind:Hd.ReasonKind.JavaScriptError});for(var y=[],C=0;C<S.length;C+=1){var E=S[C];if(typeof E!="object"||Array.isArray(E)){var I=p(h,E);if(!(0,Wa.isSuccess)(I))return I;y.push(e.config.mathpack.toNumber(I.value));continue}y.push(E)}for(var F=function(D){var U=y[D];if(typeof U=="number")return"continue";var V=oT(U),ne=r[V];if(ne!=null&&ne[1]===Zs.ValueUnavailable)return{value:(0,Wa.failure)({kind:Hd.ReasonKind.Unavailable})};var J=a[V];if(J!=null&&J.state===vc.Failed)return{value:(0,Wa.failure)({kind:Hd.ReasonKind.PreviousFailure})};var $=l[V];if($!==void 0){for(var Z=f.findIndex(function(ie){return ie===$});Z!==-1&&Z<f.length;Z+=1)f[Z].cycle=!0;return{value:(0,Wa.failure)({kind:Hd.ReasonKind.CellCycle})}}},C=0;C<y.length;C+=1){var w=F(C);if(typeof w=="object")return w.value}for(var B=0,C=0;C<y.length;C+=1){var k=y[C];if(typeof k=="number"){B+=k;continue}var x=m(k);if(x!==void 0)return(0,Wa.failure)({kind:x});var G=oT(k),H=a[G];if(H!=null){if(H.state===vc.Failed)return(0,Wa.failure)({kind:h.cycle?Hd.ReasonKind.CellCycle:Hd.ReasonKind.PreviousFailure});(0,Lv.assertTrue)("calc.runtime.testUtil: Final after abstractEvalCell",H.state===vc.Final),B+=e.config.mathpack.toNumber(H.oper)}}return(0,Wa.success)(e.config.mathpack.fromNumber(B))}function m(h){var S=oT(h),y=r[S];if(y!=null){var C=y[1];if(!(typeof C=="number"||C===Zs.ValueUnavailable)){var E=a[S];if(E==null&&(E=_9(qO.blankOper),a[S]=E),E.state===vc.Failed){(0,Lv.assertTrue)("calc.runtime.makeCellEvaluationTest",E.reason!=null);return}if(E.state!==vc.Final){var I={cycle:!1};(0,Lv.assertTrue)("calc.runtime.makeCellEvaluationTest.abstractEvalCell: undetected cycle",l[S]==null),l[S]=I,f.push(I);try{switch(C){case Zs.ValueMocked:return(0,Lv.assertFalse)("calc.runtime.makeCellEvaluationTest.abstractEvalCell: unexpected ValueMocked");case Zs.FormulaUnavailable:throw new Error("calc.runtime.makeCellEvaluationTest.abstractEvalCell: dummy Failure from getCellFormula")}var F=p(I,C);if((0,Wa.isSuccess)(F)){c(E,F.value);return}s(E,F.reason.kind);return}catch(w){return Hd.ReasonKind.JavaScriptError}finally{delete l[S],f.pop()}}}}}var v=n.map(function(h){try{return m(h)}catch(S){return Hd.ReasonKind.JavaScriptError}});return{evalResults:v,sheetState:a}}Pa.abstractEvalCells=lbe;function ebe(e){return typeof e=="string"?Hd.ReasonKind.PreviousFailure:e}function rbe(e){return e==null?e:Ow.__assign(Ow.__assign({},e),{reason:void 0})}function nbe(e,r){for(var n in e){var a=e[n];a!=null&&a.state===vc.Dirty&&(delete e[n],delete r[n])}}function sEr(e,r){nbe(e,r),nbe(r,e)}function tbe(e,r){var n={};for(var a in e)n[a]=r(e[a]);return n}function cbe(e){for(var r=[],n=0;n<e;n+=1)r.push(n);return r}function lEr(e){return e===void 0&&(e=.5),{doTimeout:function(n){var a=(0,Bv.randomFloat)();return a>e}}}Pa.makeRandomizedTimer=lEr;function cEr(e,r){return r==null?r:typeof r.row=="number"&&typeof r.col=="number"&&r.rows===1&&r.cols===1?"gridCell(".concat(r.row,", ").concat(r.col,")"):r.kind===128&&Object.getOwnPropertyNames(r).length===1?"blankOper":r}function dbe(e,r,n,a,o,u,t,d){d===void 0&&(d={});var s=uEr(e,a),c=s[0],l=s[1],f=s[2];for(var p in d){var m=p;f[m]=d[m](f[m])}for(var v=[a,o,u,t],h=o.map(function(k){return(0,md.sheetGridCell)(c,k)}),S=t??cbe(o.length),y=[],C=0;C<S.length;C+=1)y[S[C]]=C;for(var E={globals:f,resolver:(0,QPr.createResolver)(f),numberFormatter:(0,JPr.createNumberFormatter)(f),parser:(0,ibe.createParser)(f),printer:(0,XPr.createPrinter)(f),analyzer:(0,obe.createAnalyzer)(f),createCellEvaluationMachine:r.createCellEvaluationMachine.bind(r),createFormulaEvaluationMachine:r.createFormulaEvaluationMachine.bind(r),createCallTermEvaluationMachine:r.createCallTermEvaluationMachine.bind(r)},I={globals:f,timer:n,machineContext:E},F=[],C=0;C<S.length;C+=1){var w=h[S[C]];F.push(new zPr.VoidMachine(E.createCellEvaluationMachine(E,void 0,YPr.emptyVisitedCells,w)))}var B=new jee.EvaluationRuntime(I,F);return B.evaluateAsync((0,jee.createSchedule)(I.globals.schedulerConfig)).then(function(k){return y.map(function(x){var G=k[x];return G.kind===Wa.ResultKind.Success?G.value:G.reason.kind})}).catch(function(k){return k.reason!=null?k.reason.stack:k.stack}).then(function(k){if(Array.isArray(k)){var x=k,G=l,H=u.evalResults,L=u.sheetState;t!=null&&(x=x.map(ebe),H=H.map(ebe),G=tbe(G,rbe),L=tbe(L,rbe),sEr(G,L));try{expect([v,x,G]).toEqual([v,H,L])}catch(D){throw console.warn("runMockCellEvaluationTest: test failure:",JSON.stringify({testData:v,testResults:x,testState:G},cEr,2)),D}}else expect([v,k]).toEqual([v,void 0])})}Pa.runMockCellEvaluationTest=dbe;function dEr(e,r,n,a,o,u){u===void 0&&(u={});var t={createCellEvaluationMachine:$Pr.createCellEvaluationMachine,createFormulaEvaluationMachine:eEr.createFormulaEvaluationMachine,createCallTermEvaluationMachine:function(c){}},d=(0,jee.runtimeTimer)();return dbe(e,t,d,r,n,a,o,u)}Pa.runCellEvaluationTest=dEr;var fEr=3;function zee(e,r,n){n===void 0&&(n=0);var a=(0,Bv.randomFloat)()*(n<fEr?1:.625);return a<.05?Zs.EvalJavaScriptError:a<.1?Zs.EvalNotImplemented:a<.55?1:Ow.__spreadArray([],new Array((0,Bv.randomIndex)(3)+1),!0).map(function(){return(0,Bv.randomFloat)()<.5?(0,md.gridCell)((0,Bv.randomIndex)(e),(0,Bv.randomIndex)(r)):zee(e,r,n+1)})}Pa.randomTestFormula=zee;function fbe(e,r){for(;;){var n=(0,Bv.randomFloat)();return n<.1?Zs.ValueUnavailable:n<.2?Zs.FormulaUnavailable:zee(e,r)}}Pa.randomTestCellContents=fbe;function pbe(e,r){for(var n={},a=0;a<e;a+=1)for(var o=0;o<r;o+=1)if((0,Bv.randomFloat)()<.5){var u=fbe(e,r),t=(0,md.gridCell)(a,o);n[oT(t)]=[t,u]}return n}Pa.randomTestSheetContents=pbe;function pEr(e,r,n){var a=pbe(r,n),o=[];for(var u in a){var t=a[u];t!=null&&(0,Bv.randomFloat)()<.75&&o.push(t[0])}o=(0,Bv.randomShuffled)(o);var d=lbe(e,a,o),s=(0,Bv.randomFloat)()<.5?(0,Bv.randomShuffled)(cbe(o.length)):void 0;return[a,o,d,s]}Pa.randomCellEvaluationTest=pEr});var Sbe=Y(R9=>{"use strict";_();Object.defineProperty(R9,"__esModule",{value:!0});R9.FuncContextMock=void 0;var mEr=MG(),gbe=zs(),vbe=cO(),hbe=Bd(),gEr=function(){function e(r){this.config=r,this.formatter=(0,mEr.createNumberFormatter)({config:this.config}),this.mathpack=this.config.mathpack,this.datepack=this.config.datepack}return Object.defineProperty(e.prototype,"calcingArray",{get:function(){throw new Error("Method not implemented.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originGridCell",{get:function(){throw new Error("Method not implemented.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originSheet",{get:function(){throw new Error("Method not implemented.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reflectionGridCell",{get:function(){throw new Error("Method not implemented.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reflectionSheet",{get:function(){throw new Error("Method not implemented.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"followHyperlinks",{get:function(){throw new Error("Method not implemented.")},enumerable:!1,configurable:!0}),e.prototype.applyFunction=function(r,n){throw new Error("Method not implemented.")},e.prototype.applyLambda=function(r,n){throw new Error("Method not implemented.")},e.prototype.handleEvaluationError=function(r){throw new Error("Method not implemented.")},e.prototype.coerceOper=function(r,n){throw new Error("Method not implemented.")},e.prototype.parseGeneral=function(r,n){var a,o=this.formatter.parseGeneral(r,!1,n,vbe.GetTimeKind.NonVolatile);return(0,hbe.isSuccess)(o)||(0,gbe.throwEvaluationError)(o.reason),(a=o.value)===null||a===void 0?void 0:a.value},e.prototype.parseDate=function(r){var n,a=this.formatter.parseDate(r,vbe.GetTimeKind.NonVolatile);return(0,hbe.isSuccess)(a)||(0,gbe.throwEvaluationError)(a.reason),(n=a.value)===null||n===void 0?void 0:n.value},e.prototype.getCellFormula=function(r){throw new Error("Method not implemented.")},e.prototype.getSheetIndex=function(r,n){throw new Error("Method not implemented.")},e.prototype.getSheetRangePosition=function(r){throw new Error("Method not implemented.")},e.prototype.getSheetRangeIndexes=function(r){throw new Error("Method not implemented.")},e.prototype.getNameFormula=function(r,n){throw new Error("Method not implemented.")},e.prototype.getCellRef=function(r,n,a,o){throw new Error("Method not implemented.")},e.prototype.getStructRef=function(r,n,a){throw new Error("Method not implemented.")},e.prototype.dereferenceAllOpers=function(){throw new Error("Method not implemented.")},e.prototype.dereferenceAllOpersAndFormulae=function(){throw new Error("Method not implemented.")},e.prototype.dereferenceOper=function(r,n){throw new Error("Method not implemented.")},e.prototype.dereferenceOpers=function(r,n){throw new Error("Method not implemented.")},e.prototype.isInFilterMode=function(){throw new Error("Method not implemented.")},e.prototype.printFormula=function(r,n){throw new Error("Method not implemented.")},e.prototype.getBinaryOperator=function(r){throw new Error("Method not implemented.")},e.prototype.getUnaryOperator=function(r){throw new Error("Method not implemented.")},e.prototype.parseFormula=function(r,n,a,o){throw new Error("Method not implemented.")},e.prototype.applyFormat=function(r,n,a){throw new Error("Method not implemented.")},e.prototype.getRandom=function(){throw new Error("Method not implemented.")},e.prototype.getTime=function(r){throw new Error("Method not implemented.")},e}();R9.FuncContextMock=gEr});var T9=Y(uT=>{"use strict";_();Object.defineProperty(uT,"__esModule",{value:!0});uT.getAbsoluteIndexNoClamp=uT.getAbsoluteIndex=uT.ni=void 0;var vEr=ao(),hEr=zs(),SEr=function(r){throw new hEr.EvaluationError((0,vEr.notImplemented)([r]))};uT.ni=SEr;function yEr(e,r){return r>=0?r:Math.max(e+r,0)}uT.getAbsoluteIndex=yEr;function CEr(e,r){return r>=0?r:e+r}uT.getAbsoluteIndexNoClamp=CEr});var bbe=Y(gd=>{"use strict";_();Object.defineProperty(gd,"__esModule",{value:!0});gd.hstack=gd.vstack=gd.filter=gd.map=gd.drop=gd.take=gd.rangeOrArrayToVal=gd.choosecols=gd.sequence=void 0;var _be=Bl(),uu=ao(),_Er=_o(),dp=_o(),cS=cd(),REr=jC(),qv=T9(),kw=_f(),TEr=zo(),Yee=Ic(),bEr=Mv(),PEr=function(r,n){var a=n[0],o=n[1],u=n[2],t=n[3],d=r.mathpack,s=(0,uu.isMissingOper)(a)?1:d.sfix(a),c=o===void 0||(0,uu.isMissingOper)(o)?1:d.sfix(o);if(s<0||s>Yee.sheetRows||c<0||c>Yee.sheetRows)return dp.valueErrorOper;if((0,bEr.validateArraySize)(s,c),s===0||c===0)return dp.calcErrorOper;for(var l=u===void 0||(0,uu.isMissingOper)(u)?d.fromNumber(1):u,f=t===void 0||(0,uu.isMissingOper)(t)?d.fromNumber(1):t,p=l,m=[],v=0;v<s;v++){for(var h=[],S=0;S<c;S++)if(h.push(p),!(0,uu.isErrorOper)(p)){var y=d.add(p,f);p=(0,uu.isErrorOper)(y)?y:d.checkAlmostCancellation(f,y)}m.push(h)}return(0,dp.arrayOper)(s,c,m)};gd.sequence=PEr;function EEr(e,r){var n=[];return r.opers.forEach(function(a){a.forEach(function(o){(0,uu.isNumberOper)(o)&&n.push(e.toNumber(o))})}),n}var NEr=function(r,n){var a=n[0],o=n.slice(1),u=r.mathpack,t=(0,cS.refToVal)(r,a,!1);if(!(0,uu.isArrayOper)(t))return t;var d=t.opers.map(function(s){var c=s.length,l=[];return o.forEach(function(f){(0,uu.isNumberOper)(f)?l.push(s[(0,qv.getAbsoluteIndex)(c,u.toNumber(f))]):EEr(u,f).forEach(function(p){l.push(s[(0,qv.getAbsoluteIndex)(c,p)])})}),l});return d.length===0||d[0].length===0?dp.calcErrorOper:(0,dp.arrayOper)(d.length,d[0].length,d)};gd.choosecols=NEr;var Rbe=function(){function e(r){this.oper=r;var n=r.ranges[0],a=n.rows,o=n.cols;this.rows=a,this.cols=o}return e.prototype.slice=function(r,n,a,o){var u=this.oper.ranges[0],t=u.row,d=u.col;return(0,_Er.range3DOper)(this.oper.sheets,(0,Yee.gridRange)(t+r,d+a,n,o))},e}(),Tbe=function(){function e(r){this.oper=r,this.rows=r.opers.length,this.cols=r.opers[0].length}return e.prototype.slice=function(r,n,a,o){return(0,dp.arrayOper)(n,o,this.oper.opers.slice(r,r+n).map(function(u){return u.slice(a,a+o)}))},e}();function Jee(e){return(0,uu.isRangeOper)(e)?e.ranges.length>1?dp.valueErrorOper:((0,TEr.assertTrue)("calc.funcs.takeDrop: not 3D ref",(0,uu.isSheetIndex)(e.sheets)),e):e}gd.rangeOrArrayToVal=Jee;function ybe(e,r){if((0,kw.fastAbs)(e)<r){var n=(0,kw.fastAbs)(e);return e<0?{start:r-n,count:n}:{start:0,count:n}}return{start:0,count:r}}function Cbe(e,r){if((0,kw.fastAbs)(e)<r){var n=r-(0,kw.fastAbs)(e);return e<0?{start:0,count:n}:{start:e,count:n}}return{start:0,count:0}}var AEr=function(r,n){var a=n[0],o=n[1],u=n[2],t=r.mathpack,d=Jee(a);if(!(0,uu.isArrayOper)(d)&&!(0,uu.isRangeOper)(d))return d;var s=(0,uu.isRangeOper)(d)?new Rbe(d):new Tbe(d),c=(0,uu.isMissingOper)(o)?s.rows:t.lfix(o),l=u===void 0||(0,uu.isMissingOper)(u)?s.cols:t.lfix(u),f=ybe(c,s.rows),p=f.start,m=f.count,v=ybe(l,s.cols),h=v.start,S=v.count;return m===0||S===0?dp.calcErrorOper:s.slice(p,m,h,S)};gd.take=AEr;var OEr=function(r,n){var a=n[0],o=n[1],u=n[2],t=r.mathpack,d=Jee(a);if(!(0,uu.isArrayOper)(d)&&!(0,uu.isRangeOper)(d))return d;var s=(0,uu.isRangeOper)(d)?new Rbe(d):new Tbe(d),c=(0,uu.isMissingOper)(o)?0:t.lfix(o),l=u===void 0||(0,uu.isMissingOper)(u)?0:t.lfix(u),f=Cbe(c,s.rows),p=f.start,m=f.count,v=Cbe(l,s.cols),h=v.start,S=v.count;return m===0||S===0?dp.calcErrorOper:s.slice(p,m,h,S)};gd.drop=OEr;var kEr=function(r,n){var a=(0,cS.refToVal)(r,n[n.length-1],!0),o=n.slice(0,n.length-1).map(function(s){return(0,cS.refToVal)(r,s,!1)});if(!o.every(uu.isArrayOper))return(0,qv.ni)("MAP: Non array input");if(!(a instanceof REr.LambdaOper)||o.length===0)return(0,qv.ni)("MAP: No lambda or array");var u=o[0],t=u.rows,d=u.cols;return o.every(function(s){return s.rows===t&&s.cols===d})?(0,cS.machineCall)(new cS.ArrayMachine(r,t,d,function(s,c){return(0,cS.machineCall)(new cS.ThenMachine(r,function(){return r.applyLambda(a,o.map(function(l){return l.opers[s][c]}))},function(l){return(0,uu.isRangeOper)(l)?(0,qv.ni)("MAP: nested range"):(0,uu.isArrayOper)(l)?(0,qv.ni)("MAP: nested array"):l}))})):(0,qv.ni)("MAP: Bad dimensions")};gd.map=kEr;function FEr(e,r,n,a){for(var o=[],u=0;u<n.length;u++){var t=n[u],d=e.coerceOper(t,_be.OperKind.Boolean);if(!(0,uu.isBooleanOper)(d))return t;d.value&&o.push(r[u])}return o.length===0?a:(0,dp.arrayOper)(o.length,o[0].length,o)}function IEr(e,r,n,a){for(var o=[],u=0,t=0;t<n.length;t++){var d=n[t],s=e.coerceOper(d,_be.OperKind.Boolean);if(!(0,uu.isBooleanOper)(s))return d;var c=s.value;c&&(o.push(c),u++)}return u===0?a:(0,dp.arrayOper)(r.length,u,r.map(function(l){return l.filter(function(f,p){var m;return(m=o[p])!==null&&m!==void 0?m:!0})}))}var MEr=function(r,n){var a=n[0],o=n[1],u=n[2],t=(0,cS.refToVal)(r,a,!1),d=(0,cS.refToVal)(r,o,!1),s=u===void 0||(0,uu.isMissingOper)(u)?dp.calcErrorOper:u;return!(0,uu.isArrayOper)(t)||!(0,uu.isArrayOper)(d)?(0,qv.ni)("FILTER: non-array input"):d.rows===1&&d.cols===t.cols?IEr(r,t.opers,d.opers[0],s):d.cols===1&&d.cols===t.cols?FEr(r,t.opers,d.opers.map(function(c){return c[0]}),s):dp.valueErrorOper};gd.filter=MEr;var wEr=function(r,n){var a=n.map(function(h){return(0,cS.refToVal)(r,h,!1)});if(!a.every(uu.isArrayOper))return(0,qv.ni)("VSTACK: non array input");for(var o=0,u=0,t=a;u<t.length;u++){var d=t[u];d.cols>o&&(o=d.cols)}if(o<1)return(0,qv.ni)("VSTACK: Empty array");for(var s=[],c=0,l=a;c<l.length;c++)for(var d=l[c],f=0,p=d.opers;f<p.length;f++){for(var m=p[f],v=m.slice();v.length<o;)v.push(dp.naErrorOper);s.push(v)}return(0,dp.arrayOper)(s.length,o,s)};gd.vstack=wEr;var DEr=function(r,n){var a,o,u=n.map(function(m){return(0,cS.refToVal)(r,m,!1)});if(!u.every(uu.isArrayOper))return(0,qv.ni)("HSTACK: non array input");for(var t=0,d=0,s=u;d<s.length;d++){var c=s[d];c.rows>t&&(t=c.rows)}if(t<1)return(0,qv.ni)("HSTACK: Empty array");for(var l=[],f=function(v){var h=[];u.forEach(function(S){return(0,kw.safePush)(h,v<S.rows?S.opers[v]:Array(S.cols).fill(dp.naErrorOper))}),l.push(h)},p=0;p<t;p++)f(p);return(0,dp.arrayOper)(t,(o=(a=l[0])===null||a===void 0?void 0:a.length)!==null&&o!==void 0?o:0,l)};gd.hstack=DEr});var Nbe=Y(UO=>{"use strict";_();Object.defineProperty(UO,"__esModule",{value:!0});UO.xlookup=UO.xmatch=void 0;var Pbe=Sm(),Fw=ao(),Ebe=_o(),xEr=cd(),LEr=u9(),Iw=T9(),BEr=function(r,n){var a=n[0],o=n[1],u=n[2],t=n[3];if(u!==void 0&&!(0,Fw.isMissingOper)(u)||t!==void 0&&!(0,Fw.isMissingOper)(t))return(0,Iw.ni)("XMATCH: unsupported optional args");if((0,Fw.isRichOper)(a))return(0,Iw.ni)("XMATCH: unsupported rich lookup");var d=(0,xEr.refToVal)(r,o,!1),s=(0,LEr.makeLookupComparer)(r,a);if(!(0,Fw.isArrayOper)(d)){if((0,Fw.isRangeOper)(d))return(0,Iw.ni)("XMATCH: range oper");var c=s(d);return c.sgnT===Pbe.OperatorId.Eq?r.mathpack.fromNumber(1):Ebe.naErrorOper}var l;if(d.rows===1)l=d.opers[0];else if(d.cols===1)l=d.opers.map(function(p){return p[0]});else return(0,Iw.ni)("XMATCH: non-vector");for(var f=0;f<l.length;f++)if(s(l[f]).sgnT===Pbe.OperatorId.Eq)return r.mathpack.fromNumber(f+1);return Ebe.naErrorOper};UO.xmatch=BEr;var qEr=function(r,n){return(0,Iw.ni)("XLOOKUP: Not implemented")};UO.xlookup=qEr});var Obe=Y(sT=>{"use strict";_();Object.defineProperty(sT,"__esModule",{value:!0});sT.textAfter=sT.textBefore=sT.textSplit=void 0;var UEr=zo(),bg=ao(),Uv=_o(),GO=T9();function Xee(e){var r=[];if((0,bg.isArrayOper)(e))for(var n=e.rows,a=e.cols,o=e.opers,u=0;u<n;u++)for(var t=0;t<a;t++){var d=o[u][t];if(!(0,bg.isStringOper)(d))return(0,GO.ni)("TEXTSPLIT array with non-text element");r.push(d.value)}else r.push(e.value);return r}var GEr=function(r,n){var a=n[0],o=n[1],u=n[2],t=n[3],d=n[4],s=n[5],c=a.value;if((0,bg.isMissingOper)(o)||u!==void 0&&!(0,bg.isMissingOper)(u)||d!==void 0&&!(0,bg.isMissingOper)(d)||s!==void 0&&!(0,bg.isMissingOper)(s))return(0,GO.ni)("TEXTSPLIT unsupported arguments");var l=Xee(o);if(l.some(function(E){return E===""}))return Uv.valueErrorOper;for(var f=t===void 0||(0,bg.isMissingOper)(t)?!1:t.value,p=[],m=0,v=c;m<v.length;){for(var h=v.length-m,S=!1,y=0;y<l.length;y++){var C=l[y];v.startsWith(C,m)&&(p.push(v.slice(0,m)),v=v.slice(m+C.length),m=0,S=!0)}S?(0,UEr.assertTrue)("calc.funcs.textsplit: Loop invariant",v.length-m<h):m++}return p.push(v),f&&(p=p.filter(function(E){return E.length!==0})),p.length===0?Uv.calcErrorOper:(0,Uv.arrayOper)(1,p.length,[p.map(Uv.stringOper)])};sT.textSplit=GEr;function Abe(e,r){for(var n=[],a=[],o=0;o<e.length;){for(var u=!1,t=0;t<r.length;t++){var d=r[t];d.length>0&&e.startsWith(d,o)&&(n.push(o),a.push(d.length),o+=d.length,u=!0)}u||o++}return{matchStart:n,matchLength:a}}var KEr=function(r,n){var a=n[0],o=n[1],u=n[2],t=n[3],d=n[4],s=n[5];if(t!==void 0&&!(0,bg.isMissingOper)(t)||d!==void 0&&!(0,bg.isMissingOper)(d))return(0,GO.ni)("TEXTBEFORE unsupported arguments");var c=a.value,l=Xee(o),f=u===void 0||(0,bg.isMissingOper)(u)?1:Math.floor(r.mathpack.toNumber(u)),p=s??Uv.naErrorOper,m=Math.abs(f);if(f===0||m>c.length||l.every(function(y){return c.length-y.length+1<m}))return Uv.valueErrorOper;if(l.some(function(y){return y.length===0}))return(0,Uv.stringOper)(f<0?c:"");var v=Abe(c,l).matchStart,h=(0,GO.getAbsoluteIndexNoClamp)(v.length,f<0?f:f-1),S=v[h];return S===void 0?p:(0,Uv.stringOper)(c.slice(0,S))};sT.textBefore=KEr;var VEr=function(r,n){var a=n[0],o=n[1],u=n[2],t=n[3],d=n[4],s=n[5];if(t!==void 0&&!(0,bg.isMissingOper)(t)||d!==void 0&&!(0,bg.isMissingOper)(d))return(0,GO.ni)("TEXTAFTER unsupported arguments");var c=a.value,l=Xee(o),f=u===void 0||(0,bg.isMissingOper)(u)?1:Math.floor(r.mathpack.toNumber(u)),p=s??Uv.naErrorOper,m=Math.abs(f);if(f===0||m>c.length||l.every(function(E){return c.length-E.length+1<m}))return Uv.valueErrorOper;if(l.some(function(E){return E.length===0}))return(0,Uv.stringOper)(f<0?"":c);var v=Abe(c,l),h=v.matchStart,S=v.matchLength,y=(0,GO.getAbsoluteIndexNoClamp)(h.length,f<0?f:f-1),C=h[y];return C===void 0?p:(0,Uv.stringOper)(c.slice(C+S[y]))};sT.textAfter=VEr});var Fbe=Y(b9=>{"use strict";_();var D0;Object.defineProperty(b9,"__esModule",{value:!0});b9.nextFuncs=void 0;var Pg=Sm(),lT=bbe(),kbe=Nbe(),Zee=Obe(),WEr=(D0={},D0[Pg.WorksheetFuncId.TEXTBEFORE]=Zee.textBefore,D0[Pg.WorksheetFuncId.TEXTAFTER]=Zee.textAfter,D0[Pg.WorksheetFuncId.TEXTSPLIT]=Zee.textSplit,D0[Pg.WorksheetFuncId.XMATCH]=kbe.xmatch,D0[Pg.WorksheetFuncId.XLOOKUP]=kbe.xlookup,D0[Pg.WorksheetFuncId.TAKE]=lT.take,D0[Pg.WorksheetFuncId.DROP]=lT.drop,D0[Pg.WorksheetFuncId.CHOOSECOLS]=lT.choosecols,D0[Pg.WorksheetFuncId.SEQUENCE]=lT.sequence,D0[Pg.WorksheetFuncId.MAP]=lT.map,D0[Pg.WorksheetFuncId.FILTER]=lT.filter,D0[Pg.WorksheetFuncId.VSTACK]=lT.vstack,D0[Pg.WorksheetFuncId.HSTACK]=lT.hstack,D0);b9.nextFuncs={v1:WEr}});var Gv=Y(En=>{"use strict";_();Object.defineProperty(En,"__esModule",{value:!0});En.nextFuncs=En.wildcard=En.webFuncs=En.volatileFuncs=En.funcsUtil=En.funcsTestUtils=En.stringFuncs=En.referenceFuncs=En.reduce=En.recordFuncs=En.rangeFuncs=En.predicateFuncs=En.numfmtFuncs=En.mathFuncs=En.lookupFuncs=En.logicalFuncs=En.lambdaFuncs=En.informationFuncs=En.getWorksheetFuncModule=En.engineeringFuncs=En.dateTimeFuncs=En.criteria=En.aggregationFuncs=En.visitedMap=En.value=En.util=En.testUtils=En.term=En.serviceTypes=En.rtree=En.machine=En.extensionTypes=En.evaluatorService=En.evalTypes=En.evalFormula=En.evalCell=En.evalRuntime=En.evalFunction=En.dereferenceModule=En.compilerService=En.coerce=En.calcChain=En.PackageName=void 0;En.PackageName="excel-online-calc-runtime";En.calcChain=MCe();En.coerce=XU();En.compilerService=tG();En.dereferenceModule=lG();En.evalFunction=h$();En.evalRuntime=RG();En.evalCell=NG();En.evalFormula=kG();En.evalTypes=zs();En.evaluatorService=j_e();En.extensionTypes=QP();En.machine=cd();En.rtree=UZ();En.serviceTypes=hg();En.term=oS();En.testUtils=mbe();En.util=qd();En.value=jC();En.visitedMap=D1();En.aggregationFuncs=J$();En.criteria=L$();En.dateTimeFuncs=iee();En.engineeringFuncs=uee();En.getWorksheetFuncModule=Wee();En.informationFuncs=see();En.lambdaFuncs=lee();En.logicalFuncs=pee();En.lookupFuncs=u9();En.mathFuncs=s9();En.numfmtFuncs=Tee();En.predicateFuncs=Pee();En.rangeFuncs=Nee();En.recordFuncs=Aee();En.reduce=q$();En.referenceFuncs=f9();En.stringFuncs=p9();En.funcsTestUtils=Sbe();En.funcsUtil=Mv();En.volatileFuncs=Uee();En.webFuncs=Gee();En.wildcard=fw();En.nextFuncs=Fbe()});var Z1=Y(wt=>{_();Object.defineProperty(wt,"__esModule",{value:!0});wt.userDefinedFunc=wt.stopped=wt.runtimePositionLetVal=wt.runtimePositionLambdaRoot=wt.runtimePositionLambdaParam=wt.runtimePositionFormulaRoot=wt.runtimePositionFirstOrderFunc=wt.previousNameFailure=wt.previousFailure=wt.pendingValue=wt.paused=wt.nameCycle=wt.limitExceeded=wt.interval=wt.illFormedFormula=wt.finalValue=wt.evalLocals=wt.evalGlobals=wt.createCompileGlobals=wt.compileLocalsName=wt.compileLocalsGrid=wt.cellWellFormedFormula=wt.cellFormula=wt.cellCycle=wt.breaked=wt.StepAction=wt.RuntimePositionKind=wt.ReasonKind=wt.LimitKind=wt.Interrupt=wt.CellKind=void 0;var su=Gv(),jEr=su.serviceTypes.CellKind;wt.CellKind=jEr;var HEr=su.serviceTypes.Interrupt;wt.Interrupt=HEr;var QEr=su.serviceTypes.LimitKind;wt.LimitKind=QEr;var zEr=su.serviceTypes.ReasonKind;wt.ReasonKind=zEr;var YEr=su.serviceTypes.StepAction;wt.StepAction=YEr;var JEr=su.serviceTypes.RuntimePositionKind;wt.RuntimePositionKind=JEr;var XEr=su.serviceTypes.runtimePositionLetVal;wt.runtimePositionLetVal=XEr;var ZEr=su.serviceTypes.runtimePositionLambdaRoot;wt.runtimePositionLambdaRoot=ZEr;var $Er=su.serviceTypes.runtimePositionLambdaParam;wt.runtimePositionLambdaParam=$Er;var eNr=su.serviceTypes.runtimePositionFormulaRoot;wt.runtimePositionFormulaRoot=eNr;var rNr=su.serviceTypes.runtimePositionFirstOrderFunc;wt.runtimePositionFirstOrderFunc=rNr;var nNr=su.serviceTypes.cellCycle;wt.cellCycle=nNr;var tNr=su.serviceTypes.cellFormula;wt.cellFormula=tNr;var aNr=su.serviceTypes.cellWellFormedFormula;wt.cellWellFormedFormula=aNr;var iNr=su.serviceTypes.compileLocalsGrid;wt.compileLocalsGrid=iNr;var oNr=su.serviceTypes.compileLocalsName;wt.compileLocalsName=oNr;var uNr=su.serviceTypes.createCompileGlobals;wt.createCompileGlobals=uNr;var sNr=su.serviceTypes.evalGlobals;wt.evalGlobals=sNr;var lNr=su.serviceTypes.evalLocals;wt.evalLocals=lNr;var cNr=su.serviceTypes.finalValue;wt.finalValue=cNr;var dNr=su.serviceTypes.illFormedFormula;wt.illFormedFormula=dNr;var fNr=su.serviceTypes.interval;wt.interval=fNr;var pNr=su.serviceTypes.limitExceeded;wt.limitExceeded=pNr;var mNr=su.serviceTypes.nameCycle;wt.nameCycle=mNr;var gNr=su.serviceTypes.paused;wt.paused=gNr;var vNr=su.serviceTypes.breaked;wt.breaked=vNr;var hNr=su.serviceTypes.pendingValue;wt.pendingValue=hNr;var SNr=su.serviceTypes.previousFailure;wt.previousFailure=SNr;var yNr=su.serviceTypes.previousNameFailure;wt.previousNameFailure=yNr;var CNr=su.serviceTypes.stopped;wt.stopped=CNr;var _Nr=su.serviceTypes.userDefinedFunc;wt.userDefinedFunc=_Nr});var ere=Y(cT=>{_();Object.defineProperty(cT,"__esModule",{value:!0});cT.createCompiler=cT.compiledFormulaTerm=cT.compiledFormula=void 0;var $ee=Gv(),RNr=$ee.compilerService.compiledFormula;cT.compiledFormula=RNr;var TNr=$ee.compilerService.compiledFormulaTerm;cT.compiledFormulaTerm=TNr;var bNr=$ee.compilerService.createCompiler;cT.createCompiler=bNr});var rre=Y(P9=>{_();Object.defineProperty(P9,"__esModule",{value:!0});P9.createEvaluator=void 0;var PNr=Gv(),ENr=PNr.evaluatorService.createEvaluator;P9.createEvaluator=ENr});var Ibe=Y($1=>{_();Object.defineProperty($1,"__esModule",{value:!0});$1.rangeValues=$1.machine=$1.isRangeValues=$1.DerefOperKind=void 0;var E9=Gv(),NNr=E9.extensionTypes.DerefOperKind;$1.DerefOperKind=NNr;var ANr=E9.extensionTypes.isRangeValues;$1.isRangeValues=ANr;var ONr=E9.extensionTypes.machine;$1.machine=ONr;var kNr=E9.extensionTypes.rangeValues;$1.rangeValues=kNr});var wbe=Y(KO=>{_();Object.defineProperty(KO,"__esModule",{value:!0});KO.RecordOper=KO.LambdaOper=void 0;var Mbe=Gv(),FNr=Mbe.value.LambdaOper;KO.LambdaOper=FNr;var INr=Mbe.value.RecordOper;KO.RecordOper=INr});var Bbe=Y(ww=>{_();Object.defineProperty(ww,"__esModule",{value:!0});ww.runtime=void 0;var lu=Mw(Z1()),MNr=Mw(ere()),wNr=Mw(rre()),Dbe=Mw(Ibe()),xbe=Mw(wbe());function Lbe(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,n=new WeakMap;return(Lbe=function(o){return o?n:r})(e)}function Mw(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var n=Lbe(r);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(u!=="default"&&Object.prototype.hasOwnProperty.call(e,u)){var t=o?Object.getOwnPropertyDescriptor(e,u):null;t&&(t.get||t.set)?Object.defineProperty(a,u,t):a[u]=e[u]}return a.default=e,n&&n.set(e,a),a}var nre;ww.runtime=nre;(function(e){e.ReasonKind=lu.ReasonKind,e.interval=lu.interval,e.CellKind=lu.CellKind,e.Interrupt=lu.Interrupt,e.StepAction=lu.StepAction,e.RuntimePositionKind=lu.RuntimePositionKind,e.runtimePositionLetVal=lu.runtimePositionLetVal,e.runtimePositionLambdaRoot=lu.runtimePositionLambdaRoot,e.runtimePositionLambdaParam=lu.runtimePositionLambdaParam,e.runtimePositionFormulaRoot=lu.runtimePositionFormulaRoot,e.runtimePositionFirstOrderFunc=lu.runtimePositionFirstOrderFunc,e.finalValue=lu.finalValue,e.pendingValue=lu.pendingValue,e.cellWellFormedFormula=lu.cellWellFormedFormula,e.cellFormula=lu.cellFormula,e.userDefinedFunc=lu.userDefinedFunc,e.stopped=lu.stopped,e.nameCycle=lu.nameCycle,e.cellCycle=lu.cellCycle,e.paused=lu.paused,e.breaked=lu.breaked,e.previousFailure=lu.previousFailure,e.previousNameFailure=lu.previousNameFailure,e.evalGlobals=lu.evalGlobals,e.evalLocals=lu.evalLocals,e.compileLocalsGrid=lu.compileLocalsGrid,e.compileLocalsName=lu.compileLocalsName,e.illFormedFormula=lu.illFormedFormula,e.createCompileGlobals=lu.createCompileGlobals,e.limitExceeded=lu.limitExceeded,e.LimitKind=lu.LimitKind,e.LambdaOper=xbe.LambdaOper,e.RecordOper=xbe.RecordOper,e.createCompiler=MNr.createCompiler,e.createEvaluator=wNr.createEvaluator;var r;(function(n){n.DerefOperKind=Dbe.DerefOperKind,n.machine=Dbe.machine})(r=e.extension||(e.extension={}))})(nre||(ww.runtime=nre={}))});var dT=Y(Qr=>{_();Object.defineProperty(Qr,"__esModule",{value:!0});Qr.RecalcServiceCreateMode=void 0;Object.defineProperty(Qr,"RibbonFormat",{enumerable:!0,get:function(){return DNr.RibbonFormat}});Qr.arrayDelta=Qr.arrayData=void 0;Qr.arrayFormulaCellData=JNr;Qr.arrayFormulaEdit=void 0;Qr.arrayPromote=nAr;Qr.arrayUpdate=void 0;Qr.arrayWrite=rAr;Qr.cellDataDelta=Qr.cellData=Qr.blankValue=void 0;Qr.cellFormulaCellData=YNr;Qr.cellFormulaRangeFormulaEdit=mAr;Qr.columnData=Qr.cellLocation=void 0;Qr.copyPasteRangePasteEdit=RAr;Qr.errorValue=Qr.errorTypeName=void 0;Qr.evalFormulaData=wAr;Qr.evalFormulaFormat=void 0;Qr.evalFormulaFormatAggregate=MAr;Qr.evalFormulaFormatIformat=kAr;Qr.evalFormulaFormatInferred=IAr;Qr.evalFormulaFormatKnown=FAr;Qr.evalFormulaFormatOrigin=OAr;Qr.formatEditChangeDecimals=yAr;Qr.formatEditOperation=void 0;Qr.formatEditRibbonFormat=SAr;Qr.formatEditSetFormat=hAr;Qr.getCellFormatKind=jNr;Qr.getCellValueKind=WNr;Qr.inferredFormat=void 0;Qr.inferredRangeFormulaEdit=vAr;Qr.namedObject=Qr.namedFormulaData=Qr.namedFailureData=Qr.localeData=void 0;Qr.namedObjectsPromote=pAr;Qr.namedObjectsUpdate=void 0;Qr.namedObjectsWrite=dAr;Qr.rangePasteEdit=Qr.rangeLocation=Qr.rangeFormulaEdit=Qr.rangeFormatEdit=Qr.rangeFailure=Qr.rangeDelta=Qr.numberFormat=Qr.namedValueData=Qr.namedTableData=Qr.namedRangeData=void 0;Qr.rangePromote=$Nr;Qr.sheetRangeLocation=Qr.sheetName=Qr.sheetCellLocation=Qr.runExperiment=Qr.richValue=Qr.recalcServiceConfig=Qr.recalcResults=Qr.rangeWrite=Qr.rangeUpdate=void 0;Qr.undefinedNamesWrite=fAr;Qr.updateRequest=Qr.unusedCellsUpdate=void 0;Qr.valueCellData=XNr;Qr.valueRangeFormulaEdit=gAr;Qr.worksheetFunctionName=Qr.workbookProps=void 0;var ji=ft(),DNr=Q3(),xNr=(0,ji.typedInstanceCreator)()(function(e,r){return{functionId:e,functionName:r}});Qr.worksheetFunctionName=xNr;var LNr=(0,ji.typedInstanceCreator)()(function(e,r){return{errorType:e,errorName:r}});Qr.errorTypeName=LNr;var BNr=(0,ji.typedInstanceCreator)()(function(e,r,n,a,o,u,t,d,s,c,l,f,p,m,v,h,S,y,C,E,I,F,w,B,k,x,G,H,L,D,U,V,ne,J,$,Z,ie,X,Q,b,R,P,A,T,g,O,M,K,W,z,ee){return{worksheetFunctionNames:e,errorTypeNames:r,specialRefNames:W,trueName:n,falseName:a,rowLetter:o,columnLetter:u,leftBrace:t,rightBrace:d,leftBracket:s,rightBracket:c,decimalSeparator:l,listSeparator:f,columnSeparator:p,rowSeparator:m,thousandsData:v,thousandsSeparator:h,lcid:S,country:y,numberDecimals:C,isExpSepBySpace:E,fractionSeparator:I,isPercentSepBySpace:F,currencyFormat:w,isCurrencySymbolLead:B,isCurrencySepBySpace:k,currencySymbol:x,currencyDecimals:G,dateOrder:H,dateSeparator:L,dateAltSeparator:D,year4Digits:U,month2Digits:V,day2Digits:ne,longDateFormat:J,timeSeparator:$,timeAltSeparator:Z,hour2Digits:ie,clock24Hour:X,isAMPMSepBySpace:Q,ampmSymbols:b,dayNameShort:R,dayNameLong:P,monthNameShort:A,monthNameLong:T,pictureSpecial:g,pictureSingle:O,pictureColor:M,pictureDbnum:K,sysDateFormat:z,sysTimeFormat:ee}});Qr.localeData=BNr;var qNr=(0,ji.typedInstanceCreator)()(function(e,r,n){return{iformat:e,formatString:r,builtIn:n}});Qr.numberFormat=qNr;var UNr=(0,ji.typedInstanceCreator)()(function(e,r){return{sheetId:e,sheetName:r}});Qr.sheetName=UNr;var GNr={kind:"Blank"};Qr.blankValue=GNr;var KNr=(0,ji.typedInstanceCreator)()(function(e){return{kind:"Error",type:e}});Qr.errorValue=KNr;var VNr=(0,ji.typedInstanceCreator)()(function(e){return{kind:"Rich",fields:e}});Qr.richValue=VNr;function WNr(e){return typeof e=="object"?e.kind:typeof e}function jNr(e){return typeof e=="object"?e.kind:typeof e}var HNr=(0,ji.typedInstanceCreator)()(function(e,r){return{row:e,column:r}});Qr.cellLocation=HNr;var QNr=(0,ji.typedInstanceCreator)()(function(e,r,n,a){return{row:e,column:r,lastRow:n,lastColumn:a}});Qr.rangeLocation=QNr;var zNr=(0,ji.typedInstanceCreator)()(function(e,r,n,a,o){return{sheetId:e,row:r,column:n,lastRow:a,lastColumn:o}});Qr.sheetRangeLocation=zNr;var qbe=(0,ji.typedInstanceCreator)()(function(e,r,n){return{sheetId:e,row:r,column:n,lastRow:void 0,lastColumn:void 0}});Qr.sheetCellLocation=qbe;var N9=(0,ji.typedInstanceCreator)()(function(e,r,n,a,o){return{formulaBarText:e,value:r,iformat:n,failureReason:a,kind:o}});Qr.cellData=N9;function YNr(e,r,n,a){return N9(e,r,n,a,"CellFormula")}function JNr(e,r,n){return N9(void 0,e,r,n,"ArrayFormula")}function XNr(e,r,n,a){return N9(e,r,n,a,"Value")}var are=(0,ji.typedInstanceCreator)()(function(e,r,n,a,o){return{range:e,data:r,fromStateId:n,excludeRows:a,excludeColumns:o}});Qr.rangeUpdate=are;var ZNr=(0,ji.typedInstanceCreator)()(function(e,r,n,a){return are(e,r,void 0,n,a)});Qr.rangeWrite=ZNr;function $Nr(e,r,n,a){return are(e,void 0,r,n,a)}var eAr=(0,ji.typedInstanceCreator)()(function(e,r){return{isSpilled:e,formulaBarText:r}});Qr.arrayData=eAr;var ire=(0,ji.typedInstanceCreator)()(function(e,r,n){return{range:e,data:r,fromStateId:n}});Qr.arrayUpdate=ire;function rAr(e,r){return ire(e,r,void 0)}function nAr(e,r){return ire(e,void 0,r)}var tAr=(0,ji.typedInstanceCreator)()(function(e,r){return{sheetId:e,usedRange:r}});Qr.unusedCellsUpdate=tAr;var aAr=(0,ji.typedInstanceCreator)()(function(e){return{kind:"NamedValue",value:e}});Qr.namedValueData=aAr;var iAr=(0,ji.typedInstanceCreator)()(function(e){return{kind:"NamedFormula",formulaBarText:e}});Qr.namedFormulaData=iAr;var oAr=(0,ji.typedInstanceCreator)()(function(e){return{kind:"NamedRange",range:e}});Qr.namedRangeData=oAr;var uAr=(0,ji.typedInstanceCreator)()(function(e,r){return{column:e,name:r}});Qr.columnData=uAr;var sAr=(0,ji.typedInstanceCreator)()(function(e,r,n,a){return{kind:"NamedTable",range:e,hasHeadersRow:r,hasTotalsRow:n,columns:a}});Qr.namedTableData=sAr;var lAr=(0,ji.typedInstanceCreator)()(function(e,r){return{kind:"NamedFailure",failureReason:e,objectKind:r}});Qr.namedFailureData=lAr;var cAr=(0,ji.typedInstanceCreator)()(function(e,r){return{name:e,data:r}});Qr.namedObject=cAr;var A9=(0,ji.typedInstanceCreator)()(function(e,r,n){return{scope:e,objects:r,fromStateId:n}});Qr.namedObjectsUpdate=A9;function dAr(e,r){return A9(e,r,void 0)}function fAr(e){return A9(e,void 0,void 0)}function pAr(e,r){return A9(e,void 0,r)}var O9=function(r,n,a,o,u,t){return t===void 0&&(t="Inferred"),{range:Array.isArray(r)?r:[r],formulaBarText:n,value:a,origin:o,viewport:u,kind:t}};Qr.rangeFormulaEdit=O9;function mAr(e,r,n,a){return O9(e,r,void 0,n,a,"CellFormula")}function gAr(e,r,n,a){return O9(e,r,n,void 0,a,"Value")}function vAr(e,r,n,a){return O9(e,r,void 0,n,a,"Inferred")}var k9=(0,ji.typedInstanceCreator)()(function(e,r,n,a){return{kind:e,format:r,ribbon:n,changeDecimals:a}});Qr.formatEditOperation=k9;function hAr(e){return k9("SetFormat",e,void 0,void 0)}function SAr(e){return k9("RibbonFormat",void 0,e,void 0)}function yAr(e){return k9("ChangeDecimals",void 0,void 0,e)}var CAr=(0,ji.typedInstanceCreator)()(function(e,r,n,a){return{range:e,operation:r,origin:n,viewport:a}});Qr.rangeFormatEdit=CAr;var _Ar=(0,ji.typedInstanceCreator)()(function(e,r,n,a){return{range:e,formulaBarText:r,origin:n,viewport:a}});Qr.arrayFormulaEdit=_Ar;var Ube=(0,ji.typedInstanceCreator)()(function(e,r,n,a){return{kind:e,target:r,source:n,viewport:a}});Qr.rangePasteEdit=Ube;function RAr(e,r,n){var a=qbe(e.sheetId,e.row,e.column);return Ube("CopyPaste",a,r,n)}var TAr=(0,ji.typedInstanceCreator)()(function(e,r,n){return{format:e,category:r,decimals:n}});Qr.inferredFormat=TAr;var bAr=(0,ji.typedInstanceCreator)()(function(e,r,n,a,o){return{formulaBarText:e,value:r,format:n,formatted:a,hasHyperlink:o}});Qr.cellDataDelta=bAr;var PAr=(0,ji.typedInstanceCreator)()(function(e,r){return{range:e,data:r}});Qr.rangeDelta=PAr;var EAr=(0,ji.typedInstanceCreator)()(function(e,r){return{range:e,data:r}});Qr.arrayDelta=EAr;var NAr=(0,ji.typedInstanceCreator)()(function(e,r){return{range:e,reason:r}});Qr.rangeFailure=NAr;var AAr=(0,ji.typedInstanceCreator)()(function(e,r,n,a,o,u){return{stateId:e,priorityGroup:r,isFinished:n,rangeDeltas:a,arrayDeltas:o,rangeFailures:u}});Qr.recalcResults=AAr;var VO=(0,ji.typedInstanceCreator)()(function(e,r,n){return{kind:e,iformat:r,knownFormat:n}});Qr.evalFormulaFormat=VO;function OAr(){return VO("Origin")}function kAr(e){return VO("Iformat",e)}function FAr(e){return VO("Known",void 0,e)}function IAr(){return VO("Inferred")}function MAr(){return VO("Aggregate")}function wAr(e,r){return{value:e,formatted:r}}var DAr=(0,ji.typedInstanceCreator)()(function(e,r,n){return{rangeUpdateRanges:e,arrayUpdateRanges:r,namesUpdateScopes:n}});Qr.updateRequest=DAr;var xAr=(0,ji.typedInstanceCreator)()(function(e,r){return{name:e,param:r}});Qr.runExperiment=xAr;var LAr=(0,ji.typedInstanceCreator)()(function(e,r,n,a,o,u,t,d,s,c,l,f){return l===void 0&&(l=c==null?void 0:c/(c>=1?1:10)),{totalEvalTimeMs:e,samplePrecisionEvalRate:r,samplePrecisionPrintFormulaRate:c,samplePrecisionPrintValueRate:l,sampleRecalcStatisticsRate:d,sampleWorkbookStatisticsRate:a,sampleRecalcEditedStopwatchRate:o,sampleRecalcViewportStopwatchRate:u,sampleCellEvalStopwatchRate:t,rngSeed:n,volatileMode:f,runExperiments:s}});Qr.recalcServiceConfig=LAr;var BAr=(0,ji.typedInstanceCreator)()(function(e,r,n){return{date1904:e,dateCompatibility:r,timezone:n}});Qr.workbookProps=BAr;var tre;Qr.RecalcServiceCreateMode=tre;(function(e){e.Thread="Thread",e.Local="Local",e.ThreadOrLocal="ThreadOrLocal"})(tre||(Qr.RecalcServiceCreateMode=tre={}))});var Gbe=Y($p=>{_();Object.defineProperty($p,"__esModule",{value:!0});$p.ivlMeetsOrTouches=$p.ivlMeets=$p.ivlMeet=$p.ivlJoin=$p.ivlExcept=$p.ivlDistance=$p.ivlCompare=void 0;var ZP=Cn(),qAr=ZP.interval.ivlJoin;$p.ivlJoin=qAr;var UAr=ZP.interval.ivlMeet;$p.ivlMeet=UAr;var GAr=ZP.interval.ivlDistance;$p.ivlDistance=GAr;var KAr=ZP.interval.ivlMeets;$p.ivlMeets=KAr;var VAr=ZP.interval.ivlMeetsOrTouches;$p.ivlMeetsOrTouches=VAr;var WAr=ZP.interval.ivlExcept;$p.ivlExcept=WAr;var jAr=ZP.interval.ivlCompare;$p.ivlCompare=jAr});var ey=Y(Xa=>{_();Object.defineProperty(Xa,"__esModule",{value:!0});Xa.unionUntyped=Xa.union=Xa.symmetricDiff=Xa.meetsUntyped=Xa.meets=Xa.lazy=Xa.intersectUntyped=Xa.intersect=Xa.getNodeCount=Xa.fromUntyped=Xa.forEachKeyUntyped=Xa.forEachKey=Xa.exceptUntyped=Xa.except=Xa.empty=Xa.dense=Xa.createFromKey=Xa.complement=Xa.compareUntyped=Xa.compare=Xa.combineCmp=Xa.cacheKeySplitting=Xa.SetKind=void 0;var Gl=Cn(),HAr=Gl.bspSet.SetKind;Xa.SetKind=HAr;var QAr=Gl.bspSet.cacheKeySplitting;Xa.cacheKeySplitting=QAr;var zAr=Gl.bspSet.createFromKey;Xa.createFromKey=zAr;var YAr=Gl.bspSet.fromUntyped;Xa.fromUntyped=YAr;var JAr=Gl.bspSet.union;Xa.union=JAr;var XAr=Gl.bspSet.unionUntyped;Xa.unionUntyped=XAr;var ZAr=Gl.bspSet.intersect;Xa.intersect=ZAr;var $Ar=Gl.bspSet.intersectUntyped;Xa.intersectUntyped=$Ar;var e2r=Gl.bspSet.meets;Xa.meets=e2r;var r2r=Gl.bspSet.meetsUntyped;Xa.meetsUntyped=r2r;var n2r=Gl.bspSet.except;Xa.except=n2r;var t2r=Gl.bspSet.exceptUntyped;Xa.exceptUntyped=t2r;var a2r=Gl.bspSet.compare;Xa.compare=a2r;var i2r=Gl.bspSet.combineCmp;Xa.combineCmp=i2r;var o2r=Gl.bspSet.compareUntyped;Xa.compareUntyped=o2r;var u2r=Gl.bspSet.dense;Xa.dense=u2r;var s2r=Gl.bspSet.empty;Xa.empty=s2r;var l2r=Gl.bspSet.lazy;Xa.lazy=l2r;var c2r=Gl.bspSet.symmetricDiff;Xa.symmetricDiff=c2r;var d2r=Gl.bspSet.complement;Xa.complement=d2r;var f2r=Gl.bspSet.getNodeCount;Xa.getNodeCount=f2r;var p2r=Gl.bspSet.forEachKey;Xa.forEachKey=p2r;var m2r=Gl.bspSet.forEachKeyUntyped;Xa.forEachKeyUntyped=m2r});var Kbe=Y(fT=>{_();Object.defineProperty(fT,"__esModule",{value:!0});fT.boundedParetoSplitter=fT.boundedParetoSetOperations=fT.boundedPareto=void 0;var ore=Cn(),g2r=ore.split.boundedPareto;fT.boundedPareto=g2r;var v2r=ore.split.boundedParetoSplitter;fT.boundedParetoSplitter=v2r;var h2r=ore.split.boundedParetoSetOperations;fT.boundedParetoSetOperations=h2r});var x0=Y(Ou=>{_();Object.defineProperty(Ou,"__esModule",{value:!0});Ou.unionProduct=Ou.symmetricDiffProduct=Ou.project=Ou.productSetSerializer=Ou.meetsProduct=Ou.intersectProduct=Ou.getSubspaces=Ou.getSubspaceCount=Ou.forEachProduct=Ou.exceptProduct=Ou.createFromProduct=Ou.complementProduct=Ou.compareProduct=Ou.ProductSetSerializer=void 0;var bm=Cn(),S2r=bm.productSet.createFromProduct;Ou.createFromProduct=S2r;var y2r=bm.productSet.project;Ou.project=y2r;var C2r=bm.productSet.unionProduct;Ou.unionProduct=C2r;var _2r=bm.productSet.intersectProduct;Ou.intersectProduct=_2r;var R2r=bm.productSet.exceptProduct;Ou.exceptProduct=R2r;var T2r=bm.productSet.compareProduct;Ou.compareProduct=T2r;var b2r=bm.productSet.meetsProduct;Ou.meetsProduct=b2r;var P2r=bm.productSet.complementProduct;Ou.complementProduct=P2r;var E2r=bm.productSet.symmetricDiffProduct;Ou.symmetricDiffProduct=E2r;var N2r=bm.productSet.getSubspaces;Ou.getSubspaces=N2r;var A2r=bm.productSet.forEachProduct;Ou.forEachProduct=A2r;var O2r=bm.productSet.getSubspaceCount;Ou.getSubspaceCount=O2r;var k2r=bm.productSet.ProductSetSerializer;Ou.ProductSetSerializer=k2r;var F2r=bm.productSet.productSetSerializer;Ou.productSetSerializer=F2r});var e0=Y(Tl=>{_();Object.defineProperty(Tl,"__esModule",{value:!0});Tl.bspFactory=Tl.availableSetProduct=Tl.availableReadProduct=Tl.availableAllProduct=Tl.availabilityOperations=Tl.anyAvailability=Tl.AvailabilityKind=void 0;Tl.cellSetBounds=x2r;Tl.createCellSetFromRange=D2r;Tl.forEachCellInSet=K2r;Tl.forEachCol=w9;Tl.forEachRangeInSet=jbe;Tl.forEachRow=M9;Tl.translateAvailabilitySet=V2r;var I9=gs(),I2r=zu(),Vbe=Gbe(),fp=ey(),lre=Kbe(),pT=x0(),dS;Tl.AvailabilityKind=dS;(function(e){e[e.AvailableSet=0]="AvailableSet",e[e.AvailableRead=1]="AvailableRead"})(dS||(Tl.AvailabilityKind=dS={}));var F9=[dS.AvailableSet,dS.AvailableRead+1];Tl.anyAvailability=F9;var ure=[0,I9.sheetRows],sre=[0,I9.sheetCols],Wbe=(0,lre.boundedParetoSetOperations)(1,F9[0]+1,F9[1],F9,"Availability operations, alpha = 1");Tl.availabilityOperations=Wbe;var M2r=(0,lre.boundedParetoSetOperations)(.2,ure[0]+1,ure[1],ure,"Row operations, alpha = 0.2"),w2r=(0,lre.boundedParetoSetOperations)(.35,sre[0]+1,sre[1],sre,"Col operations, alpha = 0.35"),$C={availability:Wbe,row:M2r,col:w2r},mT={availability:(0,fp.createFromKey)($C.availability),row:(0,fp.createFromKey)($C.row),col:(0,fp.createFromKey)($C.col)};Tl.bspFactory=mT;function D2r(e){return(0,pT.createFromProduct)({row:mT.row([e.row,e.row+e.rows]),col:mT.col([e.col,e.col+e.cols])})}function x2r(e){if(e!==fp.empty){var r=e===fp.dense?void 0:e.root.bounds.row,n=e===fp.dense?void 0:e.root.bounds.col,a=r===void 0?$C.row.top:U2r((0,fp.fromUntyped)($C.row,r)),o=a[0],u=a[1],t=n===void 0?$C.col.top:G2r((0,fp.fromUntyped)($C.col,n)),d=t[0],s=t[1];return(0,I9.gridRange)(o,d,u-o,s-d)}}var L2r=(0,pT.createFromProduct)({availability:mT.availability([dS.AvailableSet,dS.AvailableSet+1])});Tl.availableSetProduct=L2r;var B2r=(0,pT.createFromProduct)({availability:mT.availability([dS.AvailableRead,dS.AvailableRead+1])});Tl.availableReadProduct=B2r;var q2r=(0,pT.createFromProduct)({availability:mT.availability([dS.AvailableSet,dS.AvailableRead+1])});Tl.availableAllProduct=q2r;function M9(e,r){return e!==fp.dense?(0,fp.forEachKey)(e,r):r($C.row.top)}function w9(e,r){return e!==fp.dense?(0,fp.forEachKey)(e,r):r($C.col.top)}function U2r(e){var r=[];return M9(e,function(n){return r.push(n),!0}),r.reduce(Vbe.ivlJoin)}function G2r(e){var r=[];return w9(e,function(n){return r.push(n),!0}),r.reduce(Vbe.ivlJoin)}function jbe(e,r){var n=function(o){return M9(o.row,function(u){var t=u[0],d=u[1];return w9(o.col,function(s){var c=s[0],l=s[1];return r((0,I9.gridRange)(t,c,d-t,l-c))})})};return(0,pT.forEachProduct)(e,n,"row","col")}function K2r(e,r){return jbe(e,function(n){return(0,I2r.forEachCellInRange)(n,r)})}function V2r(e,r,n){var a=fp.empty;return(0,pT.forEachProduct)(e,function(o){var u=fp.empty;M9(o.row,function(s){var c=s[0],l=s[1];return u=(0,fp.union)(u,mT.row([c+r,l+r])),!0});var t=fp.empty;w9(o.col,function(s){var c=s[0],l=s[1];return t=(0,fp.union)(t,mT.col([c+n,l+n])),!0});var d=(0,pT.createFromProduct)({row:u,col:t,availability:o.availability});return a=(0,pT.unionProduct)(a,d),!0},"row","col","availability"),a}});var vd=Y(so=>{_();Object.defineProperty(so,"__esModule",{value:!0});so.UnavailableKind=so.SpecialStyle=so.SpecialFormat=so.SetMessageKind=so.RecalcStatisticsMessage=so.OutputMessageKind=so.FormulaMode=so.ComputedCellKind=so.ComputeKind=void 0;so.createSheetCellSetFromRange=H2r;so.emptyRecalcStatistics=void 0;so.isOutputFormatUnavailable=Z2r;so.mergeRecalcStatistics=X2r;so.sheetCellSet=Hbe;so.sheetHiddenRows=z2r;so.sheetInFilterMode=Y2r;so.sheetUsedRange=Q2r;var Pm=br(),W2r=e0(),j2r=Ai(),dre;so.UnavailableKind=dre;(function(e){e.DocumentLoc="DocumentLoc",e.SheetId="SheetId",e.SheetNames="SheetNames",e.GridRange="GridRange",e.GridRangeSize="GridRangeSize",e.CellFormat="CellFormat",e.CellStyle="CellStyle",e.HiddenRows="HiddenRows",e.HiddenCols="HiddenCols",e.InFilterMode="InFilterMode",e.CellFormula="CellFormula",e.CellMissingFormula="CellMissingFormula",e.CellEvaluatingValue="CellEvaluatingValue",e.EvalFailure="EvalFailure",e.ClientFailure="ClientFailure",e.NumberFormat="NumberFormat",e.StyleId="StyleId",e.FontId="FontId",e.FillId="FillId",e.BorderId="BorderId",e.NameLoc="NameLoc",e.VolatileFunction="VolatileFunction",e.TimeGranularity="TimeGranularity",e.GetTimeKind="GetTimeKind",e.ColumnName="ColumnName",e.ContainingTable="ContainingTable",e.NamedRanges="NamedRanges"})(dre||(so.UnavailableKind=dre={}));function Hbe(e,r){return{sheet:e,set:r}}function H2r(e){return Hbe(e.sheet,(0,W2r.createCellSetFromRange)(e.range))}function Q2r(e,r){return{sheet:e,range:r}}function z2r(e,r,n){return{sheet:e,range:r,hidden:n}}function Y2r(e,r){return{sheet:e,inFilterMode:r}}var fre;so.ComputeKind=fre;(function(e){e.PrecisionTest="PrecisionTest",e.EditedCell="EditedCell",e.DependentCell="DependentCell",e.EvalFormula="EvalFormula",e.ParseEdit="ParseEdit"})(fre||(so.ComputeKind=fre={}));var pre;so.ComputedCellKind=pre;(function(e){e.EditedCell="EditedCell",e.DependentCell="DependentCell",e.IndependentCell="IndependentCell",e.UnknownNonEditedCell="UnknownNonEditedCell"})(pre||(so.ComputedCellKind=pre={}));var J2r={calculatedCellCount:{},changedCellCount:{},continueCount:0,editFinishedCount:0,stateTimedOut:!1,recalcFinishedCount:0};so.emptyRecalcStatistics=J2r;var e_;so.RecalcStatisticsMessage=e_;(function(e){e.ChangedCell="ChangedCell",e.UnchangedCell="UnchangedCell",e.ContinueComputation="ContinueComputation",e.EditFinished="EditFinished",e.StateTimedOut="StateTimedOut",e.RecalcFinished="RecalcFinished"})(e_||(so.RecalcStatisticsMessage=e_={}));function cre(e,r){var n,a;return(0,Pm.__assign)((0,Pm.__assign)({},e),(n={},n[r]=((a=e[r])!==null&&a!==void 0?a:0)+1,n))}function X2r(e,r){switch(r.message){case e_.ChangedCell:return(0,Pm.__assign)((0,Pm.__assign)({},e),{changedCellCount:cre(e.changedCellCount,r.cellKind),calculatedCellCount:cre(e.calculatedCellCount,r.cellKind)});case e_.UnchangedCell:return(0,Pm.__assign)((0,Pm.__assign)({},e),{calculatedCellCount:cre(e.calculatedCellCount,r.cellKind)});case e_.ContinueComputation:return(0,Pm.__assign)((0,Pm.__assign)({},e),{continueCount:e.continueCount+1});case e_.StateTimedOut:return(0,Pm.__assign)((0,Pm.__assign)({},e),{stateTimedOut:!0});case e_.EditFinished:return(0,Pm.__assign)((0,Pm.__assign)({},e),{editFinishedCount:e.editFinishedCount+1});case e_.RecalcFinished:return(0,Pm.__assign)((0,Pm.__assign)({},e),{recalcFinishedCount:e.recalcFinishedCount+1});default:return(0,j2r.assertNever)("calc.calc.partialWorkbookMessages.mergeRecalcStatistics",r)}}var mre;so.SetMessageKind=mre;(function(e){e.SetSheetNames="SetSheetNames",e.SetRefStyle="SetRefStyle",e.SetLocaleInfo="SetLocaleInfo",e.SetNumberFormats="SetNumberFormats",e.WriteNamedObject="WriteNamedObject",e.WriteUndefinedNames="WriteUndefinedNames",e.PromoteNamedObjects="PromoteNamedObjects",e.ExtendUnusedRange="ExtendUnusedRange",e.WriteHiddenRows="WriteHiddenRows",e.WriteInFilterMode="WriteInFilterMode",e.SetCellContents="SetCellContents",e.SetRangeFormula="SetRangeFormula",e.PromoteCellContents="PromoteCellContents"})(mre||(so.SetMessageKind=mre={}));var gre;so.SpecialFormat=gre;(function(e){e.Unavailable="Unavailable",e.Weak="Weak",e.ClientValueUnknown="ClientValueUnknown",e.Origin="Origin",e.Aggregate="Aggregate",e.Inferred="Inferred",e.Known="Known",e.Edit="Edit"})(gre||(so.SpecialFormat=gre={}));var vre;so.SpecialStyle=vre;(function(e){e.Unavailable="Unavailable",e.Weak="Weak",e.Blank="Blank"})(vre||(so.SpecialStyle=vre={}));var hre;so.FormulaMode=hre;(function(e){e.EvalFormula="eval-formula",e.ServerCellFormula="server-cell-formula",e.EditCellFormula="edit-cell-formula",e.ServerNamedFormula="server-named-formula",e.EditNamedFormula="edit-named-formula"})(hre||(so.FormulaMode=hre={}));var Sre;so.OutputMessageKind=Sre;(function(e){e.StateAdvanced="StateAdvanced",e.CellWrite="CellWrite",e.RangeWrite="RangeWrite",e.NameFailure="NameFailure",e.RangeFailure="RangeFailure",e.NumberFormatFailure="NumberFormatFailure",e.PrintFormulaFailure="PrintFormulaFailure",e.InferFormatFailure="InferFormatFailure",e.FormatValueFailure="FormatValueFailure",e.UnhandledFailure="UnhandledFailure",e.UpdateRequest="UpdateRequest",e.UpdateNamesRequest="UpdateNamesRequest",e.GarbageCollected="GarbageCollected",e.Alert="Alert",e.RecalcStatistics="RecalcStatistics",e.WorkbookStatistics="WorkbookStatistics",e.ExperimentRunResult="ExperimentRunResult"})(Sre||(so.OutputMessageKind=Sre={}));function Z2r(e){return typeof e=="object"}});var gT=Y(WO=>{_();Object.defineProperty(WO,"__esModule",{value:!0});WO.makeGridRangeTable=WO.gridRangeDistance=void 0;var Qbe=Gv(),$2r=Qbe.rtree.gridRangeDistance;WO.gridRangeDistance=$2r;var eOr=Qbe.rtree.makeGridRangeTable;WO.makeGridRangeTable=eOr});var r_=Y(di=>{_();Object.defineProperty(di,"__esModule",{value:!0});di.isBlankGridFormula=di.isBlankCellFormat=di.hiddennessFullyUnavailable=di.emptyUsedRange=di.emptyGridStatistics=di.denseUsedRange=di.clientValueUnknownOper=di.blankRangeGridFormula=di.blankGridValue=di.blankClientGridFormula=di.blankCellGridFormula=di.blankCellFormat=di.SpecialString=di.SpecialBoolean=di.PartialWorkbookGrid=di.CloningTarget=di.ClientOperKind=void 0;di.isBlankGridValue=qw;di.isClientValueUnknownOper=rPe;di.mergeGridStatistics=oOr;di.usedRangeIsect=x9;di.usedRangeJoin=_re;var Kv=br(),D9=Z1(),Eg=zu(),ry=gs(),rOr=f1(),pa=e0(),xw=gT(),eE=ft(),Bi=ey(),ct=x0(),hc=vd(),jO=Di(),nOr=ig();function zbe(e){return Array.isArray(e)}var $P=0;di.blankCellFormat=$P;var Lw=function(r){return r===0};di.isBlankCellFormat=Lw;var L9;di.SpecialBoolean=L9;(function(e){e.ClientValueUnknown="ClientValueUnknown"})(L9||(di.SpecialBoolean=L9={}));var Uw;di.SpecialString=Uw;(function(e){e[e.ClientValueUnknown=0]="ClientValueUnknown"})(Uw||(di.SpecialString=Uw={}));var B9={fmla:"",lexicalKind:ry.LexicalKind.Cell,origin:(0,ry.gridCell)(0,0),compiledFmla:void 0,hasHyperlink:!1};di.blankCellGridFormula=B9;(0,eE.staticAssertExtends)();var $be={fmla:"",lexicalKind:ry.LexicalKind.Range,origin:(0,ry.gridCell)(0,0),compiledFmla:void 0,hasHyperlink:!1};di.blankRangeGridFormula=$be;(0,eE.staticAssertExtends)();var Bw=function(r,n){return r===""&&!n};di.isBlankGridFormula=Bw;var ePe=B9;di.blankClientGridFormula=ePe;var Gw;di.ClientOperKind=Gw;(function(e){e.ClientValueUnknown="ClientValueUnknown"})(Gw||(di.ClientOperKind=Gw={}));var yre={kind:Gw.ClientValueUnknown};di.clientValueUnknownOper=yre;function rPe(e){return e.kind===Gw.ClientValueUnknown}var vT={oper:rOr.blankOper,failure:void 0};di.blankGridValue=vT;(0,eE.staticAssertExtends)();function qw(e,r){return(0,Eg.isBlankOper)(e)&&r===void 0}function Ybe(e,r,n){return e.setValue(r,n,function(a){return a.fmla!==n.fmla||a.lexicalKind!==n.lexicalKind||a.compiledFmla!==void 0&&!(0,Eg.isGridCellEqual)(a.origin,n.origin)||a.compiledFmla==null!=(n.compiledFmla==null)})}function Jbe(e,r){return e.forEachMeets(r,function(n,a){if(a.fmla.length>0){var o=a.lexicalKind===ry.LexicalKind.Cell?B9:$be;e=e.setValue(n,o)}return!0}),e}function Xbe(e,r){return e.forEachMeets(r,function(n,a){return(a.fmla===Uw.ClientValueUnknown||a.fmla.length>0)&&(e=e.setValue(n,ePe)),!0}),e}function Zbe(e,r,n,a){var o=(0,ct.intersectProduct)(r,pa.availableReadProduct),u=(0,ct.project)((0,ct.intersectProduct)(n,o),"row","col");return(0,pa.forEachCellInSet)((0,ct.exceptProduct)(r,u),function(t){return e=e.setValue(t,a),!0}),e}function tOr(e,r,n){var a=(0,ct.intersectProduct)(r,pa.availableReadProduct),o=(0,ct.project)((0,ct.intersectProduct)(n,a),"row","col");return(0,pa.forEachCellInSet)((0,ct.exceptProduct)(r,o),function(u){return e=e.setValue(u,hc.SpecialStyle.Unavailable),!0}),e}var aOr={hidden:[],available:[]};di.hiddennessFullyUnavailable=aOr;var Dw={values:(0,xw.makeGridRangeTable)(),formats:(0,xw.makeGridRangeTable)(),styles:(0,xw.makeGridRangeTable)(),formulae:(0,xw.makeGridRangeTable)(),dirty:Bi.empty},iOr={serverFormulaeNodeCount:0,serverFormatsNodeCount:0,serverStylesNodeCount:0,serverValuesNodeCount:0,serverDirtySetSubspaceCount:0,editedFormulaeNodeCount:0,editedFormatsNodeCount:0,editedStylesNodeCount:0,editedValuesNodeCount:0,editedDirtySetSubspaceCount:0,clientFormulaeNodeCount:0,clientFormatsNodeCount:0,clientValuesNodeCount:0,recalcValuesNodeCount:0,recalcDirtySetSubspaceCount:0,recalcFailuresSetSubspaceCount:0,recalcTaintSetSubspaceCount:0,availabilitySetSubspaceCount:0,availabilityHistorySize:0,hiddenRowsNodeCount:0,hiddenColsNodeCount:0};di.emptyGridStatistics=iOr;function oOr(e,r){return{serverFormulaeNodeCount:e.serverFormulaeNodeCount+r.serverFormulaeNodeCount,serverFormatsNodeCount:e.serverFormatsNodeCount+r.serverFormatsNodeCount,serverStylesNodeCount:e.serverStylesNodeCount+r.serverStylesNodeCount,serverValuesNodeCount:e.serverValuesNodeCount+r.serverValuesNodeCount,serverDirtySetSubspaceCount:e.serverDirtySetSubspaceCount+r.serverDirtySetSubspaceCount,editedFormulaeNodeCount:e.editedFormulaeNodeCount+r.editedFormulaeNodeCount,editedFormatsNodeCount:e.editedFormatsNodeCount+r.editedFormatsNodeCount,editedStylesNodeCount:e.editedStylesNodeCount+r.editedStylesNodeCount,editedValuesNodeCount:e.editedValuesNodeCount+r.editedValuesNodeCount,editedDirtySetSubspaceCount:e.editedDirtySetSubspaceCount+r.editedDirtySetSubspaceCount,clientFormulaeNodeCount:e.clientFormulaeNodeCount+r.clientFormulaeNodeCount,clientFormatsNodeCount:e.clientFormatsNodeCount+r.clientFormatsNodeCount,clientValuesNodeCount:e.clientValuesNodeCount+r.clientValuesNodeCount,recalcValuesNodeCount:e.recalcValuesNodeCount+r.recalcValuesNodeCount,recalcDirtySetSubspaceCount:e.recalcDirtySetSubspaceCount+r.recalcDirtySetSubspaceCount,recalcFailuresSetSubspaceCount:e.recalcFailuresSetSubspaceCount+r.recalcFailuresSetSubspaceCount,recalcTaintSetSubspaceCount:e.recalcTaintSetSubspaceCount+r.recalcTaintSetSubspaceCount,availabilitySetSubspaceCount:e.availabilitySetSubspaceCount+r.availabilitySetSubspaceCount,availabilityHistorySize:e.availabilityHistorySize+r.availabilityHistorySize,hiddenRowsNodeCount:e.hiddenRowsNodeCount+r.hiddenRowsNodeCount,hiddenColsNodeCount:e.hiddenColsNodeCount+r.hiddenColsNodeCount}}var Ng=void 0;di.emptyUsedRange=Ng;var Cre=(0,ry.gridRange)(0,0,ry.sheetRows,ry.sheetCols);di.denseUsedRange=Cre;function _re(e,r){return e===Ng?r:r===Ng?e:(0,Eg.gridRangeJoin)(e,r)}function x9(e,r){return e===Ng||r===Ng?Ng:(0,Eg.gridRangeIsect)(e,r)}var Kw;di.CloningTarget=Kw;(function(e){e[e.Server=0]="Server",e[e.Client=1]="Client"})(Kw||(di.CloningTarget=Kw={}));var uOr=function(){function e(r,n,a,o,u,t,d,s,c,l){r===void 0&&(r=Dw),n===void 0&&(n=Bi.empty),a===void 0&&(a=Cre),o===void 0&&(o=Bi.empty),u===void 0&&(u=Bi.empty),t===void 0&&(t=Bi.empty),d===void 0&&(d=Bi.empty),s===void 0&&(s=(0,xw.makeGridRangeTable)()),c===void 0&&(c=!1),l===void 0&&(l=!1),this.oldAvailabilities={},this.availabilityHistorySize=0,this.serverContents=r,this.serverAvailability=n,this.serverUsed=a,this.hiddenRows=o,this.hiddenRowsAvailability=u,this.hiddenCols=t,this.hiddenColsAvailability=d,this.mergeCells=s,this.inFilterMode=c,this.filterModeAvailable=l,this.rollBackToServerState(0)}return e.create=function(){return new e},e.prototype.clone=function(r){r===void 0&&(r=Kw.Server);var n=new e(this.serverContents,this.serverAvailability,this.serverUsed,this.hiddenRows,this.hiddenRowsAvailability,this.hiddenCols,this.hiddenColsAvailability,this.mergeCells,this.inFilterMode,this.filterModeAvailable);return r===Kw.Client&&(n.editedContents=this.editedContents,n.clientContents=this.clientContents,n.recalcValues=this.recalcValues,n.recalcDirty=this.recalcDirty,n.recalcFailures=this.recalcFailures,n.editedTaint=this.editedTaint,n.recalcTaint=this.recalcTaint,n.editedAvailability=this.editedAvailability),n},e.prototype.advanceState=function(r,n){this.oldAvailabilities[r]=this.serverAvailability,this.availabilityHistorySize+=1,this.serverAvailability=Bi.empty,this.serverUsed=Cre,this.hiddenRows=this.hiddenRowsAvailability=Bi.empty,this.hiddenCols=this.hiddenColsAvailability=Bi.empty,this.inFilterMode=this.filterModeAvailable=!1,this.rollBackToServerState(n)},e.prototype.rollBackToServerState=function(r){this.editedContents=this.serverContents,this.editedAvailability=this.serverAvailability,this.editedUsed=this.serverUsed,this.editedTaint=Bi.empty,this.rollBackToEditedState(r)},e.prototype.rollBackToEditedState=function(r){this.setClientContents(this.editedContents,r),this.recalcValues=this.editedContents.values,this.recalcFailures=Bi.empty,this.recalcDirty=this.editedContents.dirty,this.recalcTaint=this.editedTaint},e.prototype.allServerAvailable=function(r){return this.allAvailable(r,this.serverAvailability)},e.prototype.allEditedAvailable=function(r){return this.allAvailable(r,this.editedAvailability)},e.prototype.allAvailable=function(r,n){var a=(0,pa.createCellSetFromRange)(r),o=(0,ct.intersectProduct)(a,pa.availableReadProduct),u=(0,ct.intersectProduct)(n,o),t=(0,ct.project)((0,ct.exceptProduct)(o,u),"row","col"),d=(0,ct.compareProduct)(u,o),s=d!==void 0&&d>=0;return s?!0:t},e.prototype.forEachRecalcDirty=function(r,n){return(0,pa.forEachCellInSet)((0,ct.intersectProduct)(this.recalcDirty,(0,pa.createCellSetFromRange)(r)),n)},e.prototype.hasRecalcDirty=function(r){return(0,ct.meetsProduct)(this.recalcDirty,(0,pa.createCellSetFromRange)(r))},e.prototype.hasRecalcFailure=function(r){return(0,ct.meetsProduct)(this.recalcFailures,(0,pa.createCellSetFromRange)(r))},e.prototype.hasEditedEditTaint=function(r){return(0,ct.meetsProduct)(this.editedTaint,(0,pa.createCellSetFromRange)(r))},e.prototype.hasRecalcEditTaint=function(r){return(0,ct.meetsProduct)(this.recalcTaint,(0,pa.createCellSetFromRange)(r))},e.prototype.getEditedUsedRange=function(){return this.editedUsed},e.prototype.getServerUsedRange=function(){return this.serverUsed},e.prototype.getServerAvailability=function(){return this.serverAvailability},e.prototype.getHiddenRows=function(r,n){var a=pa.bspFactory.row((0,eE.pair)(r,n)),o=(0,Bi.intersect)(this.hiddenRowsAvailability,a),u=[];(0,pa.forEachRow)(o,function(d){var s=d[0],c=d[1];return u.push((0,D9.interval)(s,c)),!0});var t=[];return(0,pa.forEachRow)((0,Bi.intersect)(this.hiddenRows,o),function(d){var s=d[0],c=d[1];return t.push((0,D9.interval)(s,c)),!0}),{hidden:t,available:u}},e.prototype.tryGetHiddenRows=function(r,n){var a=this.getHiddenRows(r,n),o=a.available.length===1&&a.available[0].start===r&&a.available[0].end===n;return o?(0,jO.success)(a.hidden):(0,jO.failure)({kind:hc.UnavailableKind.HiddenRows})},e.prototype.setHiddenRows=function(r,n){var a=pa.bspFactory.row((0,eE.pair)(r.row,r.row+r.rows));this.hiddenRows=(0,Bi.union)((0,Bi.except)(this.hiddenRows,a),(0,Bi.intersect)(n,a)),this.hiddenRowsAvailability=(0,Bi.union)(this.hiddenRowsAvailability,a)},e.prototype.getHiddenCols=function(r,n){var a=pa.bspFactory.col((0,eE.pair)(r,n)),o=(0,Bi.intersect)(this.hiddenColsAvailability,a),u=[];(0,pa.forEachCol)(o,function(d){var s=d[0],c=d[1];return u.push((0,D9.interval)(s,c)),!0});var t=[];return(0,pa.forEachCol)((0,Bi.intersect)(this.hiddenCols,o),function(d){var s=d[0],c=d[1];return t.push((0,D9.interval)(s,c)),!0}),{hidden:t,available:u}},e.prototype.tryGetHiddenCols=function(r,n){var a=this.getHiddenCols(r,n),o=a.available.length===1&&a.available[0].start===r&&a.available[0].end===n;return o?(0,jO.success)(a.hidden):(0,jO.failure)({kind:hc.UnavailableKind.HiddenCols})},e.prototype.setHiddenCols=function(r,n){var a=pa.bspFactory.col((0,eE.pair)(r.col,r.col+r.cols));this.hiddenCols=(0,Bi.union)((0,Bi.except)(this.hiddenCols,a),(0,Bi.intersect)(n,a)),this.hiddenColsAvailability=(0,Bi.union)(this.hiddenColsAvailability,a)},e.prototype.setMergeCell=function(r){this.mergeCells=this.mergeCells.setValue(r,!0)},e.prototype.getMergeCell=function(r){var n;return this.mergeCells.forEachGe(r,function(a){return n=a,!0}),n},e.prototype.isInFilterMode=function(){return this.filterModeAvailable?(0,jO.success)(this.inFilterMode):(0,jO.failure)({kind:hc.UnavailableKind.InFilterMode})},e.prototype.setInFilterMode=function(r){this.inFilterMode=r,this.filterModeAvailable=!0},e.prototype.forEachNonBlankSetCellInSet=function(r,n,a,o){var u=(0,ct.intersectProduct)(r,pa.availableSetProduct);return(0,pa.forEachRangeInSet)((0,ct.intersectProduct)(a,u),function(t){return o.formulae.forEachMeets(t,function(d,s){return Bw(s.fmla,s.compiledFmla!==void 0)?!0:(0,Eg.forEachCellInRange)((0,Eg.gridRangeIsect)(t,d),n)})})},e.prototype.forEachReadableCellInSet=function(r,n,a){var o=(0,ct.intersectProduct)(r,pa.availableReadProduct);return(0,pa.forEachRangeInSet)((0,ct.intersectProduct)(a,o),function(u){return(0,Eg.forEachCellInRange)(u,n)})},e.prototype.forEachEditedNonBlankCellInSet=function(r,n){return this.forEachNonBlankSetCellInSet(r,n,this.editedAvailability,this.editedContents)},e.prototype.forEachServerNonBlankCellInSet=function(r,n){return this.forEachNonBlankSetCellInSet(r,n,this.serverAvailability,this.serverContents)},e.prototype.forEachEditedCellInSet=function(r,n){return this.forEachReadableCellInSet(r,n,this.editedAvailability)},e.prototype.promoteServerAvailability=function(r,n){var a=(0,ct.intersectProduct)(r,pa.availableSetProduct),o=this.oldAvailabilities[n];if(o===void 0)return!1;var u=(0,ct.compareProduct)(o,a);return u!==void 0&&u>=0?(this.unionAvailability(!0,(0,ct.intersectProduct)(r,pa.availableAllProduct)),this.unionTaint(!0,Bi.empty),this.unionUsed(!0,(0,pa.cellSetBounds)(r)),!0):!1},e.prototype.extendServerUnused=function(r,n){var a=r===Ng?Bi.empty:(0,pa.createCellSetFromRange)(r),o=(0,ct.complementProduct)(a),u=this.serverContents,t=u.values,d=u.formats,s=u.styles,c=u.formulae,l=u.dirty;(0,pa.forEachRangeInSet)(o,function(m){return t.forEachLe(m,function(v,h){return qw(h.oper,h.failure)||(t=t.setValue(v,vT)),!0}),d.forEachLe(m,function(v,h){return Lw(h)||(d=d.setValue(v,$P)),!0}),s.forEachLe(m,function(v,h){return h!==hc.SpecialStyle.Blank&&(s=s.setValue(v,hc.SpecialStyle.Blank)),!0}),!0}),(0,pa.forEachRangeInSet)(o,function(m){return c=Jbe(c,m),!0}),l=(0,ct.exceptProduct)(l,o),this.setContents(!0,{values:t,formats:d,styles:s,formulae:c,dirty:l},n);var f=(0,ct.intersectProduct)(o,pa.availableReadProduct);this.serverAvailability=this.editedAvailability=(0,ct.unionProduct)(this.serverAvailability,f),this.editedTaint=this.recalcTaint=Bi.empty;var p=this.serverUsed;p=x9(p,r),this.serverUsed=this.editedUsed=p},e.prototype.setRecalcFailure=function(r){this.recalcFailures=(0,ct.unionProduct)(this.recalcFailures,r)},e.prototype.setRecalcEditTaint=function(r){this.recalcTaint=(0,ct.unionProduct)(this.recalcTaint,r)},e.prototype.setRecalcValue=function(r,n){var a=this;(0,Eg.forEachCellInRange)(r,function(o,u,t){return a.recalcValues=a.recalcValues.setValue(o,{oper:zbe(n)?n[u][t]:n,failure:void 0}),!0}),this.recalcDirty=(0,ct.exceptProduct)(this.recalcDirty,(0,pa.createCellSetFromRange)(r))},e.prototype.setClientContents=function(r,n){this.clientContents=r},e.prototype.setClientValue=function(r,n,a){var o=this.clientContents.values;(0,Eg.forEachCellInRange)(r,function(u,t,d){return o=o.setValue(u,{oper:zbe(n)?n[t][d]:n,failure:void 0}),!0}),this.setClientContents((0,Kv.__assign)((0,Kv.__assign)({},this.clientContents),{values:o}),a)},e.prototype.setClientFormula=function(r,n,a,o){var u=this.clientContents.formulae;u=Xbe(u,r),n!==void 0?u=u.setValue(n,a):(0,Eg.forEachCellInRange)(r,function(t){return u=u.setValue(t,a),!0}),this.setClientContents((0,Kv.__assign)((0,Kv.__assign)({},this.clientContents),{formulae:u}),o)},e.prototype.setClientFormat=function(r,n,a){var o=this.clientContents.formats;(0,Eg.forEachCellInRange)(r,function(u){return o=o.setValue(u,n),!0}),this.setClientContents((0,Kv.__assign)((0,Kv.__assign)({},this.clientContents),{formats:o}),a)},e.prototype.getRecalcValues=function(r){for(var n=r.row,a=r.col,o=r.rows,u=r.cols,t=new Array(o),d=0;d<o;d+=1)t[d]=(0,nOr.arrayFill)(new Array(u),vT);return this.recalcValues.forEachLe(r,function(s,c){return t[s.row-n][s.col-a]=c,!0}),t},e.prototype.forEachRecalcValue=function(r,n){return this.recalcValues.forEachMeets(r,n)},e.prototype.getClientValue=function(r){var n=this.clientContents.values.getValue(r);return n??vT},e.prototype.getServerValue=function(r){var n=this.serverContents.values.getValue(r);return n??vT},e.prototype.getEditedValue=function(r){var n=this.editedContents.values.getValue(r);return n??vT},e.prototype.forEachEditedValue=function(r,n){return this.editedContents.values.forEachMeets(r,n)},e.prototype.getServerFormula=function(r){return this.getFormula(r,this.serverContents.formulae)},e.prototype.getClientFormula=function(r){return this.getFormula(r,this.clientContents.formulae)},e.prototype.setEditedFormat=function(r,n){this.editedContents=(0,Kv.__assign)((0,Kv.__assign)({},this.editedContents),{formats:this.editedContents.formats.setValue(r,n)})},e.prototype.getEditedFormat=function(r){var n=this.editedContents.formats.getValue(r);return n??$P},e.prototype.forEachEditedFormat=function(r,n){return this.editedContents.formats.forEachMeets(r,n)},e.prototype.getServerFormat=function(r){var n=this.serverContents.formats.getValue(r);return n??$P},e.prototype.getEditedStyle=function(r){var n=this.editedContents.styles.getValue(r);return n??hc.SpecialStyle.Blank},e.prototype.getServerStyle=function(r){var n=this.serverContents.styles.getValue(r);return n??hc.SpecialStyle.Blank},e.prototype.getClientFormat=function(r){var n=this.clientContents.formats.getValue(r);return n??$P},e.prototype.getEditedFormula=function(r){return this.getFormula(r,this.editedContents.formulae)},e.prototype.forEachEditedFormula=function(r,n){return this.editedContents.formulae.forEachMeets(r,n)},e.prototype.getFormula=function(r,n){var a=void 0;return n.forEachGe(r,function(o,u){return Bw(u.fmla,u.compiledFmla!==void 0)?!0:(a=[o,u],!1)}),a},e.prototype.setContents=function(r,n,a){r&&(this.serverContents=n),this.editedContents=n,r&&this.setClientContents(this.editedContents,a),this.recalcValues=this.editedContents.values,this.recalcDirty=this.editedContents.dirty,this.recalcFailures=Bi.empty},e.prototype.unionAvailability=function(r,n){var a=r?this.serverAvailability:this.editedAvailability;a=(0,ct.unionProduct)(a,n),r&&(this.serverAvailability=a),this.editedAvailability=a},e.prototype.unionTaint=function(r,n){this.editedTaint=r?Bi.empty:(0,ct.unionProduct)(this.editedTaint,n),this.recalcTaint=this.editedTaint},e.prototype.unionUsed=function(r,n){var a=r?this.serverUsed:this.editedUsed;a=_re(a,n),r&&(this.serverUsed=a),this.editedUsed=a},e.prototype.setCellContents=function(r,n,a,o,u,t,d,s,c){this.setCommon(r,n,void 0,a,o,u,t,d,s,c)},e.prototype.setRangeFormula=function(r,n,a,o,u,t,d,s){var c=(0,pa.createCellSetFromRange)(n);this.setCommon(r,c,n,a,o,void 0,u,t,d,s)},e.prototype.setCommon=function(r,n,a,o,u,t,d,s,c,l){var f=this,p=r?this.serverContents:this.editedContents,m=p.values,v=p.formats,h=p.styles,S=p.formulae,y=p.dirty,C=o===void 0&&u!==void 0||(o==null?void 0:o.compiledFmla)!==void 0,E=o;o!==void 0&&((0,pa.forEachRangeInSet)(n,function(b){return S=Jbe(S,b),!0}),Bw(o.fmla,o.compiledFmla!==void 0)&&(E=void 0));var I=E!==void 0&&a===void 0?o:void 0,F=E!==void 0&&a!==void 0?o:void 0,w=u;u!==void 0&&qw(u,t)&&((0,pa.forEachRangeInSet)(n,function(b){return m.forEachLe(b,function(R,P){return qw(P.oper,P.failure)||(m=m.setValue(R,vT)),!0}),!0}),y=C?(0,ct.unionProduct)(y,n):(0,ct.exceptProduct)(y,n),w=void 0);var B=w!==void 0?{oper:w,failure:t}:void 0,k=d;d!==void 0&&Lw(d)&&((0,pa.forEachRangeInSet)(n,function(b){return v.forEachLe(b,function(R,P){return Lw(P)||(v=v.setValue(R,$P)),!0}),!0}),k=void 0);var x=k===hc.SpecialFormat.Weak?void 0:k,G=k===hc.SpecialFormat.Weak?k:void 0,H=s;s!==void 0&&s===hc.SpecialStyle.Blank&&((0,pa.forEachRangeInSet)(n,function(b){return h.forEachLe(b,function(R,P){return P!==hc.SpecialStyle.Blank&&(h=h.setValue(R,hc.SpecialStyle.Blank)),!0}),!0}),H=void 0);var L=H===hc.SpecialStyle.Weak?void 0:H,D=H===hc.SpecialStyle.Weak?H:void 0,U=n;if(!r){var V=(0,ct.intersectProduct)(n,pa.availableSetProduct),ne=(0,ct.project)((0,ct.intersectProduct)(this.editedAvailability,V),"row","col"),J=(0,ct.intersectProduct)(n,c!==void 0?(0,pa.createCellSetFromRange)(c):Bi.empty);U=(0,ct.unionProduct)(ne,J)}if((I!==void 0||x!==void 0||L!==void 0||B!==void 0)&&((0,pa.forEachCellInSet)(U,function(b){return I!==void 0&&(S=Ybe(S,b,I)),x!==void 0&&(v=v.setValue(b,x)),L!==void 0&&(h=h.setValue(b,L)),B!==void 0&&(m=m.setValue(b,B)),!0}),(I!==void 0||B!==void 0)&&(y=C?(0,ct.unionProduct)(y,U):(0,ct.exceptProduct)(y,U))),F!==void 0){S=Ybe(S,a,F);var $=(0,pa.createCellSetFromRange)(a);y=C?(0,ct.unionProduct)(y,$):(0,ct.exceptProduct)(y,$)}G!==void 0&&(v=Zbe(v,U,r?this.serverAvailability:this.editedAvailability,hc.SpecialFormat.Unavailable)),D!==void 0&&(h=tOr(h,U,r?this.serverAvailability:this.editedAvailability));var Z=u===void 0?Bi.empty:U,ie=o===void 0?Bi.empty:U,X=d===void 0?Bi.empty:U,Q=u===void 0&&d===void 0?Bi.empty:U;r||((0,pa.forEachRangeInSet)(Z,function(b){return f.setClientValue(b,yre,l),!0}),o!==void 0&&(a!==void 0?this.setClientFormula(a,a,o,l):(0,pa.forEachRangeInSet)(ie,function(b){return f.setClientFormula(b,void 0,o,l),!0})),d===hc.SpecialFormat.Weak?this.setClientContents((0,Kv.__assign)((0,Kv.__assign)({},this.clientContents),{formats:Zbe(this.clientContents.formats,X,this.editedAvailability,hc.SpecialFormat.ClientValueUnknown)}),l):(0,pa.forEachRangeInSet)(X,function(b){return f.setClientFormat(b,hc.SpecialFormat.ClientValueUnknown,l),!0})),this.setContents(r,{values:m,formats:v,styles:h,formulae:S,dirty:y},l),this.unionAvailability(r,(0,ct.intersectProduct)(Z,pa.availableAllProduct)),r||(this.editedAvailability=(0,ct.exceptProduct)(this.editedAvailability,(0,ct.exceptProduct)(n,U))),this.unionTaint(r,Q),this.unionUsed(r,(0,pa.cellSetBounds)(n))},e.prototype.copyRange=function(r){function n(h,S){return h.forEachLe(r,function(y,C){return S=S.setValue(y,C),!0}),S}var a=Dw.values,o=Dw.formats,u=Dw.styles,t=Dw.formulae,d=this.editedContents,s=d.values,c=d.formats,l=d.styles,f=d.formulae;a=n(s,a),o=n(c,o),u=n(l,u),f.forEachMeets(r,function(h,S){return t=t.setValue((0,Eg.gridRangeIsect)(h,r),S),!0});var p=(0,Eg.gridRangeAnchor)(r),m=(0,ct.intersectProduct)(this.editedAvailability,(0,pa.createCellSetFromRange)(r)),v=x9(this.editedUsed,r);return{origin:p,formats:o,styles:u,values:a,formulae:t,availability:m,used:v}},e.prototype.pasteRange=function(r,n,a){var o=(0,pa.createCellSetFromRange)(r),u=(0,ry.gridRange)(n.origin.row,n.origin.col,r.rows,r.cols),t=this.editedContents,d=t.values,s=t.formats,c=t.styles,l=t.formulae,f=t.dirty,p=this.editedUsed,m=r.row-n.origin.row,v=r.col-n.origin.col;function h(w){return(0,ry.gridRange)(w.row+m,w.col+v,w.rows,w.cols)}function S(w){return(0,pa.translateAvailabilitySet)(w,m,v)}function y(w,B,k){return B.forEachMeets(r,function(x,G){return B=B.setValue(x,k),!0}),w.forEachLe(u,function(x,G){return B=B.setValue(h(x),G),!0}),B}var C=_re(p,n.used!==Ng?h(n.used):Ng),E=x9(C,r);d=y(n.values,d,vT),E!==Ng&&this.setClientValue(E,yre,a),s=y(n.formats,s,$P),c=y(n.styles,c,hc.SpecialStyle.Blank),E!==Ng&&this.setClientFormat(E,hc.SpecialFormat.ClientValueUnknown,a),l=y(n.formulae,l,B9),f=(0,ct.exceptProduct)(f,o);{var I=this.clientContents.formulae;I=Xbe(I,r),l.forEachLe(r,function(w,B){var k=B.origin,x=B.compiledFmla;return x!==void 0&&(f=(0,ct.unionProduct)(f,(0,pa.createCellSetFromRange)(w))),I=I.setValue(w,{fmla:Uw.ClientValueUnknown,origin:k,compiledFmla:x,hasHyperlink:L9.ClientValueUnknown}),!0}),this.setClientContents((0,Kv.__assign)((0,Kv.__assign)({},this.clientContents),{formulae:I}),a)}var F=!1;this.setContents(F,{values:d,formats:s,styles:c,formulae:l,dirty:f},a),this.editedAvailability=(0,ct.exceptProduct)(this.editedAvailability,o),this.unionAvailability(F,S(n.availability)),this.unionTaint(F,E===Ng?Bi.empty:(0,pa.createCellSetFromRange)(E)),this.unionUsed(F,C)},e.prototype.assumeRecalcFinal=function(r,n){this.recalcDirty=(0,ct.exceptProduct)(this.recalcDirty,r)},e.prototype.getDirtyEditedCells=function(){return(0,ct.intersectProduct)(this.recalcDirty,this.editedTaint)},e.prototype.getNonDirtyEditedCells=function(){return(0,ct.exceptProduct)(this.editedTaint,this.recalcDirty)},e.prototype.getDirtyDependentCells=function(){return(0,ct.exceptProduct)(this.recalcDirty,this.editedTaint)},e.prototype.onCellModified=function(r,n){var a=r?this.serverContents:this.editedContents;this.setContents(r,a,n),this.unionAvailability(r,Bi.empty),this.unionTaint(r,Bi.empty),this.unionUsed(r,Ng)},e.prototype.clearCompiledFormulas=function(){for(var r=0,n=[this.serverContents.formulae,this.editedContents.formulae];r<n.length;r++){var a=n[r];a.forEach(function(o,u){return u.compiledFmla!==void 0&&u.compiledFmla.reset(),!0})}},e.prototype.getStatistics=function(){return{serverFormulaeNodeCount:this.serverContents.formulae.getCount(),serverFormatsNodeCount:this.serverContents.formats.getCount(),serverStylesNodeCount:this.serverContents.styles.getCount(),serverValuesNodeCount:this.serverContents.values.getCount(),serverDirtySetSubspaceCount:(0,ct.getSubspaceCount)(this.serverContents.dirty),editedFormulaeNodeCount:this.editedContents.formulae.getCount(),editedFormatsNodeCount:this.editedContents.formats.getCount(),editedStylesNodeCount:this.editedContents.styles.getCount(),editedValuesNodeCount:this.editedContents.values.getCount(),editedDirtySetSubspaceCount:(0,ct.getSubspaceCount)(this.editedContents.dirty),clientFormulaeNodeCount:this.clientContents.formulae.getCount(),clientFormatsNodeCount:this.clientContents.formats.getCount(),clientValuesNodeCount:this.clientContents.values.getCount(),recalcValuesNodeCount:this.recalcValues.getCount(),recalcDirtySetSubspaceCount:(0,ct.getSubspaceCount)(this.recalcDirty),recalcFailuresSetSubspaceCount:(0,ct.getSubspaceCount)(this.recalcFailures),recalcTaintSetSubspaceCount:(0,ct.getSubspaceCount)(this.recalcTaint),availabilityHistorySize:this.availabilityHistorySize,availabilitySetSubspaceCount:(0,ct.getSubspaceCount)(this.editedAvailability),hiddenRowsNodeCount:(0,Bi.getNodeCount)(this.hiddenRows)+(0,Bi.getNodeCount)(this.hiddenRowsAvailability),hiddenColsNodeCount:(0,Bi.getNodeCount)(this.hiddenCols)+(0,Bi.getNodeCount)(this.hiddenColsAvailability)}},e.prototype.collectGarbage=function(r,n){var a=Bi.empty;for(var o in this.oldAvailabilities)if(this.oldAvailabilities.hasOwnProperty(o)){var u=Number(o);if(u>=r){a=(0,ct.unionProduct)(a,this.oldAvailabilities[u]);continue}delete this.oldAvailabilities[u],this.availabilityHistorySize-=1}function t(p){return(0,ct.meetsProduct)((0,ct.intersectProduct)((0,pa.createCellSetFromRange)(p),pa.availableSetProduct),a)}function d(p,m){return!Bw(m.fmla,m.compiledFmla!==void 0)&&t(p)}function s(p,m){return!Lw(m)&&t(p)}function c(p,m){return m!==hc.SpecialStyle.Blank&&t(p)}function l(p,m){return!(!rPe(m.oper)&&qw(m.oper,m.failure))&&t(p)}var f=(0,ct.project)(a,"row","col");this.serverContents={formulae:this.serverContents.formulae.filter(d),formats:this.serverContents.formats.filter(s),styles:this.serverContents.styles.filter(c),values:this.serverContents.values.filter(l),dirty:(0,ct.intersectProduct)(this.serverContents.dirty,f)},this.editedContents={formulae:this.editedContents.formulae.filter(d),formats:this.editedContents.formats.filter(s),styles:this.editedContents.styles.filter(c),values:this.editedContents.values.filter(l),dirty:(0,ct.intersectProduct)(this.editedContents.dirty,f)},this.setClientContents({formulae:this.clientContents.formulae.filter(d),formats:this.clientContents.formats.filter(s),values:this.clientContents.values.filter(l)},n),this.recalcValues=this.recalcValues.filter(l),this.recalcDirty=(0,ct.intersectProduct)(this.recalcDirty,f)},e}();di.PartialWorkbookGrid=uOr});var YO=Y(Vr=>{_();Object.defineProperty(Vr,"__esModule",{value:!0});Vr.allChecker=zO;Vr.arrayChecker=r0;Vr.chWorksheetFunctionName=Vr.chWorkbookProps=Vr.chUnusedCellsUpdate=Vr.chString=Vr.chSheetRangeLocation=Vr.chSheetName=Vr.chSheetId=Vr.chSheetCellLocation=Vr.chRow=Vr.chReadOper=Vr.chRangeUpdate=Vr.chRangeLocation=Vr.chRangeFormulaEdit=Vr.chRangeFormatEdit=Vr.chPossiblyInfiniteNumber=Vr.chPasteEdit=Vr.chNumberFormat=Vr.chNonemptyString=Vr.chNever=Vr.chNatural=Vr.chNamedValueData=Vr.chNamedValue=Vr.chNamedTableScope=Vr.chNamedTableData=Vr.chNamedRangeData=Vr.chNamedObjectsUpdate=Vr.chNamedObjectData=Vr.chNamedObject=Vr.chNamedFormulaData=Vr.chNamedFailureData=Vr.chLocaleData=Vr.chInteger=Vr.chFormulaText=Vr.chFiniteNumber=Vr.chEvalFormulaFormat=Vr.chErrorTypeName=Vr.chError=Vr.chColumnData=Vr.chCol=Vr.chCellValue=Vr.chCellLocation=Vr.chCellFormat=Vr.chCellData=Vr.chBoolean=Vr.chBlank=Vr.chArrayUpdate=Vr.chArrayFormulaEdit=Vr.chArrayData=Vr.chArray=void 0;Vr.check=Rre;Vr.checker=ku;Vr.depAllChecker=pp;Vr.eqChecker=t_;Vr.filterCheck=dOr;Vr.fromChecker=fOr;Vr.incrementStat=iPe;Vr.intChecker=Vv;Vr.isFormulaText=bre;Vr.objectChecker=li;Vr.oneOfChecker=nE;Vr.optChecker=Za;Vr.taggedUnionChecker=hT;Vr.typeofChecker=U9;var Wv=ft(),rE=pv(),Vw=gs(),fS=H3(),q9=tu(),sOr=Qu(),lOr=ig(),cOr=Q3(),n_;function iPe(e,r){var n;e[r]=((n=e[r])!==null&&n!==void 0?n:0)+1}function QO(e,r,n){return e.push("".concat(r.join("."),": expected ").concat(n)),!1}function ku(e,r){return function(n,a,o){return(0,Wv.isDefined)(n)&&e(n)||QO(a,o,r)}}function Rre(e,r,n,a){for(var o=[],u=r(e,o,[a]),t=0,d=o;t<d.length;t++){var s=d[t];iPe(n,s)}return u}function dOr(e,r,n,a){if(!Rre(e,Ww,n,a))return[];var o="".concat(a,".<index>");return e.filter(function(u){return Rre(u,r,n,o)})}function Za(e){return function(r,n,a){return(0,Wv.isNone)(r)?!0:e(r,n,a)}}function fOr(e){return function(r,n,a){return e(r,n,a)}}function li(e){return function(r,n,a){if((0,Wv.isNone)(r))return QO(n,a,"non-null object");var o=a.length;try{var u=!0;for(var t in e)a[o]=t,u=u&&e[t](r[t],n,a);return u}finally{a.length=o}}}function zO(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return function(n,a,o){return e.reduce(function(u,t){return u&&t(n,a,o)},!0)}}function pp(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return function(a,o,u){return r.reduce(function(t,d){return t&&d(a)(a,o,u)},e(a,o,u))}}function r0(e){return function(r,n,a){if(!Array.isArray(r))return QO(n,a,"Array");a.push("<index>");try{return r.reduce(function(o,u){return o&&e(u,n,a)},!0)}finally{a.pop()}}}function hT(e){var r="one of ".concat(JSON.stringify(Object.getOwnPropertyNames(e).sort()));return function(n,a,o){if((0,Wv.isNone)(n))return QO(a,o,"non-null object");var u=o.length;try{var t=typeof n.kind=="string"||typeof n.kind=="number"?e[n.kind]:void 0;return(0,Wv.isNone)(t)?(o.push("kind"),QO(a,o,r)):t(n,a,o)}finally{o.length=u}}}function U9(e){var r="typeof one of ".concat(JSON.stringify(Object.getOwnPropertyNames(e).sort()));return function(n,a,o){var u=e[typeof n];return(0,Wv.isNone)(u)?QO(a,o,r):u(n,a,o)}}function Tre(e){return typeof e=="number"&&e>-(1/0)&&e<1/0}function pOr(e){return typeof e=="number"&&!isNaN(e)}function oPe(e){return(e|0)===e||Math.floor(e)===e}function Vv(e,r,n){return n===void 0&&(n=e!==0?"integer >= ".concat(e," and < ").concat(r):"natural < ".concat(r)),ku(function(a){return typeof a=="number"&&a>=e&&a<r&&oPe(a)},n)}var Em=ku(function(e){return!1},"never");Vr.chNever=Em;var mOr=ku(pOr,"number (non-NaN)");Vr.chPossiblyInfiniteNumber=mOr;var HO=ku(Tre,"finite number");Vr.chFiniteNumber=HO;var jw=ku(function(e){return Tre(e)&&oPe(e)},"integer");Vr.chInteger=jw;var Nm=Vv(0,1/0,"natural");Vr.chNatural=Nm;var $s=ku(function(e){return typeof e=="string"},"string");Vr.chString=$s;var Lc=ku(function(e){return typeof e=="string"&&e.length>0},"nonempty string");Vr.chNonemptyString=Lc;var hd=ku(function(e){return typeof e=="boolean"},"boolean");Vr.chBoolean=hd;var Ww=ku(function(e){return Array.isArray(e)},"Array");Vr.chArray=Ww;function t_(e){return ku(function(r){return r===e},JSON.stringify(e))}function nE(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];for(var n=Object.create(null),a=Object.create(null),o=0,u=e;o<u.length;o++){var t=u[o];typeof t=="number"?a[t]=!0:n[t]=!0}var d="one of ".concat(JSON.stringify(e.slice().sort()));return ku(function(s){switch(typeof s){case"string":case"symbol":return n[s]===!0;case"number":return a[s]===!0}return!1},d)}function bre(e){return e[0]==="="||e[0]==="+"||e[0]==="-"}var Hw=ku(function(e){return typeof e=="string"&&bre(e)},"formula text");Vr.chFormulaText=Hw;var gOr=li({functionId:Nm,functionName:Lc});Vr.chWorksheetFunctionName=gOr;var vOr=ku(function(e){return typeof e=="string"&&e.length>1&&(0,lOr.stringStartsWith)(e,"#")},"error name"),hOr=li({errorType:Nm,errorName:vOr});Vr.chErrorTypeName=hOr;var SOr=li({iformat:Nm,formatString:$s,builtIn:hd});Vr.chNumberFormat=SOr;var Qw=ku(function(e){return typeof e=="string"||Tre(e)},"string or finite number");Vr.chSheetId=Qw;var yOr=li({sheetId:Qw,sheetName:$s});Vr.chSheetName=yOr;var G9=Vv(0,Vw.sheetRows);Vr.chRow=G9;var K9=Vv(0,Vw.sheetCols);Vr.chCol=K9;var zw=li({row:G9,column:K9});Vr.chCellLocation=zw;var COr=ku(function(e){return e.lastRow==null||e.lastRow>=e.row},"lastRow >= row"),_Or=ku(function(e){return e.lastColumn==null||e.lastColumn>=e.column},"lastColumn >= column"),ROr=zO(zw,li({lastRow:Za(G9),lastColumn:Za(K9)})),Pre=pp(ROr,function(e){return COr},function(e){return _Or});Vr.chRangeLocation=Pre;var Ag=zO(Pre,li({sheetId:Qw}));Vr.chSheetRangeLocation=Ag;var uPe=zO(Ag,li({lastRow:Za(Em),lastColumn:Za(Em)}));Vr.chSheetCellLocation=uPe;var sPe=li({kind:t_("Blank")});Vr.chBlank=sPe;var Ere=li({kind:t_("Error"),type:Nm});Vr.chError=Ere;var Nre=U9({number:HO,string:$s,boolean:hd,object:hT({Blank:sPe,Error:Ere})});Vr.chCellValue=Nre;var lPe=U9({number:Nm,string:$s});Vr.chCellFormat=lPe;var cPe=zO(li({value:Nre,iformat:Nm,failureReason:Za($s)}),hT({CellFormula:li({formulaBarText:Hw}),ArrayFormula:li({formulaBarText:Za(Em)}),Value:li({formulaBarText:$s})}));Vr.chCellData=cPe;var TOr=li({range:Ag,excludeRows:Za(r0(G9)),excludeColumns:Za(r0(K9)),data:Za(cPe),fromStateId:Za(jw)});Vr.chRangeUpdate=TOr;var dPe=li({isSpilled:hd,formulaBarText:Hw});Vr.chArrayData=dPe;var bOr=li({range:Ag,data:Za(dPe),fromStateId:Za(jw)});Vr.chArrayUpdate=bOr;var POr=li({sheetId:Qw,usedRange:Za(Pre)});Vr.chUnusedCellsUpdate=POr;var fPe=U9({number:HO,string:$s,boolean:hd,object:hT({Error:Ere})});Vr.chNamedValue=fPe;var pPe=li({kind:t_("NamedValue"),value:fPe});Vr.chNamedValueData=pPe;var mPe=li({kind:t_("NamedFormula"),formulaBarText:Hw});Vr.chNamedFormulaData=mPe;var gPe=li({kind:t_("NamedRange"),range:Ag});Vr.chNamedRangeData=gPe;var vPe=li({column:Nm,name:Lc});Vr.chColumnData=vPe;var hPe=function(r){var n;return((n=r.lastRow)!==null&&n!==void 0?n:r.row)-r.row+1},SPe=function(r){var n;return((n=r.lastColumn)!==null&&n!==void 0?n:r.column)-r.column+1},EOr=ku(function(e){return(!e.hasHeadersRow||e.range.row>0)&&(!e.hasTotalsRow||e.range.row+hPe(e.range)<Vw.sheetRows)},"enough rows for headers and totals"),NOr=ku(function(e){var r=e.range.column,n=e.range.column+SPe(e.range);return e.columns.every(function(a){return a.column>=r&&a.column<n})},"column names in range"),yPe=pp(li({kind:t_("NamedTable"),range:Ag,hasHeadersRow:hd,hasTotalsRow:hd,columns:r0(vPe)}),function(e){return EOr},function(e){return NOr});Vr.chNamedTableData=yPe;var CPe=function(r){return ku(function(n){var a;return((a=n.data)===null||a===void 0?void 0:a.kind)!=="NamedTable"||r==null},"NamedTable at global scope")};Vr.chNamedTableScope=CPe;var _Pe=li({kind:t_("NamedFailure"),failureReason:$s,objectKind:Za(nE("NamedValue","NamedFormula","NamedRange","NamedTable"))});Vr.chNamedFailureData=_Pe;var RPe=hT({NamedValue:pPe,NamedFormula:mPe,NamedRange:gPe,NamedTable:yPe,NamedFailure:_Pe});Vr.chNamedObjectData=RPe;var AOr=li({name:$s,data:Za(RPe)}),OOr=function(r){return pp(AOr,function(n){return CPe(r)})};Vr.chNamedObject=OOr;var kOr=li({scope:Za(Qw),objects:Za(Ww),fromStateId:Za(jw)});Vr.chNamedObjectsUpdate=kOr;var FOr=ku(function(e){return e.length>0},"a non-empty array"),IOr=ku(function(e){return e.every(function(r){return r.sheetId===e[0].sheetId})},"ranges on the same sheet"),TPe=pp(r0(Ag),function(e){return FOr},function(e){return IOr}),MOr=zO(li({range:TPe,origin:Za(zw),viewport:Za(Ag)}),hT({CellFormula:li({formulaBarText:Hw,value:Za(Em)}),Value:li({formulaBarText:$s,value:Nre}),Inferred:li({formulaBarText:$s,value:Za(Em)})}));Vr.chRangeFormulaEdit=MOr;var wOr=hT({SetFormat:li({format:lPe}),RibbonFormat:li({ribbon:nE.apply(void 0,(0,Wv.strEnumArray)(cOr.RibbonFormat))}),ChangeDecimals:li({changeDecimals:Vv(-20,20)})}),DOr=li({range:TPe,operation:wOr,origin:Za(zw),viewport:Za(Ag)});Vr.chRangeFormatEdit=DOr;var xOr=li({range:Ag,formulaBarText:ku(function(e){return typeof e=="string"&&(e.length===0||bre(e))},"empty string or text denoting formula"),origin:Za(zw),viewport:Za(Ag)});Vr.chArrayFormulaEdit=xOr;var LOr=ku(function(e){var r=SPe(e.source),n=hPe(e.source);return e.target.column+r<=Vw.sheetCols&&e.target.row+n<=Vw.sheetRows},"(target,source) in range"),BOr=pp(li({kind:nE("CopyPaste"),target:uPe,source:Ag,viewport:Za(Ag)}),function(e){return LOr});Vr.chPasteEdit=BOr;var qOr=ku(function(e){return e.length===2},"2 AM/PM symbols"),nPe=ku(function(e){return e.length===7},"7 day symbols"),tPe=ku(function(e){return e.length===12},"12 month symbols");function Yw(e){var r=(0,Wv.numEnumMap)(e,Wv.identity);return ku(function(n){return n.every(function(a,o){return a==null||o in r})},"indexes in enum")}var UOr=Yw(sOr.SpecialRefId),GOr=Yw(q9.PictureSpecial),KOr=Yw(q9.PictureSingle),VOr=Yw(q9.PictureColor),WOr=Yw(q9.PictureDbnum),jOr=li({worksheetFunctionNames:Ww,thousandsData:r0(Nm),errorTypeNames:Ww,specialRefNames:pp(r0(Za(Lc)),function(e){return UOr}),trueName:Lc,falseName:Lc,rowLetter:Lc,columnLetter:Lc,leftBrace:Lc,rightBrace:Lc,leftBracket:Lc,rightBracket:Lc,decimalSeparator:Lc,listSeparator:Lc,columnSeparator:Lc,rowSeparator:Lc,thousandsSeparator:$s,lcid:Nm,country:Nm,numberDecimals:Nm,isExpSepBySpace:hd,fractionSeparator:Lc,isPercentSepBySpace:hd,currencyFormat:nE(fS.CurrencyFormat.Paren,fS.CurrencyFormat.Lead,fS.CurrencyFormat.Intern,fS.CurrencyFormat.Trail),isCurrencySymbolLead:hd,isCurrencySepBySpace:hd,currencySymbol:$s,currencyDecimals:Nm,dateOrder:nE(fS.DateOrder.MDY,fS.DateOrder.DMY,fS.DateOrder.YMD,fS.DateOrder.MYD,fS.DateOrder.DYM,fS.DateOrder.YDM),dateSeparator:$s,dateAltSeparator:$s,year4Digits:hd,month2Digits:hd,day2Digits:hd,longDateFormat:hd,timeSeparator:$s,timeAltSeparator:Za($s),hour2Digits:hd,clock24Hour:hd,isAMPMSepBySpace:hd,ampmSymbols:pp(r0($s),function(e){return qOr}),dayNameShort:pp(r0($s),function(e){return nPe}),dayNameLong:pp(r0($s),function(e){return nPe}),monthNameShort:pp(r0($s),function(e){return tPe}),monthNameLong:pp(r0($s),function(e){return tPe}),pictureSpecial:pp(r0(Za(Lc)),function(e){return GOr}),pictureSingle:pp(r0(Za(Lc)),function(e){return KOr}),pictureColor:pp(r0(Za(Lc)),function(e){return VOr}),pictureDbnum:pp(r0(Za(Lc)),function(e){return WOr}),sysDateFormat:$s,sysTimeFormat:$s});Vr.chLocaleData=jOr;var aPe=li({yr:jw,mon:Vv(1,13),dom:Vv(1,6),wdy:Vv(1,8),hour:Vv(0,24),min:Vv(0,60),sec:Vv(0,60),fracSec:t_(0),rounding:Vv(0,4)}),HOr=pp(li({bias:HO,standardDate:Za(aPe),standardBias:HO,daylightDate:Za(aPe),daylightBias:HO}),function(e){return ku(function(r){return(0,Wv.isNone)(r.standardDate)===(0,Wv.isNone)(r.daylightDate)},"standardDate iff daylightDate")}),QOr=li({date1904:Za(hd),dateCompatibility:Za(hd),timezone:Za(HOr)});Vr.chWorkbookProps=QOr;var zOr=Za(hT({Origin:li({iformat:Za(Em),knownFormat:Za(Em)}),Iformat:li({iformat:Nm,knownFormat:Za(Em)}),Known:li({iformat:Za(Em),knownFormat:nE.apply(void 0,(0,Wv.numEnumArray)(fS.KnownFormat))}),Inferred:li({iformat:Za(Em),knownFormat:Za(Em)}),Aggregate:li({iformat:Za(Em),knownFormat:Za(Em)})}));Vr.chEvalFormulaFormat=zOr;var YOr=(n_={},n_[rE.OperKind.Number]=!0,n_[rE.OperKind.String]=!0,n_[rE.OperKind.Boolean]=!0,n_[rE.OperKind.Error]=!0,n_[rE.OperKind.Array]=!1,n_[rE.OperKind.Blank]=!0,n_[rE.OperKind.Rich]=!1,n_),JOr=ku(function(e){return YOr[e.kind]},"supported ReadOper");Vr.chReadOper=JOr});var Are=Y(jv=>{_();Object.defineProperty(jv,"__esModule",{value:!0});jv.floorToPowerOf2=jv.enumerateKeysInOrder=jv.enumerateInOrder=jv.RootPointer=jv.ArrayMapTree=void 0;var Jw=Cn(),XOr=Jw.arrayMapTree.floorToPowerOf2;jv.floorToPowerOf2=XOr;var ZOr=Jw.arrayMapTree.ArrayMapTree;jv.ArrayMapTree=ZOr;var $Or=Jw.arrayMapTree.RootPointer;jv.RootPointer=$Or;var ekr=Jw.arrayMapTree.enumerateInOrder;jv.enumerateInOrder=ekr;var rkr=Jw.arrayMapTree.enumerateKeysInOrder;jv.enumerateKeysInOrder=rkr});var cu=Y(i_=>{_();Object.defineProperty(i_,"__esModule",{value:!0});i_.VolatileMode=i_.ResettableLazy=void 0;i_.asyncLazy=nkr;i_.getTimeImpl=akr;var V9=Ai(),Xw=Di(),Ore=vd(),a_=rq(),kre=Ll(),JO=zu(),bPe=function(){function e(r){this.valueCreationFunc=r,this.value=void 0}return e.prototype.getValue=function(){return this.value===void 0&&(this.value=this.valueCreationFunc()),this.value},e.prototype.reset=function(){this.value=void 0},e}();i_.ResettableLazy=bPe;function nkr(e){return new bPe(e)}var ST;i_.VolatileMode=ST;(function(e){e.GroundTruth="GroundTruth",e.Estimation="Estimation",e.PrecisionTest="PrecisionTest"})(ST||(i_.VolatileMode=ST={}));var tkr=function(){return new Date};function akr(e,r,n,a,o){switch(a===void 0&&(a=ST.Estimation),o===void 0&&(o=tkr),a){case ST.PrecisionTest:return(0,Xw.failure)((0,JO.unavailable)([{kind:Ore.UnavailableKind.GetTimeKind,getTimeKind:n}]));case ST.Estimation:switch(n){case kre.GetTimeKind.NonVolatile:return(0,Xw.failure)((0,JO.unavailable)([{kind:Ore.UnavailableKind.GetTimeKind,getTimeKind:n}]));case kre.GetTimeKind.ValueCell:case kre.GetTimeKind.Volatile:break}break;case ST.GroundTruth:break}var u=e.mathpack,t=e.datepack,d=o(),s=t.utcToLocal(e,(0,a_.dateTime)(d.getUTCFullYear(),d.getUTCMonth()+1,d.getUTCDate(),d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCDay()+1,d.getUTCMilliseconds(),a_.Rounding.Round1000ths),e.timezone);(0,V9.assertTrue)("calc.calc.PartialWorkbookDocumentCollection: to local",s!==!1);var c=s.yr,l=s.rounding,f=1,p=s.mon,m=s.dom,v=s.hour,h=s.min,S=s.sec,y=s.fracSec;r<a_.TimeGranularity.Instant&&(y=0,S=0,h=0,v=0),r<a_.TimeGranularity.Day&&(m=1,p=1);var C=(0,a_.dateTime)(c,p,m,v,h,S,f,y,l),E=t.toNum(e,C);(0,V9.assertTrue)("calc.calc.PartialWorkbookDocumentCollection: toNum",!(0,JO.isErrorOper)(E));var I=u.toNumber(E);if(a===ST.GroundTruth)return(0,Xw.success)(E);var F=t.toNum(e,s);(0,V9.assertTrue)("calc.calc.PartialWorkbookDocumentCollection: toNum",!(0,JO.isErrorOper)(F));var w=u.toNumber(F),B;switch(r){case a_.TimeGranularity.Instant:B=w;break;case a_.TimeGranularity.Day:B=I+1;break;case a_.TimeGranularity.Year:{var k=(0,a_.dateTime)(c+1,p,m,v,h,S,f,y,l),x=t.toNum(e,k);(0,V9.assertTrue)("calc.calc.PartialWorkbookDocumentCollection: toNum",!(0,JO.isErrorOper)(x)),B=u.toNumber(x);break}}var G=.006944444444444444;return w<I+G||w>B-G?(0,Xw.failure)((0,JO.unavailable)([{kind:Ore.UnavailableKind.TimeGranularity,granularity:r}])):(0,Xw.success)(E)}});var j9=Y(W9=>{_();Object.defineProperty(W9,"__esModule",{value:!0});W9.RedBlackMapTree=void 0;var ikr=Cn(),okr=ikr.rbMapTree.RedBlackMapTree;W9.RedBlackMapTree=okr});var $w=Y(Ff=>{_();Object.defineProperty(Ff,"__esModule",{value:!0});Ff.emptyNameStatistics=Ff.PartialWorkbookNames=void 0;Ff.isNamedTableRangeEqual=Rkr;Ff.mergeNameStatistics=_kr;Ff.mergeNamedTables=gkr;Ff.namedRange=Ff.namedFormula=Ff.namedFailure=void 0;Ff.namedTable=mkr;Ff.namedValue=void 0;var H9=br(),ukr=Are(),ny=gs(),Q9=ft(),skr=cu(),Fre=j9(),Og=Di(),yT=Qu(),Zw=zu(),lkr=Ai(),PPe=gT(),ckr=vd(),dkr=(0,Q9.typedInstanceCreator)()(function(e){return{kind:"NamedValue",value:e}});Ff.namedValue=dkr;var fkr=(0,Q9.typedInstanceCreator)()(function(e){return{kind:"NamedRange",value:e}});Ff.namedRange=fkr;var pkr=Fre.RedBlackMapTree.create(function(e,r){return e-r});function mkr(e,r,n,a,o){var u,t=e.sheet,d=e.range,s=r?(0,ny.gridRange)(d.row-1,d.col,1,d.cols):void 0,c=n?(0,ny.gridRange)(d.row+d.rows,d.col,1,d.cols):void 0,l=(0,Zw.gridRangeJoinOpt)((0,Zw.gridRangeJoinOpt)(s,e.range),c),f=a.reduce(function(v,h){return(0,lkr.assertTrue)("calc.calc.namedTable: column names in range",h.column>=e.range.col&&h.column<e.range.col+e.range.cols),v.setValue(h.column,h.name)},pkr),p=Fre.RedBlackMapTree.create(o);f.forEach(function(v,h){return p=p.setValue(h,v),!0});var m=f.getCount()===e.range.cols;return{kind:"NamedTable",specialRefRanges:(u={},u[yT.SpecialRefId.Data]=e,u[yT.SpecialRefId.Headers]=s?(0,ny.sheetGridRange)(t,s):void 0,u[yT.SpecialRefId.Totals]=c?(0,ny.sheetGridRange)(t,c):void 0,u[yT.SpecialRefId.All]=(0,ny.sheetGridRange)(t,l),u),columnNames:p,columnIndexes:f,allColumnNamesAvailable:m,hasHeadersRow:r,hasTotalsRow:n}}function gkr(e,r){var n=e.columnNames,a=e.columnIndexes;r.columnIndexes.forEach(function(u,t){var d=e.columnIndexes.getValue(u);return d!==void 0&&(n=n.remove(d)),!0}),r.columnIndexes.forEach(function(u,t){return n=n.setValue(t,u),a=a.setValue(u,t),!0});var o=a.getCount()===r.specialRefRanges[yT.SpecialRefId.All].range.cols;return(0,H9.__assign)((0,H9.__assign)({},r),{columnNames:n,columnIndexes:a,allColumnNamesAvailable:o})}var vkr=(0,Q9.typedInstanceCreator)()(function(e){return{kind:"NamedFormula",fmla:e}});Ff.namedFormula=vkr;var hkr=(0,Q9.typedInstanceCreator)()(function(e,r){return{kind:"NamedFailure",failureReason:e,objectKind:r}});Ff.namedFailure=hkr;var Skr=(0,PPe.makeGridRangeTable)(),ykr=(0,PPe.makeGridRangeTable)(),Ckr={namesCount:0,tablesCount:0,rangesCount:0,recalcFailuresCount:0,scopes:0,allAvailableScopes:0};Ff.emptyNameStatistics=Ckr;function _kr(e,r){return{namesCount:e.namesCount+r.namesCount,tablesCount:e.tablesCount+r.tablesCount,rangesCount:e.rangesCount+r.rangesCount,recalcFailuresCount:e.recalcFailuresCount+r.recalcFailuresCount,scopes:e.scopes+r.scopes,allAvailableScopes:e.allAvailableScopes+r.allAvailableScopes}}function Rkr(e,r){return(0,Zw.isSheetGridRangeEqual)(e.specialRefRanges[yT.SpecialRefId.Data],r.specialRefRanges[yT.SpecialRefId.Data])&&e.hasHeadersRow===r.hasHeadersRow&&e.hasTotalsRow===r.hasTotalsRow}var Tkr=function(){function e(r,n,a,o){this.names=r,this.allAvailable=n,this.tables=a,this.ranges=o}return e.create=function(r){return new e(Fre.RedBlackMapTree.create(r),!1,Skr,ykr)},e.prototype.update=function(r,n,a,o){return r!==this.names||n!==this.allAvailable||a!==this.tables||o!==this.ranges?new e(r,n,a,o):this},e.prototype.getEntry=function(r,n,a){var o=this.names.getEntry(n);return o===void 0?this.allAvailable?(0,Og.success)(void 0):(0,Og.failure)((0,Zw.unavailable)([{kind:ckr.UnavailableKind.NameLoc,name:(0,ny.nameLoc)(r,n),source:a}])):(0,Og.success)(o.value!==!1?o:void 0)},e.prototype.getEntryIfDefined=function(r){var n=this.names.getEntry(r);if(n!==void 0)return n.value!==!1?n:void 0},e.prototype.setValue=function(r,n){return this.update(this.names.setValue(r,n),this.allAvailable,this.tables,this.ranges)},e.prototype.remove=function(r){return this.update(this.allAvailable?this.names.remove(r):this.names.setValue(r,!1),this.allAvailable,this.tables,this.ranges)},e.prototype.getContainingTable=function(r){var n;return this.tables.forEachGe(r,function(a,o){return n=o,!1}),n},e.prototype.getIntersectingTables=function(r){var n=[];return this.tables.forEachMeets(r,function(a,o){return n.push(o),!0}),n},e.prototype.getNamedRanges=function(r){var n;return(n=this.ranges.getValue(r))!==null&&n!==void 0?n:[]},e.prototype.getAvailableNames=function(r){var n=[];return this.names.forEach(function(a,o){return o!==!1&&n.push((0,ny.nameLoc)(r,a)),!0}),n},e.prototype.forEachAvailableName=function(r){return this.names.forEach(function(n,a){return r(n,a===!1?void 0:a)})},e.prototype.setUndefined=function(){return this.update(this.names,!0,this.tables,this.ranges)},e.prototype.getStatistics=function(r){return{namesCount:this.names.getCount(),tablesCount:this.tables.getCount(),rangesCount:this.ranges.getCount(),recalcFailuresCount:r,scopes:1,allAvailableScopes:this.allAvailable?1:0}},e.prototype.collectGarbage=function(){return this.update(this.allAvailable?this.names.filter(function(r,n){return n!==!1}):this.names,this.allAvailable,this.tables,this.ranges)},e.prototype.resetLazyData=function(){this.names.forEach(function(r,n){return n!==!1&&n.lazyData.reset(),!0})},e.prototype.onWriteNamedTable=function(r,n,a){var o=n.specialRefRanges[yT.SpecialRefId.All].range;return this.update(this.names,this.allAvailable,a==="remove"?this.tables.remove(o):this.tables.setValue(o,r),this.ranges)},e.prototype.onWriteNamedRange=function(r,n,a){var o,u=n.value.ranges[0],t=(o=this.ranges.getValue(u))!==null&&o!==void 0?o:[],d=a==="remove"?t.filter(function(s){return(0,Zw.isNameScopeEqual)(r.scope,s.scope)&&r.name===s.name}):(0,H9.__spreadArray)((0,H9.__spreadArray)([],t,!0),[r],!1);return this.update(this.names,this.allAvailable,this.tables,d.length===0?this.ranges.remove(u):this.ranges.setValue(u,d))},e}(),bkr=function(){function e(r,n){this.stringCompareCI=r,this.scope=n,this.isCurrent=!1,this.isChanged=!1,this.oldContents=this.contents=this.emptyContents=Tkr.create(r),this.emptyRecalcFailures=this.recalcFailures=ukr.ArrayMapTree.create(r)}return e.prototype.clone=function(){var r=new e(this.stringCompareCI,this.scope);return r.contents=this.contents,r},e.prototype.advanceState=function(r){this.oldContents=this.contents,this.oldStateId=this.isCurrent?r:void 0,this.contents=this.emptyContents,this.isCurrent=this.isChanged=!1,this.recalcFailures=this.emptyRecalcFailures},e.prototype.getStatistics=function(){return this.contents.getStatistics(this.recalcFailures.getCount())},e.prototype.collectGarbage=function(r){this.oldStateId===void 0||this.oldStateId<r?(this.oldContents=this.emptyContents,this.oldStateId=void 0):this.oldContents=this.oldContents.collectGarbage(),this.contents=this.contents.collectGarbage()},e.prototype.getNameLoc=function(r,n){var a=this.contents.getEntry(this.scope,r,n);return(0,Og.isSuccess)(a)?(0,Og.success)(a.value!==void 0?(0,ny.nameLoc)(this.scope,a.value.key):void 0):a},e.prototype.getNameFormula=function(r,n){var a=this.contents.getEntry(this.scope,r,n);return(0,Og.isSuccess)(a)?(0,Og.success)(a.value!==void 0?a.value.value:void 0):a},e.prototype.getContainingTable=function(r){return this.contents.getContainingTable(r)},e.prototype.getIntersectingTables=function(r){return this.contents.getIntersectingTables(r)},e.prototype.getNamedRanges=function(r){return this.contents.getNamedRanges(r)},e.prototype.allAvailable=function(){return this.contents.allAvailable},e.prototype.getAvailableNames=function(r){return this.contents.getAvailableNames(r)},e.prototype.hasRecalcFailure=function(r){return this.recalcFailures.contains(r)},e.prototype.setRecalcFailure=function(r){this.recalcFailures=this.recalcFailures.setValue(r,!0)},e.prototype.onCellModified=function(r){this.recalcFailures=this.emptyRecalcFailures},e.prototype.resetLazyData=function(){this.contents.resetLazyData(),this.oldContents!==this.contents&&this.oldContents.resetLazyData()},e.prototype.setNamedObject=function(r,n,a,o,u){var t=this.contents.getEntryIfDefined(n.name);if(t!==void 0){var d=u((0,ny.nameLoc)(this.scope,t.key),t.value.obj,"remove");if(d.kind===Og.ResultKind.Failure)return d}if(a===void 0?this.contents=this.contents.remove(n.name):this.contents=this.contents.setValue(n.name,{obj:a,lazyData:new skr.ResettableLazy(function(){return o(r,n,a)})}),this.isCurrent=this.isChanged=!0,a!==void 0){var d=u(n,a,"add");if(d.kind===Og.ResultKind.Failure)return d}return Og.successUndefined},e.prototype.setUndefinedNames=function(){this.contents=this.contents.setUndefined(),this.isCurrent=this.isChanged=!0},e.prototype.promoteNamedObjects=function(r,n){var a=this;if(this.isChanged||r!==this.oldStateId)return(0,Og.success)(!1);this.contents=this.oldContents,this.isCurrent=!0;var o=(0,Og.success)(!0);return this.contents.forEachAvailableName(function(u,t){if(t===void 0)return!0;var d=n((0,ny.nameLoc)(a.scope,u),t.obj,"add");return d.kind===Og.ResultKind.Success?!0:(o=d,!1)}),o},e.prototype.onWriteNamedTable=function(r,n,a){this.contents=this.contents.onWriteNamedTable(r,n,a)},e.prototype.onWriteNamedRange=function(r,n,a){this.contents=this.contents.onWriteNamedRange(r,n,a)},e.prototype.forEachAvailableName=function(r){return this.contents.forEachAvailableName(r)},e}();Ff.PartialWorkbookNames=bkr});var NPe=Y(XO=>{_();Object.defineProperty(XO,"__esModule",{value:!0});XO.makeEmptyTable=XO.entry=void 0;var EPe=Cn(),Pkr=EPe.table.makeEmptyTable;XO.makeEmptyTable=Pkr;var Ekr=EPe.table.entry;XO.entry=Ekr});var wre=Y(J9=>{_();Object.defineProperty(J9,"__esModule",{value:!0});J9.PartialWorkbookNameManager=void 0;var pS=gs(),Ire=ft(),lo=Di(),APe=Qu(),z9=zu(),Nkr=Ai(),eD=$w(),Y9=g2(),Akr=NPe(),Mre=vd(),Okr=function(){function e(r,n,a,o,u){var t=this;this.document=r,this.stringCompareCI=n,this.sheetScopedNames=a,this.oldSheetScopedNames=o,this.onWriteNamedObject=function(d,s,c){if(s.kind==="NamedRange"){var l=s.value;(0,Nkr.assertTrue)("calc.calc.PartialWorkbookDocument.onWriteNamedObject: bad range",(0,z9.isDocumentLocEqual)(s.value.sheets.document,d.scope.document));var f=t.getNamesBySheetId(l.sheets.index);if(f.kind===lo.ResultKind.Failure)return f;f.value.onWriteNamedRange(d,s,c)}if(s.kind==="NamedTable"){var f=t.getNamesBySheetId(s.specialRefRanges[APe.SpecialRefId.All].sheet.index);if(f.kind===lo.ResultKind.Failure)return f;f.value.onWriteNamedTable(d,s,c)}return lo.successUndefined},this.globalNames=u??new eD.PartialWorkbookNames(n,(0,pS.documentScope)(r))}return e.prototype.clone=function(){var r;if(this.sheetScopedNames){r=(0,Ire.makeStringMap)();for(var n in this.sheetScopedNames){var a=this.sheetScopedNames[n];r[n]=a.clone()}}return new e(this.document,this.stringCompareCI,r,void 0,this.globalNames.clone())},e.prototype.setNamedObject=function(r,n,a,o){var u=this.getNameFormula(n,pS.NameSource.StructRef);a!==void 0&&a.kind==="NamedTable"&&(0,lo.isSuccess)(u)&&u.value!==void 0&&u.value.obj.kind==="NamedTable"&&(0,eD.isNamedTableRangeEqual)(u.value.obj,a)&&(a=(0,eD.mergeNamedTables)(u.value.obj,a));var t=this.getNamesBySheetId(n.scope.index);return t.kind===lo.ResultKind.Failure?t:t.value.setNamedObject(r,n,a,o,this.onWriteNamedObject)},e.prototype.setUndefinedNames=function(r){var n=this.getNamesBySheetId(r.index);return n.kind===lo.ResultKind.Failure?n:(0,lo.success)(n.value.setUndefinedNames())},e.prototype.promoteNamedObjects=function(r,n){var a=this.getNamesBySheetId(r.index);return a.kind===lo.ResultKind.Failure?a:a.value.promoteNamedObjects(n,this.onWriteNamedObject)},e.prototype.setSheetNames=function(r){for(var n,a,o=(n=this.sheetScopedNames)!==null&&n!==void 0?n:this.oldSheetScopedNames,u=(0,Ire.makeStringMap)(),t=0,d=r;t<d.length;t++){var s=d[t].sheetId;u[s]=(a=o==null?void 0:o[s])!==null&&a!==void 0?a:new eD.PartialWorkbookNames(this.stringCompareCI,(0,pS.sheetIndex)(this.document,s))}return new e(this.document,this.stringCompareCI,u,void 0,this.globalNames)},e.prototype.getNameLoc=function(r,n,a){var o=this.getNamesBySheetId(r);if(o.kind===lo.ResultKind.Failure)return o;var u=o.value.getNameLoc(n,a);return u.kind===lo.ResultKind.Failure,u},e.prototype.getAvailableNamesInScope=function(r){var n=this.getAllDocumentNames(),a=this.getNamesBySheetId(r);return a.kind===lo.ResultKind.Success&&(0,Ire.safePush)(n,a.value.getAvailableNames((0,pS.nameScope)(this.document,r))),n},e.prototype.getAllDocumentNames=function(){return this.globalNames.getAvailableNames((0,pS.documentScope)(this.document))},e.prototype.getAvailableTableColumns=function(r){var n=this.getNameFormula(r,pS.NameSource.StructRef),a=[];if(n.kind!==lo.ResultKind.Success||n.value===void 0||n.value.obj.kind!=="NamedTable")return{cols:a,isPartial:!0};var o=!n.value.obj.allColumnNamesAvailable;return n.value.obj.columnNames.forEach(function(u){return a.push(u),!0}),{cols:a,isPartial:o}},e.prototype.getNameFormula=function(r,n){var a=this.getNamesBySheetId(r.scope.index);return a.kind===lo.ResultKind.Failure?a:a.value.getNameFormula(r.name,n)},e.prototype.hasRecalcNameFailure=function(r){var n=this.getNamesBySheetId(r.scope.index);return n.kind===lo.ResultKind.Failure?n:(0,lo.success)(n.value.hasRecalcFailure(r.name))},e.prototype.setRecalcNameFailure=function(r){var n=this.getNamesBySheetId(r.scope.index);return n.kind===lo.ResultKind.Failure?n:(0,lo.success)(n.value.setRecalcFailure(r.name))},e.prototype.getNamesBySheetId=function(r){if(r===void 0)return(0,lo.success)(this.globalNames);if(!this.sheetScopedNames)return(0,lo.failure)((0,z9.unavailable)([{kind:Mre.UnavailableKind.SheetNames}]));var n=this.sheetScopedNames[r];return n===void 0?(0,lo.failure)((0,z9.unavailable)([{kind:Mre.UnavailableKind.SheetId,document:this.document,sheetId:r}])):(0,lo.success)(n)},e.prototype.getContainingTable=function(r){var n=this.getNamesBySheetId(r.sheet.index);return n.kind===lo.ResultKind.Failure?n:(0,lo.success)(n.value.getContainingTable(r.range))},e.prototype.getNamedRanges=function(r){var n=this.getNamesBySheetId(r.sheet.index);return n.kind===lo.ResultKind.Failure?n:(0,lo.success)(n.value.getNamedRanges(r.range))},e.prototype.getIntersectingTables=function(r){var n=this.getNamesBySheetId(r.sheet.index);return n.kind===lo.ResultKind.Failure?n:(0,lo.success)(n.value.getIntersectingTables(r.range))},e.prototype.getStructRefColumn=function(r,n){var a=this.getNameFormula(r,pS.NameSource.StructRef);if(a.kind===lo.ResultKind.Failure)return a;if(a.value===void 0)return(0,lo.success)(void 0);if(a.value.obj.kind!=="NamedTable")return(0,lo.failure)((0,Y9.invalidStructRef)(Y9.InvalidStructRefReason.NamedObjectNotTable));var o=a.value.obj,u;if(typeof n=="string")u=o.columnNames.getEntry(n);else{var t=o.columnIndexes.getValue(n);u=t===void 0?void 0:(0,Akr.entry)(t,n)}if(u===void 0)return o.allColumnNamesAvailable?(0,lo.success)(void 0):(0,lo.failure)((0,z9.unavailable)([{kind:Mre.UnavailableKind.ColumnName,table:r,columnNameOrIndex:n}]));var d=o.specialRefRanges[APe.SpecialRefId.Data],s=d.sheet,c=d.range,l=(0,pS.sheetGridRange)(s,(0,pS.gridRange)(c.row,u.value,c.rows,1));return(0,lo.success)((0,pS.structRefColumnLoc)(u.key,l,o.hasHeadersRow,o.hasTotalsRow))},e.prototype.getStructRefSpecialRef=function(r,n){var a=this.getNameFormula(r,pS.NameSource.StructRef);return a.kind===lo.ResultKind.Failure?a:a.value===void 0?(0,lo.success)(void 0):a.value.obj.kind!=="NamedTable"?(0,lo.failure)((0,Y9.invalidStructRef)(Y9.InvalidStructRefReason.NamedObjectNotTable)):(0,lo.success)(a.value.obj.specialRefRanges[n])},e.prototype.onCellModified=function(r){this.forEachSheetScope(function(n){n.onCellModified(r)}),this.globalNames.onCellModified(r)},e.prototype.collectGarbage=function(r){this.forEachSheetScope(function(n){n.collectGarbage(r)}),this.globalNames.collectGarbage(r)},e.prototype.advanceState=function(r){this.forEachSheetScope(function(n){n.advanceState(r)}),this.globalNames.advanceState(r),this.oldSheetScopedNames=this.sheetScopedNames,this.sheetScopedNames=void 0},e.prototype.resetLazyData=function(){this.forEachSheetScope(function(r){r.resetLazyData()}),this.globalNames.resetLazyData()},e.prototype.getNameStatistics=function(){var r=this.globalNames.getStatistics();return this.forEachSheetScope(function(n){return r=(0,eD.mergeNameStatistics)(r,n.getStatistics())}),r},e.prototype.forEachSheetScope=function(r){for(var n in this.sheetScopedNames)if(Object.prototype.hasOwnProperty.call(this.sheetScopedNames,n)){var a=this.sheetScopedNames[n];r(a)}},e}();J9.PartialWorkbookNameManager=Okr});var xre=Y($9=>{_();Object.defineProperty($9,"__esModule",{value:!0});$9.PartialWorkbookSheets=void 0;var OPe=br(),kkr=Are(),Dre=ft(),kPe=gs(),o_=Di(),X9=zu(),Z9=vd(),Fkr=function(){function e(r,n,a,o,u,t){this.document=r,this.stringCompareCI=n,this.sheetPosToId=a,this.sheetNameToId=o,this.data=u,this.oldData=t}return e.prototype.clone=function(){return new e(this.document,this.stringCompareCI,this.sheetPosToId,this.sheetNameToId,this.data,void 0)},e.prototype.setSheetNames=function(r){for(var n,a=(n=this.data)!==null&&n!==void 0?n:this.oldData,o=(0,Dre.makeStringMap)(),u=[],t=[],d=0;d<r.length;d+=1){var s=r[d],c=s.sheetName,l=s.sheetId;u[d]=l,t.push([c,l]);var f=a==null?void 0:a[l];if(f===void 0){var p=(0,kPe.sheetIndex)(this.document,l);o[l]={pos:d,name:c,sheetIndex:p}}else o[l]=(0,OPe.__assign)((0,OPe.__assign)({},f),{pos:d,name:c})}var m=kkr.ArrayMapTree.create(this.stringCompareCI).setValues(t);return new e(this.document,this.stringCompareCI,u,m,o,void 0)},e.prototype.advanceState=function(r){this.oldData=this.data,this.sheetPosToId=void 0,this.sheetNameToId=void 0,this.data=void 0},e.prototype.getSheetRangeIds=function(r){var n,a;if(!this.sheetPosToId)return(0,o_.failure)((0,X9.unavailable)([{kind:Z9.UnavailableKind.SheetNames}]));if(r.index===void 0)n=0,a=this.sheetPosToId.length;else{var o=this.getSheetById(r.index);if(!(0,o_.isSuccess)(o))return o;var u=this.getSheetById(r.index2);if(!(0,o_.isSuccess)(u))return u;n=(0,Dre.fastMin)(o.value.pos,u.value.pos),a=(0,Dre.fastMax)(o.value.pos,u.value.pos)+1}for(var t=[],d=n;d<a;d+=1)t.push(this.sheetPosToId[d]);return(0,o_.success)((0,kPe.sheetRangeIndexes)(t,n))},e.prototype.getSheetById=function(r){if(!this.data)return(0,o_.failure)((0,X9.unavailable)([{kind:Z9.UnavailableKind.SheetNames}]));var n=this.data[r];return n===void 0?(0,o_.failure)((0,X9.unavailable)([{kind:Z9.UnavailableKind.SheetId,document:this.document,sheetId:r}])):(0,o_.success)(n)},e.prototype.getSheetByName=function(r){if(!this.sheetNameToId)return(0,o_.failure)((0,X9.unavailable)([{kind:Z9.UnavailableKind.SheetNames}]));var n=this.sheetNameToId.getValue(r);return n===void 0?(0,o_.success)(void 0):this.getSheetById(n)},e.prototype.forEachSheet=function(r){if(!(!this.sheetPosToId||!this.data))for(var n=0,a=this.sheetPosToId;n<a.length;n++){var o=a[n],u=this.data[o];u&&r(u,o)}},e}();$9.PartialWorkbookSheets=Fkr});var IPe=Y(nK=>{_();Object.defineProperty(nK,"__esModule",{value:!0});nK.PartialWorkbookDocument=void 0;var ZO=zu(),FPe=ft(),$O=r_(),eK=e0(),tE=vd(),Wr=Di(),rK=x0(),Ikr=wre(),Mkr=xre(),wkr=function(){function e(r,n,a,o,u,t,d,s){u===void 0&&(u=new Mkr.PartialWorkbookSheets(r,n)),s===void 0&&(s=new Ikr.PartialWorkbookNameManager(r,n)),this.document=r,this.stringCompareCI=n,this.formats=a,this.styles=o,this.sheets=u,this.grids=t,this.oldGrids=d,this.nameManager=s}return e.prototype.clone=function(r){r===void 0&&(r=$O.CloningTarget.Server);var n;if(this.grids){n=(0,FPe.makeStringMap)();for(var a in this.grids){var o=this.grids[a];n[a]=o.clone(r)}}return new e(this.document,this.stringCompareCI,this.formats.clone(),this.styles.clone(),this.sheets.clone(),n,void 0,this.nameManager.clone())},e.prototype.setClientValue=function(r,n,a){var o=this.getGridById(r.sheet.index);return o.kind===Wr.ResultKind.Failure?o:(0,Wr.success)(o.value.setClientValue(r.range,n,a))},e.prototype.setClientFormula=function(r,n,a){var o=this.getGridById(r.sheet.index);return o.kind===Wr.ResultKind.Failure?o:(0,Wr.success)(o.value.setClientFormula(r.range,r.range,n,a))},e.prototype.setRecalcFailure=function(r,n){var a=this.getGridById(r);return a.kind===Wr.ResultKind.Failure?a:(0,Wr.success)(a.value.setRecalcFailure(n))},e.prototype.setRecalcEditTaint=function(r,n){var a=this.getGridById(r);return a.kind===Wr.ResultKind.Failure?a:(0,Wr.success)(a.value.setRecalcEditTaint(n))},e.prototype.setRecalcValue=function(r,n){var a=this.getGridById(r.sheet.index);return a.kind===Wr.ResultKind.Failure?a:(0,Wr.success)(a.value.setRecalcValue(r.range,n))},e.prototype.setEditedFormat=function(r,n){var a=this.getGridById(r.sheet.index);return a.kind===Wr.ResultKind.Failure?a:(0,Wr.success)(a.value.setEditedFormat(r.range,n))},e.prototype.setClientFormat=function(r,n,a){var o=this.getGridById(r.sheet.index);return o.kind===Wr.ResultKind.Failure?o:(0,Wr.success)(o.value.setClientFormat(r.range,n,a))},e.prototype.setHiddenRows=function(r,n,a){var o=this.getGridById(r);return o.kind===Wr.ResultKind.Failure?o:(0,Wr.success)(o.value.setHiddenRows(n,a))},e.prototype.setHiddenCols=function(r,n,a){var o=this.getGridById(r);return o.kind===Wr.ResultKind.Failure?o:(0,Wr.success)(o.value.setHiddenCols(n,a))},e.prototype.setMergeCell=function(r){var n=this.getGridById(r.sheet.index);return n.kind===Wr.ResultKind.Failure?n:(0,Wr.success)(n.value.setMergeCell(r.range))},e.prototype.setInFilterMode=function(r,n){var a=this.getGridById(r);return a.kind===Wr.ResultKind.Failure?a:(0,Wr.success)(a.value.setInFilterMode(n))},e.prototype.setCellContents=function(r,n,a,o,u,t,d,s,c){var l=this.getGridById(n.sheet.index);if(l.kind===Wr.ResultKind.Failure)return l;var f=s!==void 0&&(0,ZO.isSheetIndexEqual)(n.sheet,s.sheet)?s.range:void 0;return(0,Wr.success)(l.value.setCellContents(r,n.set,a,o,u,t,d,f,c))},e.prototype.setRangeFormula=function(r,n,a,o,u,t,d,s){var c=this.getGridById(n.sheet.index);if(c.kind===Wr.ResultKind.Failure)return c;var l=d!==void 0&&(0,ZO.isSheetIndexEqual)(n.sheet,d.sheet)?d.range:void 0;return(0,Wr.success)(c.value.setRangeFormula(r,n.range,a,o,u,t,l,s))},e.prototype.copyRange=function(r){var n=this.getGridById(r.sheet.index);return n.kind===Wr.ResultKind.Failure?n:(0,Wr.success)(n.value.copyRange(r.range))},e.prototype.pasteRange=function(r,n,a){var o=this.getGridById(r.sheet.index);return o.kind===Wr.ResultKind.Failure?o:(0,Wr.success)(o.value.pasteRange(r.range,n,a))},e.prototype.assumeRecalcFinal=function(r,n){var a=this.getGridById(r.sheet.index);return a.kind===Wr.ResultKind.Failure?a:(0,Wr.success)(a.value.assumeRecalcFinal(r.set,n))},e.prototype.getDirtyEditedCells=function(){var r=[];return this.forEachSheet(function(n,a){return void r.push((0,tE.sheetCellSet)(n.sheetIndex,a.getDirtyEditedCells()))}),r},e.prototype.getNonDirtyEditedCells=function(){var r=[];return this.forEachSheet(function(n,a){return void r.push((0,tE.sheetCellSet)(n.sheetIndex,a.getNonDirtyEditedCells()))}),r},e.prototype.getDirtyDependentCells=function(){var r=[];return this.forEachSheet(function(n,a){return void r.push((0,tE.sheetCellSet)(n.sheetIndex,a.getDirtyDependentCells()))}),r},e.prototype.setNamedObject=function(r,n,a,o){return this.nameManager.setNamedObject(r,n,a,o)},e.prototype.setUndefinedNames=function(r){return this.nameManager.setUndefinedNames(r)},e.prototype.promoteNamedObjects=function(r,n){return this.nameManager.promoteNamedObjects(r,n)},e.prototype.setSheetNames=function(r){for(var n,a,o=(n=this.grids)!==null&&n!==void 0?n:this.oldGrids,u=(0,FPe.makeStringMap)(),t=0,d=r;t<d.length;t++){var s=d[t].sheetId;u[s]=(a=o==null?void 0:o[s])!==null&&a!==void 0?a:$O.PartialWorkbookGrid.create()}return new e(this.document,this.stringCompareCI,this.formats,this.styles,this.sheets.setSheetNames(r),u,void 0,this.nameManager.setSheetNames(r))},e.prototype.extendServerUnused=function(r,n,a){var o=this.getGridById(r);return o.kind===Wr.ResultKind.Failure?o:(0,Wr.success)(o.value.extendServerUnused(n,a))},e.prototype.promoteServerAvailability=function(r,n,a){var o=this.getGridById(r);return o.kind===Wr.ResultKind.Failure?o:(0,Wr.success)(o.value.promoteServerAvailability(n,a))},e.prototype.getNameLoc=function(r,n,a){return this.nameManager.getNameLoc(r,n,a)},e.prototype.getNameFormula=function(r,n){return this.nameManager.getNameFormula(r,n)},e.prototype.hasRecalcNameFailure=function(r){return this.nameManager.hasRecalcNameFailure(r)},e.prototype.setRecalcNameFailure=function(r){return this.nameManager.setRecalcNameFailure(r)},e.prototype.getContainingTable=function(r){var n=this.nameManager.getContainingTable(r);if(n.kind===Wr.ResultKind.Failure||n.value!==void 0)return n;var a=this.getGridById(r.sheet.index);if(a.kind===Wr.ResultKind.Failure)return(0,Wr.failure)((0,ZO.unavailable)([a.reason]));var o=(0,rK.intersectProduct)((0,eK.createCellSetFromRange)(r.range),eK.availableSetProduct);return(0,rK.meetsProduct)(o,a.value.getServerAvailability())?Wr.successUndefined:(0,Wr.failure)((0,ZO.unavailable)([{kind:tE.UnavailableKind.ContainingTable,range:r}]))},e.prototype.getNamedRanges=function(r){var n=this.nameManager.getNamedRanges(r);if(n.kind===Wr.ResultKind.Failure||n.value!==void 0)return n;var a=this.getGridById(r.sheet.index);if(a.kind===Wr.ResultKind.Failure)return(0,Wr.failure)((0,ZO.unavailable)([a.reason]));var o=(0,rK.intersectProduct)((0,eK.createCellSetFromRange)(r.range),eK.availableSetProduct);return(0,rK.meetsProduct)(o,a.value.getServerAvailability())?(0,Wr.success)([]):(0,Wr.failure)((0,ZO.unavailable)([{kind:tE.UnavailableKind.NamedRanges,range:r}]))},e.prototype.getIntersectingTables=function(r){return this.nameManager.getIntersectingTables(r)},e.prototype.getStructRefColumn=function(r,n){return this.nameManager.getStructRefColumn(r,n)},e.prototype.getStructRefSpecialRef=function(r,n){return this.nameManager.getStructRefSpecialRef(r,n)},e.prototype.getEditedFormula=function(r){var n=this.getGridById(r.sheet.index);return n.kind===Wr.ResultKind.Failure?n:(0,Wr.success)(n.value.getEditedFormula(r.range))},e.prototype.forEachEditedFormula=function(r,n){var a=this.getGridById(r.sheet.index);return a.kind===Wr.ResultKind.Failure?a:(0,Wr.success)(a.value.forEachEditedFormula(r.range,n))},e.prototype.getEditedValue=function(r){var n=this.getGridById(r.sheet.index);return n.kind===Wr.ResultKind.Failure?n:(0,Wr.success)(n.value.getEditedValue(r.range))},e.prototype.forEachEditedValue=function(r,n){var a=this.getGridById(r.sheet.index);return a.kind===Wr.ResultKind.Failure?a:(0,Wr.success)(a.value.forEachEditedValue(r.range,n))},e.prototype.getEditedFormat=function(r){var n=this.getGridById(r.sheet.index);return n.kind===Wr.ResultKind.Failure?n:(0,Wr.success)(n.value.getEditedFormat(r.range))},e.prototype.forEachEditedFormat=function(r,n){var a=this.getGridById(r.sheet.index);return a.kind===Wr.ResultKind.Failure?a:(0,Wr.success)(a.value.forEachEditedFormat(r.range,n))},e.prototype.getEditedStyle=function(r){var n=this.getGridById(r.sheet.index);return n.kind===Wr.ResultKind.Failure?n:(0,Wr.success)(n.value.getEditedStyle(r.range))},e.prototype.isInFilterMode=function(r){var n=this.getGridById(r);return n.kind===Wr.ResultKind.Failure?n:n.value.isInFilterMode()},e.prototype.getHiddenRows=function(r,n,a){var o=this.getGridById(r);return o.kind===Wr.ResultKind.Failure?$O.hiddennessFullyUnavailable:o.value.getHiddenRows(n,a)},e.prototype.tryGetHiddenRows=function(r,n,a){var o=this.getGridById(r);return o.kind===Wr.ResultKind.Failure?o:o.value.tryGetHiddenRows(n,a)},e.prototype.getHiddenCols=function(r,n,a){var o=this.getGridById(r);return o.kind===Wr.ResultKind.Failure?$O.hiddennessFullyUnavailable:o.value.getHiddenCols(n,a)},e.prototype.tryGetHiddenCols=function(r,n,a){var o=this.getGridById(r);return o.kind===Wr.ResultKind.Failure?o:o.value.tryGetHiddenCols(n,a)},e.prototype.getMergeCell=function(r){var n=this.getGridById(r.sheet.index);return n.kind===Wr.ResultKind.Failure?n:(0,Wr.success)(n.value.getMergeCell(r.range))},e.prototype.getServerFormat=function(r){var n=this.getGridById(r.sheet.index);return n.kind===Wr.ResultKind.Failure?n:(0,Wr.success)(n.value.getServerFormat(r.range))},e.prototype.getServerStyle=function(r){var n=this.getGridById(r.sheet.index);return n.kind===Wr.ResultKind.Failure?n:(0,Wr.success)(n.value.getServerStyle(r.range))},e.prototype.getClientFormat=function(r){var n=this.getGridById(r.sheet.index);return n.kind===Wr.ResultKind.Failure?n:(0,Wr.success)(n.value.getClientFormat(r.range))},e.prototype.getClientValue=function(r){var n=this.getGridById(r.sheet.index);return n.kind===Wr.ResultKind.Failure?n:(0,Wr.success)(n.value.getClientValue(r.range))},e.prototype.getRecalcValues=function(r){var n=this.getGridById(r.sheet.index);return n.kind===Wr.ResultKind.Failure?n:(0,Wr.success)(n.value.getRecalcValues(r.range))},e.prototype.forEachRecalcValue=function(r,n){var a=this.getGridById(r.sheet.index);return a.kind===Wr.ResultKind.Failure?a:(0,Wr.success)(a.value.forEachRecalcValue(r.range,n))},e.prototype.getServerValue=function(r){var n=this.getGridById(r.sheet.index);return n.kind===Wr.ResultKind.Failure?n:(0,Wr.success)(n.value.getServerValue(r.range))},e.prototype.getServerFormula=function(r){var n=this.getGridById(r.sheet.index);return n.kind===Wr.ResultKind.Failure?n:(0,Wr.success)(n.value.getServerFormula(r.range))},e.prototype.getClientFormula=function(r){var n=this.getGridById(r.sheet.index);return n.kind===Wr.ResultKind.Failure?n:(0,Wr.success)(n.value.getClientFormula(r.range))},e.prototype.getServerUsedRange=function(r){var n=this.getGridById(r);return n.kind===Wr.ResultKind.Failure?n:(0,Wr.success)(n.value.getServerUsedRange())},e.prototype.allServerAvailable=function(r){var n=this.getGridById(r.sheet.index);return n.kind===Wr.ResultKind.Failure?n:(0,Wr.success)(n.value.allServerAvailable(r.range))},e.prototype.allEditedAvailable=function(r){var n=this.getGridById(r.sheet.index);return n.kind===Wr.ResultKind.Failure?n:(0,Wr.success)(n.value.allEditedAvailable(r.range))},e.prototype.forEachRecalcDirty=function(r,n){var a=this.getGridById(r.sheet.index);return a.kind===Wr.ResultKind.Failure?a:(0,Wr.success)(a.value.forEachRecalcDirty(r.range,n))},e.prototype.hasRecalcDirty=function(r){var n=this.getGridById(r.sheet.index);return n.kind===Wr.ResultKind.Failure?n:(0,Wr.success)(n.value.hasRecalcDirty(r.range))},e.prototype.hasRecalcFailure=function(r){var n=this.getGridById(r.sheet.index);return n.kind===Wr.ResultKind.Failure?n:(0,Wr.success)(n.value.hasRecalcFailure(r.range))},e.prototype.hasEditedEditTaint=function(r){var n=this.getGridById(r.sheet.index);return n.kind===Wr.ResultKind.Failure?n:(0,Wr.success)(n.value.hasEditedEditTaint(r.range))},e.prototype.hasRecalcEditTaint=function(r){var n=this.getGridById(r.sheet.index);return n.kind===Wr.ResultKind.Failure?n:(0,Wr.success)(n.value.hasRecalcEditTaint(r.range))},e.prototype.forEachEditedNonBlankCellInSet=function(r,n,a){var o=this.getGridById(r);return o.kind===Wr.ResultKind.Failure?o:(0,Wr.success)(o.value.forEachEditedNonBlankCellInSet(n,a))},e.prototype.forEachServerNonBlankCellInSet=function(r,n,a){var o=this.getGridById(r);return o.kind===Wr.ResultKind.Failure?o:(0,Wr.success)(o.value.forEachServerNonBlankCellInSet(n,a))},e.prototype.forEachEditedCellInSet=function(r,n,a){var o=this.getGridById(r);return o.kind===Wr.ResultKind.Failure?o:(0,Wr.success)(o.value.forEachEditedCellInSet(n,a))},e.prototype.getSheetIndex=function(r){var n=this.sheets.getSheetByName(r);return n.kind===Wr.ResultKind.Failure||n.value===void 0?n:(0,Wr.success)(n.value.sheetIndex)},e.prototype.getSheetName=function(r){var n=this.sheets.getSheetById(r);return n.kind===Wr.ResultKind.Failure?n:(0,Wr.success)(n.value.name)},e.prototype.getEditedUsedRange=function(r){var n=this.getGridById(r);return n.kind===Wr.ResultKind.Failure?n:(0,Wr.success)(n.value.getEditedUsedRange())},e.prototype.getSheetRangeIds=function(r){return this.sheets.getSheetRangeIds(r)},e.prototype.getIformat=function(r){return this.formats.getIformat(r)},e.prototype.getIformats=function(){return this.formats.getIformats()},e.prototype.getKnownFormat=function(r){return this.formats.getKnownFormat(r)},e.prototype.getFormatString=function(r){return this.formats.getFormatString(r)},e.prototype.resolveCellStyle=function(r){return this.styles.resolveCellStyle(r)},e.prototype.setNumberFormats=function(r,n){this.formats.setNumberFormats(r,n)},e.prototype.setStyles=function(r,n){this.styles.setStyles(r,n)},e.prototype.setFonts=function(r,n){this.styles.setFonts(r,n)},e.prototype.setFills=function(r,n){this.styles.setFills(r,n)},e.prototype.setBorders=function(r,n){this.styles.setBorders(r,n)},e.prototype.onCellModified=function(r,n){this.forEachSheet(function(a,o){o.onCellModified(r,n)}),this.nameManager.onCellModified(r)},e.prototype.collectGarbage=function(r,n){this.forEachSheet(function(a,o){o.collectGarbage(r,n)}),this.nameManager.collectGarbage(r)},e.prototype.advanceState=function(r,n){this.forEachSheet(function(a,o){o.advanceState(r,n)}),this.nameManager.advanceState(r),this.sheets.advanceState(r),this.oldGrids=this.grids,this.grids=void 0},e.prototype.clearCompiledFormulas=function(){this.forEachSheet(function(r,n){n.clearCompiledFormulas()}),this.nameManager.resetLazyData()},e.prototype.clearCompiledNumberFormats=function(){this.formats.clearCompiledNumberFormats()},e.prototype.getGridStatistics=function(){var r=$O.emptyGridStatistics;return this.forEachSheet(function(n,a){return r=(0,$O.mergeGridStatistics)(r,a.getStatistics())}),r},e.prototype.getNameStatistics=function(){return this.nameManager.getNameStatistics()},e.prototype.getServerAvailableCells=function(){var r=[];return this.forEachSheet(function(n,a){r.push({sheetIdx:n.sheetIndex,availableCells:a.getServerAvailability()})}),r},e.prototype.forEachSheet=function(r){var n=this.grids;n&&this.sheets.forEachSheet(function(a,o){var u=n[o];u&&r(a,u)})},e.prototype.getGridById=function(r){var n=this.grids;if(!n)return(0,Wr.failure)({kind:tE.UnavailableKind.SheetNames});var a=n[r];return a===void 0?(0,Wr.failure)({kind:tE.UnavailableKind.SheetId,document:this.document,sheetId:r}):(0,Wr.success)(a)},e}();nK.PartialWorkbookDocument=wkr});var Lre=Y(tK=>{_();Object.defineProperty(tK,"__esModule",{value:!0});tK.getWorksheetFunc=void 0;var Dkr=Gv(),xkr=Dkr.getWorksheetFuncModule.getWorksheetFunc;tK.getWorksheetFunc=xkr});var iK=Y(ty=>{_();Object.defineProperty(ty,"__esModule",{value:!0});ty.kindAnonymizers=ty.anonymizeMagnitude=ty.anonymizeFormulaString=ty.anonymize=void 0;var aK=Cn(),Lkr=aK.anonymizer.anonymize;ty.anonymize=Lkr;var Bkr=aK.anonymizer.anonymizeFormulaString;ty.anonymizeFormulaString=Bkr;var qkr=aK.anonymizer.anonymizeMagnitude;ty.anonymizeMagnitude=qkr;var Ukr=aK.anonymizer.kindAnonymizers;ty.kindAnonymizers=Ukr});var MPe=Y(oK=>{_();Object.defineProperty(oK,"__esModule",{value:!0});oK.adjustFormulaOrigin=void 0;var Gkr=et(),Kkr=Gkr.adjust.adjustFormulaOrigin;oK.adjustFormulaOrigin=Kkr});var wPe=Y(sK=>{_();Object.defineProperty(sK,"__esModule",{value:!0});sK.PartialWorkbookFormats=void 0;var Bre=ft(),uK=Di(),Vkr=vd(),Wkr=function(){function e(r){this.iformats=[],this.formatStrings=(0,Bre.makeStringMap)(),this.knownFormats=r}return e.prototype.clone=function(){var r=this,n=new e(this.knownFormats);return Object.keys(this.iformats).map(Number).forEach(function(a){n.iformats[a]=r.iformats[a]}),Object.keys(this.formatStrings).forEach(function(a){n.formatStrings[a]=r.formatStrings[a]}),n},e.prototype.clearCompiledNumberFormats=function(){var r=this;this.iformats.forEach(function(n){n.compiledFormat.reset()}),Object.keys(this.knownFormats).map(function(n){return Number(n)}).forEach(function(n){r.knownFormats[n].reset()}),this.formatStrings=(0,Bre.makeStringMap)(),Object.keys(this.iformats).map(Number).forEach(function(n){var a=r.iformats[n];r.formatStrings[a.formatString]=n})},e.prototype.getIformat=function(r){var n=this.iformats[r];return n===void 0?(0,uK.failure)({kind:Vkr.UnavailableKind.NumberFormat,iformat:r}):(0,uK.success)(n.compiledFormat)},e.prototype.getIformats=function(){return this.iformats},e.prototype.getKnownFormat=function(r){return(0,uK.success)(this.knownFormats[r])},e.prototype.getFormatString=function(r){return(0,uK.success)(this.formatStrings[r])},e.prototype.setNumberFormats=function(r,n){var a=this;n||(this.iformats=[],this.formatStrings=(0,Bre.makeStringMap)()),Object.keys(r).map(Number).forEach(function(o){var u=a.iformats[o];u!==void 0&&delete a.formatStrings[u.formatString];var t=r[o];a.iformats[o]=t,a.formatStrings[t.formatString]=o})},e}();sK.PartialWorkbookFormats=Wkr});var qre=Y(n0=>{_();Object.defineProperty(n0,"__esModule",{value:!0});n0.VerticalAlignment=n0.PatternType=n0.HorizontalAlignment=n0.FontVerticalAlignment=n0.FontUnderline=n0.FillKind=n0.BorderLineType=void 0;var aE=et(),jkr=aE.styleServiceTypes.BorderLineType;n0.BorderLineType=jkr;var Hkr=aE.styleServiceTypes.FillKind;n0.FillKind=Hkr;var Qkr=aE.styleServiceTypes.FontUnderline;n0.FontUnderline=Qkr;var zkr=aE.styleServiceTypes.FontVerticalAlignment;n0.FontVerticalAlignment=zkr;var Ykr=aE.styleServiceTypes.HorizontalAlignment;n0.HorizontalAlignment=Ykr;var Jkr=aE.styleServiceTypes.PatternType;n0.PatternType=Jkr;var Xkr=aE.styleServiceTypes.VerticalAlignment;n0.VerticalAlignment=Xkr});var Ure=Y(rk=>{_();Object.defineProperty(rk,"__esModule",{value:!0});rk.blankStyleValue=rk.PartialWorkbookStyles=void 0;var ek=Di(),iE=qre(),rD=vd(),lK={type:iE.BorderLineType.None,color:{argb:"00000000"}},nD={font:{name:"Calibri",bold:!1,italic:!1,underline:iE.FontUnderline.None,strikethrough:!1,verticalAlign:iE.FontVerticalAlignment.None,size:11,color:{argb:"ff000000"}},fill:{kind:iE.FillKind.Pattern,pattern:iE.PatternType.None,fgColor:{argb:"00000000"},bgColor:{argb:"00000000"}},border:{top:lK,bottom:lK,left:lK,right:lK},alignment:{horizontal:iE.HorizontalAlignment.Automatic,vertical:iE.VerticalAlignment.Bottom,textRotation:0,wrapText:!1,indent:0,relativeIndent:0,shrinkToFit:!1,readingOrder:0}};rk.blankStyleValue=nD;var Zkr=function(){function e(){this.styles=[],this.fonts=[],this.fills=[],this.borders=[]}return e.prototype.clone=function(){function r(a,o){Object.keys(a).map(Number).forEach(function(u){return void(o[u]=a[u])})}var n=new e;return r(this.styles,n.styles),r(this.fonts,n.fonts),r(this.fills,n.fills),r(this.borders,n.borders),n},e.prototype.resolveCellStyle=function(r){if(r===rD.SpecialStyle.Blank)return(0,ek.success)(nD);var n=this.styles[r];if(n===void 0)return(0,ek.failure)({kind:rD.UnavailableKind.StyleId,styleId:r});var a=n.fontId,o=n.fillId,u=n.borderId,t=n.alignment,d=a!==void 0?this.fonts[a]:nD.font;if(d===void 0)return(0,ek.failure)({kind:rD.UnavailableKind.FontId,fontId:a});var s=o!==void 0?this.fills[o]:nD.fill;if(s===void 0)return(0,ek.failure)({kind:rD.UnavailableKind.FillId,fillId:o});var c=u!==void 0?this.borders[u]:nD.border;return c===void 0?(0,ek.failure)({kind:rD.UnavailableKind.BorderId,borderId:u}):(0,ek.success)({font:d,fill:s,border:c,alignment:t})},e.prototype.setStyles=function(r,n){var a=this;n||(this.styles=[]),Object.keys(r).map(Number).forEach(function(o){return void(a.styles[o]=r[o])})},e.prototype.setFonts=function(r,n){var a=this;n||(this.fonts=[]),Object.keys(r).map(Number).forEach(function(o){return void(a.fonts[o]=r[o])})},e.prototype.setFills=function(r,n){var a=this;n||(this.fills=[]),Object.keys(r).map(Number).forEach(function(o){return void(a.fills[o]=r[o])})},e.prototype.setBorders=function(r,n){var a=this;n||(this.borders=[]),Object.keys(r).map(Number).forEach(function(o){return void(a.borders[o]=r[o])})},e}();rk.PartialWorkbookStyles=Zkr});var Wre=Y(ak=>{_();Object.defineProperty(ak,"__esModule",{value:!0});ak.voidCallback=ak.PartialWorkbookDocumentCollection=void 0;var $kr=br(),eFr=IPe(),go=gs(),Kn=zu(),cK=tu(),mS=r_(),dK=f1(),tD=e0(),ja=vd(),rFr=U2(),aD=OP(),Qd=Z1(),DPe=AP(),nFr=Zq(),tFr=ere(),Sc=Qu(),oE=cu(),uE=sg(),aFr=Lre(),nk=ft(),sE=Ai(),iFr=rre(),oFr=n3(),Gre=r3(),xPe=iK(),uFr=MPe(),Hv=Ll(),sFr=qU(),LPe=wZ(),iD=pv(),Ae=Di(),lFr=g2(),cFr=Cn(),tk=H3(),dFr=$w(),fFr=wPe(),BPe=MZ(),pFr=ig(),qPe=Ml(),mFr=Ure(),Kre=Q3(),gFr=Ql(),lE=(0,go.gridCell)(0,0),vFr=function(e){(0,$kr.__extends)(r,e);function r(){var n=e.call(this,void 0)||this;return n.fns=[],n}return r.prototype.wsfNode=function(n){this.fns.push((0,cK.englishWorksheetFuncIdToName)(n))},r.prototype.operatorNode=function(n){this.fns.push((0,cK.englishOperatorIdToName)(n))},r}(qPe.ConstVisitor);function hFr(e){var r=new vFr;return(0,qPe.reduceBottomUp)(r,e),r.fns}var Vre=(0,dK.precedents)([],[],[],iD.SpecialPrecs.None,dK.PrecsBound.Exact),UPe={onNameFailure:function(){},onRangeFailure:function(){},onNumberFormatFailure:function(){},onInferFormatFailure:function(){},onUnavailableObject:function(){},onUnavailable:function(){},onSetCellValue:function(){},onSetCellValues:function(){},onReturnCellValue:function(){}};ak.voidCallback=UPe;var SFr=function(){function e(r,n,a,o,u,t){var d=this;this.cb=n,this.schedulerConfig=a,this.limits=o,this.maxDereferenceCells=u,this.isServerWorkbookLoad=t,this.renderBlanksAsZerosEnabled=(0,gFr.isChangeGateEnabled)("OfficeVSO:7042222_renderBlanksAsZeros"),this.random=new cFr.JSF32(Math.random()*4294967296),this.worksheetFuncOverrides={},this.userDefinedFuncOverrides={},this.version=0,this.interruptToken=[Qd.Interrupt.Continue],this.getCellValue=this.makeGetCellValues(this.tryGetCellValue.bind(this)),this.getCellValues=this.makeGetCellValues(this.tryGetCellValues.bind(this)),this.compileNamedObject=function(s,c,l){var f=s?ja.FormulaMode.ServerNamedFormula:ja.FormulaMode.EditNamedFormula;switch(l.kind){case"NamedFormula":{var p=l.fmla,m=d.parser.parseFormula((0,DPe.parseLocals)(go.LexicalKind.NameManager,lE),p);(0,sE.assertTrue)("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: isServerUpdate",s);var v=s&&d.isServerWorkbookLoad,h=(0,aD.analyzeLocalsName)((0,go.originCell)((0,go.documentScope)(d.documentLoc),lE),void 0,v),S=m,y=d.checkFormula(h,S,p,f);return d.compileFormula((0,Qd.compileLocalsName)(lE),y)}case"NamedValue":case"NamedRange":case"NamedTable":{var m=void 0,C;if(l.kind==="NamedRange"){var E=l.value;(0,sE.assertTrue)("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: bad range",(0,Kn.isDocumentLocEqual)(l.value.sheets.document,c.scope.document));var I=E.sheets,F=d.getDocument(I.document);if(!(0,Ae.isSuccess)(F))return d.cb.onUnavailableObject(F.reason),(0,Ae.failure)((0,Kn.unavailable)([F.reason]));var w=F.value.getSheetName(I.index);if(!(0,Ae.isSuccess)(w))return d.cb.onUnavailable(w.reason),w;var B=l.value.ranges[0];m=(0,Sc.formula)((0,Sc.cellRefNode)((0,Sc.cellRefRange)((0,Sc.cellRefSingle)((0,Sc.pos)(Sc.PosKind.Abs,B.row),(0,Sc.pos)(Sc.PosKind.Abs,B.col)),(0,Sc.cellRefSingle)((0,Sc.pos)(Sc.PosKind.Abs,B.row+B.rows-1),(0,Sc.pos)(Sc.PosKind.Abs,B.col+B.cols-1))),(0,Sc.sheetQualifier)(w.value)),[],[],1),C=(0,go.sheetGridCell)(I,lE)}else l.kind==="NamedTable"?(m=(0,Sc.formula)((0,Sc.structRefNode)((0,Sc.nameNode)((0,Sc.identNamePart)(c.name)),(0,Sc.structRef)(void 0)),[],[],1),C=(0,go.originCell)((0,go.documentScope)(d.documentLoc),lE)):(m=(0,Sc.formula)((0,Sc.literalNode)(l.value,!0),[],[],1),C=(0,go.originCell)((0,go.documentScope)(d.documentLoc),lE));var y=d.analyzer.checkFormula((0,aD.analyzeLocalsName)(C),m);return!(0,Ae.isSuccess)(y)||!(0,Kn.isWellFormed)(y.value)?(0,sE.assertFalse)("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: constructed ill-formed formula ".concat((0,Gre.anonymizeFormula)(d.config,m,(0,go.lexicalSourceName)(c)))):d.compileFormula((0,Qd.compileLocalsName)(lE),(0,Ae.success)(y.value))}case"NamedFailure":return(0,Ae.failure)((0,Kn.unavailable)([{kind:ja.UnavailableKind.ClientFailure,reason:l.failureReason}]));default:return(0,sE.assertNever)("calc.calc.partialWorkbookDocumentCollection.compileNamedFmla",l)}},this.config=r,this.parser=(0,nFr.createParser)(this),this.printer=(0,Gre.createPrinter)(this),this.analyzer=(0,rFr.createAnalyzer)(this),this.formatter=(0,sFr.createNumberFormatter)(this),this.compiler=(0,tFr.createCompiler)(this),this.evaluator=(0,iFr.createEvaluator)(this)}return e.prototype.clone=function(r,n){var a;r===void 0&&(r=UPe),n===void 0&&(n=mS.CloningTarget.Server);var o=new e(this.config,r,this.schedulerConfig,this.limits,this.maxDereferenceCells,this.isServerWorkbookLoad);return o.documentLoc=this.documentLoc,o.document=(a=this.document)===null||a===void 0?void 0:a.clone(n),o.worksheetFuncOverrides=this.worksheetFuncOverrides,o.userDefinedFuncOverrides=this.userDefinedFuncOverrides,o.version=this.version,o},e.prototype.compareVersion=function(r){return this.version===r.version},e.prototype.reconfigure=function(r,n,a,o){this.schedulerConfig=r,this.limits=n,this.maxDereferenceCells=a,this.isServerWorkbookLoad=o,this.advanceVersion()},e.prototype.setConfig=function(r){this.config=r},e.prototype.forEachDocument=function(r){this.document!==void 0&&r(this.document)},e.prototype.getDocumentLoc=function(r,n){var a=this.documentLoc;return a!==void 0&&(r===void 0||r===a.path)&&this.config.localeInfo.stringCompareCI(n,a.name)===0?(0,Ae.success)(a):(0,Ae.failure)((0,Kn.unavailable)([{kind:ja.UnavailableKind.DocumentLoc,document:(0,go.documentLoc)(r,n)}]))},e.prototype.getNameLoc=function(r,n,a){var o=this.getDocument(r.document);return o.kind===Ae.ResultKind.Failure?(0,Ae.failure)((0,Kn.unavailable)([o.reason])):o.value.getNameLoc(r.index,n,a)},e.prototype.getUserDefinedFuncLoc=function(r,n){if(this.userDefinedFuncOverrides[n]!==void 0){var a=(0,go.userDefinedFuncLoc)(r,n);return(0,Ae.success)([a])}return(0,Ae.failure)((0,Kn.notImplemented)(["call UDF"]))},e.prototype.getCellFormat=function(r){var n=this.allEditedAvailable(r);if(n.kind===Ae.ResultKind.Failure)return(0,Ae.failure)((0,Kn.unavailable)([n.reason]));if(n.value!==!0)return(0,Ae.failure)((0,Kn.unavailable)([{kind:ja.UnavailableKind.GridRange,unavailableCells:n.value,range:r}]));var a=this.getEditedFormat(r);return a.kind===Ae.ResultKind.Failure?(0,Ae.failure)((0,Kn.unavailable)([a.reason])):a.value===ja.SpecialFormat.Unavailable?(0,Ae.failure)((0,Kn.unavailable)([{kind:ja.UnavailableKind.CellFormat}])):(0,Ae.success)(a.value)},e.prototype.getCellStyle=function(r){var n=this.allEditedAvailable(r);if(!(0,Ae.isSuccess)(n))return(0,Ae.failure)((0,Kn.unavailable)([n.reason]));if(n.value!==!0)return(0,Ae.failure)((0,Kn.unavailable)([{kind:ja.UnavailableKind.GridRange,unavailableCells:n.value,range:r}]));var a=this.getEditedStyle(r);return(0,Ae.isSuccess)(a)?a.value===ja.SpecialStyle.Unavailable?(0,Ae.failure)((0,Kn.unavailable)([{kind:ja.UnavailableKind.CellStyle}])):this.resolveCellStyle(r.sheet.document,a.value):(0,Ae.failure)((0,Kn.unavailable)([a.reason]))},e.prototype.getIformat=function(r,n){var a=this.getDocument(r);if(a.kind===Ae.ResultKind.Failure)return(0,Ae.failure)((0,Kn.unavailable)([a.reason]));var o=a.value.getIformat(n);if(o.kind===Ae.ResultKind.Failure)return(0,Ae.failure)((0,Kn.unavailable)([o.reason]));var u=o.value.getValue();return u.kind===Ae.ResultKind.Failure?(0,Ae.failure)((0,Hv.previousFormatFailure)((0,Hv.formatLocIFormat)(r,n))):u},e.prototype.getIformats=function(r,n,a){var o=this.getDocument(r);if(o.kind===Ae.ResultKind.Failure)return(0,Ae.failure)((0,Kn.unavailable)([o.reason]));for(var u=o.value.getIformats(),t=[],d=n,s=(0,nk.fastMin)(u.length,a);d<s;d+=1){var c=u[d];c!==void 0&&t.push({iformat:d,formatString:c.formatString,builtIn:c.builtIn})}return(0,Ae.success)(t)},e.prototype.getKnownFormat=function(r,n){var a=this.getDocument(r);if(a.kind===Ae.ResultKind.Failure)return(0,Ae.failure)((0,Kn.unavailable)([a.reason]));var o=a.value.getKnownFormat(n);if(o.kind===Ae.ResultKind.Failure)return(0,Ae.failure)((0,Kn.unavailable)([o.reason]));var u=o.value.getValue();return u.kind===Ae.ResultKind.Failure?(0,Ae.failure)((0,Hv.previousFormatFailure)((0,Hv.formatLocKnownFormat)(r,n))):u},e.prototype.getFormatString=function(r,n){var a=this.getDocument(r);if(a.kind===Ae.ResultKind.Failure)return(0,Ae.failure)((0,Kn.unavailable)([a.reason]));var o=a.value.getFormatString(n);return o.kind===Ae.ResultKind.Failure?(0,Ae.failure)((0,Kn.unavailable)([o.reason])):o},e.prototype.getNameFormula=function(r,n){var a=this.getDocument(r.scope.document);if(a.kind===Ae.ResultKind.Failure)return(0,Ae.failure)((0,Kn.unavailable)([a.reason]));var o=a.value.getNameFormula(r,n);if(o.kind===Ae.ResultKind.Failure)return o;if(o.value===void 0)return(0,Ae.success)(void 0);var u=o.value.lazyData.getValue();if((0,Ae.isSuccess)(u))return u;var t=this.hasRecalcNameFailure(r);return(0,Ae.isSuccess)(t)?t.value||this.setNameFailure(r,u.reason):this.cb.onUnavailable(t.reason),(0,Ae.failure)((0,Qd.previousNameFailure)(r))},e.prototype.getCellFormula=function(r){var n=this.getEditedFormula(r);if(n.kind===Ae.ResultKind.Failure)return(0,Ae.failure)((0,Kn.unavailable)([n.reason]));if(n.value===void 0)return(0,Ae.success)(void 0);var a=n.value,o=a[0],u=a[1];if(u.compiledFmla===void 0)return(0,Ae.success)(void 0);var t=(0,go.sheetGridRange)(r.sheet,o),d=this.readCompiledFmla(t,u.compiledFmla);return(0,Ae.isSuccess)(d)?(0,Ae.success)((0,Qd.cellFormula)((0,go.lexicalSourceGrid)(u.lexicalKind,t),d.value)):d},e.prototype.setCellValue=function(r,n,a){var o=this.setRecalcValue(r,n);if(o.kind===Ae.ResultKind.Failure)return this.cb.onUnavailableObject(o.reason);var u=this.propagateEditTaint(r,a);if(u.kind===Ae.ResultKind.Failure)return this.cb.onUnavailableObject(u.reason);this.cb.onSetCellValue(r,n,a,u.value,this.evalParams)},e.prototype.setCellValues=function(r,n,a){var o=this.setClientValue(r,n);if(o.kind===Ae.ResultKind.Failure)return this.cb.onUnavailableObject(o.reason);var u=this.setRecalcValue(r,n);if(u.kind===Ae.ResultKind.Failure)return this.cb.onUnavailableObject(u.reason);var t=this.propagateEditTaint(r,a);if(t.kind===Ae.ResultKind.Failure)return this.cb.onUnavailableObject(t.reason);this.cb.onSetCellValues(r,n,a,t.value,this.evalParams)},e.prototype.getWorksheetFunc=function(r){var n;if((0,uE.getWorksheetFuncType)(r).staticPrecs&(iD.SpecialPrecs.Time|iD.SpecialPrecs.Calc)){var a=!1,o=this.evalParams.volatileMode;switch(r){case uE.WorksheetFuncId.RAND:case uE.WorksheetFuncId.RANDBETWEEN:case uE.WorksheetFuncId.RANDARRAY:case uE.WorksheetFuncId.NOW:a=o===oE.VolatileMode.GroundTruth;break;case uE.WorksheetFuncId.TODAY:a=o===oE.VolatileMode.GroundTruth||o===oE.VolatileMode.Estimation;break;default:a=uE.WorksheetFuncId[r]===void 0;break}if(!a)return(0,Ae.failure)((0,Kn.unavailable)([{kind:ja.UnavailableKind.VolatileFunction,name:(0,cK.englishWorksheetFuncIdToName)(r)}]))}var u=(n=this.worksheetFuncOverrides[r])!==null&&n!==void 0?n:(0,aFr.getWorksheetFunc)(r);return u!=null?(0,Ae.success)(u):(0,Ae.failure)((0,Kn.notImplemented)([(0,cK.englishWorksheetFuncIdToName)(r)]))},e.prototype.getUserDefinedFunc=function(r){var n=r.id;return this.userDefinedFuncOverrides[n]!==void 0?(0,Ae.success)(this.userDefinedFuncOverrides[n]):(0,Ae.failure)((0,Kn.notImplemented)(["call UDF"]))},e.prototype.getSheetRangeIndexes=function(r){return this.getSheetRangeIds(r)},e.prototype.setCellFailure=function(r,n,a){var o,u=this.setRecalcFailure(r.sheet,(0,tD.createCellSetFromRange)(r.range));if(u.kind===Ae.ResultKind.Failure)return this.cb.onUnavailableObject(u.reason);var t=this.setClientValue(r,mS.clientValueUnknownOper);if(t.kind===Ae.ResultKind.Failure)return this.cb.onUnavailableObject(t.reason);var d=this.setRecalcValue(r,dK.blankOper);if(d.kind===Ae.ResultKind.Failure)return this.cb.onUnavailableObject(d.reason);var s=this.propagateEditTaint(r,a);if(s.kind===Ae.ResultKind.Failure)return this.cb.onUnavailableObject(s.reason);var c=this.evalParams;(o=c.onRangeFailure)===null||o===void 0||o.call(c,r,n,a),this.cb.onRangeFailure(r,n,a,s.value,c)},e.prototype.getUsedRange=function(r){var n=this.getEditedUsedRange(r);return n.kind===Ae.ResultKind.Failure?(0,Ae.failure)((0,Kn.unavailable)([n.reason])):n},e.prototype.getSheetName=function(r,n){var a=this.getDocument(r);if(a.kind===Ae.ResultKind.Failure)return(0,Ae.failure)((0,Kn.unavailable)([a.reason]));var o=a.value.getSheetName(n);return o.kind===Ae.ResultKind.Failure||o.value===void 0?o:(0,Ae.success)(o.value)},e.prototype.getSheetIndex=function(r,n){var a=this.getDocument(r);if(a.kind===Ae.ResultKind.Failure)return(0,Ae.failure)((0,Kn.unavailable)([a.reason]));var o=a.value.getSheetIndex(n);return o.kind===Ae.ResultKind.Failure||o.value===void 0?o:(0,Ae.success)(o.value.index)},e.prototype.getContainingTable=function(r){var n=this.getDocument(r.sheet.document);return n.kind===Ae.ResultKind.Failure?(0,Ae.failure)((0,Kn.unavailable)([n.reason])):n.value.getContainingTable(r)},e.prototype.getNamedRanges=function(r){var n=this.getDocument(r.sheet.document);return n.kind===Ae.ResultKind.Failure?(0,Ae.failure)((0,Kn.unavailable)([n.reason])):n.value.getNamedRanges(r)},e.prototype.getStructRefColumn=function(r,n){var a=this.getDocument(r.scope.document);return a.kind===Ae.ResultKind.Failure?(0,Ae.failure)((0,Kn.unavailable)([a.reason])):a.value.getStructRefColumn(r,n)},e.prototype.getStructRefSpecialRef=function(r,n){var a=this.getDocument(r.scope.document);return a.kind===Ae.ResultKind.Failure?(0,Ae.failure)((0,Kn.unavailable)([a.reason])):a.value.getStructRefSpecialRef(r,n)},e.prototype.getIntersectingTables=function(r){var n=this.getDocument(r.sheet.document);return n.kind===Ae.ResultKind.Failure?(0,Ae.failure)((0,Kn.unavailable)([n.reason])):n.value.getIntersectingTables(r)},e.prototype.getNamedObject=function(r,n){var a,o=this.getDocument(r.scope.document);if(o.kind===Ae.ResultKind.Failure)return(0,Ae.failure)((0,Kn.unavailable)([o.reason]));var u=o.value.getNameFormula(r,n);return u.kind===Ae.ResultKind.Failure?u:(0,Ae.success)((a=u.value)===null||a===void 0?void 0:a.obj)},e.prototype.getHiddenRows=function(r,n,a){var o=this.getDocument(r.document);return o.kind===Ae.ResultKind.Failure?mS.hiddennessFullyUnavailable:o.value.getHiddenRows(r.index,n,a)},e.prototype.tryGetHiddenRows=function(r,n,a){var o=this.getDocument(r.document);if(o.kind===Ae.ResultKind.Failure)return(0,Ae.failure)((0,Kn.unavailable)([o.reason]));var u=o.value.tryGetHiddenRows(r.index,n,a);return u.kind===Ae.ResultKind.Failure?(0,Ae.failure)((0,Kn.unavailable)([u.reason])):u},e.prototype.getHiddenCols=function(r,n,a){var o=this.getDocument(r.document);return o.kind===Ae.ResultKind.Failure?mS.hiddennessFullyUnavailable:o.value.getHiddenCols(r.index,n,a)},e.prototype.tryGetHiddenCols=function(r,n,a){var o=this.getDocument(r.document);if(o.kind===Ae.ResultKind.Failure)return(0,Ae.failure)((0,Kn.unavailable)([o.reason]));var u=o.value.tryGetHiddenCols(r.index,n,a);return u.kind===Ae.ResultKind.Failure?(0,Ae.failure)((0,Kn.unavailable)([u.reason])):u},e.prototype.getMergeCell=function(r){var n=this.allEditedAvailable(r);if(n.kind===Ae.ResultKind.Failure)return(0,Ae.failure)((0,Kn.unavailable)([n.reason]));if(n.value!==!0)return(0,Ae.failure)((0,Kn.unavailable)([{kind:ja.UnavailableKind.GridRange,unavailableCells:n.value,range:r}]));var a=this.getDocument(r.sheet.document);if(a.kind===Ae.ResultKind.Failure)return(0,Ae.failure)((0,Kn.unavailable)([a.reason]));var o=a.value.getMergeCell(r);return o.kind===Ae.ResultKind.Failure?(0,Ae.failure)((0,Kn.unavailable)([o.reason])):o},e.prototype.isInFilterMode=function(r){var n=this.getDocument(r.document);if(n.kind===Ae.ResultKind.Failure)return(0,Ae.failure)((0,Kn.unavailable)([n.reason]));var a=n.value.isInFilterMode(r.index);return a.kind===Ae.ResultKind.Failure?(0,Ae.failure)((0,Kn.unavailable)([a.reason])):a},e.prototype.getRandom=function(){return(0,sE.assertTrue)("calc.calc.PartialWorkbookDocumentCollection: getRandom",this.evalParams.volatileMode===oE.VolatileMode.GroundTruth),(0,Ae.success)(this.config.mathpack.fromNumber(this.random.next()))},e.prototype.getTime=function(r,n){return(0,oE.getTimeImpl)(this.config,r,n,this.evalParams.volatileMode)},e.prototype.withEvalParams=function(r,n){var a=this,o=this.evalParams;this.evalParams=r;try{var u=n();return Array.isArray(u)?u:u.kind===Ae.ResultKind.Paused?(0,Qd.paused)(function(){return a.withEvalParams(r,u.resume)}):(0,Qd.breaked)(function(){return a.withEvalParams(r,u.resume)})}finally{this.evalParams=o}},e.prototype.withEvalParamsEvalFormula=function(r,n){var a=this,o=this.evalParams;this.evalParams=r;try{var u=n();return u.kind===Ae.ResultKind.Paused?(0,Qd.paused)(function(){return a.withEvalParamsEvalFormula(r,u.resume)}):u.kind===Ae.ResultKind.Breaked?(0,Qd.breaked)(function(){return a.withEvalParamsEvalFormula(r,u.resume)}):u}finally{this.evalParams=o}},e.prototype.evaluate=function(r,n,a,o){var u=this;return this.withEvalParams({computeKind:r,computeCells:n,volatileMode:a,onRangeFailure:o},function(){return u.evaluator.evalCells({},n)})},e.prototype.evalFormula=function(r,n,a,o){var u=this,t={lexicalKind:go.LexicalKind.Other,originGridCell:(0,Ae.success)(n.range),originSheet:(0,Ae.success)(n.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!0,wrapCellReferences:!1,workbookLoad:!1,emitStepInfo:!1,contextNames:void 0},d={lexicalSource:{kind:go.LexicalKind.Other},originGridCell:(0,Ae.success)(n.range),originSheet:(0,Ae.success)(n.sheet),calcingArray:!1,reflectionGridCell:(0,Ae.success)(n.range),reflectionSheet:(0,Ae.success)(n.sheet),implicitIntersect:!1,allowUnqualifiedCell:!0,wrapCellReferences:!1,followHyperlinks:(0,Ae.success)(!1),contextNames:void 0},s=function c(l,f){if(f.kind===Ae.ResultKind.Paused)return(0,Qd.paused)(function(){return c(l,f.resume())});if(f.kind===Ae.ResultKind.Breaked)return(0,Qd.breaked)(function(){return c(l,f.resume())});if(!(0,Ae.isSuccess)(f))return(0,Ae.success)({value:f});var p=u.evalFormulaFormat(n,l,f.value,a);return(0,Ae.success)({value:(0,Ae.success)(f.value),formatted:p})};return this.withEvalParamsEvalFormula({computeKind:ja.ComputeKind.EvalFormula,computeCells:[n],volatileMode:o},function(){var c=u.parser.parseFormula(t,r),l=u.checkFormula(t,c,r,ja.FormulaMode.EvalFormula),f=u.compileFormula(t,l);return(0,Ae.isSuccess)(f)?s(f.value,u.evaluator.evalFormula(d,f.value)):(0,Ae.success)({value:f})})},e.prototype.evalFormulaFormat=function(r,n,a,o){var u;if(o!==void 0){if(typeof o=="number")return this.formatValueIformat(r.sheet.document,o,a);if(o.kind===ja.SpecialFormat.Known)return this.formatValueKnownFormat(r.sheet.document,o.knownFormat,a);var t=a;if(this.renderBlanksAsZerosEnabled&&(0,Kn.isBlankOper)(a)&&(o.kind===ja.SpecialFormat.Origin||o.kind===ja.SpecialFormat.Inferred||o.kind===ja.SpecialFormat.Edit)&&((u=o.renderBlanksAsZeros)!==null&&u!==void 0&&u)&&(t=this.config.mathpack.zero),o.kind===ja.SpecialFormat.Origin||o.kind===ja.SpecialFormat.Aggregate){var d=this.ensureCellExists(r);return(0,nk.isNone)(d)||!(0,Ae.isSuccess)(d)?d:o.kind===ja.SpecialFormat.Origin?this.formatValueCell(r,t):this.formatValueAggregate(r,t)}return o.kind===ja.SpecialFormat.Inferred?this.applyInferredFormat(r,n,t):o.kind===ja.SpecialFormat.Edit?this.applyEditFormat(r,n,t,o.isWholeFormula):(0,sE.assertNever)("calc.calc.PartialWorkbookDocumentCollection.evalFormulaFormat",o)}},e.prototype.evalValue=function(r,n,a){var o,u=this.evalParams;this.evalParams={computeKind:n,computeCells:[r],volatileMode:a};try{var t=this.getEditedFormula(r);if(!(0,Ae.isSuccess)(t))return this.cb.onUnavailableObject(t.reason);if(((o=t.value)===null||o===void 0?void 0:o[1].compiledFmla)!==void 0)return;var d=this.hasRecalcDirty(r);if(!(0,Ae.isSuccess)(d))return this.cb.onUnavailableObject(d.reason);if(d.value)return;var s=this.tryGetCellValue(r.range,r.sheet);if(s===void 0)return;(0,sE.assertTrue)("calc.calc.PartialWorkbookDocumentCollection.evalValue",s.kind===Qd.CellKind.FinalValue),this.cb.onReturnCellValue(r,s.oper,ja.ComputedCellKind.EditedCell)}finally{this.evalParams=u}},e.prototype.advanceVersion=function(){return this.version++,this.version},e.prototype.setUserDefinedFuncOverrides=function(r){this.userDefinedFuncOverrides=r,this.advanceVersion()},e.prototype.setWorksheetFuncOverrides=function(r){this.worksheetFuncOverrides=r,this.advanceVersion()},e.prototype.setSheetNames=function(r,n){var a=this.ensureDocument(r);return a.kind===Ae.ResultKind.Failure?a:(this.document=a.value.setSheetNames(n),(0,Ae.success)(void 0))},e.prototype.advanceState=function(r){this.document!==void 0&&this.document.advanceState(r,this.advanceVersion())},e.prototype.onCellModified=function(r){if(this.document!==void 0)return this.document.onCellModified(r,this.advanceVersion())},e.prototype.getServerDocument=function(){return this.documentLoc},e.prototype.allServerAvailable=function(r){var n=this.getDocument(r.sheet.document);return n.kind===Ae.ResultKind.Failure?n:n.value.allServerAvailable(r)},e.prototype.forEachEditedNonBlankCellInSet=function(r,n,a){var o=r.index,u=r.document,t=this.getDocument(u);return t.kind===Ae.ResultKind.Failure?t:t.value.forEachEditedNonBlankCellInSet(o,n,a)},e.prototype.forEachServerNonBlankCellInSet=function(r,n,a){var o=r.index,u=r.document,t=this.getDocument(u);return t.kind===Ae.ResultKind.Failure?t:t.value.forEachServerNonBlankCellInSet(o,n,a)},e.prototype.forEachEditedCellInSet=function(r,n,a){var o=r.index,u=r.document,t=this.getDocument(u);return t.kind===Ae.ResultKind.Failure?t:t.value.forEachEditedCellInSet(o,n,a)},e.prototype.clearCompiledFormulas=function(){if(this.document!==void 0)return this.document.clearCompiledFormulas()},e.prototype.clearCompiledNumberFormats=function(){if(this.document!==void 0)return this.document.clearCompiledNumberFormats()},e.prototype.getGridStatistics=function(){return this.document!==void 0?this.document.getGridStatistics():mS.emptyGridStatistics},e.prototype.getNameStatistics=function(){return this.document!==void 0?this.document.getNameStatistics():dFr.emptyNameStatistics},e.prototype.collectGarbage=function(r){if(this.document!==void 0)return this.document.collectGarbage(r,this.advanceVersion())},e.prototype.getEditedFormula=function(r){var n=this.getDocument(r.sheet.document);return n.kind===Ae.ResultKind.Failure?n:n.value.getEditedFormula(r)},e.prototype.forEachEditedFormula=function(r,n){var a=this.getDocument(r.sheet.document);return a.kind===Ae.ResultKind.Failure?a:a.value.forEachEditedFormula(r,n)},e.prototype.getEditedValue=function(r){var n=this.getDocument(r.sheet.document);return n.kind===Ae.ResultKind.Failure?n:n.value.getEditedValue(r)},e.prototype.forEachEditedValue=function(r,n){var a=this.getDocument(r.sheet.document);return a.kind===Ae.ResultKind.Failure?a:a.value.forEachEditedValue(r,n)},e.prototype.getEditedFormat=function(r){var n=this.getDocument(r.sheet.document);return n.kind===Ae.ResultKind.Failure?n:n.value.getEditedFormat(r)},e.prototype.forEachEditedFormat=function(r,n){var a=this.getDocument(r.sheet.document);return a.kind===Ae.ResultKind.Failure?a:a.value.forEachEditedFormat(r,n)},e.prototype.getEditedStyle=function(r){var n=this.getDocument(r.sheet.document);return n.kind===Ae.ResultKind.Failure?n:n.value.getEditedStyle(r)},e.prototype.getServerFormat=function(r){var n=this.getDocument(r.sheet.document);return n.kind===Ae.ResultKind.Failure?n:n.value.getServerFormat(r)},e.prototype.getServerStyle=function(r){var n=this.getDocument(r.sheet.document);return n.kind===Ae.ResultKind.Failure?n:n.value.getServerStyle(r)},e.prototype.getClientFormat=function(r){var n=this.getDocument(r.sheet.document);return n.kind===Ae.ResultKind.Failure?n:n.value.getClientFormat(r)},e.prototype.getClientValue=function(r){var n=this.getDocument(r.sheet.document);return n.kind===Ae.ResultKind.Failure?n:n.value.getClientValue(r)},e.prototype.getRecalcValues=function(r){var n=this.getDocument(r.sheet.document);return n.kind===Ae.ResultKind.Failure?n:n.value.getRecalcValues(r)},e.prototype.forEachRecalcValue=function(r,n){var a=this.getDocument(r.sheet.document);return a.kind===Ae.ResultKind.Failure?a:a.value.forEachRecalcValue(r,n)},e.prototype.getServerValue=function(r){var n=this.getDocument(r.sheet.document);return n.kind===Ae.ResultKind.Failure?n:n.value.getServerValue(r)},e.prototype.getServerFormula=function(r){var n=this.getDocument(r.sheet.document);return n.kind===Ae.ResultKind.Failure?n:n.value.getServerFormula(r)},e.prototype.getClientFormula=function(r){var n=this.getDocument(r.sheet.document);return n.kind===Ae.ResultKind.Failure?n:n.value.getClientFormula(r)},e.prototype.getServerUsedRange=function(r){var n=this.getDocument(r.document);if(n.kind===Ae.ResultKind.Failure)return n;var a=n.value.getServerUsedRange(r.index);return a.kind===Ae.ResultKind.Failure||a.value===void 0?a:(0,Ae.success)((0,go.sheetGridRange)(r,a.value))},e.prototype.getServerAvailableCells=function(){var r=[];return this.forEachDocument(function(n){return void(0,nk.safePush)(r,n.getServerAvailableCells())}),r},e.prototype.promoteServerAvailability=function(r,n){var a=r.sheet,o=r.set,u=this.getDocument(a.document);return u.kind===Ae.ResultKind.Failure?u:u.value.promoteServerAvailability(a.index,o,n)},e.prototype.extendServerUnused=function(r,n){var a=this.getDocument(r.document);return a.kind===Ae.ResultKind.Failure?a:a.value.extendServerUnused(r.index,n,this.advanceVersion())},e.prototype.setCellContents=function(r,n,a,o,u,t,d,s,c,l){var f=this.getDocument(n.sheet.document);if(f.kind===Ae.ResultKind.Failure)return f;var p=a===void 0?void 0:o?this.compileFmla(r,go.LexicalKind.Cell,(0,go.sheetGridCell)(n.sheet,u),void 0,a):a===""?mS.blankCellGridFormula:{fmla:a,lexicalKind:go.LexicalKind.Cell,origin:u,compiledFmla:void 0,hasHyperlink:mS.SpecialBoolean.ClientValueUnknown};return f.value.setCellContents(r,n,p,t,d,s,c,l,this.advanceVersion())},e.prototype.setRangeFormula=function(r,n,a,o,u,t,d,s){var c=this.getDocument(n.sheet.document);if(c.kind===Ae.ResultKind.Failure)return c;var l=a===""?mS.blankRangeGridFormula:this.compileFmla(r,go.LexicalKind.Range,(0,go.sheetGridCell)(n.sheet,o),(0,Kn.gridRangeAnchor)(n.range),a);return c.value.setRangeFormula(r,n,l,u,t,d,s,this.advanceVersion())},e.prototype.copyRange=function(r){var n=this.getDocument(r.sheet.document);return n.kind===Ae.ResultKind.Failure?n:n.value.copyRange(r)},e.prototype.pasteRange=function(r,n){var a=this.getDocument(r.sheet.document);return a.kind===Ae.ResultKind.Failure?a:a.value.pasteRange(r,n,this.advanceVersion())},e.prototype.assumeRecalcFinal=function(r){var n=this.getDocument(r.sheet.document);return n.kind===Ae.ResultKind.Failure?n:n.value.assumeRecalcFinal(r,this.advanceVersion())},e.prototype.getDirtyEditedCells=function(){return this.document?this.document.getDirtyEditedCells():[]},e.prototype.getNonDirtyEditedCells=function(){return this.document?this.document.getNonDirtyEditedCells():[]},e.prototype.getDirtyDependentCells=function(){return this.document?this.document.getDirtyDependentCells():[]},e.prototype.setNamedObject=function(r,n,a){var o=this.getDocument(n.scope.document);return o.kind===Ae.ResultKind.Failure?(0,Ae.failure)((0,Kn.unavailable)([o.reason])):o.value.setNamedObject(r,n,a,this.compileNamedObject)},e.prototype.setUndefinedNames=function(r){var n=this.getDocument(r.document);return n.kind===Ae.ResultKind.Failure?(0,Ae.failure)((0,Kn.unavailable)([n.reason])):n.value.setUndefinedNames(r)},e.prototype.promoteNamedObjects=function(r,n){var a=this.getDocument(r.document);return a.kind===Ae.ResultKind.Failure?(0,Ae.failure)((0,Kn.unavailable)([a.reason])):a.value.promoteNamedObjects(r,n)},e.prototype.setNumberFormats=function(r,n,a){var o=this,u=this.ensureDocument(r);if(u.kind===Ae.ResultKind.Failure)return(0,Ae.failure)((0,Kn.unavailable)([u.reason]));var t=[];return n.forEach(function(d){var s=d.iformat,c=d.formatString,l=d.builtIn,f=o.compileNumberFormat(c,l);t[s]={formatString:c,builtIn:l,compiledFormat:f}}),(0,Ae.success)(u.value.setNumberFormats(t,a))},e.prototype.setStyles=function(r,n,a){var o=this.ensureDocument(r);return o.kind===Ae.ResultKind.Failure?o:(0,Ae.success)(o.value.setStyles(n,a))},e.prototype.setFonts=function(r,n,a){var o=this.ensureDocument(r);return o.kind===Ae.ResultKind.Failure?o:(0,Ae.success)(o.value.setFonts(n,a))},e.prototype.setFills=function(r,n,a){var o=this.ensureDocument(r);return o.kind===Ae.ResultKind.Failure?o:(0,Ae.success)(o.value.setFills(n,a))},e.prototype.setBorders=function(r,n,a){var o=this.ensureDocument(r);return o.kind===Ae.ResultKind.Failure?o:(0,Ae.success)(o.value.setBorders(n,a))},e.prototype.writeHiddenRows=function(r,n,a){var o=this.getDocument(r.document);return o.kind===Ae.ResultKind.Failure?o:o.value.setHiddenRows(r.index,n,a)},e.prototype.writeHiddenCols=function(r,n,a){var o=this.getDocument(r.document);return o.kind===Ae.ResultKind.Failure?o:o.value.setHiddenCols(r.index,n,a)},e.prototype.writeMergeCell=function(r){var n=this.getDocument(r.sheet.document);return n.kind===Ae.ResultKind.Failure?n:n.value.setMergeCell(r)},e.prototype.writeInFilterMode=function(r,n){var a=this.getDocument(r.document);return a.kind===Ae.ResultKind.Failure?a:a.value.setInFilterMode(r.index,n)},e.prototype.resolveCellFormat=function(r,n){if(typeof n!="number")return(0,Ae.success)(n);var a=this.getDocument(r);if(!(0,Ae.isSuccess)(a))return(0,Ae.failure)((0,Kn.unavailable)([a.reason]));var o=a.value.getIformat(n);return(0,Ae.isSuccess)(o)?o.value.getValue():(0,Ae.failure)((0,Kn.unavailable)([o.reason]))},e.prototype.resolveCellStyle=function(r,n){var a=this.getDocument(r);if(!(0,Ae.isSuccess)(a))return(0,Ae.failure)((0,Kn.unavailable)([a.reason]));var o=a.value.resolveCellStyle(n);return(0,Ae.isSuccess)(o)?(0,Ae.success)(o.value):(0,Ae.failure)((0,Kn.unavailable)([o.reason]))},e.prototype.resolveValueFormat=function(r,n){var a;if(typeof n=="string")return this.resolveStringFormat(r,n);var o=this.getKnownFormat(r,n);if(!(0,Ae.isSuccess)(o))return o;var u=this.getFormatString(r,o.value.formatString);return(0,Ae.isSuccess)(u)?(0,Ae.success)((a=u.value)!==null&&a!==void 0?a:o.value):u},e.prototype.resolveStringFormat=function(r,n){var a=this.getFormatString(r,n);return(0,Ae.isSuccess)(a)?a.value!==void 0?(0,Ae.success)(a.value):this.formatter.createFormat(n,!1):a},e.prototype.resolveObjectFormat=function(r,n){var a=this.getFormatString(r,n.formatString);return(0,Ae.isSuccess)(a)?a.value!==void 0?(0,Ae.success)(a.value):(0,Ae.success)(n):a},e.prototype.resolveEditFormat=function(r,n){return typeof n=="number"?(0,Ae.success)(n):this.resolveStringFormat(r,n)},e.prototype.resolveRibbonFormat=function(r,n,a){var o;switch(n){case Kre.RibbonFormat.GalleryShortDate:case Kre.RibbonFormat.GalleryLongDate:{var u=this.getCellFormat(a);if(!(0,Ae.isSuccess)(u))return u;var t=this.resolveCellFormat(a.sheet.document,u.value);if(!(0,Ae.isSuccess)(t))return t;o=t.value;break}}var d=(0,Kre.getRibbonFormat)(this.config.localeInfo,n,o);return this.resolveStringFormat(r,d)},e.prototype.resolveChangeDecimals=function(r,n,a){var o=this.getCellFormat(a);if(!(0,Ae.isSuccess)(o))return o;var u=this.resolveCellFormat(a.sheet.document,o.value);if(!(0,Ae.isSuccess)(u))return u;var t=this.formatter.changeFormatDecimals(u.value,n);return(0,Ae.isSuccess)(t)?t.value===void 0?Ae.successUndefined:this.resolveObjectFormat(r,t.value):t},e.prototype.parseInferredEdit=function(r,n,a){var o=this.getCellFormat(r);if(!(0,Ae.isSuccess)(o))return o;var u=this.resolveCellFormat(r.sheet.document,o.value);if(!(0,Ae.isSuccess)(u))return u;var t=this.evalParams;this.evalParams={computeKind:ja.ComputeKind.ParseEdit,computeCells:[r],volatileMode:a};try{return this.formatter.parseEdit(n,u.value)}finally{this.evalParams=t}},e.prototype.inferFormulaFormat=function(r){var n=this.getEditedFormula(r);if(!(0,Ae.isSuccess)(n))return(0,Ae.success)(void this.cb.onUnavailableObject(n.reason));if(n.value===void 0||n.value[1].compiledFmla===void 0)return(0,Ae.success)(void this.cb.onUnavailableObject({kind:ja.UnavailableKind.CellEvaluatingValue}));var a=n.value[1].compiledFmla.getValue();if(!(0,Ae.isSuccess)(a))return a;var o=(0,go.lexicalSourceGrid)(n.value[1].lexicalKind,(0,go.sheetGridRange)(r.sheet,n.value[0])),u=a.value;return this.formatter.evalFormat((0,Hv.evalFormatLocalsGrid)(o),u)},e.prototype.fillInferredFormat=function(r,n){var a=this,o=n,u=n===ja.SpecialFormat.Unavailable?(0,Ae.success)(ja.SpecialFormat.Unavailable):this.resolveCellFormat(r.sheet.document,n);if(!(0,Ae.isSuccess)(u)){var t=u.reason;(0,tD.forEachRangeInSet)(r.set,function(s){var c=(0,go.sheetGridRange)(r.sheet,s);return a.cb.onInferFormatFailure(c,t),!0}),u=(0,Ae.success)(ja.SpecialFormat.Unavailable),o=ja.SpecialFormat.Unavailable}var d=u.value;(0,tD.forEachCellInSet)(r.set,function(s){var c=(0,go.sheetGridCell)(r.sheet,s),l=a.getEditedFormat(c);if(!(0,Ae.isSuccess)(l))return a.cb.onUnavailableObject(l.reason),!0;if(l.value===ja.SpecialFormat.Unavailable)return!0;var f=a.resolveCellFormat(r.sheet.document,l.value);if(!(0,Ae.isSuccess)(f))return a.cb.onInferFormatFailure(c,f.reason),!0;if((0,LPe.shouldInstallFormat)(d===ja.SpecialFormat.Unavailable?void 0:d,f.value)){var p=a.setEditedFormat(c,o);(0,Ae.isSuccess)(p)||a.cb.onUnavailableObject(p.reason)}return!0})},e.prototype.anonymizeFormula=function(r,n){var a,o=(a=n.compiledFmla)===null||a===void 0?void 0:a.getValue();return o!==void 0&&(0,Ae.isSuccess)(o)?[(0,Gre.anonymizeFormula)(this.config,o.value,r),hFr(o.value)]:[(0,xPe.anonymizeFormulaString)(n.fmla),[]]},e.prototype.compileFmla=function(r,n,a,o,u){var t=this;return{fmla:u,lexicalKind:n,origin:o??a.range,compiledFmla:new oE.ResettableLazy(function(){var d=t.parser.parseFormula((0,DPe.parseLocals)(n,a.range),u),s=r?d:t.autocorrectFormula((0,aD.analyzeLocalsGrid)(n,a),d),c=r&&t.isServerWorkbookLoad,l=t.checkFormula((0,aD.analyzeLocalsGrid)(n,a,void 0,c),s,u,r?ja.FormulaMode.ServerCellFormula:ja.FormulaMode.EditCellFormula),f=t.adjustFormulaOrigin(l,a,o);return t.compileFormula((0,Qd.compileLocalsGrid)(n,a.range),f)}),hasHyperlink:mS.SpecialBoolean.ClientValueUnknown}},e.prototype.compileFormula=function(r,n){return(0,Ae.isSuccess)(n)?this.compiler.compileFormula(r,n.value):n},e.prototype.checkFormula=function(r,n,a,o){if(!(0,Ae.isSuccess)(n))return n;var u=this.analyzer.checkFormulaWithDiagnostics(r,n.value);if(!(0,Ae.isSuccess)(u))return u;if(!(0,Kn.isWellFormed)(u.value[0])){var t="calc.PartialWorkbook.checkFormula: expected well-formed formula; given "+(0,xPe.anonymizeFormulaString)(a);return(0,Ae.failure)((0,Qd.illFormedFormula)(t,o,(0,aD.summarizeFormulaDiagnostics)(u.value[1])))}return(0,Ae.success)(u.value[0])},e.prototype.autocorrectFormula=function(r,n){return(0,Ae.isSuccess)(n)?this.analyzer.autocorrectFormula(r,n.value):n},e.prototype.adjustFormulaOrigin=function(r,n,a){if(!(0,Ae.isSuccess)(r)||a===void 0)return r;var o=(0,lFr.resolveLocalsGrid)(n);return(0,uFr.adjustFormulaOrigin)(this,o,a,r.value)},e.prototype.compileNumberFormat=function(r,n){var a=this;return new oE.ResettableLazy(function(){var o=a.formatter.createFormat(r,n);return(0,Ae.isSuccess)(o)||a.cb.onNumberFormatFailure(o.reason),o})},e.prototype.compileKnownFormats=function(){var r=this;return(0,nk.numEnumMap)(tk.KnownFormat,function(n){return r.compileNumberFormat((0,BPe.getKnownFormat)(r.config.localeInfo,n),!1)})},e.prototype.printFormulaBarText=function(r,n,a){return this.printer.printFormula((0,oFr.printLocalsGrid)(r,(0,go.sheetGridCell)(r.range.sheet,n)),a)},e.prototype.renderValueBarText=function(r,n,a){var o=this.getEditedResolvedFormat(r);return(0,Ae.isSuccess)(o)?this.formatter.renderFormulaBar(r.sheet.document,n,o.value,(0,pFr.stringStartsWith)(a,"'")):o},e.prototype.formatValueCell=function(r,n){if((0,Kn.isBlankOper)(n))return(0,Ae.success)((0,Hv.formattedValue)([],void 0,Hv.Alignment.Left,Hv.Clip.All));var a=this.getEditedResolvedFormat(r);if(!(0,Ae.isSuccess)(a))return a;var o=!0;return this.formatter.applyFormat(a.value,n,o)},e.prototype.formatValueAggregate=function(r,n){if(!(0,Kn.isNumberOper)(n))return(0,Ae.success)((0,Hv.hashesValue)(Hv.aggregationError,void 0));var a;if((0,Kn.isNumberOper)(n)&&this.config.mathpack.cond(n)===0)a=this.getKnownFormat(r.sheet.document,tk.KnownFormat.General);else{if(a=this.getEditedResolvedFormat(r),!(0,Ae.isSuccess)(a))return a;var o=a.value.valueType;o===Hv.FormatValueType.Text?a=this.getKnownFormat(r.sheet.document,tk.KnownFormat.General):o===Hv.FormatValueType.Time&&(a=this.getKnownFormat(r.sheet.document,tk.KnownFormat.AbsHMMSS))}if(!(0,Ae.isSuccess)(a))return a;var u=!0;return this.formatter.applyFormat(a.value,n,u)},e.prototype.formatValueIformat=function(r,n,a){var o=this.getIformat(r,n);return(0,Ae.isSuccess)(o)?this.formatter.applyFormat(o.value,a,!0):o},e.prototype.formatValueKnownFormat=function(r,n,a){var o=this.getKnownFormat(r,n);return(0,Ae.isSuccess)(o)?this.formatter.applyFormat(o.value,a,!0):o},e.prototype.getEditedResolvedFormat=function(r){var n=this.getEditedFormat(r);return(0,Ae.isSuccess)(n)?n.value===ja.SpecialFormat.Unavailable?(0,Ae.failure)((0,Kn.unavailable)([{kind:ja.UnavailableKind.CellFormat}])):this.resolveCellFormat(r.sheet.document,n.value):(0,Ae.failure)((0,Kn.unavailable)([n.reason]))},e.prototype.getDocument=function(r){return this.documentLoc===void 0||this.document===void 0||!(0,Kn.isDocumentLocEqual)(this.documentLoc,r)?(0,Ae.failure)({kind:ja.UnavailableKind.DocumentLoc,document:r}):(0,Ae.success)(this.document)},e.prototype.ensureDocument=function(r){return this.documentLoc===void 0&&this.document===void 0&&(this.documentLoc=r,this.document=new eFr.PartialWorkbookDocument(r,this.config.localeInfo.stringCompareCI,new fFr.PartialWorkbookFormats(this.compileKnownFormats()),new mFr.PartialWorkbookStyles)),this.getDocument(r)},e.prototype.tryGetCellValues=function(r,n){var a=this,o=(0,go.sheetGridRange)(n,r),u=r.row,t=r.col,d=r.rows,s=r.cols,c=this.getRecalcValues(o);if(c.kind===Ae.ResultKind.Failure){this.cb.onUnavailableObject(c.reason);return}for(var l=!1,f=0;f<d;f+=1)for(var p=c.value[f],m=0;m<s;m+=1){var v=p[m].failure;v!==void 0&&(this.setCellFailure((0,go.sheetGridCell)(n,(0,go.gridCell)(u+f,t+m)),v,Vre),l=!0)}if(!l){var h=function(E){return(0,Qd.finalValue)(E.oper)},S=c.value.map(function(C){return C.map(h)}),y=this.forEachRecalcDirty(o,function(C){var E=(0,go.sheetGridCell)(n,C),I=a.getEditedFormula(E);if(I.kind===Ae.ResultKind.Failure)return a.cb.onUnavailableObject(I.reason),!1;if(I.value===void 0)return a.setCellFailure(E,(0,Kn.unavailable)([{kind:ja.UnavailableKind.CellMissingFormula}]),Vre),l=!0,!0;var F=I.value,w=F[0],B=F[1];if(B.compiledFmla===void 0)return a.cb.onUnavailableObject({kind:ja.UnavailableKind.CellEvaluatingValue}),!1;var k=a.readCompiledFmla((0,go.sheetGridRange)(n,w),B.compiledFmla);return(0,Ae.isSuccess)(k)?(S[C.row-u][C.col-t]=(0,Qd.pendingValue)((0,go.sheetGridCell)(n,(0,Kn.gridRangeAnchor)(w))),!0):(l=!0,!0)});if(!(0,Ae.isSuccess)(y)){this.cb.onUnavailableObject(y.reason);return}if(!(!y.value||l))return S}},e.prototype.tryGetCellValue=function(r,n){var a=this.tryGetCellValues(r,n);return a===void 0?void 0:a[0][0]},e.prototype.makeGetCellValues=function(r){var n=this;return function(a){var o=n.allEditedAvailable(a);if(o.kind===Ae.ResultKind.Failure)return(0,Ae.failure)((0,Kn.unavailable)([o.reason]));if(o.value!==!0)return(0,Ae.failure)((0,Kn.unavailable)([{kind:ja.UnavailableKind.GridRange,range:a,unavailableCells:o.value}]));var u=n.hasRecalcFailure(a);if(u.kind===Ae.ResultKind.Failure)return(0,Ae.failure)((0,Kn.unavailable)([u.reason]));if(u.value)return(0,Ae.failure)((0,Qd.previousFailure)(a));if((0,Kn.gridRangeSize)(a.range)>n.maxDereferenceCells)return(0,Ae.failure)((0,Kn.unavailable)([{kind:ja.UnavailableKind.GridRangeSize,range:a}]));var t=r(a.range,a.sheet);return t===void 0?(0,Ae.failure)((0,Qd.previousFailure)(a)):(0,Ae.success)(t)}},e.prototype.readCompiledFmla=function(r,n){var a=n.getValue();if((0,Ae.isSuccess)(a))return a;if(this.setCellFailure(r,a.reason,Vre),a.reason.kind===Qd.ReasonKind.Unavailable){var o=a.reason;return a}return(0,Ae.failure)((0,Kn.unavailable)([{kind:ja.UnavailableKind.CellFormula,reason:a.reason}]))},e.prototype.getEditedUsedRange=function(r){var n=this.getDocument(r.document);if(n.kind===Ae.ResultKind.Failure)return n;var a=n.value.getEditedUsedRange(r.index);return a.kind===Ae.ResultKind.Failure||a.value===void 0?a:(0,Ae.success)((0,go.sheetGridRange)(r,a.value))},e.prototype.getSheetRangeIds=function(r){var n=this.getDocument(r.document);return n.kind===Ae.ResultKind.Failure?(0,Ae.failure)((0,Kn.unavailable)([n.reason])):n.value.getSheetRangeIds(r)},e.prototype.allEditedAvailable=function(r){var n=this.getDocument(r.sheet.document);return n.kind===Ae.ResultKind.Failure?n:n.value.allEditedAvailable(r)},e.prototype.forEachRecalcDirty=function(r,n){var a=this.getDocument(r.sheet.document);return a.kind===Ae.ResultKind.Failure?a:a.value.forEachRecalcDirty(r,n)},e.prototype.hasRecalcDirty=function(r){var n=this.getDocument(r.sheet.document);return n.kind===Ae.ResultKind.Failure?n:n.value.hasRecalcDirty(r)},e.prototype.hasRecalcFailure=function(r){var n=this.getDocument(r.sheet.document);return n.kind===Ae.ResultKind.Failure?n:n.value.hasRecalcFailure(r)},e.prototype.hasEditedEditTaint=function(r){var n=this.getDocument(r.sheet.document);return n.kind===Ae.ResultKind.Failure?n:n.value.hasEditedEditTaint(r)},e.prototype.hasRecalcEditTaint=function(r){var n=this.getDocument(r.sheet.document);return n.kind===Ae.ResultKind.Failure?n:n.value.hasRecalcEditTaint(r)},e.prototype.setEditedFormat=function(r,n){var a=this.getDocument(r.sheet.document);return a.kind===Ae.ResultKind.Failure?a:a.value.setEditedFormat(r,n)},e.prototype.setClientFormat=function(r,n){var a=this.getDocument(r.sheet.document);return a.kind===Ae.ResultKind.Failure?a:a.value.setClientFormat(r,n,this.advanceVersion())},e.prototype.setRecalcFailure=function(r,n){var a=this.getDocument(r.document);return a.kind===Ae.ResultKind.Failure?a:a.value.setRecalcFailure(r.index,n)},e.prototype.testAndSetClientValue=function(r,n){var a=this.getClientValue(r);if(a.kind===Ae.ResultKind.Failure)return a;var o=(0,mS.isClientValueUnknownOper)(a.value.oper)||!(0,Kn.isReadOperEqual)(this.config.mathpack,a.value.oper,n,!0);if(o){var u=this.setClientValue(r,n);if(u.kind===Ae.ResultKind.Failure)return u}return(0,Ae.success)(o)},e.prototype.testAndSetClientFormat=function(r,n){var a=this.getClientFormat(r);if(a.kind===Ae.ResultKind.Failure)return a;var o=n!==a.value;if(o){var u=this.setClientFormat(r,n);if(u.kind===Ae.ResultKind.Failure)return u}return(0,Ae.success)(o)},e.prototype.testAndSetClientFormula=function(r,n,a){var o,u=this.getClientFormula((0,Kn.sheetGridRangeAnchor)(r));if(u.kind===Ae.ResultKind.Failure)return u;var t=(o=u.value)!==null&&o!==void 0?o:[r.range,mS.blankClientGridFormula],d=t[0],s=t[1],c=(0,Kn.gridRangeAnchor)(r.range),l=n!==void 0&&n!==s.fmla||s.compiledFmla!==void 0&&!(0,Kn.isGridCellEqual)(c,s.origin),f=a!==void 0&&a!==s.hasHyperlink;if(l||f){var p=s.compiledFmla,m=this.setClientFormula((0,go.sheetGridRange)(r.sheet,d),{fmla:n??s.fmla,compiledFmla:p,origin:n!==void 0?c:s.origin,hasHyperlink:a??s.hasHyperlink});if(m.kind===Ae.ResultKind.Failure)return m}return(0,Ae.success)({hasFmlaChanged:l,hasHyperlinkChanged:f})},e.prototype.setRecalcEditTaint=function(r,n){var a=this.getDocument(r.document);return a.kind===Ae.ResultKind.Failure?a:a.value.setRecalcEditTaint(r.index,n)},e.prototype.propagateEditTaint=function(r,n){var a=this.hasEditedEditTaint(r);if(a.kind===Ae.ResultKind.Failure)return a;if(a.value)return(0,Ae.success)(ja.ComputedCellKind.EditedCell);for(var o=0,u=n.cells;o<u.length;o++){var t=u[o],d=this.hasRecalcEditTaint(t);if(d.kind===Ae.ResultKind.Failure)return d;if(d.value){var s=this.setRecalcEditTaint(r.sheet,(0,tD.createCellSetFromRange)(r.range));return s.kind===Ae.ResultKind.Failure?s:(0,Ae.success)(ja.ComputedCellKind.DependentCell)}}if(n.special&(iD.SpecialPrecs.Calc|iD.SpecialPrecs.Time)){var s=this.setRecalcEditTaint(r.sheet,(0,tD.createCellSetFromRange)(r.range));return s.kind===Ae.ResultKind.Failure?s:(0,Ae.success)(ja.ComputedCellKind.DependentCell)}return n.bound===dK.PrecsBound.Exact||this.evalParams!==void 0&&this.evalParams.computeKind===ja.ComputeKind.EditedCell?(0,Ae.success)(ja.ComputedCellKind.IndependentCell):(0,Ae.success)(ja.ComputedCellKind.UnknownNonEditedCell)},e.prototype.setClientValue=function(r,n){var a=this.getDocument(r.sheet.document);return a.kind===Ae.ResultKind.Failure?a:a.value.setClientValue(r,n,this.advanceVersion())},e.prototype.setRecalcValue=function(r,n){var a=this.getDocument(r.sheet.document);return a.kind===Ae.ResultKind.Failure?a:a.value.setRecalcValue(r,n)},e.prototype.setClientFormula=function(r,n){var a=this.getDocument(r.sheet.document);return a.kind===Ae.ResultKind.Failure?a:a.value.setClientFormula(r,n,this.advanceVersion())},e.prototype.hasRecalcNameFailure=function(r){var n=this.getDocument(r.scope.document);return n.kind===Ae.ResultKind.Failure?(0,Ae.failure)((0,Kn.unavailable)([n.reason])):n.value.hasRecalcNameFailure(r)},e.prototype.setRecalcNameFailure=function(r){var n=this.getDocument(r.scope.document);return n.kind===Ae.ResultKind.Failure?(0,Ae.failure)((0,Kn.unavailable)([n.reason])):n.value.setRecalcNameFailure(r)},e.prototype.setNameFailure=function(r,n){var a=this.setRecalcNameFailure(r);if(a.kind===Ae.ResultKind.Failure)return this.cb.onUnavailable(a.reason);this.cb.onNameFailure(r,n,this.evalParams)},e.prototype.applyInferredFormat=function(r,n,a){var o=this.getInferredFormat(r,n);return(0,Ae.isSuccess)(o)?o.value===void 0?this.formatValueKnownFormat(r.sheet.document,tk.KnownFormat.General,a):typeof o.value=="number"?this.formatValueIformat(r.sheet.document,o.value,a):this.formatter.applyFormat(o.value,a,!0):o},e.prototype.applyEditFormat=function(r,n,a,o){if(n.node.kind===Sc.NodeKind.CellRef&&!o)return this.applyInferredFormat(r,n,a);var u=this.ensureCellExists(r);if((0,nk.isNone)(u)||!(0,Ae.isSuccess)(u))return u;var t=this.getEditedResolvedFormat(r);if(!(0,Ae.isSuccess)(t))return t;var d=this.getInferredFormat(r,n);if(!(0,Ae.isSuccess)(d))return d;var s;if(d.value===void 0)s=void 0;else if(typeof d.value=="number"){var c=this.getIformat(r.sheet.document,d.value);if(!(0,Ae.isSuccess)(c))return c;s=c.value}else s=d.value;var l=(0,BPe.getKnownFormat)(this.config.localeInfo,tk.KnownFormat.General)===t.value.formatString;return(o||l)&&(0,nk.isDefined)(s)&&(0,LPe.shouldInstallFormat)(s,t.value)?this.formatter.applyFormat(s,a,!0):this.formatter.applyFormat(t.value,a,!0)},e.prototype.getInferredFormat=function(r,n){var a={lexicalSource:{kind:go.LexicalKind.Other},originGridCell:(0,Ae.success)(r.range),originSheet:(0,Ae.success)(r.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1};return this.formatter.evalFormat(a,n)},e.prototype.ensureCellExists=function(r){var n=this.allEditedAvailable(r);return(0,Ae.isSuccess)(n)?n.value!==!0?(0,Ae.failure)((0,Kn.unavailable)([{kind:ja.UnavailableKind.GridRange,unavailableCells:n.value,range:r}])):(0,Ae.success)(!0):void this.cb.onUnavailableObject(n.reason)},e}();ak.PartialWorkbookDocumentCollection=SFr});var KPe=Y(ik=>{_();Object.defineProperty(ik,"__esModule",{value:!0});ik.ulsStopwatchFactory=ik.initStopwatch=void 0;var GPe=Cn(),yFr=GPe.stopwatch.initStopwatch;ik.initStopwatch=yFr;var CFr=GPe.stopwatch.ulsStopwatchFactory;ik.ulsStopwatchFactory=CFr});var VPe=Y(cE=>{_();Object.defineProperty(cE,"__esModule",{value:!0});cE.QueuePos=cE.PriorityScheduler=void 0;var _Fr=gY(),fK;cE.QueuePos=fK;(function(e){e[e.Back=0]="Back",e[e.Front=1]="Front"})(fK||(cE.QueuePos=fK={}));var RFr=function(){function e(){this.minPriority=0,this.taskDeqs=[]}return e.prototype.deleteTasks=function(r,n){var a=this.taskDeqs[r];if(a)for(var o;o=a.popFront();)typeof o!="function"&&o.onDeleted&&o.onDeleted(n)},e.prototype.addTask=function(r,n,a){var o,u=(o=this.taskDeqs[r])!==null&&o!==void 0?o:this.taskDeqs[r]=new _Fr.Deque;n===fK.Back?u.pushBack(a):u.pushFront(a),r<this.minPriority&&(this.minPriority=r)},e.prototype.runTask=function(){for(var r,n=this.minPriority;n<this.taskDeqs.length;n+=1){this.minPriority=n;var a=(r=this.taskDeqs[n])===null||r===void 0?void 0:r.popFront();if(a)return typeof a=="function"?a():a.onRun(),!0}return!1},e.prototype.getCount=function(r){var n,a;return r!==void 0?(a=(n=this.taskDeqs[r])===null||n===void 0?void 0:n.getCount())!==null&&a!==void 0?a:0:this.taskDeqs.reduce(function(o,u){return u?o+u.getCount():o},0)},e}();cE.PriorityScheduler=RFr});var WPe=Y(us=>{_();Object.defineProperty(us,"__esModule",{value:!0});us.singleReadOperType=us.refToVal=us.readOperType=us.nextTransition=us.nextOnSuccessReceiver=us.machineCall=us.isMachineCall=us.callMachineTransition=us.breakTransition=us.ThenMachine=us.MachineRuntime=us.MachineCallKind=us.ArrayMachine=void 0;var kg=Gv(),TFr=kg.machine.ArrayMachine;us.ArrayMachine=TFr;var bFr=kg.machine.MachineCallKind;us.MachineCallKind=bFr;var PFr=kg.machine.ThenMachine;us.ThenMachine=PFr;var EFr=kg.machine.isMachineCall;us.isMachineCall=EFr;var NFr=kg.machine.machineCall;us.machineCall=NFr;var AFr=kg.machine.nextOnSuccessReceiver;us.nextOnSuccessReceiver=AFr;var OFr=kg.machine.callMachineTransition;us.callMachineTransition=OFr;var kFr=kg.machine.nextTransition;us.nextTransition=kFr;var FFr=kg.machine.breakTransition;us.breakTransition=FFr;var IFr=kg.machine.MachineRuntime;us.MachineRuntime=IFr;var MFr=kg.machine.readOperType;us.readOperType=MFr;var wFr=kg.machine.refToVal;us.refToVal=wFr;var DFr=kg.machine.singleReadOperType;us.singleReadOperType=DFr});var jPe=Y(If=>{_();Object.defineProperty(If,"__esModule",{value:!0});If.nextTransition=If.nextOnSuccessReceiver=If.callMachineTransition=If.breakTransition=If.TransitionKind=If.MachineRuntime=If.MachineCycle=If.AllMachine=void 0;var CT=Cn(),xFr=CT.machine.AllMachine;If.AllMachine=xFr;var LFr=CT.machine.MachineCycle;If.MachineCycle=LFr;var BFr=CT.machine.MachineRuntime;If.MachineRuntime=BFr;var qFr=CT.machine.TransitionKind;If.TransitionKind=qFr;var UFr=CT.machine.callMachineTransition;If.callMachineTransition=UFr;var GFr=CT.machine.nextOnSuccessReceiver;If.nextOnSuccessReceiver=GFr;var KFr=CT.machine.nextTransition;If.nextTransition=KFr;var VFr=CT.machine.breakTransition;If.breakTransition=VFr});var sk=Y(zd=>{_();Object.defineProperty(zd,"__esModule",{value:!0});zd.cellFormatToInferredFormat=cIr;zd.cellValueToReadOper=oIr;zd.createExcludeCellSet=aIr;zd.createLocaleInfo=zPe;zd.evalFormulaFormatToUnion=dIr;zd.gridCellToCellLocation=tIr;zd.localeInfoFromData=XFr;zd.namedObjectDataToNamedObject=sIr;zd.namedObjectToNamedObjectData=lIr;zd.readOperToCellValue=uIr;zd.sheetCellLocationToGridCell=ZFr;zd.sheetGridRangeToCellSet=eIr;zd.sheetGridRangeToHiddenCols=nIr;zd.sheetGridRangeToHiddenRows=rIr;zd.sheetGridRangeToLocation=Hre;zd.sheetRangeLocationToGridRange=gK;zd.unusedCellsUpdateToUsedRange=$Fr;var jre=br(),l_=ft(),el=tu(),s_=gs(),Fg=dT(),WFr=e0(),jFr=r_(),ok=vd(),RT=f1(),HFr=zu(),HPe=ey(),pK=x0(),uk=Ai(),mK=YO(),_T=$w(),u_=pv(),QFr=Qu();function zFr(e,r,n){var a=(0,el.getEnglishWorksheetFuncIdToName)().slice();return(0,mK.filterCheck)(r,mK.chWorksheetFunctionName,n,"localeData.worksheetFunctionNames").forEach(function(o){return a[o.functionId]=o.functionName}),(0,el.createWorksheetFuncNameCallbacks)(e,a)}function YFr(e,r){var n=el.englishErrorNames.slice();return(0,mK.filterCheck)(e,mK.chErrorTypeName,r,"localeData.errorTypeNames").forEach(function(a){return n[a.errorType]=a.errorName}),n}function JFr(e){if((0,l_.isNone)(e))return function(a){return a>0&&a%3===0};if(e.length===0||e[0]===0)return function(){return!1};if(e.length===2&&e[1]===0){var r=e[0];return function(a){return a>0&&a%r===0}}var n=e[e.length-1]===0&&e.length>=2;return function(a){if(a<=0)return!1;for(var o=a,u=0;u<e.length&&(o-=e[u],!(o<=0));u+=1);if(o>0&&n){var t=e[e.length-2];return o%t===0}return o===0}}function zPe(e,r){var n="en-US",a=(0,l_.makeStringCompareCI)(n),o=zFr(a,e.worksheetFunctionNames,r),u=o.getWorksheetFuncId,t=o.getWorksheetFuncName,d=JFr(e.thousandsData),s=YFr(e.errorTypeNames,r),c=e.lcid,l=c===el.LCID.Thailand,f=c===el.LCID.Korea,p=c===el.LCID.Japan,m=c===el.LCID.ChinaT||c===el.LCID.HongKong,v=c===el.LCID.China,h=f||p||v||m,S=c===el.LCID.Hindi||c===el.LCID.Tamil,y=c===el.LCID.Thailand||c===el.LCID.Vietnam||S,C=(c&el.LCID.LANG)===(el.LCID.Hebrew&el.LCID.LANG)||(c&el.LCID.LANG)===(el.LCID.Arabic&el.LCID.LANG)||c===el.LCID.Syriac,E=C||y,I=e.listSeparator===";"||e.decimalSeparator===";"?";;":";";return(0,jre.__assign)((0,jre.__assign)({},e),{leftBracket:"[",rightBracket:"]",rcLeftBracket:e.leftBracket,rcRightBracket:e.rightBracket,getWorksheetFuncId:u,getWorksheetFuncName:t,isNumeral:el.isNumeral,getOrdinal:el.getOrdinal,getNumberShape:el.getNumberShape,isThousandsPosition:d,isIdentStart:el.isIdentStart,isIdentContinue:el.isIdentContinue,stringCompareCI:a,errorNames:s,statementSeparator:I,isThai:l,isEastAsia:h,isKorea:f,isJapan:p,isChinaT:m,isChinaS:v,isComplexScript:E})}function XFr(e){return zPe(e,{})}function QPe(e,r){return(0,l_.isNone)(r)?{index:e,length:1}:{index:e,length:(0,l_.fastAbs)(r-e)+1}}function gK(e,r){var n=QPe(r.row,r.lastRow),a=n.index,o=n.length,u=QPe(r.column,r.lastColumn),t=u.index,d=u.length;return(0,s_.sheetGridRange)((0,s_.sheetIndex)(e,r.sheetId),(0,s_.gridRange)(a,t,o,d))}function ZFr(e,r){var n=r.row,a=r.column;return(0,s_.sheetGridCell)((0,s_.sheetIndex)(e,r.sheetId),(0,s_.gridCell)(n,a))}function $Fr(e,r){var n=r.sheetId,a=r.usedRange;return(0,l_.isDefined)(a)?gK(e,(0,jre.__assign)({sheetId:n},a)):(0,ok.sheetUsedRange)((0,s_.sheetIndex)(e,n),jFr.emptyUsedRange)}function eIr(e,r,n){var a=e.sheet,o=e.range,u=iIr(o,r,n);return{sheet:a,set:u}}function rIr(e,r){var n=e.sheet,a=e.range,o=r;return{sheet:n,range:a,hidden:o}}function nIr(e,r){var n=e.sheet,a=e.range,o=r;return{sheet:n,range:a,hidden:o}}function Hre(e){return(0,HFr.isSheetGridCell)(e)?(0,Fg.sheetRangeLocation)(e.sheet.index,e.range.row,e.range.col):(0,Fg.sheetRangeLocation)(e.sheet.index,e.range.row,e.range.col,e.range.row+e.range.rows-1,e.range.col+e.range.cols-1)}function tIr(e){var r=e.row,n=e.col;return{row:r,column:n}}function aIr(e,r,n,a){var o=HPe.empty;if((0,l_.isNone)(a))return o;for(var u=0;u<a.length;u+=1){var t=a[u];if(e<=t&&t<e+r){for(var d=1;u+d<a.length&&a[u+d]===t+d;)d+=1;u+=d-1,o=(0,HPe.union)(o,n((0,l_.pair)(t,t+d)))}}return o}function iIr(e,r,n){var a=(0,pK.createFromProduct)({row:r}),o=(0,pK.createFromProduct)({col:n}),u=(0,pK.unionProduct)(a,o);return(0,pK.exceptProduct)((0,WFr.createCellSetFromRange)(e),u)}function oIr(e,r){switch(typeof r){case"string":return(0,RT.stringOper)(r);case"boolean":return(0,RT.booleanOper)(r);case"number":return e.fromNumber(r)}switch(r.kind){case"Blank":return RT.blankOper;case"Error":return(0,RT.errorOper)(r.type);default:return}}function uIr(e,r){switch(r.kind){case u_.OperKind.String:case u_.OperKind.Boolean:return r.value;case u_.OperKind.Number:return e.toNumber(r);case u_.OperKind.Error:return(0,Fg.errorValue)(r.type);case u_.OperKind.Blank:return Fg.blankValue;default:return}}function sIr(e,r,n,a){if(!(0,l_.isNone)(a))switch(a.kind){case"NamedValue":switch(typeof a.value){case"string":return(0,_T.namedValue)((0,RT.stringOper)(a.value));case"boolean":return(0,_T.namedValue)((0,RT.booleanOper)(a.value));case"number":return(0,_T.namedValue)(e.fromNumber(a.value))}return a.value.kind==="Error"?(0,_T.namedValue)((0,RT.errorOper)(a.value.type)):(0,uk.assertNever)("calc.calc.namedObjectDataToNamedObject: NamedValue",a.value.kind);case"NamedFormula":return(0,_T.namedFormula)(a.formulaBarText);case"NamedRange":{var o=gK(n,a.range);return(0,_T.namedRange)((0,RT.range3DOper)(o.sheet,o.range))}case"NamedTable":{var u=gK(n,a.range);return(0,_T.namedTable)(u,a.hasHeadersRow,a.hasTotalsRow,a.columns,r)}case"NamedFailure":return(0,_T.namedFailure)(a.failureReason,(0,l_.isNone)(a.objectKind)?void 0:a.objectKind);default:return(0,uk.assertNever)("calc.calc.namedObjectDataToNamedObject: kind",a)}}function lIr(e,r,n){if(n)switch(n.kind){case"NamedValue":switch(n.value.kind){case u_.OperKind.Number:return(0,Fg.namedValueData)(e.toNumber(n.value));case u_.OperKind.String:case u_.OperKind.Boolean:return(0,Fg.namedValueData)(n.value.value);case u_.OperKind.Error:return(0,Fg.namedValueData)(n.value.type);default:return}case"NamedFormula":return(0,Fg.namedFormulaData)(n.fmla);case"NamedRange":{var a=(0,s_.sheetGridRange)((0,s_.sheetIndex)(r,n.value.sheets.index),n.value.ranges[0]);return(0,Fg.namedRangeData)(Hre(a))}case"NamedTable":{var o=n.specialRefRanges[QFr.SpecialRefId.Data],u=[];return n.columnIndexes.forEach(function(t,d){return u.push((0,Fg.columnData)(t,d)),!0}),(0,Fg.namedTableData)(Hre(o),n.hasHeadersRow,n.hasTotalsRow,u)}case"NamedFailure":return n;default:return(0,uk.assertNever)("calc.calc.namedObjectToNamedObjectData: kind",n)}}function cIr(e){if(e!==void 0)return(0,ok.isOutputFormatUnavailable)(e.format)?(0,Fg.inferredFormat)({kind:e.format.kind},e.valueType,e.decimals):(0,Fg.inferredFormat)(e.format,e.valueType,e.decimals)}function dIr(e){if(e!=null)switch(e.kind){case"Origin":return{kind:ok.SpecialFormat.Origin};case"Iformat":return(0,uk.assertTrue)("calc.calc.evalFormulaFormatToUnion: iformat",typeof e.iformat=="number"),e.iformat;case"Known":return(0,uk.assertTrue)("calc.calc.evalFormulaFormatToUnion: knownFormat",typeof e.knownFormat=="number"),{kind:ok.SpecialFormat.Known,knownFormat:e.knownFormat};case"Inferred":return{kind:ok.SpecialFormat.Inferred};case"Aggregate":return{kind:ok.SpecialFormat.Aggregate};default:return(0,uk.assertNever)("calc.calc.evalFormulaFormatToUnion: kind",e.kind)}}});var uD=Y(dE=>{_();Object.defineProperty(dE,"__esModule",{value:!0});dE.RecalcServiceDataTransformer=void 0;dE.incrementFailure=hIr;dE.initialRecalcServiceConfig=void 0;var lk=br(),YPe=gs(),Qre=ft(),fIr=tu(),Bc=YO(),JPe=sk(),Yre=Qu(),pIr=OJ(),Jre=rq(),gS=vd(),mIr=AP(),zre=Ll(),Mf=Z1(),gIr=Ai(),oD={localeInfo:(0,fIr.getEnglishLocaleInfo)(),mathpack:pIr.xlMathpack,refStyle:Yre.RefStyle.A1,timezone:Jre.tzUTC,date1904:!1,dateCompatibility:!0,datepack:Jre.xlDatepack};dE.initialRecalcServiceConfig=oD;var vIr=function(){function e(){this.document=(0,YPe.documentLoc)(void 0,""),this.langConfig=oD}return e.prototype.getLangConfig=function(){return this.langConfig},e.prototype.setA1ReferenceStyle=function(r,n,a){this.langConfig=(0,lk.__assign)((0,lk.__assign)({},this.langConfig),{refStyle:a?Yre.RefStyle.A1:Yre.RefStyle.R1C1}),r.setLangConfig(n,this.langConfig)},e.prototype.setLocaleInfo=function(r,n,a,o){(0,Bc.check)(a,Bc.chLocaleData,o,"localeData")&&(this.langConfig=(0,lk.__assign)((0,lk.__assign)({},this.langConfig),{localeInfo:(0,JPe.createLocaleInfo)(a,o)}),r.setLangConfig(n,this.langConfig))},e.prototype.setWorkbookProps=function(r,n,a,o){var u,t,d;(0,Bc.check)(a,Bc.chWorkbookProps,o,"workbookProps")&&(this.langConfig=(0,lk.__assign)((0,lk.__assign)({},this.langConfig),{date1904:(u=a.date1904)!==null&&u!==void 0?u:oD.date1904,dateCompatibility:(t=a.dateCompatibility)!==null&&t!==void 0?t:oD.dateCompatibility,timezone:(d=a.timezone)!==null&&d!==void 0?d:oD.timezone}),r.setLangConfig(n,this.langConfig))},e.prototype.updateSheetNames=function(r,n,a,o){r.setSheetNames(this.document,(0,Bc.filterCheck)(a,Bc.chSheetName,o,"sheetNames"),n)},e.prototype.updateNamedObjects=function(r,n,a,o){for(var u=(0,Bc.filterCheck)(a,Bc.chNamedObjectsUpdate,o,"namedObjectsUpdates"),t=0,d=u;t<d.length;t++){var s=d[t],c=s.scope,l=s.objects,f=s.fromStateId,p=(0,YPe.nameScope)(this.document,(0,Qre.isDefined)(c)?c:void 0);if((0,Qre.isDefined)(l))for(var m=(0,Bc.filterCheck)(l,(0,Bc.chNamedObject)(c),o,"namedObjectsUpdates.<index>.objects"),v=0,h=m;v<h.length;v++){var S=h[v],y=S.name,C=S.data;r.writeNamedObject(n,p,y,(0,JPe.namedObjectDataToNamedObject)(this.langConfig.mathpack,this.langConfig.localeInfo.stringCompareCI,this.document,C))}else(0,Qre.isDefined)(f)?r.promoteNamedObjects(n,p,f):r.writeUndefinedNames(n,p)}},e}();dE.RecalcServiceDataTransformer=vIr;function hIr(e,r){var n,a;switch(r.kind){case Mf.ReasonKind.NotImplemented:for(var o=0,u=r.features;o<u.length;o++){var t=u[o];(0,Bc.incrementStat)(e,"".concat(Mf.ReasonKind.NotImplemented," ").concat(t))}break;case Mf.ReasonKind.IllFormedFormula:(0,Bc.incrementStat)(e,"".concat(Mf.ReasonKind.IllFormedFormula," ").concat((n=r.mode)!==null&&n!==void 0?n:""," ").concat(JSON.stringify({diagnostics:(a=r.diagnostics)!==null&&a!==void 0?a:{},message:r.mode===gS.FormulaMode.ServerCellFormula||r.mode===gS.FormulaMode.ServerNamedFormula?r.message:void 0})));break;case Mf.ReasonKind.Unavailable:for(var d=0,s=r.objects;d<s.length;d++){var c=s[d],l=[Mf.ReasonKind.Unavailable];if(typeof c.kind=="string"&&c.kind in gS.UnavailableKind){var f=c;switch(l.push(f.kind),f.kind){case gS.UnavailableKind.SheetId:l.push(f.sheetId);break;case gS.UnavailableKind.NameLoc:l.push(f.source),l.push(f.name.scope.index===void 0?"global":"sheet");break;case gS.UnavailableKind.ClientFailure:l.push(f.reason);break;case gS.UnavailableKind.CellFormula:case gS.UnavailableKind.EvalFailure:l.push(f.reason.kind);break;case gS.UnavailableKind.VolatileFunction:l.push(f.name);break;case gS.UnavailableKind.TimeGranularity:l.push(Jre.TimeGranularity[f.granularity]);break;case gS.UnavailableKind.GetTimeKind:l.push(f.getTimeKind);break}}else l.push(JSON.stringify(c));(0,Bc.incrementStat)(e,l.join(" "))}break;case Mf.ReasonKind.LimitExceeded:(0,Bc.incrementStat)(e,"".concat(r.kind," ").concat(Mf.LimitKind[r.limit]));break;case zre.FormatReasonKind.NotFormatString:(0,Bc.incrementStat)(e,"".concat(r.kind," ").concat(r.message));break;case zre.FormatReasonKind.NotValueString:(0,Bc.incrementStat)(e,"".concat(r.kind," ").concat(r.message));break;case Mf.ReasonKind.InvalidQualifier:(0,Bc.incrementStat)(e,"".concat(r.kind," ").concat(r.reason));break;case Mf.ReasonKind.InvalidCellRef:(0,Bc.incrementStat)(e,"".concat(r.kind," ").concat(r.reason));break;case Mf.ReasonKind.InvalidStructRef:(0,Bc.incrementStat)(e,"".concat(r.kind," ").concat(r.reason));break;case Mf.ReasonKind.Internal:(0,Bc.incrementStat)(e,"".concat(r.kind," ").concat(r.message));break;case Mf.ReasonKind.JavaScriptError:case mIr.ReasonKind.NotFormulaString:case Mf.ReasonKind.CellCycle:case Mf.ReasonKind.NameCycle:case Mf.ReasonKind.Stopped:case Mf.ReasonKind.PreviousFailure:case Mf.ReasonKind.PreviousNameFailure:case zre.FormatReasonKind.PreviousFormatFailure:(0,Bc.incrementStat)(e,r.kind);break;default:(0,gIr.assertNever)("calc.calc.incrementFailure",r)}}});var iEe=Y(vS=>{_();Object.defineProperty(vS,"__esModule",{value:!0});vS.PrecisionStopReason=vS.PrecisionMessageKind=vS.PrecisionExperiment=void 0;vS.precisionValue=$re;var yK=br(),SIr=Z1(),ck=zu(),vK=gs(),hK=ft(),yIr=Cn(),SK=iK(),rEe=ey(),CIr=WPe(),sD=rB(),XPe=vd(),_Ir=r_(),nEe=e0(),tEe=x0(),RIr=tu(),aEe=Ai(),fE=pv(),Am=Di(),Zre=Ml(),vn=sg(),ZPe=jPe(),Xre=uD(),TIr=cu(),bIr=XB(),PIr=Jc(),mp,wn;function $re(e,r){switch(r.kind){case fE.OperKind.Number:return{kind:"n",magnitude:(0,SK.anonymizeMagnitude)(e.toNumber(r))};case fE.OperKind.String:return{kind:"s"};case fE.OperKind.Boolean:return{kind:"b"};case fE.OperKind.Error:return{kind:"e",type:(0,RIr.englishErrorTypeToName)(r.type)};case fE.OperKind.Rich:return{kind:"r"};case fE.OperKind.Array:return{kind:"a"};case fE.OperKind.Blank:return{kind:"z"};default:return(0,aEe.assertNever)("calc.calc.precisionValue",r)}}function EIr(e){return e.sampled===void 0}var Qv;vS.PrecisionMessageKind=Qv;(function(e){e.EvalStatistics="EvalStatistics",e.PrintFormulaStatistics="PrintFormulaStatistics",e.UnhandledFailure="UnhandledFailure"})(Qv||(vS.PrecisionMessageKind=Qv={}));var dk;vS.PrecisionStopReason=dk;(function(e){e.Success="Success",e.Timeout="Timeout"})(dk||(vS.PrecisionStopReason=dk={}));function $Pe(e,r){var n=e[r.sheet.index];return n!==void 0&&(0,tEe.meetsProduct)(n,(0,nEe.createCellSetFromRange)(r.range))}function eEe(e,r){var n,a=(n=e[r.sheet.index])!==null&&n!==void 0?n:rEe.empty;e[r.sheet.index]=(0,tEe.unionProduct)(a,(0,nEe.createCellSetFromRange)(r.range))}var NIr=(mp={},mp[vn.OperatorId.Add]=.05,mp[vn.OperatorId.Sub]=.069,mp[vn.OperatorId.Eq]=.097,mp[vn.OperatorId.Mul]=.1,mp[vn.OperatorId.Div]=.11,mp[vn.OperatorId.Concat]=.36,mp[vn.OperatorId.Gt]=.65,mp[vn.OperatorId.Ne]=.79,mp[vn.OperatorId.Lt]=.89,mp[vn.OperatorId.Le]=1.6,mp[vn.OperatorId.Ge]=1.9,mp[vn.OperatorId.Percent]=2.9,mp[vn.OperatorId.At]=6.2,mp[vn.OperatorId.Pow]=13,mp[vn.OperatorId.Range]=67,mp),AIr=(wn={},wn[vn.WorksheetFuncId.IF]=.076,wn[vn.WorksheetFuncId.SUM]=.11,wn[vn.WorksheetFuncId.IFERROR]=.5,wn[vn.WorksheetFuncId.COUNTIF]=.77,wn[vn.WorksheetFuncId.AND]=.82,wn[vn.WorksheetFuncId.VLOOKUP]=1.5,wn[vn.WorksheetFuncId.AVERAGE]=1.5,wn[vn.WorksheetFuncId.HOUR]=1.9,wn[vn.WorksheetFuncId.MINUTE]=1.9,wn[vn.WorksheetFuncId.TEXT]=2,wn[vn.WorksheetFuncId.OR]=2,wn[vn.WorksheetFuncId.NOW]=2.1,wn[vn.WorksheetFuncId.ISBLANK]=2.3,wn[vn.WorksheetFuncId.CONCATENATE]=2.6,wn[vn.WorksheetFuncId.SUMIF]=2.7,wn[vn.WorksheetFuncId.COUNTIFS]=3.3,wn[vn.WorksheetFuncId.LEFT]=3.4,wn[vn.WorksheetFuncId.ISNUMBER]=3.7,wn[vn.WorksheetFuncId.MID]=3.9,wn[vn.WorksheetFuncId.COUNTA]=4,wn[vn.WorksheetFuncId.MONTH]=4.2,wn[vn.WorksheetFuncId.SECOND]=4.3,wn[vn.WorksheetFuncId.LEN]=4.9,wn[vn.WorksheetFuncId.WEEKNUM]=5,wn[vn.WorksheetFuncId.DAY]=5.2,wn[vn.WorksheetFuncId.ROUND]=5.4,wn[vn.WorksheetFuncId.FIND]=5.8,wn[vn.WorksheetFuncId.NETWORKDAYS]=6.2,wn[vn.WorksheetFuncId.COUNT]=6.2,wn[vn.WorksheetFuncId.YEAR]=6.3,wn[vn.WorksheetFuncId.INT]=6.4,wn[vn.WorksheetFuncId.RIGHT]=6.7,wn[vn.WorksheetFuncId.ABS]=7,wn[vn.WorksheetFuncId.CONCAT]=7.2,wn[vn.WorksheetFuncId.CHAR]=7.4,wn[vn.WorksheetFuncId.MAX]=8,wn[vn.WorksheetFuncId.ROW]=8.1,wn[vn.WorksheetFuncId.WEEKDAY]=9.1,wn[vn.WorksheetFuncId.DAYS]=9.2,wn[vn.WorksheetFuncId.MIN]=9.8,wn[vn.WorksheetFuncId.SEARCH]=9.8,wn[vn.WorksheetFuncId.WORKDAY]=11,wn[vn.WorksheetFuncId.DATEDIF]=12,wn[vn.WorksheetFuncId.TIME]=13,wn[vn.WorksheetFuncId.HYPERLINK]=13,wn[vn.WorksheetFuncId.IFS]=13,wn[vn.WorksheetFuncId.ISERROR]=13,wn[vn.WorksheetFuncId.COUNTBLANK]=14,wn[vn.WorksheetFuncId.TODAY]=14,wn[vn.WorksheetFuncId.VALUE]=18,wn[vn.WorksheetFuncId.ROUNDUP]=18,wn[vn.WorksheetFuncId.MATCH]=19,wn[vn.WorksheetFuncId.DATE]=20,wn[vn.WorksheetFuncId.SUBSTITUTE]=20,wn[vn.WorksheetFuncId.INDIRECT]=22,wn[vn.WorksheetFuncId.INDEX]=23,wn[vn.WorksheetFuncId.TRIM]=24,wn[vn.WorksheetFuncId.UPPER]=25,wn[vn.WorksheetFuncId.SUMIFS]=28,wn[vn.WorksheetFuncId.EXACT]=29,wn[vn.WorksheetFuncId.NOT]=32,wn[vn.WorksheetFuncId.PRODUCT]=35,wn[vn.WorksheetFuncId.ROUNDDOWN]=37,wn[vn.WorksheetFuncId.AVERAGEIF]=38,wn[vn.WorksheetFuncId.ISTEXT]=40,wn[vn.WorksheetFuncId.ISOWEEKNUM]=41,wn[vn.WorksheetFuncId.EOMONTH]=42,wn[vn.WorksheetFuncId.MROUND]=45,wn[vn.WorksheetFuncId.COLUMN]=45,wn[vn.WorksheetFuncId.ROWS]=46,wn[vn.WorksheetFuncId.TIMEVALUE]=52,wn[vn.WorksheetFuncId.TRUNC]=53,wn[vn.WorksheetFuncId.LOOKUP]=59,wn[vn.WorksheetFuncId.NA]=59,wn[vn.WorksheetFuncId.DAYS360]=61,wn[vn.WorksheetFuncId.RANK]=67,wn[vn.WorksheetFuncId.EDATE]=72,wn[vn.WorksheetFuncId.MOD]=82,wn[vn.WorksheetFuncId.OFFSET]=83,wn[vn.WorksheetFuncId.STDEV]=87,wn[vn.WorksheetFuncId.SUBTOTAL]=91,wn),OIr=(0,Zre.binaryVisitor)((0,yK.__assign)((0,yK.__assign)({},(0,Zre.constVisitor)(.01)),{nameNode:function(){return 1},operatorNode:function(r){var n;return(n=NIr[r])!==null&&n!==void 0?n:100},wsfNode:function(r){var n;return(n=AIr[r])!==null&&n!==void 0?n:100}}),hK.fastMax);function kIr(e){return(0,Am.isSuccess)(e)?(0,Zre.reduceBottomUp)(OIr,e.value):1}var FIr=function(){function e(r,n){var a=this,o,u,t,d;this.onAlert=n,this.sampledSets={},this.precisionWrongSets={},this.log=[],this.result=void 0,this.debugStructRefFF=(0,PIr.getTypedFeatureGate)("Microsoft.Office.Excel.DebugStructRefFF"),this.testEval=function(s){var c=s.cell,l=s.p;return a.resumeToPledge(function(){return a.docs.evaluate(XPe.ComputeKind.EditedCell,[c],TIr.VolatileMode.PrecisionTest)},l)},this.testPrint=function(s){var c=s.cell,l=s.p;return sD.Pledge.try(function(){var f=a.getFormula(c);if(!(0,Am.isSuccess)(f))return a.onUnavailableObject(f.reason);var p=f.value,m=p[0],v=p[1],h;if(v.compiledFmla===void 0){var S=a.docs.getServerValue(c);if(!(0,Am.isSuccess)(S))return a.onUnavailableObject(S.reason);h=a.docs.renderValueBarText(c,S.value.oper,v.fmla)}else{var y=v.compiledFmla.getValue();h=(0,Am.isSuccess)(y)?a.docs.printFormulaBarText(m,v.origin,y.value):y}if(!(0,Am.isSuccess)(h))return void a.log.push({kind:Qv.PrintFormulaStatistics,stats:{samples:[],failures:[h.reason]}});var C=(0,SK.anonymizeFormulaString)(v.fmla),E=h.value===v.fmla?{expected:C,p:l}:{expected:C,sampled:(0,SK.anonymizeFormulaString)(h.value),p:l};a.log.push({kind:Qv.PrintFormulaStatistics,stats:{samples:[E],failures:[]}})})},this.config={samplePrecisionEvalRate:this.debugStructRefFF?1:(o=r.samplePrecisionEvalRate)!==null&&o!==void 0?o:0,samplePrecisionPrintFormulaRate:(u=r.samplePrecisionPrintFormulaRate)!==null&&u!==void 0?u:0,samplePrecisionPrintValueRate:(t=r.samplePrecisionPrintValueRate)!==null&&t!==void 0?t:0,rngSeed:(d=r.rngSeed)!==null&&d!==void 0?d:(0,hK.now)()|0},this.rng=new yIr.JSF32(this.config.rngSeed)}return Object.defineProperty(e.prototype,"done",{get:function(){return this.result!==void 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resultLogMessage",{get:function(){return this.createResultLogMessage(dk.Success)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"failedLogMessage",{get:function(){return this.createResultLogMessage(dk.Timeout)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"readonlyDebugLog",{get:function(){return this.log},enumerable:!1,configurable:!0}),e.prototype.setContext=function(r){var n=this;this.stateId=r.stateId,this.docs=r.documents,this.docs.reconfigure({yieldIntervalMs:r.stepBudget/2,totalTimeMs:r.totalBudget},this.docs.limits,this.docs.maxDereferenceCells,this.docs.isServerWorkbookLoad),this.runtime=new CIr.MachineRuntime(this.sampleCells().bind(function(a){var o=a.evalCells,u=a.printCells;return sD.Pledge.all((0,yK.__spreadArray)((0,yK.__spreadArray)([],o.map(n.testEval),!0),u.map(n.testPrint),!0))}).catch(function(a){n.log.push({kind:Qv.UnhandledFailure,reason:a})}))},e.prototype.step=function(){if(!this.result){var r=this.runtime.step();this.result=r.kind===ZPe.TransitionKind.Break||r.kind===ZPe.TransitionKind.Next?void 0:r}},e.prototype.sampleCells=function(){var r=this,n=[],a=[],o=[];return this.docs.getServerAvailableCells().forEach(function(u){var t=u.sheetIdx;return o.push(sD.Pledge.try(function(){r.docs.forEachServerNonBlankCellInSet(t,rEe.dense,function(d){var s=(0,vK.sheetGridCell)(t,d),c=r.config,l=c.samplePrecisionEvalRate,f=c.samplePrecisionPrintFormulaRate,p=c.samplePrecisionPrintValueRate;if(l>0){var m=r.getWeight(s),v=m===void 0?void 0:l>=1?1:(0,hK.fastMin)(1,l*m);v!==void 0&&r.rng.next()<v&&(eEe(r.sampledSets,s),n.push({cell:s,p:v}))}var h=(0,hK.fastMax)(f,p);if(h>0){var S=r.rng.next();if(S<h){var v=r.isValueCell(s)?p:f;S<v&&a.push({cell:s,p:v})}}return!0})})),!0}),sD.Pledge.all(o).bind(function(){return{evalCells:n,printCells:a}})},e.prototype.getWeight=function(r){var n=this.getFormula(r);if(!(0,Am.isSuccess)(n))return this.onUnavailableObject(n.reason);var a=n.value,o=a[1];if(o.compiledFmla!==void 0)return kIr(o.compiledFmla.getValue())},e.prototype.isValueCell=function(r){var n=this.getFormula(r);return(0,Am.isSuccess)(n)?n.value[1].compiledFmla===void 0:(this.onUnavailableObject(n.reason),!1)},e.prototype.resumeToPledge=function(r,n){var a=this;return sD.Pledge.try(function(){try{a.p=n;var o=r();return Array.isArray(o)?o:a.resumeToPledge(o.resume,n)}finally{a.p=void 0}})},e.prototype.getFormula=function(r){var n,a=this.docs.getEditedFormula(r);if(!(0,Am.isSuccess)(a))return a;var o=(n=a.value)!==null&&n!==void 0?n:[r.range,_Ir.blankCellGridFormula],u=o[0],t=o[1],d=(0,vK.lexicalSourceGrid)(t.lexicalKind,(0,vK.sheetGridRange)(r.sheet,u));return(0,Am.success)([d,t])},e.prototype.onRangeFailure=function(r,n,a,o,u){var t;if(this.debugStructRefFF&&n.kind===SIr.ReasonKind.IllFormedFormula&&n.mode===XPe.FormulaMode.ServerCellFormula&&n.message.indexOf("[@[")>=0&&n.message.indexOf("[ ")<0&&n.message.indexOf(" ]")<0){var d=this.docs.getSheetName(r.sheet.document,r.sheet.index),s=(0,bIr.formatGridRange)(this.docs.config.localeInfo,r.range,void 0,(0,Am.isSuccess)(d)?d.value:"<UNEXPECTED SHEET>");(t=this.onAlert)===null||t===void 0||t.call(this,"We need your help!\nYou encountered an error we are having a hard time reproducing.\nCould you please save a copy of your workbook right now, at its current state, and send it to niwilson@microsoft.com?\n"+"For your information, the cell that XLO cannot parse is: ".concat(s,"\n")+"\nThank you!")}var c={samples:[],failures:[n]};this.log.push({kind:Qv.EvalStatistics,stats:c})},e.prototype.onNameFailure=function(){},e.prototype.onNumberFormatFailure=function(){},e.prototype.onInferFormatFailure=function(){},e.prototype.onReturnCellValue=function(){},e.prototype.onUnavailableObject=function(r){var n=(0,ck.unavailable)([r]);this.onUnavailable(n)},e.prototype.onUnavailable=function(r){this.log.push({kind:Qv.UnhandledFailure,reason:r})},e.prototype.hasWrongPrecedent=function(r){var n=this;return r.cells.some(function(a){return $Pe(n.precisionWrongSets,a)})},e.prototype.onSetCellValue=function(r,n,a,o,u){var t=this.getFormula(r);if(!(0,Am.isSuccess)(t))return this.onUnavailableObject(t.reason);var d=t.value,s=d[0],c=d[1],l=this.hasWrongPrecedent(a);return this.logPrecisionResult(r,n,s,c,l)},e.prototype.onSetCellValues=function(r,n,a,o,u){var t=this,d=this.getFormula((0,ck.sheetGridRangeAnchor)(r));if(!(0,Am.isSuccess)(d))return this.onUnavailableObject(d.reason);var s=d.value,c=s[0],l=s[1],f=this.hasWrongPrecedent(a);(0,ck.forEachCellInRange)(r.range,function(p,m,v){return t.logPrecisionResult((0,vK.sheetGridCell)(r.sheet,p),n[m][v],c,l,f),!0})},e.prototype.logPrecisionResult=function(r,n,a,o,u){var t=this.docs.allServerAvailable(r);if(!(0,Am.isSuccess)(t))return this.onUnavailableObject(t.reason);if(t.value===!0){var d=this.docs.getServerValue(r);if(!(0,Am.isSuccess)(d))return this.onUnavailableObject(d.reason);var s=$Pe(this.sampledSets,r),c=this.precisionResult(n,d.value.oper,a,o,s,u);EIr(c)||eEe(this.precisionWrongSets,r);var l={samples:[c],failures:[]};this.log.push({kind:Qv.EvalStatistics,stats:l})}},e.prototype.precisionResult=function(r,n,a,o,u,t){var d=this.p,s=this.docs.config.mathpack,c=$re(s,n),l=this.docs.anonymizeFormula(a,o),f=l[0],p=l[1];if((0,ck.isReadOperEqual)(s,r,n,!0)){var m={expected:c,formula:f,functions:p,root:u,cascaded:t,p:d};return m}var v=$re(s,r);if((0,ck.isNumberOper)(n)&&(0,ck.isNumberOper)(r)){var h=s.toNumber(n),S=s.toNumber(r),y=(0,SK.anonymizeMagnitude)(h===0?S:(S-h)/h),C={expected:c,sampled:v,relMagnitude:y,formula:f,functions:p,root:u,cascaded:t,p:d};return C}var E={expected:c,sampled:v,formula:f,functions:p,root:u,cascaded:t,p:d};return E},e.prototype.createResultLogMessage=function(r){var n,a;if(!(this.log.length===0&&r===dk.Success)){for(var o={samples:[],failures:{}},u={samples:[],failures:{}},t={},d=0,s=this.log;d<s.length;d++){var c=s[d];switch(c.kind){case Qv.EvalStatistics:(n=o.samples).push.apply(n,c.stats.samples);for(var l=0,f=c.stats.failures;l<f.length;l++){var p=f[l];(0,Xre.incrementFailure)(o.failures,p)}break;case Qv.PrintFormulaStatistics:(a=u.samples).push.apply(a,c.stats.samples);for(var m=0,v=c.stats.failures;m<v.length;m++){var p=v[m];(0,Xre.incrementFailure)(u.failures,p)}break;case Qv.UnhandledFailure:(0,Xre.incrementFailure)(t,c.reason);break;default:(0,aEe.assertNever)("calc.calc.PrecisionExperiment.createResultMessage",c)}}return["PrecisionExperiment",r,"stateId = ".concat(this.stateId),"evalStats = ".concat(JSON.stringify(o)),"printStats = ".concat(JSON.stringify(u)),"unhandledFailures = ".concat(JSON.stringify(t))].join(", ")}},e}();vS.PrecisionExperiment=FIr});var CK=Y(fk=>{"use strict";_();Object.defineProperty(fk,"__esModule",{value:!0});fk.Timer=fk.createPerf=void 0;var IIr=1e9,MIr=1e6;function oEe(){return typeof process!="undefined"?{now:function(){var r=process.hrtime(),n=r[0],a=r[1];return(n*IIr+a)/MIr}}:typeof performance!="undefined"?performance:Date}fk.createPerf=oEe;var wIr=function(){function e(r){this.perf=oEe(),this.name=r,this.start()}return e.prototype.start=function(){this.startTimeMS=this.perf.now(),this.splitTimeMS=this.startTimeMS},e.prototype.split=function(r){var n=this.perf.now(),a=n-this.splitTimeMS;console.warn("timer: "+this.name+" @ "+r+" : = "+this.roundMe(a)+" (total = "+this.roundMe(n-this.startTimeMS)+")"),this.splitTimeMS=n},e.prototype.elapsedTime=function(){return this.perf.now()-this.startTimeMS},e.prototype.roundMe=function(r){return Math.round(r*100)/100},e}();fk.Timer=wIr});var RK=Y(_K=>{"use strict";_();Object.defineProperty(_K,"__esModule",{value:!0});_K.watchdog=void 0;var DIr=CK(),uEe=(0,DIr.createPerf)();function xIr(){var e=1/0,r=function(a){if(a===void 0&&(a=""),uEe.now()>e)throw new Error("Time limit exceeded with message: ".concat(a))};return r.arm=function(n){e=uEe.now()+n},r}_K.watchdog=xIr()});var ene=Y(TK=>{"use strict";_();Object.defineProperty(TK,"__esModule",{value:!0});TK.ExcelUtils=void 0;var Ig=RK(),dEn=TK.ExcelUtils=function(){function e(){}return e.column_name_to_index=function(r){if(r.length===1)return r[0].charCodeAt(0)-"A".charCodeAt(0)+1;for(var n=0,a=r.split(""),o=0,u=a;o<u.length;o++){var t=u[o];n*=26,n+=t.charCodeAt(0)-"A".charCodeAt(0)+1}return n},e.column_index_to_name=function(r){for(var n="";r>0;)n+=String.fromCharCode((r-1)%26+65),r=Math.floor((r-1)/26);return n.split("").reverse().join("")},e.cell_dependency=function(r,n,a){(0,Ig.watchdog)("wd0x1a9bd3");var o=!1;{var u=e.cell_both_absolute.exec(r);if(u){var t=e.column_name_to_index(u[1]),d=Number(u[2]);return u[2][0]>="\u2000"&&(d=Number(u[2].charCodeAt(0)-16384)),[t,d,0]}}(0,Ig.watchdog)("wd0xa26bda");{var u=e.cell_col_absolute.exec(r);if(u){var t=e.column_name_to_index(u[1]),d=Number(u[2]);return u[2][0]>="\u2000"&&(d=Number(u[2].charCodeAt(0)-16384)),[t,d-a,0]}}(0,Ig.watchdog)("wd0x2a23e1");{var u=e.cell_row_absolute.exec(r);if(u){var t=e.column_name_to_index(u[1]),d=Number(u[2]);return u[2][0]>="\u2000"&&(d=Number(u[2].charCodeAt(0)-16384)),[t-n,d,0]}}(0,Ig.watchdog)("wd0x3ebc91");{var u=e.cell_both_relative.exec(r);if(u){var t=e.column_name_to_index(u[1]),d=Number(u[2]);return u[2][0]>="\u2000"&&(d=Number(u[2].charCodeAt(0)-16384)),[t-n,d-a,0]}}throw new Error("We should never get here.")},e.toR1C1=function(r,n,a){a===void 0&&(a=!1);var o=e.cell_dependency(r,0,0),u=e.cell_dependency(n,0,0),t="R",d="C";a&&(t="\u03C1",d="\u03B3");var s=[];u.forEach(function(l,f,p){s.push(l-o[f])});var c="";return e.cell_both_absolute.exec(n)?c=t+u[1]+d+u[0]:e.cell_col_absolute.exec(n)?(s[1]===0?c+=t:c+=t+"["+s[1]+"]",c+=d+u[0]):e.cell_row_absolute.exec(n)?(s[0]===0?c+=d:c+=d+"["+s[0]+"]",c=t+u[1]+c):(s[1]===0?c+=t:c+=t+"["+s[1]+"]",s[0]===0?c+=d:c+=d+"["+s[0]+"]"),c},e.formulaToR1C1=function(r,n,a){for(var o=r.slice(),u=e.column_index_to_name(n)+a,t;t=e.range_pair.exec(o);)if(t){var d=t[1],s=t[2];o=o.replace(t[0],e.toR1C1(u,t[1],!0)+":"+e.toR1C1(u,t[2],!0))}for(var c=null;c=e.single_dep.exec(o);)if(c){var d=c[1];o=o.replace(c[0],e.toR1C1(u,d,!0))}return o=o.replace(/ρ/g,"R"),o=o.replace(/γ/g,"C"),o},e.extract_sheet_cell=function(r){(0,Ig.watchdog)("wd0x012630");var n=e.sheet_plus_cell.exec(r);return n?[n[1],n[2],n[2]]:["","",""]},e.all_cell_dependencies=function(r,n,a,o){o===void 0&&(o=!0),(0,Ig.watchdog)("wd0x2f82fe");var u=r,t=null,d=[];if(typeof r!="string")return null;for(r=r.replace(this.formulas_with_numbers,"_"),r=r.replace(this.formulas_with_quoted_sheetnames_2,"_"),r=r.replace(this.formulas_with_quoted_sheetnames_1,"_"),r=r.replace(this.formulas_with_unquoted_sheetnames_2,"_"),r=r.replace(this.formulas_with_unquoted_sheetnames_1,"_"),r=r.replace(this.formulas_with_unquoted_sheetnames_1,"_"),r=r.replace(this.formulas_with_structured_references,"_");t=e.range_pair.exec(r);)if((0,Ig.watchdog)("wd0x784918"),t){for(var s=t[1],c=e.cell_dependency(s,n,a),l=t[2],f=e.cell_dependency(l,n,a),p=f[0]-c[0]+1,m=f[1]-c[1]+1,v=0;v<p;v++)for(var h=0;h<m;h++)d.push([v+c[0],h+c[1],0]);r=r.replace(t[0],"_")}for(var S=null;S=e.single_dep.exec(r);)if((0,Ig.watchdog)("wd0x0fb232"),S){var s=S[1],y=e.cell_dependency(s,n,a);d.push(y),r=r.replace(S[0],"_")}if(o)for(var C=null;C=e.number_dep.exec(r);)(0,Ig.watchdog)("wd0xd82ed1"),C&&(d.push([0,0,1]),r=r.replace(C[0],"_"));return d},e.numeric_constants=function(r){var n=[];if(r=r.slice(),typeof r!="string")return n;r=r.replace(this.formulas_with_numbers,"_"),r=r.replace(this.formulas_with_quoted_sheetnames_2,"_"),r=r.replace(this.formulas_with_quoted_sheetnames_1,"_"),r=r.replace(this.formulas_with_unquoted_sheetnames_2,"_"),r=r.replace(this.formulas_with_unquoted_sheetnames_1,"_"),r=r.replace(this.formulas_with_unquoted_sheetnames_1,"_"),r=r.replace(this.formulas_with_structured_references,"_");for(var a=null;a=e.range_pair.exec(r);)a&&(r=r.replace(a[0],"_"));for(var o=null;o=e.single_dep.exec(r);)o&&(r=r.replace(o[0],"_"));for(var u=null;u=e.number_dep.exec(r);)u&&(n.push(parseFloat(u)),r=r.replace(u[0],"_"));return n},e.baseVector=function(){return[0,0,0]},e.all_dependencies=function(r,n,a,o,u){(0,Ig.watchdog)("wd0x961028");var t=[];if(r>=u.length||n>=u[0].length||r<0||n<0)return[];var d=u[r][n];return d.length>1&&d[0]==="="&&(t=e.all_cell_dependencies(d,o,a)),t},e.generate_all_references=function(r,n,a){(0,Ig.watchdog)("wd0x6a6002");for(var o={},u=0;u<r.length;u++)for(var t=r[u],d=0;d<t.length;d++){(0,Ig.watchdog)("wd0x93d412");var s=t[d];if(s[0]==="=")for(var c=e.all_cell_dependencies(s,0,0),l=0,f=c;l<f.length;l++){var p=f[l];if((0,Ig.watchdog)("wd0x8a466e"),!(p[0]===0&&p[1]===0&&p[2]!==0)){var m=p[0]-n-1,v=p[1]-a-1,h=v>=r.length||m>=r[0].length||m<0||v<0;{var S=!1;if(h)S=!0;else{var y=r[v][m];y!==void 0&&y[0]!=="="&&(S=!0)}if(S){var C=p.join(",");o[C]=!0}}}}}return o},e.general_re="\\$?[A-Z][A-Z]?\\$?[\\d\\u2000-\\u6000]+",e.sheet_re="[^\\!]+",e.sheet_plus_cell=new RegExp("("+e.sheet_re+")\\!("+e.general_re+")"),e.sheet_plus_range=new RegExp("("+e.sheet_re+")\\!("+e.general_re+"):("+e.general_re+")"),e.single_dep=new RegExp("("+e.general_re+")"),e.range_pair=new RegExp("("+e.general_re+"):("+e.general_re+")","g"),e.number_dep=new RegExp("([0-9]+\\.?[0-9]*)"),e.cell_both_relative=new RegExp("[^\\$A-Z]?([A-Z][A-Z]?)([\\d\\u2000-\\u6000]+)"),e.cell_col_absolute=new RegExp("\\$([A-Z][A-Z]?)([\\d\\u2000-\\u6000]+)"),e.cell_row_absolute=new RegExp("[^\\$A-Z]?([A-Z][A-Z]?)\\$([\\d\\u2000-\\u6000]+)"),e.cell_both_absolute=new RegExp("\\$([A-Z][A-Z]?)\\$([\\d\\u2000-\\u6000]+)"),e.formulas_with_numbers=new RegExp("/ATAN2|BIN2DEC|BIN2HEX|BIN2OCT|DAYS360|DEC2BIN|DEC2HEX|DEC2OCT|HEX2BIN|HEX2DEC|HEX2OCT|IMLOG2|IMLOG10|LOG10|OCT2BIN|OCT2DEC|OCT2HEX|SUNX2MY2|SUMX2PY2|SUMXMY2|T.DIST.2T|T.INV.2T/","g"),e.formulas_with_quoted_sheetnames_1=new RegExp("'[^']*'!\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_quoted_sheetnames_2=new RegExp("'[^']*'!\\$?[A-Z][A-Z]?\\$?\\d+:\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_unquoted_sheetnames_1=new RegExp("[A-Za-z0-9]+!\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_unquoted_sheetnames_2=new RegExp("[A-Za-z0-9]+!\\$?[A-Z][A-Z]?\\$?\\d+:\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_structured_references=new RegExp("\\[([^\\]])*\\]","g"),e.originalSheetSuffix="_EL",e}()});var sEe=Y(bK=>{"use strict";_();Object.defineProperty(bK,"__esModule",{value:!0});bK.RectangleUtils=void 0;var LIr=function(){function e(){}return e.is_adjacent=function(r,n){var a=r[0],o=a[0],u=a[1],t=a[2],d=r[1],s=d[0],c=d[1],l=d[2],f=n[0],p=f[0],m=f[1],v=f[2],h=n[1],S=h[0],y=h[1],C=h[2],E=1,I=!(o-S>E||p-s>E||u-y>E||m-c>E);return I},e.bounding_box=function(r,n){var a=r[0],o=a[0],u=a[1],t=a[2],d=r[1],s=d[0],c=d[1],l=d[2],f=n[0],p=f[0],m=f[1],v=f[2],h=n[1],S=h[0],y=h[1],C=h[2];return[[Math.min(o,p),Math.min(u,m),0],[Math.max(s,S),Math.max(c,y),0]]},e.area=function(r){var n=r[0],a=n[0],o=n[1],u=n[2],t=r[1],d=t[0],s=t[1],c=t[2],l=d-a+1,f=s-o+1;return l*f},e.diagonal=function(r){var n=r[0],a=n[0],o=n[1],u=n[2],t=r[1],d=t[0],s=t[1],c=t[2],l=d-a+1,f=s-o+1;return Math.sqrt(l*l+f*f)},e.overlap=function(r,n){var a=r[0],o=a[0],u=a[1],t=a[2],d=r[1],s=d[0],c=d[1],l=d[2],f=n[0],p=f[0],m=f[1],v=f[2],h=n[1],S=h[0],y=h[1],C=h[2],E=0,I=0;return s>S?E=S-o+1:E=s-p+1,c>y?I=y-u+1:I=c-m+1,E*I},e.is_mergeable=function(r,n){return e.is_adjacent(r,n)&&e.area(r)+e.area(n)-e.overlap(r,n)===e.area(e.bounding_box(r,n))},e}();bK.RectangleUtils=LIr});var lEe=Y(PK=>{"use strict";_();Object.defineProperty(PK,"__esModule",{value:!0});PK.JSONclone=void 0;var BIr=function(){function e(){}return e.clone=function(r){if(r){if(Array.isArray(r))return r.slice();if(r.constructor===Object){for(var n={},a=0,o=Object.keys(r);a<o.length;a++){var u=o[a];n[u]=e.clone(r[u])}return n}return r}return null},e}();PK.JSONclone=BIr});var cEe=Y(pk=>{"use strict";_();Object.defineProperty(pk,"__esModule",{value:!0});pk.Stencil=pk.InfoGain=void 0;var qIr=function(){function e(){}return e.normalized_entropy=function(r){for(var n=r.reduce(function(t,d){return t+d},0),a=0,o=0;o<r.length;o++){var u=r[o]/n;u!==0&&(a-=u*Math.log2(u))}return a/Math.log2(n)},e}();pk.InfoGain=qIr;var SEn=pk.Stencil=function(){function e(){}return e.initialize=function(){if(!e.initialized){if(e.stencil_right=e.stencil.filter(function(n){var a=n[0],o=n[1];return a<=0}),e.stencil_left=e.stencil.filter(function(n){var a=n[0],o=n[1];return a>=0}),e.stencil_top=e.stencil.filter(function(n){var a=n[0],o=n[1];return o>=0}),e.stencil_bottom=e.stencil.filter(function(n){var a=n[0],o=n[1];return o<=0}),e.stencil_topleft=e.stencil_top.filter(function(n){var a=n[0],o=n[1];return a>=0}),e.stencil_topright=e.stencil_top.filter(function(n){var a=n[0],o=n[1];return a<=0}),e.stencil_bottomleft=e.stencil_bottom.filter(function(n){var a=n[0],o=n[1];return a>=0}),e.stencil_bottomright=e.stencil_bottom.filter(function(n){var a=n[0],o=n[1];return a<=0}),e.reflectStencils){var r=void 0;r=e.stencil.filter(function(n){var a=n[0],o=n[1];return a>0}).map(function(n){var a=n[0],o=n[1];return[-a,o]}),e.stencil_right=e.stencil_right.concat(r),r=e.stencil.filter(function(n){var a=n[0],o=n[1];return a<0}).map(function(n){var a=n[0],o=n[1];return[-a,o]}),e.stencil_left=e.stencil_left.concat(r),r=e.stencil.filter(function(n){var a=n[0],o=n[1];return o<0}).map(function(n){var a=n[0],o=n[1];return[a,-o]}),e.stencil_top=e.stencil_top.concat(r),r=e.stencil.filter(function(n){var a=n[0],o=n[1];return o>0}).map(function(n){var a=n[0],o=n[1];return[a,-o]}),e.stencil_bottom=e.stencil_bottom.concat(r),r=e.stencil_top.filter(function(n){var a=n[0],o=n[1];return a<0}).map(function(n){var a=n[0],o=n[1];return[-a,o]}),e.stencil_topleft=e.stencil_topleft.concat(r),r=e.stencil_left.filter(function(n){var a=n[0],o=n[1];return o<0}).map(function(n){var a=n[0],o=n[1];return[a,-o]}),e.stencil_topleft=e.stencil_topleft.concat(r),e.stencil_topleft.splice(e.stencil_topleft.findIndex(function(n){return JSON.stringify(n)===JSON.stringify([1,1])}),1),r=e.stencil_top.filter(function(n){var a=n[0],o=n[1];return a>0}).map(function(n){var a=n[0],o=n[1];return[-a,o]}),e.stencil_topright=e.stencil_topright.concat(r),r=e.stencil_right.filter(function(n){var a=n[0],o=n[1];return o<0}).map(function(n){var a=n[0],o=n[1];return[a,-o]}),e.stencil_topright=e.stencil_topright.concat(r),e.stencil_topright.splice(e.stencil_topright.findIndex(function(n){return JSON.stringify(n)===JSON.stringify([-1,1])}),1),r=e.stencil_bottom.map(function(n){var a=n[0],o=n[1];return[-a,o]}).filter(function(n){var a=n[0],o=n[1];return a>0}),e.stencil_bottomleft=e.stencil_bottomleft.concat(r),r=e.stencil_left.map(function(n){var a=n[0],o=n[1];return[a,-o]}).filter(function(n){var a=n[0],o=n[1];return o<0}),e.stencil_bottomleft=e.stencil_bottomleft.concat(r),e.stencil_bottomleft.splice(e.stencil_bottomleft.findIndex(function(n){return JSON.stringify(n)===JSON.stringify([1,-1])}),1),r=e.stencil_bottom.map(function(n){var a=n[0],o=n[1];return[-a,o]}).filter(function(n){var a=n[0],o=n[1];return a<0}),e.stencil_bottomright=e.stencil_bottomright.concat(r),r=e.stencil_right.map(function(n){var a=n[0],o=n[1];return[a,-o]}).filter(function(n){var a=n[0],o=n[1];return o<0}),e.stencil_bottomright=e.stencil_bottomright.concat(r),e.stencil_bottomright.splice(e.stencil_bottomright.findIndex(function(n){return JSON.stringify(n)===JSON.stringify([-1,-1])}),1)}e.initialized=!0}},e.apply_stencil=function(r,n,a,o,u,t){var d;if(r.length!==e.stencil.length)throw Error("Length mismatched");for(var s=u,c=0;c<r.length;c++){var l=(d=r[c],d[0]),f=d[1];s=t(s,n[a+f][o+l])}return s},e.stencil_computation=function(r,n,a){e.initialize();for(var o=r.length,u=r[0].length,t=Array(o).fill(0).map(function(){return Array(u).fill(0)}),d=1;d<u-1;d++)for(var s=1;s<o-1;s++)t[s][d]=e.apply_stencil(e.stencil,r,d,s,a,n);for(var s=1;s<u-1;s++)t[0][s]=e.apply_stencil(e.stencil_top,r,0,s,a,n),t[o-1][s]=e.apply_stencil(e.stencil_bottom,r,o-1,s,a,n);for(var d=1;d<o-1;d++)t[d][0]=e.apply_stencil(e.stencil_left,r,d,0,a,n),t[d][u-1]=e.apply_stencil(e.stencil_right,r,d,u-1,a,n);return t[0][0]=e.apply_stencil(e.stencil_topleft,r,0,0,a,n),t[0][u-1]=e.apply_stencil(e.stencil_topright,r,0,u-1,a,n),t[o-1][0]=e.apply_stencil(e.stencil_bottomleft,r,o-1,0,a,n),t[o-1][u-1]=e.apply_stencil(e.stencil_bottomright,r,o-1,u-1,a,n),t},e.reflectStencils=!0,e.ninePointStencil=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,0],[0,1],[1,-1],[1,0],[1,1]],e.stencil=e.ninePointStencil,e.initialized=!1,e}()});var fEe=Y(mk=>{"use strict";_();Object.defineProperty(mk,"__esModule",{value:!0});mk.strict_binsearch=mk.binsearch=void 0;function dEe(e,r,n){for(var a=e.length,o=0,u=a;o<u;){var t=Math.floor((o+u)/2);n(e[t],r)<0?o=t+1:u=t}return o}function UIr(e,r,n){return n===void 0&&(n=void 0),typeof n=="undefined"&&(n=function(o,u){return o===u?0:o<u?-1:1}),dEe(e,r,n)}mk.binsearch=UIr;function GIr(e,r,n){n===void 0&&(n=void 0);var a=dEe(e,r,n);return a===e.length||n(e[a],r)!==0?-1:a}mk.strict_binsearch=GIr});var hEe=Y(ay=>{"use strict";_();Object.defineProperty(ay,"__esModule",{value:!0});ay.numComparator=ay.find_all_proposed_fixes=ay.Colorize=ay.tuple=void 0;var lD=ene(),gk=sEe(),pEe=CK(),KIr=lEe(),VIr=cEe(),wf=RK(),vk=fEe();function gEe(e,r){if(typeof e=="number")return e-r;e=e,r=r;for(var n=0;n<e.length;n+=1){var a=gEe(e[n],r[n]);if(a!==0)return a}return 0}function rne(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return e}ay.tuple=rne;var WIr=ay.Colorize=function(){function e(){}return e.setReportingThreshold=function(r){e.reportingThreshold=r},e.getReportingThreshold=function(){return e.reportingThreshold},e.setFormattingDiscount=function(r){e.formattingDiscount=r},e.getFormattingDiscount=function(){return e.formattingDiscount},e.process_formulas=function(r,n,a){(0,wf.watchdog)("wd0xea1170");for(var o=JSON.stringify(lD.ExcelUtils.baseVector()),u=function(C,E){return[C[0]+E[0],C[1]+E[1],C[2]+E[2]]},t=[],d=0;d<r.length;d++){(0,wf.watchdog)("wd0xa1597b");for(var s=r[d],c=0;c<s.length;c++){(0,wf.watchdog)("wd0x0d7fc8");var l=s[c].toString();if(l.length>0){var f=lD.ExcelUtils.all_dependencies(d,c,a+d,n+c,r),p=c+n+1,m=d+a+1;if(f.length===0)l[0]==="="&&t.push([[p,m,0],e.distinguishedZeroHash]);else{var v=f.reduce(u);if(JSON.stringify(v)===o)t.push([[p,m,0],v.toString()]);else{var h=this.hash_vector(v),S=h.toString();t.push([[p,m,0],S])}}}}}return t},e.color_all_data=function(r){for(var n=[],a=0,o=Object.keys(r);a<o.length;a++){var u=o[a];(0,wf.watchdog)("wd0xc22046");var t=u.split(","),d=Number(t[0]),s=Number(t[1]);n.push([[d,s,0],e.distinguishedZeroHash])}return n},e.process_values=function(r,n,a,o){for(var u=[],t=0;t<r.length;t++){(0,wf.watchdog)("wd0x503d57");for(var d=r[t],s=0;s<d.length;s++){(0,wf.watchdog)("wd0x366ad1");var c=d[s].toString();if(c.length>0&&n[t][s][0]!=="="){var l=Number(c).toString();if(l===c){var f=s+a+1,p=t+o+1;u.push([[f,p,1],e.distinguishedZeroHash])}}}}return u},e.identify_ranges=function(r,n){for(var a={},o=0,u=r;o<u.length;o++){var t=u[o];(0,wf.watchdog)("wd0x770d8c"),a[t[1]]=a[t[1]]||[],a[t[1]].push(t[0])}for(var d=0,s=Object.keys(a);d<s.length;d++){var c=s[d];(0,wf.watchdog)("wd0x84ae4d"),a[c].sort(n)}return a},e.group_ranges=function(r,n){var a={},o=0,u=1;n||(o=1,u=0);for(var t=0,d=Object.keys(r);t<d.length;t++){var s=d[t];(0,wf.watchdog)("wd0xa372ae"),a[s]=[];for(var c=r[s].shift(),l=c,f=0,p=r[s];f<p.length;f++){var m=p[f];m[o]===l[o]&&m[u]===l[u]+1||(a[s].push([c,l]),c=m),l=m}a[s].push([c,l])}return a},e.identify_groups=function(r){var n=function(s,c){return s[0]===c[0]?s[1]-c[1]:s[0]-c[0]},a=this.identify_ranges(r,n),o=this.group_ranges(a,!0),u=KIr.JSONclone.clone(o),t=this.merge_groups(u);return t},e.processed_to_matrix=function(r,n,a,o,u){for(var t,d=new Array(r),s=0;s<r;s++)d[s]=new Array(n).fill(0);for(var c=0,l=u;c<l.length;c++){var f=l[c],p=(t=f[0],t[0]),m=t[1],v=t[2],h=f[1],S=m-o-1,y=p-a-1,C=Number(e.distinguishedZeroHash);v===1||(C=Number(h)),d[S][y]=C}return d},e.stencilize=function(r){var n=VIr.Stencil.stencil_computation(r,function(a,o){return a*o},1);return n},e.compute_stencil_probabilities=function(r,n,a){for(var o=new Array(r),u=0;u<r;u++)o[u]=new Array(n).fill(0);for(var t=0,d={},u=0;u<r;u++)for(var s=0;s<n;s++)d[a[u][s]]=d[a[u][s]]+1||1,a[u][s]!==0&&(t+=1);for(var u=0;u<r;u++)for(var s=0;s<n;s++)o[u][s]=d[a[u][s]]/t;for(var c=0,l=0,u=0;u<r;u++)for(var s=0;s<n;s++)a[u][s]>0&&(l+=d[a[u][s]]);for(var u=0;u<r;u++)for(var s=0;s<n;s++)d[a[u][s]]>0&&(c+=this.entropy(d[a[u][s]]/l));var f=c/Math.log2(t);return o},e.generate_suspicious_cells=function(r,n,a,o,u,t,d){d===void 0&&(d=.01);for(var s=[],c=0,l=0,f=0;f<r;f++)for(var p=0;p<n;p++){var m=p+a+1,v=f+o+1;t[f][p]>0&&(c+=u[f][p],l+=1,t[f][p]<=d&&u[f][p]!==0&&s.push([m,v,t[f][p]]))}var h=c/l;return s.sort(function(S,y){return Math.abs(y[2]-h)-Math.abs(S[2]-h)}),s},e.process_suspicious=function(r,n,a){var o;(0,wf.watchdog)("wd0x72fd38");var u=new pEe.Timer("process_suspicious"),t=(o=lD.ExcelUtils.extract_sheet_cell(r),o[0]),d=o[1],s=lD.ExcelUtils.cell_dependency(d,0,0),c=[];n.length>this.formulasThreshold?console.warn("Too many formulas to perform formula analysis."):c=e.process_formulas(n,s[0]-1,s[1]-1);var l=!1,f=[],p=[],m=a.length,v=a[0].length;if(a.length>this.valuesThreshold)console.warn("Too many values to perform reference analysis.");else{var h=lD.ExcelUtils.generate_all_references(n,s[0]-1,s[1]-1);f=e.color_all_data(h),p=e.process_values(a,n,s[0]-1,s[1]-1)}var S=e.identify_groups(f),y=e.identify_groups(c),C=[];a.length<1e4&&(C=e.find_suspicious_cells(m,v,s,n,c,p,1));var E=e.generate_proposed_fixes(y);return rne(C,y,S,E)},e.entropy=function(r){return-r*Math.log2(r)},e.entropydiff=function(r,n){var a=r+n,o=this.entropy(r/a)+this.entropy(n/a),u=o/Math.log2(a);return-u},e.fix_metric=function(r,n,a,o){var u=n[0],t=n[1],d=o[0],s=o[1],c=gk.RectangleUtils.area([[u[0],u[1],0],[t[0],t[1],0]]),l=gk.RectangleUtils.area([[d[0],d[1],0],[s[0],s[1],0]]),f=Math.min(c,l),p=Math.max(c,l),m=Math.min(a,r),v=Math.max(a,r),h=Math.abs(v-m)/this.Multiplier;h<1&&(h=1);var S=this.entropydiff(f,p),y=(1+S)/(h*f);return y=-y,y},e.count_proposed_fixes=function(r){var n,a,o=0;for(var u in r){var t=(n=r[u][1],n[0]),d=n[1],s=(a=r[u][2],a[0]),c=a[1];o+=gk.RectangleUtils.diagonal([[t[0],t[1],0],[d[0],d[1],0]]),o+=gk.RectangleUtils.diagonal([[s[0],s[1],0],[c[0],c[1],0]])}return o},e.fix_proposed_fixes=function(r){var n=0,a={},o={};for(var u in r){if(r[u][1]>r[u][2]){var t=r[u][1];r[u][1]=r[u][2],r[u][2]=t}a[JSON.stringify(r[u][1])]=r[u],o[JSON.stringify(r[u][2])]=r[u]}var d=[],s={};for(var u in r){var c=r[u][0];if(!(-c<e.reportingThreshold/100)){var l=JSON.stringify(r[u][1]),f=JSON.stringify(r[u][2]);if(!(l in o)&&!(f in a))d.push(r[u]);else{if(!s[l]&&l in o){var p=-c*JSON.parse(o[l][0]),m=[p,r[u][1],o[l][1]];d.push(m),s[l]=!0,s[f]=!0;continue}if(!s[f]&&f in a){var p=-c*JSON.parse(a[f][0]),m=[p,r[u][1],a[f][2]];d.push(m),s[f]=!0,s[l]=!0}}}}return d},e.generate_proposed_fixes=function(r){var n=vEe(r);return n.sort(gEe),n},e.merge_groups=function(r){for(var n=0,a=Object.keys(r);n<a.length;n++){var o=a[n];(0,wf.watchdog)("wd0x781a33");var u=r[o].slice();r[o]=this.merge_individual_groups(u)}return r},e.merge_individual_groups=function(r){var n=new pEe.Timer("merge_individual_groups"),a=0;for(r=r.sort();;){(0,wf.watchdog)("wd0x0a3668");for(var o=!1,u={},t=[],d=r.slice();d.length>0;)for(var s=d.shift(),c=0;c<d.length;c++)if((0,wf.watchdog)("wd0x9cf1d5"),gk.RectangleUtils.is_mergeable(s,d[c])){var l=JSON.stringify(s),f=JSON.stringify(d[c]);if(!(l in u)&&!(f in u)){t.push(gk.RectangleUtils.bounding_box(s,d[c])),u[l]=!0,u[f]=!0,o=!0;break}}for(var c=0;c<r.length;c++)(0,wf.watchdog)("wd0x1bc2bb"),JSON.stringify(r[c])in u||t.push(r[c]);if(t.sort(),!o)return t;if(r=t.slice(),a++,a>2e3)return console.warn("Too many iterations; abandoning this group."),n.split("done, "+a+" iterations."),[[[-1,-1,0],[-1,-1,0]]]}},e.hash_vector=function(r){var n=!0;{var a=0,o=0,u=Math.abs(r[0]-a),t=Math.abs(r[1]-o),d=r[2];return this.Multiplier*(u+t+d)}{var a=-7,o=-3,u=r[0]-a;u=u*u;var t=r[1]-o;t=t*t;var d=r[2];return this.Multiplier*Math.sqrt(u+t+d)}},e.adjust_proposed_fixes=function(r,n,a,o){var u=r.map(function(t){var d=t[0];if(-d*100<1)return null;for(var s=t[1].map(function(J){return J.toString().padStart(10,"0")}),c=t[2].map(function(J){return J.toString().padStart(10,"0")}),l=s<c?t[1]:t[2],f=s<c?t[2]:t[1],p=l[0],m=p[0],v=p[1],h=l[1],S=h[0],y=h[1],C=f[0],E=C[0],I=C[1],F=f[1],w=F[0],B=F[1],k=m-a-1,x=v-o-1,G=w-a-1,H=B-o-1,L=!0,D=JSON.stringify(n[x][k]),U=x;U<=H;U++)for(var V=k;V<=G;V++){var ne=JSON.stringify(n[U][V]);if(ne!==D){L=!1;break}}return rne(d,l,f,L)}).filter(function(t){return t!==null});return u},e.find_suspicious_cells=function(r,n,a,o,u,t,d){return(0,wf.watchdog)("wd0x8cabd6"),[];var s;{t=t;var c=e.processed_to_matrix(r,n,a[0]-1,a[1]-1,u.concat(t)),l=e.stencilize(c),f=e.compute_stencil_probabilities(r,n,l),p=e.generate_suspicious_cells(r,n,a[0]-1,a[1]-1,c,f,d);if(typeof o!="undefined"){var m=0,v=0;s=p.filter(function(S){var y=o[S[1]-a[1]][S[0]-a[0]];return y.length<1||y[0]!=="="?(v+=S[2],!0):(m+=S[2],v+=S[2],!1)}),console.log("total formula weight = "+m),console.log("total weight = "+v);var h=m/v;console.log("after processing 1, suspiciousCells = "+JSON.stringify(s)),s=s.map(function(S){return[S[0],S[1],S[2]*h]}),console.log("after processing 2, suspiciousCells = "+JSON.stringify(s)),s=s.filter(function(S){return S[2]<=d}),console.log("after processing 3, suspiciousCells = "+JSON.stringify(s))}else s=p}return s},e.reportingThreshold=35,e.suspiciousCellsReportingThreshold=85,e.formattingDiscount=50,e.formulasThreshold=1e4,e.valuesThreshold=1e4,e.Multiplier=1,e.distinguishedZeroHash="12345",e}();function jIr(e,r){var n=e[0],a=e[1],o=r[0],u=r[1];return n[0]!==o[0]?n[0]-o[0]:n[1]-o[1]}function HIr(e,r){for(var n=0,a=Object.keys(e);n<a.length;n++){var o=a[n];(0,wf.watchdog)("wd0xa287cd"),r[o]=e[o].sort(jIr).map(function(u,t,d){return[u[0].map(function(s,c,l){return Number(s)}),u[1].map(function(s,c,l){return Number(s)})]})}}function vEe(e){var r=[],n={};HIr(e,n);for(var a={},o={},u=0,t=Object.keys(e);u<t.length;u++){var d=t[u];(0,wf.watchdog)("wd0xb02b87"),a[d]=n[d].map(function(y,C,E){var I=y[0],F=y[1];return I}),o[d]=n[d].map(function(y,C,E){var I=y[0],F=y[1];return F})}var s=zIr(e),c=Object.keys(e);mEe(c,function(y,C){return s[y][0][0]-s[C][0][0]});var l=c.map(function(y,C,E){return s[y]}),f=Object.keys(e);mEe(f,function(y,C){return s[y][0][1]-s[C][0][1]});for(var p=f.map(function(y,C,E){return s[y]}),m=0,v=Object.keys(e);m<v.length;m++)for(var d=v[m],h=0;h<n[d].length;h++){(0,wf.watchdog)("wd0xe37031");var S=JIr(d,n[d][h],n,c,f,a,o,s,l,p);r=r.concat(S)}return r=r.map(function(y,C,E){return hk(y[1],y[2])<0?[y[0],y[2],y[1]]:[y[0],y[1],y[2]]}),r=QIr(r),r}ay.find_all_proposed_fixes=vEe;function mEe(e,r){for(var n=e.map(function(o,u){return{item:o,index:u}}).sort(function(o,u){return r(o.item,u.item)||o.index-u.index}).map(function(o){var u=o.item;return u}),a=0;a<e.length;a+=1)e[a]=n[a];return e}function QIr(e){var r={};return e.filter(function(n){return!(r[n]=n in r)})}function hk(e,r){for(var n=0;n<3;n++){if(e[n]<r[n])return-1;if(e[n]>r[n])return 1}return 0}ay.numComparator=hk;function zIr(e){for(var r={},n=0,a=Object.keys(e);n<a.length;n++){for(var o=a[n],u=1e6,t=1e6,d=-1e6,s=-1e6,c=0;c<e[o].length;c++){var l=e[o][c][0][0],f=e[o][c][1][0],p=e[o][c][0][1],m=e[o][c][1][1];f>d&&(d=f),l<u&&(u=l),m>s&&(s=m),p<t&&(t=p)}r[o]=[[u,t,0],[d,s,0]]}return r}function YIr(e,r,n,a){var o=e[0],u=e[1],t=r[0],d=r[1],s=[o-1,d,0],c=[t,u-1,0],l=[t+1,u,0],f=[o,d+1,0],p=[],m=-1;if(m=(0,vk.strict_binsearch)(a,s,hk),m!==-1&&n[m][1]===u){var v=[n[m],a[m]];p.push(v)}if(m=(0,vk.strict_binsearch)(a,c,hk),m!==-1&&n[m][0]===o){var v=[n[m],a[m]];p.push(v)}if(m=(0,vk.strict_binsearch)(n,l,hk),m!==-1&&a[m][1]===d){var v=[n[m],a[m]];p.push(v)}if(m=(0,vk.strict_binsearch)(n,f,hk),m!==-1&&a[m][0]===t){var v=[n[m],a[m]];p.push(v)}return p}function JIr(e,r,n,a,o,u,t,d,s,c){var l=r[0],f=r[1],p=[],m=n,v=(0,vk.binsearch)(s,r,function(w,B){return w[0][0]-B[0][0]}),h=(0,vk.binsearch)(c,r,function(w,B){return w[0][1]-B[0][1]}),S,y,C;v>h?(S=a,C=v,y=0):(S=o,C=h,y=1),C>0&&(C-=1);for(var E=function(B){var k=S[B];if(k===e)return"continue";var x=d[k];if(y===0){if(f[0]+1<x[0][0])return"break"}else if(f[1]+1<x[0][1])return"break";if(!(f[0]+1<x[0][0]||f[1]+1<x[0][1]||x[1][0]+1<l[0]||x[1][1]+1<l[1])){var G=YIr(l,f,u[k],t[k]);G.length>0&&(p=p.concat(G.map(function(H,L,D){var U=WIr.fix_metric(parseFloat(e),r,parseFloat(k),H);return[U,r,H]})))}},I=C;I<S.length;I++){var F=E(I);if(F==="break")break}return p}});var yEe=Y(NK=>{"use strict";_();Object.defineProperty(NK,"__esModule",{value:!0});NK.detect_errors=void 0;var EK=ene(),cD=hEe(),XIr=CK(),Sk=RK();function SEe(e,r){for(var n=e[0],a=e[1],o=r[0],u=r[1],t=[],d=n;d<=o;d++)for(var s=a;s<=u;s++)t.push([d,s,0]);return t}function ZIr(e,r,n,a){a===void 0&&(a=1/0),r=r??cD.Colorize.getFormattingDiscount(),n=n??cD.Colorize.getReportingThreshold(),Sk.watchdog.arm(a);for(var o=e.worksheets.map(function(p){if((0,Sk.watchdog)("wd0x8d98cc"),p.formulas.length===0&&p.values.length===0)return{name:"",out:null};var m=p.usedRangeAddress;m=m.replace(/!(!+)/,"!");var v=new XIr.Timer("excelint"),h=cD.Colorize.process_suspicious(m,p.formulas,p.values),S=h[0],y=h[1],C=h[2],E=h[3];(0,Sk.watchdog)("wd0x7919b4");var I=v.elapsedTime(),F=cD.Colorize.adjust_proposed_fixes(E,p.styles,0,0),w=v.elapsedTime(),B=F.map(function(Q){(0,Sk.watchdog)("wd0xfb8f16");var b=Q[0],R=Q[1],P=Q[2],A=Q[3],T=-b;return A||(T*=(100-r)/100),T*100>=n?(0,cD.tuple)(T,R,P,A):null}).filter(function(Q){return Q!==null}),k=function(b,R){return(R[0]-b[0]+1)*(R[1]-b[1]+1)*(R[2]-b[2]+1)},x=v.elapsedTime(),G=B.map(function(Q){(0,Sk.watchdog)("wd0x2375dd");for(var b=Q[1][0][0]===Q[2][0][0]?"vertical":"horizontal",R=[],P=[],A=[],T=[],g=[],O=[],M=[],K=[],W=[],z=Q[3],ee=[k.apply(void 0,Q[1]),k.apply(void 0,Q[2])],ue=0;ue<2;ue++){var ce=Q[ue+1][0],he=ce[1]-1,de=ce[0]-1,pe=p.formulas[he][de],_e=EK.ExcelUtils.numeric_constants(pe);g.push(_e),O.push(O.reduce(function(Pe,Re){return Pe+Re},0));var Ce=EK.ExcelUtils.all_cell_dependencies(pe,de+1,he+1,!1);M.push(Ce.length);var Ne=EK.ExcelUtils.formulaToR1C1(pe,de+1,he+1),Le=EK.ExcelUtils.column_index_to_name(de+1)+(he+1)+":",Oe=Le+Ne;A.push(Ne),T.push(Oe),R.push(pe),P.push(Le+pe),K.push((pe.match(/\$/g)||[]).length),W.push(Ce)}for(var le=Math.abs(O[0]-O[1]),me=[],ue=0;ue<W.length;ue++)if(W[ue].length>0){if(b==="vertical"&&W[ue][0][0]===0&&W[ue][0][1]===-1){me.push("recurrent-formula");break}if(b==="horizontal"&&W[ue][0][0]===-1&&W[ue][0][1]===0){me.push("recurrent-formula");break}}M[0]!==M[1]&&me.push("different-referent-count"),g[0].length!==g[1].length&&(Math.abs(g[0].length-g[1].length)===1?me.push("one-extra-constant"):me.push("number-of-constants-mismatch")),g[0].length>0&&g[1].length>0&&(M[0]+M[1]===0?me.push("both-constants"):M[0]*M[1]===0&&me.push("one-is-all-constants")),A[0]!==A[1]&&JSON.stringify(W[0].sort())!==JSON.stringify(W[1].sort())&&me.push("r1c1-mismatch"),K[0]!==K[1]&&me.push("absolute-ref-mismatch");for(var ue=0;ue<W.length;ue++)if(W[ue].length>0&&W[ue][0][0]*W[ue][0][1]!==0){me.push("off-axis-reference");break}return me.length===0&&me.push("unclassified"),{bin:me,direction:b,sameFormat:z,rangeSizes:ee,numbers:O,sameConstants:g[0]===g[1],numeric_difference:le,magnitude_numeric_difference:le===0?0:Math.log10(le),formulas:P,r1c1formulas:T,dependence_vectors:W}}),H=v.elapsedTime(),L=p.formulas.flat().filter(function(Q){return Q.length>0}).length,D=p.values.flat().filter(function(Q){return Q.length>0}).length,U=p.values[0].length,V=p.values.length,ne=V*U,J=B.map(function(Q){return Q[0]}).reduce(function(Q,b){return Q+b},0),$=B.map(function(Q){return(0,Sk.watchdog)("wd0xbcc23c"),Q[0]>=n/100?SEe(Q[1][0],Q[1][1]).concat(SEe(Q[2][0],Q[2][1])):[]}),Z=Array.from(new Set($.flat(1).map(function(Q){return JSON.stringify(Q)})));$=Z.map(function(Q){return JSON.parse(Q)});var ie=v.elapsedTime(),X={suspiciousnessThreshold:n,formattingDiscount:r,proposedFixes:B,exampleFixes:G,suspiciousRanges:B.length,weightedSuspiciousRanges:J,suspiciousCells:$.length,elapsedTimeSeconds:ie/1e3,proposedFixesTimeSeconds:I/1e3,adjustProposedFixesTimeSeconds:(w-I)/1e3,adjustFormatProposedFixesTimeSeconds:(x-w)/1e3,exampleFixesTimeSeconds:(H-x)/1e3,numCountingTimeSeconds:(ie-H)/1e3,columns:U,rows:V,totalCells:ne,numFormulaCells:L,numValueCells:D};return{name:p.sheetName,out:X}}).filter(function(p){return p.out!==null}),u={},t=0,d=o;t<d.length;t++){var s=d[t],c=s.name,l=s.out;u[c]=l}var f={workbookName:e.workbookName,worksheets:u};return f}NK.detect_errors=ZIr});var CEe=Y(AK=>{"use strict";_();Object.defineProperty(AK,"__esModule",{value:!0});AK.detect_errors=void 0;var $Ir=yEe();Object.defineProperty(AK,"detect_errors",{enumerable:!0,get:function(){return $Ir.detect_errors}})});var TEe=Y(OK=>{_();Object.defineProperty(OK,"__esModule",{value:!0});OK.ExceLintExperiment=void 0;var eMr=br(),_Ee=gs(),rMr=CEe(),nMr=Cn(),tMr=XB(),aMr=iK(),iMr=Ai(),REe=tu(),yk=Di(),oMr=Qu();function uMr(e){for(var r,n,a,o,u=e.getServerDocument(),t=[],d=0,s=e.getServerAvailableCells();d<s.length;d++){var c=s[d],l="UndefinedSheet";if(u!==void 0){var f=e.getSheetName(u,c.sheetIdx.index);f.kind===yk.ResultKind.Success&&(l=f.value)}var p=e.getServerUsedRange(c.sheetIdx);if(!(p.kind===yk.ResultKind.Failure||p.value===void 0)){var m=p.value.sheet,v=(0,eMr.__assign)({},p.value.range);v.cols=Math.min(v.cols,75),v.rows=Math.min(v.rows,1e3);for(var h=[],S=[],y=[],C=0,E=v.row,I=v.row+v.rows-1;E<=I;E+=1){for(var F=[],w=[],B=[],k=v.col,x=v.col+v.cols-1;k<=x;k+=1){var G=(0,_Ee.sheetGridCell)(m,(0,_Ee.gridCell)(E,k)),H=e.getServerValue(G),L=H.kind===yk.ResultKind.Success?JSON.stringify(H.value):"";w.push(L);var D=e.getServerFormat(G),U=D.kind===yk.ResultKind.Success?(0,nMr.fnv1a)(JSON.stringify(D.value)).toString():"";B.push(U);var V=e.getServerFormula(G),ne=V.kind===yk.ResultKind.Success?(n=(r=V.value)===null||r===void 0?void 0:r[1].compiledFmla)===null||n===void 0?void 0:n.getValue():void 0,J=(ne==null?void 0:ne.kind)===yk.ResultKind.Success&&(o=(a=V.value)===null||a===void 0?void 0:a[1].fmla)!==null&&o!==void 0?o:"";J!==""&&(C+=1),F.push(J)}h.push(F),S.push(w),y.push(B)}if(C!==0){var $=(0,tMr.formatGridRange)(e.config.localeInfo,v,oMr.RefStyle.A1,l),Z={sheetName:l,usedRangeAddress:$,values:S,formulas:h,styles:y};t.push(Z)}}}var ie={workbookName:"PartialWorkbook",worksheets:t};return ie}var sMr=function(){function e(r){r===void 0&&(r=75),this.timeLimitMS=r,this.result=void 0}return Object.defineProperty(e.prototype,"done",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.setContext=function(r){var n=r.documents;try{iMr.ulsLogger.ULS.traceTag(578588694,REe.LogCategory.msoulscat_ES_EWAJS,REe.TraceLevel.Info,"calc.calc.RecalcService: ExceLint experiment setContext started");var a=uMr(n);this.result=(0,rMr.detect_errors)(a,void 0,void 0,this.timeLimitMS)}catch(o){this.result="ExceLint experiment crashed with error: ".concat(o)}},e.prototype.step=function(){},Object.defineProperty(e.prototype,"report",{get:function(){var n=this;if(typeof this.result=="undefined"||typeof this.result=="string")return[];var a=Object.keys(this.result.worksheets).map(function(o){var u=n.result.worksheets[o],t=u.exampleFixes.map(function(s,c){var l=u.proposedFixes[c][0],f=s.rangeSizes,p=f.reduce(function(m,v){return m+v},0);return{anomalousnessIndex:l,categories:s.bin,sizeOfCellRange:p,sizeOfEachSFRRange:f,redactedFormulaForEachSFR:s.formulas.map(aMr.anonymizeFormulaString),stylesDiffer:!s.sameFormat,operatorsDiffer:null,direction:s.direction}}),d=t.map(function(s){return s.sizeOfEachSFRRange.length}).reduce(function(s,c){return s+c},0);return{totalFormulas:u.numFormulaCells,totalSimilarFormulaRanges:d,numberOfAdjacentSFRs:t.length,numberOfAnomalousRanges:u.suspiciousRanges,numberOfCellsInAnomalousRanges:u.suspiciousCells,anomalies:t,elapsedTimeSeconds:u.elapsedTimeSeconds,proposedFixesTimeSeconds:u.proposedFixesTimeSeconds,adjustProposedFixesTimeSeconds:u.adjustProposedFixesTimeSeconds,adjustFormatProposedFixesTimeSeconds:u.adjustFormatProposedFixesTimeSeconds,exampleFixesTimeSeconds:u.exampleFixesTimeSeconds,numCountingTimeSeconds:u.numCountingTimeSeconds,columns:u.columns,rows:u.rows}}).filter(function(o){return o.totalFormulas>0});return a},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resultLogMessage",{get:function(){return typeof this.result=="string"?this.result:this.result===void 0?"ExceLint experiment return <undefined>":"ExceLint experiment done. Result: ".concat(JSON.stringify(this.report))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"failedLogMessage",{get:function(){var n=this.resultLogMessage;return n+" BTW, experiment ran out of time budget"},enumerable:!1,configurable:!0}),e}();OK.ExceLintExperiment=sMr});var kK=Y(dD=>{_();Object.defineProperty(dD,"__esModule",{value:!0});dD.Messages=void 0;var nne;dD.Messages=nne;(function(e){e.Root="calc.exp.UnitExperiment",e.Default="uninitialised",e.Initialised="init",e.Failure="fail",e.UnifyBound="unifyBound"})(nne||(dD.Messages=nne={}))});var IK=Y(Is=>{_();Object.defineProperty(Is,"__esModule",{value:!0});Is.areSignaturesEqual=vMr;Is.compose=wEe;Is.createPoisonApplication=bMr;Is.everyVar=Is.everyConst=void 0;Is.fromConstants=IEe;Is.fromVar=pMr;Is.inv=SMr;Is.isSimpleUnit=gMr;Is.makeSignature=Ck;Is.pow=yMr;Is.prod=hMr;Is.serialiseMeasure=_Mr;Is.shuffleNormalForms=CMr;Is.someVar=Is.someConst=void 0;Is.substituteVariable=one;Is.toUnitConstraint=MEe;Is.unify=void 0;var pE=Ai(),zv=kK();function lMr(e,r){for(var n in e)r(n,e[n])}function ane(e,r){for(var n in e)if(!r(n,e[n]))return!1;return!0}var AEe=function(r,n){return!ane(r,function(a,o){return!n(a,o)})},fD=function(r,n){return ane(r.consts,n)};Is.everyConst=fD;var cMr=function(r,n){return AEe(r.consts,n)};Is.someConst=cMr;var OEe=function(r,n){return ane(r.vars,n)};Is.everyVar=OEe;var dMr=function(r,n){return AEe(r.vars,n)};Is.someVar=dMr;function mE(e,r){var n=0;lMr(r.vars,function(){return n+=1}),(0,pE.assertTrue)(e,r.name===void 0||r.varCount===1),(0,pE.assertTrue)(e,r.varCount===n)}function Ck(e,r,n){var a={varCount:e,vars:r,consts:n,name:void 0};return mE(zv.Messages.Root,a),a}function fMr(){}function kEe(){return new fMr}var FEe=kEe();function gE(){return Ck(0,{},kEe())}function IEe(e){return Ck(0,{},e)}function pMr(e){var r,n=Ck(1,(r={},r[e]=1,r),FEe);return n.name=e,n}var ine=function(){return!1};function mMr(e,r){for(var n in e.vars)return r===e.vars[n]?n:void 0}function gMr(e){if(e.varCount===0||e.name!==void 0)return!0;if(e.varCount===1&&(e.consts===FEe||fD(e,ine))){var r=mMr(e,1);return r===void 0?!1:(e.name=r,!0)}return!1}function bEe(e,r){return OEe(e,function(n,a){return r.vars[n]===a})&&fD(e,function(n,a){return r.consts[n]===a})}function vMr(e,r){return bEe(e,r)&&bEe(r,e)}function hMr(e,r){var n,a,o=gE(),u=e.vars,t=e.consts,d=r.vars,s=r.consts;for(var c in u){var l=u[c]+((n=d[c])!==null&&n!==void 0?n:0);l!==0&&(o.vars[c]=l,o.varCount+=1)}for(var c in t){var l=t[c]+((a=s[c])!==null&&a!==void 0?a:0);l!==0&&(o.consts[c]=l)}for(var c in d)u[c]===void 0&&(o.vars[c]=d[c],o.varCount+=1);for(var c in s)t[c]===void 0&&(o.consts[c]=s[c]);return mE(zv.Messages.Root,o),o}function SMr(e){var r=gE(),n=e.vars,a=e.consts;for(var o in n)r.vars[o]=-n[o];for(var o in a)r.consts[o]=-a[o];return r.varCount=e.varCount,mE(zv.Messages.Root,r),r}function yMr(e,r,n){if(r===0)return n;var a=gE(),o=e.vars,u=e.consts;for(var t in o)a.vars[t]=o[t]*r;for(var t in u)a.consts[t]=u[t]*r;return a.varCount=e.varCount,mE(zv.Messages.Root,a),a}function CMr(e,r){var n,a,o=gE(),u=gE(),t=o.vars,d=u.consts;for(var s in e.vars){var c=e.vars[s]-((n=r.vars[s])!==null&&n!==void 0?n:0);c!==0&&(t[s]=c,o.varCount+=1)}for(var s in r.vars)e.vars[s]===void 0&&(t[s]=-r.vars[s],o.varCount+=1);for(var s in r.consts){var c=r.consts[s]-((a=e.consts[s])!==null&&a!==void 0?a:0);c!==0&&(d[s]=c)}for(var s in e.consts)r.consts[s]===void 0&&(d[s]=-e.consts[s]);return mE(zv.Messages.Root,o),mE(zv.Messages.Root,u),(0,pE.assertTrue)(zv.Messages.Root,fD(o,ine)),{vars:o,consts:u}}function MEe(e,r){var n,a,o=gE(),u=e.vars,t=e.consts,d=r.vars,s=r.consts;for(var c in u){var l=u[c]-((n=d[c])!==null&&n!==void 0?n:0);l!==0&&(o.vars[c]=l,o.varCount+=1)}for(var c in t){var l=t[c]-((a=s[c])!==null&&a!==void 0?a:0);l!==0&&(o.consts[c]=l)}for(var c in d)u[c]===void 0&&(o.vars[c]=-d[c],o.varCount+=1);for(var c in s)t[c]===void 0&&(o.consts[c]=-s[c]);return mE(zv.Messages.Root,o),o}function tne(e,r,n,a){return n?r===1?e:"".concat(e,"^").concat(r):r===-1?e:"".concat(e,"^").concat(r*a)}function _Mr(e){var r=[],n=[];for(var a in e.vars){var o=e.vars[a];o>0?r.push([a,o]):n.push([a,o])}for(var u in e.consts){var o=e.consts[u];o>0?r.push([u,o]):n.push([u,o])}if(n.length===0)return r.length===0?"1":r.map(function(s){var c=s[0],l=s[1];return tne(c,l,!0,1)}).join("*");var t=n.map(function(s){var c=s[0],l=s[1];return tne(c,l,!1,-1)}).join("*");if(n.length>1&&(t="("+t+")"),r.length===0)return"1/".concat(t);var d=r.map(function(s){var c=s[0],l=s[1];return tne(c,l,!0,1)}).join("*");return"".concat(d,"/").concat(t)}function one(e,r,n){var a=r.vars,o=r.consts,u=a[e];if(u===void 0)return r;var t=0,d=gE(),s=d.vars,c=d.consts;for(var l in a){var f=n.vars[l],p=f===void 0?0:f,m=l===e,v=(m?0:a[l])+p*u;v!==0&&(t+=1,s[l]=v)}for(var l in n.vars){var h=a[l];h===void 0&&(t+=1,s[l]=u*n.vars[l])}for(var l in o){var S=n.consts[l],v=o[l]+u*(S===void 0?0:S);v!==0&&(c[l]=v)}for(var l in n.consts){var h=o[l];h===void 0&&(c[l]=u*n.consts[l])}return Ck(t,s,c)}var FK=function(){},RMr={kind:1,substitution:FK},PEe=function(r){return{kind:1,substitution:r}},EEe={kind:0},TMr=function(r){return r<0?-r:r};function bMr(e){return function(r,n){if(n.varCount===0||r===FK)return n;var a=n;for(var o in n.vars){var u=r(o);if(u===e)return e;u!==void 0&&(a=one(o,a,u))}return a}}function wEe(e,r,n){var a={};return n===FK?r:r===FK?n:function(o){var u=a[o];if(u!==void 0)return u;var t=n(o);return t===void 0?a[o]=r(o):a[o]=e(r,t)}}function NEe(e,r){return function(n){return e===n?r:void 0}}var PMr=100;function DEe(e,r,n){if(e>=PMr)return(0,pE.assertFalse)(zv.Messages.UnifyBound);if(n.varCount===0)return fD(n,ine)?RMr:EEe;if(n.varCount===1){var a;for(var o in n.vars){a=o;break}(0,pE.assertTrue)(zv.Messages.Root,a!==void 0);var u=n.vars[a],t={};for(var d in n.consts){var s=n.consts[d];if(s%u===0){t[d]=-(s/u);continue}return EEe}return PEe(NEe(a,IEe(t)))}var c,l=0,f=void 0,p=n.vars,m=n.consts,v=n.varCount;for(var d in p){var s=p[d],h=TMr(s);(f===void 0||h<f)&&(l=s,f=h,c=d)}(0,pE.assertTrue)(zv.Messages.Root,c!==void 0),(0,pE.assertTrue)(zv.Messages.Root,l!==0);var S={},y={};for(var d in p)if(d===c)S[d]=1;else{var s=p[d];S[d]=-Math.floor(s/l)}for(var d in m){var s=m[d];y[d]=-Math.floor(s/l)}var C=Ck(v,S,y),E=DEe(e+1,r,one(c,n,C));return E.kind===0?E:PEe(wEe(r,E.substitution,NEe(c,C)))}var EMr=function(r,n,a){return DEe(0,r,MEe(n,a))};Is.unify=EMr});var lne=Y(vo=>{_();Object.defineProperty(vo,"__esModule",{value:!0});vo.dimensionlessNumberType=vo.dimensionLess=vo.bottomType=vo.boolType=vo.ExperimentState=void 0;vo.dimensionsFromType=une;vo.errorType=void 0;vo.getLiftingDimensionsFromTypes=kMr;vo.isResolvedReferenceType=KMr;vo.joinDimensions=qEe;vo.makeArrayType=LEe;vo.makePrimitiveType=c_;vo.makeReferenceType=xEe;vo.makeResolvedReferenceType=OMr;vo.topType=vo.stringType=vo.primitiveUnitType=vo.primitiveType=vo.oneType=vo.numberType=void 0;vo.typeFromDimensions=FMr;var MK=br(),NMr=zu(),AMr=IK(),L0=pv();function c_(e,r){return r===void 0&&(r=void 0),{kind:0,flags:e,unit:r}}function xEe(e){return{kind:1,reference:e,resolution:void 0}}function OMr(e,r){var n=xEe(e);return n.resolution=r,n}function LEe(e,r){return{kind:2,elementType:e,dimensions:r}}function BEe(e){return{kind:3,flags:e}}function une(e){var r;switch(e.kind){case 1:var n=(r=e.resolution)===null||r===void 0?void 0:r.range;return n===void 0?!1:(0,NMr.isGridCell)(n)?!0:{rows:n.rows,columns:n.cols,exact:!0};case 2:return e.dimensions;case 0:return!0;case 3:return!1}}function kMr(e,r){var n=une(e),a=une(r);return qEe(n,a)}function qEe(e,r){return typeof e=="object"?typeof r=="object"?{rows:Math.max(e.rows,r.rows),columns:Math.max(e.columns,r.columns),exact:e.exact&&r.exact}:(0,MK.__assign)((0,MK.__assign)({},e),{exact:e.exact&&r}):typeof r=="object"?(0,MK.__assign)((0,MK.__assign)({},r),{exact:r.exact&&e}):e&&r}function FMr(e,r){return r===!0?e:LEe(e,r)}var IMr=c_(L0.OperKind.Boolean);vo.boolType=IMr;var MMr=c_(L0.OperKind.String);vo.stringType=MMr;var wMr=c_(L0.OperKind.Number);vo.numberType=wMr;var UEe=(0,AMr.fromConstants)({});vo.dimensionLess=UEe;var DMr=c_(L0.OperKind.Number,UEe);vo.dimensionlessNumberType=DMr;var xMr=c_(L0.OperKind.Error);vo.errorType=xMr;var LMr=c_(L0.OperKind.Missing|L0.OperKind.Blank);vo.oneType=LMr;var BMr=BEe(L0.SignatureType.None);vo.bottomType=BMr;var qMr=BEe(L0.SignatureType.All);vo.topType=qMr;var UMr=c_(L0.OperKind.Number|L0.OperKind.Boolean|L0.OperKind.String);vo.primitiveType=UMr;var GMr=function(r){return c_(L0.OperKind.Number|L0.OperKind.Boolean|L0.OperKind.String,r)};vo.primitiveUnitType=GMr;function KMr(e){return e.resolution!==void 0}var sne;vo.ExperimentState=sne;(function(e){e[e.Checking=0]="Checking",e[e.SolvingSimple=1]="SolvingSimple",e[e.SolvingFull=2]="SolvingFull"})(sne||(vo.ExperimentState=sne={}))});var GEe=Y(wK=>{_();Object.defineProperty(wK,"__esModule",{value:!0});wK.UF=void 0;var VMr=function(){function e(){this.roots=[],this.backlinks=[],this.descriptors=[],this.ranks=[]}return e.prototype.makePoint=function(r){var n=this.roots.length;return this.roots.push(n),this.backlinks.push(n),this.descriptors.push(r),this.ranks.push(0),n},e.prototype.find=function(r){for(var n=this.roots,a=r;n[a]!==a;)n[a]=n[n[a]],a=n[a];return a},e.prototype.findWithDescriptor=function(r){var n=this.find(r);return[n,this.descriptors[n]]},e.prototype.union=function(r,n,a){a===void 0&&(a=!1);var o=this.find(r),u=this.find(n);if(o!==u){var t=this.roots,d=this.backlinks,s=this.ranks;if(a){var c=d[u];d[u]=d[o],d[o]=c,t[u]=o,s[o]<=s[u]&&(s[o]=s[u]+1);return}if(s[o]<s[u]){var c=d[o];d[o]=d[u],d[u]=c,t[o]=u}else{var c=d[u];d[u]=d[o],d[o]=c,t[u]=o,s[o]===s[u]&&(s[o]+=1)}}},e.prototype.forEachInClass=function(r,n){var a=this.backlinks,o=r;for(n(o);a[o]!==r;)o=a[o],n(o)},e}();wK.UF=VMr});var JEe=Y(iy=>{_();Object.defineProperty(iy,"__esModule",{value:!0});iy.UnitExperimentSettings=void 0;iy.isInterestingFormat=QEe;iy.makeSolverContext=XMr;iy.numberFormatFromCellFormat=xK;iy.runSolverStep=u3r;iy.updateFormatStatsFromCellFormat=zEe;iy.valueTypeFromCellFormat=YEe;var pD=lne(),SS=IK(),Mg=kK(),WMr=GEe(),jMr=gs(),cne=zu(),wg=Ai(),dne=e0(),HMr=vd(),KEe=x0(),hS=Ll(),jEe=Di(),VEe=Jc(),_k,mne={get UnitlessTimeAndDate(){return(0,VEe.getTypedFeatureGate)("Microsoft.Office.Excel.UnitlessTimeAndDate")},get IgnoreDivMul(){return(0,VEe.getTypedFeatureGate)("Microsoft.Office.Excel.UnitExpIgnoreDivMul")}};iy.UnitExperimentSettings=mne;var Om={kind:0},QMr=function(r){return{kind:1,error:r}},HEe=function(r){return{kind:2,constraint:r}},fne=(0,SS.fromConstants)({error:1}),pne=(0,SS.fromConstants)({}),zMr=(0,SS.fromConstants)({currency:1}),YMr=(0,SS.fromConstants)({date:1}),JMr=(0,SS.fromConstants)({time:1});function XMr(e,r,n){var a=new WMr.UF,o=a.makePoint(fne),u=(0,SS.createPoisonApplication)(fne);return{symbolContext:e,typeContext:r,stats:n,uf:a,errorPoint:o,errorUnit:fne,apply:u}}function gne(e,r){return r.link===void 0&&(r.link=e.uf.makePoint(r.unit)),r.link}function WEe(e,r,n,a){return(0,wg.assertTrue)(Mg.Messages.Root,n.varCount===0),e.uf.union(a===void 0?e.uf.makePoint(n):a,r,!0),Om}function DK(e,r,n,a,o){return r===e.errorUnit?((0,wg.assertTrue)(Mg.Messages.Root,n===e.errorPoint),o!==void 0&&e.uf.union(e.errorPoint,o,!0),Om):a===e.errorUnit?((0,wg.assertTrue)(Mg.Messages.Root,o===e.errorPoint),n!==void 0&&e.uf.union(e.errorPoint,n,!0),Om):r.varCount===0?a.varCount===0?(0,SS.areSignaturesEqual)(r,a)?Om:(n!==void 0&&e.uf.union(e.errorPoint,n,!0),o!==void 0&&e.uf.union(e.errorPoint,o,!0),QMr([r,a])):((0,wg.assertTrue)(Mg.Messages.Root,o!==void 0),WEe(e,o,r,n)):a.varCount===1?((0,wg.assertTrue)(Mg.Messages.Root,n!==void 0),(0,wg.assertTrue)(Mg.Messages.Root,o!==void 0),e.uf.union(n,o),Om):((0,wg.assertTrue)(Mg.Messages.Root,n!==void 0),WEe(e,n,a,o))}function vne(e,r,n){if(!(0,SS.isSimpleUnit)(r))return HEe({kind:2,unit:r,target:n});var a=gne(e,n),o=e.uf.findWithDescriptor(a),u=o[0],t=o[1];if(r.varCount===1){(0,wg.assertTrue)(Mg.Messages.Root,r.name!==void 0);var d=e.symbolContext.getTable().getValue(r.name);(0,wg.assertTrue)(Mg.Messages.Root,d!==void 0);var s=e.uf.findWithDescriptor(gne(e,d)),c=s[0],l=s[1];return DK(e,l,c,t,u)}return DK(e,r,void 0,t,u)}function ZMr(e,r){return vne(e,r.unit,r.target)}function QEe(e,r){if(r===HMr.SpecialFormat.Unavailable||r===0)return!1;var n=xK(e,r);if(n===void 0)return!1;var a=n==null?void 0:n.valueType;return a===void 0||a===hS.FormatValueType.General?!1:a===hS.FormatValueType.Currency||a===hS.FormatValueType.Accounting?n.currencySymbol!==void 0:!0}function zEe(e,r,n,a){var o,u,t;a?n.referencedFormatCells+=1:n.allFormatCells+=1;var d=xK(e,r),s=a?n.enriched.referencedFormatTypes:n.enriched.allFormatTypes,c=d==null?void 0:d.valueType;if(c!==void 0&&(s[c]=((o=s[c])!==null&&o!==void 0?o:0)+1),c===hS.FormatValueType.Currency||c===hS.FormatValueType.Accounting){var l=a?n.enriched.referencedCurrencyTypes:n.enriched.allCurrencyTypes,f=d==null?void 0:d.currencySymbol,p=(u=d==null?void 0:d.culture)===null||u===void 0?void 0:u.culture,m=f===void 0?"none":f===hS.FormatCurrency.LocaleInfo?"defaultSymbol":f+"_"+p;l[m]=((t=l[m])!==null&&t!==void 0?t:0)+1}}function YEe(e,r){var n;return(n=xK(e,r))===null||n===void 0?void 0:n.valueType}function xK(e,r){if(typeof r=="number"){var n=e.getIformat(r);return(0,jEe.isSuccess)(n)?n.value:void 0}return r}function LK(e,r,n){var a=e.typeContext.types[r.index];if(a===void 0)return(0,wg.assertFalse)(Mg.Messages.Root);var o=a.getValue(n);if(o===void 0){var u=(0,jMr.sheetGridCell)(r,n),t=e.typeContext.formats(u);if((0,jEe.isSuccess)(t)){if(!QEe(e.typeContext,t.value)||e.typeContext.isStringValue(u)){var d=e.symbolContext.freshSymbol().unit;return e.typeContext.types[r.index]=a.setValue(n,(0,pD.primitiveUnitType)(d)),d}var s=hne(e,t.value);return s===void 0?s=e.symbolContext.freshSymbol().unit:zEe(e.typeContext,t.value,e.stats,!0),e.typeContext.types[r.index]=a.setValue(n,(0,pD.primitiveUnitType)(s)),s}var c=e.symbolContext.freshSymbol().unit;return e.typeContext.types[r.index]=a.setValue(n,(0,pD.primitiveUnitType)(c)),c}if(o.kind===0)return o.unit}function $Mr(e,r){var n=r.type.resolution;if(!(0,cne.isSheetIndex)(n.sheet))return Om;if((0,cne.isGridCell)(n.range)){var a=LK(e,n.sheet,n.range);return a===void 0?Om:vne(e,a,r.target)}var o=e.typeContext.available[n.sheet.index];if(o===void 0)return Om;var u=o.usedRange;if(u===void 0)return Om;var t=(0,cne.gridRangeIsect)(n.range,u);if(t===void 0)return Om;var d=(0,KEe.intersectProduct)((0,KEe.intersectProduct)((0,dne.createCellSetFromRange)(t),dne.availableReadProduct),o.availableCells),s=[];return(0,dne.forEachCellInSet)(d,function(c){return s.push(c),!0}),{kind:3,constraint:{kind:1,cursor:0,index:o.sheetIdx,cells:s,target:r.target},output:void 0}}function e3r(e,r){var n=r.cursor,a=r.cells;if(n>=a.length)return Om;var o=a[n],u=LK(e,r.index,o),t=u===void 0?Om:vne(e,u,r.target);return r.cursor+=1,{kind:3,constraint:r,output:t}}function hne(e,r){var n=YEe(e.typeContext,r);if(n!==void 0)switch(n){case hS.FormatValueType.Currency:case hS.FormatValueType.Accounting:return zMr;case hS.FormatValueType.Percentage:return pne;case hS.FormatValueType.Date:return mne.UnitlessTimeAndDate?pne:YMr;case hS.FormatValueType.Time:return mne.UnitlessTimeAndDate?pne:JMr;default:return}}function r3r(e,r){var n=hne(e,r.format);if(n===void 0)return Om;var a=LK(e,r.cell.sheet,r.cell.range);if(a===void 0)return Om;if(!(0,SS.isSimpleUnit)(a))return HEe(r);if(a.varCount===1){(0,wg.assertTrue)(Mg.Messages.Root,a.name!==void 0);var o=e.symbolContext.getTable().getValue(a.name);(0,wg.assertTrue)(Mg.Messages.Root,o!==void 0);var u=e.uf.findWithDescriptor(gne(e,o)),t=u[0],d=u[1];return DK(e,d,t,n,void 0)}return DK(e,a,void 0,n,void 0)}function n3r(e){var r=e.symbolContext.getTable();return function(n){var a=r.getValue(n);if(!(a===void 0||a.link===void 0))return a.ufSubstitution===void 0&&(a.ufSubstitution=e.uf.findWithDescriptor(a.link)[1]),a.ufSubstitution}}var t3r=(_k={},_k[2]=ZMr,_k[3]=r3r,_k[0]=$Mr,_k[1]=e3r,_k);function a3r(e){var r=e.context,n=r.apply,a=r.errorUnit,o={kind:pD.ExperimentState.SolvingFull,context:e.context,stats:e.stats,constraints:e.deferred,constraintCursor:0,unifyNF:function(t,d){var s=n(o.substitution,t);if(s!==a){var c=n(o.substitution,d);if(c!==a){var l=(0,SS.unify)(n,s,c);if(l.kind===1){o.substitution=(0,SS.compose)(n,l.substitution,o.substitution);return}o.stats.errorCount+=1,o.stats.enriched.errors.push({error:[n(o.substitution,t),n(o.substitution,d)]})}}},substitution:n3r(e.context)};return o}function i3r(e){var r=e.constraints,n=e.context,a=e.constraintCursor,o=e.deferred,u=r[a],t=t3r[u.kind](n,u);switch(t.kind){case 2:o.push(t.constraint);break;case 1:e.stats.errorCount+=1,e.stats.enriched.errors.push({error:t.error});break;case 3:if(r[a]=t.constraint,t.output!==void 0)switch(t.output.kind){case 2:o.push(t.output.constraint);break;case 1:e.stats.errorCount+=1,e.stats.enriched.errors.push({error:t.output.error});break}return e;default:break}return e.constraintCursor+=1,e}function o3r(e){var r=e.constraints,n=e.context,a=e.constraintCursor,o=e.unifyNF,u=r[a];switch(u.kind){case 2:o(u.unit,u.target.unit);break;case 3:var t=hne(n,u.format);if(t===void 0)break;var d=LK(n,u.cell.sheet,u.cell.range);if(d===void 0)break;o(t,d);break;default:return e.constraintCursor+=1,(0,wg.assertNever)(Mg.Messages.Root,u)}return e.constraintCursor+=1,e}function u3r(e){return e.kind===pD.ExperimentState.SolvingSimple?e.constraintCursor===e.constraints.length?a3r(e):i3r(e):o3r(e)}});var Cne=Y(UK=>{_();Object.defineProperty(UK,"__esModule",{value:!0});UK.UnitExperiment=void 0;var XEe=br(),vE=Ai(),ZEe=gs(),ia=sg(),mD=Qu(),s3r=g2(),l3r=ZB(),gD=IK(),Yv=kK(),kn=lne(),TT=JEe(),c3r=j9(),$Ee=ig(),d3r=gT(),bT=Di(),oy=pv(),eNe=Ml(),Df=rB(),BK=zu(),Sne=e0(),f3r=x0(),p3r=function(){function e(){this.isDone=!1,this.lastStepMessage="before started"}return Object.defineProperty(e.prototype,"done",{get:function(){return this.isDone},enumerable:!1,configurable:!0}),e.prototype.freshCheckingState=function(r){var n=this;this.lastStepMessage="freshCheckingState";var a=[],o={};r.getServerAvailableCells().forEach(function(d){var s,c=r.getServerUsedRange(d.sheetIdx);if(c.kind!==bT.ResultKind.Success){n.isDone=!0,n.statsMessage="Unit experiment: getServerUsedRange failed";return}var l=(0,XEe.__assign)((0,XEe.__assign)({},d),{usedRange:(s=c.value)===null||s===void 0?void 0:s.range});o[d.sheetIdx.index]=l,a.push(l)});var u=r.getServerDocument()===void 0?function(){return(0,bT.failure)(void 0)}:function(d){return r.getIformat(r.getServerDocument(),d)},t=function(s){if(r.getServerDocument()===void 0)return!1;var c=r.getServerValue(s);return c.kind===bT.ResultKind.Success&&c.value.oper.kind===oy.OperKind.String};return{kind:kn.ExperimentState.Checking,locale:r.config.localeInfo,mathpack:r.config.mathpack,resolver:(0,l3r.createResolver)(r),documentTypeContext:{formats:function(s){return r.getServerFormat(s)},types:{},available:o,getIformat:u,isStringValue:t},constraints:[],stats:{formulaCells:0,referencedFormatCells:0,allFormatCells:0,totalCells:0,errorCount:0,enriched:{errors:[],referencedFormatTypes:{},allFormatTypes:{},referencedCurrencyTypes:{},allCurrencyTypes:{}}},sheets:a,mutableState:{symbolContext:m3r.init(),ranges:void 0,cells:void 0,sheetCursor:0,rangeCursor:0,cellCursor:0}}},e.prototype.freshSolvingState=function(r){return this.lastStepMessage="freshSolvingState",{kind:kn.ExperimentState.SolvingSimple,stats:r.stats,context:(0,TT.makeSolverContext)(r.mutableState.symbolContext,r.documentTypeContext,r.stats),constraints:r.constraints,constraintCursor:0,deferred:[]}},e.prototype.step=function(){if(!this.isDone){if(this.documentContext===void 0)return this.isDone=!0,(0,vE.assertNever)("".concat(Yv.Messages.Root,".").concat(Yv.Messages.Initialised),this.documentContext);this.state===void 0&&(this.state=this.freshCheckingState(this.documentContext));try{var r=this.state;switch(r.kind){case kn.ExperimentState.Checking:if(r.mutableState.sheetCursor<r.sheets.length){this.state=this.runCheckStep(this.documentContext,r);return}this.state=this.freshSolvingState(r);return;case kn.ExperimentState.SolvingSimple:this.lastStepMessage="SolvingSimple",this.state=(0,TT.runSolverStep)(r);return;case kn.ExperimentState.SolvingFull:if(r.constraintCursor<r.constraints.length){this.lastStepMessage="SolvingFull",this.state=(0,TT.runSolverStep)(r);return}this.lastStepMessage="done SolvingFull",this.isDone=!0,this.statsMessage=this.statsForLogging(r.stats);return}}catch(n){this.statsMessage="".concat(Yv.Messages.Root,".").concat(Yv.Messages.Failure,": ").concat((0,$Ee.messageFromError)(n)),this.isDone=!0;return}}},e.prototype.setContext=function(r){var n=r.documents;this.documentContext=n},e.prototype.initialiseSheetStep=function(r){this.lastStepMessage="initialiseSheetStep";var n=r.mutableState,a=r.sheets,o=n.sheetCursor,u=a[o],t=u.usedRange,d=[];if(t!==void 0){var s=(0,f3r.intersectProduct)(u.availableCells,Sne.availableReadProduct);(0,Sne.forEachRangeInSet)(s,function(c){var l=(0,BK.gridRangeIsect)(c,t);if(l!==void 0){if((0,BK.gridRangeSize)(l)<250)return d.push(l),!0;(0,BK.forEachTileInRange)(l,15,function(f){return d.push(f),!0})}return!0})}return n.ranges=d,n.rangeCursor=0,r.documentTypeContext.types[u.sheetIdx.index]=(0,d3r.makeGridRangeTable)(),r},e.prototype.initialiseRangeCells=function(r,n){this.lastStepMessage="initialiseRangeCells";var a=n.mutableState,o=n.stats,u=n.sheets,t=a.sheetCursor,d=[],s=u[t],c=a.ranges[a.rangeCursor];return r.forEachServerNonBlankCellInSet(s.sheetIdx,(0,Sne.createCellSetFromRange)(c),function(l){var f,p=(0,ZEe.sheetGridCell)(s.sheetIdx,l),m=r.getServerFormula(p);m.kind===bT.ResultKind.Success&&((f=m.value)===null||f===void 0?void 0:f[1].compiledFmla)!==void 0&&(d.push(m.value[1]),o.formulaCells+=1);var v=r.getServerFormat(p);return v.kind===bT.ResultKind.Success&&(0,TT.isInterestingFormat)(n.documentTypeContext,v.value)&&(0,TT.updateFormatStatsFromCellFormat)(n.documentTypeContext,v.value,o,!1),o.totalCells+=1,!0}),a.cells=d,a.cellCursor=0,n},e.prototype.checkCell=function(r,n){this.lastStepMessage="checkCell";var a=n.sheets,o=n.constraints,u=n.stats,t=n.mutableState,d=t.cells,s=t.sheetCursor,c=t.cellCursor,l=a[s],f=d[c],p=f.compiledFmla.getValue();if(p.kind===bT.ResultKind.Success){var m=(0,ZEe.sheetGridCell)(l.sheetIdx,f.origin),v=N3r(n,m,p.value);n.documentTypeContext.types[l.sheetIdx.index]=v;var h=r.getServerFormat(m);h.kind===bT.ResultKind.Success&&(0,TT.isInterestingFormat)(n.documentTypeContext,h.value)&&(o.push({kind:3,cell:m,format:h.value}),(0,TT.updateFormatStatsFromCellFormat)(n.documentTypeContext,h.value,u,!0))}return n.mutableState.cellCursor+=1,n},e.prototype.runCheckStep=function(r,n){if(!v3r(n))return this.initialiseSheetStep(n);var a=n.mutableState;return a.rangeCursor===a.ranges.length?(a.ranges=void 0,a.sheetCursor+=1,n):g3r(n)?a.cellCursor<n.mutableState.cells.length?this.checkCell(r,n):(a.cells=void 0,a.rangeCursor+=1,n):this.initialiseRangeCells(r,n)},e.prototype.statsForLogging=function(r){return JSON.stringify(r)},Object.defineProperty(e.prototype,"resultLogMessage",{get:function(){var n;return(n=this.statsMessage)!==null&&n!==void 0?n:"".concat(Yv.Messages.Root,".").concat(Yv.Messages.Default)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"failedLogMessage",{get:function(){var n,a,o,u,t,d=(n=this.state)===null||n===void 0?void 0:n.kind,s=((a=this.state)===null||a===void 0?void 0:a.kind)===kn.ExperimentState.Checking&&((o=this.state)===null||o===void 0?void 0:o.mutableState.cellCursor)===0;return"Units experiment timed out. Last step: ".concat(this.lastStepMessage,". Experiment state: ").concat(d!==void 0?kn.ExperimentState[d]:"NotStarted",". isCellCursorZero: ").concat(s,". Number of constraints: ").concat((u=this.state)===null||u===void 0?void 0:u.constraints.length,". Stats: ").concat(this.statsForLogging((t=this.state)===null||t===void 0?void 0:t.stats))},enumerable:!1,configurable:!0}),e}();UK.UnitExperiment=p3r;var m3r=function(){function e(r,n){this.seed=r,this.table=n}return e.init=function(){return new e(0,c3r.RedBlackMapTree.create(function(r,n){return r.localeCompare(n)}))},e.prototype.getTable=function(){return this.table},e.prototype.freshSymbol=function(r){var n=r===void 0?"gen":r,a="".concat(n,"@").concat(this.seed+=1),o={unit:(0,gD.fromVar)(a),link:void 0,ufSubstitution:void 0};return this.table=this.table.setValue(a,o),o},e.prototype.copy=function(){return new e(this.seed,this.table)},e}();function g3r(e){return e.mutableState.cells!==void 0}function v3r(e){return e.mutableState.ranges!==void 0}function h3r(e,r){return e===kn.bottomType?r:r===kn.bottomType||e===kn.topType?e:r===kn.topType?r:e.kind===0&&r.kind===0&&e.unit===void 0&&r.unit===void 0?(0,kn.makePrimitiveType)(e.flags|r.flags):kn.topType}function Rk(e,r,n){switch(e.kind){case 2:return e.elementType.kind===1?void 0:n?Rk(e.elementType,r,!1):void 0;case 1:return{kind:0,type:e,target:r};case 0:return e.unit===void 0?void 0:{kind:2,unit:e.unit,target:r};case 3:return;default:return(0,vE.assertNever)(Yv.Messages.Root,e)}}function S3r(e){switch(e.kind){case oy.OperKind.Number:return kn.numberType;case oy.OperKind.String:return kn.stringType;case oy.OperKind.Boolean:return kn.boolType;case oy.OperKind.Error:return kn.errorType;default:return kn.oneType}}function yne(e,r,n){switch(r.kind){case 2:return r.elementType.kind===1?void 0:n?yne(e,r.elementType,!1):void 0;case 1:var a=e.symbolContext.freshSymbol(),o={kind:0,type:r,target:a};return[a.unit,o];case 0:return r.unit===void 0?void 0:[r.unit,void 0];case 3:return;default:return(0,vE.assertNever)(Yv.Messages.Root,r)}}function y3r(e){var r=e.length;if(r===0)return kn.topType;for(var n=kn.bottomType,a=e[0].length,o=0;o<e.length;o+=1)for(var u=e[o],t=0;t<u.length;t+=1)n=h3r(n,u[t]);return(0,kn.makeArrayType)(n,{rows:r,columns:a,exact:!0})}function C3r(e,r){var n=(0,s3r.resolveLocalsGrid)(e.origin),a=e.resolver.resolveCellRef(n,r.reference).resolution;return(0,bT.isSuccess)(a)?a.value?a.value:!0:!1}function d_(e,r){if(r.kind===1&&!(0,kn.isResolvedReferenceType)(r)){var n=C3r(e,r);return typeof n=="object"?(0,kn.makeResolvedReferenceType)(r.reference,n):n?kn.errorType:void 0}if(r.kind===2){var a=d_(e,r.elementType);return a===void 0?a:a===r.elementType?r:(0,kn.makeArrayType)(a,r.dimensions)}return r}function rNe(e,r){switch(r.kind){case 0:if(r.unit===void 0){var n=e.symbolContext.freshSymbol();return(0,kn.makePrimitiveType)(r.flags,n.unit)}return r;case 2:for(var a=r,o=[];a.kind===2;)o.push(a.dimensions),a=a.elementType;var u=rNe(e,a);return o.reduceRight(kn.makeArrayType,u);case 1:case 3:return r;default:return(0,vE.assertNever)(Yv.Messages.Root,r)}}function qK(e,r,n,a,o){var u=e.symbolContext.freshSymbol(),t=Rk(r,u,a),d=Rk(n,u,a);if(t!==void 0&&d!==void 0||o&&(t!==void 0||d!==void 0))return e.pushConstraint(t),e.pushConstraint(d),u}function _3r(e,r,n){switch(r){case ia.WorksheetFuncId.SUM:case ia.WorksheetFuncId.AVERAGE:case ia.WorksheetFuncId.MAX:case ia.WorksheetFuncId.MIN:if(n.length===0)return kn.topType;var a=e.symbolContext.freshSymbol(),o=!0;return n.forEach(function(p){var m=d_(e,p);m&&e.pushConstraint(Rk(m,a,!0))&&(o=!1)}),o?kn.numberType:(0,kn.makePrimitiveType)(oy.OperKind.Number,a.unit);case ia.WorksheetFuncId.IF:if(n.length<2)return kn.topType;var u=d_(e,n[0]),t=d_(e,n[1]),d=d_(e,n[2]===void 0?kn.boolType:n[2]);if(u===void 0)return t!==void 0&&d!==void 0&&qK(e,t,d,!0,!1),kn.topType;var s=(0,kn.dimensionsFromType)(u),c=typeof s=="object";if(t===void 0||d===void 0)return kn.topType;var l=qK(e,t,d,!0,!0),f=l?(0,kn.primitiveUnitType)(l.unit):kn.primitiveType;return c?(0,kn.makeArrayType)(f,s):f;default:return kn.topType}}function R3r(e,r,n){if(n.length<2)return kn.topType;var a=d_(e,n[0][0]),o=d_(e,n[1][0]);if(a===void 0||o===void 0)return kn.topType;var u=(0,kn.getLiftingDimensionsFromTypes)(a,o);if(u===!1)return kn.topType;var t=typeof u=="object";switch(r){case ia.OperatorId.Add:case ia.OperatorId.Sub:case ia.OperatorId.Min:case ia.OperatorId.Max:{var d=qK(e,a,o,t,!0);return(0,kn.typeFromDimensions)(d===void 0?kn.numberType:(0,kn.makePrimitiveType)(oy.OperKind.Number,d.unit),u)}case ia.OperatorId.Eq:case ia.OperatorId.Ne:case ia.OperatorId.Lt:case ia.OperatorId.Le:case ia.OperatorId.Gt:case ia.OperatorId.Ge:return qK(e,a,o,t,!1),(0,kn.typeFromDimensions)(kn.boolType,u);case ia.OperatorId.Mul:case ia.OperatorId.Div:if(TT.UnitExperimentSettings.IgnoreDivMul)return kn.numberType;var s=e.symbolContext.freshSymbol(),c=e.symbolContext.freshSymbol(),l=Rk(a,s,t),f=Rk(o,c,t);if(e.pushConstraint(l),e.pushConstraint(f),l===void 0&&f===void 0)return(0,kn.typeFromDimensions)(kn.numberType,u);var p=r===ia.OperatorId.Mul?(0,gD.prod)(s.unit,c.unit):(0,gD.prod)(s.unit,(0,gD.inv)(c.unit));return(0,kn.typeFromDimensions)((0,kn.makePrimitiveType)(oy.OperKind.Number,p),u);case ia.OperatorId.Pow:var m=n[1],v=m[1];if((0,BK.isNumberLiteralNode)(v)){var h=e.mathpack.toNumber(v.oper);if((0,$Ee.isInteger)(h)){var S=yne(e,a,typeof u=="object");return S===void 0?(0,kn.typeFromDimensions)(kn.numberType,u):(e.pushConstraint(S[1]),(0,kn.typeFromDimensions)((0,kn.makePrimitiveType)(oy.OperKind.Number,(0,gD.pow)(S[0],h,kn.dimensionLess)),u))}}return kn.topType;case ia.OperatorId.Range:case ia.OperatorId.Isect:case ia.OperatorId.Union:return kn.topType;case ia.OperatorId.Concat:return(0,kn.typeFromDimensions)(kn.stringType,u);case ia.OperatorId.And:case ia.OperatorId.Or:case ia.OperatorId.Xor:return(0,kn.typeFromDimensions)(kn.boolType,u);default:return(0,vE.assertNever)(Yv.Messages.Root,r)}}function T3r(e,r,n){if(n.length<1)return kn.topType;var a=n[0][0],o=d_(e,a);if(o===void 0)return kn.topType;var u=(0,kn.dimensionsFromType)(o);if(u===!1)return kn.topType;switch(r){case ia.OperatorId.Percent:return(0,kn.typeFromDimensions)(kn.dimensionlessNumberType,u);case ia.OperatorId.Neg:case ia.OperatorId.Pos:var t=yne(e,o,typeof u=="object");return t===void 0?(0,kn.typeFromDimensions)(kn.numberType,u):(e.pushConstraint(t[1]),(0,kn.typeFromDimensions)((0,kn.makePrimitiveType)(oy.OperKind.Number,t[0]),u));case ia.OperatorId.At:case ia.OperatorId.Pound:return kn.topType;default:return(0,vE.assertNever)(Yv.Messages.Root,r)}}function b3r(e,r,n){switch(r){case ia.OperatorId.Add:case ia.OperatorId.Sub:case ia.OperatorId.Mul:case ia.OperatorId.Div:case ia.OperatorId.Pow:case ia.OperatorId.Eq:case ia.OperatorId.Ne:case ia.OperatorId.Lt:case ia.OperatorId.Le:case ia.OperatorId.Gt:case ia.OperatorId.Ge:case ia.OperatorId.Range:case ia.OperatorId.Isect:case ia.OperatorId.Union:case ia.OperatorId.Concat:case ia.OperatorId.And:case ia.OperatorId.Or:case ia.OperatorId.Xor:case ia.OperatorId.Min:case ia.OperatorId.Max:return R3r(e,r,n);case ia.OperatorId.Percent:case ia.OperatorId.Neg:case ia.OperatorId.Pos:case ia.OperatorId.At:case ia.OperatorId.Pound:return T3r(e,r,n);default:return(0,vE.assertNever)(Yv.Messages.Root,r)}}var P3r=function(){function e(r){var n=this;this.context=r,this.visitFormulaNode=function(a){return(0,eNe.visitFormulaNode)(n,a)},this.lazyVisitFormulaNode=function(a){return Df.Pledge.resolve(a).bind(n.visitFormulaNode)}}return e.prototype.literalNode=function(r){return Df.Pledge.resolve(S3r(r))},e.prototype.arrayNode=function(r){var n=this;return Df.Pledge.all(r.map(function(a){return Df.Pledge.all(a.map(n.lazyVisitFormulaNode))})).bind(y3r)},e.prototype.appNode=function(r,n){var a=this;return r.kind===mD.NodeKind.Operator?Df.Pledge.all(n.map(function(o){return a.lazyVisitFormulaNode(o).bind(function(u){return[u,o]})})).bind(function(o){return b3r(a.context,r.id,o)}):r.kind===mD.NodeKind.WSF?Df.Pledge.all(n.map(this.lazyVisitFormulaNode)).bind(function(o){return _3r(a.context,r.id,o)}):Df.Pledge.resolve(kn.topType)},e.prototype.letNode=function(r,n,a,o){return Df.Pledge.resolve(kn.topType)},e.prototype.lambdaNode=function(r,n,a,o){return Df.Pledge.resolve(kn.topType)},e.prototype.parenNode=function(r){return this.lazyVisitFormulaNode(r)},e.prototype.nameNode=function(r,n){return Df.Pledge.resolve(kn.topType)},e.prototype.cellRefNode=function(r,n){return Df.Pledge.resolve((0,kn.makeReferenceType)((0,mD.cellRefNode)(r,n)))},e.prototype.fieldRefNode=function(r,n){return Df.Pledge.resolve(kn.topType)},e.prototype.structRefNode=function(r,n){return Df.Pledge.resolve(kn.topType)},e.prototype.missingNode=function(r){return Df.Pledge.resolve(kn.topType)},e.prototype.badSequenceNode=function(r,n){return Df.Pledge.resolve(kn.topType)},e.prototype.badCharsNode=function(r,n){return Df.Pledge.resolve(kn.topType)},e.prototype.operatorNode=function(r,n){return Df.Pledge.resolve((0,mD.operatorNode)(r,n))},e.prototype.wsfNode=function(r,n,a){return Df.Pledge.resolve((0,mD.wsfNode)(r,n,a))},e}();function E3r(e,r){return(0,eNe.reducePledge)(new P3r(e),r)}function N3r(e,r,n){var a=e.constraints,o=e.locale,u=e.mathpack,t=e.resolver,d=e.documentTypeContext,s=function(E){return E!==void 0?(a.push(E),!0):!1},c=d.types[r.sheet.index],l=e.mutableState.symbolContext.copy(),f={origin:r,locale:o,mathpack:u,resolver:t,symbolContext:l,pushConstraint:s},p=E3r(f,n),m=d_(f,p),v=rNe(f,m===void 0?kn.topType:m),h=v;if(h.kind===1){var S=l.freshSymbol(),y={kind:0,type:h,target:S};h=(0,kn.primitiveUnitType)(S.unit),a.push(y)}return e.mutableState.symbolContext=l,h.kind===2?c:c.setValue(r.range,h)}});var GK=Y(hE=>{_();Object.defineProperty(hE,"__esModule",{value:!0});hE.ExperimentKind=void 0;hE.getExperimentFactories=I3r;hE.registerExperimentFactory=M3r;var nNe=Ol(),A3r=Ai(),tNe=ft(),O3r=TEe(),k3r=Cne(),F3r=function(){function e(r){this.stepDelay=r,this.done=!1,this.resultLogMessage="TestExperiment",this.failedLogMessage="TestExperiment exceeded budget",this.iters=0}return e.create=function(r){if(typeof r!="number"){var n="calc.calc.TestExperiment: expected number; given ".concat(r);A3r.ulsLogger.ULS.traceTag(591974878,nNe.LogCategory.msoulscat_ES_EWAJS,nNe.TraceLevel.Warning,n);return}return new e(r)},e.prototype.setContext=function(){},e.prototype.step=function(){for(var r=(0,tNe.now)();(0,tNe.now)()<r+this.stepDelay;);this.iters+=1,this.iters>1&&(this.done=!0)},e}(),Tk;hE.ExperimentKind=Tk;(function(e){e.OneShot="OneShot",e.Recurring="Recurring",e.Precision="Precision"})(Tk||(hE.ExperimentKind=Tk={}));var _ne={TestExperiment:function(r){return{experimentName:"TestExperiment",kind:Tk.OneShot,create:function(){return F3r.create(r)}}},ExceLintExperiment:function(){return{experimentName:"ExceLintExperiment",kind:Tk.OneShot,create:function(){return new O3r.ExceLintExperiment}}},UnitExperiment:function(){return{experimentName:"UnitExperiment",kind:Tk.OneShot,create:function(){return new k3r.UnitExperiment},stepBudget:80}}};function I3r(e){var r=e.map(function(n){var a,o=n.name,u=n.param;return(a=_ne[o])===null||a===void 0?void 0:a.call(_ne,u)});return r.filter(function(n){return n!==void 0})}function M3r(e,r){_ne[e]=r}});var Pk=Y(bk=>{_();Object.defineProperty(bk,"__esModule",{value:!0});bk.ResolvablePromiseWithTimeout=bk.ResolvablePromise=void 0;var aNe=Cn(),w3r=aNe.resolvablePromise.ResolvablePromise;bk.ResolvablePromise=w3r;var D3r=aNe.resolvablePromise.ResolvablePromiseWithTimeout;bk.ResolvablePromiseWithTimeout=D3r});var iNe=Y(KK=>{"use strict";_();Object.defineProperty(KK,"__esModule",{value:!0});KK.definedNameInfoDefinitions=void 0;KK.definedNameInfoDefinitions={config:{scriptSharpNamespace:"Microsoft.Office.Excel.WebUI.Client",webpackChunkName:"excelOnlineCalc",typescriptInterfaceStartsWithI:!0},enums:[{name:"DefinedNameInfoType",values:[{name:"Invalid",value:-1},{name:"Table",value:0},{name:"NamedRange",value:1}]}],pods:[{name:"DefinedNameInfo",fields:[{name:"name",type:"string"},{name:"tooltip",type:"string"},{name:"namedRange",type:"DefinedNameInfoRange"},{name:"sheetName",type:"string"},{name:"type",type:"DefinedNameInfoType"}]},{name:"DefinedNameInfoRange",fields:[{name:"top",type:"number-int"},{name:"left",type:"number-int"},{name:"bottom",type:"number-int"},{name:"right",type:"number-int"},{name:"maxRows",type:"number-int"},{name:"maxColumns",type:"number-int"},{name:"sheetName",type:"string"}]}]}});var oNe=Y(VK=>{"use strict";_();Object.defineProperty(VK,"__esModule",{value:!0});VK.dynamicPluginLoaderDefinitions=void 0;VK.dynamicPluginLoaderDefinitions={config:{scriptSharpNamespace:"Microsoft.Office.Excel.WebUI.Client",webpackChunkName:"excelOnlineCalc",typescriptInterfaceStartsWithI:!0},interfaces:[{name:"DynamicPluginLoaderBase",comment:["Base type for both kinds of plugin loaders (main and other thread).","Instantiate `PluginParam` with a type wide enough to include any plugin factory's parameter."],genericParameterDefinitions:["PluginParam"],methods:[{name:"loadPluginScript",parameters:[{name:"identifier",type:"string"},{name:"isLocalized",type:"boolean"}],async:!0},{name:"createAndAttachPlugin",parameters:[{name:"factoryName",type:"PluginFactoryName"},{name:"param",type:"PluginParam"}],async:!0}]},{name:"DynamicPluginLoader",comment:"Allows loading plugins, and creating threads that load plugins.",genericParameterDefinitions:["PluginParam"],extends:[{type:"DynamicPluginLoaderBase",genericParameters:["PluginParam"]}],methods:[{name:"isThreadingSupported",returnType:"boolean"},{name:"createPluginThread",parameters:[{name:"pluginThreadName",type:"string"}],returnType:{type:"DynamicPluginLoaderThread",genericParameters:["PluginParam"]},async:!0}]},{name:"DynamicPluginLoaderThread",comment:"Client-facing interface to a plugin thread.",genericParameterDefinitions:["PluginParam"],extends:[{type:"DynamicPluginLoaderBase",genericParameters:["PluginParam"]}],methods:[{name:"close"}]}]}});var uNe=Y(vD=>{"use strict";_();Object.defineProperty(vD,"__esModule",{value:!0});vD.MajorityDataType=void 0;var x3r;(function(e){e[e.Text=0]="Text",e[e.Number=1]="Number",e[e.Date=2]="Date",e[e.Max=3]="Max"})(x3r=vD.MajorityDataType||(vD.MajorityDataType={}))});var sNe=Y(WK=>{"use strict";_();Object.defineProperty(WK,"__esModule",{value:!0});WK.formulaAssistanceDefinitions=void 0;WK.formulaAssistanceDefinitions={config:{scriptSharpNamespace:"Microsoft.Office.Excel.WebUI.Client",webpackChunkName:"excelOnlineCalc",typescriptInterfaceStartsWithI:!0},enums:[{name:"CompletionItemKind",nameLookup:"TypeScript",comment:"taken from LSP. Do *not* change the values, but pick the correct ones from the spec.",values:[{name:"Function",value:3},{name:"Enum",value:13},{name:"NamedRange",value:100},{name:"TableHeader",value:101},{name:"LetVariable",value:102},{name:"RichEntity",value:103},{name:"Lambda",value:104},{name:"CustomFunction",value:105},{name:"Table",value:106},{name:"TableSpecialStructRef",value:107},{name:"RichEntityEmptyCellRef",value:108},{name:"RangeRef",value:109}]},{name:"SuggestionKind",nameLookup:"TypeScript",values:[{name:"Simple",value:0},{name:"Smart",value:1}]},{name:"DiagnosticSeverity",nameLookup:"TypeScript",comment:"take from LSP https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/#diagnosticSeverity, do *not* change the values, but pick the correct ones from the spec.",values:[{name:"Error",value:1},{name:"Warning",value:2},{name:"Information",value:3},{name:"Hint",value:4}]},{name:"DiagnosticTag",nameLookup:"TypeScript",comment:"take from LSP https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/#diagnosticTag , do *not* change the values, but pick the correct ones from the spec.",values:[{name:"Unnecessary",value:1},{name:"Deprecated",value:2}]},{name:"CodeActionKind",nameLookup:"TypeScript",comment:"take from LSP https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/#codeActionKind . Spec defines this as string and then defines own values, we use standard enum instead.",values:[{name:"Empty",value:0},{name:"QuickFix",value:1},{name:"Refactor",value:2},{name:"RefactorExtract",value:3},{name:"RefactorInline",value:4},{name:"RefactorRewrite",value:5},{name:"Source",value:6},{name:"SourceOrganizeImports",value:7,comment:"including for completeness but not relevant for spreadsheets"},{name:"SourceFixAll",value:8}]},{name:"RepairItemPartType",nameLookup:"TypeScript",values:[{name:"None",value:0},{name:"Added",value:1},{name:"Removed",value:2},{name:"Replaced",value:3}]}],pods:[{name:"FunctionRenderingInfo",comment:"All data representing a function for the argument assistance card.",fields:[{name:"functionName",type:"string",comment:"Function name"},{name:"functionDescription",type:"string",comment:"Function description"},{name:"signatures",type:"FunctionSignature[]",comment:"Array of all function signatures"},{name:"activeSignature",type:"number-int",comment:"Current active function signature",nullable:!0},{name:"listSeparator",type:"string",comment:"The list separator for the current locale"},{name:"isUDF",type:"boolean",comment:"Indicates whether a user defined function"},{name:"helpID",type:"string",comment:"Link for the extended help for this function"}]},{name:"FunctionSignature",comment:"Represents all function signatures, with all the info specific to it",fields:[{name:"signatureParams",type:"Parameters",comment:"Function signature parameters"},{name:"exampleParams",type:"Parameters",comment:"Function example parameters"},{name:"descriptionParams",type:"Parameters",comment:"Parameters to be described"},{name:"descriptions",type:"string[]",comment:"Description of each function parameter"},{name:"exampleDescription",type:"string",comment:"Description of the function example"}]},{name:"Parameters",comment:"Represents a group of parameters, and which one is active",fields:[{name:"params",type:"string[]",comment:"Function parameters"},{name:"activeParam",type:"number-int",comment:"Current active parameter in the group"}]},{name:"Position",comment:"from LSP: https://microsoft.github.io/language-server-protocol/specifications/specification-3-17/#position",fields:[{name:"line",type:"number-int",comment:"should be uint, according to spec, but the generator doesn't support the type."},{name:"character",type:"number-int",comment:"should be uint, according to spec, but the generator doesn't support the type."}]},{name:"LSPRange",comment:"from LSP: https://microsoft.github.io/language-server-protocol/specifications/specification-3-17/#range",fields:[{name:"start",type:"Position"},{name:"end",type:"Position"}]},{name:"TextEdit",comment:"from LSP: https://microsoft.github.io/language-server-protocol/specifications/specification-3-17/#textEdit",fields:[{name:"range",type:"LSPRange"},{name:"newText",type:"string"}]},{name:"AnyObject1",fields:[]},{name:"Data",comment:"from LSP: https://microsoft.github.io/language-server-protocol/specifications/specification-3-17/#data",fields:[{name:"type",type:"string"},{name:"value",type:"AnyObject1"}]},{name:"CompletionItem",comment:"from LSP: https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/#completionItem",fields:[{name:"label",type:"string"},{name:"textEdit",type:"TextEdit"},{name:"evaluation",type:"string"},{name:"kind",type:"CompletionItemKind"},{name:"type",comment:"Excel-specific extension, consider removing if we find a better LSP mapping.",type:"SuggestionKind",nullable:!0},{name:"detail",type:"string"},{name:"isPrefixed",type:"boolean",nullable:!0},{name:"shouldRequestAutocompleteOnCommit",comment:"Whether an autocomplete request should be sent upon committing this completion item",type:"boolean",nullable:!0}]},{name:"CompletionList",comment:"from LSP: https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/#completionList",fields:[{name:"items",type:"CompletionItem[]"},{name:"data",type:"Data"}]},{name:"Diagnostic",comment:"from https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/#diagnostic",fields:[{name:"range",type:"LSPRange"},{name:"severity",type:"DiagnosticSeverity",nullable:!0},{name:"code",type:"number-int",comment:"type is integer | string, we opt for number-int and leave string description to codeDescription"},{name:"codeDescription",type:"CodeDescription"},{name:"source",type:"string"},{name:"message",type:"string"},{name:"tags",type:"DiagnosticTag[]",nullable:!0},{name:"data",type:"string",comment:"spec type is unknown"}]},{name:"CodeDescription",comment:"from https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/#codeDescription",fields:[{name:"href",type:"string",comment:"true spec type is URI type"}]},{name:"CodeAction",comment:"from https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/#codeAction . We skip WorkspaceEdit.",fields:[{name:"title",type:"string"},{name:"kind",type:"CodeActionKind"},{name:"diagnostics",type:"Diagnostic[]"},{name:"isPreferred",type:"boolean",nullable:!0},{name:"disabled",type:"DisabledReason"},{name:"textEdit",type:"TextEdit",comment:"spec defines command, but we don't have a general use case for that yet. Using TextEdit as an initial case."},{name:"data",type:"string",comment:"spec type is LSPAny"}]},{name:"DisabledReason",comment:"Not an actual specification type, but LSP defines `disabled` in CodeAction as object literal",fields:[{name:"reason",type:"string"}]},{name:"ArgumentProp",comment:"Function-param data for the function arguments dialog",fields:[{name:"name",type:"string"},{name:"description",type:"string"},{name:"type",type:"string"},{name:"isOptional",type:"boolean"}]},{name:"FormulaRepairResult",fields:[{name:"diagnostics",type:"string"},{name:"description",type:"string"},{name:"formula",type:"string"},{name:"repairs",type:"RepairItem[]"}]},{name:"RepairItem",fields:[{name:"text",type:"string"},{name:"repairedFormulaParts",type:"RepairItemPart[]"},{name:"originalFormulaParts",type:"RepairItemPart[]"},{name:"formulaValue",type:"string"}]},{name:"RepairItemPart",fields:[{name:"type",type:"RepairItemPartType"},{name:"location",type:"Location"}]},{name:"Location",fields:[{name:"start",type:"number-int"},{name:"end",type:"number-int"}]}]}});var cNe=Y(lNe=>{"use strict";_();Object.defineProperty(lNe,"__esModule",{value:!0})});var dNe=Y(jK=>{"use strict";_();Object.defineProperty(jK,"__esModule",{value:!0});jK.pluginSchedulerFactoryDefinition=void 0;jK.pluginSchedulerFactoryDefinition={config:{scriptSharpNamespace:"Microsoft.Office.Excel.WebUI.Client",webpackChunkName:"excelOnlineCalc",typescriptInterfaceStartsWithI:!0},factory:{name:"PluginSchedulerSingleton",module:"../x10-formula-bar/schedulerExports",methods:[{name:"instance",parameters:[],returnType:"PluginScheduler"}]}}});var fNe=Y(HK=>{"use strict";_();Object.defineProperty(HK,"__esModule",{value:!0});HK.schedulerInterfaceDefinitions=void 0;HK.schedulerInterfaceDefinitions={config:{scriptSharpNamespace:"Microsoft.Office.Excel.WebUI.Client",webpackChunkName:"excelOnlineCalc",typescriptInterfaceStartsWithI:!0},enums:[{name:"EditorMessageType",values:[{name:"FunctionMessage",value:0}],nameLookup:"ScriptSharpAndTypeScript"},{name:"MessageType",values:[{name:"Insert",value:0},{name:"Delete",value:1},{name:"Replace",value:2}],nameLookup:"ScriptSharpAndTypeScript"},{name:"PluginFactoryName",values:[{name:"TestPlugin",value:0},{name:"AutocompletePlugin",value:1},{name:"DragPlugin",value:2},{name:"ConfigTestPlugin",value:3},{name:"ArgumentAssistancePlugin",value:4},{name:"FeatureGateTestPlugin",value:5},{name:"DNMTraceTagTestPlugin",value:7},{name:"ParenthesesCouplingPlugin",value:8},{name:"AutocompleteFunctionPlugin",value:9},{name:"AutocompleteLetPlugin",value:10},{name:"AutocompleteRichValuePlugin",value:11},{name:"AutocompleteNamedObjectsPlugin",value:12},{name:"AutocompleteTableHeadersPlugin",value:13},{name:"ColoredReferencesPlugin",value:14},{name:"ValuePreviewPlugin",value:15},{name:"AutocompleteRangeSuggestionPlugin",value:16},{name:"SyntaxErrorsPlugin",value:17},{name:"GotoCtrlClickPlugin",value:18},{name:"AutocompleteEnumPlugin",value:19},{name:"FormulaByExamplePlugin",value:20},{name:"FormulaCollectionPlugin",value:1004},{name:"ParserPerformanceMeasurements",value:1005},{name:"FormulaRepairShadowEvalPlugin",value:1007},{name:"PythonAutocompletePlugin",value:1008},{name:"AutocompleteWrapperPlugin",value:1009},{name:"AutocompleteBinaryModelExperimentPlugin",value:1010},{name:"ChangeGateTestPlugin",value:2e3},{name:"SlowTestPlugin",value:2001},{name:"EvalOnCloneTestPlugin",value:2002},{name:"EvalFormulaTestPlugin",value:2003},{name:"PythonTestPlugin",value:2004},{name:"ChatGPTPlugin",value:2005},{name:"EventsTestPlugin",value:2006}],nameLookup:"ScriptSharpAndTypeScript"},{name:"PluginGroup",values:[{name:"Excel",value:0},{name:"Python",value:1}],nameLookup:"ScriptSharpAndTypeScript"},{name:"PluginAttachGroup",comment:"We have various attach groups. By default, plugins are in the `Core` group unless put elsewhere. The `Core` group has an opt-out behavior, whilst the others have opt-in. This convention is enforced statically.",values:[{name:"Core",value:0},{name:"Python",value:1},{name:"SmartSuggestionsAutoComplete",value:2}],nameLookup:"ScriptSharpAndTypeScript"},{name:"PluginSchedulerResultKind",values:[{name:"Done",value:0,comment:"The scheduler has provided the final message"},{name:"Superseded",value:1,comment:"The event was abandonned due to another one. You are guaranteed to receive another response shortly."}],nameLookup:"ScriptSharpAndTypeScript"},{name:"PerCharacterExperimentResultKind",values:[{name:"AutocompleteWrapperPluginResult",value:0}],nameLookup:"ScriptSharpAndTypeScript"},{name:"HighlightKind",values:[{name:"CellRef",value:0},{name:"StructRef",value:1},{name:"NamedRange",value:2},{name:"Parentheses",value:3}],nameLookup:"ScriptSharpAndTypeScript"},{name:"PositionKind",values:[{name:"Absolute",value:0},{name:"Relative",value:1}],nameLookup:"ScriptSharpAndTypeScript"},{name:"ValuePreviewResultKind",values:[{name:"Failure",value:0},{name:"Success",value:1},{name:"Unavailable",value:2}],nameLookup:"ScriptSharpAndTypeScript"},{name:"GotoCtrlClickResultKind",values:[{name:"ReferenceFound",value:0},{name:"NoReferenceFound",value:1},{name:"Failure",value:2},{name:"RangeResolutionFailure",value:3}],nameLookup:"ScriptSharpAndTypeScript"},{name:"SchedulerFeature",values:[{name:"ArgumentAssistance",value:0},{name:"SimpleAutoComplete",value:1},{name:"SmartSuggestionsAutoComplete",value:2},{name:"ValuePreview",value:3},{name:"ColoredReferences",value:4},{name:"ParenthesisCoupling",value:5},{name:"SyntaxErrors",value:6},{name:"GotoCtrlClick",value:7},{name:"EnumAutoComplete",value:8}],nameLookup:"ScriptSharpAndTypeScript"},{name:"ALOperationType",values:[{name:"none",value:0},{name:"add",value:1},{name:"update",value:2},{name:"delete",value:3},{name:"updateAnnotationMetaData",value:4},{name:"move",value:5},{name:"focus",value:6},{name:"visibility",value:7}],nameLookup:"ScriptSharpAndTypeScript"}],interfaces:[{name:"ALInterop",methods:[{name:"signal",parameters:[{name:"signal",type:"AnyObject"}],returnType:"string"},{name:"registerOnAnnotation",parameters:[{name:"annotationName",type:"string"},{name:"featureName",type:"string"},{name:"isModelRequired",type:"boolean"},{name:"newAnnotationCallback",type:{parameters:[{name:"sender",type:"AnyObject"},{name:"annotationReceivedEventArgs",type:"AnnotationReceivedEventArgs"}]}}],returnType:"string"}]},{name:"ChatGPTProvider",methods:[{name:"openChat",parameters:[{name:"options",type:"AnyObject"}],async:!0,returnType:{type:"number-int"}},{name:"send",parameters:[{name:"chatId",type:"number-int"},{name:"message",type:"string"}],async:!0,returnType:{type:"string"}},{name:"close",parameters:[{name:"chatId",type:"number-int"}],async:!0}]},{name:"Notifier",methods:[{name:"setActiveCell",parameters:[{name:"notification",type:"CellMessage"}]},{name:"setActiveCellFormat",parameters:[{name:"notification",type:"FormatMessage"}]},{name:"doNothing",parameters:[{name:"notification",type:"string"}]},{name:"setFunctionsInfo",parameters:[{name:"functionsInfo",type:"FunctionInfo[]"}]},{name:"setDefinedNamesInfo",parameters:[{name:"definedNamesInfo",type:"DefinedNameInfo[]"}]},{name:"notifyWorkbookClosing"},{name:"setSchedulerFeatures",parameters:[{name:"features",type:"SchedulerFeature[]"}]}]},{name:"Requester",methods:[{name:"functionSuggestion",parameters:[{name:"request",type:"FunctionSuggestionRequest"},{name:"pluginGroup",type:"PluginGroup"},{name:"computationGroup",type:"string"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["SuggestionResult"]}},{name:"inCellSuggestion",parameters:[{name:"request",type:"InCellSuggestionRequest"},{name:"pluginGroup",type:"PluginGroup"},{name:"computationGroup",type:"string"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["InCellSuggestionResult"]}},{name:"formulaHighlighting",parameters:[{name:"request",type:"FormulaHighlightingRequest"},{name:"pluginGroup",type:"PluginGroup"},{name:"computationGroup",type:"string"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["FormulaHighlightingResult"]}},{name:"argumentAssistance",parameters:[{name:"request",type:"ArgumentAssistanceRequest"},{name:"pluginGroup",type:"PluginGroup"},{name:"computationGroup",type:"string"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["FunctionRenderingInfo"]}},{name:"runExperiment",parameters:[{name:"request",type:"RunExperimentRequest"},{name:"pluginGroup",type:"PluginGroup"},{name:"computationGroup",type:"string"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["RunExperimentResults"]}},{name:"runAuthoringExperiment",parameters:[{name:"request",type:"RunAuthoringExperimentRequest"},{name:"pluginGroup",type:"PluginGroup"},{name:"computationGroup",type:"string"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["RunExperimentResults"]}},{name:"runPerCharacterExperiment",parameters:[{name:"request",type:"RunPerCharacterExperimentRequest"},{name:"pluginGroup",type:"PluginGroup"},{name:"computationGroup",type:"string"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["RunPerCharacterExperimentResults"]}},{name:"runTest",parameters:[{name:"request",type:"RunTestRequest"},{name:"pluginGroup",type:"PluginGroup"},{name:"computationGroup",type:"string"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["AnyObjectResults"]}},{name:"valuePreview",parameters:[{name:"request",type:"ValuePreviewRequest"},{name:"pluginGroup",type:"PluginGroup"},{name:"computationGroup",type:"string"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["ValuePreviewResult"]}},{name:"gotoCtrlClick",parameters:[{name:"request",type:"GotoCtrlClickRequest"},{name:"pluginGroup",type:"PluginGroup"},{name:"computationGroup",type:"string"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["GotoCtrlClickResult"]}},{name:"formulaRepair",parameters:[{name:"request",type:"FormulaRepairRequest"},{name:"pluginGroup",type:"PluginGroup"},{name:"computationGroup",type:"string"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["FormulaRepairResult"]}},{name:"chatGPTQuery",parameters:[{name:"request",type:"ChatGPTRequest"},{name:"pluginGroup",type:"PluginGroup"},{name:"computationGroup",type:"string"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["ChatGPTResult"]}},{name:"formulaByExample",parameters:[{name:"request",type:"formulaByExampleRequest"},{name:"pluginGroup",type:"PluginGroup"},{name:"computationGroup",type:"string"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["formulaByExampleResult"]}}]},{name:"ObsoleteRequester",methods:[{name:"functionSuggestion",parameters:[{name:"request",type:"FunctionSuggestionRequest"},{name:"pluginGroup",type:"PluginGroup"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["SuggestionResult"]}},{name:"inCellSuggestion",parameters:[{name:"request",type:"InCellSuggestionRequest"},{name:"pluginGroup",type:"PluginGroup"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["InCellSuggestionResult"]}},{name:"formulaHighlighting",parameters:[{name:"request",type:"FormulaHighlightingRequest"},{name:"pluginGroup",type:"PluginGroup"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["FormulaHighlightingResult"]}},{name:"argumentAssistance",parameters:[{name:"request",type:"ArgumentAssistanceRequest"},{name:"pluginGroup",type:"PluginGroup"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["FunctionRenderingInfo"]}},{name:"runExperiment",parameters:[{name:"request",type:"RunExperimentRequest"},{name:"pluginGroup",type:"PluginGroup"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["RunExperimentResults"]}},{name:"runAuthoringExperiment",parameters:[{name:"request",type:"RunAuthoringExperimentRequest"},{name:"pluginGroup",type:"PluginGroup"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["RunExperimentResults"]}},{name:"runPerCharacterExperiment",parameters:[{name:"request",type:"RunPerCharacterExperimentRequest"},{name:"pluginGroup",type:"PluginGroup"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["RunPerCharacterExperimentResults"]}},{name:"runTest",parameters:[{name:"request",type:"RunTestRequest"},{name:"pluginGroup",type:"PluginGroup"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["AnyObjectResults"]}},{name:"valuePreview",parameters:[{name:"request",type:"ValuePreviewRequest"},{name:"pluginGroup",type:"PluginGroup"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["ValuePreviewResult"]}},{name:"gotoCtrlClick",parameters:[{name:"request",type:"GotoCtrlClickRequest"},{name:"pluginGroup",type:"PluginGroup"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["GotoCtrlClickResult"]}},{name:"formulaRepair",parameters:[{name:"request",type:"FormulaRepairRequest"},{name:"pluginGroup",type:"PluginGroup"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["FormulaRepairResult"]}},{name:"chatGPTQuery",parameters:[{name:"request",type:"ChatGPTRequest"},{name:"pluginGroup",type:"PluginGroup"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["ChatGPTResult"]}},{name:"formulaByExample",parameters:[{name:"request",type:"formulaByExampleRequest"},{name:"pluginGroup",type:"PluginGroup"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["formulaByExampleResult"]}}]},{name:"ObsoleteSyncRequester",methods:[{name:"formulaHighlighting",parameters:[{name:"request",type:"FormulaHighlightingRequest"},{name:"pluginGroup",type:"PluginGroup"}],returnType:{type:"FormulaHighlightingResult"}}]},{name:"SyncRequester",methods:[{name:"formulaHighlighting",parameters:[{name:"request",type:"FormulaHighlightingRequest"},{name:"pluginGroup",type:"PluginGroup"},{name:"computationGroup",type:"string"}],returnType:{type:"FormulaHighlightingResult"}}]},{name:"ObsoleteBatchRequester",methods:[{name:"functionSuggestionAndArgumentAssistance",parameters:[{name:"functionSuggestionAndArgumentAssistanceRequest",type:"FunctionSuggestionAndArgumentAssistanceRequest"},{name:"pluginGroup",type:"PluginGroup"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["FunctionSuggestionAndArgumentAssistanceResult"]}}]},{name:"BatchRequester",methods:[{name:"functionSuggestionAndArgumentAssistance",parameters:[{name:"functionSuggestionAndArgumentAssistanceRequest",type:"FunctionSuggestionAndArgumentAssistanceRequest"},{name:"pluginGroup",type:"PluginGroup"},{name:"computationGroup",type:"string"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["FunctionSuggestionAndArgumentAssistanceResult"]}}]},{name:"PluginScheduler",methods:[{name:"notifier",returnType:"Notifier"},{name:"requester",returnType:"Requester"},{name:"getRequester",comment:"@obsolete use requester now",returnType:"ObsoleteRequester"},{name:"syncRequester",returnType:"SyncRequester"},{name:"getSyncRequester",comment:"@obsolete use syncRequester now",returnType:"ObsoleteSyncRequester"},{name:"recalcServiceAttached",returnType:"void",async:!0},{name:"getFunctionsShortDescriptions",returnType:"functionShortDescriptionsMap"},{name:"batchRequester",returnType:"BatchRequester"},{name:"getBatchRequester",comment:"@obsolete use batchRequester now",returnType:"ObsoleteBatchRequester"},{name:"setServerDataProvider",parameters:[{name:"serverDataProvider",type:"ServerDataProvider"}]}]},{name:"PluginSchedulerSingleton",methods:[{name:"instance",parameters:[],returnType:"PluginScheduler"}]},{name:"ServerDataProvider",methods:[{name:"getRichValueFieldListContext",comment:["Returns the fieldInfo data for given range"],async:!0,parameters:[{name:"rangeToQuery",type:"SharedSheetRange"},{name:"dotNotationPath",type:"string"},{name:"singleColumn",type:"boolean"},{name:"findRange",type:"boolean"}],returnType:"FieldInfoListContextData[]"},{name:"getTableColHeaders",comment:["Returns the col header names for a given table"],async:!0,parameters:[{name:"tableName",type:"string"}],returnType:"string[]"}]}],pods:[{name:"AnnotationReceivedEventArgs",fields:[{name:"annotation",type:"AnyObject"},{name:"parentObject",type:"AnyObject"},{name:"parentPath",type:"string[]"},{name:"operationType",type:"ALOperationType"}]},{name:"PluginSchedulerResult",genericParameterDefinitions:["TPayload"],fields:[{name:"kind",type:"PluginSchedulerResultKind"},{name:"payload",type:"TPayload"}]},{name:"SuggestionResult",extends:"CompletionList",fields:[]},{name:"InCellSuggestionResult",fields:[{name:"completionItem",type:"CompletionItem"},{name:"data",type:"Data"}]},{name:"ChatGPTResult",fields:[{name:"result",type:"string"},{name:"details",type:"string"}]},{name:"AnyObject",fields:[]},{name:"RunExperimentResult",extends:"AnyObject",fields:[]},{name:"formulaByExampleEvalResult",extends:"AnyObject",fields:[]},{name:"formulaByExampleSuggestion",fields:[{name:"formula",type:"string"},{name:"cells",type:"formulaByExampleEvalResult[]"}]},{name:"formulaByExampleResult",fields:[{name:"flowId",type:"number-int"},{name:"columnRange",type:"SharedRange",comment:"obsolete property, needs to be defined internally"},{name:"colRange",type:"RangeObject"},{name:"tableName",type:"string"},{name:"tableColumnName",type:"string"},{name:"suggestions",type:"formulaByExampleSuggestion[]"}]},{name:"RunPerCharacterExperimentResult",fields:[{name:"kind",type:"PerCharacterExperimentResultKind"},{name:"value",type:"AnyObject"}]},{name:"RunPerCharacterExperimentResults",fields:[{name:"results",type:"RunPerCharacterExperimentResult[]"}]},{name:"FormulaHighlightingResult",fields:[{name:"formulaHighlights",type:"FormulaHighlight[]"}]},{name:"RunExperimentResults",fields:[{name:"results",type:"RunExperimentResult[]"}]},{name:"AnyObjectResults",fields:[{name:"results",type:"AnyObject[]"}]},{name:"FunctionSuggestionAndArgumentAssistanceResult",fields:[{name:"functionSuggestion",type:"SuggestionResult"},{name:"argumentAssistance",type:"FunctionRenderingInfo"},{name:"inCellSuggestion",type:"InCellSuggestionResult"}]},{name:"RunExperimentRequest",fields:[]},{name:"RunAuthoringExperimentRequest",fields:[{name:"content",type:"string"},{name:"isCellContentOnlyEqualDuringEdit",type:"boolean"}]},{name:"RunTestRequest",fields:[{name:"content",type:"string"}]},{name:"FunctionSuggestionRequest",extends:"SuggestionRequest",fields:[]},{name:"InCellSuggestionRequest",extends:"SuggestionRequest",fields:[]},{name:"ChatGPTRequest",fields:[{name:"query",type:"string"},{name:"context",type:"AnyObject"}]},{name:"RunPerCharacterExperimentRequest",fields:[{name:"content",type:"string"},{name:"caretPosition",type:"number-int"},{name:"enableAutocompleteWrapperPlugin",type:"boolean"}]},{name:"ArgumentAssistanceRequest",fields:[{name:"content",type:"string"},{name:"caretPosition",type:"number-int"}]},{name:"formulaByExampleRequest",fields:[{name:"editedCellRange",type:"SharedRange",comment:"obsolete property, needs to be defined internally"},{name:"cellEditRange",type:"RangeObject"}]},{name:"FunctionSuggestionAndArgumentAssistanceRequest",fields:[{name:"functionSuggestion",type:"FunctionSuggestionRequest"},{name:"argumentAssistance",type:"ArgumentAssistanceRequest"},{name:"inCellSuggestion",type:"InCellSuggestionRequest"}]},{name:"FormulaHighlightingRequest",fields:[{name:"content",type:"string"},{name:"caretPosition",type:"number-int",comment:"The caret position is always at the start of the selection (left for ltr, right for rtl)"},{name:"selectionLength",type:"number-int",nullable:!0}]},{name:"DisplayObject",fields:[{name:"value",type:"string"},{name:"help",type:"string"},{name:"toolTip",type:"string"}]},{name:"FormulaHighlight",fields:[{name:"kind",type:"HighlightKind",comment:"The type of the highlight"},{name:"span",type:"Span",comment:"The index range of the highlight in the formula (start, end)"},{name:"rangeInfo",type:"RangeInfo",comment:"Optional. If the highlight is a reference to a range, contains the range information"}]},{name:"RangeInfo",fields:[{name:"sharedRange",type:"SharedRange",comment:"obsolete property, needs to be defined internally"},{name:"range",type:"RangeObject"},{name:"positionKindInfo",type:"PositionKindInfo",comment:"Optional. If the range is RangeRef, Contains information about the position kind of the range columns/rows"}]},{name:"PositionKindInfo",fields:[{name:"firstRow",type:"PositionKind"},{name:"firstColumn",type:"PositionKind"},{name:"secondRow",type:"PositionKind"},{name:"secondColumn",type:"PositionKind"}]},{name:"Span",fields:[{name:"start",type:"number-int"},{name:"end",type:"number-int"}]},{name:"CellMessage",extends:"FormatMessage",fields:[{name:"colIndex",type:"number-int"},{name:"rowIndex",type:"number-int"},{name:"sheetIndex",type:"string"},{name:"docPath",type:"string"},{name:"docName",type:"string"}]},{name:"FormatMessage",fields:[{name:"formatString",type:"string"},{name:"builtIn",type:"boolean",nullable:!0}]},{name:"functionShortDescriptionsMap",fields:[{name:"descriptionsMap",type:"Map",comment:"obsolete map that is not reka compatible",genericParameters:["number-int","string"]},{name:"descriptionMap",type:"Map",genericParameters:["string","string"]}]},{name:"ValuePreviewRequest",extends:"ContextualText",fields:[]},{name:"ValuePreviewResult",fields:[{name:"kind",type:"ValuePreviewResultKind"},{name:"value",type:"string"},{name:"unformattedValue",type:"string"},{name:"color",type:"AnyObject"},{name:"operKind",type:"number-int",nullable:!0},{name:"evaluatedFormula",type:"string"},{name:"index",type:"number-int"},{name:"length",type:"number-int"}]},{name:"GotoCtrlClickRequest",extends:"ContextualText",fields:[]},{name:"GotoCtrlClickResult",fields:[{name:"kind",type:"GotoCtrlClickResultKind"},{name:"sharedSheetRange",type:"SharedSheetRange"},{name:"sheetRange",type:"SheetRange"},{name:"span",type:"Span"}]},{name:"ContextualText",fields:[{name:"text",type:"string"},{name:"index",type:"number-int"},{name:"length",type:"number-int"}]},{name:"SuggestionRequest",fields:[{name:"content",type:"string"},{name:"caretPosition",type:"number-int",comment:"TODO: remove nullable once passed by S#",nullable:!0}]},{name:"FormulaRepairRequest",fields:[{name:"formula",type:"string"}]}]}});var pNe=Y(hD=>{"use strict";_();Object.defineProperty(hD,"__esModule",{value:!0});hD.DefinedNameInfoType=void 0;var L3r;(function(e){e[e.Invalid=-1]="Invalid",e[e.Table=0]="Table",e[e.NamedRange=1]="NamedRange"})(L3r=hD.DefinedNameInfoType||(hD.DefinedNameInfoType={}))});var gNe=Y(mNe=>{"use strict";_();Object.defineProperty(mNe,"__esModule",{value:!0})});var vNe=Y(Sd=>{"use strict";_();Object.defineProperty(Sd,"__esModule",{value:!0});Sd.RepairItemPartType=Sd.CodeActionKind=Sd.DiagnosticTag=Sd.DiagnosticSeverity=Sd.SuggestionKind=Sd.CompletionItemKind=void 0;var B3r;(function(e){e[e.Function=3]="Function",e[e.Enum=13]="Enum",e[e.NamedRange=100]="NamedRange",e[e.TableHeader=101]="TableHeader",e[e.LetVariable=102]="LetVariable",e[e.RichEntity=103]="RichEntity",e[e.Lambda=104]="Lambda",e[e.CustomFunction=105]="CustomFunction",e[e.Table=106]="Table",e[e.TableSpecialStructRef=107]="TableSpecialStructRef",e[e.RichEntityEmptyCellRef=108]="RichEntityEmptyCellRef",e[e.RangeRef=109]="RangeRef"})(B3r=Sd.CompletionItemKind||(Sd.CompletionItemKind={}));var q3r;(function(e){e[e.Simple=0]="Simple",e[e.Smart=1]="Smart"})(q3r=Sd.SuggestionKind||(Sd.SuggestionKind={}));var U3r;(function(e){e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Information=3]="Information",e[e.Hint=4]="Hint"})(U3r=Sd.DiagnosticSeverity||(Sd.DiagnosticSeverity={}));var G3r;(function(e){e[e.Unnecessary=1]="Unnecessary",e[e.Deprecated=2]="Deprecated"})(G3r=Sd.DiagnosticTag||(Sd.DiagnosticTag={}));var K3r;(function(e){e[e.Empty=0]="Empty",e[e.QuickFix=1]="QuickFix",e[e.Refactor=2]="Refactor",e[e.RefactorExtract=3]="RefactorExtract",e[e.RefactorInline=4]="RefactorInline",e[e.RefactorRewrite=5]="RefactorRewrite",e[e.Source=6]="Source",e[e.SourceOrganizeImports=7]="SourceOrganizeImports",e[e.SourceFixAll=8]="SourceFixAll"})(K3r=Sd.CodeActionKind||(Sd.CodeActionKind={}));var V3r;(function(e){e[e.None=0]="None",e[e.Added=1]="Added",e[e.Removed=2]="Removed",e[e.Replaced=3]="Replaced"})(V3r=Sd.RepairItemPartType||(Sd.RepairItemPartType={}))});var Rne=Y(qi=>{"use strict";_();Object.defineProperty(qi,"__esModule",{value:!0});qi.ALOperationType=qi.SchedulerFeature=qi.GotoCtrlClickResultKind=qi.ValuePreviewResultKind=qi.PositionKind=qi.HighlightKind=qi.PerCharacterExperimentResultKind=qi.PluginSchedulerResultKind=qi.PluginAttachGroup=qi.PluginGroup=qi.PluginFactoryName=qi.MessageType=qi.EditorMessageType=void 0;var W3r;(function(e){e[e.FunctionMessage=0]="FunctionMessage"})(W3r=qi.EditorMessageType||(qi.EditorMessageType={}));var j3r;(function(e){e[e.Insert=0]="Insert",e[e.Delete=1]="Delete",e[e.Replace=2]="Replace"})(j3r=qi.MessageType||(qi.MessageType={}));var H3r;(function(e){e[e.TestPlugin=0]="TestPlugin",e[e.AutocompletePlugin=1]="AutocompletePlugin",e[e.DragPlugin=2]="DragPlugin",e[e.ConfigTestPlugin=3]="ConfigTestPlugin",e[e.ArgumentAssistancePlugin=4]="ArgumentAssistancePlugin",e[e.FeatureGateTestPlugin=5]="FeatureGateTestPlugin",e[e.DNMTraceTagTestPlugin=7]="DNMTraceTagTestPlugin",e[e.ParenthesesCouplingPlugin=8]="ParenthesesCouplingPlugin",e[e.AutocompleteFunctionPlugin=9]="AutocompleteFunctionPlugin",e[e.AutocompleteLetPlugin=10]="AutocompleteLetPlugin",e[e.AutocompleteRichValuePlugin=11]="AutocompleteRichValuePlugin",e[e.AutocompleteNamedObjectsPlugin=12]="AutocompleteNamedObjectsPlugin",e[e.AutocompleteTableHeadersPlugin=13]="AutocompleteTableHeadersPlugin",e[e.ColoredReferencesPlugin=14]="ColoredReferencesPlugin",e[e.ValuePreviewPlugin=15]="ValuePreviewPlugin",e[e.AutocompleteRangeSuggestionPlugin=16]="AutocompleteRangeSuggestionPlugin",e[e.SyntaxErrorsPlugin=17]="SyntaxErrorsPlugin",e[e.GotoCtrlClickPlugin=18]="GotoCtrlClickPlugin",e[e.AutocompleteEnumPlugin=19]="AutocompleteEnumPlugin",e[e.FormulaByExamplePlugin=20]="FormulaByExamplePlugin",e[e.FormulaCollectionPlugin=1004]="FormulaCollectionPlugin",e[e.ParserPerformanceMeasurements=1005]="ParserPerformanceMeasurements",e[e.FormulaRepairShadowEvalPlugin=1007]="FormulaRepairShadowEvalPlugin",e[e.PythonAutocompletePlugin=1008]="PythonAutocompletePlugin",e[e.AutocompleteWrapperPlugin=1009]="AutocompleteWrapperPlugin",e[e.AutocompleteBinaryModelExperimentPlugin=1010]="AutocompleteBinaryModelExperimentPlugin",e[e.ChangeGateTestPlugin=2e3]="ChangeGateTestPlugin",e[e.SlowTestPlugin=2001]="SlowTestPlugin",e[e.EvalOnCloneTestPlugin=2002]="EvalOnCloneTestPlugin",e[e.EvalFormulaTestPlugin=2003]="EvalFormulaTestPlugin",e[e.PythonTestPlugin=2004]="PythonTestPlugin",e[e.ChatGPTPlugin=2005]="ChatGPTPlugin",e[e.EventsTestPlugin=2006]="EventsTestPlugin"})(H3r=qi.PluginFactoryName||(qi.PluginFactoryName={}));var Q3r;(function(e){e[e.Excel=0]="Excel",e[e.Python=1]="Python"})(Q3r=qi.PluginGroup||(qi.PluginGroup={}));var z3r;(function(e){e[e.Core=0]="Core",e[e.Python=1]="Python",e[e.SmartSuggestionsAutoComplete=2]="SmartSuggestionsAutoComplete"})(z3r=qi.PluginAttachGroup||(qi.PluginAttachGroup={}));var Y3r;(function(e){e[e.Done=0]="Done",e[e.Superseded=1]="Superseded"})(Y3r=qi.PluginSchedulerResultKind||(qi.PluginSchedulerResultKind={}));var J3r;(function(e){e[e.AutocompleteWrapperPluginResult=0]="AutocompleteWrapperPluginResult"})(J3r=qi.PerCharacterExperimentResultKind||(qi.PerCharacterExperimentResultKind={}));var X3r;(function(e){e[e.CellRef=0]="CellRef",e[e.StructRef=1]="StructRef",e[e.NamedRange=2]="NamedRange",e[e.Parentheses=3]="Parentheses"})(X3r=qi.HighlightKind||(qi.HighlightKind={}));var Z3r;(function(e){e[e.Absolute=0]="Absolute",e[e.Relative=1]="Relative"})(Z3r=qi.PositionKind||(qi.PositionKind={}));var $3r;(function(e){e[e.Failure=0]="Failure",e[e.Success=1]="Success",e[e.Unavailable=2]="Unavailable"})($3r=qi.ValuePreviewResultKind||(qi.ValuePreviewResultKind={}));var ewr;(function(e){e[e.ReferenceFound=0]="ReferenceFound",e[e.NoReferenceFound=1]="NoReferenceFound",e[e.Failure=2]="Failure",e[e.RangeResolutionFailure=3]="RangeResolutionFailure"})(ewr=qi.GotoCtrlClickResultKind||(qi.GotoCtrlClickResultKind={}));var rwr;(function(e){e[e.ArgumentAssistance=0]="ArgumentAssistance",e[e.SimpleAutoComplete=1]="SimpleAutoComplete",e[e.SmartSuggestionsAutoComplete=2]="SmartSuggestionsAutoComplete",e[e.ValuePreview=3]="ValuePreview",e[e.ColoredReferences=4]="ColoredReferences",e[e.ParenthesisCoupling=5]="ParenthesisCoupling",e[e.SyntaxErrors=6]="SyntaxErrors",e[e.GotoCtrlClick=7]="GotoCtrlClick",e[e.EnumAutoComplete=8]="EnumAutoComplete"})(rwr=qi.SchedulerFeature||(qi.SchedulerFeature={}));var nwr;(function(e){e[e.none=0]="none",e[e.add=1]="add",e[e.update=2]="update",e[e.delete=3]="delete",e[e.updateAnnotationMetaData=4]="updateAnnotationMetaData",e[e.move=5]="move",e[e.focus=6]="focus",e[e.visibility=7]="visibility"})(nwr=qi.ALOperationType||(qi.ALOperationType={}))});var SNe=Y(hNe=>{"use strict";_();Object.defineProperty(hNe,"__esModule",{value:!0})});var yNe=Y(SD=>{"use strict";_();Object.defineProperty(SD,"__esModule",{value:!0});SD.SpecialFormat=void 0;var twr;(function(e){e.Unavailable="Unavailable",e.Weak="Weak",e.ClientValueUnknown="ClientValueUnknown",e.Origin="Origin",e.Aggregate="Aggregate",e.Inferred="Inferred",e.Known="Known",e.Edit="Edit"})(twr=SD.SpecialFormat||(SD.SpecialFormat={}))});var Tne=Y(yd=>{"use strict";_();Object.defineProperty(yd,"__esModule",{value:!0});yd.assertPositiveLength=yd.assertPositiveInteger=yd.assertInteger=yd.assertIndex=yd.assertNatural=yd.assertNever=yd.assertFalse=yd.assertTrue=yd.ulsLogger=void 0;var f_=Cn();yd.ulsLogger=f_.assertions.ulsLogger;yd.assertTrue=f_.assertions.assertTrue;yd.assertFalse=f_.assertions.assertFalse;yd.assertNever=f_.assertions.assertNever;yd.assertNatural=f_.assertions.assertNatural;yd.assertIndex=f_.assertions.assertIndex;yd.assertInteger=f_.assertions.assertInteger;yd.assertPositiveInteger=f_.assertions.assertPositiveInteger;yd.assertPositiveLength=f_.assertions.assertPositiveLength});var yD=Y(Ea=>{"use strict";_();Object.defineProperty(Ea,"__esModule",{value:!0});Ea.now=Ea.mapFromArrayOfPairs=Ea.singleton=Ea.typedInstanceCreator=Ea.makeStringCompareCI=Ea.fastAbs=Ea.fastMax=Ea.fastMin=Ea.pair=Ea.filterOutNones=Ea.isNone=Ea.isDefined=Ea.safeConcat=Ea.safePush=Ea.strEnumArray=Ea.numEnumMap=Ea.numEnumArray=Ea.cloneStringMap=Ea.makeStringMap=Ea.identity=Ea.staticAssertIsOptional=Ea.staticAssertIs=Ea.staticAssertSame=Ea.staticAssertExtends=Ea.makeNewtypeIso=void 0;var rl=Cn();Ea.makeNewtypeIso=rl.core.makeNewtypeIso;Ea.staticAssertExtends=rl.core.staticAssertExtends;Ea.staticAssertSame=rl.core.staticAssertSame;Ea.staticAssertIs=rl.core.staticAssertIs;Ea.staticAssertIsOptional=rl.core.staticAssertIsOptional;Ea.identity=rl.core.identity;Ea.makeStringMap=rl.core.makeStringMap;Ea.cloneStringMap=rl.core.cloneStringMap;Ea.numEnumArray=rl.core.numEnumArray;Ea.numEnumMap=rl.core.numEnumMap;Ea.strEnumArray=rl.core.strEnumArray;Ea.safePush=rl.core.safePush;Ea.safeConcat=rl.core.safeConcat;Ea.isDefined=rl.core.isDefined;Ea.isNone=rl.core.isNone;Ea.filterOutNones=rl.core.filterOutNones;Ea.pair=rl.core.pair;Ea.fastMin=rl.core.fastMin;Ea.fastMax=rl.core.fastMax;Ea.fastAbs=rl.core.fastAbs;Ea.makeStringCompareCI=rl.core.makeStringCompareCI;Ea.typedInstanceCreator=rl.core.typedInstanceCreator;Ea.singleton=rl.core.singleton;Ea.mapFromArrayOfPairs=rl.core.mapFromArrayOfPairs;Ea.now=rl.core.now});var QK=Y(PT=>{"use strict";_();Object.defineProperty(PT,"__esModule",{value:!0});PT.defaultSetTimeoutInterface=PT.clearTimerUnified=PT.setImmediateUnified=void 0;var bne=Cn();PT.setImmediateUnified=bne.setTimeoutInterfaceModule.setImmediateUnified;PT.clearTimerUnified=bne.setTimeoutInterfaceModule.clearTimerUnified;PT.defaultSetTimeoutInterface=bne.setTimeoutInterfaceModule.defaultSetTimeoutInterface});var Ene=Y(SE=>{"use strict";_();Object.defineProperty(SE,"__esModule",{value:!0});SE.RepeatedTaskScheduler=SE.TaskKind=void 0;var awr=Tne(),iwr=yD(),owr=QK(),Ms;(function(e){e[e.NoWorkScheduled=0]="NoWorkScheduled",e[e.PromiseScheduled=1]="PromiseScheduled",e[e.ImmediateScheduled=2]="ImmediateScheduled",e[e.FutureScheduled=3]="FutureScheduled"})(Ms||(Ms={}));(0,iwr.staticAssertExtends)();function YK(e,r){return{kind:e,handle:r}}function Pne(e){return e!==void 0?(e.kind=Ms.NoWorkScheduled,e.handle=void 0,e):YK(Ms.NoWorkScheduled,void 0)}function uwr(e){return e!==void 0?(e.kind=Ms.PromiseScheduled,e.handle=void 0,e):YK(Ms.PromiseScheduled,void 0)}function swr(e,r){return r!==void 0?(r.kind=Ms.ImmediateScheduled,r.handle=e,r):YK(Ms.ImmediateScheduled,e)}function lwr(e,r){return r!==void 0?(r.kind=Ms.FutureScheduled,r.handle=e,r):YK(Ms.FutureScheduled,e)}var zK;(function(e){e.Sync="Sync",e.MicroTask="MicroTask",e.MacroTask="MacroTask"})(zK=SE.TaskKind||(SE.TaskKind={}));var cwr=Promise.resolve(),dwr=function(){function e(r,n){n===void 0&&(n=owr.defaultSetTimeoutInterface);var a=this;this.timer=n,this.handleState=Pne(),this.clearHandleClosureAndRunBody=function(){var o;switch(a.handleState.kind){case Ms.NoWorkScheduled:o=zK.Sync;break;case Ms.PromiseScheduled:o=zK.MicroTask;break;case Ms.ImmediateScheduled:case Ms.FutureScheduled:o=zK.MacroTask;break;default:(0,awr.assertNever)("Unknown handle state",a.handleState)}a.handleState=Pne(a.handleState),r(o)},this.promiseClosure=function(){a.handleState.kind===Ms.PromiseScheduled&&a.clearHandleClosureAndRunBody()}}return e.prototype.runNextSynchronously=function(){switch(this.handleState.kind){case Ms.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle);break;case Ms.FutureScheduled:this.timer.clearTimeout(this.handleState.handle);break}this.clearHandleClosureAndRunBody()},e.prototype.runNextAsMicrotask=function(){switch(this.handleState.kind){case Ms.PromiseScheduled:return;case Ms.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle);break;case Ms.FutureScheduled:this.timer.clearTimeout(this.handleState.handle);break}this.handleState=uwr(this.handleState),cwr.then(this.promiseClosure)},e.prototype.runNextAsMacrotask=function(){switch(this.handleState.kind){case Ms.ImmediateScheduled:return;case Ms.FutureScheduled:this.timer.clearTimeout(this.handleState.handle);break}this.handleState=swr(this.timer.setImmediate(this.clearHandleClosureAndRunBody),this.handleState)},e.prototype.runNextInFuture=function(r){switch(this.handleState.kind){case Ms.FutureScheduled:this.timer.clearTimeout(this.handleState.handle);break;case Ms.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle);break}this.handleState=lwr(this.timer.setTimeout(this.clearHandleClosureAndRunBody,r),this.handleState)},e.prototype.clear=function(){switch(this.handleState.kind){case Ms.FutureScheduled:this.timer.clearTimeout(this.handleState.handle);break;case Ms.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle);break}this.handleState=Pne(this.handleState)},e}();SE.RepeatedTaskScheduler=dwr});var Nne=Y(JK=>{"use strict";_();Object.defineProperty(JK,"__esModule",{value:!0});JK.PriorityQueue=void 0;var fwr=Cn();JK.PriorityQueue=fwr.priorityQueue.PriorityQueue});var Ane=Y(yE=>{"use strict";_();Object.defineProperty(yE,"__esModule",{value:!0});yE.TimelineQueueProcessor=yE.defaultTimerInterface=void 0;var CNe=br(),pwr=yD(),mwr=Nne(),gwr=QK(),_Ne=Ene();yE.defaultTimerInterface=CNe.__assign(CNe.__assign({},gwr.defaultSetTimeoutInterface),{now:pwr.now});var vwr=function(){function e(r,n,a,o){o===void 0&&(o=yE.defaultTimerInterface);var u=this,t,d;this.cmp=r,this.consumeMessage=n,this.timer=o,this.startTime=void 0,this.totalSyncCost=0,this.maxWitnessedNow=0,this.lastFutureAbsoluteTime=void 0,this.queue=new mwr.PriorityQueue(function(s,c){var l=s.delayUntil-c.delayUntil;return l!==0?l:r(s.payload,c.payload)}),this.costThreshold=(t=a==null?void 0:a.costThreshold)!==null&&t!==void 0?t:1,this.timeThreshold=(d=a==null?void 0:a.timeThreshold)!==null&&d!==void 0?d:10,this.scheduler=new _Ne.RepeatedTaskScheduler(function(s){u.totalSyncCost=0,u.lastFutureAbsoluteTime=void 0,s===_Ne.TaskKind.MacroTask&&(u.startTime=void 0),u.continue()},o)}return e.prototype.enqueue=function(r,n,a){a===void 0&&(a=this.maxWitnessedNow),this.queue.enqueue({delayUntil:a,payload:r,abstractCost:n}),this.continue()},e.prototype.push=function(r,n,a){a===void 0&&(a=this.maxWitnessedNow),this.queue.push({delayUntil:a,payload:r,abstractCost:n}),this.continue()},e.prototype.pop=function(){var r;return this.queue.getCount()===1&&this.scheduler.clear(),(r=this.queue.pop())===null||r===void 0?void 0:r.payload},e.prototype.peek=function(){return this.queue.peek()},e.prototype.getCount=function(){return this.queue.getCount()},e.prototype.continue=function(){var r;for(this.startTime=(r=this.startTime)!==null&&r!==void 0?r:this.now();this.totalSyncCost<this.costThreshold;){var n=this.queue.peek();if(n===void 0||n.delayUntil>this.maxWitnessedNow&&this.tryRunNextInFuture(n.delayUntil,this.now()))return;this.queue.pop(),this.totalSyncCost+=n.abstractCost,this.consumeMessage(n.payload)}var a=this.queue.peek();if(a!==void 0){var o=this.now();o-this.startTime<this.timeThreshold&&a.delayUntil<=o?this.scheduler.runNextAsMicrotask():this.tryRunNextInFuture(a.delayUntil,o)||this.scheduler.runNextAsMacrotask()}},e.prototype.tryRunNextInFuture=function(r,n){return r>n?(this.lastFutureAbsoluteTime!==r&&(this.lastFutureAbsoluteTime=r,this.scheduler.runNextInFuture(r-n)),!0):!1},e.prototype.now=function(){return this.maxWitnessedNow=this.timer.now()},e}();yE.TimelineQueueProcessor=vwr});var RNe=Y(yc=>{"use strict";_();Object.defineProperty(yc,"__esModule",{value:!0});yc.values=yc.stringStartsWith=yc.stringEndsWith=yc.repeat=yc.prependErrorMessage=yc.partialArray=yc.messageFromError=yc.mathLog2=yc.isInteger=yc.arrayFill=void 0;var uy=Cn();yc.arrayFill=uy.util.arrayFill;yc.isInteger=uy.util.isInteger;yc.mathLog2=uy.util.mathLog2;yc.messageFromError=uy.util.messageFromError;yc.partialArray=uy.util.partialArray;yc.prependErrorMessage=uy.util.prependErrorMessage;yc.repeat=uy.util.repeat;yc.stringEndsWith=uy.util.stringEndsWith;yc.stringStartsWith=uy.util.stringStartsWith;yc.values=uy.util.values});var TNe=Y(Nk=>{"use strict";_();Object.defineProperty(Nk,"__esModule",{value:!0});Nk.MockTimerImmediate=Nk.MockTimer=void 0;var XK=br(),hwr=Nne(),Swr=RNe(),Ek=QK(),ywr=function(){function e(r){var n=this;this.nowTimes=r,this.setImmediateCalls=[],this.setTimeoutCalls=[],this.clearImmediateCalls=[],this.clearTimeoutCalls=[],this.setImmediate=function(a){for(var o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];if(n.handle!==void 0)throw"setImmediate called, even though we already have a callback";return n.setImmediateCalls.push(XK.__spreadArray([a],o,!0)),n.handle=(0,Ek.setImmediateUnified)(function(){return n.handle=void 0,a.apply(void 0,o)})},this.clearImmediate=function(a){if(n.handle!==a)throw"clearImmediate called with a different handle than the one supplied";(0,Ek.clearTimerUnified)(n.handle),n.clearImmediateCalls.push([a]),n.handle=void 0},this.setTimeout=function(a,o){for(var u=[],t=2;t<arguments.length;t++)u[t-2]=arguments[t];if(n.handle!==void 0)throw"setTimeout called, even though we already have a callback";return n.setTimeoutCalls.push(XK.__spreadArray([a,o],u,!0)),n.handle=(0,Ek.setImmediateUnified)(function(){return n.handle=void 0,a.apply(void 0,u)})},this.clearTimeout=function(a){if(n.handle!==a)throw"clearTimeout called with a different handle than the one supplied";(0,Ek.clearTimerUnified)(n.handle),n.clearTimeoutCalls.push([a]),n.handle=void 0}}return e.prototype.now=function(){var r=this.nowTimes.shift();if(r===void 0)throw"now was called too many times";return r},e}();Nk.MockTimer=ywr;var Cwr=-1,MNn=Nk.MockTimerImmediate=function(){function e(r,n){r===void 0&&(r=1),n===void 0&&(n=0);var a=this;this.precisionMs=r,this.startTime=n,this.setImmediate=function(o){for(var u=[],t=1;t<arguments.length;t++)u[t-1]=arguments[t];var d={delayUntil:Cwr,callback:o,args:u,isValid:!0};return a.queue.enqueue(d),new e.Immediate(d)},this.clearImmediate=function(o){if(!(o instanceof e.Immediate))throw new TypeError("handle is not a MockFullTimer.Immediate");(0,Ek.clearTimerUnified)(o)},this.setTimeout=function(o,u){for(var t=[],d=2;d<arguments.length;d++)t[d-2]=arguments[d];var s=a.time+(u>4?u:4),c={delayUntil:s,callback:o,args:t,isValid:!0};return a.queue.enqueue(c),new e.Timeout(c)},this.clearTimeout=function(o){if(!(o instanceof e.Timeout))throw new TypeError("handle is not a MockFullTimer.Timeout");(0,Ek.clearTimerUnified)(o)},this.time=n>0?n:0,this.queue=new hwr.PriorityQueue(function(o,u){return o.delayUntil-u.delayUntil})}return e.prototype.preciseNow=function(){return this.time},e.prototype.now=function(){return Math.floor(this.time/this.precisionMs)*this.precisionMs},e.prototype.busyWait=function(r){this.time+=r>0?r:0},e.prototype.busyWaitUntil=function(r){this.time=this.time<r?r:this.time},e.prototype.runMacrotasksWhile=function(r){return XK.__awaiter(this,void 0,void 0,function(){var n;return XK.__generator(this,function(a){switch(a.label){case 0:return[4,new Promise(function(o){return setImmediate(function(){return o()})})];case 1:if(a.sent(),!r())return[2];if(n=this.queue.pop(),!n)return[2];if(this.busyWaitUntil(n.delayUntil),n.isValid)try{n.callback.apply(n,n.args)}catch(o){dispatchEvent(new ErrorEvent("error",{error:o,message:(0,Swr.messageFromError)(o),filename:"",lineno:0,colno:0}))}return[3,0];case 2:return[2]}})})},e.Immediate=function(){function r(n){this.delayedCallback=n,this.kind="Mocking"}return r}(),e.Timeout=function(){function r(n){this.delayedCallback=n,this.kind="Mocking"}return r}(),e}()});var bNe=Y(t0=>{"use strict";_();Object.defineProperty(t0,"__esModule",{value:!0});t0.promiseLoop=t0.promiseFinally=t0.newPromise=t0.isThenable=t0.collapseThenable=t0.bindMaybeThenable=t0.MaybeThenable=void 0;var CE=Cn();t0.MaybeThenable=CE.promise.MaybeThenable;t0.bindMaybeThenable=CE.promise.bindMaybeThenable;t0.collapseThenable=CE.promise.collapseThenable;t0.isThenable=CE.promise.isThenable;t0.newPromise=CE.promise.newPromise;t0.promiseFinally=CE.promise.promiseFinally;t0.promiseLoop=CE.promise.promiseLoop});var PNe=Y($K=>{"use strict";_();Object.defineProperty($K,"__esModule",{value:!0});$K.runQueueProcessorUntil=void 0;var ZK=br(),_wr=bNe();function Rwr(e,r){return ZK.__awaiter(this,void 0,void 0,function(){var n,a,o,u=this;return ZK.__generator(this,function(t){switch(t.label){case 0:return n=!1,a=Promise.resolve(r),a.then(function(){return n=!0}),o=0,[4,(0,_wr.promiseLoop)(function(){return ZK.__awaiter(u,void 0,void 0,function(){return ZK.__generator(this,function(d){switch(d.label){case 0:return++o%100!==0?[3,2]:[4,new Promise(function(s){return setTimeout(s,1)})];case 1:d.sent(),d.label=2;case 2:return n?[2,void 0]:(e.step(),[2,!0])}})})},!0)];case 1:return t.sent(),[2,a]}})})}$K.runQueueProcessorUntil=Rwr});var ENe=Y(CD=>{"use strict";_();Object.defineProperty(CD,"__esModule",{value:!0});CD.NotificationKind=void 0;var Twr;(function(e){e.setActiveCell="setActiveCell",e.doNothing="doNothing",e.setA1ReferenceStyle="setA1ReferenceStyle",e.setLocale="setLocale",e.setWorkbookProps="setWorkbookProps",e.updateSheetNames="updateSheetNames",e.updateNamedObjects="updateNamedObjects",e.setFunctionsInfo="setFunctionsInfo",e.conflictResolverEarlyTermination="conflictResolverEarlyTermination",e.setDefinedNamesInfo="setDefinedNamesInfo",e.notifyWorkbookClosing="notifyWorkbookClosing",e.setSchedulerFeatures="setSchedulerFeatures",e.setActiveCellFormat="setActiveCellFormat"})(Twr=CD.NotificationKind||(CD.NotificationKind={}))});var NNe=Y(a0=>{"use strict";_();Object.defineProperty(a0,"__esModule",{value:!0});a0.successUndefined=a0.success=a0.javaScriptError=a0.isSuccess=a0.failure=a0.ResultKind=a0.ReasonKind=void 0;var _E=Cn();a0.ReasonKind=_E.result.ReasonKind;a0.ResultKind=_E.result.ResultKind;a0.failure=_E.result.failure;a0.isSuccess=_E.result.isSuccess;a0.javaScriptError=_E.result.javaScriptError;a0.success=_E.result.success;a0.successUndefined=_E.result.successUndefined});var ANe=Y(kr=>{"use strict";_();Object.defineProperty(kr,"__esModule",{value:!0});kr.isSheetGridRangeEqual=kr.isSheetGridRange=kr.isSheetGridCellEqual=kr.isSheetGridCell=kr.isRichOper=kr.isReadOperEqual=kr.isRangeOper=kr.isRangeOpNoMissing=kr.isRangeOpClosed=kr.isPrimitiveOper=kr.isOperatorNode=kr.isNumberOper=kr.isNumberLiteralNode=kr.isNameScopeEqual=kr.isMissingOper=kr.isMissingNode=kr.isGridRangeEqual=kr.isGridCellEqual=kr.isGridCell=kr.isErrorOper=kr.isDocumentLocEqual=kr.isCommaOpRefWellFormed=kr.isCommaOpNoBadOrMissing=kr.isCommaOpClosed=kr.isBooleanOper=kr.isBooleanLiteralNode=kr.isBlankOper=kr.isArrayOper=kr.internal=kr.gridRangesJoin=kr.gridRangeSize=kr.gridRangeJoinOpt=kr.gridRangeJoin=kr.gridRangeIsects=kr.gridRangeIsect=kr.gridRangeExcept=kr.gridRangeCompare=kr.gridRangeAnchor=kr.gridCellRange=kr.gridCellImplicitIsect=kr.getWorksheetFuncId=kr.getUserDefinedFuncName=kr.getBoundName=kr.getArguments=kr.getArgType=kr.forEachTileInRange=kr.forEachCellInRange=kr.createFailureErrorClass=kr.ReasonKind=kr.LangReasonKind=void 0;kr.unavailable=kr.shouldFieldRefBeBracketed=kr.sheetGridRangeAnchor=kr.notImplemented=kr.normalizeCommaOpRef=kr.isWriteOper=kr.isWellFormed=kr.isWSFNode=kr.isValidArgsLength=kr.isUnqualifiedNameNode=kr.isStringOper=kr.isSheetIndexEqual=kr.isSheetIndex=void 0;var qt=et();kr.LangReasonKind=qt.util.LangReasonKind;kr.ReasonKind=qt.util.ReasonKind;kr.createFailureErrorClass=qt.util.createFailureErrorClass;kr.forEachCellInRange=qt.util.forEachCellInRange;kr.forEachTileInRange=qt.util.forEachTileInRange;kr.getArgType=qt.util.getArgType;kr.getArguments=qt.util.getArguments;kr.getBoundName=qt.util.getBoundName;kr.getUserDefinedFuncName=qt.util.getUserDefinedFuncName;kr.getWorksheetFuncId=qt.util.getWorksheetFuncId;kr.gridCellImplicitIsect=qt.util.gridCellImplicitIsect;kr.gridCellRange=qt.util.gridCellRange;kr.gridRangeAnchor=qt.util.gridRangeAnchor;kr.gridRangeCompare=qt.util.gridRangeCompare;kr.gridRangeExcept=qt.util.gridRangeExcept;kr.gridRangeIsect=qt.util.gridRangeIsect;kr.gridRangeIsects=qt.util.gridRangeIsects;kr.gridRangeJoin=qt.util.gridRangeJoin;kr.gridRangeJoinOpt=qt.util.gridRangeJoinOpt;kr.gridRangeSize=qt.util.gridRangeSize;kr.gridRangesJoin=qt.util.gridRangesJoin;kr.internal=qt.util.internal;kr.isArrayOper=qt.util.isArrayOper;kr.isBlankOper=qt.util.isBlankOper;kr.isBooleanLiteralNode=qt.util.isBooleanLiteralNode;kr.isBooleanOper=qt.util.isBooleanOper;kr.isCommaOpClosed=qt.util.isCommaOpClosed;kr.isCommaOpNoBadOrMissing=qt.util.isCommaOpNoBadOrMissing;kr.isCommaOpRefWellFormed=qt.util.isCommaOpRefWellFormed;kr.isDocumentLocEqual=qt.util.isDocumentLocEqual;kr.isErrorOper=qt.util.isErrorOper;kr.isGridCell=qt.util.isGridCell;kr.isGridCellEqual=qt.util.isGridCellEqual;kr.isGridRangeEqual=qt.util.isGridRangeEqual;kr.isMissingNode=qt.util.isMissingNode;kr.isMissingOper=qt.util.isMissingOper;kr.isNameScopeEqual=qt.util.isNameScopeEqual;kr.isNumberLiteralNode=qt.util.isNumberLiteralNode;kr.isNumberOper=qt.util.isNumberOper;kr.isOperatorNode=qt.util.isOperatorNode;kr.isPrimitiveOper=qt.util.isPrimitiveOper;kr.isRangeOpClosed=qt.util.isRangeOpClosed;kr.isRangeOpNoMissing=qt.util.isRangeOpNoMissing;kr.isRangeOper=qt.util.isRangeOper;kr.isReadOperEqual=qt.util.isReadOperEqual;kr.isRichOper=qt.util.isRichOper;kr.isSheetGridCell=qt.util.isSheetGridCell;kr.isSheetGridCellEqual=qt.util.isSheetGridCellEqual;kr.isSheetGridRange=qt.util.isSheetGridRange;kr.isSheetGridRangeEqual=qt.util.isSheetGridRangeEqual;kr.isSheetIndex=qt.util.isSheetIndex;kr.isSheetIndexEqual=qt.util.isSheetIndexEqual;kr.isStringOper=qt.util.isStringOper;kr.isUnqualifiedNameNode=qt.util.isUnqualifiedNameNode;kr.isValidArgsLength=qt.util.isValidArgsLength;kr.isWSFNode=qt.util.isWSFNode;kr.isWellFormed=qt.util.isWellFormed;kr.isWriteOper=qt.util.isWriteOper;kr.normalizeCommaOpRef=qt.util.normalizeCommaOpRef;kr.notImplemented=qt.util.notImplemented;kr.sheetGridRangeAnchor=qt.util.sheetGridRangeAnchor;kr.shouldFieldRefBeBracketed=qt.util.shouldFieldRefBeBracketed;kr.unavailable=qt.util.unavailable});var ONe=Y(e8=>{"use strict";_();Object.defineProperty(e8,"__esModule",{value:!0});e8.MockGlobals=void 0;var sy=NNe(),ly=ANe(),bwr=function(){function e(r){this.config=r}return e.prototype.getDocumentLoc=function(){return(0,sy.failure)((0,ly.notImplemented)(["getDocumentLoc"]))},e.prototype.getSheetIndex=function(){return(0,sy.failure)((0,ly.notImplemented)(["getSheetIndex"]))},e.prototype.getSheetName=function(){return(0,sy.failure)((0,ly.notImplemented)(["getSheetName"]))},e.prototype.getNameLoc=function(){return(0,sy.failure)((0,ly.notImplemented)(["getNameLoc"]))},e.prototype.getUserDefinedFuncLoc=function(){return(0,sy.failure)((0,ly.notImplemented)(["getUserDefinedFuncLoc"]))},e.prototype.getSheetRangeIndexes=function(){return(0,sy.failure)((0,ly.notImplemented)(["getSheetRangeIndexes"]))},e.prototype.getContainingTable=function(){return(0,sy.failure)((0,ly.notImplemented)(["getContainingTable"]))},e.prototype.getStructRefColumn=function(){return(0,sy.failure)((0,ly.notImplemented)(["getStructRefColumn"]))},e.prototype.getStructRefSpecialRef=function(){return(0,sy.failure)((0,ly.notImplemented)(["getStructRefSpecialRef"]))},e.prototype.getTime=function(){return(0,sy.failure)((0,ly.unavailable)(["getTime"]))},e}();e8.MockGlobals=bwr});var MNe=Y(cy=>{"use strict";_();Object.defineProperty(cy,"__esModule",{value:!0});cy.spanCompare=cy.Timeline=cy.spanToLSPRange=cy.indexToLSPPosition=void 0;var kNe=br(),Pwr=yD(),Ewr=Ane(),r8=Ol(),FNe=Tne(),INe=oC();function One(e,r){for(var n=0,a=0;a<r;){var o=e.indexOf("\n",a),u=e.indexOf("\r",a),t=o<0?u:u<0?o:(0,Pwr.fastMin)(o,u);if(t<0||t>=r)break;n+=1,a=t+1+(t===u&&t+1<r&&e.charCodeAt(t+1)===10?1:0)}return{line:n,character:r-a}}cy.indexToLSPPosition=One;function Nwr(e,r,n){return{start:One(e,r),end:One(e,n)}}cy.spanToLSPRange=Nwr;var Awr=function(){function e(r,n,a){a===void 0&&(a=!0),this.name=r,this.logThreshold=n,this.enabled=a,this.timestamps=new Map,this.timer=Ewr.defaultTimerInterface,this.workerInfo={isWorkerThread:(0,INe.isWorkerThread)(),workerName:(0,INe.workerName)()},FNe.ulsLogger.ULS.traceTag(526223315,r8.LogCategory.msoulscat_ES_EWAJS,r8.TraceLevel.Info,"Timeline[".concat(this.name,"]: Initializing, ").concat(JSON.stringify(this.workerInfo)))}return e.prototype.stamp=function(r){this.enabled&&!this.timestamps.has(r)&&this.timestamps.set(r,this.timer.now())},e.prototype.log=function(r){if(this.enabled){this.stamp(r);var n={},a=this.timer.now(),o=0;this.timestamps.forEach(function(u,t){a=Math.min(a,u),o=Math.max(o,u),n[t]=u}),o-a>this.logThreshold&&FNe.ulsLogger.ULS.traceTag(526234881,r8.LogCategory.msoulscat_ES_EWAJS,r8.TraceLevel.Info,"Timeline[".concat(this.name,"]: ").concat(JSON.stringify(kNe.__assign(kNe.__assign({},n),this.workerInfo)))),this.timestamps.clear()}},e}();cy.Timeline=Awr;function Owr(e,r){var n;return(n=e.start-r.start)!==0||(n=r.end-e.end)!==0?n:0}cy.spanCompare=Owr});var wNe=Y(Dt=>{"use strict";_();Object.defineProperty(Dt,"__esModule",{value:!0});Dt.userDefinedFuncLoc=Dt.unsafeGridRange=Dt.structRefColumnLoc=Dt.sheetRows=Dt.sheetRangeIndexes=Dt.sheetRange=Dt.sheetIndex=Dt.sheetGridRange=Dt.sheetGridCube=Dt.sheetGridCell=Dt.sheetCols=Dt.originCell=Dt.nameScope=Dt.nameLoc=Dt.lexicalSourceRange=Dt.lexicalSourceUDF=Dt.lexicalSourceWSF=Dt.lexicalSourceName=Dt.lexicalSourceGrid=Dt.lexicalSourceCell=Dt.isSheetIndex=Dt.isSheetGridRange=Dt.isSheetGridCell=Dt.isGridCell=Dt.gridRange=Dt.gridCell=Dt.documentScope=Dt.documentLoc=Dt.allSheetsRange=Dt.NameSource=Dt.LexicalKind=void 0;var du=et();Dt.LexicalKind=du.location.LexicalKind;Dt.NameSource=du.location.NameSource;Dt.allSheetsRange=du.location.allSheetsRange;Dt.documentLoc=du.location.documentLoc;Dt.documentScope=du.location.documentScope;Dt.gridCell=du.location.gridCell;Dt.gridRange=du.location.gridRange;Dt.isGridCell=du.location.isGridCell;Dt.isSheetGridCell=du.location.isSheetGridCell;Dt.isSheetGridRange=du.location.isSheetGridRange;Dt.isSheetIndex=du.location.isSheetIndex;Dt.lexicalSourceCell=du.location.lexicalSourceCell;Dt.lexicalSourceGrid=du.location.lexicalSourceGrid;Dt.lexicalSourceName=du.location.lexicalSourceName;Dt.lexicalSourceWSF=du.location.lexicalSourceWSF;Dt.lexicalSourceUDF=du.location.lexicalSourceUDF;Dt.lexicalSourceRange=du.location.lexicalSourceRange;Dt.nameLoc=du.location.nameLoc;Dt.nameScope=du.location.nameScope;Dt.originCell=du.location.originCell;Dt.sheetCols=du.location.sheetCols;Dt.sheetGridCell=du.location.sheetGridCell;Dt.sheetGridCube=du.location.sheetGridCube;Dt.sheetGridRange=du.location.sheetGridRange;Dt.sheetIndex=du.location.sheetIndex;Dt.sheetRange=du.location.sheetRange;Dt.sheetRangeIndexes=du.location.sheetRangeIndexes;Dt.sheetRows=du.location.sheetRows;Dt.structRefColumnLoc=du.location.structRefColumnLoc;Dt.unsafeGridRange=du.location.unsafeGridRange;Dt.userDefinedFuncLoc=du.location.userDefinedFuncLoc});var DNe=Y($a=>{"use strict";_();Object.defineProperty($a,"__esModule",{value:!0});$a.valueErrorOper=$a.trueOper=$a.stringOper=$a.refErrorOper=$a.rangeSeqOper=$a.range3DOper=$a.precedents=$a.numErrorOper=$a.nullErrorOper=$a.nameErrorOper=$a.naErrorOper=$a.missingOper=$a.gettingDataErrorOper=$a.fieldErrorOper=$a.falseOper=$a.errorOper=$a.div0ErrorOper=$a.cellStringLimit=$a.booleanOper=$a.blankOper=$a.arrayOper=$a.PrecsBound=$a.ErrorType=void 0;var Kl=et();$a.ErrorType=Kl.value.ErrorType;$a.PrecsBound=Kl.value.PrecsBound;$a.arrayOper=Kl.value.arrayOper;$a.blankOper=Kl.value.blankOper;$a.booleanOper=Kl.value.booleanOper;$a.cellStringLimit=Kl.value.cellStringLimit;$a.div0ErrorOper=Kl.value.div0ErrorOper;$a.errorOper=Kl.value.errorOper;$a.falseOper=Kl.value.falseOper;$a.fieldErrorOper=Kl.value.fieldErrorOper;$a.gettingDataErrorOper=Kl.value.gettingDataErrorOper;$a.missingOper=Kl.value.missingOper;$a.naErrorOper=Kl.value.naErrorOper;$a.nameErrorOper=Kl.value.nameErrorOper;$a.nullErrorOper=Kl.value.nullErrorOper;$a.numErrorOper=Kl.value.numErrorOper;$a.precedents=Kl.value.precedents;$a.range3DOper=Kl.value.range3DOper;$a.rangeSeqOper=Kl.value.rangeSeqOper;$a.refErrorOper=Kl.value.refErrorOper;$a.stringOper=Kl.value.stringOper;$a.trueOper=Kl.value.trueOper;$a.valueErrorOper=Kl.value.valueErrorOper});var LNe=Y(Dg=>{"use strict";_();Object.defineProperty(Dg,"__esModule",{value:!0});Dg.wrapIntoResumeRecalc=Dg.emptyRangeFormat=Dg.emptyRangeFormula=Dg.emptyRangeValue=Dg.FormulaKind=void 0;var dy=br(),kwr=wNe(),Fwr=DNe(),Iwr=yD(),xNe;(function(e){e.Value="Value",e.CellFormula="CellFormula"})(xNe=Dg.FormulaKind||(Dg.FormulaKind={}));Dg.emptyRangeValue=Fwr.blankOper;Dg.emptyRangeFormula={kind:xNe.Value,formulaBarText:"",origin:(0,kwr.gridCell)(0,0)};(0,Iwr.staticAssertExtends)();Dg.emptyRangeFormat=0;function Mwr(e,r){return{evalClonedModelOnSnapshot:function(a){for(var o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];var t=e.evalClonedModelOnSnapshot.apply(e,dy.__spreadArray([a],o,!1));return r(a),t},discardSnapshot:e.discardSnapshot.bind(e),getRangeFormats:function(a){for(var o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];var t=e.getRangeFormats.apply(e,dy.__spreadArray([a],o,!1));return r(a),t},getRangeValues:function(a){for(var o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];var t=e.getRangeValues.apply(e,dy.__spreadArray([a],o,!1));return r(a),t},getRangeFormulae:function(a){for(var o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];var t=e.getRangeFormulae.apply(e,dy.__spreadArray([a],o,!1));return r(a),t},getSheetNames:function(a){for(var o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];var t=e.getSheetNames.apply(e,dy.__spreadArray([a],o,!1));return r(a),t},getIntersectingTables:function(a){for(var o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];var t=e.getIntersectingTables.apply(e,dy.__spreadArray([a],o,!1));return r(a),t},getIformats:function(a){for(var o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];var t=e.getIformats.apply(e,dy.__spreadArray([a],o,!1));return r(a),t},getHiddenRows:function(a){for(var o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];var t=e.getHiddenRows.apply(e,dy.__spreadArray([a],o,!1));return r(a),t},getHiddenCols:function(a){for(var o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];var t=e.getHiddenCols.apply(e,dy.__spreadArray([a],o,!1));return r(a),t},evalFormulaOnSnapshot:function(a){for(var o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];var t=e.evalFormulaOnSnapshot.apply(e,dy.__spreadArray([a],o,!1));return r(a),t},getCorrespondingSnapshotID:function(a){return e.getCorrespondingSnapshotID(a)}}}Dg.wrapIntoResumeRecalc=Mwr});var fy=Y(ci=>{"use strict";_();Object.defineProperty(ci,"__esModule",{value:!0});ci.gridinterface=ci.helpers=ci.mockGlobals=ci.notificationKinds=ci.testUtils=ci.mockTimer=ci.timelineQueueProcessor=ci.repeatedTaskScheduler=ci.types=ci.sharedModule=ci.smartCompletionEwaFacadeModule=ci.formulaAssistanceModule=ci.dynamicPluginLoaderEwaFacadeModule=ci.definedNameInfoEwaFacadeModule=ci.smartCompletionDefinitions=ci.pluginSchedulerFactoryDefinitionModule=ci.functionInfoDTO=ci.formulaAssistanceDefinitionsModule=ci.fieldInfoDataDTO=ci.dynamicPluginLoaderDefinitionsModule=ci.definedNameInfoDefinitionsModule=ci.PackageName=void 0;ci.PackageName="excel-online-x10-types";ci.definedNameInfoDefinitionsModule=iNe();ci.dynamicPluginLoaderDefinitionsModule=oNe();ci.fieldInfoDataDTO=uNe();ci.formulaAssistanceDefinitionsModule=sNe();ci.functionInfoDTO=cNe();ci.pluginSchedulerFactoryDefinitionModule=dNe();ci.smartCompletionDefinitions=fNe();ci.definedNameInfoEwaFacadeModule=pNe();ci.dynamicPluginLoaderEwaFacadeModule=gNe();ci.formulaAssistanceModule=vNe();ci.smartCompletionEwaFacadeModule=Rne();ci.sharedModule=SNe();ci.types=yNe();ci.repeatedTaskScheduler=Ene();ci.timelineQueueProcessor=Ane();ci.mockTimer=TNe();ci.testUtils=PNe();ci.notificationKinds=ENe();ci.mockGlobals=ONe();ci.helpers=MNe();ci.gridinterface=LNe()});var Fu=Y(ws=>{_();Object.defineProperty(ws,"__esModule",{value:!0});ws.ValuePreviewResultKind=ws.SchedulerFeature=ws.PositionKind=ws.PluginSchedulerResultKind=ws.PluginGroup=ws.PluginFactoryName=ws.PluginAttachGroup=ws.MessageType=ws.HighlightKind=ws.GotoCtrlClickResultKind=ws.EditorMessageType=ws.ALOperationType=void 0;var Jv=fy(),wwr=Jv.smartCompletionEwaFacadeModule.EditorMessageType;ws.EditorMessageType=wwr;var Dwr=Jv.smartCompletionEwaFacadeModule.MessageType;ws.MessageType=Dwr;var xwr=Jv.smartCompletionEwaFacadeModule.PluginFactoryName;ws.PluginFactoryName=xwr;var Lwr=Jv.smartCompletionEwaFacadeModule.PluginGroup;ws.PluginGroup=Lwr;var Bwr=Jv.smartCompletionEwaFacadeModule.PluginAttachGroup;ws.PluginAttachGroup=Bwr;var qwr=Jv.smartCompletionEwaFacadeModule.PluginSchedulerResultKind;ws.PluginSchedulerResultKind=qwr;var Uwr=Jv.smartCompletionEwaFacadeModule.HighlightKind;ws.HighlightKind=Uwr;var Gwr=Jv.smartCompletionEwaFacadeModule.ValuePreviewResultKind;ws.ValuePreviewResultKind=Gwr;var Kwr=Jv.smartCompletionEwaFacadeModule.GotoCtrlClickResultKind;ws.GotoCtrlClickResultKind=Kwr;var Vwr=Jv.smartCompletionEwaFacadeModule.PositionKind;ws.PositionKind=Vwr;var Wwr=Jv.smartCompletionEwaFacadeModule.SchedulerFeature;ws.SchedulerFeature=Wwr;var jwr=Jv.smartCompletionEwaFacadeModule.ALOperationType;ws.ALOperationType=jwr});var Xv=Y(NT=>{_();Object.defineProperty(NT,"__esModule",{value:!0});NT.x10Logger=NT.ImmediateLogger=NT.CombinedLogger=void 0;var xf=br(),n8=ft(),ET=Ai(),i0=tu(),BNe=Fu(),qNe=Jc(),kne="Main",py=function(r,n,a){return"x10arch.[".concat(r,"].").concat(n,": ").concat((0,n8.isDefined)(a.description)&&a.description.length?"".concat(a.description,". "):"").concat((0,n8.isDefined)(a.data)?JSON.stringify(a.data):"")};(0,n8.staticAssertExtends)();(0,n8.staticAssertExtends)();var Hwr={snapshotCreation:function(r,n){return ET.ulsLogger.ULS.traceTag(512305240,i0.LogCategory.msoulscat_ES_EWAJS,i0.TraceLevel.Info,py(r,"snapshotCreation",{data:n}))},beginRequest:function(r,n){return ET.ulsLogger.ULS.traceTag(553734792,i0.LogCategory.msoulscat_ES_EWAJS,i0.TraceLevel.Info,py(r,"beginRequest",{data:n}))},requestSkipped:function(r,n){return ET.ulsLogger.ULS.traceTag(553734793,i0.LogCategory.msoulscat_ES_EWAJS,i0.TraceLevel.Info,py(r,"requestSkipped",{data:n}))},registerPluginFactory:function(r,n){var a=n.factoryName;return ET.ulsLogger.ULS.traceTag(571246212,i0.LogCategory.msoulscat_ES_EWAJS,i0.TraceLevel.Info,py(r,"registerPluginFactory",{description:"registered ".concat(BNe.PluginFactoryName[a])}))},pluginCompletedInTime:function(r,n){var a=n.pluginName,o=n.logInfo;return ET.ulsLogger.ULS.traceTag(553734790,i0.LogCategory.msoulscat_ES_EWAJS,i0.TraceLevel.Info,py(r,"pluginCompletedInTime",{description:"plugin completed in time. plugin name:".concat(a),data:o}))},computationStoppedExecution:function(r,n){var a=n.computationName,o=n.stopReason,u=n.logInfo;return ET.ulsLogger.ULS.traceTag(509109120,i0.LogCategory.msoulscat_ES_EWAJS,i0.TraceLevel.Info,py(r,"pluginStoppedExecution",{data:(0,xf.__assign)({computationName:a,stopReason:o},u)}))},closeComputationFrame:function(r,n){return ET.ulsLogger.ULS.traceTag(553734789,i0.LogCategory.msoulscat_ES_EWAJS,i0.TraceLevel.Info,py(r,"closeUIMessageFrame",{data:n}))}},Qwr={snapshotCreation:{numSnapshots:0,numFreshSnapshots:0},beginRequest:{},requestSkipped:{},registerPluginFactory:{factories:[]},pluginCompletedInTime:{},computationStoppedExecution:{},closeComputationFrame:{}},zwr={snapshotCreation:function(r,n){var a=r.numSnapshots,o=r.numFreshSnapshots;return{numSnapshots:a+1,numFreshSnapshots:o+(n?1:0)}},beginRequest:function(r,n){var a,o,u=n.computationKind;return(0,xf.__assign)((0,xf.__assign)({},r),(a={},a[u]=((o=r[u])!==null&&o!==void 0?o:0)+1,a))},requestSkipped:function(r,n){var a,o,u=n.computationKind;return(0,xf.__assign)((0,xf.__assign)({},r),(a={},a[u]=((o=r[u])!==null&&o!==void 0?o:0)+1,a))},registerPluginFactory:function(r,n){var a=r.factories,o=n.factoryName;return{factories:(0,xf.__spreadArray)((0,xf.__spreadArray)([],a,!0),[BNe.PluginFactoryName[o]],!1)}},pluginCompletedInTime:function(r,n){var a,o,u=n.pluginName;return(0,xf.__assign)((0,xf.__assign)({},r),(a={},a[u]=((o=r[u])!==null&&o!==void 0?o:0)+1,a))},computationStoppedExecution:function(r,n){var a,o,u,t,d=n.computationName,s=n.stopReason;return(0,xf.__assign)((0,xf.__assign)({},r),(a={},a[d]=(0,xf.__assign)((0,xf.__assign)({},r[d]),(o={},o[s]=((t=(u=r[d])===null||u===void 0?void 0:u[s])!==null&&t!==void 0?t:0)+1,o)),a))},closeComputationFrame:function(r,n){var a,o,u,t;return(0,xf.__assign)((0,xf.__assign)({},r),(a={},a[n.computationKind]=(0,xf.__assign)((0,xf.__assign)({},r[n.computationKind]),(o={},o[n.stopReason]=((t=(u=r[n.computationKind])===null||u===void 0?void 0:u[n.stopReason])!==null&&t!==void 0?t:0)+1,o)),a))}},Fne=function(){function e(){var r=this;this._threadId=kne,this.formatLogMessage=function(n,a){return py(r.threadId,n,a)}}return e.prototype.log=function(r){Hwr[r.kind](this.threadId,r.payload)},e.prototype.flush=function(){},Object.defineProperty(e.prototype,"threadId",{get:function(){return this._threadId},set:function(n){this._threadId=n},enumerable:!1,configurable:!0}),e}();NT.ImmediateLogger=Fne;var Ywr=function(){function e(){var r=this;this.loggingStates=(0,xf.__assign)({},Qwr),this._threadId=kne,this.formatLogMessage=function(n,a){return py(r.threadId,n,a)}}return e.prototype.log=function(r){this.loggingStates[r.kind]=zwr[r.kind](this.loggingStates[r.kind],r.payload)},e.prototype.flush=function(){ET.ulsLogger.ULS.traceTag(512274703,i0.LogCategory.msoulscat_ES_EWAJS,i0.TraceLevel.Warning,this.formatLogMessage("AgggregationLogger.flush",{description:"summary logs for session",data:this.loggingStates}))},Object.defineProperty(e.prototype,"threadId",{get:function(){return this._threadId},set:function(n){this._threadId=n},enumerable:!1,configurable:!0}),e}(),UNe=function(){function e(){var r=this;this._threadId=kne,this.aggregatingLogger=new Ywr,this.formatLogMessage=function(n,a){return py(r.threadId,n,a)},(0,qNe.getTypedFeatureGate)("Microsoft.Office.Excel.EnableFullSessionLogging")&&(this.immediateLogger=new Fne)}return e.prototype.log=function(r){var n;(n=this.immediateLogger)===null||n===void 0||n.log(r),this.aggregatingLogger.log(r)},e.prototype.flush=function(){var r;(r=this.immediateLogger)===null||r===void 0||r.flush(),this.aggregatingLogger.flush()},Object.defineProperty(e.prototype,"threadId",{get:function(){return this._threadId},set:function(n){this._threadId=n,this.immediateLogger&&(this.immediateLogger.threadId=n),this.aggregatingLogger.threadId=n},enumerable:!1,configurable:!0}),e}();NT.CombinedLogger=UNe;var Jwr=(0,qNe.getTypedFeatureGate)("Microsoft.Office.Excel.UseAggregatedLogging")?new UNe:new Fne;NT.x10Logger=Jwr});var xne=Y(gy=>{_();Object.defineProperty(gy,"__esModule",{value:!0});gy.PartialWorkbook=gy.MaxStateIdDifferenceForGC=gy.EvalOnClonePropsFromPartialWBDocumentCollection=gy.EvalOnClonePropsFromPartialWB=void 0;var AT=br(),bE=Z1(),yS=zu(),ss=gs(),t8=f1(),Xwr=sg(),Wn=vd(),RE=Ai(),a8=e0(),_D=r_(),Zwr=YO(),Ak=ft(),RD=Wre(),$wr=Cn(),GNe=x0(),Ine=KPe(),KNe=Ol(),ho=VPe(),TE=Ll(),eDr=H3(),Zt=Di(),Mne=Ml(),rDr=iEe(),i8=GK(),WNe=Pk(),Dne=cu(),nDr=ig(),tDr=Xv(),aDr=gT(),iDr=1,oDr=1e3,uDr=1,sDr=10,lDr=1e4,VNe=2*ss.sheetCols,wne=17;gy.MaxStateIdDifferenceForGC=wne;var o8=(0,ss.gridRange)(0,0,ss.sheetRows,ss.sheetCols);function u8(e,r){var n;return r.kind===bE.ReasonKind.Unavailable&&r.objects.length>0&&"kind"in r.objects[0]&&(n=r.objects[0].kind),(0,Zt.failure)({cell:e,kind:r.kind,innerKind:n})}var cDr=(0,Mne.binaryVisitor)((0,AT.__assign)((0,AT.__assign)({},(0,Mne.constVisitor)(!1)),{wsfNode:function(r){return r===Xwr.WorksheetFuncId.HYPERLINK}}),function(e,r){return e||r}),my;(function(e){e.EvalFinished="EvalFinished",e.EvalTimedOut="EvalTimedOut",e.StateIdAdvanced="StateIdAdvanced",e.EditReceived="EditReceived",e.SetSheetNames="SetSheetNames",e.SetLangConfig="SetLangConfig"})(my||(my={}));var dDr=function(){function e(r,n){this.formatResults=n,this.resultsPromise=new WNe.ResolvablePromise,this.stateId=-1,this.cloneLazy=new Dne.ResettableLazy(function(){return r.createSnapshotSync()})}return e}();gy.EvalOnClonePropsFromPartialWB=dDr;var fDr=function(){function e(r,n){this.formatResults=n,this.resultsPromise=new WNe.ResolvablePromise,this.stateId=-1,this.cloneLazy=new Dne.ResettableLazy(function(){return r.clone(RD.voidCallback,_D.CloningTarget.Client)})}return e}();gy.EvalOnClonePropsFromPartialWBDocumentCollection=fDr;var dt;(function(e){e[e.ServerUpdate=0]="ServerUpdate",e[e.ClientEdit=1]="ClientEdit",e[e.EvalFormula=2]="EvalFormula",e[e.BeforeCompute=3]="BeforeCompute",e[e.ComputeCellValue=4]="ComputeCellValue",e[e.AfterCompute=5]="AfterCompute",e[e.ComputeEvalOnClone=6]="ComputeEvalOnClone",e[e.ComputeEvalFormula=7]="ComputeEvalFormula",e[e.RecalcFinished=8]="RecalcFinished",e[e.CompleteDataQuery=9]="CompleteDataQuery",e[e.MaybeCollectGarbage=10]="MaybeCollectGarbage",e[e.RunExperiment=11]="RunExperiment",e[e.TestAdvanceState=12]="TestAdvanceState"})(dt||(dt={}));var pDr=function(){function e(r,n){n===void 0&&(n={});var a=this,o,u;this.scheduler=new ho.PriorityScheduler,this.outputMessageLog=[],this.stateId=-(1/0),this.stateChangesSinceLastGC=0,this.stateChanges=0,this.stateEvalTime=0,this.latestSnapshotID=-1,this.numPrecisionFailures=0,this.printFormulaProperties=function(t){var d,s=(0,yS.sheetGridRangeAnchor)(t),c=a.getAvailableFormula(s);if(!(0,Zt.isSuccess)(c))return void a.onUnavailableObject(c.reason);var l=(d=c.value,d[0]),f=d[1],p=f.compiledFmla.getValue(),m=(0,Zt.isSuccess)(p)?a.docs.printFormulaBarText(l,s.range,p.value):p,v=m.kind===Zt.ResultKind.Success?m.value:void a.outputMessageLog.push({kind:Wn.OutputMessageKind.PrintFormulaFailure,stateId:a.stateId,range:t,reason:m.reason});return{formulaBarText:v,hasHyperlink:a.formulaHasHyperlink(f),isFormula:!0}},this.printValueProperties=function(t,d){var s,c,l=a.docs.getEditedFormula(t);if(!(0,Zt.isSuccess)(l))return void a.onUnavailableObject(l.reason);var f=(c=(s=l.value)===null||s===void 0?void 0:s[1].fmla)!==null&&c!==void 0?c:"",p=a.docs.renderValueBarText(t,d,f),m=(0,Zt.isSuccess)(p)?p.value:void a.outputMessageLog.push({kind:Wn.OutputMessageKind.PrintFormulaFailure,stateId:a.stateId,range:t,reason:p.reason});return{formulaBarText:m,hasHyperlink:!1,isFormula:!1}},this.scheduleAvailableFormulas=function(t,d){var s=a.docs.forEachEditedNonBlankCellInSet(t.sheet,t.set,function(c){var l=(0,ss.sheetGridCell)(t.sheet,c),f=a.docs.getEditedFormula(l);return f.kind===Zt.ResultKind.Failure?(a.onUnavailableObject(f.reason),!0):(f.value!==void 0&&f.value[1].compiledFmla!==void 0&&a.enqueueComputeCellValue(l,d),!0)});(0,Zt.isSuccess)(s)||a.onUnavailableObject(s.reason)},this.scheduleAvailableValues=function(t,d){var s=a.docs.forEachEditedCellInSet(t.sheet,t.set,function(c){var l=(0,ss.sheetGridCell)(t.sheet,c),f=a.docs.getEditedFormula(l);return f.kind===Zt.ResultKind.Failure?(a.onUnavailableObject(f.reason),!0):((f.value===void 0||f.value[1].compiledFmla===void 0)&&a.enqueueReturnCellValue(l,d),!0)});(0,Zt.isSuccess)(s)||a.onUnavailableObject(s.reason)},this.docs=new RD.PartialWorkbookDocumentCollection(r,this,n,n,(o=n.maxDereferenceCells)!==null&&o!==void 0?o:VNe,(u=n.isServerWorkbookLoad)!==null&&u!==void 0?u:!1),this.reconfigure(n)}return e.prototype.reconfigure=function(r){var n,a;this.config=r,this.rng=new $wr.JSF32(r.rngSeed!==void 0?r.rngSeed:0),this.docs.reconfigure(r,r,(n=r.maxDereferenceCells)!==null&&n!==void 0?n:VNe,(a=r.isServerWorkbookLoad)!==null&&a!==void 0?a:!1)},e.prototype.getDocs=function(){return this.docs},e.prototype.setWorksheetFuncOverrides=function(r){this.docs.setWorksheetFuncOverrides(r)},e.prototype.onNameFailure=function(r,n,a){a.computeKind!==Wn.ComputeKind.EvalFormula&&this.outputMessageLog.push({kind:Wn.OutputMessageKind.NameFailure,stateId:this.stateId,name:r,reason:n})},e.prototype.onRangeFailure=function(r,n,a,o,u){u.computeKind!==Wn.ComputeKind.EvalFormula&&this.outputMessageLog.push({kind:Wn.OutputMessageKind.RangeFailure,stateId:this.stateId,cellKind:o,range:r,reason:n})},e.prototype.onNumberFormatFailure=function(r){this.outputMessageLog.push({kind:Wn.OutputMessageKind.NumberFormatFailure,stateId:this.stateId,reason:r})},e.prototype.onInferFormatFailure=function(r,n){this.outputMessageLog.push({kind:Wn.OutputMessageKind.InferFormatFailure,stateId:this.stateId,range:r,reason:n})},e.prototype.onUnavailableObject=function(r){var n=(0,yS.unavailable)([r]);this.onUnavailable(n)},e.prototype.onUnavailable=function(r){this.outputMessageLog.push({kind:Wn.OutputMessageKind.UnhandledFailure,stateId:this.stateId,reason:r})},e.prototype.onSetCellValue=function(r,n,a,o,u){if(u.computeKind!==Wn.ComputeKind.EvalFormula){var t=this.outputCell(r,n,o,this.printFormulaProperties);t!==void 0?(this.outputMessageLog.push({kind:Wn.OutputMessageKind.RecalcStatistics,message:Wn.RecalcStatisticsMessage.ChangedCell,stateId:this.stateId,cellKind:o}),(o===Wn.ComputedCellKind.EditedCell||o===Wn.ComputedCellKind.DependentCell)&&this.outputMessageLog.push((0,AT.__assign)((0,AT.__assign)({kind:Wn.OutputMessageKind.CellWrite,stateId:this.stateId,cellKind:o,cell:r},t),{formatted:this.formatValue(o,r,n)}))):this.outputMessageLog.push({kind:Wn.OutputMessageKind.RecalcStatistics,message:Wn.RecalcStatisticsMessage.UnchangedCell,stateId:this.stateId,cellKind:o})}},e.prototype.onSetCellValues=function(r,n,a,o,u){var t=this;if(u.computeKind!==Wn.ComputeKind.EvalFormula){var d=this.outputRange(r,n,o);d!==void 0&&(o===Wn.ComputedCellKind.EditedCell||o===Wn.ComputedCellKind.DependentCell)&&this.outputMessageLog.push((0,AT.__assign)((0,AT.__assign)({kind:Wn.OutputMessageKind.RangeWrite,stateId:this.stateId,cellKind:o,range:r},d),{formatted:n.map(function(s,c){return s.map(function(l,f){return t.formatValue(o,(0,ss.sheetGridCell)(r.sheet,(0,ss.gridCell)(r.range.row+c,r.range.col+f)),l)})})}))}},e.prototype.onReturnCellValue=function(r,n,a){var o=this,u=this.outputCell(r,n,a,function(){return o.printValueProperties(r,n)});u!==void 0?(this.outputMessageLog.push({kind:Wn.OutputMessageKind.RecalcStatistics,message:Wn.RecalcStatisticsMessage.ChangedCell,stateId:this.stateId,cellKind:Wn.ComputedCellKind.EditedCell}),a===Wn.ComputedCellKind.EditedCell&&this.outputMessageLog.push((0,AT.__assign)((0,AT.__assign)({kind:Wn.OutputMessageKind.CellWrite,stateId:this.stateId,cellKind:Wn.ComputedCellKind.EditedCell,cell:r},u),{formatted:this.formatValue(a,r,n)}))):this.outputMessageLog.push({kind:Wn.OutputMessageKind.RecalcStatistics,message:Wn.RecalcStatisticsMessage.UnchangedCell,stateId:this.stateId,cellKind:Wn.ComputedCellKind.EditedCell})},e.prototype.createSnapshot=function(r,n){var a=this;return n===void 0&&(n=_D.CloningTarget.Client),new Promise(function(o){a.scheduler.addTask(dt.CompleteDataQuery,ho.QueuePos.Back,{onRun:function(){var t=!1,d=a.docs.clone(RD.voidCallback,n);(a.latestSnapshot===void 0||a.latestSnapshotID===-1||!a.latestSnapshot.compareVersion(d))&&(t=!0,a.latestSnapshot=d,a.latestSnapshotID=r),tDr.x10Logger.log({kind:"snapshotCreation",payload:t}),o({snapshot:a.latestSnapshot,correspondingId:a.latestSnapshotID})},onDeleted:function(){o(void 0)}})})},e.prototype.createSnapshotSync=function(r){return r===void 0&&(r=_D.CloningTarget.Client),this.docs.clone(RD.voidCallback,r)},e.prototype.outputCell=function(r,n,a,o){var u;if(a===Wn.ComputedCellKind.EditedCell||a===Wn.ComputedCellKind.DependentCell){var t=this.docs.testAndSetClientValue(r,n);u=(0,Zt.isSuccess)(t)?t.value?n:void 0:void this.onUnavailableObject(t.reason)}var d=this.outputFormat(r,a),s=this.outputFormulaProperties(r,a,o);return u!==void 0||d!==void 0||s!==void 0?{value:n,format:d,formulaBarText:s==null?void 0:s.formulaBarText,hasHyperlink:s==null?void 0:s.hasHyperlink}:void 0},e.prototype.outputRange=function(r,n,a){var o=this;if(a===Wn.ComputedCellKind.EditedCell||a===Wn.ComputedCellKind.DependentCell){var u=this.docs.setClientValue(r,n);(0,Zt.isSuccess)(u)||this.onUnavailableObject(u.reason)}var t=n.map(function(s,c){return s.map(function(l,f){return o.outputFormat((0,ss.sheetGridCell)(r.sheet,(0,ss.gridCell)(r.range.row+c,r.range.col+f)),a)})}),d=this.outputFormulaProperties(r,a,this.printFormulaProperties);return{values:n,formats:t,formulaBarText:d==null?void 0:d.formulaBarText}},e.prototype.outputFormat=function(r,n){if(n===Wn.ComputedCellKind.EditedCell){var a=this.docs.getEditedFormat(r);if(!(0,Zt.isSuccess)(a))return void this.onUnavailableObject(a.reason);var o=this.docs.testAndSetClientFormat(r,a.value);if(!(0,Zt.isSuccess)(o))return void this.onUnavailableObject(o.reason);if(o.value){var u=a.value;if(u===Wn.SpecialFormat.Unavailable)return{format:(0,yS.unavailable)([{kind:Wn.UnavailableKind.CellFormat}]),valueType:TE.FormatValueType.Custom,decimals:0};var t=this.docs.resolveCellFormat(r.sheet.document,u);if((0,Zt.isSuccess)(t))return{format:typeof u=="number"?u:u.formatString,valueType:t.value.valueType,decimals:t.value.decimals}}}},e.prototype.outputFormulaProperties=function(r,n,a){var o;if(n===Wn.ComputedCellKind.EditedCell){var u=a(r);if(u!==void 0){var t=u.formulaBarText,d=u.hasHyperlink,s=u.isFormula,c=this.docs.testAndSetClientFormula(r,t,d);if(!(0,Zt.isSuccess)(c))return void this.onUnavailableObject(c.reason);var l=(o=c.value,o.hasFmlaChanged),f=o.hasHyperlinkChanged;return l||f?{formulaBarText:l?t:void 0,hasHyperlink:f?d:void 0,isFormula:s}:void 0}}},e.prototype.formatValue=function(r,n,a,o){var u=o??this.docs,t=u.formatValueCell(n,a);if(!(0,Zt.isSuccess)(t)){u===this.docs&&this.outputMessageLog.push({kind:Wn.OutputMessageKind.FormatValueFailure,stateId:this.stateId,cellKind:r,range:n,reason:t.reason});return}return t.value},e.prototype.getAvailableFormula=function(r){var n,a=this.docs.getEditedFormula(r);if(!(0,Zt.isSuccess)(a))return a;if(a.value===void 0)return(0,Zt.failure)({kind:Wn.UnavailableKind.CellMissingFormula});var o=(n=a.value,n[0]),u=n[1];if(u.compiledFmla===void 0)return(0,Zt.failure)({kind:Wn.UnavailableKind.CellEvaluatingValue});var t=(0,ss.lexicalSourceGrid)(u.lexicalKind,(0,ss.sheetGridRange)(r.sheet,o));return(0,Zt.success)([t,u])},e.prototype.formulaHasHyperlink=function(r){if(r.lexicalKind!==ss.LexicalKind.Cell)return!1;var n=r==null?void 0:r.compiledFmla.getValue();if((0,Zt.isSuccess)(n))return(0,Mne.reduceBottomUp)(cDr,n.value)},e.prototype.handleSetCellContents=function(r,n,a,o,u,t,d,s,c,l,f){var p,m,v,h=c!==void 0?(0,yS.unavailable)([{kind:Wn.UnavailableKind.ClientFailure,reason:c}]):void 0,S=d,y;o!==void 0?(m=o,(0,RE.assertTrue)("calc.calc.PartialWorkbook.handleSetCellContents: formula edit",u!==void 0),v=u):a===void 0?((0,RE.assertTrue)("calc.calc.PartialWorkbook.handleSetCellContents: format edit",!r&&u===void 0&&d!==void 0&&h===void 0),m=!1,v=void 0):((0,RE.assertTrue)("calc.calc.PartialWorkbook.handleSetCellContents: inferred edit",!r&&h===void 0&&S===Wn.SpecialFormat.Weak),p=this.parseInferredEdit(n,a,t,h,S,f),m=p.isFormula,v=p.oper,h=p.cellFailure,S=p.cellFormat,y=p.inferredFormat);var C=f!==void 0?f.cloneLazy.getValue():this.docs,E=C.setCellContents(r,n,a,m,t,v,h,S,s,l);if(E.kind===Zt.ResultKind.Failure)return this.onUnavailableObject(E.reason);if(C.onCellModified(r),!r){var I=(0,ss.sheetGridCell)(n.sheet,t),F=a===void 0?(0,Zt.success)(void 0):m?C.inferFormulaFormat(I):y!==void 0&&y!==eDr.KnownFormat.General?C.resolveValueFormat(n.sheet.document,y):(0,Zt.success)(void 0);F.kind!==Zt.ResultKind.Success&&(this.onInferFormatFailure(I,F.reason),F=(0,Zt.success)(Wn.SpecialFormat.Unavailable)),F.value!==void 0&&C.fillInferredFormat(n,F.value),f!==void 0?(f.stateId=this.stateId,this.enqueueEvalFormulaComputeCellValuesOnDocs(n,C,f)):this.enqueueBeforeCompute(l)}},e.prototype.parseInferredEdit=function(r,n,a,o,u,t){var d=t?t.cloneLazy.getValue().parseInferredEdit((0,ss.sheetGridCell)(r.sheet,a),n,this.getVolatileMode()):this.docs.parseInferredEdit((0,ss.sheetGridCell)(r.sheet,a),n,this.getVolatileMode());if(!(0,Zt.isSuccess)(d))return{isFormula:!1,oper:t8.blankOper,cellFailure:d.reason,cellFormat:Wn.SpecialFormat.Unavailable};var s=n.length>0?n.charAt(0):"";switch((s==="="||s==="+"||s==="-")&&(d.value.kind===TE.EditKind.Formula||d.value.kind===TE.EditKind.Number)&&RE.ulsLogger.ULS.dnmTraceTag(541189698,KNe.LogCategory.msoulscat_ES_EWAJS,KNe.TraceLevel.Info,JSON.stringify({startChar:s,editKind:String(d.value.kind)})),d.value.kind){case TE.EditKind.Formula:return{isFormula:!0,oper:t8.blankOper,cellFailure:o,cellFormat:u};case TE.EditKind.String:case TE.EditKind.Other:return{isFormula:!1,oper:d.value.value,cellFailure:o,cellFormat:u};case TE.EditKind.Number:return{isFormula:!1,oper:d.value.value,cellFailure:o,cellFormat:u,inferredFormat:d.value.format}}},e.prototype.handleSetRangeFormula=function(r,n,a,o,u){var t=(0,Zwr.isFormulaText)(a);(0,RE.assertTrue)("calc.calc.PartialWorkbook: handleSetRangeFormula",a===""&&!r||t);var d=r?void 0:t8.blankOper,s=r?void 0:Wn.SpecialFormat.Weak,c=r?void 0:Wn.SpecialStyle.Weak,l=this.docs.setRangeFormula(r,n,a,o,d,s,c,u);if(l.kind===Zt.ResultKind.Failure)return this.onUnavailableObject(l.reason);this.docs.onCellModified(r),r||this.enqueueBeforeCompute(u)},e.prototype.handleEditPaste=function(r,n,a,o){var u=(0,ss.sheetGridRange)(n.sheet,(0,ss.gridRange)(n.range.row,n.range.col,a.range.rows,a.range.cols)),t=!1,d=this.docs.copyRange(a);if(d.kind===Zt.ResultKind.Failure)return this.onUnavailableObject(d.reason);var s=this.docs.pasteRange(u,d.value);if(s.kind===Zt.ResultKind.Failure)return this.onUnavailableObject(s.reason);this.docs.onCellModified(t),this.enqueueBeforeCompute(o)},e.prototype.handleAssumeRecalcFinal=function(r){var n=this;this.scheduler.getCount(dt.BeforeCompute)<0||this.scheduler.addTask(dt.ComputeCellValue,ho.QueuePos.Front,function(){var a=n.docs.assumeRecalcFinal(r);if(a.kind===Zt.ResultKind.Failure)return n.onUnavailableObject(a.reason)})},e.prototype.evalFormula=function(r,n,a,o,u){var t=this;return new Promise(function(d){var s=function(){return d({value:(0,Zt.failure)(bE.stopped)})};t.scheduler.deleteTasks(dt.EvalFormula,void 0),t.scheduler.addTask(dt.EvalFormula,ho.QueuePos.Back,{onRun:function(){if(!u&&!t.trySetStateId(dt.EvalFormula,r))return s();t.enqueueComputeEvalFormula(n,a,o,u,d)},onDeleted:s}),t.enqueueRecalcFinished()})},e.prototype.enqueueBeforeCompute=function(r){var n=this;this.scheduler.deleteTasks(dt.BeforeCompute,void 0),this.scheduler.addTask(dt.BeforeCompute,ho.QueuePos.Back,function(){n.enqueueAfterCompute(),n.restrictToViewport(n.docs.getNonDirtyEditedCells(),r,Wn.ComputeKind.EditedCell,n.scheduleAvailableValues),n.restrictToViewport(n.docs.getDirtyEditedCells(),r,Wn.ComputeKind.EditedCell,n.scheduleAvailableFormulas),n.restrictToViewport(n.docs.getDirtyDependentCells(),r,Wn.ComputeKind.DependentCell,n.scheduleAvailableFormulas)})},e.prototype.withEvalTiming=function(r){var n=this.docs.schedulerConfig.totalTimeMs;if(n===void 0)return r();var a=(0,Ak.now)(),o;try{o=r()}finally{this.stateEvalTime+=(0,Ak.fastMax)(iDr,(0,Ak.now)()-a),this.stateEvalTime>=n&&(this.deleteComputeTasks(my.EvalTimedOut),this.outputMessageLog.push({kind:Wn.OutputMessageKind.RecalcStatistics,stateId:this.stateId,message:Wn.RecalcStatisticsMessage.StateTimedOut}),o=[])}return o},e.prototype.enqueueEvalFormulaComputeCellValuesOnDocs=function(r,n,a){var o=this,u=[];(0,a8.forEachCellInSet)(r.set,function(l){return u.push((0,ss.sheetGridCell)(r.sheet,l)),!0});var t=(0,aDr.makeGridRangeTable)(),d=function(f,p,m){!(0,yS.isSheetIndexEqual)(f.sheet,r.sheet)||!(0,GNe.meetsProduct)(r.set,(0,a8.createCellSetFromRange)(f.range))||(0,yS.forEachCellInRange)(f.range,function(v){return t=t.setValue(v,p),!0})},s=function(){return n.evaluate(Wn.ComputeKind.EvalFormula,u,o.getVolatileMode(),d)},c={onRun:function(){var f=o.withEvalTiming(s);if(Array.isArray(f)){var p=f.map(function(m,v){var h,S=u[v].range;if(!(0,Zt.isSuccess)(m)){if(m.reason.kind===bE.ReasonKind.Stopped)return u8(S,m.reason);var y=(0,yS.unavailable)([{kind:Wn.UnavailableKind.EvalFailure,reason:m.reason}]);return o.onUnavailable(y),u8(S,y)}var C=n.getCellValue(u[v]);if(!(0,Zt.isSuccess)(C)){var E=(h=t.getValue(S))!==null&&h!==void 0?h:C.reason;return u8(S,E)}try{(0,RE.assertTrue)("calc.calc.PartialWorkbook: FinalValue after evalCell",C.value.kind===bE.CellKind.FinalValue)}catch(w){var y=(0,yS.unavailable)([{kind:Wn.UnavailableKind.EvalFailure,reason:(0,Zt.javaScriptError)(w)}]);return o.onUnavailable(y),u8(S,y)}var I=C.value.oper;if(a.formatResults===!0){var F=o.formatValue(Wn.ComputedCellKind.EditedCell,u[v],I,n);return(0,Zt.success)({cell:S,value:I,formatted:F})}return a.formatResults===!1?(0,Zt.success)({cell:S,value:I,formatted:void 0}):(0,Zt.success)((0,Ak.pair)(u[v].range,I))});a.resultsPromise.resolve({stateId:a.stateId,results:p});return}s=f.resume,o.scheduler.addTask(dt.ComputeEvalOnClone,ho.QueuePos.Front,c)},onDeleted:function(){return a.resultsPromise.resolve({stateId:a.stateId,results:(0,nDr.arrayFill)(new Array(u.length),(0,Zt.failure)(bE.stopped))})}};this.scheduler.addTask(dt.ComputeEvalOnClone,ho.QueuePos.Front,c)},e.prototype.enqueueComputeCellValue=function(r,n){var a=this,o=n===Wn.ComputeKind.EditedCell&&this.shouldSample(this.config.sampleRecalcEditedStopwatchRate)?(0,Ine.ulsStopwatchFactory)("calc.calc.PartialWorkbook: recalc edited"):void 0,u=!0,t,d=function(){return a.docs.evaluate(n,[r],a.getVolatileMode())},s=function c(){if(u){u=!1,t=a.shouldSample(a.config.sampleCellEvalStopwatchRate)?(0,Ine.ulsStopwatchFactory)("calc.calc.PartialWorkbook: cell eval"):void 0;var l=a.docs.getEditedFormula(r);if(!(0,Zt.isSuccess)(l))return a.onUnavailableObject(l.reason);if(l.value===void 0)return}else a.outputMessageLog.push({kind:Wn.OutputMessageKind.RecalcStatistics,stateId:a.stateId,message:Wn.RecalcStatisticsMessage.ContinueComputation});var f=a.withEvalTiming(d);if(Array.isArray(f)){t==null||t.stop(),o==null||o.stop();for(var p=0,m=f;p<m.length;p++){var v=m[p];!(0,Zt.isSuccess)(v)&&v.reason.kind!==bE.ReasonKind.Stopped&&a.onUnavailableObject({kind:Wn.UnavailableKind.EvalFailure,reason:v.reason})}return}d=f.resume,a.scheduler.addTask(dt.ComputeCellValue,ho.QueuePos.Front,c)};this.scheduler.addTask(dt.ComputeCellValue,ho.QueuePos.Back,s)},e.prototype.enqueueComputeEvalFormula=function(r,n,a,o,u){var t=this;o===void 0&&(o=this.docs);var d=this.getVolatileMode(),s=function(){return o.evalFormula(r,n,a,d)},c={onRun:function(){var f=s();if(f.kind!==Zt.ResultKind.Paused&&f.kind!==Zt.ResultKind.Breaked){u(f.value);return}s=f.resume,t.scheduler.addTask(dt.ComputeEvalFormula,ho.QueuePos.Front,c)},onDeleted:function(){return u({value:(0,Zt.failure)(bE.stopped)})}};this.scheduler.addTask(dt.ComputeEvalFormula,ho.QueuePos.Back,c)},e.prototype.enqueueReturnCellValue=function(r,n){var a=this,o=this.getVolatileMode();this.scheduler.addTask(dt.ComputeCellValue,ho.QueuePos.Back,function(){a.docs.evalValue(r,n,o)})},e.prototype.enqueueAfterCompute=function(){var r=this;this.scheduler.deleteTasks(dt.AfterCompute,my.EditReceived);var n=this.shouldSample(this.config.sampleRecalcViewportStopwatchRate)?(0,Ine.ulsStopwatchFactory)("calc.calc.PartialWorkbook: recalc viewport"):void 0;this.scheduler.addTask(dt.AfterCompute,ho.QueuePos.Back,{onRun:function(){n==null||n.stop(my.EvalFinished),r.outputMessageLog.push({kind:Wn.OutputMessageKind.RecalcStatistics,message:Wn.RecalcStatisticsMessage.EditFinished,stateId:r.stateId})},onDeleted:function(o){n==null||n.stop(o)}})},e.prototype.enqueueRecalcFinished=function(){var r=this;this.scheduler.deleteTasks(dt.RecalcFinished,void 0),this.scheduler.addTask(dt.RecalcFinished,ho.QueuePos.Back,function(){r.outputMessageLog.push({kind:Wn.OutputMessageKind.RecalcStatistics,message:Wn.RecalcStatisticsMessage.RecalcFinished,stateId:r.stateId})})},e.prototype.promoteCellContents=function(r,n,a,o){var u=this;this.scheduler.addTask(dt.ServerUpdate,ho.QueuePos.Back,function(){if(u.trySetStateId(dt.ServerUpdate,r)){var t=u.docs.promoteServerAvailability(a,o);if(t.kind===Zt.ResultKind.Failure)return u.onUnavailableObject(t.reason);u.docs.onCellModified(!0),t.value||u.outputMessageLog.push({kind:Wn.OutputMessageKind.UpdateRequest,stateId:u.stateId,range:n})}})},e.prototype.writeCellContents=function(r,n,a,o,u,t,d,s,c,l){var f=this;this.scheduler.addTask(dt.ServerUpdate,ho.QueuePos.Back,function(){!l&&!f.trySetStateId(dt.ServerUpdate,r)||f.handleSetCellContents(!0,n,a,o,t,u,d,s,c,void 0,l)})},e.prototype.editCellContents=function(r,n,a,o,u,t,d,s){var c=this;t===void 0&&(t=t8.blankOper),d===void 0&&(d=(0,ss.sheetGridRange)(n.sheet,o8)),this.lastViewport=d,this.scheduler.addTask(dt.ClientEdit,ho.QueuePos.Back,function(){c.trySetStateId(dt.ClientEdit,r)&&c.handleSetCellContents(!1,n,a,o,t,u,Wn.SpecialFormat.Weak,Wn.SpecialStyle.Weak,void 0,d,s)}),this.enqueueRecalcFinished()},e.prototype.editCellContentsOnClone=function(r,n,a,o,u){this.editCellContents(this.stateId,r,n,a,o,void 0,void 0,u)},e.prototype.editCellFormats=function(r,n,a,o,u){var t=this;u===void 0&&(u=(0,ss.sheetGridRange)(n.sheet,o8)),this.lastViewport=u,this.scheduler.addTask(dt.ClientEdit,ho.QueuePos.Back,function(){if(t.trySetStateId(dt.ClientEdit,r)){var d=a.kind==="SetFormat"?t.docs.resolveEditFormat(n.sheet.document,a.format):a.kind==="RibbonFormat"?t.docs.resolveRibbonFormat(n.sheet.document,a.ribbon,(0,ss.sheetGridCell)(n.sheet,o)):a.kind==="ChangeDecimals"?t.docs.resolveChangeDecimals(n.sheet.document,a.changeDecimals,(0,ss.sheetGridCell)(n.sheet,o)):(0,RE.assertNever)("calc.calc.PartialWorkbook: editCellFormats",a);(0,Zt.isSuccess)(d)||(0,a8.forEachRangeInSet)(n.set,function(s){return t.onInferFormatFailure((0,ss.sheetGridRange)(n.sheet,s),d.reason),!0}),!((0,Zt.isSuccess)(d)&&d.value===void 0)&&t.handleSetCellContents(!1,n,void 0,void 0,void 0,(0,ss.gridCell)(0,0),(0,Zt.isSuccess)(d)?d.value:Wn.SpecialFormat.Unavailable,void 0,void 0,u)}}),this.enqueueRecalcFinished()},e.prototype.writeArrayFormula=function(r,n,a,o,u){var t=this;o===void 0&&(o=(0,yS.gridRangeAnchor)(n.range)),u===void 0&&(u=!1),this.scheduler.addTask(dt.ServerUpdate,ho.QueuePos.Back,function(){t.trySetStateId(dt.ServerUpdate,r)&&t.handleSetRangeFormula(!0,n,a,o,void 0)})},e.prototype.editArrayFormula=function(r,n,a,o,u){var t=this;o===void 0&&(o=(0,yS.gridRangeAnchor)(n.range)),u===void 0&&(u=(0,ss.sheetGridRange)(n.sheet,o8)),this.lastViewport=u,this.scheduler.addTask(dt.ClientEdit,ho.QueuePos.Back,function(){t.trySetStateId(dt.ClientEdit,r)&&t.handleSetRangeFormula(!1,n,a,o,u)}),this.enqueueRecalcFinished()},e.prototype.editPaste=function(r,n,a,o,u){var t=this;u===void 0&&(u=(0,ss.sheetGridRange)(a.sheet,o8)),this.scheduler.addTask(dt.ClientEdit,ho.QueuePos.Back,function(){t.trySetStateId(dt.ClientEdit,r)&&t.handleEditPaste(n,a,o,u)}),this.enqueueRecalcFinished()},e.prototype.assumeRecalcFinal=function(r,n){var a=this;this.scheduler.addTask(dt.ClientEdit,ho.QueuePos.Back,function(){a.stateId===r&&a.handleAssumeRecalcFinal(n)})},e.prototype.testAdvanceState=function(r){var n=this;this.scheduler.addTask(dt.TestAdvanceState,ho.QueuePos.Back,function(){n.trySetStateId(dt.TestAdvanceState,r)})},e.prototype.step=function(){if(!this.scheduler.runTask())return{queueEmpty:!0,messages:[]};var r=this.outputMessageLog;return this.outputMessageLog=[],{queueEmpty:!1,messages:r}},e.prototype.trySetStateId=function(r,n){var a=this,o,u,t,d,s;if(n<this.stateId)return!1;if(r===dt.ClientEdit&&(this.deleteComputeTasks(my.EditReceived),this.stateEvalTime=0),n>this.stateId){if(this.stateId!==-(1/0)){var c=this.config.sampleWorkbookStatisticsRate;c!==void 0&&this.shouldSample(c)&&this.outputMessageLog.push({kind:Wn.OutputMessageKind.WorkbookStatistics,stateId:this.stateId,stats:this.getStatistics(),p:c})}var l=1;this.stateChanges===l&&this.enqueueRunExperiments(i8.ExperimentKind.OneShot),this.stateChanges>=l&&this.scheduler.getCount(dt.RunExperiment)===0&&this.enqueueRunExperiments(i8.ExperimentKind.Recurring);var f=(o=this.config.samplePrecisionEvalRate)!==null&&o!==void 0?o:0,p=(u=this.config.samplePrecisionPrintFormulaRate)!==null&&u!==void 0?u:0,m=(t=this.config.samplePrecisionPrintValueRate)!==null&&t!==void 0?t:0;if(this.stateChanges>=l&&(f>0||p>0||m>0)&&this.numPrecisionFailures<e.maxPrecisionFailures&&this.scheduler.getCount(dt.RunExperiment)===0){var v=this.config.experimentFactories,h=(d=v==null?void 0:v.stepBudget)!==null&&d!==void 0?d:sDr,S=(s=v==null?void 0:v.totalBudget)!==null&&s!==void 0?s:lDr,y=new rDr.PrecisionExperiment({samplePrecisionEvalRate:f,samplePrecisionPrintFormulaRate:p,samplePrecisionPrintValueRate:m},function(I){a.outputMessageLog.push({kind:Wn.OutputMessageKind.Alert,message:I})}),C={stateId:this.stateId,documents:this.docs.clone(y),stepBudget:h,totalBudget:S,viewport:this.lastViewport};y.setContext(C),this.enqueueRunExperiment("PrecisionExperiment",h,S,i8.ExperimentKind.Precision,y,function(){return a.numPrecisionFailures=0},function(){return a.numPrecisionFailures+=1})}this.deleteComputeTasks(my.StateIdAdvanced),this.lastViewport=void 0;var E=this.stateId;this.stateId=n,this.docs.advanceState(E),this.outputMessageLog.push({kind:Wn.OutputMessageKind.StateAdvanced,stateId:this.stateId}),this.stateEvalTime=0,this.stateChangesSinceLastGC+=1,this.stateChanges+=1,this.enqueueMaybeCollectGarbage()}return!0},e.prototype.deleteComputeTasks=function(r){this.scheduler.deleteTasks(dt.BeforeCompute,void 0),this.scheduler.deleteTasks(dt.ComputeCellValue,void 0),this.scheduler.deleteTasks(dt.AfterCompute,r),r!==my.EvalTimedOut&&this.scheduler.deleteTasks(dt.ComputeEvalFormula,void 0)},e.prototype.enqueueRunExperiment=function(r,n,a,o,u,t,d){var s=this,c=0,l=0,f=function(v,h,S,y){var C=u.failedLogMessage;C!==void 0&&s.outputMessageLog.push({experimentName:r,kind:Wn.OutputMessageKind.ExperimentRunResult,experimentKind:o,logMessage:C,timeoutReason:{budgetType:v,budget:h,elapsedTime:S,stepsCount:y}})},p=function m(){if(u.done){var v=u.resultLogMessage;v!==void 0&&s.outputMessageLog.push({experimentName:r,kind:Wn.OutputMessageKind.ExperimentRunResult,experimentKind:o,logMessage:v}),t();return}for(var h=(0,Ak.now)(),S=h,y=0;y<oDr&&S===h;y+=1){u.step(),l+=1;var C=(0,Ak.now)(),E=C-S;if(E>=n&&!u.done){f("stepBudget",n,E,l),d();return}S=C}if(c+=S>h?S-h:uDr,c>=a&&!u.done){f("totalBudget",a,c,l),d();return}s.scheduler.addTask(dt.RunExperiment,ho.QueuePos.Front,m)};this.scheduler.addTask(dt.RunExperiment,ho.QueuePos.Back,p)},e.prototype.enqueueRunExperiments=function(r){var n,a;if(this.config.experimentFactories){var o=(n=this.config.experimentFactories,n.stepBudget),u=n.totalBudget,t=n.factories,d=t.filter(function(v){var h,S;return v.kind===r&&((h=v.numFailures)!==null&&h!==void 0?h:0)<((S=v.maxFailures)!==null&&S!==void 0?S:3)});if(d.length!==0)for(var s={stateId:this.stateId,documents:this.docs.clone(RD.voidCallback,r===i8.ExperimentKind.OneShot?_D.CloningTarget.Server:_D.CloningTarget.Client),stepBudget:o,totalBudget:u,viewport:this.lastViewport},c=function(h){var S=h.create();if(!S)return"continue";S.setContext(s),l.enqueueRunExperiment(h.experimentName,(a=h.stepBudget)!==null&&a!==void 0?a:o,u,r,S,function(){return h.numFailures=0},function(){var y;return h.numFailures=((y=h.numFailures)!==null&&y!==void 0?y:0)+1})},l=this,f=0,p=d;f<p.length;f++){var m=p[f];c(m)}}},e.prototype.setSheetNames=function(r,n,a){var o=this;this.scheduler.addTask(dt.ServerUpdate,ho.QueuePos.Back,function(){if(o.trySetStateId(dt.ServerUpdate,a)){var u=o.docs.setSheetNames(r,n);u.kind===Zt.ResultKind.Failure&&o.onUnavailableObject(u.reason),o.deleteComputeTasks(my.SetSheetNames)}})},e.prototype.setLangConfig=function(r,n){var a=this;this.scheduler.addTask(dt.ServerUpdate,ho.QueuePos.Back,function(){if(a.trySetStateId(dt.ServerUpdate,r)){var o=a.docs.config.localeInfo!==n.localeInfo,u=a.docs.config.refStyle!==n.refStyle;a.docs.setConfig(n),o&&a.docs.clearCompiledNumberFormats(),(o||u)&&(a.docs.clearCompiledFormulas(),a.deleteComputeTasks(my.SetLangConfig))}})},e.prototype.setNumberFormats=function(r,n,a,o){var u=this;this.scheduler.addTask(dt.ServerUpdate,ho.QueuePos.Back,function(){if(u.trySetStateId(dt.ServerUpdate,o)){var t=u.docs.setNumberFormats(r,n,a);if(t.kind===Zt.ResultKind.Failure)return u.onUnavailable(t.reason)}})},e.prototype.writeNamedObject=function(r,n,a,o){var u=this;this.scheduler.addTask(dt.ServerUpdate,ho.QueuePos.Back,function(){if(u.trySetStateId(dt.ServerUpdate,r)){var t=u.docs.setNamedObject(!0,(0,ss.nameLoc)(n,a),o);if(t.kind===Zt.ResultKind.Failure)return u.onUnavailable(t.reason)}})},e.prototype.writeUndefinedNames=function(r,n){var a=this;this.scheduler.addTask(dt.ServerUpdate,ho.QueuePos.Back,function(){if(a.trySetStateId(dt.ServerUpdate,r)){var o=a.docs.setUndefinedNames(n);if(o.kind===Zt.ResultKind.Failure)return a.onUnavailable(o.reason)}})},e.prototype.promoteNamedObjects=function(r,n,a){var o=this;this.scheduler.addTask(dt.ServerUpdate,ho.QueuePos.Back,function(){if(o.trySetStateId(dt.ServerUpdate,r)){var u=o.docs.promoteNamedObjects(n,a);if(u.kind===Zt.ResultKind.Failure)return o.onUnavailable(u.reason);u.value||o.outputMessageLog.push({kind:Wn.OutputMessageKind.UpdateNamesRequest,stateId:o.stateId,scope:n})}})},e.prototype.extendUnusedRange=function(r,n){var a=this;this.scheduler.addTask(dt.ServerUpdate,ho.QueuePos.Back,function(){if(a.trySetStateId(dt.ServerUpdate,n)){var o=a.docs.extendServerUnused(r.sheet,r.range);if(o.kind===Zt.ResultKind.Failure)return a.onUnavailableObject(o.reason);a.docs.onCellModified(!0)}})},e.prototype.writeHiddenRows=function(r,n){var a=this;this.scheduler.addTask(dt.ServerUpdate,ho.QueuePos.Back,function(){if(a.trySetStateId(dt.ServerUpdate,r)){var o=a.docs.writeHiddenRows(n.sheet,n.range,n.hidden);if(o.kind===Zt.ResultKind.Failure)return a.onUnavailableObject(o.reason)}})},e.prototype.writeHiddenCols=function(r,n){var a=this;this.scheduler.addTask(dt.ServerUpdate,ho.QueuePos.Back,function(){if(a.trySetStateId(dt.ServerUpdate,r)){var o=a.docs.writeHiddenCols(n.sheet,n.range,n.hidden);if(o.kind===Zt.ResultKind.Failure)return a.onUnavailableObject(o.reason)}})},e.prototype.writeInFilterMode=function(r,n){var a=this;this.scheduler.addTask(dt.ServerUpdate,ho.QueuePos.Back,function(){if(a.trySetStateId(dt.ServerUpdate,r)){var o=a.docs.writeInFilterMode(n.sheet,n.inFilterMode);if(o.kind===Zt.ResultKind.Failure)return a.onUnavailableObject(o.reason)}})},e.prototype.getStatistics=function(){return{queueSize:this.scheduler.getCount(),totalGridStatistics:this.docs.getGridStatistics(),totalNameStatistics:this.docs.getNameStatistics()}},e.prototype.enqueueMaybeCollectGarbage=function(){var r=this;this.scheduler.deleteTasks(dt.MaybeCollectGarbage,void 0),this.scheduler.addTask(dt.MaybeCollectGarbage,ho.QueuePos.Back,function(){if(!(r.stateChangesSinceLastGC<wne)){var n=r.stateId-wne;r.docs.collectGarbage(n),r.outputMessageLog.push({kind:Wn.OutputMessageKind.GarbageCollected,minStateIdKept:n}),r.stateChangesSinceLastGC=0}})},e.prototype.shouldSample=function(r){return r!==void 0&&this.rng.next()<=r},e.prototype.restrictToViewport=function(r,n,a,o){if(n!==void 0)for(var u=n.sheet,t=n.range,d=(0,a8.createCellSetFromRange)(t),s=0,c=r;s<c.length;s++){var l=c[s];(0,yS.isSheetIndexEqual)(u,l.sheet)&&o((0,Wn.sheetCellSet)(u,(0,GNe.intersectProduct)(l.set,d)),a)}else for(var f=0,p=r;f<p.length;f++){var l=p[f];o(l,a)}},e.prototype.getVolatileMode=function(){var r;return(r=this.config.volatileMode)!==null&&r!==void 0?r:Dne.VolatileMode.Estimation},e.maxPrecisionFailures=3,e}();gy.PartialWorkbook=pDr});var Bne=Y(OT=>{_();Object.defineProperty(OT,"__esModule",{value:!0});OT.delayPromiseImpl=OT.asyncLoopFactory=OT.asyncLoop=void 0;var Lne=Cn(),mDr=Lne.asyncLoopModule.asyncLoop;OT.asyncLoop=mDr;var gDr=Lne.asyncLoopModule.asyncLoopFactory;OT.asyncLoopFactory=gDr;var vDr=Lne.asyncLoopModule.delayPromiseImpl;OT.delayPromiseImpl=vDr});var Ok=Y(o0=>{_();Object.defineProperty(o0,"__esModule",{value:!0});o0.promiseLoop=o0.promiseFinally=o0.newPromise=o0.isThenable=o0.collapseThenable=o0.bindMaybeThenable=o0.MaybeThenable=void 0;var PE=Cn(),hDr=PE.promise.MaybeThenable;o0.MaybeThenable=hDr;var SDr=PE.promise.bindMaybeThenable;o0.bindMaybeThenable=SDr;var yDr=PE.promise.collapseThenable;o0.collapseThenable=yDr;var CDr=PE.promise.isThenable;o0.isThenable=CDr;var _Dr=PE.promise.newPromise;o0.newPromise=_Dr;var RDr=PE.promise.promiseFinally;o0.promiseFinally=RDr;var TDr=PE.promise.promiseLoop;o0.promiseLoop=TDr});var HNe=Y(Gne=>{_();Object.defineProperty(Gne,"__esModule",{value:!0});Gne.computeUnavailableCellsStats=PDr;var bDr=vd(),qne=e0(),jNe=zu(),s8=x0(),Une=ft(),p_=ey();function PDr(e){for(var r,n,a,o,u,t,d,s=(0,Une.makeStringMap)(),c=(0,Une.makeStringMap)(),l=0,f=e;l<f.length;l++){var p=f[l],m=p.range;if(p.reason.kind===jNe.LangReasonKind.Unavailable)for(var v=0,h=p.reason.objects;v<h.length;v++){var S=h[v];S.kind===bDr.UnavailableKind.GridRange&&((0,jNe.isSheetIndexEqual)(S.range.sheet,m.sheet)?s[S.range.sheet.index]=(0,s8.unionProduct)((r=s[S.range.sheet.index])!==null&&r!==void 0?r:p_.empty,S.unavailableCells!==!0?S.unavailableCells:p_.empty):c[S.range.sheet.index]=(0,s8.unionProduct)((n=c[S.range.sheet.index])!==null&&n!==void 0?n:p_.empty,S.unavailableCells!==!0?S.unavailableCells:p_.empty))}}var y=0,C=0,E=0,I=(0,Une.makeStringMap)();for(var F in s){var w=(a=s[F])!==null&&a!==void 0?a:p_.empty;I[F]=(0,s8.unionProduct)((o=I[F])!==null&&o!==void 0?o:p_.empty,w),(0,qne.forEachRangeInSet)(w,function(k){return y+=k.rows*k.cols,!0})}for(var F in c){var w=(u=c[F])!==null&&u!==void 0?u:p_.empty;I[F]=(0,s8.unionProduct)((t=I[F])!==null&&t!==void 0?t:p_.empty,w),(0,qne.forEachRangeInSet)(w,function(G){return C+=G.rows*G.cols,!0})}for(var F in I){var w=(d=I[F])!==null&&d!==void 0?d:p_.empty;(0,qne.forEachRangeInSet)(w,function(G){return E+=G.rows*G.cols,!0})}var B={numOfUnavailableCellsInTheSameSheet:y,numOfUnavailableCellsInDifferentSheet:C,totalNumOfUnavailableCells:E};return B}});var QNe=Y(Kne=>{_();Object.defineProperty(Kne,"__esModule",{value:!0});Object.defineProperty(Kne,"mixin",{enumerable:!0,get:function(){return EDr.mixin}});var EDr=Cn()});var Vne=Y(c8=>{_();Object.defineProperty(c8,"__esModule",{value:!0});c8.getMissingJSFeatures=YNe;c8.logMissingJSFeatures=ODr;var zNe=Ai(),l8=tu(),NDr=ig(),ADr=[{name:"self",test:function(){return typeof self!="undefined"}},{name:"fetch",test:function(){return typeof fetch=="function"}},{name:"Set",test:function(){return typeof Set=="function"}},{name:"Map",test:function(){return typeof Map=="function"}},{name:"WeakMap",test:function(){return typeof WeakMap=="function"}},{name:"Symbol",test:function(){return typeof Symbol=="function"}},{name:"WebAssembly",test:function(){return typeof WebAssembly=="object"}},{name:"Atomics",test:function(){return typeof Atomics=="object"}},{name:"BigInt",test:function(){return typeof BigInt=="function"}},{name:"String.startsWith",test:function(){return!0}},{name:"String.codePointAt",test:function(){return!0}},{name:"Object.assign",test:function(){return typeof Object.assign=="function"}},{name:"Object.setPrototypeOf",test:function(){return typeof Object.setPrototypeOf=="function"}},{name:"Number.EPSILON",test:function(){return typeof Number.EPSILON=="number"}},{name:"Number.isFinite",test:function(){return typeof Number.isFinite=="function"}},{name:"Number.parseInt",test:function(){return typeof Number.parseInt=="function"}},{name:"Math.acosh",test:function(){return typeof Math.acosh=="function"}},{name:"Math.hypot",test:function(){return typeof Math.hypot=="function"}},{name:"Math.log1p",test:function(){return typeof Math.log1p=="function"}},{name:"Math.trunc",test:function(){return typeof Math.trunc=="function"}},{name:"Promise.finally",test:function(){return typeof Promise.resolve().finally=="function"}},{name:"RegExp_flags",test:function(){return new RegExp("x","i"),!0}},{name:"RegExp.flags",test:function(){return typeof/x/.flags=="string"}},{name:"Array.of",test:function(){return typeof Array.of=="function"}},{name:"Array.entries",test:function(){return typeof[].entries=="function"}},{name:"Array.find",test:function(){return typeof[].find=="function"}},{name:"performance",test:function(){return typeof performance=="object"}},{name:"performance.now",test:function(){return typeof performance.now=="function"}},{name:"performance.timeOrigin",test:function(){return typeof performance.timeOrigin=="number"}},{name:"performance.memory",test:function(){return typeof performance.memory=="object"}}];function YNe(){return ADr.map(function(e){var r=e.name,n=e.test;try{return n()?"":r}catch(a){return r}}).filter(function(e){return e.length>0})}function ODr(e){e().then(function(r){var n={main:YNe(),worker:r},a="calc.calc.logMissingJSFeatures: missing = ".concat(JSON.stringify(n));zNe.ulsLogger.ULS.traceTag(561534152,l8.LogCategory.msoulscat_ES_EWAJS,l8.TraceLevel.Info,a)}).catch(function(r){var n="calc.calc.logMissingJSFeatures: threw ".concat((0,NDr.messageFromError)(r));zNe.ulsLogger.ULS.traceTag(561534153,l8.LogCategory.msoulscat_ES_EWAJS,l8.TraceLevel.Info,n)})}});var kk=Y(Zv=>{_();Object.defineProperty(Zv,"__esModule",{value:!0});Zv.wrapIntoResumeRecalc=Zv.emptyRangeValue=Zv.emptyRangeFormula=Zv.emptyRangeFormat=Zv.FormulaKind=void 0;var TD=fy(),kDr=TD.gridinterface.FormulaKind;Zv.FormulaKind=kDr;var FDr=TD.gridinterface.emptyRangeFormat;Zv.emptyRangeFormat=FDr;var IDr=TD.gridinterface.emptyRangeFormula;Zv.emptyRangeFormula=IDr;var MDr=TD.gridinterface.emptyRangeValue;Zv.emptyRangeValue=MDr;var wDr=TD.gridinterface.wrapIntoResumeRecalc;Zv.wrapIntoResumeRecalc=wDr});var d8=Y(Ik=>{_();Object.defineProperty(Ik,"__esModule",{value:!0});Ik.RecalcSideGrid=void 0;Ik.convertX10RangeFormulaEditsToCalcRangeFormulaEdits=$Ne;Ik.convertX10UpdatesToCalcUpdates=ZNe;var nl=br(),NE=ft(),ls=Di(),bD=gs(),km=zu(),JNe=kk(),PD=r_(),DDr=BDr(oC()),xDr=dT(),EE=sk(),jne=vd(),Fk=e0(),Wne=x0(),LDr=Qu();function XNe(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,n=new WeakMap;return(XNe=function(o){return o?n:r})(e)}function BDr(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var n=XNe(r);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(u!=="default"&&Object.prototype.hasOwnProperty.call(e,u)){var t=o?Object.getOwnPropertyDescriptor(e,u):null;t&&(t.get||t.set)?Object.defineProperty(a,u,t):a[u]=e[u]}return a.default=e,n&&n.set(e,a),a}(0,NE.staticAssertSame)();(0,NE.staticAssertSame)();(0,NE.staticAssertSame)();(0,NE.staticAssertSame)();var qDr=function(){function e(r){this.calcGrid=r,this.snapshotPromises=[]}return e.prototype.createIGridExportEndpoint=function(r){return(0,nl.__awaiter)(this,void 0,void 0,function(){var n=this;return(0,nl.__generator)(this,function(a){switch(a.label){case 0:return[4,DDr.Endpoint.createInside(r,function(){return n})];case 1:return a.sent(),[2]}})})},e.prototype.discardSnapshot=function(r){return this.snapshotPromises[r]===void 0?!1:(delete this.snapshotPromises[r],!0)},e.prototype.evalClonedModelOnSnapshot=function(r,n,a){var o;return(0,nl.__awaiter)(this,void 0,void 0,function(){var u,t,d,s,c;return(0,nl.__generator)(this,function(l){switch(l.label){case 0:return[4,this.getOrCreateSnapshot(r)];case 1:return u=((o=l.sent())!==null&&o!==void 0?o:{snapshot:void 0}).snapshot,u===void 0?[2,(0,ls.failure)((0,km.unavailable)(["evalOnClonedModel"]))]:(t=ZNe(n,u.config.mathpack),d=$Ne(a,u.config.mathpack),s=this.calcGrid.evalOnClonedModelOnSnapshot(t,d,u,void 0),this.calcGrid.resumeRecalc(),c=ls.success,[4,s]);case 2:return[2,c.apply(void 0,[l.sent()])]}})})},e.prototype.evalFormulaOnSnapshot=function(r,n,a,o){var u;return o===void 0&&(o={kind:jne.SpecialFormat.Origin}),(0,nl.__awaiter)(this,void 0,void 0,function(){var t,d,s,c;return(0,nl.__generator)(this,function(l){switch(l.label){case 0:return[4,this.getOrCreateSnapshot(r)];case 1:return t=((u=l.sent())!==null&&u!==void 0?u:{snapshot:void 0}).snapshot,t===void 0?[2,(0,ls.failure)((0,km.unavailable)(["evalFormula"]))]:(d=this.calcGrid.evalFormulaOnSnapshotImpl(n,a,o,t),this.calcGrid.resumeRecalc(),c=UDr,[4,d]);case 2:return s=c.apply(void 0,[l.sent()]),[2,(0,ls.success)(s)]}})})},e.prototype.getSheetNames=function(r){var n;return(0,nl.__awaiter)(this,void 0,void 0,function(){var a,o,u,t,d,s,c;return(0,nl.__generator)(this,function(l){switch(l.label){case 0:return[4,this.getOrCreateSnapshot(r)];case 1:if(a=((n=l.sent())!==null&&n!==void 0?n:{snapshot:void 0}).snapshot,a===void 0)return[2,(0,ls.failure)((0,km.unavailable)(["getSheetNames"]))];if(o={document:this.calcGrid.document,sheets:new Array},u=a.getSheetRangeIndexes((0,bD.allSheetsRange)(this.calcGrid.document)),!(0,ls.isSuccess)(u))return[2,u];for(t=0,d=u.value.sheets;t<d.length;t++){if(s=d[t],c=a.getSheetName(this.calcGrid.document,s),!(0,ls.isSuccess)(c))return[2,c];o.sheets.push({sheetIndex:(0,bD.sheetIndex)(this.calcGrid.document,s),sheetName:c.value})}return[2,(0,ls.success)(o)]}})})},e.prototype.getCorrespondingSnapshotID=function(r){return(0,nl.__awaiter)(this,void 0,void 0,function(){var n;return(0,nl.__generator)(this,function(a){switch(a.label){case 0:return[4,this.getOrCreateSnapshot(r)];case 1:return n=a.sent(),n===void 0?[2,-1]:[2,n.correspondingId]}})})},e.prototype.getOrCreateSnapshot=function(r){return(0,nl.__awaiter)(this,void 0,void 0,function(){return(0,nl.__generator)(this,function(n){return this.snapshotPromises[r]===void 0&&(this.snapshotPromises[r]=this.calcGrid.dataModel.createSnapshot(r),this.calcGrid.resumeRecalc().catch(function(a){setTimeout(function(){throw a})})),[2,this.snapshotPromises[r]]})})},e.prototype.getRangeFormats=function(r,n){return this.getRangeData(r,n,"formats")},e.prototype.getRangeValues=function(r,n){return this.getRangeData(r,n,"values")},e.prototype.getRangeFormulae=function(r,n){return this.getRangeData(r,n,"formulae")},e.prototype.getRangeData=function(r,n,a){var o;return(0,nl.__awaiter)(this,void 0,void 0,function(){var u,t,d,s,c,l,f,p;return(0,nl.__generator)(this,function(m){switch(m.label){case 0:return[4,this.getOrCreateSnapshot(r)];case 1:return u=((o=m.sent())!==null&&o!==void 0?o:{snapshot:void 0}).snapshot,u===void 0?[2,(0,ls.failure)((0,km.unavailable)(["getRangeData/getOrCreateSnapshot"]))]:(t=u.allEditedAvailable(n),t.kind!==ls.ResultKind.Success?[2,(0,ls.failure)((0,km.unavailable)(["getRangeData/allEditedAvailable"]))]:(d=(0,Fk.createCellSetFromRange)(n.range),t.value!==!0&&(d=(0,Wne.exceptProduct)(d,t.value)),s=function(h){var S=[],y=(0,Fk.forEachRangeInSet)(d,function(C){var E=h((0,bD.sheetGridRange)(n.sheet,C),function(I){d=(0,Wne.exceptProduct)(d,(0,Fk.createCellSetFromRange)(I))},function(I,F){S.push([[I.row,I.col],F])});return E.kind===ls.ResultKind.Success&&E.value});return y?(0,ls.success)(S):(0,ls.failure)((0,km.unavailable)(["getRangeData/extractData"]))},c={formulae:function(){return s(function(h,S,y){return u.forEachEditedFormula(h,function(C,E){var I=E.lexicalKind,F=E.compiledFmla,w=E.fmla,B=E.origin;return I===bD.LexicalKind.Range||!(0,km.isGridCell)(C)?S(C):(0,PD.isBlankGridFormula)(w,F!==void 0)||y(C,{kind:F!==void 0?JNe.FormulaKind.CellFormula:JNe.FormulaKind.Value,formulaBarText:w,origin:(0,km.isGridCellEqual)(B,C)?void 0:B}),!0})})},formats:function(){return s(function(h,S,y){return u.forEachEditedFormat(h,function(C,E){return E===jne.SpecialFormat.Unavailable?S(C):(0,PD.isBlankCellFormat)(E)||y(C,typeof E=="number"?E:E.formatString),!0})})},values:function(){return s(function(h,S,y){return u.forEachRecalcValue(h,function(C,E){return E.failure!==void 0?S(C):(0,PD.isBlankGridValue)(E.oper,E.failure)||y(C,E.oper),!0})})}},l=c[a](),f=l,f.kind!==ls.ResultKind.Success?[2,f]:(p=[],(0,Fk.forEachRangeInSet)(d,function(v){return p.push(v),!0}),[2,(0,ls.success)({nonEmptyCells:f.value,availableRanges:p})])))}})})},e.prototype.getIntersectingTables=function(r,n){var a,o;return(0,nl.__awaiter)(this,void 0,void 0,function(){var u,t,d,s,c,l,f,p,m,v,h,S;return(0,nl.__generator)(this,function(y){switch(y.label){case 0:return[4,this.getOrCreateSnapshot(r)];case 1:if(u=((a=y.sent())!==null&&a!==void 0?a:{snapshot:void 0}).snapshot,u===void 0)return[2,(0,ls.failure)((0,km.unavailable)(["getIntersectingTables/getOrCreateSnapshot"]))];if(t=u.allServerAvailable(n),t.kind!==ls.ResultKind.Success)return[2,(0,ls.failure)((0,km.unavailable)(["getIntersectingTables/allServerAvailable"]))];if(d=u.getIntersectingTables(n),!(0,ls.isSuccess)(d))return[2,(0,ls.failure)((0,km.unavailable)(["getIntersectingTables/getIntersectingTables"]))];for(s=[],c=function(E){var I=u.getNamedObject(E,bD.NameSource.Plain);if(I.kind!==ls.ResultKind.Success)return{value:I};if(((o=I.value)===null||o===void 0?void 0:o.kind)!=="NamedTable")return"continue";var F=[];I.value.columnIndexes.forEach(function(w,B){return F.push({column:w,name:B}),!0}),s.push({name:E.name,dataRange:I.value.specialRefRanges[LDr.SpecialRefId.Data].range,hasHeadersRow:I.value.hasHeadersRow,hasTotalsRow:I.value.hasTotalsRow,columns:F})},l=0,f=d.value;l<f.length;l++)if(p=f[l],m=c(p),typeof m=="object")return[2,m.value];return v=(0,Fk.createCellSetFromRange)(n.range),h=t.value===!0?v:(0,Wne.exceptProduct)(v,t.value),S=[],(0,Fk.forEachRangeInSet)(h,function(C){return S.push(C),!0}),[2,(0,ls.success)({tables:s,availableRanges:S})]}})})},e.prototype.getIformats=function(r,n,a,o){var u;return(0,nl.__awaiter)(this,void 0,void 0,function(){var t,d;return(0,nl.__generator)(this,function(s){switch(s.label){case 0:return[4,this.getOrCreateSnapshot(r)];case 1:return t=((u=s.sent())!==null&&u!==void 0?u:{snapshot:void 0}).snapshot,t===void 0?[2,(0,ls.failure)((0,km.unavailable)(["getIformats/getOrCreateSnapshot"]))]:(d=t.getIformats(n,a,o),(0,ls.isSuccess)(d)?[2,(0,ls.success)({availableFormats:d.value})]:[2,(0,ls.failure)((0,km.unavailable)(["getIformats/getIntersectingTables"]))])}})})},e.prototype.getHiddenRows=function(r,n,a,o){var u;return(0,nl.__awaiter)(this,void 0,void 0,function(){var t;return(0,nl.__generator)(this,function(d){switch(d.label){case 0:return[4,this.getOrCreateSnapshot(r)];case 1:return t=((u=d.sent())!==null&&u!==void 0?u:{snapshot:void 0}).snapshot,t===void 0?[2,PD.hiddennessFullyUnavailable]:[2,t.getHiddenRows(n,a,o)]}})})},e.prototype.getHiddenCols=function(r,n,a,o){var u;return(0,nl.__awaiter)(this,void 0,void 0,function(){var t;return(0,nl.__generator)(this,function(d){switch(d.label){case 0:return[4,this.getOrCreateSnapshot(r)];case 1:return t=((u=d.sent())!==null&&u!==void 0?u:{snapshot:void 0}).snapshot,t===void 0?[2,PD.hiddennessFullyUnavailable]:[2,t.getHiddenCols(n,a,o)]}})})},e}();Ik.RecalcSideGrid=qDr;function ZNe(e,r){return e.map(function(n){if(!(0,NE.isDefined)(n.data))return{data:void 0,range:(0,EE.sheetGridRangeToLocation)(n.range)};var a=(0,EE.readOperToCellValue)(r,n.data.value);return{data:{kind:n.data.kind,formulaBarText:n.data.formulaBarText,value:a??xDr.blankValue,iformat:n.data.iformat,failureReason:a===void 0?"unsupported Oper serialization":void 0},range:(0,EE.sheetGridRangeToLocation)(n.range)}})}function $Ne(e,r){return e.map(function(n){var a=n.range,o=a[0],u=a.slice(1),t=(0,nl.__spreadArray)([(0,EE.sheetGridRangeToLocation)(o)],u.map(function(d){return(0,EE.sheetGridRangeToLocation)(d)}),!0);return{kind:n.kind,range:t,formulaBarText:n.formulaBarText,value:(0,NE.isDefined)(n.value)?(0,EE.readOperToCellValue)(r,n.value):void 0,origin:(0,NE.isDefined)(n.origin)?(0,EE.gridCellToCellLocation)(n.origin):void 0}})}function UDr(e){if(e.value.kind===ls.ResultKind.Failure&&e.value.reason.kind===km.ReasonKind.Unavailable)for(var r=e.value.reason.objects,n=0;n<r.length;n++){var a=r[n];a.kind===jne.UnavailableKind.GridRange&&(r[n]=(0,nl.__assign)((0,nl.__assign)({},a),{unavailableCells:!0}))}return e}});var h8=Y(Mk=>{_();Object.defineProperty(Mk,"__esModule",{value:!0});Mk.recalcServiceInsideInit=Mk.RecalcServiceImpl=void 0;var f8=br(),GDr=exr(oC()),tl=Ol(),al=ft(),KDr=e3(),ED=gs(),kT=dT(),p8=e0(),m8=xne(),VDr=r_(),Iu=vd(),eAe=f1(),g8=zu(),rAe=ey(),nAe=x0(),u0=Ai(),WDr=Z1(),jDr=Bne(),Ds=YO(),HDr=Ok(),QDr=ig(),zDr=GK(),YDr=HNe(),ND=Di(),JDr=Jc(),XDr=QNe(),ZDr=Vne(),cs=sk(),Hne=uD(),tAe=cu(),$Dr=d8();function aAe(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,n=new WeakMap;return(aAe=function(o){return o?n:r})(e)}function exr(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var n=aAe(r);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(u!=="default"&&Object.prototype.hasOwnProperty.call(e,u)){var t=o?Object.getOwnPropertyDescriptor(e,u):null;t&&(t.get||t.set)?Object.defineProperty(a,u,t):a[u]=e[u]}return a.default=e,n&&n.set(e,a),a}var Qne,v8=10,rxr=function(){function e(r,n,a){this.onRecalcResults=r,this.onUpdateRequest=n,this.currentOutputStateId=a,this.editedRangeDeltas=[],this.dependentRangeDeltas=[],this.editedRangeFailures=[],this.dependentRangeFailures=[],this.rangeUpdateRequests=[],this.namesUpdateRequests=[],this.recalcFinished=!1}return e.prototype.setOutputStateId=function(r){r<=this.currentOutputStateId||(this.flush(),this.currentOutputStateId=r)},e.prototype.pushCellWrite=function(r,n){(r!==Iu.ComputedCellKind.DependentCell?this.editedRangeDeltas:this.dependentRangeDeltas).push(n)},e.prototype.pushRangeWrite=function(r,n){(0,al.safePush)(r!==Iu.ComputedCellKind.DependentCell?this.editedRangeDeltas:this.dependentRangeDeltas,n)},e.prototype.pushRangeFailure=function(r,n){(r!==Iu.ComputedCellKind.DependentCell?this.editedRangeFailures:this.dependentRangeFailures).push(n)},e.prototype.pushUpdateRequest=function(r){this.rangeUpdateRequests.push(r)},e.prototype.pushUpdateNameRequest=function(r){this.namesUpdateRequests.push(r.index)},e.prototype.pushRecalcFinished=function(r){this.recalcFinished=this.recalcFinished||r},e.prototype.isRecalcFinished=function(){return this.recalcFinished},e.prototype.flush=function(){(this.rangeUpdateRequests.length>0||this.namesUpdateRequests.length>0)&&(this.onUpdateRequest((0,kT.updateRequest)(this.rangeUpdateRequests,[],this.namesUpdateRequests)),this.rangeUpdateRequests=[],this.namesUpdateRequests=[]),(this.editedRangeDeltas.length>0||this.editedRangeFailures.length>0)&&(this.sendRecalcResults("Edited",this.editedRangeDeltas,[],this.editedRangeFailures),this.editedRangeDeltas=[],this.editedRangeFailures=[]),(this.dependentRangeDeltas.length>0||this.dependentRangeFailures.length>0)&&(this.sendRecalcResults("Dependents",this.dependentRangeDeltas,[],this.dependentRangeFailures),this.dependentRangeDeltas=[],this.dependentRangeFailures=[]),this.recalcFinished&&(this.onRecalcResults((0,kT.recalcResults)(this.currentOutputStateId,"Dependents",!0,[],[],[])),this.recalcFinished=!1)},e.prototype.sendRecalcResults=function(r,n,a,o){for(var u=0;u<(0,al.fastMax)((0,al.fastMax)(n.length,a.length),o.length);u+=v8)this.onRecalcResults((0,kT.recalcResults)(this.currentOutputStateId,r,!1,n.slice(u,u+v8),a.slice(u,u+v8),o.slice(u,u+v8)))},e}();function zne(e){var r=e.kind;return{kind:r}}var iAe=function(){function e(r,n,a,o,u,t,d){t===void 0&&(t={}),d===void 0&&(d="Local");var s=this;this.onRecalcResults=r,this.onUpdateRequest=n,this.onGC=a,this.onAlert=o,this.asyncLoopFactory=u,this.twConfig=t,this.dataTransformer=new Hne.RecalcServiceDataTransformer,this.currentInputStateId=-(1/0),this.currentOutputStateId=-(1/0),this.lastRecalcStatsStateId=-(1/0),this.recalcStatistics=Iu.emptyRecalcStatistics,this.nameFailures=[],this.rangeFailures=[],this.numberFormatFailures=[],this.printFormulaFailures=[],this.inferFormatFailures=[],this.formatValueFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.initCalcThreadInside=function(c,l,f){return(0,f8.__awaiter)(s,void 0,void 0,function(){return(0,f8.__generator)(this,function(p){return[2,(0,KDr.initCalcInThread)(c,l,f,this.twConfig)]})})},this.setConfig({}),this.dataModel=new m8.PartialWorkbook(this.dataTransformer.getLangConfig(),this.config)}return Object.defineProperty(e.prototype,"document",{get:function(){return this.dataTransformer.document},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mathpack",{get:function(){return this.dataTransformer.getLangConfig().mathpack},enumerable:!1,configurable:!0}),e.prototype.ping=function(){},e.prototype.setInputStateId=function(r,n){var a=r-this.currentInputStateId;return a<0?(this.logInputStateIdDecrease(n),!1):(a!==0&&(this.flushInputLogs(),this.currentInputStateId=r),!0)},e.prototype.setOutputStateId=function(r){var n=r-this.currentOutputStateId;return n<0?(this.logOutputStateIdDecrease(),!1):(n!==0&&(this.flushOutputLogs(),this.currentOutputStateId=r),!0)},e.prototype.clearAsyncResumeRecalc=function(){this.recalcLoop!==void 0&&this.recalcLoop.stop()},e.prototype.resumeRecalc=function(){var r=this;this.flushInputLogs(),this.clearAsyncResumeRecalc(),this.recalcLoop=this.asyncLoopFactory(function(){var a=r.dataModel.step(),o=a.messages,u=a.queueEmpty;return o.length>0&&r.processRecalcResults(o),u?void 0:1},{costThreshold:1,timeThreshold:this.config.yieldIntervalMs});var n=this.recalcLoop;return(0,HDr.promiseFinally)(this.recalcLoop.promise,function(){r.recalcLoop===n&&(r.recalcLoop=void 0)})},e.prototype.testResumeRecalc=function(r){return(0,f8.__awaiter)(this,void 0,void 0,function(){var n;return(0,f8.__generator)(this,function(a){switch(a.label){case 0:return[4,this.resumeRecalc()];case 1:return a.sent(),r!==void 0&&(n="calc.calc.RecalcService: resumeRecalc finished; resumeId = ".concat(r),u0.ulsLogger.ULS.traceTag(574128980,tl.LogCategory.msoulscat_ES_EWAJS,tl.TraceLevel.Info,n)),[2]}})})},e.prototype.processRecalcResults=function(r){for(var n=new rxr(this.onRecalcResults,this.onUpdateRequest,this.currentOutputStateId),a=0,o=r;a<o.length;a++){var u=o[a];if(u.kind===Iu.OutputMessageKind.GarbageCollected){this.onGC(u.minStateIdKept);continue}if(u.kind===Iu.OutputMessageKind.Alert){this.onAlert(u.message);continue}if(u.kind===Iu.OutputMessageKind.ExperimentRunResult){this.logExperimentRunResult(u.experimentName,JSON.stringify({message:u.logMessage,timeoutReason:u.timeoutReason}));continue}if(this.setOutputStateId(u.stateId))switch(n.setOutputStateId(u.stateId),u.kind){case Iu.OutputMessageKind.CellWrite:{var t=u.cell,d=u.value,s=u.format,c=u.cellKind,l=u.formulaBarText,f=u.formatted,p=u.hasHyperlink,m=t.sheet,v=t.range,h=this.cellWriteToRangeDelta(m.index,v.row,v.col,d,s,l,f,p,"messages.<index>.value");(0,al.isDefined)(h)&&n.pushCellWrite(c,h);break}case Iu.OutputMessageKind.RangeWrite:{var S=u.range,y=u.values,c=u.cellKind,l=u.formulaBarText,f=u.formatted,C=u.formats,m=S.sheet,v=S.range;n.pushRangeWrite(c,this.rangeWriteToRangeDeltas(m.index,v,y,C,l,f,"messages.<index>.values"));break}case Iu.OutputMessageKind.NameFailure:this.nameFailures.push(u);break;case Iu.OutputMessageKind.RangeFailure:{var S=u.range,c=u.cellKind,E=u.reason;n.pushRangeFailure(c,this.rangeFailure(S,E)),this.rangeFailures.push(u);break}case Iu.OutputMessageKind.NumberFormatFailure:this.numberFormatFailures.push(u);break;case Iu.OutputMessageKind.PrintFormulaFailure:this.printFormulaFailures.push(u);break;case Iu.OutputMessageKind.InferFormatFailure:this.inferFormatFailures.push(u);break;case Iu.OutputMessageKind.FormatValueFailure:{var S=u.range,c=u.cellKind,E=u.reason;n.pushRangeFailure(c,this.rangeFailure(S,E)),this.formatValueFailures.push(u);break}case Iu.OutputMessageKind.UnhandledFailure:this.unhandledFailures.push(u);break;case Iu.OutputMessageKind.UpdateRequest:n.pushUpdateRequest((0,cs.sheetGridRangeToLocation)(u.range));break;case Iu.OutputMessageKind.UpdateNamesRequest:n.pushUpdateNameRequest(u.scope);break;case Iu.OutputMessageKind.RecalcStatistics:n.pushRecalcFinished(u.message===Iu.RecalcStatisticsMessage.RecalcFinished),this.recalcStatistics=(0,Iu.mergeRecalcStatistics)(this.recalcStatistics,u);break;case Iu.OutputMessageKind.WorkbookStatistics:this.logWorkbookStats(u.stateId,u.stats,u.p);break;case Iu.OutputMessageKind.StateAdvanced:break;default:return(0,u0.assertNever)("calc.calc.RecalcServiceImpl.processRecalcResults",u)}}n.isRecalcFinished()&&this.flushOutputLogs(),n.flush()},e.prototype.logExperimentRunResult=function(r,n){u0.ulsLogger.ULS.traceTag(594409422,tl.LogCategory.msoulscat_ES_EWAJS,tl.TraceLevel.Info,"calc.calc.RecalcService: ".concat(r," done; ").concat(n)),r==="UnitExperiment"&&u0.ulsLogger.ULS.traceTag(538567681,tl.LogCategory.msoulscat_ES_EWAJS,tl.TraceLevel.Info,"calc.calc.RecalcService: UnitExperiment done: ".concat(n))},e.prototype.logAllFailureStats=function(){var r=this.nameFailures;this.nameFailures=[];var n=this.rangeFailures;this.rangeFailures=[];var a=this.numberFormatFailures;this.numberFormatFailures=[];var o=this.printFormulaFailures;this.printFormulaFailures=[];var u=this.inferFormatFailures;this.inferFormatFailures=[];var t=this.formatValueFailures;this.formatValueFailures=[];var d=this.unhandledFailures;this.unhandledFailures=[],this.logGenFailureStats(r,595194337,"name",tl.TraceLevel.Info),this.logCellFailureStats(n,595658722,"range",tl.TraceLevel.Info),this.logGenFailureStats(a,590484946,"format",tl.TraceLevel.Info),this.logGenFailureStats(o,592730065,"print-formula",tl.TraceLevel.Info),this.logGenFailureStats(u,590484947,"infer-format",tl.TraceLevel.Info),this.logCellFailureStats(t,590484948,"format-value",tl.TraceLevel.Info),this.logGenFailureStats(d,595194338,"unhandled",tl.TraceLevel.Warning)},e.prototype.logGenFailureStats=function(r,n,a,o){if(r.length!==0){for(var u={},t=0,d=r;t<d.length;t++){var s=d[t].reason;(0,Hne.incrementFailure)(u,s)}var c="calc.calc.RecalcService: recalc ".concat(a," failures; stateId = ").concat(this.currentOutputStateId,", stats = ").concat(JSON.stringify(u));u0.ulsLogger.ULS.traceTag(n,tl.LogCategory.msoulscat_ES_EWAJS,o,c),this.logJavaScriptFailures(r,a)}},e.prototype.logCellFailureStats=function(r,n,a,o){var u=this,t;if(r.length!==0){for(var d={},s=0,c=r;s<c.length;s++){var l=c[s],f=l.reason,p=l.cellKind,m=(t=d[p])!==null&&t!==void 0?t:d[p]={};(0,Hne.incrementFailure)(m,f)}Object.getOwnPropertyNames(d).sort().forEach(function(v){var h=d[v],S="calc.calc.RecalcService: recalc ".concat(a," failures; stateId = ").concat(u.currentOutputStateId,", cell kind = ").concat(v,", stats = ").concat(JSON.stringify(h));u0.ulsLogger.ULS.traceTag(n,tl.LogCategory.msoulscat_ES_EWAJS,o,S)}),this.logJavaScriptFailures(r,a)}},e.prototype.logJavaScriptFailures=function(r,n){for(var a=0,o=r;a<o.length;a++){var u=o[a].reason;if(u.kind===WDr.ReasonKind.JavaScriptError){var t=(0,QDr.messageFromError)(u.error),d="calc.calc.RecalcService: recalc ".concat(n," JavaScript error: ").concat(t);u0.ulsLogger.ULS.traceTag(595658721,tl.LogCategory.msoulscat_ES_EWAJS,tl.TraceLevel.Warning,d)}}},e.prototype.logIgnoredStats=function(r,n,a,o){if(Object.getOwnPropertyNames(o).length!==0){var u="stateId = ".concat(n,", stats = ").concat(JSON.stringify(o)),t="calc.calc.RecalcService: ignored ".concat(a," data; ").concat(u);u0.ulsLogger.ULS.traceTag(r,tl.LogCategory.msoulscat_ES_EWAJS,tl.TraceLevel.Warning,t)}},e.prototype.logIgnoredInputStats=function(){this.logIgnoredStats(595658723,this.currentInputStateId,"input",this.ignoredInputStats),this.ignoredInputStats={}},e.prototype.logIgnoredOutputStats=function(){this.logIgnoredStats(595658752,this.currentOutputStateId,"output",this.ignoredOutputStats),this.ignoredOutputStats={}},e.prototype.logRecalcStats=function(){if(this.currentOutputStateId!==-(1/0)&&!(this.lastRecalcStatsStateId===this.currentOutputStateId&&this.recalcStatistics===Iu.emptyRecalcStatistics)){var r=this.recalcStatistics;this.recalcStatistics=Iu.emptyRecalcStatistics,this.lastRecalcStatsStateId=this.currentOutputStateId;var n=this.config.sampleRecalcStatisticsRate;if(this.dataModel.shouldSample(n)){var a="stateId = ".concat(this.currentOutputStateId,", stats = ").concat(JSON.stringify(r),", p = ").concat(JSON.stringify(n)),o="calc.calc.RecalcService: recalc statistics; ".concat(a);u0.ulsLogger.ULS.traceTag(595654593,tl.LogCategory.msoulscat_ES_EWAJS,tl.TraceLevel.Info,o)}}},e.prototype.logUnavailableStats=function(){if(this.currentOutputStateId!==-(1/0)&&this.rangeFailures.length!==0){var r=(0,YDr.computeUnavailableCellsStats)(this.rangeFailures);if(!(r.numOfUnavailableCellsInTheSameSheet===0&&r.numOfUnavailableCellsInDifferentSheet===0&&r.totalNumOfUnavailableCells===0)){var n="stateId = ".concat(this.currentOutputStateId,", stats = ").concat(JSON.stringify(r)),a="calc.calc.RecalcService: unavailable cells statistics; ".concat(n);u0.ulsLogger.ULS.traceTag(589632004,tl.LogCategory.msoulscat_ES_EWAJS,tl.TraceLevel.Info,a)}}},e.prototype.logWorkbookStats=function(r,n,a){var o="stateId = ".concat(r,", stats = ").concat(JSON.stringify(n),", p = ").concat(JSON.stringify(a)),u="calc.calc.RecalcService: workbook statistics; ".concat(o);u0.ulsLogger.ULS.traceTag(595359882,tl.LogCategory.msoulscat_ES_EWAJS,tl.TraceLevel.Info,u)},e.prototype.logInputStateIdDecrease=function(r){(0,Ds.incrementStat)(this.ignoredInputStats,"".concat(r,": input stateId went backwards"))},e.prototype.logOutputStateIdDecrease=function(){(0,Ds.incrementStat)(this.ignoredOutputStats,"output stateId went backwards")},e.prototype.flushInputLogs=function(){this.logIgnoredInputStats()},e.prototype.flushOutputLogs=function(){this.logUnavailableStats(),this.logAllFailureStats(),this.logIgnoredOutputStats(),this.logRecalcStats()},e.prototype.cellWriteToRangeDelta=function(r,n,a,o,u,t,d,s,c){if((0,Ds.check)(o,Ds.chReadOper,this.ignoredOutputStats,c)){var l=(0,cs.readOperToCellValue)(this.mathpack,o),f=(0,cs.cellFormatToInferredFormat)(u);return(0,al.isDefined)(t)||(0,al.isDefined)(l)||(0,al.isDefined)(f)||(0,al.isDefined)(d)||(0,al.isDefined)(s)?(0,kT.rangeDelta)((0,kT.sheetRangeLocation)(r,n,a),(0,kT.cellDataDelta)(t,l,f,d,s)):void 0}},e.prototype.rangeWriteToRangeDeltas=function(r,n,a,o,u,t,d){for(var s="".concat(d,".<index>.<index>"),c=n.row,l=n.col,f=n.rows,p=n.cols,m=[],v=0;v<f;v+=1)for(var h=0;h<p;h+=1){var S=this.cellWriteToRangeDelta(r,c+v,l+h,a[v][h],o[v][h],v===0&&h===0?u:void 0,t[v][h],void 0,s);(0,al.isDefined)(S)&&m.push(S)}return m},e.prototype.rangeFailure=function(r,n){return(0,kT.rangeFailure)((0,cs.sheetGridRangeToLocation)(r),zne(n))},e.prototype.setA1ReferenceStyle=function(r){this.clearAsyncResumeRecalc(),this.dataTransformer.setA1ReferenceStyle(this.dataModel,this.currentInputStateId,r)},e.prototype.setLocale=function(r){this.clearAsyncResumeRecalc(),this.dataTransformer.setLocaleInfo(this.dataModel,this.currentInputStateId,r,this.ignoredInputStats)},e.prototype.setWorkbookProps=function(r){this.clearAsyncResumeRecalc(),this.dataTransformer.setWorkbookProps(this.dataModel,this.currentInputStateId,r,this.ignoredInputStats)},e.prototype.setNumberFormats=function(r,n){this.clearAsyncResumeRecalc(),this.dataModel.setNumberFormats(this.document,(0,Ds.filterCheck)(r,Ds.chNumberFormat,this.ignoredInputStats,"numberFormats"),n,this.currentInputStateId)},e.prototype.updateSheetNames=function(r,n){this.setInputStateId(r,"sheetNames")&&(this.clearAsyncResumeRecalc(),this.dataTransformer.updateSheetNames(this.dataModel,r,n,this.ignoredInputStats))},e.prototype.updateNamedObjects=function(r,n){this.setInputStateId(r,"namedObjectsUpdates")&&(this.clearAsyncResumeRecalc(),this.dataTransformer.updateNamedObjects(this.dataModel,r,n,this.ignoredInputStats))},e.prototype.updateUnusedCells=function(r,n){if(this.setInputStateId(r,"unusedCellsUpdates")){this.clearAsyncResumeRecalc();for(var a=(0,Ds.filterCheck)(n,Ds.chUnusedCellsUpdate,this.ignoredInputStats,"unusedCellsUpdates"),o=0,u=a;o<u.length;o++){var t=u[o];this.dataModel.extendUnusedRange((0,cs.unusedCellsUpdateToUsedRange)(this.document,t),r)}}},e.prototype.updateRanges=function(r,n){this.setInputStateId(r,"rangeUpdates")&&(this.clearAsyncResumeRecalc(),this.applyRangeUpdates(r,n))},e.prototype.updateArrays=function(r,n){if(this.setInputStateId(r,"arrayUpdates")){this.clearAsyncResumeRecalc();for(var a=(0,Ds.filterCheck)(n,Ds.chArrayUpdate,this.ignoredInputStats,"arrayUpdates"),o=0,u=a;o<u.length;o++){var t=u[o],d=t.range,s=t.data,c=t.fromStateId,l=(0,cs.sheetRangeLocationToGridRange)(this.document,d);if((0,al.isDefined)(s)){var f=s.formulaBarText,p=s.isSpilled,m=(0,g8.gridRangeAnchor)(l.range);this.dataModel.writeArrayFormula(r,l,f,m,p)}else(0,al.isDefined)(c)}}},e.prototype.editRangeFormulas=function(r,n){this.setInputStateId(r,"rangeFormulaEdits")&&(this.clearAsyncResumeRecalc(),this.applyRangeFormulaEdits(n,r))},e.prototype.evalOnClonedModel=function(r,n,a){return this.evalOnClonedModelOnSnapshot(r,n,void 0,a)},e.prototype.evalOnClonedModelOnSnapshot=function(r,n,a,o){a===void 0&&(a=void 0),(0,u0.assertPositiveInteger)("edits array should not be empty",n.length);var u=a===void 0?new m8.EvalOnClonePropsFromPartialWB(this.dataModel,o):new m8.EvalOnClonePropsFromPartialWBDocumentCollection(a,o);return this.applyRangeUpdates(-1,r,u),this.applyRangeFormulaEdits(n,-1,u),u.resultsPromise.toPromise()},e.prototype.applyRangeUpdates=function(r,n,a){for(var o,u,t=(0,Ds.filterCheck)(n,Ds.chRangeUpdate,this.ignoredInputStats,"rangeUpdates"),d=0,s=t;d<s.length;d++){var c=s[d],l=c.range,f=c.excludeRows,p=c.excludeColumns,m=c.data,v=c.fromStateId,h=(0,cs.sheetRangeLocationToGridRange)(this.document,l),S=h.range,y=(0,cs.createExcludeCellSet)(S.row,S.rows,p8.bspFactory.row,f),C=(0,cs.createExcludeCellSet)(S.col,S.cols,p8.bspFactory.col,p),E=(0,cs.sheetGridRangeToCellSet)(h,y,C),I=(0,al.isDefined)(m)?(0,cs.cellValueToReadOper)(this.mathpack,m.value):eAe.blankOper;(0,u0.assertTrue)("calc.calc.RecalcService: updateRanges oper",I!=null);var F=(0,g8.gridRangeAnchor)(S);if((0,al.isDefined)(m)){var w=m.iformat,B=m.kind==="ArrayFormula"?void 0:(o=m.formulaBarText)!==null&&o!==void 0?o:void 0,k=(u=m.failureReason)!==null&&u!==void 0?u:void 0,x=m.kind==="CellFormula";this.dataModel.writeCellContents(r,E,B,x,F,I,w,Iu.SpecialStyle.Blank,k,a)}else if((0,al.isNone)(v))this.dataModel.writeCellContents(r,E,"",!1,F,eAe.blankOper,VDr.blankCellFormat,void 0,void 0,a);else{if(a)throw new Error("Promote cell data is unsupported for cloned models.");this.dataModel.promoteCellContents(r,h,E,v)}a||(this.dataModel.writeHiddenRows(r,(0,cs.sheetGridRangeToHiddenRows)(h,y)),this.dataModel.writeHiddenCols(r,(0,cs.sheetGridRangeToHiddenCols)(h,C)))}},e.prototype.applyRangeFormulaEdits=function(r,n,a){for(var o=this,u=(0,Ds.filterCheck)(r,Ds.chRangeFormulaEdit,this.ignoredInputStats,"rangeFormulaEdits"),t=function(p){var m=p.kind,v=p.range,h=p.formulaBarText,S=p.value,y=p.origin,C=p.viewport,E=rAe.empty;v.forEach(function(x){E=(0,nAe.unionProduct)(E,(0,p8.createCellSetFromRange)((0,cs.sheetRangeLocationToGridRange)(o.document,x).range))});var I=(0,cs.sheetRangeLocationToGridRange)(d.document,v[0]),F=(0,al.isDefined)(y)?(0,ED.gridCell)(y.row,y.column):(0,g8.gridRangeAnchor)(I.range),w=(0,al.isDefined)(C)?(0,cs.sheetRangeLocationToGridRange)(d.document,C):void 0,B=void 0;(0,al.isDefined)(S)?(B=(0,cs.cellValueToReadOper)(d.mathpack,S),(0,u0.assertTrue)("calc.calc.RecalcService: editRangeFormulas oper",B!=null)):B=void 0;var k=m==="CellFormula"?!0:m==="Value"?!1:void 0;a?d.dataModel.editCellContentsOnClone((0,Iu.sheetCellSet)(I.sheet,E),h,k,F,a):d.dataModel.editCellContents(n,(0,Iu.sheetCellSet)(I.sheet,E),h,k,F,B,w)},d=this,s=0,c=u;s<c.length;s++){var l=c[s];t(l)}},e.prototype.editRangeFormats=function(r,n){var a=this;if(this.setInputStateId(r,"rangeFormatEdits")){this.clearAsyncResumeRecalc();for(var o=(0,Ds.filterCheck)(n,Ds.chRangeFormatEdit,this.ignoredInputStats,"rangeFormatEdits"),u=function(f){var p=f.range,m=f.operation,v=f.origin,h=f.viewport,S=m.kind==="SetFormat"&&!(0,al.isNone)(m.format)?{kind:m.kind,format:m.format}:m.kind==="RibbonFormat"&&!(0,al.isNone)(m.ribbon)?{kind:m.kind,ribbon:m.ribbon}:m.kind==="ChangeDecimals"&&!(0,al.isNone)(m.changeDecimals)?{kind:m.kind,changeDecimals:m.changeDecimals}:void 0;(0,u0.assertTrue)("calc.calc.RecalcService: editRangeFormats operation",S!=null);var y=rAe.empty;p.forEach(function(F){y=(0,nAe.unionProduct)(y,(0,p8.createCellSetFromRange)((0,cs.sheetRangeLocationToGridRange)(a.document,F).range))});var C=(0,cs.sheetRangeLocationToGridRange)(t.document,p[0]),E=v!=null?(0,ED.gridCell)(v.row,v.column):(0,g8.gridRangeAnchor)(C.range),I=(0,al.isDefined)(h)?(0,cs.sheetRangeLocationToGridRange)(t.document,h):void 0;t.dataModel.editCellFormats(r,(0,Iu.sheetCellSet)(C.sheet,y),S,E,I)},t=this,d=0,s=o;d<s.length;d++){var c=s[d];u(c)}}},e.prototype.editArrayFormulas=function(r,n){if(this.setInputStateId(r,"arrayFormulaEdits")){this.clearAsyncResumeRecalc();for(var a=(0,Ds.filterCheck)(n,Ds.chArrayFormulaEdit,this.ignoredInputStats,"arrayFormulaEdits"),o=0,u=a;o<u.length;o++){var t=u[o],d=t.range,s=t.formulaBarText,c=t.origin,l=t.viewport,f=(0,cs.sheetRangeLocationToGridRange)(this.document,d),p=(0,al.isDefined)(c)?(0,ED.gridCell)(c.row,c.column):(0,ED.gridCell)(d.row,d.column),m=(0,al.isDefined)(l)?(0,cs.sheetRangeLocationToGridRange)(this.document,l):void 0;this.dataModel.editArrayFormula(r,f,s,p,m)}}},e.prototype.editRangePaste=function(r,n){if(this.setInputStateId(r,"editRangePaste")){this.clearAsyncResumeRecalc();for(var a=(0,Ds.filterCheck)(n,Ds.chPasteEdit,this.ignoredInputStats,"pasteEdits"),o=0,u=a;o<u.length;o++){var t=u[o],d=t.kind,s=t.source,c=t.target,l=t.viewport,f=(0,cs.sheetRangeLocationToGridRange)(this.document,s),p=(0,cs.sheetCellLocationToGridCell)(this.document,c),m=(0,al.isDefined)(l)?(0,cs.sheetRangeLocationToGridRange)(this.document,l):void 0;this.dataModel.editPaste(r,d,p,f,m)}}},e.prototype.setConfig=function(r){var n,a,o,u,t,d,s,c,l,f,p,m,v=Array.isArray(r.runExperiments)?{stepBudget:(n=r.experimentStepBudget)!==null&&n!==void 0?n:10,totalBudget:(a=r.experimentTotalBudget)!==null&&a!==void 0?a:1e4,factories:(0,zDr.getExperimentFactories)(r.runExperiments)}:void 0;this.config={yieldIntervalMs:10,totalTimeMs:(o=r.totalEvalTimeMs)!==null&&o!==void 0?o:1e4,maxCellChain:2*ED.sheetCols,maxNameChain:128,maxLambdaCalls:1e4,maxLambdaDepth:1e3,samplePrecisionEvalRate:(u=r.samplePrecisionEvalRate)!==null&&u!==void 0?u:.02,samplePrecisionPrintFormulaRate:(t=r.samplePrecisionPrintFormulaRate)!==null&&t!==void 0?t:.001,samplePrecisionPrintValueRate:(d=r.samplePrecisionPrintValueRate)!==null&&d!==void 0?d:1e-4,sampleRecalcStatisticsRate:(s=r.sampleRecalcStatisticsRate)!==null&&s!==void 0?s:.2,sampleWorkbookStatisticsRate:(c=r.sampleWorkbookStatisticsRate)!==null&&c!==void 0?c:.1,sampleCellEvalStopwatchRate:(l=r.sampleCellEvalStopwatchRate)!==null&&l!==void 0?l:.003,sampleRecalcEditedStopwatchRate:(f=r.sampleRecalcEditedStopwatchRate)!==null&&f!==void 0?f:1,sampleRecalcViewportStopwatchRate:(p=r.sampleRecalcViewportStopwatchRate)!==null&&p!==void 0?p:1,rngSeed:(m=r.rngSeed)!==null&&m!==void 0?m:Date.now()*1e3,volatileMode:r.volatileMode!=null?tAe.VolatileMode[r.volatileMode]:tAe.VolatileMode.Estimation,experimentFactories:v}},e.prototype.reconfigure=function(r){this.setConfig(r),this.dataModel.reconfigure(this.config)},e.prototype.clearCache=function(){this.clearAsyncResumeRecalc(),this.dataModel=new m8.PartialWorkbook(this.dataTransformer.getLangConfig(),this.config),this.recalcStatistics=Iu.emptyRecalcStatistics,this.nameFailures=[],this.rangeFailures=[],this.numberFormatFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.currentInputStateId=this.currentOutputStateId=this.lastRecalcStatsStateId=-(1/0)},e.prototype.evalFormula=function(r,n,a,o){var u=this;return(0,Ds.check)(a,Ds.chSheetCellLocation,this.ignoredInputStats,"origin")?(0,Ds.check)(o,Ds.chEvalFormulaFormat,this.ignoredInputStats,"format")?this.dataModel.evalFormula(r,n,(0,cs.sheetCellLocationToGridCell)(this.document,a),(0,cs.evalFormulaFormatToUnion)(o)).then(function(t){var d=t.value,s=t.formatted,c;if((0,ND.isSuccess)(d)){if(!(0,Ds.check)(d.value,Ds.chReadOper,u.ignoredOutputStats,"evalFormula"))throw new Error("ignored output");var l=(0,cs.readOperToCellValue)(u.mathpack,d.value);(0,u0.assertTrue)("calc.calc.RecalcService.evalFormula",l!==void 0),c=(0,ND.success)(l)}else c=(0,ND.failure)(zne(d.reason));var f;return s===void 0?f=void 0:(0,ND.isSuccess)(s)?f=s:f=(0,ND.failure)(zne(s.reason)),(0,kT.evalFormulaData)(c,f)}):Promise.reject(new Error("ignored format")):Promise.reject(new Error("ignored input"))},e.prototype.evalFormulaOnSnapshotImpl=function(r,n,a,o){return this.dataModel.evalFormula(-1,r,n,a,o)},e.prototype.testAdvanceState=function(r){this.setInputStateId(r,"testAdvanceState")&&(this.dataModel.testAdvanceState(r),this.clearAsyncResumeRecalc())},e.prototype.getMissingJSFeatures=function(){return(0,ZDr.getMissingJSFeatures)()},e}();Mk.RecalcServiceImpl=iAe;var nxr=(0,XDr.mixin)(iAe,function(e){return new $Dr.RecalcSideGrid(e)},["getSheetNames","getRangeValues","getRangeFormats","getRangeFormulae","getIntersectingTables","getIformats","discardSnapshot","createIGridExportEndpoint","getHiddenRows","getHiddenCols","evalFormulaOnSnapshot","evalClonedModelOnSnapshot","getCorrespondingSnapshotID"]);if((0,JDr.getTypedFeatureGate)("TESTING_ONLY_RECALC_SERVICE_IMPORTSCRIPTS_FAIL")&&(self.__retries=((Qne=self.__retries)!==null&&Qne!==void 0?Qne:-1)+1,self.__retries===0))throw"";var txr=function(r){var n=r.config,a=r.connection;return GDr.Endpoint.createInside(a,function(o){return new nxr(function(){for(var u,t=[],d=0;d<arguments.length;d++)t[d]=arguments[d];return(u=o.post).onRecalcResults.apply(u,t)},function(){for(var u,t=[],d=0;d<arguments.length;d++)t[d]=arguments[d];return(u=o.post).onUpdateRequest.apply(u,t)},function(){for(var u,t=[],d=0;d<arguments.length;d++)t[d]=arguments[d];return(u=o.post).onGC.apply(u,t)},function(){for(var u,t=[],d=0;d<arguments.length;d++)t[d]=arguments[d];return(u=o.post).onAlert.apply(u,t)},jDr.asyncLoop,n,a.createMode)})};Mk.recalcServiceInsideInit=txr});var Yne=Y(wk=>{_();Object.defineProperty(wk,"__esModule",{value:!0});wk.GridProvider=wk.GridImportManager=void 0;var oAe=br(),axr=ixr(oC()),uAe=ig(),sAe=Ai(),S8=Ol(),lAe=Xv();function dAe(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,n=new WeakMap;return(dAe=function(o){return o?n:r})(e)}function ixr(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var n=dAe(r);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(u!=="default"&&Object.prototype.hasOwnProperty.call(e,u)){var t=o?Object.getOwnPropertyDescriptor(e,u):null;t&&(t.get||t.set)?Object.defineProperty(a,u,t):a[u]=e[u]}return a.default=e,n&&n.set(e,a),a}var oxr=function(){function e(r){this.onGridReady=r,this.gridService=void 0}return e.prototype.getGrid=function(){var r;return(r=this.gridService)===null||r===void 0?void 0:r.call},e.prototype.createIGridImportEndpoint=function(r){return(0,oAe.__awaiter)(this,void 0,void 0,function(){var n,a=this;return(0,oAe.__generator)(this,function(o){switch(o.label){case 0:return this.onGridExporterClosed(),[4,axr.Endpoint.createOutside(r,function(u){a.gridService={call:void 0,close:function(){return u.close("Force")}}})];case 1:return n=o.sent(),n.hasBeenClosed()||(this.gridService=n,this.onGridReady(this.gridService.call)),[2]}})})},e.prototype.onGridExporterClosed=function(){if(this.gridService){var r=this.gridService;this.gridService=void 0,r.close()}},e}();wk.GridProvider=oxr;function cAe(e,r,n){var a=new MessageChannel,o=a.port1,u=a.port2;Promise.all([e.createIGridImportEndpoint({port:u,options:n}),r.createIGridExportEndpoint({port:o,options:n},function(){return e.onGridExporterClosed()})]).catch(function(t){sAe.ulsLogger.ULS.traceTag(540674071,S8.LogCategory.msoulscat_ES_EWAJS,S8.TraceLevel.Warning,lAe.x10Logger.formatLogMessage("connectGridImporterExporter",{description:"".concat((0,uAe.messageFromError)(t))}));try{e.onGridExporterClosed()}catch(d){sAe.ulsLogger.ULS.traceTag(540644190,S8.LogCategory.msoulscat_ES_EWAJS,S8.TraceLevel.Warning,lAe.x10Logger.formatLogMessage("connectGridImporterExporter",{description:"importer threw ".concat((0,uAe.messageFromError)(d))}))}})}var uxr=function(){function e(r){this.timeout=r,this.exporter=void 0,this.importers=[]}return e.prototype.onGridExporterCreated=function(r){this.exporter=r;for(var n=0,a=this.importers;n<a.length;n++){var o=a[n],u=o.importer,t=o.id;cAe(u,r,{id:t,createTimeout:this.timeout})}},e.prototype.onGridImporterCreated=function(r,n){this.importers.push({importer:r,id:n}),this.exporter&&cAe(r,this.exporter,{id:n,createTimeout:this.timeout})},e}();wk.GridImportManager=uxr});var m_=Y(y8=>{_();Object.defineProperty(y8,"__esModule",{value:!0});y8.NotificationKind=void 0;var sxr=fy(),lxr=sxr.notificationKinds.NotificationKind;y8.NotificationKind=lxr});var AD=Y(vy=>{_();Object.defineProperty(vy,"__esModule",{value:!0});vy.X10TaskInternal=vy.Subject=vy.Ref=vy.InitializingSubject=void 0;var cxr=br(),dxr=Ol(),fxr=Ai(),pxr=Xv(),fAe=function(){function e(){this.subscribers=[],this.currentSubscription=0}return e.prototype.next=function(r){for(var n=0,a=this.subscribers;n<a.length;n++){var o=a[n],u=o[0],t=o[1];t(r)}},e.prototype.subscribe=function(r){return this.subscribers.push([++this.currentSubscription,r]),this.currentSubscription},e.prototype.unsubscribe=function(r){this.subscribers=this.subscribers.filter(function(n){var a=n[0],o=n[1];return a!==r})},e}();vy.Subject=fAe;var mxr=function(e){(0,cxr.__extends)(r,e);function r(n){var a=e.call(this)||this;return a.initializeSubscriber=n,a}return r.prototype.subscribe=function(n){var a=e.prototype.subscribe.call(this,n);return this.initializeSubscriber().map(n),a},r}(fAe);vy.InitializingSubject=mxr;var gxr=function(){function e(r){this.value=r}return e}();vy.Ref=gxr;var vxr=function(){function e(r,n){this.maybeThenable=r,this.token=n}return e.createToken=function(){return"Do not use outside of x10 scheduler. Resovle by yielding with an 'AwaitTask' / 'AwaitAll' request"},e.prototype.resolve=function(r){return fxr.ulsLogger.ULS.assertTag(508179168,dxr.LogCategory.msoulscat_ES_EWAJS,r===this.token,pxr.x10Logger.formatLogMessage("X10TaskInternal.resolve",{description:"Task is resolving with an invalid token"})),this.maybeThenable},e}();vy.X10TaskInternal=vxr});var ds=Y(Si=>{_();Object.defineProperty(Si,"__esModule",{value:!0});Si.SchedulerVersionCompatibility=Si.SchedulerTimelineQueueMessageKind=Si.ResponseState=Si.RequestKind=Si.FrameExecutionStopReason=Si.ExposedNotificationKinds=Si.ExecutionStopReason=Si.DefaultComputationGroup=Si.ComputationRequestKind=void 0;Si.awaitPromise=Txr;Si.chatGPTRequest=Lxr;Si.closeChatGPTSession=xxr;Si.createChatGPTSession=Dxr;Si.delay=void 0;Si.delayRequest=Oxr;Si.getCellRequest=Exr;Si.getContainingTableRequest=Nxr;Si.getFunctionInfo=wxr;Si.getIntersectingTablesRequest=Axr;Si.getRangeRequest=bxr;Si.getSheetNamesRequest=Pxr;Si.makeRequester=_xr;Si.makeSyncRequester=Rxr;Si.parseCellFormulaRequest=Fxr;Si.parseEditRequest=Ixr;Si.printFormulaRequest=Mxr;Si.sendAugLoopSignal=Bxr;Si.typedRequest=B0;var OD=br(),Fm=ft(),pAe=Fu(),gAe=Ai(),AE=m_(),hxr=Pk(),Sxr=AD(),yxr=Xv(),mAe=Jc(),ete="";Si.DefaultComputationGroup=ete;var Lf={GetSheetNames:"GetSheetNames",GetRange:"GetRange",Delay:"Delay",GetCell:"GetCell",GetContainingTable:"GetContainingTable",UnsafeGetContainingTableName:"UnsafeGetContainingTableName",GetAvailableTableHeaders:"GetAvailableTableHeaders",GetIntersectingTables:"GetIntersectingTables",UnsafeGetIntersectingTableNames:"UnsafeGetIntersectingTableNames",GetStructRefColumn:"GetStructRefColumn",GetStructRefSpecialRef:"GetStructRefSpecialRef",GetIformat:"GetIformat",ParseCellFormula:"ParseCellFormula",ParseEdit:"ParseEdit",ParseNumberFormat:"ParseNumberFormat",PrintFormula:"PrintFormula",GetActiveCell:"GetActiveCell",GetActiveCellFormat:"GetActiveCellFormat",GetConfig:"GetConfig",AwaitPromise:"AwaitPromise",CreateTask:"CreateTask",PromiseToTask:"PromiseToTask",AwaitTask:"AwaitTask",AwaitBatch:"AwaitBatch",AwaitAll:"AwaitAll",AwaitAny:"AwaitAny",GetFunctionsInfo:"GetFunctionsInfo",GetFunctionInfo:"GetFunctionInfo",GetCorrelationId:"GetCorrelationId",SetActiveCell:"SetActiveCell",ParseActiveCell:"ParseActiveCell",GetRichValueFieldListContext:"GetRichValueFieldListContext",GetHiddenRows:"GetHiddenRows",GetHiddenCols:"GetHiddenCols",GetDefinedNamesInfo:"GetDefinedNamesInfo",GetDefinedNameInfo:"GetDefinedNameInfo",ResolveReferences:"ResolveReferences",EvalOnClonedModel:"EvalOnClonedModel",EvalFormula:"EvalFormula",GetCorrespondingSnapshotID:"GetCorrespondingSnapshotID",GetFullTableHeadersFromServer:"GetFullTableHeadersFromServer",CreateChatGPTSession:"CreateChatGPTSession",CloseChatGPTSession:"CloseChatGPTSession",SendChatGPTRequest:"SendChatGPTRequest",IsSchedulerFeatureEnabled:"IsSchedulerFeatureEnabled",SendAugLoopSignal:"SendAugLoopSignal",TriggerEvent:"TriggerEvent",AwaitEvent:"AwaitEvent"};Si.ComputationRequestKind=Lf;(0,Fm.staticAssertExtends)();(0,Fm.staticAssertExtends)();(0,Fm.staticAssertExtends)();(0,Fm.staticAssertExtends)();var Cxr=[AE.NotificationKind.setActiveCell,AE.NotificationKind.doNothing,AE.NotificationKind.setFunctionsInfo,AE.NotificationKind.setDefinedNamesInfo,AE.NotificationKind.notifyWorkbookClosing,AE.NotificationKind.setSchedulerFeatures,AE.NotificationKind.setActiveCellFormat];Si.ExposedNotificationKinds=Cxr;(0,Fm.staticAssertSame)();var kD;Si.RequestKind=kD;(function(e){e.functionSuggestion="functionSuggestion",e.inCellSuggestion="inCellSuggestion",e.formulaHighlighting="formulaHighlighting",e.argumentAssistance="argumentAssistance",e.valuePreview="valuePreview",e.gotoCtrlClick="gotoCtrlClick",e.runExperiment="runExperiment",e.runAuthoringExperiment="runAuthoringExperiment",e.runPerCharacterExperiment="runPerCharacterExperiment",e.runTest="runTest",e.formulaRepair="formulaRepair",e.chatGPTQuery="chatGPTQuery",e.formulaByExample="formulaByExample"})(kD||(Si.RequestKind=kD={}));(0,Fm.staticAssertExtends)();(0,Fm.staticAssertExtends)();(0,Fm.staticAssertExtends)();function _xr(e){var r=function(d){return function(s,c,l){return(0,Fm.isNone)(s)?Promise.resolve(null):Promise.resolve(e.doRequest(d,s,c,l??ete))}};(0,Fm.staticAssertExtends)();for(var n={},a=0,o=(0,Fm.strEnumArray)(kD);a<o.length;a++){var u=o[a];n[u]=r(u)}return n}function Rxr(e){return{formulaHighlighting:function(n,a,o){return(0,Fm.isNone)(n)?null:e.doSyncRequest(kD.formulaHighlighting,n,a,o??ete)}}}function B0(e,r){var n;return(0,OD.__generator)(this,function(a){switch(a.label){case 0:return[4,(0,OD.__assign)({kind:e},r)];case 1:if(n=a.sent(),n.kind==="RequestFailure")throw"RequestFailure: typedRequest got error response";return(0,gAe.assertTrue)("Response kind coincides with request kind",n.kind===e),[2,n]}})}function Txr(e){var r;return(0,OD.__generator)(this,function(n){switch(n.label){case 0:return[4,{kind:Lf.AwaitPromise,promise:e}];case 1:return r=n.sent(),(0,gAe.assertTrue)("Response kind coincides with request kind",r.kind===Lf.AwaitPromise),[2,r.result]}})}function bxr(e){return B0(Lf.GetRange,{range:e})}function Pxr(){return B0(Lf.GetSheetNames,{})}function Exr(e){return B0(Lf.GetCell,{cell:e})}function Nxr(e){return B0(Lf.GetContainingTable,{cell:e})}function Axr(e){return B0(Lf.GetIntersectingTables,{range:e})}function Oxr(){return B0(Lf.Delay,{})}var kxr={kind:Lf.Delay};Si.delay=kxr;function Fxr(e,r,n){return n===void 0&&(n=!1),B0(Lf.ParseCellFormula,{cell:e,formula:r,useEnglishLocaleInfo:n})}function Ixr(e,r){return B0(Lf.ParseEdit,{cell:e,formulaBarText:r})}function Mxr(e,r){return B0(Lf.PrintFormula,{formula:e,origin:r})}function wxr(e){return B0(Lf.GetFunctionInfo,{functionName:e})}function Dxr(e){return B0(Lf.CreateChatGPTSession,{options:e})}function xxr(e){return B0(Lf.CloseChatGPTSession,{session:e})}function Lxr(e,r){return B0(Lf.SendChatGPTRequest,{session:e,request:r})}function Bxr(e){return B0(Lf.SendAugLoopSignal,{signalData:e})}var Jne;Si.SchedulerTimelineQueueMessageKind=Jne;(function(e){e[e.NoOpRequest=0]="NoOpRequest",e[e.AsyncRequest=1]="AsyncRequest",e[e.SyncRequest=2]="SyncRequest",e[e.StepComputation=3]="StepComputation",e[e.StopComputationFrame=4]="StopComputationFrame",e[e.Timeout=5]="Timeout"})(Jne||(Si.SchedulerTimelineQueueMessageKind=Jne={}));var Xne;Si.SchedulerVersionCompatibility=Xne;(function(e){e.Both="Both",e.SyncOnly="SyncOnly"})(Xne||(Si.SchedulerVersionCompatibility=Xne={}));(0,Fm.staticAssertExtends)();(0,Fm.staticAssertExtends)();var C8;Si.FrameExecutionStopReason=C8;(function(e){e.Superseded="Superseded",e.Timeout="Timeout",e.ConflictResolverEarlyTermination="ConflictResolverEarlyTermination"})(C8||(Si.FrameExecutionStopReason=C8={}));var Zne;(function(e){e.Done="Done",e.Exception="Exception"})(Zne||(Zne={}));var qxr="Unknown",$ne={Unknown:qxr,Frame:C8,Computation:Zne};Si.ExecutionStopReason=$ne;var Uxr=function(){function e(r,n){this.computationType=r,this.computationKind=n,this._attachedComputations=[],this._attachedSyncComputations=[],this._computationFrames=new Map,this.resolveCorrelatedRequestsWithNoPluginsEnabled=(0,mAe.isTypedChangeGateEnabled)("OfficeVSO:7536593_resolveCorrelatedRequestsWithNoPlugins"),this.isX10AddComputationGroupsToRequestsEnabled=(0,mAe.isTypedChangeGateEnabled)("OfficeVSO:8151860_x10AddComputationGroupsToRequests")}return e.prototype.computationFrame=function(r){return this.isX10AddComputationGroupsToRequestsEnabled?this._computationFrames.get(r):this._deprecatedComputationFrame},Object.defineProperty(e.prototype,"attachedComputations",{get:function(){return(0,OD.__spreadArray)([],this._attachedComputations,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"attachedSyncComputations",{get:function(){return(0,OD.__spreadArray)([],this._attachedSyncComputations,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numComputations",{get:function(){return this._attachedComputations.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numSyncComputations",{get:function(){return this._attachedSyncComputations.length},enumerable:!1,configurable:!0}),e.prototype.attachComputation=function(r){this._attachedComputations.push(r)},e.prototype.attachSyncComputation=function(r){this._attachedSyncComputations.push(r)},e.prototype.createFrame=function(r,n,a,o,u,t,d){var s=new hxr.ResolvablePromise,c=this.computationKind,l={type:this.computationType,correlationId:r,computationGroup:n,computationInput:a,cache:o,config:u,startTime:t,timeWindow:d,successfulResults:{kind:c,results:[]},resolvable:s,stopReasonRef:new Sxr.Ref($ne.Unknown),numFailures:0,numSkippedComputations:0};return this.isX10AddComputationGroupsToRequestsEnabled?this._computationFrames.set(n,l):this._deprecatedComputationFrame=l,s},e.prototype.closeFrame=function(r,n,a){var o,u=this.computationFrame(r);if(u&&(this.isX10AddComputationGroupsToRequestsEnabled?this._computationFrames.delete(r):this._deprecatedComputationFrame=void 0,u.stopReasonRef.value=n,u.resolvable.resolve(n===$ne.Frame.Superseded?{kind:pAe.PluginSchedulerResultKind.Superseded}:{kind:pAe.PluginSchedulerResultKind.Done,payload:u.successfulResults}),(o=u.cache)===null||o===void 0||o.close(),this.resolveCorrelatedRequestsWithNoPluginsEnabled||this.numComputations>0)){var t=this,d=t.computationKind,s=t.numComputations,c=t.numSyncComputations,l=u.correlationId,f=u.startTime,p=u.numSkippedComputations,m=u.successfulResults,v=m.results.length,h={correlationId:l,type:this.computationType,computationKind:d,computationGroup:r,numComputations:s,numSyncComputations:c,numSent:v,numSkippedComputations:p,stopReason:n,startTime:f,stopTime:a};yxr.x10Logger.log({kind:"closeComputationFrame",payload:h})}},e.prototype.stop=function(r,n,a){this.computationFrame(r)!==void 0&&this.closeFrame(r,n,a)},e}();Si.ResponseState=Uxr});var _8=Y($v=>{_();Object.defineProperty($v,"__esModule",{value:!0});$v.asReadonly=Jxr;$v.bindLazyMethods=Hxr;$v.bindMethods=jxr;$v.bindMethodsUnbox=$v.bindMethodsNullCheck=void 0;$v.functionMapFromDUFunction=Wxr;$v.mapFromArrayOfDependantPairs=yAe;$v.staticTypeHint=Kxr;var Gxr=br(),xg=ft();function Kxr(e){}rte="",xg.staticAssertSame,xg.staticAssertSame,xg.staticAssertSame;var rte;Vxr=void 0,xg.staticAssertSame;var Vxr;function Wxr(e,r){for(var n={},a=function(s){n[s]=function(){for(var c=[],l=0;l<arguments.length;l++)c[l]=arguments[l];return e.apply(void 0,(0,Gxr.__spreadArray)([s],c,!1))}},o=0,u=r;o<u.length;o++){var t=u[o];a(t)}return n}function jxr(e,r){for(var n={},a=function(s){var c=function(){for(var f=[],p=0;p<arguments.length;p++)f[p]=arguments[p];return e[s].apply(e,f)};n[s]=c},o=0,u=r;o<u.length;o++){var t=u[o];a(t)}return n}function Hxr(e,r){for(var n={},a=function(s){var c=function(){for(var f,p=[],m=0;m<arguments.length;m++)p[m]=arguments[m];return(f=e.getValue())[s].apply(f,p)};n[s]=c},o=0,u=r;o<u.length;o++){var t=u[o];a(t)}return n}xg.staticAssertSame,xg.staticAssertSame,xg.staticAssertSame,xg.staticAssertSame;var Qxr=function(){function e(){}return e.prototype.unbox=function(r){return function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return r(n)}},e.prototype.nullcheck=function(r){return function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];for(var o=0,u=n;o<u.length;o++){var t=u[o];if((0,xg.isNone)(t))return null}return r.apply(void 0,n)}},e}();function hAe(e){var r=new Qxr,n=r[e].bind(r);return function(a,o){for(var u={},t=0,d=o;t<d.length;t++){var s=d[t],c=a[s].bind(a);u[s]=n(c)}return u}}var SAe=hAe("unbox");$v.bindMethodsUnbox=SAe;var tte=hAe("nullcheck");$v.bindMethodsNullCheck=tte;nte={methodF:function(r){return r+1},methodG:function(r){var n=r[0];return n+1}},vAe=SAe(nte,["methodG"]),xg.staticAssertSame,zxr=tte(nte,["methodG"]),xg.staticAssertSame,Yxr=tte(vAe,["methodG"]),xg.staticAssertSame;var nte,vAe,zxr,Yxr;function Jxr(e){return e}function yAe(e){return e.reduce(function(r,n){var a=n[0],o=n[1];return r[a]=o,r},{})}var wAn=yAe([["a",1],["b",2]]);xg.staticAssertSame});var _Ae=Y(ute=>{_();Object.defineProperty(ute,"__esModule",{value:!0});ute.makeNotifier=Zxr;var CAe=br(),ote=ft(),Xxr=m_(),ate=ds(),ite=_8();(0,ote.staticAssertExtends)();(0,ote.staticAssertExtends)();(0,ote.staticAssertExtends)();function Zxr(e){var r,n=e.doNotify.bind(e),a=(0,ite.functionMapFromDUFunction)(n,ate.ExposedNotificationKinds),o=(0,ite.bindMethodsUnbox)(a,ate.ExposedNotificationKinds),u=(0,ite.bindMethodsNullCheck)(o,ate.ExposedNotificationKinds),t=(0,CAe.__assign)((0,CAe.__assign)({},u),(r={},r[Xxr.NotificationKind.notifyWorkbookClosing]=function(){return o.notifyWorkbookClosing([])},r));return t}});var Cd=Y(Im=>{_();Object.defineProperty(Im,"__esModule",{value:!0});Im.ProcessNonFormulaCells=void 0;Im.getPluginFactory=r4r;Im.pluginGroupOptInDefault=Im.pluginGroupMap=Im.pluginFactoryKindMap=void 0;Im.registerPluginFactory=n4r;Im.requestKindCellContentNameMap=void 0;var $t=Fu(),RAe=Ai(),N8=tu(),g_=ft(),yi=ds(),$xr=Jc(),ste=Xv(),Ro,R8,T8,b8,P8,E8,q0,CS,e4r=(Ro={},Ro[$t.PluginFactoryName.TestPlugin]=yi.RequestKind.runTest,Ro[$t.PluginFactoryName.PythonTestPlugin]=yi.RequestKind.runTest,Ro[$t.PluginFactoryName.AutocompletePlugin]=yi.RequestKind.functionSuggestion,Ro[$t.PluginFactoryName.AutocompleteRangeSuggestionPlugin]=yi.RequestKind.inCellSuggestion,Ro[$t.PluginFactoryName.DragPlugin]=yi.RequestKind.functionSuggestion,Ro[$t.PluginFactoryName.ConfigTestPlugin]=yi.RequestKind.runTest,Ro[$t.PluginFactoryName.FeatureGateTestPlugin]=yi.RequestKind.runTest,Ro[$t.PluginFactoryName.ChangeGateTestPlugin]=yi.RequestKind.runTest,Ro[$t.PluginFactoryName.ArgumentAssistancePlugin]=yi.RequestKind.argumentAssistance,Ro[$t.PluginFactoryName.FormulaRepairShadowEvalPlugin]=yi.RequestKind.runAuthoringExperiment,Ro[$t.PluginFactoryName.FormulaCollectionPlugin]=yi.RequestKind.functionSuggestion,Ro[$t.PluginFactoryName.DNMTraceTagTestPlugin]=yi.RequestKind.runTest,Ro[$t.PluginFactoryName.AutocompleteWrapperPlugin]=yi.RequestKind.runPerCharacterExperiment,Ro[$t.PluginFactoryName.AutocompleteBinaryModelExperimentPlugin]=yi.RequestKind.runAuthoringExperiment,Ro[$t.PluginFactoryName.ParenthesesCouplingPlugin]=yi.RequestKind.formulaHighlighting,Ro[$t.PluginFactoryName.ColoredReferencesPlugin]=yi.RequestKind.formulaHighlighting,Ro[$t.PluginFactoryName.SlowTestPlugin]=yi.RequestKind.functionSuggestion,Ro[$t.PluginFactoryName.EvalOnCloneTestPlugin]=yi.RequestKind.runTest,Ro[$t.PluginFactoryName.EvalFormulaTestPlugin]=yi.RequestKind.runTest,Ro[$t.PluginFactoryName.AutocompleteFunctionPlugin]=yi.RequestKind.functionSuggestion,Ro[$t.PluginFactoryName.AutocompleteEnumPlugin]=yi.RequestKind.functionSuggestion,Ro[$t.PluginFactoryName.AutocompleteLetPlugin]=yi.RequestKind.functionSuggestion,Ro[$t.PluginFactoryName.AutocompleteRichValuePlugin]=yi.RequestKind.functionSuggestion,Ro[$t.PluginFactoryName.AutocompleteNamedObjectsPlugin]=yi.RequestKind.functionSuggestion,Ro[$t.PluginFactoryName.ParserPerformanceMeasurements]=yi.RequestKind.runExperiment,Ro[$t.PluginFactoryName.AutocompleteTableHeadersPlugin]=yi.RequestKind.functionSuggestion,Ro[$t.PluginFactoryName.PythonAutocompletePlugin]=yi.RequestKind.functionSuggestion,Ro[$t.PluginFactoryName.ValuePreviewPlugin]=yi.RequestKind.valuePreview,Ro[$t.PluginFactoryName.GotoCtrlClickPlugin]=yi.RequestKind.gotoCtrlClick,Ro[$t.PluginFactoryName.SyntaxErrorsPlugin]=yi.RequestKind.formulaRepair,Ro[$t.PluginFactoryName.ChatGPTPlugin]=yi.RequestKind.chatGPTQuery,Ro[$t.PluginFactoryName.EventsTestPlugin]=yi.RequestKind.runTest,Ro[$t.PluginFactoryName.FormulaByExamplePlugin]=yi.RequestKind.formulaByExample,Ro);Im.pluginFactoryKindMap=e4r;(0,g_.staticAssertExtends)();(0,g_.staticAssertExtends)();(0,g_.staticAssertExtends)();var qAn=(R8={},R8[$t.PluginFactoryName.ParenthesesCouplingPlugin]=yi.SchedulerVersionCompatibility.SyncOnly,R8[$t.PluginFactoryName.ColoredReferencesPlugin]=yi.SchedulerVersionCompatibility.SyncOnly,R8);(0,g_.staticAssertExtends)();(0,g_.staticAssertExtends)();var lte=(0,g_.makeStringMap)();function r4r(e){var r=lte[e];if(!r){var n=ste.x10Logger.formatLogMessage("getPluginFactory",{description:"".concat($t.PluginFactoryName[e]," has not been registered")});throw RAe.ulsLogger.ULS.traceTag(557056858,N8.LogCategory.msoulscat_ES_EWAJS,N8.TraceLevel.Error,n),new Error(n)}return r}function n4r(e){var r=e.factoryName,n=lte[r];if(n!==void 0&&n!==e){var a=ste.x10Logger.formatLogMessage("registerPluginFactory",{description:"".concat($t.PluginFactoryName[r]," is already registered")});if(RAe.ulsLogger.ULS.traceTag(557056859,N8.LogCategory.msoulscat_ES_EWAJS,N8.TraceLevel.Error,a),!(0,$xr.getTypedFeatureGate)("Microsoft.Office.Excel.x10DoNotThrowOnDoublePluginRegistration"))throw new Error(a)}lte[r]=e,ste.x10Logger.log({kind:"registerPluginFactory",payload:{factoryName:r}})}var t4r=(T8={},T8[$t.PluginGroup.Excel]=!0,T8[$t.PluginGroup.Python]=!1,T8);Im.pluginGroupOptInDefault=t4r;(0,g_.staticAssertExtends)();var a4r=(b8={},b8[$t.PluginGroup.Excel]=(P8={},P8[$t.PluginFactoryName.PythonTestPlugin]=!1,P8[$t.PluginFactoryName.PythonAutocompletePlugin]=!1,P8),b8[$t.PluginGroup.Python]=(E8={},E8[$t.PluginFactoryName.PythonTestPlugin]=!0,E8[$t.PluginFactoryName.PythonAutocompletePlugin]=!0,E8),b8);Im.pluginGroupMap=a4r;var i4r=(q0={},q0[$t.PluginFactoryName.TestPlugin]=!0,q0[$t.PluginFactoryName.ParserPerformanceMeasurements]=!0,q0[$t.PluginFactoryName.ConfigTestPlugin]=!0,q0[$t.PluginFactoryName.FeatureGateTestPlugin]=!0,q0[$t.PluginFactoryName.DNMTraceTagTestPlugin]=!0,q0[$t.PluginFactoryName.ChangeGateTestPlugin]=!0,q0[$t.PluginFactoryName.SlowTestPlugin]=!0,q0[$t.PluginFactoryName.EvalOnCloneTestPlugin]=!0,q0[$t.PluginFactoryName.EvalFormulaTestPlugin]=!0,q0[$t.PluginFactoryName.PythonTestPlugin]=!0,q0[$t.PluginFactoryName.ChatGPTPlugin]=!0,q0[$t.PluginFactoryName.EventsTestPlugin]=!0,q0[$t.PluginFactoryName.FormulaByExamplePlugin]=!0,q0);Im.ProcessNonFormulaCells=i4r;g_.staticAssertSame;var o4r=(CS={},CS[yi.RequestKind.functionSuggestion]="content",CS[yi.RequestKind.inCellSuggestion]="content",CS[yi.RequestKind.formulaHighlighting]="content",CS[yi.RequestKind.argumentAssistance]="content",CS[yi.RequestKind.valuePreview]="text",CS[yi.RequestKind.runAuthoringExperiment]="content",CS[yi.RequestKind.runPerCharacterExperiment]="content",CS[yi.RequestKind.formulaRepair]="formula",CS[yi.RequestKind.gotoCtrlClick]="text",CS);Im.requestKindCellContentNameMap=o4r;g_.staticAssertSame});var FD=Y(Dk=>{_();Object.defineProperty(Dk,"__esModule",{value:!0});Dk.defaultTimerInterface=Dk.TimelineQueueProcessor=void 0;var TAe=fy(),u4r=TAe.timelineQueueProcessor.TimelineQueueProcessor;Dk.TimelineQueueProcessor=u4r;var s4r=TAe.timelineQueueProcessor.defaultTimerInterface;Dk.defaultTimerInterface=s4r});var eh=Y(Mm=>{_();Object.defineProperty(Mm,"__esModule",{value:!0});Mm.SuggestionKind=Mm.RepairItemPartType=Mm.DiagnosticTag=Mm.DiagnosticSeverity=Mm.CompletionItemKind=Mm.CodeActionKind=void 0;var xk=fy(),l4r=xk.formulaAssistanceModule.CompletionItemKind;Mm.CompletionItemKind=l4r;var c4r=xk.formulaAssistanceModule.SuggestionKind;Mm.SuggestionKind=c4r;var d4r=xk.formulaAssistanceModule.DiagnosticSeverity;Mm.DiagnosticSeverity=d4r;var f4r=xk.formulaAssistanceModule.DiagnosticTag;Mm.DiagnosticTag=f4r;var p4r=xk.formulaAssistanceModule.CodeActionKind;Mm.CodeActionKind=p4r;var m4r=xk.formulaAssistanceModule.RepairItemPartType;Mm.RepairItemPartType=m4r});var FT=Y(v_=>{_();Object.defineProperty(v_,"__esModule",{value:!0});v_.endOf=void 0;v_.filterSuggestionsAccordingToPrefix=h4r;v_.verifyTextAndRange=v_.getStructRefCompletionItemRank=void 0;var bAe=Ol(),g4r=Ai(),PAe=ft(),v4r=eh();function h4r(e,r,n,a){a===void 0&&(a=!1);var o=[],u=[],t=e.toLocaleLowerCase();return e===""?{prefixedSuggestions:r,notPrefixedSuggestions:u}:(r.forEach(function(d){var s=n?n(d).toLocaleLowerCase():typeof d=="string"?d.toLocaleLowerCase():void 0;if(s!==void 0)if(s.startsWith(t)&&(!a||s!==t))o.push(d);else if(a){var c=s.split(" ");(0,PAe.isDefined)(c.find(function(l){return l.startsWith(t)}))&&u.push(d)}else t.length>2&&s.includes(t)&&u.push(d)}),{prefixedSuggestions:o,notPrefixedSuggestions:u})}var S4r=function(r,n,a,o){var u,t,d,s,c,l,f;expect(r==null?void 0:r.label).toEqual(n),expect((u=r==null?void 0:r.textEdit)===null||u===void 0?void 0:u.newText).toEqual(n),expect((s=(d=(t=r==null?void 0:r.textEdit)===null||t===void 0?void 0:t.range)===null||d===void 0?void 0:d.start)===null||s===void 0?void 0:s.character).toEqual(a),expect((f=(l=(c=r==null?void 0:r.textEdit)===null||c===void 0?void 0:c.range)===null||l===void 0?void 0:l.end)===null||f===void 0?void 0:f.character).toEqual(o)};v_.verifyTextAndRange=S4r;var y4r=function(r){return r.length};v_.endOf=y4r;var C4r=function(r){var n,a,o,u,t=r.kind===v4r.CompletionItemKind.TableHeader?1:(a=(n=r.label)===null||n===void 0?void 0:n.startsWith("#"))!==null&&a!==void 0&&a?0:(u=(o=r.label)===null||o===void 0?void 0:o.startsWith("@"))!==null&&u!==void 0&&u?2:void 0;return(0,PAe.isNone)(t)?(g4r.ulsLogger.ULS.traceTag(526411872,bAe.LogCategory.msoulscat_ES_EWAJS,bAe.TraceLevel.Warning,"conflictResolver: trying to rank a structRef completion item with unexpected fields. item = ".concat(JSON.stringify(r))),0):t};v_.getStructRefCompletionItemRank=C4r});var cte=Y(hy=>{_();Object.defineProperty(hy,"__esModule",{value:!0});hy.spanToLSPRange=hy.spanCompare=hy.indexToLSPPosition=hy.Timeline=void 0;var A8=fy(),_4r=A8.helpers.Timeline;hy.Timeline=_4r;var R4r=A8.helpers.indexToLSPPosition;hy.indexToLSPPosition=R4r;var T4r=A8.helpers.spanToLSPRange;hy.spanToLSPRange=T4r;var b4r=A8.helpers.spanCompare;hy.spanCompare=b4r});var AAe=Y(k8=>{_();Object.defineProperty(k8,"__esModule",{value:!0});k8.conflictResolver=void 0;var h_=br(),fs=ft(),P4r=Cd(),rh=Fu(),IT=eh(),E4r=Ai(),EAe=FT(),N4r=cte(),A4r={runTest:O8,runExperiment:O8,runAuthoringExperiment:O8,runPerCharacterExperiment:O8,argumentAssistance:Lk,valuePreview:Lk,gotoCtrlClick:Lk,formulaRepair:Lk,chatGPTQuery:Lk,formulaByExample:Lk,inCellSuggestion:function(r){for(var n=0,a=r;n<a.length;n++){var o=a[n],u=o[0],t=o[1];if(u===rh.PluginFactoryName.AutocompleteRangeSuggestionPlugin&&(0,fs.isDefined)(t))return t}return null},formulaHighlighting:function(r){var n;if(r.length>0){for(var a=[],o=0,u=r;o<u.length;o++){var t=u[o],d=t[0],s=t[1],c=(n=s.formulaHighlights)===null||n===void 0?void 0:n.filter(fs.isDefined);c!==void 0&&(a=a.concat(c))}var l=function(p,m){return(0,fs.isDefined)(p.span)&&(0,fs.isDefined)(m.span)?(0,N4r.spanCompare)(p.span,m.span):(0,fs.isDefined)(p)?1:(0,fs.isDefined)(m)?-1:0};return a.sort(l),{formulaHighlights:a}}return null},functionSuggestion:function(r){var n=[],a=[],o=[],u=void 0,t=r.filter(function(h){var S=h[0];return m(S)==="enum"});if(t.forEach(function(h){var S=h[0],y=h[1];(0,fs.isDefined)(y.items)&&y.items.filter(fs.isDefined).filter(function(C){return(0,fs.isDefined)(C.textEdit)||(0,fs.isDefined)(C.label)}).forEach(function(C){return o.push((0,h_.__assign)((0,h_.__assign)({},C),{type:IT.SuggestionKind.Simple}))})}),o.length>0)return{items:(0,h_.__spreadArray)([],o,!0),data:u};for(var d=0,s=r;d<s.length;d++){var c=s[d],l=c[0],f=c[1],p=m(l);p===IT.SuggestionKind.Smart?((0,fs.isDefined)(f.items)&&f.items.filter(fs.isDefined).filter(function(h){return(0,fs.isDefined)(h.textEdit)||(0,fs.isDefined)(h.label)}).forEach(function(h){return n.push((0,h_.__assign)((0,h_.__assign)({},h),{type:IT.SuggestionKind.Smart}))}),(0,fs.isDefined)(f.data)&&(u=f.data)):(0,fs.isDefined)(f.items)&&f.items.filter(fs.isDefined).filter(function(h){return(0,fs.isDefined)(h.textEdit)||(0,fs.isDefined)(h.label)}).forEach(function(h){return a.push((0,h_.__assign)((0,h_.__assign)({},h),{type:IT.SuggestionKind.Simple}))})}return{items:(0,h_.__spreadArray)((0,h_.__spreadArray)([],n,!0),a.sort(v),!0),data:u};function m(h){switch(h){case rh.PluginFactoryName.AutocompletePlugin:case rh.PluginFactoryName.FormulaCollectionPlugin:return IT.SuggestionKind.Smart;case rh.PluginFactoryName.DragPlugin:case rh.PluginFactoryName.SlowTestPlugin:case rh.PluginFactoryName.AutocompleteFunctionPlugin:case rh.PluginFactoryName.AutocompleteLetPlugin:case rh.PluginFactoryName.AutocompleteRichValuePlugin:case rh.PluginFactoryName.AutocompleteNamedObjectsPlugin:case rh.PluginFactoryName.AutocompleteTableHeadersPlugin:case rh.PluginFactoryName.PythonAutocompletePlugin:return IT.SuggestionKind.Simple;case rh.PluginFactoryName.AutocompleteEnumPlugin:return"enum";default:(0,E4r.assertNever)("unknown plugin factory name: ".concat(h),h)}}function v(h,S){if((0,fs.isDefined)(h.label)&&(0,fs.isDefined)(S.label)){if((0,fs.isDefined)(h.isPrefixed)&&(0,fs.isDefined)(S.isPrefixed)&&h.isPrefixed!==S.isPrefixed)return h.isPrefixed?-1:1;if(NAe.includes(h.kind)&&NAe.includes(S.kind)){var y=(0,EAe.getStructRefCompletionItemRank)(h),C=(0,EAe.getStructRefCompletionItemRank)(S);if(y!==C)return C-y}return h.label.toLocaleLowerCase()>S.label.toLocaleLowerCase()?1:-1}return(0,fs.isDefined)(h.label)?1:(0,fs.isDefined)(S.label)?-1:0}}};k8.conflictResolver=A4r;var NAe=[IT.CompletionItemKind.TableHeader,IT.CompletionItemKind.TableSpecialStructRef];(0,fs.staticAssertExtends)();function O8(e){for(var r=[],n=0,a=e;n<a.length;n++){var o=a[n],u=o[0],t=o[1].results;(0,fs.isDefined)(t)&&r.push.apply(r,t.filter(fs.isDefined))}return{results:r}}function Lk(e){if(e.length===0)return null;if(e.length===1)return e[0][1];var r=P4r.pluginFactoryKindMap[e[0][0]];throw new Error("Conflict resolver: ".concat(r,": ").concat(e.length," results received, while only one active plugin is currently supported"))}});var fte=Y(MT=>{_();Object.defineProperty(MT,"__esModule",{value:!0});MT.customConflictResolverPluginKinds=MT.CustomConflictResolverStrategy=void 0;MT.makeBatchRequester=k4r;var F8=ds(),S_=ft(),dte,ID;MT.CustomConflictResolverStrategy=ID;(function(e){e.FunctionSuggestionAndArgumentAssistance="FunctionSuggestionAndArgumentAssistance"})(ID||(MT.CustomConflictResolverStrategy=ID={}));var O4r=(dte={},dte[ID.FunctionSuggestionAndArgumentAssistance]=[F8.RequestKind.functionSuggestion,F8.RequestKind.argumentAssistance,F8.RequestKind.inCellSuggestion],dte);MT.customConflictResolverPluginKinds=O4r;function k4r(e){return{functionSuggestionAndArgumentAssistance:function(n,a,o){if((0,S_.isNone)(n))return Promise.resolve(null);var u=n.functionSuggestion,t=n.argumentAssistance,d=n.inCellSuggestion;return(0,S_.isNone)(u)||(0,S_.isNone)(t)||(0,S_.isNone)(d)?Promise.resolve(null):e.doBatchRequest({strategy:ID.FunctionSuggestionAndArgumentAssistance,functionSuggestion:u,argumentAssistance:t,inCellSuggestion:d},a,o??F8.DefaultComputationGroup)}}}(0,S_.staticAssertExtends)();(0,S_.staticAssertExtends)();(0,S_.staticAssertExtends)();(0,S_.staticAssertExtends)();(0,S_.staticAssertExtends)()});var FAe=Y(Uk=>{_();Object.defineProperty(Uk,"__esModule",{value:!0});Uk.customConflictResolverFactories=Uk.FunctionSuggestionAndArgumentAssistanceConflictResolver=void 0;var F4r=fte(),qk=ft(),I4r=Pk(),Bk=ds(),y_=Ai(),OAe=eh(),M4r=Ql(),pte,kAe=function(){function e(){this.argumentAssistanceResult=null,this.functionSuggestionResult=null,this.inCellSuggestionResult=null,this.argumentAssistanceSet=!1,this.functionSuggestionSet=!1,this.inCellSuggestionSet=!1,this.promise=new I4r.ResolvablePromise}return e.prototype.consumeResult=function(r){var n;if((0,M4r.isChangeGateEnabled)("OfficeVSO:7640530_InCellSuggestionRequestResolverEnabledV2"))switch(r.kind){case Bk.RequestKind.functionSuggestion:(0,y_.assertTrue)("functionSuggestionSet should be false when receiving functionSuggestion request",!this.functionSuggestionSet),this.functionSuggestionResult=r.result,this.functionSuggestionSet=!0,this.resolvePromiseIfPossible();break;case Bk.RequestKind.argumentAssistance:(0,y_.assertTrue)("argumentAssistanceSet should be false when receiving argumentAssistance request",!this.argumentAssistanceSet),this.argumentAssistanceResult=r.result,this.argumentAssistanceSet=!0,this.resolvePromiseIfPossible();break;case Bk.RequestKind.inCellSuggestion:(0,y_.assertTrue)("inCellSuggestionSet should be false when receiving inCellSuggestion request",!this.inCellSuggestionSet),this.inCellSuggestionResult=r.result,this.inCellSuggestionSet=!0,this.resolvePromiseIfPossible();break;default:(0,y_.assertNever)("unknown result: ".concat(r),r)}else switch(r.kind){case Bk.RequestKind.functionSuggestion:if((0,y_.assertTrue)("functionSuggestionSet should be false when receiving functionSuggestion request",!this.functionSuggestionSet),(0,qk.isDefined)(r.result)&&(0,qk.isDefined)(r.result.items)&&r.result.items.length>0&&((n=r.result.items[r.result.items.length-1])===null||n===void 0?void 0:n.type)===OAe.SuggestionKind.Simple)return this.promise.resolve({functionSuggestion:r.result,argumentAssistance:null,inCellSuggestion:null});if(this.argumentAssistanceSet)return this.argumentAssistanceResult!==null?this.promise.resolve({functionSuggestion:null,argumentAssistance:this.argumentAssistanceResult,inCellSuggestion:null}):this.promise.resolve({functionSuggestion:r.result,argumentAssistance:null,inCellSuggestion:null});this.functionSuggestionResult=r.result,this.functionSuggestionSet=!0;break;case Bk.RequestKind.argumentAssistance:if((0,y_.assertTrue)("argumentAssistanceSet should be false when receiving argumentAssistance request",!this.argumentAssistanceSet),this.functionSuggestionSet)return r.result!==null?this.promise.resolve({functionSuggestion:null,argumentAssistance:r.result,inCellSuggestion:null}):this.promise.resolve({functionSuggestion:this.functionSuggestionResult,argumentAssistance:null,inCellSuggestion:null});this.argumentAssistanceResult=r.result,this.argumentAssistanceSet=!0;break;case Bk.RequestKind.inCellSuggestion:break;default:(0,y_.assertNever)("unknown result: ".concat(r),r)}},e.create=function(){return new e},e.prototype.resolvePromiseIfPossible=function(){var r,n;if(this.functionSuggestionSet){if((0,qk.isDefined)(this.functionSuggestionResult)&&(0,qk.isDefined)(this.functionSuggestionResult.items)&&this.functionSuggestionResult.items.length>0)return((r=this.functionSuggestionResult.items[length-1])===null||r===void 0?void 0:r.type)===OAe.SuggestionKind.Smart&&((0,y_.assertTrue)("can't get argument assistance and smart suggestion at the same time",!this.argumentAssistanceSet||this.argumentAssistanceResult==null),(0,y_.assertTrue)("can't get in cell suggestion and smart suggestion at the same time",!this.inCellSuggestionSet||((n=this.inCellSuggestionResult)===null||n===void 0?void 0:n.completionItem)==null)),this.promise.resolve({functionSuggestion:this.functionSuggestionResult,argumentAssistance:null,inCellSuggestion:null});if(this.argumentAssistanceSet&&this.inCellSuggestionSet)return this.promise.resolve({functionSuggestion:this.functionSuggestionResult,argumentAssistance:this.argumentAssistanceResult,inCellSuggestion:this.inCellSuggestionResult})}},e}();Uk.FunctionSuggestionAndArgumentAssistanceConflictResolver=kAe;(0,qk.staticAssertExtends)();var w4r=(pte={},pte[F4r.CustomConflictResolverStrategy.FunctionSuggestionAndArgumentAssistance]=kAe,pte);Uk.customConflictResolverFactories=w4r;(0,qk.staticAssertExtends)()});var mte=Y(M8=>{_();Object.defineProperty(M8,"__esModule",{value:!0});M8.defaultPluginResponseWindows=void 0;var Lg=ds(),I8=ft(),U0,D4r=(U0={},U0[Lg.RequestKind.functionSuggestion]={startDelta:5,stopDelta:2e3},U0[Lg.RequestKind.inCellSuggestion]={startDelta:5,stopDelta:2e3},U0[Lg.RequestKind.formulaHighlighting]={startDelta:5,stopDelta:2e3},U0[Lg.RequestKind.argumentAssistance]={startDelta:5,stopDelta:2e3},U0[Lg.RequestKind.valuePreview]={startDelta:5,stopDelta:2e3},U0[Lg.RequestKind.gotoCtrlClick]={startDelta:5,stopDelta:2e3},U0[Lg.RequestKind.formulaRepair]={startDelta:5,stopDelta:2e3},U0[Lg.RequestKind.runExperiment]={startDelta:0,stopDelta:15e3},U0[Lg.RequestKind.runAuthoringExperiment]={startDelta:0,stopDelta:15e3},U0[Lg.RequestKind.runPerCharacterExperiment]={startDelta:5,stopDelta:2e3},U0[Lg.RequestKind.runTest]={startDelta:0,stopDelta:15e3},U0[Lg.RequestKind.chatGPTQuery]={startDelta:0,stopDelta:15e3},U0[Lg.RequestKind.formulaByExample]={startDelta:0,stopDelta:2e3},U0);M8.defaultPluginResponseWindows=D4r;(0,I8.staticAssertExtends)();(0,I8.staticAssertExtends)();(0,I8.staticAssertExtends)();(0,I8.staticAssertExtends)()});var gte=Y(w8=>{_();Object.defineProperty(w8,"__esModule",{value:!0});w8.functionShortDescriptions=void 0;var IAe=sg(),x4r=cu(),L4r=Ai(),MAe=Ol(),B4r=new x4r.ResettableLazy(function(){try{for(var e=new Map,r=new Map,n=0,a=Object.keys(IAe.WorksheetFuncId);n<a.length;n++){var o=a[n],u=Number(o);if(!isNaN(Number(u))){var t=FormulaAuthoringStrings[IAe.WorksheetFuncId[u]+"ShortDescription"];e.set(u,t),r.set(u.toString(),t)}}return{descriptionsMap:e,descriptionMap:r}}catch(d){return L4r.ulsLogger.ULS.traceTag(538792415,MAe.LogCategory.msoulscat_ES_EWAJS,MAe.TraceLevel.Info,"failed to get functionShortDescriptionsMap with exception ".concat(d)),{}}});w8.functionShortDescriptions=B4r});var DAe=Y(OE=>{_();Object.defineProperty(OE,"__esModule",{value:!0});OE.InternalSchedulerResponseKind=void 0;OE.wrapRequest=U4r;OE.wrapSyncRequest=wAe;var q4r=Ai(),MD=ft(),wa=ds(),vte;OE.InternalSchedulerResponseKind=vte;(function(e){e[e.FirstStep=0]="FirstStep",e[e.NormalResponse=1]="NormalResponse",e[e.RequestFailure=2]="RequestFailure",e[e.AsyncException=3]="AsyncException"})(vte||(OE.InternalSchedulerResponseKind=vte={}));(0,MD.staticAssertExtends)();function wAe(e,r){switch(e.kind){case wa.ComputationRequestKind.Delay:case wa.ComputationRequestKind.CreateTask:case wa.ComputationRequestKind.PromiseToTask:case wa.ComputationRequestKind.GetActiveCell:case wa.ComputationRequestKind.GetActiveCellFormat:case wa.ComputationRequestKind.GetConfig:case wa.ComputationRequestKind.GetCorrelationId:case wa.ComputationRequestKind.GetFunctionInfo:case wa.ComputationRequestKind.GetFunctionsInfo:case wa.ComputationRequestKind.GetDefinedNameInfo:case wa.ComputationRequestKind.GetDefinedNamesInfo:case wa.ComputationRequestKind.SetActiveCell:case wa.ComputationRequestKind.IsSchedulerFeatureEnabled:case wa.ComputationRequestKind.TriggerEvent:return{kind:wa.SchedulerTimelineQueueMessageKind.NoOpRequest,request:e,computation:r};case wa.ComputationRequestKind.GetSheetNames:case wa.ComputationRequestKind.GetAvailableTableHeaders:case wa.ComputationRequestKind.ParseCellFormula:case wa.ComputationRequestKind.ParseNumberFormat:case wa.ComputationRequestKind.PrintFormula:case wa.ComputationRequestKind.ParseActiveCell:case wa.ComputationRequestKind.ResolveReferences:case wa.ComputationRequestKind.UnsafeGetContainingTableName:case wa.ComputationRequestKind.UnsafeGetIntersectingTableNames:case wa.ComputationRequestKind.GetStructRefColumn:case wa.ComputationRequestKind.GetStructRefSpecialRef:return{kind:wa.SchedulerTimelineQueueMessageKind.SyncRequest,request:e,computation:r};default:(0,q4r.assertNever)("unknown request: ".concat(e),e)}}function U4r(e,r){switch(e.kind){case wa.ComputationRequestKind.GetRange:case wa.ComputationRequestKind.GetCell:case wa.ComputationRequestKind.GetContainingTable:case wa.ComputationRequestKind.GetIntersectingTables:case wa.ComputationRequestKind.GetIformat:case wa.ComputationRequestKind.AwaitPromise:case wa.ComputationRequestKind.AwaitTask:case wa.ComputationRequestKind.AwaitBatch:case wa.ComputationRequestKind.AwaitAll:case wa.ComputationRequestKind.AwaitAny:case wa.ComputationRequestKind.ParseEdit:case wa.ComputationRequestKind.GetRichValueFieldListContext:case wa.ComputationRequestKind.GetHiddenRows:case wa.ComputationRequestKind.GetHiddenCols:case wa.ComputationRequestKind.EvalOnClonedModel:case wa.ComputationRequestKind.EvalFormula:case wa.ComputationRequestKind.GetCorrespondingSnapshotID:case wa.ComputationRequestKind.GetFullTableHeadersFromServer:case wa.ComputationRequestKind.CreateChatGPTSession:case wa.ComputationRequestKind.CloseChatGPTSession:case wa.ComputationRequestKind.SendChatGPTRequest:case wa.ComputationRequestKind.SendAugLoopSignal:case wa.ComputationRequestKind.AwaitEvent:return{kind:wa.SchedulerTimelineQueueMessageKind.AsyncRequest,request:e,computation:r};default:return wAe(e,r)}}(0,MD.staticAssertExtends)();(0,MD.staticAssertExtends)();(0,MD.staticAssertExtends)();(0,MD.staticAssertExtends)()});var DD=Y(Bg=>{_();Object.defineProperty(Bg,"__esModule",{value:!0});Bg.caretInSpanScope=Y4r;Bg.createNameToDefinedNameInfoMapping=H4r;Bg.findFieldRefSourceLhs=qAe;Bg.getAbsolutePosition=_S;Bg.getNamePartIfExists=Q4r;Bg.getRangeFromCellRef=j4r;Bg.getSheetIndexFromQualifier=W4r;Bg.getSheetIndexFromSheetName=LAe;Bg.getSheetNameFromQualifier=BAe;Bg.isValidCellRef=V4r;Bg.sheetIndexToSheetName=z4r;var nh=Qu(),wD=ft(),G4r=Ql(),K4r=zu(),xAe=function(){function e(){}return e.MaxRow=1048575,e.MaxColumn=16383,e}();function V4r(e){return(0,G4r.isChangeGateEnabled)("OfficeVSO:7898117_addValidityCheckBeforeConstructingRange")?e.kind!==nh.CellRefKind.Bad&&e.kind!==nh.CellRefKind.Error:!0}function LAe(e,r){var n=r.nameToIndex.getValue(e);if((0,wD.isDefined)(n))return r.sheets[n].sheetIndex}function W4r(e,r,n){var a=BAe(e,n);return LAe(a,r)}function BAe(e,r){return e.kind===nh.QualifierKind.Sheet?e.sheet:e.kind===nh.QualifierKind.Ident?e.name:((0,wD.isDefined)(r)&&r("getSheetNameFromQualifier unexpected qualifier kind: ".concat(e.kind)),"")}function j4r(e,r,n){switch(e.kind){case nh.CellRefKind.Single:{var a=_S(e.row,r.row),o=_S(e.col,r.col);return{firstRow:a,firstColumn:o,lastRow:a,lastColumn:o}}case nh.CellRefKind.Range:return{firstRow:_S(e.ref1.row,r.row),firstColumn:_S(e.ref1.col,r.col),lastRow:_S(e.ref2.row,r.row),lastColumn:_S(e.ref2.col,r.col)};case nh.CellRefKind.Col:return{firstRow:0,firstColumn:_S(e.col1,r.col),lastRow:xAe.MaxRow,lastColumn:_S(e.col2,r.col)};case nh.CellRefKind.Row:return{firstRow:_S(e.row1,r.row),firstColumn:0,lastRow:_S(e.row2,r.row),lastColumn:xAe.MaxColumn};default:(0,wD.isDefined)(n)&&n("getRangeFromCellRef unexpected CellRefKind: ".concat(e.kind))}}function H4r(e){var r=new Map;return e.forEach(function(n){(0,wD.isDefined)(n.name)&&r.set(n.name.toLocaleLowerCase(),n)}),r}function Q4r(e,r){var n=r.get(e.asWhole.toLocaleLowerCase());if(n!==void 0&&n.type!==-1)return n}function _S(e,r){return e.index+(e.kind===nh.PosKind.Rel?r:0)}function z4r(e,r){var n=r.sheets.findIndex(function(a){return(0,K4r.isSheetIndexEqual)(a.sheetIndex,e)});if(n!==-1)return r.sheets[n].sheetName}function Y4r(e,r){return(0,wD.isDefined)(r)&&e>=r.start&&e<=r.end}function qAe(e){switch(e.kind){case nh.NamePartKind.CellRefNamePart:case nh.NamePartKind.IdentNamePart:return e;case nh.NamePartKind.FieldRefNamePart:return qAe(e.lhs)}}});var x8=Y(xD=>{_();Object.defineProperty(xD,"__esModule",{value:!0});xD.getPositionKindInfoFromCellRef=Z4r;xD.gridRangeToRange=J4r;xD.spanCompare=X4r;var Gk=Fu(),D8=Qu(),Sy={Abs:Gk.PositionKind.Absolute,Rel:Gk.PositionKind.Relative};function J4r(e){var r=e.row,n=e.col;return{firstRow:r,firstColumn:n,lastRow:r+e.rows-1,lastColumn:n+e.cols-1}}function X4r(e,r){var n;return(n=e.start-r.start)!==0||(n=r.end-e.end)!==0?n:0}function Z4r(e){switch(e.kind){case D8.CellRefKind.Col:return nLr(e);case D8.CellRefKind.Row:return rLr(e);case D8.CellRefKind.Single:return eLr(e);case D8.CellRefKind.Range:return $4r(e)}}function $4r(e){return{firstRow:Sy[e.ref1.row.kind],firstColumn:Sy[e.ref1.col.kind],secondRow:Sy[e.ref2.row.kind],secondColumn:Sy[e.ref2.col.kind]}}function eLr(e){var r,n;return{firstRow:r=Sy[e.row.kind],firstColumn:n=Sy[e.col.kind],secondRow:r,secondColumn:n}}function rLr(e){return{firstRow:Sy[e.row1.kind],firstColumn:Gk.PositionKind.Relative,secondRow:Sy[e.row2.kind],secondColumn:Gk.PositionKind.Relative}}function nLr(e){return{firstRow:Gk.PositionKind.Relative,firstColumn:Sy[e.col1.kind],secondRow:Gk.PositionKind.Relative,secondColumn:Sy[e.col2.kind]}}});var Vk=Y(wT=>{_();Object.defineProperty(wT,"__esModule",{value:!0});wT.getRangeFromDefinedName=UAe;wT.getSharedSheetRangeFromResolvedRef=uLr;wT.getSheetRangeFromDefinedNameInfo=iLr;wT.sheetRangeFromCellRef=oLr;wT.toSharedRange=lLr;wT.toSharedSheetRange=sLr;var Kk=br(),L8=ft(),B8=DD(),tLr=Di(),aLr=x8();function UAe(e){var r=e.namedRange;if(!(r==null||e.type===-1)){var n=e.type===0?1:0;if(r.bottom&&r.top&&r.right&&r.left)return{firstRow:r.top+n-1,firstColumn:r.left-1,lastRow:r.bottom-1,lastColumn:r.right-1}}}function iLr(e,r){var n=UAe(e);if((0,L8.isDefined)(n)){var a=(0,L8.isDefined)(e.sheetName)?e.sheetName:r?(0,B8.getSheetNameFromQualifier)(r):"";return(0,Kk.__assign)((0,Kk.__assign)({},n),{sheetName:a,namedObjectName:(0,L8.isDefined)(e.name)?e.name:""})}}function oLr(e,r,n,a){var o=(0,B8.getRangeFromCellRef)(e,n,a);if((0,L8.isDefined)(o))return(0,Kk.__assign)((0,Kk.__assign)({},o),{sheetName:r?(0,B8.getSheetNameFromQualifier)(r):"",namedObjectName:""})}function uLr(e,r,n){var a;if(!(0,tLr.isSuccess)(r.resolution)){n==null||n("failed to resolve StructRef, reason: ".concat(r.resolution.reason));return}if(r.resolution.value===void 0){n==null||n("failed to resolve StructRef, resolution value undefined");return}var o=r.resolution.value,u=(a=(0,B8.sheetIndexToSheetName)(o.sheet,e))!==null&&a!==void 0?a:"";return(0,Kk.__assign)((0,Kk.__assign)({},(0,aLr.gridRangeToRange)(o.range)),{sheetName:u,namedObjectName:r.node.lhs?r.node.lhs.whole:""})}function sLr(e){return{FirstColumn:e.firstColumn,FirstRow:e.firstRow,LastColumn:e.lastColumn,LastRow:e.lastRow,NamedObjectName:e.namedObjectName,SheetName:e.sheetName}}function lLr(e){return{FirstColumn:e.firstColumn,FirstRow:e.firstRow,LastColumn:e.lastColumn,LastRow:e.lastRow}}});var VAe=Y(jk=>{_();Object.defineProperty(jk,"__esModule",{value:!0});jk.processRequest=mLr;jk.processSyncRequest=gLr;jk.requestProcessorMap=void 0;var Na=br(),kE=ft(),hte=Ok(),ln=Di(),th=tu(),GAe=gs(),cLr=r3(),KAe=n3(),ei=ds(),dLr=zu(),q8=Xv(),fLr=Vk(),Ste=AD(),Ga,Wk=Ste.X10TaskInternal.createToken();function U8(e,r){return e.kind===ln.ResultKind.Failure?e:(0,ln.success)(r(e.value))}function G8(e){return(0,Na.__awaiter)(this,void 0,void 0,function(){var r,n;return(0,Na.__generator)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),r=ln.success,[4,e];case 1:return[2,r.apply(void 0,[a.sent()])];case 2:return n=a.sent(),[2,(0,ln.failure)(n)];case 3:return[2]}})})}var pLr=(Ga={},Ga[ei.ComputationRequestKind.Delay]=function(){return(0,ln.success)({})},Ga[ei.ComputationRequestKind.AwaitPromise]=function(e){var r=e.request.promise;return(0,Na.__awaiter)(void 0,void 0,void 0,function(){var n,a;return(0,Na.__generator)(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,r];case 1:return n=o.sent(),[2,(0,ln.success)({result:n})];case 2:return a=o.sent(),[2,(0,ln.failure)(a)];case 3:return[2]}})})},Ga[ei.ComputationRequestKind.CreateTask]=function(e){var r=e.request.request,n=e.handle,a=e.schedulerState,o=new Ste.X10TaskInternal(a.scheduler.processRequest(n,r,{onFulfiled:function(t){return t.kind===ln.ResultKind.Success?t.value:{kind:"RequestFailure"}}}),Wk);return(0,ln.success)({task:o})},Ga[ei.ComputationRequestKind.PromiseToTask]=function(e){var r=e.request.promise;return(0,ln.success)({task:new Ste.X10TaskInternal(r,Wk)})},Ga[ei.ComputationRequestKind.AwaitTask]=function(e){var r=e.request.task;return(0,Na.__awaiter)(void 0,void 0,void 0,function(){var n,a;return(0,Na.__generator)(this,function(o){switch(o.label){case 0:return n=ln.success,a={},[4,G8(r.resolve(Wk))];case 1:return[2,n.apply(void 0,[(a.result=o.sent(),a)])]}})})},Ga[ei.ComputationRequestKind.AwaitBatch]=function(e){var r=e.request.tasks;return(0,Na.__awaiter)(void 0,void 0,void 0,function(){var n,a,o,u,t,d;return(0,Na.__generator)(this,function(s){switch(s.label){case 0:n=[],a=0,o=r,s.label=1;case 1:return a<o.length?(u=o[a],d=(t=n).push,[4,G8(u.resolve(Wk))]):[3,4];case 2:d.apply(t,[s.sent()]),s.label=3;case 3:return a++,[3,1];case 4:return[2,(0,ln.success)({results:n})]}})})},Ga[ei.ComputationRequestKind.AwaitAll]=function(e){var r=e.request.tasks;return(0,Na.__awaiter)(void 0,void 0,void 0,function(){var n,a,o;return(0,Na.__generator)(this,function(u){switch(u.label){case 0:return n=hte.MaybeThenable.all(r.map(function(t){return t.resolve(Wk)})),a=ln.success,o={},[4,G8(n)];case 1:return[2,a.apply(void 0,[(o.result=u.sent(),o)])]}})})},Ga[ei.ComputationRequestKind.AwaitAny]=function(e){var r=e.request.tasks;return(0,Na.__awaiter)(void 0,void 0,void 0,function(){var n,a,o;return(0,Na.__generator)(this,function(u){switch(u.label){case 0:return n=hte.MaybeThenable.any(r.map(function(t){return t.resolve(Wk)})),a=ln.success,o={},[4,G8(n)];case 1:return[2,a.apply(void 0,[(o.result=u.sent(),o)])]}})})},Ga[ei.ComputationRequestKind.GetCell]=function(e){var r=e.request.cell,n=e.cache;return(0,Na.__awaiter)(void 0,void 0,void 0,function(){var a;return(0,Na.__generator)(this,function(o){switch(o.label){case 0:return n===void 0?[2,(0,ln.failure)(void 0)]:[4,n.getCell(r)];case 1:return a=o.sent(),[2,(0,ln.success)({result:a})]}})})},Ga[ei.ComputationRequestKind.GetContainingTable]=function(e){var r=e.request.cell,n=e.cache;return(0,Na.__awaiter)(void 0,void 0,void 0,function(){var a;return(0,Na.__generator)(this,function(o){switch(o.label){case 0:return n===void 0?[2,(0,ln.failure)(void 0)]:[4,n.getContainingTable(r)];case 1:return a=o.sent(),[2,(0,ln.success)({result:a})]}})})},Ga[ei.ComputationRequestKind.UnsafeGetContainingTableName]=function(e){var r=e.request.cell,n=e.cache;if(n===void 0)return(0,ln.failure)(void 0);var a=n.getContainingTableName(r);return(0,ln.success)({result:a})},Ga[ei.ComputationRequestKind.GetAvailableTableHeaders]=function(e){var r=e.request.tableName,n=e.cache;if(n===void 0)return(0,ln.failure)(void 0);var a=n.getAvailableTableHeaders(r);return(0,ln.success)({result:a})},Ga[ei.ComputationRequestKind.GetIntersectingTables]=function(e){var r=e.request.range,n=e.cache;return(0,Na.__awaiter)(void 0,void 0,void 0,function(){var a;return(0,Na.__generator)(this,function(o){switch(o.label){case 0:return n===void 0?[2,(0,ln.failure)(void 0)]:[4,n.getIntersectingTables(r)];case 1:return a=o.sent(),[2,(0,ln.success)({result:a})]}})})},Ga[ei.ComputationRequestKind.UnsafeGetIntersectingTableNames]=function(e){var r=e.request.range,n=e.cache;if(n===void 0)return(0,ln.failure)(void 0);var a=n.getIntersectingTableNames(r);return(0,ln.success)({result:a})},Ga[ei.ComputationRequestKind.GetRange]=function(e){var r=e.request,n=r.range,a=r.layers,o=e.cache;return(0,Na.__awaiter)(void 0,void 0,void 0,function(){var u;return(0,Na.__generator)(this,function(t){switch(t.label){case 0:return o===void 0?[2,(0,ln.failure)(void 0)]:[4,o.getRange(n,a)];case 1:return u=t.sent(),[2,(0,ln.success)({localSheetGrid:u})]}})})},Ga[ei.ComputationRequestKind.GetSheetNames]=function(e){var r=e.cache;return r===void 0?(0,ln.failure)(void 0):r.getSheetNames()},Ga[ei.ComputationRequestKind.GetStructRefColumn]=function(e){var r=e.request,n=r.table,a=r.nameOrCol,o=e.cache;if(o===void 0)return(0,ln.failure)(void 0);var u=o.getStructRefColumn(n,a);return(0,ln.success)({result:u})},Ga[ei.ComputationRequestKind.GetStructRefSpecialRef]=function(e){var r=e.request,n=r.table,a=r.id,o=e.cache;if(o===void 0)return(0,ln.failure)(void 0);var u=o.getStructRefSpecialRef(n,a);return(0,ln.success)({result:u})},Ga[ei.ComputationRequestKind.GetIformat]=function(e){var r=e.request,n=r.document,a=r.iformat,o=e.cache;return(0,Na.__awaiter)(void 0,void 0,void 0,function(){var u;return(0,Na.__generator)(this,function(t){switch(t.label){case 0:return o===void 0?[2,(0,ln.failure)(void 0)]:[4,o.getIformat(n,a)];case 1:return u=t.sent(),[2,(0,ln.success)({result:u})]}})})},Ga[ei.ComputationRequestKind.ParseCellFormula]=function(e){var r=e.request,n=r.cell,a=r.formula,o=r.useEnglishLocaleInfo,u=e.cache;return u===void 0?(0,ln.failure)(void 0):(0,ln.success)(u.parseCellFormula(n,a,o))},Ga[ei.ComputationRequestKind.ParseEdit]=function(e){var r=e.request,n=r.cell,a=r.formulaBarText,o=e.cache;return(0,Na.__awaiter)(void 0,void 0,void 0,function(){var u;return(0,Na.__generator)(this,function(t){switch(t.label){case 0:return o===void 0?[2,(0,ln.failure)(void 0)]:(u=ln.success,[4,o.parseEdit(n,a)]);case 1:return[2,u.apply(void 0,[t.sent()])]}})})},Ga[ei.ComputationRequestKind.ParseActiveCell]=function(e){var r=e.request.formulaText,n=e.schedulerState,a=n.activeCell,o=n.activeCellFormat,u=e.cache;if(u===void 0||(0,kE.isNone)(a)||o===void 0)return(0,ln.failure)(void 0);var t=o??{formatString:"General",builtIn:!0};return(0,ln.success)(u.parseEditSync(a,r,t))},Ga[ei.ComputationRequestKind.ParseNumberFormat]=function(e){var r=e.request,n=r.formatString,a=r.builtIn,o=e.cache;return o===void 0?(0,ln.failure)(void 0):(0,ln.success)(o.parseNumberFormat(n,a))},Ga[ei.ComputationRequestKind.PrintFormula]=function(e){var r=e.request,n=r.formula,a=r.origin,o=e.config;if(o===void 0)return(0,ln.failure)([]);var u=(0,cLr.createPrinter)((0,KAe.createSimplePrintGlobals)(o)),t=u.printFormula((0,KAe.printLocalsGrid)((0,GAe.lexicalSourceGrid)(GAe.LexicalKind.Cell,a),a),n);return(0,ln.success)({result:t})},Ga[ei.ComputationRequestKind.GetActiveCell]=function(e){var r=e.schedulerState.activeCell;return r===void 0?(th.ulsLogger.ULS.traceTag(512274723,th.LogCategory.msoulscat_ES_EWAJS,th.TraceLevel.Info,q8.x10Logger.formatLogMessage("GetActiveCell",{description:"failed because activeCell was undefined"})),(0,ln.failure)(void 0)):(0,ln.success)({activeCell:r})},Ga[ei.ComputationRequestKind.GetActiveCellFormat]=function(e){var r=e.schedulerState.activeCellFormat;return r===void 0?(0,ln.failure)(void 0):r===null?(0,ln.success)({result:(0,ln.failure)((0,dLr.unavailable)(["unavailableFormat"]))}):(0,ln.success)({result:(0,ln.success)(r)})},Ga[ei.ComputationRequestKind.GetConfig]=function(e){var r=e.config;return r===void 0?(0,ln.failure)(void 0):(0,ln.success)({config:r})},Ga[ei.ComputationRequestKind.GetFunctionsInfo]=function(e){var r=e.schedulerState,n=r.functionsInfoMap;if(n===void 0)return th.ulsLogger.ULS.traceTag(512274722,th.LogCategory.msoulscat_ES_EWAJS,th.TraceLevel.Info,q8.x10Logger.formatLogMessage("GetFunctionsInfo",{description:"failed because functionsInfoMap was undefined"})),(0,ln.failure)(void 0);var a=Object.keys(n).map(function(o){return n[o]});return(0,ln.success)({functionsInfo:a})},Ga[ei.ComputationRequestKind.GetFunctionInfo]=function(e){var r=e.request.functionName,n=e.schedulerState;if(n.functionsInfoMap===void 0)return th.ulsLogger.ULS.traceTag(512274721,th.LogCategory.msoulscat_ES_EWAJS,th.TraceLevel.Info,q8.x10Logger.formatLogMessage("GetFunctionInfo",{description:"failed because functionsInfoMap was undefined"})),(0,ln.failure)(void 0);var a=n.functionsInfoMap[r.toUpperCase()];return a===void 0?(0,ln.failure)(void 0):(0,ln.success)({functionInfo:a})},Ga[ei.ComputationRequestKind.GetDefinedNamesInfo]=function(e){var r=e.schedulerState,n=r.definedNamesInfoMap;if(n===void 0)return th.ulsLogger.ULS.traceTag(512274720,th.LogCategory.msoulscat_ES_EWAJS,th.TraceLevel.Info,q8.x10Logger.formatLogMessage("GetDefinedNamesInfo",{description:"failed because definedNamesInfoMap was undefined"})),(0,ln.failure)(void 0);var a=Object.keys(n).map(function(o){return n[o]});return(0,ln.success)({definedNamesInfo:a})},Ga[ei.ComputationRequestKind.GetDefinedNameInfo]=function(e){var r=e.request.definedName,n=e.schedulerState;if(n.definedNamesInfoMap===void 0)return(0,ln.failure)(void 0);var a=n.definedNamesInfoMap[r.toUpperCase()];return(0,ln.success)({definedNameInfo:a})},Ga[ei.ComputationRequestKind.EvalOnClonedModel]=function(e){var r=e.cache,n=e.request;return(0,Na.__awaiter)(void 0,void 0,void 0,function(){var a;return(0,Na.__generator)(this,function(o){switch(o.label){case 0:return[4,r==null?void 0:r.evalOnClonedModel(n.updates,n.edits)];case 1:return a=o.sent(),a===void 0||a.kind!==ln.ResultKind.Success?[2,(0,ln.failure)(void 0)]:[2,(0,ln.success)({result:a.value})]}})})},Ga[ei.ComputationRequestKind.EvalFormula]=function(e){var r=e.cache,n=e.request;return(0,Na.__awaiter)(void 0,void 0,void 0,function(){var a;return(0,Na.__generator)(this,function(o){switch(o.label){case 0:return[4,r==null?void 0:r.evalFormula(n.formula,n.origin,n.format)];case 1:return a=o.sent(),a===void 0?[2,(0,ln.failure)(void 0)]:a.kind!==ln.ResultKind.Success?[2,(0,ln.failure)(a.reason)]:[2,(0,ln.success)({result:a.value})]}})})},Ga[ei.ComputationRequestKind.GetCorrelationId]=function(e){var r=e.correlationId;return(0,ln.success)({correlationId:r})},Ga[ei.ComputationRequestKind.SetActiveCell]=function(e){return e.schedulerState=(0,Na.__assign)((0,Na.__assign)({},e.schedulerState),{activeCell:e.request.activeCell,activeCellFormat:e.request.activeCellFormat}),(0,ln.success)({})},Ga[ei.ComputationRequestKind.GetRichValueFieldListContext]=function(e){var r=e.schedulerState,n=e.request,a=n.rangeToQuery,o=n.dotNotationPath,u=n.singleColumn,t=n.findRange;return(0,Na.__awaiter)(void 0,void 0,void 0,function(){var d,s;return(0,Na.__generator)(this,function(c){switch(c.label){case 0:return d=r.serverDataProvider,(0,kE.isNone)(d)?[2,(0,ln.failure)(void 0)]:[4,d.getRichValueFieldListContext((0,fLr.toSharedSheetRange)(a),o,u,t)];case 1:return s=c.sent(),(0,kE.isNone)(s)?[2,(0,ln.success)({result:[]})]:[2,(0,ln.success)({result:s.filter(kE.isDefined)})]}})})},Ga[ei.ComputationRequestKind.GetHiddenRows]=function(e){var r=e.cache,n=e.request;return(0,Na.__awaiter)(void 0,void 0,void 0,function(){var a;return(0,Na.__generator)(this,function(o){switch(o.label){case 0:return r===void 0?[2,(0,ln.failure)([])]:[4,r.getHiddenRows(n.sheet,n.start,n.endExclusive)];case 1:return a=o.sent(),[2,(0,ln.success)({result:a})]}})})},Ga[ei.ComputationRequestKind.GetHiddenCols]=function(e){var r=e.cache,n=e.request;return(0,Na.__awaiter)(void 0,void 0,void 0,function(){var a;return(0,Na.__generator)(this,function(o){switch(o.label){case 0:return r===void 0?[2,(0,ln.failure)([])]:[4,r.getHiddenCols(n.sheet,n.start,n.endExclusive)];case 1:return a=o.sent(),[2,(0,ln.success)({result:a})]}})})},Ga[ei.ComputationRequestKind.ResolveReferences]=function(e){var r=e.cache,n=e.request,a=n.locals,o=n.nodes;if(r===void 0||a===void 0||o===void 0)return(0,ln.failure)(void 0);var u=r.resolveReferences(a,o);return(0,ln.success)({resolverResults:u})},Ga[ei.ComputationRequestKind.GetCorrespondingSnapshotID]=function(e){var r=e.cache;return(0,Na.__awaiter)(void 0,void 0,void 0,function(){var n;return(0,Na.__generator)(this,function(a){switch(a.label){case 0:return r===void 0?[2,(0,ln.failure)(void 0)]:[4,r.getCorrespondingSnapshotID()];case 1:return n=a.sent(),[2,(0,ln.success)({snapshotID:n})]}})})},Ga[ei.ComputationRequestKind.GetFullTableHeadersFromServer]=function(e){var r=e.schedulerState,n=e.request.tableName;return(0,Na.__awaiter)(void 0,void 0,void 0,function(){var a,o;return(0,Na.__generator)(this,function(u){switch(u.label){case 0:return a=r.serverDataProvider,(0,kE.isNone)(a)?[2,(0,ln.failure)(void 0)]:[4,a.getTableColHeaders(n)];case 1:return o=u.sent(),(0,kE.isNone)(o)?[2,(0,ln.success)({result:[]})]:[2,(0,ln.success)({result:o.filter(kE.isDefined)})]}})})},Ga[ei.ComputationRequestKind.CreateChatGPTSession]=function(e){var r=e.schedulerState.scheduler,n=e.finalizer,a=e.request.options;return(0,Na.__awaiter)(void 0,void 0,void 0,function(){var o;return(0,Na.__generator)(this,function(u){switch(u.label){case 0:return a===void 0?[2,(0,ln.failure)(void 0)]:[4,r.createChatGPTSession(a)];case 1:return o=u.sent(),o.kind===ln.ResultKind.Success&&n.subscribe(function(){return r.closeChatGPTSession(o.value)}),[2,U8(o,function(t){return{result:t}})]}})})},Ga[ei.ComputationRequestKind.CloseChatGPTSession]=function(e){var r=e.schedulerState.scheduler,n=e.request.session;return(0,Na.__awaiter)(void 0,void 0,void 0,function(){var a;return(0,Na.__generator)(this,function(o){switch(o.label){case 0:return n===void 0?[2,(0,ln.failure)(void 0)]:(a=U8,[4,r.closeChatGPTSession(n)]);case 1:return[2,a.apply(void 0,[o.sent(),function(){return{result:void 0}}])]}})})},Ga[ei.ComputationRequestKind.SendChatGPTRequest]=function(e){var r=e.schedulerState.scheduler,n=e.request,a=n.session,o=n.request;return(0,Na.__awaiter)(void 0,void 0,void 0,function(){var u;return(0,Na.__generator)(this,function(t){switch(t.label){case 0:return a===void 0||o===void 0?[2,(0,ln.failure)(void 0)]:[4,r.sendChatGPTRequest(a,o)];case 1:return u=t.sent(),[2,U8(u,function(d){return{result:d}})]}})})},Ga[ei.ComputationRequestKind.IsSchedulerFeatureEnabled]=function(e){var r=e.schedulerState.scheduler,n=e.request.feature,a=r.isSchedulerFeatureEnabled(n);return(0,ln.success)({isFeatureEnabled:a})},Ga[ei.ComputationRequestKind.SendAugLoopSignal]=function(e){var r=e.schedulerState.scheduler,n=e.request.signalData;return(0,Na.__awaiter)(void 0,void 0,void 0,function(){var a;return(0,Na.__generator)(this,function(o){switch(o.label){case 0:return n===void 0?[2,(0,ln.failure)(void 0)]:[4,r.sendAugLoopSignal(n)];case 1:return a=o.sent(),[2,U8(a,function(u){return{result:u}})]}})})},Ga[ei.ComputationRequestKind.TriggerEvent]=function(e){var r=e.schedulerState.scheduler,n=e.request,a=n.eventKind,o=n.event;return a===void 0?(0,ln.failure)(void 0):(r.triggerEventImmediate(a,o),(0,ln.success)({}))},Ga[ei.ComputationRequestKind.AwaitEvent]=function(e){var r=e.schedulerState.scheduler,n=e.request;return(0,Na.__awaiter)(void 0,void 0,void 0,function(){var a;return(0,Na.__generator)(this,function(o){switch(o.label){case 0:return[4,r.catchEvent(n)];case 1:return a=o.sent(),[2,(0,ln.success)({result:a})]}})})},Ga);jk.requestProcessorMap=pLr;function mLr(e,r,n,a,o){var u=n.info.correlationId,t=n.schedulerState,d=n.finalizer,s=e[r.kind],c={request:r,correlationId:u,cache:a,config:o,schedulerState:t,finalizer:d,handle:n},l=s(c);return(0,hte.bindMaybeThenable)(l,function(f){return f.kind!==ln.ResultKind.Success?(0,ln.failure)(void 0):(n.schedulerState=c.schedulerState,(0,ln.success)((0,Na.__assign)({kind:r.kind},f.value)))})}function gLr(e,r,n,a,o){var u=n.info.correlationId,t=n.schedulerState,d=n.finalizer,s=e[r.kind],c={request:r,correlationId:u,cache:a,config:o,schedulerState:t,finalizer:d,handle:n},l=s(c);return l.kind!==ln.ResultKind.Success?(0,ln.failure)(void 0):(n.schedulerState=c.schedulerState,(0,ln.success)((0,Na.__assign)({kind:r.kind},l.value)))}});var yte=Y(K8=>{_();Object.defineProperty(K8,"__esModule",{value:!0});K8.PriorityQueue=void 0;var vLr=Cn(),hLr=vLr.priorityQueue.PriorityQueue;K8.PriorityQueue=hLr});var jAe=Y(Qk=>{_();Object.defineProperty(Qk,"__esModule",{value:!0});Qk.SyncDataModel=Qk.MaxStateIdDifferenceForGC=void 0;var V8=br(),SLr=uD(),yLr=sk(),W8=dT(),CLr=xre(),_Lr=wre(),WAe=gs(),ah=Di(),Cte=zu(),Hk=m_(),RLr=function(){},_te=17;Qk.MaxStateIdDifferenceForGC=_te;var TLr=function(){function e(){this.dataTransformer=new SLr.RecalcServiceDataTransformer,this.stateId=-(1/0),this.stateChangesSinceLastGC=0,this.config=this.dataTransformer.getLangConfig(),this.configNotifications=[],this.sheets=new CLr.PartialWorkbookSheets(this.dataTransformer.document,this.config.localeInfo.stringCompareCI),this.nameManager=new _Lr.PartialWorkbookNameManager(this.dataTransformer.document,this.config.localeInfo.stringCompareCI),this.schedulerFeatures=[]}return Object.defineProperty(e.prototype,"document",{get:function(){return this.dataTransformer.document},enumerable:!1,configurable:!0}),e.prototype.getStateAsNotifications=function(){return(0,V8.__spreadArray)((0,V8.__spreadArray)((0,V8.__spreadArray)((0,V8.__spreadArray)([],this.configNotifications,!0),this.getSheetStateAsNotifications(),!0),this.getNameStateAsNotifications(),!0),this.getSchedulerFeaturesAsNotifications(),!0)},e.prototype.getSchedulerFeaturesAsNotifications=function(){return[[Hk.NotificationKind.setSchedulerFeatures,[this.schedulerFeatures]]]},e.prototype.getSheetStateAsNotifications=function(){var r=[];return this.sheets.forEachSheet(function(n,a){r.push((0,W8.sheetName)(a,n.name))}),r.length>0?[[Hk.NotificationKind.updateSheetNames,[this.stateId,r]]]:[]},e.prototype.getNameStateAsNotifications=function(){var r=this,n=[],a=function(t){var d=[];t.forEachAvailableName(function(s,c){var l=(0,yLr.namedObjectToNamedObjectData)(r.config.mathpack,r.dataTransformer.document,c==null?void 0:c.obj);return d.push((0,W8.namedObject)(s,l)),!0}),d.length>0&&n.push((0,W8.namedObjectsWrite)(t.scope.index,d)),t.allAvailable()&&n.push((0,W8.undefinedNamesWrite)(t.scope.index))},o=this.nameManager.getNamesBySheetId(void 0);return(0,ah.isSuccess)(o)&&a(o.value),this.nameManager.forEachSheetScope(function(u){a(u)}),n.length>0?[[Hk.NotificationKind.updateNamedObjects,[this.stateId,n]]]:[]},e.prototype.trySetStateId=function(r,n){if(n<this.stateId)return!1;if(n>this.stateId){var a=this.stateId;if(this.stateId=n,this.sheets.advanceState(a),this.nameManager.advanceState(a),this.stateChangesSinceLastGC+=1,this.stateChangesSinceLastGC>=_te){this.stateChangesSinceLastGC=0;var o=this.stateId-_te;this.nameManager.collectGarbage(o)}}return!0},e.prototype.clearCompiledFormulas=function(){this.nameManager.resetLazyData()},e.prototype.clearCompiledNumberFormats=function(){},e.prototype.setA1ReferenceStyle=function(r){this.configNotifications.push([Hk.NotificationKind.setA1ReferenceStyle,[r]]),this.dataTransformer.setA1ReferenceStyle(this,this.stateId,r)},e.prototype.setLocale=function(r){this.configNotifications.push([Hk.NotificationKind.setLocale,[r]]);var n={};this.dataTransformer.setLocaleInfo(this,this.stateId,r,n)},e.prototype.setWorkbookProps=function(r){this.configNotifications.push([Hk.NotificationKind.setWorkbookProps,[r]]);var n={};this.dataTransformer.setWorkbookProps(this,this.stateId,r,n)},e.prototype.updateSheetNames=function(r,n){var a={};this.dataTransformer.updateSheetNames(this,r,n,a)},e.prototype.updateNamedObjects=function(r,n){var a={};this.dataTransformer.updateNamedObjects(this,r,n,a)},e.prototype.setSchedulerFeatures=function(r){this.schedulerFeatures=r},e.prototype.setLangConfig=function(r,n){if(this.trySetStateId(!0,r)){var a=this.config.localeInfo!==n.localeInfo,o=this.config.refStyle!==n.refStyle;this.config=n,a&&this.clearCompiledNumberFormats(),(a||o)&&this.clearCompiledFormulas()}},e.prototype.setSheetNames=function(r,n,a){this.trySetStateId(!0,a)&&(this.sheets=this.sheets.setSheetNames(n),this.nameManager=this.nameManager.setSheetNames(n))},e.prototype.writeNamedObject=function(r,n,a,o){if(this.trySetStateId(!0,r)){var u=this.nameManager.setNamedObject(!0,(0,WAe.nameLoc)(n,a),o,RLr);(0,ah.isSuccess)(u)}},e.prototype.writeUndefinedNames=function(r,n){if(this.trySetStateId(!0,r)){var a=this.nameManager.setUndefinedNames(n);(0,ah.isSuccess)(a)}},e.prototype.promoteNamedObjects=function(r,n,a){if(this.trySetStateId(!0,r)){var o=this.nameManager.promoteNamedObjects(n,a);(0,ah.isSuccess)(o)&&o.value}},e.prototype.getDocumentLoc=function(r,n){var a=this.dataTransformer.document;return(r===void 0||r===a.path)&&this.config.localeInfo.stringCompareCI(n,a.name)===0?(0,ah.success)(a):(0,ah.failure)((0,Cte.unavailable)([(0,WAe.documentLoc)(r,n)]))},e.prototype.getSheetIndex=function(r,n){var a=this.sheets.getSheetByName(n);return!(0,ah.isSuccess)(a)||a.value===void 0?a:(0,ah.success)(a.value.sheetIndex.index)},e.prototype.getSheetName=function(r,n){var a=this.sheets.getSheetById(n);return(0,ah.isSuccess)(a)?(0,ah.success)(a.value.name):a},e.prototype.getNameLoc=function(r,n,a){return this.nameManager.getNameLoc(r.index,n,a)},e.prototype.getUserDefinedFuncLoc=function(r,n){return(0,ah.failure)((0,Cte.notImplemented)(["call UDF"]))},e.prototype.getSheetRangeIndexes=function(r){return this.sheets.getSheetRangeIds(r)},e.prototype.getContainingTable=function(r){return this.nameManager.getContainingTable(r)},e.prototype.getStructRefColumn=function(r,n){return this.nameManager.getStructRefColumn(r,n)},e.prototype.getStructRefSpecialRef=function(r,n){return this.nameManager.getStructRefSpecialRef(r,n)},e.prototype.getTime=function(){return(0,ah.failure)((0,Cte.unavailable)(["getTime"]))},e}();Qk.SyncDataModel=TLr});var Rte=Y(j8=>{"use strict";_();Object.defineProperty(j8,"__esModule",{value:!0});j8.PackageName=void 0;j8.PackageName="excel-online-calc-recalc"});var HAe=Y(Tte=>{_();Object.defineProperty(Tte,"__esModule",{value:!0});Tte.getExcelOnlineCalcNewPackagesNames=FLr;var bLr=Cn(),PLr=et(),ELr=N0(),NLr=gm(),ALr=Gv(),OLr=Rte(),kLr="".concat(bLr.PackageName,", ").concat(PLr.PackageName,",\n  ").concat(ELr.PackageName,", ").concat(NLr.PackageName,", ").concat(ALr.PackageName,", ").concat(OLr.PackageName);function FLr(){return kLr}});var QAe=Y(H8=>{_();Object.defineProperty(H8,"__esModule",{value:!0});H8.ChatGPTService=void 0;var zk=br(),ILr=ft(),DT=Di(),MLr=function(){function e(r){this.provider=r,this.set=new Set}return e.prototype.createSession=function(r){return(0,zk.__awaiter)(this,void 0,void 0,function(){var n;return(0,zk.__generator)(this,function(a){switch(a.label){case 0:return[4,this.provider.openChat(r)];case 1:return n=a.sent(),(0,ILr.isDefined)(n)?(this.set.add(n),[2,(0,DT.success)(n)]):[2,(0,DT.failure)(void 0)]}})})},e.prototype.closeSession=function(r){return(0,zk.__awaiter)(this,void 0,void 0,function(){var n;return(0,zk.__generator)(this,function(a){switch(a.label){case 0:if(!this.set.has(r))return[2,(0,DT.failure)(void 0)];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.provider.close(r)];case 2:return a.sent(),this.set.delete(r),[2,(0,DT.success)(void 0)];case 3:return n=a.sent(),[2,(0,DT.failure)(void 0)];case 4:return[2]}})})},e.prototype.request=function(r,n){return(0,zk.__awaiter)(this,void 0,void 0,function(){var a,o;return(0,zk.__generator)(this,function(u){switch(u.label){case 0:if(!this.set.has(r))return[2,(0,DT.failure)(void 0)];u.label=1;case 1:return u.trys.push([1,3,,4]),[4,this.provider.send(r,n)];case 2:return a=u.sent(),[2,(0,DT.success)(a)];case 3:return o=u.sent(),[2,(0,DT.failure)(void 0)];case 4:return[2]}})})},e}();H8.ChatGPTService=MLr});var JAe=Y(Yk=>{_();Object.defineProperty(Yk,"__esModule",{value:!0});Yk.X10ExceptionComputationTermination=Yk.X10Exception=void 0;var zAe=br(),YAe=function(e){(0,zAe.__extends)(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r}(Error);Yk.X10Exception=YAe;var wLr=function(e){(0,zAe.__extends)(r,e);function r(n){var a=e.call(this,"Computation execution was terminated with '".concat(n,"'."))||this;return a.stopReason=n,a}return r}(YAe);Yk.X10ExceptionComputationTermination=wLr});var ZAe=Y(Q8=>{_();Object.defineProperty(Q8,"__esModule",{value:!0});Q8.ComputationFinalizer=void 0;var DLr=br(),wm=tu(),xLr=AD(),XAe=JAe(),LLr=Ai(),LD=Xv(),FE=ds(),BLr=function(){function e(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];this.subject=new xLr.Subject,this.isClosed=!1;for(var a=0,o=r;a<o.length;a++){var u=o[a];this.subscribe(u)}}return e.prototype.subscribe=function(r){if(this.isClosed){wm.ulsLogger.ULS.traceTag(509109123,wm.LogCategory.msoulscat_ES_EWAJS,wm.TraceLevel.Warning,LD.x10Logger.formatLogMessage("PluginFinalizer",{description:"subscription for a closed finalizer was requested"}));return}return this.subject.subscribe(r)},e.prototype.finalize=function(r,n){var a=this.extractComputationInfo(r);if(n===FE.ExecutionStopReason.Unknown&&wm.ulsLogger.ULS.traceTag(509109122,wm.LogCategory.msoulscat_ES_EWAJS,wm.TraceLevel.Warning,LD.x10Logger.formatLogMessage("PluginFinalizer",{description:"finalize was invoked with an unknown stop reason",data:a})),this.isClosed){wm.ulsLogger.ULS.traceTag(509109121,wm.LogCategory.msoulscat_ES_EWAJS,wm.TraceLevel.Warning,LD.x10Logger.formatLogMessage("PluginFinalizer",{description:"finalizer was invoked more than once",data:(0,DLr.__assign)({stopReason:n},a)}));return}this.isClosed=!0,this.finalizeComputationGeneratorExecution(r,n),this.subject.next({computationInfo:a,stopReason:n})},e.prototype.finalizeComputationGeneratorExecution=function(r,n){switch(n){case FE.ExecutionStopReason.Unknown:case FE.ExecutionStopReason.Frame.Timeout:case FE.ExecutionStopReason.Frame.Superseded:case FE.ExecutionStopReason.Frame.ConflictResolverEarlyTermination:var a=!1;try{r.generator.throw(new XAe.X10ExceptionComputationTermination(n))}catch(o){a=!0,o instanceof XAe.X10ExceptionComputationTermination&&o.stopReason&&(o==null?void 0:o.stopReason)!==n&&wm.ulsLogger.ULS.traceTag(508903693,wm.LogCategory.msoulscat_ES_EWAJS,wm.TraceLevel.Warning,LD.x10Logger.formatLogMessage("finalizeComputationGeneratorExecution",{description:"computation threw an exception during execution",data:r.info}))}finally{wm.ulsLogger.ULS.assertTag(508903692,wm.LogCategory.msoulscat_ES_EWAJS,a,LD.x10Logger.formatLogMessage("finalizeComputationGeneratorExecution",{description:"computation terminated by x10 with exception but did not threw the exception back",data:r.info}))}break;case FE.ExecutionStopReason.Computation.Done:case FE.ExecutionStopReason.Computation.Exception:break;default:(0,LLr.assertNever)("Unknown stopReason",n)}},e.prototype.extractComputationInfo=function(r){var n,a,o=r.info;o.totalRuntime=r.info.computationTime;for(var u in r.info.requestTimes)o.totalRuntime+=(a=(n=r.info.requestTimes[u])===null||n===void 0?void 0:n.requestDuration)!==null&&a!==void 0?a:0;return o},e}();Q8.ComputationFinalizer=BLr});var z8=Y(BD=>{_();Object.defineProperty(BD,"__esModule",{value:!0});BD.EventKind=void 0;var bte;BD.EventKind=bte;(function(e){e.TestEvent="TestEvent",e.ALAnnotation="ALAnnotation"})(bte||(BD.EventKind=bte={}))});var J8=Y(yy=>{_();Object.defineProperty(yy,"__esModule",{value:!0});yy.ExecutionType=yy.ComputationType=yy.ComputationKinds=void 0;var UD=ft(),qLr=ds(),ULr=z8(),Y8,qD;yy.ComputationType=qD;(function(e){e.UIMessage="UIMessage",e.Event="Event"})(qD||(yy.ComputationType=qD={}));var GLr=(Y8={},Y8[qD.UIMessage]=qLr.RequestKind,Y8[qD.Event]=ULr.EventKind,Y8);yy.ComputationKinds=GLr;(0,UD.staticAssertSame)();var Pte;yy.ExecutionType=Pte;(function(e){e.Sync="Sync",e.Async="Async"})(Pte||(yy.ExecutionType=Pte={}));(0,UD.staticAssertExtends)();(0,UD.staticAssertExtends)();(0,UD.staticAssertExtends)();(0,UD.staticAssertExtends)()});var Ete=Y(xT=>{_();Object.defineProperty(xT,"__esModule",{value:!0});xT.wrapRegistration=xT.registerComputation=xT.getRegisteredComputations=void 0;var GD=ft(),KLr=Fu(),$Ae=J8(),e2e=(0,GD.mapFromArrayOfPairs)((0,GD.strEnumArray)($Ae.ComputationType).map(function(e){return[e,(0,GD.mapFromArrayOfPairs)((0,GD.numEnumArray)(KLr.PluginFactoryName).map(function(r){return[r,[]]}))]})),VLr=function(r){for(var n=[],a=0,o=(0,GD.strEnumArray)($Ae.ComputationType).map(function(t){return e2e[t][r]});a<o.length;a++){var u=o[a];n.push.apply(n,u)}return n};xT.getRegisteredComputations=VLr;var r2e=function(r,n,a,o,u,t){return function(d){return{type:r,kind:n,execution:a,registrationMethod:function(c){return function(l){var f=l[0],p=l[1];if(t!==void 0&&!t(f.computationInput,p)){d.addResult(r,n,o,{kind:"Skipped"},f.correlationId,f.computationGroup);return}var m=u.bind(c);d.startComputation(r,n,a,o,m(f.computationInput),f)}}}}};xT.wrapRegistration=r2e;var WLr=function(r,n,a,o,u,t){var d=r2e(r,n,a,o,u,t);e2e[r][o].push(d)};xT.registerComputation=WLr});var Nte=Y(C_=>{_();Object.defineProperty(C_,"__esModule",{value:!0});C_.SupportedAugLoopAnnotations=C_.RegisterAnnotation=C_.AnnotationDefinitionsMap=void 0;var X8,Z8,IE;C_.SupportedAugLoopAnnotations=IE;(function(e){e.formulaByExample="formulaByExample",e.testAnnotation="testAnnotation"})(IE||(C_.SupportedAugLoopAnnotations=IE={}));var jLr=(X8={},X8[IE.formulaByExample]=!0,X8[IE.testAnnotation]=!1,X8);C_.RegisterAnnotation=jLr;var HLr=(Z8={},Z8[IE.formulaByExample]={annotationName:"AugLoop_FormulaByExample_FormulaByExampleAnnotation",featureName:"FormulaByExample2",isModelRequired:!1},Z8[IE.testAnnotation]={annotationName:"TestAnnotation",featureName:"TestFeature",isModelRequired:!1},Z8);C_.AnnotationDefinitionsMap=HLr});var i2e=Y(e7=>{_();Object.defineProperty(e7,"__esModule",{value:!0});e7.AugLoopService=void 0;var n2e=br(),$8=Di(),t2e=ft(),a2e=Nte(),QLr=function(){function e(r,n,a){var o=this;this.augLoopInterop=r,(0,t2e.strEnumArray)(a2e.SupportedAugLoopAnnotations).forEach(function(u){n[u]&&o.registerAugloop(u,a)})}return e.prototype.registerAugloop=function(r,n){try{var a=a2e.AnnotationDefinitionsMap[r],o=this.augLoopInterop.registerOnAnnotation(a.annotationName,a.featureName,a.isModelRequired,n.bind(a));return o}catch(u){return(0,$8.failure)(u)}},e.prototype.sendSignal=function(r){return(0,n2e.__awaiter)(this,void 0,void 0,function(){var n;return(0,n2e.__generator)(this,function(a){try{return n=this.augLoopInterop.signal(r),(0,t2e.isDefined)(n)?[2,(0,$8.success)(n)]:[2,(0,$8.failure)(n)]}catch(o){return[2,(0,$8.failure)(o)]}return[2]})})},e}();e7.AugLoopService=QLr});var kte=Y(GT=>{_();Object.defineProperty(GT,"__esModule",{value:!0});GT.parentMethodsPost=GT.parentMethodsCall=GT.FormulaBarScheduler=void 0;var $n=br(),LT=gs(),G0=Fu(),il=ft(),xo=Ai(),ti=tu(),ea=ds(),zLr=_Ae(),bl=m_(),ME=Cd(),BT=Di(),YLr=FD(),o2e=Ok(),JLr=AAe(),KD=Pk(),XLr=FAe(),u2e=fte(),ZLr=mte(),$Lr=gte(),e5r=ig(),ih=DAe(),r7=VAe(),r5r=yte(),n5r=cu(),t5r=jAe(),Ote=Jc(),a5r=HAe(),vs=Xv(),i5r=QAe(),Jk=AD(),s2e=ZAe(),UT=_8(),la=J8(),n7=Ete(),o5r=z8(),u5r=i2e(),s5r=Nte(),VD,qT,l2e=function(){function e(){this.current=0}return e.prototype.create=function(){return this.current+=1},e}(),l5r=["createChatGPTSession","closeChatGPTSession","sendChatGPTRequest","sendAugLoopSignal"];GT.parentMethodsCall=l5r;var c5r=["addResult","addToComputationCount","triggerEventImmediate"];GT.parentMethodsPost=c5r;(0,il.staticAssertSame)();var d5r={kind:"RequestFailure"},c2e={kind:ih.InternalSchedulerResponseKind.FirstStep},f5r=(VD={},VD[bl.NotificationKind.setActiveCell]=!0,VD[bl.NotificationKind.setActiveCellFormat]=!0,VD[bl.NotificationKind.doNothing]=!0,VD),p5r=function(){function e(r,n,a,o,u){var t,d,s,c,l,f;a===void 0&&(a=(0,$n.__assign)({},ZLr.defaultPluginResponseWindows)),o===void 0&&(o=YLr.defaultTimerInterface);var p=this;this.createPrefetchingCache=n,this.pluginResultWindows=a,this.timer=o,this.parent=u,this.responseStates=(0,UT.mapFromArrayOfDependantPairs)((0,il.strEnumArray)(la.ComputationType).map(function(m){return[m,(0,UT.mapFromArrayOfDependantPairs)((0,il.strEnumArray)(la.ComputationKinds[m]).map(function(v){return[v,new ea.ResponseState(m,v)]}))]})),this.uiMessages=(0,UT.mapFromArrayOfDependantPairs)((0,il.strEnumArray)(la.ComputationKinds[la.ComputationType.UIMessage]).map(function(m){return[m,new Jk.Subject]})),this.syncUIMessages=(0,UT.mapFromArrayOfDependantPairs)((0,il.strEnumArray)(la.ComputationKinds[la.ComputationType.UIMessage]).map(function(m){return[m,new Jk.Subject]})),this.eventHandlers=(0,UT.mapFromArrayOfDependantPairs)((0,il.strEnumArray)(la.ComputationKinds[la.ComputationType.Event]).map(function(m){return[m,new Jk.Subject]})),this.conflictResolvers=(t={},t[la.ComputationType.UIMessage]=JLr.conflictResolver,t[la.ComputationType.Event]=(0,il.mapFromArrayOfPairs)((0,il.strEnumArray)(la.ComputationKinds[la.ComputationType.Event]).map(function(m){return[m,function(){}]})),t),this.computationSubjects=(d={},d[la.ComputationType.UIMessage]=(s={},s[la.ExecutionType.Async]=this.uiMessages,s[la.ExecutionType.Sync]=this.syncUIMessages,s),d[la.ComputationType.Event]=(c={},c[la.ExecutionType.Async]=this.eventHandlers,c),d),this.syncMessageQueue=new r5r.PriorityQueue(function(){return 0}),this.doNotifyStatelessSubject=new Jk.Subject,this.doNotifyStatefulSubject=new Jk.InitializingSubject(function(){return p.syncDataModel.getStateAsNotifications()}),this.requestWithCorrelationIdSubject=new Jk.Subject,this.syncDataModel=new t5r.SyncDataModel,this.idFactory=new l2e,this.eventComputationGroupFactory=new l2e,this.state={scheduler:this},this.notificationProcessorMap=(l={},l[bl.NotificationKind.setActiveCell]=this.setActiveCellImpl.bind(this),l[bl.NotificationKind.setActiveCellFormat]=this.setActiveCellFormatImpl.bind(this),l[bl.NotificationKind.setA1ReferenceStyle]=this.syncDataModel.setA1ReferenceStyle.bind(this.syncDataModel),l[bl.NotificationKind.setLocale]=this.syncDataModel.setLocale.bind(this.syncDataModel),l[bl.NotificationKind.setWorkbookProps]=this.syncDataModel.setWorkbookProps.bind(this.syncDataModel),l[bl.NotificationKind.updateSheetNames]=this.syncDataModel.updateSheetNames.bind(this.syncDataModel),l[bl.NotificationKind.updateNamedObjects]=this.syncDataModel.updateNamedObjects.bind(this.syncDataModel),l[bl.NotificationKind.doNothing]=function(){},l[bl.NotificationKind.setFunctionsInfo]=this.setFunctionInfo.bind(this),l[bl.NotificationKind.conflictResolverEarlyTermination]=function(m,v,h){return p.stopComputationFrame(m,v,la.ComputationType.UIMessage,h,ea.ExecutionStopReason.Frame.ConflictResolverEarlyTermination)},l[bl.NotificationKind.setDefinedNamesInfo]=this.setDefinedNamesInfo.bind(this),l[bl.NotificationKind.notifyWorkbookClosing]=this.onWorkbookClosing.bind(this),l[bl.NotificationKind.setSchedulerFeatures]=this.syncDataModel.setSchedulerFeatures.bind(this.syncDataModel),l),this.notifierObject=(0,zLr.makeNotifier)(this),this.requesterObject=(0,ea.makeRequester)(this),this.syncRequesterObject=(0,ea.makeSyncRequester)(this),this.batchRequesterObject=(0,u2e.makeBatchRequester)(this),this.obsoleteRequesterObject={argumentAssistance:function(){for(var v,h=[],S=0;S<arguments.length;S++)h[S]=arguments[S];return(v=p.requesterObject).argumentAssistance.apply(v,(0,$n.__spreadArray)((0,$n.__spreadArray)([],h,!1),[ea.DefaultComputationGroup],!1))},functionSuggestion:function(){for(var v,h=[],S=0;S<arguments.length;S++)h[S]=arguments[S];return(v=p.requesterObject).functionSuggestion.apply(v,(0,$n.__spreadArray)((0,$n.__spreadArray)([],h,!1),[ea.DefaultComputationGroup],!1))},formulaHighlighting:function(){for(var v,h=[],S=0;S<arguments.length;S++)h[S]=arguments[S];return(v=p.requesterObject).formulaHighlighting.apply(v,(0,$n.__spreadArray)((0,$n.__spreadArray)([],h,!1),[ea.DefaultComputationGroup],!1))},runExperiment:function(){for(var v,h=[],S=0;S<arguments.length;S++)h[S]=arguments[S];return(v=p.requesterObject).runExperiment.apply(v,(0,$n.__spreadArray)((0,$n.__spreadArray)([],h,!1),[ea.DefaultComputationGroup],!1))},runAuthoringExperiment:function(){for(var v,h=[],S=0;S<arguments.length;S++)h[S]=arguments[S];return(v=p.requesterObject).runAuthoringExperiment.apply(v,(0,$n.__spreadArray)((0,$n.__spreadArray)([],h,!1),[ea.DefaultComputationGroup],!1))},runTest:function(){for(var v,h=[],S=0;S<arguments.length;S++)h[S]=arguments[S];return(v=p.requesterObject).runTest.apply(v,(0,$n.__spreadArray)((0,$n.__spreadArray)([],h,!1),[ea.DefaultComputationGroup],!1))},chatGPTQuery:function(){for(var v,h=[],S=0;S<arguments.length;S++)h[S]=arguments[S];return(v=p.requesterObject).chatGPTQuery.apply(v,(0,$n.__spreadArray)((0,$n.__spreadArray)([],h,!1),[ea.DefaultComputationGroup],!1))},inCellSuggestion:function(){for(var v,h=[],S=0;S<arguments.length;S++)h[S]=arguments[S];return(v=p.requesterObject).inCellSuggestion.apply(v,(0,$n.__spreadArray)((0,$n.__spreadArray)([],h,!1),[ea.DefaultComputationGroup],!1))},runPerCharacterExperiment:function(){for(var v,h=[],S=0;S<arguments.length;S++)h[S]=arguments[S];return(v=p.requesterObject).runPerCharacterExperiment.apply(v,(0,$n.__spreadArray)((0,$n.__spreadArray)([],h,!1),[ea.DefaultComputationGroup],!1))},valuePreview:function(){for(var v,h=[],S=0;S<arguments.length;S++)h[S]=arguments[S];return(v=p.requesterObject).valuePreview.apply(v,(0,$n.__spreadArray)((0,$n.__spreadArray)([],h,!1),[ea.DefaultComputationGroup],!1))},gotoCtrlClick:function(){for(var v,h=[],S=0;S<arguments.length;S++)h[S]=arguments[S];return(v=p.requesterObject).gotoCtrlClick.apply(v,(0,$n.__spreadArray)((0,$n.__spreadArray)([],h,!1),[ea.DefaultComputationGroup],!1))},formulaRepair:function(){for(var v,h=[],S=0;S<arguments.length;S++)h[S]=arguments[S];return(v=p.requesterObject).formulaRepair.apply(v,(0,$n.__spreadArray)((0,$n.__spreadArray)([],h,!1),[ea.DefaultComputationGroup],!1))},formulaByExample:function(){for(var v,h=[],S=0;S<arguments.length;S++)h[S]=arguments[S];return(v=p.requesterObject).formulaByExample.apply(v,(0,$n.__spreadArray)((0,$n.__spreadArray)([],h,!1),[ea.DefaultComputationGroup],!1))}},this.obsoleteSyncRequesterObject={formulaHighlighting:function(){for(var v,h=[],S=0;S<arguments.length;S++)h[S]=arguments[S];return(v=p.syncRequesterObject).formulaHighlighting.apply(v,(0,$n.__spreadArray)((0,$n.__spreadArray)([],h,!1),[ea.DefaultComputationGroup],!1))}},this.obsoleteBatchRequesterObject={functionSuggestionAndArgumentAssistance:function(){for(var v,h=[],S=0;S<arguments.length;S++)h[S]=arguments[S];return(v=p.batchRequesterObject).functionSuggestionAndArgumentAssistance.apply(v,(0,$n.__spreadArray)((0,$n.__spreadArray)([],h,!1),[ea.DefaultComputationGroup],!1))}},this.notificationQueue=[],this.resolveCorrelatedRequestsWithNoPluginsEnabled=(0,Ote.isTypedChangeGateEnabled)("OfficeVSO:7536593_resolveCorrelatedRequestsWithNoPlugins"),this.isEnabledProcessNotificationsAfterShouldRunPlugin=(0,Ote.getTypedFeatureGate)("Microsoft.Office.Excel.ProcessNotificationsAfterShouldRunPlugin"),this.eventResultWindows=(0,il.mapFromArrayOfPairs)((0,il.strEnumArray)(la.ComputationKinds[la.ComputationType.Event]).map(function(m){return[m,{startDelta:0,stopDelta:1/0}]})),this.computationResultWindows=(f={},f[la.ComputationType.UIMessage]=this.pluginResultWindows,f[la.ComputationType.Event]=this.eventResultWindows,f),this.recalcServiceAttachedPromise=new KD.ResolvablePromise,this.chatGPTProviderAttachedPromise=new KD.ResolvablePromise,this.alManagerAttachedPromise=new KD.ResolvablePromiseWithTimeout(3e5,this.timer),this.computationFinalizerHandlers=[h5r],this.annotationReceivedCallback=function(m,v){p.triggerEvent(o5r.EventKind.ALAnnotation,{annotation:v}).catch(function(h){xo.ulsLogger.ULS.traceTag(508411927,ti.LogCategory.msoulscat_ES_EWAJS,ti.TraceLevel.Info,"x10arch.annotationReceivedCallback: Error triggering AL annotation event: ".concat(h))})},this.warmupParse=(0,n5r.asyncLazy)(function(){return(0,$n.__awaiter)(p,void 0,void 0,function(){var m,v,h;return(0,$n.__generator)(this,function(S){return m=this.createPrefetchingCache(this.syncDataModel,-1),m&&(v=(0,LT.documentLoc)(void 0,""),h=(0,LT.sheetGridCell)((0,LT.sheetIndex)(v,0),(0,LT.gridCell)(1,1)),m.parseEditSync(h,"=sum(5,7)",{formatString:"'GENERAL",builtIn:!0})),[2]})})}),xo.ulsLogger.ULS.traceTag(537796811,ti.LogCategory.msoulscat_ES_EWAJS,ti.TraceLevel.Info,vs.x10Logger.formatLogMessage("excelOnlineCalcPackages",{description:"".concat((0,a5r.getExcelOnlineCalcNewPackagesNames)())})),this.processor=r(this.consumeMessage.bind(this)),this.alManagerAttachedPromise.toPromise().catch(function(){})}return e.prototype.setFunctionInfo=function(r){if((0,il.isNone)(r)){xo.ulsLogger.ULS.traceTag(512274762,ti.LogCategory.msoulscat_ES_EWAJS,ti.TraceLevel.Info,vs.x10Logger.formatLogMessage("setFunctionInfo",{description:"functionsInfo was none"}));return}for(var n={},a=0,o=r;a<o.length;a++){var u=o[a];(0,il.isDefined)(u)&&(n[u.NameDataStrings]=u)}this.state=(0,$n.__assign)((0,$n.__assign)({},this.state),{functionsInfoMap:n}),xo.ulsLogger.ULS.traceTag(512274761,ti.LogCategory.msoulscat_ES_EWAJS,ti.TraceLevel.Info,vs.x10Logger.formatLogMessage("setFunctionInfo",{description:"set functionsInfoMap"}))},e.prototype.setDefinedNamesInfo=function(r){if((0,il.isNone)(r)){xo.ulsLogger.ULS.traceTag(512274760,ti.LogCategory.msoulscat_ES_EWAJS,ti.TraceLevel.Info,vs.x10Logger.formatLogMessage("setDefinedNamesInfo",{description:"definedNamesInfo was none"}));return}for(var n={},a=0,o=r;a<o.length;a++){var u=o[a];(0,il.isDefined)(u)&&(0,il.isDefined)(u.name)&&(n[u.name.toUpperCase()]=u)}this.state=(0,$n.__assign)((0,$n.__assign)({},this.state),{definedNamesInfoMap:n}),xo.ulsLogger.ULS.traceTag(512274759,ti.LogCategory.msoulscat_ES_EWAJS,ti.TraceLevel.Info,vs.x10Logger.formatLogMessage("setDefinedNamesInfo",{description:"set definedNamesInfoMap"}))},e.prototype.onWorkbookClosing=function(){vs.x10Logger.flush()},e.prototype.getPluginResponseWindows=function(){return this.pluginResultWindows},e.prototype.setPluginResponseWindow=function(r,n,a){this.pluginResultWindows[r]={startDelta:n,stopDelta:a}},e.prototype.consumeMessage=function(r){var n=this;switch(r.kind){case ea.SchedulerTimelineQueueMessageKind.StepComputation:this.stepComputation(r.computation,r.payload);break;case ea.SchedulerTimelineQueueMessageKind.NoOpRequest:case ea.SchedulerTimelineQueueMessageKind.SyncRequest:case ea.SchedulerTimelineQueueMessageKind.AsyncRequest:var a=this.timer.now();this.processRequest(r.computation,r.request,{onFulfiled:function(u){return u.kind===BT.ResultKind.Success?(n.enqueueMessage({kind:ea.SchedulerTimelineQueueMessageKind.StepComputation,computation:r.computation,payload:{kind:ih.InternalSchedulerResponseKind.NormalResponse,response:u.value}}),u.value):(n.enqueueMessage({kind:ea.SchedulerTimelineQueueMessageKind.StepComputation,computation:r.computation,payload:{kind:ih.InternalSchedulerResponseKind.RequestFailure}}),{kind:"RequestFailure"})},onRejected:function(u){n.enqueueMessage({kind:ea.SchedulerTimelineQueueMessageKind.StepComputation,computation:r.computation,payload:{kind:ih.InternalSchedulerResponseKind.AsyncException,error:u}})}}),r.computation.info.schedulerTime+=this.timer.now()-a;break;case ea.SchedulerTimelineQueueMessageKind.StopComputationFrame:this.stopComputationFrame(r.correlationId,r.computationGroup,r.type,r.computationKind,ea.ExecutionStopReason.Frame.Timeout);break;case ea.SchedulerTimelineQueueMessageKind.Timeout:r.callback();break;default:(0,xo.assertNever)("unknown message: ".concat(r),r)}},e.prototype.enqueueMessage=function(r,n){var a=e.abstractStepCosts[r.kind];this.processor.enqueue(r,a,n)},e.prototype.stepComputation=function(r,n){var a=this.responseStates[r.info.type][r.info.computationKind].computationFrame(r.info.computationGroup);if(r.info.correlationId!==(a==null?void 0:a.correlationId)){r.finalizer.finalize(r,r.stopReasonRef.value);return}try{var o=this.timer.now(),u=d2e(r.generator,n);if(r.info.computationTime+=this.timer.now()-o,u.done!==!0){var t=u.value;this.enqueueMessage((0,ih.wrapRequest)(t,r))}else this.addResultAndFinalizeComputationFrame(r,{kind:"Successful",message:u.value},ea.ExecutionStopReason.Computation.Done,a.correlationId)}catch(d){this.addResultAndFinalizeComputationFrame(r,{kind:"Exception"},ea.ExecutionStopReason.Computation.Exception,a.correlationId),xo.ulsLogger.ULS.traceTag(553734791,ti.LogCategory.msoulscat_ES_EWAJS,ti.TraceLevel.Warning,vs.x10Logger.formatLogMessage("stepPlugin",{description:"plugin threw exception: ".concat(d," during computation"),data:r.info}))}},e.prototype.addResultAndFinalizeComputationFrame=function(r,n,a,o){r.finalizer.finalize(r,a);var u=r.info.pluginFactoryName;return this.addResult(r.info.type,r.info.computationKind,u,n,o,r.info.computationGroup)},e.prototype.addResult=function(r,n,a,o,u,t){var d=this.responseStates[r][n].computationFrame(t);if(!(d===void 0||d.correlationId>u)){switch(xo.ulsLogger.ULS.assertTag(523360267,ti.LogCategory.msoulscat_ES_EWAJS,d.correlationId===u,vs.x10Logger.formatLogMessage("addResult",{description:"main scheduler corelationID (".concat(d.correlationId,") is less than the child one (").concat(u,")"),data:{pluginFactoryName:G0.PluginFactoryName[a]}})),this.parent&&this.parent.addResult(r,n,a,o,u,t),o.kind){case"Successful":d.successfulResults.results.push([a,o.message]);break;case"Exception":d.numFailures+=1;break;case"Skipped":d.numSkippedComputations+=1;break;default:(0,xo.assertNever)("unknown result",o)}v5r(d)===this.responseStates[r][n].numComputations&&this.stopComputationFrame(d.correlationId,t,r,n,ea.ExecutionStopReason.Computation.Done)}},e.prototype.processRequest=function(r,n,a){var o=this,u,t,d=a.onFulfiled,s=a.onRejected,c=this.responseStates[r.info.type][r.info.computationKind],l=c.computationFrame(r.info.computationGroup);if(r.info.correlationId!==(l==null?void 0:l.correlationId))return r.finalizer.finalize(r,r.stopReasonRef.value),{kind:"RequestFailure"};var f=this.timer.now(),p=(0,r7.processRequest)(r7.requestProcessorMap,n,r,(u=c.computationFrame(r.info.computationGroup))===null||u===void 0?void 0:u.cache,(t=c.computationFrame(r.info.computationGroup))===null||t===void 0?void 0:t.config);return(0,o2e.bindMaybeThenable)(p,function(m){return o.addProcessingTime(r,n.kind,f),m.kind!==BT.ResultKind.Success&&xo.ulsLogger.ULS.traceTag(538788238,ti.LogCategory.msoulscat_ES_EWAJS,ti.TraceLevel.Warning,vs.x10Logger.formatLogMessage("processRequest",{description:"request returned a scheduler-side failure",data:(0,$n.__assign)((0,$n.__assign)({},r.info),{failedRequest:n.kind})})),d(m)},function(m){return o.addProcessingTime(r,n.kind,f),s==null||s(m),xo.ulsLogger.ULS.traceTag(540611209,ti.LogCategory.msoulscat_ES_EWAJS,ti.TraceLevel.Warning,vs.x10Logger.formatLogMessage("processRequest",{description:"request processor threw",data:(0,$n.__assign)((0,$n.__assign)({},r.info),{failedRequest:n.kind,error:(0,e5r.messageFromError)(m)})})),{kind:"RequestFailure"}})},e.prototype.addProcessingTime=function(r,n,a){var o=this.timer.now(),u=r.info.requestTimes[n];return u?(u.requestDuration=u.requestDuration+o-a,u.numberOfRequests+=1,u.timeSinceLastRequest=o-r.lastTimestamp):r.info.requestTimes[n]={requestDuration:o-a,numberOfRequests:1,timeSinceLastRequest:o-r.lastTimestamp},r.lastTimestamp=o,o},e.prototype.stopComputationFrame=function(r,n,a,o,u){var t,d=this.responseStates[a][o];r===((t=d.computationFrame(n))===null||t===void 0?void 0:t.correlationId)&&d.stop(n,u,this.timer.now())},e.prototype.recalcServiceAttached=function(){return this.recalcServiceAttachedPromise.toPromise()},e.prototype.chatGPTProviderAttached=function(){return this.chatGPTProviderAttachedPromise.toPromise()},e.prototype.getFunctionsShortDescriptions=function(){return $Lr.functionShortDescriptions.getValue()},e.prototype.getSchedulerFeatures=function(){return(0,UT.asReadonly)(this.syncDataModel.schedulerFeatures)},e.prototype.isSchedulerFeatureEnabled=function(r){return this.getSchedulerFeatures().indexOf(r)!==-1},e.prototype.doNotify=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];xo.ulsLogger.ULS.traceTag(512274758,ti.LogCategory.msoulscat_ES_EWAJS,ti.TraceLevel.Info,vs.x10Logger.formatLogMessage("FormulaBarScheduler.doNotify",{description:"received notification of kind:\n       ".concat(r[0],"\n      ")})),this.enqueueNotification(r),r[0]===bl.NotificationKind.setSchedulerFeatures&&this.processNotifications()},e.prototype.enqueueNotification=function(r){var n=this.notificationQueue.length-1,a=this.notificationQueue[n];if(a===void 0)this.notificationQueue.push(r),xo.ulsLogger.ULS.traceTag(512274757,ti.LogCategory.msoulscat_ES_EWAJS,ti.TraceLevel.Info,vs.x10Logger.formatLogMessage("FormulaBarScheduler.enqueueNotification",{description:"queue empty, notification of kind:\n         ".concat(r[0]," pushed to queue\n        ")}));else{var o=a[0],u=r[0],t=o===u&&f5r[o]===!0;t?(this.notificationQueue[n]=r,xo.ulsLogger.ULS.traceTag(512274756,ti.LogCategory.msoulscat_ES_EWAJS,ti.TraceLevel.Info,vs.x10Logger.formatLogMessage("FormulaBarScheduler.enqueueNotification",{description:"notification of kind:\n           ".concat(r[0]," overrode previous notification\n          ")}))):(this.notificationQueue.push(r),xo.ulsLogger.ULS.traceTag(512274755,ti.LogCategory.msoulscat_ES_EWAJS,ti.TraceLevel.Info,vs.x10Logger.formatLogMessage("FormulaBarScheduler.enqueueNotification",{description:"couldn't coalesce, notification of kind:\n           ".concat(r[0]," pushed to queue\n          ")})))}},e.prototype.processNotifications=function(){for(var r=0,n=this.notificationQueue;r<n.length;r++){var a=n[r];xo.ulsLogger.ULS.traceTag(512274754,ti.LogCategory.msoulscat_ES_EWAJS,ti.TraceLevel.Info,vs.x10Logger.formatLogMessage("FormulaBarScheduler.processNotifications",{description:"processing notification of kind:\n         ".concat(a[0],"\n        ")})),this.processNotification(a)}this.notificationQueue.length=0},e.prototype.processNotification=function(r){var n,a=r[0],o=r[1];switch((n=this.notificationProcessorMap)[a].apply(n,o),a){case bl.NotificationKind.setA1ReferenceStyle:case bl.NotificationKind.setLocale:case bl.NotificationKind.setWorkbookProps:case bl.NotificationKind.updateSheetNames:case bl.NotificationKind.updateNamedObjects:case bl.NotificationKind.setSchedulerFeatures:this.doNotifyStatefulSubject.next(r);break;default:this.doNotifyStatelessSubject.next(r);break}},e.prototype.requestWithCorrelationId=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var a=r[0],o=r[1],u=r[2],t=r[3],d=r[4],s=r[5],c=r[6],l=this.timer.now(),f=this.responseStates[a][o];f.closeFrame(c,ea.ExecutionStopReason.Frame.Superseded,l);var p=this.createPrefetchingCache(this.syncDataModel,d),m=this.computationResultWindows[a][o],v=f.createFrame(d,c,t,p,this.syncDataModel.config,l,m);this.resolveCorrelatedRequestsWithNoPluginsEnabled&&this.responseStates[a][o].numComputations===0?(vs.x10Logger.log({kind:"requestSkipped",payload:{computationKind:o,computationGroup:c}}),v.resolve({kind:G0.PluginSchedulerResultKind.Done,payload:{kind:o,results:[]}})):vs.x10Logger.log({kind:"beginRequest",payload:{correlationId:d,computationKind:o,computationGroup:c}});var h=f.computationFrame(c);return(0,xo.assertTrue)("`frame` should be always defined at this point",h!==void 0),this.computationSubjects[a][u][o].next([h,s]),m.stopDelta<1/0&&this.enqueueMessage({kind:ea.SchedulerTimelineQueueMessageKind.StopComputationFrame,correlationId:d,computationGroup:c,type:a,computationKind:o},l+m.stopDelta),this.requestWithCorrelationIdSubject.next([a,o,u,t,d,s,c]),v},e.prototype.syncRequestWithCorrelationId=function(r,n,a,o,u,t,d){var s,c=this.timer.now(),l=this.responseStates[r][n];l.closeFrame(d,ea.ExecutionStopReason.Frame.Superseded,c);var f=this.createPrefetchingCache(this.syncDataModel,u),p=this.computationResultWindows[r][n],m=l.createFrame(u,d,o,f,this.syncDataModel.config,c,p);vs.x10Logger.log({kind:"beginRequest",payload:{correlationId:u,computationKind:n,computationGroup:d}});var v=l.computationFrame(d);(0,xo.assertTrue)("`frame` should be always defined at this point",v!==void 0),this.computationSubjects[r][a][n].next([v,t]);var h=c+p.stopDelta,S=(s=this.runToCompletion(f,this.syncDataModel.config,h),s[0]),y=s[1];return l.closeFrame(d,S,this.timer.now()),m.resolve({kind:G0.PluginSchedulerResultKind.Done,payload:{kind:n,results:[]}}),{kind:n,results:y}},e.prototype.runToCompletion=function(r,n,a){for(var o=[],u=this.timer.now(),t=this.syncMessageQueue.pop();t!==void 0;t=this.syncMessageQueue.pop(),u=this.timer.now()){if(u>=a){t.computation.finalizer.finalize(t.computation,ea.ExecutionStopReason.Frame.Timeout);break}var d=void 0;switch(t.kind){case ea.SchedulerTimelineQueueMessageKind.StepComputation:{var s=t.computation,c=t.payload;try{var l=d2e(s.generator,c);if(s.info.computationTime+=this.timer.now()-u,l.done!==!0){var f=l.value;this.syncMessageQueue.enqueue((0,ih.wrapSyncRequest)(f,s))}else this.addResult(s.info.type,s.info.computationKind,s.info.pluginFactoryName,{kind:"Successful",message:l.value},s.info.correlationId,s.info.computationGroup),s.finalizer.finalize(s,ea.ExecutionStopReason.Computation.Done),o.push([s.info.pluginFactoryName,l.value])}catch(m){xo.ulsLogger.ULS.traceTag(538581056,ti.LogCategory.msoulscat_ES_EWAJS,ti.TraceLevel.Warning,vs.x10Logger.formatLogMessage("FormulaBarScheduler.runToCompletion",{description:"plugin threw exception during computation",data:s.info})),s.finalizer.finalize(s,ea.ExecutionStopReason.Computation.Exception)}}break;case ea.SchedulerTimelineQueueMessageKind.NoOpRequest:case ea.SchedulerTimelineQueueMessageKind.SyncRequest:var p=(0,r7.processSyncRequest)(r7.requestProcessorMap,t.request,t.computation,r,n);d=this.addProcessingTime(t.computation,t.request.kind,u),t.computation.info.schedulerTime+=d-u,p.kind===BT.ResultKind.Success?this.syncMessageQueue.enqueue({kind:ea.SchedulerTimelineQueueMessageKind.StepComputation,computation:t.computation,payload:{kind:ih.InternalSchedulerResponseKind.NormalResponse,response:p.value}}):(xo.ulsLogger.ULS.traceTag(538469328,ti.LogCategory.msoulscat_ES_EWAJS,ti.TraceLevel.Warning,vs.x10Logger.formatLogMessage("FormulaBarScheduler.runToCompletion",{description:"request returned a scheduler-side failure",data:(0,$n.__assign)((0,$n.__assign)({},t.computation.info),{failedRequest:t.request.kind})})),this.syncMessageQueue.enqueue({kind:ea.SchedulerTimelineQueueMessageKind.StepComputation,computation:t.computation,payload:{kind:ih.InternalSchedulerResponseKind.RequestFailure}}));break;default:(0,xo.assertNever)("unknown message: ".concat(t),t)}}return this.syncMessageQueue.clear(),[!(0,il.isDefined)(a)||u<a?ea.ExecutionStopReason.Computation.Done:ea.ExecutionStopReason.Frame.Timeout,o]},e.prototype.triggerEventImmediate=function(r,n){if(this.parent)return this.parent.triggerEventImmediate(r,n);this.triggerEvent(r,n)},e.prototype.triggerEvent=function(r,n){return this.processNotifications(),this.doRequestUntyped(la.ComputationType.Event,r,n,G0.PluginGroup.Excel,this.eventComputationGroupFactory.create().toString())},e.prototype.doRequest=function(r,n,a,o){return this.isEnabledProcessNotificationsAfterShouldRunPlugin&&!this.shouldRunUIMessageComputation(r,n,a,la.ExecutionType.Async)?this.wrapResults(la.ComputationType.UIMessage,this.skippedRequest(r,o)):(this.processNotifications(),this.doRequestUntyped(la.ComputationType.UIMessage,r,n,a,o))},e.prototype.skippedRequest=function(r,n){vs.x10Logger.log({kind:"requestSkipped",payload:{computationKind:r,computationGroup:n}});var a=new KD.ResolvablePromise;return a.resolve({kind:G0.PluginSchedulerResultKind.Done,payload:{kind:r,results:[]}}),a},e.prototype.wrapResults=function(r,n){return(0,$n.__awaiter)(this,void 0,void 0,function(){var a;return(0,$n.__generator)(this,function(o){switch(o.label){case 0:return[4,this.resolveConflicts(r,n)];case 1:return a=o.sent(),a.kind===G0.PluginSchedulerResultKind.Superseded?[2,a]:[2,(0,$n.__assign)((0,$n.__assign)({},a),{payload:a.payload.result})]}})})},e.prototype.doRequestUntyped=function(r,n,a,o,u){return(0,$n.__awaiter)(this,void 0,void 0,function(){var t;return(0,$n.__generator)(this,function(d){return!this.resolveCorrelatedRequestsWithNoPluginsEnabled&&this.responseStates[r][n].numComputations===0?t=this.skippedRequest(n,u):t=this.requestWithCorrelationId(r,n,la.ExecutionType.Async,a,this.idFactory.create(),o,u),[2,this.wrapResults(r,t)]})})},e.prototype.doSyncRequest=function(r,n,a,o){return this.isEnabledProcessNotificationsAfterShouldRunPlugin&&!this.shouldRunUIMessageComputation(r,n,a,la.ExecutionType.Sync)?this.wrapSyncResponse(la.ComputationType.UIMessage,this.skippedSyncRequest(r,o)):(this.processNotifications(),this.doSyncRequestUntyped(la.ComputationType.UIMessage,r,n,a,o))},e.prototype.skippedSyncRequest=function(r,n){return vs.x10Logger.log({kind:"requestSkipped",payload:{computationKind:r,computationGroup:n}}),{kind:r,results:[]}},e.prototype.wrapSyncResponse=function(r,n){return this.syncResolveConflicts(r,n).result},e.prototype.doSyncRequestUntyped=function(r,n,a,o,u){var t;if(this.responseStates[r][n].numSyncComputations===0)t=this.skippedSyncRequest(n,u);else{var d=this.idFactory.create();t=this.syncRequestWithCorrelationId(r,n,la.ExecutionType.Sync,a,d,o,u)}return this.wrapSyncResponse(r,t)},e.prototype.resolveConflicts=function(r,n){return(0,$n.__awaiter)(this,void 0,void 0,function(){var a;return(0,$n.__generator)(this,function(o){switch(o.label){case 0:return[4,n];case 1:return a=o.sent(),a.kind===G0.PluginSchedulerResultKind.Superseded?[2,a]:[2,{kind:G0.PluginSchedulerResultKind.Done,payload:this.syncResolveConflicts(r,a.payload)}]}})})},e.prototype.syncResolveConflicts=function(r,n){var a=n.results.filter(function(o){var u=o[1];return(0,il.isDefined)(u)});return{kind:n.kind,result:this.conflictResolvers[r][n.kind](a)}},e.prototype.doBatchRequest=function(r,n,a){return(0,$n.__awaiter)(this,void 0,void 0,function(){var o,u,t,d,s,c,l,m,f,p,m,v;return(0,$n.__generator)(this,function(h){switch(h.label){case 0:for(this.isEnabledProcessNotificationsAfterShouldRunPlugin||this.processNotifications(),o=this.idFactory.create(),u=u2e.customConflictResolverPluginKinds[r.strategy],t=XLr.customConflictResolverFactories[r.strategy].create(),d=u.map(function(){return!0}),s=new KD.ResolvablePromise,c=function(y){var C=u[y],E=r[C],I=void 0;l.isEnabledProcessNotificationsAfterShouldRunPlugin&&!l.shouldRunUIMessageComputation(C,E,n,la.ExecutionType.Async)?I=l.skippedRequest(C,a??ea.DefaultComputationGroup):(l.processNotifications(),I=l.requestWithCorrelationId(la.ComputationType.UIMessage,C,la.ExecutionType.Async,E,o,n,a??ea.DefaultComputationGroup)),l.resolveConflicts(la.ComputationType.UIMessage,I).then(function(F){if(d[y]=!1,F.kind===G0.PluginSchedulerResultKind.Superseded)s.resolve({kind:G0.PluginSchedulerResultKind.Superseded});else{var w=F.payload;t.consumeResult(w)}},function(){xo.ulsLogger.ULS.traceTag(553734794,ti.LogCategory.msoulscat_ES_EWAJS,ti.TraceLevel.Error,vs.x10Logger.formatLogMessage("doBatchRequest",{description:'Custom conflict resolver "'.concat(r.strategy,'" got an exception for plugin kind "').concat(C,'". Skipping kind')})),d[y]=!1,t.consumeResult({kind:C,result:null})})},l=this,m=0;m<u.length;m+=1)c(m);return f=(0,o2e.bindMaybeThenable)(t.promise,function(S){return{kind:G0.PluginSchedulerResultKind.Done,payload:S}}),[4,Promise.race([s,f])];case 1:for(p=h.sent(),m=0;m<u.length;m+=1)v=u[m],d[m]&&(this.doNotify(bl.NotificationKind.conflictResolverEarlyTermination,[o,a??ea.DefaultComputationGroup,v]),this.processNotifications());return[2,p]}})})},e.prototype.notifier=function(){return this.notifierObject},e.prototype.requester=function(){return this.requesterObject},e.prototype.getRequester=function(){return this.obsoleteRequesterObject},e.prototype.syncRequester=function(){return this.syncRequesterObject},e.prototype.getSyncRequester=function(){return this.obsoleteSyncRequesterObject},e.prototype.batchRequester=function(){return this.batchRequesterObject},e.prototype.getBatchRequester=function(){return this.obsoleteBatchRequesterObject},e.prototype.setServerDataProvider=function(r){(0,il.isNone)(r)||(this.state=(0,$n.__assign)((0,$n.__assign)({},this.state),{serverDataProvider:r}))},e.prototype.setActiveCellImpl=function(r){if((0,il.isNone)(r.docName)||(0,il.isNone)(r.sheetIndex)){xo.ulsLogger.ULS.traceTag(553734796,ti.LogCategory.msoulscat_ES_EWAJS,ti.TraceLevel.Warning,vs.x10Logger.formatLogMessage("setActiveCellImpl",{description:"early exit, some of the arguments is None"}));return}var n=(0,LT.documentLoc)(void 0,""),a=(0,LT.unsafeGridRange)(r.rowIndex,r.colIndex,1,1),o=(0,LT.sheetGridCell)((0,LT.sheetIndex)(n,r.sheetIndex),a),u=f2e(r);this.state=(0,$n.__assign)((0,$n.__assign)({},this.state),{activeCell:o,activeCellFormat:u}),xo.ulsLogger.ULS.traceTag(512274752,ti.LogCategory.msoulscat_ES_EWAJS,ti.TraceLevel.Info,vs.x10Logger.formatLogMessage("setActiveCellImpl",{description:"updated activeCell to col: ".concat(o.range.col,", row: ").concat(o.range.row)}))},e.prototype.setActiveCellFormatImpl=function(r){var n=f2e(r);this.state=(0,$n.__assign)((0,$n.__assign)({},this.state),{activeCellFormat:n})},e.prototype.getConfig=function(){return this.syncDataModel.config},e.prototype.startComputation=function(r,n,a,o,u,t){switch(a){case la.ExecutionType.Async:this.enqueueMessage({kind:ea.SchedulerTimelineQueueMessageKind.StepComputation,computation:(0,$n.__assign)((0,$n.__assign)({},this.generateNewComputationInfo(r,n,o,t)),{generator:u}),payload:c2e},t.startTime+t.timeWindow.startDelta);break;case la.ExecutionType.Sync:this.syncMessageQueue.enqueue({kind:ea.SchedulerTimelineQueueMessageKind.StepComputation,computation:(0,$n.__assign)((0,$n.__assign)({},this.generateNewComputationInfo(r,n,o,t)),{generator:u}),payload:c2e});break;default:(0,xo.assertNever)("".concat(a),a)}},e.prototype.generateNewComputationInfo=function(r,n,a,o){return{info:{correlationId:o.correlationId,computationGroup:o.computationGroup,type:r,computationKind:n,pluginFactoryName:a,computationTime:0,schedulerTime:0,requestTimes:{}},finalizer:new(s2e.ComputationFinalizer.bind.apply(s2e.ComputationFinalizer,(0,$n.__spreadArray)([void 0],this.computationFinalizerHandlers,!1))),stopReasonRef:o.stopReasonRef,schedulerState:this.state,lastTimestamp:this.timer.now()}},e.prototype.createAndAttachPlugin=function(r,n){this.parent&&this.warmupParse.getValue();for(var a=r.create(n),o=ME.pluginFactoryKindMap[r.factoryName],u=(0,n7.wrapRegistration)(la.ComputationType.UIMessage,o,la.ExecutionType.Async,r.factoryName,a.run.bind(a),function(l,f){return Ate(r.factoryName,f,l,o)}),t=0,d=(0,$n.__spreadArray)([u],(0,n7.getRegisteredComputations)(r.factoryName),!0);t<d.length;t++){var s=d[t],c=s(this);switch(c.type){case la.ComputationType.UIMessage:this.computationSubjects[c.type][c.execution][c.kind].subscribe(c.registrationMethod(a)),this.addToComputationCount(c.type,c.kind,r.factoryName);break;case la.ComputationType.Event:this.computationSubjects[c.type][c.execution][c.kind].subscribe(c.registrationMethod(a)),this.addToComputationCount(c.type,c.kind,r.factoryName);break;default:(0,xo.assertNever)("".concat(c),c)}}xo.ulsLogger.ULS.traceTag(545378970,ti.LogCategory.msoulscat_ES_EWAJS,ti.TraceLevel.Info,"x10arch.FormulaBarScheduler.createAndAttachPlugin: ".concat(G0.PluginFactoryName[r.factoryName]," was attached."))},e.prototype.createAndAttachSyncPlugin=function(r,n){for(var a=r.create(n),o=ME.pluginFactoryKindMap[r.factoryName],u=(0,n7.wrapRegistration)(la.ComputationType.UIMessage,o,la.ExecutionType.Sync,r.factoryName,a.run.bind(a),function(l,f){return Ate(r.factoryName,f,l,o)}),t=0,d=(0,$n.__spreadArray)([u],(0,n7.getRegisteredComputations)(r.factoryName),!0);t<d.length;t++){var s=d[t],c=s(this);switch(c.type){case la.ComputationType.UIMessage:this.computationSubjects[c.type][c.execution][c.kind].subscribe(c.registrationMethod(a)),this.responseStates[c.type][c.kind].attachSyncComputation(r.factoryName);break;case la.ComputationType.Event:this.computationSubjects[c.type][c.execution][c.kind].subscribe(c.registrationMethod(a)),this.responseStates[c.type][c.kind].attachSyncComputation(r.factoryName);break;default:(0,xo.assertNever)("".concat(c),c)}}xo.ulsLogger.ULS.traceTag(538581058,ti.LogCategory.msoulscat_ES_EWAJS,ti.TraceLevel.Info,"x10arch.FormulaBarScheduler.createAndAttachSyncPlugin: ".concat(G0.PluginFactoryName[r.factoryName]," was attached."))},e.prototype.addToComputationCount=function(r,n,a){this.parent&&this.parent.addToComputationCount(r,n,a),this.responseStates[r][n].attachComputation(a)},e.prototype.catchEvent=function(r){var n=this;return new Promise(function(a,o){var u=n.computationSubjects[la.ComputationType.Event][la.ExecutionType.Async][r.eventKind].subscribe(function(t){var d=t[0],s=t[1];(!(0,il.isDefined)(r.predicate)||r.predicate(d.computationInput))&&(n.computationSubjects[la.ComputationType.Event][la.ExecutionType.Async][r.eventKind].unsubscribe(u),a((0,BT.success)(d.computationInput)))});n.enqueueMessage({kind:ea.SchedulerTimelineQueueMessageKind.Timeout,type:la.ComputationType.Event,callback:function(){n.computationSubjects[la.ComputationType.Event][la.ExecutionType.Async][r.eventKind].unsubscribe(u),a((0,BT.failure)("Timeout"))}},n.timer.now()+r.timeout)})},e.prototype.registerAsyncGrid=function(){this.recalcServiceAttachedPromise.resolve(void 0)},e.prototype.registerChatGPTProvider=function(r){var n=new i5r.ChatGPTService(r);return this.chatGPTProviderAttachedPromise.resolve(n)},e.prototype.registerALManager=function(r){var n=new u5r.AugLoopService(r,s5r.RegisterAnnotation,this.annotationReceivedCallback);return this.alManagerAttachedPromise.resolve(n)},e.prototype.sendAugLoopSignal=function(r){return(0,$n.__awaiter)(this,void 0,void 0,function(){var n,a;return(0,$n.__generator)(this,function(o){switch(o.label){case 0:if(this.parent!==void 0)return[3,5];n=void 0,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.alManagerAttachedPromise.toPromise()];case 2:return n=o.sent(),[3,4];case 3:return a=o.sent(),xo.ulsLogger.ULS.traceTag(508630016,ti.LogCategory.msoulscat_ES_EWAJS,ti.TraceLevel.Info,"x10arch.FormulaBarScheduler.sendAugLoopSignal: Error getting AugLoopService: ".concat(a)),[2,(0,BT.failure)(a)];case 4:return[2,n.sendSignal(r)];case 5:return[2,this.parent.sendAugLoopSignal(r)]}})})},e.prototype.augloopCloseCallback=function(){xo.ulsLogger.ULS.traceTag(508629987,ti.LogCategory.msoulscat_ES_EWAJS,ti.TraceLevel.Info,"x10arch.FormulaBarScheduler.augloopCloseCallback: Got close callback from AugLoop Manager")},e.prototype.createChatGPTSession=function(r){return(0,$n.__awaiter)(this,void 0,void 0,function(){var n;return(0,$n.__generator)(this,function(a){switch(a.label){case 0:return this.parent!==void 0?[3,2]:[4,this.chatGPTProviderAttached()];case 1:return n=a.sent(),[2,n.createSession(r)];case 2:return[2,this.parent.createChatGPTSession(r)]}})})},e.prototype.closeChatGPTSession=function(r){return(0,$n.__awaiter)(this,void 0,void 0,function(){var n;return(0,$n.__generator)(this,function(a){switch(a.label){case 0:return this.parent!==void 0?[3,2]:[4,this.chatGPTProviderAttached()];case 1:return n=a.sent(),[2,n.closeSession(r)];case 2:return[2,this.parent.closeChatGPTSession(r)]}})})},e.prototype.sendChatGPTRequest=function(r,n){return(0,$n.__awaiter)(this,void 0,void 0,function(){var a,o;return(0,$n.__generator)(this,function(u){switch(u.label){case 0:return this.parent!==void 0?[3,3]:[4,this.chatGPTProviderAttached()];case 1:return a=u.sent(),[4,a.request(r,n)];case 2:return o=u.sent(),o.kind===BT.ResultKind.Success&&!(0,il.isDefined)(o.value)?[2,(0,BT.failure)(void 0)]:((0,UT.staticTypeHint)(o),[2,o]);case 3:return[2,this.parent.sendChatGPTRequest(r,n)]}})})},e.prototype.shouldRunUIMessageComputation=function(r,n,a,o){for(var u=this.responseStates[la.ComputationType.UIMessage][r],t=o===la.ExecutionType.Async?u.attachedComputations:u.attachedSyncComputations,d=0,s=t;d<s.length;d++){var c=s[d];if(Ate(c,a,n,r))return!0}return!1},e.abstractStepCosts=(qT={},qT[ea.SchedulerTimelineQueueMessageKind.NoOpRequest]=.01,qT[ea.SchedulerTimelineQueueMessageKind.AsyncRequest]=.1,qT[ea.SchedulerTimelineQueueMessageKind.SyncRequest]=.5,qT[ea.SchedulerTimelineQueueMessageKind.StepComputation]=1,qT[ea.SchedulerTimelineQueueMessageKind.StopComputationFrame]=.01,qT[ea.SchedulerTimelineQueueMessageKind.Timeout]=.01,qT),e}();GT.FormulaBarScheduler=p5r;function d2e(e,r){switch(r.kind){case ih.InternalSchedulerResponseKind.FirstStep:return e.next();case ih.InternalSchedulerResponseKind.NormalResponse:return e.next(r.response);case ih.InternalSchedulerResponseKind.AsyncException:case ih.InternalSchedulerResponseKind.RequestFailure:return e.next(d5r);default:(0,xo.assertNever)("x10arch: FormulaBarScheduler.stepPlugin: unknown payload",r)}}function m5r(e){return e[1]in ME.requestKindCellContentNameMap}function g5r(e){return e[0][ME.requestKindCellContentNameMap[e[1]]]}function Ate(e,r,n,a){var o,u=(0,Ote.getTypedFeatureGate)("Microsoft.Office.Excel.SkipFormulaPluginsForNonFormulaCells"),t=(o=ME.pluginGroupMap[r][e])!==null&&o!==void 0?o:ME.pluginGroupOptInDefault[r],d=e in ME.ProcessNonFormulaCells,s=["=","+","-"];if(!t)return!1;if(!u)return t;if(d)return!0;var c=[n,a];if(m5r(c)){var l=g5r(c);return(0,UT.staticTypeHint)(l),(0,il.isDefined)(l)?s.indexOf(l[0])!==-1:!0}return!0}function v5r(e){return e.numFailures+e.numSkippedComputations+e.successfulResults.results.length}function h5r(e){vs.x10Logger.log({kind:"computationStoppedExecution",payload:{computationName:G0.PluginFactoryName[e.computationInfo.pluginFactoryName],stopReason:e.stopReason,logInfo:e.computationInfo}}),e.stopReason===ea.ExecutionStopReason.Computation.Done&&vs.x10Logger.log({kind:"pluginCompletedInTime",payload:{pluginName:G0.PluginFactoryName[e.computationInfo.pluginFactoryName],logInfo:e.computationInfo}})}function f2e(e){var r=null;return!(0,il.isNone)(e.formatString)&&!(0,il.isNone)(e.builtIn)&&(r={formatString:e.formatString,builtIn:e.builtIn}),r}});var m2e=Y(Xk=>{_();Object.defineProperty(Xk,"__esModule",{value:!0});Xk.experimentQueueProcessorFactory=Xk.ExperimentQueueProcessor=void 0;var Fte=ft(),S5r=yte(),y5r=ds(),p2e=function(){function e(r){this.consumeMessage=r,this.queue=new S5r.PriorityQueue(function(){return 0})}return e.prototype.enqueue=function(r,n,a){(0,Fte.isDefined)(a)&&r.kind===y5r.SchedulerTimelineQueueMessageKind.StopComputationFrame||this.queue.enqueue(r)},e.prototype.step=function(){var r=this.queue.pop();(0,Fte.isDefined)(r)&&this.consumeMessage(r)},Object.defineProperty(e.prototype,"done",{get:function(){return this.queue.getCount()===0},enumerable:!1,configurable:!0}),e}();Xk.ExperimentQueueProcessor=p2e;var C5r=function(r){return new p2e(r)};Xk.experimentQueueProcessorFactory=C5r;(0,Fte.staticAssertExtends)()});var S2e=Y(t7=>{_();Object.defineProperty(t7,"__esModule",{value:!0});t7.NaiveLocalSheetGrid=void 0;var _5r=ft(),oh=Di(),g2e=gs(),Ite=zu(),WD=kk(),v2e=e0(),h2e=x0(),R5r=ey(),T5r=pv(),b5r=Ai(),P5r=function(){function e(r,n,a,o){this.formats=void 0,this.values=void 0,this.formulae=void 0,this.valueAvailabilitySet=void 0,this.formatAvailabilitySet=void 0,this.formulaAvailabilitySet=void 0,(0,oh.isSuccess)(n)&&(this.values=e.buildSparseMatrix(n.value.nonEmptyCells,function(u){return u}),this.valueAvailabilitySet=e.unionRanges(n.value.availableRanges)),(0,oh.isSuccess)(o)&&(this.formats=e.buildSparseMatrix(o.value.nonEmptyCells,function(u){return u}),this.formatAvailabilitySet=e.unionRanges(o.value.availableRanges)),(0,oh.isSuccess)(a)&&(this.formulae=e.buildSparseMatrix(a.value.nonEmptyCells,function(u){return u}),this.formulaAvailabilitySet=e.unionRanges(a.value.availableRanges))}return e.buildSparseMatrix=function(r,n){for(var a=[],o=0,u=r;o<u.length;o++)for(var t=u[o],d=t[0],s=d[0],c=d[1],l=d[2],f=l===void 0?1:l,p=d[3],m=p===void 0?1:p,v=t.slice(1),h=v.length,S=c,y=0;S<c+m;S+=1)for(var C=s;C<s+f;C+=1,y=(y+1)%h)a[C]===void 0&&(a[C]=[]),a[C][S]=n(v[y],C,S);return a},e.forEachInSparseMatrix=function(r,n,a){a===void 0&&(a=function(){return!1});var o=!0;return r.forEach(function(u,t){o&&u.forEach(function(d,s){if(o&&!a(d)){var c=n((0,g2e.gridCell)(t,s),d);c||(o=!1)}})}),o},e.unionRanges=function(r){return r.map(v2e.createCellSetFromRange).reduce(h2e.unionProduct,R5r.empty)},e.prototype.getCellValue=function(r,n){return this.isAvailable(r,n,"value")?this.values!==void 0&&this.values[r]!==void 0&&this.values[r][n]!==void 0?(0,oh.success)(this.values[r][n]):(0,oh.success)(WD.emptyRangeValue):(0,oh.failure)((0,Ite.unavailable)(["getCellValue"]))},e.prototype.getCellFormat=function(r,n){return this.isAvailable(r,n,"format")?this.formats!==void 0&&this.formats[r]!==void 0&&this.formats[r][n]!==void 0?(0,oh.success)(this.formats[r][n]):(0,oh.success)(WD.emptyRangeFormat):(0,oh.failure)((0,Ite.unavailable)(["getCellFormat"]))},e.prototype.getCellFormula=function(r,n){return this.isAvailable(r,n,"formula")?this.formulae!==void 0&&this.formulae[r]!==void 0&&this.formulae[r][n]!==void 0?(0,oh.success)(this.formulae[r][n]):(0,oh.success)(WD.emptyRangeFormula):(0,oh.failure)((0,Ite.unavailable)(["getCellFormula"]))},e.prototype.foreachNonBlankCellValue=function(r){return this.values===void 0?!0:e.forEachInSparseMatrix(this.values,r,function(n){return n.kind===T5r.OperKind.Blank})},e.prototype.foreachNonBlankCellFormula=function(r){return this.formulae===void 0?!0:e.forEachInSparseMatrix(this.formulae,r,function(n){return n.kind===WD.emptyRangeFormula.kind&&n.formulaBarText===WD.emptyRangeFormula.formulaBarText})},e.prototype.isAvailable=function(r,n,a){var o,u;switch(a){case"value":u=this.valueAvailabilitySet;break;case"formula":u=this.formulaAvailabilitySet;break;case"format":u=this.formatAvailabilitySet;break;default:(0,b5r.assertNever)("isAvailable",a)}return u===void 0?!1:((o=(0,h2e.compareProduct)((0,v2e.createCellSetFromRange)((0,g2e.gridCell)(r,n)),u))!==null&&o!==void 0?o:1)<=0},e}();t7.NaiveLocalSheetGrid=P5r;(0,_5r.staticAssertExtends)()});var w2e=Y(a7=>{_();Object.defineProperty(a7,"__esModule",{value:!0});a7.PrefetchingCache=void 0;var Pl=br(),qg=gs(),y2e=S2e(),RS=zu(),Ci=Di(),E5r=Ai(),Mte=tu(),N5r=ig(),wte=Ok(),jD=ft(),A5r=gT(),Dm=e0(),gp=ey(),QD=x0(),M2e=j9(),wE=Ll(),O5r=qU(),k5r=AP(),F5r=OP(),C2e=Zq(),_2e=U2(),HD=Z1(),R2e=Qu(),I5r=ZB(),M5r=Xv();function T2e(e){var r=e.hasHeadersRow,n=e.hasTotalsRow,a=e.dataRange;return(0,qg.gridRange)(a.row-Number(r),a.col,a.rows+Number(r)+Number(n),a.cols)}function b2e(e,r,n,a){for(var o=r.name,u=r.hasHeadersRow,t=r.hasTotalsRow,d=r.dataRange,s=r.columns,c=u?(0,qg.gridRange)(d.row-1,d.col,1,d.cols):void 0,l=t?(0,qg.gridRange)(d.row+d.rows,d.col,1,d.cols):void 0,f={},p=M2e.RedBlackMapTree.create(e.stringCompareCI),m=0,v=s;m<v.length;m++){var h=v[m];f[h.column]=h,p=p.setValue(h.name,h)}return{name:o,sheet:n,dataRange:d,headersRange:c,totalsRange:l,allRange:a,indexToColumn:f,nameToColumn:p,allColumnNamesAvailable:s.length===d.cols}}function w5r(){return{cellTiles:[],tables:(0,A5r.makeGridRangeTable)(),tableTiles:[],hiddenRows:gp.empty,hiddenRowsAvailability:gp.empty,hiddenCols:gp.empty,hiddenColsAvailability:gp.empty}}function P2e(e,r){var n;return((n=(0,QD.compareProduct)((0,Dm.createCellSetFromRange)(r),e))!==null&&n!==void 0?n:1)<=0}var E2e=(0,Ci.failure)((0,RS.unavailable)(["getCell"])),N2e=(0,Ci.failure)((0,RS.unavailable)(["getContainingTable"])),A2e=(0,Ci.failure)((0,RS.unavailable)(["getIntersectingTables"])),O2e=(0,Ci.failure)((0,RS.unavailable)(["getIntersectingTableNames"])),k2e=(0,Ci.failure)((0,RS.unavailable)(["getIformats"])),F2e=(0,Ci.failure)((0,RS.unavailable)(["GetAvailableTableHeaders"]));function I2e(e,r){var n=Object.create(e);for(var a in r)n[a]=r[a];return n}var D5r=function(){function e(r,n,a){this.grid=r,this.syncDataStore=n,this.correlationId=a,this.correspondingSnapshotID=-1,this.sheet2contents=(0,jD.makeStringMap)(),this.currentDocumentLoc=(0,qg.documentLoc)(void 0,""),this.formatPages=[],this.formulaCache=new Map,this.englishFormulaCache=new Map,this.builtInFormatCache=new Map,this.customFormatCache=new Map,this.parser=(0,C2e.createParser)(n),this.analyzer=(0,_2e.createAnalyzer)(n),this.formatter=(0,O5r.createNumberFormatter)(n),this.resolver=(0,I5r.createResolver)(n);var o=I2e(n,{config:I2e(n.config,{localeInfo:(0,Mte.getEnglishLocaleInfo)()})});this.englishParser=(0,C2e.createParser)(o),this.englishAnalyzer=(0,_2e.createAnalyzer)(o)}return e.getOrFetchTile=function(r,n,a){var o=n.range.row>>>e.tileHeightPow,u=n.range.col>>>e.tileWidthPow;r[o]===void 0&&(r[o]=[]);var t=r[o][u];if(t===void 0){var d=(0,qg.sheetGridRange)(n.sheet,(0,qg.gridRange)(o<<e.tileHeightPow,u<<e.tileWidthPow,1<<e.tileHeightPow,1<<e.tileWidthPow));return a(d).then(function(s){return r[o][u]=s})}return t},e.create=function(r,n,a){return new e(r,n,a)},e.prototype.getSheetContents=function(r){var n;return(n=this.sheet2contents[r])!==null&&n!==void 0?n:this.sheet2contents[r]=w5r()},e.prototype.getCurrentDocumentLoc=function(){return this.currentDocumentLoc},e.prototype.getSheetNames=function(){var r;if(this.sheetNames===void 0){var n=[];this.syncDataStore.sheets.forEachSheet(function(c){n.push({sheetIndex:c.sheetIndex,sheetName:c.name})});for(var a={},o=M2e.RedBlackMapTree.create(this.syncDataStore.config.localeInfo.stringCompareCI),u=0;u<n.length;u+=1){var t=(r=n[u],r.sheetIndex),d=r.sheetName;a[t.index]=u,o=o.setValue(d,u)}var s=this.getCurrentDocumentLoc();this.sheetNames={document:s,sheets:n,idToIndex:a,nameToIndex:o}}return(0,Ci.success)(this.sheetNames)},e.prototype.getRangeValues=function(r){return this.grid.getRangeValues(this.correlationId,r)},e.prototype.getRangeFormulae=function(r){return this.grid.getRangeFormulae(this.correlationId,r)},e.prototype.getRangeFormats=function(r){return this.grid.getRangeFormats(this.correlationId,r)},e.prototype.getHiddenRows=function(r,n,a){return(0,Pl.__awaiter)(this,void 0,void 0,function(){var o,u,t,d,s,c,l;return(0,Pl.__generator)(this,function(f){switch(f.label){case 0:return o=this.getSheetContents(r.index),u=Dm.bspFactory.row([n,a]),t=(0,gp.compare)(u,o.hiddenRowsAvailability),d=t===0||t===-1,d?[3,2]:[4,this.grid.getHiddenRows(this.correlationId,r,(0,jD.fastMax)(0,n-10),(0,jD.fastMin)(qg.sheetRows,a+10))];case 1:s=f.sent(),o.hiddenRows=s.hidden.reduce(function(p,m){var v=m.start,h=m.end;return(0,gp.union)(p,Dm.bspFactory.row([v,h]))},o.hiddenRows),o.hiddenRowsAvailability=s.available.reduce(function(p,m){var v=m.start,h=m.end;return(0,gp.union)(p,Dm.bspFactory.row([v,h]))},o.hiddenRowsAvailability),f.label=2;case 2:return c=[],(0,Dm.forEachRow)((0,gp.intersect)(o.hiddenRowsAvailability,u),function(p){var m=p[0],v=p[1];return c.push((0,HD.interval)(m,v)),!0}),l=[],(0,Dm.forEachRow)((0,gp.intersect)(o.hiddenRows,u),function(p){var m=p[0],v=p[1];return l.push((0,HD.interval)(m,v)),!0}),[2,{available:c,hidden:l}]}})})},e.prototype.getHiddenCols=function(r,n,a){return(0,Pl.__awaiter)(this,void 0,void 0,function(){var o,u,t,d,s,c,l;return(0,Pl.__generator)(this,function(f){switch(f.label){case 0:return o=this.getSheetContents(r.index),u=Dm.bspFactory.col([n,a]),t=(0,gp.compare)(u,o.hiddenColsAvailability),d=t===0||t===-1,d?[3,2]:[4,this.grid.getHiddenCols(this.correlationId,r,(0,jD.fastMax)(0,n-10),(0,jD.fastMin)(qg.sheetCols,a+10))];case 1:s=f.sent(),o.hiddenCols=s.hidden.reduce(function(p,m){var v=m.start,h=m.end;return(0,gp.union)(p,Dm.bspFactory.col([v,h]))},o.hiddenCols),o.hiddenColsAvailability=s.available.reduce(function(p,m){var v=m.start,h=m.end;return(0,gp.union)(p,Dm.bspFactory.col([v,h]))},o.hiddenColsAvailability),f.label=2;case 2:return c=[],(0,Dm.forEachCol)((0,gp.intersect)(o.hiddenColsAvailability,u),function(p){var m=p[0],v=p[1];return c.push((0,HD.interval)(m,v)),!0}),l=[],(0,Dm.forEachCol)((0,gp.intersect)(o.hiddenCols,u),function(p){var m=p[0],v=p[1];return l.push((0,HD.interval)(m,v)),!0}),[2,{available:c,hidden:l}]}})})},e.prototype.getRange=function(r,n){return(0,Pl.__awaiter)(this,void 0,void 0,function(){var a,o,u,t,d,s,c,l;return(0,Pl.__generator)(this,function(f){switch(f.label){case 0:return a=n===void 0||n.indexOf("values")>-1,o=n===void 0||n.indexOf("formulae")>-1,u=n===void 0||n.indexOf("formats")>-1,t=(0,Ci.failure)((0,RS.unavailable)(["getRange"])),[4,Promise.all([a?this.getRangeValues(r):t,o?this.getRangeFormulae(r):t,u?this.getRangeFormats(r):t])];case 1:return d=(l=f.sent(),l[0]),s=l[1],c=l[2],[2,new y2e.NaiveLocalSheetGrid(r.sheet,d,s,c)]}})})},e.prototype.getCell=function(r){var n=this,a=this.getSheetContents(r.sheet.index),o=e.getOrFetchTile(a.cellTiles,r,function(u){return(0,Pl.__awaiter)(n,void 0,void 0,function(){var t,d,s,c,l;return(0,Pl.__generator)(this,function(f){switch(f.label){case 0:return[4,this.grid.getRangeValues(this.correlationId,u)];case 1:return l=[f.sent()],[4,this.grid.getRangeFormulae(this.correlationId,u)];case 2:return l=l.concat([f.sent()]),[4,this.grid.getRangeFormats(this.correlationId,u)];case 3:return t=l.concat([f.sent()]),d=t[0],s=t[1],c=t[2],!(0,Ci.isSuccess)(d)||!(0,Ci.isSuccess)(s)||!(0,Ci.isSuccess)(c)?[2,"unavailable"]:[2,new y2e.NaiveLocalSheetGrid(r.sheet,d,s,c)]}})})});return(0,wte.bindMaybeThenable)(o,function(u){if(u==="unavailable")return E2e;var t=u.getCellValue(r.range.row,r.range.col),d=u.getCellFormula(r.range.row,r.range.col),s=u.getCellFormat(r.range.row,r.range.col);return!(0,Ci.isSuccess)(t)||!(0,Ci.isSuccess)(d)||!(0,Ci.isSuccess)(s)?E2e:(0,Ci.success)({value:t.value,formula:d.value,format:s.value})})},e.prototype.getAvailableTableHeaders=function(r){var n=this.syncDataStore.nameManager;if(!n)return F2e;var a=n.getAllDocumentNames(),o=a.find(function(t){return t.name===r});if(!o)return F2e;var u=n.getAvailableTableColumns(o);return(0,Ci.success)(u)},e.prototype.getStructRefColumn=function(r,n){var a=this.syncDataStore.getStructRefColumn(r,n);return a.kind===Ci.ResultKind.Failure?(0,Ci.failure)((0,RS.unavailable)(["getStructRefColumn"])):a},e.prototype.getStructRefSpecialRef=function(r,n){var a=this.syncDataStore.getStructRefSpecialRef(r,n);return a.kind===Ci.ResultKind.Failure?(0,Ci.failure)((0,RS.unavailable)(["getStructRefSpecialRef"])):a},e.prototype.getContainingTableName=function(r){var n=this.syncDataStore.getContainingTable(r);return n.kind===Ci.ResultKind.Failure?(0,Ci.failure)((0,RS.unavailable)(["getContainingTableName"])):n},e.prototype.getContainingTable=function(r){return(0,Pl.__awaiter)(this,void 0,void 0,function(){var n,a,o=this;return(0,Pl.__generator)(this,function(u){return n=this.getSheetContents(r.sheet.index),a=e.getOrFetchTile(n.tableTiles,r,function(t){return(0,Pl.__awaiter)(o,void 0,void 0,function(){var d,s,c,l,f,p;return(0,Pl.__generator)(this,function(m){switch(m.label){case 0:return[4,this.grid.getIntersectingTables(this.correlationId,t)];case 1:if(d=m.sent(),!(0,Ci.isSuccess)(d))return[2,"unavailable"];for(s=d.value.availableRanges.map(Dm.createCellSetFromRange).reduce(QD.unionProduct,gp.empty),c=0,l=d.value.tables;c<l.length;c++)f=l[c],p=T2e(f),n.tables.getValue(p)||(n.tables=n.tables.setValue(p,b2e(this.syncDataStore.config.localeInfo,f,r.sheet,p)));return[2,s]}})})}),[2,(0,wte.bindMaybeThenable)(a,function(t){if(t==="unavailable")return N2e;var d;return n.tables.forEachGe(r.range,function(s,c){return d=c,!1}),d!==void 0||P2e(t,r.range)?(0,Ci.success)(d):N2e})]})})},e.prototype.getIntersectingTables=function(r){return(0,Pl.__awaiter)(this,void 0,void 0,function(){var n,a,o,u,t,d,s,c,l,f,p=this;return(0,Pl.__generator)(this,function(m){switch(m.label){case 0:n=this.getSheetContents(r.sheet.index),a=gp.empty,o=r.range.row,u=r.range.row+r.range.rows,m.label=1;case 1:if(!(o<u))return[3,8];t=r.range.col,d=r.range.col+r.range.cols,m.label=2;case 2:return t<d?(s=e.getOrFetchTile(n.tableTiles,(0,qg.sheetGridCell)(r.sheet,(0,qg.gridCell)(o,t)),function(v){return p.fetchTableTile(v.sheet,n,v)}),(0,wte.isThenable)(s)?[4,s]:[3,4]):[3,7];case 3:return l=m.sent(),[3,5];case 4:l=s,m.label=5;case 5:if(c=l,c==="unavailable")return[2,A2e];a=(0,QD.unionProduct)(a,c),m.label=6;case 6:return t+=1<<e.tileWidthPow,[3,2];case 7:return o+=1<<e.tileHeightPow,[3,1];case 8:return f=[],n.tables.forEachMeets(r.range,function(v,h){return f.push(h),a=(0,QD.unionProduct)(a,(0,Dm.createCellSetFromRange)(v)),!0}),[2,P2e(a,r.range)?(0,Ci.success)(f):A2e]}})})},e.prototype.getIntersectingTableNames=function(r){if(this.syncDataStore.nameManager===void 0)return O2e;var n=this.syncDataStore.nameManager.getIntersectingTables(r);return n.kind===Ci.ResultKind.Failure?O2e:n},e.prototype.fetchTableTile=function(r,n,a){return(0,Pl.__awaiter)(this,void 0,void 0,function(){var o,u,t,d,s,c;return(0,Pl.__generator)(this,function(l){switch(l.label){case 0:return[4,this.grid.getIntersectingTables(this.correlationId,a)];case 1:if(o=l.sent(),!(0,Ci.isSuccess)(o))return[2,"unavailable"];for(u=o.value.availableRanges.map(Dm.createCellSetFromRange).reduce(QD.unionProduct,gp.empty),t=0,d=o.value.tables;t<d.length;t++)s=d[t],c=T2e(s),n.tables.getValue(c)||(n.tables=n.tables.setValue(c,b2e(this.syncDataStore.config.localeInfo,s,r,c)));return[2,u]}})})},e.prototype.getIformat=function(r,n){return(0,Pl.__awaiter)(this,void 0,void 0,function(){var a,o,u,t,d,s,c,l,f,p;return(0,Pl.__generator)(this,function(m){switch(m.label){case 0:return a=n>>>e.formatPagePow,o=a<<e.formatPagePow,u=o+(1<<e.formatPagePow),t=this.formatPages[a],t!==void 0?[3,2]:[4,this.grid.getIformats(this.correlationId,r,o,u)];case 1:if(d=m.sent(),!(0,Ci.isSuccess)(d))t=this.formatPages[a]="unavailable";else{for(s=[],c=0,l=d.value.availableFormats;c<l.length;c++)f=l[c],!(f.iformat<o||f.iformat>=u)&&(s[f.iformat-o]=f);t=this.formatPages[a]=s}m.label=2;case 2:return t==="unavailable"?[2,k2e]:(p=t[n-o],p===void 0?[2,k2e]:[2,(0,Ci.success)(p)])}})})},e.prototype.parseCellFormula=function(r,n,a){return{result:e.cachedParseFormula(a?this.englishFormulaCache:this.formulaCache,a?this.englishParser:this.parser,a?this.englishAnalyzer:this.analyzer,r,n)}},e.prototype.parseEdit=function(r,n){var a;return(0,Pl.__awaiter)(this,void 0,void 0,function(){var o;return(0,Pl.__generator)(this,function(u){switch(u.label){case 0:return[4,this.getEditFormat(r)];case 1:return o=(a=u.sent())!==null&&a!==void 0?a:{valueType:wE.FormatValueType.General,bidiDate:void 0,culture:void 0},[2,this.parseEditInternal(r,n,o)]}})})},e.prototype.parseEditSync=function(r,n,a){var o=this.parseNumberFormat(a.formatString,a.builtIn).result,u;return(0,Ci.isSuccess)(o)?u=o.value:u={valueType:wE.FormatValueType.General,bidiDate:void 0,culture:void 0},this.parseEditInternal(r,n,u)},e.prototype.resolveReferences=function(r,n){var a=this;return n.map(function(o){switch(o.kind){case R2e.NodeKind.StructRef:return a.resolveStructRefSync(r,o).result;case R2e.NodeKind.CellRef:return a.resolveCellRefNodeSync(r,o).result}})},e.prototype.getCorrespondingSnapshotID=function(){return(0,Pl.__awaiter)(this,void 0,void 0,function(){var r;return(0,Pl.__generator)(this,function(n){switch(n.label){case 0:return this.correspondingSnapshotID!==-1?[3,2]:(r=this,[4,this.grid.getCorrespondingSnapshotID(this.correlationId)]);case 1:r.correspondingSnapshotID=n.sent(),n.label=2;case 2:return[2,this.correspondingSnapshotID]}})})},e.prototype.parseEditInternal=function(r,n,a){var o=this.formatter.parseEdit(n,a);if(!(0,Ci.isSuccess)(o))return{result:o};if(o.value.kind===wE.EditKind.String&&n==="="&&a.valueType!==wE.FormatValueType.Text&&(o=(0,Ci.success)((0,wE.formulaEdit)(n))),o.value.kind!==wE.EditKind.Formula)return{result:(0,Ci.success)(o.value)};var u=e.parseCheckedFormula(this.parser,this.analyzer,r,o.value.fmla,r.range);return(0,Ci.isSuccess)(u)?{result:(0,Ci.success)({kind:wE.EditKind.Formula,fmla:o.value.fmla,formula:u.value})}:{result:u}},e.prototype.getEditFormat=function(r){return(0,Pl.__awaiter)(this,void 0,void 0,function(){var n,a,o,u,t,d;return(0,Pl.__generator)(this,function(s){switch(s.label){case 0:return[4,this.getCell(r)];case 1:return n=s.sent(),(0,Ci.isSuccess)(n)?typeof n.value.format!="string"?[3,2]:(a=this.parseNumberFormat(n.value.format,!1).result,[3,4]):[2,void 0];case 2:return[4,this.getIformat(r.sheet.document,n.value.format)];case 3:if(o=s.sent(),!(0,Ci.isSuccess)(o))return[2,void 0];u=(d=o.value,d.formatString),t=d.builtIn,a=this.parseNumberFormat(u,t).result,s.label=4;case 4:return[2,(0,Ci.isSuccess)(a)?a.value:void 0]}})})},e.cachedParseFormula=function(r,n,a,o,u){var t,d=r.get(u);if(d!==void 0)return d;var s=e.parseWellFormedFormula(n,a,o,u.formulaBarText,(t=u.origin)!==null&&t!==void 0?t:o.range);return r.set(u,s),s},e.parseWellFormedFormula=function(r,n,a,o,u){var t=e.parseCheckedFormula(r,n,a,o,u);return(0,Ci.isSuccess)(t)?(0,RS.isWellFormed)(t.value)?(0,Ci.success)(t.value):(0,Ci.failure)((0,HD.illFormedFormula)("ill-formed formula")):t},e.parseCheckedFormula=function(r,n,a,o,u){var t=r.parseFormula((0,k5r.parseLocals)(qg.LexicalKind.Cell,u),o);if(!(0,Ci.isSuccess)(t))return t;var d=n.checkFormula((0,F5r.analyzeLocalsGrid)(qg.LexicalKind.Cell,(0,qg.sheetGridCell)(a.sheet,u)),t.value);return(0,Ci.isSuccess)(d)?(0,Ci.success)(d.value):d},e.prototype.parseNumberFormat=function(r,n){return{result:this.cachedParseNumberFormat(r,n)}},e.prototype.evalOnClonedModel=function(r,n){return this.grid.evalClonedModelOnSnapshot(this.correlationId,r,n)},e.prototype.evalFormula=function(r,n,a){return this.grid.evalFormulaOnSnapshot(this.correlationId,r,n,a)},e.prototype.cachedParseNumberFormat=function(r,n){var a=n?this.builtInFormatCache.get(r):this.customFormatCache.get(r);if(a!==void 0)return a;var o=this.formatter.createFormat(r,n);return n?this.builtInFormatCache.set(r,o):this.customFormatCache.set(r,o),o},e.prototype.resolveStructRefSync=function(r,n){return{result:this.resolver.resolveStructRef(r,n)}},e.prototype.resolveCellRefNodeSync=function(r,n){return{result:this.resolver.resolveCellRef(r,n)}},e.prototype.close=function(){this.grid.discardSnapshot(this.correlationId).catch(function(r){E5r.ulsLogger.ULS.traceTag(553734788,Mte.LogCategory.msoulscat_ES_EWAJS,Mte.TraceLevel.Warning,M5r.x10Logger.formatLogMessage("PrefetchingCache.close",{description:(0,N5r.messageFromError)(r)}))})},e.tileWidthPow=2,e.tileHeightPow=4,e.formatPagePow=6,e}();a7.PrefetchingCache=D5r});var G2e=Y(Cy=>{_();Object.defineProperty(Cy,"__esModule",{value:!0});Cy.timelineQueueProcessorFactory=Cy.dynamicPluginLoaderInsideInit=Cy.createPrefetchingCacheFactory=Cy.DynamicPluginLoader=void 0;var Vl=br(),zD=L5r(oC()),i7=Ol(),$k=kte(),Zk=e3(),B2e=Ai(),D2e=Cd(),YD=ft(),Lte=FD(),x5r=Yne(),Dte=_8(),x2e=cu(),xte=Xv(),L2e=w2e();function q2e(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,n=new WeakMap;return(q2e=function(o){return o?n:r})(e)}function L5r(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var n=q2e(r);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(u!=="default"&&Object.prototype.hasOwnProperty.call(e,u)){var t=o?Object.getOwnPropertyDescriptor(e,u):null;t&&(t.get||t.set)?Object.defineProperty(a,u,t):a[u]=e[u]}return a.default=e,n&&n.set(e,a),a}var U2e=function(){function e(r,n){if(!(n instanceof $k.FormulaBarScheduler))throw new TypeError("DynamicPluginLoaderBase.constructor: unknown IFormulaBarScheduler class: ".concat(JSON.stringify(n)));this.scheduler=n,xte.x10Logger.threadId=r}return e.prototype.loadPluginScriptTrace=function(r,n){B2e.ulsLogger.ULS.traceTag(553734797,i7.LogCategory.msoulscat_ES_EWAJS,i7.TraceLevel.Info,xte.x10Logger.formatLogMessage("loadPluginScript",{description:"".concat(r," loaded, time to load ").concat(n)}))},e.prototype.createAndAttachPlugin=function(r,n){return(0,Vl.__awaiter)(this,void 0,void 0,function(){var a;return(0,Vl.__generator)(this,function(o){return a=(0,D2e.getPluginFactory)(r),this.scheduler.createAndAttachPlugin(a,n),[2]})})},e.prototype.createAndAttachSyncPlugin=function(r,n){return(0,Vl.__awaiter)(this,void 0,void 0,function(){var a;return(0,Vl.__generator)(this,function(o){return a=(0,D2e.getPluginFactory)(r),this.scheduler.createAndAttachSyncPlugin(a,n),[2]})})},e}(),B5r=function(e){(0,Vl.__extends)(r,e);function r(n,a,o,u){var t=e.call(this,"Main",o)||this;t.threadEntryPoint=n,t.gridManager=a,t.loader=u;var d=u.getConfig();return t.resolveScript=d.resolveScript,t}return r.prototype.loadPluginScript=function(n,a){return(0,Vl.__awaiter)(this,void 0,void 0,function(){var o,u,t;return(0,Vl.__generator)(this,function(d){switch(d.label){case 0:return(0,YD.isNone)(n)||(0,YD.isNone)(a)?[2]:(o=Lte.defaultTimerInterface,u=o.now(),[4,this.loader.loadScript(n)]);case 1:return d.sent(),t=o.now()-u,this.loadPluginScriptTrace(n,t),[2]}})})},r.prototype.isThreadingSupported=function(){return zD.isThreadingSupported()&&(0,Zk.getCalcAbsUrl)()!==void 0},r.prototype.createPluginThread=function(n){return(0,Vl.__awaiter)(this,void 0,void 0,function(){var a,o,u,t,d,s,c,l=this;return(0,Vl.__generator)(this,function(f){switch(f.label){case 0:return a="DynamicPluginLoaderThread-".concat(r.lastThreadNum+=1,"-").concat(n),o="".concat(a,"-IGrid"),[4,Zk.initCalcCalled];case 1:return f.sent(),[4,zD.createWorker({createMode:"Thread",id:a},zD.paramInsideDef({scriptUrl:(0,Zk.getCalcAbsUrlOrThrow)(),insideInitName:this.threadEntryPoint},{pluginResponseWindows:this.scheduler.getPluginResponseWindows()}),function(){return(0,Vl.__assign)((0,Vl.__assign)({},(0,Dte.bindMethods)(l.scheduler,(0,Vl.__spreadArray)((0,Vl.__spreadArray)([],$k.parentMethodsCall,!0),$k.parentMethodsPost,!0))),{resolveScript:l.resolveScript})})];case 2:u=f.sent(),f.label=3;case 3:return f.trys.push([3,5,,6]),t=function(){},u.onClose=function(){t(),B2e.ulsLogger.ULS.traceTag(553734798,i7.LogCategory.msoulscat_ES_EWAJS,i7.TraceLevel.Info,xte.x10Logger.formatLogMessage("DynamicPluginLoader",{description:"Thread closed"}))},[4,(0,Zk.initCalcThread)(u)];case 4:return d=f.sent(),t=function(){return d.close()},this.scheduler.doNotifyStatelessSubject.subscribe(function(p){return u.post.processNotification(p)}),this.scheduler.requestWithCorrelationIdSubject.subscribe(function(p){var m;return(m=u.post).requestWithCorrelationId.apply(m,p)}),this.scheduler.doNotifyStatefulSubject.subscribe(function(p){return u.post.processNotification(p)}),s={createIGridImportEndpoint:function(m){return u.call.createIGridImportEndpoint.transfer([m.port],m)},onGridExporterClosed:u.post.onGridExporterClosed},this.gridManager.onGridImporterCreated(s,o),[2,new q5r(u)];case 5:throw c=f.sent(),u.close(),c;case 6:return[2]}})})},r.lastThreadNum=0,r}(U2e);Cy.DynamicPluginLoader=B5r;var q5r=function(){function e(r){this.outside=r}return e.prototype.loadPluginScript=function(r,n){return this.outside.call.loadPluginScript(r,n)},e.prototype.createAndAttachPlugin=function(r,n){return this.outside.call.createAndAttachPlugin(r,n)},e.prototype.createAndAttachSyncPlugin=function(r,n){return this.outside.call.createAndAttachSyncPlugin(r,n)},e.prototype.recalcServiceAttached=function(){return this.outside.call.recalcServiceAttached()},e.prototype.close=function(){this.outside.close()},e}(),U5r=function(r){return function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];var o=r.getGrid();if(o!==void 0)return L2e.PrefetchingCache.create.apply(L2e.PrefetchingCache,(0,Vl.__spreadArray)([o],n,!1))}};Cy.createPrefetchingCacheFactory=U5r;var G5r=function(r){return function(n){return new Lte.TimelineQueueProcessor(function(a,o){return a.kind-o.kind},n,void 0,r)}};Cy.timelineQueueProcessorFactory=G5r;var K5r=function(r,n){return function(a,o){var u=a.config,t=a.connection,d=o.pluginResponseWindows;return(0,Vl.__awaiter)(void 0,void 0,void 0,function(){return(0,Vl.__generator)(this,function(s){return[2,zD.Endpoint.createInside(t,function(c){var l=(0,Vl.__assign)((0,Vl.__assign)({},(0,Dte.bindLazyMethods)(new x2e.ResettableLazy(function(){return c.call}),$k.parentMethodsCall)),(0,Dte.bindLazyMethods)(new x2e.ResettableLazy(function(){return c.post}),$k.parentMethodsPost)),f=void 0,p=new x5r.GridProvider(function(){return m.registerAsyncGrid()}),m=new $k.FormulaBarScheduler(r(f),n(p),d,f,l);return new V5r(String(t.options.id),p,m,u,c)})]})})}};Cy.dynamicPluginLoaderInsideInit=K5r;var V5r=function(e){(0,Vl.__extends)(r,e);function r(n,a,o,u,t){var d=e.call(this,n,o)||this;return d.gridImporter=a,d.twConfig=u,d.inside=t,d.loadedScripts=(0,YD.makeStringMap)(),d.initCalcThreadInside=function(s,c,l){return(0,Vl.__awaiter)(d,void 0,void 0,function(){return(0,Vl.__generator)(this,function(f){switch(f.label){case 0:return[4,(0,Zk.initCalcInThread)(s,c,l,this.twConfig)];case 1:return f.sent(),[2]}})})},d.createIGridImportEndpoint=d.gridImporter.createIGridImportEndpoint.bind(d.gridImporter),d.onGridExporterClosed=d.gridImporter.onGridExporterClosed.bind(d.gridImporter),d.processNotification=d.scheduler.processNotification.bind(d.scheduler),d.requestWithCorrelationId=d.scheduler.requestWithCorrelationId.bind(d.scheduler),d}return r.prototype.loadPluginScript=function(n,a){return(0,Vl.__awaiter)(this,void 0,void 0,function(){var o,u,t,d,s;return(0,Vl.__generator)(this,function(c){switch(c.label){case 0:return(0,YD.isNone)(n)||(0,YD.isNone)(a)?[2]:this.loadedScripts[n]===!0?[2]:(o=Lte.defaultTimerInterface,u=o.now(),d=(t=zD).importScriptsWithRetry,[4,this.inside.call.resolveScript({identifier:n,isLocalized:a})]);case 1:return d.apply(t,[[c.sent()],Zk.maxRetriesForLoadingScript]),s=o.now()-u,this.loadedScripts[n]=!0,this.loadPluginScriptTrace(n,s),[2]}})})},r.prototype.recalcServiceAttached=function(){return this.scheduler.recalcServiceAttached()},r}(U2e)});var rF=Y(Ry=>{_();Object.defineProperty(Ry,"__esModule",{value:!0});Ry.PluginSchedulerSingleton=Ry.GridImportManagerSingleton=void 0;Ry.createDynamicPluginLoader=Q5r;Ry.dynamicPluginLoaderInsideInit=void 0;Ry.getSchedulerFactories=XD;var eF=br(),W5r=Jc(),o7=ft(),V2e=Yne(),JD=kte(),j5r=m2e(),_y=G2e(),Bte,H5r=(0,o7.singleton)(function(){var e=XD().createGridProvider(function(){return Ute.instance().registerAsyncGrid()});return qte.instance().onGridImporterCreated(e,"Main-IGrid"),e}),qte=(0,o7.singleton)(function(){return XD().createGridImportManager()});Ry.GridImportManagerSingleton=qte;var Ute=(0,o7.singleton)(function(){return XD().createFormulaBarScheduler(H5r.instance())});Ry.PluginSchedulerSingleton=Ute;(0,o7.staticAssertExtends)();function Q5r(e){return XD().createDynamicPluginLoader(qte.instance(),Ute.instance(),e)}var z5r="excelOnlineCalc.x10.stableDynamicPluginLoaderInsideInit",Y5r=function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];return new(JD.FormulaBarScheduler.bind.apply(JD.FormulaBarScheduler,(0,eF.__spreadArray)([void 0,(0,_y.timelineQueueProcessorFactory)(n[1]),(0,_y.createPrefetchingCacheFactory)(r)],n,!1)))},J5r=function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];return new(_y.DynamicPluginLoader.bind.apply(_y.DynamicPluginLoader,(0,eF.__spreadArray)([void 0,r],n,!1)))},X5r=(0,_y.dynamicPluginLoaderInsideInit)(_y.timelineQueueProcessorFactory,_y.createPrefetchingCacheFactory);Ry.dynamicPluginLoaderInsideInit=X5r;var Z5r=function(r){return new V2e.GridImportManager(r)},$5r=function(r){return new V2e.GridProvider(r)},e6r=function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];var o,u=function(s){return o=new j5r.ExperimentQueueProcessor(s),o},t=new(JD.FormulaBarScheduler.bind.apply(JD.FormulaBarScheduler,(0,eF.__spreadArray)([void 0,u,(0,_y.createPrefetchingCacheFactory)(r)],n,!1)));if(o===void 0)throw"not initialized";return[t,o]},K2e=function(e){(0,eF.__extends)(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return Object.defineProperty(r.prototype,"ComputationFinalizerHandlers",{get:function(){return this.computationFinalizerHandlers},set:function(a){this.computationFinalizerHandlers=a},enumerable:!1,configurable:!0}),r}(JD.FormulaBarScheduler),r6r=function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];return new(K2e.bind.apply(K2e,(0,eF.__spreadArray)([void 0,(0,_y.timelineQueueProcessorFactory)(n[1]),(0,_y.createPrefetchingCacheFactory)(r)],n,!1)))},n6r={createFormulaBarScheduler:Y5r,createDynamicPluginLoader:function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return J5r.apply(void 0,(0,eF.__spreadArray)([z5r],r,!1))},createGridImportManager:Z5r,createGridProvider:$5r,createExperimentFormulaBarScheduler:e6r,createTestableFormulaBarScheduler:r6r};function XD(){return n6r}if((0,W5r.getTypedFeatureGate)("TESTING_ONLY_SCHEDULER_IMPORTSCRIPTS_FAIL")&&(self.__retries=((Bte=self.__retries)!==null&&Bte!==void 0?Bte:-1)+1,self.__retries===0))throw""});var X2e=Y(Kte=>{_();Object.defineProperty(Kte,"__esModule",{value:!0});Kte.createRecalcService=s6r;var u7=br(),Gte=o6r(oC()),__=Ol(),s7=Ai(),t6r=h8(),W2e=ig(),a6r=Ok(),j2e=ft(),H2e=rF(),ZD=m_(),Q2e=e3(),i6r=Vne();function J2e(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,n=new WeakMap;return(J2e=function(o){return o?n:r})(e)}function o6r(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var n=J2e(r);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(u!=="default"&&Object.prototype.hasOwnProperty.call(e,u)){var t=o?Object.getOwnPropertyDescriptor(e,u):null;t&&(t.get||t.set)?Object.defineProperty(a,u,t):a[u]=e[u]}return a.default=e,n&&n.set(e,a),a}var z2e=3e4,Y2e=3,u6r=1e3;function s6r(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var a=r[0],o=r[1];return(0,u7.__awaiter)(this,void 0,void 0,function(){function u(w){w===void 0&&(w="Requested"),v=w,p.close()}var t,d,s,c,l,f,p,m,v,h,S,y,C,E,I,F=this;return(0,u7.__generator)(this,function(w){switch(w.label){case 0:return t=typeof a=="boolean"?a?[new H2e.PluginSchedulerSingleton().instance(),new H2e.GridImportManagerSingleton().instance()]:[void 0,void 0]:[a,o],d=t[0],s=t[1],c=-(1/0),l=!1,f={onRecalcResults:function(k){},onUpdateRequest:function(k){},onGC:function(k){c=k},onAlert:function(k){if(!l){var x=document.createElement("div"),G=document.createElement("p");G.textContent=k,x.appendChild(G);var H=document.createElement("button");H.textContent="OK",x.appendChild(H),x.setAttribute("style","position: fixed; top: 0; left: 30%; right: 30%; background: red; color: white; font-size: 16px; font-weight: bold; z-index: 1000; padding: 3em; white-space: pre-line;"),H.onclick=function(){document.body.removeChild(x)},document.body.appendChild(x),l=!0}}},[4,Gte.createWorker({id:"RecalcService",createMode:e},{local:t6r.recalcServiceInsideInit,thread:{scriptUrl:(0,Q2e.getCalcAbsUrlOrThrow)(),insideInitName:"excelOnlineCalc.calc.recalcServiceInsideInit"}},function(){return f})];case 1:p=w.sent(),m=[],v="Requested",p.onClose=function(){for(var B=0,k=m;B<k.length;B++){var x=k[B];try{x()}catch(H){s7.ulsLogger.ULS.traceTag(539341771,__.LogCategory.msoulscat_ES_EWAJS,__.TraceLevel.Warning,"calc.calc.createRecalcService.service.onClose: callback threw ".concat((0,W2e.messageFromError)(H)))}}var G="calc.calc.createRecalcService.service.onClose: recalc service closed; reason = ".concat(v);s7.ulsLogger.ULS.traceTag(561534148,__.LogCategory.msoulscat_ES_EWAJS,v==="Requested"?__.TraceLevel.Info:__.TraceLevel.Warning,G)},w.label=2;case 2:return w.trys.push([2,5,,6]),p.createMode!=="Thread"?[3,4]:[4,(0,Q2e.initCalcThread)(p)];case 3:h=w.sent(),m.push(function(){return h.close()}),(0,i6r.logMissingJSFeatures)(p.call.getMissingJSFeatures),w.label=4;case 4:return p.call.ping.callTimeout=z2e,S=Y2e,y=0,C=function(){},(0,a6r.promiseLoop)(function(){return(0,u7.__awaiter)(F,void 0,void 0,function(){var B,k,x,G,H,L,D;return(0,u7.__generator)(this,function(U){switch(U.label){case 0:return[4,new Promise(function(V){return setTimeout(V,u6r)})];case 1:if(U.sent(),p.hasBeenClosed())return[2,void 0];B=p.call.ping.callTimeout,k=(0,j2e.now)(),U.label=2;case 2:return U.trys.push([2,4,,5]),[4,p.call.ping()];case 3:return U.sent(),[3,5];case 4:if(x=U.sent(),!Gte.WorkerError.isWorkerError(x)||x.info.cause!=="Timeout")throw x;return G=(0,j2e.now)()-k,y+=1,y>=S&&u("Unresponsive"),H=p.hasBeenClosed(),L={timeout:B,waitTime:G,timeoutCount:y,hasBeenClosed:H},D="calc.calc.RecalcService: unresponsive; ".concat(JSON.stringify(L)),s7.ulsLogger.ULS.traceTag(561534149,__.LogCategory.msoulscat_ES_EWAJS,__.TraceLevel.Warning,D),C(B,G,y,H),[2,!0];case 5:return y=0,[2,!0]}})})},!0).catch(function(B){var k="calc.calc.RecalcService: ping loop threw an error: ".concat((0,W2e.messageFromError)(B));s7.ulsLogger.ULS.traceTag(561534150,__.LogCategory.msoulscat_ES_EWAJS,__.TraceLevel.Warning,k)}),p.post.updateRanges.onPostMessageError=Gte.dispatchWorkerError,E={setOnRecalcResults:function(k){f.onRecalcResults=k},setOnUpdateRequest:function(k){f.onUpdateRequest=k},setOnUnresponsive:function(k){C=k},setA1ReferenceStyle:function(){for(var k,x=[],G=0;G<arguments.length;G++)x[G]=arguments[G];(k=p.post).setA1ReferenceStyle.apply(k,x),d!==void 0&&d.doNotify(ZD.NotificationKind.setA1ReferenceStyle,x)},setLocale:function(){for(var k,x=[],G=0;G<arguments.length;G++)x[G]=arguments[G];(k=p.post).setLocale.apply(k,x),d!==void 0&&d.doNotify(ZD.NotificationKind.setLocale,x)},setWorkbookProps:function(){for(var k,x=[],G=0;G<arguments.length;G++)x[G]=arguments[G];(k=p.post).setWorkbookProps.apply(k,x),d!==void 0&&d.doNotify(ZD.NotificationKind.setWorkbookProps,x)},updateSheetNames:function(){for(var k,x=[],G=0;G<arguments.length;G++)x[G]=arguments[G];(k=p.post).updateSheetNames.apply(k,x),d!==void 0&&d.doNotify(ZD.NotificationKind.updateSheetNames,x)},updateNamedObjects:function(){for(var k,x=[],G=0;G<arguments.length;G++)x[G]=arguments[G];(k=p.post).updateNamedObjects.apply(k,x),d!==void 0&&d.doNotify(ZD.NotificationKind.updateNamedObjects,x)},setNumberFormats:p.post.setNumberFormats,updateUnusedCells:p.post.updateUnusedCells,updateRanges:p.post.updateRanges,updateArrays:p.post.updateArrays,editRangeFormulas:p.post.editRangeFormulas,editRangeFormats:p.post.editRangeFormats,editArrayFormulas:p.post.editArrayFormulas,editRangePaste:p.post.editRangePaste,resumeRecalc:p.post.resumeRecalc,reconfigure:function(k){var x,G;p.call.ping.callTimeout=(x=k.responsivenessPingTimeout)!==null&&x!==void 0?x:z2e,S=(G=k.responsivenessPingAttempts)!==null&&G!==void 0?G:Y2e,p.post.reconfigure(k)},clearCache:function(){p.post.clearCache(),c=-(1/0)},testAdvanceState:p.post.testAdvanceState,testResumeRecalc:p.call.testResumeRecalc,close:u,stateIdAvailable:function(k){return k>=c},evalFormula:p.call.evalFormula,evalOnClonedModel:p.call.evalOnClonedModel,createIGridExportEndpoint:function(k,x){return m.push(x),p.call.createIGridExportEndpoint.transfer([k.port],k)}},s!==void 0&&s.onGridExporterCreated(E),[2,E];case 5:throw I=w.sent(),u("Error"),I;case 6:return[2]}})})}});var aOe=Y($D=>{_();Object.defineProperty($D,"__esModule",{value:!0});$D.calc=void 0;var gt=Yd(dT()),l6r=Yd(X2e()),Vte=Yd(sk()),c6r=Yd(h8()),Z2e=Yd(cu()),KT=Yd(vd()),$2e=Yd(Wre()),d6r=Yd(xne()),l7=Yd(e0()),eOe=Yd($w()),f6r=Yd(r_()),rOe=Yd(GK()),VT=Yd(YO()),Wte=Yd(ey()),DE=Yd(x0()),p6r=Yd(Ure()),m6r=Yd(gT()),g6r=Yd(Cne()),nOe=Yd(uD());function tOe(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,n=new WeakMap;return(tOe=function(o){return o?n:r})(e)}function Yd(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var n=tOe(r);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(u!=="default"&&Object.prototype.hasOwnProperty.call(e,u)){var t=o?Object.getOwnPropertyDescriptor(e,u):null;t&&(t.get||t.set)?Object.defineProperty(a,u,t):a[u]=e[u]}return a.default=e,n&&n.set(e,a),a}var jte;$D.calc=jte;(function(e){e.worksheetFunctionName=gt.worksheetFunctionName,e.errorTypeName=gt.errorTypeName,e.localeData=gt.localeData,e.numberFormat=gt.numberFormat,e.sheetName=gt.sheetName,e.blankValue=gt.blankValue,e.errorValue=gt.errorValue,e.richValue=gt.richValue,e.getCellValueKind=gt.getCellValueKind,e.getCellFormatKind=gt.getCellFormatKind,e.cellLocation=gt.cellLocation,e.rangeLocation=gt.rangeLocation,e.sheetRangeLocation=gt.sheetRangeLocation,e.sheetCellLocation=gt.sheetCellLocation,e.cellData=gt.cellData,e.cellFormulaCellData=gt.cellFormulaCellData,e.arrayFormulaCellData=gt.arrayFormulaCellData,e.valueCellData=gt.valueCellData,e.rangeUpdate=gt.rangeUpdate,e.rangeWrite=gt.rangeWrite,e.rangePromote=gt.rangePromote,e.arrayData=gt.arrayData,e.arrayUpdate=gt.arrayUpdate,e.arrayWrite=gt.arrayWrite,e.arrayPromote=gt.arrayPromote,e.unusedCellsUpdate=gt.unusedCellsUpdate,e.namedValueData=gt.namedValueData,e.namedFormulaData=gt.namedFormulaData,e.namedRangeData=gt.namedRangeData,e.namedFailureData=gt.namedFailureData,e.namedObject=gt.namedObject,e.namedObjectsUpdate=gt.namedObjectsUpdate,e.namedObjectsWrite=gt.namedObjectsWrite,e.undefinedNamesWrite=gt.undefinedNamesWrite,e.namedObjectsPromote=gt.namedObjectsPromote,e.namedTableData=gt.namedTableData,e.columnData=gt.columnData,e.rangeFormulaEdit=gt.rangeFormulaEdit,e.cellFormulaRangeFormulaEdit=gt.cellFormulaRangeFormulaEdit,e.valueRangeFormulaEdit=gt.valueRangeFormulaEdit,e.inferredRangeFormulaEdit=gt.inferredRangeFormulaEdit,e.RibbonFormat=gt.RibbonFormat,e.formatEditOperation=gt.formatEditOperation,e.formatEditSetFormat=gt.formatEditSetFormat,e.formatEditRibbonFormat=gt.formatEditRibbonFormat,e.formatEditChangeDecimals=gt.formatEditChangeDecimals,e.rangeFormatEdit=gt.rangeFormatEdit,e.arrayFormulaEdit=gt.arrayFormulaEdit,e.rangePasteEdit=gt.rangePasteEdit,e.copyPasteRangePasteEdit=gt.copyPasteRangePasteEdit,e.inferredFormat=gt.inferredFormat,e.cellDataDelta=gt.cellDataDelta,e.rangeDelta=gt.rangeDelta,e.arrayDelta=gt.arrayDelta,e.rangeFailure=gt.rangeFailure,e.recalcResults=gt.recalcResults,e.evalFormulaData=gt.evalFormulaData,e.evalFormulaFormat=gt.evalFormulaFormat,e.evalFormulaFormatOrigin=gt.evalFormulaFormatOrigin,e.evalFormulaFormatIformat=gt.evalFormulaFormatIformat,e.evalFormulaFormatKnown=gt.evalFormulaFormatKnown,e.evalFormulaFormatInferred=gt.evalFormulaFormatInferred,e.evalFormulaFormatAggregate=gt.evalFormulaFormatAggregate,e.updateRequest=gt.updateRequest,e.runExperiment=gt.runExperiment,e.recalcServiceConfig=gt.recalcServiceConfig,e.workbookProps=gt.workbookProps,e.createRecalcService=l6r.createRecalcService,e.RecalcServiceCreateMode=gt.RecalcServiceCreateMode,e.localeInfoFromData=Vte.localeInfoFromData,e.cellValueToReadOper=Vte.cellValueToReadOper,e.readOperToCellValue=Vte.readOperToCellValue,e.recalcServiceInsideInit=c6r.recalcServiceInsideInit,e.getTime=Z2e.getTimeImpl,e.RecalcServiceDataTransformer=nOe.RecalcServiceDataTransformer;var r;(function(n){n.PartialWorkbookDocumentCollection=$2e.PartialWorkbookDocumentCollection,n.VolatileMode=Z2e.VolatileMode,n.voidCallback=$2e.voidCallback,n.sheetCellSet=KT.sheetCellSet,n.createSheetCellSetFromRange=KT.createSheetCellSetFromRange,n.ComputedCellKind=KT.ComputedCellKind,n.ComputeKind=KT.ComputeKind,n.SpecialStyle=KT.SpecialStyle,n.SpecialFormat=KT.SpecialFormat,n.OutputMessageKind=KT.OutputMessageKind,n.UnavailableKind=KT.UnavailableKind,n.CloningTarget=f6r.CloningTarget,n.PartialWorkbook=d6r.PartialWorkbook,n.createCellSetFromRange=l7.createCellSetFromRange,n.bspFactory=l7.bspFactory,n.forEachCellInSet=l7.forEachCellInSet,n.forEachRangeInSet=l7.forEachRangeInSet,n.makeGridRangeTable=m6r.makeGridRangeTable,n.namedFormula=eOe.namedFormula,n.namedTable=eOe.namedTable,n.empty=Wte.empty,n.dense=Wte.dense,n.union=Wte.union,n.unionProduct=DE.unionProduct,n.meetsProduct=DE.meetsProduct,n.exceptProduct=DE.exceptProduct,n.intersectProduct=DE.intersectProduct,n.compareProduct=DE.compareProduct,n.project=DE.project,n.forEachProduct=DE.forEachProduct,n.blankStyleValue=p6r.blankStyleValue,n.UnitExperiment=g6r.UnitExperiment,n.ExperimentKind=rOe.ExperimentKind,n.registerExperimentFactory=rOe.registerExperimentFactory,n.incrementFailure=nOe.incrementFailure,n.arrayChecker=VT.arrayChecker,n.chBoolean=VT.chBoolean,n.check=VT.check,n.chFiniteNumber=VT.chFiniteNumber,n.chPossiblyInfiniteNumber=VT.chPossiblyInfiniteNumber,n.objectChecker=VT.objectChecker,n.oneOfChecker=VT.oneOfChecker,n.optChecker=VT.optChecker})(r=e.internal||(e.internal={}))})(jte||($D.calc=jte={}))});var oOe=Y(ex=>{_();Object.defineProperty(ex,"__esModule",{value:!0});ex.funcs=void 0;var v6r=S6r(Lre()),h6r=Gv();function iOe(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,n=new WeakMap;return(iOe=function(o){return o?n:r})(e)}function S6r(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var n=iOe(r);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(u!=="default"&&Object.prototype.hasOwnProperty.call(e,u)){var t=o?Object.getOwnPropertyDescriptor(e,u):null;t&&(t.get||t.set)?Object.defineProperty(a,u,t):a[u]=e[u]}return a.default=e,n&&n.set(e,a),a}var Hte;ex.funcs=Hte;(function(e){e.getWorksheetFunc=v6r.getWorksheetFunc,e.nextFuncs=h6r.nextFuncs.nextFuncs})(Hte||(ex.funcs=Hte={}))});var sOe=Y(rx=>{_();Object.defineProperty(rx,"__esModule",{value:!0});rx.style=void 0;var xE=y6r(qre());function uOe(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,n=new WeakMap;return(uOe=function(o){return o?n:r})(e)}function y6r(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var n=uOe(r);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(u!=="default"&&Object.prototype.hasOwnProperty.call(e,u)){var t=o?Object.getOwnPropertyDescriptor(e,u):null;t&&(t.get||t.set)?Object.defineProperty(a,u,t):a[u]=e[u]}return a.default=e,n&&n.set(e,a),a}var Qte;rx.style=Qte;(function(e){e.FontUnderline=xE.FontUnderline,e.FontVerticalAlignment=xE.FontVerticalAlignment,e.FillKind=xE.FillKind,e.PatternType=xE.PatternType,e.BorderLineType=xE.BorderLineType,e.HorizontalAlignment=xE.HorizontalAlignment,e.VerticalAlignment=xE.VerticalAlignment})(Qte||(rx.style=Qte={}))});var lOe=Y(c7=>{_();Object.defineProperty(c7,"__esModule",{value:!0});c7.cancelSmokeTest=C6r;c7.runSmokeTest=_6r;function C6r(){}function _6r(){return Promise.resolve()}});var fOe=Y(nx=>{_();Object.defineProperty(nx,"__esModule",{value:!0});nx.worker=void 0;var cOe=R6r(lOe());function dOe(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,n=new WeakMap;return(dOe=function(o){return o?n:r})(e)}function R6r(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var n=dOe(r);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(u!=="default"&&Object.prototype.hasOwnProperty.call(e,u)){var t=o?Object.getOwnPropertyDescriptor(e,u):null;t&&(t.get||t.set)?Object.defineProperty(a,u,t):a[u]=e[u]}return a.default=e,n&&n.set(e,a),a}var zte;nx.worker=zte;(function(e){e.runSmokeTest=cOe.runSmokeTest,e.cancelSmokeTest=cOe.cancelSmokeTest})(zte||(nx.worker=zte={}))});var pOe=Y(WT=>{_();Object.defineProperty(WT,"__esModule",{value:!0});WT.setImmediateUnified=WT.defaultSetTimeoutInterface=WT.clearTimerUnified=void 0;var Yte=Cn(),T6r=Yte.setTimeoutInterfaceModule.setImmediateUnified;WT.setImmediateUnified=T6r;var b6r=Yte.setTimeoutInterfaceModule.clearTimerUnified;WT.clearTimerUnified=b6r;var P6r=Yte.setTimeoutInterfaceModule.defaultSetTimeoutInterface;WT.defaultSetTimeoutInterface=P6r});var gOe=Y(Jte=>{_();Object.defineProperty(Jte,"__esModule",{value:!0});Jte.makeCalcGrid=O6r;var E6r=br(),N6r=pOe(),A6r=h8(),mOe=Bne(),d7=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n]};function O6r(e){e===void 0&&(e=N6r.defaultSetTimeoutInterface);var r=function(n){(0,E6r.__extends)(a,n);function a(){var o=n.call(this,d7,d7,d7,d7,(0,mOe.asyncLoopFactory)((0,mOe.delayPromiseImpl)(e)))||this;return o.calcGrid=o,o}return Object.defineProperty(a.prototype,"calcConfig",{get:function(){return this.calcGrid.dataModel.docs.config},enumerable:!1,configurable:!0}),a}(A6r.RecalcServiceImpl);return new r().calcGrid}});var Xte=Y(nF=>{_();Object.defineProperty(nF,"__esModule",{value:!0});nF.wrapIntoAsyncClass=nF.wrapIntoAsync=void 0;var vOe=Cn(),k6r=vOe.wrapIntoAsyncModule.wrapIntoAsync;nF.wrapIntoAsync=k6r;var F6r=vOe.wrapIntoAsyncModule.wrapIntoAsyncClass;nF.wrapIntoAsyncClass=F6r});var _Oe=Y(HT=>{_();Object.defineProperty(HT,"__esModule",{value:!0});HT.MockAsyncGrid=void 0;HT.createMockAsyncGrid=G6r;HT.createMockGridExporter=V6r;HT.createMockGridProvider=K6r;HT.setMockGridSheetAndNotify=W6r;var f7=br(),I6r=gOe(),hOe=yOe(gs()),M6r=Xte(),jT=dT(),w6r=kk(),D6r=tu(),x6r=yOe(oC()),L6r=Ai(),B6r=m_(),q6r=d8();function SOe(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,n=new WeakMap;return(SOe=function(o){return o?n:r})(e)}function yOe(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var n=SOe(r);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(u!=="default"&&Object.prototype.hasOwnProperty.call(e,u)){var t=o?Object.getOwnPropertyDescriptor(e,u):null;t&&(t.get||t.set)?Object.defineProperty(a,u,t):a[u]=e[u]}return a.default=e,n&&n.set(e,a),a}function U6r(e){if(typeof e=="object")switch(e.kind){case"Blank":return"";case"Error":return(0,D6r.getEnglishLocaleInfo)().errorNames[e.type];case"Rich":return"rich value formulaBarText"}return e.toString()}var COe=function(e){(0,f7.__extends)(r,e);function r(){var n=this,a=(0,I6r.makeCalcGrid)(),o=new q6r.RecalcSideGrid(a);return n=e.call(this,o)||this,n.sheetNames=[],n.calcGrid=a,n.document=a.document,n}return Object.defineProperty(r.prototype,"calcConfig",{get:function(){return this.calcGrid.dataModel.docs.config},enumerable:!1,configurable:!0}),r.prototype.setSheet=function(n,a,o){var u=hOe.documentLoc(void 0,""),t=hOe.sheetIndex(u,n);(0,L6r.assertTrue)("Sheet having sheetId ".concat(n," is already in the mock workbook"),!this.sheetNames.some(function(v){var h=v.sheetId;return h===n})),this.sheetNames.push((0,jT.sheetName)(t.index,a)),this.calcGrid.updateSheetNames(0,this.sheetNames);for(var d=[],s=0;s<o.length;s+=1){var c=o[s];if(c!==void 0)for(var l=0;l<c.length;l+=1){var f=c[l];if(f!==void 0){var p=(0,jT.sheetRangeLocation)(t.index,s,l),m=U6r(f);m.startsWith("=")?d.push((0,jT.rangeWrite)(p,(0,jT.cellFormulaCellData)(m,f,0))):d.push((0,jT.rangeWrite)(p,(0,jT.valueCellData)(m,f,0)))}}}this.calcGrid.updateRanges(0,(0,f7.__spreadArray)([(0,jT.rangeWrite)((0,jT.sheetRangeLocation)(t.index,0,0))],d,!0)),this.runTasks()},r.prototype.setNamedObjects=function(n){this.calcGrid.updateNamedObjects(0,n),this.runTasks()},r.prototype.runTasks=function(){for(;;){var n=this.calcGrid.dataModel.step();if(n.queueEmpty)break}},r}((0,M6r.wrapIntoAsyncClass)()(["getRangeFormats","getRangeFormulae","getRangeValues","getSheetNames","getIntersectingTables","getIformats","discardSnapshot","getHiddenRows","getHiddenCols","evalClonedModelOnSnapshot","evalFormulaOnSnapshot","getCorrespondingSnapshotID"]));HT.MockAsyncGrid=COe;function G6r(){var e=new COe,r=(0,w6r.wrapIntoResumeRecalc)(e,function(){return e.calcGrid.resumeRecalc()});return r.setSheet=e.setSheet.bind(e),r.setNamedObjects=e.setNamedObjects.bind(e),r.document=e.document,Object.defineProperty(r,"calcConfig",{get:function(){return e.calcConfig}}),r}function K6r(e){return{getGrid:function(){return e}}}function V6r(e){return{createIGridExportEndpoint:function(n){return(0,f7.__awaiter)(this,void 0,void 0,function(){return(0,f7.__generator)(this,function(a){switch(a.label){case 0:return[4,x6r.Endpoint.createInside(n,function(){return e})];case 1:return a.sent(),[2]}})})}}}function W6r(e,r,n,a,o,u){u===void 0&&(u=0),n.setSheet(e,r,a);var t={sheetId:e,sheetName:r};o.doNotify(B6r.NotificationKind.updateSheetNames,[u,[t]])}});var TOe=Y(tF=>{_();Object.defineProperty(tF,"__esModule",{value:!0});tF.MockTimerImmediate=tF.MockTimer=void 0;var ROe=fy(),j6r=ROe.mockTimer.MockTimer;tF.MockTimer=j6r;var H6r=ROe.mockTimer.MockTimerImmediate;tF.MockTimerImmediate=H6r});var bOe=Y(p7=>{_();Object.defineProperty(p7,"__esModule",{value:!0});p7.functionExamples=void 0;var se=sg(),Q6r=cu(),z6r=new Q6r.ResettableLazy(function(){var e;return e={},e[se.WorksheetFuncId.ABS]="=ABS(2)",e[se.WorksheetFuncId.CUBEMEMBERPROPERTY]='=CUBEMEMBERPROPERTY("'.concat(FormulaAuthoringStrings.Sales,'","[').concat(FormulaAuthoringStrings.Time,"].[").concat(FormulaAuthoringStrings.Fiscal,'].[2014]",$A$3)'),e[se.WorksheetFuncId.CUBERANKEDMEMBER]='=CUBERANKEDMEMBER("'.concat(FormulaAuthoringStrings.Sales,'",$D$4,1,"').concat(FormulaAuthoringStrings.TopMonth,'")'),e[se.WorksheetFuncId.BINOM_DIST_RANGE]="=BINOM.DIST.RANGE(60,0.75,48)",e[se.WorksheetFuncId.NETWORKDAYS_INTL]="=NETWORKDAYS.INTL(DATE(2006,1,1),DATE(2006,1,31))",e[se.WorksheetFuncId.AVERAGE_WEIGHTED]="=AVERAGE.WEIGHTED(A1:A10, B1:B10, 5, 0.5)",e[se.WorksheetFuncId.GAMMALN_PRECISE]="=GAMMALN.PRECISE(4)",e[se.WorksheetFuncId.CONFIDENCE_NORM]="=CONFIDENCE.NORM(0.05,2.5,50)",e[se.WorksheetFuncId.CEILING_PRECISE]="=CEILING.PRECISE(4.3)",e[se.WorksheetFuncId.FORECAST_LINEAR]="=FORECAST.LINEAR(30,A2:A6,B2:B6)",e[se.WorksheetFuncId.PERCENTRANK_EXC]="=PERCENTRANK.EXC(A2:A11,2)",e[se.WorksheetFuncId.PERCENTRANK_INC]="=PERCENTRANK.INC(A2:A11,2)",e[se.WorksheetFuncId.PERCENTILE_EXC]="=PERCENTILE.EXC(B2:B10,0.25)",e[se.WorksheetFuncId.PERCENTILE_INC]="=PERCENTILE.INC(A2:A5,0.3)",e[se.WorksheetFuncId.CUBEKPIMEMBER]='=CUBEKPIMEMBER("'.concat(FormulaAuthoringStrings.Sales,'","').concat(FormulaAuthoringStrings.MySalesKPI,'",1)'),e[se.WorksheetFuncId.CHISQ_DIST_RT]="=CHISQ.DIST.RT(18.307,10)",e[se.WorksheetFuncId.FLOOR_PRECISE]="=FLOOR.PRECISE(-3.2,-1)",e[se.WorksheetFuncId.NEGBINOM_DIST]="=NEGBINOM.DIST(10,5,0.25,TRUE)",e[se.WorksheetFuncId.GETPIVOTDATA]='=GETPIVOTDATA("'.concat(FormulaAuthoringStrings.Sales,'", $A$3, "').concat(FormulaAuthoringStrings.Region,'", "').concat(FormulaAuthoringStrings.South,'")'),e[se.WorksheetFuncId.CUBESETCOUNT]="=CUBESETCOUNT(A3)",e[se.WorksheetFuncId.ERFC_PRECISE]="=ERFC.PRECISE(1)",e[se.WorksheetFuncId.CHISQ_INV_RT]="=CHISQ.INV.RT(0.3, 2)",e[se.WorksheetFuncId.CONFIDENCE_T]="=CONFIDENCE.T(0.05,1,50)",e[se.WorksheetFuncId.CEILING_MATH]="=CEILING.MATH(24.3,5)",e[se.WorksheetFuncId.HYPGEOM_DIST]="=HYPGEOM.DIST(1,4,8,20,TRUE)",e[se.WorksheetFuncId.LOGNORM_DIST]="=LOGNORM.DIST(4,3.5,1.2,TRUE)",e[se.WorksheetFuncId.NEGBINOMDIST]="=NEGBINOMDIST(10,5,0.25)",e[se.WorksheetFuncId.PERMUTATIONA]="=PERMUTATIONA(3,2)",e[se.WorksheetFuncId.POISSON_DIST]="=POISSON.DIST(1, 2, TRUE)",e[se.WorksheetFuncId.WEIBULL_DIST]="=WEIBULL.DIST(105,20,100,TRUE)",e[se.WorksheetFuncId.COVARIANCE_P]="=COVARIANCE.P(A2:A6, B2:B6)",e[se.WorksheetFuncId.COVARIANCE_S]="=COVARIANCE.S(A3:A5,B3:B5)",e[se.WorksheetFuncId.QUARTILE_EXC]="=QUARTILE.EXC(A2:A12,1)",e[se.WorksheetFuncId.QUARTILE_INC]="=QUARTILE.INC(A2:A9,1)",e[se.WorksheetFuncId.ECMA_CEILING]="=ECMA.CEILING(1.5, 0.1)",e[se.WorksheetFuncId.WORKDAY_INTL]="=WORKDAY.INTL(DATE(2012,1,1),30,0)",e[se.WorksheetFuncId.STOCKHISTORY]="=STOCKHISTORY(MSFT,1-1-2020)",e[se.WorksheetFuncId.ERF_PRECISE]="=ERF.PRECISE(0.745)",e[se.WorksheetFuncId.NUMBERVALUE]="=NUMBERVALUE(0.035)",e[se.WorksheetFuncId.REGISTER_ID]='=REGISTER.ID(Kernel32, "GetTickCount", "J!")',e[se.WorksheetFuncId.HYPGEOMDIST]="=HYPGEOMDIST(1,4,8,20)",e[se.WorksheetFuncId.LOGNORMDIST]="=LOGNORMDIST(4,3.5,1.2)",e[se.WorksheetFuncId.LOGNORM_INV]="=LOGNORM.INV(0.039084, 3.5, 1.2)",e[se.WorksheetFuncId.NORM_S_DIST]="=NORM.S.DIST(1.33, TRUE)",e[se.WorksheetFuncId.STANDARDIZE]="=STANDARDIZE(42,40,1.5)",e[se.WorksheetFuncId.FORMULATEXT]="=FORMULATEXT(A2)",e[se.WorksheetFuncId.PERCENTRANK]="=PERCENTRANK(A2:A11,2)",e[se.WorksheetFuncId.CONCATENATE]='=CONCATENATE("'.concat(FormulaAuthoringStrings.Andreas,'", " ", "').concat(FormulaAuthoringStrings.Hauser,'")'),e[se.WorksheetFuncId.ISO_CEILING]="=ISO.CEILING(4.3)",e[se.WorksheetFuncId.VALUETOTEXT]='=VALUETOTEXT("'.concat(FormulaAuthoringStrings.SomeText,'")'),e[se.WorksheetFuncId.ARRAYTOTEXT]="=ARRAYTOTEXT(B1:B3)",e[se.WorksheetFuncId.AVERAGEIFS]='=AVERAGEIFS(B2:B5, B2:B5, ">70", B2:B5, "<90")',e[se.WorksheetFuncId.COUNTBLANK]="=COUNTBLANK(A2:B5)",e[se.WorksheetFuncId.ERROR_TYPE]="=ERROR.TYPE(#NULL!)",e[se.WorksheetFuncId.CUBEMEMBER]='=CUBEMEMBER("'.concat(FormulaAuthoringStrings.Sales,'",(B4, C6, D5),"').concat(FormulaAuthoringStrings.SalesFor2004,'")'),e[se.WorksheetFuncId.ISOWEEKNUM]="=ISOWEEKNUM(40977)",e[se.WorksheetFuncId.SUBSTITUTE]='=SUBSTITUTE("'.concat(FormulaAuthoringStrings.SalesData,'", "').concat(FormulaAuthoringStrings.Sales,'", "').concat(FormulaAuthoringStrings.Cost,'")'),e[se.WorksheetFuncId.SUMPRODUCT]="=SUMPRODUCT(C2:C5,D2:D5)",e[se.WorksheetFuncId.WEBSERVICE]="=WEBSERVICE(".concat(FormulaAuthoringStrings.WebServiceLink,")"),e[se.WorksheetFuncId.BINOM_DIST]="=BINOM.DIST(6,10,0.5,FALSE)",e[se.WorksheetFuncId.CHISQ_DIST]="=CHISQ.DIST(0.5,1,TRUE)",e[se.WorksheetFuncId.CONFIDENCE]="=CONFIDENCE(0.05,2.5,50)",e[se.WorksheetFuncId.EXPON_DIST]="=EXPON.DIST(0.2,10,TRUE)",e[se.WorksheetFuncId.FLOOR_MATH]="=FLOOR.MATH(24.3,5)",e[se.WorksheetFuncId.GAMMA_DIST]="=GAMMA.DIST(4.79, 1.234, 7, TRUE)",e[se.WorksheetFuncId.NORM_S_INV]="=NORM.S.INV(0.908789)",e[se.WorksheetFuncId.CHISQ_TEST]="=CHISQ.TEST(A2:B4,A6:B8)",e[se.WorksheetFuncId.PERCENTILE]="=PERCENTILE(E2:E5,0.3)",e[se.WorksheetFuncId.FIELDVALUE]='=FIELDVALUE(A2, "'.concat(FormulaAuthoringStrings.Price,'")'),e[se.WorksheetFuncId.AVERAGEIF]='=AVERAGEIF(B2:B5,"<23000")',e[se.WorksheetFuncId.BITLSHIFT]="=BITLSHIFT(4,2)",e[se.WorksheetFuncId.BITRSHIFT]="=BITRSHIFT(13,2)",e[se.WorksheetFuncId.DATEVALUE]="=DATEVALUE(40685)",e[se.WorksheetFuncId.FILTERXML]='=FILTERXML(B3,"//rc/@title")',e[se.WorksheetFuncId.CUBEVALUE]='=CUBEVALUE(Sales,"['.concat(FormulaAuthoringStrings.Measures,"].[").concat(FormulaAuthoringStrings.Profit,']","[').concat(FormulaAuthoringStrings.Time,'].[2004]","[').concat(FormulaAuthoringStrings.AllProduct,"].[").concat(FormulaAuthoringStrings.Beverages,']")'),e[se.WorksheetFuncId.ENCODEURL]='=ENCODEURL("'.concat(FormulaAuthoringStrings.EncodeURLExmapleLink,'")'),e[se.WorksheetFuncId.HYPERLINK]='=HYPERLINK("'.concat(FormulaAuthoringStrings.HyperlinkExampleLink,'", "').concat(FormulaAuthoringStrings.ClickForReport,'")'),e[se.WorksheetFuncId.ISLOGICAL]="=ISLOGICAL(TRUE)",e[se.WorksheetFuncId.ISNONTEXT]="=ISNONTEXT(A2)",e[se.WorksheetFuncId.ISFORMULA]="=ISFORMULA(A2)",e[se.WorksheetFuncId.PDURATION]="=PDURATION(2.5%,2000,2200)",e[se.WorksheetFuncId.TIMEVALUE]="=TIMEVALUE(0.1)",e[se.WorksheetFuncId.TRANSPOSE]="=TRANSPOSE(A2:F9)",e[se.WorksheetFuncId.FREQUENCY]="=FREQUENCY(A2:A20, B2:B5)",e[se.WorksheetFuncId.BETA_DIST]="=BETA.DIST(2,8,10,TRUE,1,3)",e[se.WorksheetFuncId.BINOMDIST]="=BINOMDIST(6,10,0.5,FALSE)",e[se.WorksheetFuncId.BINOM_INV]="=BINOM.INV(6,0.5,0.75)",e[se.WorksheetFuncId.CHISQ_INV]="=CHISQ.INV(0.3, 2)",e[se.WorksheetFuncId.CRITBINOM]="=CRITBINOM(6,0.5,0.75)",e[se.WorksheetFuncId.EXPONDIST]="=EXPONDIST(0.2,10,TRUE)",e[se.WorksheetFuncId.F_DIST_RT]="=F.DIST.RT(15.2069,6,4)",e[se.WorksheetFuncId.FISHERINV]="=FISHERINV(0.972955)",e[se.WorksheetFuncId.GAMMADIST]="=GAMMADIST(10.00001131,9,2,FALSE)",e[se.WorksheetFuncId.GAMMA_INV]="=GAMMA.INV(0.068094,9,2)",e[se.WorksheetFuncId.NORM_DIST]="=NORM.DIST(1, 0, 1, TRUE)",e[se.WorksheetFuncId.T_DIST_2T]="=T.DIST.2T(1.959999998,60)",e[se.WorksheetFuncId.T_DIST_RT]="=T.DIST.RT(1.959999998,60)",e[se.WorksheetFuncId.INTERCEPT]="=INTERCEPT(A2:A6, B2:B6)",e[se.WorksheetFuncId.MODE_MULT]="=MODE.MULT(A2:A13)",e[se.WorksheetFuncId.MODE_SNGL]="=MODE.SNGL(A2:A7)",e[se.WorksheetFuncId.AGGREGATE]="=AGGREGATE(12, 6, A1:A11, B1:B11)",e[se.WorksheetFuncId.RANDARRAY]="=RANDARRAY(5,3,1,100)",e[se.WorksheetFuncId.COUNTIFS]='=COUNTIFS(A2:A7,"<6",A2:A7,">1")',e[se.WorksheetFuncId.DAVERAGE]='=DAVERAGE(A4:E10, "'.concat(FormulaAuthoringStrings.Yield,'", A1:B2)'),e[se.WorksheetFuncId.BAHTTEXT]="=BAHTTEXT(1234)",e[se.WorksheetFuncId.DPRODUCT]='=DPRODUCT(A5:E11, "'.concat(FormulaAuthoringStrings.Yield,'", A1:F3)'),e[se.WorksheetFuncId.INDIRECT]="=INDIRECT(B&A)",e[se.WorksheetFuncId.ISNUMBER]="=ISNUMBER(A2)",e[se.WorksheetFuncId.MINVERSE]="=MINVERSE(A1:D4)",e[se.WorksheetFuncId.RANK_AVG]="=RANK.AVG(94,B2:B8)",e[se.WorksheetFuncId.SUBTOTAL]="=SUBTOTAL(9,A2:A5)",e[se.WorksheetFuncId.BETADIST]="=BETADIST(2,8,10,1,3)",e[se.WorksheetFuncId.BETA_INV]="=BETA.INV(0.685470581,8,10,1,3)",e[se.WorksheetFuncId.F_INV_RT]="=F.INV.RT(0.01,6,4)",e[se.WorksheetFuncId.GAMMAINV]="=GAMMAINV(0.65, 4, 2)",e[se.WorksheetFuncId.NORMDIST]="=NORMDIST(42,40,1.5,TRUE)",e[se.WorksheetFuncId.NORM_INV]="=NORM.INV(0.908789,40,1.5)",e[se.WorksheetFuncId.NORMSINV]="=NORMSINV(0.9088)",e[se.WorksheetFuncId.SUMX2MY2]="=SUMX2MY2(A3:A9,B3:B9)",e[se.WorksheetFuncId.SUMX2PY2]="=SUMX2PY2(A3:A9,B3:B9)",e[se.WorksheetFuncId.FORECAST]="=FORECAST(30,A2:A6,B2:B6)",e[se.WorksheetFuncId.QUARTILE]="=QUARTILE(A2:A9,1)",e[se.WorksheetFuncId.TRIMMEAN]="=TRIMMEAN(A2:A12,0.2)",e[se.WorksheetFuncId.T_INV_2T]="=T.INV.2T(0.546449,60)",e[se.WorksheetFuncId.AVERAGEA]="=AVERAGEA(A2:A6)",e[se.WorksheetFuncId.TEXTJOIN]="=TEXTJOIN(, , TRUE, A2:A8)",e[se.WorksheetFuncId.SEQUENCE]="=SEQUENCE(4,5)",e[se.WorksheetFuncId.ADDRESS]='=ADDRESS(2,3,1,FALSE,"['.concat(FormulaAuthoringStrings.Book1,"]").concat(FormulaAuthoringStrings.Sheet1,'")'),e[se.WorksheetFuncId.AVERAGE]="=AVERAGE(A2:A6)",e[se.WorksheetFuncId.COLUMNS]="=COLUMNS(C1:E4)",e[se.WorksheetFuncId.COUNTIF]='=COUNTIF(B2:B5,">55")',e[se.WorksheetFuncId.DAYS360]="=DAYS360(30-Jan-11,1-Feb-11)",e[se.WorksheetFuncId.DCOUNTA]='=DCOUNTA(A4:E10, "'.concat(FormulaAuthoringStrings.Profit,'", A1:F2)'),e[se.WorksheetFuncId.DECIMAL]="=DECIMAL(FF,16)",e[se.WorksheetFuncId.DEGREES]="=DEGREES(PI())",e[se.WorksheetFuncId.DSTDEVP]='=DSTDEVP(A5:E11, "'.concat(FormulaAuthoringStrings.Yield,'", A1:A3)'),e[se.WorksheetFuncId.CUBESET]='=CUBESET("'.concat(FormulaAuthoringStrings.Sales,'","[').concat(FormulaAuthoringStrings.Product,"].[").concat(FormulaAuthoringStrings.AllProducts,"].").concat(FormulaAuthoringStrings.Children,'","').concat(FormulaAuthoringStrings.Products,'",1,"[').concat(FormulaAuthoringStrings.Measures,"].[").concat(FormulaAuthoringStrings.SalesAmount,']")'),e[se.WorksheetFuncId.HLOOKUP]='=HLOOKUP("'.concat(FormulaAuthoringStrings.Axles,'", A1:C4, 2, TRUE)'),e[se.WorksheetFuncId.IFERROR]='=IFERROR(55/0, "'.concat(FormulaAuthoringStrings.ErrorInCalculation,'")'),e[se.WorksheetFuncId.ISBLANK]="=ISBLANK(A2)",e[se.WorksheetFuncId.ISERROR]="=ISERROR(#REF!)",e[se.WorksheetFuncId.XLOOKUP]='=XLOOKUP("'.concat(FormulaAuthoringStrings.Tom,'",A2:A9,C2:C9,"').concat(FormulaAuthoringStrings.NotFound,'",0,1)'),e[se.WorksheetFuncId.MDETERM]="=MDETERM(A2:D5)",e[se.WorksheetFuncId.PRODUCT]="=PRODUCT(A2:A4)",e[se.WorksheetFuncId.RADIANS]="=RADIANS(270)",e[se.WorksheetFuncId.RANK_EQ]="=RANK.EQ(7,A2:A6,1)",e[se.WorksheetFuncId.REPLACE]='=REPLACE(2009,3,2,"10")',e[se.WorksheetFuncId.STDEV_S]="=STDEV.S(A2:A11)",e[se.WorksheetFuncId.STDEV_P]="=STDEV.P(A3:A12)",e[se.WorksheetFuncId.UNICODE]="=UNICODE(B)",e[se.WorksheetFuncId.UNICHAR]="=UNICHAR(66)",e[se.WorksheetFuncId.VLOOKUP]="=VLOOKUP(103, A2:B26, 2, FALSE)",e[se.WorksheetFuncId.WEEKDAY]="=WEEKDAY(39492)",e[se.WorksheetFuncId.GAMMALN]="=GAMMALN(4)",e[se.WorksheetFuncId.BETAINV]="=BETAINV(0.685470581,8,10,1,3)",e[se.WorksheetFuncId.CHIDIST]="=CHIDIST(18.307,10)",e[se.WorksheetFuncId.COMBINA]="=COMBINA(4,3)",e[se.WorksheetFuncId.CEILING]="=CEILING(2.5, 1)",e[se.WorksheetFuncId.NORMINV]="=NORMINV(0.908789,40,1.5)",e[se.WorksheetFuncId.POISSON]="=POISSON(1, 2, TRUE)",e[se.WorksheetFuncId.WEIBULL]="=WEIBULL(105,20,100,TRUE)",e[se.WorksheetFuncId.SUMXMY2]="=SUMXMY2(A3:A9,B3:B9)",e[se.WorksheetFuncId.CHITEST]="=CHITEST(A2:B4,A6:B8)",e[se.WorksheetFuncId.PEARSON]="=PEARSON(A3:A7,B3:B7)",e[se.WorksheetFuncId.GEOMEAN]="=GEOMEAN(A2:A8)",e[se.WorksheetFuncId.HARMEAN]="=HARMEAN(A2:A8)",e[se.WorksheetFuncId.STDEVPA]="=STDEVPA(A3:A12)",e[se.WorksheetFuncId.DATEDIF]='=DATEDIF(1/1/2001,1/1/2003,"Y")',e[se.WorksheetFuncId.ARABIC]="=ARABIC(LVII)",e[se.WorksheetFuncId.CHOOSE]='=CHOOSE(3,"'.concat(FormulaAuthoringStrings.Wide,'",115,"').concat(FormulaAuthoringStrings.World,'",8)'),e[se.WorksheetFuncId.COLUMN]="=COLUMN(C9)",e[se.WorksheetFuncId.COUNTA]="=COUNTA(B2:B6)",e[se.WorksheetFuncId.DCOUNT]='=DCOUNT(A5:E11, "'.concat(FormulaAuthoringStrings.Age,'", A1:F2)'),e[se.WorksheetFuncId.DOLLAR]="=DOLLAR(1.2351, 4)",e[se.WorksheetFuncId.DSTDEV]='=DSTDEV(A5:E11, "'.concat(FormulaAuthoringStrings.Yield,'", A1:A3)'),e[se.WorksheetFuncId.GROWTH]="=GROWTH(#VALUE!)",e[se.WorksheetFuncId.IMCOSH]='=IMCOSH("4+3i")',e[se.WorksheetFuncId.IMCSCH]='=IMCSCH("4+3i")',e[se.WorksheetFuncId.IMSECH]='=IMSECH("4+3i")',e[se.WorksheetFuncId.IMSINH]='=IMSINH("4+3i")',e[se.WorksheetFuncId.ISTEXT]='=ISTEXT("'.concat(FormulaAuthoringStrings.Region1,'")'),e[se.WorksheetFuncId.LINEST]="=LINEST(B2:B10, A2:A10, FALSE, TRUE)",e[se.WorksheetFuncId.LOGEST]="=LOGEST(B2:B10, A2:A10, TRUE, TRUE)",e[se.WorksheetFuncId.LOOKUP]="=LOOKUP(4.19, A2:A6, B2:B6)",e[se.WorksheetFuncId.XMATCH]="=XMATCH(F2,C3:C9,1)",e[se.WorksheetFuncId.MEDIAN]="=MEDIAN(A2:A6)",e[se.WorksheetFuncId.MINUTE]="=MINUTE(0.53125)",e[se.WorksheetFuncId.OFFSET]="=OFFSET(D3,3,-2,1,1)",e[se.WorksheetFuncId.PROPER]='=PROPER("'.concat(FormulaAuthoringStrings.ThisIsATITLE,'")'),e[se.WorksheetFuncId.SEARCH]='=SEARCH("'.concat(FormulaAuthoringStrings.E,'","').concat(FormulaAuthoringStrings.Statements,'",6)'),e[se.WorksheetFuncId.SECOND]="=SECOND(0.700208333333333)",e[se.WorksheetFuncId.SHEETS]="=SHEETS(".concat(FormulaAuthoringStrings.My3DRef,")"),e[se.WorksheetFuncId.STDEVP]="=STDEVP(A3:A12)",e[se.WorksheetFuncId.SUMIFS]='=SUMIFS(A2:A9, B2:B9, "<>'.concat(FormulaAuthoringStrings.Bananas,'", C2:C9, "').concat(FormulaAuthoringStrings.Tom,'")'),e[se.WorksheetFuncId.AVEDEV]="=AVEDEV(A2:A8)",e[se.WorksheetFuncId.CHIINV]="=CHIINV(0.3, 2)",e[se.WorksheetFuncId.COMBIN]="=COMBIN(8,2)",e[se.WorksheetFuncId.F_DIST]="=F.DIST(15.2069,6,4,TRUE)",e[se.WorksheetFuncId.FISHER]="=FISHER(0.75)",e[se.WorksheetFuncId.LOGINV]="=LOGINV(0.039084, 3.5, 1.2)",e[se.WorksheetFuncId.PERMUT]="=PERMUT(100,3)",e[se.WorksheetFuncId.T_DIST]="=T.DIST(60,1,TRUE)",e[se.WorksheetFuncId.CORREL]="=CORREL(A2:A6, B2:B6)",e[se.WorksheetFuncId.F_TEST]="=F.TEST(A2:A6,B2:B6)",e[se.WorksheetFuncId.T_TEST]="=T.TEST(A2:A10,B2:B10,2,1)",e[se.WorksheetFuncId.SKEW_P]="=SKEW.P(A2:A11)",e[se.WorksheetFuncId.Z_TEST]="=Z.TEST(A2:A11,4)",e[se.WorksheetFuncId.STDEVA]="=STDEVA(A3:A12)",e[se.WorksheetFuncId.MAXIFS]='=MAXIFS(A2:A7,B2:B7,"'.concat(FormulaAuthoringStrings.IfsB,'",D2:D7,">100")'),e[se.WorksheetFuncId.MINIFS]='=MINIFS(A2:A7,B2:B7,"'.concat(FormulaAuthoringStrings.IfsB,'",D2:D7,">100")'),e[se.WorksheetFuncId.CONCAT]='=CONCAT("'.concat(FormulaAuthoringStrings.Andreas,'"," ", "').concat(FormulaAuthoringStrings.Hauser,'")'),e[se.WorksheetFuncId.SWITCH]='=SWITCH(WEEKDAY(10/10/2016),1,"'.concat(FormulaAuthoringStrings.Sunday,'",2,"').concat(FormulaAuthoringStrings.Monday,'",3,"').concat(FormulaAuthoringStrings.Tuesday,'","').concat(FormulaAuthoringStrings.NoMatch,'")'),e[se.WorksheetFuncId.FILTER]='=FILTER(A5:D20,(C5:C20="'.concat(FormulaAuthoringStrings.Apple,'")*(A5:A20="').concat(FormulaAuthoringStrings.East,'"),"")'),e[se.WorksheetFuncId.UNIQUE]="=UNIQUE(A2:A12)",e[se.WorksheetFuncId.SORTBY]="=SORTBY(D2:D9,E2:E9,1)",e[se.WorksheetFuncId.BITAND]="=BITAND(1,5)",e[se.WorksheetFuncId.BITXOR]="=BITXOR(5,3)",e[se.WorksheetFuncId.ACOSH]="=ACOSH(10)",e[se.WorksheetFuncId.ACOTH]="=ACOTH(6)",e[se.WorksheetFuncId.ATANH]="=ATANH(-0.1)",e[se.WorksheetFuncId.ATAN2]="=ATAN2(4,0)",e[se.WorksheetFuncId.CLEAN]="=CLEAN(A2)",e[se.WorksheetFuncId.COUNT]="=COUNT(A2:A7)",e[se.WorksheetFuncId.DVARP]='=DVARP(A4:E10, "'.concat(FormulaAuthoringStrings.Yield,'", A1:A3)'),e[se.WorksheetFuncId.EXACT]='=EXACT("'.concat(FormulaAuthoringStrings.Hello,'", "').concat(FormulaAuthoringStrings.Goodbye,'")'),e[se.WorksheetFuncId.FALSE]="=FALSE()",e[se.WorksheetFuncId.FIXED]="=FIXED(-1234.567, -1, TRUE)",e[se.WorksheetFuncId.IMCOT]='=IMCOT("4+3i")',e[se.WorksheetFuncId.IMCSC]='=IMCSC("4+3i")',e[se.WorksheetFuncId.IMSEC]='=IMSEC("4+3i")',e[se.WorksheetFuncId.IMTAN]='=IMTAN("4+3i")',e[se.WorksheetFuncId.INDEX]="=INDEX(A2:B3,2,1)",e[se.WorksheetFuncId.ISERR]="=ISERR(#N/A)",e[se.WorksheetFuncId.ISREF]="=ISREF(A2)",e[se.WorksheetFuncId.LOWER]='=LOWER("'.concat(FormulaAuthoringStrings.EECummings,'")'),e[se.WorksheetFuncId.MATCH]="=MATCH(39,B2:B5,1)",e[se.WorksheetFuncId.MMULT]="=MMULT(A1:B3, C1:F2)",e[se.WorksheetFuncId.MONTH]="=MONTH(40648)",e[se.WorksheetFuncId.RIGHT]='=RIGHT("'.concat(FormulaAuthoringStrings.SalePrice,'",5)'),e[se.WorksheetFuncId.ROUND]="=ROUND(2.149, 1)",e[se.WorksheetFuncId.SHEET]="=SHEET(".concat(FormulaAuthoringStrings.Table1,")"),e[se.WorksheetFuncId.STDEV]="=STDEV(A3:A12)",e[se.WorksheetFuncId.SUMIF]='=SUMIF(A2:A5,">160000")',e[se.WorksheetFuncId.TODAY]="=TODAY()",e[se.WorksheetFuncId.TREND]="=TREND(B2:B10, A2:A10, A11:A13, TRUE)",e[se.WorksheetFuncId.TRUNC]="=TRUNC(8.9)",e[se.WorksheetFuncId.UPPER]='=UPPER("'.concat(FormulaAuthoringStrings.KelliXu,'")'),e[se.WorksheetFuncId.VALUE]="=VALUE(1000)",e[se.WorksheetFuncId.VAR_S]="=VAR.S(A2:A11)",e[se.WorksheetFuncId.VAR_P]="=VAR.P(A2:A11)",e[se.WorksheetFuncId.GAMMA]="=GAMMA(-3.75)",e[se.WorksheetFuncId.GAUSS]="=GAUSS(2)",e[se.WorksheetFuncId.FDIST]="=FDIST(15.20686486,6,4)",e[se.WorksheetFuncId.F_INV]="=F.INV(0.01,6,4)",e[se.WorksheetFuncId.FLOOR]="=FLOOR(23.25, 0.1)",e[se.WorksheetFuncId.TDIST]="=TDIST(60, 1, 1)",e[se.WorksheetFuncId.COVAR]="=COVAR(A2:A6, B2:B6)",e[se.WorksheetFuncId.FTEST]="=FTEST(A2:A6,B2:B6)",e[se.WorksheetFuncId.STEYX]="=STEYX(A3:A9,B3:B9)",e[se.WorksheetFuncId.SLOPE]="=SLOPE(A3:A9,B3:B9)",e[se.WorksheetFuncId.TTEST]="=TTEST(A2:A10,B2:B10,2,1)",e[se.WorksheetFuncId.DEVSQ]="=DEVSQ(A2:A8)",e[se.WorksheetFuncId.SUMSQ]="=SUMSQ(3, 4)",e[se.WorksheetFuncId.ZTEST]="=ZTEST(A2:A11,6)",e[se.WorksheetFuncId.LARGE]="=LARGE(A2:B6,7)",e[se.WorksheetFuncId.SMALL]="=SMALL(A2:A10,4)",e[se.WorksheetFuncId.MUNIT]="=MUNIT(2)",e[se.WorksheetFuncId.T_INV]="=T.INV(0.75,2)",e[se.WorksheetFuncId.ROMAN]="=ROMAN(499,0)",e[se.WorksheetFuncId.POWER]="=POWER(5,2)",e[se.WorksheetFuncId.ISPMT]="=ISPMT(10%, 2, 5, 1000)",e[se.WorksheetFuncId.VARPA]="=VARPA(1, 2)",e[se.WorksheetFuncId.AREAS]="=AREAS(B2:D4)",e[se.WorksheetFuncId.ASINH]="=ASINH(10)",e[se.WorksheetFuncId.BITOR]="=BITOR(23,10)",e[se.WorksheetFuncId.ACOS]="=ACOS(-0.5)",e[se.WorksheetFuncId.ACOT]="=ACOT(2)",e[se.WorksheetFuncId.ATAN]="=ATAN(1)",e[se.WorksheetFuncId.CALL]="=CALL(A5)",e[se.WorksheetFuncId.CELL]='=CELL("'.concat(FormulaAuthoringStrings.Address,'", C2)'),e[se.WorksheetFuncId.CHAR]="=CHAR(65)",e[se.WorksheetFuncId.COSH]="=COSH(EXP(1))",e[se.WorksheetFuncId.COTH]="=COTH(2)",e[se.WorksheetFuncId.CSCH]="=CSCH(2)",e[se.WorksheetFuncId.DATE]="=DATE(2008,1,2)",e[se.WorksheetFuncId.DAYS]="=DAYS(3/15/11,2/1/11)",e[se.WorksheetFuncId.DGET]='=DGET(A5:E11, "'.concat(FormulaAuthoringStrings.Yield,'", A1:A3)'),e[se.WorksheetFuncId.DMAX]='=DMAX(A5:E11, "'.concat(FormulaAuthoringStrings.Profit,'", A1:F3)'),e[se.WorksheetFuncId.DMIN]='=DMIN(A5:E11, "'.concat(FormulaAuthoringStrings.Profit,'", A1:F3)'),e[se.WorksheetFuncId.DSUM]='=DSUM(A4:E10,"'.concat(FormulaAuthoringStrings.Profit,'", A1:F3)'),e[se.WorksheetFuncId.DVAR]='=DVAR(A4:E10, "'.concat(FormulaAuthoringStrings.Yield,'", A1:A3)'),e[se.WorksheetFuncId.FACT]="=FACT(5)",e[se.WorksheetFuncId.FIND]='=FIND("'.concat(FormulaAuthoringStrings.M,'",A2)'),e[se.WorksheetFuncId.HOUR]="=HOUR(0.75)",e[se.WorksheetFuncId.IFNA]='=IFNA("'.concat(FormulaAuthoringStrings.NoNAError,'", "').concat(FormulaAuthoringStrings.Error,'")'),e[se.WorksheetFuncId.IPMT]="=IPMT(10%, 3, 3, 8000)",e[se.WorksheetFuncId.ISNA]="=ISNA(#REF!)",e[se.WorksheetFuncId.LEFT]='=LEFT("'.concat(FormulaAuthoringStrings.SalePrice,'",4)'),e[se.WorksheetFuncId.MIRR]="=MIRR(A2:A7, 0.1, 0.12)",e[se.WorksheetFuncId.NPER]="=NPER(0.12/12, -100, -1000, 10000, 1)",e[se.WorksheetFuncId.PPMT]="=PPMT(0.08, 10, 10, 200000)",e[se.WorksheetFuncId.RAND]="=RAND()",e[se.WorksheetFuncId.RANK]="=RANK(3.5,A2:A6,1)",e[se.WorksheetFuncId.RATE]="=RATE(4*12, -200, 8000)",e[se.WorksheetFuncId.REPT]='=REPT("*-", 3)',e[se.WorksheetFuncId.ROWS]="=ROWS(C1:E4)",e[se.WorksheetFuncId.SECH]="=SECH(0)",e[se.WorksheetFuncId.SIGN]="=SIGN(10)",e[se.WorksheetFuncId.SINH]="=SINH(2)",e[se.WorksheetFuncId.SQRT]="=SQRT(16)",e[se.WorksheetFuncId.TANH]="=TANH(0.5)",e[se.WorksheetFuncId.TEXT]='=TEXT(1234.567,"$#,##0.00")',e[se.WorksheetFuncId.TIME]="=TIME(16,48,10)",e[se.WorksheetFuncId.TRIM]='=TRIM("'.concat(FormulaAuthoringStrings.FirstQuarterEarnings,'")'),e[se.WorksheetFuncId.TRUE]="=TRUE()",e[se.WorksheetFuncId.TYPE]='=TYPE("'.concat(FormulaAuthoringStrings.Smith,'")'),e[se.WorksheetFuncId.VARP]="=VARP(A2:A11)",e[se.WorksheetFuncId.YEAR]="=YEAR(39634)",e[se.WorksheetFuncId.INFO]='=INFO("'.concat(FormulaAuthoringStrings.Numfile,'")'),e[se.WorksheetFuncId.EVEN]="=EVEN(1.5)",e[se.WorksheetFuncId.FINV]="=FINV(0.42, 2, 3)",e[se.WorksheetFuncId.PROB]="=PROB(A3:A6,B3:B6,2)",e[se.WorksheetFuncId.KURT]="=KURT(A2:A11)",e[se.WorksheetFuncId.SKEW]="=SKEW(A2:A11)",e[se.WorksheetFuncId.MODE]="=MODE(A2:A7)",e[se.WorksheetFuncId.MINA]="=MINA(A2:A6)",e[se.WorksheetFuncId.MAXA]="=MAXA(A2:A6)",e[se.WorksheetFuncId.VARA]="=VARA(1, 2)",e[se.WorksheetFuncId.SORT]="=SORT(A2:A17)",e[se.WorksheetFuncId.ASIN]="=ASIN(-0.5)",e[se.WorksheetFuncId.BASE]="=BASE(7,2)",e[se.WorksheetFuncId.CODE]='=CODE("'.concat(FormulaAuthoringStrings.CodeA,'")'),e[se.WorksheetFuncId.AND]="=AND(A2>1,A2<100)",e[se.WorksheetFuncId.COS]="=COS(1.047)",e[se.WorksheetFuncId.COT]="=COT(30)",e[se.WorksheetFuncId.CSC]="=CSC(15)",e[se.WorksheetFuncId.DAY]="=DAY(40648)",e[se.WorksheetFuncId.DDB]="=DDB(2400,300,10*365,1)",e[se.WorksheetFuncId.RTD]='=RTD(mycomaddin.progid,,"'.concat(FormulaAuthoringStrings.ServerName,'","').concat(FormulaAuthoringStrings.Price,'")'),e[se.WorksheetFuncId.EXP]="=EXP(1)",e[se.WorksheetFuncId.INT]="=INT(8.9)",e[se.WorksheetFuncId.IRR]="=IRR(A2:A4,-10%)",e[se.WorksheetFuncId.LEN]='=LEN("'.concat(FormulaAuthoringStrings.Excel,'")'),e[se.WorksheetFuncId.LOG]="=LOG(10)",e[se.WorksheetFuncId.MAX]="=MAX(A2:A6)",e[se.WorksheetFuncId.MID]='=MID("'.concat(FormulaAuthoringStrings.FluidFlow,'",1,5)'),e[se.WorksheetFuncId.MIN]="=MIN(A2:A6)",e[se.WorksheetFuncId.MOD]="=MOD(3, 2)",e[se.WorksheetFuncId.NOT]="=NOT(A2>100)",e[se.WorksheetFuncId.NPV]="=NPV(0.1, -10000, 3000, 4200, 6800)",e[se.WorksheetFuncId.PMT]="=PMT(0.08/12,10,10000)",e[se.WorksheetFuncId.ROW]="=ROW(C10)",e[se.WorksheetFuncId.RRI]="=RRI(96,10000,11000)",e[se.WorksheetFuncId.SEC]="=SEC(30)",e[se.WorksheetFuncId.SIN]="=SIN(PI())",e[se.WorksheetFuncId.SLN]="=SLN(30000, 7500, 10)",e[se.WorksheetFuncId.SUM]="=SUM(A1:A3)",e[se.WorksheetFuncId.SYD]="=SYD(30000,7500,10,1)",e[se.WorksheetFuncId.TAN]="=TAN(0.785)",e[se.WorksheetFuncId.VAR]="=VAR(A2:A11)",e[se.WorksheetFuncId.VDB]="=VDB(2400, 300, 10*365, 0, 1)",e[se.WorksheetFuncId.XOR]="=XOR(3>0,2<9)",e[se.WorksheetFuncId.ODD]="=ODD(1.5)",e[se.WorksheetFuncId.PHI]="=PHI(0.75)",e[se.WorksheetFuncId.RSQ]="=RSQ(A3:A9, B3:B9)",e[se.WorksheetFuncId.IFS]='=IFS(A2>89,"'.concat(FormulaAuthoringStrings.IfsA,'",A2>79,"').concat(FormulaAuthoringStrings.IfsB,'",A2>69,"').concat(FormulaAuthoringStrings.IfsC,'",A2>59,"').concat(FormulaAuthoringStrings.IfsD,'",TRUE,"').concat(FormulaAuthoringStrings.IfsF,'")'),e[se.WorksheetFuncId.DB]="=DB(1000000,100000,6,1,7)",e[se.WorksheetFuncId.FV]="=FV(0.06/12, 10, -200, -500, 1)",e[se.WorksheetFuncId.IF]='=IF(C2>B2,"'.concat(FormulaAuthoringStrings.OverBudget,'","').concat(FormulaAuthoringStrings.WithinBudget,'")'),e[se.WorksheetFuncId.LN]="=LN(86)",e[se.WorksheetFuncId.NA]="=NA()",e[se.WorksheetFuncId.OR]="=OR(A2>1,A2<100)",e[se.WorksheetFuncId.PV]="=PV(0.08/12, 12*20, 500, , 0)",e[se.WorksheetFuncId.N]="=N(".concat(FormulaAuthoringStrings.Even,")"),e[se.WorksheetFuncId.T]='=T("'.concat(FormulaAuthoringStrings.Hello,'")'),e[se.WorksheetFuncId.ACCRINT]="=ACCRINT(39508,39691,39569,0.1,1000,2,0)",e[se.WorksheetFuncId.ACCRINTM]="=ACCRINTM(39539,39614,0.1,1000,3)",e[se.WorksheetFuncId.AMORDEGRC]="=AMORDEGRC(2400,39679,39813,300,1,0.15,1)",e[se.WorksheetFuncId.AMORLINC]="=AMORLINC(2400,39679,39813,300,1,0.15,1)",e[se.WorksheetFuncId.BESSELI]="=BESSELI(1.5,1)",e[se.WorksheetFuncId.BESSELJ]="=BESSELJ(1.9,2)",e[se.WorksheetFuncId.BESSELK]="=BESSELK(1.5,1)",e[se.WorksheetFuncId.BESSELY]="=BESSELY(2.5,1)",e[se.WorksheetFuncId.BIN2DEC]="=BIN2DEC(1100100)",e[se.WorksheetFuncId.BIN2HEX]="=BIN2HEX(11111011, 4)",e[se.WorksheetFuncId.BIN2OCT]="=BIN2OCT(1001, 3)",e[se.WorksheetFuncId.COMPLEX]='=COMPLEX(3,4,"j")',e[se.WorksheetFuncId.CONVERT]='=CONVERT(1,"lbm","kg")',e[se.WorksheetFuncId.COUPDAYBS]="=COUPDAYBS(25-Jan-11,15-Nov-11,2,1)",e[se.WorksheetFuncId.COUPDAYS]="=COUPDAYS(25-Jan-11,15-Nov-11,2,1)",e[se.WorksheetFuncId.COUPDAYSNC]="=COUPDAYSNC(25-Jan-11,15-Nov-11,2,1)",e[se.WorksheetFuncId.COUPNCD]="=COUPNCD(25-Jan-11,15-Nov-11,2,1)",e[se.WorksheetFuncId.COUPNUM]="=COUPNUM(25-Jan-11,15-Nov-12,2,1)",e[se.WorksheetFuncId.COUPPCD]="=COUPPCD(25-Jan-11,15-Nov-11,2,1)",e[se.WorksheetFuncId.CUMIPMT]="=CUMIPMT(A2/12,A3*12,A4,13,24,0)",e[se.WorksheetFuncId.CUMPRINC]="=CUMPRINC(A2/12,A3*12,A4,13,24,0)",e[se.WorksheetFuncId.DEC2BIN]="=DEC2BIN(9, 4)",e[se.WorksheetFuncId.DEC2HEX]="=DEC2HEX(100,4)",e[se.WorksheetFuncId.DEC2OCT]="=DEC2OCT(58,3)",e[se.WorksheetFuncId.DELTA]="=DELTA(5,4)",e[se.WorksheetFuncId.DISC]="=DISC(7/1/2018,1/1/2048,97.975,100,1)",e[se.WorksheetFuncId.DOLLARDE]="=DOLLARDE(1.02,16)",e[se.WorksheetFuncId.DOLLARFR]="=DOLLARFR(1.125,16)",e[se.WorksheetFuncId.DURATION]="=DURATION(7/1/2018,1/1/2048,8%,9%,2,1)",e[se.WorksheetFuncId.EDATE]="=EDATE(15-Jan-11,1)",e[se.WorksheetFuncId.EFFECT]="=EFFECT(0.0525,4)",e[se.WorksheetFuncId.EOMONTH]="=EOMONTH(1-Jan-11,1)",e[se.WorksheetFuncId.ERF]="=ERF(0.745)",e[se.WorksheetFuncId.ERFC]="=ERFC(1)",e[se.WorksheetFuncId.FACTDOUBLE]="=FACTDOUBLE(6)",e[se.WorksheetFuncId.FORECAST_ETS]="=FORECAST.ETS(A62,$B$4:$B$60,$A$4:$A$60,1,1)",e[se.WorksheetFuncId.FORECAST_ETS_CONFINT]="=FORECAST.ETS.CONFINT(A62,$B$4:$B$60,$A$4:$A$60,0.95,1,1)",e[se.WorksheetFuncId.FORECAST_ETS_SEASONALITY]="=FORECAST.ETS.SEASONALITY($B$4:$B$60,$A$4:$A$60,1,1)",e[se.WorksheetFuncId.FORECAST_ETS_STAT]="=FORECAST.ETS.STAT($B$4:$B$60,$A$4:$A$60,1,J48,1,1)",e[se.WorksheetFuncId.FVSCHEDULE]="=FVSCHEDULE(1,{0.09,0.11,0.1})",e[se.WorksheetFuncId.GCD]="=GCD(24,36)",e[se.WorksheetFuncId.GESTEP]="=GESTEP(5,4)",e[se.WorksheetFuncId.HEX2BIN]="=HEX2BIN(F,8)",e[se.WorksheetFuncId.HEX2DEC]="=HEX2DEC(FFFFFFFF5B)",e[se.WorksheetFuncId.HEX2OCT]="=HEX2OCT(F, 3)",e[se.WorksheetFuncId.IMABS]='=IMABS("5+12i")',e[se.WorksheetFuncId.IMAGE]='=IMAGE("https://microsoft.com/abc.jpg", "Microsoft", 0)',e[se.WorksheetFuncId.IMAGINARY]='=IMAGINARY("3+4i")',e[se.WorksheetFuncId.IMARGUMENT]='=IMARGUMENT("3+4i")',e[se.WorksheetFuncId.IMCONJUGATE]='=IMCONJUGATE("3+4i")',e[se.WorksheetFuncId.IMCOS]='=IMCOS("1+i")',e[se.WorksheetFuncId.IMDIV]='=IMDIV("-238+240i","10+24i")',e[se.WorksheetFuncId.IMEXP]='=IMEXP("1+i")',e[se.WorksheetFuncId.IMLN]='=IMLN("3+4i")',e[se.WorksheetFuncId.IMLOG10]='=IMLOG10("3+4i")',e[se.WorksheetFuncId.IMLOG2]='=IMLOG2("3+4i")',e[se.WorksheetFuncId.IMPOWER]='=IMPOWER("2+3i", 3)',e[se.WorksheetFuncId.IMPRODUCT]='=IMPRODUCT("3+4i","5-3i")',e[se.WorksheetFuncId.IMREAL]='=IMREAL("6-9i")',e[se.WorksheetFuncId.IMSIN]='=IMSIN("4+3i")',e[se.WorksheetFuncId.IMSQRT]='=IMSQRT("1+i")',e[se.WorksheetFuncId.IMSUB]='=IMSUB("13+4i","5+3i")',e[se.WorksheetFuncId.IMSUM]='=IMSUM("3+4i","5-3i")',e[se.WorksheetFuncId.INTRATE]="=INTRATE(2/15/2008,5/15/2008,1000000,1014420,2)",e[se.WorksheetFuncId.ISEVEN]="=ISEVEN(2.5)",e[se.WorksheetFuncId.ISODD]="=ISODD(2.5)",e[se.WorksheetFuncId.LAMBDA]="=LAMBDA(a, b, SQRT((a^2+b^2)))",e[se.WorksheetFuncId.LET]="=LET(".concat(FormulaAuthoringStrings.Total,", SUM(A1:A10), ").concat(FormulaAuthoringStrings.Count,", COUNT(A1:A10), ").concat(FormulaAuthoringStrings.Total," / ").concat(FormulaAuthoringStrings.Count,")"),e[se.WorksheetFuncId.LCM]="=LCM(5,2)",e[se.WorksheetFuncId.LOG10]="=LOG10(86)",e[se.WorksheetFuncId.MDURATION]="=MDURATION(1/1/2008,1/1/2016,8%,9%,2,1)",e[se.WorksheetFuncId.MROUND]="=MROUND(10,3)",e[se.WorksheetFuncId.MULTINOMIAL]="=MULTINOMIAL(2,3,4)",e[se.WorksheetFuncId.NETWORKDAYS]="=NETWORKDAYS(10/1/2012,3/1/2013)",e[se.WorksheetFuncId.NOMINAL]="=NOMINAL(0.053543, 4)",e[se.WorksheetFuncId.NOW]="=NOW()",e[se.WorksheetFuncId.OCT2BIN]="=OCT2BIN(3,3)",e[se.WorksheetFuncId.OCT2DEC]="=OCT2DEC(54)",e[se.WorksheetFuncId.OCT2HEX]="=OCT2HEX(100,4)",e[se.WorksheetFuncId.ODDFPRICE]="=ODDFPRICE(11/11/2008,3/1/2021,10/15/2008,3/1/2009,7.85%,6.25%,100,2,1)",e[se.WorksheetFuncId.ODDFYIELD]="=ODDFYIELD(11/11/2008,3/1/2021,10/15/2008,3/1/2009,5.75%,84.5,100,2,0)",e[se.WorksheetFuncId.ODDLPRICE]="=ODDLPRICE(2/7/2008,6/15/2008,10/15/2007,3.75%,4.05%,100,2,0)",e[se.WorksheetFuncId.ODDLYIELD]="=ODDLYIELD(4/20/2008,6/15/2008,12/24/2007,3.75%,99.875,100,2,0)",e[se.WorksheetFuncId.PI]="=PI()",e[se.WorksheetFuncId.PRICE]="=PRICE(2/15/2008,11/15/2017,5.75%,6.5%,100,2,0)",e[se.WorksheetFuncId.PRICEDISC]="=PRICEDISC(2/16/2008,3/1/2008,5.25%,100,2)",e[se.WorksheetFuncId.PRICEMAT]="=PRICEMAT(2/15/2008,4/13/2008,11/11/2007,6.1%,6.1%,0)",e[se.WorksheetFuncId.QUOTIENT]="=QUOTIENT(5,2)",e[se.WorksheetFuncId.RANDBETWEEN]="=RANDBETWEEN(1,100)",e[se.WorksheetFuncId.RECEIVED]="=RECEIVED(2/15/2008,5/15/2008,1000000,5.75%,2)",e[se.WorksheetFuncId.RECURSE]="=RECURSE()",e[se.WorksheetFuncId.ROUNDDOWN]="=ROUNDDOWN(3.14159,3)",e[se.WorksheetFuncId.ROUNDUP]="=ROUNDUP(3.14159,3)",e[se.WorksheetFuncId.SERIESSUM]="=SERIESSUM(0.785398163,0,2,A4:A7)",e[se.WorksheetFuncId.SQRTPI]="=SQRTPI(1)",e[se.WorksheetFuncId.TBILLEQ]="=TBILLEQ(3/31/2008,6/1/2008,9.14%)",e[se.WorksheetFuncId.TBILLPRICE]="=TBILLPRICE(3/31/2008,6/1/2008,9%)",e[se.WorksheetFuncId.TBILLYIELD]="=TBILLYIELD(3/31/2008,6/1/2008,98.45%)",e[se.WorksheetFuncId.TINV]="=TINV(0.05464,60)",e[se.WorksheetFuncId.WEEKNUM]="=WEEKNUM(3/9/2012,2)",e[se.WorksheetFuncId.WORKDAY]="=WORKDAY(10/1/2008,151)",e[se.WorksheetFuncId.XIRR]="=XIRR(A3:A7, B3:B7, 0.1)",e[se.WorksheetFuncId.XNPV]="=XNPV(0.09, A2:A6, B2:B6)",e[se.WorksheetFuncId.YEARFRAC]="=YEARFRAC(1/1/2012,7/30/2012)",e[se.WorksheetFuncId.YIELD]="=YIELD(2/15/2008,11/15/2016,5.75%,95.04287,100,2,0)",e[se.WorksheetFuncId.YIELDDISC]="=YIELDDISC(2/16/2008,3/1/2008,99.795,100,2)",e[se.WorksheetFuncId.YIELDMAT]="=YIELDMAT(3/15/2008,11/3/2008,11/8/2007,6.25%,100.0123,0)",e[se.WorksheetFuncId.TEXTSPLIT]='=TEXTSPLIT("1,2,3;4,5,6",",",";")',e[se.WorksheetFuncId.TEXTBEFORE]='=TEXTBEFORE("Red riding hood\'s, red hood", "hood")',e[se.WorksheetFuncId.TEXTAFTER]='=TEXTAFTER("Red riding hood\'s, red hood", "hood")',e[se.WorksheetFuncId.VSTACK]="=VSTACK({1,2},{3,4},5)",e[se.WorksheetFuncId.HSTACK]="=HSTACK({1;2},{3;4},5)",e[se.WorksheetFuncId.MAP]="=MAP(A1:C2, LAMBDA(a, IF(a>4,a*a,a)))",e[se.WorksheetFuncId.WRAPROWS]="=WRAPROWS(A2:G2,3)",e[se.WorksheetFuncId.SCAN]="=SCAN(1, A1:C2, LAMBDA(a,b,a*b))",e[se.WorksheetFuncId.MAKEARRAY]="=MAKEARRAY(3, 3, LAMBDA(row,col, row*col))",e[se.WorksheetFuncId.REDUCE]="=REDUCE(, A1:C2, LAMBDA(a,b,a+b^2))",e[se.WorksheetFuncId.NORMSDIST]="=NORMDIST(A2,A3,A4,TRUE)",e[se.WorksheetFuncId.CHOOSEROWS]="=CHOOSEROWS(A2:B7,1,3,5,1)",e[se.WorksheetFuncId.CHOOSECOLS]="=CHOOSECOLS(A2:E7,1,3,5,1)",e[se.WorksheetFuncId.DROP]="=DROP(A2:C4,2)",e[se.WorksheetFuncId.WRAPCOLS]="=WRAPCOLS(A2:F2,3)",e[se.WorksheetFuncId.TOCOL]="=TOCOL(A2:D4)",e[se.WorksheetFuncId.TAKE]="=TAKE(A2:C4,2)",e[se.WorksheetFuncId.TOROW]="=TOROW(A2:D4)",e[se.WorksheetFuncId.BYCOL]="=BYCOL(A1:C2, LAMBDA(".concat(FormulaAuthoringStrings.Array,", MAX(").concat(FormulaAuthoringStrings.Array,")))"),e[se.WorksheetFuncId.BYROW]="=BYROW(A1:C2, LAMBDA(".concat(FormulaAuthoringStrings.Array,", MAX(").concat(FormulaAuthoringStrings.Array,")))"),e[se.WorksheetFuncId.EXPAND]="=EXPAND(A2:B3,3,3)",e[se.WorksheetFuncId.DBCS]='=DBCS("EXCEL")',e[se.WorksheetFuncId.ASC]='=ASC("EXCEL")',e[se.WorksheetFuncId.LENB]='=LENB("EXCEL")',e[se.WorksheetFuncId.FURIGANA]="=PHONETIC(C4)",e[se.WorksheetFuncId.ISOMITTED]='=LAMBDA(x,y, IF(ISOMITTED(y),"'.concat(FormulaAuthoringStrings.MissingSecondArgument,'",x+y))(1,)'),e[se.WorksheetFuncId.MIDB]="=MIDB(A2,7,20)",e[se.WorksheetFuncId.RIGHTB]="=RIGHTB(A2,7)",e});p7.functionExamples=z6r});var POe=Y(m7=>{_();Object.defineProperty(m7,"__esModule",{value:!0});m7.ArgumentAssistanceVisitor=void 0;var Y6r=br(),J6r=Jc(),X6r=Qu(),Z6r=Ml(),$6r=function(e){(0,Y6r.__extends)(r,e);function r(n,a){var o=e.call(this)||this;return o.parsedFormulaTree=n,o.caretPosition=a,o.assistedFunctionScopeStart=0,o.fixHandlingWhiteSpace=!1,o.fixHandlingWhiteSpace=(0,J6r.isTypedChangeGateEnabled)("OfficeVSO:7920319_fixArgumentAssistanceHandlingWhitespaces"),o}return r.prototype.appNode=function(n,a,o,u){return n.kind===X6r.NodeKind.WSF&&this.updateAssistedFunction(n,a),e.prototype.appNode.call(this,n,a,o,u)},r.prototype.letNode=function(n,a,o,u,t,d){var s=e.prototype.letNode.call(this,n,a,o,u,t,d);return this.updateAssistedFunction(n,s.args),s},r.prototype.lambdaNode=function(n,a,o,u,t,d){var s=e.prototype.lambdaNode.call(this,n,a,o,u,t,d);return this.updateAssistedFunction(n,s.args),s},r.prototype.updateAssistedFunction=function(n,a){var o=this.parsedFormulaTree.spans[a[0].label],u=this.parsedFormulaTree.spans[a[a.length-1].label],t=o.start,d=u.end;this.fixHandlingWhiteSpace&&(t-=o.pre.length,d+=u.post.length),this.caretPosition<=d&&this.caretPosition>=t&&(this.assistedFunctionHead===void 0||t>this.assistedFunctionScopeStart)&&(this.assistedFunctionHead=n,this.assistedFunctionArgs=a,this.assistedFunctionScopeStart=t)},r}(Z6r.IdentityVisitor);m7.ArgumentAssistanceVisitor=$6r});var eae=Y(aF=>{_();Object.defineProperty(aF,"__esModule",{value:!0});aF.createFunctionRenderingInfo=rBr;aF.getBaseParamName=$te;aF.getParamIndexToHighlight=g7;aF.getParamNumberSuffix=EOe;var eBr=sg();function rBr(e,r,n,a,o,u,t,d,s){var c=tBr(r,n,a,t),l=e.Params.split("!"),f={functionName:e.NameDataStrings,functionDescription:e.Help,signatures:l.map(function(p,m){return nBr(e,p,m,c,o,u,d,s)}),activeSignature:0,listSeparator:u,isUDF:e.IsDynamicUdf,helpID:e.HelpId};return f}function nBr(e,r,n,a,o,u,t,d){var s=(0,eBr.getWorksheetFuncType)(o),c=r!==""?r.split(u+" ").filter(function(h){return h!=="..."}):[],l=uBr(c,s,a),f=iBr(t,d),p=oBr(e.ParamsHelp,c,s,n),m=sBr(l,p),v={signatureParams:Zte(l,aBr(a,c.length,s)),descriptions:p,descriptionParams:Zte(m,g7(a,m.length,s)),exampleParams:f!==null?Zte(f,g7(a,f.length,s,!0)):null,exampleDescription:""};return v}function tBr(e,r,n,a){var o,u=0;if(a)for(var t=0;t<r.length;t++){var d=e.spans[r[t].label];if(d&&d.start-d.pre.length<=n&&n<=d.end+d.post.length){u=t;break}}else for(var t=r.length-1;t>=0;t-=1){var s=(o=e.spans[r[t].label])===null||o===void 0?void 0:o.end;s!==void 0&&n<=s&&(u=t)}return u}function g7(e,r,n,a,o){a===void 0&&(a=!1),o===void 0&&(o=!1);var u=r-1,t=n.restTypes.length,d=n.headTypes.length;if(e<d+t)return e;if(e>=d&&t===0)return-1;var s=(e-d)%t;if(a)return e<=u-n.tailTypes.length?e:u-n.tailTypes.length-(t-1)+s;var c=o&&s===0&&n.tailTypes.length>0?t:s;return d+c}function aBr(e,r,n){var a=g7(e,r,n);return NOe(e,n)&&(a+=1),a}function iBr(e,r){return e===void 0||r===void 0?null:r.node.args.map(function(n){var a=r.spans[n.label];return a?e.substring(a.start,a.end):""})}function oBr(e,r,n,a){var o=e.split("!");if(a===0?o=o.slice(0,r.length):o=o.slice(-1*r.length),n.restTypes.length>0){for(var u=n.headTypes.length;u<o.length;u+=1){var t=$te(r[u]),d="".concat(t,"1,").concat(t,"2,... ");o[u]=d+o[u]}n.restTypes.length===1&&o.push(o[n.headTypes.length])}return o}function uBr(e,r,n){var a=e.slice(),o=r.headTypes.length,u=r.restTypes.length;if(u>0){for(var t=EOe(n,o,u),d=o;d<a.length;d+=u){for(var s=0;s<u;s+=1){var c=$te(a[d+s]),l=t>1&&s%u===0?"[":"",f=t>1&&s%u===u-1?"]":"";a[d+s]="".concat(l).concat(c).concat(t).concat(f)}t+=1}a.push("..."),NOe(n,r)&&a.splice(o,0,"...")}return a}function EOe(e,r,n){return 1+Math.max(Math.floor((e-r)/n),0)}function sBr(e,r){return e.filter(function(n){return n!=="..."}).slice(0,r.length).map(function(n){return lBr(n)})}function NOe(e,r){return r.restTypes.length>0&&e>=r.headTypes.length+r.restTypes.length}function $te(e){return e.match(/[^0-9\[\]]+/)}function lBr(e){return e.startsWith("[")&&!e.endsWith("]")?e+"]":!e.startsWith("[")&&e.endsWith("]")?"["+e:e}function Zte(e,r){var n={params:e,activeParam:Math.min(r,e.length-1)};return n}});var Jd=Y(s0=>{_();Object.defineProperty(s0,"__esModule",{value:!0});s0.workerThreadSpread=s0.workerThreadInitialized=s0.scriptLoaderPromise=s0.schedulerWithRecalcServiceAttached=s0.dynamicPluginLoaderCreated=s0.autoCompletePluginsThread=s0.FormulaAuthoringStringsOnMainThread=void 0;var uh=br(),rae=rF(),LE=cu(),cBr=Pk(),dBr=Jc(),AOe=Fu(),OOe=(0,LE.asyncLazy)(function(){return(0,uh.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,uh.__generator)(this,function(r){switch(r.label){case 0:return[4,v7.getValue()];case 1:return e=r.sent(),[4,e.loadPluginScript("formula-authoring-strings",!0)];case 2:return r.sent(),[2]}})})});s0.FormulaAuthoringStringsOnMainThread=OOe;var kOe=new cBr.ResolvablePromise;s0.scriptLoaderPromise=kOe;var fBr=(0,LE.asyncLazy)(function(){return(0,uh.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,uh.__generator)(this,function(r){switch(r.label){case 0:return e=rae.PluginSchedulerSingleton.instance(),gBr.getValue()?[4,OOe.getValue()]:[3,2];case 1:r.sent(),r.label=2;case 2:return[4,e.recalcServiceAttached()];case 3:return r.sent(),[2,e]}})})});s0.schedulerWithRecalcServiceAttached=fBr;var v7=(0,LE.asyncLazy)(function(){return(0,uh.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,uh.__generator)(this,function(r){switch(r.label){case 0:return[4,kOe];case 1:return e=r.sent(),[2,(0,rae.createDynamicPluginLoader)(e)]}})})});s0.dynamicPluginLoaderCreated=v7;var nae=(0,LE.asyncLazy)(function(){return(0,uh.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,uh.__generator)(this,function(r){switch(r.label){case 0:return[4,v7.getValue()];case 1:return e=r.sent(),[2,e.createPluginThread("worker")]}})})});s0.workerThreadSpread=nae;var pBr=(0,LE.asyncLazy)(function(){return(0,uh.__awaiter)(void 0,void 0,void 0,function(){return(0,uh.__generator)(this,function(e){switch(e.label){case 0:return[4,nae.getValue()];case 1:return e.sent(),[2]}})})});s0.workerThreadInitialized=pBr;var mBr=(0,LE.asyncLazy)(function(){return(0,uh.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,uh.__generator)(this,function(r){switch(r.label){case 0:return(0,dBr.getTypedFeatureGate)("Microsoft.Office.Excel.AutoCompleteOnMainThread")?[4,v7.getValue()]:[3,2];case 1:return e=r.sent(),[3,4];case 2:return[4,nae.getValue()];case 3:e=r.sent(),r.label=4;case 4:return[2,e]}})})});s0.autoCompletePluginsThread=mBr;var gBr=new LE.ResettableLazy(function(){var e=rae.PluginSchedulerSingleton.instance();return!e.isSchedulerFeatureEnabled(AOe.SchedulerFeature.SimpleAutoComplete)&&e.isSchedulerFeatureEnabled(AOe.SchedulerFeature.ArgumentAssistance)})});var oae=Y(iF=>{_();Object.defineProperty(iF,"__esModule",{value:!0});iF.argumentAssistancePluginDependenciesResolved=iF.ArgumentAssistancePluginFactory=void 0;var iae=br(),vp=ds(),vBr=Cd(),hBr=Ml(),SBr=bOe(),BE=tu(),tx=Di(),yBr=Ll(),FOe=kk(),CBr=POe(),tae=eae(),IOe=cu(),aae=Jd(),_Br=FD(),MOe=Jc(),wOe=Fu(),DOe=function(){function e(){this.factoryName=wOe.PluginFactoryName.ArgumentAssistancePlugin}return e.prototype.create=function(){var r=new RBr;return r},e}();iF.ArgumentAssistancePluginFactory=DOe;var RBr=function(){function e(){this.timer=_Br.defaultTimerInterface,this.lastRunTime=0,this.runStartTime=0,this.timeStamps=new Map,this.fixHandlingWhiteSpace=(0,MOe.isTypedChangeGateEnabled)("OfficeVSO:7920319_fixArgumentAssistanceHandlingWhitespaces")}return e.prototype.run=function(r){var n,a,o,u,t,d,s,c,l,f,p,m,v,h,S,y,C,E=this;return(0,iae.__generator)(this,function(I){switch(I.label){case 0:return this.lastRunTime=this.timer.now(),this.runStartTime=this.timer.now(),this.timeStamps=new Map,[4,{kind:vp.ComputationRequestKind.GetActiveCell}];case 1:return n=I.sent(),n.kind!==vp.ComputationRequestKind.GetActiveCell?(this.logFailure("failed to get active cell"),[2,null]):(this.addTimeStamp("GetActiveCell"),[4,{kind:vp.ComputationRequestKind.ParseActiveCell,formulaText:r.content}]);case 2:return a=I.sent(),this.addTimeStamp("ParseCellContentSync"),a===void 0||a.kind!==vp.ComputationRequestKind.ParseActiveCell||!(0,tx.isSuccess)(a.result)?[4,{kind:vp.ComputationRequestKind.ParseEdit,cell:n.activeCell,formulaBarText:r.content}]:[3,4];case 3:if(a=I.sent(),this.addTimeStamp("ParseCellContentAsync"),a.kind!==vp.ComputationRequestKind.ParseEdit||!(0,tx.isSuccess)(a.result))return[2,null];I.label=4;case 4:return a.result.value.kind!==yBr.EditKind.Formula?[2,null]:(o=a.result.value.formula,u=new CBr.ArgumentAssistanceVisitor(o,r.caretPosition),(0,hBr.reduceBottomUp)(u,o),this.addTimeStamp("ArgumentAssistanceVisitor"),u.assistedFunctionHead===void 0?(this.logTimeStamp(),[2,null]):[4,{kind:vp.ComputationRequestKind.GetFunctionInfo,functionName:u.assistedFunctionHead.whole}]);case 5:return t=I.sent(),this.addTimeStamp("GetFunctionInfo"),t.kind!==vp.ComputationRequestKind.GetFunctionInfo?(this.logFailure("failed to get function info for ".concat(u.assistedFunctionHead.whole)),[2,null]):[4,{kind:vp.ComputationRequestKind.GetConfig}];case 6:return d=I.sent(),this.addTimeStamp("GetConfig"),s=d.kind===vp.ComputationRequestKind.GetConfig?d.config.localeInfo.listSeparator:",",c=new IOe.ResettableLazy(function(){return(0,tae.createFunctionRenderingInfo)(t.functionInfo,o,u.assistedFunctionArgs,r.caretPosition,u.assistedFunctionHead.id,s,E.fixHandlingWhiteSpace)}),l=SBr.functionExamples.getValue()[u.assistedFunctionHead.id],this.addTimeStamp("GetExampleString"),l===void 0?(this.logFailure("no example found for function: ".concat(u.assistedFunctionHead.whole,", id: ").concat(u.assistedFunctionHead.id)),this.addTimeStampAndLog("createFunctionRenderingInfoNoExample"),[2,c.getValue()]):[4,{kind:vp.ComputationRequestKind.ParseCellFormula,cell:n.activeCell,formula:{formulaBarText:l,kind:FOe.FormulaKind.CellFormula},useEnglishLocaleInfo:!0}];case 7:return f=I.sent(),this.addTimeStamp("ParseExample"),f.kind!==vp.ComputationRequestKind.ParseCellFormula||!(0,tx.isSuccess)(f.result)?(this.logFailure("failed to parse example for function: ".concat(u.assistedFunctionHead.whole)),p=c.getValue(),this.addTimeStampAndLog("createFunctionRenderingInfoFailedToParseExample"),[2,p]):d.kind===vp.ComputationRequestKind.GetConfig&&d.config.localeInfo.lcid===BE.LCID.USA?(m=(0,tae.createFunctionRenderingInfo)(t.functionInfo,o,u.assistedFunctionArgs,r.caretPosition,u.assistedFunctionHead.id,s,this.fixHandlingWhiteSpace,l,f.result.value),this.addTimeStampAndLog("createFunctionRenderingInfoEnUs"),[2,m]):[4,{kind:vp.ComputationRequestKind.PrintFormula,formula:f.result.value,origin:n.activeCell}];case 8:return v=I.sent(),this.addTimeStamp("localize example string"),v.kind!==vp.ComputationRequestKind.PrintFormula||!(0,tx.isSuccess)(v.result)?(this.logFailure("failed to pretty print localized example for function: ".concat(u.assistedFunctionHead.whole)),h=c.getValue(),this.addTimeStampAndLog("createFunctionRenderingInfoFailedToPrintLocalizedExample"),[2,h]):[4,{kind:vp.ComputationRequestKind.ParseCellFormula,cell:n.activeCell,formula:{formulaBarText:v.result.value,kind:FOe.FormulaKind.CellFormula},useEnglishLocaleInfo:!1}];case 9:return S=I.sent(),this.addTimeStamp("parse localized example string"),S.kind!==vp.ComputationRequestKind.ParseCellFormula||!(0,tx.isSuccess)(S.result)?(this.logFailure("failed to parse localized example for function: ".concat(u.assistedFunctionHead.whole)),y=c.getValue(),this.addTimeStampAndLog("createFunctionRenderingInfoFailedToParseLocalizedExample"),[2,y]):(C=(0,tae.createFunctionRenderingInfo)(t.functionInfo,o,u.assistedFunctionArgs,r.caretPosition,u.assistedFunctionHead.id,s,this.fixHandlingWhiteSpace,v.result.value,S.result.value),this.addTimeStampAndLog("createFunctionRenderingInfoWithLocalizedExample"),[2,C])}})},e.prototype.logFailure=function(r){BE.ulsLogger.ULS.traceTag(545388683,BE.LogCategory.msoulscat_ES_EWAJS,BE.TraceLevel.Warning,"ArgumentAssistancePlugin encountered a failure with msg ".concat(r))},e.prototype.addTimeStampAndLog=function(r){this.addTimeStamp(r),this.logTimeStamp()},e.prototype.logTimeStamp=function(){this.timeStamps.set("Overall",this.timer.now()-this.runStartTime);var r={};this.timeStamps.forEach(function(n,a){r[a]=n}),BE.ulsLogger.ULS.traceTag(540377222,BE.LogCategory.msoulscat_ES_EWAJS,BE.TraceLevel.Info,"".concat(JSON.stringify(r)))},e.prototype.addTimeStamp=function(r){this.timeStamps.set(r,this.timer.now()-this.lastRunTime),this.lastRunTime=this.timer.now()},e}();(0,vBr.registerPluginFactory)(new DOe);var TBr=(0,IOe.asyncLazy)(function(){return(0,iae.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,iae.__generator)(this,function(r){switch(r.label){case 0:return(0,MOe.getTypedFeatureGate)("Microsoft.Office.Excel.ArgumentAssistanceOnMainThread")?[4,aae.dynamicPluginLoaderCreated.getValue()]:[3,2];case 1:return e=r.sent(),[3,4];case 2:return[4,aae.workerThreadSpread.getValue()];case 3:e=r.sent(),r.label=4;case 4:return[4,e.loadPluginScript("formula-authoring-strings",!0)];case 5:return r.sent(),[4,e.createAndAttachPlugin(wOe.PluginFactoryName.ArgumentAssistancePlugin)];case 6:return r.sent(),[4,aae.schedulerWithRecalcServiceAttached.getValue()];case 7:return r.sent(),[2]}})})});iF.argumentAssistancePluginDependenciesResolved=TBr});var uae=Y(S7=>{_();Object.defineProperty(S7,"__esModule",{value:!0});S7.AutocompleteBaseVisitor=void 0;var bBr=br(),h7=Qu(),PBr=ER(),EBr=function(e){(0,bBr.__extends)(r,e);function r(n,a,o,u){var t=e.call(this,n,a)||this;return t.formulaString=o,t.autoCompleteForCellRefEnabled=u,t}return r.prototype.nameNode=function(n,a,o){return(n.kind===h7.NamePartKind.IdentNamePart||n.kind===h7.NamePartKind.FieldRefNamePart)&&this.updateAutocompleteString(o,n.asWhole),e.prototype.nameNode.call(this,n,a,o)},r.prototype.appNode=function(n,a,o,u){return this.autoCompleteForCellRefEnabled&&n.kind===h7.NodeKind.WSF&&this.updateAutocompleteString(u,n.whole),e.prototype.appNode.call(this,n,a,o,u)},r.prototype.cellRefNode=function(n,a,o){var u=this.parsedFormulaTree.spans[o];if(n.kind===h7.CellRefKind.Single&&u){var t=this.formulaString.substring(u.start,u.end);this.updateAutocompleteString(o,t)}return e.prototype.cellRefNode.call(this,n,a,o)},r.prototype.updateAutocompleteString=function(n,a){var o=this.parsedFormulaTree.spans[n].start,u=o+a.length;this.caretPosition===u&&(this.autocompleteString=a,this.stringEndPosition=u,this.stringStartPosition=o)},r}(PBr.CaretInsideArrayNodeIdentityVisitor);S7.AutocompleteBaseVisitor=EBr});var sae=Y(uF=>{_();Object.defineProperty(uF,"__esModule",{value:!0});uF.autocompleteFunctionPluginDependenciesResolved=uF.AutocompleteFunctionPluginFactory=void 0;var ax=br(),y7=ds(),NBr=Cd(),oF=tu(),ABr=Di(),OBr=Ll(),kBr=cu(),xOe=Jd(),FBr=Ml(),IBr=gte(),MBr=eh(),LOe=Fu(),wBr=FT(),DBr=uae(),xBr=Ql(),LBr=ft(),BOe=function(){function e(){this.factoryName=LOe.PluginFactoryName.AutocompleteFunctionPlugin}return e.prototype.create=function(){return new BBr},e}();uF.AutocompleteFunctionPluginFactory=BOe;var BBr=function(){function e(){this.autoCompleteForCellRefEnabled=(0,xBr.isChangeGateEnabled)("OfficeVSO:6212698_fixFunctionAutoCompleteForCellRef")}return e.prototype.run=function(r){var n,a,o,u,t,d,s,c,l,f,p,m,v,h,S,y,C;return(0,ax.__generator)(this,function(E){switch(E.label){case 0:return[4,{kind:y7.ComputationRequestKind.ParseActiveCell,formulaText:r.content}];case 1:return n=E.sent(),n.kind!==y7.ComputationRequestKind.ParseActiveCell||!(0,ABr.isSuccess)(n.result)?[2,null]:n.result.value.kind!==OBr.EditKind.Formula?[2,null]:(a=n.result.value.formula,o=new DBr.AutocompleteBaseVisitor(a,r.caretPosition,r.content,this.autoCompleteForCellRefEnabled),(0,FBr.reduceBottomUp)(o,a),o.autocompleteString===void 0||o.stringStartPosition===void 0||o.stringEndPosition===void 0||o.isInsideArrayNode?[2,null]:(u=o.autocompleteString.toUpperCase(),t=o.stringStartPosition,d=o.stringEndPosition,[4,{kind:y7.ComputationRequestKind.GetFunctionsInfo}]));case 2:return s=E.sent(),s.kind!==y7.ComputationRequestKind.GetFunctionsInfo?(this.logFailure("failed to get functions info"),[2,null]):(c=s.functionsInfo,l=(0,wBr.filterSuggestionsAccordingToPrefix)(u,c,function(I){return I.NameDataStrings}),f=l.prefixedSuggestions,p=l.notPrefixedSuggestions,m=IBr.functionShortDescriptions.getValue(),(m===null||m.descriptionsMap===null&&m.descriptionMap===null)&&this.logFailure("failed to get short descriptions, will show function info help description"),v=((C=r.content)===null||C===void 0?void 0:C.charAt(d))==="(",h=v?"":"(",S=this.generateCompletionItems(f,m,t,d,!0,h),y=this.generateCompletionItems(p,m,t,d,!1,h),[2,{items:(0,ax.__spreadArray)((0,ax.__spreadArray)([],S,!0),y,!0)}])}})},e.prototype.generateCompletionItems=function(r,n,a,o,u,t){var d=[],s=r.map(function(c){var l,f,p,m=(f=(l=n.descriptionMap)===null||l===void 0?void 0:l.get(c.FunctionIndexInServer.toString()))!==null&&f!==void 0?f:(p=n.descriptionsMap)===null||p===void 0?void 0:p.get(c.FunctionIndexInServer);return(0,LBr.isNone)(m)&&(d.push(c.FunctionIndexInServer),m=c.Help),{label:c.NameDataStrings,kind:MBr.CompletionItemKind.Function,detail:m,textEdit:{newText:c.NameDataStrings+t,range:{start:{line:0,character:a},end:{line:0,character:o}}},isPrefixed:u}});return d.length>0&&oF.ulsLogger.ULS.traceTag(508871621,oF.LogCategory.msoulscat_ES_EWAJS,oF.TraceLevel.Info,"AutocompleteFunctionPlugin missing short descriptions for func IDs: ".concat(JSON.stringify(d))),s},e.prototype.logFailure=function(r){oF.ulsLogger.ULS.traceTag(539083013,oF.LogCategory.msoulscat_ES_EWAJS,oF.TraceLevel.Warning,"AutocompleteFunctionPlugin encountered a failure with msg ".concat(r))},e}();(0,NBr.registerPluginFactory)(new BOe);var qBr=(0,kBr.asyncLazy)(function(){return(0,ax.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,ax.__generator)(this,function(r){switch(r.label){case 0:return[4,xOe.autoCompletePluginsThread.getValue()];case 1:return e=r.sent(),[4,e.loadPluginScript("formula-authoring-strings",!0)];case 2:return r.sent(),[4,e.createAndAttachPlugin(LOe.PluginFactoryName.AutocompleteFunctionPlugin)];case 3:return r.sent(),[4,xOe.schedulerWithRecalcServiceAttached.getValue()];case 4:return r.sent(),[2]}})})});uF.autocompleteFunctionPluginDependenciesResolved=qBr});var qOe=Y(C7=>{_();Object.defineProperty(C7,"__esModule",{value:!0});C7.AutoCompleteEnumVisitor=void 0;var UBr=br(),GBr=Qu(),KBr=ER(),VBr=function(e){(0,UBr.__extends)(r,e);function r(n,a){return e.call(this,n,a)||this}return r.prototype.appNode=function(n,a,o,u){return n.kind===GBr.NodeKind.WSF&&this.updateAssistedFunctionAndArgIndex(n,a),e.prototype.appNode.call(this,n,a,o,u)},r.prototype.updateAssistedFunctionAndArgIndex=function(n,a){for(var o=0;o<a.length;o++){var u=this.parsedFormulaTree.spans[a[o].label];if(u&&u.start-u.pre.length<=this.caretPosition&&this.caretPosition<=u.end+u.post.length&&this.functionHead===void 0){this.functionHead=n,this.argIndex=o,this.functionArgs=a,this.stringStartPosition=u.start,this.stringEndPosition=u.end;break}}},r}(KBr.CaretInsideArrayNodeIdentityVisitor);C7.AutoCompleteEnumVisitor=VBr});var UOe=Y(_7=>{_();Object.defineProperty(_7,"__esModule",{value:!0});_7.functionEnums=void 0;var rr=sg(),WBr=cu(),xm=f1(),jBr=new WBr.ResettableLazy(function(){var e;return e={},e[rr.WorksheetFuncId.ERROR_TYPE]={1:[{value:function(n){var a;return(a=n.errorNames[xm.ErrorType.NULL])!==null&&a!==void 0?a:""},description:xm.ErrorType.NULL.toString()},{value:function(n){var a;return(a=n.errorNames[xm.ErrorType.DIV0])!==null&&a!==void 0?a:""},description:xm.ErrorType.DIV0.toString()},{value:function(n){var a;return(a=n.errorNames[xm.ErrorType.VALUE])!==null&&a!==void 0?a:""},description:xm.ErrorType.VALUE.toString()},{value:function(n){var a;return(a=n.errorNames[xm.ErrorType.REF])!==null&&a!==void 0?a:""},description:xm.ErrorType.REF.toString()},{value:function(n){var a;return(a=n.errorNames[xm.ErrorType.NAME])!==null&&a!==void 0?a:""},description:xm.ErrorType.NAME.toString()},{value:function(n){var a;return(a=n.errorNames[xm.ErrorType.NUM])!==null&&a!==void 0?a:""},description:xm.ErrorType.NUM.toString()},{value:function(n){var a;return(a=n.errorNames[xm.ErrorType.NA])!==null&&a!==void 0?a:""},description:xm.ErrorType.NA.toString()}]},e[rr.WorksheetFuncId.SUBTOTAL]={1:[{value:"1",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.AVERAGE)}},{value:"2",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.COUNT)}},{value:"3",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.COUNTA)}},{value:"4",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.MAX)}},{value:"5",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.MIN)}},{value:"6",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.PRODUCT)}},{value:"7",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.STDEV)}},{value:"8",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.STDEVP)}},{value:"9",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.SUM)}},{value:"10",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.VAR)}},{value:"11",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.VARP)}},{value:"101",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.AVERAGE)}},{value:"102",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.COUNT)}},{value:"103",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.COUNTA)}},{value:"104",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.MAX)}},{value:"105",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.MIN)}},{value:"106",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.PRODUCT)}},{value:"107",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.STDEV)}},{value:"108",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.STDEVP)}},{value:"109",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.SUM)}},{value:"110",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.VAR)}},{value:"111",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.VARP)}}]},e[rr.WorksheetFuncId.AGGREGATE]={1:[{value:"1",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.AVERAGE)}},{value:"2",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.COUNT)}},{value:"3",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.COUNTA)}},{value:"4",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.MAX)}},{value:"5",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.MIN)}},{value:"6",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.PRODUCT)}},{value:"7",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.STDEV)}},{value:"8",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.STDEVP)}},{value:"9",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.SUM)}},{value:"10",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.VAR)}},{value:"11",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.VARP)}},{value:"12",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.MEDIAN)}},{value:"13",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.MODE_SNGL)}},{value:"14",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.LARGE)}},{value:"15",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.SMALL)}},{value:"16",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.PERCENTILE_INC)}},{value:"17",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.QUARTILE_INC)}},{value:"18",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.PERCENTILE_EXC)}},{value:"19",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.QUARTILE_EXC)}}],2:[{value:"0",description:function(n){return FormulaAuthoringStrings.IgnoreNestedSUBTOTALandAGGREGATEfunctions.replace("{0}",n.getWorksheetFuncName(rr.WorksheetFuncId.SUBTOTAL)).replace("{1}",n.getWorksheetFuncName(rr.WorksheetFuncId.AGGREGATE))}},{value:"1",description:function(n){return FormulaAuthoringStrings.IgnoreHiddenRowsNestedSUBTOTALandAGGREGATEfunctions.replace("{0}",n.getWorksheetFuncName(rr.WorksheetFuncId.SUBTOTAL)).replace("{1}",n.getWorksheetFuncName(rr.WorksheetFuncId.AGGREGATE))}},{value:"2",description:function(n){return FormulaAuthoringStrings.IgnoreErrorValuesNestedSUBTOTALandAGGREGATEfunctions.replace("{0}",n.getWorksheetFuncName(rr.WorksheetFuncId.SUBTOTAL)).replace("{1}",n.getWorksheetFuncName(rr.WorksheetFuncId.AGGREGATE))}},{value:"3",description:function(n){return FormulaAuthoringStrings.IgnoreHiddenRowsErrorValuesNestedSUBTOTALandAGGREGATEfunctions.replace("{0}",n.getWorksheetFuncName(rr.WorksheetFuncId.SUBTOTAL)).replace("{1}",n.getWorksheetFuncName(rr.WorksheetFuncId.AGGREGATE))}},{value:"4",description:FormulaAuthoringStrings.IgnoreNothing},{value:"5",description:FormulaAuthoringStrings.IgnoreHiddenRows},{value:"6",description:FormulaAuthoringStrings.IgnoreErrorValues},{value:"7",description:FormulaAuthoringStrings.IgnoreHiddenRowsErrorValues}]},e[rr.WorksheetFuncId.CUBESET]={4:[{value:"0",description:FormulaAuthoringStrings.None},{value:"1",description:FormulaAuthoringStrings.Ascending},{value:"2",description:FormulaAuthoringStrings.Descending},{value:"3",description:FormulaAuthoringStrings.AlphaAscending},{value:"4",description:FormulaAuthoringStrings.AlphaDescending},{value:"5",description:FormulaAuthoringStrings.NaturalAscending},{value:"6",description:FormulaAuthoringStrings.NaturalDescending}]},e[rr.WorksheetFuncId.VLOOKUP]={4:[{value:function(n){return n.trueName},description:FormulaAuthoringStrings.ApproximateMatch},{value:function(n){return n.falseName},description:FormulaAuthoringStrings.ExactMatch}]},e[rr.WorksheetFuncId.HLOOKUP]={4:[{value:function(n){return n.trueName},description:FormulaAuthoringStrings.ApproximateMatch},{value:function(n){return n.falseName},description:FormulaAuthoringStrings.ExactMatch}]},e[rr.WorksheetFuncId.XLOOKUP]={5:[{value:"0",description:FormulaAuthoringStrings.ExactMatch},{value:"-1",description:FormulaAuthoringStrings.ExactMatchOrNextSmallerItem},{value:"1",description:FormulaAuthoringStrings.ExactMatchOrNextLargerItem},{value:"2",description:FormulaAuthoringStrings.WildcardCharacterMatch}],6:[{value:"1",description:FormulaAuthoringStrings.SearchFirstToLast},{value:"-1",description:FormulaAuthoringStrings.SearchLastToFirst},{value:"2",description:FormulaAuthoringStrings.BinarySearchAscending},{value:"-2",description:FormulaAuthoringStrings.BinarySearchDescending}]},e[rr.WorksheetFuncId.RANK]={3:[{value:"0",description:FormulaAuthoringStrings.Descending},{value:"1",description:FormulaAuthoringStrings.Ascending}]},e[rr.WorksheetFuncId.RANK_AVG]={3:[{value:"0",description:FormulaAuthoringStrings.Descending},{value:"1",description:FormulaAuthoringStrings.Ascending}]},e[rr.WorksheetFuncId.RANK_EQ]={3:[{value:"0",description:FormulaAuthoringStrings.Descending},{value:"1",description:FormulaAuthoringStrings.Ascending}]},e[rr.WorksheetFuncId.MATCH]={3:[{value:"1",description:FormulaAuthoringStrings.LessThan},{value:"0",description:FormulaAuthoringStrings.ExactMatch},{value:"-1",description:FormulaAuthoringStrings.GreaterThan}]},e[rr.WorksheetFuncId.XMATCH]={3:[{value:"0",description:FormulaAuthoringStrings.ExactMatch},{value:"-1",description:FormulaAuthoringStrings.ExactMatchOrNextSmallerItem},{value:"1",description:FormulaAuthoringStrings.ExactMatchOrNextLargerItem},{value:"2",description:FormulaAuthoringStrings.WildcardCharacterMatch}],4:[{value:"1",description:FormulaAuthoringStrings.SearchFirstToLast},{value:"-1",description:FormulaAuthoringStrings.SearchLastToFirst},{value:"2",description:FormulaAuthoringStrings.BinarySearchAscending},{value:"-2",description:FormulaAuthoringStrings.BinarySearchDescending}]},e[rr.WorksheetFuncId.FINDN]={4:[{value:"0",description:FormulaAuthoringStrings.CaseSensitiveMatch},{value:"1",description:FormulaAuthoringStrings.CaseInsensitiveMatch}],5:[{value:"0",description:FormulaAuthoringStrings.DontMatchToEnd},{value:"1",description:FormulaAuthoringStrings.MatchToEnd}],7:[{value:function(n){return n.trueName},description:FormulaAuthoringStrings.ReturnsTheFirstCharacterPositionOfTheString},{value:function(n){return n.falseName},description:FormulaAuthoringStrings.ReturnsTheLastCharacterPositionOfTheString}]},e[rr.WorksheetFuncId.TEXTBEFORE]={4:[{value:"0",description:FormulaAuthoringStrings.CaseSensitiveMatch},{value:"1",description:FormulaAuthoringStrings.CaseInsensitiveMatch}],5:[{value:"0",description:FormulaAuthoringStrings.DontMatchToEnd},{value:"1",description:FormulaAuthoringStrings.MatchToEnd}]},e[rr.WorksheetFuncId.TEXTAFTER]={4:[{value:"0",description:FormulaAuthoringStrings.CaseSensitiveMatch},{value:"1",description:FormulaAuthoringStrings.CaseInsensitiveMatch}],5:[{value:"0",description:FormulaAuthoringStrings.DontMatchToEnd},{value:"1",description:FormulaAuthoringStrings.MatchToEnd}]},e[rr.WorksheetFuncId.TEXTSPLIT]={4:[{value:function(n){return n.trueName},description:FormulaAuthoringStrings.IgnoreEmptyCells},{value:function(n){return n.falseName},description:FormulaAuthoringStrings.IncludeEmptyCells}],5:[{value:"0",description:FormulaAuthoringStrings.CaseSensitiveMatch},{value:"1",description:FormulaAuthoringStrings.CaseInsensitiveMatch}]},e[rr.WorksheetFuncId.ACCRINT]={6:[{value:"1",description:FormulaAuthoringStrings.Annual},{value:"2",description:FormulaAuthoringStrings.Semianual},{value:"4",description:FormulaAuthoringStrings.Quarterly}],7:[{value:"0",description:FormulaAuthoringStrings.USNASD30360},{value:"1",description:FormulaAuthoringStrings.ActualActual},{value:"2",description:FormulaAuthoringStrings.Actual360},{value:"3",description:FormulaAuthoringStrings.Actual365},{value:"4",description:FormulaAuthoringStrings.European30360}]},e[rr.WorksheetFuncId.ACCRINTM]={5:[{value:"0",description:FormulaAuthoringStrings.USNASD30360},{value:"1",description:FormulaAuthoringStrings.ActualActual},{value:"2",description:FormulaAuthoringStrings.Actual360},{value:"3",description:FormulaAuthoringStrings.Actual365},{value:"4",description:FormulaAuthoringStrings.European30360}]},e[rr.WorksheetFuncId.ADDRESS]={4:[{value:"0",description:FormulaAuthoringStrings.R1C1Style},{value:"1",description:FormulaAuthoringStrings.A1Style}],3:[{value:"1",description:FormulaAuthoringStrings.Absolute},{value:"2",description:FormulaAuthoringStrings.AbsoluteRowRelativeColumn},{value:"3",description:FormulaAuthoringStrings.RelativeRowAbsoluteColumn},{value:"4",description:FormulaAuthoringStrings.Relative}]},e[rr.WorksheetFuncId.AMORDEGRC]={7:[{value:"0",description:FormulaAuthoringStrings.USNASD30360},{value:"1",description:FormulaAuthoringStrings.ActualActual},{value:"2",description:FormulaAuthoringStrings.Actual360},{value:"3",description:FormulaAuthoringStrings.Actual365},{value:"4",description:FormulaAuthoringStrings.European30360}]},e[rr.WorksheetFuncId.AMORLINC]={7:[{value:"0",description:FormulaAuthoringStrings.USNASD30360},{value:"1",description:FormulaAuthoringStrings.ActualActual},{value:"2",description:FormulaAuthoringStrings.Actual360},{value:"3",description:FormulaAuthoringStrings.Actual365},{value:"4",description:FormulaAuthoringStrings.European30360}]},e[rr.WorksheetFuncId.BETA_DIST]={4:[{value:function(n){return n.trueName},description:FormulaAuthoringStrings.cumulativeDistributionFunction},{value:function(n){return n.falseName},description:FormulaAuthoringStrings.ProbabilityDensityFunction}]},e[rr.WorksheetFuncId.BINOMDIST]={4:[{value:function(n){return n.trueName},description:FormulaAuthoringStrings.cumulativeDistributionFunction},{value:function(n){return n.falseName},description:FormulaAuthoringStrings.probabilityMassFunction}]},e[rr.WorksheetFuncId.BINOM_DIST]={4:[{value:function(n){return n.trueName},description:FormulaAuthoringStrings.cumulativeDistributionFunction},{value:function(n){return n.falseName},description:FormulaAuthoringStrings.probabilityMassFunction}]},e[rr.WorksheetFuncId.CHISQ_DIST]={3:[{value:function(n){return n.trueName},description:FormulaAuthoringStrings.cumulativeDistributionFunction},{value:function(n){return n.falseName},description:FormulaAuthoringStrings.ProbabilityDensityFunction}]},e[rr.WorksheetFuncId.COMPLEX]={3:[{value:"i",description:FormulaAuthoringStrings.ISuffixDescriptionForComplexNumber},{value:"j",description:FormulaAuthoringStrings.JSuffixDescriptionForComplexNumber}]},e[rr.WorksheetFuncId.COUPDAYBS]={3:[{value:"1",description:FormulaAuthoringStrings.Annual},{value:"2",description:FormulaAuthoringStrings.Semianual},{value:"4",description:FormulaAuthoringStrings.Quarterly}],4:[{value:"0",description:FormulaAuthoringStrings.USNASD30360},{value:"1",description:FormulaAuthoringStrings.ActualActual},{value:"2",description:FormulaAuthoringStrings.Actual360},{value:"3",description:FormulaAuthoringStrings.Actual365},{value:"4",description:FormulaAuthoringStrings.European30360}]},e[rr.WorksheetFuncId.COUPDAYS]={3:[{value:"1",description:FormulaAuthoringStrings.Annual},{value:"2",description:FormulaAuthoringStrings.Semianual},{value:"4",description:FormulaAuthoringStrings.Quarterly}],4:[{value:"0",description:FormulaAuthoringStrings.USNASD30360},{value:"1",description:FormulaAuthoringStrings.ActualActual},{value:"2",description:FormulaAuthoringStrings.Actual360},{value:"3",description:FormulaAuthoringStrings.Actual365},{value:"4",description:FormulaAuthoringStrings.European30360}]},e[rr.WorksheetFuncId.COUPDAYSNC]={3:[{value:"1",description:FormulaAuthoringStrings.Annual},{value:"2",description:FormulaAuthoringStrings.Semianual},{value:"4",description:FormulaAuthoringStrings.Quarterly}],4:[{value:"0",description:FormulaAuthoringStrings.USNASD30360},{value:"1",description:FormulaAuthoringStrings.ActualActual},{value:"2",description:FormulaAuthoringStrings.Actual360},{value:"3",description:FormulaAuthoringStrings.Actual365},{value:"4",description:FormulaAuthoringStrings.European30360}]},e[rr.WorksheetFuncId.COUPNCD]={3:[{value:"1",description:FormulaAuthoringStrings.Annual},{value:"2",description:FormulaAuthoringStrings.Semianual},{value:"4",description:FormulaAuthoringStrings.Quarterly}],4:[{value:"0",description:FormulaAuthoringStrings.USNASD30360},{value:"1",description:FormulaAuthoringStrings.ActualActual},{value:"2",description:FormulaAuthoringStrings.Actual360},{value:"3",description:FormulaAuthoringStrings.Actual365},{value:"4",description:FormulaAuthoringStrings.European30360}]},e[rr.WorksheetFuncId.COUPNUM]={3:[{value:"1",description:FormulaAuthoringStrings.Annual},{value:"2",description:FormulaAuthoringStrings.Semianual},{value:"4",description:FormulaAuthoringStrings.Quarterly}],4:[{value:"0",description:FormulaAuthoringStrings.USNASD30360},{value:"1",description:FormulaAuthoringStrings.ActualActual},{value:"2",description:FormulaAuthoringStrings.Actual360},{value:"3",description:FormulaAuthoringStrings.Actual365},{value:"4",description:FormulaAuthoringStrings.European30360}]},e[rr.WorksheetFuncId.COUPPCD]={3:[{value:"1",description:FormulaAuthoringStrings.Annual},{value:"2",description:FormulaAuthoringStrings.Semianual},{value:"4",description:FormulaAuthoringStrings.Quarterly}],4:[{value:"0",description:FormulaAuthoringStrings.USNASD30360},{value:"1",description:FormulaAuthoringStrings.ActualActual},{value:"2",description:FormulaAuthoringStrings.Actual360},{value:"3",description:FormulaAuthoringStrings.Actual365},{value:"4",description:FormulaAuthoringStrings.European30360}]},e[rr.WorksheetFuncId.CUMIPMT]={6:[{value:"0",description:FormulaAuthoringStrings.EndOfThePeriod},{value:"1",description:FormulaAuthoringStrings.BeginningOfThePeriod}]},e[rr.WorksheetFuncId.CUMPRINC]={6:[{value:"0",description:FormulaAuthoringStrings.EndOfThePeriod},{value:"1",description:FormulaAuthoringStrings.BeginningOfThePeriod}]},e[rr.WorksheetFuncId.DAYS360]={3:[{value:function(n){return n.falseName},description:FormulaAuthoringStrings.USNASDMethod},{value:function(n){return n.trueName},description:FormulaAuthoringStrings.EuropeanMethod}]},e[rr.WorksheetFuncId.DISC]={5:[{value:"0",description:FormulaAuthoringStrings.USNASD30360},{value:"1",description:FormulaAuthoringStrings.ActualActual},{value:"2",description:FormulaAuthoringStrings.Actual360},{value:"3",description:FormulaAuthoringStrings.Actual365},{value:"4",description:FormulaAuthoringStrings.European30360}]},e[rr.WorksheetFuncId.DURATION]={5:[{value:"1",description:FormulaAuthoringStrings.Annual},{value:"2",description:FormulaAuthoringStrings.Semianual},{value:"4",description:FormulaAuthoringStrings.Quarterly}],6:[{value:"0",description:FormulaAuthoringStrings.USNASD30360},{value:"1",description:FormulaAuthoringStrings.ActualActual},{value:"2",description:FormulaAuthoringStrings.Actual360},{value:"3",description:FormulaAuthoringStrings.Actual365},{value:"4",description:FormulaAuthoringStrings.European30360}]},e[rr.WorksheetFuncId.EXPONDIST]={3:[{value:function(n){return n.trueName},description:FormulaAuthoringStrings.cumulativeDistributionFunction},{value:function(n){return n.falseName},description:FormulaAuthoringStrings.ProbabilityDensityFunction}]},e[rr.WorksheetFuncId.EXPON_DIST]={3:[{value:function(n){return n.trueName},description:FormulaAuthoringStrings.cumulativeDistributionFunction},{value:function(n){return n.falseName},description:FormulaAuthoringStrings.ProbabilityDensityFunction}]},e[rr.WorksheetFuncId.F_DIST]={3:[{value:function(n){return n.trueName},description:FormulaAuthoringStrings.cumulativeDistributionFunction},{value:function(n){return n.falseName},description:FormulaAuthoringStrings.ProbabilityDensityFunction}]},e[rr.WorksheetFuncId.FIXED]={3:[{value:function(n){return n.trueName},description:FormulaAuthoringStrings.PreventCommas},{value:function(n){return n.falseName},description:FormulaAuthoringStrings.DoNotPreventCommas}]},e[rr.WorksheetFuncId.FV]={5:[{value:"0",description:FormulaAuthoringStrings.EndOfThePeriod},{value:"1",description:FormulaAuthoringStrings.BeginningOfThePeriod}]},e[rr.WorksheetFuncId.GAMMADIST]={4:[{value:function(n){return n.trueName},description:FormulaAuthoringStrings.cumulativeDistributionFunction},{value:function(n){return n.falseName},description:FormulaAuthoringStrings.ProbabilityDensityFunction}]},e[rr.WorksheetFuncId.GAMMA_DIST]={4:[{value:function(n){return n.trueName},description:FormulaAuthoringStrings.cumulativeDistributionFunction},{value:function(n){return n.falseName},description:FormulaAuthoringStrings.ProbabilityDensityFunction}]},e[rr.WorksheetFuncId.HYPGEOM_DIST]={5:[{value:function(n){return n.trueName},description:FormulaAuthoringStrings.cumulativeDistributionFunction},{value:function(n){return n.falseName},description:FormulaAuthoringStrings.ProbabilityDensityFunction}]},e[rr.WorksheetFuncId.INDIRECT]={2:[{value:function(n){return n.trueName},description:FormulaAuthoringStrings.A1Style},{value:function(n){return n.falseName},description:FormulaAuthoringStrings.R1C1Style}]},e[rr.WorksheetFuncId.INTRATE]={5:[{value:"0",description:FormulaAuthoringStrings.USNASD30360},{value:"1",description:FormulaAuthoringStrings.ActualActual},{value:"2",description:FormulaAuthoringStrings.Actual360},{value:"3",description:FormulaAuthoringStrings.Actual365},{value:"4",description:FormulaAuthoringStrings.European30360}]},e[rr.WorksheetFuncId.IPMT]={6:[{value:"0",description:FormulaAuthoringStrings.EndOfThePeriod},{value:"1",description:FormulaAuthoringStrings.BeginningOfThePeriod}]},e[rr.WorksheetFuncId.LINEST]={3:[{value:function(n){return n.falseName},description:FormulaAuthoringStrings.bIsSetEqualTo0},{value:function(n){return n.trueName},description:FormulaAuthoringStrings.bIsCalculatedNormally}],4:[{value:function(n){return n.trueName},description:FormulaAuthoringStrings.ReturnAdditionalRegressionStatistics},{value:function(n){return n.falseName},description:FormulaAuthoringStrings.DoNotReturnAdditionalRegressionStatistics}]},e[rr.WorksheetFuncId.LOGEST]={3:[{value:function(n){return n.falseName},description:FormulaAuthoringStrings.bIsSetEqualTo0},{value:function(n){return n.trueName},description:FormulaAuthoringStrings.bIsCalculatedNormally}],4:[{value:function(n){return n.trueName},description:FormulaAuthoringStrings.ReturnAdditionalRegressionStatistics},{value:function(n){return n.falseName},description:FormulaAuthoringStrings.DoNotReturnAdditionalRegressionStatistics}]},e[rr.WorksheetFuncId.LOGNORM_DIST]={4:[{value:function(n){return n.trueName},description:FormulaAuthoringStrings.cumulativeDistributionFunction},{value:function(n){return n.falseName},description:FormulaAuthoringStrings.ProbabilityDensityFunction}]},e[rr.WorksheetFuncId.MDURATION]={5:[{value:"1",description:FormulaAuthoringStrings.Annual},{value:"2",description:FormulaAuthoringStrings.Semianual},{value:"4",description:FormulaAuthoringStrings.Quarterly}],6:[{value:"0",description:FormulaAuthoringStrings.USNASD30360},{value:"1",description:FormulaAuthoringStrings.ActualActual},{value:"2",description:FormulaAuthoringStrings.Actual360},{value:"3",description:FormulaAuthoringStrings.Actual365},{value:"4",description:FormulaAuthoringStrings.European30360}]},e[rr.WorksheetFuncId.NEGBINOM_DIST]={4:[{value:function(n){return n.trueName},description:FormulaAuthoringStrings.cumulativeDistributionFunction},{value:function(n){return n.falseName},description:FormulaAuthoringStrings.probabilityMassFunction}]},e[rr.WorksheetFuncId.NORM_S_DIST]={2:[{value:function(n){return n.trueName},description:FormulaAuthoringStrings.cumulativeDistributionFunction},{value:function(n){return n.falseName},description:FormulaAuthoringStrings.ProbabilityDensityFunction}]},e[rr.WorksheetFuncId.NORMDIST]={4:[{value:function(n){return n.trueName},description:FormulaAuthoringStrings.cumulativeDistributionFunction},{value:function(n){return n.falseName},description:FormulaAuthoringStrings.probabilityMassFunction}]},e[rr.WorksheetFuncId.NORM_DIST]={4:[{value:function(n){return n.trueName},description:FormulaAuthoringStrings.cumulativeDistributionFunction},{value:function(n){return n.falseName},description:FormulaAuthoringStrings.probabilityMassFunction}]},e[rr.WorksheetFuncId.NPER]={5:[{value:"0",description:FormulaAuthoringStrings.EndOfThePeriod},{value:"1",description:FormulaAuthoringStrings.BeginningOfThePeriod}]},e[rr.WorksheetFuncId.ODDFPRICE]={8:[{value:"1",description:FormulaAuthoringStrings.Annual},{value:"2",description:FormulaAuthoringStrings.Semianual},{value:"4",description:FormulaAuthoringStrings.Quarterly}],9:[{value:"0",description:FormulaAuthoringStrings.USNASD30360},{value:"1",description:FormulaAuthoringStrings.ActualActual},{value:"2",description:FormulaAuthoringStrings.Actual360},{value:"3",description:FormulaAuthoringStrings.Actual365},{value:"4",description:FormulaAuthoringStrings.European30360}]},e[rr.WorksheetFuncId.ODDFYIELD]={8:[{value:"1",description:FormulaAuthoringStrings.Annual},{value:"2",description:FormulaAuthoringStrings.Semianual},{value:"4",description:FormulaAuthoringStrings.Quarterly}],9:[{value:"0",description:FormulaAuthoringStrings.USNASD30360},{value:"1",description:FormulaAuthoringStrings.ActualActual},{value:"2",description:FormulaAuthoringStrings.Actual360},{value:"3",description:FormulaAuthoringStrings.Actual365},{value:"4",description:FormulaAuthoringStrings.European30360}]},e[rr.WorksheetFuncId.ODDLPRICE]={7:[{value:"1",description:FormulaAuthoringStrings.Annual},{value:"2",description:FormulaAuthoringStrings.Semianual},{value:"4",description:FormulaAuthoringStrings.Quarterly}],8:[{value:"0",description:FormulaAuthoringStrings.USNASD30360},{value:"1",description:FormulaAuthoringStrings.ActualActual},{value:"2",description:FormulaAuthoringStrings.Actual360},{value:"3",description:FormulaAuthoringStrings.Actual365},{value:"4",description:FormulaAuthoringStrings.European30360}]},e[rr.WorksheetFuncId.ODDLYIELD]={7:[{value:"1",description:FormulaAuthoringStrings.Annual},{value:"2",description:FormulaAuthoringStrings.Semianual},{value:"4",description:FormulaAuthoringStrings.Quarterly}],8:[{value:"0",description:FormulaAuthoringStrings.USNASD30360},{value:"1",description:FormulaAuthoringStrings.ActualActual},{value:"2",description:FormulaAuthoringStrings.Actual360},{value:"3",description:FormulaAuthoringStrings.Actual365},{value:"4",description:FormulaAuthoringStrings.European30360}]},e[rr.WorksheetFuncId.PMT]={5:[{value:"0",description:FormulaAuthoringStrings.EndOfThePeriod},{value:"1",description:FormulaAuthoringStrings.BeginningOfThePeriod}]},e[rr.WorksheetFuncId.POISSON]={3:[{value:function(n){return n.trueName},description:FormulaAuthoringStrings.cumulativeDistributionFunction},{value:function(n){return n.falseName},description:FormulaAuthoringStrings.probabilityMassFunction}]},e[rr.WorksheetFuncId.POISSON_DIST]={3:[{value:function(n){return n.trueName},description:FormulaAuthoringStrings.cumulativeDistributionFunction},{value:function(n){return n.falseName},description:FormulaAuthoringStrings.probabilityMassFunction}]},e[rr.WorksheetFuncId.PPMT]={6:[{value:"0",description:FormulaAuthoringStrings.EndOfThePeriod},{value:"1",description:FormulaAuthoringStrings.BeginningOfThePeriod}]},e[rr.WorksheetFuncId.PRICE]={6:[{value:"1",description:FormulaAuthoringStrings.Annual},{value:"2",description:FormulaAuthoringStrings.Semianual},{value:"4",description:FormulaAuthoringStrings.Quarterly}],7:[{value:"0",description:FormulaAuthoringStrings.USNASD30360},{value:"1",description:FormulaAuthoringStrings.ActualActual},{value:"2",description:FormulaAuthoringStrings.Actual360},{value:"3",description:FormulaAuthoringStrings.Actual365},{value:"4",description:FormulaAuthoringStrings.European30360}]},e[rr.WorksheetFuncId.PRICEDISC]={5:[{value:"0",description:FormulaAuthoringStrings.USNASD30360},{value:"1",description:FormulaAuthoringStrings.ActualActual},{value:"2",description:FormulaAuthoringStrings.Actual360},{value:"3",description:FormulaAuthoringStrings.Actual365},{value:"4",description:FormulaAuthoringStrings.European30360}]},e[rr.WorksheetFuncId.PRICEMAT]={6:[{value:"0",description:FormulaAuthoringStrings.USNASD30360},{value:"1",description:FormulaAuthoringStrings.ActualActual},{value:"2",description:FormulaAuthoringStrings.Actual360},{value:"3",description:FormulaAuthoringStrings.Actual365},{value:"4",description:FormulaAuthoringStrings.European30360}]},e[rr.WorksheetFuncId.QUARTILE]={2:[{value:"0",description:FormulaAuthoringStrings.MinimumValue},{value:"1",description:FormulaAuthoringStrings.FirstQuartile},{value:"2",description:FormulaAuthoringStrings.MedianValue},{value:"3",description:FormulaAuthoringStrings.ThirdQuartile},{value:"4",description:FormulaAuthoringStrings.MaximumValue}]},e[rr.WorksheetFuncId.QUARTILE_INC]={2:[{value:"0",description:FormulaAuthoringStrings.MinimumValue},{value:"1",description:FormulaAuthoringStrings.FirstQuartile},{value:"2",description:FormulaAuthoringStrings.MedianValue},{value:"3",description:FormulaAuthoringStrings.ThirdQuartile},{value:"4",description:FormulaAuthoringStrings.MaximumValue}]},e[rr.WorksheetFuncId.QUARTILE_EXC]={2:[{value:"1",description:FormulaAuthoringStrings.FirstQuartile},{value:"2",description:FormulaAuthoringStrings.MedianValue},{value:"3",description:FormulaAuthoringStrings.ThirdQuartile}]},e[rr.WorksheetFuncId.RATE]={5:[{value:"0",description:FormulaAuthoringStrings.EndOfThePeriod},{value:"1",description:FormulaAuthoringStrings.BeginningOfThePeriod}]},e[rr.WorksheetFuncId.RECEIVED]={5:[{value:"0",description:FormulaAuthoringStrings.USNASD30360},{value:"1",description:FormulaAuthoringStrings.ActualActual},{value:"2",description:FormulaAuthoringStrings.Actual360},{value:"3",description:FormulaAuthoringStrings.Actual365},{value:"4",description:FormulaAuthoringStrings.European30360}]},e[rr.WorksheetFuncId.ROMAN]={2:[{value:"0",description:FormulaAuthoringStrings.Classic},{value:"1",description:FormulaAuthoringStrings.MoreConcise},{value:"2",description:FormulaAuthoringStrings.MoreConcise},{value:"3",description:FormulaAuthoringStrings.MoreConcise},{value:"4",description:FormulaAuthoringStrings.Simplified}]},e[rr.WorksheetFuncId.STOCKHISTORY]={4:[{value:"0",description:FormulaAuthoringStrings.Daily},{value:"1",description:FormulaAuthoringStrings.Weekly},{value:"2",description:FormulaAuthoringStrings.Monthly}],5:[{value:"0",description:FormulaAuthoringStrings.NoHeader},{value:"1",description:FormulaAuthoringStrings.Showheader},{value:"2",description:FormulaAuthoringStrings.ShowInstrumentIdentifierAndHeader}],6:[{value:"0",description:FormulaAuthoringStrings.Date},{value:"1",description:FormulaAuthoringStrings.Close},{value:"2",description:FormulaAuthoringStrings.Open},{value:"3",description:FormulaAuthoringStrings.High},{value:"4",description:FormulaAuthoringStrings.Low},{value:"5",description:FormulaAuthoringStrings.Volume}],7:[{value:"0",description:FormulaAuthoringStrings.Date},{value:"1",description:FormulaAuthoringStrings.Close},{value:"2",description:FormulaAuthoringStrings.Open},{value:"3",description:FormulaAuthoringStrings.High},{value:"4",description:FormulaAuthoringStrings.Low},{value:"5",description:FormulaAuthoringStrings.Volume}],8:[{value:"0",description:FormulaAuthoringStrings.Date},{value:"1",description:FormulaAuthoringStrings.Close},{value:"2",description:FormulaAuthoringStrings.Open},{value:"3",description:FormulaAuthoringStrings.High},{value:"4",description:FormulaAuthoringStrings.Low},{value:"5",description:FormulaAuthoringStrings.Volume}],9:[{value:"0",description:FormulaAuthoringStrings.Date},{value:"1",description:FormulaAuthoringStrings.Close},{value:"2",description:FormulaAuthoringStrings.Open},{value:"3",description:FormulaAuthoringStrings.High},{value:"4",description:FormulaAuthoringStrings.Low},{value:"5",description:FormulaAuthoringStrings.Volume}],10:[{value:"0",description:FormulaAuthoringStrings.Date},{value:"1",description:FormulaAuthoringStrings.Close},{value:"2",description:FormulaAuthoringStrings.Open},{value:"3",description:FormulaAuthoringStrings.High},{value:"4",description:FormulaAuthoringStrings.Low},{value:"5",description:FormulaAuthoringStrings.Volume}],11:[{value:"0",description:FormulaAuthoringStrings.Date},{value:"1",description:FormulaAuthoringStrings.Close},{value:"2",description:FormulaAuthoringStrings.Open},{value:"3",description:FormulaAuthoringStrings.High},{value:"4",description:FormulaAuthoringStrings.Low},{value:"5",description:FormulaAuthoringStrings.Volume}]},e[rr.WorksheetFuncId.TREND]={4:[{value:function(n){return n.falseName},description:FormulaAuthoringStrings.bIsSetEqualTo0},{value:function(n){return n.trueName},description:FormulaAuthoringStrings.bIsCalculatedNormally}]},e[rr.WorksheetFuncId.TTEST]={3:[{value:"1",description:FormulaAuthoringStrings.OneTailedDistribution},{value:"2",description:FormulaAuthoringStrings.TwoTailedDistribution}],4:[{value:"1",description:FormulaAuthoringStrings.Paired},{value:"2",description:FormulaAuthoringStrings.TwoSampleEqualVariance},{value:"3",description:FormulaAuthoringStrings.TwoSampleUnequalVariance}]},e[rr.WorksheetFuncId.T_TEST]={3:[{value:"1",description:FormulaAuthoringStrings.OneTailedDistribution},{value:"2",description:FormulaAuthoringStrings.TwoTailedDistribution}],4:[{value:"1",description:FormulaAuthoringStrings.Paired},{value:"2",description:FormulaAuthoringStrings.TwoSampleEqualVariance},{value:"3",description:FormulaAuthoringStrings.TwoSampleUnequalVariance}]},e[rr.WorksheetFuncId.VDB]={7:[{value:function(n){return n.falseName},description:FormulaAuthoringStrings.SwitchToStraightLineDepreciation},{value:function(n){return n.trueName},description:FormulaAuthoringStrings.DoNotSwitchToStraightLineDepreciation}]},e[rr.WorksheetFuncId.WEEKDAY]={2:[{value:"1",description:FormulaAuthoringStrings.Numbers1Sundaythrough7Saturday},{value:"2",description:FormulaAuthoringStrings.Numbers1Mondaythrough7Sunday},{value:"3",description:FormulaAuthoringStrings.Numbers0Mondaythrough6Sunday},{value:"11",description:FormulaAuthoringStrings.Numbers1Mondaythrough7Sunday},{value:"12",description:FormulaAuthoringStrings.Numbers1Tuesdaythrough7Monday},{value:"13",description:FormulaAuthoringStrings.Numbers1Wednesdaythrough7Tuesday},{value:"14",description:FormulaAuthoringStrings.Numbers1Thursdaythrough7Wednesday},{value:"15",description:FormulaAuthoringStrings.Numbers1Fridaythrough7Thursday},{value:"16",description:FormulaAuthoringStrings.Numbers1Saturdaythrough7Friday},{value:"17",description:FormulaAuthoringStrings.Numbers1Sundaythrough7Saturday}]},e[rr.WorksheetFuncId.WEIBULL]={4:[{value:function(n){return n.trueName},description:FormulaAuthoringStrings.cumulativeDistributionFunction},{value:function(n){return n.falseName},description:FormulaAuthoringStrings.ProbabilityDensityFunction}]},e[rr.WorksheetFuncId.WEIBULL_DIST]={4:[{value:function(n){return n.trueName},description:FormulaAuthoringStrings.cumulativeDistributionFunction},{value:function(n){return n.falseName},description:FormulaAuthoringStrings.ProbabilityDensityFunction}]},e[rr.WorksheetFuncId.YEARFRAC]={3:[{value:"0",description:FormulaAuthoringStrings.USNASD30360},{value:"1",description:FormulaAuthoringStrings.ActualActual},{value:"2",description:FormulaAuthoringStrings.Actual360},{value:"3",description:FormulaAuthoringStrings.Actual365},{value:"4",description:FormulaAuthoringStrings.European30360}]},e[rr.WorksheetFuncId.YIELD]={6:[{value:"1",description:FormulaAuthoringStrings.Annual},{value:"2",description:FormulaAuthoringStrings.Semianual},{value:"4",description:FormulaAuthoringStrings.Quarterly}],7:[{value:"0",description:FormulaAuthoringStrings.USNASD30360},{value:"1",description:FormulaAuthoringStrings.ActualActual},{value:"2",description:FormulaAuthoringStrings.Actual360},{value:"3",description:FormulaAuthoringStrings.Actual365},{value:"4",description:FormulaAuthoringStrings.European30360}]},e[rr.WorksheetFuncId.YIELDDISC]={5:[{value:"0",description:FormulaAuthoringStrings.USNASD30360},{value:"1",description:FormulaAuthoringStrings.ActualActual},{value:"2",description:FormulaAuthoringStrings.Actual360},{value:"3",description:FormulaAuthoringStrings.Actual365},{value:"4",description:FormulaAuthoringStrings.European30360}]},e[rr.WorksheetFuncId.YIELDMAT]={6:[{value:"0",description:FormulaAuthoringStrings.USNASD30360},{value:"1",description:FormulaAuthoringStrings.ActualActual},{value:"2",description:FormulaAuthoringStrings.Actual360},{value:"3",description:FormulaAuthoringStrings.Actual365},{value:"4",description:FormulaAuthoringStrings.European30360}]},e[rr.WorksheetFuncId.GROWTH]={4:[{value:function(n){return n.falseName},description:FormulaAuthoringStrings.bIsSetEqualTo0},{value:function(n){return n.trueName},description:FormulaAuthoringStrings.bIsCalculatedNormally}]},e[rr.WorksheetFuncId.PV]={5:[{value:"0",description:FormulaAuthoringStrings.EndOfThePeriod},{value:"1",description:FormulaAuthoringStrings.BeginningOfThePeriod}]},e[rr.WorksheetFuncId.TDIST]={3:[{value:"1",description:FormulaAuthoringStrings.OneTailedDistribution},{value:"2",description:FormulaAuthoringStrings.TwoTailedDistribution}]},e[rr.WorksheetFuncId.T_DIST]={4:[{value:function(n){return n.trueName},description:FormulaAuthoringStrings.cumulativeDistributionFunction},{value:function(n){return n.falseName},description:FormulaAuthoringStrings.ProbabilityDensityFunction}]},e[rr.WorksheetFuncId.WEEKNUM]={2:[{value:"1",description:FormulaAuthoringStrings.Sunday},{value:"2",description:FormulaAuthoringStrings.Monday},{value:"11",description:FormulaAuthoringStrings.Monday},{value:"12",description:FormulaAuthoringStrings.Tuesday},{value:"13",description:FormulaAuthoringStrings.Wednesday},{value:"14",description:FormulaAuthoringStrings.Thursday},{value:"15",description:FormulaAuthoringStrings.Friday},{value:"16",description:FormulaAuthoringStrings.Saturday},{value:"17",description:FormulaAuthoringStrings.Sunday},{value:"21",description:FormulaAuthoringStrings.Monday}]},e[rr.WorksheetFuncId.NETWORKDAYS_INTL]={3:[{value:"1",description:FormulaAuthoringStrings.SaturdaySunday},{value:"2",description:FormulaAuthoringStrings.SundayMonday},{value:"3",description:FormulaAuthoringStrings.MondayTuesday},{value:"4",description:FormulaAuthoringStrings.TuesdayWednesday},{value:"5",description:FormulaAuthoringStrings.WednesdayThursday},{value:"6",description:FormulaAuthoringStrings.ThursdayFriday},{value:"7",description:FormulaAuthoringStrings.FridaySaturday},{value:"11",description:FormulaAuthoringStrings.SundayOnly},{value:"12",description:FormulaAuthoringStrings.MondayOnly},{value:"13",description:FormulaAuthoringStrings.TuesdayOnly},{value:"14",description:FormulaAuthoringStrings.WednesdayOnly},{value:"15",description:FormulaAuthoringStrings.ThursdayOnly},{value:"16",description:FormulaAuthoringStrings.FridayOnly},{value:"17",description:FormulaAuthoringStrings.SaturdayOnly}]},e[rr.WorksheetFuncId.WORKDAY_INTL]={3:[{value:"1",description:FormulaAuthoringStrings.SaturdaySunday},{value:"2",description:FormulaAuthoringStrings.SundayMonday},{value:"3",description:FormulaAuthoringStrings.MondayTuesday},{value:"4",description:FormulaAuthoringStrings.TuesdayWednesday},{value:"5",description:FormulaAuthoringStrings.WednesdayThursday},{value:"6",description:FormulaAuthoringStrings.ThursdayFriday},{value:"7",description:FormulaAuthoringStrings.FridaySaturday},{value:"11",description:FormulaAuthoringStrings.SundayOnly},{value:"12",description:FormulaAuthoringStrings.MondayOnly},{value:"13",description:FormulaAuthoringStrings.TuesdayOnly},{value:"14",description:FormulaAuthoringStrings.WednesdayOnly},{value:"15",description:FormulaAuthoringStrings.ThursdayOnly},{value:"16",description:FormulaAuthoringStrings.FridayOnly},{value:"17",description:FormulaAuthoringStrings.SaturdayOnly}]},e[rr.WorksheetFuncId.FORECAST_ETS]={5:[{value:"0",description:FormulaAuthoringStrings.MissingValuesTreatedAsZeroes},{value:"1",description:FormulaAuthoringStrings.AutomaticCompletionUsesLinearInterpolation}],6:[{value:"1",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.AVERAGE)}},{value:"2",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.COUNT)}},{value:"3",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.COUNTA)}},{value:"4",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.MAX)}},{value:"5",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.MEDIAN)}},{value:"6",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.MIN)}},{value:"7",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.SUM)}}]},e[rr.WorksheetFuncId.FORECAST_ETS_CONFINT]={6:[{value:"0",description:FormulaAuthoringStrings.MissingValuesTreatedAsZeroes},{value:"1",description:FormulaAuthoringStrings.AutomaticCompletionUsesLinearInterpolation}],7:[{value:"1",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.AVERAGE)}},{value:"2",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.COUNT)}},{value:"3",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.COUNTA)}},{value:"4",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.MAX)}},{value:"5",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.MEDIAN)}},{value:"6",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.MIN)}},{value:"7",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.SUM)}}]},e[rr.WorksheetFuncId.FORECAST_ETS_SEASONALITY]={3:[{value:"0",description:FormulaAuthoringStrings.MissingValuesTreatedAsZeroes},{value:"1",description:FormulaAuthoringStrings.AutomaticCompletionUsesLinearInterpolation}],4:[{value:"1",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.AVERAGE)}},{value:"2",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.COUNT)}},{value:"3",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.COUNTA)}},{value:"4",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.MAX)}},{value:"5",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.MEDIAN)}},{value:"6",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.MIN)}},{value:"7",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.SUM)}}]},e[rr.WorksheetFuncId.FORECAST_ETS_STAT]={4:[{value:"1",description:FormulaAuthoringStrings.AlphaParameterOfETSalgorithm},{value:"2",description:FormulaAuthoringStrings.BetaParameterOfETSalgorithm},{value:"3",description:FormulaAuthoringStrings.GammaParameterOfETSalgorithm},{value:"4",description:FormulaAuthoringStrings.MASEMetric},{value:"5",description:FormulaAuthoringStrings.SMAPEMetric},{value:"6",description:FormulaAuthoringStrings.MAEMetric},{value:"7",description:FormulaAuthoringStrings.RMSEMetric},{value:"8",description:FormulaAuthoringStrings.StepSizeDetected}],5:[{value:"0",description:FormulaAuthoringStrings.MissingValuesTreatedAsZeroes},{value:"1",description:FormulaAuthoringStrings.AutomaticCompletionUsesLinearInterpolation}],6:[{value:"1",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.AVERAGE)}},{value:"2",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.COUNT)}},{value:"3",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.COUNTA)}},{value:"4",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.MAX)}},{value:"5",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.MEDIAN)}},{value:"6",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.MIN)}},{value:"7",description:function(n){return n.getWorksheetFuncName(rr.WorksheetFuncId.SUM)}}]},e[rr.WorksheetFuncId.TEXTJOIN]={2:[{value:function(n){return n.trueName},description:FormulaAuthoringStrings.IgnoreEmptyCells},{value:function(n){return n.falseName},description:FormulaAuthoringStrings.IncludeEmptyCells}]},e[rr.WorksheetFuncId.SORT]={3:[{value:"1",description:FormulaAuthoringStrings.Ascending},{value:"-1",description:FormulaAuthoringStrings.Descending}],4:[{value:function(n){return n.trueName},description:FormulaAuthoringStrings.SortByColumn},{value:function(n){return n.falseName},description:FormulaAuthoringStrings.SortByRow}]},e[rr.WorksheetFuncId.UNIQUE]={2:[{value:function(n){return n.trueName},description:FormulaAuthoringStrings.ReturnUniqueColumns},{value:function(n){return n.falseName},description:FormulaAuthoringStrings.ReturnUniqueRows}],3:[{value:function(n){return n.trueName},description:FormulaAuthoringStrings.ReturnitemsthatAppearExactlyOnce},{value:function(n){return n.falseName},description:FormulaAuthoringStrings.ReturnEveryDistinctItem}]},e[rr.WorksheetFuncId.SORTBY]={3:[{value:"1",description:FormulaAuthoringStrings.Ascending},{value:"-1",description:FormulaAuthoringStrings.Descending}]},e[rr.WorksheetFuncId.RANDARRAY]={5:[{value:function(n){return n.trueName},description:FormulaAuthoringStrings.Integer},{value:function(n){return n.falseName},description:FormulaAuthoringStrings.Decimal}]},e[rr.WorksheetFuncId.VALUETOTEXT]={2:[{value:"0",description:FormulaAuthoringStrings.Concise},{value:"1",description:FormulaAuthoringStrings.Strict}]},e[rr.WorksheetFuncId.ARRAYTOTEXT]={2:[{value:"0",description:FormulaAuthoringStrings.Concise},{value:"1",description:FormulaAuthoringStrings.Strict}]},e[rr.WorksheetFuncId.TOCOL]={2:[{value:"0",description:FormulaAuthoringStrings.KeepAllValues},{value:"1",description:FormulaAuthoringStrings.IgnoreBlanks},{value:"2",description:FormulaAuthoringStrings.IgnoreErrors},{value:"3",description:FormulaAuthoringStrings.IgnoreBlanksAndErrors}],3:[{value:function(n){return n.falseName},description:FormulaAuthoringStrings.ScanByRow},{value:function(n){return n.trueName},description:FormulaAuthoringStrings.ScanByColumn}]},e[rr.WorksheetFuncId.TOROW]={2:[{value:"0",description:FormulaAuthoringStrings.KeepAllValues},{value:"1",description:FormulaAuthoringStrings.IgnoreBlanks},{value:"2",description:FormulaAuthoringStrings.IgnoreErrors},{value:"3",description:FormulaAuthoringStrings.IgnoreBlanksAndErrors}],3:[{value:function(n){return n.falseName},description:FormulaAuthoringStrings.ScanByRow},{value:function(n){return n.trueName},description:FormulaAuthoringStrings.ScanByColumn}]},e[rr.WorksheetFuncId.IMAGE]={3:[{value:"0",description:FormulaAuthoringStrings.FitCell},{value:"1",description:FormulaAuthoringStrings.FillCell},{value:"2",description:FormulaAuthoringStrings.OriginalSize},{value:"3",description:FormulaAuthoringStrings.CustomSize}]},e});_7.functionEnums=jBr});var rke=Y(Vu=>{_();Object.defineProperty(Vu,"__esModule",{value:!0});Vu.forceUnitTypeEnums=Vu.energyUnitTypeEnums=Vu.distanceUnitTypeEnums=Vu.areaUnitTypeEnums=void 0;Vu.getConvertEnum=HBr;Vu.volumeUnitTypeEnums=Vu.timeUnitTypeEnums=Vu.temperatureUnitTypeEnums=Vu.speedUnitTypeEnums=Vu.pressureUnitTypeEnums=Vu.powerUnitTypeEnums=Vu.massUnitTypeEnums=Vu.magnetismUnitTypeEnums=Vu.informationUnitTypeEnums=void 0;var Lm=cu(),GOe=new Lm.ResettableLazy(function(){return[{value:"g",description:FormulaAuthoringStrings.Gram},{value:"sg",description:FormulaAuthoringStrings.Slug},{value:"lbm",description:FormulaAuthoringStrings.PoundM},{value:"u",description:FormulaAuthoringStrings.Atomic},{value:"ozm",description:FormulaAuthoringStrings.Ozm},{value:"grain",description:FormulaAuthoringStrings.Grain},{value:"cwt",description:FormulaAuthoringStrings.CWeight},{value:"uk_cwt",description:FormulaAuthoringStrings.CWeightUk},{value:"stone",description:FormulaAuthoringStrings.Stone},{value:"ton",description:FormulaAuthoringStrings.Ton},{value:"uk_ton",description:FormulaAuthoringStrings.TonUk}]});Vu.massUnitTypeEnums=GOe;var KOe=new Lm.ResettableLazy(function(){return[{value:"m",description:FormulaAuthoringStrings.Meter},{value:"mi",description:FormulaAuthoringStrings.SMile},{value:"Nmi",description:FormulaAuthoringStrings.NMile},{value:"in",description:FormulaAuthoringStrings.Inch},{value:"ft",description:FormulaAuthoringStrings.Ft},{value:"yd",description:FormulaAuthoringStrings.Yd},{value:"ang",description:FormulaAuthoringStrings.Angs},{value:"Pica",description:FormulaAuthoringStrings.Pica},{value:"ell",description:FormulaAuthoringStrings.Ell},{value:"ly",description:FormulaAuthoringStrings.LightYr},{value:"parsec",description:FormulaAuthoringStrings.Parsec},{value:"survey_mi",description:FormulaAuthoringStrings.MileUs}]});Vu.distanceUnitTypeEnums=KOe;var VOe=new Lm.ResettableLazy(function(){return[{value:"yr",description:FormulaAuthoringStrings.Yr},{value:"day",description:FormulaAuthoringStrings.Day},{value:"hr",description:FormulaAuthoringStrings.Hour},{value:"mn",description:FormulaAuthoringStrings.Minute},{value:"sec",description:FormulaAuthoringStrings.Sec}]});Vu.timeUnitTypeEnums=VOe;var WOe=new Lm.ResettableLazy(function(){return[{value:"Pa",description:FormulaAuthoringStrings.Pascal},{value:"atm",description:FormulaAuthoringStrings.Atmos},{value:"mmHg",description:FormulaAuthoringStrings.Merc},{value:"psi",description:FormulaAuthoringStrings.Psi},{value:"Torr",description:FormulaAuthoringStrings.Torr}]});Vu.pressureUnitTypeEnums=WOe;var jOe=new Lm.ResettableLazy(function(){return[{value:"N",description:FormulaAuthoringStrings.Newton},{value:"dyn",description:FormulaAuthoringStrings.Dyne},{value:"lbf",description:FormulaAuthoringStrings.PoundF},{value:"pond",description:FormulaAuthoringStrings.Pond}]});Vu.forceUnitTypeEnums=jOe;var HOe=new Lm.ResettableLazy(function(){return[{value:"J",description:FormulaAuthoringStrings.Joule},{value:"e",description:FormulaAuthoringStrings.Erg},{value:"cal",description:FormulaAuthoringStrings.ItCal},{value:"eV",description:FormulaAuthoringStrings.Volt},{value:"HPh",description:FormulaAuthoringStrings.HorsePwHr},{value:"Wh",description:FormulaAuthoringStrings.WattHr},{value:"flb",description:FormulaAuthoringStrings.FtPound},{value:"BTU",description:FormulaAuthoringStrings.Btu},{value:"c",description:FormulaAuthoringStrings.ThermCal}]});Vu.energyUnitTypeEnums=HOe;var QOe=new Lm.ResettableLazy(function(){return[{value:"HP",description:FormulaAuthoringStrings.HorsePw},{value:"W",description:FormulaAuthoringStrings.Watt},{value:"PS",description:FormulaAuthoringStrings.HorseStr}]});Vu.powerUnitTypeEnums=QOe;var zOe=new Lm.ResettableLazy(function(){return[{value:"T",description:FormulaAuthoringStrings.Tessla},{value:"ga",description:FormulaAuthoringStrings.Gauss}]});Vu.magnetismUnitTypeEnums=zOe;var YOe=new Lm.ResettableLazy(function(){return[{value:"C",description:FormulaAuthoringStrings.Cels},{value:"F",description:FormulaAuthoringStrings.Fahr},{value:"K",description:FormulaAuthoringStrings.Kelv},{value:"Rank",description:FormulaAuthoringStrings.Rankine},{value:"Reau",description:FormulaAuthoringStrings.Reaumur}]});Vu.temperatureUnitTypeEnums=YOe;var JOe=new Lm.ResettableLazy(function(){return[{value:"tsp",description:FormulaAuthoringStrings.Tsp},{value:"tbs",description:FormulaAuthoringStrings.Tbs},{value:"oz",description:FormulaAuthoringStrings.Oz},{value:"cup",description:FormulaAuthoringStrings.Cup},{value:"qt",description:FormulaAuthoringStrings.QuartUs},{value:"gal",description:FormulaAuthoringStrings.Gal},{value:"l",description:FormulaAuthoringStrings.Liter},{value:"uk_pt",description:FormulaAuthoringStrings.PintUk},{value:"us_pt",description:FormulaAuthoringStrings.PintUs},{value:"ang^3",description:FormulaAuthoringStrings.AngsPow3},{value:"barrel",description:FormulaAuthoringStrings.Barrel},{value:"bushel",description:FormulaAuthoringStrings.Bushel},{value:"ft^3",description:FormulaAuthoringStrings.FootPow3},{value:"GRT",description:FormulaAuthoringStrings.RegTon},{value:"in^3",description:FormulaAuthoringStrings.InchPow3},{value:"ly^3",description:FormulaAuthoringStrings.LightYrPow3},{value:"mi^3",description:FormulaAuthoringStrings.SMilePow3},{value:"MTON",description:FormulaAuthoringStrings.MeasTon},{value:"Nmi^3",description:FormulaAuthoringStrings.NMilePow3},{value:"Pica^3",description:FormulaAuthoringStrings.PicaPow3},{value:"tspm",description:FormulaAuthoringStrings.MdnTsp},{value:"uk_gal",description:FormulaAuthoringStrings.GalUk},{value:"yd^3",description:FormulaAuthoringStrings.YdPow3},{value:"uk_qt",description:FormulaAuthoringStrings.QuartUk}]});Vu.volumeUnitTypeEnums=JOe;var XOe=new Lm.ResettableLazy(function(){return[{value:"uk_acre",description:FormulaAuthoringStrings.AcreUk},{value:"us_acre",description:FormulaAuthoringStrings.AcreUs},{value:"ang^2",description:FormulaAuthoringStrings.AngsPow2},{value:"ar",description:FormulaAuthoringStrings.Are},{value:"ft^2",description:FormulaAuthoringStrings.FootPow2},{value:"ha",description:FormulaAuthoringStrings.Hectare},{value:"in^2",description:FormulaAuthoringStrings.InchPow2},{value:"ly^2",description:FormulaAuthoringStrings.LightYrPow2},{value:"m^2",description:FormulaAuthoringStrings.MeterPow2},{value:"Morgen",description:FormulaAuthoringStrings.Morgen},{value:"mi^2",description:FormulaAuthoringStrings.SMilePow2},{value:"Nmi^2",description:FormulaAuthoringStrings.NMilePow2},{value:"Pica^2",description:FormulaAuthoringStrings.PicaPow2},{value:"yd^2",description:FormulaAuthoringStrings.YdPow2}]});Vu.areaUnitTypeEnums=XOe;var ZOe=new Lm.ResettableLazy(function(){return[{value:"bit",description:FormulaAuthoringStrings.Bit},{value:"byte",description:FormulaAuthoringStrings.Byte}]});Vu.informationUnitTypeEnums=ZOe;var $Oe=new Lm.ResettableLazy(function(){return[{value:"admkn",description:FormulaAuthoringStrings.AdmKnot},{value:"kn",description:FormulaAuthoringStrings.Knot},{value:"m/hr",description:FormulaAuthoringStrings.MSlashHr},{value:"m/sec",description:FormulaAuthoringStrings.MSlashSec},{value:"mph",description:FormulaAuthoringStrings.MPH}]});Vu.speedUnitTypeEnums=$Oe;var eke=new Lm.ResettableLazy(function(){return[GOe,KOe,VOe,WOe,jOe,HOe,QOe,zOe,YOe,JOe,XOe,ZOe,$Oe]});function HBr(e,r,n,a){var o,u=eke.getValue().map(function(s){return s.getValue()}),t=(o=[]).concat.apply(o,u);if(e===2)return t;if(e===3){var d=QBr(r,n,a);return d.length>0?d:t}return[]}function QBr(e,r,n){var a,o=e.spans[n[1].label].start,u=e.spans[n[1].label].end,t=(a=r.substring(o,u).replace(/^"|"$/g,""))!==null&&a!==void 0?a:"";if(t==="")return[];for(var d=0,s=eke.getValue();d<s.length;d++){var c=s[d];if(c.getValue().find(function(l){return l.value===t}))return c.getValue()}return[]}});var cae=Y(sF=>{_();Object.defineProperty(sF,"__esModule",{value:!0});sF.autocompleteEnumPluginDependenciesResolved=sF.AutocompleteEnumPluginFactory=void 0;var ox=br(),R7=ds(),zBr=Cd(),lae=tu(),YBr=Di(),JBr=Ll(),XBr=cu(),nke=Jd(),ZBr=Ml(),$Br=eh(),ake=Fu(),eqr=FT(),rqr=qOe(),tke=ft(),nqr=UOe(),tqr=rke(),ix=sg(),ike=function(){function e(){this.factoryName=ake.PluginFactoryName.AutocompleteEnumPlugin}return e.prototype.create=function(){return new aqr},e}();sF.AutocompleteEnumPluginFactory=ike;var aqr=function(){function e(){}return e.prototype.run=function(r){var n,a,o,u,t,d,s,c,l,f,p,m,v,h,S,y,C,E,I;return(0,ox.__generator)(this,function(F){switch(F.label){case 0:return[4,{kind:R7.ComputationRequestKind.ParseActiveCell,formulaText:r.content}];case 1:return n=F.sent(),n.kind!==R7.ComputationRequestKind.ParseActiveCell||!(0,YBr.isSuccess)(n.result)?[2,null]:n.result.value.kind!==JBr.EditKind.Formula?[2,null]:(a=n.result.value.formula,o=new rqr.AutoCompleteEnumVisitor(a,r.caretPosition),(0,ZBr.reduceBottomUp)(o,a),o.stringStartPosition===void 0||o.stringEndPosition===void 0||o.functionHead===void 0||o.argIndex===void 0||o.functionArgs===void 0||o.isInsideArrayNode?[2,null]:(u=o.argIndex+1,t=o.stringStartPosition,d=o.stringEndPosition,s=o.functionHead,c=r.caretPosition===d?r.content.substring(t,d).toUpperCase():"",l=void 0,s.id===ix.WorksheetFuncId.CONVERT?l=(0,tqr.getConvertEnum)(u,a,r.content,o.functionArgs):(f=nqr.functionEnums.getValue(),l=this.getEnumInfoByArg(u,f,s.id)),(0,tke.isNone)(l)?[2,null]:[4,{kind:R7.ComputationRequestKind.GetConfig}]));case 2:return p=F.sent(),p.kind!==R7.ComputationRequestKind.GetConfig?(this.logFailure("failed to get config"),[2,null]):(m=p.config.localeInfo,v=this.getLocalizedEnumInfo(l,m),v.length===0?(this.logFailure("failed to get enum info for values/descriptions"),[2,null]):(h=this.getFilteredEnumInfo(c,s.id,v),S=h.prefixedEnumInfo,y=h.notPrefixedEnumInfo,C=this.shouldAddDoubleQuotes(s.id),E=this.generateCompletionItems(S,t,d,!0,C),I=this.generateCompletionItems(y,t,d,!1,C),[2,{items:(0,ox.__spreadArray)((0,ox.__spreadArray)([],E,!0),I,!0)}]))}})},e.prototype.generateCompletionItems=function(r,n,a,o,u){var t=r.map(function(d){var s=u?'"'.concat(d.value,'"'):d.value;return{label:s,kind:$Br.CompletionItemKind.Enum,detail:d.description,textEdit:{newText:s,range:{start:{line:0,character:n},end:{line:0,character:a}}},isPrefixed:o}});return t},e.prototype.getFilteredEnumInfo=function(r,n,a){var o=[],u=[],t=r.replace(/^"|"$/g,"");if(this.shouldAddDoubleQuotes(n)&&r.endsWith('"')&&r.startsWith('"'))o=a.filter(function(s){return s.value.toUpperCase()===t});else{var d=(0,eqr.filterSuggestionsAccordingToPrefix)(t,a,function(s){return s.value});o=d.prefixedSuggestions,u=d.notPrefixedSuggestions}return o.length===0&&u.length===0&&u.push.apply(u,a),{prefixedEnumInfo:o,notPrefixedEnumInfo:u}},e.prototype.getEnumInfoByArg=function(r,n,a){var o=n[a];if(!(0,tke.isNone)(o))return o[r]},e.prototype.getLocalizedEnumInfo=function(r,n){var a=r.map(function(t){var d={value:typeof t.value=="function"?t.value(n):t.value,description:typeof t.description=="function"?t.description(n):t.description};return d}),o=a.length,u=a.filter(function(t){var d=t.value,s=t.description;return d!==void 0&&s!==void 0&&d!==""&&d!=="undefined"});return r.length!==o&&this.logFailure("failed to get enum info for some values"),u},e.prototype.shouldAddDoubleQuotes=function(r){return r===ix.WorksheetFuncId.COMPLEX||r===ix.WorksheetFuncId.INFO||r===ix.WorksheetFuncId.CONVERT||r===ix.WorksheetFuncId.CELL},e.prototype.logFailure=function(r){lae.ulsLogger.ULS.traceTag(508350686,lae.LogCategory.msoulscat_ES_EWAJS,lae.TraceLevel.Warning,"AutocompleteEnumPlugin encountered a failure with msg ".concat(r))},e}();(0,zBr.registerPluginFactory)(new ike);var iqr=(0,XBr.asyncLazy)(function(){return(0,ox.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,ox.__generator)(this,function(r){switch(r.label){case 0:return[4,nke.autoCompletePluginsThread.getValue()];case 1:return e=r.sent(),[4,e.loadPluginScript("formula-authoring-strings",!0)];case 2:return r.sent(),[4,e.createAndAttachPlugin(ake.PluginFactoryName.AutocompleteEnumPlugin)];case 3:return r.sent(),[4,nke.schedulerWithRecalcServiceAttached.getValue()];case 4:return r.sent(),[2]}})})});sF.autocompleteEnumPluginDependenciesResolved=iqr});var oke=Y(T7=>{_();Object.defineProperty(T7,"__esModule",{value:!0});T7.AutocompleteLetVisitor=void 0;var oqr=br(),uqr=Qu(),sqr=ER(),lqr=function(e){(0,oqr.__extends)(r,e);function r(n,a,o,u){var t=e.call(this,o,u)||this;return t.autoCompleteForCellRefEnabled=n,t.formulaString=a,t}return r.prototype.nameNode=function(n,a,o){return this.updateCaretNodeText(o,n.asWhole),e.prototype.nameNode.call(this,n,a,o)},r.prototype.cellRefNode=function(n,a,o){var u=this.parsedFormulaTree.spans[o];if(this.autoCompleteForCellRefEnabled&&n.kind===uqr.CellRefKind.Single&&u){var t=this.formulaString.substring(u.start,u.end);this.updateCaretNodeText(o,t)}return e.prototype.cellRefNode.call(this,n,a,o)},r.prototype.updateCaretNodeText=function(n,a){var o,u=(o=this.parsedFormulaTree.spans[n])===null||o===void 0?void 0:o.end;u!==void 0&&this.caretPosition===u&&a.length>0&&(this.caretNodeText=a)},r}(sqr.ExtractLetVisitor);T7.AutocompleteLetVisitor=lqr});var dae=Y(lF=>{_();Object.defineProperty(lF,"__esModule",{value:!0});lF.autocompleteLetPluginDependenciesResolved=lF.AutocompleteLetPluginFactory=void 0;var ux=br(),uke=ds(),cqr=Cd(),dqr=Di(),fqr=Ll(),pqr=cu(),ske=Jd(),mqr=Ml(),lke=eh(),gqr=oke(),vqr=FT(),hqr=Ql(),cke=Fu(),dke=function(){function e(){this.factoryName=cke.PluginFactoryName.AutocompleteLetPlugin}return e.prototype.create=function(){return new Sqr},e}();lF.AutocompleteLetPluginFactory=dke;var Sqr=function(){function e(){this.autoCompleteForCellRefEnabled=(0,hqr.isChangeGateEnabled)("OfficeVSO:6212698_fixFunctionAutoCompleteForCellRef")}return e.prototype.run=function(r){var n,a,o,u,t,d,s,c,l,f,p,m,v,h;return(0,ux.__generator)(this,function(S){switch(S.label){case 0:return[4,{kind:uke.ComputationRequestKind.ParseActiveCell,formulaText:r.content}];case 1:return n=S.sent(),n.kind!==uke.ComputationRequestKind.ParseActiveCell||!(0,dqr.isSuccess)(n.result)?[2,null]:n.result.value.kind!==fqr.EditKind.Formula?[2,null]:(a=n.result.value.formula,o=r.caretPosition,u=new gqr.AutocompleteLetVisitor(this.autoCompleteForCellRefEnabled,r.content,a,o),(0,mqr.reduceBottomUp)(u,a),t=u.references.reverse(),d=Array.from(new Set(t)),s=u.caretNodeText,s===void 0||u.isInsideArrayNode?[2,null]:(c=o,l=c-s.length,f=(0,vqr.filterSuggestionsAccordingToPrefix)(s,d),p=f.prefixedSuggestions,m=f.notPrefixedSuggestions,v=this.stringsToCompletionItems(p,l,c,!0),h=this.stringsToCompletionItems(m,l,c,!1),[2,{items:(0,ux.__spreadArray)((0,ux.__spreadArray)([],v,!0),h,!0)}]))}})},e.prototype.stringsToCompletionItems=function(r,n,a,o){return r.map(function(u){return{label:u,kind:lke.CompletionItemKind.LetVariable,type:lke.SuggestionKind.Simple,textEdit:{newText:u,range:{start:{line:0,character:n},end:{line:0,character:a}}},isPrefixed:o}})},e}();(0,cqr.registerPluginFactory)(new dke);var yqr=(0,pqr.asyncLazy)(function(){return(0,ux.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,ux.__generator)(this,function(r){switch(r.label){case 0:return[4,ske.autoCompletePluginsThread.getValue()];case 1:return e=r.sent(),[4,e.createAndAttachPlugin(cke.PluginFactoryName.AutocompleteLetPlugin)];case 2:return r.sent(),[4,ske.schedulerWithRecalcServiceAttached.getValue()];case 3:return r.sent(),[2]}})})});lF.autocompleteLetPluginDependenciesResolved=yqr});var mke=Y(b7=>{_();Object.defineProperty(b7,"__esModule",{value:!0});b7.AutocompleteRichValueVisitor=void 0;var Cqr=br(),sh=ft(),fae=tu(),Bm=Qu(),_qr=Ql(),Rqr=Jc(),fke=DD(),Tqr=ER(),bqr=function(e){(0,Cqr.__extends)(r,e);function r(n,a,o,u,t){var d=e.call(this,n,a)||this;return d.formulaText=o,d.definedNames=u,d.activeCell=t,d.dotNotationPath="",d.richValueItemPrefix="",d.dotNotationIndex=0,d.shouldAddEmptySuggestion=!1,d.onlySendNestedDotNotationPathEnabled=(0,Rqr.isTypedChangeGateEnabled)("OfficeVSO:6476056_OnlySendNestedDotNotationPath"),d.passLogFunctionToGetRangeFromCellRef=(0,_qr.isChangeGateEnabled)("OfficeVSO:7251290_PassLogFunctionToGetRangeFromCellRef"),d}return r.prototype.nameNode=function(n,a,o){var u,t,d=(u=this.parsedFormulaTree.spans[o])===null||u===void 0?void 0:u.end;if(d===this.caretPosition&&n.kind===Bm.NamePartKind.IdentNamePart&&this.trySetDefinedName(n)&&(this.dotNotationIndex=d,this.childFieldRefLabel=o),n.kind===Bm.NamePartKind.FieldRefNamePart){var s=(t=this.parsedFormulaTree.spans[n.lhs.label])===null||t===void 0?void 0:t.end;if((0,sh.isDefined)(s)&&(this.caretPosition===d||this.isCaretAfterDotBeforeStartOfFieldRef(s,n.rhs)&&n.lhs.kind!==Bm.NamePartKind.FieldRefNamePart)){var c=!1;n.lhs.kind===Bm.NamePartKind.CellRefNamePart?(this.setCellRef(n.lhs.ref,a),c=!0):n.lhs.kind===Bm.NamePartKind.IdentNamePart&&this.trySetDefinedName(n.lhs)&&(c=!0),c&&(this.dotNotationIndex=s,n.rhs.field.kind===Bm.NodeKind.Ident&&(this.caretPosition===d?this.richValueItemPrefix=n.rhs.field.whole:this.fieldRefChainEndIndex=d))}}return e.prototype.nameNode.call(this,n,a,o)},r.prototype.cellRefNode=function(n,a,o){var u,t=(u=this.parsedFormulaTree.spans[o])===null||u===void 0?void 0:u.end;return t!==void 0&&this.caretPosition===t&&(this.setCellRef(n,a),this.dotNotationIndex=t,this.childFieldRefLabel=o,this.shouldAddEmptySuggestion=!0),e.prototype.cellRefNode.call(this,n,a,o)},r.prototype.fieldRefNode=function(n,a,o,u){var t,d,s=(t=this.parsedFormulaTree.spans[u])===null||t===void 0?void 0:t.end,c=(d=this.parsedFormulaTree.spans[n.label])===null||d===void 0?void 0:d.end;return s===void 0||c===void 0?e.prototype.fieldRefNode.call(this,n,a,o,u):(this.isCaretAtEndOfFieldRefNode(s,a)?(this.initCellRefAtFieldsRefsChainStartAndAccumulateDotNotationPath(n,u),this.dotNotationIndex=c,this.richValueItemPrefix=pke(a)):this.isCaretAfterDotBeforeStartOfFieldRef(c,a)?(this.initCellRefAtFieldsRefsChainStartAndAccumulateDotNotationPath(n,u),this.dotNotationIndex=c,this.fieldRefChainEndIndex=s):n.label===this.childFieldRefLabel&&(this.fieldRefChainEndIndex=s,this.childFieldRefLabel=u),e.prototype.fieldRefNode.call(this,n,a,o,u))},r.prototype.structRefNode=function(n,a,o){var u,t=e.prototype.structRefNode.call(this,n,a,o),d=(u=this.parsedFormulaTree.spans[o])===null||u===void 0?void 0:u.end;if(this.caretPosition===d&&(0,sh.isDefined)(n)&&a.isClosed&&t.kind===Bm.NodeKind.StructRef){var s=this.definedNames.some(function(c){return c.type===0&&(0,sh.isDefined)(c.name)&&c.name.toLowerCase()===n.whole.toLowerCase()});s&&(this.setNamedNodeRef(t),this.dotNotationIndex=d)}return t},r.prototype.initCellRefAtFieldsRefsChainStartAndAccumulateDotNotationPath=function(n,a){for(var o=n;o.kind===Bm.NodeKind.FieldRef;)this.dotNotationPath=Pqr(o.rhs)+"."+this.dotNotationPath,o=o.lhs;o.kind===Bm.NodeKind.CellRef&&this.setCellRef(o.ref,o.qualifier),o.kind===Bm.NodeKind.StructRef&&this.setNamedNodeRef(o),o.kind===Bm.NodeKind.Name&&this.trySetDefinedName(o.parts),this.childFieldRefLabel=a},r.prototype.getRefString=function(n){var a,o,u=(a=this.parsedFormulaTree.spans[n])===null||a===void 0?void 0:a.start,t=(o=this.parsedFormulaTree.spans[n])===null||o===void 0?void 0:o.end;return(0,sh.isDefined)(u)&&(0,sh.isDefined)(t)&&u>=0&&t<this.formulaText.length?this.formulaText.substring(u,t):""},r.prototype.setCellRef=function(n,a){var o=this;(n.kind===Bm.CellRefKind.Single||n.kind===Bm.CellRefKind.Range)&&(this.cellRef=(0,fke.getRangeFromCellRef)(n,this.activeCell,this.passLogFunctionToGetRangeFromCellRef?pae:void 0)),(0,sh.isDefined)(a)&&(this.sheetName=(0,fke.getSheetNameFromQualifier)(a,pae)),this.trySetDotNotationPathOrigin(function(){return o.getRefString(n.label)})},r.prototype.setNamedNodeRef=function(n){var a=this;this.namedRangeNode=n,this.trySetDotNotationPathOrigin(function(){return a.getRefString(n.label)})},r.prototype.isCaretAfterDotBeforeStartOfFieldRef=function(n,a){var o;if(!(0,sh.isDefined)(a))return!1;var u=(o=this.parsedFormulaTree.spans[a.field.label])===null||o===void 0?void 0:o.start;return u!==void 0&&this.caretPosition>n&&(this.caretPosition<u||!a.isBracketed&&this.caretPosition===u)},r.prototype.isCaretAtEndOfFieldRefNode=function(n,a){var o;if(this.caretPosition===n)return!0;var u=(o=this.parsedFormulaTree.spans[a.field.label])===null||o===void 0?void 0:o.end;return!!((0,sh.isDefined)(u)&&this.caretPosition===u)},r.prototype.trySetDefinedName=function(n){if(n.canDenoteNamedObject){var a=this.definedNames.find(function(o){var u;return((u=o.name)===null||u===void 0?void 0:u.toLowerCase())===n.asWhole.toLowerCase()});if((0,sh.isDefined)(a))return this.setDefinedName(a),!0}return!1},r.prototype.setDefinedName=function(n){var a,o=n.namedRange;if((0,sh.isDefined)(o)){var u=(a=n.sheetName)!==null&&a!==void 0?a:o.sheetName;(0,sh.isDefined)(u)&&(this.sheetName=u),this.cellRef={firstRow:o.top-1,firstColumn:o.left-1,lastRow:o.bottom-1,lastColumn:o.right-1},this.trySetDotNotationPathOrigin(function(){return n.name})}},r.prototype.trySetDotNotationPathOrigin=function(n){if(this.onlySendNestedDotNotationPathEnabled){if(this.dotNotationPath.length>0){var a=n();(0,sh.isDefined)(a)?this.dotNotationPath=a+"."+this.dotNotationPath:pae("tryUpdateDotNotationPath with undefined name")}}else this.dotNotationPath=n()+(this.dotNotationPath.length>0?"."+this.dotNotationPath:"")},r}(Tqr.CaretInsideArrayNodeIdentityVisitor);b7.AutocompleteRichValueVisitor=bqr;function Pqr(e){return"["+pke(e)+"]"}function pke(e){return e.field.kind!==Bm.NodeKind.Ident?"":e.field.whole}function pae(e){fae.ulsLogger.ULS.traceTag(523257827,fae.LogCategory.msoulscat_ES_EWAJS,fae.TraceLevel.Warning,"AutocompleteRichValueVisitor failed with msg: ".concat(e))}});var vke=Y(cF=>{_();Object.defineProperty(cF,"__esModule",{value:!0});cF.parseFieldRef=cF.isUnbracketedField=void 0;var gke=N0(),Eqr=gke.parseFieldRefModule.isUnbracketedField;cF.isUnbracketedField=Eqr;var Nqr=gke.parseFieldRefModule.parseFieldRef;cF.parseFieldRef=Nqr});var mae=Y(dF=>{_();Object.defineProperty(dF,"__esModule",{value:!0});dF.autocompleteRichValuePluginDependenciesResolved=dF.AutocompleteRichValuePluginFactory=void 0;var QT=br(),qm=ds(),Aqr=Cd(),hke=Jd(),Oqr=cu(),yke=eh(),kqr=mke(),P7=Di(),Fqr=Ll(),Iqr=Ml(),Mqr=zu(),R_=ft(),wqr=Ai(),Ske=V5(),Dqr=FT(),xqr=g2(),Cke=Fu(),Lqr=vke(),Bqr=Ql(),_ke=function(){function e(){this.factoryName=Cke.PluginFactoryName.AutocompleteRichValuePlugin}return e.prototype.create=function(){return new qqr},e}();dF.AutocompleteRichValuePluginFactory=_ke;var qqr=function(){function e(){this.dontAlwaysAddBracketsEnabled=(0,Bqr.isChangeGateEnabled)("OfficeVSO:7765276_RichValueAutoCompleteDontAlwayAddBrackets")}return e.prototype.run=function(r){var n,a,o,u,t,d,s,c,l,f,p,m,v,h,S,y,C,E,I,F,w,B,k,x,G,H,L;return(0,QT.__generator)(this,function(D){switch(D.label){case 0:return(0,R_.isNone)(r.content)||(0,R_.isNone)(r.caretPosition)?(T_("missing request arguments"),[2,null]):[4,{kind:qm.ComputationRequestKind.ParseActiveCell,formulaText:r.content}];case 1:return n=D.sent(),n.kind!==qm.ComputationRequestKind.ParseActiveCell||!(0,P7.isSuccess)(n.result)?[2,null]:n.result.value.kind!==Fqr.EditKind.Formula?[2,null]:(a=n.result.value.formula,[4,{kind:qm.ComputationRequestKind.GetDefinedNamesInfo}]);case 2:return o=D.sent(),o.kind!==qm.ComputationRequestKind.GetDefinedNamesInfo?(T_("failed to get named objects info"),[2,null]):[4,{kind:qm.ComputationRequestKind.GetActiveCell}];case 3:return u=D.sent(),u.kind!==qm.ComputationRequestKind.GetActiveCell?(T_("failed to get active cell"),[2,null]):(t=u.activeCell,d=new kqr.AutocompleteRichValueVisitor(a,r.caretPosition,r.content,o.definedNamesInfo,t.range),(0,Iqr.reduceBottomUp)(d,a),d.isInsideArrayNode?[2,null]:(c=void 0,(0,R_.isDefined)(d.cellRef)?(s=d.cellRef,c=t.sheet.index,[3,6]):[3,4]));case 4:return(0,R_.isDefined)(d.namedRangeNode)?(l={originGridCell:(0,P7.success)(t.range),originSheet:(0,P7.success)(t.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!0},[4,{kind:qm.ComputationRequestKind.ResolveReferences,nodes:[d.namedRangeNode],locals:l}]):[3,6];case 5:f=D.sent(),f.kind===qm.ComputationRequestKind.ResolveReferences&&(p=f.resolverResults[0],p.kind===xqr.ResolvedKind.ResolvedStructRef&&(0,P7.isSuccess)(p.resolution)&&p.resolution.value!==void 0&&(m=p.resolution.value.range,s={firstRow:m.row,firstColumn:m.col,lastRow:m.row+m.rows-1,lastColumn:m.col+m.cols-1},c=p.resolution.value.sheet.index)),D.label=6;case 6:return(0,R_.isDefined)(s)?(v=d.dotNotationPath,(0,R_.isNone)(v)?(T_("failed to parse cellRef"),[2,null]):(h="",(0,R_.isDefined)(d.sheetName)?(h=d.sheetName,[3,9]):[3,7])):[2,null];case 7:return[4,{kind:qm.ComputationRequestKind.GetSheetNames}];case 8:if(S=D.sent(),S.kind!==qm.ComputationRequestKind.GetSheetNames)return T_("failed to get sheet names"),[2,null];if(!(0,Mqr.isDocumentLocEqual)(t.sheet.document,S.document))return T_("sheet names document is different than that of active cell"),[2,null];if(!(0,R_.isDefined)(c))return T_("sheet index is undefined"),[2,null];h=S.sheets[S.idToIndex[c]].sheetName,D.label=9;case 9:return y=(0,QT.__assign)((0,QT.__assign)({},s),{sheetName:h,namedObjectName:""}),[4,{kind:qm.ComputationRequestKind.GetRichValueFieldListContext,rangeToQuery:y,dotNotationPath:v,singleColumn:!1,findRange:!1}];case 10:return C=D.sent(),C.kind!==qm.ComputationRequestKind.GetRichValueFieldListContext?(T_("failed to get field list context data"),[2,null]):(0,R_.isNone)(C.result)||C.result.length===0?[2,null]:(C.result.length>1&&T_("fieldListContextRequest results length greater than 1"),E=(0,Dqr.filterSuggestionsAccordingToPrefix)(d.richValueItemPrefix,C.result[0].FieldInfoDataList,function(U){return U.Name},!0),I=E.prefixedSuggestions,F=E.notPrefixedSuggestions,[4,{kind:qm.ComputationRequestKind.GetConfig}]);case 11:return w=D.sent(),B=this.resultsToCompletionItems(I,!0,d.dotNotationIndex,(G=d.fieldRefChainEndIndex)!==null&&G!==void 0?G:r.caretPosition,w,!!d.namedRangeNode),k=this.resultsToCompletionItems(F,!1,d.dotNotationIndex,(H=d.fieldRefChainEndIndex)!==null&&H!==void 0?H:r.caretPosition,w,!!d.namedRangeNode),x=(0,QT.__spreadArray)((0,QT.__spreadArray)([],B,!0),k,!0),d.shouldAddEmptySuggestion&&(x=(0,QT.__spreadArray)([Uqr(d.dotNotationIndex,(L=d.fieldRefChainEndIndex)!==null&&L!==void 0?L:r.caretPosition)],x,!0)),[2,{items:x}]}})},e.getTextToCommit=function(r,n,a,o){var u=r.Name;if(u=u.replace("'","''"),u=u.replace("[","'["),u=u.replace("]","']"),r.RefersToDotFunction)return".".concat(u);if(a){if(o)return".[".concat(u,"]");var t=n.kind===qm.ComputationRequestKind.GetConfig?n.config.localeInfo:void 0;return t&&!(0,Lqr.isUnbracketedField)(t,u)?".[".concat(u,"]"):".".concat(u)}return".[".concat(u,"]")},e.prototype.resultsToCompletionItems=function(r,n,a,o,u,t){var d=this;return r.map(function(s){return{label:s.Name,kind:yke.CompletionItemKind.RichEntity,detail:"",textEdit:{newText:e.getTextToCommit(s,u,d.dontAlwaysAddBracketsEnabled,t),range:{start:{line:0,character:a},end:{line:0,character:o}}},isPrefixed:n}})},e}();function Uqr(e,r){return{label:"",kind:yke.CompletionItemKind.RichEntityEmptyCellRef,detail:"",textEdit:{newText:"",range:{start:{line:0,character:e},end:{line:0,character:r}}},isPrefixed:!0}}function T_(e){wqr.ulsLogger.ULS.traceTag(529056660,Ske.LogCategory.msoulscat_ES_EWAJS,Ske.TraceLevel.Warning,"AutocompleteRichValuePlugin encountered a failure with msg ".concat(e))}(0,Aqr.registerPluginFactory)(new _ke);var Gqr=(0,Oqr.asyncLazy)(function(){return(0,QT.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,QT.__generator)(this,function(r){switch(r.label){case 0:return[4,hke.dynamicPluginLoaderCreated.getValue()];case 1:return e=r.sent(),[4,e.createAndAttachPlugin(Cke.PluginFactoryName.AutocompleteRichValuePlugin)];case 2:return r.sent(),[4,hke.schedulerWithRecalcServiceAttached.getValue()];case 3:return r.sent(),[2]}})})});dF.autocompleteRichValuePluginDependenciesResolved=Gqr});var Sae=Y(fF=>{_();Object.defineProperty(fF,"__esModule",{value:!0});fF.autocompleteNamedObjectsPluginDependenciesResolved=fF.AutocompleteNamedObjectsPluginFactory=void 0;var sx=br(),E7=ds(),Kqr=Cd(),gae=tu(),Vqr=Di(),Wqr=Ll(),jqr=cu(),Rke=Jd(),vae=eh(),Hqr=uae(),Qqr=Ml(),zqr=FT(),hae=ft(),Yqr=Ql(),Tke=Fu(),bke=function(){function e(){this.factoryName=Tke.PluginFactoryName.AutocompleteNamedObjectsPlugin}return e.prototype.create=function(){return new Jqr},e}();fF.AutocompleteNamedObjectsPluginFactory=bke;var Jqr=function(){function e(){this.autoCompleteForCellRefEnabled=(0,Yqr.isChangeGateEnabled)("OfficeVSO:6212698_fixFunctionAutoCompleteForCellRef")}return e.prototype.run=function(r){var n,a,o,u,t,d,s,c,l,f,p,m,v,h;return(0,sx.__generator)(this,function(S){switch(S.label){case 0:return[4,{kind:E7.ComputationRequestKind.ParseActiveCell,formulaText:r.content}];case 1:return n=S.sent(),n.kind!==E7.ComputationRequestKind.ParseActiveCell||!(0,Vqr.isSuccess)(n.result)?[2,null]:n.result.value.kind!==Wqr.EditKind.Formula?[2,null]:(a=n.result.value.formula,[4,{kind:E7.ComputationRequestKind.GetDefinedNamesInfo}]);case 2:return o=S.sent(),o.kind!==E7.ComputationRequestKind.GetDefinedNamesInfo?(this.logFailure("failed to get named objects info"),[2,null]):(u=o.definedNamesInfo,t=new Hqr.AutocompleteBaseVisitor(a,r.caretPosition,r.content,this.autoCompleteForCellRefEnabled),(0,Qqr.reduceBottomUp)(t,a),d=t.autocompleteString,s=t.stringStartPosition,c=t.stringEndPosition,l=t.isInsideArrayNode,!(0,hae.isDefined)(d)||!(0,hae.isDefined)(c)||!(0,hae.isDefined)(s)||l?[2,null]:(f=(0,zqr.filterSuggestionsAccordingToPrefix)(d,u,function(y){return y.name}),p=f.prefixedSuggestions,m=f.notPrefixedSuggestions,v=this.namesToCompletionItems(p,s,c,!0),h=this.namesToCompletionItems(m,s,c,!1),[2,{items:(0,sx.__spreadArray)((0,sx.__spreadArray)([],v,!0),h,!0)}]))}})},e.prototype.namesToCompletionItems=function(r,n,a,o){return r.filter(function(u){return u.type!==-1}).map(function(u){return{label:u.name,kind:u.type===1?vae.CompletionItemKind.NamedRange:vae.CompletionItemKind.Table,type:vae.SuggestionKind.Simple,textEdit:{newText:u.name,range:{start:{line:0,character:n},end:{line:0,character:a}}},detail:u.tooltip,isPrefixed:o}})},e.prototype.logFailure=function(r){gae.ulsLogger.ULS.traceTag(528562134,gae.LogCategory.msoulscat_ES_EWAJS,gae.TraceLevel.Warning,"AutocompleteNamedObjectPlugin encountered a failure with msg ".concat(r))},e}();(0,Kqr.registerPluginFactory)(new bke);var Xqr=(0,jqr.asyncLazy)(function(){return(0,sx.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,sx.__generator)(this,function(r){switch(r.label){case 0:return[4,Rke.autoCompletePluginsThread.getValue()];case 1:return e=r.sent(),[4,e.createAndAttachPlugin(Tke.PluginFactoryName.AutocompleteNamedObjectsPlugin)];case 2:return r.sent(),[4,Rke.schedulerWithRecalcServiceAttached.getValue()];case 3:return r.sent(),[2]}})})});fF.autocompleteNamedObjectsPluginDependenciesResolved=Xqr});var Pke=Y(N7=>{_();Object.defineProperty(N7,"__esModule",{value:!0});N7.AutocompleteTableHeadersVisitor=void 0;var Zqr=br(),lx=ft(),qE=Qu(),$qr=ER(),eUr=function(e){(0,Zqr.__extends)(r,e);function r(n,a,o){var u=e.call(this,n,a)||this;return u.tableNames=o,u.isWithinThisRowOp=!1,u.isStructRefClosed=!1,u.isNodeClosed=!1,u.findContainingNode=function(t){var d=u.parsedFormulaTree.spans[t.label];if(u.isCaretInNode(t))switch(t.kind){case qE.StructRefKind.SpecialRef:case qE.StructRefKind.ColumnRef:case qE.StructRefKind.BadRef:u.isTighterThanCurrent(d)&&(u.containingNode=d,u.isNodeClosed=u.getIsNodeClosed(t));break;case qE.StructRefKind.ThisRowOpRef:var s=t,c=s.ref;if(u.isCaretInBeginningOfNode(d))break;u.isWithinThisRowOp=!0,(0,lx.isDefined)(c)?u.findContainingNode(c):u.isTighterThanCurrent(d)&&(u.containingNode=d,u.isNodeClosed=u.isStructRefClosed);break;case qE.StructRefKind.CommaOpRef:if(u.isCaretInBeginningOfNode(d))break;var l=t;l.refs.map(u.findContainingNode);break;case qE.StructRefKind.RangeOpRef:if(u.isCaretInBeginningOfNode(d))break;var f=t;u.findContainingNode(f.lhs),u.findContainingNode(f.rhs);break;case qE.StructRefKind.MissingRef:u.containingNode=void 0;break}},u.isTighterThanCurrent=function(t){return(0,lx.isDefined)(t)&&((0,lx.isNone)(u.containingNode)||t.end<u.containingNode.end||t.start>u.containingNode.start)},u}return r.prototype.structRefNode=function(n,a,o){var u=this;if(this.isCaretInNode(a)){n&&this.tableNames.forEach(function(d){d.toLocaleLowerCase()===n.whole.toLocaleLowerCase()&&(u.tableName=d)});var t=this.parsedFormulaTree.spans[a.label];this.isNodeClosed=this.isStructRefClosed=a.isClosed,this.containingNode=t,a.innerRef!==void 0&&this.findContainingNode(a.innerRef)}return e.prototype.structRefNode.call(this,n,a,o)},r.prototype.getIsNodeClosed=function(n){return n.isBracketed?n.isClosed:this.isStructRefClosed},r.prototype.isCaretInNode=function(n){var a=this.parsedFormulaTree.spans[n.label];return(0,lx.isDefined)(a)&&this.caretPosition<=a.end&&this.caretPosition>=a.start},r.prototype.isCaretInBeginningOfNode=function(n){return(0,lx.isDefined)(n)&&this.caretPosition===n.start},r}($qr.CaretInsideArrayNodeIdentityVisitor);N7.AutocompleteTableHeadersVisitor=eUr});var Eke=Y(O7=>{_();Object.defineProperty(O7,"__esModule",{value:!0});O7.AutocompleteTableHeadersVisitorOld=void 0;var rUr=br(),A7=ft(),UE=Qu(),nUr=ER(),tUr=function(e){(0,rUr.__extends)(r,e);function r(n,a,o){var u=e.call(this,n,a)||this;return u.tableNames=o,u.isWithinThisRowOp=!1,u.isNodeClosed=!1,u.findContainingNode=function(t){var d=u.parsedFormulaTree.spans[t.label];if(u.isCaretInNode(t))switch(t.kind){case UE.StructRefKind.SpecialRef:case UE.StructRefKind.ColumnRef:case UE.StructRefKind.BadRef:u.isTighterThanCurrent(d)&&(u.containingNode=d);break;case UE.StructRefKind.ThisRowOpRef:var s=t,c=s.ref;u.isWithinThisRowOp=!0,(0,A7.isDefined)(c)?u.findContainingNode(c):u.isTighterThanCurrent(d)&&(u.containingNode=d);break;case UE.StructRefKind.CommaOpRef:var l=t;l.refs.map(u.findContainingNode);break;case UE.StructRefKind.RangeOpRef:var f=t;u.findContainingNode(f.lhs),u.findContainingNode(f.rhs);break;case UE.StructRefKind.MissingRef:u.containingNode=void 0;break}},u.isTighterThanCurrent=function(t){return(0,A7.isDefined)(t)&&((0,A7.isNone)(u.containingNode)||t.end<u.containingNode.end||t.start>u.containingNode.start)},u}return r.prototype.structRefNode=function(n,a,o){var u=this;return this.isCaretInNode(a)&&(n&&this.tableNames.forEach(function(t){t.toLocaleLowerCase()===n.whole.toLocaleLowerCase()&&(u.tableName=t)}),a.innerRef===void 0?this.containingNode=this.parsedFormulaTree.spans[a.label]:this.findContainingNode(a.innerRef)),e.prototype.structRefNode.call(this,n,a,o)},r.prototype.isCaretInNode=function(n){var a=this.parsedFormulaTree.spans[n.label];return(0,A7.isDefined)(a)&&this.caretPosition<=a.end&&this.caretPosition>=a.start},r}(nUr.CaretInsideArrayNodeIdentityVisitor);O7.AutocompleteTableHeadersVisitorOld=tUr});var _ae=Y(mF=>{_();Object.defineProperty(mF,"__esModule",{value:!0});mF.autocompleteTableHeadersPluginDependenciesResolved=mF.AutocompleteTableHeadersPluginFactory=void 0;var KE=br(),Um=ds(),aUr=Cd(),pF=tu(),yae=Di(),iUr=Ll(),Ake=cu(),Cae=Jd(),GE=eh(),oUr=Ml(),Ty=ft(),uUr=Pke(),Nke=FT(),by=Qu(),Oke=Fu(),kke=Jc(),sUr=Ql(),lUr=Eke(),Fke=function(){function e(){this.factoryName=Oke.PluginFactoryName.AutocompleteTableHeadersPlugin}return e.prototype.create=function(){return new cUr},e}();mF.AutocompleteTableHeadersPluginFactory=Fke;var cUr=function(){function e(){var r=this;this.getTableHeadersFromServerEnabled=(0,kke.isTypedChangeGateEnabled)("OfficeVSO:7396249_getTableHeadersFromServer"),this.fixAutocompleteTableHeadersBugEnabled=(0,sUr.isChangeGateEnabled)("OfficeVSO:7899833_fixAutocompleteTableHeadersBug"),this.getCompletionItems=function(n,a,o,u,t,d){var s,c=a.charAt(0)==="@";if(c||t){var l=c?o+1:o,f=c?a.substring(1):a;return r.generateHeadersCompletionItems(f,n,l,u,!0)}var p=[],m=a==="";if(m){var v=(s=d[by.SpecialRefId.ThisRow])===null||s===void 0?void 0:s.substring(1);r.fixAutocompleteTableHeadersBugEnabled?p.push(r.generateThisRowOpCompletionItem(o,o,v)):p.push(r.generateThisRowOpCompletionItem(o,u,v))}return p.push.apply(p,r.generateSpecialCaseCompletionItems(o,u,a,d)),p.push.apply(p,r.generateHeadersCompletionItems(a,n,o,u)),p},this.getHeaderTextEditCallback=function(n){return function(a){var o=pUr(a);return n&&r.hasSpecialChars(o)?"[".concat(o,"]"):o}},this.hasSpecialChars=function(n){try{var a=new RegExp("(?=\\P{L})(?=\\P{M})(?=\\P{N})","u");return a.test(n)}catch(o){return r.logFailure("hasSpecialChars method, error: ".concat(o,".")),!0}}}return e.prototype.run=function(r){var n,a,o,u,t,d,s,c,l,f,p,m,v,h,S,y,C,E,I,F,w,B,k;return(0,KE.__generator)(this,function(x){switch(x.label){case 0:return n=r.content,a=r.caretPosition,(0,Ty.isNone)(n)||(0,Ty.isNone)(a)?[2,null]:[4,{kind:Um.ComputationRequestKind.ParseActiveCell,formulaText:n}];case 1:return o=x.sent(),o.kind!==Um.ComputationRequestKind.ParseActiveCell||!(0,yae.isSuccess)(o.result)?[2,null]:o.result.value.kind!==iUr.EditKind.Formula?[2,null]:(u=o.result.value.formula,[4,{kind:Um.ComputationRequestKind.GetDefinedNamesInfo}]);case 2:return t=x.sent(),t.kind!==Um.ComputationRequestKind.GetDefinedNamesInfo?(this.logFailure("failed to get named objects info"),[2,null]):(d=t.definedNamesInfo.filter(function(G){return G.type===0}).map(function(G){return G.name}).filter(Ty.isDefined),d.length===0?[2,null]:(this.fixAutocompleteTableHeadersBugEnabled?s=new uUr.AutocompleteTableHeadersVisitor(u,a,d):s=new lUr.AutocompleteTableHeadersVisitorOld(u,a,d),(0,oUr.reduceBottomUp)(s,u),c=s.tableName,l=s.containingNode,f=s.isInsideArrayNode,p=s.isNodeClosed,(0,Ty.isNone)(l)||f?[2,null]:(0,Ty.isNone)(c)?[4,{kind:Um.ComputationRequestKind.GetActiveCell}]:[3,5]));case 3:return m=x.sent(),m.kind!==Um.ComputationRequestKind.GetActiveCell?(this.logFailure("Couldn't get active cell"),[2,null]):[4,{kind:Um.ComputationRequestKind.GetContainingTable,cell:m.activeCell}];case 4:if(v=x.sent(),v.kind!==Um.ComputationRequestKind.GetContainingTable||!(0,yae.isSuccess)(v.result))return this.logFailure("GetContainingTable request failed. result kind = ".concat(JSON.stringify(v))),[2,null];if(c=(k=v.result.value)===null||k===void 0?void 0:k.name,(0,Ty.isNone)(c))return[2,null];x.label=5;case 5:return h=l.start,S=l.end,y=n.charAt(S-1),(y==="]"||y===")")&&S--,n.charAt(h)==="["&&h++,a!==S&&(!this.fixAutocompleteTableHeadersBugEnabled||!this.caretIsInTheBeginning(n,h,a))?[2,null]:[4,{kind:Um.ComputationRequestKind.GetAvailableTableHeaders,tableName:c}];case 6:return C=x.sent(),C.kind===Um.ComputationRequestKind.GetAvailableTableHeaders&&(0,yae.isSuccess)(C.result)&&!(0,Ty.isNone)(C.result.value)&&(!this.getTableHeadersFromServerEnabled||!C.result.value.isPartial)?(E=C.result.value.cols,[3,9]):[3,7];case 7:return this.getTableHeadersFromServerEnabled?(pF.ulsLogger.ULS.traceTag(509682331,pF.LogCategory.msoulscat_ES_EWAJS,pF.TraceLevel.Info,"AutocompleteTableHeadersPlugin getting col headers from server"),[4,{kind:Um.ComputationRequestKind.GetFullTableHeadersFromServer,tableName:c}]):[3,9];case 8:if(I=x.sent(),I.kind===Um.ComputationRequestKind.GetFullTableHeadersFromServer&&(0,Ty.isDefined)(I.result))E=I.result;else return this.logFailure("Failed to get header names from server"),[2,null];x.label=9;case 9:return!(0,Ty.isDefined)(E)||E.length===0?[2,null]:(F="",this.fixAutocompleteTableHeadersBugEnabled&&this.caretIsInTheBeginning(n,h,a)?S=p?S:h:F=n.substring(h,S),[4,{kind:Um.ComputationRequestKind.GetConfig}]);case 10:return w=x.sent(),w.kind!==Um.ComputationRequestKind.GetConfig?(this.logFailure("getConfig request failed"),[2,null]):(B=this.getCompletionItems(E,F,h,S,s.isWithinThisRowOp,w.config.localeInfo.specialRefNames),[2,{items:B}])}})},e.prototype.caretIsInTheBeginning=function(r,n,a){var o=r.substring(n,a).trim();return o.length===0},e.prototype.generateCompletionItems=function(r,n,a,o,u,t){var d=[];return r.forEach(function(s){var c=typeof s=="string",l=c?s:s.name,f=c?void 0:s.description;d.push({label:l,kind:u,type:GE.SuggestionKind.Simple,textEdit:{newText:(0,Ty.isDefined)(t)?t(l):l,range:{start:{line:0,character:n},end:{line:0,character:a}}},detail:f,isPrefixed:o})}),d},e.prototype.generateHeadersCompletionItems=function(r,n,a,o,u){u===void 0&&(u=!1);var t=(0,Nke.filterSuggestionsAccordingToPrefix)(r,n),d=t.prefixedSuggestions,s=t.notPrefixedSuggestions,c=this.getHeaderTextEditCallback(u);return(0,KE.__spreadArray)((0,KE.__spreadArray)([],this.generateCompletionItems(d,a,o,!0,GE.CompletionItemKind.TableHeader,c),!0),this.generateCompletionItems(s,a,o,!1,GE.CompletionItemKind.TableHeader,c),!0)},e.prototype.generateSpecialCaseCompletionItems=function(r,n,a,o){var u=[by.SpecialRefId.All,by.SpecialRefId.Data,by.SpecialRefId.Headers,by.SpecialRefId.Totals].map(function(c){var l;return{name:(l=o[c])!==null&&l!==void 0?l:"",description:fUr.getValue()[c]}}),t=(0,Nke.filterSuggestionsAccordingToPrefix)(a,u,function(c){return c.name}),d=t.prefixedSuggestions,s=t.notPrefixedSuggestions;return(0,KE.__spreadArray)((0,KE.__spreadArray)([],this.generateCompletionItems(d,r,n,!0,GE.CompletionItemKind.TableSpecialStructRef),!0),this.generateCompletionItems(s,r,n,!1,GE.CompletionItemKind.TableSpecialStructRef),!0)},e.prototype.generateThisRowOpCompletionItem=function(r,n,a){return{label:"@ - ".concat(a),kind:GE.CompletionItemKind.TableSpecialStructRef,type:GE.SuggestionKind.Simple,textEdit:{newText:"@",range:{start:{line:0,character:r},end:{line:0,character:n}}},detail:FormulaAuthoringStrings.ThisRowOpDescription,shouldRequestAutocompleteOnCommit:!0}},e.prototype.logFailure=function(r){pF.ulsLogger.ULS.traceTag(526508764,pF.LogCategory.msoulscat_ES_EWAJS,pF.TraceLevel.Warning,"AutocompleteTableHeadersPlugin encountered a failure with msg ".concat(r))},e}();(0,aUr.registerPluginFactory)(new Fke);var dUr=(0,Ake.asyncLazy)(function(){return(0,KE.__awaiter)(void 0,void 0,void 0,function(){var e,r;return(0,KE.__generator)(this,function(n){switch(n.label){case 0:return(0,kke.isTypedChangeGateEnabled)("OfficeVSO:7396249_getTableHeadersFromServer")?[4,Cae.dynamicPluginLoaderCreated.getValue()]:[3,2];case 1:return r=n.sent(),[3,4];case 2:return[4,Cae.autoCompletePluginsThread.getValue()];case 3:r=n.sent(),n.label=4;case 4:return e=r,[4,e.createAndAttachPlugin(Oke.PluginFactoryName.AutocompleteTableHeadersPlugin)];case 5:return n.sent(),[4,Cae.schedulerWithRecalcServiceAttached.getValue()];case 6:return n.sent(),[2]}})})});mF.autocompleteTableHeadersPluginDependenciesResolved=dUr;var fUr=new Ake.ResettableLazy(function(){var e;return e={},e[by.SpecialRefId.All]=FormulaAuthoringStrings.SpecialRefAllDescription,e[by.SpecialRefId.Data]=FormulaAuthoringStrings.SpecialRefDataDescription,e[by.SpecialRefId.Headers]=FormulaAuthoringStrings.SpecialRefHeadersDescription,e[by.SpecialRefId.Totals]=FormulaAuthoringStrings.SpecialRefTotalsDescription,e[by.SpecialRefId.ThisRow]=FormulaAuthoringStrings.ThisRowOpDescription,e}),pUr=function(r){return r.replace(/\[|\]|\'|\@|\#/g,"'$&")}});var Ike=Y(k7=>{_();Object.defineProperty(k7,"__esModule",{value:!0});k7.ParenthesesCouplingVisitor=void 0;var mUr=br(),gUr=Qu(),vUr=Ml(),hUr=function(e){(0,mUr.__extends)(r,e);function r(n,a){var o=e.call(this)||this;return o.formula=n,o.caretPosition=a,o.parenthesesSpan=void 0,o.checkLeft=!1,o.checkRight=!1,o.areParenthesesLeftOfCaret=!1,o}return r.prototype.appNode=function(n,a,o,u){return n.kind!==gUr.NodeKind.Operator&&this.matchFormula(n,o,u),e.prototype.appNode.call(this,n,a,o,u)},r.prototype.parenNode=function(n,a,o){var u=this.formula.spans[o];return a&&u&&this.matchParentheses(u.start,u.end-1),e.prototype.parenNode.call(this,n,a,o)},r.prototype.letNode=function(n,a,o,u,t,d){return this.matchFormula(n,t,d),e.prototype.letNode.call(this,n,a,o,u,t,d)},r.prototype.lambdaNode=function(n,a,o,u,t,d){return this.matchFormula(n,t,d),e.prototype.lambdaNode.call(this,n,a,o,u,t,d)},r.prototype.matchFormula=function(n,a,o){var u=this.formula.spans[o],t=this.formula.spans[n.label];a&&u&&t&&this.matchParentheses(t.end,u.end-1)},r.prototype.matchParentheses=function(n,a){n===this.caretPosition&&(this.checkRight=!0),a===this.caretPosition-1&&(this.checkLeft=!0),this.checkRight&&this.shouldUpdateLocation(n,a,this.caretPosition+1)?(this.parenthesesSpan={start:n,end:a},this.areParenthesesLeftOfCaret=!1):this.shouldUpdateLocation(n,a,this.caretPosition)?(this.parenthesesSpan={start:n,end:a},this.areParenthesesLeftOfCaret=!1):this.checkLeft&&this.shouldUpdateLocation(n,a,this.caretPosition-1)&&(this.parenthesesSpan={start:n,end:a},this.areParenthesesLeftOfCaret=!0)},r.prototype.shouldUpdateLocation=function(n,a,o){return n<o&&o<=a&&(this.parenthesesSpan===void 0||this.areParenthesesLeftOfCaret&&n<=this.parenthesesSpan.start||n>this.parenthesesSpan.start)},r}(vUr.IdentityVisitor);k7.ParenthesesCouplingVisitor=hUr});var Tae=Y(gF=>{_();Object.defineProperty(gF,"__esModule",{value:!0});gF.parenthesesCouplingPluginDependenciesResolved=gF.ParenthesesCouplingPluginFactory=void 0;var Rae=br(),SUr=ft(),yUr=cu(),CUr=Di(),F7=Fu(),_Ur=Ml(),RUr=Ll(),TUr=Cd(),Mke=Jd(),wke=ds(),bUr=Ike(),Dke=function(){function e(){this.factoryName=F7.PluginFactoryName.ParenthesesCouplingPlugin}return e.prototype.create=function(){return new PUr},e}();gF.ParenthesesCouplingPluginFactory=Dke;var PUr=function(){function e(){}return e.prototype.run=function(r){var n,a,o;return(0,Rae.__generator)(this,function(u){switch(u.label){case 0:return r.selectionLength!=null&&r.selectionLength>0?[2,null]:[4,{kind:wke.ComputationRequestKind.ParseActiveCell,formulaText:r.content}];case 1:return n=u.sent(),n.kind!==wke.ComputationRequestKind.ParseActiveCell||!(0,CUr.isSuccess)(n.result)?[2,null]:n.result.value.kind!==RUr.EditKind.Formula?[2,null]:(a=n.result.value.formula,o=new bUr.ParenthesesCouplingVisitor(a,r.caretPosition),(0,_Ur.reduceBottomUp)(o,a),(0,SUr.isDefined)(o.parenthesesSpan)?[2,this.getParenthesesHighlights(o.parenthesesSpan)]:[2,{formulaHighlights:void 0}])}})},e.prototype.getParenthesesHighlights=function(r){var n=r.start,a=r.end,o={kind:F7.HighlightKind.Parentheses,span:{start:n,end:n+1}},u={kind:F7.HighlightKind.Parentheses,span:{start:a,end:a+1}},t=[u,o];return{formulaHighlights:t}},e}();(0,TUr.registerPluginFactory)(new Dke);var EUr=(0,yUr.asyncLazy)(function(){return(0,Rae.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,Rae.__generator)(this,function(r){switch(r.label){case 0:return[4,Mke.dynamicPluginLoaderCreated.getValue()];case 1:return e=r.sent(),[4,e.createAndAttachSyncPlugin(F7.PluginFactoryName.ParenthesesCouplingPlugin)];case 2:return r.sent(),[4,Mke.schedulerWithRecalcServiceAttached.getValue()];case 3:return r.sent(),[2]}})})});gF.parenthesesCouplingPluginDependenciesResolved=EUr});var qke=Y(I7=>{_();Object.defineProperty(I7,"__esModule",{value:!0});I7.ColoredReferencesVisitor=void 0;var xke=br(),lh=ft(),bae=tu(),Lke=sg(),Pae=Fu(),VE=Qu(),NUr=Ml(),cx=DD(),Bke=zu(),AUr=x8(),Eae=Vk(),OUr=function(e){(0,xke.__extends)(r,e);function r(n,a,o,u,t,d){var s=e.call(this)||this;return s.activeCell=n,s.parsedFormulaTree=a,s.formulaString=o,s.sheetNames=u,s.definedNameInfoList=t,s.failureCallback=d,s.structRefNodes=[],s.formulaHighlights=[],s.activeCellSheetName=void 0,s._namedObjectsMap=void 0,s}return r.prototype.structRefNode=function(n,a,o){var u=e.prototype.structRefNode.call(this,n,a,o);return this.structRefNodes.push(u),u},r.prototype.nameNode=function(n,a,o){var u=e.prototype.nameNode.call(this,n,a,o);if(!this.isRefInActiveSheet(a))return u;if(u.parts.kind===VE.NamePartKind.FieldRefNamePart)return this.createAndAppendFieldRefHighlight(u.parts.lhs),u;if(!(0,lh.isDefined)(this.namedObjectsMap))return u;var t=this.namedObjectsMap.get(n.asWhole.toLocaleLowerCase()),d=t!==void 0&&t.type!==-1;return d&&this.createAndAppendNamedRefHighlight(o,t),u},r.prototype.cellRefNode=function(n,a,o){var u=e.prototype.cellRefNode.call(this,n,a,o);if(!(0,cx.isValidCellRef)(n)||!this.isRefInActiveSheet(a))return u;var t=this.parsedFormulaTree.spans[o];if(t){var d=this.createRangeInfoFromCellRef(n),s=this.formulaSpanToHighlightingSpan(t,VE.NodeKind.CellRef);this.formulaHighlights.push(Nae(Pae.HighlightKind.CellRef,s,d))}return u},Object.defineProperty(r.prototype,"namedObjectsMap",{get:function(){return(0,lh.isDefined)(this._namedObjectsMap)?this._namedObjectsMap:((0,lh.isDefined)(this.definedNameInfoList)&&(this._namedObjectsMap=(0,cx.createNameToDefinedNameInfoMapping)(this.definedNameInfoList)),this._namedObjectsMap)},enumerable:!1,configurable:!0}),r.prototype.createAndAppendNamedRefHighlight=function(n,a){var o=this.parsedFormulaTree.spans[n];if(!(!(0,lh.isDefined)(o)||!(0,lh.isDefined)(this.sheetNames))){var u=a.sheetName;if(!(0,lh.isDefined)(u)){Aae("createAndAppendNamedRef - sheetName undefined, DefinedNameInfo type: ".concat(a.type));return}var t=(0,cx.getSheetIndexFromSheetName)(u,this.sheetNames);if(!(0,lh.isDefined)(t)){Aae("createAndAppendNamedRef: sheetIndex undefined, DefinedNameInfo type: ".concat(a.type));return}if((0,Bke.isSheetIndexEqual)(t,this.activeCell.sheet)){var d=(0,Eae.getRangeFromDefinedName)(a);d!==void 0&&this.formulaHighlights.push(Nae(Pae.HighlightKind.NamedRange,o,{range:d,sharedRange:(0,Eae.toSharedRange)(d)}))}}},r.prototype.createAndAppendFieldRefHighlight=function(n){switch(n.kind){case VE.NamePartKind.CellRefNamePart:{this.createAndAppendCellRefPartHighlight(n);break}case VE.NamePartKind.IdentNamePart:{if(!(0,lh.isDefined)(this.namedObjectsMap))return;var a=this.namedObjectsMap.get(n.asWhole.toLocaleLowerCase()),o=a!==void 0&&a.type!==-1;o&&this.createAndAppendNamedRefHighlight(n.label,a);break}case VE.NamePartKind.FieldRefNamePart:this.createAndAppendFieldRefHighlight(n.lhs)}},r.prototype.createAndAppendCellRefPartHighlight=function(n){var a=this.parsedFormulaTree.spans[n.label];if((0,lh.isDefined)(a)){var o=this.createRangeInfoFromCellRef(n.ref),u=this.formulaSpanToHighlightingSpan(a,VE.NodeKind.CellRef),t=Nae(Pae.HighlightKind.CellRef,u,o);this.formulaHighlights.push(t)}},r.prototype.formulaSpanToHighlightingSpan=function(n,a){var o=(0,xke.__assign)({},n);return a===VE.NodeKind.CellRef&&kUr(n,this.formulaString)&&(o.end+=1),o},r.prototype.createRangeInfoFromCellRef=function(n){var a=(0,cx.getRangeFromCellRef)(n,this.activeCell.range,Aae);return{sharedRange:a===void 0?void 0:(0,Eae.toSharedRange)(a),range:a,positionKindInfo:(0,AUr.getPositionKindInfoFromCellRef)(n)}},r.prototype.isRefInActiveSheet=function(n){var a;if(!(0,lh.isDefined)(n))return!0;if(!(0,lh.isDefined)(this.sheetNames))return!1;var o=(0,cx.getSheetIndexFromQualifier)(n,this.sheetNames,this.failureCallback);return(0,lh.isDefined)(o)?(0,Bke.isSheetIndexEqual)(o,this.activeCell.sheet):((a=this.failureCallback)===null||a===void 0||a.call(this,"CellRefHighlightCreator.isRefInActiveSheet: sheetIndex is undefined"),!1)},r}(NUr.IdentityVisitor);I7.ColoredReferencesVisitor=OUr;function Nae(e,r,n){return{kind:e,span:r,rangeInfo:n}}function kUr(e,r){return r.length>e.end&&r.charAt(e.end)===Lke.operatorStrings[Lke.OperatorId.Pound]}function Aae(e){bae.ulsLogger.ULS.traceTag(520935561,bae.LogCategory.msoulscat_ES_EWAJS,bae.TraceLevel.Warning,"ColoredReferencesVisitor encountered a failure with msg ".concat(e))}});var Iae=Y(vF=>{_();Object.defineProperty(vF,"__esModule",{value:!0});vF.coloredReferencesPluginDependenciesResolved=vF.ColoredReferencesPluginFactory=void 0;var kae=br(),Oae=tu(),FUr=cu(),M7=Di(),IUr=Ml(),MUr=Ll(),wUr=Cd(),Uke=Jd(),Py=ds(),DUr=qke(),xUr=ft(),LUr=x8(),Gke=zu(),Fae=Fu(),BUr=Vk(),Kke=function(){function e(){this.factoryName=Fae.PluginFactoryName.ColoredReferencesPlugin}return e.prototype.create=function(){return new qUr},e}();vF.ColoredReferencesPluginFactory=Kke;var qUr=function(){function e(){}return e.prototype.run=function(r){var n,a,o,u,t,d,s,c,l,f,p,m,v;return(0,kae.__generator)(this,function(h){switch(h.label){case 0:return n=r.content,[4,{kind:Py.ComputationRequestKind.ParseActiveCell,formulaText:n}];case 1:return a=h.sent(),a.kind!==Py.ComputationRequestKind.ParseActiveCell||!(0,M7.isSuccess)(a.result)?[2,null]:a.result.value.kind!==MUr.EditKind.Formula?[2,null]:[4,{kind:Py.ComputationRequestKind.GetActiveCell}];case 2:return o=h.sent(),o.kind!==Py.ComputationRequestKind.GetActiveCell?(WE("failed to get active cell"),[2,null]):(u=void 0,[4,{kind:Py.ComputationRequestKind.GetSheetNames}]);case 3:return t=h.sent(),t.kind===Py.ComputationRequestKind.GetSheetNames?u=t:WE("failed to get sheet names"),d=void 0,[4,{kind:Py.ComputationRequestKind.GetDefinedNamesInfo}];case 4:return s=h.sent(),s.kind===Py.ComputationRequestKind.GetDefinedNamesInfo?d=s.definedNamesInfo:WE("failed to get defined names"),c=o.activeCell,l=a.result.value.formula,f=new DUr.ColoredReferencesVisitor(c,l,n,u,d),(0,IUr.reduceBottomUp)(f,l),p=f.formulaHighlights,f.structRefNodes.length===0?[3,6]:(m={originGridCell:(0,M7.success)(c.range),originSheet:(0,M7.success)(c.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!0},[4,{kind:Py.ComputationRequestKind.ResolveReferences,nodes:f.structRefNodes,locals:m}]);case 5:v=h.sent(),v.kind===Py.ComputationRequestKind.ResolveReferences?p=p.concat(GUr(l,c,v.resolverResults)):WE("failed to resolve node references"),h.label=6;case 6:return[2,{formulaHighlights:p}]}})},e}();(0,wUr.registerPluginFactory)(new Kke);var UUr=(0,FUr.asyncLazy)(function(){return(0,kae.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,kae.__generator)(this,function(r){switch(r.label){case 0:return[4,Uke.dynamicPluginLoaderCreated.getValue()];case 1:return e=r.sent(),[4,e.createAndAttachSyncPlugin(Fae.PluginFactoryName.ColoredReferencesPlugin)];case 2:return r.sent(),[4,Uke.schedulerWithRecalcServiceAttached.getValue()];case 3:return r.sent(),[2]}})})});vF.coloredReferencesPluginDependenciesResolved=UUr;function GUr(e,r,n){var a=[];return n.forEach(function(o){var u,t=e.spans[o.node.label];if(!t){WE("failed to resolve StructRef, formulaSpan null");return}if(!(0,M7.isSuccess)(o.resolution)){WE("failed to resolve StructRef, reason: ".concat((u=o.resolution)===null||u===void 0?void 0:u.reason.kind));return}if(o.resolution.value===void 0){WE("failed to resolve StructRef, resolution value undefined");return}var d=o.resolution.value,s=(0,Gke.sheetRangeToSheetIndex)(d.sheet);if(!(!(0,xUr.isDefined)(s)||!(0,Gke.isSheetIndexEqual)(s,r.sheet))){var c=(0,LUr.gridRangeToRange)(d.range),l={kind:Fae.HighlightKind.StructRef,span:t,rangeInfo:{sharedRange:(0,BUr.toSharedRange)(c),range:c}};a.push(l)}}),a}function WE(e){Oae.ulsLogger.ULS.traceTag(525133647,Oae.LogCategory.msoulscat_ES_EWAJS,Oae.TraceLevel.Warning,"ColoredReferencesPlugin encountered a failure with msg ".concat(e))}});var Wke=Y(Gm=>{_();Object.defineProperty(Gm,"__esModule",{value:!0});Gm.parserPerformanceMeasurementsAttach=Gm.chatGPTPluginAttach=Gm.autocompleteWrapperPluginAttach=Gm.autocompleteRangeSuggestionPluginAttach=Gm.autocompletePluginDependenciesResolved=Gm.autocompleteBinaryModelExperimentPluginAttach=void 0;var Km=br(),jE=cu(),hF=Fu(),Vke=Jd(),SF=(0,jE.asyncLazy)(function(){return(0,Km.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,Km.__generator)(this,function(r){switch(r.label){case 0:return[4,Vke.workerThreadSpread.getValue()];case 1:return e=r.sent(),[4,e.loadPluginScript("excelOnlineAutocomplete",!1)];case 2:return r.sent(),[2,e]}})})}),KUr=(0,jE.asyncLazy)(function(){return(0,Km.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,Km.__generator)(this,function(r){switch(r.label){case 0:return[4,SF.getValue()];case 1:return e=r.sent(),[4,e.createAndAttachPlugin(hF.PluginFactoryName.AutocompletePlugin)];case 2:return r.sent(),[4,Vke.schedulerWithRecalcServiceAttached.getValue()];case 3:return r.sent(),[2]}})})});Gm.autocompletePluginDependenciesResolved=KUr;var VUr=(0,jE.asyncLazy)(function(){return(0,Km.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,Km.__generator)(this,function(r){switch(r.label){case 0:return[4,SF.getValue()];case 1:return e=r.sent(),[4,e.createAndAttachPlugin(hF.PluginFactoryName.AutocompleteWrapperPlugin)];case 2:return r.sent(),[2]}})})});Gm.autocompleteWrapperPluginAttach=VUr;var WUr=(0,jE.asyncLazy)(function(){return(0,Km.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,Km.__generator)(this,function(r){switch(r.label){case 0:return[4,SF.getValue()];case 1:return e=r.sent(),[4,e.createAndAttachPlugin(hF.PluginFactoryName.AutocompleteRangeSuggestionPlugin)];case 2:return r.sent(),[2]}})})});Gm.autocompleteRangeSuggestionPluginAttach=WUr;var jUr=(0,jE.asyncLazy)(function(){return(0,Km.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,Km.__generator)(this,function(r){switch(r.label){case 0:return[4,SF.getValue()];case 1:return e=r.sent(),[4,e.createAndAttachPlugin(hF.PluginFactoryName.AutocompleteBinaryModelExperimentPlugin)];case 2:return r.sent(),[2]}})})});Gm.autocompleteBinaryModelExperimentPluginAttach=jUr;var HUr=(0,jE.asyncLazy)(function(){return(0,Km.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,Km.__generator)(this,function(r){switch(r.label){case 0:return[4,SF.getValue()];case 1:return e=r.sent(),[4,e.createAndAttachPlugin(hF.PluginFactoryName.ParserPerformanceMeasurements)];case 2:return r.sent(),[2]}})})});Gm.parserPerformanceMeasurementsAttach=HUr;var QUr=(0,jE.asyncLazy)(function(){return(0,Km.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,Km.__generator)(this,function(r){switch(r.label){case 0:return[4,SF.getValue()];case 1:return e=r.sent(),[4,e.createAndAttachPlugin(hF.PluginFactoryName.ChatGPTPlugin)];case 2:return r.sent(),[2]}})})});Gm.chatGPTPluginAttach=QUr});var jke=Y(x7=>{_();Object.defineProperty(x7,"__esModule",{value:!0});x7.GotoCtrlClickVisitor=void 0;var zUr=br(),Mae=tu(),w7=ft(),wae=Qu(),YUr=Ml(),zT=DD(),Dae=Vk(),JUr=function(e){(0,zUr.__extends)(r,e);function r(n,a,o,u){var t=e.call(this)||this;return t.parsedFormulaTree=n,t.activeCell=a,t.definedNameInfoList=o,t.caretPosition=u,t.structRefNodeToResolve=void 0,t.span=void 0,t.sheetRange=void 0,t.referenceFound=!1,t._namedObjectsMap=void 0,t}return Object.defineProperty(r.prototype,"namedObjectsMap",{get:function(){if((0,w7.isDefined)(this._namedObjectsMap))return this._namedObjectsMap;if(!(0,w7.isDefined)(this.definedNameInfoList)){D7("namedObjectsMap: was called but definedNameInfoList is undefined");return}return this._namedObjectsMap=(0,zT.createNameToDefinedNameInfoMapping)(this.definedNameInfoList),this._namedObjectsMap},enumerable:!1,configurable:!0}),r.prototype.structRefNode=function(n,a,o){var u=e.prototype.structRefNode.call(this,n,a,o);if(this.referenceFound)return u;var t=this.parsedFormulaTree.spans[o];return(0,zT.caretInSpanScope)(this.caretPosition,t)&&(this.referenceFound=!0,this.span=t,this.structRefNodeToResolve=u),u},r.prototype.cellRefNode=function(n,a,o){var u=e.prototype.cellRefNode.call(this,n,a,o);if(this.referenceFound)return u;var t=this.parsedFormulaTree.spans[o];return(0,zT.caretInSpanScope)(this.caretPosition,t)&&(this.referenceFound=!0,this.span=t,this.sheetRange=(0,Dae.sheetRangeFromCellRef)(n,a,this.activeCell,D7)),u},r.prototype.nameNode=function(n,a,o){var u=e.prototype.nameNode.call(this,n,a,o);if(this.referenceFound)return u;var t=this.parsedFormulaTree.spans[o];return(0,zT.caretInSpanScope)(this.caretPosition,t)&&u.parts.kind===wae.NamePartKind.FieldRefNamePart&&this.tryFindFieldRefGotoReference(u.parts,a),u},r.prototype.tryFindFieldRefGotoReference=function(n,a){var o=(0,zT.findFieldRefSourceLhs)(n);switch(o.kind){case wae.NamePartKind.CellRefNamePart:{var u=this.parsedFormulaTree.spans[o.label];(0,zT.caretInSpanScope)(this.caretPosition,u)&&(this.referenceFound=!0,this.span=u,this.sheetRange=(0,Dae.sheetRangeFromCellRef)(o.ref,void 0,this.activeCell,D7));return}case wae.NamePartKind.IdentNamePart:{var u=this.parsedFormulaTree.spans[o.label];if((0,w7.isDefined)(this.namedObjectsMap)&&(0,zT.caretInSpanScope)(this.caretPosition,u)){this.referenceFound=!0,this.span=u;var t=(0,zT.getNamePartIfExists)(o,this.namedObjectsMap);if(!(0,w7.isDefined)(t))return;this.sheetRange=(0,Dae.getSheetRangeFromDefinedNameInfo)(t,a)}return}default:D7("tryFindFieldRefGotoReference: Was not able to parse a left-most NamePart")}},r}(YUr.IdentityVisitor);x7.GotoCtrlClickVisitor=JUr;function D7(e){Mae.ulsLogger.ULS.traceTag(508687388,Mae.LogCategory.msoulscat_ES_EWAJS,Mae.TraceLevel.Warning,"GotoCtrlClickVisitor encountered a failure with msg ".concat(e))}});var qae=Y(CF=>{_();Object.defineProperty(CF,"__esModule",{value:!0});CF.gotoCtrlClickPluginDependenciesResolved=CF.GotoCtrlClickPluginFactory=void 0;var Bae=br(),xae=tu(),Hke=ft(),XUr=cu(),Lae=Di(),HE=Fu(),ZUr=Cd(),Qke=Jd(),zke=Vk(),Ey=ds(),$Ur=jke(),eGr=Ml(),rGr=Ll(),Yke=function(){function e(){this.factoryName=HE.PluginFactoryName.GotoCtrlClickPlugin}return e.prototype.create=function(){return new nGr},e}();CF.GotoCtrlClickPluginFactory=Yke;var nGr=function(){function e(){}return e.prototype.run=function(r){var n,a,o,u,t,d,s,c,l,f,p,m,v=r.text,h=r.index;return(0,Bae.__generator)(this,function(S){switch(S.label){case 0:return n=v,h<0||h>=n.length?(yF("caret out of formula scope"),[2,{kind:HE.GotoCtrlClickResultKind.NoReferenceFound}]):[4,{kind:Ey.ComputationRequestKind.ParseActiveCell,formulaText:n}];case 1:return a=S.sent(),a.kind!==Ey.ComputationRequestKind.ParseActiveCell||!(0,Lae.isSuccess)(a.result)?[2,null]:a.result.value.kind!==rGr.EditKind.Formula?[2,null]:[4,{kind:Ey.ComputationRequestKind.GetActiveCell}];case 2:return o=S.sent(),o.kind!==Ey.ComputationRequestKind.GetActiveCell?(yF("failed to get active cell"),[2,null]):(u=void 0,[4,{kind:Ey.ComputationRequestKind.GetDefinedNamesInfo}]);case 3:return t=S.sent(),t.kind===Ey.ComputationRequestKind.GetDefinedNamesInfo?u=t.definedNamesInfo:yF("failed to get defined names"),d=o.activeCell,s=a.result.value.formula,c=new $Ur.GotoCtrlClickVisitor(s,d.range,u,h),(0,eGr.reduceBottomUp)(c,s),c.referenceFound?(l=c.sheetRange,(0,Hke.isDefined)(c.structRefNodeToResolve)?(f=void 0,[4,{kind:Ey.ComputationRequestKind.GetSheetNames}]):[3,6]):[2,{kind:HE.GotoCtrlClickResultKind.NoReferenceFound}];case 4:if(p=S.sent(),p.kind===Ey.ComputationRequestKind.GetSheetNames)f=p;else return yF("failed to get sheet names"),[2,{kind:HE.GotoCtrlClickResultKind.RangeResolutionFailure,span:c.span}];return[4,{kind:Ey.ComputationRequestKind.ResolveReferences,nodes:[c.structRefNodeToResolve],locals:{originGridCell:(0,Lae.success)(d.range),originSheet:(0,Lae.success)(d.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!0}}];case 5:m=S.sent(),m.kind===Ey.ComputationRequestKind.ResolveReferences?l=(0,zke.getSharedSheetRangeFromResolvedRef)(f,m.resolverResults[0],yF):yF("failed to resolve node references"),S.label=6;case 6:return(0,Hke.isDefined)(l)?[2,{kind:HE.GotoCtrlClickResultKind.ReferenceFound,sharedSheetRange:(0,zke.toSharedSheetRange)(l),sheetRange:l,span:c.span}]:[2,{kind:HE.GotoCtrlClickResultKind.RangeResolutionFailure,span:c.span}]}})},e}();(0,ZUr.registerPluginFactory)(new Yke);var tGr=(0,XUr.asyncLazy)(function(){return(0,Bae.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,Bae.__generator)(this,function(r){switch(r.label){case 0:return[4,Qke.workerThreadSpread.getValue()];case 1:return e=r.sent(),[4,e.createAndAttachPlugin(HE.PluginFactoryName.GotoCtrlClickPlugin)];case 2:return r.sent(),[4,Qke.schedulerWithRecalcServiceAttached.getValue()];case 3:return r.sent(),[2]}})})});CF.gotoCtrlClickPluginDependenciesResolved=tGr;function yF(e){xae.ulsLogger.ULS.traceTag(508687389,xae.LogCategory.msoulscat_ES_EWAJS,xae.TraceLevel.Warning,"GotoCtrlClickPlugin encountered a failure with msg ".concat(e))}});var B7=Y(L7=>{_();Object.defineProperty(L7,"__esModule",{value:!0});L7.tokenizeFormula=void 0;var aGr=N0(),iGr=aGr.tokenizeFormulaModule.tokenizeFormula;L7.tokenizeFormula=iGr});var Uae=Y(nn=>{_();Object.defineProperty(nn,"__esModule",{value:!0});nn.unexpectedToken=nn.subOperatorToken=nn.specialRefToken=nn.spacesToken=nn.singleLineCommentToken=nn.rowSepToken=nn.rightSQuoteToken=nn.rightParenToken=nn.rightBracketToken=nn.rightBraceToken=nn.rangeOperatorToken=nn.qualSepToken=nn.powOperatorToken=nn.poundOperatorToken=nn.percentOperatorToken=nn.operatorToken=nn.neOperatorToken=nn.multiLineCommentToken=nn.mulOperatorToken=nn.ltOperatorToken=nn.literalToken=nn.listSepToken=nn.leftSQuoteToken=nn.leftParenToken=nn.leftBracketToken=nn.leftBraceToken=nn.leOperatorToken=nn.isNumberLikeOper=nn.isBadNumberOper=nn.isBadErrorOper=nn.identToken=nn.identOrBooleanToken=nn.gtOperatorToken=nn.geOperatorToken=nn.escapeToken=nn.eqOperatorToken=nn.endToken=nn.dotSepToken=nn.divOperatorToken=nn.concatOperatorToken=nn.colSepToken=nn.cellRefR1C1Token=nn.cellRefA1Token=nn.badNumberOper=nn.badErrorOper=nn.atOperatorToken=nn.assignSepToken=nn.appendToken=nn.addOperatorToken=nn.TokenOperKind=nn.TokenKind=nn.SepId=nn.DelimId=void 0;var ma=N0(),oGr=ma.token.DelimId;nn.DelimId=oGr;var uGr=ma.token.SepId;nn.SepId=uGr;var sGr=ma.token.TokenKind;nn.TokenKind=sGr;var lGr=ma.token.TokenOperKind;nn.TokenOperKind=lGr;var cGr=ma.token.addOperatorToken;nn.addOperatorToken=cGr;var dGr=ma.token.appendToken;nn.appendToken=dGr;var fGr=ma.token.assignSepToken;nn.assignSepToken=fGr;var pGr=ma.token.atOperatorToken;nn.atOperatorToken=pGr;var mGr=ma.token.badErrorOper;nn.badErrorOper=mGr;var gGr=ma.token.badNumberOper;nn.badNumberOper=gGr;var vGr=ma.token.cellRefA1Token;nn.cellRefA1Token=vGr;var hGr=ma.token.cellRefR1C1Token;nn.cellRefR1C1Token=hGr;var SGr=ma.token.colSepToken;nn.colSepToken=SGr;var yGr=ma.token.concatOperatorToken;nn.concatOperatorToken=yGr;var CGr=ma.token.divOperatorToken;nn.divOperatorToken=CGr;var _Gr=ma.token.dotSepToken;nn.dotSepToken=_Gr;var RGr=ma.token.endToken;nn.endToken=RGr;var TGr=ma.token.eqOperatorToken;nn.eqOperatorToken=TGr;var bGr=ma.token.escapeToken;nn.escapeToken=bGr;var PGr=ma.token.geOperatorToken;nn.geOperatorToken=PGr;var EGr=ma.token.gtOperatorToken;nn.gtOperatorToken=EGr;var NGr=ma.token.identOrBooleanToken;nn.identOrBooleanToken=NGr;var AGr=ma.token.identToken;nn.identToken=AGr;var OGr=ma.token.isBadErrorOper;nn.isBadErrorOper=OGr;var kGr=ma.token.isBadNumberOper;nn.isBadNumberOper=kGr;var FGr=ma.token.isNumberLikeOper;nn.isNumberLikeOper=FGr;var IGr=ma.token.leOperatorToken;nn.leOperatorToken=IGr;var MGr=ma.token.leftBraceToken;nn.leftBraceToken=MGr;var wGr=ma.token.leftBracketToken;nn.leftBracketToken=wGr;var DGr=ma.token.leftParenToken;nn.leftParenToken=DGr;var xGr=ma.token.leftSQuoteToken;nn.leftSQuoteToken=xGr;var LGr=ma.token.listSepToken;nn.listSepToken=LGr;var BGr=ma.token.literalToken;nn.literalToken=BGr;var qGr=ma.token.ltOperatorToken;nn.ltOperatorToken=qGr;var UGr=ma.token.mulOperatorToken;nn.mulOperatorToken=UGr;var GGr=ma.token.neOperatorToken;nn.neOperatorToken=GGr;var KGr=ma.token.operatorToken;nn.operatorToken=KGr;var VGr=ma.token.percentOperatorToken;nn.percentOperatorToken=VGr;var WGr=ma.token.poundOperatorToken;nn.poundOperatorToken=WGr;var jGr=ma.token.powOperatorToken;nn.powOperatorToken=jGr;var HGr=ma.token.qualSepToken;nn.qualSepToken=HGr;var QGr=ma.token.rangeOperatorToken;nn.rangeOperatorToken=QGr;var zGr=ma.token.rightBraceToken;nn.rightBraceToken=zGr;var YGr=ma.token.rightBracketToken;nn.rightBracketToken=YGr;var JGr=ma.token.rightParenToken;nn.rightParenToken=JGr;var XGr=ma.token.rightSQuoteToken;nn.rightSQuoteToken=XGr;var ZGr=ma.token.rowSepToken;nn.rowSepToken=ZGr;var $Gr=ma.token.spacesToken;nn.spacesToken=$Gr;var e9r=ma.token.specialRefToken;nn.specialRefToken=e9r;var r9r=ma.token.subOperatorToken;nn.subOperatorToken=r9r;var n9r=ma.token.unexpectedToken;nn.unexpectedToken=n9r;var t9r=ma.token.singleLineCommentToken;nn.singleLineCommentToken=t9r;var a9r=ma.token.multiLineCommentToken;nn.multiLineCommentToken=a9r});var G7=Y(U7=>{_();Object.defineProperty(U7,"__esModule",{value:!0});U7.ConsistentAnonymizer=void 0;var Jke=br(),i9r=B7(),Wu=Uae(),Gae=Qu(),q7=pv(),Xke=Ai(),o9r=function(){function e(){this.nonLiteralStore=new Map,this.literalStore=new Map}return e.prototype.get=function(r,n,a){var o,u;if(r===Wu.TokenKind.Literal){if(a===void 0)throw new Error("Expected subkind");return(o=this.literalStore.get(a))===null||o===void 0?void 0:o.get(n)}return(u=this.nonLiteralStore.get(r))===null||u===void 0?void 0:u.get(n)},e.prototype.set=function(r,n,a,o){var u,t;if(r===Wu.TokenKind.Literal){if(o===void 0)throw new Error("Expected subkind");var d=(u=this.literalStore.get(o))!==null&&u!==void 0?u:new Map;d.set(n,a),this.literalStore.set(o,d)}else{var d=(t=this.nonLiteralStore.get(r))!==null&&t!==void 0?t:new Map;d.set(n,a),this.nonLiteralStore.set(r,d)}},e}();function u9r(e){return e===void 0?!1:e.kind===Wu.TokenKind.Left&&e.value===Wu.DelimId.Paren}function s9r(e,r){var n=r??e.start;return e.chars==="	"||e.chars===";"?(0,Wu.unexpectedToken)(n,e.chars):(0,Wu.unexpectedToken)(n,"	")}function l9r(e){return e.map(function(r){return r.chars}).join("")}var c9r=function(){function e(){this.store=new o9r,this.counter=1}return e.prototype.getAnonymization=function(r,n,a,o){var u=this.store.get(r,a,n);if(u!==void 0)return u;var t=o(this.counter);return this.counter+=1,this.store.set(r,a,t,n),t},e.prototype.anonymizeIdent=function(r,n,a,o){var u=n??r.start,t=a==null?void 0:a.localeInfo.getWorksheetFuncId(r.chars);if(t!==void 0&&u9r(o))return(0,Wu.identToken)(u,r.chars);var d=this.getAnonymization(r.kind,void 0,r.chars,function(s){return"ident".concat(s)});return(0,Wu.identToken)(u,d)},e.prototype.anonymizeA1CellRef=function(r,n){if(r.refStyle!==Gae.RefStyle.A1)throw new Error("Expected RefStyle.A1");var a=n??r.start,o=this.getAnonymization(r.kind,void 0,r.chars,function(t){return"A".concat(t)}),u=(0,Wu.cellRefA1Token)(a,o,void 0,void 0);return u},e.prototype.anonymizeR1C1CellRef=function(r,n){if(r.refStyle!==Gae.RefStyle.R1C1)throw new Error("Expected RefStyle.R1C1");var a=n??r.start,o=this.getAnonymization(r.kind,void 0,r.chars,function(u){return"R".concat(u,"C").concat(u)});return(0,Wu.cellRefR1C1Token)(a,o,void 0,void 0)},e.prototype.anonymizeCellRef=function(r,n){return r.refStyle===Gae.RefStyle.A1?this.anonymizeA1CellRef(r,n):this.anonymizeR1C1CellRef(r,n)},e.prototype.anonymizeLiteral=function(r,n){var a=n??r.start,o=void 0;switch(r.oper.kind){case q7.OperKind.Number:o=this.getAnonymization(r.kind,r.oper.kind,r.chars,function(d){return"".concat(d)});break;case q7.OperKind.String:o=this.getAnonymization(r.kind,r.oper.kind,r.chars,function(d){return'"s'.concat(d,'"')});break;case Wu.TokenOperKind.BadNumber:o=this.getAnonymization(r.kind,r.oper.kind,r.chars,function(d){return"1e".concat(d,"000")});break;case Wu.TokenOperKind.BadError:o=this.getAnonymization(r.kind,r.oper.kind,r.chars,function(d){for(var s=["a"],c="a".charCodeAt(0),l=d;l>0;){var f=d%10,p=String.fromCharCode(c+f);s.push(p),l=Math.floor(l/10)}var m=s.join("");return"#".concat(m)});break;case q7.OperKind.Boolean:case q7.OperKind.Error:o=r.chars;break;default:(0,Xke.assertNever)("error",r.oper)}var u=r.oper,t=r.hasRight;return(0,Wu.literalToken)(a,o,u,t)},e.prototype.anonymizeToken=function(r,n,a,o){switch(r.kind){case Wu.TokenKind.Ident:return this.anonymizeIdent(r,n,a,o);case Wu.TokenKind.CellRef:return this.anonymizeCellRef(r,n);case Wu.TokenKind.Literal:return this.anonymizeLiteral(r,n);case Wu.TokenKind.Unexpected:return s9r(r,n);case Wu.TokenKind.SingleLineComment:return(0,Wu.singleLineCommentToken)(n,"redacted");case Wu.TokenKind.MultiLineComment:return(0,Wu.multiLineCommentToken)(n,"redacted",r.isClosed);case Wu.TokenKind.End:case Wu.TokenKind.Left:case Wu.TokenKind.Right:case Wu.TokenKind.Sep:case Wu.TokenKind.Operator:case Wu.TokenKind.Spaces:case Wu.TokenKind.SpecialRef:case Wu.TokenKind.Escape:return(0,Jke.__assign)((0,Jke.__assign)({},r),{start:n});default:return(0,Xke.assertNever)("ConsistentAnonymizer.anonymizeToken",r)}},e.prototype.anonymize=function(r,n,a){for(var o=(0,i9r.tokenizeFormula)(n.localeInfo,n.mathpack,n.refStyle,a,r,0,{}),u=[],t=0,d=0;d<o.length;d+=1){var s=o[d],c=d+1<o.length?o[d+1]:void 0,l=this.anonymizeToken(s,t,n,c);t+=l.chars.length,u.push(l)}return l9r(u)},e}();U7.ConsistentAnonymizer=c9r});var tFe=Y(Ny=>{_();Object.defineProperty(Ny,"__esModule",{value:!0});Ny.FormulaCollectionPluginFactory=Ny.FormulaCollectionPlugin=void 0;Ny.combineSplitCollectedFormulaLogs=E9r;Ny.deserializeSplitCollectedFormulaLog=T9r;Ny.formulaCollectionPluginDependenciesResolved=void 0;var Kae=br(),QE=ds(),d9r=Cd(),RF=tu(),Zke=Di(),f9r=Ll(),p9r=gs(),m9r=Ol(),g9r=G7(),$ke=OP(),v9r=U2(),h9r=zu(),S9r=cu(),eFe=Jd(),Vae=Fu();function y9r(e){for(var r=P9r(e),n=0,a=r;n<a.length;n++){var o=a[n],u=R9r(o);RF.ulsLogger.ULS.dnmTraceTag(537962336,RF.LogCategory.msoulscat_ES_EWAJS,RF.TraceLevel.Info,u)}}function K7(e){RF.ulsLogger.ULS.traceTag(537962337,RF.LogCategory.msoulscat_ES_EWAJS,RF.TraceLevel.Verbose,e)}function C9r(e,r){var n={},a={};return Object.keys(e).forEach(function(o){var u=Number(o),t=e[u];t!==void 0&&(n[o]=t);var d=r.spans[u];d!==void 0&&(a[o]=d)}),{spanDiagnostics:n,spans:a}}var rFe=function(){function e(){this.factoryName=Vae.PluginFactoryName.FormulaCollectionPlugin}return e.prototype.create=function(){return new nFe},e}();Ny.FormulaCollectionPluginFactory=rFe;var nFe=function(){function e(){this.lastEdit=void 0,this.consistentAnonymizer=new g9r.ConsistentAnonymizer,this.sheetIdAnonymization=new Map}return e.prototype.getEditEntry=function(r,n){var a={content:r,cell:n};if(!(this.lastEdit!==void 0&&(0,h9r.isSheetGridCellEqual)(this.lastEdit.cell,n)&&this.lastEdit.content===r))return this.lastEdit=a,a},e.prototype.anonymizeSheetId=function(r){if(this.sheetIdAnonymization.has(r)){var n=this.sheetIdAnonymization.get(r);return n}var a=(0,m9r.getNewGuid)()[0];return this.sheetIdAnonymization.set(r,a),a},e.prototype.run=function(r){var n,a,o,u,t,d,s,c,l,f,p,m,v,h,S,y,C,E,I;return(0,Kae.__generator)(this,function(F){switch(F.label){case 0:return[4,{kind:QE.ComputationRequestKind.GetActiveCell}];case 1:return n=F.sent(),n.kind!==QE.ComputationRequestKind.GetActiveCell?(K7(_F.GetActiveCell),[2,null]):(a=n.activeCell,r.content==null?(K7(_F.EmptyContent),[2,null]):r.content.trimLeft().startsWith("=")?(o=this.getEditEntry(r.content,a),o===void 0?[2,null]:[4,{kind:QE.ComputationRequestKind.GetConfig}]):[2,null]);case 2:return u=F.sent(),u.kind!==QE.ComputationRequestKind.GetConfig?(K7(_F.GetConfig),[2,null]):(t=u.config,d=(0,$ke.createAnalyzeGlobals)(t),s=(0,p9r.lexicalSourceCell)(o.cell),c=(0,$ke.analyzeLocalsGrid)(s.kind,s.range),l=(0,v9r.createAnalyzer)(d),f=this.consistentAnonymizer.anonymize(o.content,t,a.range),[4,{kind:QE.ComputationRequestKind.ParseEdit,cell:o.cell,formulaBarText:f}]);case 3:return p=F.sent(),p.kind!==QE.ComputationRequestKind.ParseEdit||!(0,Zke.isSuccess)(p.result)?(K7(_F.ParseEdit),[2,null]):p.result.value.kind!==f9r.EditKind.Formula?[2,null]:(m=p.result.value.formula,v=m.isWellFormed,h=void 0,v||(S=l.checkFormulaWithDiagnostics(c,m),(0,Zke.isSuccess)(S)&&(y=S==null?void 0:S.value[1],y!==void 0&&(h=C9r(y,m)))),[4,{kind:QE.ComputationRequestKind.GetCorrelationId}]);case 4:return C=F.sent(),C.kind!=="GetCorrelationId"?[2,null]:(E=C.correlationId,I={v:e.formulaCollectionVersion,f,ok:v,d:h,c:{s:this.anonymizeSheetId(o.cell.sheet.index),c:o.cell.range.col,r:o.cell.range.row},i:E},y9r(I),[2,null])}})},e.factoryName=Vae.PluginFactoryName.FormulaCollectionPlugin,e.formulaCollectionVersion=1,e}();Ny.FormulaCollectionPlugin=nFe;var _9r=2300;function R9r(e){return e.correlationId.toString()+","+e.logPartId.toString()+","+e.partialMessage}function T9r(e){var r=e,n=r.indexOf(","),a=Number(r.slice(0,n));r=r.slice(n+1),n=r.indexOf(",");var o=Number(r.slice(0,n)),u=r.slice(n+1);return{correlationId:a,logPartId:o,partialMessage:u}}function b9r(e,r,n){var a=n.toString().length+r.toString().length+2,o=_9r-a,u=e.slice(0,o),t={correlationId:n,logPartId:r,partialMessage:u},d=e.slice(o);return[t,d]}function P9r(e){for(var r=JSON.stringify(e),n=0,a=[];r.length>0;){var o=b9r(r,n,e.i),u=o[0],t=o[1];r=t,n+=1,a.push(u)}return a}function E9r(e){var r=e.sort(function(n){return n.logPartId}).map(function(n){return n.partialMessage}).join("");return JSON.parse(r)}var _F;(function(e){e.GetActiveCell="GetActiveCell failed",e.GetConfig="GetConfig failed",e.ParseEdit="ParseEdit failed",e.EmptyContent="empty content"})(_F||(_F={}));(0,d9r.registerPluginFactory)(new rFe);var N9r=(0,S9r.asyncLazy)(function(){return(0,Kae.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,Kae.__generator)(this,function(r){switch(r.label){case 0:return[4,eFe.workerThreadSpread.getValue()];case 1:return e=r.sent(),[4,e.createAndAttachPlugin(Vae.PluginFactoryName.FormulaCollectionPlugin)];case 2:return r.sent(),[4,eFe.schedulerWithRecalcServiceAttached.getValue()];case 3:return r.sent(),[2]}})})});Ny.formulaCollectionPluginDependenciesResolved=N9r});var iFe=Y(W7=>{_();Object.defineProperty(W7,"__esModule",{value:!0});W7.ValuePreviewVisitor=void 0;var A9r=br(),O9r=Ai(),aFe=Ol(),dx=ft(),V7=Qu(),k9r=Ml(),F9r=function(e){(0,A9r.__extends)(r,e);function r(n,a,o,u){var t=e.call(this)||this;return t.parsedFormulaTree=n,t.selectionStart=a,t.selectionEnd=o,t.formula=u,t.subFormulaStart=-1,t.subFormulaEnd=-1,t.isBadSequence=!1,t.isRefNode=!1,t.letDefinitions=void 0,t.nodeLabel=-1,t}return r.prototype.appNode=function(n,a,o,u){var t=e.prototype.appNode.call(this,n,a,o,u);return this.tryUpdateAppNodeAsSubFormula(n,t),t},r.prototype.literalNode=function(n,a,o){var u=e.prototype.literalNode.call(this,n,a,o);return this.tryUpdateNodeAsSubFormula(u),u},r.prototype.missingNode=function(n,a){var o=e.prototype.missingNode.call(this,n,a);return this.tryUpdateNodeAsSubFormula(o),o},r.prototype.arrayNode=function(n,a,o){var u=e.prototype.arrayNode.call(this,n,a,o);return this.tryUpdateNodeAsSubFormula(u),u},r.prototype.cellRefNode=function(n,a,o){var u=e.prototype.cellRefNode.call(this,n,a,o);return this.tryUpdateNodeAsSubFormula(u)&&(this.isRefNode=!0),u},r.prototype.fieldRefNode=function(n,a,o,u){var t=e.prototype.fieldRefNode.call(this,n,a,o,u);return this.tryUpdateNodeAsSubFormula(t),t},r.prototype.structRefNode=function(n,a,o){var u=e.prototype.structRefNode.call(this,n,a,o);return this.tryUpdateNodeAsSubFormula(u)&&(this.isRefNode=!0),u},r.prototype.nameNode=function(n,a,o){var u=e.prototype.nameNode.call(this,n,a,o);return this.tryUpdateNodeAsSubFormula(u)&&(this.isRefNode=!0),u},r.prototype.badSequenceNode=function(n,a,o){var u=this,t=e.prototype.badSequenceNode.call(this,n,a,o);return a.some(function(d){return d.label===u.nodeLabel})&&(this.updateNodeAsSubFormula(t),this.isBadSequence=!0),t},r.prototype.parenNode=function(n,a,o){var u=e.prototype.parenNode.call(this,n,a,o);return a&&this.tryUpdateNodeAsSubFormula(u),u},r.prototype.letNode=function(n,a,o,u,t,d){var s=e.prototype.letNode.call(this,n,a,o,u,t,d),c=this.parsedFormulaTree.spans[d];return this.isMatchingArg(c,!0)&&this.updateLetNodeAsSubFormula(s),s},r.prototype.tryUpdateNodeAsSubFormula=function(n){return this.isMinimalMatchingSpan(this.parsedFormulaTree.spans[n.label])?(this.updateNodeAsSubFormula(n),!0):!1},r.prototype.tryUpdateAppNodeAsSubFormula=function(n,a){if(!(n.kind===V7.NodeKind.WSF||n.kind===V7.NodeKind.Operator)){O9r.ulsLogger.ULS.traceTag(509347166,aFe.LogCategory.msoulscat_ES_EWAJS,aFe.TraceLevel.Info,"ValuePreviewVisitor - visitor encountered higher order function.");return}var o=this.parsedFormulaTree.spans[n.label],u=this.parsedFormulaTree.spans[a.label];this.isMatchingAppNode(o,u,n.kind,a.isClosed)&&this.updateNodeAsSubFormula(a)},r.prototype.updateLetNodeAsSubFormula=function(n){var a=this.parsedFormulaTree.spans[n.head.label],o=this.parsedFormulaTree.spans[n.label];if(this.isMatchingAppNode(a,o,V7.NodeKind.WSF,n.isClosed)){this.subFormulaStart=o.start,this.subFormulaEnd=o.end,this.nodeLabel=n.label;return}for(var u=0;u<n.args.length;u++){var t=n.args[u],d=this.parsedFormulaTree.spans[t.label];if(!(0,dx.isDefined)(d))return;if(this.isMatchingArg(d,!0)){if(u===1)return;var s=u%2===0,c=n.args.length-2,l=s?Math.min(c,u+1):u-2,f=this.parsedFormulaTree.spans[n.args[l].label];if(!(0,dx.isDefined)(f))return;var p=this.formula.substring(o.start,f.end);this.letDefinitions=p,this.nodeLabel===-1&&this.isMatchingArg(d,!1)&&(this.subFormulaStart=d.start,this.subFormulaEnd=d.end,this.nodeLabel=t.label)}}},r.prototype.updateNodeAsSubFormula=function(n){var a=this.parsedFormulaTree.spans[n.label];this.subFormulaStart=a.start,this.subFormulaEnd=a.end,this.nodeLabel=n.label},r.prototype.isMinimalMatchingSpan=function(n){return this.nodeLabel!==-1?!1:this.isMatchingArg(n)},r.prototype.isMatchingArg=function(n,a){return a===void 0&&(a=!1),(0,dx.isDefined)(n)?this.selectionStart===this.selectionEnd?this.selectionStart>=n.start&&this.selectionEnd<n.end:a?this.selectionStart>=n.start&&this.selectionEnd<=n.end:this.selectionStart===n.start&&this.selectionEnd===n.end:!1},r.prototype.isMatchingAppNode=function(n,a,o,u){return!(0,dx.isDefined)(n)||!(0,dx.isDefined)(a)||!u?!1:this.selectionStart===this.selectionEnd?o===V7.NodeKind.WSF&&(this.selectionStart===n.end||this.selectionStart===a.end-1)?!0:this.selectionStart>=n.start&&this.selectionStart<n.end:this.selectionStart===a.start&&this.selectionEnd===a.end},r}(k9r.IdentityVisitor);W7.ValuePreviewVisitor=F9r});var jae=Y(Q7=>{_();Object.defineProperty(Q7,"__esModule",{value:!0});Q7.ValuePreviewResultExtractor=void 0;var oFe=br(),ch=Rne(),I9r=ft(),fx=Di(),YT=pv(),M9r=f1(),j7=Ll(),Wae=Z1(),w9r=gm(),D9r=Ai(),uFe=V5(),x9r=function(){function e(r,n,a){this.mathpack=r,this.isFormattedStringEnabled=n,this.isErrorFallbackToServerEnabled=a}return e.prototype.fromEvalFormulaOutput=function(r){var n=r.value,a=r.formatted;switch(n.kind){case fx.ResultKind.Success:return this.resultFromSuccess(n.value,a);case fx.ResultKind.Failure:return this.resultFromFailureReason(n.reason);default:{var o=n;return o}}},e.prototype.resultFromSuccess=function(r,n){var a;switch(r.kind){case YT.OperKind.Boolean:case YT.OperKind.String:case YT.OperKind.Array:case YT.OperKind.Blank:case YT.OperKind.Number:{a=this.resultFromFormatted(n);break}case YT.OperKind.Error:{a=this.resultFromError(r,n);break}default:return{kind:ch.ValuePreviewResultKind.Failure}}if(a.kind!==ch.ValuePreviewResultKind.Success)return a;var o=a.value;return this.isFormattedStringEnabled&&r.kind===YT.OperKind.String&&(a.value='"'.concat(a.value,'"')),r.kind===YT.OperKind.Number&&(o=this.mathpack.toNumber(r).toString()),(0,oFe.__assign)((0,oFe.__assign)({},a),{unformattedValue:o,operKind:r.kind})},e.prototype.resultFromFormatted=function(r){if((0,I9r.isNone)(r))return{kind:ch.ValuePreviewResultKind.Failure};switch(r.kind){case fx.ResultKind.Success:{if((0,j7.isHashesValue)(r.value)){var n=r.value.units;return H7("Evaluate HashesValue: ".concat(n.kind)),{kind:ch.ValuePreviewResultKind.Failure}}return this.resultFromFormattedValue(r.value)}case fx.ResultKind.Failure:return this.resultFromFailureReason(r.reason);default:{var a=r;return a}}},e.prototype.resultFromFormattedValue=function(r){var n=w9r.render.renderValue(this.mathpack,r,j7.renderInfiniteWidth);if(n.kind===fx.ResultKind.Failure)return H7("renderValue fail"),{kind:ch.ValuePreviewResultKind.Failure};if((0,j7.isHashesValue)(n.value)){var a=n.value.units;return H7("Render HashesValue: ".concat(a.kind)),{kind:ch.ValuePreviewResultKind.Failure}}var o=(0,j7.renderedValueToString)(n.value);return!this.isFormattedStringEnabled&&o.trim()===""?(H7("Empty result"),{kind:ch.ValuePreviewResultKind.Failure}):{kind:ch.ValuePreviewResultKind.Success,value:o,color:r.color}},e.prototype.resultFromFailureReason=function(r){switch(r.kind){case Wae.ReasonKind.Unavailable:case Wae.ReasonKind.NotImplemented:case Wae.ReasonKind.PreviousFailure:return{kind:ch.ValuePreviewResultKind.Unavailable};default:return{kind:ch.ValuePreviewResultKind.Failure}}},e.prototype.resultFromError=function(r,n){return this.isErrorFallbackToServerEnabled?{kind:ch.ValuePreviewResultKind.Unavailable}:r.type===M9r.ErrorType.FIELD?{kind:ch.ValuePreviewResultKind.Unavailable}:this.resultFromFormatted(n)},e}();Q7.ValuePreviewResultExtractor=x9r;function H7(e){D9r.ulsLogger.ULS.traceTag(520680450,uFe.LogCategory.msoulscat_ES_EWAJS,uFe.TraceLevel.Warning,"ValuePreviewResultExtractor encountered a failure with msg ".concat(e))}});var sFe=Y(z7=>{_();Object.defineProperty(z7,"__esModule",{value:!0});z7.ValuePreviewNameVisitor=void 0;var L9r=br(),B9r=Qu(),q9r=Ml(),U9r=function(e){(0,L9r.__extends)(r,e);function r(n,a,o){var u=e.call(this)||this;return u.parsedFormulaTree=n,u.start=a,u.end=o,u.isSubFormulaName=!1,u}return r.prototype.nameNode=function(n,a,o){var u=this.parsedFormulaTree.spans[o];return n.kind===B9r.NamePartKind.IdentNamePart&&u&&u.start===this.start&&u.end===this.end&&(this.isSubFormulaName=!0),e.prototype.nameNode.call(this,n,a,o)},r}(q9r.IdentityVisitor);z7.ValuePreviewNameVisitor=U9r});var zae=Y(TF=>{_();Object.defineProperty(TF,"__esModule",{value:!0});TF.valuePreviewPluginDependenciesResolved=TF.ValuePreviewPluginFactory=void 0;var Ay=br(),dh=ds(),G9r=Cd(),K9r=cu(),lFe=Jd(),Qae=Di(),gFe=Ll(),px=ft(),vFe=Ai(),J7=Ol(),V9r=iFe(),hFe=Ml(),W9r=jae(),j9r=vd(),cFe=f1(),H9r=sFe(),dFe=pv(),YE=Fu(),Y7=tu(),Q9r=fy(),fFe=Jc(),pFe=Ql(),Hae=Q9r.types.SpecialFormat,SFe=function(){function e(){this.factoryName=YE.PluginFactoryName.ValuePreviewPlugin}return e.prototype.create=function(){var r=new z9r;return r},e}();TF.ValuePreviewPluginFactory=SFe;var z9r=function(){function e(){this.isLocalizedErrorNamesEnabled=(0,fFe.getTypedFeatureGate)("Microsoft.Office.Excel.LocalizedErrorNames"),this.isEditSpecialFormatEnabled=(0,fFe.isTypedChangeGateEnabled)("OfficeVSO:7938178_EditSpecialFormat"),this.isFormattedStringEnabled=(0,pFe.isChangeGateEnabled)("OfficeVSO:7963895_ValuePreviewFormattedString"),this.isErrorFallbackToServerEnabled=(0,pFe.isChangeGateEnabled)("OfficeVSO:8079753_ValuePreviewErrorFallbackToServer")}return e.prototype.run=function(r){var n,a,o,u,t,d,s,c,l,f,p,m,v,h,S,y,C=r.text,E=r.index,I=r.length;return(0,Ay.__generator)(this,function(F){switch(F.label){case 0:return(0,px.isNone)(C)||(0,px.isNone)(E)||(0,px.isNone)(I)?(zE("missing request arguments"),[2,null]):E<0||E+I>C.length?(zE("invalid selection, ".concat(C.length,", ").concat(E,", ").concat(I)),[2,null]):[4,{kind:dh.ComputationRequestKind.ParseActiveCell,formulaText:C}];case 1:if(n=F.sent(),n.kind!==dh.ComputationRequestKind.ParseActiveCell||!(0,Qae.isSuccess)(n.result))return[2,null];if(a=n.result.value,a.kind!==gFe.EditKind.Formula)return[2,null];if(u=void 0,C.startsWith("=")&&E===0&&I===0||I===C.length)o={start:0,end:C.length};else if(u=new V9r.ValuePreviewVisitor(a.formula,E,E+I,C),(0,hFe.reduceBottomUp)(u,a.formula),o=I===0?{start:u.subFormulaStart,end:u.subFormulaEnd}:{start:E,end:E+I},o.start===-1||o.end===o.start||u.isBadSequence||I>0&&!Y9r(a.formula,o))return[2,null];return t=C.substring(o.start,o.end),(0,px.isDefined)(u==null?void 0:u.letDefinitions)&&(t=(u==null?void 0:u.letDefinitions)+", "+t+")"),t?[4,{kind:dh.ComputationRequestKind.GetActiveCell}]:[2,null];case 2:return d=F.sent(),d.kind!==dh.ComputationRequestKind.GetActiveCell?(zE("GetActiveCell fail"),[2,null]):[4,{kind:dh.ComputationRequestKind.GetConfig}];case 3:return s=F.sent(),s.kind!==dh.ComputationRequestKind.GetConfig?(zE("GetConfig fail"),[2,null]):(c=(t.startsWith("=")?"":"=")+t,l={index:o.start,length:o.end-o.start},[4,{kind:dh.ComputationRequestKind.GetActiveCellFormat}]);case 4:return f=F.sent(),f.kind!==dh.ComputationRequestKind.GetActiveCellFormat?(zE("GetActiveCellFormat failed"),[2,(0,Ay.__assign)({kind:YE.ValuePreviewResultKind.Unavailable,evaluatedFormula:c},l)]):!(0,Qae.isSuccess)(f.result)||(0,px.isNone)(f.result.value)?(zE("Empty cell format"),[2,(0,Ay.__assign)({kind:YE.ValuePreviewResultKind.Unavailable,evaluatedFormula:c},l)]):(this.isEditSpecialFormatEnabled?p={kind:Hae.Edit,renderBlanksAsZeros:!0,isWholeFormula:c===C}:(m=Hae.Origin,(f.result.value.formatString===s.config.localeInfo.pictureSpecial[Y7.PictureSpecial.General]||(u==null?void 0:u.isRefNode)===!0&&c.length!==C.length)&&(m=Hae.Inferred),p={kind:m,renderBlanksAsZeros:!0}),[4,{kind:dh.ComputationRequestKind.EvalFormula,formula:c,origin:{sheet:d.activeCell.sheet,range:{col:d.activeCell.range.col,row:d.activeCell.range.row,rows:1,cols:1}},format:p}]);case 5:return v=F.sent(),v.kind!==dh.ComputationRequestKind.EvalFormula?[2,null]:!this.isErrorFallbackToServerEnabled&&J9r(v.result)&&(this.isLocalizedErrorNamesEnabled||mFe(s.config.localeInfo.lcid))?[4,{kind:dh.ComputationRequestKind.GetDefinedNamesInfo}]:[3,7];case 6:if(h=F.sent(),h.kind!==dh.ComputationRequestKind.GetDefinedNamesInfo)zE("failed to get named objects info");else if(X9r(h.definedNamesInfo,a.formula,c,o))return[2,(0,Ay.__assign)({kind:YE.ValuePreviewResultKind.Success,value:s.config.localeInfo.errorNames[cFe.ErrorType.NAME],unformattedValue:s.config.localeInfo.errorNames[cFe.ErrorType.NAME],operKind:dFe.OperKind.Error,evaluatedFormula:c},l)];F.label=7;case 7:return S=new W9r.ValuePreviewResultExtractor(s.config.mathpack,this.isFormattedStringEnabled,this.isErrorFallbackToServerEnabled),y=S.fromEvalFormulaOutput(v.result),!this.isErrorFallbackToServerEnabled&&!this.isLocalizedErrorNamesEnabled&&y.kind===YE.ValuePreviewResultKind.Success&&y.operKind===dFe.OperKind.Error&&!mFe(s.config.localeInfo.lcid)?(Z9r("Unsupported locale for error messages"),[2,(0,Ay.__assign)({kind:YE.ValuePreviewResultKind.Unavailable,evaluatedFormula:c},l)]):[2,(0,Ay.__assign)((0,Ay.__assign)((0,Ay.__assign)({},y),{evaluatedFormula:c}),l)]}})},e}();function Y9r(e,r){var n=r.start===0,a=n||Object.keys(e.spans).some(function(u){var t;return((t=e.spans[Number(u)])===null||t===void 0?void 0:t.start)===r.start}),o=Object.keys(e.spans).some(function(u){var t;return((t=e.spans[Number(u)])===null||t===void 0?void 0:t.end)===r.end});return a&&o}function J9r(e){return e.value.kind===Qae.ResultKind.Failure&&e.value.reason.kind===gFe.ReasonKind.Unavailable&&e.value.reason.objects.some(function(r){return r.kind===j9r.UnavailableKind.NameLoc})}function X9r(e,r,n,a){var o=(n.startsWith("=")?n.slice(1):n).toLocaleLowerCase();if(e.some(function(s){var c;return((c=s.name)===null||c===void 0?void 0:c.toLocaleLowerCase())===o}))return!1;var u=n.startsWith("=")&&a.start===0?1:a.start,t=u+o.length,d=new H9r.ValuePreviewNameVisitor(r,u,t);return(0,hFe.reduceBottomUp)(d,r),d.isSubFormulaName}function zE(e){vFe.ulsLogger.ULS.traceTag(521692767,J7.LogCategory.msoulscat_ES_EWAJS,J7.TraceLevel.Warning,"ValuePreviewPlugin encountered a failure with msg ".concat(e))}function Z9r(e){vFe.ulsLogger.ULS.traceTag(508904545,J7.LogCategory.msoulscat_ES_EWAJS,J7.TraceLevel.Info,"ValuePreviewPlugin: ".concat(e))}function mFe(e){return[Y7.LCID.USA,Y7.LCID.British,Y7.LCID.CanadianEnglish].includes(e)}(0,G9r.registerPluginFactory)(new SFe);var $9r=(0,K9r.asyncLazy)(function(){return(0,Ay.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,Ay.__generator)(this,function(r){switch(r.label){case 0:return[4,lFe.workerThreadSpread.getValue()];case 1:return e=r.sent(),[4,e.createAndAttachPlugin(YE.PluginFactoryName.ValuePreviewPlugin)];case 2:return r.sent(),[4,lFe.schedulerWithRecalcServiceAttached.getValue()];case 3:return r.sent(),[2]}})})});TF.valuePreviewPluginDependenciesResolved=$9r});var Cc=Y(Kt=>{_();var gx=An();Object.defineProperty(Kt,"__esModule",{value:!0});Kt.ObjectRef=Kt.Lazy=Kt.Enumerator=Kt.Comparer=void 0;Kt.arrayHash=AFe;Kt.assertEqual=dKr;Kt.assertNotEqual=fKr;Kt.checkArity=LKr;Kt.clamp=EKr;Kt.clear=xKr;Kt.combineHashCodes=Zae;Kt.compare=eV;Kt.compareArrays=IFe;Kt.compareArraysWith=FFe;Kt.compareDates=eie;Kt.comparePrimitives=RKr;Kt.comparerFromEqualityComparer=cKr;Kt.count=DKr;Kt.createAtom=NKr;Kt.createObj=AKr;Kt.curry=wFe;Kt.dateHash=NFe;Kt.dateOffset=Jae;Kt.disposeSafe=oKr;Kt.equalArrays=kFe;Kt.equalArraysWith=OFe;Kt.equals=vx;Kt.escapeDataString=MKr;Kt.escapeUriString=wKr;Kt.fastStructuralHash=yKr;Kt.getEnumerator=sKr;Kt.identityHash=SKr;Kt.int16ToString=vKr;Kt.int32ToString=hKr;Kt.isArrayLike=JT;Kt.isDisposable=TFe;Kt.isIterable=nKr;Kt.jsOptions=OKr;Kt.lazyFromValue=pKr;Kt.mapCurriedArgs=qKr;Kt.max=PKr;Kt.min=bKr;Kt.numberHash=bF;Kt.padLeftAndRightWithZeros=gKr;Kt.padWithZeros=mKr;Kt.partialApply=BKr;Kt.physicalHash=EFe;Kt.round=kKr;Kt.safeHash=CKr;Kt.sameConstructor=uKr;Kt.sign=FKr;Kt.stringHash=$7;Kt.structuralHash=$ae;Kt.toIterator=lKr;Kt.uncurry=MFe;Kt.unescapeDataString=IKr;var eKr=gx(L_()),_Fe=gx(hb()),yFe=gx(V_()),X7=gx(at()),Z7=gx(it());function RFe(e,r){var n=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=rKr(e))||r&&e&&typeof e.length=="number"){n&&(e=n);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function rKr(e,r){if(e){if(typeof e=="string")return CFe(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CFe(e,r)}}function CFe(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,a=new Array(r);n<r;n++)a[n]=e[n];return a}function nKr(e){return e!=null&&typeof e=="object"&&Symbol.iterator in e}function JT(e){return Array.isArray(e)||ArrayBuffer.isView(e)}function tKr(e){return typeof e.Compare=="function"}function aKr(e){return typeof e.CompareTo=="function"}function iKr(e){return typeof e.Equals=="function"}function Xae(e){return typeof e.GetHashCode=="function"}function TFe(e){return e!=null&&typeof e.Dispose=="function"}function oKr(e){TFe(e)&&e.Dispose()}function uKr(e,r){var n,a;return((n=Object.getPrototypeOf(e))===null||n===void 0?void 0:n.constructor)===((a=Object.getPrototypeOf(r))===null||a===void 0?void 0:a.constructor)}var bFe=function(){function e(r){(0,X7.default)(this,e),this.iter=r}return(0,Z7.default)(e,[{key:"System.Collections.Generic.IEnumerator`1.get_Current",value:function(){return this.current}},{key:"System.Collections.IEnumerator.get_Current",value:function(){return this.current}},{key:"System.Collections.IEnumerator.MoveNext",value:function(){var n=this.iter.next();return this.current=n.value,!n.done}},{key:"System.Collections.IEnumerator.Reset",value:function(){throw new Error("JS iterators cannot be reset")}},{key:"Dispose",value:function(){}}]),e}();Kt.Enumerator=bFe;function sKr(e){return typeof e.GetEnumerator=="function"?e.GetEnumerator():new bFe(e[Symbol.iterator]())}function lKr(e){var r;return r={},(0,yFe.default)(r,Symbol.iterator,function(){return this}),(0,yFe.default)(r,"next",function(){var a=e["System.Collections.IEnumerator.MoveNext"](),o=a?e["System.Collections.IEnumerator.get_Current"]():void 0;return{done:!a,value:o}}),r}var Yae=(0,Z7.default)(function e(r){(0,X7.default)(this,e),this.Compare=r||eV});Kt.Comparer=Yae;function cKr(e){return tKr(e)?new Yae(e.Compare):new Yae(function(r,n){var a=e.GetHashCode(r),o=e.GetHashCode(n);return a===o?e.Equals(r,n)?0:-1:a<o?-1:1})}function dKr(e,r,n){if(!vx(e,r))throw(0,_Fe.default)(new Error(n||"Expected: "+r+" - Actual: "+e),{actual:e,expected:r})}function fKr(e,r,n){if(vx(e,r))throw(0,_Fe.default)(new Error(n||"Expected: "+r+" - Actual: "+e),{actual:e,expected:r})}var PFe=function(){function e(r){(0,X7.default)(this,e),this.factory=r,this.isValueCreated=!1}return(0,Z7.default)(e,[{key:"Value",get:function(){return this.isValueCreated||(this.createdValue=this.factory(),this.isValueCreated=!0),this.createdValue}},{key:"IsValueCreated",get:function(){return this.isValueCreated}}]),e}();Kt.Lazy=PFe;function pKr(e){return new PFe(function(){return e})}function mKr(e,r){for(var n=e.toString(10);n.length<r;)n="0"+n;return n}function gKr(e,r,n){for(var a=e.toString(10);a.length<r;)a="0"+a;for(;a.length<n;)a=a+"0";return a}function Jae(e){var r=e;return typeof r.offset=="number"?r.offset:e.kind===1?0:e.getTimezoneOffset()*-6e4}function vKr(e,r){return e=e<0&&r!=null&&r!==10?65535+e+1:e,e.toString(r)}function hKr(e,r){return e=e<0&&r!=null&&r!==10?4294967295+e+1:e,e.toString(r)}var PF=function(){function e(){(0,X7.default)(this,e)}return(0,Z7.default)(e,null,[{key:"id",value:function(n){return e.idMap.has(n)||e.idMap.set(n,++e.count),e.idMap.get(n)}}]),e}();Kt.ObjectRef=PF;PF.idMap=new WeakMap;PF.count=0;function $7(e){for(var r=0,n=5381,a=e.length;r<a;)n=n*33^e.charCodeAt(r++);return n}function bF(e){return e*2654435761|0}function Zae(e){return e.length===0?0:e.reduce(function(r,n){return(r<<5)+r^n})}function EFe(e){if(e==null)return 0;switch(typeof e){case"boolean":return e?1:0;case"number":return bF(e);case"string":return $7(e);default:return bF(PF.id(e))}}function SKr(e){return e==null?0:Xae(e)?e.GetHashCode():EFe(e)}function NFe(e){return e.getTime()}function AFe(e){for(var r=e.length,n=new Array(r),a=0;a<r;a++)n[a]=$ae(e[a]);return Zae(n)}function $ae(e){var r;if(e==null)return 0;switch(typeof e){case"boolean":return e?1:0;case"number":return bF(e);case"string":return $7(e);default:{if(Xae(e))return e.GetHashCode();if(JT(e))return AFe(e);if(e instanceof Date)return NFe(e);if(((r=Object.getPrototypeOf(e))===null||r===void 0?void 0:r.constructor)===Object){var n=Object.values(e).map(function(a){return $ae(a)});return Zae(n)}else return bF(PF.id(e))}}}function yKr(e){return $7(String(e))}function CKr(e){return e==null?0:Xae(e)?e.GetHashCode():bF(PF.id(e))}function OFe(e,r,n){if(e==null)return r==null;if(r==null||e.length!==r.length)return!1;for(var a=0;a<e.length;a++)if(!n(e[a],r[a]))return!1;return!0}function kFe(e,r){return OFe(e,r,vx)}function _Kr(e,r){var n=Object.keys(e),a=Object.keys(r);if(n.length!==a.length)return!1;n.sort(),a.sort();for(var o=0;o<n.length;o++)if(n[o]!==a[o]||!vx(e[n[o]],r[a[o]]))return!1;return!0}function vx(e,r){var n;return e===r?!0:e==null?r==null:r==null||typeof e!="object"?!1:iKr(e)?e.Equals(r):JT(e)?JT(r)&&kFe(e,r):e instanceof Date?r instanceof Date&&eie(e,r)===0:((n=Object.getPrototypeOf(e))===null||n===void 0?void 0:n.constructor)===Object&&_Kr(e,r)}function eie(e,r){var n,a;return"offset"in e&&"offset"in r?(n=e.getTime(),a=r.getTime()):(n=e.getTime()+Jae(e),a=r.getTime()+Jae(r)),n===a?0:n<a?-1:1}function RKr(e,r){return e===r?0:e<r?-1:1}function FFe(e,r,n){if(e==null)return r==null?0:1;if(r==null)return-1;if(e.length!==r.length)return e.length<r.length?-1:1;for(var a=0,o=0;a<e.length;a++)if(o=n(e[a],r[a]),o!==0)return o;return 0}function IFe(e,r){return FFe(e,r,eV)}function TKr(e,r){var n=Object.keys(e),a=Object.keys(r);if(n.length!==a.length)return n.length<a.length?-1:1;n.sort(),a.sort();for(var o=0,u=0;o<n.length;o++){var t=n[o];if(t!==a[o])return t<a[o]?-1:1;if(u=eV(e[t],r[t]),u!==0)return u}return 0}function eV(e,r){var n;return e===r?0:e==null?r==null?0:-1:r==null?1:typeof e!="object"?e<r?-1:1:aKr(e)?e.CompareTo(r):JT(e)?JT(r)?IFe(e,r):-1:e instanceof Date?r instanceof Date?eie(e,r):-1:((n=Object.getPrototypeOf(e))===null||n===void 0?void 0:n.constructor)===Object?TKr(e,r):-1}function bKr(e,r,n){return e(r,n)<0?r:n}function PKr(e,r,n){return e(r,n)>0?r:n}function EKr(e,r,n,a){return e(r,n)<0?n:e(r,a)>0?a:r}function NKr(e){var r=e;return function(n,a){if(a){r=n;return}else return r}}function AKr(e){for(var r={},n=RFe(e),a;!(a=n()).done;){var o=a.value;r[o[0]]=o[1]}return r}function OKr(e){var r={};return e(r),r}function kKr(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=Math.pow(10,r),a=+(r?e*n:e).toFixed(8),o=Math.floor(a),u=a-o,t=1e-8,d=u>.49999999&&u<.50000001?o%2===0?o:o+1:Math.round(a);return r?d/n:d}function FKr(e){return e>0?1:e<0?-1:0}function IKr(e){return decodeURIComponent(e.replace(/\+/g,"%20"))}function MKr(e){return encodeURIComponent(e).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A")}function wKr(e){return encodeURI(e)}function DKr(e){if(JT(e))return e.length;for(var r=0,n=RFe(e),a;!(a=n()).done;){var o=a.value;r++}return r}function xKr(e){JT(e)?e.splice(0):e.clear()}var mx=Symbol("curried");function MFe(e,r){if(r==null||r.length>1)return r;var n=function(){for(var o=r,u=0;u<e;u++)o=o(u<0||arguments.length<=u?void 0:arguments[u]);return o};return n[mx]=r,n}function rie(e,r,n){return function(a){return r===1?n.apply(void 0,(0,eKr.default)(e.concat([a]))):rie(e.concat([a]),r-1,n)}}function wFe(e,r){return r==null||r.length===1?r:mx in r?r[mx]:rie([],e,r)}function LKr(e,r){return r.length>e?function(){for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return function(){for(var u=arguments.length,t=new Array(u),d=0;d<u;d++)t[d]=arguments[d];return r.apply(void 0,a.concat(t))}}:r}function BKr(e,r,n){if(r!=null)if(mx in r){r=r[mx];for(var a=0;a<n.length;a++)r=r(n[a]);return r}else return rie(n,e,r)}function qKr(e,r){function n(a,o,u,t){var d=u[t];if(d!==0){var s=d[0],c=d[1];s>1&&(o=wFe(s,o)),c>1&&(o=MFe(c,o))}var l=a(o);return t+1===u.length?l:function(f){return n(l,f,u,t+1)}}return function(a){return n(e,a,r,0)}}});var Uc=Y(qc=>{_();var EF=An();Object.defineProperty(qc,"__esModule",{value:!0});qc.Union=qc.Record=qc.MatchFailureException=qc.FSharpRef=qc.FSharpException=qc.Exception=qc.Attribute=void 0;qc.ensureErrorOrException=QKr;qc.isException=QFe;qc.seqToString=UFe;qc.toString=JE;qc.unionToString=GFe;var LFe=EF(Qf()),UKr=EF(zf()),DFe=EF(Ed()),XE=EF(at()),ZE=EF(it()),BFe=EF(GS()),Ug=Cc();function qFe(e){var r=GKr();return function(){var a=(0,DFe.default)(e),o;if(r){var u=(0,DFe.default)(this).constructor;o=Reflect.construct(a,arguments,u)}else o=a.apply(this,arguments);return(0,UKr.default)(this,o)}}function GKr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function KKr(e,r){var n=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=VKr(e))||r&&e&&typeof e.length=="number"){n&&(e=n);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function VKr(e,r){if(e){if(typeof e=="string")return xFe(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xFe(e,r)}}function xFe(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,a=new Array(r);n<r;n++)a[n]=e[n];return a}function UFe(e){for(var r=0,n="[",a=KKr(e),o;!(o=a()).done;){var u=o.value;if(r===0)n+=JE(u);else if(r===100){n+="; ...";break}else n+="; "+JE(u);r++}return n+"]"}function JE(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n,a;if(e!=null&&typeof e=="object"){if(typeof e.toString=="function")return e.toString();if(Symbol.iterator in e)return UFe(e);var o=(n=Object.getPrototypeOf(e))===null||n===void 0?void 0:n.constructor;return o===Object&&r<10?"{ "+Object.entries(e).map(function(u){var t=(0,BFe.default)(u,2),d=t[0],s=t[1];return d+" = "+JE(s,r+1)}).join("\n  ")+" }":(a=o==null?void 0:o.name)!==null&&a!==void 0?a:""}return String(e)}function GFe(e,r){if(r.length===0)return e;var n="",a=!0;return r.length===1?(n=JE(r[0]),a=n.indexOf(" ")>=0):n=r.map(function(o){return JE(o)}).join(", "),e+(a?" (":" ")+n+(a?")":"")}var WKr=function(){function e(){(0,XE.default)(this,e)}return(0,ZE.default)(e,[{key:"name",get:function(){return this.cases()[this.tag]}},{key:"toJSON",value:function(){return this.fields.length===0?this.name:[this.name].concat(this.fields)}},{key:"toString",value:function(){return GFe(this.name,this.fields)}},{key:"GetHashCode",value:function(){var n=this.fields.map(function(a){return(0,Ug.structuralHash)(a)});return n.splice(0,0,(0,Ug.numberHash)(this.tag)),(0,Ug.combineHashCodes)(n)}},{key:"Equals",value:function(n){return this===n?!0:(0,Ug.sameConstructor)(this,n)&&this.tag===n.tag?(0,Ug.equalArrays)(this.fields,n.fields):!1}},{key:"CompareTo",value:function(n){return this===n?0:(0,Ug.sameConstructor)(this,n)?this.tag===n.tag?(0,Ug.compareArrays)(this.fields,n.fields):this.tag<n.tag?-1:1:-1}}]),e}();qc.Union=WKr;function KFe(e){for(var r={},n=Object.keys(e),a=0;a<n.length;a++)r[n[a]]=e[n[a]];return r}function VFe(e){return"{ "+Object.entries(e).map(function(r){var n=(0,BFe.default)(r,2),a=n[0],o=n[1];return a+" = "+JE(o)}).join("\n  ")+" }"}function WFe(e){var r=Object.values(e).map(function(n){return(0,Ug.structuralHash)(n)});return(0,Ug.combineHashCodes)(r)}function jFe(e,r){if(e===r)return!0;if((0,Ug.sameConstructor)(e,r)){for(var n=Object.keys(e),a=0;a<n.length;a++)if(!(0,Ug.equals)(e[n[a]],r[n[a]]))return!1;return!0}else return!1}function HFe(e,r){if(e===r)return 0;if((0,Ug.sameConstructor)(e,r)){for(var n=Object.keys(e),a=0;a<n.length;a++){var o=(0,Ug.compare)(e[n[a]],r[n[a]]);if(o!==0)return o}return 0}else return-1}var jKr=function(){function e(){(0,XE.default)(this,e)}return(0,ZE.default)(e,[{key:"toJSON",value:function(){return KFe(this)}},{key:"toString",value:function(){return VFe(this)}},{key:"GetHashCode",value:function(){return WFe(this)}},{key:"Equals",value:function(n){return jFe(this,n)}},{key:"CompareTo",value:function(n){return HFe(this,n)}}]),e}();qc.Record=jKr;var HKr=function(){function e(r,n){(0,XE.default)(this,e),typeof n=="function"?(this.getter=r,this.setter=n):(this.getter=function(){return r},this.setter=function(a){r=a})}return(0,ZE.default)(e,[{key:"contents",get:function(){return this.getter()},set:function(n){this.setter(n)}}]),e}();qc.FSharpRef=HKr;var nie=(0,ZE.default)(function e(r){(0,XE.default)(this,e),this.message=r});qc.Exception=nie;function QFe(e){return e instanceof nie||e instanceof Error}function QKr(e){return QFe(e)?e:new Error(String(e))}var zFe=function(e){(0,LFe.default)(n,e);var r=qFe(n);function n(){return(0,XE.default)(this,n),r.apply(this,arguments)}return(0,ZE.default)(n,[{key:"toJSON",value:function(){return KFe(this)}},{key:"toString",value:function(){return VFe(this)}},{key:"GetHashCode",value:function(){return WFe(this)}},{key:"Equals",value:function(o){return jFe(this,o)}},{key:"CompareTo",value:function(o){return HFe(this,o)}}]),n}(nie);qc.FSharpException=zFe;var zKr=function(e){(0,LFe.default)(n,e);var r=qFe(n);function n(a,o,u){var t;return(0,XE.default)(this,n),t=r.call(this),t.arg1=a,t.arg2=o|0,t.arg3=u|0,t.message="The match cases were incomplete",t}return(0,ZE.default)(n)}(zFe);qc.MatchFailureException=zKr;var YKr=(0,ZE.default)(function e(){(0,XE.default)(this,e)});qc.Attribute=YKr});var Oy=Y(XT=>{_();Object.defineProperty(XT,"__esModule",{value:!0});XT.addToDict=a8r;XT.addToSet=t8r;XT.containsValue=r8r;XT.getItemFromDict=i8r;XT.keyValueList=e8r;XT.tryGetValue=n8r;var JKr=Cc(),XKr=Uc();function JFe(e,r){var n=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=ZKr(e))||r&&e&&typeof e.length=="number"){n&&(e=n);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ZKr(e,r){if(e){if(typeof e=="string")return YFe(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return YFe(e,r)}}function YFe(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,a=new Array(r);n<r;n++)a[n]=e[n];return a}var $E={None:0,LowerFirst:1,SnakeCase:2,SnakeCaseAllCaps:3,KebabCase:4};function tie(e,r){return e.replace(/[a-z]?[A-Z]/g,function(n){return n.length===1?n.toLowerCase():n.charAt(0)+r+n.charAt(1).toLowerCase()})}function $Kr(e,r){switch(r){case $E.LowerFirst:return e.charAt(0).toLowerCase()+e.slice(1);case $E.SnakeCase:return tie(e,"_");case $E.SnakeCaseAllCaps:return tie(e,"_").toUpperCase();case $E.KebabCase:return tie(e,"-");case $E.None:default:return e}}function e8r(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$E.None,n={},a=r;function o(p){throw new Error("Cannot infer key and value of "+String(p))}function u(p,m,v){p=$Kr(p,m),n[p]=v}for(var t=JFe(e),d;!(d=t()).done;){var s=d.value,c=$E.None;if(s==null&&o(s),s instanceof XKr.Union){var l=s.cases()[s.tag];s=s.fields.length===0?l:[l].concat(s.fields),c=a}if(Array.isArray(s))switch(s.length){case 0:o(s);break;case 1:u(s[0],c,!0);break;case 2:var f=s[1];u(s[0],c,f);break;default:u(s[0],c,s.slice(1))}else typeof s=="string"?u(s,c,!0):o(s)}return n}function r8r(e,r){for(var n=JFe(r),a;!(a=n()).done;){var o=a.value;if((0,JKr.equals)(e,o[1]))return!0}return!1}function n8r(e,r,n){return e.has(r)?(n.contents=e.get(r),!0):!1}function t8r(e,r){return r.has(e)?!1:(r.add(e),!0)}function a8r(e,r,n){if(e.has(r))throw new Error("An item with the same key has already been added. Key: "+r);e.set(r,n)}function i8r(e,r){if(e.has(r))return e.get(r);throw new Error("The given key '"+r+"' was not present in the dictionary.")}});var eIe=Y(fh=>{_();var o8r=An();Object.defineProperty(fh,"__esModule",{value:!0});fh.NumberStyles=void 0;fh.divRem=m8r;fh.isValid=ZFe;fh.op_UnaryNegation_Int16=f8r;fh.op_UnaryNegation_Int32=p8r;fh.op_UnaryNegation_Int8=d8r;fh.parse=$Fe;fh.tryParse=c8r;var rV=o8r(GS()),nV;fh.NumberStyles=nV;(function(e){e[e.AllowHexSpecifier=512]="AllowHexSpecifier"})(nV||(fh.NumberStyles=nV={}));function u8r(e,r){var n=(0,rV.default)(e,4),a=n[1],o=n[2],u=n[3];return{sign:a||"",prefix:o||"",digits:u,radix:r}}function XFe(e,r){switch(r){case 8:return e?[0,255]:[-128,127];case 16:return e?[0,65535]:[-32768,32767];case 32:return e?[0,4294967295]:[-2147483648,2147483647];default:throw new Error("Invalid bit size.")}}function s8r(e){switch(e){case 2:return/[^0-1]/;case 8:return/[^0-7]/;case 10:return/[^0-9]/;case 16:return/[^0-9a-fA-F]/;default:throw new Error("Invalid Base.")}}function l8r(e,r){if(r&nV.AllowHexSpecifier)return 16;switch(e){case"0b":case"0B":return 2;case"0o":case"0O":return 8;case"0x":case"0X":return 16;default:return 10}}function ZFe(e,r,n){var a=/^\s*([\+\-])?(0[xXoObB])?([0-9a-fA-F]+)\s*$/,o=a.exec(e.replace(/_/g,""));if(o!=null){var u=(0,rV.default)(o,4),t=u[2],d=u[3];n=n||l8r(t,r);var s=s8r(n);if(!s.test(d))return u8r(o,n)}return null}function $Fe(e,r,n,a,o){var u=ZFe(e,r,o);if(u!=null){var t=Number.parseInt(u.sign+u.digits,u.radix);if(!Number.isNaN(t)){var d=XFe(!0,a),s=(0,rV.default)(d,2),c=s[0],l=s[1];!n&&u.radix!==10&&t>=c&&t<=l&&(t=t<<32-a>>32-a);var f=XFe(n,a),p=(0,rV.default)(f,2),m=p[0],v=p[1];if(t>=m&&t<=v)return t}}throw new Error("Input string was not in a correct format.")}function c8r(e,r,n,a,o){try{return o.contents=$Fe(e,r,n,a),!0}catch(u){return!1}}function d8r(e){return e===-128?e:-e}function f8r(e){return e===-32768?e:-e}function p8r(e){return e===-2147483648?e:-e}function m8r(e,r,n){var a=~~(e/r),o=e%r;return n!=null?(n.contents=o,a):[a,o]}});var tV=Y(TS=>{_();Object.defineProperty(TS,"__esModule",{value:!0});TS.compare=v8r;TS.isNumeric=g8r;TS.multiply=h8r;TS.symbol=void 0;TS.toExponential=C8r;TS.toFixed=S8r;TS.toHex=_8r;TS.toPrecision=y8r;var eN=Symbol("numeric");TS.symbol=eN;function g8r(e){return typeof e=="number"||(e==null?void 0:e[eN])}function v8r(e,r){return typeof e=="number"?e<r?-1:e>r?1:0:e.CompareTo(r)}function h8r(e,r){return typeof e=="number"?e*r:e[eN]().multiply(r)}function S8r(e,r){return typeof e=="number"?e.toFixed(r):e[eN]().toFixed(r)}function y8r(e,r){return typeof e=="number"?e.toPrecision(r):e[eN]().toPrecision(r)}function C8r(e,r){return typeof e=="number"?e.toExponential(r):e[eN]().toExponential(r)}function _8r(e){return typeof e=="number"?(Number(e)>>>0).toString(16):e[eN]().toHex()}});var _Ie=Y(ot=>{_();Object.defineProperty(ot,"__esModule",{value:!0});ot.Long=vh;ot.ZERO=ot.UZERO=ot.UONE=ot.ONE=ot.NEG_ONE=ot.MIN_VALUE=ot.MAX_VALUE=ot.MAX_UNSIGNED_VALUE=void 0;ot.add=rN;ot.and=w8r;ot.compare=kF;ot.divide=b_;ot.equals=K0;ot.fromBits=Xo;ot.fromBytes=SIe;ot.fromBytesBE=CIe;ot.fromBytesLE=yIe;ot.fromInt=tN;ot.fromNumber=mh;ot.fromString=uie;ot.fromValue=bS;ot.getHighBits=P8r;ot.getHighBitsUnsigned=E8r;ot.getLowBits=N8r;ot.getLowBitsUnsigned=A8r;ot.getNumBitsAbs=sIe;ot.greaterThan=aV;ot.greaterThanOrEqual=lIe;ot.isEven=k8r;ot.isLong=l0;ot.isNegative=Vm;ot.isOdd=iie;ot.isPositive=O8r;ot.isZero=ZT;ot.lessThan=oie;ot.lessThanOrEqual=I8r;ot.modulo=M8r;ot.multiply=Gg;ot.negate=Bf;ot.not=cIe;ot.notEquals=F8r;ot.or=D8r;ot.rotateRight=ot.rotateLeft=void 0;ot.shiftLeft=dIe;ot.shiftRight=fIe;ot.shiftRightUnsigned=pIe;ot.subtract=nN;ot.toBytes=gIe;ot.toBytesBE=hIe;ot.toBytesLE=vIe;ot.toInt=AF;ot.toNumber=hx;ot.toSigned=q8r;ot.toString=OF;ot.toUnsigned=mIe;ot.xor=x8r;var R8r=tV(),ph=null;try{ph=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function vh(e,r,n){this.low=e|0,this.high=r|0,this.unsigned=!!n}vh.prototype.GetHashCode=function(){var e=this.unsigned?1:0;return e=(e<<5)+e^this.high,e=(e<<5)+e^this.low,e};vh.prototype.Equals=function(e){return K0(this,e)};vh.prototype.CompareTo=function(e){return kF(this,e)};vh.prototype.toString=function(e){return OF(this,e)};vh.prototype.toJSON=function(){return OF(this)};vh.prototype[R8r.symbol]=function(){var e=this;return{multiply:function(n){return Gg(e,n)},toPrecision:function(n){return String(e)+0 .toPrecision(n).substr(1)},toExponential:function(n){return String(e)+0 .toExponential(n).substr(1)},toFixed:function(n){return String(e)+0 .toFixed(n).substr(1)},toHex:function(){return OF(e.unsigned?e:SIe(gIe(e),!0),16)}}};vh.prototype.__isLong__;Object.defineProperty(vh.prototype,"__isLong__",{value:!0});function l0(e){return(e&&e.__isLong__)===!0}var rIe={},nIe={};function tN(e,r){var n,a,o;return r?(e>>>=0,(o=0<=e&&e<256)&&(a=nIe[e],a)?a:(n=Xo(e,(e|0)<0?-1:0,!0),o&&(nIe[e]=n),n)):(e|=0,(o=-128<=e&&e<128)&&(a=rIe[e],a)?a:(n=Xo(e,e<0?-1:0,!1),o&&(rIe[e]=n),n))}function mh(e,r){if(isNaN(e))return r?P_:gh;if(r){if(e<0)return P_;if(e>=b8r)return uIe}else{if(e<=-tIe)return Wm;if(e+1>=tIe)return oIe}return e<0?Bf(mh(-e,r)):Xo(e%oV|0,e/oV|0,r)}function Xo(e,r,n){return new vh(e,r,n)}var iV=Math.pow;function uie(e,r,n){if(e.length===0)throw Error("empty string");if(e==="NaN"||e==="Infinity"||e==="+Infinity"||e==="-Infinity")return gh;if(typeof r=="number"?(n=r,r=!1):r=!!r,n=n||10,n<2||36<n)throw RangeError("radix");var a=e.indexOf("-");if(a>0)throw Error("interior hyphen");if(a===0)return Bf(uie(e.substring(1),r,n));for(var o=mh(iV(n,8)),u=gh,t=0;t<e.length;t+=8){var d=Math.min(8,e.length-t),s=parseInt(e.substring(t,t+d),n);if(d<8){var c=mh(iV(n,d));u=rN(Gg(u,c),mh(s))}else u=Gg(u,o),u=rN(u,mh(s))}return u.unsigned=r,u}function bS(e,r){return typeof e=="number"?mh(e,r):typeof e=="string"?uie(e,r):Xo(e.low,e.high,typeof r=="boolean"?r:e.unsigned)}var T8r=16777216,oV=4294967296,b8r=18446744073709552e3,tIe=9223372036854776e3,aIe=tN(T8r),gh=tN(0);ot.ZERO=gh;var P_=tN(0,!0);ot.UZERO=P_;var NF=tN(1);ot.ONE=NF;var iIe=tN(1,!0);ot.UONE=iIe;var aie=tN(-1);ot.NEG_ONE=aie;var oIe=Xo(-1,2147483647,!1);ot.MAX_VALUE=oIe;var uIe=Xo(-1,-1,!0);ot.MAX_UNSIGNED_VALUE=uIe;var Wm=Xo(0,-2147483648,!1);ot.MIN_VALUE=Wm;function AF(e){return e.unsigned?e.low>>>0:e.low}function hx(e){return e.unsigned?(e.high>>>0)*oV+(e.low>>>0):e.high*oV+(e.low>>>0)}function OF(e,r){if(r=r||10,r<2||36<r)throw RangeError("radix");if(ZT(e))return"0";if(Vm(e))if(K0(e,Wm)){var n=mh(r),a=b_(e,n),o=nN(Gg(a,n),e);return OF(a,r)+AF(o).toString(r)}else return"-"+OF(Bf(e),r);for(var u=mh(iV(r,6),e.unsigned),t=e,d="";;){var s=b_(t,u),c=AF(nN(t,Gg(s,u)))>>>0,l=c.toString(r);if(t=s,ZT(t))return l+d;for(;l.length<6;)l="0"+l;d=""+l+d}}function P8r(e){return e.high}function E8r(e){return e.high>>>0}function N8r(e){return e.low}function A8r(e){return e.low>>>0}function sIe(e){if(Vm(e))return K0(e,Wm)?64:sIe(Bf(e));for(var r=e.high!=0?e.high:e.low,n=31;n>0&&!(r&1<<n);n--);return e.high!=0?n+33:n+1}function ZT(e){return e.high===0&&e.low===0}function Vm(e){return!e.unsigned&&e.high<0}function O8r(e){return e.unsigned||e.high>=0}function iie(e){return(e.low&1)===1}function k8r(e){return(e.low&1)===0}function K0(e,r){return l0(r)||(r=bS(r)),e.unsigned!==r.unsigned&&e.high>>>31===1&&r.high>>>31===1?!1:e.high===r.high&&e.low===r.low}function F8r(e,r){return!K0(e,r)}function oie(e,r){return kF(e,r)<0}function I8r(e,r){return kF(e,r)<=0}function aV(e,r){return kF(e,r)>0}function lIe(e,r){return kF(e,r)>=0}function kF(e,r){if(l0(r)||(r=bS(r)),K0(e,r))return 0;var n=Vm(e),a=Vm(r);return n&&!a?-1:!n&&a?1:e.unsigned?r.high>>>0>e.high>>>0||r.high===e.high&&r.low>>>0>e.low>>>0?-1:1:Vm(nN(e,r))?-1:1}function Bf(e){return!e.unsigned&&K0(e,Wm)?Wm:rN(cIe(e),NF)}function rN(e,r){l0(r)||(r=bS(r));var n=e.high>>>16,a=e.high&65535,o=e.low>>>16,u=e.low&65535,t=r.high>>>16,d=r.high&65535,s=r.low>>>16,c=r.low&65535,l=0,f=0,p=0,m=0;return m+=u+c,p+=m>>>16,m&=65535,p+=o+s,f+=p>>>16,p&=65535,f+=a+d,l+=f>>>16,f&=65535,l+=n+t,l&=65535,Xo(p<<16|m,l<<16|f,e.unsigned)}function nN(e,r){return l0(r)||(r=bS(r)),rN(e,Bf(r))}function Gg(e,r){if(ZT(e))return e.unsigned?P_:gh;if(l0(r)||(r=bS(r)),ph){var n=ph.mul(e.low,e.high,r.low,r.high);return Xo(n,ph.get_high(),e.unsigned)}if(ZT(r))return e.unsigned?P_:gh;if(K0(e,Wm))return iie(r)?Wm:gh;if(K0(r,Wm))return iie(e)?Wm:gh;if(Vm(e))return Vm(r)?Gg(Bf(e),Bf(r)):Bf(Gg(Bf(e),r));if(Vm(r))return Bf(Gg(e,Bf(r)));if(oie(e,aIe)&&oie(r,aIe))return mh(hx(e)*hx(r),e.unsigned);var a=e.high>>>16,o=e.high&65535,u=e.low>>>16,t=e.low&65535,d=r.high>>>16,s=r.high&65535,c=r.low>>>16,l=r.low&65535,f=0,p=0,m=0,v=0;return v+=t*l,m+=v>>>16,v&=65535,m+=u*l,p+=m>>>16,m&=65535,m+=t*c,p+=m>>>16,m&=65535,p+=o*l,f+=p>>>16,p&=65535,p+=u*c,f+=p>>>16,p&=65535,p+=t*s,f+=p>>>16,p&=65535,f+=a*l+o*c+u*s+t*d,f&=65535,Xo(m<<16|v,f<<16|p,e.unsigned)}function b_(e,r){if(l0(r)||(r=bS(r)),ZT(r))throw Error("division by zero");if(ph){if(!e.unsigned&&e.high===-2147483648&&r.low===-1&&r.high===-1)return e;var n=(e.unsigned?ph.div_u:ph.div_s)(e.low,e.high,r.low,r.high);return Xo(n,ph.get_high(),e.unsigned)}if(ZT(e))return e.unsigned?P_:gh;var a,o,u;if(e.unsigned){if(r.unsigned||(r=mIe(r)),aV(r,e))return P_;if(aV(r,pIe(e,1)))return iIe;u=P_}else{if(K0(e,Wm)){if(K0(r,NF)||K0(r,aie))return Wm;if(K0(r,Wm))return NF;var t=fIe(e,1);return a=dIe(b_(t,r),1),K0(a,gh)?Vm(r)?NF:aie:(o=nN(e,Gg(r,a)),u=rN(a,b_(o,r)),u)}else if(K0(r,Wm))return e.unsigned?P_:gh;if(Vm(e))return Vm(r)?b_(Bf(e),Bf(r)):Bf(b_(Bf(e),r));if(Vm(r))return Bf(b_(e,Bf(r)));u=gh}for(o=e;lIe(o,r);){a=Math.max(1,Math.floor(hx(o)/hx(r)));for(var d=Math.ceil(Math.log(a)/Math.LN2),s=d<=48?1:iV(2,d-48),c=mh(a),l=Gg(c,r);Vm(l)||aV(l,o);)a-=s,c=mh(a,e.unsigned),l=Gg(c,r);ZT(c)&&(c=NF),u=rN(u,c),o=nN(o,l)}return u}function M8r(e,r){if(l0(r)||(r=bS(r)),ph){var n=(e.unsigned?ph.rem_u:ph.rem_s)(e.low,e.high,r.low,r.high);return Xo(n,ph.get_high(),e.unsigned)}return nN(e,Gg(b_(e,r),r))}function cIe(e){return Xo(~e.low,~e.high,e.unsigned)}function w8r(e,r){return l0(r)||(r=bS(r)),Xo(e.low&r.low,e.high&r.high,e.unsigned)}function D8r(e,r){return l0(r)||(r=bS(r)),Xo(e.low|r.low,e.high|r.high,e.unsigned)}function x8r(e,r){return l0(r)||(r=bS(r)),Xo(e.low^r.low,e.high^r.high,e.unsigned)}function dIe(e,r){return l0(r)&&(r=AF(r)),(r&=63)===0?e:r<32?Xo(e.low<<r,e.high<<r|e.low>>>32-r,e.unsigned):Xo(0,e.low<<r-32,e.unsigned)}function fIe(e,r){return l0(r)&&(r=AF(r)),(r&=63)===0?e:r<32?Xo(e.low>>>r|e.high<<32-r,e.high>>r,e.unsigned):Xo(e.high>>r-32,e.high>=0?0:-1,e.unsigned)}function pIe(e,r){if(l0(r)&&(r=AF(r)),r&=63,r===0)return e;var n=e.high;if(r<32){var a=e.low;return Xo(a>>>r|n<<32-r,n>>>r,e.unsigned)}else return Xo(r===32?n:n>>>r-32,0,e.unsigned)}var L8r=function(r){var n;return l0(r)&&(r=r.toInt()),(r&=63)===0?this:r===32?Xo(this.high,this.low,this.unsigned):r<32?(n=32-r,Xo(this.low<<r|this.high>>>n,this.high<<r|this.low>>>n,this.unsigned)):(r-=32,n=32-r,Xo(this.high<<r|this.low>>>n,this.low<<r|this.high>>>n,this.unsigned))};ot.rotateLeft=L8r;var B8r=function(r){var n;return l0(r)&&(r=r.toInt()),(r&=63)===0?this:r===32?Xo(this.high,this.low,this.unsigned):r<32?(n=32-r,Xo(this.high<<n|this.low>>>r,this.low<<n|this.high>>>r,this.unsigned)):(r-=32,n=32-r,Xo(this.low<<n|this.high>>>r,this.high<<n|this.low>>>r,this.unsigned))};ot.rotateRight=B8r;function q8r(e){return e.unsigned?Xo(e.low,e.high,!1):e}function mIe(e){return e.unsigned?e:Xo(e.low,e.high,!0)}function gIe(e,r){return r?vIe(e):hIe(e)}function vIe(e){var r=e.high,n=e.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,r&255,r>>>8&255,r>>>16&255,r>>>24]}function hIe(e){var r=e.high,n=e.low;return[r>>>24,r>>>16&255,r>>>8&255,r&255,n>>>24,n>>>16&255,n>>>8&255,n&255]}function SIe(e,r,n){return n?yIe(e,r):CIe(e,r)}function yIe(e,r){return new vh(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,r)}function CIe(e,r){return new vh(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],r)}});var cie=Y(Fn=>{_();Object.defineProperty(Fn,"__esModule",{value:!0});Fn.abs=_7r;Fn.default=Fn.compare=void 0;Fn.divRem=E7r;Fn.fromInt=Fn.fromBytes=Fn.fromBits=Fn.equals=void 0;Fn.fromInteger=R7r;Fn.op_UnaryNegation=Fn.op_Subtraction=Fn.op_RightShiftUnsigned=Fn.op_RightShift=Fn.op_Multiply=Fn.op_Modulus=Fn.op_LogicalNot=Fn.op_LessThanOrEqual=Fn.op_LessThan=Fn.op_LeftShift=Fn.op_Inequality=Fn.op_GreaterThanOrEqual=Fn.op_GreaterThan=Fn.op_ExclusiveOr=Fn.op_Equality=Fn.op_Division=Fn.op_BitwiseOr=Fn.op_BitwiseAnd=Fn.op_Addition=Fn.get_Zero=Fn.get_One=Fn.getLowBitsUnsigned=Fn.getLowBits=Fn.getHighBitsUnsigned=Fn.getHighBits=Fn.fromValue=Fn.fromString=Fn.fromNumber=void 0;Fn.parse=NIe;Fn.ticksToUnixEpochMilliseconds=P7r;Fn.toString=Fn.toNumber=Fn.toInt=Fn.toBytes=void 0;Fn.tryParse=T7r;Fn.unixEpochMillisecondsToTicks=b7r;var U8r=eIe(),Ei=G8r(_Ie());function RIe(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,n=new WeakMap;return(RIe=function(o){return o?n:r})(e)}function G8r(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var n=RIe(r);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(u!=="default"&&Object.prototype.hasOwnProperty.call(e,u)){var t=o?Object.getOwnPropertyDescriptor(e,u):null;t&&(t.get||t.set)?Object.defineProperty(a,u,t):a[u]=e[u]}return a.default=e,n&&n.set(e,a),a}var K8r=Ei.Long;Fn.default=K8r;var V8r=Ei.ZERO;Fn.get_Zero=V8r;var W8r=Ei.ONE;Fn.get_One=W8r;var sie=Ei.add;Fn.op_Addition=sie;var TIe=Ei.subtract;Fn.op_Subtraction=TIe;var bIe=Ei.multiply;Fn.op_Multiply=bIe;var lie=Ei.divide;Fn.op_Division=lie;var PIe=Ei.modulo;Fn.op_Modulus=PIe;var EIe=Ei.negate;Fn.op_UnaryNegation=EIe;var j8r=Ei.shiftLeft;Fn.op_LeftShift=j8r;var H8r=Ei.shiftRight;Fn.op_RightShift=H8r;var Q8r=Ei.shiftRightUnsigned;Fn.op_RightShiftUnsigned=Q8r;var z8r=Ei.and;Fn.op_BitwiseAnd=z8r;var Y8r=Ei.or;Fn.op_BitwiseOr=Y8r;var J8r=Ei.xor;Fn.op_ExclusiveOr=J8r;var X8r=Ei.not;Fn.op_LogicalNot=X8r;var Z8r=Ei.lessThan;Fn.op_LessThan=Z8r;var $8r=Ei.lessThanOrEqual;Fn.op_LessThanOrEqual=$8r;var e7r=Ei.greaterThan;Fn.op_GreaterThan=e7r;var r7r=Ei.greaterThanOrEqual;Fn.op_GreaterThanOrEqual=r7r;var n7r=Ei.equals;Fn.op_Equality=n7r;var t7r=Ei.notEquals;Fn.op_Inequality=t7r;var a7r=Ei.equals;Fn.equals=a7r;var i7r=Ei.compare;Fn.compare=i7r;var o7r=Ei.fromInt;Fn.fromInt=o7r;var u7r=Ei.fromBits;Fn.fromBits=u7r;var s7r=Ei.fromBytes;Fn.fromBytes=s7r;var l7r=Ei.fromNumber;Fn.fromNumber=l7r;var c7r=Ei.fromString;Fn.fromString=c7r;var d7r=Ei.fromValue;Fn.fromValue=d7r;var f7r=Ei.toInt;Fn.toInt=f7r;var p7r=Ei.toBytes;Fn.toBytes=p7r;var m7r=Ei.toNumber;Fn.toNumber=m7r;var g7r=Ei.toString;Fn.toString=g7r;var v7r=Ei.getLowBits;Fn.getLowBits=v7r;var h7r=Ei.getHighBits;Fn.getHighBits=h7r;var S7r=Ei.getLowBitsUnsigned;Fn.getLowBitsUnsigned=S7r;var y7r=Ei.getHighBitsUnsigned;Fn.getHighBitsUnsigned=y7r;function C7r(e,r,n){switch(r){case 2:return e?"1111111111111111111111111111111111111111111111111111111111111111":n?"1000000000000000000000000000000000000000000000000000000000000000":"111111111111111111111111111111111111111111111111111111111111111";case 8:return e?"1777777777777777777777":n?"1000000000000000000000":"777777777777777777777";case 10:return e?"18446744073709551615":n?"9223372036854775808":"9223372036854775807";case 16:return e?"FFFFFFFFFFFFFFFF":n?"8000000000000000":"7FFFFFFFFFFFFFFF";default:throw new Error("Invalid radix.")}}function _7r(e){return!e.unsigned&&Ei.isNegative(e)?EIe(e):e}function R7r(e,r,n){var a=e,o=0;switch(n){case 0:a=e<<24>>24,o=a;break;case 4:a=e<<24>>>24;break;case 1:a=e<<16>>16,o=a;break;case 5:a=e<<16>>>16;break;case 2:a=e>>0,o=a;break;case 6:a=e>>>0;break}return Ei.fromBits(a,o>>31,r)}function NIe(e,r,n,a,o){var u=(0,U8r.isValid)(e,r,o);if(u!=null){var t=function(l,f){var p=Math.max(l.length,f.length);return l.padStart(p,"0")<=f.padStart(p,"0")},d=u.sign==="-",s=C7r(n||u.radix!==10,u.radix,d);if(t(u.digits.toUpperCase(),s))return e=d?u.sign+u.digits:u.digits,Ei.fromString(e,n,u.radix)}throw new Error("Input string was not in a correct format.")}function T7r(e,r,n,a,o){try{return o.contents=NIe(e,r,n,a),!0}catch(u){return!1}}function b7r(e,r){return bIe(sie(sie(Ei.fromNumber(e),621355968e5),r),1e4)}function P7r(e){return Ei.toNumber(TIe(lie(e,1e4),621355968e5))}function E7r(e,r,n){var a=lie(e,r),o=PIe(e,r);return n!=null?(n.contents=o,a):[a,o]}});var fie=Y(aa=>{_();var N7r=An();Object.defineProperty(aa,"__esModule",{value:!0});aa.DateTime=qf;aa.add=$T;aa.addDays=z7r;aa.addHours=Y7r;aa.addMilliseconds=Z7r;aa.addMinutes=J7r;aa.addMonths=eVr;aa.addSeconds=X7r;aa.addYears=$7r;aa.compareTo=aa.compare=void 0;aa.create=yx;aa.date=MIe;aa.dateOffsetToString=uV;aa.dateToHalfUTCString=Sx;aa.day=FF;aa.dayOfWeek=H7r;aa.dayOfYear=Q7r;aa.daysInMonth=sV;aa.default=void 0;aa.equals=iVr;aa.fromDateTimeOffset=D7r;aa.fromTicks=w7r;aa.getTicks=x7r;aa.hour=Cx;aa.isDaylightSavingTime=cVr;aa.isLeapYear=IIe;aa.maxValue=B7r;aa.millisecond=_x;aa.minValue=L7r;aa.minute=Rx;aa.month=IF;aa.now=FIe;aa.op_Addition=sVr;aa.op_Subtraction=lVr;aa.parse=kIe;aa.parseRaw=OIe;aa.second=Tx;aa.specifyKind=W7r;aa.subtract=wIe;aa.timeOfDay=j7r;aa.toLocalTime=V7r;aa.toLongDateString=rVr;aa.toLongTimeString=tVr;aa.toShortDateString=nVr;aa.toShortTimeString=aVr;aa.toString=M7r;aa.toUniversalTime=K7r;aa.today=G7r;aa.tryParse=q7r;aa.utcNow=U7r;aa.year=MF;var A7r=N7r(GS()),die=cie(),jm=Cc();function uV(e){var r=e<0;e=Math.abs(e);var n=~~(e/36e5),a=e%36e5/6e4;return(r?"-":"+")+(0,jm.padWithZeros)(n,2)+":"+(0,jm.padWithZeros)(a,2)}function Sx(e,r){var n=e.toISOString();return r==="first"?n.substring(0,n.indexOf("T")):n.substring(n.indexOf("T")+1,n.length-1)}function O7r(e,r){if(r)return e.toISOString();var n=e.kind==null?!0:e.kind===2;return(0,jm.padWithZeros)(e.getFullYear(),4)+"-"+(0,jm.padWithZeros)(e.getMonth()+1,2)+"-"+(0,jm.padWithZeros)(e.getDate(),2)+"T"+(0,jm.padWithZeros)(e.getHours(),2)+":"+(0,jm.padWithZeros)(e.getMinutes(),2)+":"+(0,jm.padWithZeros)(e.getSeconds(),2)+"."+(0,jm.padWithZeros)(e.getMilliseconds(),3)+(n?uV(e.getTimezoneOffset()*-6e4):"")}function k7r(e,r){var n=e.toISOString();return n.substring(0,n.length-1)+uV(r)}function AIe(e,r,n){return r.replace(/(\w)\1*/g,function(a){var o=Number.NaN;switch(a.substring(0,1)){case"y":var u=n?e.getUTCFullYear():e.getFullYear();o=a.length<4?u%100:u;break;case"M":o=(n?e.getUTCMonth():e.getMonth())+1;break;case"d":o=n?e.getUTCDate():e.getDate();break;case"H":o=n?e.getUTCHours():e.getHours();break;case"h":var t=n?e.getUTCHours():e.getHours();o=t>12?t%12:t;break;case"m":o=n?e.getUTCMinutes():e.getMinutes();break;case"s":o=n?e.getUTCSeconds():e.getSeconds();break;case"f":o=n?e.getUTCMilliseconds():e.getMilliseconds();break}return Number.isNaN(o)?a:o<10&&a.length>1?"0"+o:""+o})}function F7r(e,r){var n,a,o,u=new Date(e.getTime()+((n=e.offset)!==null&&n!==void 0?n:0));if(typeof r!="string")return u.toISOString().replace(/\.\d+/,"").replace(/[A-Z]|\.\d+/g," ")+uV((a=e.offset)!==null&&a!==void 0?a:0);if(r.length===1)switch(r){case"D":case"d":return Sx(u,"first");case"T":case"t":return Sx(u,"second");case"O":case"o":return k7r(u,(o=e.offset)!==null&&o!==void 0?o:0);default:throw new Error("Unrecognized Date print format")}else return AIe(u,r,!0)}function I7r(e,r){var n=e.kind===1;if(typeof r!="string")return n?e.toUTCString():e.toLocaleString();if(r.length===1)switch(r){case"D":case"d":return n?Sx(e,"first"):e.toLocaleDateString();case"T":case"t":return n?Sx(e,"second"):e.toLocaleTimeString();case"O":case"o":return O7r(e,n);default:throw new Error("Unrecognized Date print format")}else return AIe(e,r,n)}function M7r(e,r,n){return e.offset!=null?F7r(e,r):I7r(e,r)}function qf(e,r){var n=new Date(e);return n.kind=(r??0)|0,n}function w7r(e,r){e=(0,die.fromValue)(e),r=r??2;var n=qf((0,die.ticksToUnixEpochMilliseconds)(e),r);return r!==1&&(n=qf(n.getTime()-(0,jm.dateOffset)(n),r)),n}function D7r(e,r){var n;switch(r){case 1:return qf(e.getTime(),1);case 2:return qf(e.getTime(),2);default:var a=qf(e.getTime()+((n=e.offset)!==null&&n!==void 0?n:0),r);return qf(a.getTime()-(0,jm.dateOffset)(a),r)}}function x7r(e){return(0,die.unixEpochMillisecondsToTicks)(e.getTime(),(0,jm.dateOffset)(e))}function L7r(){return qf(-621355968e5,0)}function B7r(){return qf(0xe677d21fdbff,0)}function OIe(e){function r(){throw new Error("The string is not a valid Date: "+e)}(e==null||e.trim()==="")&&r(),e.length===10&&e[4]==="-"&&e[7]==="-"&&(e+="T00:00:00");var n=new Date(e),a=null;if(isNaN(n.getTime())){var o=/^\s*(\d+[^\w\s:]\d+[^\w\s:]\d+)?\s*(\d+:\d+(?::\d+(?:\.\d+)?)?)?\s*([AaPp][Mm])?\s*(Z|[+-]([01]?\d):?([0-5]?\d)?)?\s*$/.exec(e);if(o!=null){var u,t=0;if(o[2]!=null){var d=o[2].split(":");t=parseInt(d[0],10)*3600+parseInt(d[1]||"0",10)*60+parseFloat(d[2]||"0"),o[3]!=null&&o[3].toUpperCase()==="PM"&&(t+=720)}if(o[4]!=null){if(o[1]!=null)u=new Date(o[1]+" UTC");else{var s=new Date;u=new Date(s.getUTCFullYear()+"/"+(s.getUTCMonth()+1)+"/"+s.getUTCDate())}if(o[4]==="Z")a="Z";else{var c=parseInt(o[5],10)*60+parseInt(o[6]||"0",10);o[4][0]==="-"&&(c*=-1),a=c,t-=c*60}}else if(o[1]!=null)u=new Date(o[1]);else{var l=new Date;u=new Date(l.getFullYear()+"/"+(l.getMonth()+1)+"/"+l.getDate())}n=new Date(u.getTime()+t*1e3),n=new Date(n.getTime()+(n.getTimezoneOffset()-u.getTimezoneOffset())*6e4)}else r();isNaN(n.getTime())&&r()}return[n,a]}function kIe(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=OIe(e),a=(0,A7r.default)(n,2),o=a[0],u=a[1],t=u!=null?r&&u==="Z"?1:2:0;return qf(o.getTime(),t)}function q7r(e,r){try{return r.contents=kIe(e),!0}catch(n){return!1}}function yx(e,r,n){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,t=arguments.length>6&&arguments[6]!==void 0?arguments[6]:0,d=arguments.length>7?arguments[7]:void 0,s=d===1?Date.UTC(e,r-1,n,a,o,u,t):new Date(e,r-1,n,a,o,u,t).getTime();if(isNaN(s))throw new Error("The parameters describe an unrepresentable Date.");var c=qf(s,d);return e<=99&&c.setFullYear(e,r-1,n),c}function FIe(){return qf(Date.now(),2)}function U7r(){return qf(Date.now(),1)}function G7r(){return MIe(FIe())}function IIe(e){return e%4===0&&e%100!==0||e%400===0}function sV(e,r){return r===2?IIe(e)?29:28:r>=8?r%2===0?31:30:r%2===0?30:31}function K7r(e){return e.kind===1?e:qf(e.getTime(),1)}function V7r(e){return e.kind===2?e:qf(e.getTime(),2)}function W7r(e,r){return yx(MF(e),IF(e),FF(e),Cx(e),Rx(e),Tx(e),_x(e),r)}function j7r(e){return Cx(e)*36e5+Rx(e)*6e4+Tx(e)*1e3+_x(e)}function MIe(e){return yx(MF(e),IF(e),FF(e),0,0,0,0,e.kind)}function FF(e){return e.kind===1?e.getUTCDate():e.getDate()}function Cx(e){return e.kind===1?e.getUTCHours():e.getHours()}function _x(e){return e.kind===1?e.getUTCMilliseconds():e.getMilliseconds()}function Rx(e){return e.kind===1?e.getUTCMinutes():e.getMinutes()}function IF(e){return(e.kind===1?e.getUTCMonth():e.getMonth())+1}function Tx(e){return e.kind===1?e.getUTCSeconds():e.getSeconds()}function MF(e){return e.kind===1?e.getUTCFullYear():e.getFullYear()}function H7r(e){return e.kind===1?e.getUTCDay():e.getDay()}function Q7r(e){for(var r=MF(e),n=IF(e),a=FF(e),o=1;o<n;o++)a+=sV(r,o);return a}function $T(e,r){var n=qf(e.getTime()+r,e.kind);if(e.kind===2){var a=e.getTimezoneOffset(),o=n.getTimezoneOffset();return a!==o?qf(n.getTime()+(o-a)*6e4,e.kind):n}else return n}function z7r(e,r){return $T(e,r*864e5)}function Y7r(e,r){return $T(e,r*36e5)}function J7r(e,r){return $T(e,r*6e4)}function X7r(e,r){return $T(e,r*1e3)}function Z7r(e,r){return $T(e,r)}function $7r(e,r){var n=IF(e),a=MF(e)+r,o=sV(a,n),u=Math.min(o,FF(e));return yx(a,n,u,Cx(e),Rx(e),Tx(e),_x(e),e.kind)}function eVr(e,r){var n=IF(e)+r,a=0,o=0;n>12?(a=n%12,o=Math.floor(n/12),n=a):n<1&&(a=12+n%12,o=Math.floor(n/12)+(a===12?-1:0),n=a);var u=MF(e)+o,t=sV(u,n),d=Math.min(t,FF(e));return yx(u,n,d,Cx(e),Rx(e),Tx(e),_x(e),e.kind)}function wIe(e,r){return typeof r=="number"?$T(e,-r):e.getTime()-r.getTime()}function rVr(e){return e.toDateString()}function nVr(e){return e.toLocaleDateString()}function tVr(e){return e.toLocaleTimeString()}function aVr(e){return e.toLocaleTimeString().replace(/:\d\d(?!:)/,"")}function iVr(e,r){return e.getTime()===r.getTime()}var oVr=jm.compareDates;aa.compare=oVr;var uVr=jm.compareDates;aa.compareTo=uVr;function sVr(e,r){return $T(e,r)}function lVr(e,r){return wIe(e,r)}function cVr(e){var r=new Date(e.getFullYear(),0,1),n=new Date(e.getFullYear(),6,1);return dVr(r.getTimezoneOffset(),n.getTimezoneOffset(),e.getTimezoneOffset())}function dVr(e,r,n){return Math.min(e,r)===n}var fVr=qf;aa.default=fVr});var gie=Y(PS=>{_();Object.defineProperty(PS,"__esModule",{value:!0});PS.create=mie;PS.escape=pVr;PS.isMatch=gVr;PS.match=vVr;PS.matches=pie;PS.options=hVr;PS.replace=SVr;PS.split=yVr;PS.unescape=mVr;function mie(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(r&-276)throw new Error("RegexOptions only supports: IgnoreCase, Multiline, Singleline and ECMAScript");var n="gu";return n+=r&1?"i":"",n+=r&2?"m":"",n+=r&16?"s":"",new RegExp(e,n)}function pVr(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function mVr(e){return e.replace(/\\([\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|])/g,"$1")}function gVr(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return e.lastIndex=n,e.test(r)}function vVr(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return e.lastIndex=n,e.exec(r)}function pie(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(r==null)throw new Error("Input cannot ve null");if(!e.global)throw new Error("Non-global RegExp");e.lastIndex=n;for(var a=[],o,u=-1;(o=e.exec(r))!=null;)o.index===u?e.lastIndex++:(u=o.index,a.push(o));return a}function hVr(e){var r=256;return r|=e.ignoreCase?1:0,r|=e.multiline?2:0,r}function SVr(e,r,n,a){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;function u(){var f=arguments[0];if(a){a--;for(var p=[],m=arguments.length,v=typeof arguments[m-1]!="string",h=v?m-3:m-2,S=0;S<h;S++)p.push(arguments[S]);p.index=arguments[h++],p.input=arguments[h++],v&&(p.groups=arguments[h]),f=n(p)}return f}if(typeof e=="string"){var t=e;e=mie(r,a??0),r=t,a=void 0}if(typeof n=="function")return a=a??-1,r.substring(0,o)+r.substring(o).replace(e,u);if(n=n.replace(/\$0/g,function(f){return"$&"}).replace(/\${([^}]+)}/g,"$<$1>"),a!=null){var d,s=r.substring(o),c=pie(e,s),l=pie.length>a?(d=c[a-1],s.substring(0,d.index+d[0].length)):s;return r.substring(0,o)+l.replace(e,n)+r.substring(o+l.length)}else return r.replace(e,n)}function yVr(e,r,n){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(typeof e=="string"){var o=e;e=mie(r,n??0),r=o,n=void 0}return r=r.substring(a),r.split(e,n)}});var N_=Y(Hi=>{_();var CVr=An();Object.defineProperty(Hi,"__esModule",{value:!0});Hi.compare=bVr;Hi.compareOrdinal=PVr;Hi.compareTo=EVr;Hi.concat=UVr;Hi.endsWith=xVr;Hi.filter=eWr;Hi.fmt=nWr;Hi.fmtWith=tWr;Hi.format=DVr;Hi.fromBase64String=WVr;Hi.fsFormat=GIe;Hi.getCharAtIndex=YVr;Hi.getFormat=aWr;Hi.indexOfAny=AVr;Hi.initialize=KIe;Hi.insert=LVr;Hi.interpolate=kVr;Hi.isNullOrEmpty=BVr;Hi.isNullOrWhiteSpace=qVr;Hi.join=GVr;Hi.joinWithIndices=KVr;Hi.padLeft=eb;Hi.padRight=jVr;Hi.printf=OVr;Hi.remove=HVr;Hi.replace=QVr;Hi.replicate=zVr;Hi.split=JVr;Hi.startsWith=NVr;Hi.substring=rWr;Hi.toBase64String=VVr;Hi.toConsole=FVr;Hi.toConsoleError=IVr;Hi.toFail=wVr;Hi.toText=MVr;Hi.trim=XVr;Hi.trimEnd=$Vr;Hi.trimStart=ZVr;var vie=CVr(GS()),xIe=fie(),_c=tV(),Ex=gie(),LIe=Uc();function _Vr(e,r){var n=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=RVr(e))||r&&e&&typeof e.length=="number"){n&&(e=n);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function RVr(e,r){if(e){if(typeof e=="string")return DIe(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return DIe(e,r)}}function DIe(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,a=new Array(r);n<r;n++)a[n]=e[n];return a}var bx=/(^|[^%])%([0+\- ]*)(\*|\d+)?(?:\.(\d+))?(\w)/g,Px=/(?:(^|[^%])%([0+\- ]*)(\d+)?(?:\.(\d+))?(\w))?%P\(\)/g,TVr=/\{(\d+)(,-?\d+)?(?:\:([a-zA-Z])(\d{0,2})|\:(.+?))?\}/g;function BIe(e,r){return(0,_c.compare)(e,r)<0}function E_(e,r,n){function a(u){return u===!0||u===1||u===3||u===5}function o(u){return u===4||u===5}return e==null?r==null?0:-1:r==null?1:o(n)?(a(n)&&(e=e.toLowerCase(),r=r.toLowerCase()),e===r?0:e<r?-1:1):(a(n)&&(e=e.toLocaleLowerCase(),r=r.toLocaleLowerCase()),e.localeCompare(r))}function bVr(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];switch(r.length){case 2:return E_(r[0],r[1],!1);case 3:return E_(r[0],r[1],r[2]);case 4:return E_(r[0],r[1],r[2]===!0);case 5:return E_(r[0].substr(r[1],r[4]),r[2].substr(r[3],r[4]),!1);case 6:return E_(r[0].substr(r[1],r[4]),r[2].substr(r[3],r[4]),r[5]);case 7:return E_(r[0].substr(r[1],r[4]),r[2].substr(r[3],r[4]),r[5]===!0);default:throw new Error("String.compare: Unsupported number of parameters")}}function PVr(e,r){return E_(e,r,4)}function EVr(e,r){return E_(e,r,0)}function NVr(e,r,n){return e.length>=r.length?E_(e.substr(0,r.length),r,n)===0:!1}function AVr(e,r){if(e==null||e==="")return-1;var n=(arguments.length<=2?0:arguments.length-2)>0?arguments.length<=2?void 0:arguments[2]:0;if(n<0)throw new Error("Start index cannot be negative");var a=(arguments.length<=2?0:arguments.length-2)>1?arguments.length<=3?void 0:arguments[3]:e.length-n;if(a<0)throw new Error("Length cannot be negative");if(a>e.length-n)throw new Error("Invalid startIndex and length");e=e.substr(n,a);for(var o=_Vr(r),u;!(u=o()).done;){var t=u.value,d=e.indexOf(t);if(d>-1)return d+n}return-1}function OVr(e){return{input:e,cont:GIe(e)}}function kVr(e,r){var n=0,a=0,o="";Px.lastIndex=0;for(var u=Px.exec(e);u;){var t=u.index+(u[1]||"").length;o+=e.substring(a,t).replace(/%%/g,"%");var d=u,s=(0,vie.default)(d,6),c=s[2],l=s[3],f=s[4],p=s[5];o+=qIe(r[n++],c,l,f,p),a=Px.lastIndex,Px.lastIndex-=1,u=Px.exec(e)}return o+=e.substring(a).replace(/%%/g,"%"),o}function lV(e,r){return typeof r=="string"?e(r):r.cont(e)}function FVr(e){return lV(function(r){return console.log(r)},e)}function IVr(e){return lV(function(r){return console.error(r)},e)}function MVr(e){return lV(function(r){return r},e)}function wVr(e){return lV(function(r){throw new Error(r)},e)}function qIe(e,r,n,a,o){var u="";if(r=r||"",o=o||"",(0,_c.isNumeric)(e))switch(o.toLowerCase()!=="x"&&(BIe(e,0)?(e=(0,_c.multiply)(e,-1),u="-"):r.indexOf(" ")>=0?u=" ":r.indexOf("+")>=0&&(u="+")),a=a==null?null:parseInt(a,10),o){case"f":case"F":a=a??6,e=(0,_c.toFixed)(e,a);break;case"g":case"G":e=a!=null?(0,_c.toPrecision)(e,a):(0,_c.toPrecision)(e);break;case"e":case"E":e=a!=null?(0,_c.toExponential)(e,a):(0,_c.toExponential)(e);break;case"x":e=(0,_c.toHex)(e);break;case"X":e=(0,_c.toHex)(e).toUpperCase();break;default:e=String(e);break}else e instanceof Date?e=(0,xIe.toString)(e):e=(0,LIe.toString)(e);if(n=typeof n=="number"?n:parseInt(n,10),isNaN(n))e=u+e;else{var t=r.indexOf("0")>=0,d=r.indexOf("-")>=0,s=d||!t?" ":"0";s==="0"?(e=eb(e,n-u.length,s,d),e=u+e):e=eb(u+e,n,s,d)}return e}function UIe(e,r,n){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"",o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:-1;return function(){for(var u=a,t=r.slice(),d=n.slice(),s=arguments.length,c=new Array(s),l=0;l<s;l++)c[l]=arguments[l];for(var f=0,p=c;f<p.length;f++){var m=p[f],v=(0,vie.default)(d[0],6),h=v[2],S=v[3],y=v[4],C=v[5],E=S;if(o>=0)E=o,o=-1;else if(E==="*"){if(m<0)throw new Error("Non-negative number required");o=m;continue}u+=t[0],u+=qIe(m,h,E,y,C),t.splice(0,1),d.splice(0,1)}return d.length===0?(u+=t[0],e(u)):UIe(e,t,d,u,o)}}function GIe(e){return function(r){bx.lastIndex=0;for(var n=[],a=[],o=0,u=bx.exec(e);u;){var t=u.index+(u[1]||"").length;n.push(e.substring(o,t).replace(/%%/g,"%")),a.push(u),o=bx.lastIndex,bx.lastIndex-=1,u=bx.exec(e)}return n.length===0?r(e.replace(/%%/g,"%")):(n.push(e.substring(o).replace(/%%/g,"%")),UIe(r,n,a))}}function DVr(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return typeof e=="object"&&n.length>0&&(e=n[0],n.shift()),e.replace(TVr,function(o,u,t,d,s,c){if(u<0||u>=n.length)throw new Error("Index must be greater or equal to zero and less than the arguments' length.");var l=n[u];if((0,_c.isNumeric)(l))switch(s=s==null?null:parseInt(s,10),d){case"f":case"F":s=s??2,l=(0,_c.toFixed)(l,s);break;case"g":case"G":l=s!=null?(0,_c.toPrecision)(l,s):(0,_c.toPrecision)(l);break;case"e":case"E":l=s!=null?(0,_c.toExponential)(l,s):(0,_c.toExponential)(l);break;case"p":case"P":s=s??2,l=(0,_c.toFixed)((0,_c.multiply)(l,100),s)+" %";break;case"d":case"D":l=s!=null?eb(String(l),s,"0"):String(l);break;case"x":case"X":l=s!=null?eb((0,_c.toHex)(l),s,"0"):(0,_c.toHex)(l),d==="X"&&(l=l.toUpperCase());break;default:if(c){var f="";l=c.replace(/([0#,]+)(\.[0#]+)?/,function(p,m,v){BIe(l,0)&&(l=(0,_c.multiply)(l,-1),f="-");var h=v!=null?v.length:0;if(l=(0,_c.toFixed)(l,Math.max(h-1,0)),m.indexOf(",")>0){for(var S=l.split("."),y=(0,vie.default)(S,2),C=y[0],E=y[1],I=C.length%3,F=Math.floor(C.length/3),w=I>0?C.substr(0,I)+(F>0?",":""):"",B=0;B<F;B++)w+=C.substr(I+B*3,3)+(B<F-1?",":"");l=E?w+"."+E:w}m=m.replace(/,/g,"");var k=m.length>0&&m[0]==="0"?m.length:0;return eb(l,k-f.length+h,"0")}),l=f+l}}else l instanceof Date?l=(0,xIe.toString)(l,c||d):l=(0,LIe.toString)(l);return t=parseInt((t||" ").substring(1),10),isNaN(t)||(l=eb(String(l),Math.abs(t)," ",t<0)),l})}function xVr(e,r){var n=e.lastIndexOf(r);return n>=0&&n===e.length-r.length}function KIe(e,r){if(e<0)throw new Error("String length must be non-negative");for(var n=new Array(e),a=0;a<e;a++)n[a]=r(a);return n.join("")}function LVr(e,r,n){if(r<0||r>e.length)throw new Error("startIndex is negative or greater than the length of this instance.");return e.substring(0,r)+n+e.substring(r)}function BVr(e){return typeof e!="string"||e.length===0}function qVr(e){return typeof e!="string"||/^\s*$/.test(e)}function UVr(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return r.map(function(a){return String(a)}).join("")}function GVr(e,r){return Array.isArray(r)?r.join(e):Array.from(r).join(e)}function KVr(e,r,n,a){var o=n+a;if(o>r.length)throw new Error("Index and count must refer to a location within the buffer.");return r.slice(n,o).join(e)}function VIe(e){throw new Error("The environment doesn't support '"+e+"', please use a polyfill.")}function VVr(e){for(var r="",n=0;n<e.length;n++)r+=String.fromCharCode(e[n]);return typeof btoa=="function"?btoa(r):VIe("btoa")}function WVr(e){for(var r=typeof atob=="function"?atob(e):VIe("atob"),n=new Uint8Array(r.length),a=0;a<r.length;a++)n[a]=r.charCodeAt(a);return n}function eb(e,r,n,a){n=n||" ",r=r-e.length;for(var o=0;o<r;o++)e=a?e+n:n+e;return e}function jVr(e,r,n){return eb(e,r,n,!0)}function HVr(e,r,n){if(r>=e.length)throw new Error("startIndex must be less than length of string");if(typeof n=="number"&&r+n>e.length)throw new Error("Index and count must refer to a location within the string.");return e.slice(0,r)+(typeof n=="number"?e.substr(r+n):"")}function QVr(e,r,n){return e.replace(new RegExp((0,Ex.escape)(r),"g"),n)}function zVr(e,r){return KIe(e,function(){return r})}function YVr(e,r){if(r<0||r>=e.length)throw new Error("Index was outside the bounds of the array.");return e[r]}function JVr(e,r,n,a){if(n=typeof n=="number"?n:void 0,a=typeof a=="number"?a:0,n&&n<0)throw new Error("Count cannot be less than zero");if(n===0)return[];var o=(a&1)===1,u=(a&2)===2;r=r||[],r=r.filter(function(m){return m}).map(Ex.escape),r=r.length>0?r:["\\s"];var t=[],d=new RegExp(r.join("|"),"g"),s=!0,c=0;do{var l=d.exec(e);if(l===null){var f=u?e.substring(c).trim():e.substring(c);(!o||f.length>0)&&t.push(f),s=!1}else{var p=u?e.substring(c,l.index).trim():e.substring(c,l.index);(!o||p.length>0)&&(n!=null&&t.length+1===n?(t.push(u?e.substring(c).trim():e.substring(c)),s=!1):t.push(p)),c=d.lastIndex}}while(s);return t}function XVr(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];if(n.length===0)return e.trim();var o="["+(0,Ex.escape)(n.join(""))+"]+";return e.replace(new RegExp("^"+o),"").replace(new RegExp(o+"$"),"")}function ZVr(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return n.length===0?e.trimStart():e.replace(new RegExp("^["+(0,Ex.escape)(n.join(""))+"]+"),"")}function $Vr(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return n.length===0?e.trimEnd():e.replace(new RegExp("["+(0,Ex.escape)(n.join(""))+"]+$"),"")}function eWr(e,r){return r.split("").filter(function(n){return e(n)}).join("")}function rWr(e,r,n){if(r+(n||0)>e.length)throw new Error("Invalid startIndex and/or length");return n!=null?e.substr(r,n):e.substr(r)}function nWr(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return{strs:e,args:n}}function tWr(e){return function(r){for(var n=arguments.length,a=new Array(n>1?n-1:0),o=1;o<n;o++)a[o-1]=arguments[o];return{strs:r,args:a,fmts:e}}}function aWr(e){return e.fmts?e.strs.reduce(function(r,n,a){return r+("{"+(String(a-1)+e.fmts[a-1])+"}")+n}):e.strs.reduce(function(r,n,a){return r+("{"+(a-1)+"}")+n})}});var WIe=Y((nFn,Nx)=>{_();function iWr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}Nx.exports=iWr,Nx.exports.__esModule=!0,Nx.exports.default=Nx.exports});var hie=Y((aFn,Kg)=>{_();var oWr=q4(),uWr=WIe();function cV(e,r,n){return uWr()?(Kg.exports=cV=Reflect.construct.bind(),Kg.exports.__esModule=!0,Kg.exports.default=Kg.exports):(Kg.exports=cV=function(o,u,t){var d=[null];d.push.apply(d,u);var s=Function.bind.apply(o,d),c=new s;return t&&oWr(c,t.prototype),c},Kg.exports.__esModule=!0,Kg.exports.default=Kg.exports),cV.apply(null,arguments)}Kg.exports=cV,Kg.exports.__esModule=!0,Kg.exports.default=Kg.exports});var QIe=Y(wF=>{_();var sWr=An();Object.defineProperty(wF,"__esModule",{value:!0});wF.default=wF.Big=void 0;var lWr=sWr(V_()),cWr=Cc(),dWr=tV(),hs=(0,lWr.default)({GetHashCode:function(){return(0,cWr.combineHashCodes)([this.s,this.e].concat(this.c))},Equals:function(r){return!this.cmp(r)},CompareTo:function(r){return this.cmp(r)}},dWr.symbol,function(){var e=this;return{multiply:function(n){return e.mul(n)},toPrecision:function(n){return e.toPrecision(n)},toExponential:function(n){return e.toExponential(n)},toFixed:function(n){return e.toFixed(n)},toHex:function(){return(Number(e)>>>0).toString(16)}}}),fWr=28,pWr=1,DF=1e6,mWr=1e6,gWr=-29,vWr=29,hWr=!1,dV="[big.js] Invalid decimal places",SWr="[big.js] Invalid rounding mode",jIe="[big.js] Division by zero",ky=void 0,yWr=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function HIe(){function e(r){var n=this;if(!(n instanceof e))return r===ky?HIe():new e(r);if(r instanceof e)n.s=r.s,n.e=r.e,n.c=r.c.slice(),CWr(n);else{if(typeof r!="string"){if(e.strict===!0)throw TypeError("[big.js] Invalid number");r=r===0&&1/r<0?"-0":String(r)}_Wr(n,r)}n.constructor=e}return e.prototype=hs,e.DP=fWr,e.RM=pWr,e.NE=gWr,e.PE=vWr,e.strict=hWr,e}function CWr(e){if(e.c.length>1&&!e.c[0]){var r=e.c.findIndex(function(n){return n});e.c=e.c.slice(r),e.e=e.e-r}}function _Wr(e,r){var n,a,o;if(!yWr.test(r))throw Error("[big.js] Invalid number");for(e.s=r.charAt(0)=="-"?(r=r.slice(1),-1):1,(n=r.indexOf("."))>-1&&(r=r.replace(".","")),(a=r.search(/e/i))>0?(n<0&&(n=a),n+=+r.slice(a+1),r=r.substring(0,a)):n<0&&(n=r.length),o=r.length,a=0;a<n&&a<o&&r.charAt(a)=="0";)++a;if(a==o)e.c=[e.e=0];else for(e.e=n-a-1,e.c=[],n=0;a<o;)e.c[n++]=+r.charAt(a++);return e=rb(e,Ax.DP+1,Ax.RM),e}function rb(e,r,n,a){var o=e.c;if(n===ky&&(n=Ax.RM),n!==0&&n!==1&&n!==2&&n!==3)throw Error(SWr);if(r<1)a=n===3&&(a||!!o[0])||r===0&&(n===1&&o[0]>=5||n===2&&(o[0]>5||o[0]===5&&(a||o[1]!==ky))),o.length=1,a?(e.e=e.e-r+1,o[0]=1):o[0]=e.e=0;else if(r<o.length){var u=o.findIndex(function(t,d){return d>=r&&t>0})<0;if(a=n===1&&o[r]>=5||n===2&&(o[r]>5||o[r]===5&&(a||o[r+1]!==ky||o[r-1]&1))||n===3&&(a||!u),o.length=r--,a)for(;++o[r]>9;)o[r]=0,r--||(++e.e,o.unshift(1));for(r=o.length;!o[--r];)o.pop()}return e}function xF(e,r,n){var a=e.e,o=e.c.join(""),u=o.length;if(r)o=o.charAt(0)+(u>1?"."+o.slice(1):"")+(a<0?"e":"e+")+a;else if(a<0){for(;++a;)o="0"+o;o="0."+o}else if(a>0)if(++a>u)for(a-=u;a--;)o+="0";else a<u&&(o=o.slice(0,a)+"."+o.slice(a));else u>1&&(o=o.charAt(0)+"."+o.slice(1));return e.s<0&&n?"-"+o:o}hs.abs=function(){var e=new this.constructor(this);return e.s=1,e};hs.cmp=function(o){var r,n=this.constructor,a=new n(this),o=new n(o),u=a.c,t=o.c,d=a.s,s=o.s,c=a.e,l=o.e;if(!u[0]||!t[0])return u[0]?d:t[0]?-s:0;if(d!=s)return d;if(r=d<0,c!=l)return c>l^r?1:-1;for(s=Math.max(u.length,t.length),d=0;d<s;d++)if(c=d<u.length?u[d]:0,l=d<t.length?t[d]:0,c!=l)return c>l^r?1:-1;return 0};hs.div=function(a){var r=this.constructor,n=new r(this),a=new r(a),o=n.c,u=a.c,t=n.s==a.s?1:-1,d=r.DP;if(d!==~~d||d<0||d>DF)throw Error(dV);if(!u[0])throw Error(jIe);if(!o[0])return a.s=t,a.c=[a.e=0],a;var s,c,l,f,p,m=u.slice(),v=s=u.length,h=o.length,S=o.slice(0,s),y=S.length,C=a,E=C.c=[],I=0,F=d+(C.e=n.e-a.e)+1;for(C.s=t,t=F<0?0:F,m.unshift(0);y++<s;)S.push(0);do{for(l=0;l<10;l++){if(s!=(y=S.length))f=s>y?1:-1;else for(p=-1,f=0;++p<s;)if(u[p]!=S[p]){f=u[p]>S[p]?1:-1;break}if(f<0){for(c=y==s?u:m;y;){if(S[--y]<c[y]){for(p=y;p&&!S[--p];)S[p]=9;--S[p],S[y]+=10}S[y]-=c[y]}for(;!S[0];)S.shift()}else break}E[I++]=f?l:++l,S[0]&&f?S[y]=o[v]||0:S=[o[v]]}while((v++<h||S[0]!==ky)&&t--);return!E[0]&&I!=1&&(E.shift(),C.e--,F--),I>F&&rb(C,F,r.RM,S[0]!==ky),C};hs.eq=function(e){return this.cmp(e)===0};hs.gt=function(e){return this.cmp(e)>0};hs.gte=function(e){return this.cmp(e)>-1};hs.lt=function(e){return this.cmp(e)<0};hs.lte=function(e){return this.cmp(e)<1};hs.minus=hs.sub=function(d){var r,n,a,o,u=this.constructor,t=new u(this),d=new u(d),s=t.s,c=d.s;if(s!=c)return d.s=-c,t.plus(d);var l=t.c.slice(),f=t.e,p=d.c,m=d.e;if(!l[0]||!p[0])return p[0]?d.s=-c:l[0]?d=new u(t):d.s=1,d;if(s=f-m){for((o=s<0)?(s=-s,a=l):(m=f,a=p),a.reverse(),c=s;c--;)a.push(0);a.reverse()}else for(n=((o=l.length<p.length)?l:p).length,s=c=0;c<n;c++)if(l[c]!=p[c]){o=l[c]<p[c];break}if(o&&(a=l,l=p,p=a,d.s=-d.s),(c=(n=p.length)-(r=l.length))>0)for(;c--;)l[r++]=0;for(c=r;n>s;){if(l[--n]<p[n]){for(r=n;r&&!l[--r];)l[r]=9;--l[r],l[n]+=10}l[n]-=p[n]}for(;l[--c]===0;)l.pop();for(;l[0]===0;)l.shift(),--m;return l[0]||(d.s=1,l=[m=0]),d.c=l,d.e=m,d};hs.mod=function(o){var r,n=this.constructor,a=new n(this),o=new n(o),u=a.s,t=o.s;if(!o.c[0])throw Error(jIe);return a.s=o.s=1,r=o.cmp(a)==1,a.s=u,o.s=t,r?new n(a):(u=n.DP,t=n.RM,n.DP=n.RM=0,a=a.div(o),n.DP=u,n.RM=t,this.minus(a.times(o)))};hs.plus=hs.add=function(t){var r,n,a,o=this.constructor,u=new o(this),t=new o(t);if(u.s!=t.s)return t.s=-t.s,u.minus(t);var d=u.e,s=u.c,c=t.e,l=t.c;if(!s[0]||!l[0])return l[0]||(s[0]?t=new o(u):t.s=u.s),t;if(s=s.slice(),r=d-c){for(r>0?(c=d,a=l):(r=-r,a=s),a.reverse();r--;)a.push(0);a.reverse()}for(s.length-l.length<0&&(a=l,l=s,s=a),r=l.length,n=0;r;s[r]%=10)n=(s[--r]=s[r]+l[r]+n)/10|0;for(n&&(s.unshift(n),++c),r=s.length;s[--r]===0;)s.pop();return t.c=s,t.e=c,t};hs.pow=function(e){var r=this.constructor,n=new r(this),a=new r("1"),o=new r("1"),u=e<0;if(e!==~~e||e<-1e6||e>mWr)throw Error("[big.js] Invalid exponent");for(u&&(e=-e);e&1&&(a=a.times(n)),e>>=1,!!e;)n=n.times(n);return u?o.div(a):a};hs.prec=function(e,r){if(e!==~~e||e<1||e>DF)throw Error("[big.js] Invalid precision");return rb(new this.constructor(this),e,r)};hs.round=function(e,r){if(e===ky)e=0;else if(e!==~~e||e<-1e6||e>DF)throw Error(dV);return rb(new this.constructor(this),e+this.e+1,r)};hs.sqrt=function(){var e,r,n,a=this.constructor,o=new a(this),u=o.s,t=o.e,d=new a("0.5");if(!o.c[0])return new a(o);if(u<0)throw Error("[big.js] No square root");u=Math.sqrt(o+""),u===0||u===1/0?(r=o.c.join(""),r.length+t&1||(r+="0"),u=Math.sqrt(r),t=((t+1)/2|0)-(t<0||t&1),e=new a((u==1/0?"5e":(u=u.toExponential()).slice(0,u.indexOf("e")+1))+t)):e=new a(u+""),t=e.e+(a.DP+=4);do n=e,e=d.times(n.plus(o.div(n)));while(n.c.slice(0,t).join("")!==e.c.slice(0,t).join(""));return rb(e,(a.DP-=4)+e.e+1,a.RM)};hs.times=hs.mul=function(o){var r,n=this.constructor,a=new n(this),o=new n(o),u=a.c,t=o.c,d=u.length,s=t.length,c=a.e,l=o.e;if(o.s=a.s==o.s?1:-1,!u[0]||!t[0])return o.c=[o.e=0],o;for(o.e=c+l,d<s&&(r=u,u=t,t=r,l=d,d=s,s=l),r=new Array(l=d+s);l--;)r[l]=0;for(c=s;c--;){for(s=0,l=d+c;l>c;)s=r[l]+t[c]*u[l-c-1]+s,r[l--]=s%10,s=s/10|0;r[l]=s}for(s?++o.e:r.shift(),c=r.length;!r[--c];)r.pop();return o.c=r,o};hs.toExponential=function(e,r){var n=this,a=n.c[0];if(e!==ky){if(e!==~~e||e<0||e>DF)throw Error(dV);for(n=rb(new n.constructor(n),++e,r);n.c.length<e;)n.c.push(0)}return xF(n,!0,!!a)};hs.toFixed=function(e,r){var n=this,a=n.c[0];if(e!==ky){if(e!==~~e||e<0||e>DF)throw Error(dV);for(n=rb(new n.constructor(n),e+n.e+1,r),e=e+n.e+1;n.c.length<e;)n.c.push(0)}return xF(n,!1,!!a)};hs.toJSON=hs.toString=function(){var e=this,r=e.constructor;return xF(e,e.e<=r.NE||e.e>=r.PE,!!e.c[0])};hs.toNumber=function(){var e=Number(xF(this,!0,!0));if(this.constructor.strict===!0&&!this.eq(e.toString()))throw Error("[big.js] Imprecise conversion");return e};hs.toPrecision=function(e,r){var n=this,a=n.constructor,o=n.c[0];if(e!==ky){if(e!==~~e||e<1||e>DF)throw Error("[big.js] Invalid precision");for(n=rb(new a(n),e,r);n.c.length<e;)n.c.push(0)}return xF(n,e<=n.e||n.e<=a.NE||n.e>=a.PE,!!o)};hs.valueOf=function(){var e=this,r=e.constructor;if(r.strict===!0)throw Error("[big.js] valueOf disallowed");return xF(e,e.e<=r.NE||e.e>=r.PE,!0)};var Ax=HIe();wF.Big=Ax;var RWr=Ax;wF.default=RWr});var aMe=Y(Ha=>{_();var TWr=An();Object.defineProperty(Ha,"__esModule",{value:!0});Ha.abs=IWr;Ha.add=void 0;Ha.ceiling=DWr;Ha.compare=kWr;Ha.divide=Ha.default=void 0;Ha.equals=FWr;Ha.floor=xWr;Ha.fromIntArray=JWr;Ha.fromInts=nMe;Ha.fromParts=tMe;Ha.getBits=XWr;Ha.negate=Ha.multiply=Ha.get_Zero=Ha.get_One=Ha.get_MinusOne=Ha.get_MinValue=Ha.get_MaxValue=void 0;Ha.op_Addition=YIe;Ha.op_Division=ZIe;Ha.op_Modulus=$Ie;Ha.op_Multiply=XIe;Ha.op_Subtraction=JIe;Ha.op_UnaryNegation=eMe;Ha.parse=HWr;Ha.pow=LWr;Ha.remainder=void 0;Ha.round=MWr;Ha.sqrt=BWr;Ha.subtract=void 0;Ha.toNumber=QWr;Ha.toString=jWr;Ha.truncate=wWr;Ha.tryParse=rMe;var Fy=TWr(QIe()),bWr=Uc(),PWr=Fy.default;Ha.default=PWr;var zIe=new Fy.default(0);Ha.get_Zero=zIe;var EWr=new Fy.default(1);Ha.get_One=EWr;var NWr=new Fy.default(-1);Ha.get_MinusOne=NWr;var AWr=new Fy.default("79228162514264337593543950335");Ha.get_MaxValue=AWr;var OWr=new Fy.default("-79228162514264337593543950335");Ha.get_MinValue=OWr;function kWr(e,r){return e.cmp(r)}function FWr(e,r){return!e.cmp(r)}function IWr(e){return e.abs()}function MWr(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return e.round(r,2)}function wWr(e){return e.round(0,0)}function DWr(e){return e.round(0,e.cmp(0)>=0?3:0)}function xWr(e){return e.round(0,e.cmp(0)>=0?0:3)}function LWr(e,r){return e.pow(r)}function BWr(e){return e.sqrt()}function YIe(e,r){return e.add(r)}function JIe(e,r){return e.sub(r)}function XIe(e,r){return e.mul(r)}function ZIe(e,r){return e.div(r)}function $Ie(e,r){return e.mod(r)}function eMe(e){var r=new Fy.default(e);return r.s=-r.s||0,r}var qWr=YIe;Ha.add=qWr;var UWr=JIe;Ha.subtract=UWr;var GWr=XIe;Ha.multiply=GWr;var KWr=ZIe;Ha.divide=KWr;var VWr=$Ie;Ha.remainder=VWr;var WWr=eMe;Ha.negate=WWr;function jWr(e){return e.toString()}function rMe(e,r){try{return r.contents=new Fy.default(e.trim()),!0}catch(n){return!1}}function HWr(e){var r=new bWr.FSharpRef(zIe);if(rMe(e,r))return r.contents;throw new Error("Input string was not in a correct format.")}function QWr(e){return+e}function zWr(e,r){for(var n=new Uint8Array(r/4|0),a=1,o=0;o<e.length;o++){for(var u=e[o],t=0;t<a;t++){var d=n[t]*10+u|0;n[t]=d&15,u=d>>4}u!==0&&(n[a++]=u)}return n.slice(0,a)}function YWr(e,r){for(var n=new Uint8Array(r*301/1e3+1|0),a=1,o=e.length-1;o>=0;o--){for(var u=e[o],t=0;t<a;t++){var d=n[t]*16+u|0;n[t]=d%10|0,u=d/10|0}for(;u>0;)n[a++]=u%10|0,u=u/10|0}return n.slice(0,a)}function Sie(e,r,n){for(var a=0;a<8;a++)e[n+a]=r>>a*4&15}function yie(e,r){for(var n=0,a=0;a<8;a++)n=n|e[r+a]<<a*4;return n}function JWr(e){return nMe(e[0],e[1],e[2],e[3])}function nMe(e,r,n,a){var o=a<0,u=a>>16&127;return tMe(e,r,n,o,u)}function tMe(e,r,n,a,o){var u=96,t=new Uint8Array(24);Sie(t,e,0),Sie(t,r,8),Sie(t,n,16);var d=YWr(t,u);o=o&127;var s=new Fy.default(0);s.c=Array.from(d.reverse()),s.e=d.length-o-1,s.s=a?-1:1;var c=new Fy.default(s);return c}function XWr(e){var r=96,n=Uint8Array.from(e.c),a=zWr(n,r),o=yie(a,0),u=yie(a,8),t=yie(a,16),d=e.toString(),s=d.indexOf("."),c=s<0?0:d.length-s-1,l=(c&127)<<16|(e.s<0?2147483648:0);return[o,u,t,l]}});var c0=Y(Sn=>{_();var A_=An();Object.defineProperty(Sn,"__esModule",{value:!0});Sn.TypeInfo=Sn.MethodInfo=Sn.GenericParameter=Sn.CaseInfo=void 0;Sn.anonRecord_type=sjr;Sn.array_type=gjr;Sn.char_type=Sn.bool_type=void 0;Sn.class_type=ojr;Sn.createInstance=jjr;Sn.decimal_type=void 0;Sn.delegate_type=djr;Sn.enum_type=vjr;Sn.equals=mV;Sn.float64_type=Sn.float32_type=void 0;Sn.fullName=gV;Sn.generic_type=Sjr;Sn.getCaseFields=Yjr;Sn.getCaseName=zjr;Sn.getCaseTag=Qjr;Sn.getElementType=kx;Sn.getEnumName=Ojr;Sn.getEnumNames=Njr;Sn.getEnumUnderlyingType=Pjr;Sn.getEnumValues=Ejr;Sn.getFunctionElements=Ijr;Sn.getGenericTypeDefinition=bjr;Sn.getGenerics=pV;Sn.getHashCode=bie;Sn.getRecordElements=vV;Sn.getRecordField=Bjr;Sn.getRecordFields=Ljr;Sn.getTupleElements=Fjr;Sn.getTupleField=Ujr;Sn.getTupleFields=qjr;Sn.getUnionCaseFields=xjr;Sn.getUnionCases=PMe;Sn.getUnionFields=Djr;Sn.getValue=Hjr;Sn.int8_type=Sn.int32_type=Sn.int16_type=void 0;Sn.isArray=Cjr;Sn.isEnum=CV;Sn.isEnumDefined=kjr;Sn.isFunction=Nie;Sn.isGenericParameter=Rjr;Sn.isGenericType=_jr;Sn.isInstanceOfType=Tjr;Sn.isRecord=wjr;Sn.isSubclassOf=RMe;Sn.isTuple=EMe;Sn.isUnion=Mjr;Sn.lambda_type=fjr;Sn.list_type=mjr;Sn.makeGenericType=Wjr;Sn.makeRecord=Kjr;Sn.makeTuple=Vjr;Sn.makeUnion=Gjr;Sn.measure_type=hjr;Sn.name=CMe;Sn.namespace=_Me;Sn.obj_type=void 0;Sn.option_type=pjr;Sn.parseEnum=bMe;Sn.record_type=ujr;Sn.string_type=void 0;Sn.tryParseEnum=Ajr;Sn.tuple_type=cjr;Sn.uint8_type=Sn.uint32_type=Sn.uint16_type=void 0;Sn.union_type=ljr;Sn.unit_type=void 0;var _ie=A_(hie()),Cie=A_(GS()),hV=A_(L_()),ZWr=A_(Qf()),$Wr=A_(zf()),iMe=A_(Ed()),SV=A_(it()),yV=A_(at()),Rie=Uc(),fV=Cc(),ejr=A_(aMe()),rjr=cie();function oMe(e,r){var n=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=njr(e))||r&&e&&typeof e.length=="number"){n&&(e=n);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function njr(e,r){if(e){if(typeof e=="string")return uMe(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return uMe(e,r)}}function uMe(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,a=new Array(r);n<r;n++)a[n]=e[n];return a}function tjr(e){var r=ajr();return function(){var a=(0,iMe.default)(e),o;if(r){var u=(0,iMe.default)(this).constructor;o=Reflect.construct(a,arguments,u)}else o=a.apply(this,arguments);return(0,$Wr.default)(this,o)}}function ajr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var sMe=(0,SV.default)(function e(r,n,a,o){(0,yV.default)(this,e),this.declaringType=r,this.tag=n,this.name=a,this.fields=o});Sn.CaseInfo=sMe;var ijr=(0,SV.default)(function e(r,n,a){(0,yV.default)(this,e),this.name=r,this.parameters=n,this.returnType=a});Sn.MethodInfo=ijr;var Lo=function(){function e(r,n,a,o,u,t,d){(0,yV.default)(this,e),this.fullname=r,this.generics=n,this.construct=a,this.parent=o,this.fields=u,this.cases=t,this.enumCases=d}return(0,SV.default)(e,[{key:"toString",value:function(){return gV(this)}},{key:"GetHashCode",value:function(){return bie(this)}},{key:"Equals",value:function(n){return mV(this,n)}}]),e}();Sn.TypeInfo=Lo;var Tie=function(e){(0,ZWr.default)(n,e);var r=tjr(n);function n(a){return(0,yV.default)(this,n),r.call(this,a)}return(0,SV.default)(n)}(Lo);Sn.GenericParameter=Tie;function pV(e){return e.generics!=null?e.generics:[]}function bie(e){var r=(0,fV.stringHash)(e.fullname),n=pV(e).map(bie);return(0,fV.combineHashCodes)([r].concat((0,hV.default)(n)))}function mV(e,r){return e.fullname===""?r.fullname===""&&(0,fV.equalArraysWith)(vV(e),vV(r),function(n,a){var o=(0,Cie.default)(n,2),u=o[0],t=o[1],d=(0,Cie.default)(a,2),s=d[0],c=d[1];return u===s&&mV(t,c)}):e.fullname===r.fullname&&(0,fV.equalArraysWith)(pV(e),pV(r),mV)}function ojr(e,r,n,a){return new Lo(e,r,n,a)}function ujr(e,r,n,a){return new Lo(e,r,n,void 0,a)}function sjr(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Lo("",void 0,void 0,void 0,function(){return r})}function ljr(e,r,n,a){var o=new Lo(e,r,n,void 0,void 0,function(){var u=n.prototype.cases();return a().map(function(t,d){return new sMe(o,d,u[d],t)})});return o}function cjr(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Lo("System.Tuple`"+r.length,r)}function djr(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Lo("System.Func`"+r.length,r)}function fjr(e,r){return new Lo("Microsoft.FSharp.Core.FSharpFunc`2",[e,r])}function pjr(e){return new Lo("Microsoft.FSharp.Core.FSharpOption`1",[e])}function mjr(e){return new Lo("Microsoft.FSharp.Collections.FSharpList`1",[e])}function gjr(e){return new Lo("[]",[e])}function vjr(e,r,n){return new Lo(e,[r],void 0,void 0,void 0,void 0,n)}function hjr(e){return new Lo(e)}function Sjr(e){return new Tie(e)}var Ox=new Lo("System.Object");Sn.obj_type=Ox;var yjr=new Lo("Microsoft.FSharp.Core.Unit");Sn.unit_type=yjr;var lMe=new Lo("System.Char");Sn.char_type=lMe;var cMe=new Lo("System.String");Sn.string_type=cMe;var Pie=new Lo("System.Boolean");Sn.bool_type=Pie;var dMe=new Lo("System.SByte");Sn.int8_type=dMe;var fMe=new Lo("System.Byte");Sn.uint8_type=fMe;var pMe=new Lo("System.Int16");Sn.int16_type=pMe;var mMe=new Lo("System.UInt16");Sn.uint16_type=mMe;var gMe=new Lo("System.Int32");Sn.int32_type=gMe;var vMe=new Lo("System.UInt32");Sn.uint32_type=vMe;var hMe=new Lo("System.Single");Sn.float32_type=hMe;var SMe=new Lo("System.Double");Sn.float64_type=SMe;var yMe=new Lo("System.Decimal");Sn.decimal_type=yMe;function CMe(e){if(Array.isArray(e))return e[0];if(e instanceof Lo){var r=kx(e);if(r!=null)return CMe(r)+"[]";var n=e.fullname.lastIndexOf(".");return n===-1?e.fullname:e.fullname.substr(n+1)}else return e.name}function gV(e){var r=kx(e);return r!=null?gV(r)+"[]":e.generics==null||e.generics.length===0?e.fullname:e.fullname+"["+e.generics.map(function(n){return gV(n)}).join(",")+"]"}function _Me(e){var r=kx(e);if(r!=null)return _Me(r);var n=e.fullname.lastIndexOf(".");return n===-1?"":e.fullname.substr(0,n)}function Cjr(e){return kx(e)!=null}function kx(e){var r;return e.fullname==="[]"&&((r=e.generics)===null||r===void 0?void 0:r.length)===1?e.generics[0]:void 0}function _jr(e){return e.generics!=null&&e.generics.length>0}function Rjr(e){return e instanceof Tie}function CV(e){return e.enumCases!=null&&e.enumCases.length>0}function RMe(e,r){return r.fullname===Ox.fullname||e.parent!=null&&(e.parent.Equals(r)||RMe(e.parent,r))}function TMe(e){return CV(e)||[dMe.fullname,fMe.fullname,pMe.fullname,mMe.fullname,gMe.fullname,vMe.fullname,hMe.fullname,SMe.fullname].includes(e.fullname)}function Tjr(e,r){if(e.fullname===Ox.fullname)return!0;switch(typeof r){case"boolean":return e.fullname===Pie.fullname;case"string":return e.fullname===cMe.fullname;case"function":return Nie(e);case"number":return TMe(e);default:return e.construct!=null&&r instanceof e.construct}}function bjr(e){return e.generics==null?e:new Lo(e.fullname,e.generics.map(function(){return Ox}))}function Pjr(e){var r;return(r=e.generics)===null||r===void 0?void 0:r[0]}function Ejr(e){if(CV(e)&&e.enumCases!=null)return e.enumCases.map(function(r){return r[1]});throw new Error(e.fullname+" is not an enum type")}function Njr(e){if(CV(e)&&e.enumCases!=null)return e.enumCases.map(function(r){return r[0]});throw new Error(e.fullname+" is not an enum type")}function Eie(e,r){if(e.enumCases!=null)if(typeof r=="string"){for(var n=oMe(e.enumCases),a;!(a=n()).done;){var o=a.value;if(o[0]===r)return o}throw new Error("'"+r+"' was not found in "+e.fullname)}else{for(var u=oMe(e.enumCases),t;!(t=u()).done;){var d=t.value;if(d[1]===r)return d}return["",r]}else throw new Error(e.fullname+" is not an enum type")}function bMe(e,r){var n=parseInt(r,10);return Eie(e,isNaN(n)?r:n)[1]}function Ajr(e,r,n){try{return n.contents=bMe(e,r),!0}catch(a){return!1}}function Ojr(e,r){return Eie(e,r)[0]}function kjr(e,r){try{var n=Eie(e,r);return n[0]!=null&&n[0]!==""}catch(a){}return!1}function PMe(e){if(e.cases!=null)return e.cases();throw new Error(e.fullname+" is not an F# union type")}function vV(e){if(e.fields!=null)return e.fields();throw new Error(e.fullname+" is not an F# record type")}function Fjr(e){if(EMe(e)&&e.generics!=null)return e.generics;throw new Error(e.fullname+" is not a tuple type")}function Ijr(e){if(Nie(e)&&e.generics!=null){var r=e.generics;return[r[0],r[1]]}else throw new Error(e.fullname+" is not an F# function type")}function Mjr(e){return e instanceof Lo?e.cases!=null:e instanceof Rie.Union}function wjr(e){return e instanceof Lo?e.fields!=null:e instanceof Rie.Record}function EMe(e){return e.fullname.startsWith("System.Tuple")}function Nie(e){return e.fullname==="Microsoft.FSharp.Core.FSharpFunc`2"}function Djr(e,r){var n=PMe(r),a=n[e.tag];if(a==null)throw new Error("Cannot find case "+e.name+" in union type");return[a,e.fields]}function xjr(e){return e.fields==null?[]:e.fields}function Ljr(e){return Object.keys(e).map(function(r){return e[r]})}function Bjr(e,r){return e[r[0]]}function qjr(e){return e}function Ujr(e,r){return e[r]}function Gjr(e,r){var n=(e.fields||[]).length;if(r.length!==n)throw new Error("Expected an array of length "+n+" but got "+r.length);return e.declaringType.construct!=null?(0,_ie.default)(e.declaringType.construct,[e.tag].concat((0,hV.default)(r))):{}}function Kjr(e,r){var n=vV(e);if(n.length!==r.length)throw new Error("Expected an array of length "+n.length+" but got "+r.length);return e.construct!=null?(0,_ie.default)(e.construct,(0,hV.default)(r)):n.reduce(function(a,o,u){var t=(0,Cie.default)(o,2),d=t[0],s=t[1];return a[d]=r[u],a},{})}function Vjr(e,r){return e}function Wjr(e,r){return new Lo(e.fullname,r,e.construct,e.parent,e.fields,e.cases)}function jjr(e,r){if(typeof e.construct=="function")return(0,_ie.default)(e.construct,(0,hV.default)(r??[]));if(TMe(e))return 0;switch(e.fullname){case Ox.fullname:return{};case Pie.fullname:return!1;case"System.Int64":case"System.UInt64":return(0,rjr.fromInt)(0);case yMe.fullname:return new ejr.default(0);case lMe.fullname:return null;default:throw new Error("Cannot access constructor of "+e.fullname)}}function Hjr(e,r){return r[e[0]]}function Aie(e){if(!(e instanceof Rie.Union))throw new Error("Value is not an F# union type")}function Qjr(e){return Aie(e),e.tag}function zjr(e){return Aie(e),e.cases()[e.tag]}function Yjr(e){return Aie(e),e.fields}});var Iy=Y(Uf=>{_();var NMe=An();Object.defineProperty(Uf,"__esModule",{value:!0});Uf.Some=void 0;Uf.bind=sHr;Uf.defaultArg=nHr;Uf.defaultArgWith=tHr;Uf.filter=aHr;Uf.flatten=eHr;Uf.map=iHr;Uf.map2=oHr;Uf.map3=uHr;Uf.ofNullable=Zjr;Uf.some=kie;Uf.toArray=rHr;Uf.toNullable=$jr;Uf.tryOp=lHr;Uf.value=Hm;var Jjr=NMe(at()),Xjr=NMe(it()),Oie=Cc(),_V=function(){function e(r){(0,Jjr.default)(this,e),this.value=r}return(0,Xjr.default)(e,[{key:"toJSON",value:function(){return this.value}},{key:"toString",value:function(){return String(this.value)}},{key:"GetHashCode",value:function(){return(0,Oie.structuralHash)(this.value)}},{key:"Equals",value:function(n){return n==null?!1:(0,Oie.equals)(this.value,n instanceof e?n.value:n)}},{key:"CompareTo",value:function(n){return n==null?1:(0,Oie.compare)(this.value,n instanceof e?n.value:n)}}]),e}();Uf.Some=_V;function kie(e){return e==null||e instanceof _V?new _V(e):e}function Hm(e){if(e==null)throw new Error("Option has no value");return e instanceof _V?e.value:e}function Zjr(e){return e??void 0}function $jr(e){return e==null?null:Hm(e)}function eHr(e){return e==null?void 0:Hm(e)}function rHr(e){return e==null?[]:[Hm(e)]}function nHr(e,r){return e!=null?Hm(e):r}function tHr(e,r){return e!=null?Hm(e):r()}function aHr(e,r){return r!=null?e(Hm(r))?r:void 0:r}function iHr(e,r){return r!=null?kie(e(Hm(r))):void 0}function oHr(e,r,n){return r!=null&&n!=null?e(Hm(r),Hm(n)):void 0}function uHr(e,r,n,a){return r!=null&&n!=null&&a!=null?e(Hm(r),Hm(n),Hm(a)):void 0}function sHr(e,r){return r!=null?e(Hm(r)):void 0}function lHr(e,r){try{return kie(e(r))}catch(n){return}}});var OMe=Y(aN=>{_();Object.defineProperty(aN,"__esModule",{value:!0});aN.ComparisonIdentity_FromFunction=AMe;aN.ComparisonIdentity_Structural=fHr;aN.HashIdentity_FromFunctions=Fie;aN.HashIdentity_Reference=dHr;aN.HashIdentity_Structural=cHr;var RV=Cc();function Fie(e,r){return{Equals:function(a,o){return r(a,o)},GetHashCode:function(a){return e(a)}}}function cHr(){return Fie(RV.structuralHash,RV.equals)}function dHr(){return Fie(RV.physicalHash,function(e,r){return e===r})}function AMe(e){return{Compare:function(n,a){return e(n,a)}}}function fHr(){return AMe(RV.compare)}});var IMe=Y(Wl=>{_();var kMe=An();Object.defineProperty(Wl,"__esModule",{value:!0});Wl.StringBuilder=void 0;Wl.StringBuilder$reflection=vHr;Wl.StringBuilder_$ctor=yHr;Wl.StringBuilder_$ctor_Z18115A39=PV;Wl.StringBuilder_$ctor_Z524259A4=hHr;Wl.StringBuilder_$ctor_Z721C83C5=SHr;Wl.StringBuilder__AppendFormat_433E080=AHr;Wl.StringBuilder__AppendLine=OHr;Wl.StringBuilder__AppendLine_Z721C83C5=kHr;Wl.StringBuilder__Append_244C7CD6=_Hr;Wl.StringBuilder__Append_43A65C09=NHr;Wl.StringBuilder__Append_4E60E31B=PHr;Wl.StringBuilder__Append_5E38073B=THr;Wl.StringBuilder__Append_695F1130=EHr;Wl.StringBuilder__Append_Z1FBCCD16=bHr;Wl.StringBuilder__Append_Z524259A4=RHr;Wl.StringBuilder__Append_Z721C83C5=CHr;Wl.StringBuilder__Clear=MHr;Wl.StringBuilder__ToString_Z37302880=IHr;Wl.StringBuilder__get_Length=FHr;var pHr=kMe(at()),mHr=kMe(it()),TV=N_(),gHr=c0(),FMe=Cc(),bV=Uc(),Iie=function(){function e(r,n){(0,pHr.default)(this,e),this.buf=[],(0,TV.isNullOrEmpty)(r)||this.buf.push(r)}return(0,mHr.default)(e,[{key:"toString",value:function(){var n=this;return(0,TV.join)("",n.buf)}}]),e}();Wl.StringBuilder=Iie;function vHr(){return(0,gHr.class_type)("System.Text.StringBuilder",void 0,Iie)}function PV(e,r){return new Iie(e,r)}function hHr(e){return PV("",e)}function SHr(e){return PV(e,16)}function yHr(){return PV("",16)}function CHr(e,r){return e.buf.push(r),e}function _Hr(e,r){return e.buf.push(r),e}function RHr(e,r){return e.buf.push((0,FMe.int32ToString)(r)),e}function THr(e,r){return e.buf.push(r.toString()),e}function bHr(e,r){return e.buf.push((0,bV.toString)(r)),e}function PHr(e,r){return e.buf.push((0,bV.toString)(r)),e}function EHr(e,r){return e.buf.push(r.join("")),e}function NHr(e,r){return e.buf.push((0,bV.toString)(r)),e}function AHr(e,r,n){return e.buf.push((0,TV.format)(r,n)),e}function OHr(e){return e.buf.push("\n"),e}function kHr(e,r){return e.buf.push(r),e.buf.push("\n"),e}function FHr(e){for(var r=0,n=e.buf.length-1;n>=0;n--)r=r+e.buf[n].length|0;return r|0}function IHr(e,r,n){return(0,TV.substring)((0,bV.toString)(e),r,n)}function MHr(e){return(0,FMe.clear)(e.buf),e}});var wMe=Y(Gf=>{_();var wHr=An();Object.defineProperty(Gf,"__esModule",{value:!0});Gf.ExtraTopLevelOperators_LazyPattern=QHr;Gf.LanguagePrimitives_FastGenericComparer=BHr;Gf.LanguagePrimitives_FastGenericComparerFromTable=qHr;Gf.LanguagePrimitives_FastGenericEqualityComparer=UHr;Gf.LanguagePrimitives_FastGenericEqualityComparerFromTable=GHr;Gf.LanguagePrimitives_GenericEqualityERComparer=Gf.LanguagePrimitives_GenericEqualityComparer=void 0;Gf.Operators_Failure=KHr;Gf.Operators_FailurePattern=VHr;Gf.Operators_Lock=HHr;Gf.Operators_NullArg=WHr;Gf.Operators_Using=jHr;Gf.PrintfModule_PrintFormatToStringBuilder=zHr;Gf.PrintfModule_PrintFormatToStringBuilderThen=MMe;var AV=wHr(V_()),LF=Cc(),OV=OMe(),DHr=IMe(),EV,NV,xHr=(EV={},(0,AV.default)(EV,"System.Collections.IEqualityComparer.Equals541DA560",function(r,n){return(0,LF.equals)(r,n)}),(0,AV.default)(EV,"System.Collections.IEqualityComparer.GetHashCode4E60E31B",function(r){return(0,LF.structuralHash)(r)}),EV);Gf.LanguagePrimitives_GenericEqualityComparer=xHr;var LHr=(NV={},(0,AV.default)(NV,"System.Collections.IEqualityComparer.Equals541DA560",function(r,n){return(0,LF.equals)(r,n)}),(0,AV.default)(NV,"System.Collections.IEqualityComparer.GetHashCode4E60E31B",function(r){return(0,LF.structuralHash)(r)}),NV);Gf.LanguagePrimitives_GenericEqualityERComparer=LHr;function BHr(){return(0,OV.ComparisonIdentity_Structural)()}function qHr(){return(0,OV.ComparisonIdentity_Structural)()}function UHr(){return(0,OV.HashIdentity_Structural)()}function GHr(){return(0,OV.HashIdentity_Structural)()}function KHr(e){return new Error(e)}function VHr(e){return e.message}function WHr(e){throw new Error(e)}function jHr(e,r){try{return r(e)}finally{(0,LF.equals)(e,null)||(0,LF.disposeSafe)(e)}}function HHr(e,r){return r()}function QHr(e){return e.Value}function MMe(e,r,n){return n.cont(function(a){return(0,DHr.StringBuilder__Append_Z721C83C5)(r,a),e()})}function zHr(e,r){return MMe(function(){},e,r)}});var kV=Y(Kf=>{_();Object.defineProperty(Kf,"__esModule",{value:!0});Kf.SR_notEnoughElements=Kf.SR_keyNotFoundAlt=Kf.SR_inputWasEmpty=Kf.SR_inputSequenceTooLong=Kf.SR_inputSequenceEmpty=Kf.SR_inputMustBeNonNegative=Kf.SR_indexOutOfBounds=Kf.SR_differentLengths=void 0;var YHr="The index was outside the range of elements in the collection.";Kf.SR_indexOutOfBounds=YHr;var JHr="Collection was empty.";Kf.SR_inputWasEmpty=JHr;var XHr="The input must be non-negative.";Kf.SR_inputMustBeNonNegative=XHr;var ZHr="The input sequence was empty.";Kf.SR_inputSequenceEmpty=ZHr;var $Hr="The input sequence contains more than one element.";Kf.SR_inputSequenceTooLong=$Hr;var eQr="An index satisfying the predicate was not found in the collection.";Kf.SR_keyNotFoundAlt=eQr;var rQr="The collections had different lengths.";Kf.SR_differentLengths=rQr;var nQr="The input sequence has an insufficient number of elements.";Kf.SR_notEnoughElements=nQr});var qF=Y(qr=>{_();Object.defineProperty(qr,"__esModule",{value:!0});qr.Helpers_allocateArrayFromCons=ol;qr.addInPlace=xMe;qr.addRangeInPlace=IQr;qr.allPairs=dzr;qr.append=tQr;qr.average=Gzr;qr.averageBy=Kzr;qr.choose=YQr;qr.chunkBySize=hzr;qr.collect=vQr;qr.compareWith=yzr;qr.concat=DMe;qr.contains=SQr;qr.copy=bQr;qr.copyTo=LMe;qr.copyToTypedArray=xQr;qr.empty=yQr;qr.equalsWith=Czr;qr.exactlyOne=_zr;qr.exists=Mzr;qr.exists2=wzr;qr.existsOffset=KMe;qr.existsOffset2=VMe;qr.fill=aQr;qr.filter=wie;qr.find=BQr;qr.findBack=WQr;qr.findIndex=UQr;qr.findIndexBack=QQr;qr.findLastIndex=HQr;qr.fold=XQr;qr.fold2=UMe;qr.foldBack=Ozr;qr.foldBack2=kzr;qr.foldBackIndexed=Azr;qr.foldBackIndexed2=GMe;qr.foldIndexed=JQr;qr.foldIndexed2=qMe;qr.forAll=BMe;qr.forAll2=Izr;qr.getSubArray=iQr;qr.head=Tzr;qr.indexOf=xie;qr.indexed=gQr;qr.initialize=_Qr;qr.insertAt=Hzr;qr.insertManyAt=Qzr;qr.insertRangeInPlace=MQr;qr.isEmpty=rzr;qr.item=Ezr;qr.iterate=ZQr;qr.iterate2=$Qr;qr.iterateIndexed=FV;qr.iterateIndexed2=ezr;qr.last=oQr;qr.map=Die;qr.map2=cQr;qr.map3=fQr;qr.mapFold=pQr;qr.mapFoldBack=mQr;qr.mapIndexed=sQr;qr.mapIndexed2=lQr;qr.mapIndexed3=dQr;qr.max=Bzr;qr.maxBy=Lzr;qr.min=Uzr;qr.minBy=qzr;qr.pairwise=RQr;qr.partition=LQr;qr.permute=nzr;qr.pick=KQr;qr.reduce=Ix;qr.reduceBack=Fzr;qr.removeAllInPlace=DQr;qr.removeAt=zzr;qr.removeInPlace=wQr;qr.removeManyAt=Yzr;qr.replicate=TQr;qr.reverse=PQr;qr.scan=EQr;qr.scanBack=NQr;qr.setSlice=tzr;qr.singleton=CQr;qr.skip=AQr;qr.skipWhile=OQr;qr.sort=ozr;qr.sortBy=uzr;qr.sortByDescending=lzr;qr.sortDescending=szr;qr.sortInPlace=izr;qr.sortInPlaceBy=azr;qr.sortWith=czr;qr.splitAt=Szr;qr.splitInto=Wzr;qr.sum=Dzr;qr.sumBy=xzr;qr.tail=Pzr;qr.take=kQr;qr.takeWhile=FQr;qr.transpose=jzr;qr.truncate=Mie;qr.tryExactlyOne=Rzr;qr.tryFind=qQr;qr.tryFindBack=jQr;qr.tryFindIndex=GQr;qr.tryFindIndexBack=zQr;qr.tryHead=bzr;qr.tryItem=Nzr;qr.tryLast=uQr;qr.tryPick=VQr;qr.unfold=fzr;qr.unzip=pzr;qr.unzip3=mzr;qr.updateAt=Jzr;qr.where=hQr;qr.windowed=Vzr;qr.zip=gzr;qr.zip3=vzr;var Vg=Iy(),hh=Cc(),BF=kV();function ol(e,r){return typeof e=="function"?new e(r):new Array(r)}function Fx(){throw new Error("An index satisfying the predicate was not found in the collection.")}function iN(){throw new Error("Arrays had different lengths")}function tQr(e,r,n){for(var a=e.length|0,o=r.length|0,u=ol(n,a+o),t=0;t<=a-1;t++)u[t]=e[t];for(var d=0;d<=o-1;d++)u[d+a]=r[d];return u}function wie(e,r){return r.filter(e)}function aQr(e,r,n,a){var o=r|0;return e.fill(a,o,o+n)}function iQr(e,r,n){var a=r|0;return e.slice(a,a+n)}function oQr(e){if(e.length===0)throw new Error("The input array was empty\\nParameter name: array");return e[e.length-1]}function uQr(e){if(e.length!==0)return(0,Vg.some)(e[e.length-1])}function sQr(e,r,n){for(var a=r.length|0,o=ol(n,a),u=0;u<=a-1;u++)o[u]=e(u,r[u]);return o}function Die(e,r,n){for(var a=r.length|0,o=ol(n,a),u=0;u<=a-1;u++)o[u]=e(r[u]);return o}function lQr(e,r,n,a){if(r.length!==n.length)throw new Error("Arrays had different lengths");for(var o=ol(a,r.length),u=0;u<=r.length-1;u++)o[u]=e(u,r[u],n[u]);return o}function cQr(e,r,n,a){if(r.length!==n.length)throw new Error("Arrays had different lengths");for(var o=ol(a,r.length),u=0;u<=r.length-1;u++)o[u]=e(r[u],n[u]);return o}function dQr(e,r,n,a,o){if(r.length!==n.length||n.length!==a.length)throw new Error("Arrays had different lengths");for(var u=ol(o,r.length),t=0;t<=r.length-1;t++)u[t]=e(t,r[t],n[t],a[t]);return u}function fQr(e,r,n,a,o){if(r.length!==n.length||n.length!==a.length)throw new Error("Arrays had different lengths");for(var u=ol(o,r.length),t=0;t<=r.length-1;t++)u[t]=e(r[t],n[t],a[t]);return u}function pQr(e,r,n,a){var o=n.length|0;if(o===0)return[[],r];for(var u=r,t=ol(a,o),d=0;d<=n.length-1;d++){var s=e(u,n[d]);t[d]=s[0],u=s[1]}return[t,u]}function mQr(e,r,n,a){var o=r.length|0;if(o===0)return[[],n];for(var u=n,t=ol(a,o),d=r.length-1;d>=0;d--){var s=e(r[d],u);t[d]=s[0],u=s[1]}return[t,u]}function gQr(e){for(var r=e.length|0,n=new Array(r),a=0;a<=r-1;a++)n[a]=[a,e[a]];return n}function Mie(e,r){var n=(0,hh.max)(hh.comparePrimitives,0,e)|0,a=0;return r.slice(a,a+n)}function DMe(e,r){var n=Array.isArray(e)?e:Array.from(e),a=n.length|0;switch(a){case 0:return ol(r,0);case 1:return n[0];default:{for(var o=0,u=0,t=0;t<=n.length-1;t++){var d=n[t];u=u+d.length|0}for(var s=ol(r,u),c=0;c<=n.length-1;c++)for(var l=n[c],f=0;f<=l.length-1;f++)s[o]=l[f],o=o+1|0;return s}}}function vQr(e,r,n){return DMe(Die(e,r,null),n)}function hQr(e,r){return r.filter(e)}function xie(e,r,n,a,o){var u=(0,Vg.defaultArg)(n,0)|0,t=(0,Vg.defaultArg)((0,Vg.map)(function(s){return u+s},a),e.length)|0,d=function(c){e:for(;;){var l=c;if(l>=t)return-1;if(o.Equals(r,e[l]))return l|0;c=l+1;continue e;break}};return d(u)|0}function SQr(e,r,n){return xie(r,e,void 0,void 0,n)>=0}function yQr(e){return ol(e,0)}function CQr(e,r){var n=ol(r,1);return n[0]=e,n}function _Qr(e,r,n){if(e<0)throw new Error("The input must be non-negative\\nParameter name: count");for(var a=ol(n,e),o=0;o<=e-1;o++)a[o]=r(o);return a}function RQr(e){if(e.length<2)return[];for(var r=e.length-1|0,n=new Array(r),a=0;a<=r-1;a++)n[a]=[e[a],e[a+1]];return n}function TQr(e,r,n){if(e<0)throw new Error("The input must be non-negative\\nParameter name: count");for(var a=ol(n,e),o=0;o<=a.length-1;o++)a[o]=r;return a}function bQr(e){return e.slice()}function PQr(e){var r=e.slice();return r.reverse()}function EQr(e,r,n,a){var o=ol(a,n.length+1);o[0]=r;for(var u=0;u<=n.length-1;u++)o[u+1]=e(o[u],n[u]);return o}function NQr(e,r,n,a){var o=ol(a,r.length+1);o[r.length]=n;for(var u=r.length-1;u>=0;u--)o[u]=e(r[u],o[u+1]);return o}function AQr(e,r,n){if(e>r.length)throw new Error("count is greater than array length\\nParameter name: count");if(e===r.length)return ol(n,0);var a=(e<0?0:e)|0;return r.slice(a)}function OQr(e,r,n){for(var a=0;a<r.length&&e(r[a]);)a=a+1|0;if(a===r.length)return ol(n,0);var o=a|0;return r.slice(o)}function kQr(e,r,n){if(e<0)throw new Error("The input must be non-negative\\nParameter name: count");if(e>r.length)throw new Error("count is greater than array length\\nParameter name: count");if(e===0)return ol(n,0);var a=0;return r.slice(a,a+e)}function FQr(e,r,n){for(var a=0;a<r.length&&e(r[a]);)a=a+1|0;if(a===0)return ol(n,0);var o=0,u=a|0;return r.slice(o,o+u)}function xMe(e,r){r.push(e)}function IQr(e,r){var n=(0,hh.getEnumerator)(e);try{for(;n["System.Collections.IEnumerator.MoveNext"]();)xMe(n["System.Collections.Generic.IEnumerator`1.get_Current"](),r)}finally{(0,hh.disposeSafe)(n)}}function MQr(e,r,n){var a,o=e,u=(0,hh.getEnumerator)(r);try{for(;u["System.Collections.IEnumerator.MoveNext"]();){var t=u["System.Collections.Generic.IEnumerator`1.get_Current"]();a=o|0,n.splice(a,0,t),o=o+1|0}}finally{(0,hh.disposeSafe)(u)}}function wQr(e,r,n){var a=xie(r,e,void 0,void 0,n)|0;return a>-1?(r.splice(a,1),!0):!1}function DQr(e,r){var n=function a(o){var u=r.findIndex(e)|0;return u>-1?(r.splice(u,1),a(o)+1|0):o|0};return n(0)|0}function LMe(e,r,n,a,o){for(var u=a-r|0,t=r;t<=r+o-1;t++)n[t+u]=e[t]}function xQr(e,r,n,a,o){try{n.set(e.subarray(r,r+o),a)}catch(u){LMe(e,r,n,a,o)}}function LQr(e,r,n){for(var a=r.length|0,o=ol(n,a),u=ol(n,a),t=0,d=0,s=0;s<=a-1;s++)e(r[s])?(o[t]=r[s],t=t+1|0):(u[d]=r[s],d=d+1|0);return[Mie(t,o),Mie(d,u)]}function BQr(e,r){var n=r.find(e);return n==null?Fx():(0,Vg.value)(n)}function qQr(e,r){return r.find(e)}function UQr(e,r){var n=r.findIndex(e)|0;return n>-1?n|0:Fx()|0}function GQr(e,r){var n=r.findIndex(e)|0;if(n>-1)return n}function KQr(e,r){var n=function(o){e:for(;;){var u=o;if(u>=r.length)return Fx();var t=e(r[u]);if(t!=null)return(0,Vg.value)(t);o=u+1;continue e;break}};return n(0)}function VQr(e,r){var n=function(o){e:for(;;){var u=o;if(u>=r.length)return;var t=e(r[u]);if(t==null){o=u+1;continue e}else return t;break}};return n(0)}function WQr(e,r){var n=function(o){e:for(;;){var u=o;if(u<0)return Fx();if(e(r[u]))return r[u];o=u-1;continue e;break}};return n(r.length-1)}function jQr(e,r){var n=function(o){e:for(;;){var u=o;if(u<0)return;if(e(r[u]))return(0,Vg.some)(r[u]);o=u-1;continue e;break}};return n(r.length-1)}function HQr(e,r){var n=function(o){e:for(;;){var u=o;if(u<0)return-1;if(e(r[u]))return u|0;o=u-1;continue e;break}};return n(r.length-1)|0}function QQr(e,r){var n=function(o){e:for(;;){var u=o;if(u<0)return Fx()|0;if(e(r[u]))return u|0;o=u-1;continue e;break}};return n(r.length-1)|0}function zQr(e,r){var n=function(o){e:for(;;){var u=o;if(u<0)return;if(e(r[u]))return u;o=u-1;continue e;break}};return n(r.length-1)}function YQr(e,r,n){for(var a=[],o=0;o<=r.length-1;o++){var u=e(r[o]);if(u!=null){var t=(0,Vg.value)(u);a.push(t)}}return typeof n=="function"?Die(function(d){return d},a,n):a}function JQr(e,r,n){return n.reduce(function(a,o,u){return e(u,a,o)},r)}function XQr(e,r,n){return n.reduce(e,r)}function ZQr(e,r){for(var n=0;n<=r.length-1;n++)e(r[n])}function FV(e,r){for(var n=0;n<=r.length-1;n++)e(n,r[n])}function $Qr(e,r,n){r.length!==n.length&&iN();for(var a=0;a<=r.length-1;a++)e(r[a],n[a])}function ezr(e,r,n){r.length!==n.length&&iN();for(var a=0;a<=r.length-1;a++)e(a,r[a],n[a])}function rzr(e){return e.length===0}function BMe(e,r){return r.every(e)}function nzr(e,r){var n=r.length|0,a=r.slice(),o=new Array(n);if(FV(function(u,t){var d=e(u)|0;if(d<0||d>=n)throw new Error("Not a valid permutation");a[d]=t,o[d]=1},r),!o.every(function(u){return u===1}))throw new Error("Not a valid permutation");return a}function tzr(e,r,n,a){for(var o=(0,Vg.defaultArg)(r,0)|0,u=(0,Vg.defaultArg)(n,-1)|0,t=(u>=0?u:e.length-1)-o|0,d=0;d<=t;d++)e[d+o]=a[d]}function azr(e,r,n){r.sort(function(a,o){return n.Compare(e(a),e(o))})}function izr(e,r){e.sort(function(n,a){return r.Compare(n,a)})}function ozr(e,r){var n=e.slice();return n.sort(function(a,o){return r.Compare(a,o)}),n}function uzr(e,r,n){var a=r.slice();return a.sort(function(o,u){return n.Compare(e(o),e(u))}),a}function szr(e,r){var n=e.slice();return n.sort(function(a,o){return r.Compare(a,o)*-1}),n}function lzr(e,r,n){var a=r.slice();return a.sort(function(o,u){return n.Compare(e(o),e(u))*-1}),a}function czr(e,r){var n=e,a=r.slice();return a.sort(n),a}function dzr(e,r){for(var n=e.length|0,a=r.length|0,o=new Array(n*a),u=0;u<=e.length-1;u++)for(var t=0;t<=r.length-1;t++)o[u*a+t]=[e[u],r[t]];return o}function fzr(e,r){var n=[],a=function(u){e:for(;;){var t=u,d=e(t);if(d!=null){var s=d[0],c=d[1];n.push(s),u=c;continue e}break}};return a(r),n}function pzr(e){var r=e.length|0,n=new Array(r),a=new Array(r);return FV(function(o,u){n[o]=u[0],a[o]=u[1]},e),[n,a]}function mzr(e){var r=e.length|0,n=new Array(r),a=new Array(r),o=new Array(r);return FV(function(u,t){n[u]=t[0],a[u]=t[1],o[u]=t[2]},e),[n,a,o]}function gzr(e,r){e.length!==r.length&&iN();for(var n=new Array(e.length),a=0;a<=e.length-1;a++)n[a]=[e[a],r[a]];return n}function vzr(e,r,n){(e.length!==r.length||r.length!==n.length)&&iN();for(var a=new Array(e.length),o=0;o<=e.length-1;o++)a[o]=[e[o],r[o],n[o]];return a}function hzr(e,r){if(e<1)throw new Error("The input must be positive.\\nParameter name: size");if(r.length===0)return[[]];for(var n=[],a=0;a<=~~Math.ceil(r.length/e)-1;a++){var o=void 0,u=a*e|0;o=r.slice(u,u+e),n.push(o)}return n}function Szr(e,r){var n;if(e<0||e>r.length)throw new Error(BF.SR_indexOutOfBounds+"\\nParameter name: index");return[(n=0,r.slice(n,n+e)),r.slice(e)]}function yzr(e,r,n){if(r==null)return n==null?0:-1;if(n==null)return 1;var a=0,o=0,u=r.length|0,t=n.length|0;if(u>t)return 1;if(u<t)return-1;for(;a<u&&o===0;)o=e(r[a],n[a])|0,a=a+1|0;return o|0}function Czr(e,r,n){if(r==null)return n==null;if(n==null)return!1;var a=0,o=!0,u=r.length|0,t=n.length|0;if(u>t)return!1;if(u<t)return!1;for(;a<u&&o;)o=e(r[a],n[a]),a=a+1|0;return o}function _zr(e){if(e.length===1)return e[0];throw e.length===0?new Error("The input sequence was empty\\nParameter name: array"):new Error("Input array too long\\nParameter name: array")}function Rzr(e){if(e.length===1)return(0,Vg.some)(e[0])}function Tzr(e){if(e.length===0)throw new Error("The input array was empty\\nParameter name: array");return e[0]}function bzr(e){if(e.length!==0)return(0,Vg.some)(e[0])}function Pzr(e){if(e.length===0)throw new Error("Not enough elements\\nParameter name: array");return e.slice(1)}function Ezr(e,r){return r[e]}function Nzr(e,r){if(!(e<0||e>=r.length))return(0,Vg.some)(r[e])}function Azr(e,r,n){return r.reduceRight(function(a,o,u){return e(u,o,a)},n)}function Ozr(e,r,n){return r.reduceRight(function(a,o){return e(o,a)},n)}function qMe(e,r,n,a){var o=r;if(n.length!==a.length)throw new Error("Arrays have different lengths");for(var u=0;u<=n.length-1;u++)o=e(u,o,n[u],a[u]);return o}function UMe(e,r,n,a){return qMe(function(o,u,t,d){return e(u,t,d)},r,n,a)}function GMe(e,r,n,a){var o=a;r.length!==n.length&&iN();for(var u=r.length|0,t=1;t<=u;t++)o=e(t-1,r[u-t],n[u-t],o);return o}function kzr(e,r,n,a){return GMe(function(o,u,t,d){return e(u,t,d)},r,n,a)}function Ix(e,r){if(r.length===0)throw new Error("The input array was empty");var n=e;return r.reduce(n)}function Fzr(e,r){if(r.length===0)throw new Error("The input array was empty");var n=e;return r.reduceRight(n)}function Izr(e,r,n){return UMe(function(a,o,u){return a&&e(o,u)},!0,r,n)}function KMe(e,r,n){e:for(;;){var a=e,o=r,u=n;if(u===o.length)return!1;if(a(o[u]))return!0;e=a,r=o,n=u+1;continue e;break}}function Mzr(e,r){return KMe(e,r,0)}function VMe(e,r,n,a){e:for(;;){var o=e,u=r,t=n,d=a;if(d===u.length)return!1;if(o(u[d],t[d]))return!0;e=o,r=u,n=t,a=d+1;continue e;break}}function wzr(e,r,n){return r.length!==n.length&&iN(),VMe(e,r,n,0)}function Dzr(e,r){for(var n=r.GetZero(),a=0;a<=e.length-1;a++)n=r.Add(n,e[a]);return n}function xzr(e,r,n){for(var a=n.GetZero(),o=0;o<=r.length-1;o++)a=n.Add(a,e(r[o]));return a}function Lzr(e,r,n){return Ix(function(a,o){return n.Compare(e(o),e(a))>0?o:a},r)}function Bzr(e,r){return Ix(function(n,a){return r.Compare(a,n)>0?a:n},e)}function qzr(e,r,n){return Ix(function(a,o){return n.Compare(e(o),e(a))>0?a:o},r)}function Uzr(e,r){return Ix(function(n,a){return r.Compare(a,n)>0?n:a},e)}function Gzr(e,r){if(e.length===0)throw new Error("The input array was empty\\nParameter name: array");for(var n=r.GetZero(),a=0;a<=e.length-1;a++)n=r.Add(n,e[a]);return r.DivideByInt(n,e.length)}function Kzr(e,r,n){if(r.length===0)throw new Error("The input array was empty\\nParameter name: array");for(var a=n.GetZero(),o=0;o<=r.length-1;o++)a=n.Add(a,e(r[o]));return n.DivideByInt(a,r.length)}function Vzr(e,r){if(e<=0)throw new Error("windowSize must be positive");var n,a=(0,hh.max)(hh.comparePrimitives,0,r.length-e+1)|0;n=new Array(a);for(var o=e;o<=r.length;o++)n[o-e]=r.slice(o-e,o-1+1);return n}function Wzr(e,r){if(e<1)throw new Error("The input must be positive.\\nParameter name: chunks");if(r.length===0)return[[]];for(var n=[],a=(0,hh.min)(hh.comparePrimitives,e,r.length)|0,o=~~(r.length/a)|0,u=r.length%a|0,t=0;t<=a-1;t++){var d=(t<u?o+1:o)|0,s=void 0,c=t*o+(0,hh.min)(hh.comparePrimitives,u,t)|0;s=r.slice(c,c+d),n.push(s)}return n}function jzr(e,r){var n=Array.isArray(e)?e:Array.from(e),a=n.length|0;if(a===0)return new Array(0);var o=n[0],u=o.length|0;BMe(function(c){return c.length===u},n)||iN();for(var t=new Array(u),d=0;d<=u-1;d++){t[d]=ol(r,a);for(var s=0;s<=a-1;s++)t[d][s]=n[s][d]}return t}function Hzr(e,r,n){var a=n.length|0;if(e<0||e>a)throw new Error(BF.SR_indexOutOfBounds+"\\nParameter name: index");for(var o=new n.constructor(a+1),u=0;u<=e-1;u++)o[u]=n[u];o[e]=r;for(var t=e;t<=a-1;t++)o[t+1]=n[t];return o}function Qzr(e,r,n){var a=n.length|0;if(e<0||e>a)throw new Error(BF.SR_indexOutOfBounds+"\\nParameter name: index");for(var o=Array.from(r),u=o.length|0,t=new n.constructor(a+u),d=0;d<=e-1;d++)t[d]=n[d];for(var s=0;s<=u-1;s++)t[e+s]=o[s];for(var c=e;c<=a-1;c++)t[c+u]=n[c];return t}function zzr(e,r){if(e<0||e>=r.length)throw new Error(BF.SR_indexOutOfBounds+"\\nParameter name: index");var n=-1;return wie(function(a){return n=n+1|0,n!==e},r)}function Yzr(e,r,n){var a=-1,o=-1,u=wie(function(s){return a=a+1|0,a===e?(o=0,!1):a>e?a<e+r?!1:(o=1,!0):!0},n),t=(o===0&&a+1===e+r?1:o)|0;if(t<1){var d=t<0?"index":"count";throw new Error(BF.SR_indexOutOfBounds+"\\nParameter name: "+d)}return u}function Jzr(e,r,n){var a=n.length|0;if(e<0||e>=a)throw new Error(BF.SR_indexOutOfBounds+"\\nParameter name: index");for(var o=new n.constructor(a),u=0;u<=a-1;u++)o[u]=u===e?r:n[u];return o}});var O_=Y(Ur=>{_();var Mx=An();Object.defineProperty(Ur,"__esModule",{value:!0});Ur.FSharpList=void 0;Ur.FSharpList$reflection=QMe;Ur.FSharpList_Cons_305B8EAC=hp;Ur.FSharpList__get_Head=fu;Ur.FSharpList__get_IsEmpty=So;Ur.FSharpList__get_Item_Z524259A4=YMe;Ur.FSharpList__get_Length=MV;Ur.FSharpList__get_Tail=Ka;Ur.FSharpList_get_Empty=ga;Ur.ListEnumerator$1=void 0;Ur.ListEnumerator$1$reflection=tYr;Ur.ListEnumerator$1_$ctor_3002E699=zMe;Ur.allPairs=iJr;Ur.append=Bie;Ur.average=rJr;Ur.averageBy=nJr;Ur.choose=MYr;Ur.chunkBySize=aJr;Ur.collect=CYr;Ur.compareWith=cYr;Ur.concat=hYr;Ur.cons=iYr;Ur.contains=wYr;Ur.empty=aYr;Ur.exactlyOne=dJr;Ur.exists=qYr;Ur.exists2=UYr;Ur.filter=xV;Ur.find=EYr;Ur.findBack=NYr;Ur.findIndex=AYr;Ur.findIndexBack=OYr;Ur.fold=Xd;Ur.fold2=Dx;Ur.foldBack=wV;Ur.foldBack2=dYr;Ur.foldIndexed=ZMe;Ur.forAll=LYr;Ur.forAll2=BYr;Ur.getSlice=lJr;Ur.head=Uie;Ur.indexed=RYr;Ur.initialize=u3e;Ur.insertAt=SJr;Ur.insertManyAt=yJr;Ur.isEmpty=uYr;Ur.item=FYr;Ur.iterate=IV;Ur.iterate2=pYr;Ur.iterateIndexed=mYr;Ur.iterateIndexed2=gYr;Ur.last=lYr;Ur.length=JMe;Ur.map=_Yr;Ur.map2=r3e;Ur.map3=n3e;Ur.mapFold=t3e;Ur.mapFoldBack=bYr;Ur.mapIndexed=Kie;Ur.mapIndexed2=TYr;Ur.max=ZYr;Ur.maxBy=XYr;Ur.min=eJr;Ur.minBy=$Yr;Ur.ofArray=zm;Ur.ofArrayWithTail=$Me;Ur.ofSeq=e3e;Ur.pairwise=mJr;Ur.partition=IYr;Ur.permute=tJr;Ur.pick=PYr;Ur.reduce=xx;Ur.reduceBack=xYr;Ur.removeAt=CJr;Ur.removeManyAt=_Jr;Ur.replicate=DYr;Ur.reverse=wx;Ur.scan=SYr;Ur.scanBack=yYr;Ur.singleton=oYr;Ur.skip=Wie;Ur.skipWhile=oJr;Ur.sort=jYr;Ur.sortBy=HYr;Ur.sortByDescending=zYr;Ur.sortDescending=QYr;Ur.sortWith=Lx;Ur.splitAt=cJr;Ur.splitInto=vJr;Ur.sum=YYr;Ur.sumBy=JYr;Ur.tail=Gie;Ur.take=jie;Ur.takeWhile=uJr;Ur.toArray=Qm;Ur.toSeq=vYr;Ur.transpose=hJr;Ur.truncate=sJr;Ur.tryExactlyOne=fJr;Ur.tryFind=a3e;Ur.tryFindBack=i3e;Ur.tryFindIndex=DV;Ur.tryFindIndexBack=o3e;Ur.tryHead=sYr;Ur.tryItem=kYr;Ur.tryLast=XMe;Ur.tryPick=Vie;Ur.unfold=fYr;Ur.unzip=GYr;Ur.unzip3=KYr;Ur.updateAt=RJr;Ur.where=pJr;Ur.windowed=gJr;Ur.zip=VYr;Ur.zip3=WYr;var jMe=Mx(at()),HMe=Mx(it()),Xzr=Mx(Qf()),Zzr=Mx(zf()),WMe=Mx(Ed()),$zr=N_(),Sh=Cc(),eYr=Uc(),Lie=c0(),xs=kV(),yh=Iy(),Sp=qF();function rYr(e){var r=nYr();return function(){var a=(0,WMe.default)(e),o;if(r){var u=(0,WMe.default)(this).constructor;o=Reflect.construct(a,arguments,u)}else o=a.apply(this,arguments);return(0,Zzr.default)(this,o)}}function nYr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Ss=function(e,r){(0,Xzr.default)(a,e);var n=rYr(a);function a(o,u){var t;return(0,jMe.default)(this,a),t=n.call(this),t.head=o,t.tail=u,t}return(0,HMe.default)(a,[{key:"toString",value:function(){var u=this;return"["+(0,$zr.join)("; ",u)+"]"}},{key:"Equals",value:function(u){var t=this;if(t===u)return!0;var d=function(c,l){e:for(;;){var f=c,p=l,m=[f.tail,p.tail];if(m[0]!=null)if(m[1]!=null){var v=m[0],h=m[1];if((0,Sh.equals)(f.head,p.head)){c=v,l=h;continue e}else return!1}else return!1;else return m[1]==null;break}};return d(t,u)}},{key:"GetHashCode",value:function(){var u=this,t=function(s,c,l){e:for(;;){var f=s,p=c,m=l,v=m.tail;if(v!=null){var h=v;if(f>18)return p|0;s=f+1,c=(p<<1)+(0,Sh.structuralHash)(m.head)+631*f,l=h;continue e}else return p|0;break}};return t(0,0,u)|0}},{key:"toJSON",value:function(u){var t=this;return Array.from(t)}},{key:"CompareTo",value:function(u){var t=this,d=function(c,l){e:for(;;){var f=c,p=l,m=[f.tail,p.tail];if(m[0]!=null)if(m[1]!=null){var v=m[0],h=m[1],S=(0,Sh.compare)(f.head,p.head)|0;if(S===0){c=v,l=h;continue e}else return S|0}else return 1;else return m[1]!=null?-1:0;break}};return d(t,u)|0}},{key:"GetEnumerator",value:function(){var u=this;return zMe(u)}},{key:r,value:function(){return(0,Sh.toIterator)(this.GetEnumerator())}},{key:"System.Collections.IEnumerable.GetEnumerator",value:function(){var u=this;return(0,Sh.getEnumerator)(u)}}]),a}(eYr.Record,Symbol.iterator);Ur.FSharpList=Ss;function QMe(e){return(0,Lie.record_type)("ListModule.FSharpList",[e],Ss,function(){return[["head",e],["tail",(0,Lie.option_type)(QMe(e))]]})}var qie=function(){function e(r){(0,jMe.default)(this,e),this.xs=r,this.it=this.xs,this.current=null}return(0,HMe.default)(e,[{key:"System.Collections.Generic.IEnumerator`1.get_Current",value:function(){var n=this;return n.current}},{key:"System.Collections.IEnumerator.get_Current",value:function(){var n=this;return n.current}},{key:"System.Collections.IEnumerator.MoveNext",value:function(){var n=this,a=n.it.tail;if(a!=null){var o=a;return n.current=n.it.head,n.it=o,!0}else return!1}},{key:"System.Collections.IEnumerator.Reset",value:function(){var n=this;n.it=n.xs,n.current=null}},{key:"Dispose",value:function(){}}]),e}();Ur.ListEnumerator$1=qie;function tYr(e){return(0,Lie.class_type)("ListModule.ListEnumerator`1",[e],qie)}function zMe(e){return new qie(e)}function ga(){return new Ss(null,void 0)}function hp(e,r){return new Ss(e,r)}function So(e){return e.tail==null}function MV(e){var r=function(a,o){e:for(;;){var u=a,t=o,d=t.tail;if(d!=null){a=u+1,o=d;continue e}else return u|0;break}};return r(0,e)|0}function fu(e){var r=e.tail;if(r!=null)return e.head;throw new Error(xs.SR_inputWasEmpty+"\\nParameter name: list")}function Ka(e){var r=e.tail;if(r!=null)return r;throw new Error(xs.SR_inputWasEmpty+"\\nParameter name: list")}function YMe(e,r){var n=function(o,u){e:for(;;){var t=o,d=u,s=d.tail;if(s!=null){if(t===r)return d.head;o=t+1,u=s;continue e}else throw new Error(xs.SR_indexOutOfBounds+"\\nParameter name: index");break}};return n(0,e)}function aYr(){return ga()}function iYr(e,r){return hp(e,r)}function oYr(e){return hp(e,ga())}function uYr(e){return So(e)}function JMe(e){return MV(e)}function Uie(e){return fu(e)}function sYr(e){if(!So(e))return(0,yh.some)(fu(e))}function Gie(e){return Ka(e)}function XMe(e){e:for(;;){var r=e;if(So(r))return;var n=Ka(r);if(So(n))return(0,yh.some)(fu(r));e=n;continue e;break}}function lYr(e){var r=XMe(e);if(r==null)throw new Error(xs.SR_inputWasEmpty);return(0,yh.value)(r)}function cYr(e,r,n){var a=function(u,t){e:for(;;){var d=u,s=t,c=[So(d),So(s)];if(c[0])return c[1]?0:-1;if(c[1])return 1;var l=e(fu(d),fu(s))|0;if(l===0){u=Ka(d),t=Ka(s);continue e}else return l|0;break}};return a(r,n)|0}function Qm(e){var r=MV(e)|0,n=(0,Sp.fill)(new Array(r),0,r,null),a=function(u,t){e:for(;;){var d=u,s=t;if(!So(s)){n[d]=fu(s),u=d+1,t=Ka(s);continue e}break}};return a(0,e),n}function Xd(e,r,n){for(var a=r,o=n;!So(o);)a=e(a,fu(o)),o=Ka(o);return a}function wx(e){return Xd(function(r,n){return hp(n,r)},ga(),e)}function wV(e,r,n){return(0,Sp.foldBack)(e,Qm(r),n)}function ZMe(e,r,n){var a=function(u,t,d){e:for(;;){var s=u,c=t,l=d;if(So(l))return c;u=s+1,t=e(s,c,fu(l)),d=Ka(l);continue e;break}};return a(0,r,n)}function Dx(e,r,n,a){for(var o=r,u=n,t=a;!So(u)&&!So(t);)o=e(o,fu(u),fu(t)),u=Ka(u),t=Ka(t);return o}function dYr(e,r,n,a){return(0,Sp.foldBack2)(e,Qm(r),Qm(n),a)}function fYr(e,r){var n=function(d,s){var c;e:for(;;){var l=d,f=s,p=e(l);if(p!=null){d=p[1],s=(c=new Ss(p[0],void 0),f.tail=c,c);continue e}else return f;break}},a=ga(),o=n(r,a),u=ga();return o.tail=u,Ka(a)}function IV(e,r){Xd(function(n,a){e(a)},void 0,r)}function pYr(e,r,n){Dx(function(a,o,u){e(o,u)},void 0,r,n)}function mYr(e,r){Xd(function(n,a){return e(n,a),n+1|0},0,r)}function gYr(e,r,n){Dx(function(a,o,u){return e(a,o,u),a+1|0},0,r,n)}function vYr(e){return e}function $Me(e,r){for(var n=r,a=e.length-1;a>=0;a--)n=hp(e[a],n);return n}function zm(e){return $Me(e,ga())}function e3e(e){var r,n;if((0,Sh.isArrayLike)(e))return zm(e);if(e instanceof Ss)return e;var a=ga(),o=a,u=(0,Sh.getEnumerator)(e);try{for(;u["System.Collections.IEnumerator.MoveNext"]();){var t=u["System.Collections.Generic.IEnumerator`1.get_Current"]();o=(r=o,n=new Ss(t,void 0),r.tail=n,n)}}finally{(0,Sh.disposeSafe)(u)}var d=o,s=ga();return d.tail=s,Ka(a)}function hYr(e){var r=ga(),n=r,a=function(s){n=Xd(function(c,l){var f=new Ss(l,void 0);return c.tail=f,f},n,s)};if((0,Sh.isArrayLike)(e))e.forEach(a);else if(e instanceof Ss)IV(a,e);else{var o=(0,Sh.getEnumerator)(e);try{for(;o["System.Collections.IEnumerator.MoveNext"]();)a(o["System.Collections.Generic.IEnumerator`1.get_Current"]())}finally{(0,Sh.disposeSafe)(o)}}var u=n,t=ga();return u.tail=t,Ka(r)}function SYr(e,r,n){var a,o,u=ga(),t,d=new Ss(r,void 0);u.tail=d,t=d;for(var s=r,c=n;!So(c);)s=e(s,fu(c)),t=(a=t,o=new Ss(s,void 0),a.tail=o,o),c=Ka(c);var l=t,f=ga();return l.tail=f,Ka(u)}function yYr(e,r,n){return zm((0,Sp.scanBack)(e,Qm(r),n))}function Bie(e,r){return Xd(function(n,a){return hp(a,n)},r,wx(e))}function CYr(e,r){for(var n,a,o=ga(),u=o,t=r;!So(t);){for(var d=e(fu(t));!So(d);)u=(n=u,a=new Ss(fu(d),void 0),n.tail=a,a),d=Ka(d);t=Ka(t)}var s=u,c=ga();return s.tail=c,Ka(o)}function Kie(e,r){var n=ga(),a=ZMe(function(u,t,d){var s=new Ss(e(u,d),void 0);return t.tail=s,s},n,r),o=ga();return a.tail=o,Ka(n)}function _Yr(e,r){var n=ga(),a=Xd(function(u,t){var d=new Ss(e(t),void 0);return u.tail=d,d},n,r),o=ga();return a.tail=o,Ka(n)}function RYr(e){return Kie(function(r,n){return[r,n]},e)}function r3e(e,r,n){var a=ga(),o=Dx(function(t,d,s){var c=new Ss(e(d,s),void 0);return t.tail=c,c},a,r,n),u=ga();return o.tail=u,Ka(a)}function TYr(e,r,n){var a=function(s,c,l,f){var p;e:for(;;){var m=s,v=c,h=l,S=f;if(So(h)||So(S))return v;s=m+1,c=(p=new Ss(e(m,fu(h),fu(S)),void 0),v.tail=p,p),l=Ka(h),f=Ka(S);continue e;break}},o=ga(),u=a(0,o,r,n),t=ga();return u.tail=t,Ka(o)}function n3e(e,r,n,a){var o=function(c,l,f,p){var m;e:for(;;){var v=c,h=l,S=f,y=p;if(So(h)||So(S)||So(y))return v;c=(m=new Ss(e(fu(h),fu(S),fu(y)),void 0),v.tail=m,m),l=Ka(h),f=Ka(S),p=Ka(y);continue e;break}},u=ga(),t=o(u,r,n,a),d=ga();return t.tail=d,Ka(u)}function t3e(e,r,n){var a=ga(),o=Xd(function(t,d){var s,c=e(t[1],d);return[(s=new Ss(c[0],void 0),t[0].tail=s,s),c[1]]},[a,r],n),u=ga();return o[0].tail=u,[Ka(a),o[1]]}function bYr(e,r,n){return t3e(function(a,o){return e(o,a)},n,wx(r))}function Vie(e,r){var n=function(o){e:for(;;){var u=o;if(So(u))return;var t=e(fu(u));if(t==null){o=Ka(u);continue e}else return t;break}};return n(r)}function PYr(e,r){var n=Vie(e,r);if(n==null)throw new Error(xs.SR_keyNotFoundAlt);return(0,yh.value)(n)}function a3e(e,r){return Vie(function(n){return e(n)?(0,yh.some)(n):void 0},r)}function EYr(e,r){var n=a3e(e,r);if(n==null)throw new Error(xs.SR_keyNotFoundAlt);return(0,yh.value)(n)}function i3e(e,r){return(0,Sp.tryFindBack)(e,Qm(r))}function NYr(e,r){var n=i3e(e,r);if(n==null)throw new Error(xs.SR_keyNotFoundAlt);return(0,yh.value)(n)}function DV(e,r){var n=function(o,u){e:for(;;){var t=o,d=u;if(So(d))return;if(e(fu(d)))return t;o=t+1,u=Ka(d);continue e;break}};return n(0,r)}function AYr(e,r){var n=DV(e,r);if(n==null)throw new Error(xs.SR_keyNotFoundAlt);return n|0}function o3e(e,r){return(0,Sp.tryFindIndexBack)(e,Qm(r))}function OYr(e,r){var n=o3e(e,r);if(n==null)throw new Error(xs.SR_keyNotFoundAlt);return n|0}function kYr(e,r){var n=function(o,u){e:for(;;){var t=o,d=u;if(So(d))return;if(t===e)return(0,yh.some)(fu(d));o=t+1,u=Ka(d);continue e;break}};return n(0,r)}function FYr(e,r){return YMe(r,e)}function xV(e,r){var n=ga(),a=Xd(function(u,t){if(e(t)){var d=new Ss(t,void 0);return u.tail=d,d}else return u},n,r),o=ga();return a.tail=o,Ka(n)}function IYr(e,r){var n=[ga(),ga()],a=n[1],o=n[0],u=Xd((0,Sh.uncurry)(2,function(s){var c=s[0],l=s[1];return function(f){var p,m;return e(f)?[(p=new Ss(f,void 0),c.tail=p,p),l]:[c,(m=new Ss(f,void 0),l.tail=m,m)]}}),[o,a],r),t=ga();u[0].tail=t;var d=ga();return u[1].tail=d,[Ka(o),Ka(a)]}function MYr(e,r){var n=ga(),a=Xd(function(u,t){var d=e(t);if(d==null)return u;var s=new Ss((0,yh.value)(d),void 0);return u.tail=s,s},n,r),o=ga();return a.tail=o,Ka(n)}function wYr(e,r,n){return DV(function(a){return n.Equals(e,a)},r)!=null}function u3e(e,r){for(var n,a,o=ga(),u=o,t=0;t<=e-1;t++)u=(n=u,a=new Ss(r(t),void 0),n.tail=a,a);var d=u,s=ga();return d.tail=s,Ka(o)}function DYr(e,r){return u3e(e,function(n){return r})}function xx(e,r){if(So(r))throw new Error(xs.SR_inputWasEmpty);return Xd(e,Uie(r),Gie(r))}function xYr(e,r){if(So(r))throw new Error(xs.SR_inputWasEmpty);return wV(e,Gie(r),Uie(r))}function LYr(e,r){return Xd(function(n,a){return n&&e(a)},!0,r)}function BYr(e,r,n){return Dx(function(a,o,u){return a&&e(o,u)},!0,r,n)}function qYr(e,r){return DV(e,r)!=null}function UYr(e,r,n){e:for(;;){var a=e,o=r,u=n,t=[So(o),So(u)],d=void 0;switch(t[0]?t[1]?d=0:d=2:t[1]?d=2:d=1,d){case 0:return!1;case 1:{if(a(fu(o),fu(u)))return!0;e=a,r=Ka(o),n=Ka(u);continue e}case 2:throw new Error(xs.SR_differentLengths+"\\nParameter name: list2")}break}}function GYr(e){return wV(function(r,n){return[hp(r[0],n[0]),hp(r[1],n[1])]},e,[ga(),ga()])}function KYr(e){return wV(function(r,n){return[hp(r[0],n[0]),hp(r[1],n[1]),hp(r[2],n[2])]},e,[ga(),ga(),ga()])}function VYr(e,r){return r3e(function(n,a){return[n,a]},e,r)}function WYr(e,r,n){return n3e(function(a,o,u){return[a,o,u]},e,r,n)}function Lx(e,r){var n=Qm(r);return n.sort(e),zm(n)}function jYr(e,r){return Lx(function(n,a){return r.Compare(n,a)},e)}function HYr(e,r,n){return Lx(function(a,o){return n.Compare(e(a),e(o))},r)}function QYr(e,r){return Lx(function(n,a){return r.Compare(n,a)*-1},e)}function zYr(e,r,n){return Lx(function(a,o){return n.Compare(e(a),e(o))*-1},r)}function YYr(e,r){return Xd(function(n,a){return r.Add(n,a)},r.GetZero(),e)}function JYr(e,r,n){return Xd(function(a,o){return n.Add(a,e(o))},n.GetZero(),r)}function XYr(e,r,n){return xx(function(a,o){return n.Compare(e(o),e(a))>0?o:a},r)}function ZYr(e,r){return xx(function(n,a){return r.Compare(a,n)>0?a:n},e)}function $Yr(e,r,n){return xx(function(a,o){return n.Compare(e(o),e(a))>0?a:o},r)}function eJr(e,r){return xx(function(n,a){return r.Compare(a,n)>0?n:a},e)}function rJr(e,r){var n=0,a=Xd(function(o,u){return n=n+1|0,r.Add(o,u)},r.GetZero(),e);return r.DivideByInt(a,n)}function nJr(e,r,n){var a=0,o=Xd(function(u,t){return a=a+1|0,n.Add(u,e(t))},n.GetZero(),r);return n.DivideByInt(o,a)}function tJr(e,r){return zm((0,Sp.permute)(e,Qm(r)))}function aJr(e,r){return zm((0,Sp.map)(zm,(0,Sp.chunkBySize)(e,Qm(r))))}function iJr(e,r){var n=ga(),a=n;IV(function(t){IV(function(d){var s,c;a=(s=a,c=new Ss([t,d],void 0),s.tail=c,c)},r)},e);var o=a,u=ga();return o.tail=u,Ka(n)}function Wie(e,r){e:for(;;){var n=e,a=r;if(n<=0)return a;if(So(a))throw new Error(xs.SR_notEnoughElements+"\\nParameter name: list");e=n-1,r=Ka(a);continue e;break}}function oJr(e,r){e:for(;;){var n=e,a=r;if(So(a))return a;if(n(fu(a))){e=n,r=Ka(a);continue e}else return a;break}}function jie(e,r){if(e<0)throw new Error(xs.SR_inputMustBeNonNegative+"\\nParameter name: count");var n=function(d,s,c){var l;e:for(;;){var f=d,p=s,m=c;if(f<=0)return p;if(So(m))throw new Error(xs.SR_notEnoughElements+"\\nParameter name: list");d=f-1,s=(l=new Ss(fu(m),void 0),p.tail=l,l),c=Ka(m);continue e;break}},a=ga(),o=n(e,a,r),u=ga();return o.tail=u,Ka(a)}function uJr(e,r){var n=function(d,s){var c;e:for(;;){var l=d,f=s;if(So(f))return l;if(e(fu(f))){d=(c=new Ss(fu(f),void 0),l.tail=c,c),s=Ka(f);continue e}else return l;break}},a=ga(),o=n(a,r),u=ga();return o.tail=u,Ka(a)}function sJr(e,r){var n=function(d,s,c){var l;e:for(;;){var f=d,p=s,m=c;if(f<=0)return p;if(So(m))return p;d=f-1,s=(l=new Ss(fu(m),void 0),p.tail=l,l),c=Ka(m);continue e;break}},a=ga(),o=n(e,a,r),u=ga();return o.tail=u,Ka(a)}function lJr(e,r,n){var a=JMe(n)|0,o=(0,yh.defaultArg)(e,0)|0,u=(0,yh.defaultArg)(r,a-1)|0;if(o<0)throw new Error(xs.SR_indexOutOfBounds+"\\nParameter name: startIndex");if(u>=a)throw new Error(xs.SR_indexOutOfBounds+"\\nParameter name: endIndex");return u<o?ga():jie(u-o+1,Wie(o,n))}function cJr(e,r){if(e<0)throw new Error(xs.SR_inputMustBeNonNegative+"\\nParameter name: index");if(e>MV(r))throw new Error(xs.SR_notEnoughElements+"\\nParameter name: index");return[jie(e,r),Wie(e,r)]}function dJr(e){if(So(e))throw new Error(xs.SR_inputSequenceEmpty+"\\nParameter name: list");if(So(Ka(e)))return fu(e);throw new Error(xs.SR_inputSequenceTooLong+"\\nParameter name: list")}function fJr(e){if(!So(e)&&So(Ka(e)))return(0,yh.some)(fu(e))}function pJr(e,r){return xV(e,r)}function mJr(e){return zm((0,Sp.pairwise)(Qm(e)))}function gJr(e,r){return zm((0,Sp.map)(zm,(0,Sp.windowed)(e,Qm(r))))}function vJr(e,r){return zm((0,Sp.map)(zm,(0,Sp.splitInto)(e,Qm(r))))}function hJr(e){return zm((0,Sp.map)(zm,(0,Sp.transpose)((0,Sp.map)(Qm,Array.from(e)))))}function SJr(e,r,n){var a=-1,o=!1,u=Xd(function(t,d){return a=a+1|0,a===e?(o=!0,hp(d,hp(r,t))):hp(d,t)},ga(),n);return wx(o?u:a+1===e?hp(r,u):function(){throw new Error(xs.SR_indexOutOfBounds+"\\nParameter name: index")}())}function yJr(e,r,n){var a=-1,o=!1,u=e3e(r),t=Xd(function(d,s){return a=a+1|0,a===e?(o=!0,hp(s,Bie(u,d))):hp(s,d)},ga(),n);return wx(o?t:a+1===e?Bie(u,t):function(){throw new Error(xs.SR_indexOutOfBounds+"\\nParameter name: index")}())}function CJr(e,r){var n=-1,a=!1,o=xV(function(u){return n=n+1|0,n===e?(a=!0,!1):!0},r);if(!a)throw new Error(xs.SR_indexOutOfBounds+"\\nParameter name: index");return o}function _Jr(e,r,n){var a=-1,o=-1,u=xV(function(s){return a=a+1|0,a===e?(o=0,!1):a>e?a<e+r?!1:(o=1,!0):!0},n),t=(o===0&&a+1===e+r?1:o)|0;if(t<1){var d=t<0?"index":"count";throw new Error(xs.SR_indexOutOfBounds+"\\nParameter name: "+d)}return u}function RJr(e,r,n){var a=!1,o=Kie(function(u,t){return u===e?(a=!0,r):t},n);if(!a)throw new Error(xs.SR_indexOutOfBounds+"\\nParameter name: index");return o}});var Dy=Y(dr=>{_();var s3e=An();Object.defineProperty(dr,"__esModule",{value:!0});dr.CachedSeq$1=void 0;dr.CachedSeq$1$reflection=uXr;dr.CachedSeq$1_$ctor_Z7A8347D4=I3e;dr.CachedSeq$1__Clear=sXr;dr.Enumerator_FromFunctions$1=void 0;dr.Enumerator_FromFunctions$1$reflection=NJr;dr.Enumerator_FromFunctions$1_$ctor_58C54629=GF;dr.Enumerator_Seq=void 0;dr.Enumerator_Seq$reflection=EJr;dr.Enumerator_Seq_$ctor_673A07F2=m3e;dr.Enumerator_alreadyFinished=LV;dr.Enumerator_cast=g3e;dr.Enumerator_concat=v3e;dr.Enumerator_enumerateThenFinally=qV;dr.Enumerator_generateWhileSome=$ie;dr.Enumerator_noReset=p3e;dr.Enumerator_notStarted=BV;dr.Enumerator_unfold=h3e;dr.SR_resetNotSupported=dr.SR_notEnoughElements=dr.SR_keyNotFoundAlt=dr.SR_inputSequenceTooLong=dr.SR_inputSequenceEmpty=dr.SR_enumerationNotStarted=dr.SR_enumerationAlreadyFinished=void 0;dr.allPairs=lXr;dr.append=FJr;dr.average=GXr;dr.averageBy=KXr;dr.cache=M3e;dr.cast=IJr;dr.checkNonNull=Bx;dr.choose=y3e;dr.chunkBySize=WXr;dr.collect=PXr;dr.compareWith=MJr;dr.concat=VF;dr.contains=wJr;dr.delay=d0;dr.empty=AJr;dr.enumerateFromFunctions=DJr;dr.enumerateThenFinally=xJr;dr.enumerateUsing=LJr;dr.enumerateWhile=BJr;dr.exactlyOne=qJr;dr.exists=C3e;dr.exists2=_3e;dr.filter=eoe;dr.find=GJr;dr.findBack=KJr;dr.findIndex=VJr;dr.findIndexBack=WJr;dr.fold=uN;dr.fold2=roe;dr.foldBack=jJr;dr.foldBack2=HJr;dr.forAll=QJr;dr.forAll2=zJr;dr.generate=oN;dr.generateIndexed=wy;dr.head=YJr;dr.indexNotFound=KF;dr.indexed=iXr;dr.initialize=noe;dr.initializeInfinite=JJr;dr.insertAt=jXr;dr.insertManyAt=HXr;dr.isEmpty=XJr;dr.item=ZJr;dr.iterate=$Jr;dr.iterate2=eXr;dr.iterateIndexed=rXr;dr.iterateIndexed2=nXr;dr.last=tXr;dr.length=aXr;dr.map=UF;dr.map2=k3e;dr.map3=F3e;dr.mapFold=cXr;dr.mapFoldBack=dXr;dr.mapIndexed=O3e;dr.mapIndexed2=oXr;dr.max=BXr;dr.maxBy=LXr;dr.min=UXr;dr.minBy=qXr;dr.mkSeq=My;dr.ofArray=qx;dr.ofList=OJr;dr.ofSeq=Ni;dr.pairwise=NXr;dr.permute=VXr;dr.pick=fXr;dr.readOnly=toe;dr.reduce=Ux;dr.reduceBack=pXr;dr.removeAt=QXr;dr.removeManyAt=zXr;dr.replicate=mXr;dr.reverse=gXr;dr.scan=vXr;dr.scanBack=hXr;dr.singleton=S3e;dr.skip=D3e;dr.skipWhile=SXr;dr.sort=FXr;dr.sortBy=IXr;dr.sortByDescending=wXr;dr.sortDescending=MXr;dr.sortWith=Gx;dr.splitInto=AXr;dr.sum=DXr;dr.sumBy=xXr;dr.tail=yXr;dr.take=CXr;dr.takeWhile=_Xr;dr.toArray=Zd;dr.toList=kJr;dr.transpose=kXr;dr.truncate=RXr;dr.tryExactlyOne=UJr;dr.tryFind=R3e;dr.tryFindBack=T3e;dr.tryFindIndex=b3e;dr.tryFindIndexBack=P3e;dr.tryHead=E3e;dr.tryItem=N3e;dr.tryLast=A3e;dr.tryPick=w3e;dr.unfold=UV;dr.updateAt=YXr;dr.where=EXr;dr.windowed=OXr;dr.zip=TXr;dr.zip3=bXr;var Qie=s3e(at()),zie=s3e(it()),ut=Cc(),TJr=Uc(),Yie=c0(),fi=Iy(),Hie=wMe(),Rc=qF(),Wg=O_(),ES=kV(),l3e="Enumeration already finished.";dr.SR_enumerationAlreadyFinished=l3e;var c3e="Enumeration has not started. Call MoveNext.";dr.SR_enumerationNotStarted=c3e;var Jie="The input sequence was empty.";dr.SR_inputSequenceEmpty=Jie;var bJr="The input sequence contains more than one element.";dr.SR_inputSequenceTooLong=bJr;var d3e="An index satisfying the predicate was not found in the collection.";dr.SR_keyNotFoundAlt=d3e;var PJr="The input sequence has an insufficient number of elements.";dr.SR_notEnoughElements=PJr;var f3e="Reset is not supported on this enumerator.";dr.SR_resetNotSupported=f3e;function p3e(){throw new Error(f3e)}function BV(){throw new Error(c3e)}function LV(){throw new Error(l3e)}var Xie=function(e){function r(n){(0,Qie.default)(this,r),this.f=n}return(0,zie.default)(r,[{key:"toString",value:function(){var a=this,o=4,u=0,t="seq [",d=(0,ut.getEnumerator)(a);try{for(;u<o&&d["System.Collections.IEnumerator.MoveNext"]();)u>0&&(t=t+"; "),t=t+(0,TJr.toString)(d["System.Collections.Generic.IEnumerator`1.get_Current"]()),u=u+1|0;return u===o&&(t=t+"; ..."),t+"]"}finally{(0,ut.disposeSafe)(d)}}},{key:"GetEnumerator",value:function(){var a=this;return a.f()}},{key:e,value:function(){return(0,ut.toIterator)(this.GetEnumerator())}},{key:"System.Collections.IEnumerable.GetEnumerator",value:function(){var a=this;return a.f()}}]),r}(Symbol.iterator);dr.Enumerator_Seq=Xie;function EJr(e){return(0,Yie.class_type)("SeqModule.Enumerator.Seq",[e],Xie)}function m3e(e){return new Xie(e)}var Zie=function(){function e(r,n,a){(0,Qie.default)(this,e),this.current=r,this.next=n,this.dispose=a}return(0,zie.default)(e,[{key:"System.Collections.Generic.IEnumerator`1.get_Current",value:function(){var n=this;return n.current()}},{key:"System.Collections.IEnumerator.get_Current",value:function(){var n=this;return n.current()}},{key:"System.Collections.IEnumerator.MoveNext",value:function(){var n=this;return n.next()}},{key:"System.Collections.IEnumerator.Reset",value:function(){p3e()}},{key:"Dispose",value:function(){var n=this;n.dispose()}}]),e}();dr.Enumerator_FromFunctions$1=Zie;function NJr(e){return(0,Yie.class_type)("SeqModule.Enumerator.FromFunctions`1",[e],Zie)}function GF(e,r,n){return new Zie(e,r,n)}function g3e(e){return GF(function(){return e["System.Collections.IEnumerator.get_Current"]()},function(){return e["System.Collections.IEnumerator.MoveNext"]()},function(){(0,ut.isDisposable)(e)&&(0,ut.disposeSafe)(e)})}function v3e(e){var r=void 0,n=void 0,a=!1,o=!1,u=void 0,t=function(){if(o=!0,n!=null){var s=n;try{(0,ut.disposeSafe)(s)}finally{n=void 0}}if(r!=null){var c=r;try{(0,ut.disposeSafe)(c)}finally{r=void 0}}};return GF(function(){return a?o&&LV():BV(),u!=null?(0,fi.value)(u):LV()},function(){var d;if(a||(a=!0),o)return!1;for(var s=void 0;s==null;){var c=[r,n];if(c[0]!=null)if(c[1]!=null){var l=c[1];if(l["System.Collections.IEnumerator.MoveNext"]())u=(0,fi.some)(l["System.Collections.Generic.IEnumerator`1.get_Current"]()),s=!0;else try{(0,ut.disposeSafe)(l)}finally{n=void 0}}else{var f=c[0];if(f["System.Collections.IEnumerator.MoveNext"]()){var p=f["System.Collections.Generic.IEnumerator`1.get_Current"]();n=(d=p,(0,ut.getEnumerator)(d))}else t(),s=!1}else r=(0,ut.getEnumerator)(e)}return(0,fi.value)(s)},function(){o||t()})}function qV(e,r){return GF(function(){return r["System.Collections.Generic.IEnumerator`1.get_Current"]()},function(){return r["System.Collections.IEnumerator.MoveNext"]()},function(){try{(0,ut.disposeSafe)(r)}finally{e()}})}function $ie(e,r,n){var a=!1,o=void 0,u=(0,fi.some)(e()),t=function(){if(u!=null){var c=(0,fi.value)(u);try{n(c)}finally{u=void 0}}},d=function(){try{t()}finally{o=void 0}};return GF(function(){return a||BV(),o!=null?(0,fi.value)(o):LV()},function(){if(a||(a=!0),u!=null){var s=(0,fi.value)(u),c;try{c=r(s)}catch(l){throw d(),l}return c!=null?(o=c,!0):(d(),!1)}else return!1},t)}function h3e(e,r){var n=void 0,a=r;return GF(function(){if(n!=null){var o=n[0],u=n[1];return o}else return BV()},function(){if(n=e(a),n!=null){var o=n[0],u=n[1];return a=u,!0}else return!1},function(){})}function KF(){throw new Error(d3e)}function Bx(e,r){r==null&&(0,Hie.Operators_NullArg)(e)}function My(e){return m3e(e)}function Ni(e){return Bx("source",e),(0,ut.getEnumerator)(e)}function d0(e){return My(function(){return(0,ut.getEnumerator)(e())})}function VF(e){return My(function(){return v3e(e)})}function UV(e,r){return My(function(){return h3e(e,r)})}function AJr(){return d0(function(){return new Array(0)})}function S3e(e){return d0(function(){return(0,Rc.singleton)(e)})}function qx(e){return e}function Zd(e){return e instanceof Wg.FSharpList?(0,Wg.toArray)(e):Array.from(e)}function OJr(e){return e}function kJr(e){return(0,ut.isArrayLike)(e)?(0,Wg.ofArray)(e):e instanceof Wg.FSharpList?e:(0,Wg.ofSeq)(e)}function oN(e,r,n){return My(function(){return $ie(e,r,n)})}function wy(e,r,n){return My(function(){var a=-1;return $ie(e,function(o){return a=a+1|0,r(a,o)},n)})}function FJr(e,r){return VF([e,r])}function IJr(e){return My(function(){return Bx("source",e),g3e((0,ut.getEnumerator)(e))})}function y3e(e,r){return oN(function(){return Ni(r)},function(n){for(var a=void 0;a==null&&n["System.Collections.IEnumerator.MoveNext"]();)a=e(n["System.Collections.Generic.IEnumerator`1.get_Current"]());return a},function(n){(0,ut.disposeSafe)(n)})}function MJr(e,r,n){var a=Ni(r);try{var o=Ni(n);try{for(var u=0,t=a["System.Collections.IEnumerator.MoveNext"](),d=o["System.Collections.IEnumerator.MoveNext"]();u===0&&t&&d;)u=e(a["System.Collections.Generic.IEnumerator`1.get_Current"](),o["System.Collections.Generic.IEnumerator`1.get_Current"]())|0,u===0&&(t=a["System.Collections.IEnumerator.MoveNext"](),d=o["System.Collections.IEnumerator.MoveNext"]());return(u!==0?u:t?1:d?-1:0)|0}finally{(0,ut.disposeSafe)(o)}}finally{(0,ut.disposeSafe)(a)}}function wJr(e,r,n){var a=Ni(r);try{for(var o=!1;!o&&a["System.Collections.IEnumerator.MoveNext"]();)o=n.Equals(e,a["System.Collections.Generic.IEnumerator`1.get_Current"]());return o}finally{(0,ut.disposeSafe)(a)}}function DJr(e,r,n){return oN(e,function(a){return r(a)?(0,fi.some)(n(a)):void 0},function(a){var o=a;(0,ut.isDisposable)(o)&&(0,ut.disposeSafe)(o)})}function xJr(e,r){var n=r;return My(function(){try{return qV(n,Ni(e))}catch(a){throw n(),a}})}function LJr(e,r){var n=function(){if(!(0,ut.equals)(e,null)){var o=e;(0,ut.disposeSafe)(o)}};return My(function(){try{return qV(n,Ni(r(e)))}catch(a){throw n(),a}})}function BJr(e,r){return VF(UV(function(n){return e()?[r,n+1]:void 0},0))}function eoe(e,r){return y3e(function(n){if(e(n))return(0,fi.some)(n)},r)}function C3e(e,r){var n=Ni(r);try{for(var a=!1;!a&&n["System.Collections.IEnumerator.MoveNext"]();)a=e(n["System.Collections.Generic.IEnumerator`1.get_Current"]());return a}finally{(0,ut.disposeSafe)(n)}}function _3e(e,r,n){var a=Ni(r);try{var o=Ni(n);try{for(var u=!1;!u&&a["System.Collections.IEnumerator.MoveNext"]()&&o["System.Collections.IEnumerator.MoveNext"]();)u=e(a["System.Collections.Generic.IEnumerator`1.get_Current"](),o["System.Collections.Generic.IEnumerator`1.get_Current"]());return u}finally{(0,ut.disposeSafe)(o)}}finally{(0,ut.disposeSafe)(a)}}function qJr(e){var r=Ni(e);try{if(r["System.Collections.IEnumerator.MoveNext"]()){var n=r["System.Collections.Generic.IEnumerator`1.get_Current"]();if(r["System.Collections.IEnumerator.MoveNext"]())throw new Error("The input sequence contains more than one element.\\nParameter name: source");return n}else throw new Error("The input sequence was empty.\\nParameter name: source")}finally{(0,ut.disposeSafe)(r)}}function UJr(e){var r=Ni(e);try{if(r["System.Collections.IEnumerator.MoveNext"]()){var n=r["System.Collections.Generic.IEnumerator`1.get_Current"]();return r["System.Collections.IEnumerator.MoveNext"]()?void 0:(0,fi.some)(n)}else return}finally{(0,ut.disposeSafe)(r)}}function R3e(e,r){var n=Ni(r);try{for(var a=void 0;a==null&&n["System.Collections.IEnumerator.MoveNext"]();){var o=n["System.Collections.Generic.IEnumerator`1.get_Current"]();e(o)&&(a=(0,fi.some)(o))}return a}finally{(0,ut.disposeSafe)(n)}}function GJr(e,r){var n=R3e(e,r);return n==null?KF():(0,fi.value)(n)}function T3e(e,r){return(0,Rc.tryFindBack)(e,Zd(r))}function KJr(e,r){var n=T3e(e,r);return n==null?KF():(0,fi.value)(n)}function b3e(e,r){var n=Ni(r);try{var a=function(u){e:for(;;){var t=u;if(n["System.Collections.IEnumerator.MoveNext"]()){if(e(n["System.Collections.Generic.IEnumerator`1.get_Current"]()))return t;u=t+1;continue e}else return;break}};return a(0)}finally{(0,ut.disposeSafe)(n)}}function VJr(e,r){var n=b3e(e,r);return n==null?KF()|0:n|0}function P3e(e,r){return(0,Rc.tryFindIndexBack)(e,Zd(r))}function WJr(e,r){var n=P3e(e,r);return n==null?KF()|0:n|0}function uN(e,r,n){var a=Ni(n);try{for(var o=r;a["System.Collections.IEnumerator.MoveNext"]();)o=e(o,a["System.Collections.Generic.IEnumerator`1.get_Current"]());return o}finally{(0,ut.disposeSafe)(a)}}function jJr(e,r,n){return(0,Rc.foldBack)(e,Zd(r),n)}function roe(e,r,n,a){var o=Ni(n);try{var u=Ni(a);try{for(var t=r;o["System.Collections.IEnumerator.MoveNext"]()&&u["System.Collections.IEnumerator.MoveNext"]();)t=e(t,o["System.Collections.Generic.IEnumerator`1.get_Current"](),u["System.Collections.Generic.IEnumerator`1.get_Current"]());return t}finally{(0,ut.disposeSafe)(u)}}finally{(0,ut.disposeSafe)(o)}}function HJr(e,r,n,a){return(0,Rc.foldBack2)(e,Zd(r),Zd(n),a)}function QJr(e,r){return!C3e(function(n){return!e(n)},r)}function zJr(e,r,n){return!_3e(function(a,o){return!e(a,o)},r,n)}function E3e(e){if((0,ut.isArrayLike)(e))return(0,Rc.tryHead)(e);if(e instanceof Wg.FSharpList)return(0,Wg.tryHead)(e);var r=Ni(e);try{return r["System.Collections.IEnumerator.MoveNext"]()?(0,fi.some)(r["System.Collections.Generic.IEnumerator`1.get_Current"]()):void 0}finally{(0,ut.disposeSafe)(r)}}function YJr(e){var r=E3e(e);if(r==null)throw new Error("The input sequence was empty.\\nParameter name: source");return(0,fi.value)(r)}function noe(e,r){return UV(function(n){return n<e?[r(n),n+1]:void 0},0)}function JJr(e){return noe(2147483647,e)}function XJr(e){if((0,ut.isArrayLike)(e))return e.length===0;if(e instanceof Wg.FSharpList)return(0,Wg.isEmpty)(e);var r=Ni(e);try{return!r["System.Collections.IEnumerator.MoveNext"]()}finally{(0,ut.disposeSafe)(r)}}function N3e(e,r){if((0,ut.isArrayLike)(r))return(0,Rc.tryItem)(e,r);if(r instanceof Wg.FSharpList)return(0,Wg.tryItem)(e,r);var n=Ni(r);try{var a=function(u){e:for(;;){var t=u;if(n["System.Collections.IEnumerator.MoveNext"]()){if(t===0)return(0,fi.some)(n["System.Collections.Generic.IEnumerator`1.get_Current"]());u=t-1;continue e}else return;break}};return a(e)}finally{(0,ut.disposeSafe)(n)}}function ZJr(e,r){var n=N3e(e,r);if(n==null)throw new Error("The input sequence has an insufficient number of elements.\\nParameter name: index");return(0,fi.value)(n)}function $Jr(e,r){uN(function(n,a){e(a)},void 0,r)}function eXr(e,r,n){roe(function(a,o,u){e(o,u)},void 0,r,n)}function rXr(e,r){uN(function(n,a){return e(n,a),n+1|0},0,r)}function nXr(e,r,n){roe(function(a,o,u){return e(a,o,u),a+1|0},0,r,n)}function A3e(e){var r=Ni(e);try{var n=function(o){e:for(;;){var u=o;if(r["System.Collections.IEnumerator.MoveNext"]()){o=r["System.Collections.Generic.IEnumerator`1.get_Current"]();continue e}else return u;break}};return r["System.Collections.IEnumerator.MoveNext"]()?(0,fi.some)(n(r["System.Collections.Generic.IEnumerator`1.get_Current"]())):void 0}finally{(0,ut.disposeSafe)(r)}}function tXr(e){var r=A3e(e);if(r==null)throw new Error("The input sequence has an insufficient number of elements.\\nParameter name: source");return(0,fi.value)(r)}function aXr(e){if((0,ut.isArrayLike)(e))return e.length|0;if(e instanceof Wg.FSharpList)return(0,Wg.length)(e)|0;var r=Ni(e);try{for(var n=0;r["System.Collections.IEnumerator.MoveNext"]();)n=n+1|0;return n|0}finally{(0,ut.disposeSafe)(r)}}function UF(e,r){return oN(function(){return Ni(r)},function(n){return n["System.Collections.IEnumerator.MoveNext"]()?(0,fi.some)(e(n["System.Collections.Generic.IEnumerator`1.get_Current"]())):void 0},function(n){(0,ut.disposeSafe)(n)})}function O3e(e,r){return wy(function(){return Ni(r)},function(n,a){return a["System.Collections.IEnumerator.MoveNext"]()?(0,fi.some)(e(n,a["System.Collections.Generic.IEnumerator`1.get_Current"]())):void 0},function(n){(0,ut.disposeSafe)(n)})}function iXr(e){return O3e(function(r,n){return[r,n]},e)}function k3e(e,r,n){return oN(function(){return[Ni(r),Ni(n)]},function(a){var o=a[0],u=a[1];return o["System.Collections.IEnumerator.MoveNext"]()&&u["System.Collections.IEnumerator.MoveNext"]()?(0,fi.some)(e(o["System.Collections.Generic.IEnumerator`1.get_Current"](),u["System.Collections.Generic.IEnumerator`1.get_Current"]())):void 0},function(a){try{(0,ut.disposeSafe)(a[0])}finally{(0,ut.disposeSafe)(a[1])}})}function oXr(e,r,n){return wy(function(){return[Ni(r),Ni(n)]},function(a,o){var u=o[0],t=o[1];return u["System.Collections.IEnumerator.MoveNext"]()&&t["System.Collections.IEnumerator.MoveNext"]()?(0,fi.some)(e(a,u["System.Collections.Generic.IEnumerator`1.get_Current"](),t["System.Collections.Generic.IEnumerator`1.get_Current"]())):void 0},function(a){try{(0,ut.disposeSafe)(a[0])}finally{(0,ut.disposeSafe)(a[1])}})}function F3e(e,r,n,a){return oN(function(){return[Ni(r),Ni(n),Ni(a)]},function(o){var u=o[0],t=o[1],d=o[2];return u["System.Collections.IEnumerator.MoveNext"]()&&t["System.Collections.IEnumerator.MoveNext"]()&&d["System.Collections.IEnumerator.MoveNext"]()?(0,fi.some)(e(u["System.Collections.Generic.IEnumerator`1.get_Current"](),t["System.Collections.Generic.IEnumerator`1.get_Current"](),d["System.Collections.Generic.IEnumerator`1.get_Current"]())):void 0},function(o){try{(0,ut.disposeSafe)(o[0])}finally{try{(0,ut.disposeSafe)(o[1])}finally{(0,ut.disposeSafe)(o[2])}}})}function toe(e){return Bx("source",e),UF(function(r){return r},e)}var aoe=function(e){function r(n,a){(0,Qie.default)(this,r),this.cleanup=n,this.res=a}return(0,zie.default)(r,[{key:"Dispose",value:function(){var a=this;a.cleanup()}},{key:"GetEnumerator",value:function(){var a=this;return(0,ut.getEnumerator)(a.res)}},{key:e,value:function(){return(0,ut.toIterator)(this.GetEnumerator())}},{key:"System.Collections.IEnumerable.GetEnumerator",value:function(){var a=this;return(0,ut.getEnumerator)(a.res)}}]),r}(Symbol.iterator);dr.CachedSeq$1=aoe;function uXr(e){return(0,Yie.class_type)("SeqModule.CachedSeq`1",[e],aoe)}function I3e(e,r){return new aoe(e,r)}function sXr(e){e.cleanup()}function M3e(e){Bx("source",e);var r=[],n=void 0;return I3e(function(){(0,Hie.Operators_Lock)(r,function(){(0,ut.clear)(r);var a,o;switch(n!=null&&(0,fi.value)(n)!=null?(a=0,o=(0,fi.value)(n)):a=1,a){case 0:{(0,ut.disposeSafe)(o);break}}n=void 0})},UV(function(a){return(0,Hie.Operators_Lock)(r,function(){if(a<r.length)return[r[a],a+1];if(a>=r.length){var o;if(n!=null)o=(0,fi.value)(n);else{var u=(0,ut.getEnumerator)(e);n=(0,fi.some)(u),o=u}if(o!=null){var t=o;t["System.Collections.IEnumerator.MoveNext"]()?r.push(t["System.Collections.Generic.IEnumerator`1.get_Current"]()):((0,ut.disposeSafe)(t),n=(0,fi.some)(void 0))}}return a<r.length?[r[a],a+1]:void 0})},0))}function lXr(e,r){var n=M3e(r);return d0(function(){return VF(UF(function(a){return UF(function(o){return[a,o]},n)},e))})}function cXr(e,r,n){var a=(0,Rc.mapFold)(e,r,Zd(n));return[toe(a[0]),a[1]]}function dXr(e,r,n){var a=(0,Rc.mapFoldBack)(e,Zd(r),n);return[toe(a[0]),a[1]]}function w3e(e,r){var n=Ni(r);try{for(var a=void 0;a==null&&n["System.Collections.IEnumerator.MoveNext"]();)a=e(n["System.Collections.Generic.IEnumerator`1.get_Current"]());return a}finally{(0,ut.disposeSafe)(n)}}function fXr(e,r){var n=w3e(e,r);return n==null?KF():(0,fi.value)(n)}function Ux(e,r){var n=Ni(r);try{var a=function(u){e:for(;;){var t=u;if(n["System.Collections.IEnumerator.MoveNext"]()){u=e(t,n["System.Collections.Generic.IEnumerator`1.get_Current"]());continue e}else return t;break}};if(n["System.Collections.IEnumerator.MoveNext"]())return a(n["System.Collections.Generic.IEnumerator`1.get_Current"]());throw new Error(Jie)}finally{(0,ut.disposeSafe)(n)}}function pXr(e,r){var n=Zd(r);if(n.length>0)return n.reduceRight(e);throw new Error(Jie)}function mXr(e,r){return noe(e,function(n){return r})}function gXr(e){return d0(function(){return(0,Rc.reverse)(Zd(e))})}function vXr(e,r,n){return d0(function(){var a=r;return VF([S3e(r),UF(function(o){return a=e(a,o),a},n)])})}function hXr(e,r,n){return d0(function(){return(0,Rc.scanBack)(e,Zd(r),n)})}function D3e(e,r){return My(function(){var n=Ni(r);try{for(var a=1;a<=e;a++)if(!n["System.Collections.IEnumerator.MoveNext"]())throw new Error("The input sequence has an insufficient number of elements.\\nParameter name: source");return qV(function(){},n)}catch(o){throw(0,ut.disposeSafe)(n),o}})}function SXr(e,r){return d0(function(){var n=!0;return eoe(function(a){return n&&(n=e(a)),!n},r)})}function yXr(e){return D3e(1,e)}function CXr(e,r){return wy(function(){return Ni(r)},function(n,a){if(n<e){if(a["System.Collections.IEnumerator.MoveNext"]())return(0,fi.some)(a["System.Collections.Generic.IEnumerator`1.get_Current"]());throw new Error("The input sequence has an insufficient number of elements.\\nParameter name: source")}else return},function(n){(0,ut.disposeSafe)(n)})}function _Xr(e,r){return oN(function(){return Ni(r)},function(n){return n["System.Collections.IEnumerator.MoveNext"]()&&e(n["System.Collections.Generic.IEnumerator`1.get_Current"]())?(0,fi.some)(n["System.Collections.Generic.IEnumerator`1.get_Current"]()):void 0},function(n){(0,ut.disposeSafe)(n)})}function RXr(e,r){return wy(function(){return Ni(r)},function(n,a){return n<e&&a["System.Collections.IEnumerator.MoveNext"]()?(0,fi.some)(a["System.Collections.Generic.IEnumerator`1.get_Current"]()):void 0},function(n){(0,ut.disposeSafe)(n)})}function TXr(e,r){return k3e(function(n,a){return[n,a]},e,r)}function bXr(e,r,n){return F3e(function(a,o,u){return[a,o,u]},e,r,n)}function PXr(e,r){return d0(function(){return VF(UF(e,r))})}function EXr(e,r){return eoe(e,r)}function NXr(e){return d0(function(){return(0,Rc.pairwise)(Zd(e))})}function AXr(e,r){return d0(function(){return(0,Rc.map)(qx,(0,Rc.splitInto)(e,Zd(r)))})}function OXr(e,r){return d0(function(){return(0,Rc.map)(qx,(0,Rc.windowed)(e,Zd(r)))})}function kXr(e){return d0(function(){return(0,Rc.map)(qx,(0,Rc.transpose)((0,Rc.map)(Zd,Zd(e))))})}function Gx(e,r){return d0(function(){var n=Zd(r);return n.sort(e),n})}function FXr(e,r){return Gx(function(n,a){return r.Compare(n,a)},e)}function IXr(e,r,n){return Gx(function(a,o){return n.Compare(e(a),e(o))},r)}function MXr(e,r){return Gx(function(n,a){return r.Compare(n,a)*-1},e)}function wXr(e,r,n){return Gx(function(a,o){return n.Compare(e(a),e(o))*-1},r)}function DXr(e,r){return uN(function(n,a){return r.Add(n,a)},r.GetZero(),e)}function xXr(e,r,n){return uN(function(a,o){return n.Add(a,e(o))},n.GetZero(),r)}function LXr(e,r,n){return Ux(function(a,o){return n.Compare(e(o),e(a))>0?o:a},r)}function BXr(e,r){return Ux(function(n,a){return r.Compare(a,n)>0?a:n},e)}function qXr(e,r,n){return Ux(function(a,o){return n.Compare(e(o),e(a))>0?a:o},r)}function UXr(e,r){return Ux(function(n,a){return r.Compare(a,n)>0?n:a},e)}function GXr(e,r){var n=0,a=uN(function(o,u){return n=n+1|0,r.Add(o,u)},r.GetZero(),e);if(n===0)throw new Error("The input sequence was empty.\\nParameter name: source");return r.DivideByInt(a,n)}function KXr(e,r,n){var a=0,o=uN(function(u,t){return a=a+1|0,n.Add(u,e(t))},n.GetZero(),r);if(a===0)throw new Error("The input sequence was empty.\\nParameter name: source");return n.DivideByInt(o,a)}function VXr(e,r){return d0(function(){return(0,Rc.permute)(e,Zd(r))})}function WXr(e,r){return d0(function(){return(0,Rc.map)(qx,(0,Rc.chunkBySize)(e,Zd(r)))})}function jXr(e,r,n){var a=!1;if(e<0)throw new Error(ES.SR_indexOutOfBounds+"\\nParameter name: index");return wy(function(){return Ni(n)},function(o,u){if((a||o<e)&&u["System.Collections.IEnumerator.MoveNext"]())return(0,fi.some)(u["System.Collections.Generic.IEnumerator`1.get_Current"]());if(o===e)return a=!0,(0,fi.some)(r);if(!a)throw new Error(ES.SR_indexOutOfBounds+"\\nParameter name: index")},function(o){(0,ut.disposeSafe)(o)})}function HXr(e,r,n){var a=-1;if(e<0)throw new Error(ES.SR_indexOutOfBounds+"\\nParameter name: index");return wy(function(){return[Ni(n),Ni(r)]},function(o,u){var t=u[0],d=u[1];o===e&&(a=0);var s;if(a===0?d["System.Collections.IEnumerator.MoveNext"]()?s=(0,fi.some)(d["System.Collections.Generic.IEnumerator`1.get_Current"]()):(a=1,s=void 0):s=void 0,s==null){if(t["System.Collections.IEnumerator.MoveNext"]())return(0,fi.some)(t["System.Collections.Generic.IEnumerator`1.get_Current"]());if(a<1)throw new Error(ES.SR_indexOutOfBounds+"\\nParameter name: index");return}else return(0,fi.some)((0,fi.value)(s))},function(o){(0,ut.disposeSafe)(o[0]),(0,ut.disposeSafe)(o[1])})}function QXr(e,r){var n=!1;if(e<0)throw new Error(ES.SR_indexOutOfBounds+"\\nParameter name: index");return wy(function(){return Ni(r)},function(a,o){if((n||a<e)&&o["System.Collections.IEnumerator.MoveNext"]())return(0,fi.some)(o["System.Collections.Generic.IEnumerator`1.get_Current"]());if(a===e&&o["System.Collections.IEnumerator.MoveNext"]())return n=!0,o["System.Collections.IEnumerator.MoveNext"]()?(0,fi.some)(o["System.Collections.Generic.IEnumerator`1.get_Current"]()):void 0;if(!n)throw new Error(ES.SR_indexOutOfBounds+"\\nParameter name: index")},function(a){(0,ut.disposeSafe)(a)})}function zXr(e,r,n){if(e<0)throw new Error(ES.SR_indexOutOfBounds+"\\nParameter name: index");return wy(function(){return Ni(n)},function(a,o){if(a<e){if(o["System.Collections.IEnumerator.MoveNext"]())return(0,fi.some)(o["System.Collections.Generic.IEnumerator`1.get_Current"]());throw new Error(ES.SR_indexOutOfBounds+"\\nParameter name: index")}else{if(a===e){for(var u=1;u<=r;u++)if(!o["System.Collections.IEnumerator.MoveNext"]())throw new Error(ES.SR_indexOutOfBounds+"\\nParameter name: count")}return o["System.Collections.IEnumerator.MoveNext"]()?(0,fi.some)(o["System.Collections.Generic.IEnumerator`1.get_Current"]()):void 0}},function(a){(0,ut.disposeSafe)(a)})}function YXr(e,r,n){var a=!1;if(e<0)throw new Error(ES.SR_indexOutOfBounds+"\\nParameter name: index");return wy(function(){return Ni(n)},function(o,u){if((a||o<e)&&u["System.Collections.IEnumerator.MoveNext"]())return(0,fi.some)(u["System.Collections.Generic.IEnumerator`1.get_Current"]());if(o===e&&u["System.Collections.IEnumerator.MoveNext"]())return a=!0,(0,fi.some)(r);if(!a)throw new Error(ES.SR_indexOutOfBounds+"\\nParameter name: index")},function(o){(0,ut.disposeSafe)(o)})}});var x3e=Y((AFn,Kx)=>{_();function JXr(e){return Function.toString.call(e).indexOf("[native code]")!==-1}Kx.exports=JXr,Kx.exports.__esModule=!0,Kx.exports.default=Kx.exports});var L3e=Y((kFn,k_)=>{_();var XXr=Ed(),ZXr=q4(),$Xr=x3e(),eZr=hie();function ioe(e){var r=typeof Map=="function"?new Map:void 0;return k_.exports=ioe=function(a){if(a===null||!$Xr(a))return a;if(typeof a!="function")throw new TypeError("Super expression must either be null or a function");if(typeof r!="undefined"){if(r.has(a))return r.get(a);r.set(a,o)}function o(){return eZr(a,arguments,XXr(this).constructor)}return o.prototype=Object.create(a.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),ZXr(o,a)},k_.exports.__esModule=!0,k_.exports.default=k_.exports,ioe(e)}k_.exports=ioe,k_.exports.__esModule=!0,k_.exports.default=k_.exports});var W3e=Y(V0=>{_();var nb=An();Object.defineProperty(V0,"__esModule",{value:!0});V0.Trampoline=V0.OperationCanceledError=V0.CancellationToken=V0.AsyncBuilder=void 0;V0.protectedBind=G3e;V0.protectedCont=sN;V0.protectedReturn=K3e;V0.singleton=void 0;var rZr=nb(uj()),nZr=nb(Qf()),tZr=nb(zf()),B3e=nb(Ed()),aZr=nb(L3e()),iZr=nb(GS()),KV=nb(at()),VV=nb(it()),GV=Uc();function oZr(e){var r=uZr();return function(){var a=(0,B3e.default)(e),o;if(r){var u=(0,B3e.default)(this).constructor;o=Reflect.construct(a,arguments,u)}else o=a.apply(this,arguments);return(0,tZr.default)(this,o)}}function uZr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function sZr(e,r){var n=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=lZr(e))||r&&e&&typeof e.length=="number"){n&&(e=n);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function lZr(e,r){if(e){if(typeof e=="string")return q3e(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return q3e(e,r)}}function q3e(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,a=new Array(r);n<r;n++)a[n]=e[n];return a}var cZr=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;(0,KV.default)(this,e),this._id=0,this._cancelled=r,this._listeners=new Map}return(0,VV.default)(e,[{key:"isCancelled",get:function(){return this._cancelled}},{key:"cancel",value:function(){if(!this._cancelled){this._cancelled=!0;for(var n=sZr(this._listeners),a;!(a=n()).done;){var o=a.value,u=(0,iZr.default)(o,2),t=u[1];t()}}}},{key:"addListener",value:function(n){var a=this._id;return this._listeners.set(this._id++,n),a}},{key:"removeListener",value:function(n){return this._listeners.delete(n)}},{key:"register",value:function(n,a){var o=this,u=this.addListener(a==null?n:function(){return n(a)});return{Dispose:function(){o.removeListener(u)}}}}]),e}();V0.CancellationToken=cZr;var U3e=function(e){(0,nZr.default)(n,e);var r=oZr(n);function n(){var a;return(0,KV.default)(this,n),a=r.call(this,"The operation was canceled"),Object.setPrototypeOf((0,rZr.default)(a),n.prototype),a}return(0,VV.default)(n)}((0,aZr.default)(Error));V0.OperationCanceledError=U3e;var dZr=function(){function e(){(0,KV.default)(this,e),this.callCount=0}return(0,VV.default)(e,[{key:"incrementAndCheck",value:function(){return this.callCount++>e.maxTrampolineCallCount}},{key:"hijack",value:function(n){this.callCount=0,setTimeout(n,0)}}],[{key:"maxTrampolineCallCount",get:function(){return 2e3}}]),e}();V0.Trampoline=dZr;function sN(e){return function(r){if(r.cancelToken.isCancelled)r.onCancel(new U3e);else if(r.trampoline.incrementAndCheck())r.trampoline.hijack(function(){try{e(r)}catch(n){r.onError((0,GV.ensureErrorOrException)(n))}});else try{e(r)}catch(n){r.onError((0,GV.ensureErrorOrException)(n))}}}function G3e(e,r){return sN(function(n){e({onSuccess:function(o){try{r(o)(n)}catch(u){n.onError((0,GV.ensureErrorOrException)(u))}},onError:n.onError,onCancel:n.onCancel,cancelToken:n.cancelToken,trampoline:n.trampoline})})}function K3e(e){return sN(function(r){return r.onSuccess(e)})}var V3e=function(){function e(){(0,KV.default)(this,e)}return(0,VV.default)(e,[{key:"Bind",value:function(n,a){return G3e(n,a)}},{key:"Combine",value:function(n,a){return this.Bind(n,function(){return a})}},{key:"Delay",value:function(n){return sN(function(a){return n()(a)})}},{key:"For",value:function(n,a){var o=n[Symbol.iterator](),u=o.next();return this.While(function(){return!u.done},this.Delay(function(){var t=a(u.value);return u=o.next(),t}))}},{key:"Return",value:function(n){return K3e(n)}},{key:"ReturnFrom",value:function(n){return n}},{key:"TryFinally",value:function(n,a){return sN(function(o){n({onSuccess:function(t){a(),o.onSuccess(t)},onError:function(t){a(),o.onError(t)},onCancel:function(t){a(),o.onCancel(t)},cancelToken:o.cancelToken,trampoline:o.trampoline})})}},{key:"TryWith",value:function(n,a){return sN(function(o){n({onSuccess:o.onSuccess,onCancel:o.onCancel,cancelToken:o.cancelToken,trampoline:o.trampoline,onError:function(t){try{a(t)(o)}catch(d){o.onError((0,GV.ensureErrorOrException)(d))}}})})}},{key:"Using",value:function(n,a){return this.TryFinally(a(n),function(){return n.Dispose()})}},{key:"While",value:function(n,a){var o=this;return n()?this.Bind(a,function(){return o.While(n,a)}):this.Return(void 0)}},{key:"Zero",value:function(){return sN(function(n){return n.onSuccess(void 0)})}}]),e}();V0.AsyncBuilder=V3e;var fZr=new V3e;V0.singleton=fZr});var Z3e=Y(Mu=>{_();var Vx=An();Object.defineProperty(Mu,"__esModule",{value:!0});Mu.Choice_makeChoice1Of2=PZr;Mu.Choice_makeChoice2Of2=EZr;Mu.Choice_tryValueIfChoice1Of2=NZr;Mu.Choice_tryValueIfChoice2Of2=AZr;Mu.FSharpChoice$2=void 0;Mu.FSharpChoice$2$reflection=yZr;Mu.FSharpChoice$3=void 0;Mu.FSharpChoice$3$reflection=CZr;Mu.FSharpChoice$4=void 0;Mu.FSharpChoice$4$reflection=_Zr;Mu.FSharpChoice$5=void 0;Mu.FSharpChoice$5$reflection=RZr;Mu.FSharpChoice$6=void 0;Mu.FSharpChoice$6$reflection=TZr;Mu.FSharpChoice$7=void 0;Mu.FSharpChoice$7$reflection=bZr;Mu.FSharpResult$2=void 0;Mu.FSharpResult$2$reflection=gZr;Mu.Result_Bind=SZr;Mu.Result_Map=vZr;Mu.Result_MapError=hZr;var cN=Vx(at()),dN=Vx(it()),fN=Vx(Qf()),pZr=Vx(zf()),j3e=Vx(Ed()),pN=Uc(),mN=c0(),H3e=Iy();function gN(e){var r=mZr();return function(){var a=(0,j3e.default)(e),o;if(r){var u=(0,j3e.default)(this).constructor;o=Reflect.construct(a,arguments,u)}else o=a.apply(this,arguments);return(0,pZr.default)(this,o)}}function mZr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var lN=function(e){(0,fN.default)(n,e);var r=gN(n);function n(a){var o;(0,cN.default)(this,n),o=r.call(this),o.tag=a|0;for(var u=arguments.length,t=new Array(u>1?u-1:0),d=1;d<u;d++)t[d-1]=arguments[d];return o.fields=t,o}return(0,dN.default)(n,[{key:"cases",value:function(){return["Ok","Error"]}}]),n}(pN.Union);Mu.FSharpResult$2=lN;function gZr(e,r){return(0,mN.union_type)("FSharp.Core.FSharpResult`2",[e,r],lN,function(){return[[["ResultValue",e]],[["ErrorValue",r]]]})}function vZr(e,r){return r.tag===0?new lN(0,e(r.fields[0])):new lN(1,r.fields[0])}function hZr(e,r){return r.tag===0?new lN(0,r.fields[0]):new lN(1,e(r.fields[0]))}function SZr(e,r){return r.tag===0?e(r.fields[0]):new lN(1,r.fields[0])}var WV=function(e){(0,fN.default)(n,e);var r=gN(n);function n(a){var o;(0,cN.default)(this,n),o=r.call(this),o.tag=a|0;for(var u=arguments.length,t=new Array(u>1?u-1:0),d=1;d<u;d++)t[d-1]=arguments[d];return o.fields=t,o}return(0,dN.default)(n,[{key:"cases",value:function(){return["Choice1Of2","Choice2Of2"]}}]),n}(pN.Union);Mu.FSharpChoice$2=WV;function yZr(e,r){return(0,mN.union_type)("FSharp.Core.FSharpChoice`2",[e,r],WV,function(){return[[["Item",e]],[["Item",r]]]})}var Q3e=function(e){(0,fN.default)(n,e);var r=gN(n);function n(a){var o;(0,cN.default)(this,n),o=r.call(this),o.tag=a|0;for(var u=arguments.length,t=new Array(u>1?u-1:0),d=1;d<u;d++)t[d-1]=arguments[d];return o.fields=t,o}return(0,dN.default)(n,[{key:"cases",value:function(){return["Choice1Of3","Choice2Of3","Choice3Of3"]}}]),n}(pN.Union);Mu.FSharpChoice$3=Q3e;function CZr(e,r,n){return(0,mN.union_type)("FSharp.Core.FSharpChoice`3",[e,r,n],Q3e,function(){return[[["Item",e]],[["Item",r]],[["Item",n]]]})}var z3e=function(e){(0,fN.default)(n,e);var r=gN(n);function n(a){var o;(0,cN.default)(this,n),o=r.call(this),o.tag=a|0;for(var u=arguments.length,t=new Array(u>1?u-1:0),d=1;d<u;d++)t[d-1]=arguments[d];return o.fields=t,o}return(0,dN.default)(n,[{key:"cases",value:function(){return["Choice1Of4","Choice2Of4","Choice3Of4","Choice4Of4"]}}]),n}(pN.Union);Mu.FSharpChoice$4=z3e;function _Zr(e,r,n,a){return(0,mN.union_type)("FSharp.Core.FSharpChoice`4",[e,r,n,a],z3e,function(){return[[["Item",e]],[["Item",r]],[["Item",n]],[["Item",a]]]})}var Y3e=function(e){(0,fN.default)(n,e);var r=gN(n);function n(a){var o;(0,cN.default)(this,n),o=r.call(this),o.tag=a|0;for(var u=arguments.length,t=new Array(u>1?u-1:0),d=1;d<u;d++)t[d-1]=arguments[d];return o.fields=t,o}return(0,dN.default)(n,[{key:"cases",value:function(){return["Choice1Of5","Choice2Of5","Choice3Of5","Choice4Of5","Choice5Of5"]}}]),n}(pN.Union);Mu.FSharpChoice$5=Y3e;function RZr(e,r,n,a,o){return(0,mN.union_type)("FSharp.Core.FSharpChoice`5",[e,r,n,a,o],Y3e,function(){return[[["Item",e]],[["Item",r]],[["Item",n]],[["Item",a]],[["Item",o]]]})}var J3e=function(e){(0,fN.default)(n,e);var r=gN(n);function n(a){var o;(0,cN.default)(this,n),o=r.call(this),o.tag=a|0;for(var u=arguments.length,t=new Array(u>1?u-1:0),d=1;d<u;d++)t[d-1]=arguments[d];return o.fields=t,o}return(0,dN.default)(n,[{key:"cases",value:function(){return["Choice1Of6","Choice2Of6","Choice3Of6","Choice4Of6","Choice5Of6","Choice6Of6"]}}]),n}(pN.Union);Mu.FSharpChoice$6=J3e;function TZr(e,r,n,a,o,u){return(0,mN.union_type)("FSharp.Core.FSharpChoice`6",[e,r,n,a,o,u],J3e,function(){return[[["Item",e]],[["Item",r]],[["Item",n]],[["Item",a]],[["Item",o]],[["Item",u]]]})}var X3e=function(e){(0,fN.default)(n,e);var r=gN(n);function n(a){var o;(0,cN.default)(this,n),o=r.call(this),o.tag=a|0;for(var u=arguments.length,t=new Array(u>1?u-1:0),d=1;d<u;d++)t[d-1]=arguments[d];return o.fields=t,o}return(0,dN.default)(n,[{key:"cases",value:function(){return["Choice1Of7","Choice2Of7","Choice3Of7","Choice4Of7","Choice5Of7","Choice6Of7","Choice7Of7"]}}]),n}(pN.Union);Mu.FSharpChoice$7=X3e;function bZr(e,r,n,a,o,u,t){return(0,mN.union_type)("FSharp.Core.FSharpChoice`7",[e,r,n,a,o,u,t],X3e,function(){return[[["Item",e]],[["Item",r]],[["Item",n]],[["Item",a]],[["Item",o]],[["Item",u]],[["Item",t]]]})}function PZr(e){return new WV(0,e)}function EZr(e){return new WV(1,e)}function NZr(e){if(e.tag===0)return(0,H3e.some)(e.fields[0])}function AZr(e){if(e.tag===1)return(0,H3e.some)(e.fields[0])}});var iwe=Y(xy=>{_();var Wx=An();Object.defineProperty(xy,"__esModule",{value:!0});xy.SystemException=void 0;xy.SystemException$reflection=awe;xy.SystemException_$ctor=IZr;xy.TimeoutException=void 0;xy.TimeoutException$reflection=MZr;xy.TimeoutException_$ctor=wZr;var ewe=Wx(it()),rwe=Wx(at()),nwe=Wx(Qf()),OZr=Wx(zf()),$3e=Wx(Ed()),kZr=Uc(),ooe=c0();function twe(e){var r=FZr();return function(){var a=(0,$3e.default)(e),o;if(r){var u=(0,$3e.default)(this).constructor;o=Reflect.construct(a,arguments,u)}else o=a.apply(this,arguments);return(0,OZr.default)(this,o)}}function FZr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var jV=function(e){(0,nwe.default)(n,e);var r=twe(n);function n(){return(0,rwe.default)(this,n),r.call(this)}return(0,ewe.default)(n)}(kZr.Exception);xy.SystemException=jV;function awe(){return(0,ooe.class_type)("System.SystemException",void 0,jV,(0,ooe.class_type)("System.Exception"))}function IZr(){return new jV}var uoe=function(e){(0,nwe.default)(n,e);var r=twe(n);function n(){return(0,rwe.default)(this,n),r.call(this)}return(0,ewe.default)(n)}(jV);xy.TimeoutException=uoe;function MZr(){return(0,ooe.class_type)("System.TimeoutException",void 0,uoe,awe())}function wZr(){return new uoe}});var pwe=Y(pu=>{_();var swe=An();Object.defineProperty(pu,"__esModule",{value:!0});pu.Async=void 0;pu.awaitPromise=jx;pu.bind=VZr;pu.callThenInvoke=KZr;pu.cancel=jZr;pu.cancelAfter=HZr;pu.cancellationToken=JZr;pu.catchAsync=XZr;pu.createCancellationToken=WZr;pu.defaultCancellationToken=pu.default=void 0;pu.fromContinuations=dwe;pu.ignore=ZZr;pu.invoke=GZr;pu.isCancellationRequested=QZr;pu.makeAsync=UZr;pu.parallel=$Zr;pu.runSynchronously=t$r;pu.sequential=r$r;pu.sleep=n$r;pu.start=fwe;pu.startAsPromise=WF;pu.startChild=cwe;pu.startImmediate=a$r;pu.startWithContinuations=doe;pu.throwIfCancellationRequested=zZr;var DZr=swe(it()),xZr=swe(at()),$d=W3e(),owe=Z3e(),LZr=iwe();function BZr(e,r){var n=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=qZr(e))||r&&e&&typeof e.length=="number"){n&&(e=n);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function qZr(e,r){if(e){if(typeof e=="string")return uwe(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return uwe(e,r)}}function uwe(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,a=new Array(r);n<r;n++)a[n]=e[n];return a}var lwe=(0,DZr.default)(function e(){(0,xZr.default)(this,e)});pu.Async=lwe;function soe(e){}function loe(e){return(0,$d.protectedCont)(function(r){return e()(r)})}function UZr(e){return e}function GZr(e,r){return e(r)}function KZr(e,r,n){return n(r)(e)}function VZr(e,r,n){return(0,$d.protectedBind)(r,n)(e)}function WZr(e){var r=new $d.CancellationToken(typeof e=="boolean"?e:!1);return typeof e=="number"&&setTimeout(function(){r.cancel()},e),r}function jZr(e){e.cancel()}function HZr(e,r){setTimeout(function(){e.cancel()},r)}function QZr(e){return e!=null&&e.isCancelled}function zZr(e){if(e!=null&&e.isCancelled)throw new Error("Operation is cancelled")}function YZr(e){return(0,$d.protectedCont)(function(r){var n,a=setTimeout(function(){r.cancelToken.removeListener(n),r.onError(new LZr.TimeoutException)},e);n=r.cancelToken.addListener(function(){clearTimeout(a),r.onCancel(new $d.OperationCanceledError)})})}function cwe(e,r){if(r){var n=(0,$d.protectedBind)(e$r(e,YZr(r)),function(o){return(0,$d.protectedReturn)(o[0])});return cwe(n)}var a=WF(e);return(0,$d.protectedCont)(function(o){return(0,$d.protectedReturn)(jx(a))(o)})}function jx(e){return dwe(function(r){return e.then(r[0]).catch(function(n){return(n instanceof $d.OperationCanceledError?r[2]:r[1])(n)})})}function JZr(){return(0,$d.protectedCont)(function(e){return e.onSuccess(e.cancelToken)})}var coe=new $d.CancellationToken;pu.defaultCancellationToken=coe;function XZr(e){return(0,$d.protectedCont)(function(r){e({onSuccess:function(a){return r.onSuccess((0,owe.Choice_makeChoice1Of2)(a))},onError:function(a){return r.onSuccess((0,owe.Choice_makeChoice2Of2)(a))},onCancel:r.onCancel,cancelToken:r.cancelToken,trampoline:r.trampoline})})}function dwe(e){return(0,$d.protectedCont)(function(r){return e([r.onSuccess,r.onError,r.onCancel])})}function ZZr(e){return(0,$d.protectedBind)(e,function(r){return(0,$d.protectedReturn)(void 0)})}function $Zr(e){return loe(function(){return jx(Promise.all(Array.from(e,function(r){return WF(r)})))})}function e$r(e,r){return loe(function(){return jx(Promise.all([WF(e),WF(r)]))})}function r$r(e){function r(n){for(var a=Promise.resolve([]),o=function(c){a=a.then(function(l){return WF(c).then(function(f){return l.concat([f])})})},u=BZr(n),t;!(t=u()).done;){var d=t.value;o(d)}return a}return loe(function(){return jx(r(e))})}function n$r(e){return(0,$d.protectedCont)(function(r){var n,a=setTimeout(function(){r.cancelToken.removeListener(n),r.onSuccess(void 0)},e);n=r.cancelToken.addListener(function(){clearTimeout(a),r.onCancel(new $d.OperationCanceledError)})})}function t$r(){throw new Error("Asynchronous code cannot be run synchronously in JS")}function fwe(e,r){return doe(e,r)}function a$r(e,r){return fwe(e,r)}function doe(e,r,n,a,o){typeof r!="function"&&(o=r,r=void 0);var u=new $d.Trampoline;e({onSuccess:r||soe,onError:n||soe,onCancel:a||soe,cancelToken:o||coe,trampoline:u})}function WF(e,r){return new Promise(function(n,a){return doe(e,n,a,a,r||coe)})}var i$r=lwe;pu.default=i$r});var HF=Y(st=>{_();var Yx=An();Object.defineProperty(st,"__esModule",{value:!0});st.CancelActionKind=void 0;st.CancelActionKind$reflection=P$r;st.CancellationTokenWrapper=void 0;st.CancellationTokenWrapper$reflection=_$r;st.CancellationTokenWrapper_$ctor_Z211DAE3E=R$r;st.FrameworkCancellationToken=void 0;st.FrameworkCancellationToken$reflection=Poe;st.FrameworkCancellationToken_$ctor=C$r;st.MatchedToken=void 0;st.MatchedToken$reflection=Pwe;st.ModifyStatus=void 0;st.ModifyStatus$reflection=hwe;st.Observed=void 0;st.Observed$reflection=v$r;st.RepairResult=void 0;st.RepairResult$reflection=y$r;st.Span=void 0;st.Span$reflection=d$r;st.StackElement=void 0;st.StackElement$reflection=Twe;st.State$1=void 0;st.State$1$reflection=voe;st.State$1__get_IsDone=S$r;st.SymbolSource=void 0;st.SymbolSource$reflection=boe;st.TimeoutCancellationToken=void 0;st.TimeoutCancellationToken$reflection=T$r;st.TimeoutCancellationToken_$ctor_5E38073B=b$r;st.TimeoutCancellationToken_$ctor_Z342822E9=Awe;st.Token=void 0;st.Token$reflection=jF;st.TokenMetaInfo=void 0;st.TokenMetaInfo$reflection=c$r;st.TokenMetaInfo__get_Modifiable=Swe;st.Token_$ctor_5C2E8043=QV;st.Token_$ctor_5EDE2FB7=p$r;st.Token_$ctor_74210AD3=m$r;st.Token_$ctor_Z176EF219=f$r;st.Token__EqualsExceptMetaInfo_315F8FC7=g$r;st.Token__get_MetaInfo=ywe;st.Token__get_Span=goe;st.Token__get_Symbol=poe;st.Token__get_Value=moe;st.debugOfRule=Cwe;st.debugOfSeq=Hx;st.debugOfSymbol=hoe;st.defaultSymbolSource=st.defaultSpan=st.defaultInputMeta=st.debugParserConfig=void 0;var Ym=Yx(at()),Jm=Yx(it()),jg=Yx(Qf()),o$r=Yx(zf()),mwe=Yx(Ed()),Qx=Cc(),u$r=Oy(),W0=Uc(),Ch=N_(),To=c0(),vwe=Dy(),gwe=O_(),s$r=pwe(),foe=fie();function Hg(e){var r=l$r();return function(){var a=(0,mwe.default)(e),o;if(r){var u=(0,mwe.default)(this).constructor;o=Reflect.construct(a,arguments,u)}else o=a.apply(this,arguments);return(0,o$r.default)(this,o)}}function l$r(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var zx=(0,Qx.createAtom)(void 0);st.debugParserConfig=zx;function hoe(e){var r;if(zx()!=null){var n,a=null;n=[(0,u$r.tryGetValue)(zx().SymbolNames,e,new W0.FSharpRef(function(){return a},function(o){a=o})),a],r=n[0]?n[1]:void 0}else r=void 0;return r??(0,Ch.toText)((0,Ch.printf)("?%d"))(e)}var HV=function(e){(0,jg.default)(n,e);var r=Hg(n);function n(a){var o;(0,Ym.default)(this,n),o=r.call(this),o.tag=a|0;for(var u=arguments.length,t=new Array(u>1?u-1:0),d=1;d<u;d++)t[d-1]=arguments[d];return o.fields=t,o}return(0,Jm.default)(n,[{key:"cases",value:function(){return["Unmodified","AdHoc","Core"]}}]),n}(W0.Union);st.ModifyStatus=HV;function hwe(){return(0,To.union_type)("Microsoft.ProgramSynthesis.Repair.Framework.ParseState.ModifyStatus",[],HV,function(){return[[],[],[]]})}var Soe=function(e){(0,jg.default)(n,e);var r=Hg(n);function n(a,o){var u;return(0,Ym.default)(this,n),u=r.call(this),u.FromInput=a,u.ModifyStatus=o,u}return(0,Jm.default)(n,[{key:"toString",value:function(){var o=this,u=[o.FromInput,Swe(o)];return u[0]?u[1]?"":"[*]":u[1]?"[+]":"[+*]"}}]),n}(W0.Record);st.TokenMetaInfo=Soe;function c$r(){return(0,To.record_type)("Microsoft.ProgramSynthesis.Repair.Framework.ParseState.TokenMetaInfo",[],Soe,function(){return[["FromInput",To.bool_type],["ModifyStatus",hwe()]]})}function Swe(e){return(0,Qx.equals)(e.ModifyStatus,new HV(0))}var yoe=new Soe(!0,new HV(0));st.defaultInputMeta=yoe;var Coe=function(e){(0,jg.default)(n,e);var r=Hg(n);function n(a,o){var u;return(0,Ym.default)(this,n),u=r.call(this),u.Start=a|0,u.End=o|0,u}return(0,Jm.default)(n)}(W0.Record);st.Span=Coe;function d$r(){return(0,To.record_type)("Microsoft.ProgramSynthesis.Repair.Framework.ParseState.Span",[],Coe,function(){return[["Start",To.int32_type],["End",To.int32_type]]})}var _oe=new Coe(0,0);st.defaultSpan=_oe;var Roe=function(e){(0,jg.default)(n,e);var r=Hg(n);function n(a,o,u,t){var d;return(0,Ym.default)(this,n),d=r.call(this),d.symbol=a|0,d.value=o,d.meta=u,d.span=t,d}return(0,Jm.default)(n,[{key:"toString",value:function(){var o=this,u=hoe(o.symbol),t=(0,Ch.isNullOrEmpty)(o.value)?"":"("+o.value+")";return""+u+t+ywe(o)}}]),n}(W0.Record);st.Token=Roe;function jF(){return(0,To.class_type)("Microsoft.ProgramSynthesis.Repair.Framework.ParseState.Token",void 0,Roe,(0,To.class_type)("System.ValueType"))}function QV(e,r,n,a){return new Roe(e,r,n,a)}function f$r(e,r){return QV(e,r,yoe,_oe)}function p$r(e,r,n){return QV(e,r,yoe,n)}function m$r(e,r,n){return QV(e,r,n,_oe)}function poe(e){return e.symbol}function moe(e){return e.value}function ywe(e){return e.meta}function goe(e){return e.span}function g$r(e,r){return poe(e)===poe(r)&&moe(e)===moe(r)?(0,Qx.equals)(goe(e),goe(r)):!1}function Hx(e,r){return(0,Ch.join)(e,(0,vwe.map)(function(n){var a=n;return(0,W0.toString)(a)},r))}function Cwe(e){var r;if(zx()!=null){var n=zx();r=e>=0&&e<n.RuleStrings.length?n.RuleStrings[e]:void 0}else r=void 0;return r??(0,Ch.toText)((0,Ch.printf)("?%d"))(e)}var _we=function(e){(0,jg.default)(n,e);var r=Hg(n);function n(a,o,u){var t;return(0,Ym.default)(this,n),t=r.call(this),t.Reliable=a,t.Unreliable=o,t.MinEditDist=u,t}return(0,Jm.default)(n,[{key:"toString",value:function(){var o=this,u=Hx(" ",o.Unreliable),t=(0,W0.toString)(o.Reliable);return(0,Ch.toText)((0,Ch.printf)("(%s, %s)"))(u)(t)}}]),n}(W0.Record);st.Observed=_we;function v$r(){return(0,To.record_type)("Microsoft.ProgramSynthesis.Repair.Framework.ParseState.Observed",[],_we,function(){return[["Reliable",jF()],["Unreliable",(0,To.list_type)(jF())],["MinEditDist",(0,To.option_type)(To.float64_type)]]})}var Toe=function(e){(0,jg.default)(n,e);var r=Hg(n);function n(a,o){var u;return(0,Ym.default)(this,n),u=r.call(this),u.RuleId=a|0,u.RuleIdx=o|0,u}return(0,Jm.default)(n,[{key:"toString",value:function(){var o=this,u=Cwe(o.RuleId);return(0,Ch.toText)((0,Ch.printf)("(%s, %d)"))(u)(o.RuleIdx)}}]),n}(W0.Record);st.SymbolSource=Toe;function boe(){return(0,To.record_type)("Microsoft.ProgramSynthesis.Repair.Framework.ParseState.SymbolSource",[],Toe,function(){return[["RuleId",To.int32_type],["RuleIdx",To.int32_type]]})}var h$r=new Toe(-1,-1);st.defaultSymbolSource=h$r;var Rwe=function(e){(0,jg.default)(n,e);var r=Hg(n);function n(a,o){var u;return(0,Ym.default)(this,n),u=r.call(this),u.Symbol=a|0,u.Source=o,u}return(0,Jm.default)(n,[{key:"toString",value:function(){var o=this;return hoe(o.Symbol)}}]),n}(W0.Record);st.StackElement=Rwe;function Twe(){return(0,To.record_type)("Microsoft.ProgramSynthesis.Repair.Framework.ParseState.StackElement",[],Rwe,function(){return[["Symbol",To.int32_type],["Source",boe()]]})}var bwe=function(e){(0,jg.default)(n,e);var r=Hg(n);function n(a,o){var u;return(0,Ym.default)(this,n),u=r.call(this),u.Token=a,u.Source=o,u}return(0,Jm.default)(n,[{key:"toString",value:function(){var o=this;return(0,W0.toString)(o.Token)}}]),n}(W0.Record);st.MatchedToken=bwe;function Pwe(){return(0,To.record_type)("Microsoft.ProgramSynthesis.Repair.Framework.ParseState.MatchedToken",[],bwe,function(){return[["Token",jF()],["Source",boe()]]})}var Ewe=function(e){(0,jg.default)(n,e);var r=Hg(n);function n(a,o,u,t,d,s,c,l){var f;return(0,Ym.default)(this,n),f=r.call(this),f.Input=a,f.Stack=o,f.MatchedTokens=u,f.Cost=t,f.EditDistance=d,f.Backtrack=s,f.Parent=c,f.Context=l,f}return(0,Jm.default)(n,[{key:"toString",value:function(){var o=this,u=Hx(" ",o.Input),t=Hx(" ",o.Stack),d=Hx(" ",(0,vwe.reverse)(o.MatchedTokens));return(0,Ch.toText)((0,Ch.printf)("{Input = %s, Stack = %s, Matched = %s, Cost = %f, EditDistance = %f}"))(u)(t)(d)(o.Cost)(o.EditDistance)}}]),n}(W0.Record);st.State$1=Ewe;function voe(e){return(0,To.record_type)("Microsoft.ProgramSynthesis.Repair.Framework.ParseState.State`1",[e],Ewe,function(){return[["Input",(0,To.list_type)(jF())],["Stack",(0,To.list_type)(Twe())],["MatchedTokens",(0,To.list_type)(Pwe())],["Cost",To.float64_type],["EditDistance",To.float64_type],["Backtrack",(0,To.option_type)(voe(e))],["Parent",(0,To.option_type)(voe(e))],["Context",(0,To.option_type)(e)]]})}function S$r(e){return(0,Qx.equals)(e.Input,(0,gwe.empty)())?(0,Qx.equals)(e.Stack,(0,gwe.empty)()):!1}var Nwe=function(e){(0,jg.default)(n,e);var r=Hg(n);function n(a,o,u){var t;return(0,Ym.default)(this,n),t=r.call(this),t.Tokens=a,t.EditDistance=o,t.Cost=u,t}return(0,Jm.default)(n)}(W0.Record);st.RepairResult=Nwe;function y$r(){return(0,To.record_type)("Microsoft.ProgramSynthesis.Repair.Framework.ParseState.RepairResult",[],Nwe,function(){return[["Tokens",(0,To.array_type)(jF())],["EditDistance",To.float64_type],["Cost",To.float64_type]]})}var Jx=function(){function e(){(0,Ym.default)(this,e)}return(0,Jm.default)(e,[{key:"Microsoft.ProgramSynthesis.Repair.Framework.ParseState.FrameworkCancellationToken.get_IsDebuggerAttached",value:function(){return!1}}]),e}();st.FrameworkCancellationToken=Jx;function Poe(){return(0,To.class_type)("Microsoft.ProgramSynthesis.Repair.Framework.ParseState.FrameworkCancellationToken",void 0,Jx)}function C$r(){return new Jx}var Eoe=function(e){(0,jg.default)(n,e);var r=Hg(n);function n(a){var o;return(0,Ym.default)(this,n),o=r.call(this),o.token=a,o}return(0,Jm.default)(n,[{key:"Microsoft.ProgramSynthesis.Repair.Framework.ParseState.FrameworkCancellationToken.get_IsCancellationRequested",value:function(){var o=this;return o["Microsoft.ProgramSynthesis.Repair.Framework.ParseState.FrameworkCancellationToken.get_IsDebuggerAttached"]()?!1:(0,s$r.isCancellationRequested)(o.token)}}]),n}(Jx);st.CancellationTokenWrapper=Eoe;function _$r(){return(0,To.class_type)("Microsoft.ProgramSynthesis.Repair.Framework.ParseState.CancellationTokenWrapper",void 0,Eoe,Poe())}function R$r(e){return new Eoe(e)}var Noe=function(e){(0,jg.default)(n,e);var r=Hg(n);function n(a){var o;return(0,Ym.default)(this,n),o=r.call(this),o.time=a,o.start=(0,foe.now)(),o}return(0,Jm.default)(n,[{key:"Microsoft.ProgramSynthesis.Repair.Framework.ParseState.FrameworkCancellationToken.get_IsCancellationRequested",value:function(){var o=this;return o["Microsoft.ProgramSynthesis.Repair.Framework.ParseState.FrameworkCancellationToken.get_IsDebuggerAttached"]()?!1:(0,foe.op_Subtraction)((0,foe.now)(),o.start)>=o.time}}]),n}(Jx);st.TimeoutCancellationToken=Noe;function T$r(){return(0,To.class_type)("Microsoft.ProgramSynthesis.Repair.Framework.ParseState.TimeoutCancellationToken",void 0,Noe,Poe())}function Awe(e){return new Noe(e)}function b$r(e){return Awe(e)}var Owe=function(e){(0,jg.default)(n,e);var r=Hg(n);function n(a){var o;(0,Ym.default)(this,n),o=r.call(this),o.tag=a|0;for(var u=arguments.length,t=new Array(u>1?u-1:0),d=1;d<u;d++)t[d-1]=arguments[d];return o.fields=t,o}return(0,Jm.default)(n,[{key:"cases",value:function(){return["EmptyResult","IncompleteResults","Exception"]}}]),n}(W0.Union);st.CancelActionKind=Owe;function P$r(){return(0,To.union_type)("Microsoft.ProgramSynthesis.Repair.Framework.ParseState.CancelActionKind",[],Owe,function(){return[[],[],[]]})}});var Iwe=Y(_h=>{_();var kwe=An();Object.defineProperty(_h,"__esModule",{value:!0});_h.HashSet=void 0;_h.HashSet$reflection=O$r;_h.HashSet_$ctor_Z6150332D=k$r;_h.HashSet__Add_2B595=zV;_h.HashSet__Clear=Aoe;_h.HashSet__Contains_2B595=koe;_h.HashSet__Remove_2B595=Foe;_h.HashSet__get_Comparer=F$r;_h.HashSet__get_Count=Ooe;var E$r=kwe(at()),N$r=kwe(it()),vN=Cc(),QF=Dy(),Fwe=Uc(),A$r=c0(),Ioe=Oy(),KFn=Iy(),Moe=function(e,r){function n(a,o){(0,E$r.default)(this,n);var u=new Fwe.FSharpRef(null);this.comparer=o,u.contents=this,this.hashMap=new Map([]),this["init@8-2"]=1;var t=(0,vN.getEnumerator)(a);try{for(;t["System.Collections.IEnumerator.MoveNext"]();){var d=t["System.Collections.Generic.IEnumerator`1.get_Current"]();zV(u.contents,d)}}finally{(0,vN.disposeSafe)(t)}}return(0,N$r.default)(n,[{key:e,get:function(){return"HashSet"}},{key:"toJSON",value:function(o){var u=this;return Array.from(u)}},{key:"System.Collections.IEnumerable.GetEnumerator",value:function(){var o=this;return(0,vN.getEnumerator)(o)}},{key:"GetEnumerator",value:function(){var o=this;return(0,vN.getEnumerator)((0,QF.concat)(o.hashMap.values()))}},{key:r,value:function(){return(0,vN.toIterator)(this.GetEnumerator())}},{key:"System.Collections.Generic.ICollection`1.Add2B595",value:function(o){var u=this;zV(u,o)}},{key:"System.Collections.Generic.ICollection`1.Clear",value:function(){var o=this;Aoe(o)}},{key:"System.Collections.Generic.ICollection`1.Contains2B595",value:function(o){var u=this;return koe(u,o)}},{key:"System.Collections.Generic.ICollection`1.CopyToZ2E171D71",value:function(o,u){var t=this;(0,QF.iterateIndexed)(function(d,s){o[u+d]=s},t)}},{key:"System.Collections.Generic.ICollection`1.get_Count",value:function(){var o=this;return Ooe(o)|0}},{key:"System.Collections.Generic.ICollection`1.get_IsReadOnly",value:function(){return!1}},{key:"System.Collections.Generic.ICollection`1.Remove2B595",value:function(o){var u=this;return Foe(u,o)}},{key:"size",get:function(){var o=this;return Ooe(o)|0}},{key:"add",value:function(o){var u=this;return zV(u,o),u}},{key:"clear",value:function(){var o=this;Aoe(o)}},{key:"delete",value:function(o){var u=this;return Foe(u,o)}},{key:"has",value:function(o){var u=this;return koe(u,o)}},{key:"keys",value:function(){var o=this;return(0,QF.map)(function(u){return u},o)}},{key:"values",value:function(){var o=this;return(0,QF.map)(function(u){return u},o)}},{key:"entries",value:function(){var o=this;return(0,QF.map)(function(u){return[u,u]},o)}},{key:"forEach",value:function(o,u){var t=this;(0,QF.iterate)(function(d){o(d,d,t)},t)}}]),n}(Symbol.toStringTag,Symbol.iterator);_h.HashSet=Moe;function O$r(e){return(0,A$r.class_type)("Fable.Collections.HashSet",[e],Moe)}function k$r(e,r){return new Moe(e,r)}function woe(e,r){var n=e.comparer.GetHashCode(r)|0,a,o=null;return a=[(0,Ioe.tryGetValue)(e.hashMap,n,new Fwe.FSharpRef(function(){return o},function(u){o=u})),o],a[0]?[!0,n,a[1].findIndex(function(u){return e.comparer.Equals(r,u)})]:[!1,n,-1]}function F$r(e){return e.comparer}function Aoe(e){e.hashMap.clear()}function Ooe(e){var r=0,n=(0,vN.getEnumerator)(e.hashMap.values());try{for(;n["System.Collections.IEnumerator.MoveNext"]();){var a=n["System.Collections.Generic.IEnumerator`1.get_Current"]();r=r+a.length|0}}finally{(0,vN.disposeSafe)(n)}return r|0}function zV(e,r){var n=woe(e,r),a;switch(n[0]&&n[2]>-1?a=0:a=1,a){case 0:return!1;case 1:if(n[0]){var o=void(0,Ioe.getItemFromDict)(e.hashMap,n[1]).push(r);return!0}else return e.hashMap.set(n[1],[r]),!0}}function koe(e,r){var n=woe(e,r),a;switch(n[0]&&n[2]>-1?a=0:a=1,a){case 0:return!0;case 1:return!1}}function Foe(e,r){var n=woe(e,r),a;switch(n[0]&&n[2]>-1?a=0:a=1,a){case 0:return(0,Ioe.getItemFromDict)(e.hashMap,n[1]).splice(n[2],1),!0;case 1:return!1}}});var a4=Y(mr=>{_();var JF=An();Object.defineProperty(mr,"__esModule",{value:!0});mr.FSharpSet=void 0;mr.FSharpSet$reflection=B$r;mr.FSharpSet_$ctor=$m;mr.FSharpSet_Compare=G$r;mr.FSharpSet_Empty=rW;mr.FSharpSet_Equality=U$r;mr.FSharpSet_Intersection=oue;mr.FSharpSet_IntersectionMany=fDe;mr.FSharpSet__Add=tue;mr.FSharpSet__ComputeHashCode=hDe;mr.FSharpSet__Contains=aue;mr.FSharpSet__Exists=lDe;mr.FSharpSet__Filter=uDe;mr.FSharpSet__Fold=q$r;mr.FSharpSet__ForAll=cDe;mr.FSharpSet__IsProperSubsetOf=j$r;mr.FSharpSet__IsProperSupersetOf=H$r;mr.FSharpSet__IsSubsetOf=V$r;mr.FSharpSet__IsSupersetOf=W$r;mr.FSharpSet__Iterate=aDe;mr.FSharpSet__Map=sDe;mr.FSharpSet__Partition=oDe;mr.FSharpSet__Remove=tDe;mr.FSharpSet__ToArray=vDe;mr.FSharpSet__ToList=gDe;mr.FSharpSet__get_Choose=K$r;mr.FSharpSet__get_Comparer=wu;mr.FSharpSet__get_Count=Zx;mr.FSharpSet__get_IsEmpty=iDe;mr.FSharpSet__get_MaximumElement=mDe;mr.FSharpSet__get_MinimumElement=pDe;mr.FSharpSet__get_Tree=Vt;mr.FSharpSet_op_Addition=iue;mr.FSharpSet_op_Subtraction=dDe;mr.SetTreeLeaf$1=void 0;mr.SetTreeLeaf$1$reflection=Uoe;mr.SetTreeLeaf$1_$ctor_2B595=Xm;mr.SetTreeLeaf$1__get_Key=yn;mr.SetTreeModule_SetIterator$1=void 0;mr.SetTreeModule_SetIterator$1$reflection=L$r;mr.SetTreeModule_add=Tc;mr.SetTreeModule_alreadyFinished=Ywe;mr.SetTreeModule_balance=CN;mr.SetTreeModule_choose=Zwe;mr.SetTreeModule_collapseLHS=Zoe;mr.SetTreeModule_compare=e4;mr.SetTreeModule_compareStacks=Xwe;mr.SetTreeModule_copyToArray=$oe;mr.SetTreeModule_count=Koe;mr.SetTreeModule_countAux=Goe;mr.SetTreeModule_current=Boe;mr.SetTreeModule_diff=Uwe;mr.SetTreeModule_diffAux=Qoe;mr.SetTreeModule_empty=x$r;mr.SetTreeModule_exists=eW;mr.SetTreeModule_filter=qwe;mr.SetTreeModule_filterAux=Hoe;mr.SetTreeModule_fold=$V;mr.SetTreeModule_foldBack=Bwe;mr.SetTreeModule_foldBackOpt=Woe;mr.SetTreeModule_foldOpt=joe;mr.SetTreeModule_forall=r4;mr.SetTreeModule_intersection=Gwe;mr.SetTreeModule_intersectionAux=zoe;mr.SetTreeModule_iter=ZV;mr.SetTreeModule_maximumElement=Qwe;mr.SetTreeModule_maximumElementAux=jwe;mr.SetTreeModule_maximumElementOpt=Hwe;mr.SetTreeModule_mem=tb;mr.SetTreeModule_minimumElement=Joe;mr.SetTreeModule_minimumElementAux=Vwe;mr.SetTreeModule_minimumElementOpt=Wwe;mr.SetTreeModule_mk=j0;mr.SetTreeModule_mkFromEnumerator=rDe;mr.SetTreeModule_mkIEnumerator=qoe;mr.SetTreeModule_mkIterator=Loe;mr.SetTreeModule_moveNext=Jwe;mr.SetTreeModule_notStarted=zwe;mr.SetTreeModule_ofArray=eue;mr.SetTreeModule_ofList=nDe;mr.SetTreeModule_ofSeq=rue;mr.SetTreeModule_partition=Kwe;mr.SetTreeModule_partition1=xoe;mr.SetTreeModule_partitionAux=Yoe;mr.SetTreeModule_properSubset=t4;mr.SetTreeModule_rebalance=yN;mr.SetTreeModule_remove=YF;mr.SetTreeModule_spliceOutSuccessor=Voe;mr.SetTreeModule_split=$x;mr.SetTreeModule_subset=n4;mr.SetTreeModule_toArray=eDe;mr.SetTreeModule_toList=$we;mr.SetTreeModule_union=zF;mr.SetTreeNode$1=void 0;mr.SetTreeNode$1$reflection=D$r;mr.SetTreeNode$1_$ctor_Z6E7BE5F7=Zm;mr.SetTreeNode$1__get_Height=Qg;mr.SetTreeNode$1__get_Left=Oa;mr.SetTreeNode$1__get_Right=va;mr.add=Y$r;mr.contains=z$r;mr.count=den;mr.difference=Sen;mr.empty=ten;mr.exceptWith=Nen;mr.exists=ien;mr.filter=oen;mr.fold=sen;mr.foldBack=len;mr.forAll=aen;mr.intersect=een;mr.intersectMany=ren;mr.intersectWith=Een;mr.isEmpty=Q$r;mr.isProperSubset=_en;mr.isProperSubsetOf=ken;mr.isProperSuperset=Ren;mr.isProperSupersetOf=Fen;mr.isSubset=yen;mr.isSubsetOf=Aen;mr.isSuperset=Cen;mr.isSupersetOf=Oen;mr.iterate=nen;mr.map=cen;mr.maxElement=ben;mr.minElement=Ten;mr.newMutableSetWith=nW;mr.ofArray=pen;mr.ofList=fen;mr.ofSeq=hen;mr.partition=uen;mr.remove=X$r;mr.singleton=J$r;mr.toArray=gen;mr.toList=men;mr.toSeq=ven;mr.union=Z$r;mr.unionMany=$$r;mr.unionWith=Pen;var Xx=JF(V_()),wwe=JF(Qf()),I$r=JF(zf()),Mwe=JF(Ed()),YV=JF(it()),JV=JF(at()),hN=c0(),Ly=Iy(),Dwe=Uc(),Fr=O_(),xwe=qF(),SN=Cc(),M$r=N_(),yp=Dy(),Doe=Iwe();function Lwe(e){var r=w$r();return function(){var a=(0,Mwe.default)(e),o;if(r){var u=(0,Mwe.default)(this).constructor;o=Reflect.construct(a,arguments,u)}else o=a.apply(this,arguments);return(0,I$r.default)(this,o)}}function w$r(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var XV=(0,YV.default)(function e(r){(0,JV.default)(this,e),this.k=r});mr.SetTreeLeaf$1=XV;function Uoe(e){return(0,hN.class_type)("Set.SetTreeLeaf`1",[e],XV)}function Xm(e){return new XV(e)}function yn(e){return e.k}var Aa=function(e){(0,wwe.default)(n,e);var r=Lwe(n);function n(a,o,u,t){var d;return(0,JV.default)(this,n),d=r.call(this,a),d.left=o,d.right=u,d.h=t|0,d}return(0,YV.default)(n)}(XV);mr.SetTreeNode$1=Aa;function D$r(e){return(0,hN.class_type)("Set.SetTreeNode`1",[e],Aa,Uoe(e))}function Zm(e,r,n,a){return new Aa(e,r,n,a)}function Oa(e){return e.left}function va(e){return e.right}function Qg(e){return e.h}function x$r(){}function Goe(e,r){e:for(;;){var n=e,a=r;if(n!=null){var o=n;if(o instanceof Aa){e=Oa(o),r=Goe(va(o),a+1);continue e}else return a+1|0}else return a|0;break}}function Koe(e){return Goe(e,0)}function j0(e,r,n){var a,o=e;if(o!=null){var u=o;a=u instanceof Aa?Qg(u):1}else a=0;var t,d=n;if(d!=null){var s=d;t=s instanceof Aa?Qg(s):1}else t=0;var c=(a<t?t:a)|0;return c===0?Xm(r):Zm(r,e,n,c+1)}function yN(e,r,n){var a,o,u,t,d,s=e;if(s!=null){var c=s;d=c instanceof Aa?Qg(c):1}else d=0;var l,f=n;if(f!=null){var p=f;l=p instanceof Aa?Qg(p):1}else l=0;if(l>d+2){var m=(0,Ly.value)(n);if(m instanceof Aa)if(a=Oa(m),(a!=null?(o=a,o instanceof Aa?Qg(o):1):0)>d+1){var v=(0,Ly.value)(Oa(m));if(v instanceof Aa)return j0(j0(e,r,Oa(v)),yn(v),j0(va(v),yn(m),va(m)));throw new Error("internal error: Set.rebalance")}else return j0(j0(e,r,Oa(m)),yn(m),va(m));else throw new Error("internal error: Set.rebalance")}else if(d>l+2){var h=(0,Ly.value)(e);if(h instanceof Aa)if(u=va(h),(u!=null?(t=u,t instanceof Aa?Qg(t):1):0)>l+1){var S=(0,Ly.value)(va(h));if(S instanceof Aa)return j0(j0(Oa(h),yn(h),Oa(S)),yn(S),j0(va(S),r,n));throw new Error("internal error: Set.rebalance")}else return j0(Oa(h),yn(h),j0(va(h),r,n));else throw new Error("internal error: Set.rebalance")}else return j0(e,r,n)}function Tc(e,r,n){if(n!=null){var a=n,o=e.Compare(r,yn(a))|0;if(a instanceof Aa)return o<0?yN(Tc(e,r,Oa(a)),yn(a),va(a)):o===0?n:yN(Oa(a),yn(a),Tc(e,r,va(a)));var u=e.Compare(r,yn(a))|0;return u<0?Zm(r,void 0,n,2):u===0?n:Zm(r,n,void 0,2)}else return Xm(r)}function CN(e,r,n,a){if(r!=null){var o=r;if(a!=null){var u=a;return o instanceof Aa?u instanceof Aa?Qg(o)+2<Qg(u)?yN(CN(e,r,n,Oa(u)),yn(u),va(u)):Qg(u)+2<Qg(o)?yN(Oa(o),yn(o),CN(e,va(o),n,a)):j0(r,n,a):Tc(e,n,Tc(e,yn(u),r)):Tc(e,n,Tc(e,yn(o),a))}else return Tc(e,n,r)}else return Tc(e,n,a)}function $x(e,r,n){if(n!=null){var a=n;if(a instanceof Aa){var o=e.Compare(r,yn(a))|0;if(o<0){var u=$x(e,r,Oa(a));return[u[0],u[1],CN(e,u[2],yn(a),va(a))]}else{if(o===0)return[Oa(a),!0,va(a)];var t=$x(e,r,va(a));return[CN(e,Oa(a),yn(a),t[0]),t[1],t[2]]}}else{var d=e.Compare(yn(a),r)|0;return d<0?[n,!1,void 0]:d===0?[void 0,!0,void 0]:[void 0,!1,n]}}else return[void 0,!1,void 0]}function Voe(e){if(e!=null){var r=e;if(r instanceof Aa){if(Oa(r)==null)return[yn(r),va(r)];var n=Voe(Oa(r));return[n[0],j0(n[1],yn(r),va(r))]}else return[yn(r),void 0]}else throw new Error("internal error: Set.spliceOutSuccessor")}function YF(e,r,n){if(n!=null){var a=n,o=e.Compare(r,yn(a))|0;if(a instanceof Aa){if(o<0)return yN(YF(e,r,Oa(a)),yn(a),va(a));if(o===0){if(Oa(a)==null)return va(a);if(va(a)==null)return Oa(a);var u=Voe(va(a));return j0(Oa(a),u[0],u[1])}else return yN(Oa(a),yn(a),YF(e,r,va(a)))}else return o===0?void 0:n}else return n}function tb(e,r,n){e:for(;;){var a=e,o=r,u=n;if(u!=null){var t=u,d=a.Compare(o,yn(t))|0;if(t instanceof Aa)if(d<0){e=a,r=o,n=Oa(t);continue e}else{if(d===0)return!0;e=a,r=o,n=va(t);continue e}else return d===0}else return!1;break}}function ZV(e,r){e:for(;;){var n=e,a=r;if(a!=null){var o=a;if(o instanceof Aa){ZV(n,Oa(o)),n(yn(o)),e=n,r=va(o);continue e}else n(yn(o))}break}}function Woe(e,r,n){e:for(;;){var a=e,o=r,u=n;if(o!=null){var t=o;if(t instanceof Aa){e=a,r=Oa(t),n=a(yn(t),Woe(a,va(t),u));continue e}else return a(yn(t),u)}else return u;break}}function Bwe(e,r,n){return Woe(e,r,n)}function joe(e,r,n){e:for(;;){var a=e,o=r,u=n;if(u!=null){var t=u;if(t instanceof Aa){e=a,r=a(joe(a,o,Oa(t)),yn(t)),n=va(t);continue e}else return a(o,yn(t))}else return o;break}}function $V(e,r,n){return joe(e,r,n)}function r4(e,r){e:for(;;){var n=e,a=r;if(a!=null){var o=a;if(o instanceof Aa)if(n(yn(o))&&r4(n,Oa(o))){e=n,r=va(o);continue e}else return!1;else return n(yn(o))}else return!0;break}}function eW(e,r){e:for(;;){var n=e,a=r;if(a!=null){var o=a;if(o instanceof Aa){if(n(yn(o))||eW(n,Oa(o)))return!0;e=n,r=va(o);continue e}else return n(yn(o))}else return!1;break}}function n4(e,r,n){return r4(function(a){return tb(e,a,n)},r)}function t4(e,r,n){return r4(function(a){return tb(e,a,n)},r)?eW(function(a){return!tb(e,a,r)},n):!1}function Hoe(e,r,n,a){e:for(;;){var o=e,u=r,t=n,d=a;if(t!=null){var s=t;if(s instanceof Aa){var c=u(yn(s))?Tc(o,yn(s),d):d;e=o,r=u,n=Oa(s),a=Hoe(o,u,va(s),c);continue e}else return u(yn(s))?Tc(o,yn(s),d):d}else return d;break}}function qwe(e,r,n){return Hoe(e,r,n,void 0)}function Qoe(e,r,n){e:for(;;){var a=e,o=r,u=n;if(u==null)return u;if(o!=null){var t=o;if(t instanceof Aa){e=a,r=Oa(t),n=Qoe(a,va(t),YF(a,yn(t),u));continue e}else return YF(a,yn(t),u)}else return u;break}}function Uwe(e,r,n){return Qoe(e,n,r)}function zF(e,r,n){if(r!=null){var a=r;if(n!=null){var o=n;if(a instanceof Aa)if(o instanceof Aa)if(Qg(a)>Qg(o)){var u=$x(e,yn(a),n);return CN(e,zF(e,Oa(a),u[0]),yn(a),zF(e,va(a),u[2]))}else{var t=$x(e,yn(o),r);return CN(e,zF(e,Oa(o),t[0]),yn(o),zF(e,va(o),t[2]))}else return Tc(e,yn(o),r);else return Tc(e,yn(a),n)}else return r}else return n}function zoe(e,r,n,a){e:for(;;){var o=e,u=r,t=n,d=a;if(t!=null){var s=t;if(s instanceof Aa){var c=zoe(o,u,va(s),d),l=tb(o,yn(s),u)?Tc(o,yn(s),c):c;e=o,r=u,n=Oa(s),a=l;continue e}else return tb(o,yn(s),u)?Tc(o,yn(s),d):d}else return d;break}}function Gwe(e,r,n){return zoe(e,n,r,void 0)}function xoe(e,r,n,a,o){return r(n)?[Tc(e,n,a),o]:[a,Tc(e,n,o)]}function Yoe(e,r,n,a,o){e:for(;;){var u=e,t=r,d=n,s=a,c=o,l=[s,c];if(d!=null){var f=d;if(f instanceof Aa){var p=Yoe(u,t,va(f),l[0],l[1]),m=xoe(u,t,yn(f),p[0],p[1]);e=u,r=t,n=Oa(f),a=m[0],o=m[1];continue e}else return xoe(u,t,yn(f),l[0],l[1])}else return l;break}}function Kwe(e,r,n){return Yoe(e,r,n,void 0,void 0)}function Vwe(e,r){e:for(;;){var n=e,a=r;if(n!=null){var o=n;if(o instanceof Aa){e=Oa(o),r=yn(o);continue e}else return yn(o)}else return a;break}}function Wwe(e){if(e!=null){var r=e;return r instanceof Aa?(0,Ly.some)(Vwe(Oa(r),yn(r))):(0,Ly.some)(yn(r))}else return}function jwe(e,r){e:for(;;){var n=e,a=r;if(n!=null){var o=n;if(o instanceof Aa){e=va(o),r=yn(o);continue e}else return yn(o)}else return a;break}}function Hwe(e){if(e!=null){var r=e;return r instanceof Aa?(0,Ly.some)(jwe(va(r),yn(r))):(0,Ly.some)(yn(r))}else return}function Joe(e){var r=Wwe(e);if(r==null)throw new Error("Set contains no elements");return(0,Ly.value)(r)}function Qwe(e){var r=Hwe(e);if(r==null)throw new Error("Set contains no elements");return(0,Ly.value)(r)}var Xoe=function(e){(0,wwe.default)(n,e);var r=Lwe(n);function n(a,o){var u;return(0,JV.default)(this,n),u=r.call(this),u.stack=a,u.started=o,u}return(0,YV.default)(n)}(Dwe.Record);mr.SetTreeModule_SetIterator$1=Xoe;function L$r(e){return(0,hN.record_type)("Set.SetTreeModule.SetIterator`1",[e],Xoe,function(){return[["stack",(0,hN.list_type)((0,hN.option_type)(Uoe(e)))],["started",hN.bool_type]]})}function Zoe(e){e:for(;;){var r=e;if((0,Fr.isEmpty)(r))return(0,Fr.empty)();var n=(0,Fr.head)(r),a=(0,Fr.tail)(r);if(n!=null){var o=n;if(o instanceof Aa){e=(0,Fr.ofArrayWithTail)([Oa(o),Xm(yn(o)),va(o)],a);continue e}else return r}else{e=a;continue e}break}}function Loe(e){return new Xoe(Zoe((0,Fr.singleton)(e)),!1)}function zwe(){throw new Error("Enumeration not started")}function Ywe(){throw new Error("Enumeration already started")}function Boe(e){if(e.started){var r=e.stack;if((0,Fr.isEmpty)(r))return Ywe();if((0,Fr.head)(r)!=null){var n=(0,Fr.head)(r);return yn(n)}else throw new Error("Please report error: Set iterator, unexpected stack for current")}else return zwe()}function Jwe(e){if(e.started){var r=e.stack;if((0,Fr.isEmpty)(r))return!1;if((0,Fr.head)(r)!=null){var n=(0,Fr.head)(r);if(n instanceof Aa)throw new Error("Please report error: Set iterator, unexpected stack for moveNext");return e.stack=Zoe((0,Fr.tail)(r)),!(0,Fr.isEmpty)(e.stack)}else throw new Error("Please report error: Set iterator, unexpected stack for moveNext")}else return e.started=!0,!(0,Fr.isEmpty)(e.stack)}function qoe(e){var r,n=Loe(e);return r={},(0,Xx.default)(r,"System.Collections.Generic.IEnumerator`1.get_Current",function(){return Boe(n)}),(0,Xx.default)(r,"System.Collections.IEnumerator.get_Current",function(){return Boe(n)}),(0,Xx.default)(r,"System.Collections.IEnumerator.MoveNext",function(){return Jwe(n)}),(0,Xx.default)(r,"System.Collections.IEnumerator.Reset",function(){n=Loe(e)}),(0,Xx.default)(r,"Dispose",function(){}),r}function Xwe(e,r,n){e:for(;;){var a=e,o=r,u=n,t=[o,u];if((0,Fr.isEmpty)(t[0]))return(0,Fr.isEmpty)(t[1])?0:-1;if((0,Fr.isEmpty)(t[1]))return 1;if((0,Fr.head)(t[1])!=null)if((0,Fr.head)(t[0])!=null){var d=(0,Fr.head)(t[0]),s=(0,Fr.head)(t[1]);if(d instanceof Aa)if(Oa(d)==null)if(s instanceof Aa)if(Oa(s)==null){var c=a.Compare(yn(d),yn(s))|0;if(c!==0)return c|0;e=a,r=(0,Fr.cons)(va(d),(0,Fr.tail)(t[0])),n=(0,Fr.cons)(va(s),(0,Fr.tail)(t[1]));continue e}else{var l=[o,u],f=void 0,p=void 0,m=void 0,v=void 0,h=void 0;switch((0,Fr.isEmpty)(l[0])?(0,Fr.isEmpty)(l[1])?f=2:(0,Fr.head)(l[1])!=null?(f=1,v=(0,Fr.tail)(l[1]),h=(0,Fr.head)(l[1])):f=2:(0,Fr.head)(l[0])!=null?(f=0,p=(0,Fr.tail)(l[0]),m=(0,Fr.head)(l[0])):(0,Fr.isEmpty)(l[1])?f=2:(0,Fr.head)(l[1])!=null?(f=1,v=(0,Fr.tail)(l[1]),h=(0,Fr.head)(l[1])):f=2,f){case 0:if(m instanceof Aa){e=a,r=(0,Fr.ofArrayWithTail)([Oa(m),Zm(yn(m),void 0,va(m),0)],p),n=u;continue e}else{e=a,r=(0,Fr.ofArrayWithTail)([void 0,Xm(yn(m))],p),n=u;continue e}case 1:if(h instanceof Aa){e=a,r=o,n=(0,Fr.ofArrayWithTail)([Oa(h),Zm(yn(h),void 0,va(h),0)],v);continue e}else{e=a,r=o,n=(0,Fr.ofArrayWithTail)([void 0,Xm(yn(h))],v);continue e}case 2:throw new Error("unexpected state in SetTree.compareStacks")}}else{var S=a.Compare(yn(d),yn(s))|0;if(S!==0)return S|0;e=a,r=(0,Fr.cons)(va(d),(0,Fr.tail)(t[0])),n=(0,Fr.cons)(void 0,(0,Fr.tail)(t[1]));continue e}else{var y=[o,u],C=void 0,E=void 0,I=void 0,F=void 0,w=void 0;switch((0,Fr.isEmpty)(y[0])?(0,Fr.isEmpty)(y[1])?C=2:(0,Fr.head)(y[1])!=null?(C=1,F=(0,Fr.tail)(y[1]),w=(0,Fr.head)(y[1])):C=2:(0,Fr.head)(y[0])!=null?(C=0,E=(0,Fr.tail)(y[0]),I=(0,Fr.head)(y[0])):(0,Fr.isEmpty)(y[1])?C=2:(0,Fr.head)(y[1])!=null?(C=1,F=(0,Fr.tail)(y[1]),w=(0,Fr.head)(y[1])):C=2,C){case 0:if(I instanceof Aa){e=a,r=(0,Fr.ofArrayWithTail)([Oa(I),Zm(yn(I),void 0,va(I),0)],E),n=u;continue e}else{e=a,r=(0,Fr.ofArrayWithTail)([void 0,Xm(yn(I))],E),n=u;continue e}case 1:if(w instanceof Aa){e=a,r=o,n=(0,Fr.ofArrayWithTail)([Oa(w),Zm(yn(w),void 0,va(w),0)],F);continue e}else{e=a,r=o,n=(0,Fr.ofArrayWithTail)([void 0,Xm(yn(w))],F);continue e}case 2:throw new Error("unexpected state in SetTree.compareStacks")}}else if(s instanceof Aa)if(Oa(s)==null){var B=a.Compare(yn(d),yn(s))|0;if(B!==0)return B|0;e=a,r=(0,Fr.cons)(void 0,(0,Fr.tail)(t[0])),n=(0,Fr.cons)(va(s),(0,Fr.tail)(t[1]));continue e}else{var k=[o,u],x=void 0,G=void 0,H=void 0,L=void 0,D=void 0;switch((0,Fr.isEmpty)(k[0])?(0,Fr.isEmpty)(k[1])?x=2:(0,Fr.head)(k[1])!=null?(x=1,L=(0,Fr.tail)(k[1]),D=(0,Fr.head)(k[1])):x=2:(0,Fr.head)(k[0])!=null?(x=0,G=(0,Fr.tail)(k[0]),H=(0,Fr.head)(k[0])):(0,Fr.isEmpty)(k[1])?x=2:(0,Fr.head)(k[1])!=null?(x=1,L=(0,Fr.tail)(k[1]),D=(0,Fr.head)(k[1])):x=2,x){case 0:if(H instanceof Aa){e=a,r=(0,Fr.ofArrayWithTail)([Oa(H),Zm(yn(H),void 0,va(H),0)],G),n=u;continue e}else{e=a,r=(0,Fr.ofArrayWithTail)([void 0,Xm(yn(H))],G),n=u;continue e}case 1:if(D instanceof Aa){e=a,r=o,n=(0,Fr.ofArrayWithTail)([Oa(D),Zm(yn(D),void 0,va(D),0)],L);continue e}else{e=a,r=o,n=(0,Fr.ofArrayWithTail)([void 0,Xm(yn(D))],L);continue e}case 2:throw new Error("unexpected state in SetTree.compareStacks")}}else{var U=a.Compare(yn(d),yn(s))|0;if(U!==0)return U|0;e=a,r=(0,Fr.tail)(t[0]),n=(0,Fr.tail)(t[1]);continue e}}else{var V=(0,Fr.head)(t[1]),ne=[o,u],J=void 0,$=void 0,Z=void 0,ie=void 0,X=void 0;switch((0,Fr.isEmpty)(ne[0])?(0,Fr.isEmpty)(ne[1])?J=2:(0,Fr.head)(ne[1])!=null?(J=1,ie=(0,Fr.tail)(ne[1]),X=(0,Fr.head)(ne[1])):J=2:(0,Fr.head)(ne[0])!=null?(J=0,$=(0,Fr.tail)(ne[0]),Z=(0,Fr.head)(ne[0])):(0,Fr.isEmpty)(ne[1])?J=2:(0,Fr.head)(ne[1])!=null?(J=1,ie=(0,Fr.tail)(ne[1]),X=(0,Fr.head)(ne[1])):J=2,J){case 0:if(Z instanceof Aa){e=a,r=(0,Fr.ofArrayWithTail)([Oa(Z),Zm(yn(Z),void 0,va(Z),0)],$),n=u;continue e}else{e=a,r=(0,Fr.ofArrayWithTail)([void 0,Xm(yn(Z))],$),n=u;continue e}case 1:if(X instanceof Aa){e=a,r=o,n=(0,Fr.ofArrayWithTail)([Oa(X),Zm(yn(X),void 0,va(X),0)],ie);continue e}else{e=a,r=o,n=(0,Fr.ofArrayWithTail)([void 0,Xm(yn(X))],ie);continue e}case 2:throw new Error("unexpected state in SetTree.compareStacks")}}else if((0,Fr.head)(t[0])!=null){var Q=(0,Fr.head)(t[0]),b=[o,u],R=void 0,P=void 0,A=void 0,T=void 0,g=void 0;switch((0,Fr.isEmpty)(b[0])?(0,Fr.isEmpty)(b[1])?R=2:(0,Fr.head)(b[1])!=null?(R=1,T=(0,Fr.tail)(b[1]),g=(0,Fr.head)(b[1])):R=2:(0,Fr.head)(b[0])!=null?(R=0,P=(0,Fr.tail)(b[0]),A=(0,Fr.head)(b[0])):(0,Fr.isEmpty)(b[1])?R=2:(0,Fr.head)(b[1])!=null?(R=1,T=(0,Fr.tail)(b[1]),g=(0,Fr.head)(b[1])):R=2,R){case 0:if(A instanceof Aa){e=a,r=(0,Fr.ofArrayWithTail)([Oa(A),Zm(yn(A),void 0,va(A),0)],P),n=u;continue e}else{e=a,r=(0,Fr.ofArrayWithTail)([void 0,Xm(yn(A))],P),n=u;continue e}case 1:if(g instanceof Aa){e=a,r=o,n=(0,Fr.ofArrayWithTail)([Oa(g),Zm(yn(g),void 0,va(g),0)],T);continue e}else{e=a,r=o,n=(0,Fr.ofArrayWithTail)([void 0,Xm(yn(g))],T);continue e}case 2:throw new Error("unexpected state in SetTree.compareStacks")}}else{e=a,r=(0,Fr.tail)(t[0]),n=(0,Fr.tail)(t[1]);continue e}break}}function e4(e,r,n){return r==null?n==null?0:-1:n==null?1:Xwe(e,(0,Fr.singleton)(r),(0,Fr.singleton)(n))|0}function Zwe(e){return Joe(e)}function $we(e){var r=function n(a,o){e:for(;;){var u=a,t=o;if(u!=null){var d=u;if(d instanceof Aa){a=Oa(d),o=(0,Fr.cons)(yn(d),n(va(d),t));continue e}else return(0,Fr.cons)(yn(d),t)}else return t;break}};return r(e,(0,Fr.empty)())}function $oe(e,r,n){var a=n;ZV(function(o){r[a]=o,a=a+1|0},e)}function eDe(e){var r=Koe(e)|0,n=(0,xwe.fill)(new Array(r),0,r,null);return $oe(e,n,0),n}function rDe(e,r,n){e:for(;;){var a=e,o=r,u=n;if(u["System.Collections.IEnumerator.MoveNext"]()){e=a,r=Tc(a,u["System.Collections.Generic.IEnumerator`1.get_Current"](),o),n=u;continue e}else return o;break}}function eue(e,r){return(0,xwe.fold)(function(n,a){return Tc(e,a,n)},void 0,r)}function nDe(e,r){return(0,Fr.fold)(function(n,a){return Tc(e,a,n)},void 0,r)}function rue(e,r){if((0,SN.isArrayLike)(r))return eue(e,r);if(r instanceof Fr.FSharpList)return nDe(e,r);var n=(0,SN.getEnumerator)(r);try{return rDe(e,void 0,n)}finally{(0,SN.disposeSafe)(n)}}var nue=function(e,r){function n(a,o){(0,JV.default)(this,n),this.comparer=a,this.tree=o}return(0,YV.default)(n,[{key:"GetHashCode",value:function(){var o=this;return hDe(o)|0}},{key:"Equals",value:function(o){var u=this;return o instanceof n&&e4(wu(u),Vt(u),Vt(o))===0}},{key:"toString",value:function(){var o=this;return"set ["+(0,M$r.join)("; ",(0,yp.map)(function(u){var t=u;return(0,Dwe.toString)(t)},o))+"]"}},{key:e,get:function(){return"FSharpSet"}},{key:"toJSON",value:function(o){var u=this;return Array.from(u)}},{key:"CompareTo",value:function(o){var u=this;return e4(wu(u),Vt(u),Vt(o))|0}},{key:"System.Collections.Generic.ICollection`1.Add2B595",value:function(o){throw new Error("ReadOnlyCollection")}},{key:"System.Collections.Generic.ICollection`1.Clear",value:function(){throw new Error("ReadOnlyCollection")}},{key:"System.Collections.Generic.ICollection`1.Remove2B595",value:function(o){throw new Error("ReadOnlyCollection")}},{key:"System.Collections.Generic.ICollection`1.Contains2B595",value:function(o){var u=this;return tb(wu(u),o,Vt(u))}},{key:"System.Collections.Generic.ICollection`1.CopyToZ2E171D71",value:function(o,u){var t=this;$oe(Vt(t),o,u)}},{key:"System.Collections.Generic.ICollection`1.get_IsReadOnly",value:function(){return!0}},{key:"System.Collections.Generic.ICollection`1.get_Count",value:function(){var o=this;return Zx(o)|0}},{key:"System.Collections.Generic.IReadOnlyCollection`1.get_Count",value:function(){var o=this;return Zx(o)|0}},{key:"GetEnumerator",value:function(){var o=this;return qoe(Vt(o))}},{key:r,value:function(){return(0,SN.toIterator)(this.GetEnumerator())}},{key:"System.Collections.IEnumerable.GetEnumerator",value:function(){var o=this;return qoe(Vt(o))}},{key:"size",get:function(){var o=this;return Zx(o)|0}},{key:"add",value:function(o){var u=this;throw new Error("Set cannot be mutated")}},{key:"clear",value:function(){throw new Error("Set cannot be mutated")}},{key:"delete",value:function(o){throw new Error("Set cannot be mutated")}},{key:"has",value:function(o){var u=this;return aue(u,o)}},{key:"keys",value:function(){var o=this;return(0,yp.map)(function(u){return u},o)}},{key:"values",value:function(){var o=this;return(0,yp.map)(function(u){return u},o)}},{key:"entries",value:function(){var o=this;return(0,yp.map)(function(u){return[u,u]},o)}},{key:"forEach",value:function(o,u){var t=this;(0,yp.iterate)(function(d){o(d,d,t)},t)}}]),n}(Symbol.toStringTag,Symbol.iterator);mr.FSharpSet=nue;function B$r(e){return(0,hN.class_type)("Set.FSharpSet",[e],nue)}function $m(e,r){return new nue(e,r)}function wu(e){return e.comparer}function Vt(e){return e.tree}function rW(e){return $m(e,void 0)}function tue(e,r){return $m(wu(e),Tc(wu(e),r,Vt(e)))}function tDe(e,r){return $m(wu(e),YF(wu(e),r,Vt(e)))}function Zx(e){return Koe(Vt(e))}function aue(e,r){return tb(wu(e),r,Vt(e))}function aDe(e,r){ZV(r,Vt(e))}function q$r(e,r,n){var a=r;return $V(function(o,u){return a(u,o)},n,Vt(e))}function iDe(e){return Vt(e)==null}function oDe(e,r){if(Vt(e)==null)return[e,e];var n=Kwe(wu(e),r,Vt(e));return[$m(wu(e),n[0]),$m(wu(e),n[1])]}function uDe(e,r){return Vt(e)==null?e:$m(wu(e),qwe(wu(e),r,Vt(e)))}function sDe(e,r,n){return $m(n,$V(function(a,o){return Tc(n,r(o),a)},void 0,Vt(e)))}function lDe(e,r){return eW(r,Vt(e))}function cDe(e,r){return r4(r,Vt(e))}function dDe(e,r){return Vt(e)==null||Vt(r)==null?e:$m(wu(e),Uwe(wu(e),Vt(e),Vt(r)))}function iue(e,r){return Vt(r)==null?e:Vt(e)==null?r:$m(wu(e),zF(wu(e),Vt(e),Vt(r)))}function oue(e,r){return Vt(r)==null?r:Vt(e)==null?e:$m(wu(e),Gwe(wu(e),Vt(e),Vt(r)))}function fDe(e){return(0,yp.reduce)(oue,e)}function U$r(e,r){return e4(wu(e),Vt(e),Vt(r))===0}function G$r(e,r){return e4(wu(e),Vt(e),Vt(r))}function K$r(e){return Zwe(Vt(e))}function pDe(e){return Joe(Vt(e))}function mDe(e){return Qwe(Vt(e))}function V$r(e,r){return n4(wu(e),Vt(e),Vt(r))}function W$r(e,r){return n4(wu(e),Vt(r),Vt(e))}function j$r(e,r){return t4(wu(e),Vt(e),Vt(r))}function H$r(e,r){return t4(wu(e),Vt(r),Vt(e))}function gDe(e){return $we(Vt(e))}function vDe(e){return eDe(Vt(e))}function hDe(e){var r,n=0,a=(0,SN.getEnumerator)(e);try{for(;a["System.Collections.IEnumerator.MoveNext"]();){var o=a["System.Collections.Generic.IEnumerator`1.get_Current"]();n=(r=(0,SN.structuralHash)(o)|0,(n<<1)+r+631|0)}}finally{(0,SN.disposeSafe)(a)}return Math.abs(n)|0}function Q$r(e){return iDe(e)}function z$r(e,r){return aue(r,e)}function Y$r(e,r){return tue(r,e)}function J$r(e,r){return tue(rW(r),e)}function X$r(e,r){return tDe(r,e)}function Z$r(e,r){return iue(e,r)}function $$r(e,r){return(0,yp.fold)(iue,rW(r),e)}function een(e,r){return oue(e,r)}function ren(e){return fDe(e)}function nen(e,r){aDe(r,e)}function ten(e){return rW(e)}function aen(e,r){return cDe(r,e)}function ien(e,r){return lDe(r,e)}function oen(e,r){return uDe(r,e)}function uen(e,r){return oDe(r,e)}function sen(e,r,n){return $V(e,r,Vt(n))}function len(e,r,n){return Bwe(e,Vt(r),n)}function cen(e,r,n){return sDe(r,e,n)}function den(e){return Zx(e)}function fen(e,r){return $m(r,rue(r,e))}function pen(e,r){return $m(r,eue(r,e))}function men(e){return gDe(e)}function gen(e){return vDe(e)}function ven(e){return(0,yp.map)(function(r){return r},e)}function hen(e,r){return $m(r,rue(r,e))}function Sen(e,r){return dDe(e,r)}function yen(e,r){return n4(wu(e),Vt(e),Vt(r))}function Cen(e,r){return n4(wu(e),Vt(r),Vt(e))}function _en(e,r){return t4(wu(e),Vt(e),Vt(r))}function Ren(e,r){return t4(wu(e),Vt(r),Vt(e))}function Ten(e){return pDe(e)}function ben(e){return mDe(e)}function Pen(e,r){return(0,yp.fold)(function(n,a){return n.add(a)},e,r)}function nW(e,r){return e instanceof Doe.HashSet?(0,Doe.HashSet_$ctor_Z6150332D)(r,(0,Doe.HashSet__get_Comparer)(e)):new Set(r)}function Een(e,r){var n=nW(e,r);(0,yp.iterate)(function(a){n.has(a)||e.delete(a)},e.values())}function Nen(e,r){(0,yp.iterate)(function(n){e.delete(n)},r)}function Aen(e,r){var n=nW(e,r);return(0,yp.forAll)(function(a){return n.has(a)},e.values())}function Oen(e,r){return(0,yp.forAll)(function(n){return e.has(n)},r)}function ken(e,r){var n=nW(e,r);return n.size>e.size?(0,yp.forAll)(function(a){return n.has(a)},e.values()):!1}function Fen(e,r){var n=(0,yp.cache)(r);return(0,yp.exists)(function(a){return!e.has(a)},n)?(0,yp.forAll)(function(a){return e.has(a)},n):!1}});var pue=Y(H0=>{_();var SDe=An();Object.defineProperty(H0,"__esModule",{value:!0});H0.Dictionary=void 0;H0.Dictionary$reflection=xen;H0.Dictionary_$ctor_6623D9B3=Len;H0.Dictionary__Add_5BDDA1=tW;H0.Dictionary__Clear=uue;H0.Dictionary__ContainsKey_2B595=due;H0.Dictionary__Remove_2B595=aW;H0.Dictionary__TryFind_2B595=i4;H0.Dictionary__get_Comparer=Ben;H0.Dictionary__get_Count=sue;H0.Dictionary__get_Item_2B595=lue;H0.Dictionary__set_Item_5BDDA1=cue;var Ien=SDe(at()),Men=SDe(it()),F_=Cc(),Rh=Dy(),yDe=Uc(),wen=c0(),XF=Oy(),Den=N_(),fue=function(e,r){function n(a,o){(0,Ien.default)(this,n);var u=new yDe.FSharpRef(null);this.comparer=o,u.contents=this,this.hashMap=new Map([]),this["init@8-1"]=1;var t=(0,F_.getEnumerator)(a);try{for(;t["System.Collections.IEnumerator.MoveNext"]();){var d=t["System.Collections.Generic.IEnumerator`1.get_Current"]();tW(u.contents,d[0],d[1])}}finally{(0,F_.disposeSafe)(t)}}return(0,Men.default)(n,[{key:e,get:function(){return"Dictionary"}},{key:"toJSON",value:function(o){var u=this;return Array.from(u)}},{key:"System.Collections.IEnumerable.GetEnumerator",value:function(){var o=this;return(0,F_.getEnumerator)(o)}},{key:"GetEnumerator",value:function(){var o=this;return(0,F_.getEnumerator)((0,Rh.concat)(o.hashMap.values()))}},{key:r,value:function(){return(0,F_.toIterator)(this.GetEnumerator())}},{key:"System.Collections.Generic.ICollection`1.Add2B595",value:function(o){var u=this;tW(u,o[0],o[1])}},{key:"System.Collections.Generic.ICollection`1.Clear",value:function(){var o=this;uue(o)}},{key:"System.Collections.Generic.ICollection`1.Contains2B595",value:function(o){var u=this,t=i4(u,o[0]),d;switch(t!=null&&(0,F_.equals)(t[1],o[1])?d=0:d=1,d){case 0:return!0;case 1:return!1}}},{key:"System.Collections.Generic.ICollection`1.CopyToZ2E171D71",value:function(o,u){var t=this;(0,Rh.iterateIndexed)(function(d,s){o[u+d]=s},t)}},{key:"System.Collections.Generic.ICollection`1.get_Count",value:function(){var o=this;return sue(o)|0}},{key:"System.Collections.Generic.ICollection`1.get_IsReadOnly",value:function(){return!1}},{key:"System.Collections.Generic.ICollection`1.Remove2B595",value:function(o){var u=this,t=i4(u,o[0]);return t!=null?((0,F_.equals)(t[1],o[1])&&aW(u,o[0]),!0):!1}},{key:"System.Collections.Generic.IDictionary`2.Add5BDDA1",value:function(o,u){var t=this;tW(t,o,u)}},{key:"System.Collections.Generic.IDictionary`2.ContainsKey2B595",value:function(o){var u=this;return due(u,o)}},{key:"System.Collections.Generic.IDictionary`2.get_Item2B595",value:function(o){var u=this;return lue(u,o)}},{key:"System.Collections.Generic.IDictionary`2.set_Item5BDDA1",value:function(o,u){var t=this;cue(t,o,u)}},{key:"System.Collections.Generic.IDictionary`2.get_Keys",value:function(){var o=this;return(0,Rh.toArray)((0,Rh.delay)(function(){return(0,Rh.map)(function(u){return u[0]},o)}))}},{key:"System.Collections.Generic.IDictionary`2.Remove2B595",value:function(o){var u=this;return aW(u,o)}},{key:"System.Collections.Generic.IDictionary`2.TryGetValue23A0B95A",value:function(o,u){var t=this,d=i4(t,o);if(d!=null){var s=d;return u.contents=s[1],!0}else return!1}},{key:"System.Collections.Generic.IDictionary`2.get_Values",value:function(){var o=this;return(0,Rh.toArray)((0,Rh.delay)(function(){return(0,Rh.map)(function(u){return u[1]},o)}))}},{key:"size",get:function(){var o=this;return sue(o)|0}},{key:"clear",value:function(){var o=this;uue(o)}},{key:"delete",value:function(o){var u=this;return aW(u,o)}},{key:"entries",value:function(){var o=this;return(0,Rh.map)(function(u){return[u[0],u[1]]},o)}},{key:"get",value:function(o){var u=this;return lue(u,o)}},{key:"has",value:function(o){var u=this;return due(u,o)}},{key:"keys",value:function(){var o=this;return(0,Rh.map)(function(u){return u[0]},o)}},{key:"set",value:function(o,u){var t=this;return cue(t,o,u),t}},{key:"values",value:function(){var o=this;return(0,Rh.map)(function(u){return u[1]},o)}},{key:"forEach",value:function(o,u){var t=this;(0,Rh.iterate)(function(d){o(d[1],d[0],t)},t)}}]),n}(Symbol.toStringTag,Symbol.iterator);H0.Dictionary=fue;function xen(e,r){return(0,wen.class_type)("Fable.Collections.Dictionary",[e,r],fue)}function Len(e,r){return new fue(e,r)}function o4(e,r){var n=e.comparer.GetHashCode(r)|0,a,o=null;return a=[(0,XF.tryGetValue)(e.hashMap,n,new yDe.FSharpRef(function(){return o},function(u){o=u})),o],a[0]?[!0,n,a[1].findIndex(function(u){return e.comparer.Equals(r,u[0])})]:[!1,n,-1]}function i4(e,r){var n=o4(e,r),a;switch(n[0]&&n[2]>-1?a=0:a=1,a){case 0:return(0,XF.getItemFromDict)(e.hashMap,n[1])[n[2]];case 1:return}}function Ben(e){return e.comparer}function uue(e){e.hashMap.clear()}function sue(e){var r=0,n=(0,F_.getEnumerator)(e.hashMap.values());try{for(;n["System.Collections.IEnumerator.MoveNext"]();){var a=n["System.Collections.Generic.IEnumerator`1.get_Current"]();r=r+a.length|0}}finally{(0,F_.disposeSafe)(n)}return r|0}function lue(e,r){var n=i4(e,r);if(n!=null)return n[1];throw new Error("The item was not found in collection")}function cue(e,r,n){var a=o4(e,r),o;switch(a[0]&&a[2]>-1?o=0:o=1,o){case 0:{(0,XF.getItemFromDict)(e.hashMap,a[1])[a[2]]=[r,n];break}case 1:{if(a[0])var u=void(0,XF.getItemFromDict)(e.hashMap,a[1]).push([r,n]);else e.hashMap.set(a[1],[[r,n]]);break}}}function tW(e,r,n){var a=o4(e,r),o;switch(a[0]&&a[2]>-1?o=0:o=1,o){case 0:{var u=(0,Den.format)("An item with the same key has already been added. Key: {0}",r);throw new Error(u)}case 1:{if(a[0])var t=void(0,XF.getItemFromDict)(e.hashMap,a[1]).push([r,n]);else e.hashMap.set(a[1],[[r,n]]);break}}}function due(e,r){var n=o4(e,r),a;switch(n[0]&&n[2]>-1?a=0:a=1,a){case 0:return!0;case 1:return!1}}function aW(e,r){var n=o4(e,r),a;switch(n[0]&&n[2]>-1?a=0:a=1,a){case 0:return(0,XF.getItemFromDict)(e.hashMap,n[1]).splice(n[2],1),!0;case 1:return!1}}});var RDe=Y(ZF=>{_();var u4=An();Object.defineProperty(ZF,"__esModule",{value:!0});ZF.ParserConfig=void 0;ZF.ParserConfig$reflection=Qen;ZF.ParserConfig__GetSymbolName_Z524259A4=zen;var qen=u4(it()),Uen=u4(at()),Gen=u4(Qf()),Ken=u4(zf()),CDe=u4(Ed()),Ven=Uc(),Qi=c0(),Wen=Oy();function jen(e){var r=Hen();return function(){var a=(0,CDe.default)(e),o;if(r){var u=(0,CDe.default)(this).constructor;o=Reflect.construct(a,arguments,u)}else o=a.apply(this,arguments);return(0,Ken.default)(this,o)}}function Hen(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var _De=function(e){(0,Gen.default)(n,e);var r=jen(n);function n(a,o,u,t,d,s,c,l,f,p,m,v,h,S){var y;return(0,Uen.default)(this,n),y=r.call(this),y.Rules=a,y.Terminals=o,y.DeletableTerminals=u,y.InsertableTerminals=t,y.TerminalWeights=d,y.TerminalDefaultValues=s,y.ReliableTerminals=c,y.Start=l|0,y.End=f|0,y.NumLaTable=p,y.LLTable=m,y.LLRepairTable=v,y.SymbolNames=h,y.RuleStrings=S,y}return(0,qen.default)(n)}(Ven.Record);ZF.ParserConfig=_De;function Qen(){return(0,Qi.record_type)("Microsoft.ProgramSynthesis.Repair.Framework.ParserConfig.ParserConfig",[],_De,function(){return[["Rules",(0,Qi.array_type)((0,Qi.list_type)(Qi.int32_type))],["Terminals",(0,Qi.class_type)("Microsoft.FSharp.Collections.FSharpSet`1",[Qi.int32_type])],["DeletableTerminals",(0,Qi.class_type)("Microsoft.FSharp.Collections.FSharpSet`1",[Qi.int32_type])],["InsertableTerminals",(0,Qi.class_type)("Microsoft.FSharp.Collections.FSharpSet`1",[Qi.int32_type])],["TerminalWeights",(0,Qi.class_type)("System.Collections.Generic.IDictionary`2",[Qi.int32_type,Qi.float64_type])],["TerminalDefaultValues",(0,Qi.class_type)("System.Collections.Generic.IDictionary`2",[Qi.int32_type,Qi.string_type])],["ReliableTerminals",(0,Qi.class_type)("Microsoft.FSharp.Collections.FSharpSet`1",[Qi.int32_type])],["Start",Qi.int32_type],["End",Qi.int32_type],["NumLaTable",(0,Qi.class_type)("System.Collections.Generic.IDictionary`2",[Qi.int32_type,Qi.int32_type])],["LLTable",(0,Qi.class_type)("System.Collections.Generic.IDictionary`2",[(0,Qi.tuple_type)(Qi.int32_type,(0,Qi.list_type)(Qi.int32_type)),Qi.int32_type])],["LLRepairTable",(0,Qi.class_type)("System.Collections.Generic.IDictionary`2",[(0,Qi.tuple_type)(Qi.int32_type,Qi.int32_type),(0,Qi.list_type)(Qi.int32_type)])],["SymbolNames",(0,Qi.class_type)("System.Collections.Generic.IDictionary`2",[Qi.int32_type,Qi.string_type])],["RuleStrings",(0,Qi.array_type)(Qi.string_type)]]})}function zen(e,r){return(0,Wen.getItemFromDict)(e.SymbolNames,r)}});var mue=Y(zi=>{_();Object.defineProperty(zi,"__esModule",{value:!0});zi.terminals=zi.terminalWeights=zi.terminalDefaultValues=zi.symbolNames=zi.rules=zi.ruleStrings=zi.reliableTerminals=zi.numLaTable=zi.llTable=zi.llRepairTable=zi.insertableTerminals=zi.deletableTerminals=zi.config=zi.TAG_not_builtin_fnc=zi.TAG_maybe_fnc_name=zi.TAG_maybe_fnc_dot_ident=zi.TAG_intersection_op=zi.TAG_fnc_open_paren=zi.TAG_fnc_closing_paren=void 0;var iW=a4(),ab=Cc(),j=O_(),$F=HF(),TDe=pue(),Yen=RDe(),bDe=(0,iW.ofSeq)([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33],{Compare:ab.comparePrimitives});zi.terminals=bDe;var PDe=(0,iW.ofSeq)([5,11,12,9,10,3,2,1,7,4,13,6,8],{Compare:ab.comparePrimitives});zi.deletableTerminals=PDe;var EDe=(0,iW.ofSeq)([5,9,10,3,2,1,7,4,13],{Compare:ab.comparePrimitives});zi.insertableTerminals=EDe;var NDe=new Map([[1,1],[2,1],[3,1],[4,1],[5,1],[6,1],[7,.5],[8,1],[9,1],[10,1],[11,1],[12,1],[13,1]]);zi.terminalWeights=NDe;var ADe=new Map([[1,null],[2,null],[3,null],[4,":"],[5,null],[6," "],[7,null],[8,null],[9,null],[10,null],[11,null],[12,null],[13,null]]);zi.terminalDefaultValues=ADe;var ODe=(0,iW.ofSeq)([0,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33],{Compare:ab.comparePrimitives});zi.reliableTerminals=ODe;var kDe=new Map([[0,"T_EOF"],[1,"T_ParenOpen"],[2,"T_ParenClose"],[3,"T_Comma"],[4,"T_RangeOp"],[5,"T_Bang"],[6,"T_Spaces"],[7,"T_Quote"],[8,"T_Unexpected"],[9,"T_BracketClose"],[10,"T_BracketOpen"],[11,"T_BraceClose"],[12,"T_BraceOpen"],[13,"T_SingleQuote"],[14,"T_Percent"],[15,"T_Add"],[16,"T_Sub"],[17,"T_Mul"],[18,"T_Div"],[19,"T_Pow"],[20,"T_Concat"],[21,"T_Eq"],[22,"T_Ne"],[23,"T_Lt"],[24,"T_Le"],[25,"T_Gt"],[26,"T_Ge"],[27,"T_BooleanLiteral"],[28,"T_StringLiteral"],[29,"T_NumberLiteral"],[30,"T_CellRef"],[31,"T_Ident"],[32,"T_Dot"],[33,"T_FAIL"],[34,"NT_AreaReference"],[35,"NT_AreaReferenceTail"],[36,"NT_AreaReferenceTop"],[37,"NT_Arg"],[38,"NT_ArgsList"],[39,"NT_ArgsListTail"],[40,"NT_BangAreaRefOrAreaReferenceTail"],[41,"NT_CellRefOrRange"],[42,"NT_ForceFail"],[43,"NT_Formula"],[44,"NT_FormulaTail"],[45,"NT_FuncIdentDotStar"],[46,"NT_FuncIdentDotStarTail"],[47,"NT_IdentNotBuiltin"],[48,"NT_IdentOrRefPrefixOrColumnRangeOrFunctionCall"],[49,"NT_InfixOp"],[50,"NT_OptionalPct"],[51,"NT_OptionalUnOp"],[52,"NT_ParenTail"],[53,"NT_QualifiedCellRef"],[54,"NT_Range"],[55,"NT_ReferencePrefix"],[56,"NT_ReferencePrefixTail"],[57,"NT_RelOp"],[58,"NT_SpFormula"],[59,"NT_SpacesOpt"],[60,"NT_StringLiteralOrStringPredicate"],[61,"NT_Term"],[62,"NT_TermBase"],[63,"NT_Top"],[64,"NT_UnaryNegTail"]]);zi.symbolNames=kDe;var FDe=[(0,j.ofArray)([58,21]),(0,j.singleton)(58),(0,j.ofArray)([43,51,59]),(0,j.singleton)(6),(0,j.empty)(),(0,j.ofArray)([44,59,61]),(0,j.ofArray)([44,59,2,52,58,1]),(0,j.empty)(),(0,j.ofArray)([52,58,3]),(0,j.empty)(),(0,j.ofArray)([58,49]),(0,j.singleton)(15),(0,j.singleton)(16),(0,j.singleton)(17),(0,j.singleton)(18),(0,j.singleton)(19),(0,j.singleton)(20),(0,j.singleton)(21),(0,j.singleton)(22),(0,j.singleton)(23),(0,j.singleton)(24),(0,j.singleton)(25),(0,j.singleton)(26),(0,j.singleton)(62),(0,j.singleton)(27),(0,j.ofArray)([60,7]),(0,j.ofArray)([7,28]),(0,j.ofArray)([7,62,57]),(0,j.ofArray)([50,29]),(0,j.ofArray)([41,53]),(0,j.ofArray)([48,31]),(0,j.ofArray)([30,5,13,28,13]),(0,j.singleton)(30),(0,j.empty)(),(0,j.singleton)(14),(0,j.empty)(),(0,j.ofArray)([35,53,4]),(0,j.ofArray)([2,38,1,45]),(0,j.ofArray)([40,47,4]),(0,j.ofArray)([56,5]),(0,j.ofArray)([9,47,10]),(0,j.empty)(),(0,j.ofArray)([41,53]),(0,j.singleton)(29),(0,j.ofArray)([36,5]),(0,j.singleton)(35),(0,j.ofArray)([5,47]),(0,j.empty)(),(0,j.ofArray)([34,55]),(0,j.ofArray)([35,54]),(0,j.empty)(),(0,j.ofArray)([36,6]),(0,j.ofArray)([53,4,53]),(0,j.empty)(),(0,j.ofArray)([46,32]),(0,j.ofArray)([45,31]),(0,j.ofArray)([45,29]),(0,j.empty)(),(0,j.ofArray)([39,37]),(0,j.empty)(),(0,j.ofArray)([39,37,3]),(0,j.singleton)(58),(0,j.singleton)(31),(0,j.singleton)(21),(0,j.singleton)(22),(0,j.singleton)(23),(0,j.singleton)(25),(0,j.singleton)(24),(0,j.singleton)(26),(0,j.empty)(),(0,j.ofArray)([64,16]),(0,j.singleton)(15),(0,j.empty)(),(0,j.singleton)(16),(0,j.singleton)(33)];zi.rules=FDe;var Jen=new $F.SymbolSource(30,1);zi.TAG_maybe_fnc_name=Jen;var Xen=new $F.SymbolSource(37,0);zi.TAG_fnc_closing_paren=Xen;var Zen=new $F.SymbolSource(37,2);zi.TAG_fnc_open_paren=Zen;var $en=new $F.SymbolSource(51,1);zi.TAG_intersection_op=$en;var ern=new $F.SymbolSource(55,1);zi.TAG_maybe_fnc_dot_ident=ern;var rrn=new $F.SymbolSource(62,0);zi.TAG_not_builtin_fnc=rrn;var IDe=["Top -> Eq SpFormula","Top -> SpFormula","SpFormula -> SpacesOpt OptionalUnOp Formula","SpacesOpt -> Spaces","SpacesOpt -> ","Formula -> Term SpacesOpt FormulaTail","Formula -> ParenOpen SpFormula ParenTail ParenClose SpacesOpt FormulaTail","ParenTail -> ","ParenTail -> Comma SpFormula ParenTail","FormulaTail -> ","FormulaTail -> InfixOp SpFormula","InfixOp -> Add","InfixOp -> Sub","InfixOp -> Mul","InfixOp -> Div","InfixOp -> Pow","InfixOp -> Concat","InfixOp -> Eq","InfixOp -> Ne","InfixOp -> Lt","InfixOp -> Le","InfixOp -> Gt","InfixOp -> Ge","Term -> TermBase","TermBase -> BooleanLiteral","TermBase -> Quote StringLiteralOrStringPredicate","StringLiteralOrStringPredicate -> StringLiteral Quote","StringLiteralOrStringPredicate -> RelOp TermBase Quote","TermBase -> NumberLiteral OptionalPct","TermBase -> QualifiedCellRef CellRefOrRange","TermBase -> Ident IdentOrRefPrefixOrColumnRangeOrFunctionCall","QualifiedCellRef -> SingleQuote StringLiteral SingleQuote Bang CellRef","QualifiedCellRef -> CellRef","OptionalPct -> ","OptionalPct -> Percent","CellRefOrRange -> ","CellRefOrRange -> RangeOp QualifiedCellRef AreaReferenceTail","IdentOrRefPrefixOrColumnRangeOrFunctionCall -> FuncIdentDotStar ParenOpen ArgsList ParenClose","IdentOrRefPrefixOrColumnRangeOrFunctionCall -> RangeOp IdentNotBuiltin BangAreaRefOrAreaReferenceTail","IdentOrRefPrefixOrColumnRangeOrFunctionCall -> Bang ReferencePrefixTail","IdentOrRefPrefixOrColumnRangeOrFunctionCall -> BracketOpen IdentNotBuiltin BracketClose","IdentOrRefPrefixOrColumnRangeOrFunctionCall -> ","ReferencePrefixTail -> QualifiedCellRef CellRefOrRange","ReferencePrefixTail -> NumberLiteral","BangAreaRefOrAreaReferenceTail -> Bang AreaReferenceTop","BangAreaRefOrAreaReferenceTail -> AreaReferenceTail","ReferencePrefix -> IdentNotBuiltin Bang","ReferencePrefix -> ","AreaReferenceTop -> ReferencePrefix AreaReference","AreaReference -> Range AreaReferenceTail","AreaReferenceTail -> ","AreaReferenceTail -> Spaces AreaReferenceTop","Range -> QualifiedCellRef RangeOp QualifiedCellRef","FuncIdentDotStar -> ","FuncIdentDotStar -> Dot FuncIdentDotStarTail","FuncIdentDotStarTail -> Ident FuncIdentDotStar","FuncIdentDotStarTail -> NumberLiteral FuncIdentDotStar","ArgsList -> ","ArgsList -> Arg ArgsListTail","ArgsListTail -> ","ArgsListTail -> Comma Arg ArgsListTail","Arg -> SpFormula","IdentNotBuiltin -> Ident","RelOp -> Eq","RelOp -> Ne","RelOp -> Lt","RelOp -> Gt","RelOp -> Le","RelOp -> Ge","OptionalUnOp -> ","OptionalUnOp -> Sub UnaryNegTail","OptionalUnOp -> Add","UnaryNegTail -> ","UnaryNegTail -> Sub","ForceFail -> FAIL"];zi.ruleStrings=IDe;var MDe=new Map([[34,1],[35,2],[36,1],[37,1],[38,1],[39,1],[40,1],[41,1],[42,1],[43,1],[44,1],[45,1],[46,1],[47,1],[48,1],[49,1],[50,1],[51,1],[52,1],[53,1],[54,1],[55,1],[56,1],[57,1],[58,1],[59,1],[60,1],[61,1],[62,1],[63,1],[64,1]]);zi.numLaTable=MDe;var wDe=new TDe.Dictionary([[[34,(0,j.singleton)(30)],49],[[34,(0,j.singleton)(13)],49],[[35,(0,j.ofArray)([15,15])],50],[[35,(0,j.ofArray)([27,15])],50],[[35,(0,j.ofArray)([30,15])],50],[[35,(0,j.ofArray)([31,15])],50],[[35,(0,j.ofArray)([29,15])],50],[[35,(0,j.ofArray)([1,15])],50],[[35,(0,j.ofArray)([7,15])],50],[[35,(0,j.ofArray)([13,15])],50],[[35,(0,j.ofArray)([6,15])],50],[[35,(0,j.ofArray)([16,15])],50],[[35,(0,j.ofArray)([15,3])],50],[[35,(0,j.ofArray)([27,3])],50],[[35,(0,j.ofArray)([30,3])],50],[[35,(0,j.ofArray)([31,3])],50],[[35,(0,j.ofArray)([29,3])],50],[[35,(0,j.ofArray)([1,3])],50],[[35,(0,j.ofArray)([7,3])],50],[[35,(0,j.ofArray)([13,3])],50],[[35,(0,j.ofArray)([6,3])],50],[[35,(0,j.ofArray)([16,3])],50],[[35,(0,j.ofArray)([15,20])],50],[[35,(0,j.ofArray)([27,20])],50],[[35,(0,j.ofArray)([30,20])],50],[[35,(0,j.ofArray)([31,20])],50],[[35,(0,j.ofArray)([29,20])],50],[[35,(0,j.ofArray)([1,20])],50],[[35,(0,j.ofArray)([7,20])],50],[[35,(0,j.ofArray)([13,20])],50],[[35,(0,j.ofArray)([6,20])],50],[[35,(0,j.ofArray)([16,20])],50],[[35,(0,j.ofArray)([15,18])],50],[[35,(0,j.ofArray)([27,18])],50],[[35,(0,j.ofArray)([30,18])],50],[[35,(0,j.ofArray)([31,18])],50],[[35,(0,j.ofArray)([29,18])],50],[[35,(0,j.ofArray)([1,18])],50],[[35,(0,j.ofArray)([7,18])],50],[[35,(0,j.ofArray)([13,18])],50],[[35,(0,j.ofArray)([6,18])],50],[[35,(0,j.ofArray)([16,18])],50],[[35,(0,j.singleton)(0)],50],[[35,(0,j.ofArray)([15,21])],50],[[35,(0,j.ofArray)([27,21])],50],[[35,(0,j.ofArray)([30,21])],50],[[35,(0,j.ofArray)([31,21])],50],[[35,(0,j.ofArray)([29,21])],50],[[35,(0,j.ofArray)([1,21])],50],[[35,(0,j.ofArray)([7,21])],50],[[35,(0,j.ofArray)([13,21])],50],[[35,(0,j.ofArray)([6,21])],50],[[35,(0,j.ofArray)([16,21])],50],[[35,(0,j.ofArray)([15,26])],50],[[35,(0,j.ofArray)([27,26])],50],[[35,(0,j.ofArray)([30,26])],50],[[35,(0,j.ofArray)([31,26])],50],[[35,(0,j.ofArray)([29,26])],50],[[35,(0,j.ofArray)([1,26])],50],[[35,(0,j.ofArray)([7,26])],50],[[35,(0,j.ofArray)([13,26])],50],[[35,(0,j.ofArray)([6,26])],50],[[35,(0,j.ofArray)([16,26])],50],[[35,(0,j.ofArray)([15,25])],50],[[35,(0,j.ofArray)([27,25])],50],[[35,(0,j.ofArray)([30,25])],50],[[35,(0,j.ofArray)([31,25])],50],[[35,(0,j.ofArray)([29,25])],50],[[35,(0,j.ofArray)([1,25])],50],[[35,(0,j.ofArray)([7,25])],50],[[35,(0,j.ofArray)([13,25])],50],[[35,(0,j.ofArray)([6,25])],50],[[35,(0,j.ofArray)([16,25])],50],[[35,(0,j.ofArray)([15,24])],50],[[35,(0,j.ofArray)([27,24])],50],[[35,(0,j.ofArray)([30,24])],50],[[35,(0,j.ofArray)([31,24])],50],[[35,(0,j.ofArray)([29,24])],50],[[35,(0,j.ofArray)([1,24])],50],[[35,(0,j.ofArray)([7,24])],50],[[35,(0,j.ofArray)([13,24])],50],[[35,(0,j.ofArray)([6,24])],50],[[35,(0,j.ofArray)([16,24])],50],[[35,(0,j.ofArray)([15,23])],50],[[35,(0,j.ofArray)([27,23])],50],[[35,(0,j.ofArray)([30,23])],50],[[35,(0,j.ofArray)([31,23])],50],[[35,(0,j.ofArray)([29,23])],50],[[35,(0,j.ofArray)([1,23])],50],[[35,(0,j.ofArray)([7,23])],50],[[35,(0,j.ofArray)([13,23])],50],[[35,(0,j.ofArray)([6,23])],50],[[35,(0,j.ofArray)([16,23])],50],[[35,(0,j.ofArray)([15,17])],50],[[35,(0,j.ofArray)([27,17])],50],[[35,(0,j.ofArray)([30,17])],50],[[35,(0,j.ofArray)([31,17])],50],[[35,(0,j.ofArray)([29,17])],50],[[35,(0,j.ofArray)([1,17])],50],[[35,(0,j.ofArray)([7,17])],50],[[35,(0,j.ofArray)([13,17])],50],[[35,(0,j.ofArray)([6,17])],50],[[35,(0,j.ofArray)([16,17])],50],[[35,(0,j.ofArray)([15,22])],50],[[35,(0,j.ofArray)([27,22])],50],[[35,(0,j.ofArray)([30,22])],50],[[35,(0,j.ofArray)([31,22])],50],[[35,(0,j.ofArray)([29,22])],50],[[35,(0,j.ofArray)([1,22])],50],[[35,(0,j.ofArray)([7,22])],50],[[35,(0,j.ofArray)([13,22])],50],[[35,(0,j.ofArray)([6,22])],50],[[35,(0,j.ofArray)([16,22])],50],[[35,(0,j.ofArray)([15,2])],50],[[35,(0,j.ofArray)([3,2])],50],[[35,(0,j.ofArray)([20,2])],50],[[35,(0,j.ofArray)([18,2])],50],[[35,(0,j.ofArray)([0,2])],50],[[35,(0,j.ofArray)([21,2])],50],[[35,(0,j.ofArray)([26,2])],50],[[35,(0,j.ofArray)([25,2])],50],[[35,(0,j.ofArray)([24,2])],50],[[35,(0,j.ofArray)([23,2])],50],[[35,(0,j.ofArray)([17,2])],50],[[35,(0,j.ofArray)([22,2])],50],[[35,(0,j.ofArray)([2,2])],50],[[35,(0,j.ofArray)([19,2])],50],[[35,(0,j.ofArray)([7,2])],50],[[35,(0,j.ofArray)([6,2])],50],[[35,(0,j.ofArray)([16,2])],50],[[35,(0,j.ofArray)([15,19])],50],[[35,(0,j.ofArray)([27,19])],50],[[35,(0,j.ofArray)([30,19])],50],[[35,(0,j.ofArray)([31,19])],50],[[35,(0,j.ofArray)([29,19])],50],[[35,(0,j.ofArray)([1,19])],50],[[35,(0,j.ofArray)([7,19])],50],[[35,(0,j.ofArray)([13,19])],50],[[35,(0,j.ofArray)([6,19])],50],[[35,(0,j.ofArray)([16,19])],50],[[35,(0,j.ofArray)([15,7])],50],[[35,(0,j.ofArray)([3,7])],50],[[35,(0,j.ofArray)([20,7])],50],[[35,(0,j.ofArray)([18,7])],50],[[35,(0,j.ofArray)([0,7])],50],[[35,(0,j.ofArray)([21,7])],50],[[35,(0,j.ofArray)([26,7])],50],[[35,(0,j.ofArray)([25,7])],50],[[35,(0,j.ofArray)([24,7])],50],[[35,(0,j.ofArray)([23,7])],50],[[35,(0,j.ofArray)([17,7])],50],[[35,(0,j.ofArray)([22,7])],50],[[35,(0,j.ofArray)([2,7])],50],[[35,(0,j.ofArray)([19,7])],50],[[35,(0,j.ofArray)([7,7])],50],[[35,(0,j.ofArray)([6,7])],50],[[35,(0,j.ofArray)([16,7])],50],[[35,(0,j.ofArray)([15,6])],50],[[35,(0,j.ofArray)([3,6])],50],[[35,(0,j.ofArray)([20,6])],50],[[35,(0,j.ofArray)([18,6])],50],[[35,(0,j.ofArray)([0,6])],50],[[35,(0,j.ofArray)([21,6])],50],[[35,(0,j.ofArray)([26,6])],50],[[35,(0,j.ofArray)([25,6])],50],[[35,(0,j.ofArray)([24,6])],50],[[35,(0,j.ofArray)([23,6])],50],[[35,(0,j.ofArray)([17,6])],50],[[35,(0,j.ofArray)([22,6])],50],[[35,(0,j.ofArray)([2,6])],50],[[35,(0,j.ofArray)([19,6])],50],[[35,(0,j.ofArray)([16,6])],50],[[35,(0,j.ofArray)([15,16])],50],[[35,(0,j.ofArray)([27,16])],50],[[35,(0,j.ofArray)([30,16])],50],[[35,(0,j.ofArray)([31,16])],50],[[35,(0,j.ofArray)([29,16])],50],[[35,(0,j.ofArray)([1,16])],50],[[35,(0,j.ofArray)([7,16])],50],[[35,(0,j.ofArray)([13,16])],50],[[35,(0,j.ofArray)([6,16])],50],[[35,(0,j.ofArray)([16,16])],50],[[35,(0,j.ofArray)([30,6])],51],[[35,(0,j.ofArray)([31,6])],51],[[35,(0,j.ofArray)([13,6])],51],[[36,(0,j.singleton)(30)],48],[[36,(0,j.singleton)(31)],48],[[36,(0,j.singleton)(13)],48],[[37,(0,j.singleton)(15)],61],[[37,(0,j.singleton)(27)],61],[[37,(0,j.singleton)(30)],61],[[37,(0,j.singleton)(31)],61],[[37,(0,j.singleton)(29)],61],[[37,(0,j.singleton)(1)],61],[[37,(0,j.singleton)(7)],61],[[37,(0,j.singleton)(13)],61],[[37,(0,j.singleton)(6)],61],[[37,(0,j.singleton)(16)],61],[[38,(0,j.singleton)(2)],57],[[38,(0,j.singleton)(15)],58],[[38,(0,j.singleton)(27)],58],[[38,(0,j.singleton)(30)],58],[[38,(0,j.singleton)(31)],58],[[38,(0,j.singleton)(29)],58],[[38,(0,j.singleton)(1)],58],[[38,(0,j.singleton)(7)],58],[[38,(0,j.singleton)(13)],58],[[38,(0,j.singleton)(6)],58],[[38,(0,j.singleton)(16)],58],[[39,(0,j.singleton)(2)],59],[[39,(0,j.singleton)(3)],60],[[40,(0,j.singleton)(5)],44],[[40,(0,j.singleton)(15)],45],[[40,(0,j.singleton)(3)],45],[[40,(0,j.singleton)(20)],45],[[40,(0,j.singleton)(18)],45],[[40,(0,j.singleton)(0)],45],[[40,(0,j.singleton)(21)],45],[[40,(0,j.singleton)(26)],45],[[40,(0,j.singleton)(25)],45],[[40,(0,j.singleton)(24)],45],[[40,(0,j.singleton)(23)],45],[[40,(0,j.singleton)(17)],45],[[40,(0,j.singleton)(22)],45],[[40,(0,j.singleton)(2)],45],[[40,(0,j.singleton)(19)],45],[[40,(0,j.singleton)(7)],45],[[40,(0,j.singleton)(6)],45],[[40,(0,j.singleton)(16)],45],[[41,(0,j.singleton)(15)],35],[[41,(0,j.singleton)(3)],35],[[41,(0,j.singleton)(20)],35],[[41,(0,j.singleton)(18)],35],[[41,(0,j.singleton)(0)],35],[[41,(0,j.singleton)(21)],35],[[41,(0,j.singleton)(26)],35],[[41,(0,j.singleton)(25)],35],[[41,(0,j.singleton)(24)],35],[[41,(0,j.singleton)(23)],35],[[41,(0,j.singleton)(17)],35],[[41,(0,j.singleton)(22)],35],[[41,(0,j.singleton)(2)],35],[[41,(0,j.singleton)(19)],35],[[41,(0,j.singleton)(7)],35],[[41,(0,j.singleton)(6)],35],[[41,(0,j.singleton)(16)],35],[[41,(0,j.singleton)(4)],36],[[42,(0,j.singleton)(33)],74],[[43,(0,j.singleton)(27)],5],[[43,(0,j.singleton)(30)],5],[[43,(0,j.singleton)(31)],5],[[43,(0,j.singleton)(29)],5],[[43,(0,j.singleton)(7)],5],[[43,(0,j.singleton)(13)],5],[[43,(0,j.singleton)(1)],6],[[44,(0,j.singleton)(3)],9],[[44,(0,j.singleton)(0)],9],[[44,(0,j.singleton)(2)],9],[[44,(0,j.singleton)(15)],10],[[44,(0,j.singleton)(20)],10],[[44,(0,j.singleton)(18)],10],[[44,(0,j.singleton)(21)],10],[[44,(0,j.singleton)(26)],10],[[44,(0,j.singleton)(25)],10],[[44,(0,j.singleton)(24)],10],[[44,(0,j.singleton)(23)],10],[[44,(0,j.singleton)(17)],10],[[44,(0,j.singleton)(22)],10],[[44,(0,j.singleton)(19)],10],[[44,(0,j.singleton)(16)],10],[[45,(0,j.singleton)(1)],53],[[45,(0,j.singleton)(32)],54],[[46,(0,j.singleton)(31)],55],[[46,(0,j.singleton)(29)],56],[[47,(0,j.singleton)(31)],62],[[48,(0,j.singleton)(32)],37],[[48,(0,j.singleton)(1)],37],[[48,(0,j.singleton)(4)],38],[[48,(0,j.singleton)(5)],39],[[48,(0,j.singleton)(10)],40],[[48,(0,j.singleton)(15)],41],[[48,(0,j.singleton)(3)],41],[[48,(0,j.singleton)(20)],41],[[48,(0,j.singleton)(18)],41],[[48,(0,j.singleton)(0)],41],[[48,(0,j.singleton)(21)],41],[[48,(0,j.singleton)(26)],41],[[48,(0,j.singleton)(25)],41],[[48,(0,j.singleton)(24)],41],[[48,(0,j.singleton)(23)],41],[[48,(0,j.singleton)(17)],41],[[48,(0,j.singleton)(22)],41],[[48,(0,j.singleton)(2)],41],[[48,(0,j.singleton)(19)],41],[[48,(0,j.singleton)(7)],41],[[48,(0,j.singleton)(6)],41],[[48,(0,j.singleton)(16)],41],[[49,(0,j.singleton)(15)],11],[[49,(0,j.singleton)(16)],12],[[49,(0,j.singleton)(17)],13],[[49,(0,j.singleton)(18)],14],[[49,(0,j.singleton)(19)],15],[[49,(0,j.singleton)(20)],16],[[49,(0,j.singleton)(21)],17],[[49,(0,j.singleton)(22)],18],[[49,(0,j.singleton)(23)],19],[[49,(0,j.singleton)(24)],20],[[49,(0,j.singleton)(25)],21],[[49,(0,j.singleton)(26)],22],[[50,(0,j.singleton)(15)],33],[[50,(0,j.singleton)(3)],33],[[50,(0,j.singleton)(20)],33],[[50,(0,j.singleton)(18)],33],[[50,(0,j.singleton)(0)],33],[[50,(0,j.singleton)(21)],33],[[50,(0,j.singleton)(26)],33],[[50,(0,j.singleton)(25)],33],[[50,(0,j.singleton)(24)],33],[[50,(0,j.singleton)(23)],33],[[50,(0,j.singleton)(17)],33],[[50,(0,j.singleton)(22)],33],[[50,(0,j.singleton)(2)],33],[[50,(0,j.singleton)(19)],33],[[50,(0,j.singleton)(7)],33],[[50,(0,j.singleton)(6)],33],[[50,(0,j.singleton)(16)],33],[[50,(0,j.singleton)(14)],34],[[51,(0,j.singleton)(27)],69],[[51,(0,j.singleton)(30)],69],[[51,(0,j.singleton)(31)],69],[[51,(0,j.singleton)(29)],69],[[51,(0,j.singleton)(1)],69],[[51,(0,j.singleton)(7)],69],[[51,(0,j.singleton)(13)],69],[[51,(0,j.singleton)(16)],70],[[51,(0,j.singleton)(15)],71],[[52,(0,j.singleton)(2)],7],[[52,(0,j.singleton)(3)],8],[[53,(0,j.singleton)(13)],31],[[53,(0,j.singleton)(30)],32],[[54,(0,j.singleton)(30)],52],[[54,(0,j.singleton)(13)],52],[[55,(0,j.singleton)(31)],46],[[55,(0,j.singleton)(30)],47],[[55,(0,j.singleton)(13)],47],[[56,(0,j.singleton)(30)],42],[[56,(0,j.singleton)(13)],42],[[56,(0,j.singleton)(29)],43],[[57,(0,j.singleton)(21)],63],[[57,(0,j.singleton)(22)],64],[[57,(0,j.singleton)(23)],65],[[57,(0,j.singleton)(25)],66],[[57,(0,j.singleton)(24)],67],[[57,(0,j.singleton)(26)],68],[[58,(0,j.singleton)(15)],2],[[58,(0,j.singleton)(27)],2],[[58,(0,j.singleton)(30)],2],[[58,(0,j.singleton)(31)],2],[[58,(0,j.singleton)(29)],2],[[58,(0,j.singleton)(1)],2],[[58,(0,j.singleton)(7)],2],[[58,(0,j.singleton)(13)],2],[[58,(0,j.singleton)(6)],2],[[58,(0,j.singleton)(16)],2],[[59,(0,j.singleton)(6)],3],[[59,(0,j.singleton)(15)],4],[[59,(0,j.singleton)(27)],4],[[59,(0,j.singleton)(30)],4],[[59,(0,j.singleton)(3)],4],[[59,(0,j.singleton)(20)],4],[[59,(0,j.singleton)(18)],4],[[59,(0,j.singleton)(0)],4],[[59,(0,j.singleton)(21)],4],[[59,(0,j.singleton)(26)],4],[[59,(0,j.singleton)(25)],4],[[59,(0,j.singleton)(31)],4],[[59,(0,j.singleton)(24)],4],[[59,(0,j.singleton)(23)],4],[[59,(0,j.singleton)(17)],4],[[59,(0,j.singleton)(22)],4],[[59,(0,j.singleton)(29)],4],[[59,(0,j.singleton)(2)],4],[[59,(0,j.singleton)(1)],4],[[59,(0,j.singleton)(19)],4],[[59,(0,j.singleton)(7)],4],[[59,(0,j.singleton)(13)],4],[[59,(0,j.singleton)(16)],4],[[60,(0,j.singleton)(28)],26],[[60,(0,j.singleton)(21)],27],[[60,(0,j.singleton)(26)],27],[[60,(0,j.singleton)(25)],27],[[60,(0,j.singleton)(24)],27],[[60,(0,j.singleton)(23)],27],[[60,(0,j.singleton)(22)],27],[[61,(0,j.singleton)(27)],23],[[61,(0,j.singleton)(30)],23],[[61,(0,j.singleton)(31)],23],[[61,(0,j.singleton)(29)],23],[[61,(0,j.singleton)(7)],23],[[61,(0,j.singleton)(13)],23],[[62,(0,j.singleton)(27)],24],[[62,(0,j.singleton)(7)],25],[[62,(0,j.singleton)(29)],28],[[62,(0,j.singleton)(30)],29],[[62,(0,j.singleton)(13)],29],[[62,(0,j.singleton)(31)],30],[[63,(0,j.singleton)(21)],0],[[63,(0,j.singleton)(15)],1],[[63,(0,j.singleton)(27)],1],[[63,(0,j.singleton)(30)],1],[[63,(0,j.singleton)(31)],1],[[63,(0,j.singleton)(29)],1],[[63,(0,j.singleton)(1)],1],[[63,(0,j.singleton)(7)],1],[[63,(0,j.singleton)(13)],1],[[63,(0,j.singleton)(6)],1],[[63,(0,j.singleton)(16)],1],[[64,(0,j.singleton)(27)],72],[[64,(0,j.singleton)(30)],72],[[64,(0,j.singleton)(31)],72],[[64,(0,j.singleton)(29)],72],[[64,(0,j.singleton)(1)],72],[[64,(0,j.singleton)(7)],72],[[64,(0,j.singleton)(13)],72],[[64,(0,j.singleton)(16)],73]],{Equals:ab.equalArrays,GetHashCode:ab.arrayHash});zi.llTable=wDe;var DDe=new TDe.Dictionary([[[34,30],(0,j.singleton)(49)],[[34,28],(0,j.singleton)(49)],[[35,15],(0,j.singleton)(50)],[[35,27],(0,j.singleton)(50)],[[35,30],(0,j.ofArray)([50,51])],[[35,20],(0,j.singleton)(50)],[[35,18],(0,j.singleton)(50)],[[35,0],(0,j.singleton)(50)],[[35,21],(0,j.singleton)(50)],[[35,26],(0,j.singleton)(50)],[[35,25],(0,j.singleton)(50)],[[35,31],(0,j.ofArray)([50,51])],[[35,24],(0,j.singleton)(50)],[[35,23],(0,j.singleton)(50)],[[35,17],(0,j.singleton)(50)],[[35,22],(0,j.singleton)(50)],[[35,29],(0,j.singleton)(50)],[[35,19],(0,j.singleton)(50)],[[35,28],(0,j.ofArray)([50,51])],[[35,16],(0,j.singleton)(50)],[[36,30],(0,j.singleton)(48)],[[36,31],(0,j.singleton)(48)],[[36,28],(0,j.singleton)(48)],[[37,15],(0,j.singleton)(61)],[[37,27],(0,j.singleton)(61)],[[37,30],(0,j.singleton)(61)],[[37,21],(0,j.singleton)(61)],[[37,26],(0,j.singleton)(61)],[[37,25],(0,j.singleton)(61)],[[37,31],(0,j.singleton)(61)],[[37,24],(0,j.singleton)(61)],[[37,23],(0,j.singleton)(61)],[[37,22],(0,j.singleton)(61)],[[37,29],(0,j.singleton)(61)],[[37,28],(0,j.singleton)(61)],[[37,16],(0,j.singleton)(61)],[[38,15],(0,j.ofArray)([57,58])],[[38,27],(0,j.ofArray)([57,58])],[[38,30],(0,j.ofArray)([57,58])],[[38,20],(0,j.singleton)(57)],[[38,18],(0,j.singleton)(57)],[[38,0],(0,j.singleton)(57)],[[38,21],(0,j.ofArray)([57,58])],[[38,26],(0,j.ofArray)([57,58])],[[38,25],(0,j.ofArray)([57,58])],[[38,31],(0,j.ofArray)([57,58])],[[38,24],(0,j.ofArray)([57,58])],[[38,23],(0,j.ofArray)([57,58])],[[38,17],(0,j.singleton)(57)],[[38,22],(0,j.ofArray)([57,58])],[[38,29],(0,j.ofArray)([57,58])],[[38,19],(0,j.singleton)(57)],[[38,28],(0,j.ofArray)([57,58])],[[38,16],(0,j.ofArray)([57,58])],[[39,15],(0,j.ofArray)([59,60])],[[39,27],(0,j.ofArray)([59,60])],[[39,30],(0,j.ofArray)([59,60])],[[39,20],(0,j.singleton)(59)],[[39,18],(0,j.singleton)(59)],[[39,0],(0,j.singleton)(59)],[[39,21],(0,j.ofArray)([59,60])],[[39,26],(0,j.ofArray)([59,60])],[[39,25],(0,j.ofArray)([59,60])],[[39,31],(0,j.ofArray)([59,60])],[[39,24],(0,j.ofArray)([59,60])],[[39,23],(0,j.ofArray)([59,60])],[[39,17],(0,j.singleton)(59)],[[39,22],(0,j.ofArray)([59,60])],[[39,29],(0,j.ofArray)([59,60])],[[39,19],(0,j.singleton)(59)],[[39,28],(0,j.ofArray)([59,60])],[[39,16],(0,j.ofArray)([59,60])],[[40,30],(0,j.ofArray)([44,45])],[[40,31],(0,j.ofArray)([44,45])],[[40,28],(0,j.ofArray)([44,45])],[[40,15],(0,j.singleton)(45)],[[40,27],(0,j.singleton)(45)],[[40,20],(0,j.singleton)(45)],[[40,18],(0,j.singleton)(45)],[[40,0],(0,j.singleton)(45)],[[40,21],(0,j.singleton)(45)],[[40,26],(0,j.singleton)(45)],[[40,25],(0,j.singleton)(45)],[[40,24],(0,j.singleton)(45)],[[40,23],(0,j.singleton)(45)],[[40,17],(0,j.singleton)(45)],[[40,22],(0,j.singleton)(45)],[[40,29],(0,j.singleton)(45)],[[40,19],(0,j.singleton)(45)],[[40,16],(0,j.singleton)(45)],[[41,15],(0,j.singleton)(35)],[[41,27],(0,j.singleton)(35)],[[41,30],(0,j.ofArray)([35,36])],[[41,20],(0,j.singleton)(35)],[[41,18],(0,j.singleton)(35)],[[41,0],(0,j.singleton)(35)],[[41,21],(0,j.singleton)(35)],[[41,26],(0,j.singleton)(35)],[[41,25],(0,j.singleton)(35)],[[41,31],(0,j.singleton)(35)],[[41,24],(0,j.singleton)(35)],[[41,23],(0,j.singleton)(35)],[[41,17],(0,j.singleton)(35)],[[41,22],(0,j.singleton)(35)],[[41,29],(0,j.singleton)(35)],[[41,19],(0,j.singleton)(35)],[[41,28],(0,j.ofArray)([35,36])],[[41,16],(0,j.singleton)(35)],[[42,33],(0,j.singleton)(74)],[[43,27],(0,j.ofArray)([5,6])],[[43,30],(0,j.ofArray)([5,6])],[[43,21],(0,j.ofArray)([5,6])],[[43,26],(0,j.ofArray)([5,6])],[[43,25],(0,j.ofArray)([5,6])],[[43,31],(0,j.ofArray)([5,6])],[[43,24],(0,j.ofArray)([5,6])],[[43,23],(0,j.ofArray)([5,6])],[[43,22],(0,j.ofArray)([5,6])],[[43,29],(0,j.ofArray)([5,6])],[[43,28],(0,j.ofArray)([5,6])],[[43,15],(0,j.singleton)(6)],[[43,16],(0,j.singleton)(6)],[[44,15],(0,j.ofArray)([9,10])],[[44,27],(0,j.singleton)(9)],[[44,30],(0,j.singleton)(9)],[[44,20],(0,j.ofArray)([9,10])],[[44,18],(0,j.ofArray)([9,10])],[[44,0],(0,j.singleton)(9)],[[44,21],(0,j.ofArray)([9,10])],[[44,26],(0,j.ofArray)([9,10])],[[44,25],(0,j.ofArray)([9,10])],[[44,31],(0,j.singleton)(9)],[[44,24],(0,j.ofArray)([9,10])],[[44,23],(0,j.ofArray)([9,10])],[[44,17],(0,j.ofArray)([9,10])],[[44,22],(0,j.ofArray)([9,10])],[[44,29],(0,j.singleton)(9)],[[44,19],(0,j.ofArray)([9,10])],[[44,28],(0,j.singleton)(9)],[[44,16],(0,j.ofArray)([9,10])],[[45,15],(0,j.singleton)(53)],[[45,27],(0,j.singleton)(53)],[[45,30],(0,j.singleton)(53)],[[45,20],(0,j.singleton)(53)],[[45,18],(0,j.singleton)(53)],[[45,0],(0,j.singleton)(53)],[[45,21],(0,j.singleton)(53)],[[45,26],(0,j.singleton)(53)],[[45,25],(0,j.singleton)(53)],[[45,31],(0,j.singleton)(53)],[[45,24],(0,j.singleton)(53)],[[45,23],(0,j.singleton)(53)],[[45,17],(0,j.singleton)(53)],[[45,22],(0,j.singleton)(53)],[[45,29],(0,j.singleton)(53)],[[45,19],(0,j.singleton)(53)],[[45,28],(0,j.singleton)(53)],[[45,16],(0,j.singleton)(53)],[[45,32],(0,j.singleton)(54)],[[46,31],(0,j.singleton)(55)],[[46,29],(0,j.singleton)(56)],[[47,31],(0,j.singleton)(62)],[[48,15],(0,j.ofArray)([37,41])],[[48,27],(0,j.ofArray)([37,41])],[[48,30],(0,j.ofArray)([37,39,41])],[[48,20],(0,j.ofArray)([37,41])],[[48,18],(0,j.ofArray)([37,41])],[[48,32],(0,j.singleton)(37)],[[48,0],(0,j.ofArray)([37,41])],[[48,21],(0,j.ofArray)([37,41])],[[48,26],(0,j.ofArray)([37,41])],[[48,25],(0,j.ofArray)([37,41])],[[48,31],(0,j.ofArray)([37,38,40,41])],[[48,24],(0,j.ofArray)([37,41])],[[48,23],(0,j.ofArray)([37,41])],[[48,17],(0,j.ofArray)([37,41])],[[48,22],(0,j.ofArray)([37,41])],[[48,29],(0,j.ofArray)([37,39,41])],[[48,19],(0,j.ofArray)([37,41])],[[48,28],(0,j.ofArray)([37,39,41])],[[48,16],(0,j.ofArray)([37,41])],[[49,15],(0,j.singleton)(11)],[[49,16],(0,j.singleton)(12)],[[49,17],(0,j.singleton)(13)],[[49,18],(0,j.singleton)(14)],[[49,19],(0,j.singleton)(15)],[[49,20],(0,j.singleton)(16)],[[49,21],(0,j.singleton)(17)],[[49,22],(0,j.singleton)(18)],[[49,23],(0,j.singleton)(19)],[[49,24],(0,j.singleton)(20)],[[49,25],(0,j.singleton)(21)],[[49,26],(0,j.singleton)(22)],[[50,15],(0,j.singleton)(33)],[[50,27],(0,j.singleton)(33)],[[50,30],(0,j.singleton)(33)],[[50,20],(0,j.singleton)(33)],[[50,18],(0,j.singleton)(33)],[[50,0],(0,j.singleton)(33)],[[50,21],(0,j.singleton)(33)],[[50,26],(0,j.singleton)(33)],[[50,25],(0,j.singleton)(33)],[[50,31],(0,j.singleton)(33)],[[50,24],(0,j.singleton)(33)],[[50,23],(0,j.singleton)(33)],[[50,17],(0,j.singleton)(33)],[[50,22],(0,j.singleton)(33)],[[50,29],(0,j.singleton)(33)],[[50,19],(0,j.singleton)(33)],[[50,28],(0,j.singleton)(33)],[[50,16],(0,j.singleton)(33)],[[50,14],(0,j.singleton)(34)],[[51,15],(0,j.ofArray)([69,71])],[[51,27],(0,j.singleton)(69)],[[51,30],(0,j.singleton)(69)],[[51,21],(0,j.singleton)(69)],[[51,26],(0,j.singleton)(69)],[[51,25],(0,j.singleton)(69)],[[51,31],(0,j.singleton)(69)],[[51,24],(0,j.singleton)(69)],[[51,23],(0,j.singleton)(69)],[[51,22],(0,j.singleton)(69)],[[51,29],(0,j.singleton)(69)],[[51,28],(0,j.singleton)(69)],[[51,16],(0,j.ofArray)([69,70])],[[52,15],(0,j.ofArray)([7,8])],[[52,27],(0,j.ofArray)([7,8])],[[52,30],(0,j.ofArray)([7,8])],[[52,20],(0,j.singleton)(7)],[[52,18],(0,j.singleton)(7)],[[52,0],(0,j.singleton)(7)],[[52,21],(0,j.ofArray)([7,8])],[[52,26],(0,j.ofArray)([7,8])],[[52,25],(0,j.ofArray)([7,8])],[[52,31],(0,j.ofArray)([7,8])],[[52,24],(0,j.ofArray)([7,8])],[[52,23],(0,j.ofArray)([7,8])],[[52,17],(0,j.singleton)(7)],[[52,22],(0,j.ofArray)([7,8])],[[52,29],(0,j.ofArray)([7,8])],[[52,19],(0,j.singleton)(7)],[[52,28],(0,j.ofArray)([7,8])],[[52,16],(0,j.ofArray)([7,8])],[[53,28],(0,j.singleton)(31)],[[53,30],(0,j.singleton)(32)],[[54,30],(0,j.singleton)(52)],[[54,28],(0,j.singleton)(52)],[[55,31],(0,j.singleton)(46)],[[55,30],(0,j.singleton)(47)],[[55,28],(0,j.singleton)(47)],[[56,30],(0,j.singleton)(42)],[[56,28],(0,j.singleton)(42)],[[56,29],(0,j.singleton)(43)],[[57,21],(0,j.singleton)(63)],[[57,22],(0,j.singleton)(64)],[[57,23],(0,j.singleton)(65)],[[57,25],(0,j.singleton)(66)],[[57,24],(0,j.singleton)(67)],[[57,26],(0,j.singleton)(68)],[[58,15],(0,j.singleton)(2)],[[58,27],(0,j.singleton)(2)],[[58,30],(0,j.singleton)(2)],[[58,21],(0,j.singleton)(2)],[[58,26],(0,j.singleton)(2)],[[58,25],(0,j.singleton)(2)],[[58,31],(0,j.singleton)(2)],[[58,24],(0,j.singleton)(2)],[[58,23],(0,j.singleton)(2)],[[58,22],(0,j.singleton)(2)],[[58,29],(0,j.singleton)(2)],[[58,28],(0,j.singleton)(2)],[[58,16],(0,j.singleton)(2)],[[59,15],(0,j.ofArray)([3,4])],[[59,27],(0,j.ofArray)([3,4])],[[59,30],(0,j.ofArray)([3,4])],[[59,20],(0,j.ofArray)([3,4])],[[59,18],(0,j.ofArray)([3,4])],[[59,0],(0,j.ofArray)([3,4])],[[59,21],(0,j.ofArray)([3,4])],[[59,26],(0,j.ofArray)([3,4])],[[59,25],(0,j.ofArray)([3,4])],[[59,31],(0,j.ofArray)([3,4])],[[59,24],(0,j.ofArray)([3,4])],[[59,23],(0,j.ofArray)([3,4])],[[59,17],(0,j.ofArray)([3,4])],[[59,22],(0,j.ofArray)([3,4])],[[59,29],(0,j.ofArray)([3,4])],[[59,19],(0,j.ofArray)([3,4])],[[59,28],(0,j.ofArray)([3,4])],[[59,16],(0,j.ofArray)([3,4])],[[60,28],(0,j.singleton)(26)],[[60,21],(0,j.singleton)(27)],[[60,26],(0,j.singleton)(27)],[[60,25],(0,j.singleton)(27)],[[60,24],(0,j.singleton)(27)],[[60,23],(0,j.singleton)(27)],[[60,22],(0,j.singleton)(27)],[[61,27],(0,j.singleton)(23)],[[61,30],(0,j.singleton)(23)],[[61,21],(0,j.singleton)(23)],[[61,26],(0,j.singleton)(23)],[[61,25],(0,j.singleton)(23)],[[61,31],(0,j.singleton)(23)],[[61,24],(0,j.singleton)(23)],[[61,23],(0,j.singleton)(23)],[[61,22],(0,j.singleton)(23)],[[61,29],(0,j.singleton)(23)],[[61,28],(0,j.singleton)(23)],[[62,27],(0,j.singleton)(24)],[[62,21],(0,j.singleton)(25)],[[62,26],(0,j.singleton)(25)],[[62,25],(0,j.singleton)(25)],[[62,24],(0,j.singleton)(25)],[[62,23],(0,j.singleton)(25)],[[62,22],(0,j.singleton)(25)],[[62,28],(0,j.ofArray)([25,29])],[[62,29],(0,j.singleton)(28)],[[62,30],(0,j.singleton)(29)],[[62,31],(0,j.singleton)(30)],[[63,21],(0,j.ofArray)([0,1])],[[63,15],(0,j.singleton)(1)],[[63,27],(0,j.singleton)(1)],[[63,30],(0,j.singleton)(1)],[[63,26],(0,j.singleton)(1)],[[63,25],(0,j.singleton)(1)],[[63,31],(0,j.singleton)(1)],[[63,24],(0,j.singleton)(1)],[[63,23],(0,j.singleton)(1)],[[63,22],(0,j.singleton)(1)],[[63,29],(0,j.singleton)(1)],[[63,28],(0,j.singleton)(1)],[[63,16],(0,j.singleton)(1)],[[64,15],(0,j.singleton)(72)],[[64,27],(0,j.singleton)(72)],[[64,30],(0,j.singleton)(72)],[[64,21],(0,j.singleton)(72)],[[64,26],(0,j.singleton)(72)],[[64,25],(0,j.singleton)(72)],[[64,31],(0,j.singleton)(72)],[[64,24],(0,j.singleton)(72)],[[64,23],(0,j.singleton)(72)],[[64,22],(0,j.singleton)(72)],[[64,29],(0,j.singleton)(72)],[[64,28],(0,j.singleton)(72)],[[64,16],(0,j.ofArray)([72,73])]],{Equals:ab.equalArrays,GetHashCode:ab.arrayHash});zi.llRepairTable=DDe;var nrn=new Yen.ParserConfig(FDe,bDe,PDe,EDe,NDe,ADe,ODe,63,0,MDe,wDe,DDe,kDe,IDe);zi.config=nrn});var Cue=Y(bc=>{_();var s4=An();Object.defineProperty(bc,"__esModule",{value:!0});bc.ListMapping$2=void 0;bc.ListMapping$2$reflection=hrn;bc.ListMapping$2_$ctor=Srn;bc.ListMapping$2__Add_5BDDA1=yrn;bc.ListMapping$2__Get_2B595=Crn;bc.MutableLinkedList$1=void 0;bc.MutableLinkedList$1$reflection=gue;bc.PriorityQueue$2=void 0;bc.PriorityQueue$2$reflection=lrn;bc.PriorityQueue$2_$ctor=crn;bc.PriorityQueue$2__Clear=mrn;bc.PriorityQueue$2__Dequeue=frn;bc.PriorityQueue$2__Enqueue_5BDDA1=drn;bc.PriorityQueue$2__get_NonEmpty=prn;bc.minElement=vrn;bc.optionOr=Rrn;bc.someOptionOr=_rn;var vue=s4(it()),hue=s4(at()),trn=s4(Qf()),arn=s4(zf()),xDe=s4(Ed()),RN=Uc(),eI=c0(),rI=Cc(),_N=Iy(),irn=pue(),LDe=Oy(),orn=Dy();function urn(e){var r=srn();return function(){var a=(0,xDe.default)(e),o;if(r){var u=(0,xDe.default)(this).constructor;o=Reflect.construct(a,arguments,u)}else o=a.apply(this,arguments);return(0,arn.default)(this,o)}}function srn(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var oW=function(e){(0,trn.default)(n,e);var r=urn(n);function n(a,o){var u;return(0,hue.default)(this,n),u=r.call(this),u.Value=a,u.Next=o,u}return(0,vue.default)(n)}(RN.Record);bc.MutableLinkedList$1=oW;function gue(e){return(0,eI.record_type)("Microsoft.ProgramSynthesis.Repair.Framework.Utils.MutableLinkedList`1",[e],oW,function(){return[["Value",e],["Next",(0,eI.record_type)("Microsoft.FSharp.Core.FSharpRef`1",[(0,eI.option_type)(gue(e))],RN.FSharpRef,function(){return[["contents",(0,eI.option_type)(gue(e))]]})]]})}var Sue=(0,vue.default)(function e(){(0,hue.default)(this,e),this.elts=new RN.FSharpRef(void 0)});bc.PriorityQueue$2=Sue;function lrn(e,r){return(0,eI.class_type)("Microsoft.ProgramSynthesis.Repair.Framework.Utils.PriorityQueue`2",[e,r],Sue)}function crn(){return new Sue}function drn(e,r,n){grn(e,r,n,e.elts)}function frn(e){var r=e.elts.contents;if(r!=null){var n=r;return e.elts.contents=n.Next.contents,n.Value}else throw new Error("Dequeue on empty priority queue")}function prn(e){return e.elts.contents!=null}function mrn(e){e.elts=new RN.FSharpRef(void 0)}function grn(e,r,n,a){e:for(;;){var o=e,u=r,t=n,d=a,s=d.contents;if(s!=null){var c=s;if((0,rI.compare)(t,c.Value[1])<=0){var l=new oW([u,t],new RN.FSharpRef(d.contents));d.contents=l}else{e=o,r=u,n=t,a=c.Next;continue e}}else d.contents=new oW([u,t],new RN.FSharpRef(void 0));break}}function vrn(e){var r=void 0,n=(0,rI.getEnumerator)(e);try{for(;n["System.Collections.IEnumerator.MoveNext"]();){var a=n["System.Collections.Generic.IEnumerator`1.get_Current"]();r!=null?(0,rI.compare)(a,(0,_N.value)(r))<0&&(r=(0,_N.some)(a)):r=(0,_N.some)(a)}}finally{(0,rI.disposeSafe)(n)}if(r==null)throw new Error("Expected non-empty sequence\\nParameter name: s");return(0,_N.value)(r)}var yue=(0,vue.default)(function e(){(0,hue.default)(this,e),this.map=new irn.Dictionary([],{Equals:rI.equals,GetHashCode:rI.structuralHash})});bc.ListMapping$2=yue;function hrn(e,r){return(0,eI.class_type)("Microsoft.ProgramSynthesis.Repair.Framework.Utils.ListMapping`2",[e,r],yue)}function Srn(){return new yue}function yrn(e,r,n){e.map.has(r)||e.map.set(r,[]),(0,LDe.getItemFromDict)(e.map,r).push(n)}function Crn(e,r){var n,a=null;return n=[(0,LDe.tryGetValue)(e.map,r,new RN.FSharpRef(function(){return a},function(o){a=o})),a],n[0]?n[1]:(0,orn.empty)()}function _rn(e,r){if(e==null)return(0,_N.some)(r);var n=(0,_N.value)(e);return e}function Rrn(e,r){return e==null?r:(0,_N.value)(e)}});var VDe=Y(eg=>{_();var d4=An();Object.defineProperty(eg,"__esModule",{value:!0});eg.DistanceRepairSearcher=void 0;eg.DistanceRepairSearcher$reflection=Nrn;eg.DistanceRepairSearcher_$ctor_212569DE=Arn;eg.DistanceRepairSearcher__ClearQueue=Orn;eg.DistanceRepairSearcher__Search_Z297C2F74=krn;eg.RepairResult=void 0;eg.RepairResult$reflection=Prn;eg.SearchState=void 0;eg.SearchState$reflection=Ern;var Tue=d4(it()),bue=d4(at()),GDe=d4(Qf()),Trn=d4(zf()),BDe=d4(Ed()),I_=Uc(),f0=c0(),yo=HF(),Gc=Dy(),qDe=N_(),TN=Cue(),lt=O_(),c4=a4(),M_=Oy(),_ue=Cc();function KDe(e){var r=brn();return function(){var a=(0,BDe.default)(e),o;if(r){var u=(0,BDe.default)(this).constructor;o=Reflect.construct(a,arguments,u)}else o=a.apply(this,arguments);return(0,Trn.default)(this,o)}}function brn(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Pue=function(e){(0,GDe.default)(n,e);var r=KDe(n);function n(a,o){var u;return(0,bue.default)(this,n),u=r.call(this),u.EditDistance=a,u.Output=o,u}return(0,Tue.default)(n)}(I_.Record);eg.RepairResult=Pue;function Prn(){return(0,f0.record_type)("Microsoft.ProgramSynthesis.Repair.Framework.RepairSearcher.RepairResult",[],Pue,function(){return[["EditDistance",f0.float64_type],["Output",(0,f0.list_type)((0,yo.Token$reflection)())]]})}var bN=function(e){(0,GDe.default)(n,e);var r=KDe(n);function n(a,o,u,t,d,s,c){var l;return(0,bue.default)(this,n),l=r.call(this),l.Stack=a,l.Output=o,l.Observed=u,l.EditDistances=t,l.EditOriginalTokens=d,l.TieBreaker=s|0,l.CurrentEditDistance=c,l}return(0,Tue.default)(n,[{key:"toString",value:function(){var o=this,u=(0,yo.debugOfSeq)(" ",o.Stack),t=(0,yo.debugOfSeq)(" ",(0,Gc.reverse)(o.Output)),d=(0,yo.debugOfSeq)(" ",o.Observed);return(0,qDe.toText)((0,qDe.printf)("{Stack = %s, Observed = %s, Output = %s, Cost= %f}"))(u)(d)(t)(o.CurrentEditDistance)}}]),n}(I_.Record);eg.SearchState=bN;function Ern(){return(0,f0.record_type)("Microsoft.ProgramSynthesis.Repair.Framework.RepairSearcher.SearchState",[],bN,function(){return[["Stack",(0,f0.list_type)(f0.int32_type)],["Output",(0,f0.list_type)((0,yo.Token$reflection)())],["Observed",(0,f0.list_type)((0,yo.Observed$reflection)())],["EditDistances",(0,f0.array_type)(f0.float64_type)],["EditOriginalTokens",(0,f0.array_type)((0,f0.list_type)((0,f0.option_type)((0,yo.Token$reflection)())))],["TieBreaker",f0.int32_type],["CurrentEditDistance",f0.float64_type]]})}var Eue=(0,Tue.default)(function e(r){(0,bue.default)(this,e),this.conf=r,this.queue=(0,TN.PriorityQueue$2_$ctor)(),this.tieBreaker=0});eg.DistanceRepairSearcher=Eue;function Nrn(){return(0,f0.class_type)("Microsoft.ProgramSynthesis.Repair.Framework.RepairSearcher.DistanceRepairSearcher",void 0,Eue)}function Arn(e){return new Eue(e)}function Orn(e){(0,TN.PriorityQueue$2__Clear)(e.queue)}function krn(e,r,n,a,o){return(0,Gc.delay)(function(){return(0,Gc.append)(((0,TN.PriorityQueue$2__get_NonEmpty)(e.queue)&&function(){throw new Error("State queue should be empty")}(),(0,Gc.empty)()),(0,Gc.delay)(function(){var u=0,t=0,d=UDe(e,(0,lt.isEmpty)(n)?function(){throw new Error("expected non-empty observed")}():(0,lt.head)(n).Unreliable);return l4(e,new bN(Lrn(e,r),(0,lt.empty)(),n,d[0],d[1],u,t),t),(0,Gc.enumerateWhile)(function(){return(0,TN.PriorityQueue$2__get_NonEmpty)(e.queue)&&!o["Microsoft.ProgramSynthesis.Repair.Framework.ParseState.FrameworkCancellationToken.get_IsCancellationRequested"]()},(0,Gc.delay)(function(){var s,c,l,f,p=(0,TN.PriorityQueue$2__Dequeue)(e.queue),m=p[0],v=p[1][0],h=m.Observed;if((0,lt.isEmpty)(h))throw new Error("unexpected empty observed segments");var S=(0,lt.head)(h).Unreliable,y=(0,lt.head)(h).Reliable,C=(0,lt.tail)(h),E=m.Stack;if((0,lt.isEmpty)(E))throw new Error("search: empty stack");var I=(0,lt.tail)(E),F=(0,lt.head)(E)|0;if((0,c4.FSharpSet__Contains)(e.conf.Terminals,F))if(F===(0,yo.Token__get_Symbol)(y)){var w=xrn(e,m),B=w.EditDistances[w.EditDistances.length-1],k=B+w.CurrentEditDistance;if(Rue(e,k,a)&&wrn(e,B,(0,lt.head)(h).MinEditDist,a)){if(k<v)throw new Error("real distance should not end up lower than estimated");if(k>v)return l4(e,w,k),(0,Gc.empty)();var x=(0,lt.cons)(y,w.Output);if((0,lt.isEmpty)(C))return(0,Gc.singleton)(new Pue(k,(0,lt.reverse)(x)));var G=UDe(e,(0,lt.head)(C).Unreliable);return l4(e,(s=new I_.FSharpRef(w),new bN(I,x,C,G[0],G[1],s.contents.TieBreaker,k)),k),(0,Gc.empty)()}else return(0,Gc.empty)()}else{if((0,c4.FSharpSet__Contains)(e.conf.ReliableTerminals,F))return(0,Gc.empty)();var H=Irn(e,(0,c4.FSharpSet__Contains)(e.conf.InsertableTerminals,F)?m.EditDistances[0]+(0,M_.getItemFromDict)(e.conf.TerminalWeights,F):1/0,(0,lt.cons)(void 0,m.EditOriginalTokens[0]),S),L=H[1],D=H[0];Drn(e,F,S,m.EditDistances,m.EditOriginalTokens,D,L);var U=m.CurrentEditDistance+(0,TN.minElement)(D);if(Rue(e,U,a)){var V=new yo.TokenMetaInfo(!1,new yo.ModifyStatus(2)),ne=(0,yo.Token_$ctor_74210AD3)(F,(c=(l=null,[(0,M_.tryGetValue)(e.conf.TerminalDefaultValues,F,new I_.FSharpRef(function(){return l},function(Z){l=Z})),l]),c[0]?c[1]:null),V);return l4(e,(f=new I_.FSharpRef(m),new bN(I,(0,lt.cons)(ne,m.Output),f.contents.Observed,D,L,f.contents.TieBreaker,f.contents.CurrentEditDistance)),U),(0,Gc.empty)()}else return(0,Gc.empty)()}else{var J,$=null;return J=[(0,M_.tryGetValue)(e.conf.LLRepairTable,[F,(0,yo.Token__get_Symbol)(y)],new I_.FSharpRef(function(){return $},function(Z){$=Z})),$],J[0]?(0,Gc.collect)(function(Z){var ie,X=Frn(e,I,e.conf.Rules[Z]);return l4(e,(ie=new I_.FSharpRef(m),new bN(X,ie.contents.Output,ie.contents.Observed,ie.contents.EditDistances,ie.contents.EditOriginalTokens,ie.contents.TieBreaker,ie.contents.CurrentEditDistance)),v),(0,Gc.empty)()},J[1]):(0,Gc.empty)()}}))}))})}function l4(e,r,n){(0,TN.PriorityQueue$2__Enqueue_5BDDA1)(e.queue,r,[n,e.tieBreaker]),e.tieBreaker=e.tieBreaker-1|0}function Frn(e,r,n){e:for(;;){var a=e,o=r,u=n;if((0,lt.isEmpty)(u))return o;e=a,r=(0,lt.cons)((0,lt.head)(u),o),n=(0,lt.tail)(u);continue e;break}}function UDe(e,r){var n=function(o,u,t,d,s){var c;e:for(;;){var l=o,f=u,p=t,m=d,v=s;if((0,lt.isEmpty)(v))return[(0,lt.toArray)((0,lt.reverse)(p)),(0,lt.toArray)(m)];var h=(0,lt.head)(v),S=l?!0:(c=(0,yo.Token__get_MetaInfo)(h),!(0,yo.TokenMetaInfo__get_Modifiable)(c)),y=f+(0,M_.getItemFromDict)(e.conf.TerminalWeights,(0,yo.Token__get_Symbol)(h));o=S,u=y,t=(0,lt.cons)(S?1/0:y,p),d=(0,lt.cons)((0,lt.empty)(),m),s=(0,lt.tail)(v);continue e;break}};return n(!1,0,(0,lt.singleton)(0),(0,lt.singleton)((0,lt.empty)()),r)}function Irn(e,r,n,a){var o=function(t,d,s){e:for(;;){var c=t,l=d,f=s;if((0,lt.isEmpty)(f))return[(0,lt.toArray)((0,lt.reverse)(c)),(0,lt.toArray)((0,lt.reverse)(l))];t=(0,lt.cons)(0,c),d=(0,lt.cons)((0,lt.empty)(),l),s=(0,lt.tail)(f);continue e;break}};return o((0,lt.singleton)(r),(0,lt.singleton)(n),a)}function Mrn(e,r,n){return n!=null?r>=n:!0}function Rue(e,r,n){return n!=null?r<=n:!0}function wrn(e,r,n,a){return!(r>=1/0)&&Mrn(e,r,n)?Rue(e,r,a):!1}function Drn(e,r,n,a,o,u,t){var d=function(c,l){var f;e:for(;;){var p=c,m=l;if(!(0,lt.isEmpty)(m)){var v=(0,lt.head)(m),h=(f=(0,yo.Token__get_MetaInfo)(v),(0,yo.TokenMetaInfo__get_Modifiable)(f)&&(0,c4.FSharpSet__Contains)(e.conf.DeletableTerminals,(0,yo.Token__get_Symbol)(v))),S=h?u[p-1]+(0,M_.getItemFromDict)(e.conf.TerminalWeights,(0,yo.Token__get_Symbol)(v)):1/0,y=t[p-1],C=(0,c4.FSharpSet__Contains)(e.conf.InsertableTerminals,r),E=C?a[p]+(0,M_.getItemFromDict)(e.conf.TerminalWeights,r):1/0,I=(0,lt.cons)(void 0,o[p]),F=C&&h?a[p-1]+(0,_ue.max)(_ue.comparePrimitives,(0,M_.getItemFromDict)(e.conf.TerminalWeights,(0,yo.Token__get_Symbol)(v)),(0,M_.getItemFromDict)(e.conf.TerminalWeights,r)):1/0,w=(0,lt.cons)(void 0,o[p-1]),B=(0,lt.cons)(v,o[p-1]),k=S<E?[S,y]:[E,I],x=k[1],G=k[0],H=r===(0,yo.Token__get_Symbol)(v)?a[p-1]<=G?[a[p-1],B]:[G,x]:F<G?[F,w]:[G,x];u[p]=H[0],t[p]=H[1],c=p+1,l=(0,lt.tail)(m);continue e}break}};d(1,n)}function xrn(e,r){var n=function t(d,s){var c,l,f,p,m=[s,d];if((0,lt.isEmpty)(m[0]))return d;if((0,lt.isEmpty)(m[1]))throw new Error("More edit tokens than output");if(!(0,_ue.equals)((0,yo.Token__get_MetaInfo)((0,lt.head)(m[1])).ModifyStatus,new yo.ModifyStatus(2)))debugger;var v=t((0,lt.tail)(m[1]),(0,lt.tail)(m[0]));return(0,lt.cons)((0,lt.head)(m[0])!=null?(c=(0,lt.head)(m[0]),(0,yo.Token__get_Symbol)((0,lt.head)(m[1]))!==(0,yo.Token__get_Symbol)(c)&&function(){debugger}(),l=(f=null,[(0,M_.tryGetValue)(e.conf.TerminalDefaultValues,(0,yo.Token__get_Symbol)((0,lt.head)(m[1])),new I_.FSharpRef(function(){return f},function(h){f=h})),f]),(0,yo.Token__get_Value)((0,lt.head)(m[1]))===(0,yo.Token__get_Value)(c)||(0,yo.Token__get_Value)((0,lt.head)(m[1]))===l[1]||function(){debugger}(),p=new yo.TokenMetaInfo((0,yo.Token__get_MetaInfo)(c).FromInput,new yo.ModifyStatus(2)),(0,yo.Token_$ctor_5C2E8043)((0,yo.Token__get_Symbol)(c),(0,yo.Token__get_Value)(c),p,(0,yo.Token__get_Span)(c))):(0,lt.head)(m[1]),v)},a=n(r.Output,r.EditOriginalTokens[r.EditOriginalTokens.length-1]),o=new I_.FSharpRef(r),u=[(0,lt.empty)()];return new bN(o.contents.Stack,a,o.contents.Observed,o.contents.EditDistances,u,o.contents.TieBreaker,o.contents.CurrentEditDistance)}function Lrn(e,r){var n=function(o,u){e:for(;;){var t=o,d=u;if((0,lt.isEmpty)(d))return(0,lt.reverse)(t);o=(0,lt.cons)((0,lt.head)(d).Symbol,t),u=(0,lt.tail)(d);continue e;break}};return n((0,lt.empty)(),r)}});var Fue=Y(p0=>{_();var p4=An();Object.defineProperty(p0,"__esModule",{value:!0});p0.Parser$1=void 0;p0.Parser$1$reflection=jrn;p0.Parser$1_$ctor_654FF197=Hrn;p0.Parser$1__AddErrorStateTransformer_Z4C0E8FCD=$rn;p0.Parser$1__AddInitCallback_Z32A6DF7A=Yrn;p0.Parser$1__AddRuleCallback_Z6A2750E6=Xrn;p0.Parser$1__AddStateTransformer_Z37DD4466=Zrn;p0.Parser$1__AddTerminalMatchCallback_ZAB15BBF=Jrn;p0.Parser$1__ExpandRule_50A4B1B0=zrn;p0.Parser$1__Parse_2AE5B288=Qrn;p0.SymbolMatch=void 0;p0.SymbolMatch$reflection=Wrn;var QDe=p4(at()),zDe=p4(it()),Brn=p4(Qf()),qrn=p4(zf()),WDe=p4(Ed()),uW=Uc(),Nue=c0(),jl=HF(),Vf=Cue(),Aue=VDe(),Zo=Dy(),ko=Cc(),ai=O_(),Oue=a4(),Urn=Iy(),jDe=Oy(),Grn=qF();function Krn(e){var r=Vrn();return function(){var a=(0,WDe.default)(e),o;if(r){var u=(0,WDe.default)(this).constructor;o=Reflect.construct(a,arguments,u)}else o=a.apply(this,arguments);return(0,qrn.default)(this,o)}}function Vrn(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var ib=function(e){(0,Brn.default)(n,e);var r=Krn(n);function n(a){var o;(0,QDe.default)(this,n),o=r.call(this),o.tag=a|0;for(var u=arguments.length,t=new Array(u>1?u-1:0),d=1;d<u;d++)t[d-1]=arguments[d];return o.fields=t,o}return(0,zDe.default)(n,[{key:"cases",value:function(){return["Terminal","TaggedTerminal"]}}]),n}(uW.Union);p0.SymbolMatch=ib;function Wrn(){return(0,Nue.union_type)("Microsoft.ProgramSynthesis.Repair.Framework.Parser.SymbolMatch",[],ib,function(){return[[["Item",Nue.int32_type]],[["Item",(0,jl.SymbolSource$reflection)()]]]})}var kue=(0,zDe.default)(function e(r,n,a,o){(0,QDe.default)(this,e),this.this=new uW.FSharpRef(null);var u=this.this;this.config=r,this.maxLocalEditDist=n,this.maxGlobalEditDist=a,this.maxBacktrack=o|0,this.this.contents=this,this.tieBreaker=0,this.inSearch=!1,this.queue=(0,Vf.PriorityQueue$2_$ctor)(),this.searcher=(0,Aue.DistanceRepairSearcher_$ctor_212569DE)(this.config),this.initCallbacks=[],this.terminalMatchCallbacks=(0,Vf.ListMapping$2_$ctor)(),this.ruleCallbacks=(0,Vf.ListMapping$2_$ctor)(),this.stateTransformers=(0,Vf.ListMapping$2_$ctor)(),this.errorStateTransformer=[],this["init@28"]=1});p0.Parser$1=kue;function jrn(e){return(0,Nue.class_type)("Microsoft.ProgramSynthesis.Repair.Framework.Parser.Parser`1",[e],kue)}function Hrn(e,r,n,a){return new kue(e,r,n,a)}function Qrn(e,r,n,a,o){var u,t=fnn(e,(0,Zo.toList)(r),o);if(u=n==null?t:(0,Zo.truncate)(n,t),(0,ko.equals)(a,new jl.CancelActionKind(0))){var d=(0,Zo.toArray)(u);return o["Microsoft.ProgramSynthesis.Repair.Framework.ParseState.FrameworkCancellationToken.get_IsCancellationRequested"]()?[]:d}else return(0,Zo.delay)(function(){return(0,Zo.append)((0,Zo.map)(function(s){return s},u),(0,Zo.delay)(function(){if((0,ko.equals)(a,new jl.CancelActionKind(2))&&o["Microsoft.ProgramSynthesis.Repair.Framework.ParseState.FrameworkCancellationToken.get_IsCancellationRequested"]())throw new Error;return(0,Zo.empty)()}))})}function zrn(e,r,n){return YDe(e,r,n)}function Yrn(e,r){e.initCallbacks.push(r)}function Jrn(e,r,n){(0,Vf.ListMapping$2__Add_5BDDA1)(e.terminalMatchCallbacks,r,(0,ko.curry)(3,n))}function Xrn(e,r,n){(0,Vf.ListMapping$2__Add_5BDDA1)(e.ruleCallbacks,r,(0,ko.curry)(3,n))}function Zrn(e,r,n){(0,Vf.ListMapping$2__Add_5BDDA1)(e.stateTransformers,r,(0,ko.curry)(2,n))}function $rn(e,r){e.errorStateTransformer.push((0,ko.curry)(2,r))}function f4(e,r){var n;n=e.maxGlobalEditDist,(n==null||r.EditDistance<=n)&&((0,Vf.PriorityQueue$2__Enqueue_5BDDA1)(e.queue,r,[r.Cost,e.tieBreaker]),e.tieBreaker=e.tieBreaker-1|0)}function enn(e,r,n){var a=function(u,t,d){e:for(;;){var s=u,c=t,l=d;if((0,ai.isEmpty)(c))return s;if(l<=0)return s;if((0,ai.isEmpty)(c))throw new Error("Match failure");u=(0,ai.cons)((0,jl.Token__get_Symbol)((0,ai.head)(c)),s),t=(0,ai.tail)(c),d=l-1;continue e;break}};return a((0,ai.empty)(),r,n)}function YDe(e,r,n){var a=function(d,s,c){e:for(;;){var l=d,f=s,p=c;if((0,ai.isEmpty)(p))return f;d=l+1,s=(0,ai.cons)(new jl.StackElement((0,ai.head)(p),new jl.SymbolSource(n,l)),f),c=(0,ai.tail)(p);continue e;break}},o=e.config.Rules[n],u=r.Stack;if((0,ai.isEmpty)(u))throw new Error("empty stack");return new jl.State$1(r.Input,a(0,(0,ai.tail)(u),o),r.MatchedTokens,r.Cost,r.EditDistance,(0,Vf.someOptionOr)(r.Backtrack,r),r,r.Context)}function rnn(e,r,n){e:for(;;){var a=e,o=r,u=n;if((0,ai.isEmpty)(u))return o;if((0,Oue.FSharpSet__Contains)(a.config.ReliableTerminals,(0,jl.Token__get_Symbol)((0,ai.head)(u).Token)))return o;if((0,ai.isEmpty)(u))throw new Error("Match failure");var t=(0,ai.head)(u);if((0,ko.equals)((0,jl.Token__get_MetaInfo)(t.Token).ModifyStatus,new jl.ModifyStatus(2)))return;e=a,r=(0,ai.cons)(t.Token,o),n=(0,ai.tail)(u);continue e;break}}function nnn(e,r,n,a){var o=function(d,s){e:for(;;){var c=d,l=s;if((0,ai.isEmpty)(l))return[(0,ai.reverse)(c),l];if((0,Oue.FSharpSet__Contains)(e.config.ReliableTerminals,(0,jl.Token__get_Symbol)((0,ai.head)(l))))return[(0,ai.reverse)(c),l];if((0,ai.isEmpty)(l))throw new Error("Match failure");d=(0,ai.cons)((0,ai.head)(l),c),s=(0,ai.tail)(l);continue e;break}},u=function(d,s,c){e:for(;;){var l=d,f=s,p=c;if(f<=0)return[(0,ai.reverse)(l),p];if((0,ai.isEmpty)(p))throw new Error("not enough input");var m=o((0,ai.empty)(),p),v=m[1],h=void 0;if(!(0,ai.isEmpty)(v))h=[(0,ai.head)(v),(0,ai.tail)(v)];else throw new Error("not enough input");d=(0,ai.cons)(new jl.Observed(h[0],m[0],f===a&&(a>1||n-0<5e-324)?(0,Vf.minElement)(e.config.TerminalWeights.values()):void 0),l),s=f-1,c=h[1];continue e;break}};return u((0,ai.empty)(),a,r)}function HDe(e,r,n){return new jl.StackElement(r,n)}function tnn(e,r,n){return(0,Zo.delay)(function(){var a=r,o=1;return(0,Zo.enumerateWhile)(function(){return o<=e.maxBacktrack&&a!=null},(0,Zo.delay)(function(){var u=(0,Urn.value)(a),t=rnn(e,u.Input,u.MatchedTokens);if(t!=null){var d=t,s=(0,Vf.optionOr)(u.Backtrack,u),c=u.Cost-s.Cost,l=u.EditDistance-s.EditDistance,f=nnn(e,d,l,o),p,m=e.maxGlobalEditDist;return p=m==null?e.maxLocalEditDist:m-s.EditDistance-l,(0,Zo.append)(p>0?(0,Zo.map)(function(v){return new jl.State$1((0,ai.append)(v.Output,f[1]),s.Stack,s.MatchedTokens,s.Cost+v.EditDistance+c,s.EditDistance+v.EditDistance+l,void 0,s.Parent,s.Context)},(0,Aue.DistanceRepairSearcher__Search_Z297C2F74)(e.searcher,s.Stack,f[0],p,n)):(0,Zo.empty)(),(0,Zo.delay)(function(){return a=s.Parent,o=o+1|0,(0,Zo.empty)()}))}else return a=void 0,(0,Zo.empty)()}))})}function JDe(e,r){var n=!1,a=r.Stack;if(!(0,ai.isEmpty)(a)){var o=(0,ai.head)(a),u=(0,ko.getEnumerator)([new ib(0,o.Symbol),new ib(1,o.Source)]);try{for(;u["System.Collections.IEnumerator.MoveNext"]();){var t=(0,ko.getEnumerator)((0,Vf.ListMapping$2__Get_2B595)(e.stateTransformers,u["System.Collections.Generic.IEnumerator`1.get_Current"]()));try{for(;t["System.Collections.IEnumerator.MoveNext"]();){var d=(0,ko.getEnumerator)(t["System.Collections.Generic.IEnumerator`1.get_Current"]()(r)(e.this.contents));try{for(;d["System.Collections.IEnumerator.MoveNext"]();){var s=d["System.Collections.Generic.IEnumerator`1.get_Current"]();n=!0,f4(e,s)}}finally{(0,ko.disposeSafe)(d)}}}finally{(0,ko.disposeSafe)(t)}}}finally{(0,ko.disposeSafe)(u)}}n||f4(e,r)}function ann(e,r,n,a,o){var u=(0,ko.getEnumerator)([new ib(0,r.Symbol),new ib(1,r.Source)]);try{for(;u["System.Collections.IEnumerator.MoveNext"]();){var t=(0,ko.getEnumerator)((0,Vf.ListMapping$2__Get_2B595)(e.terminalMatchCallbacks,u["System.Collections.Generic.IEnumerator`1.get_Current"]()));try{for(;t["System.Collections.IEnumerator.MoveNext"]();)t["System.Collections.Generic.IEnumerator`1.get_Current"]()(n)(a)(o)}finally{(0,ko.disposeSafe)(t)}}}finally{(0,ko.disposeSafe)(u)}}function inn(e,r,n,a,o,u){var t=new jl.State$1(a,u,(0,ai.cons)(new jl.MatchedToken(n,o.Source),r.MatchedTokens),r.Cost,r.EditDistance,(0,Oue.FSharpSet__Contains)(e.config.ReliableTerminals,(0,jl.Token__get_Symbol)(n))?void 0:(0,Vf.someOptionOr)(r.Backtrack,r),r,r.Context);ann(e,o,r,t,n),JDe(e,t)}function onn(e,r,n,a,o){var u=(0,ko.getEnumerator)([new ib(0,r.Symbol),new ib(1,r.Source)]);try{for(;u["System.Collections.IEnumerator.MoveNext"]();){var t=(0,ko.getEnumerator)((0,Vf.ListMapping$2__Get_2B595)(e.ruleCallbacks,u["System.Collections.Generic.IEnumerator`1.get_Current"]()));try{for(;t["System.Collections.IEnumerator.MoveNext"]();)t["System.Collections.Generic.IEnumerator`1.get_Current"]()(n)(a)(o)}finally{(0,ko.disposeSafe)(t)}}}finally{(0,ko.disposeSafe)(u)}}function unn(e,r,n,a){var o=YDe(e,r,n);onn(e,a,r,o,n),JDe(e,o)}function snn(e,r,n){var a,o=0;if(a=[(0,jDe.tryGetValue)(e.config.NumLaTable,r.Symbol,new uW.FSharpRef(function(){return o},function(d){o=d|0})),o],a[0]){var u,t=0;return u=[(0,jDe.tryGetValue)(e.config.LLTable,[r.Symbol,enn(e,n,a[1])],new uW.FSharpRef(function(){return t},function(d){t=d|0})),t],u[0]?u[1]:void 0}else return}function lnn(e,r,n){var a,o,u,t,d;if(a=r.Stack,(0,ai.isEmpty)(a)?!0:(o=(0,ai.head)(a),u=r.Input,(0,ai.isEmpty)(u)?!0:(t=(0,ai.head)(u),o.Symbol===(0,jl.Token__get_Symbol)(t)?(inn(e,r,t,(0,ai.tail)(u),o,(0,ai.tail)(a)),!1):(d=snn(e,o,r.Input),d==null?!0:(unn(e,r,d,o),!1))))){var s=[],c=(0,ko.getEnumerator)(e.errorStateTransformer);try{for(;c["System.Collections.IEnumerator.MoveNext"]();){var l=(0,ko.getEnumerator)(c["System.Collections.Generic.IEnumerator`1.get_Current"]()(r)(e.this.contents));try{for(;l["System.Collections.IEnumerator.MoveNext"]();){var f=l["System.Collections.Generic.IEnumerator`1.get_Current"](),p=f[0];if(f[1])(0,Grn.contains)(p,s,{Equals:ko.equals,GetHashCode:ko.safeHash})||s.push(p);else if(!(0,ko.equals)(p,r))f4(e,p);else throw new Error("transformed State is same as error state")}}finally{(0,ko.disposeSafe)(l)}}}finally{(0,ko.disposeSafe)(c)}e.errorStateTransformer.length===0&&s.push(r);var m=(0,ko.getEnumerator)(s);try{for(;m["System.Collections.IEnumerator.MoveNext"]();){var v=(0,ko.getEnumerator)(tnn(e,m["System.Collections.Generic.IEnumerator`1.get_Current"](),n));try{for(;v["System.Collections.IEnumerator.MoveNext"]();)f4(e,v["System.Collections.Generic.IEnumerator`1.get_Current"]())}finally{(0,ko.disposeSafe)(v)}}}finally{(0,ko.disposeSafe)(m)}}}function cnn(e,r){var n=(0,ko.getEnumerator)(e.initCallbacks);try{for(;n["System.Collections.IEnumerator.MoveNext"]();)n["System.Collections.Generic.IEnumerator`1.get_Current"]()(r)}finally{(0,ko.disposeSafe)(n)}}function dnn(e){(0,Vf.PriorityQueue$2__Clear)(e.queue),(0,Aue.DistanceRepairSearcher__ClearQueue)(e.searcher)}function fnn(e,r,n){return(0,Zo.delay)(function(){return(0,Zo.append)((e.inSearch&&function(){throw new Error("Parse called second time, without first call done")}(),(0,Zo.empty)()),(0,Zo.delay)(function(){e.inSearch=!0,dnn(e);var a=new jl.State$1(r,(0,ai.ofArray)([HDe(e,e.config.Start,jl.defaultSymbolSource),HDe(e,e.config.End,jl.defaultSymbolSource)]),(0,ai.empty)(),0,0,void 0,void 0,void 0);return cnn(e,a),f4(e,a),(0,Zo.append)((0,Zo.enumerateWhile)(function(){return(0,Vf.PriorityQueue$2__get_NonEmpty)(e.queue)&&!n["Microsoft.ProgramSynthesis.Repair.Framework.ParseState.FrameworkCancellationToken.get_IsCancellationRequested"]()},(0,Zo.delay)(function(){var o=(0,Vf.PriorityQueue$2__Dequeue)(e.queue)[0];return(0,jl.State$1__get_IsDone)(o)?(0,Zo.singleton)(new jl.RepairResult((0,Zo.toArray)((0,Zo.map)(function(u){return u.Token},(0,ai.reverse)(o.MatchedTokens))),o.EditDistance,o.Cost)):(lnn(e,o,n),(0,Zo.empty)())})),(0,Zo.delay)(function(){return e.inSearch=!1,(0,Zo.empty)()}))}))})}});var XDe=Y(sW=>{_();Object.defineProperty(sW,"__esModule",{value:!0});sW.fncArities=void 0;var pnn=new Map([["COUNT",[1,2147483647]],["IF",[2,3]],["ISNA",[1,1]],["ISERROR",[1,1]],["SUM",[1,2147483647]],["AVERAGE",[1,2147483647]],["MIN",[1,2147483647]],["MAX",[1,2147483647]],["ROW",[0,1]],["COLUMN",[0,1]],["NA",[0,0]],["NPV",[2,2147483647]],["STDEV",[1,2147483647]],["DOLLAR",[1,2]],["FIXED",[1,3]],["SIN",[1,1]],["COS",[1,1]],["TAN",[1,1]],["ATAN",[1,1]],["PI",[0,0]],["SQRT",[1,1]],["EXP",[1,1]],["LN",[1,1]],["LOG10",[1,1]],["ABS",[1,1]],["INT",[1,1]],["SIGN",[1,1]],["ROUND",[2,2]],["LOOKUP",[2,3]],["INDEX",[2,4]],["REPT",[2,2]],["MID",[3,3]],["LEN",[1,1]],["VALUE",[1,1]],["TRUE",[0,0]],["FALSE",[0,0]],["AND",[1,2147483647]],["OR",[1,2147483647]],["NOT",[1,1]],["MOD",[2,2]],["DCOUNT",[3,3]],["DSUM",[3,3]],["DAVERAGE",[3,3]],["DMIN",[3,3]],["DMAX",[3,3]],["DSTDEV",[3,3]],["VAR",[1,2147483647]],["DVAR",[3,3]],["TEXT",[2,2]],["LINEST",[1,4]],["TREND",[1,4]],["LOGEST",[1,4]],["GROWTH",[1,4]],["GOTO",[1,1]],["HALT",[0,1]],["RETURN",[0,1]],["PV",[3,5]],["FV",[3,5]],["NPER",[3,5]],["PMT",[3,5]],["RATE",[3,6]],["MIRR",[3,3]],["IRR",[1,2]],["RAND",[0,0]],["MATCH",[2,3]],["DATE",[3,3]],["TIME",[3,3]],["DAY",[1,1]],["MONTH",[1,1]],["YEAR",[1,1]],["WEEKDAY",[1,2]],["HOUR",[1,1]],["MINUTE",[1,1]],["SECOND",[1,1]],["NOW",[0,0]],["AREAS",[1,1]],["ROWS",[1,1]],["COLUMNS",[1,1]],["OFFSET",[3,5]],["ABSREF",[2,2]],["RELREF",[2,2]],["ARGUMENT",[0,3]],["SEARCH",[2,3]],["TRANSPOSE",[1,1]],["ERROR",[0,2]],["STEP",[0,0]],["TYPE",[1,1]],["ECHO",[0,1]],["SET_NAME",[1,2]],["CALLER",[0,0]],["DEREF",[1,1]],["WINDOWS",[0,2]],["SERIES",[4,5]],["DOCUMENTS",[0,2]],["ACTIVE_CELL",[0,0]],["SELECTION",[0,0]],["RESULT",[0,1]],["ATAN2",[2,2]],["ASIN",[1,1]],["ACOS",[1,1]],["CHOOSE",[2,2147483647]],["HLOOKUP",[3,4]],["VLOOKUP",[3,4]],["LINKS",[0,2]],["INPUT",[1,7]],["ISREF",[1,1]],["GET_FORMULA",[1,1]],["GET_NAME",[1,2]],["SET_VALUE",[2,2]],["LOG",[1,2]],["EXEC",[1,4]],["CHAR",[1,1]],["LOWER",[1,1]],["UPPER",[1,1]],["PROPER",[1,1]],["LEFT",[1,2]],["RIGHT",[1,2]],["EXACT",[2,2]],["TRIM",[1,1]],["REPLACE",[4,4]],["SUBSTITUTE",[3,4]],["CODE",[1,1]],["NAMES",[0,3]],["DIRECTORY",[0,1]],["FIND",[2,3]],["CELL",[1,2]],["ISERR",[1,1]],["ISTEXT",[1,1]],["ISNUMBER",[1,1]],["ISBLANK",[1,1]],["T",[1,1]],["N",[1,1]],["FOPEN",[1,2]],["FCLOSE",[1,1]],["FSIZE",[1,1]],["FREADLN",[1,1]],["FREAD",[2,2]],["FWRITELN",[2,2]],["FWRITE",[2,2]],["FPOS",[1,2]],["DATEVALUE",[1,1]],["TIMEVALUE",[1,1]],["SLN",[3,3]],["SYD",[4,4]],["DDB",[4,5]],["GET_DEF",[1,3]],["REFTEXT",[1,2]],["TEXTREF",[1,2]],["INDIRECT",[1,2]],["REGISTER",[1,2147483647]],["CALL",[1,2147483647]],["ADD_BAR",[0,1]],["ADD_MENU",[2,4]],["ADD_COMMAND",[3,5]],["ENABLE_COMMAND",[4,5]],["CHECK_COMMAND",[4,5]],["RENAME_COMMAND",[4,5]],["SHOW_BAR",[0,1]],["DELETE_MENU",[2,3]],["DELETE_COMMAND",[3,4]],["GET_CHART_ITEM",[1,3]],["DIALOG_BOX",[1,1]],["CLEAN",[1,1]],["MDETERM",[1,1]],["MINVERSE",[1,1]],["MMULT",[2,2]],["FILES",[0,2]],["IPMT",[4,6]],["PPMT",[4,6]],["COUNTA",[1,2147483647]],["CANCEL_KEY",[0,2]],["FOR",[3,4]],["WHILE",[1,1]],["BREAK",[0,0]],["NEXT",[0,0]],["INITIATE",[2,2]],["REQUEST",[2,2]],["POKE",[3,3]],["EXECUTE",[2,2]],["TERMINATE",[1,1]],["RESTART",[0,1]],["HELP",[0,1]],["GET_BAR",[0,4]],["PRODUCT",[1,2147483647]],["FACT",[1,1]],["GET_CELL",[1,2]],["GET_WORKSPACE",[1,1]],["GET_WINDOW",[1,2]],["GET_DOCUMENT",[1,2]],["DPRODUCT",[3,3]],["ISNONTEXT",[1,1]],["GET_NOTE",[0,3]],["NOTE",[0,4]],["STDEVP",[1,2147483647]],["VARP",[1,2147483647]],["DSTDEVP",[3,3]],["DVARP",[3,3]],["TRUNC",[1,2]],["ISLOGICAL",[1,1]],["DCOUNTA",[3,3]],["DELETE_BAR",[1,1]],["UNREGISTER",[1,1]],["USDOLLAR",[1,2]],["FINDB",[2,3]],["SEARCHB",[2,3]],["REPLACEB",[4,4]],["LEFTB",[1,2]],["RIGHTB",[1,2]],["MIDB",[3,3]],["LENB",[1,1]],["ROUNDUP",[2,2]],["ROUNDDOWN",[2,2]],["ASC",[1,1]],["DBCS",[1,1]],["RANK",[2,3]],["ADDRESS",[2,5]],["DAYS360",[2,3]],["TODAY",[0,0]],["VDB",[5,7]],["ELSE",[0,0]],["ELSE_IF",[1,1]],["END_IF",[0,0]],["FOR_CELL",[1,3]],["MEDIAN",[1,2147483647]],["SUMPRODUCT",[1,2147483647]],["SINH",[1,1]],["COSH",[1,1]],["TANH",[1,1]],["ASINH",[1,1]],["ACOSH",[1,1]],["ATANH",[1,1]],["DGET",[3,3]],["CREATE_OBJECT",[2,11]],["VOLATILE",[0,1]],["LAST_ERROR",[0,0]],["CUSTOM_UNDO",[0,2]],["CUSTOM_REPEAT",[0,3]],["FORMULA_CONVERT",[2,5]],["GET_LINK_INFO",[2,4]],["TEXT_BOX",[1,4]],["INFO",[1,1]],["GROUP",[0,0]],["GET_OBJECT",[1,5]],["DB",[4,5]],["PAUSE",[0,1]],["RESUME",[0,1]],["FREQUENCY",[2,2]],["ADD_TOOLBAR",[0,2]],["DELETE_TOOLBAR",[1,1]],["_UDF",[1,2147483647]],["RESET_TOOLBAR",[1,1]],["EVALUATE",[1,1]],["GET_TOOLBAR",[1,2]],["GET_TOOL",[1,3]],["SPELLING_CHECK",[1,3]],["ERROR_TYPE",[1,1]],["APP_TITLE",[0,1]],["WINDOW_TITLE",[0,1]],["SAVE_TOOLBAR",[0,2]],["ENABLE_TOOL",[3,3]],["PRESS_TOOL",[3,3]],["REGISTER_ID",[2,3]],["GET_PROJECT",[1,2]],["AVEDEV",[1,2147483647]],["BETADIST",[3,5]],["GAMMALN",[1,1]],["BETAINV",[3,5]],["BINOMDIST",[4,4]],["CHIDIST",[2,2]],["CHIINV",[2,2]],["COMBIN",[2,2]],["CONFIDENCE",[3,3]],["CRITBINOM",[3,3]],["EVEN",[1,1]],["EXPONDIST",[3,3]],["FDIST",[3,3]],["FINV",[3,3]],["FISHER",[1,1]],["FISHERINV",[1,1]],["FLOOR",[2,2]],["GAMMADIST",[4,4]],["GAMMAINV",[3,3]],["CEILING",[2,2]],["HYPGEOMDIST",[4,4]],["LOGNORMDIST",[3,3]],["LOGINV",[3,3]],["NEGBINOMDIST",[3,3]],["NORMDIST",[4,4]],["NORMSDIST",[1,1]],["NORMINV",[3,3]],["NORMSINV",[1,1]],["STANDARDIZE",[3,3]],["ODD",[1,1]],["PERMUT",[2,2]],["POISSON",[3,3]],["TDIST",[3,3]],["WEIBULL",[4,4]],["SUMXMY2",[2,2]],["SUMX2MY2",[2,2]],["SUMX2PY2",[2,2]],["CHITEST",[2,2]],["CORREL",[2,2]],["COVAR",[2,2]],["FORECAST",[3,3]],["FTEST",[2,2]],["INTERCEPT",[2,2]],["PEARSON",[2,2]],["RSQ",[2,2]],["STEYX",[2,2]],["SLOPE",[2,2]],["TTEST",[4,4]],["PROB",[3,4]],["DEVSQ",[1,2147483647]],["GEOMEAN",[1,2147483647]],["HARMEAN",[1,2147483647]],["SUMSQ",[1,2147483647]],["KURT",[1,2147483647]],["SKEW",[1,2147483647]],["ZTEST",[2,3]],["LARGE",[2,2]],["SMALL",[2,2]],["QUARTILE",[2,2]],["PERCENTILE",[2,2]],["PERCENTRANK",[2,3]],["MODE",[1,2147483647]],["TRIMMEAN",[2,2]],["TINV",[2,2]],["MOVIE_COMMAND",[3,4]],["GET_MOVIE",[2,3]],["CONCATENATE",[1,2147483647]],["POWER",[2,2]],["SPREADBASE_DATA_FIELD",[2,9]],["GET_VIEW",[1,2]],["GET_FIELD",[1,3]],["GET_ITEM",[1,4]],["RADIANS",[1,1]],["DEGREES",[1,1]],["SUBTOTAL",[2,2147483647]],["SUMIF",[2,3]],["COUNTIF",[2,2]],["COUNTBLANK",[1,1]],["SCENARIO_GET",[1,2]],["OPTIONS_LISTS",[1,1]],["ISPMT",[4,4]],["DATEDIF",[3,3]],["DATESTRING",[1,1]],["NUMBERSTRING",[2,2]],["ROMAN",[1,2]],["OPENDIALOG",[0,4]],["SAVEDIALOG",[0,5]],["VIEW_GET",[1,2]],["GETPIVOTDATA",[2,2147483647]],["HYPERLINK",[1,2]],["FURIGANA",[1,1]],["AVERAGEA",[1,2147483647]],["MAXA",[1,2147483647]],["MINA",[1,2147483647]],["STDEVPA",[1,2147483647]],["VARPA",[1,2147483647]],["STDEVA",[1,2147483647]],["VARA",[1,2147483647]],["BAHTTEXT",[1,1]],["THAIDOW",[1,1]],["THAIDIGIT",[1,1]],["THAIMOY",[1,1]],["THAINUMSOUND",[1,1]],["THAINUMSTRING",[1,1]],["THAISTRINGLENGTH",[1,1]],["ISTHAIDIGIT",[1,1]],["ROUNDBAHTDOWN",[1,1]],["ROUNDBAHTUP",[1,1]],["THAIYEAR",[1,1]],["RTD",[3,2147483647]],["CUBEVALUE",[1,2147483647]],["CUBEMEMBER",[2,3]],["CUBEMEMBERPROPERTY",[3,3]],["CUBERANKEDMEMBER",[3,4]],["HEX2BIN",[1,2]],["HEX2DEC",[1,1]],["HEX2OCT",[1,2]],["DEC2BIN",[1,2]],["DEC2HEX",[1,2]],["DEC2OCT",[1,2]],["OCT2BIN",[1,2]],["OCT2HEX",[1,2]],["OCT2DEC",[1,1]],["BIN2DEC",[1,1]],["BIN2OCT",[1,2]],["BIN2HEX",[1,2]],["IMSUB",[2,2]],["IMDIV",[2,2]],["IMPOWER",[2,2]],["IMABS",[1,1]],["IMSQRT",[1,1]],["IMLN",[1,1]],["IMLOG2",[1,1]],["IMLOG10",[1,1]],["IMSIN",[1,1]],["IMCOS",[1,1]],["IMEXP",[1,1]],["IMARGUMENT",[1,1]],["IMCONJUGATE",[1,1]],["IMAGINARY",[1,1]],["IMREAL",[1,1]],["COMPLEX",[2,3]],["IMSUM",[1,2147483647]],["IMPRODUCT",[1,2147483647]],["SERIESSUM",[4,4]],["FACTDOUBLE",[1,1]],["SQRTPI",[1,1]],["QUOTIENT",[2,2]],["DELTA",[1,2]],["GESTEP",[1,2]],["ISEVEN",[1,1]],["ISODD",[1,1]],["MROUND",[2,2]],["ERF",[1,2]],["ERFC",[1,1]],["BESSELJ",[2,2]],["BESSELK",[2,2]],["BESSELY",[2,2]],["BESSELI",[2,2]],["XIRR",[2,3]],["XNPV",[3,3]],["PRICEMAT",[5,6]],["YIELDMAT",[5,6]],["INTRATE",[4,5]],["RECEIVED",[4,5]],["DISC",[4,5]],["PRICEDISC",[4,5]],["YIELDDISC",[4,5]],["TBILLEQ",[3,3]],["TBILLPRICE",[3,3]],["TBILLYIELD",[3,3]],["PRICE",[6,7]],["YIELD",[6,7]],["DOLLARDE",[2,2]],["DOLLARFR",[2,2]],["NOMINAL",[2,2]],["EFFECT",[2,2]],["CUMPRINC",[6,6]],["CUMIPMT",[6,6]],["EDATE",[2,2]],["EOMONTH",[2,2]],["YEARFRAC",[2,3]],["COUPDAYBS",[3,4]],["COUPDAYS",[3,4]],["COUPDAYSNC",[3,4]],["COUPNCD",[3,4]],["COUPNUM",[3,4]],["COUPPCD",[3,4]],["DURATION",[5,6]],["MDURATION",[5,6]],["ODDLPRICE",[7,8]],["ODDLYIELD",[7,8]],["ODDFPRICE",[8,9]],["ODDFYIELD",[8,9]],["RANDBETWEEN",[2,2]],["WEEKNUM",[1,2]],["AMORDEGRC",[6,7]],["AMORLINC",[6,7]],["CONVERT",[3,3]],["ACCRINT",[6,8]],["ACCRINTM",[4,5]],["WORKDAY",[2,3]],["NETWORKDAYS",[2,3]],["GCD",[1,2147483647]],["MULTINOMIAL",[1,2147483647]],["LCM",[1,2147483647]],["FVSCHEDULE",[2,2]],["CUBEKPIMEMBER",[3,4]],["CUBESET",[2,5]],["CUBESETCOUNT",[1,1]],["IFERROR",[2,2]],["COUNTIFS",[2,2147483647]],["SUMIFS",[3,2147483647]],["AVERAGEIF",[2,3]],["AVERAGEIFS",[3,2147483647]],["AGGREGATE",[3,2147483647]],["BINOM_DIST",[4,4]],["BINOM_INV",[3,3]],["CONFIDENCE_NORM",[3,3]],["CONFIDENCE_T",[3,3]],["CHISQ_TEST",[2,2]],["F_TEST",[2,2]],["COVARIANCE_P",[2,2]],["COVARIANCE_S",[2,2]],["EXPON_DIST",[3,3]],["GAMMA_DIST",[4,4]],["GAMMA_INV",[3,3]],["MODE_MULT",[1,2147483647]],["MODE_SNGL",[1,2147483647]],["NORM_DIST",[4,4]],["NORM_INV",[3,3]],["PERCENTILE_EXC",[2,2]],["PERCENTILE_INC",[2,2]],["PERCENTRANK_EXC",[2,3]],["PERCENTRANK_INC",[2,3]],["POISSON_DIST",[3,3]],["QUARTILE_EXC",[2,2]],["QUARTILE_INC",[2,2]],["RANK_AVG",[2,3]],["RANK_EQ",[2,3]],["STDEV_S",[1,2147483647]],["STDEV_P",[1,2147483647]],["T_DIST",[3,3]],["T_DIST_2T",[2,2]],["T_DIST_RT",[2,2]],["T_INV",[2,2]],["T_INV_2T",[2,2]],["VAR_S",[1,2147483647]],["VAR_P",[1,2147483647]],["WEIBULL_DIST",[4,4]],["NETWORKDAYS_INTL",[2,4]],["WORKDAY_INTL",[2,4]],["ECMA_CEILING",[2,2]],["ISO_CEILING",[1,2]],["BETA_DIST",[4,6]],["BETA_INV",[3,5]],["CHISQ_DIST",[3,3]],["CHISQ_DIST_RT",[2,2]],["CHISQ_INV",[2,2]],["CHISQ_INV_RT",[2,2]],["F_DIST",[4,4]],["F_DIST_RT",[3,3]],["F_INV",[3,3]],["F_INV_RT",[3,3]],["HYPGEOM_DIST",[5,5]],["LOGNORM_DIST",[4,4]],["LOGNORM_INV",[3,3]],["NEGBINOM_DIST",[4,4]],["NORM_S_DIST",[2,2]],["NORM_S_INV",[1,1]],["T_TEST",[4,4]],["Z_TEST",[2,3]],["ERF_PRECISE",[1,1]],["ERFC_PRECISE",[1,1]],["GAMMALN_PRECISE",[1,1]],["CEILING_PRECISE",[1,2]],["FLOOR_PRECISE",[1,2]],["ACOT",[1,1]],["ACOTH",[1,1]],["COT",[1,1]],["COTH",[1,1]],["CSC",[1,1]],["CSCH",[1,1]],["SEC",[1,1]],["SECH",[1,1]],["IMTAN",[1,1]],["IMCOT",[1,1]],["IMCSC",[1,1]],["IMCSCH",[1,1]],["IMSEC",[1,1]],["IMSECH",[1,1]],["BITAND",[2,2]],["BITOR",[2,2]],["BITXOR",[2,2]],["BITLSHIFT",[2,2]],["BITRSHIFT",[2,2]],["PERMUTATIONA",[2,2]],["COMBINA",[2,2]],["XOR",[1,2147483647]],["PDURATION",[3,3]],["BASE",[2,3]],["DECIMAL",[2,2]],["DAYS",[2,2]],["BINOM_DIST_RANGE",[3,4]],["GAMMA",[1,1]],["SKEW_P",[1,2147483647]],["GAUSS",[1,1]],["PHI",[1,1]],["RRI",[3,3]],["UNICHAR",[1,1]],["UNICODE",[1,1]],["MUNIT",[1,1]],["ARABIC",[1,1]],["ISOWEEKNUM",[1,1]],["NUMBERVALUE",[1,3]],["SHEET",[0,1]],["SHEETS",[0,1]],["FORMULATEXT",[1,1]],["ISFORMULA",[1,1]],["IFNA",[2,2]],["CEILING_MATH",[1,3]],["FLOOR_MATH",[1,3]],["IMSINH",[1,1]],["IMCOSH",[1,1]],["FILTERXML",[2,2]],["WEBSERVICE",[1,1]],["ENCODEURL",[1,1]],["FORECAST_ETS",[3,6]],["FORECAST_ETS_CONFINT",[3,7]],["FORECAST_ETS_SEASONALITY",[2,4]],["FORECAST_LINEAR",[3,3]],["FORECAST_ETS_STAT",[3,6]],["MAXIFS",[3,2147483647]],["MINIFS",[3,2147483647]],["TEXTJOIN",[3,2147483647]],["CONCAT",[1,2147483647]],["IFS",[2,2147483647]],["SWITCH",[3,2147483647]],["SINGLE",[1,1]],["AVERAGE_WEIGHTED",[2,2147483647]],["ANCHORARRAY",[1,1]],["_FV",[2,3]],["FIELDVALUE",[2,2]],["FILTER",[2,3]],["SORT",[1,4]],["UNIQUE",[1,3]],["RICHSEARCH",[2,2]],["LARGEPROPERTY",[3,3]],["SMALLPROPERTY",[3,3]],["AVERAGEPROPERTY",[2,2147483647]],["FINDN",[2,5]],["TEXTSLICE",[1,3]],["TEXTBEFORE",[2,4]],["TEXTAFTER",[2,4]],["TEXTSPLIT",[2,4]],["_SORT",[1,4]],["_ONEDARRAY",[2,2]],["XMATCH",[2,4]],["XLOOKUP",[3,6]],["SORTBY",[2,2147483647]],["RANDARRAY",[0,5]],["SEQUENCE",[1,4]],["STOCKHISTORY",[2,2147483647]],["SUBARRAY",[1,5]],["VSTACK",[1,2147483647]],["HSTACK",[1,2147483647]],["CHOOSEROWS",[2,2147483647]],["CHOOSECOLS",[2,2147483647]],["LET",[3,2147483647]],["LAMBDA",[1,2147483647]],["MAKEARRAY",[3,3]],["APPLY",[1,2147483647]],["ISLAMBDA",[1,1]],["ARITY",[1,1]],["RECURSE",[0,0]],["RECORD",[3,2147483647]],["VALUETOTEXT",[1,2]],["ARRAYTOTEXT",[1,2]],["FORMATTEDNUMBER",[2,2]],["TOCOLUMN",[1,3]],["TOROW",[1,3]],["VECTORWRAP",[2,3]],["MAP",[2,2147483647]],["REDUCE",[3,3]],["SCAN",[3,3]],["BYROW",[1,2]],["BYCOL",[1,2]],["ISMISSINGARG",[1,1]],["TESTFUNCTIONBEGIN",[0,0]],["IMAGE",[1,1]],["GRF",[1,2]],["UNIT",[2,2]],["RICHERROR",[1,2]],["COUNTER",[0,0]],["BROKENRECORD",[3,2147483647]],["FORMULABYTES",[1,1]],["FORMULACODE",[1,1]],["FORMULAHTML",[1,1]],["STREAM",[0,1]],["GETRICHERRORS",[0,1]],["DBGSTAT",[1,2]],["RICHNUMBER",[1,1]],["RICHERNUMBER",[1,1]],["DBGWRITE",[2,2]],["TEST",[1,2147483647]],["AAC",[1,2147483647]],["AWC",[1,2147483647]],["LETREC",[3,2147483647]],["NESTEDRECORD",[3,2147483647]]]);sW.fncArities=pnn});var cxe=Y(OS=>{_();var m4=An();Object.defineProperty(OS,"__esModule",{value:!0});OS.ArityInfo=void 0;OS.ArityInfo$reflection=sxe;OS.Context=void 0;OS.Context$reflection=hnn;OS.addHeuristics=Bnn;OS.defaultInsertMeta=void 0;var axe=m4(it()),ixe=m4(at()),oxe=m4(Qf()),mnn=m4(zf()),ZDe=m4(Ed()),Mue=Uc(),PN=c0(),Vn=O_(),Q0=Iy(),ua=HF(),ca=Dy(),gnn=Oy(),tI=XDe(),Bo=Fue(),$De=qF(),AS=Cc(),lW=gie(),Iue=N_(),exe=a4(),nI=mue();function uxe(e){var r=vnn();return function(){var a=(0,ZDe.default)(e),o;if(r){var u=(0,ZDe.default)(this).constructor;o=Reflect.construct(a,arguments,u)}else o=a.apply(this,arguments);return(0,mnn.default)(this,o)}}function vnn(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var cW=function(e){(0,oxe.default)(n,e);var r=uxe(n);function n(a,o){var u;return(0,ixe.default)(this,n),u=r.call(this),u.FncName=a,u.NumArgs=o|0,u}return(0,axe.default)(n)}(Mue.Record);OS.ArityInfo=cW;function sxe(){return(0,PN.record_type)("Microsoft.ProgramSynthesis.Repair.Excel.Heuristics.ArityInfo",[],cW,function(){return[["FncName",PN.string_type],["NumArgs",PN.int32_type]]})}var ob=function(e){(0,oxe.default)(n,e);var r=uxe(n);function n(a,o){var u;return(0,ixe.default)(this,n),u=r.call(this),u.LastFncName=a,u.Arities=o,u}return(0,axe.default)(n)}(Mue.Record);OS.Context=ob;function hnn(){return(0,PN.record_type)("Microsoft.ProgramSynthesis.Repair.Excel.Heuristics.Context",[],ob,function(){return[["LastFncName",(0,PN.option_type)(PN.string_type)],["Arities",(0,PN.list_type)(sxe())]]})}function Snn(e){var r=new ob(void 0,(0,Vn.empty)());e.Context=r}function ynn(e,r,n){var a;r.Context=(a=(0,Q0.value)(r.Context),new ob((0,ua.Token__get_Value)(n),a.Arities))}function Cnn(e,r,n){var a=(0,Q0.value)((0,Q0.value)(r.Context).LastFncName)+"_"+(0,ua.Token__get_Value)(n);r.Context=new ob(a,(0,Q0.value)(r.Context).Arities)}function _nn(e,r,n){var a=new cW((0,Q0.value)((0,Q0.value)(e.Context).LastFncName),0),o=new ob((0,Q0.value)(r.Context).LastFncName,(0,Vn.cons)(a,(0,Q0.value)(r.Context).Arities));r.Context=o}function Rnn(e,r,n){var a,o=(0,Q0.value)(r.Context).Arities;if(!(0,Vn.isEmpty)(o))a=(0,Vn.tail)(o);else throw new Error("no arity parent");var u=new ob((0,Q0.value)(r.Context).LastFncName,a);r.Context=u}function Tnn(e,r,n){var a,o=(0,Q0.value)(r.Context).Arities;if(!(0,Vn.isEmpty)(o))a=[(0,Vn.head)(o),(0,Vn.tail)(o)];else throw new Error("no arity info");var u=a[0],t=new cW(u.FncName,u.NumArgs+1),d=new ob((0,Q0.value)(r.Context).LastFncName,(0,Vn.cons)(t,a[1]));r.Context=d}function rxe(e,r){return(0,ca.delay)(function(){var n,a=(0,Q0.value)(e.Context).Arities;if(!(0,Vn.isEmpty)(a))n=(0,Vn.head)(a);else throw new Error("no arity info");var o,u=e.Stack;if(!(0,Vn.isEmpty)(u))o=(0,Vn.head)(u);else throw new Error("empty stack");var t,d=[0,0];return t=[(0,gnn.tryGetValue)(tI.fncArities,n.FncName.toLocaleUpperCase(),new Mue.FSharpRef(function(){return d},function(s){d=s})),d],t[0]?n.NumArgs>=t[1][1]?o.Symbol===38?(0,ca.singleton)((0,Bo.Parser$1__ExpandRule_50A4B1B0)(r,e,57)):o.Symbol===39?(0,ca.singleton)((0,Bo.Parser$1__ExpandRule_50A4B1B0)(r,e,59)):(0,ca.empty)():n.NumArgs<t[1][0]?o.Symbol===38?(0,ca.singleton)((0,Bo.Parser$1__ExpandRule_50A4B1B0)(r,e,58)):o.Symbol===39?(0,ca.singleton)((0,Bo.Parser$1__ExpandRule_50A4B1B0)(r,e,60)):(0,ca.empty)():(0,ca.singleton)(e):(0,ca.singleton)(e)})}function nxe(e,r){for(var n=e.length|0,a=r.length|0,o=(0,$De.initialize)(a+1,function(s){return s},Int32Array),u=1;u<=n;u++){var t=(0,$De.fill)(new Int32Array(a+1),0,a+1,0);t[0]=u|0;for(var d=1;d<=a;d++)t[d]=(e[u-1]===r[d-1]?o[d-1]:(0,AS.min)(AS.comparePrimitives,o[d],(0,AS.min)(AS.comparePrimitives,t[d-1],o[d-1]))+1)|0;o=t}return o[a]|0}function bnn(e,r){if((e.length===0||r.length===0)&&(e.length>0||r.length>0))return 0;if(!(e.length>0&&r.length>0))debugger;var n=e.length>r.length?[nxe(r,e),e.length]:[nxe(e,r),r.length],a=n[1]|0,o=n[0]|0;return o>=a?0:(a-o)/a}function Pnn(e,r){return(0,Vn.sortByDescending)(function(n){return n[1]},(0,Vn.filter)(function(n){return n[1]>=r},(0,ca.toList)((0,ca.delay)(function(){return(0,ca.map)(function(n){return[n,bnn(e,n)]},tI.fncArities.keys())}))),{Compare:AS.comparePrimitives})}function Enn(e){var r=0,n=void 0,a=(0,AS.getEnumerator)(tI.fncArities.keys());try{for(;a["System.Collections.IEnumerator.MoveNext"]();){var o=a["System.Collections.Generic.IEnumerator`1.get_Current"]();e.indexOf(o)===0&&o.length>r&&(n=o,r=o.length|0)}}finally{(0,AS.disposeSafe)(a)}return n}function Nnn(e,r){var n=(0,lW.match)((0,lW.create)(e),r);if(n!=null)return n[0]}function Ann(e){var r=Nnn("\\$?[a-zA-Z]+\\$?\\d+",e),n;switch(r!=null&&r===e?n=0:n=1,n){case 0:return!0;case 1:return!1}}var NS=new ua.TokenMetaInfo(!1,new ua.ModifyStatus(1));OS.defaultInsertMeta=NS;function Onn(e){if((0,ua.Token__get_Symbol)(e)===31){var r=(0,lW.match)((0,lW.create)("[A-Z]{1,4}[1-9][0-9]*$"),(0,ua.Token__get_Value)(e));if(r!=null){var n=r[0];return[(0,Iue.substring)((0,ua.Token__get_Value)(e),0,(0,ua.Token__get_Value)(e).length-n.length),n]}else return}else return}function knn(e,r,n){return(0,ca.delay)(function(){var a=r.Input,o,u,t,d;switch((0,Vn.isEmpty)(a)||(0,Vn.isEmpty)((0,Vn.tail)(a))?o=1:(0,ua.Token__get_Symbol)((0,Vn.head)((0,Vn.tail)(a)))===1&&!tI.fncArities.has((0,ua.Token__get_Value)((0,Vn.head)(a)).toLocaleUpperCase())?(o=0,u=(0,Vn.tail)(a),t=(0,Vn.head)(a),d=(0,Vn.head)((0,Vn.tail)(a))):o=1,o){case 0:{var s=Pnn((0,ua.Token__get_Value)(t).toLocaleUpperCase(),e);return(0,Vn.isEmpty)(s)?(0,ca.singleton)(r):(0,ca.append)((0,ca.collect)(function(I){var F=I[1];return(0,ca.singleton)(new ua.State$1((0,Vn.cons)((0,ua.Token_$ctor_74210AD3)(31,I[0],NS),u),r.Stack,r.MatchedTokens,r.Cost+(1-F),r.EditDistance+(1-F),r.Backtrack,r.Parent,r.Context))},s),(0,ca.delay)(function(){return(0,ca.singleton)(new ua.State$1(r.Input,r.Stack,r.MatchedTokens,r.Cost+1,r.EditDistance+1,r.Backtrack,r.Parent,r.Context))}))}case 1:{var c,l,f,p;switch((0,Vn.isEmpty)(a)||(0,Vn.isEmpty)((0,Vn.tail)(a))?c=1:(0,ua.Token__get_Symbol)((0,Vn.head)((0,Vn.tail)(a)))!==1&&!tI.fncArities.has((0,ua.Token__get_Value)((0,Vn.head)(a)))?(c=0,l=(0,Vn.tail)(a),f=(0,Vn.head)(a),p=(0,Vn.head)((0,Vn.tail)(a))):c=1,c){case 0:{var m=Enn((0,ua.Token__get_Value)(f).toLocaleUpperCase());if(m!=null){var v=m;if((0,exe.exists)(function(I){return(0,ua.Token__get_Value)(f).toLocaleUpperCase().indexOf(I)===0},(0,exe.ofSeq)(["TABLE","COLUMN"],{Compare:AS.comparePrimitives})))return(0,ca.singleton)(r);var h=(0,ua.Token__get_Value)(f).slice(v.length,(0,ua.Token__get_Value)(f).length+1);if(Ann(h)){var S=(0,ua.Token_$ctor_74210AD3)(30,h,NS),y=(0,ua.Token_$ctor_74210AD3)(1,null,NS);return(0,ca.singleton)(new ua.State$1((0,Vn.ofArrayWithTail)([(0,ua.Token_$ctor_74210AD3)(31,v,NS),y,S],l),r.Stack,r.MatchedTokens,r.Cost,r.EditDistance,r.Backtrack,r.Parent,r.Context))}else return(0,ca.singleton)(r)}else{var C=Onn(f);if(C!=null){var E=C[1];return(0,ca.append)((0,ca.singleton)(new ua.State$1((0,Vn.ofArrayWithTail)([(0,ua.Token_$ctor_74210AD3)(31,C[0],NS),(0,ua.Token_$ctor_74210AD3)(30,E,NS)],l),r.Stack,r.MatchedTokens,r.Cost,r.EditDistance,r.Backtrack,r.Parent,r.Context)),(0,ca.delay)(function(){return(0,ca.singleton)(r)}))}else return(0,ca.singleton)(r)}}case 1:return(0,ca.singleton)(r)}}}})}function lxe(e){return tI.fncArities.has(e)}function Fnn(e){if((0,ua.Token__get_Symbol)(e)===31&&(0,Iue.endsWith)((0,ua.Token__get_Value)(e),")")){var r=(0,ua.Token__get_Value)(e).indexOf(")")|0,n=(0,ua.Token__get_Value)(e).length-r|0;return[(0,Iue.substring)((0,ua.Token__get_Value)(e),0,r),n]}else return}function Inn(e,r){var n=e.Input;if((0,Vn.isEmpty)(n))return e;var a=Fnn((0,Vn.head)(n));if(a==null)return e;var o=a[1]|0;return new ua.State$1((0,Vn.append)((0,Vn.cons)((0,ua.Token_$ctor_74210AD3)(31,a[0],ua.defaultInputMeta),(0,Vn.replicate)(o,(0,ua.Token_$ctor_74210AD3)(2,null,ua.defaultInputMeta))),(0,Vn.tail)(n)),e.Stack,e.MatchedTokens,e.Cost,e.EditDistance,e.Backtrack,e.Parent,e.Context)}function Mnn(e,r){return(0,ca.delay)(function(){var n=e.Input;if((0,Vn.isEmpty)(n))return(0,ca.singleton)(e);var a=lxe((0,ua.Token__get_Value)((0,Vn.head)(n)).toLocaleUpperCase());return a?(0,ca.singleton)((0,Bo.Parser$1__ExpandRule_50A4B1B0)(r,e,74)):(0,ca.singleton)(Inn(e,r))})}function wnn(e,r){return(0,ca.delay)(function(){var n=(0,Q0.value)(e.Context).LastFncName;if(n!=null){var a=n,o=lxe(a.toLocaleUpperCase());return o?(0,ca.singleton)((0,Bo.Parser$1__ExpandRule_50A4B1B0)(r,e,37)):(0,ca.singleton)(e)}else return(0,ca.singleton)(e)})}function Dnn(e){var r,n,a,o,u;switch((0,Vn.isEmpty)(e)||(0,Vn.isEmpty)((0,Vn.tail)(e))||(0,Vn.isEmpty)((0,Vn.tail)((0,Vn.tail)(e)))?r=1:(r=0,n=(0,Vn.tail)((0,Vn.tail)((0,Vn.tail)(e))),a=(0,Vn.head)(e),o=(0,Vn.head)((0,Vn.tail)(e)),u=(0,Vn.head)((0,Vn.tail)((0,Vn.tail)(e)))),r){case 0:return[a,o,u,n];case 1:return}}function txe(e,r){return(0,ca.delay)(function(){var n=Dnn(e.Input);if(n==null)return(0,ca.singleton)(e);var a=n[2],o=n[1],u=n[3],t=[(0,ua.Token__get_Symbol)(n[0]),(0,ua.Token__get_Symbol)(o),(0,ua.Token__get_Symbol)(a)],d=(0,AS.equalArrays)(t,[23,6,25])?(0,ua.Token_$ctor_74210AD3)(22,null,NS):(0,AS.equalArrays)(t,[23,6,21])?(0,ua.Token_$ctor_74210AD3)(24,null,NS):(0,AS.equalArrays)(t,[25,6,21])?(0,ua.Token_$ctor_74210AD3)(26,null,NS):void 0;return d==null?(0,ca.singleton)(e):(0,ca.singleton)(new ua.State$1((0,Vn.cons)(d,u),e.Stack,e.MatchedTokens,e.Cost+.01,e.EditDistance+.01,e.Backtrack,e.Parent,e.Context))})}function xnn(e,r){return(0,ca.delay)(function(){var n,a=e.MatchedTokens,o;switch((0,Vn.isEmpty)(a)||(0,Vn.isEmpty)((0,Vn.tail)(a))?o=1:(n=(0,Vn.head)(a),((0,ua.Token__get_Symbol)(n.Token)===15?!0:(0,ua.Token__get_Symbol)(n.Token)===16)&&(0,ua.Token__get_Symbol)((0,Vn.head)((0,Vn.tail)(a)).Token)===30?o=0:o=1),o){case 0:{var u=e.Parent;if(u==null)return(0,ca.singleton)([e,!0]);var t=u.Backtrack;if(t==null)return(0,ca.singleton)([e,!0]);var d=t;return(0,ca.append)((0,Vn.isEmpty)((0,Q0.value)(d.Context).Arities)?(0,ca.empty)():(0,ua.Token__get_Symbol)((0,Vn.head)(e.Input))===0?(0,ca.singleton)([new ua.State$1((0,Vn.cons)((0,ua.Token_$ctor_74210AD3)(2,null,NS),e.Input),d.Stack,d.MatchedTokens,d.Cost+.1,d.EditDistance+.1,d.Backtrack,d.Parent,d.Context),!1]):(0,ca.empty)(),(0,ca.delay)(function(){return(0,ca.singleton)([new ua.State$1(e.Input,d.Stack,d.MatchedTokens,d.Cost+.01,d.EditDistance+.01,d.Backtrack,d.Parent,d.Context),!1])}))}case 1:return(0,ca.singleton)([e,!0])}})}function Lnn(e,r){return(0,ca.delay)(function(){var n=e.MatchedTokens,a;switch((0,Vn.isEmpty)(n)?a=1:(0,ua.Token__get_Symbol)((0,Vn.head)(n).Token)===21?a=0:a=1,a){case 0:{var o=e.Input,u,t,d;switch((0,Vn.isEmpty)(o)?u=1:(0,ua.Token__get_Symbol)((0,Vn.head)(o))===21?(u=0,t=(0,Vn.head)(o),d=(0,Vn.tail)(o)):u=1,u){case 0:return(0,ca.singleton)([new ua.State$1(d,e.Stack,e.MatchedTokens,e.Cost+.1,e.EditDistance+.1,e.Backtrack,e.Parent,e.Context),!1]);case 1:return(0,ca.singleton)([e,!0])}}case 1:return(0,ca.singleton)([e,!0])}})}function Bnn(e,r){var n=r??.6;(0,Bo.Parser$1__AddInitCallback_Z32A6DF7A)(e,function(a){Snn(a)}),(0,Bo.Parser$1__AddTerminalMatchCallback_ZAB15BBF)(e,new Bo.SymbolMatch(1,nI.TAG_maybe_fnc_name),function(a,o,u){ynn(a,o,u)}),(0,Bo.Parser$1__AddTerminalMatchCallback_ZAB15BBF)(e,new Bo.SymbolMatch(1,nI.TAG_maybe_fnc_dot_ident),function(a,o,u){Cnn(a,o,u)}),(0,Bo.Parser$1__AddTerminalMatchCallback_ZAB15BBF)(e,new Bo.SymbolMatch(1,nI.TAG_fnc_open_paren),function(a,o,u){_nn(a,o,u)}),(0,Bo.Parser$1__AddTerminalMatchCallback_ZAB15BBF)(e,new Bo.SymbolMatch(1,nI.TAG_fnc_closing_paren),function(a,o,u){Rnn(a,o,u)}),(0,Bo.Parser$1__AddRuleCallback_Z6A2750E6)(e,new Bo.SymbolMatch(0,37),function(a,o,u){Tnn(a,o,u)}),(0,Bo.Parser$1__AddStateTransformer_Z37DD4466)(e,new Bo.SymbolMatch(0,38),rxe),(0,Bo.Parser$1__AddStateTransformer_Z37DD4466)(e,new Bo.SymbolMatch(0,39),rxe),(0,Bo.Parser$1__AddStateTransformer_Z37DD4466)(e,new Bo.SymbolMatch(1,nI.TAG_not_builtin_fnc),Mnn),(0,Bo.Parser$1__AddStateTransformer_Z37DD4466)(e,new Bo.SymbolMatch(0,48),wnn),(0,Bo.Parser$1__AddStateTransformer_Z37DD4466)(e,new Bo.SymbolMatch(0,25),txe),(0,Bo.Parser$1__AddStateTransformer_Z37DD4466)(e,new Bo.SymbolMatch(0,23),txe),(0,Bo.Parser$1__AddStateTransformer_Z37DD4466)(e,new Bo.SymbolMatch(1,nI.TAG_maybe_fnc_name),function(a,o){return knn(n,a,o)}),(0,Bo.Parser$1__AddErrorStateTransformer_Z4C0E8FCD)(e,xnn),(0,Bo.Parser$1__AddErrorStateTransformer_Z4C0E8FCD)(e,Lnn)}});var vxe=Y(zn=>{_();var h4=An();Object.defineProperty(zn,"__esModule",{value:!0});zn.RepairOptions=void 0;zn.RepairOptions$reflection=Ntn;zn.T_Unexpected=zn.T_Sub=zn.T_StringLiteral=zn.T_Spaces=zn.T_SingleQuote=zn.T_RangeOp=zn.T_Quote=zn.T_Pow=zn.T_Percent=zn.T_ParenOpen=zn.T_ParenClose=zn.T_NumberLiteral=zn.T_Ne=zn.T_Mul=zn.T_Lt=zn.T_Le=zn.T_Ident=zn.T_Gt=zn.T_Ge=zn.T_Eq=zn.T_EOF=zn.T_Dot=zn.T_Div=zn.T_Concat=zn.T_Comma=zn.T_CellRef=zn.T_BracketOpen=zn.T_BracketClose=zn.T_BraceOpen=zn.T_BraceClose=zn.T_BooleanLiteral=zn.T_Bang=zn.T_Add=void 0;zn.newToken=Ptn;zn.niceStringOfToken=mxe;zn.repair=gxe;zn.stringOfToken=pxe;var qnn=h4(it()),Unn=h4(at()),Gnn=h4(Qf()),Knn=h4(zf()),dxe=h4(Ed()),Kc=HF(),kS=N_(),Vnn=Oy(),wue=mue(),Da=O_(),g4=Dy(),Wnn=Uc(),EN=c0(),fxe=Fue(),jnn=cxe();function Hnn(e){var r=Qnn();return function(){var a=(0,dxe.default)(e),o;if(r){var u=(0,dxe.default)(this).constructor;o=Reflect.construct(a,arguments,u)}else o=a.apply(this,arguments);return(0,Knn.default)(this,o)}}function Qnn(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var znn=1;zn.T_ParenOpen=znn;var Ynn=2;zn.T_ParenClose=Ynn;var Jnn=10;zn.T_BracketOpen=Jnn;var Xnn=9;zn.T_BracketClose=Xnn;var Znn=12;zn.T_BraceOpen=Znn;var $nn=11;zn.T_BraceClose=$nn;var etn=3;zn.T_Comma=etn;var rtn=4;zn.T_RangeOp=rtn;var ntn=5;zn.T_Bang=ntn;var ttn=6;zn.T_Spaces=ttn;var v4=7;zn.T_Quote=v4;var atn=14;zn.T_Percent=atn;var itn=15;zn.T_Add=itn;var otn=16;zn.T_Sub=otn;var utn=17;zn.T_Mul=utn;var stn=18;zn.T_Div=stn;var ltn=19;zn.T_Pow=ltn;var ctn=20;zn.T_Concat=ctn;var dtn=21;zn.T_Eq=dtn;var ftn=22;zn.T_Ne=ftn;var ptn=23;zn.T_Lt=ptn;var mtn=24;zn.T_Le=mtn;var gtn=25;zn.T_Gt=gtn;var vtn=26;zn.T_Ge=vtn;var htn=27;zn.T_BooleanLiteral=htn;var dW=28;zn.T_StringLiteral=dW;var Stn=29;zn.T_NumberLiteral=Stn;var ytn=30;zn.T_CellRef=ytn;var Ctn=31;zn.T_Ident=Ctn;var _tn=32;zn.T_Dot=_tn;var Rtn=8;zn.T_Unexpected=Rtn;var Ttn=13;zn.T_SingleQuote=Ttn;var btn=0;zn.T_EOF=btn;function Ptn(e,r){return(0,Kc.Token_$ctor_Z176EF219)(e,r)}function pxe(e){var r;if((0,kS.isNullOrWhiteSpace)((0,Kc.Token__get_Value)(e)))r="";else{var n=(0,Kc.Token__get_Value)(e);r=(0,kS.toText)((0,kS.printf)("[%s]"))(n)}var a=(0,Vnn.getItemFromDict)(wue.symbolNames,(0,Kc.Token__get_Symbol)(e));return(0,kS.toText)((0,kS.printf)("%s%s"))(a)(r)}function mxe(e){var r,n=(0,Kc.Token__get_Symbol)(e)|0;switch(n){case 1:return"(";case 2:return")";case 3:return",";case 4:return":";case 5:return"!";case 6:return(0,kS.isNullOrEmpty)((0,Kc.Token__get_Value)(e))?"":(0,Kc.Token__get_Value)(e);case 7:return'"';case 9:return"]";case 10:return"[";case 11:return"}";case 12:return"{";case 13:return"'";case 14:return"%";case 15:return"+";case 16:return"-";case 17:return"*";case 18:return"/";case 19:return"^";case 20:return"&";case 21:return"=";case 22:return"<>";case 23:return"<";case 24:return"<=";case 25:return">";case 26:return">=";case 28:return(0,kS.isNullOrEmpty)((0,Kc.Token__get_Value)(e))?"":(0,Kc.Token__get_Value)(e);case 32:return".";default:{if((0,kS.isNullOrEmpty)((0,Kc.Token__get_Value)(e)))throw new Error((r=pxe(e),(0,kS.toText)((0,kS.printf)("don't know how to nicely convert token '%s' to string"))(r)));return(0,Kc.Token__get_Value)(e)}}}function Etn(e){var r=function(o,u){e:for(;;){var t=o,d=u;if((0,Da.isEmpty)(d))throw new Error("should not happen");if((0,Kc.Token__get_Symbol)((0,Da.head)(d))===v4)return[(0,Kc.Token_$ctor_Z176EF219)(dW,(0,kS.join)("",(0,g4.map)(mxe,(0,Da.reverse)(t)))),(0,Da.head)(d),(0,Da.tail)(d)];if((0,Da.isEmpty)(d))throw new Error("Match failure");o=(0,Da.cons)((0,Da.head)(d),t),u=(0,Da.tail)(d);continue e;break}},n=function(o,u){e:for(;;){var t=o,d=u,s=void 0,c=void 0,l=void 0,f=void 0,p=void 0;switch((0,Da.isEmpty)(d)?s=0:(0,Da.isEmpty)((0,Da.tail)(d))||(0,Da.isEmpty)((0,Da.tail)((0,Da.tail)(d)))?s=2:(0,Kc.Token__get_Symbol)((0,Da.head)(d))===v4&&(0,Kc.Token__get_Symbol)((0,Da.head)((0,Da.tail)(d)))===dW&&(0,Kc.Token__get_Symbol)((0,Da.head)((0,Da.tail)((0,Da.tail)(d))))===v4?(s=1,c=(0,Da.tail)((0,Da.tail)((0,Da.tail)(d))),l=(0,Da.head)(d),f=(0,Da.head)((0,Da.tail)(d)),p=(0,Da.head)((0,Da.tail)((0,Da.tail)(d)))):s=2,s){case 0:return(0,Da.reverse)(t);case 1:{o=(0,Da.ofArrayWithTail)([p,f,l],t),u=c;continue e}case 2:{var m=void 0,v=void 0,h=void 0,S=void 0;switch((0,Da.isEmpty)(d)||(0,Da.isEmpty)((0,Da.tail)(d))?m=1:(0,Kc.Token__get_Symbol)((0,Da.head)(d))===v4&&(0,Kc.Token__get_Symbol)((0,Da.head)((0,Da.tail)(d)))!==dW?(m=0,v=(0,Da.tail)(d),h=(0,Da.head)(d),S=(0,Da.head)((0,Da.tail)(d))):m=1,m){case 0:{var y=r((0,Da.empty)(),v);o=(0,Da.ofArrayWithTail)([y[1],y[0],h],t),u=y[2];continue e}case 1:{if((0,Da.isEmpty)(d))throw new Error("Match failure");o=(0,Da.cons)((0,Da.head)(d),t),u=(0,Da.tail)(d);continue e}}}}break}};return(0,Da.toArray)(n((0,Da.empty)(),(0,Da.ofArray)(e.Tokens)))}var fW=function(e){(0,Gnn.default)(n,e);var r=Hnn(n);function n(a,o,u,t,d){var s;return(0,Unn.default)(this,n),s=r.call(this),s.Timeout=a,s.MaxBacktrack=o|0,s.MaxGlobalEditDistance=u,s.MaxLocalEditDistance=t,s.ValidateCandidateRepairs=d,s}return(0,qnn.default)(n)}(Wnn.Record);zn.RepairOptions=fW;function Ntn(){return(0,EN.record_type)("Microsoft.ProgramSynthesis.Repair.Excel.Repairer.RepairOptions",[],fW,function(){return[["Timeout",EN.float64_type],["MaxBacktrack",EN.int32_type],["MaxGlobalEditDistance",EN.float64_type],["MaxLocalEditDistance",(0,EN.option_type)(EN.float64_type)],["ValidateCandidateRepairs",EN.bool_type]]})}var Atn=new fW(1e3,1,5,5,!1);function gxe(e,r){var n=r??Atn;(0,Kc.debugParserConfig)(wue.config,!0);var a=(0,fxe.Parser$1_$ctor_654FF197)(wue.config,n.MaxGlobalEditDistance,n.MaxLocalEditDistance,n.MaxBacktrack);(0,jnn.addHeuristics)(a,void 0);var o=(0,g4.toArray)((0,g4.map)(Etn,(0,fxe.Parser$1__Parse_2AE5B288)(a,e,void 0,new Kc.CancelActionKind(1),(0,Kc.TimeoutCancellationToken_$ctor_5E38073B)(n.Timeout))));if(n.ValidateCandidateRepairs){var u=new fW(n.Timeout,0,0,0,!1);return(0,g4.toArray)((0,g4.collect)(function(t){return gxe(t,u)},o))}else return o}});var hxe=Y((dIn,S4)=>{_();var Otn=Ed();function ktn(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&(e=Otn(e),e!==null););return e}S4.exports=ktn,S4.exports.__esModule=!0,S4.exports.default=S4.exports});var Sxe=Y((pIn,zg)=>{_();var Ftn=hxe();function pW(){return typeof Reflect!="undefined"&&Reflect.get?(zg.exports=pW=Reflect.get.bind(),zg.exports.__esModule=!0,zg.exports.default=zg.exports):(zg.exports=pW=function(r,n,a){var o=Ftn(r,n);if(o){var u=Object.getOwnPropertyDescriptor(o,n);return u.get?u.get.call(arguments.length<3?r:a):u.value}},zg.exports.__esModule=!0,zg.exports.default=zg.exports),pW.apply(this,arguments)}zg.exports=pW,zg.exports.__esModule=!0,zg.exports.default=zg.exports});var yxe=Y((gIn,y4)=>{_();var Itn=dH(),Mtn=jW(),wtn=M4(),Dtn=fH();function xtn(e){return Itn(e)||Mtn(e)||wtn(e)||Dtn()}y4.exports=xtn,y4.exports.__esModule=!0,y4.exports.default=y4.exports});var Txe=Y(Rxe=>{_();var mW=Sxe(),Due=Qf(),Ltn=zf(),aI=Ed(),Cxe=yxe(),Yg=at(),Jg=it(),_i=hb(),Pc=L_(),Qe=V_(),Mr=GS();function xue(e){var r=Btn();return function(){var a=aI(e),o;if(r){var u=aI(this).constructor;o=Reflect.construct(a,arguments,u)}else o=a.apply(this,arguments);return Ltn(this,o)}}function Btn(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function da(e,r){var n=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=qtn(e))||r&&e&&typeof e.length=="number"){n&&(e=n);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function qtn(e,r){if(e){if(typeof e=="string")return _xe(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _xe(e,r)}}function _xe(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,a=new Array(r);n<r;n++)a[n]=e[n];return a}(function(){var e={1583:function(u,t){"use strict";var d,s;function c(l){return{kind:d.Success,value:l}}Object.defineProperty(t,"__esModule",{value:!0}),t.javaScriptError=t.ReasonKind=t.isSuccess=t.failure=t.successUndefined=t.success=t.ResultKind=void 0,function(l){l.Success="Success",l.Failure="Failure",l.Paused="Paused",l.Breaked="Breaked"}(d=t.ResultKind||(t.ResultKind={})),t.success=c,t.successUndefined=c(void 0),t.failure=function(l){return{kind:d.Failure,reason:l}},t.isSuccess=function(l){return l.kind===d.Success},function(l){l.JavaScriptError="JavaScriptError"}(s=t.ReasonKind||(t.ReasonKind={})),t.javaScriptError=function(l){return{kind:s.JavaScriptError,error:l}}},8908:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.anonymizeFormulaString=t.anonymizeMagnitude=t.kindAnonymizers=t.anonymize=void 0;var s=d(1071);function c(S){return S}function l(S,y){if(typeof y=="string"&&f[y]!=null)return S;var C=function(I){if(typeof I=="object"&&I!==null){var F=I.kind;if(typeof F=="string")return F}}(S),E=C!==void 0?t.kindAnonymizers[C]:void 0;return E===void 0&&(E=p[function(I){var F=typeof I;if(F==="object"){if(I===null)return"null";if(Array.isArray(I))return"Array"}return F}(S)]),E!==void 0?E(S,y):"<unexpected>"}t.anonymize=function(S){try{return String(JSON.stringify(l(S,void 0)))}catch(E){if(E==null||typeof E!="object")return"<error: ".concat(String(JSON.stringify(E)),">");var y=String(E.name),C=String(E.message);return C.indexOf(y)>=0?"<error ".concat(C,">"):"<error ".concat(y,": ").concat(C,">")}};var f={kind:!0,type:!0,index:!0,length:!0,row:!0,col:!0,rows:!0,cols:!0},p={boolean:c,symbol:function(y){return typeof y!="symbol"?"<unexpected>":"<symbol ".concat(String(y),">")},undefined:c,null:c,number:function(y){return typeof y!="number"?"<unexpected>":isFinite(y)?"<number>":y},bigint:function(y){return typeof y!="bigint"?"<unexpected>":"<bigint>"},string:function(y){return typeof y!="string"?"<unexpected>":y.length>0?"<string>":y},function:function(y){if(typeof y!="function")return"<unexpected>";var C=y.name;return typeof C=="string"&&C.length>0?"<function ".concat(C,">"):"<function>"},object:function(y){if(typeof y!="object")return"<unexpected>";var C={};for(var E in y)Object.prototype.hasOwnProperty.call(y,E)&&(C[E]=l(y[E],E));return C},Array:function(S){function y(C){return S.apply(this,arguments)}return y.toString=function(){return S.toString()},y}(function(S){return typeof S=="object"&&Array.isArray(S)?S.map(l):"<unexpected>"})};t.kindAnonymizers=Object.create(null),t.anonymizeMagnitude=function(S){var y=Math.abs(S);return y===0?-1e4:Math.floor((0,s.mathLog2)(y))};var m=new RegExp("[^=\\[\\]\\.\\\\\\/%@#\\-_\\+,;\\(\\):?\"&<>'!\\{\\}~\\^\\*$\x80\xA2\xA3\xA4\xA5\u20A0\u20A1\u20A2\u20A3\u20A4\u20A5\u20A6\u20A7\u20A8\u20A9\u20AA\u20AB\u20AC\u20AD\u20AE\u20AF\u20B0\u20B1\u20B2\u20B3\u20B4\u20B5\u20B6\u20B7\u20B8\u20B9\\s\uA0C2d]","g"),v=/[0-9]/g,h=/d/g;t.anonymizeFormulaString=function(S){return S.toLowerCase().replace(h,"w").replace(v,"d").replace(m,"w")}},1826:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.broadcastArray2D=t.broadcastArray=t.colArray2D=t.rowArray2D=t.singletonArray2D=t.constantArray2D=t.constantArray=t.array2DToJaggedArray=t.jaggedArray=t.array2DForall2=t.array2DForall=t.NonstrictSparseArray2D=t.NonstrictArray2D=t.StrictSparseArray2D=t.strictArray2D=t.StrictArray2D=void 0;var s=d(3319),c=d(995),l=function(){function y(C,E,I){(0,s.assertNatural)("calc.common.StrictArray2D",C),(0,s.assertNatural)("calc.common.StrictArray2D",E);var F=I.length;F<C&&(0,s.assertFalse)("calc.common.StrictArray2D: expected elements.length >= ".concat(C,"; given ").concat(F));for(var w=0;w<F;w+=1){var B=I[w].length;B<E&&(0,s.assertFalse)("calc.common.StrictArray2D: expected elements[".concat(w,"].length >= ").concat(C,"; given ").concat(B))}this.rows=C,this.cols=E,this.elements=I}return y.prototype.get=function(C,E){return(0,s.assertIndex)("calc.common.StrictArray2D.get",C,this.rows),(0,s.assertIndex)("calc.common.StrictArray2D.get",E,this.cols),this.elements[C][E]},y.prototype.strict=function(){return this},y.prototype.map=function(C){var E=this;return new p(this.rows,this.cols,function(I,F){return C(E.elements[I][F])})},y}();t.StrictArray2D=l,t.strictArray2D=function(y,C,E){return new l(y,C,E)};var f=function(){function y(C,E,I,F,w,B){(0,s.assertNatural)("calc.common.StrictSparseArray2D",C),(0,s.assertNatural)("calc.common.StrictSparseArray2D",E),(0,s.assertIndex)("calc.common.StrictSparseArray2D",I,C+1),(0,s.assertIndex)("calc.common.StrictSparseArray2D",F,E+1);var k=w.length;k<I&&(0,s.assertFalse)("calc.common.StrictSparseArray2D: expected elements.length >= ".concat(I,"; given ").concat(k));for(var x=0;x<k;x+=1){var G=w[x].length;G<F&&(0,s.assertFalse)("calc.common.StrictSparseArray2D: expected elements[".concat(x,"].length >= ").concat(F,"; given ").concat(G))}this.rows=C,this.cols=E,this.denseRows=I,this.denseCols=F,this.denseElements=w,this.sparseElement=B}return y.prototype.get=function(C,E){return(0,s.assertIndex)("calc.common.StrictSparseArray2D.get",C,this.rows),(0,s.assertIndex)("calc.common.StrictSparseArray2D.get",E,this.cols),C<this.denseRows&&E<this.denseCols?this.denseElements[C][E]:this.sparseElement},y.prototype.getSparse=function(){return this.sparseElement},y.prototype.strict=function(){return this},y.prototype.map=function(C){var E=this;return new m(this.rows,this.cols,this.denseRows,this.denseCols,function(I,F){return C(E.denseElements[I][F])},function(){return C(E.sparseElement)})},y}();t.StrictSparseArray2D=f;var p=function(){function y(C,E,I){(0,s.assertNatural)("calc.common.NonstrictArray2D",C),(0,s.assertNatural)("calc.common.NonstrictArray2D",E),this.rows=C,this.cols=E,this.func=I}return y.prototype.get=function(C,E){return(0,s.assertIndex)("calc.common.NonstrictArray2D.get",C,this.rows),(0,s.assertIndex)("calc.common.NonstrictArray2D.get",E,this.cols),this.func(C,E)},y.prototype.strict=function(){var C=v(this.rows,this.cols,this.func);return new l(this.rows,this.cols,C)},y.prototype.map=function(C){var E=this;return new y(this.rows,this.cols,function(I,F){return C(E.func(I,F))})},y}();t.NonstrictArray2D=p;var m=function(){function y(C,E,I,F,w,B){(0,s.assertNatural)("calc.common.NonstrictSparseArray2D",C),(0,s.assertNatural)("calc.common.NonstrictSparseArray2D",E),(0,s.assertIndex)("calc.common.NonstrictSparseArray2D",I,C+1),(0,s.assertIndex)("calc.common.NonstrictSparseArray2D",F,E+1),this.rows=C,this.cols=E,this.denseRows=I,this.denseCols=F,this.denseFunc=w,this.sparseFunc=B}return y.prototype.get=function(C,E){return(0,s.assertIndex)("calc.common.NonstrictSparseArray2D.get",C,this.rows),(0,s.assertIndex)("calc.common.NonstrictSparseArray2D.get",E,this.cols),C<this.denseRows&&E<this.denseCols?this.denseFunc(C,E):this.sparseFunc()},y.prototype.getSparse=function(){return this.sparseFunc()},y.prototype.strict=function(){var C=v(this.denseRows,this.denseCols,this.denseFunc),E=this.sparseFunc();return new f(this.rows,this.cols,this.denseRows,this.denseCols,C,E)},y.prototype.map=function(C){var E=this;return new y(this.rows,this.cols,this.denseRows,this.denseCols,function(I,F){return C(E.denseFunc(I,F))},function(){return C(E.sparseFunc())})},y}();function v(y,C,E){for(var I=[],F=0;F<y;F+=1){for(var w=[],B=0;B<C;B+=1)w[B]=E(F,B);I[F]=w}return I}function h(y,C,E){for(var I=[],F=[],w=0;w<C;w+=1)F[w]=E;for(var B=0;B<y;B+=1)I[B]=F;return I}function S(y,C,E){return new p(y,C,function(I,F){return E})}t.NonstrictSparseArray2D=m,t.array2DForall=function(y,C){for(var E=0;E<C.rows;E+=1)for(var I=0;I<C.cols;I+=1)if(!y(C.get(E,I)))return!1;return!0},t.array2DForall2=function(y,C,E){for(var I=(0,c.fastMin)(C.rows,E.rows),F=(0,c.fastMin)(C.cols,E.cols),w=0;w<I;w+=1)for(var B=0;B<F;B+=1)if(!y(C.get(w,B),E.get(w,B)))return!1;return!0},t.jaggedArray=v,t.array2DToJaggedArray=function(y){return v(y.rows,y.cols,y.get.bind(y))},t.constantArray=h,t.constantArray2D=S,t.singletonArray2D=function(y){return S(1,1,y)},t.rowArray2D=function(y){return new p(1,y.length,function(C,E){return y[E]})},t.colArray2D=function(y){return new p(y.length,1,function(C,E){return y[C]})},t.broadcastArray=function(y,C,E,I,F,w){if(y===E&&C===I)return F;if(y===1&&C===1)return h(E,I,F[0]===void 0?w:F[0][0]);var B,k=[];B=y===1?function(H,L){return L<C?F[0][L]:w}:C===1?function(H,L){return H<y?F[H][0]:w}:function(H,L){return H<y&&L<C?F[H][L]:w};for(var x=0;x<E;x+=1){k.push([]);for(var G=0;G<I;G+=1)k[x][G]=B(x,G)}return k},t.broadcastArray2D=function(y,C,E,I){return E.rows===y&&E.cols===C?E:E.rows===1&&E.cols===1?S(y,C,E.get(0,0)):E.rows===1?new p(y,C,function(F,w){return w<E.cols?E.get(0,w):I}):E.cols===1?new p(y,C,function(F,w){return F<E.rows?E.get(F,0):I}):new p(y,C,function(F,w){return F<E.rows&&w<E.cols?E.get(F,w):I})}},3319:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertIndex=t.assertPositiveInteger=t.assertNatural=t.assertInteger=t.assertTrue=t.assertFalse=t.assertNever=t.ulsLogger=void 0;var s=d(1821),c=d(8515),l=d(8908);function f(y,C){return function(E,I,F,w){if(y(E,I,F,w),!F)throw new Error("".concat(C," ").concat(E," ").concat(I," ").concat(w))}}function p(y){return{shipAssertTag:f(y.shipAssertTag.bind(y),"shipAssertTag"),assertTag:f(y.assertTag.bind(y),"assertTag"),traceTag:y.traceTag.bind(y),debugTraceTag:y.debugTraceTag.bind(y),dnmTraceTag:y.dnmTraceTag.bind(y)}}function m(y){return function(){for(var C=[],E=0;E<arguments.length;E++)C[E]=arguments[E];try{return y.apply(void 0,C)}catch(I){}}}var v=function(){function y(){this.callBufferCapacity=100,this.callBuffer=[],this.shipAssertTag=this.createBufferingCallback("shipAssertTag"),this.assertTag=this.createBufferingCallback("assertTag"),this.traceTag=this.createBufferingCallback("traceTag"),this.dnmTraceTag=this.createBufferingCallback("dnmTraceTag"),this.debugTraceTag=this.createBufferingCallback("debugTraceTag")}return y.prototype.createBufferingCallback=function(C){var E=this;return function(){for(var I=[],F=0;F<arguments.length;F++)I[F]=arguments[F];E.callBuffer.length<E.callBufferCapacity&&E.callBuffer.push({method:C,args:I})}},y.prototype.invokeBufferedCalls=function(){var C;if(this.callBuffer.length!==0){var E=this.callBuffer;this.callBuffer=[];var I="calc.common.DefaultLogger.invokeBufferedCalls: ".concat(E.length," calls before initLogger");t.ulsLogger.ULS.traceTag(579736781,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,I);for(var F=0,w=E;F<w.length;F++){var B=w[F];(C=t.ulsLogger.noThrowLogger)[B.method].apply(C,B.args)}}},y}(),h=function(){function y(){this.logger=new v,this.ULS=p(this.logger),this.noThrowLogger=this.logger}return y.prototype.setLogger=function(C){var E=this.logger;this.logger=C,this.ULS=p(C),this.noThrowLogger=function(I){return{shipAssertTag:m(I.shipAssertTag.bind(I)),assertTag:m(I.assertTag.bind(I)),traceTag:m(I.traceTag.bind(I)),debugTraceTag:m(I.debugTraceTag.bind(I)),dnmTraceTag:m(I.dnmTraceTag.bind(I))}}(C),E instanceof v&&E.invokeBufferedCalls()},y}();function S(y){return t.ulsLogger.ULS.assertTag(595980873,s.LogCategory.msoulscat_ES_EWAJS,!1,y)}t.ulsLogger=new h,t.assertNever=function(y,C){var E=(0,l.anonymize)(C),I="".concat(y,": code should be unreachable because a value has type 'never'; given ").concat(E);return t.ulsLogger.ULS.assertTag(595980872,s.LogCategory.msoulscat_ES_EWAJS,!1,I)},t.assertFalse=S,t.assertTrue=function(y,C){C||S("".concat(y,": expected condition to be true"))},t.assertInteger=function(y,C){(0,c.isInteger)(C)||S("".concat(y,": expected integer; given ").concat((0,l.anonymize)(C)))},t.assertNatural=function(y,C){(!(0,c.isInteger)(C)||C<0)&&S("".concat(y,": expected natural number; given ").concat((0,l.anonymize)(C)))},t.assertPositiveInteger=function(y,C){(!(0,c.isInteger)(C)||C<=0)&&S("".concat(y,": expected positive integer; given ").concat((0,l.anonymize)(C)))},t.assertIndex=function(y,C,E){(!(0,c.isInteger)(C)||C<0||C>=E)&&S("".concat(y,": expected natural number less than ").concat((0,l.anonymize)(E),"; given ").concat((0,l.anonymize)(C)))},t.assertPositiveLength=function(y,C,E){(!(0,c.isInteger)(C)||C<=0||C>E)&&S("".concat(y,": expected positive integer at most ").concat((0,l.anonymize)(E),"; given ").concat((0,l.anonymize)(C)))}},8314:function(u,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},6058:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.asyncLoop=t.asyncLoopFactory=t.delayPromiseImpl=void 0;var s=d(995),c=d(6757),l=d(2122);function f(m){return function(v){return new Promise(function(h){return m.setTimeout(h,v,void 0)})}}function p(m){return function(v,h){var S,y,C,E=(S=h==null?void 0:h.timeThreshold)!==null&&S!==void 0?S:10,I=(y=h==null?void 0:h.costThreshold)!==null&&y!==void 0?y:1,F=(C=h==null?void 0:h.macrotaskDelay)!==null&&C!==void 0?C:0,w={iterations:0,microtaskContinues:0,macrotaskContinues:0,macrotaskTotalDelay:0},B=(0,c.newPromise)(),k=B[0],x=B[1],G=x[0],H=x[1],L=!0,D=m(F),U=(0,s.now)();return function V(){if(!L||!function(){try{for(var J=0;J<I;){w.iterations+=1;var $=v();if($===void 0)return!1;J+=$}return!0}catch(Z){return H(Z),!1}}())return G();var ne=(0,s.now)();ne-U<E?(Promise.resolve().then(V),w.microtaskContinues+=1):(D.then(function(){D=m(F),U=(0,s.now)(),w.macrotaskTotalDelay+=U-ne,V()}),w.macrotaskContinues+=1)}(),{promise:k,stop:function(){L=!1},stats:w}}}t.delayPromiseImpl=f,t.asyncLoopFactory=p,t.asyncLoop=p(f(l.defaultSetTimeoutInterface))},3387:function(u,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codePointCapitalD=t.codePointCapitalC=t.codePointCapitalB=t.codePointCapitalA=t.codePointTilde=t.codePointRightCurlyBracket=t.codePointPipe=t.codePointLeftCurlyBracket=t.codePointBacktick=t.codePointUnderscore=t.codePointCircumflexAccent=t.codePointRightSquareBracket=t.codePointBackslash=t.codePointLeftSquareBracket=t.codePointAtSign=t.codePointQuestionMark=t.codePointGreaterThanSign=t.codePointEqualsSign=t.codePointLessThanSign=t.codePointSemicolon=t.codePointColon=t.codePointDigitNine=t.codePointDigitEight=t.codePointDigitSeven=t.codePointDigitSix=t.codePointDigitFive=t.codePointDigitFour=t.codePointDigitThree=t.codePointDigitTwo=t.codePointDigitOne=t.codePointDigitZero=t.codePointSlash=t.codePointFullStop=t.codePointMinusSign=t.codePointComma=t.codePointPlusSign=t.codePointAsterisk=t.codePointRightParen=t.codePointLeftParen=t.codePointSingleQuote=t.codePointAmpersand=t.codePointPercentSign=t.codePointDollarSign=t.codePointHash=t.codePointDoubleQuote=t.codePointExclamationMark=t.codePointSpace=t.codePointCR=t.codePointLF=t.codePointTab=void 0,t.codePointThaiDigitNine=t.codePointThaiDigitZero=t.codePointSmallZ=t.codePointSmallY=t.codePointSmallX=t.codePointSmallW=t.codePointSmallV=t.codePointSmallU=t.codePointSmallT=t.codePointSmallS=t.codePointSmallR=t.codePointSmallQ=t.codePointSmallP=t.codePointSmallO=t.codePointSmallN=t.codePointSmallM=t.codePointSmallL=t.codePointSmallK=t.codePointSmallJ=t.codePointSmallI=t.codePointSmallH=t.codePointSmallG=t.codePointSmallF=t.codePointSmallE=t.codePointSmallD=t.codePointSmallC=t.codePointSmallB=t.codePointSmallA=t.codePointCapitalZ=t.codePointCapitalY=t.codePointCapitalX=t.codePointCapitalW=t.codePointCapitalV=t.codePointCapitalU=t.codePointCapitalT=t.codePointCapitalS=t.codePointCapitalR=t.codePointCapitalQ=t.codePointCapitalP=t.codePointCapitalO=t.codePointCapitalN=t.codePointCapitalM=t.codePointCapitalL=t.codePointCapitalK=t.codePointCapitalJ=t.codePointCapitalI=t.codePointCapitalH=t.codePointCapitalG=t.codePointCapitalF=t.codePointCapitalE=void 0,t.codePointInvertedQuestionMark=t.codePointInvertedExclamationMark=t.codePointRightSingleQuotationMark=t.codePointLeftSingleQuotationMark=t.codePointEuroSign=t.codePointFullwidthLatinSmallZ=t.codePointFullwidthLatinSmallA=t.codePointFullwidthLatinCapitalZ=t.codePointFullwidthLatinCapitalA=t.codePointFullwidthDigitNine=t.codePointFullwidthDigitZero=void 0,t.codePointTab=9,t.codePointLF=10,t.codePointCR=13,t.codePointSpace=32,t.codePointExclamationMark=33,t.codePointDoubleQuote=34,t.codePointHash=35,t.codePointDollarSign=36,t.codePointPercentSign=37,t.codePointAmpersand=38,t.codePointSingleQuote=39,t.codePointLeftParen=40,t.codePointRightParen=41,t.codePointAsterisk=42,t.codePointPlusSign=43,t.codePointComma=44,t.codePointMinusSign=45,t.codePointFullStop=46,t.codePointSlash=47,t.codePointDigitZero=48,t.codePointDigitOne=49,t.codePointDigitTwo=50,t.codePointDigitThree=51,t.codePointDigitFour=52,t.codePointDigitFive=53,t.codePointDigitSix=54,t.codePointDigitSeven=55,t.codePointDigitEight=56,t.codePointDigitNine=57,t.codePointColon=58,t.codePointSemicolon=59,t.codePointLessThanSign=60,t.codePointEqualsSign=61,t.codePointGreaterThanSign=62,t.codePointQuestionMark=63,t.codePointAtSign=64,t.codePointLeftSquareBracket=91,t.codePointBackslash=92,t.codePointRightSquareBracket=93,t.codePointCircumflexAccent=94,t.codePointUnderscore=95,t.codePointBacktick=96,t.codePointLeftCurlyBracket=123,t.codePointPipe=124,t.codePointRightCurlyBracket=125,t.codePointTilde=126,t.codePointCapitalA=65,t.codePointCapitalB=66,t.codePointCapitalC=67,t.codePointCapitalD=68,t.codePointCapitalE=69,t.codePointCapitalF=70,t.codePointCapitalG=71,t.codePointCapitalH=72,t.codePointCapitalI=73,t.codePointCapitalJ=74,t.codePointCapitalK=75,t.codePointCapitalL=76,t.codePointCapitalM=77,t.codePointCapitalN=78,t.codePointCapitalO=79,t.codePointCapitalP=80,t.codePointCapitalQ=81,t.codePointCapitalR=82,t.codePointCapitalS=83,t.codePointCapitalT=84,t.codePointCapitalU=85,t.codePointCapitalV=86,t.codePointCapitalW=87,t.codePointCapitalX=88,t.codePointCapitalY=89,t.codePointCapitalZ=90,t.codePointSmallA=97,t.codePointSmallB=98,t.codePointSmallC=99,t.codePointSmallD=100,t.codePointSmallE=101,t.codePointSmallF=102,t.codePointSmallG=103,t.codePointSmallH=104,t.codePointSmallI=105,t.codePointSmallJ=106,t.codePointSmallK=107,t.codePointSmallL=108,t.codePointSmallM=109,t.codePointSmallN=110,t.codePointSmallO=111,t.codePointSmallP=112,t.codePointSmallQ=113,t.codePointSmallR=114,t.codePointSmallS=115,t.codePointSmallT=116,t.codePointSmallU=117,t.codePointSmallV=118,t.codePointSmallW=119,t.codePointSmallX=120,t.codePointSmallY=121,t.codePointSmallZ=122,t.codePointThaiDigitZero=3664,t.codePointThaiDigitNine=3673,t.codePointFullwidthDigitZero=65296,t.codePointFullwidthDigitNine=65305,t.codePointFullwidthLatinCapitalA=65313,t.codePointFullwidthLatinCapitalZ=65338,t.codePointFullwidthLatinSmallA=65345,t.codePointFullwidthLatinSmallZ=65370,t.codePointEuroSign=8364,t.codePointLeftSingleQuotationMark=8216,t.codePointRightSingleQuotationMark=8217,t.codePointInvertedExclamationMark=161,t.codePointInvertedQuestionMark=191},9574:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.combinations=void 0;var s=d(655);t.combinations=function c(){for(var l=[],f=0;f<arguments.length;f++)l[f]=arguments[f];if(l.length===0)return[[]];for(var p=l[0],m=l.slice(1),v=c.apply(void 0,m),h=[],S=0,y=p;S<y.length;S++)for(var C=y[S],E=0,I=v;E<I.length;E++){var F=I[E];h.push(s.__spreadArray([C],F,!0))}return h}},8994:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initCalcThread=t.initCalcInThread=t.initCalc=t.getCalcAbsUrlOrThrow=t.getCalcAbsUrl=t.isCalcInit=t.maxRetriesForLoadingScript=t.initCalcCalled=void 0;var s=d(655),c=d(1821),l=d(186),f=d(3319),p=d(4782),m=d(3854),v=d(8515),h=d(245),S=d(3971);t.initCalcCalled=new h.ResolvablePromise,t.maxRetriesForLoadingScript=9;var y=/^(https)|(http)|(file):\/\//,C=!1,E=void 0;function I(){if(E==null)throw new Error("initCalc was not passed calcAbsUrl");return E}function F(w,B,k,x){if(C)f.ulsLogger.ULS.traceTag(595910878,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.config.initCalc: Calc is already initialized");else{if(f.ulsLogger.setLogger(w),(0,p.initStopwatch)(w),(0,m.initFeatureConfiguration)(B),k!=null&&!y.test(k)){var G="calc.config.initCalc: calcAbsUrl is not absolute: ".concat(k);f.ulsLogger.ULS.traceTag(595910879,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Warning,G)}l.setConfig(x??{importScriptsMaxRetries:t.maxRetriesForLoadingScript,onWorkerError:function(U){var V={error:(0,v.messageFromError)(U),innerError:U.info.error?(0,v.messageFromError)(U.info.error):void 0},ne="calc.onWorkerError: ".concat(JSON.stringify(V));f.ulsLogger.ULS.traceTag(593335298,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Warning,ne)},onCreateWorker:function(U){var V="calc.onCreateWorker: ".concat(JSON.stringify(U));f.ulsLogger.ULS.traceTag(593335299,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,V)}}),E=k,C=!0;var H=" (".concat("production",")"),L="calc.config.initCalc: Calc version ".concat(S.excelOnlineCalcPackageVersion).concat(H," initialized");f.ulsLogger.ULS.traceTag(594642132,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,L),t.initCalcCalled.resolve(void 0)}}t.isCalcInit=function(){return C},t.getCalcAbsUrl=function(){return E},t.getCalcAbsUrlOrThrow=I,t.initCalc=function(w,B,k){F(w,B,k,void 0)},t.initCalcInThread=function(w,B,k,x){return s.__awaiter(this,void 0,void 0,function(){var G;return s.__generator(this,function(H){switch(H.label){case 0:return[4,l.Endpoint.createOutside(w)];case 1:return G=H.sent(),F((L=G.post,D=function(V){return"[".concat(new Date().toISOString(),"] ").concat(V)},{shipAssertTag:function(V,ne,J,$){L.shipAssertTag(V,ne,J,D($))},assertTag:function(V,ne,J,$){L.assertTag(V,ne,J,D($))},traceTag:function(V,ne,J,$){L.traceTag(V,ne,J,D($))},debugTraceTag:function(V,ne,J,$){L.debugTraceTag(V,ne,J,D($))},dnmTraceTag:function(V,ne,J,$){L.dnmTraceTag(V,ne,J,D($))}}),function(U){return B[U]===!0},k,x),[2]}var L,D})})},t.initCalcThread=function(w){return s.__awaiter(this,void 0,void 0,function(){var B,k,x,G,H;return s.__generator(this,function(L){switch(L.label){case 0:B=I(),k=new MessageChannel,x={port:k.port1,options:{id:"WorkerThreadLogger"}},G={port:k.port2,options:{id:"WorkerThreadLogger"}},L.label=1;case 1:return L.trys.push([1,3,,4]),[4,Promise.all([l.Endpoint.createInside(x,function(){return f.ulsLogger.noThrowLogger}),w.call.initCalcThreadInside.transfer([G.port],G,(0,m.getFeatures)(),B)])];case 2:return[2,L.sent()[0]];case 3:throw H=L.sent(),x.port.close(),H;case 4:return[2]}})})}},995:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapFromArrayOfPairs=t.singleton=t.now=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0;var s=d(3854);function c(){var h=Object.create(null);return h.___=void 0,delete h.___,h}function l(h){return Object.keys(h).map(function(S){return Number(S)}).filter(function(S){return!isNaN(S)})}function f(h,S){for(var y=0,C=S;y<C.length;y++){var E=C[y];h.push(E)}return h}function p(h){return h!=null}t.makeNewtypeIso=function(h,S){return{wrap:h,unwrap:S}},t.staticAssertExtends=function(){},t.staticAssertSame=function(){},t.staticAssertIs=function(){return function(h){return h}},t.staticAssertIsOptional=function(h){return h},t.identity=function(h){return h},t.makeStringMap=c,t.cloneStringMap=function(h){var S=c();for(var y in h)S[y]=h[y];return S},t.numEnumArray=l,t.numEnumMap=function(h,S){for(var y={},C=0,E=l(h);C<E.length;C++){var I=E[C];y[I]=S(I)}return y},t.strEnumArray=function(h){return Object.keys(h).map(function(S){return S}).map(function(S){return h[S]}).sort()},t.safePush=f,t.safeConcat=function(h,S){var y=[];f(y,h);for(var C=0,E=S;C<E.length;C++)f(y,E[C]);return y},t.isDefined=p,t.isNone=function(h){return h==null},t.filterOutNones=function(h){return h.filter(p)},t.pair=function(h,S){return[h,S]},t.fastMin=function(h,S){return h<S?h:S},t.fastMax=function(h,S){return h<S?S:h},t.fastAbs=function(h){return h<0?-h:h},t.makeStringCompareCI=function(h){try{var S=new Intl.Collator(function(y){var C=[y],E=y.indexOf("-");return E>0&&C.push(y.substring(0,E)),C[C.length-1]!=="en"&&C.push("en"),C}(h),{sensitivity:"accent"});return S.compare.bind(S)}catch(y){return function(C,E){return C===E?0:C.toLocaleUpperCase().localeCompare(E.toLocaleUpperCase())}}},t.typedInstanceCreator=function(){return function(h){return h}};var m=typeof self!="undefined"&&self.performance!=null&&self.performance.now!=null?function(){return self.performance.now()}:typeof process!="undefined"&&process.hrtime!=null?function(){var h=process.hrtime();return 1e3*h[0]+h[1]/1e6}:function(){return Date.now()},v=typeof self!="undefined"&&self.performance!=null&&self.performance.now!=null?function(){return self.performance.now()}:function(){return Date.now()};t.now=(0,s.isTypedChangeGateEnabled)("Microsoft.Office.Excel.ChangeGate.PreciseNowForNodeJS")?m:v,t.singleton=function(h){return function(){function S(){}return S.instance=function(){return S.value===void 0&&(S.value=h()),S.value},S.prototype.instance=function(){return S.instance()},S.value=void 0,S}()},t.mapFromArrayOfPairs=function(h){return h.reduce(function(S,y){var C=y[0],E=y[1];return S[C]=E,S},{})}},1612:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.enumerateKeysInOrder=t.enumerateInOrder=t.RootPointer=t.ArrayMapTree=t.floorToPowerOf2=void 0;var s=d(3897);function c(S){if(S===0)return 0;var y=S;return y=((y=((y=((y=((y=(y|y>>>1)>>>0)|y>>>2)>>>0)|y>>>4)>>>0)|y>>>8)>>>0)|y>>>16)>>>0,(y+=1)/2}t.floorToPowerOf2=c;var l=function(){function S(y,C,E){this.keyCompare=y,this.keys=C,this.values=E}return S.create=function(y){return new S(y,[],[])},S.prototype.setValue=function(y,C){return this.setValues([[y,C]])},S.prototype.remove=function(y){return this.getKeyIndex(y)===void 0?this:this.filter(function(C){return C!==y})},S.prototype.getOrSetValue=function(y,C){var E=this.getKeyIndex(y);if(E===void 0){var I=C();return[this.setValue(y,I),I]}return[this,this.values[E]]},S.prototype.filter=function(y){for(var C=[],E=0;E<this.keys.length;E+=1){var I=this.keys[E],F=this.values[E];y(I,F)&&C.push([I,F])}return C.length===this.getCount()?this:this.ofSequence(C)},S.prototype.getCount=function(){return this.keys.length},S.prototype.getValue=function(y){var C=this.getKeyIndex(y);if(C!==void 0)return this.values[C]},S.prototype.getEntry=function(y){var C=this.getKeyIndex(y);if(C!==void 0)return(0,s.entry)(this.keys[C],this.values[C])},S.prototype.contains=function(y){return this.getKeyIndex(y)!==void 0},S.prototype.forEach=function(y){for(var C=0;C<this.keys.length;C+=1)if(!y(this.keys[C],this.values[C]))return!1;return!0},S.prototype.setValues=function(y){var C=this,E=this.keys.map(function(H,L){return[H,C.values[L],L]}),I=E.length;y.forEach(function(H,L){var D=H[0],U=H[1];return E.push([D,U,L+I])}),E.sort(function(H,L){var D=H[0],U=H[2],V=L[0],ne=L[2],J=C.keyCompare(D,V);return J!==0?J:U-ne});for(var F=[],w=void 0,B=0;B<E.length;B+=1){var k=E[B],x=k[0],G=k[1];w===void 0||this.keyCompare(x,w)!==0?(F.push([x,G]),w=x):F[F.length-1]=[x,G]}return this.ofSequence(F)},S.prototype.getKeyIndex=function(y){for(var C=t.RootPointer;C>=0&&C<this.keys.length;){var E=this.keyCompare(y,this.keys[C]);if(E===0)return C;E<0?C=v(C):E>0&&(C=h(C))}},S.prototype.ofSequence=function(y){var C=this,E=y.slice();E.sort(function(H,L){var D=H[0],U=L[0];return C.keyCompare(D,U)});for(var I=new Array(E.length),F=new Array(E.length),w=function(H){var L=new Array(H);return m(t.RootPointer,L,0,H),L}(E.length),B=0;B<E.length;B+=1){var k=E[w[B]],x=k[0],G=k[1];I[B]=x,F[B]=G}return new S(this.keyCompare,I,F)},S}();function f(S,y){var C=[];return p(S,y,C),C}function p(S,y,C){y<0||y>=S.keys.length||(p(S,v(y),C),C.push([S.keys[y],S.values[y]]),p(S,h(y),C))}function m(S,y,C,E){if(!(S>=y.length)){var I=(w=c(F=E))/2-1<=F-w?w-1:F-w/2;y[S]=C+I,m(v(S),y,C,I),m(h(S),y,C+I+1,E-I-1)}var F,w}function v(S){return 2*S+1}function h(S){return 2*S+2}t.ArrayMapTree=l,t.RootPointer=0,t.enumerateInOrder=f,t.enumerateKeysInOrder=function(S,y){return f(S,y).map(function(C){return C[0]})}},3870:function(u,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BinaryHeap=void 0;var d=function(){function s(c){this.items=[],this.cmp=c}return s.prototype.insert=function(c){this.items.push(c);for(var l=this.getCount()-1;l>0;){var f=l-1>>>1,p=this.items[f];if(!(this.cmp(p,c)>0))break;this.items[l]=p,l=f}this.items[l]=c},s.prototype.peek=function(){return this.items[0]},s.prototype.removeMin=function(){var c=this.peek(),l=this.items.pop(),f=this.getCount()-1;if(f<0||l===void 0)return c;var p=0;for(this.items[0]=l;p<f;){var m=p,v=1+(p<<1),h=2+(p<<1);if(v<=f&&this.cmp(this.items[v],l)<0&&(m=v),h<=f&&this.cmp(this.items[h],m===v?this.items[m]:l)<0&&(m=h),p===m)break;this.items[p]=this.items[m],p=m}return this.items[p]=l,c},s.prototype.getCount=function(){return this.items.length},s.prototype.clear=function(){this.items.length=0},s.prototype.forEach=function(c){for(var l=0,f=this.items;l<f.length;l++)if(!c(f[l]))return},s}();t.BinaryHeap=d},1937:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forEachKeyUntyped=t.forEachKey=t.getNodeCount=t.complement=t.symmetricDiff=t.lazy=t.empty=t.dense=t.compareUntyped=t.combineCmp=t.compare=t.exceptUntyped=t.except=t.meetsUntyped=t.meets=t.intersectUntyped=t.intersect=t.unionUntyped=t.union=t.fromUntyped=t.createFromKey=t.cacheKeySplitting=t.SetKind=void 0;var s,c=d(655),l=d(655).__assign;function f(L,D,U){return U===void 0&&(U=10),function(V){if(V.split!==void 0)return V.split;var ne=L(V),J=V===D?0:V.depth;return J!==void 0&&J<U&&(V.split=ne,ne[0][0].depth=J+1,ne[1][0].depth=J+1),ne}}function p(L,D){return D===t.empty?t.empty:D===t.dense?t.dense:{setOperations:L,root:D}}function m(L,D){return D===t.empty?L:D===t.dense||L===t.empty?D:L===t.dense?L:p(L.setOperations,v(L.setOperations,L.setOperations.top,L.root,D.root))}function v(L,D,U,V){if(V===t.empty)return U;if(V===t.dense||U===t.empty)return V;if(U===t.dense)return U;if(U.isExact&&V.isExact){var ne=function(Q,b,R,P){var A=R.key,T=P.key,g=Q.compare(A,T);if(g!==void 0)return g<0?P:R;var O=Q.union(A,T);if(O!==void 0){var M=Q.compare(O,b);return M!==void 0&&M===0?t.dense:k(Q,b,O,!0)}}(L,D,U,V);if(ne!==void 0)return ne}var J=x(L,D,U),$=x(L,D,V),Z=L.split(D),ie=Z[0][0],X=Z[1][0];return F(L,ie,X,v(L,ie,J.left,$.left),v(L,X,J.right,$.right))}function h(L,D,U,V){if(U===t.empty)return U;if(V===t.empty||U===t.dense)return V;if(V===t.dense)return U;if(U.isExact&&V.isExact){var ne=function(Q,b,R,P){var A=R.key,T=P.key;if(!Q.meets(A,T))return t.empty;var g=Q.compare(A,T);if(g!==void 0)return g<0?R:P;var O=Q.intersect(A,T);return O!==void 0?k(Q,b,O,!0):void 0}(L,D,U,V);if(ne!==void 0)return ne}var J=x(L,D,U),$=x(L,D,V),Z=L.split(D),ie=Z[0][0],X=Z[1][0];return F(L,ie,X,h(L,ie,J.left,$.left),h(L,X,J.right,$.right))}function S(L,D,U,V){if(U===t.empty||V===t.empty)return!1;if(U===t.dense||V===t.dense)return!0;if(U.isExact&&V.isExact)return L.meets(U.key,V.key);var ne=x(L,D,U),J=x(L,D,V),$=L.split(D),Z=$[0][0],ie=$[1][0];return S(L,Z,ne.left,J.left)||S(L,ie,ne.right,J.right)}function y(L,D){return L===t.empty||D===t.empty?L:D===t.dense?t.empty:L===t.dense?p(D.setOperations,C(D.setOperations,D.setOperations.top,L,D.root)):p(L.setOperations,C(L.setOperations,L.setOperations.top,L.root,D.root))}function C(L,D,U,V){if(U===t.empty||V===t.empty)return U;if(V===t.dense)return t.empty;if(U===t.dense){var ne=x(L,D,V),J=L.split(D),$=J[0][0],Z=J[1][0];return F(L,$,Z,C(L,$,t.dense,ne.left),C(L,Z,t.dense,ne.right))}if(U.isExact&&V.isExact){var ie=function(A,T,g,O){var M=g.key,K=O.key;if(!A.meets(M,K))return g;var W=A.except(M,K);return W!==void 0?k(A,T,W,!0):void 0}(L,D,U,V);if(ie!==void 0)return ie}var X=x(L,D,U),Q=x(L,D,V),b=L.split(D),R=b[0][0],P=b[1][0];return F(L,R,P,C(L,R,X.left,Q.left),C(L,P,X.right,Q.right))}function E(L,D){if(L!==void 0&&D!==void 0)return L===0?D:D===0||L===D?L:void 0}function I(L,D,U,V){if(U===V)return 0;if(U===t.empty)return-1;if(V===t.empty)return 1;if(U===t.dense)return V===t.dense?0:1;if(V===t.dense)return-1;if(U.isExact&&V.isExact)return function(b,R,P){return b.compare(R.key,P.key)}(L,U,V);var ne=x(L,D,U),J=x(L,D,V),$=L.split(D),Z=$[0][0],ie=$[1][0],X=I(L,Z,ne.left,J.left);if(X!==void 0){var Q=I(L,ie,ne.right,J.right);if(Q!==void 0)return E(X,Q)}}function F(L,D,U,V,ne){return V===t.empty?ne===t.empty?t.empty:ne===t.dense?w(V,ne,void 0,!1,L.infimum(U,U),L.supremum(U,U)):w(V,ne,void 0,!1,ne.infimum,ne.supremum):ne===t.empty?V===t.dense?w(V,ne,void 0,!1,L.infimum(D,D),L.supremum(D,D)):w(V,ne,void 0,!1,V.infimum,V.supremum):V===t.dense?ne===t.dense?t.dense:w(V,ne,void 0,!1,L.combineInfima(L.infimum(D,D),ne.infimum),L.combineSuprema(L.supremum(D,D),ne.supremum)):ne===t.dense?w(V,ne,void 0,!1,L.combineInfima(V.infimum,L.infimum(U,U)),L.combineSuprema(V.supremum,L.supremum(U,U))):w(V,ne,void 0,!1,L.combineInfima(V.infimum,ne.infimum),L.combineSuprema(V.supremum,ne.supremum))}function w(L,D,U,V,ne,J){return{key:U,left:L,right:D,isExact:V,infimum:ne,supremum:J}}function B(L,D,U){if(!L.meets(D,U))return t.empty;var V=L.compare(D,U);if(V!==void 0)return V<=0?t.dense:k(L,D,U,!0);var ne=L.intersect(D,U);return ne!==void 0?k(L,D,ne,!0):k(L,D,U,!1)}function k(L,D,U,V){return w(void 0,void 0,U,!!V,L.infimum(U,D),L.supremum(U,D))}function x(L,D,U){if(U.left!==void 0)return U;var V=L.split(D),ne=V[0][0],J=V[1][0],$=F(L,ne,J,B(L,ne,U.key),B(L,J,U.key));if($===t.empty||$===t.dense)throw new Error("incorrect set operations implementation");var Z=$;return l(U,{left:Z.left,right:Z.right})}function G(L){return L===void 0||L===t.empty||L===t.dense?0:G(L.left)+G(L.right)+1}function H(L,D,U){return function V(ne,J){if(J===t.empty)return!0;if(J===t.dense)return U(ne);if(J.isExact)return U(J.key);var $=x(L,ne,J),Z=L.split(ne),ie=Z[0][0],X=Z[1][0];return V(ie,$.left)&&V(X,$.right)}(L.top,D)}(function(L){L[L.Dense=0]="Dense",L[L.Empty=1]="Empty"})(s=t.SetKind||(t.SetKind={})),t.cacheKeySplitting=f,t.createFromKey=function(L){var D=c.__assign(c.__assign({},L),{split:f(L.split,L.top)});return function(U){return p(D,B(D,D.top,U))}},t.fromUntyped=p,t.union=m,t.unionUntyped=v,t.intersect=function(L,D){return L===t.empty?L:D===t.empty||L===t.dense?D:D===t.dense?L:p(L.setOperations,h(L.setOperations,L.setOperations.top,L.root,D.root))},t.intersectUntyped=h,t.meets=function(L,D){return L!==t.empty&&D!==t.empty&&(L===t.dense||D===t.dense||S(L.setOperations,L.setOperations.top,L.root,D.root))},t.meetsUntyped=S,t.except=y,t.exceptUntyped=C,t.compare=function(L,D){return L===D?0:L===t.empty?-1:D===t.empty?1:L===t.dense?D===t.dense?0:1:D===t.dense?-1:I(L.setOperations,L.setOperations.top,L.root,D.root)},t.combineCmp=E,t.compareUntyped=I,t.dense=s.Dense,t.empty=s.Empty,t.lazy=B,t.symmetricDiff=function(L,D){return m(y(L,D),y(D,L))},t.complement=function(L){return y(t.dense,L)},t.getNodeCount=function(L){return L===t.empty||L===t.dense?0:G(L.root)},t.forEachKey=function(L,D){return L===t.empty||H(L.setOperations,L.root,D)},t.forEachKeyUntyped=H},2276:function(u,t){"use strict";function d(c,l){return c&l-1}Object.defineProperty(t,"__esModule",{value:!0}),t.Deque=void 0;var s=function(){function c(){this.front=0,this.count=0,this.values=[void 0]}return c.prototype.getCount=function(){return this.count},c.prototype.maybeResize=function(){var l=this.values.length;if(this.count>=l){this.values.length=l<<1;for(var f=0;f<this.front;f+=1)this.values[l+f]=this.values[f],this.values[f]=void 0}else{var p=l>>4;if(p>=1&&this.count<p){for(f=0;f<this.count;f+=1)this.values[d(this.front+f,p)]=this.values[d(this.front+f,l)];this.values.length=p,this.front=d(this.front,p)}}},c.prototype.pushBack=function(l){this.maybeResize(),this.values[d(this.front+this.count,this.values.length)]=l,this.count+=1},c.prototype.pushFront=function(l){this.maybeResize();var f=d(this.front-1,this.values.length);this.values[f]=l,this.front=f,this.count+=1},c.prototype.peekBack=function(){return this.values[d(this.front+this.count-1,this.values.length)]},c.prototype.peekFront=function(){return this.values[this.front]},c.prototype.peekPos=function(l){if(!(l<0||l>=this.count))return this.values[d(this.front+l,this.values.length)]},c.prototype.popBack=function(){var l=d(this.front+this.count-1,this.values.length),f=this.values[l];return f!==void 0&&(this.values[l]=void 0,this.count-=1),f},c.prototype.popFront=function(){var l=this.values[this.front];return l!==void 0&&(this.values[this.front]=void 0,this.front=d(this.front+1,this.values.length),this.count-=1),l},c.prototype.forEach=function(l){for(var f=this.values.length,p=0;p<this.count;p+=1)if(!l(this.values[d(this.front+p,f)]))return!1;return!0},c}();t.Deque=s},6348:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeNumberDict=t.makeStringDict=t.makeDictionary=void 0;var s=d(3897),c=d(995);function l(f){function p(m,v){return Object.prototype.hasOwnProperty.call(m,v)}return{entries:(0,c.makeStringMap)(),keyToString:f,getCount:function(){return Object.keys(this.entries).length},getValue:function(v){var h=this.keyToString(v),S=p(this.entries,h)?this.entries[h]:void 0;return(0,c.isDefined)(S)?S.value:void 0},getEntry:function(v){var h=this.getValue(v);return h===void 0?void 0:(0,s.entry)(v,h)},setValue:function(v,h){var S=this.keyToString(v),y=p(this.entries,S)?this.entries[S]:void 0;(0,c.isDefined)(y)?y.value=h:this.entries[S]=(0,s.entry)(v,h)},contains:function(v){var h=this.keyToString(v),S=p(this.entries,h)?this.entries[h]:void 0;return(0,c.isDefined)(S)},remove:function(v){var h=this.keyToString(v);return!!p(this.entries,h)&&(delete this.entries[h],!0)},getOrSetValue:function(v,h){var S=this.keyToString(v),y=p(this.entries,S)?this.entries[S]:void 0;if((0,c.isDefined)(y))return y.value;var C=h();return delete this.entries[S],this.entries[S]=(0,s.entry)(v,C),C},forEach:function(v){for(var h in this.entries){var S=p(this.entries,h)?this.entries[h]:void 0;if((0,c.isDefined)(S)&&!v(S.key,S.value))return!1}return!0},filter:function(v){var h=[];this.forEach(function(E,I){return v(E,I)||h.push(E),!0});for(var S=0,y=h;S<y.length;S++){var C=y[S];this.remove(C)}}}}t.makeDictionary=l,t.makeStringDict=function(){return l(c.identity)},t.makeNumberDict=function(){return l(function(f){return String(f)})}},4642:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeHashSet=void 0;var s=d(995),c=d(1757);t.makeHashSet=function(l,f){return{map:{},keyToHash:l,keyEquals:f,nelements:0,add:function(m){var v=this.keyToHash(m);if((0,s.isNone)(this.map[v]))this.map[v]=[m],this.nelements+=1;else{for(var h=this.map[v],S=0;S<h.length;S+=1)if(this.keyEquals(m,h[S]))return;(0,c.logCollisionKey)(m),h.push(m),this.nelements+=1}},contains:function(m){var v=this.keyToHash(m),h=this.map[v];if((0,s.isNone)(h))return!1;for(var S=0;S<h.length;S+=1)if(this.keyEquals(m,h[S]))return!0;return(0,c.logCollisionKey)(m),!1},forEach:function(m){var v=this;Object.keys(this.map).forEach(function(h){v.map[Number(h)].forEach(function(S){m(S)})})},size:function(){return this.nelements},remove:function(m){var v=this,h=this.keyToHash(m),S=this.map[h];if((0,s.isNone)(S))return!1;var y=[],C=!1;return S.forEach(function(E){v.keyEquals(m,E)?(v.nelements-=1,C=!0):y.push(E)}),this.map[h]=y,C||(0,c.logCollisionKey)(m),C}}}},1569:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeHashTable=void 0;var s=d(3897),c=d(1757),l=d(995);t.makeHashTable=function(f,p){return{map:{},nentries:0,keyToHash:f,keyEquals:p,getCount:function(){return this.nentries},getValue:function(v){var h=this.getEntry(v);return h===void 0?void 0:h.value},getEntry:function(v){var h=this.keyToHash(v),S=this.map[h];if(!(0,l.isNone)(S)){for(var y=0;y<S.length;y+=1){var C=S[y];if(this.keyEquals(v,C.key))return C}(0,c.logCollisionKey)(v)}},contains:function(v){return this.getValue(v)!==void 0},setValue:function(v,h){var S=this.keyToHash(v),y=this.map[S];if(y==null)this.map[S]=[(0,s.entry)(v,h)],this.nentries+=1;else{for(var C=0;C<y.length;C+=1){var E=y[C];if(this.keyEquals(E.key,v))return void(E.value=h)}y.push((0,s.entry)(v,h)),this.nentries+=1,(0,c.logCollisionKey)(v)}},remove:function(v){var h=this.keyToHash(v),S=this.map[h];if((0,l.isNone)(S))return!1;for(var y=[],C=!1,E=0;E<S.length;E+=1){var I=S[E];this.keyEquals(v,I.key)?(this.nentries-=1,C=!0):y.push(I)}return this.map[h]=y,C||(0,c.logCollisionKey)(v),C},getOrSetValue:function(v,h){var S=this.keyToHash(v),y=this.map[S];if((0,l.isNone)(y)){var C=h();return this.map[S]=[(0,s.entry)(v,C)],this.nentries+=1,C}for(var E=0;E<y.length;E+=1){var I=y[E];if(this.keyEquals(v,I.key))return I.value}var F=h();return y.push((0,s.entry)(v,F)),this.nentries+=1,(0,c.logCollisionKey)(v),F},forEach:function(v){var h=this;return Object.keys(this.map).every(function(S){return h.map[Number(S)].every(function(y){return v(y.key,y.value)})})},filter:function(v){var h=[];this.forEach(function(E,I){return v(E,I)||h.push(E),!0});for(var S=0,y=h;S<y.length;S++){var C=y[S];this.remove(C)}}}}},8114:function(u,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.binarySearch=t.exponentialBuckets=t.linearBuckets=t.Histogram=void 0;var d=function(){function c(l){var f,p,m=this;this.buckets=l,this.createSampleCounts=function(){return new Array(m.buckets.length+1).fill(0)},this.sampleCounts=this.createSampleCounts(),this.findBucket=(f=function(h,S){return h-S},p=m.buckets.length,function(v){return s(m.buckets,0,p,v,f)})}return c.prototype.addSample=function(l){var f=this.findBucket(l);f<0&&(f=~f),this.sampleCounts[f]+=1},c.prototype.reset=function(){var l={buckets:this.buckets,sampleCounts:this.sampleCounts};return this.sampleCounts=this.createSampleCounts(),l},c}();function s(c,l,f,p,m){for(var v=l,h=l+f-1;v<=h;){var S=v+(h-v>>>1),y=m(c[S],p);if(y===0)return S;y<0?v=S+1:h=S-1}return~v}t.Histogram=d,t.linearBuckets=function(c,l,f){for(var p=(l-c)/(f-1),m=[],v=c,h=0;h<f;v+=p,h+=1)m.push(v);return m},t.exponentialBuckets=function(c,l,f){for(var p=Math.log(c),m=(Math.log(l)-p)/(f-1),v=[],h=0,S=0;S<f;h+=m,S+=1)v.push(Math.exp(p+h));return v},t.binarySearch=s},8124:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ivlCompare=t.ivlExcept=t.ivlMeetsOrTouches=t.ivlMeets=t.ivlDistance=t.ivlMeet=t.ivlJoin=void 0;var s=d(995);t.ivlJoin=function(c,l){var f=c[0],p=c[1],m=l[0],v=l[1];return[(0,s.fastMin)(f,m),(0,s.fastMax)(p,v)]},t.ivlMeet=function(c,l){var f=c[0],p=c[1],m=l[0],v=l[1];return[(0,s.fastMax)(f,m),(0,s.fastMin)(p,v)]},t.ivlDistance=function(c,l){var f=c[0],p=c[1],m=l[0],v=l[1];return .5*(0,s.fastAbs)(f+p-(m+v))},t.ivlMeets=function(c,l){var f=c[0],p=c[1],m=l[0],v=l[1];return(0,s.fastMax)(f,m)<(0,s.fastMin)(p,v)},t.ivlMeetsOrTouches=function(c,l){var f=c[0],p=c[1],m=l[0],v=l[1];return(0,s.fastMax)(f,m)<=(0,s.fastMin)(p,v)},t.ivlExcept=function(c,l){var f=c[0],p=c[1],m=l[0],v=l[1];return f<m&&v>=p?[f,m]:f>=m&&v<p?[v,p]:void 0},t.ivlCompare=function(c,l){var f=c[0],p=c[1],m=l[0],v=l[1];return f===m&&p===v?0:f>=m&&p<=v?-1:f<=m&&p>=v?1:void 0}},7213:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PriorityQueue=void 0;var s=d(3870),c=function(){function l(f){this.min=0,this.max=0,this.heap=new s.BinaryHeap(function(p,m){var v=p[0],h=p[1],S=m[0],y=m[1],C=f(v,S);return C!==0?C:h-y})}return l.prototype.peek=function(){var f=this.heap.peek();if(f!==void 0)return f[0]},l.prototype.enqueue=function(f){this.max+=1,this.heap.insert([f,this.max])},l.prototype.push=function(f){this.min-=1,this.heap.insert([f,this.min])},l.prototype.pop=function(){var f=this.heap.removeMin();return f===void 0?(this.min=0,void(this.max=0)):f[0]},l.prototype.getCount=function(){return this.heap.getCount()},l.prototype.clear=function(){this.heap.clear()},l}();t.PriorityQueue=c},5100:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.productSetSerializer=t.ProductSetSerializer=t.getSubspaceCount=t.forEachProduct=t.getSubspaces=t.symmetricDiffProduct=t.complementProduct=t.meetsProduct=t.compareProduct=t.exceptProduct=t.intersectProduct=t.unionProduct=t.project=t.createFromProduct=void 0;var s=d(655),c=d(1937),l=d(3854),f=function(z,ee){var ue,ce,he=z[0],de=ee[0];return(ue=String(he))<(ce=String(de))?-1:ue>ce?1:0},p={},m=function(z){for(var ee=[],ue=0,ce=Object.keys(z);ue<ce.length;ue++){var he=ce[ue];ee.push([he,z[he].id])}var de=function(_e){for(var Ce="",Ne=0,Le=_e;Ne<Le.length;Ne++){var Oe=Le[Ne];Ce+=String(Oe[0]),Ce+="\0",Ce+=String(Oe[1]),Ce+="\0"}return Ce}(ee.sort(f)),pe=p[de];return pe===void 0&&(pe={box:{},probabilities:{},depth:1},p[de]=pe),pe};function v(W){return Object.getOwnPropertyNames(W).length>0}var h=function(){for(var z=[],ee=0;ee<arguments.length;ee++)z[ee]=arguments[ee];return(0,l.getTypedFeatureGate)("Microsoft.Office.Excel.ProductSetBugFixFromPR1043532")?S.apply(void 0,z):y.apply(void 0,z)};function S(W){return v(W)?{isSubspace:!0,bounds:W}:c.dense}function y(W){for(var z=!0,ee=0,ue=Object.keys(W);ee<ue.length;ee++){var ce=ue[ee];if(Object.prototype.hasOwnProperty.call(W,ce)){z=!1;break}}return z?c.dense:{isSubspace:!0,bounds:W}}function C(W){return W.isSubspace?1:W.subspaceCount}var E=function(z,ee,ue){return{isSubspace:!1,left:z,right:ee,bounds:ue,subspaceCount:C(z)+C(ee)}};function I(W,z){if(z===c.dense)return z;if(z.isSubspace){for(var ee=!1,ue=0,ce=Object.keys(z.bounds);ue<ce.length;ue++){var he=ce[ue];if(Object.prototype.hasOwnProperty.call(W,he)){ee=!0;break}}if(!ee)return c.dense}return{productOperations:W,root:z}}function F(W){return W===void 0?c.dense:W}var w={unzip:function(z){for(var ee={},ue={},ce=0,he=Object.keys(z);ce<he.length;ce++){var de=he[ce];if(Object.prototype.hasOwnProperty.call(z,de)){var pe=z[de];if(pe===c.empty)return c.empty;if(pe===c.dense)continue;ee[de]=pe.setOperations,ue[de]=pe.root}}return I(ee,h(ue))},combineProduct:function(z,ee,ue,ce){for(var he={},de=0,pe=Object.keys(z);de<pe.length;de++){var _e=pe[de];if(Object.prototype.hasOwnProperty.call(z,_e)){var Ce=ce(z[_e],z[_e].top,F(ee[_e]),F(ue[_e]));if(Ce===c.empty)return c.empty;if(Ce===c.dense)continue;he[_e]=Ce}}return he},restrict:function(z){for(var ee=[],ue=1;ue<arguments.length;ue++)ee[ue-1]=arguments[ue];for(var ce={},he=0,de=ee;he<de.length;he++){var pe=de[he];if(Object.prototype.hasOwnProperty.call(z,pe)){var _e=z[pe];ce[pe]=_e}}return ce},fromUntypedProduct:function(z,ee,ue){for(var ce={},he=0,de=ue;he<de.length;he++){var pe=de[he],_e=ee[pe];ce[pe]=(0,c.fromUntyped)(z[pe],_e!==void 0?_e:c.dense)}return ce},denseProduct:function(z){for(var ee={},ue=0,ce=z;ue<ce.length;ue++)ee[ce[ue]]=c.dense;return ee}};function B(W,z,ee){var ue=w.combineProduct(W,z,ee,c.unionUntyped);if(ue===c.empty)throw new Error("broken invariant: the union of two non-empty products cannot be empty");return ue}function k(W,z,ee){for(var ue=0,ce=0,he=Object.keys(W);ce<he.length;ce++){var de=he[ce];if(Object.prototype.hasOwnProperty.call(W,de)){var pe=F(z[de]),_e=F(ee[de]),Ce=W[de];if((ue=(0,c.combineCmp)(ue,(0,c.compareUntyped)(Ce,Ce.top,pe,_e)))===void 0)return}}return ue}t.createFromProduct=w.unzip.bind(w);var x,G=(x={},function(W,z,ee){var ue;if(z===x.left&&ee===x.right)return x.res;x.left=z,x.right=ee;var ce,he=k(W,z.bounds,ee.bounds);if(he!==void 0)return x.res=he<=0?ee:z;for(var de=0,pe=Object.keys(W);de<pe.length;de++){var _e=pe[de];if(Object.prototype.hasOwnProperty.call(W,_e)&&(0,c.compareUntyped)(W[_e],W[_e].top,F(z.bounds[_e]),F(ee.bounds[_e]))!==0){if(ce!==void 0)return x.res=void 0;ce=_e}}if(ce!==void 0){var Ce=(0,c.unionUntyped)(W[ce],W[ce].top,F(z.bounds[ce]),F(ee.bounds[ce]));if(Ce===c.empty)return x.res=c.empty;if(Ce===c.dense){var Ne=z.bounds,Le=ce,Oe=(Ne[Le],s.__rest(Ne,[typeof Le=="symbol"?Le:Le+""]));return x.res=h(Oe)}var le=s.__assign(s.__assign({},z.bounds),((ue={})[ce]=Ce,ue));return x.res=h(le)}return x.res=void 0});function H(W,z,ee){if(ee===c.empty)return z;if(ee===c.dense||z===c.empty)return ee;if(z===c.dense)return z;if(!z.isSubspace||!ee.isSubspace)return E(z,ee,B(W,z.bounds,ee.bounds));var ue=G(W,z,ee);return ue!==void 0?ue:E(z,ee,B(W,z.bounds,ee.bounds))}function L(W,z){for(var ee=[],ue=2;ue<arguments.length;ue++)ee[ue-2]=arguments[ue];var ce=w.restrict.apply(w,s.__spreadArray([z.bounds],ee,!1));if(z.isSubspace)return h(ce);var he=L.apply(void 0,s.__spreadArray([W,z.left],ee,!1));if(he===c.dense)return c.dense;var de=L.apply(void 0,s.__spreadArray([W,z.right],ee,!1));return H(W,he,de)}function D(W,z,ee){for(var ue=[],ce=3;ce<arguments.length;ce++)ue[ce-3]=arguments[ce];if(z===c.empty||z===c.dense)return z;if(z.isSubspace){var he=w.restrict.apply(w,s.__spreadArray([z.bounds],ue,!1));return h(he)}var de=ne(W,ee),pe=de[0],_e=de[1],Ce=$(W,z,pe,_e),Ne=Ce[0],Le=Ce[1],Oe=D.apply(void 0,s.__spreadArray([W,Ne,pe],ue,!1)),le=D.apply(void 0,s.__spreadArray([W,Le,_e],ue,!1));return H(W,Oe,le)}function U(W){for(var z=[],ee=1;ee<arguments.length;ee++)z[ee-1]=arguments[ee];if(W===c.dense||W===c.empty)return W;var ue=w.restrict.apply(w,s.__spreadArray([W.productOperations],z,!1));if(!v(ue))return c.dense;var ce=D.apply(void 0,s.__spreadArray([ue,W.root,m(ue)],z,!1));return ce===c.empty?ce:I(ue,ce)}function V(W){for(var z=[],ee=1;ee<arguments.length;ee++)z[ee-1]=arguments[ee];if(W===c.dense||W===c.empty)return W;var ue=w.restrict.apply(w,s.__spreadArray([W.productOperations],z,!1)),ce=L.apply(void 0,s.__spreadArray([ue,W.root],z,!1));return ce===c.empty?ce:I(ue,ce)}function ne(W,z){var ee,ue,ce,he;if(z.children!==void 0)return z.children;for(var de,pe,_e=z.box,Ce=z.probabilities,Ne=0,Le=0,Oe=Object.keys(W);Le<Oe.length;Le++){var le=Oe[Le];if(Object.prototype.hasOwnProperty.call(W,le)){var me=Ce[le],Pe=W[le];if(me===void 0){de=le,pe=Pe.top;break}if(me>Ne){var Re=F(_e[le]);if(Re===c.empty)throw new Error("the key split can never return empty");var fe=Pe.top;if(Re!==c.dense){if(!Re.isExact)throw new Error("the key can always be represented exactly");fe=Re.key}if(!Pe.canSplit(fe))continue;de=le,Ne=me,pe=fe}}}if(de===void 0||pe===void 0)throw new Error("there has to be at least one dimension");var Se=W[de],be=Se.split(pe),xe=be[0],Ie=xe[0],Ve=xe[1],Ze=be[1],gr=Ze[0],cr=Ze[1],_r=[{box:s.__assign(s.__assign({},_e),(ee={},ee[de]=(0,c.lazy)(Se,Se.top,Ie),ee)),probabilities:s.__assign(s.__assign({},Ce),(ue={},ue[de]=Ve,ue)),depth:z.depth+1},{box:s.__assign(s.__assign({},_e),(ce={},ce[de]=(0,c.lazy)(Se,Se.top,gr),ce)),probabilities:s.__assign(s.__assign({},Ce),(he={},he[de]=cr,he)),depth:z.depth+1}];return z.depth<10&&(z.children=_r),_r}function J(W,z,ee,ue){if(z===c.empty)return[c.empty,c.empty];if(z===c.dense)return[h(ee),h(ue)];var ce=k(W,z.bounds,ee);if(ce!==void 0&&ce<=0)return[z,c.empty];var he=w.combineProduct(W,z.bounds,ee,c.intersectUntyped);if(he===c.empty)return[c.empty,z];var de=w.combineProduct(W,z.bounds,ue,c.intersectUntyped);if(z.isSubspace)return[h(he),de===c.empty?c.empty:h(de)];var pe=J(W,z.left,ee,ue),_e=pe[0],Ce=pe[1],Ne=J(W,z.right,ee,ue),Le=Ne[0],Oe=Ne[1];return[H(W,_e,Le),H(W,Ce,Oe)]}t.project=function(){for(var W=[],z=0;z<arguments.length;z++)W[z]=arguments[z];return(0,l.getTypedFeatureGate)("Microsoft.Office.Excel.ProductSetBugFixFromPR1043532")?U.apply(void 0,W):V.apply(void 0,W)};var $=function(z,ee,ue,ce){return J(z,ee,ue.box,ce.box)};function Z(W,z,ee,ue,ce){var he=ne(W,ue),de=he[0],pe=he[1],_e=$(W,z,de,pe),Ce=_e[0],Ne=_e[1],Le=$(W,ee,de,pe),Oe=Le[0],le=Le[1],me=ce(W,Ce,Oe,de);return me===c.dense?c.dense:H(W,me,ce(W,Ne,le,pe))}function ie(W,z,ee,ue){if(ee===c.empty)return z;if(z===c.empty)return ee;if(z===c.dense)return z;if(ee===c.dense)return ee;if(z.isSubspace&&ee.isSubspace){var ce=G(W,z,ee);if(ce!==void 0)return ce}return Z(W,z,ee,ue,ie)}function X(W,z){if(z===c.empty)return W;if(z===c.dense||W===c.empty)return z;if(W===c.dense)return W;var ee=s.__assign(s.__assign({},W.productOperations),z.productOperations),ue=ie(ee,W.root,z.root,m(ee));return ue===c.empty?ue:I(ee,ue)}function Q(W,z,ee,ue){if(z===c.empty||ee===c.empty)return c.empty;if(z===c.dense)return ee;if(ee===c.dense)return z;if(z.isSubspace&&ee.isSubspace){var ce=w.combineProduct(W,z.bounds,ee.bounds,c.intersectUntyped);return ce===c.empty?c.empty:h(ce)}return Z(W,z,ee,ue,Q)}function b(W,z,ee,ue){if(z===c.empty)return z;if(ee===c.dense)return c.empty;if(ee===c.empty)return z;if(z===c.dense)return Z(W,z,ee,ue,b);if(z.isSubspace&&ee.isSubspace){var ce=function(he,de,pe){var _e,Ce,Ne=k(he,de.bounds,pe.bounds);if(Ne===0||Ne===-1)return c.empty;for(var Le=0,Oe=Object.keys(he);Le<Oe.length;Le++){var le=Oe[Le];if(Object.prototype.hasOwnProperty.call(he,le)){var me=(0,c.compareUntyped)(he[le],he[le].top,F(de.bounds[le]),F(pe.bounds[le]));if(me===void 0||me>0){if(Ce!==void 0)return;Ce=le}}}if(Ce!==void 0){var Pe=(0,c.exceptUntyped)(he[Ce],he[Ce].top,F(de.bounds[Ce]),F(pe.bounds[Ce]));if(Pe===c.empty)return c.empty;if(Pe===c.dense){var Re=de.bounds,fe=Ce,Se=(Re[fe],s.__rest(Re,[typeof fe=="symbol"?fe:fe+""]));return h(Se)}var be=s.__assign(s.__assign({},de.bounds),((_e={})[Ce]=Pe,_e));return h(be)}}(W,z,ee);if(ce!==void 0)return ce}return Z(W,z,ee,ue,b)}function R(W,z){if(W===c.empty||z===c.empty)return W;if(z===c.dense)return c.empty;if(W===c.dense){var ee=b(z.productOperations,c.dense,z.root,m(z.productOperations));return ee===c.empty?ee:I(z.productOperations,ee)}var ue=s.__assign(s.__assign({},W.productOperations),z.productOperations),ce=b(ue,W.root,z.root,m(ue));return ce===c.empty?ce:I(ue,ce)}function P(W,z,ee,ue){if(z===ee)return 0;if(z===c.empty)return-1;if(ee===c.empty)return 1;if(z===c.dense)return ee===c.dense?0:1;if(ee===c.dense)return-1;if(z.isSubspace&&ee.isSubspace)return k(W,z.bounds,ee.bounds);var ce=ne(W,ue),he=ce[0],de=ce[1],pe=$(W,z,he,de),_e=pe[0],Ce=pe[1],Ne=$(W,ee,he,de),Le=Ne[0],Oe=Ne[1],le=P(W,_e,Le,he);return le!==void 0?(0,c.combineCmp)(le,P(W,Ce,Oe,de)):void 0}function A(W,z,ee,ue){if(z===c.empty||ee===c.empty)return!1;if(z===c.dense||ee===c.dense)return!0;if(!function(le,me,Pe){for(var Re=0,fe=Object.keys(le);Re<fe.length;Re++){var Se=fe[Re];if(Object.prototype.hasOwnProperty.call(le,Se)){var be=F(me[Se]),xe=F(Pe[Se]),Ie=le[Se];if(!(0,c.meetsUntyped)(Ie,Ie.top,be,xe))return!1}}return!0}(W,z.bounds,ee.bounds))return!1;if(z.isSubspace&&ee.isSubspace)return!0;var ce=ne(W,ue),he=ce[0],de=ce[1],pe=$(W,z,he,de),_e=pe[0],Ce=pe[1],Ne=$(W,ee,he,de),Le=Ne[0],Oe=Ne[1];return A(W,_e,Le,he)||A(W,Ce,Oe,de)}t.unionProduct=X,t.intersectProduct=function(W,z){if(W===c.empty)return W;if(z===c.empty||W===c.dense)return z;if(z===c.dense)return W;var ee=s.__assign(s.__assign({},W.productOperations),z.productOperations),ue=Q(ee,W.root,z.root,m(ee));return ue===c.empty?ue:I(ee,ue)},t.exceptProduct=R,t.compareProduct=function(W,z){if(W===z)return 0;if(W===c.empty)return-1;if(z===c.empty)return 1;if(W===c.dense)return z===c.dense?0:1;if(z===c.dense)return-1;var ee=s.__assign(s.__assign({},W.productOperations),z.productOperations);return P(ee,W.root,z.root,m(ee))},t.meetsProduct=function(W,z){if(W===c.empty||z===c.empty)return!1;if(W===c.dense||z===c.dense)return!0;var ee=s.__assign(s.__assign({},W.productOperations),z.productOperations);return A(ee,W.root,z.root,m(ee))},t.complementProduct=function(W){return R(c.dense,W)},t.symmetricDiffProduct=function(W,z){return X(R(W,z),R(z,W))},t.getSubspaces=function(W){if(W===c.empty||W===c.dense)return[];var z=[];return function ee(ue){ue.isSubspace?z.push(ue.bounds):(ee(ue.left),ee(ue.right))}(W.root),z},t.forEachProduct=function(W,z){for(var ee=[],ue=2;ue<arguments.length;ue++)ee[ue-2]=arguments[ue];var ce=t.project.apply(void 0,s.__spreadArray([W],ee,!1));if(ce===c.empty)return!0;if(ce===c.dense)return z(w.denseProduct(ee));var he=ce.productOperations,de=ce.root;function pe(_e){return _e.isSubspace?z(w.fromUntypedProduct(he,_e.bounds,ee)):pe(_e.left)&&pe(_e.right)}return pe(de)},t.getSubspaceCount=function(W){return W===c.empty||W===c.dense?0:C(W.root)};var T=function(){function W(z){z===void 0&&(z=[]),this.buffer=z,this.cursor=0}return W.prototype.putBack=function(z){this.cursor-=1,this.buffer[this.cursor]=z},W.prototype.pick=function(){return this.buffer[this.cursor]},Object.defineProperty(W.prototype,"length",{get:function(){return this.buffer.length-this.cursor},enumerable:!1,configurable:!0}),Object.defineProperty(W.prototype,"empty",{get:function(){return this.length===0},enumerable:!1,configurable:!0}),W.prototype.pop=function(){var z=this.pick();return this.cursor+=1,z},W}(),g=function(){var z=this;this.size=0,this.clear=function(){},this.get=function(){},this.set=function(){return z}};function O(W,z){return function(ee,ue){for(var ce=[],he=2;he<arguments.length;he++)ce[he-2]=arguments[he];var de=z.get(ee);de===void 0?(W.apply(void 0,s.__spreadArray([ee,ue],ce,!1)),z.set(ee,z.size)):ue.push("__cached__",de)}}function M(W,z){return function(ee){for(var ue=[],ce=1;ce<arguments.length;ce++)ue[ce-1]=arguments[ce];if(ee.pick()==="__cached__"){ee.pop();var he=ee.pop();return z[he]}var de=W.apply(void 0,s.__spreadArray([ee],ue,!1));return z.push(de),de}}var K=function(){function W(z){var ee,ue,ce,he,de=this;for(var pe in this.globalProductOperations=z,this.cached=typeof Map!="undefined"?new Map:new g,this.cache=[],this.serializers={},this.serializeProductSet=function(Ce,Ne){if(Ce!==c.empty&&Ce!==c.dense){var Le=Ce,Oe=de.getDims(Le.productOperations);Ne.push(Oe),de.serializeUntypedSparseProductCached(Le.root,Ne,Oe)}else Ne.push(Ce)},this.deserializeProductSet=function(Ce){var Ne=Ce.pop();if(Ne===c.empty||Ne===c.dense)return Ne;Ce.putBack(Ne);for(var Le={},Oe=Ce.pop(),le=0,me=Oe;le<me.length;le++){var Pe=me[le],Re=de.globalProductOperations[Pe];Le[Pe]=Re}return{productOperations:Le,root:de.deserializeUntypedSparseProductCached(Ce,Oe)}},this.serializeUntypedSparse=function(Ce,Ne,Le){Ne.push(Ce==null?void 0:Ce.isExact),Ne.push(de.serializers[Le].serializeBound(Ce==null?void 0:Ce.infimum)),Ne.push(de.serializers[Le].serializeBound(Ce==null?void 0:Ce.supremum));var Oe=W.normalizeKey(Ce==null?void 0:Ce.key);Ne.push(de.serializers[Le].serializeKey(Oe));for(var le=0,me=[Ce==null?void 0:Ce.left,Ce==null?void 0:Ce.right];le<me.length;le++){var Pe=me[le];Pe==null||Pe===c.empty||Pe===c.dense?Ne.push(Pe):(Ne.push("us"),de.serializeUntypedSparseCached(Pe,Ne,Le))}},this.deserializeUntypedSparse=function(Ce,Ne){var Le=Ce.pop(),Oe=de.serializers[Ne].deserializeBound(Ce.pop()),le=de.serializers[Ne].deserializeBound(Ce.pop()),me=de.serializers[Ne].deserializeKey(Ce.pop()),Pe=["left","right"].map(function(Re){var fe=Ce.pop();return fe==="us"?de.deserializeUntypedSparseCached(Ce,Ne):fe});return{infimum:Oe,supremum:le,isExact:Le,key:me,left:Pe[0],right:Pe[1]}},this.serializeUntypedSparseProduct=function(Ce,Ne,Le){Ne.push(Ce.isSubspace);for(var Oe=0,le=Le;Oe<le.length;Oe++){var me=le[Oe],Pe=Ce.bounds[me];de.serializeUntypedSparseCached(Pe,Ne,me)}Ce.isSubspace||(de.serializeUntypedSparseProductCached(Ce.left,Ne,Le),de.serializeUntypedSparseProductCached(Ce.right,Ne,Le),Ne.push(Ce.subspaceCount))},this.deserializeUntypedSparseProduct=function(Ce,Ne){for(var Le=Ce.pop(),Oe={},le=0,me=Ne;le<me.length;le++){var Pe=me[le],Re=de.deserializeUntypedSparseCached(Ce,Pe);Oe[Pe]=Re}return Le?{isSubspace:Le,bounds:Oe}:{isSubspace:Le,bounds:Oe,left:de.deserializeUntypedSparseProductCached(Ce,Ne),right:de.deserializeUntypedSparseProductCached(Ce,Ne),subspaceCount:Ce.pop()}},this.serializeUntypedSparseCached=O(this.serializeUntypedSparse,this.cached),this.deserializeUntypedSparseCached=M(this.deserializeUntypedSparse,this.cache),this.serializeProductSetCached=O(this.serializeProductSet,this.cached),this.deserializeProductSetCached=M(this.deserializeProductSet,this.cache),this.serializeUntypedSparseProductCached=O(this.serializeUntypedSparseProduct,this.cached),this.deserializeUntypedSparseProductCached=M(this.deserializeUntypedSparseProduct,this.cache),z){var _e={serializeKey:(ee=z[pe].serializeKey)!==null&&ee!==void 0?ee:function(Ce){return JSON.stringify(Ce)},deserializeKey:(ue=z[pe].deserializeKey)!==null&&ue!==void 0?ue:function(Ce){return JSON.parse(Ce)},serializeBound:(ce=z[pe].serializeBound)!==null&&ce!==void 0?ce:function(Ce){return JSON.stringify(Ce)},deserializeBound:(he=z[pe].deserializeBound)!==null&&he!==void 0?he:function(Ce){return JSON.parse(Ce)}};this.serializers[pe]=_e}}return W.prototype.getDims=function(z){return Object.keys(z)},W.prototype.serialize=function(z){this.cached.clear();var ee=[];ee.push(z.length);for(var ue=0,ce=z;ue<ce.length;ue++){var he=ce[ue];this.serializeProductSetCached(he,ee)}return JSON.stringify(ee)},W.prototype.deserialize=function(z){this.cache.length=0;for(var ee=new T(JSON.parse(z)),ue=ee.pop(),ce=[],he=0;he<ue;he+=1){var de=this.deserializeProductSetCached(ee);ce.push(de)}return ce},W.normalizeKey=function(z){if(typeof z=="object"){var ee=s.__assign({},z);return delete ee.depth,delete ee.split,ee}return z},W}();t.ProductSetSerializer=K,t.productSetSerializer=function(W){return new K(W)}},5273:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RTree=t.RTKind=t.copyExcept=void 0;var s,c=d(655),l=d(995),f=d(3897);function p(B,k,x){if(x!==void 0){var G=B.slice();return G[k]=x,G}var H=B.slice(0,-1);return k<B.length-1&&(H[k]=B[B.length-1]),H}function m(B,k,x){return{kind:B,key:k,value:x}}function v(B,k){return m(s.Ptr,B,k)}function h(B,k){return m(s.Leaf,B,k)}function S(B,k){return m(s.Branch,B,k)}t.copyExcept=p,function(B){B[B.Ptr=1]="Ptr",B[B.Leaf=2]="Leaf",B[B.Branch=3]="Branch"}(s=t.RTKind||(t.RTKind={}));var y=function(){function B(k,x,G){this.lattice=k,this.root=x,this.count=G}return B.create=function(k,x,G,H,L){L===void 0&&(L=2);var D=L>1?Math.ceil(L):1;return new B({keyJoin:k,keyMeets:x,keyCompare:G,keyDistance:H,minChildren:D,maxChildren:2*D,keyGe:function(V,ne){var J=G(V,ne);return J!==void 0&&J>=0},keyLe:function(V,ne){var J=G(V,ne);return J!==void 0&&J<=0}},void 0,0)},B.prototype.getCount=function(){return this.count},Object.defineProperty(B.prototype,"bounds",{get:function(){var x;return(x=this.root)===null||x===void 0?void 0:x.key},enumerable:!1,configurable:!0}),B.prototype.getValue=function(k){if(this.root!==void 0)return function x(G,H){var L=G.keyCompare(H.key,k);if(H.kind===s.Ptr)return L===0?H.value:void 0;if(!(L===void 0||L<0))for(var D=0,U=H.value;D<U.length;D++){var V=x(G,U[D]);if(V!==void 0)return V}}(this.lattice,this.root)},B.prototype.getEntry=function(k){var x=this.getValue(k);return x===void 0?void 0:(0,f.entry)(k,x)},B.prototype.setValue=function(k,x,G){G===void 0&&(G=function(D){return!0});var H=w(this.lattice,this.root,k,G,x);return H!==void 0?H===this.root?this:new B(this.lattice,H,this.count):new B(this.lattice,F(this.lattice,this.root,v(k,x)),this.count+1)},B.prototype.filter=function(k){var x=new B(this.lattice,void 0,0);return this.forEach(function(G,H){return k(G,H)&&(x=x.setValue(G,H)),!0}),x},B.prototype.contains=function(k,x){return x===void 0&&(x=function(H){return!0}),w(this.lattice,this.root,k,x)!==void 0},B.prototype.getOrSetValue=function(k,x){var G=this.getValue(k);if(G===void 0){var H=x();return[this.setValue(k,H),H]}return[this,G]},B.prototype.forEach=function(k){return C(this.root,k)},B.prototype.forEachGe=function(k,x){var G=this;return C(this.root,x,function(H){return G.lattice.keyGe(H,k)},function(H){return G.lattice.keyGe(H,k)})},B.prototype.forEachLe=function(k,x){var G=this;return C(this.root,x,function(H){return G.lattice.keyMeets(H,k)},function(H){return G.lattice.keyLe(H,k)})},B.prototype.forEachMeets=function(k,x){var G=this;return C(this.root,x,function(H){return G.lattice.keyMeets(H,k)},function(H){return G.lattice.keyMeets(H,k)})},B.prototype.remove=function(k){var x=this;if(this.root==null)return this;var G=[],H=this.lattice,L=function Z(ie,X){var Q=H.keyCompare(ie.key,k);if(Q===void 0||Q<0)return(0,l.pair)(ie,1);if(ie.kind===s.Leaf){for(var b=ie.value,R=0;R<b.length;R+=1)if(H.keyCompare(b[R].key,k)===0){if((A=p(b,R)).length<X){var P=h(ie.key,A);return G.push(P),(0,l.pair)(P,3)}return(0,l.pair)(h(E(H,A),A),2)}}else for(b=ie.value,R=0;R<b.length;R+=1){var A,T=Z(b[R],H.minChildren),g=T[0],O=T[1];if(O===3)return(A=p(b,R)).length>=X?(0,l.pair)(S(E(H,A),A),2):(P=S(ie.key,A),G.push(P),(0,l.pair)(P,3));if(O===2)return(0,l.pair)(S(ie.key,p(b,R,g)),2)}return(0,l.pair)(ie,1)},D=this.root.kind===s.Leaf?1:2,U=L(this.root,D),V=U[0],ne=U[1];if(V===this.root)return this;for(var J=ne===3?void 0:V,$=0;$<G.length;$+=1)C(G[$],function(Z,ie){return J=F(x.lattice,J,v(Z,ie)),!0});return new B(this.lattice,J,this.count-1)},B}();function C(B,k,x,G){var H=x!==void 0?x:function(){return!0},L=G!==void 0?G:function(){return!0};if(B==null)return!0;var D=function U(V){if(!H(V.key))return!0;if(V.kind===s.Leaf)for(var ne=V.value,J=0;J<ne.length;J+=1){var $=ne[J];if(L($.key)&&!k($.key,$.value))return!1}else for(ne=V.value,J=0;J<ne.length;J+=1)if(!U(ne[J]))return!1;return!0};return D(B)}function E(B,k){for(var x=k[0].key,G=1;G<k.length;G+=1)x=B.keyJoin(x,k[G].key);return x}function I(B,k,x){var G=function(D,U){for(var V=function(A,T){for(var g=0,O=1,M=A.keyDistance(T[0].key,T[1].key),K=2;K<T.length;K+=1)for(var W=0;W<K;W+=1){var z=A.keyDistance(T[W].key,T[K].key);z>M&&(g=W,O=K,M=z)}return(0,l.pair)(g,O)}(D,U),ne=V[0],J=V[1],$=U[ne].key,Z=U[J].key,ie=[],X=0;X<U.length;X+=1){var Q=U[X];ie.push([Q,D.keyDistance($,Q.key)-D.keyDistance(Z,Q.key)])}ie.sort(function(A,T){return A[1]-T[1]});for(var b=D.minChildren;b<U.length-D.minChildren&&ie[b][1]<0;b+=1);var R=[],P=[];for(X=0;X<b;X+=1)R.push(ie[X][0]);for(X=b;X<U.length;X+=1)P.push(ie[X][0]);return(0,l.pair)(R,P)}(B,x),H=G[0],L=G[1];return(0,l.pair)(m(k,E(B,H),H),m(k,E(B,L),L))}function F(B,k,x){if(k==null)return h(x.key,[x]);var G=function D(U){if(U.kind===s.Leaf){var V=c.__spreadArray(c.__spreadArray([],U.value,!0),[x],!1);if(V.length>B.maxChildren){var ne=I(B,U.kind,V),J=ne[0],$=ne[1];return(0,l.pair)(h(J.key,J.value),$)}return(0,l.pair)(h(B.keyJoin(U.key,x.key),V),void 0)}var Z=U.value.slice(),ie=function(A,T,g){for(var O=0,M=A.keyDistance(T[0].key,g),K=T[0].value.length,W=1;W<T.length;W+=1){var z=T[W],ee=A.keyDistance(z.key,g);(ee<M||ee===M&&z.value.length<K)&&(O=W,M=ee,K=z.value.length)}return O}(B,Z,x.key),X=D(Z[ie]),Q=X[0],b=X[1];if(Z[ie]=Q,b!=null&&(Z.push(b),Z.length>B.maxChildren)){var R=I(B,U.kind,Z),P=R[0];return $=R[1],(0,l.pair)(S(P.key,P.value),$)}return(0,l.pair)(S(B.keyJoin(U.key,x.key),Z),void 0)}(k),H=G[0],L=G[1];return L!=null?S(B.keyJoin(H.key,L.key),[H,L]):H}function w(B,k,x,G,H){if(k!==void 0)return function D(U){if(U.kind!==s.Leaf){for(V=0;V<U.value.length;V+=1)if(ne=U.value[V],B.keyMeets(ne.key,x)&&(J=D(ne))!==void 0)return S(U.key,p(U.value,V,J))}else for(var V=0;V<U.value.length;V+=1){var ne,J;if((J=L(ne=U.value[V]))!==void 0)return h(U.key,p(U.value,V,J))}}(k);function L(D){if(B.keyCompare(D.key,x)===0)return H!==void 0&&D.value!==H&&G(D.value)?v(D.key,H):D}}t.RTree=y},6328:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RedBlackMapTree=void 0;var s=d(3553),c=function(){function l(f,p,m){this.root=f,this.count=p,this.keyCompare=m}return l.create=function(f){return new l(s.emptyUntyped,0,f)},l.prototype.getCount=function(){return this.count},l.prototype.getValue=function(f){var p=(0,s.findUntyped)(this,f,this.root);return p==null?void 0:p.value},l.prototype.getEntry=function(f){return(0,s.findUntyped)(this,f,this.root)},l.prototype.contains=function(f){return this.getValue(f)!==void 0},l.prototype.forEach=function(f){return(0,s.forEachUntyped)(f,this.root)},l.prototype.setValue=function(f,p){return new l((0,s.insertUntyped)(this,f,p,this.root),this.contains(f)?this.count:this.count+1,this.keyCompare)},l.prototype.remove=function(f){return this.contains(f)?new l((0,s.removeUntyped)(this,f,this.root),this.count-1,this.keyCompare):this},l.prototype.getOrSetValue=function(f,p){var m=this.getValue(f);if(m!==void 0)return[this,m];var v=p();return[new l((0,s.insertUntyped)(this,f,v,this.root),this.count+1,this.keyCompare),v]},l.prototype.filter=function(f){var p=this,m=s.emptyUntyped,v=0;return this.forEach(function(h,S){return f(h,S)&&(m=(0,s.insertUntyped)(p,h,S,m),v+=1),!1}),new l(m,v,this.keyCompare)},l}();t.RedBlackMapTree=c},3553:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.remove=t.removeUntyped=t.insert=t.insertUntyped=t.forEach=t.forEachUntyped=t.find=t.findUntyped=t.empty=t.emptyUntyped=t.isLeaf=t.fromUntyped=t.Color=void 0;var s,c,l=d(3319);(function(J){J[J.Red=0]="Red",J[J.Black=1]="Black"})(s=t.Color||(t.Color={})),function(J){J[J.DoubleBlack=2]="DoubleBlack"}(c||(c={}));var f=s.Red,p=s.Black,m=c.DoubleBlack,v={c:p,l:void 0,r:void 0},h={c:m,l:void 0,r:void 0};function S(J,$){return{ops:J,root:$}}function y(J){return J.l===void 0}function C(J){return J.c===f}function E(J){return J.c===p&&J.l!==void 0}function I(J){return J.c===p&&J.l===void 0}function F(J,$,Z,ie,X){return{c:J,l:$,key:Z,value:ie,r:X}}function w(J,$){return F(J,$.l,$.key,$.value,$.r)}function B(J){return y(J)?v:w(p,J)}function k(J,$,Z){if(!y(Z)){var ie=J.keyCompare($,Z.key);return ie<0?k(J,$,Z.l):ie>0?k(J,$,Z.r):Z}}function x(J,$){return!!y($)||!!x(J,$.l)&&!!J($.key,$.value)&&x(J,$.r)}function G(J,$,Z,ie,X){if(J===p){if(C($)&&C($.l))return F(f,w(p,$.l),$.key,$.value,F(p,$.r,Z,ie,X));if(C(X)&&C(X.r))return F(f,F(p,$,Z,ie,X.l),X.key,X.value,w(p,X.r));if(C($)&&C($.r))return F(f,F(p,$.l,$.key,$.value,$.r.l),$.r.key,$.r.value,F(p,$.r.r,Z,ie,X));if(C(X)&&C(X.l))return F(f,F(p,$,Z,ie,X.l.l),X.l.key,X.l.value,F(p,X.l.r,X.key,X.value,X.r))}if(J===m){if(C(X)&&C(X.l))return F(p,F(p,$,Z,ie,X.l.l),X.l.key,X.l.value,F(p,X.l.r,X.key,X.value,X.r));if(C($)&&C($.r))return F(p,F(p,$.l,$.key,$.value,$.r.l),$.r.key,$.r.value,F(p,$.r.r,Z,ie,X))}return F(J,$,Z,ie,X)}function H(J,$,Z,ie,X){return J===f&&$.c===m&&E(X)?G(p,F(f,B($),Z,ie,X.l),X.key,X.value,X.r):J===f&&E($)&&X.c===m?G(p,$.l,$.key,$.value,F(f,$.r,Z,ie,B(X))):J===p&&$.c===m&&E(X)?G(m,F(f,B($),Z,ie,X.l),X.key,X.value,X.r):J===p&&E($)&&X.c===m?G(m,$.l,$.key,$.value,F(f,$.r,Z,ie,B(X))):J===p&&$.c===m&&C(X)&&E(X.l)?F(p,G(p,F(f,B($),Z,ie,X.l.l),X.l.key,X.l.value,X.l.r),X.key,X.value,X.r):J===p&&C($)&&E($.r)&&X.c===m?F(p,$.l,$.key,$.value,G(p,$.r.l,$.r.key,$.r.value,F(f,$.r.r,Z,ie,B(X)))):((0,l.assertTrue)("calc.common.rbTree.rotate: expected R|B",$.c!==m&&X.c!==m),F(J,$,Z,ie,X))}function L(J,$,Z,ie){if(y(ie))return F(f,v,$,Z,v);var X=J.keyCompare($,ie.key);return X<0?G(ie.c,L(J,$,Z,ie.l),ie.key,ie.value,ie.r):X>0?G(ie.c,ie.l,ie.key,ie.value,L(J,$,Z,ie.r)):F(ie.c,ie.l,$,Z,ie.r)}function D(J,$,Z,ie){return function(X){return!C(X)||X.l.c!==f&&X.r.c!==f?X:w(p,X)}(L(J,$,Z,ie))}function U(J,$,Z){if(y(Z))return Z;if(Z.c===f&&I(Z.l)&&I(Z.r))return J.keyCompare($,Z.key)===0?v:Z;if(Z.c===p&&I(Z.l)&&I(Z.r))return J.keyCompare($,Z.key)===0?h:Z;if(Z.c===p&&C(Z.l)&&I(Z.l.l)&&I(Z.l.r)&&I(Z.r)){var ie=J.keyCompare($,Z.key);return ie<0?F(p,U(J,$,Z.l),Z.key,Z.value,v):ie>0?Z:F(p,v,Z.l.key,Z.l.value,v)}var X=J.keyCompare($,Z.key);if(X<0)return H(Z.c,U(J,$,Z.l),Z.key,Z.value,Z.r);if(X>0)return H(Z.c,Z.l,Z.key,Z.value,U(J,$,Z.r));(0,l.assertTrue)("calc.common.rbTree.rem: expected node",!y(Z.r));var Q=V(Z.r),b=Q[0],R=Q[1],P=Q[2];return H(Z.c,Z.l,b,R,P)}function V(J){if(J.c===f&&I(J.l)&&I(J.r))return[J.key,J.value,v];if(J.c===p&&I(J.l)&&I(J.r))return[J.key,J.value,h];if(J.c===p&&I(J.l)&&C(J.r))return[J.key,J.value,w(p,J.r)];(0,l.assertTrue)("calc.common.rbTree.remMin: expected node",!y(J.l));var $=V(J.l),Z=$[0],ie=$[1],X=$[2];return[Z,ie,H(J.c,X,J.key,J.value,J.r)]}function ne(J,$,Z){var ie=U(J,$,function(X){return E(X)&&X.l.c===p&&X.r.c===p?w(f,X):X}(Z));return(0,l.assertTrue)("calc.common.rbTree.remove: expected R|B",ie.c===f||ie.c===p),ie}t.fromUntyped=S,t.isLeaf=y,t.emptyUntyped=v,t.empty=function(J){return S(J,t.emptyUntyped)},t.findUntyped=k,t.find=function(J,$){return k($.ops,J,$.root)},t.forEachUntyped=x,t.forEach=function(J,$){return x(J,$.root)},t.insertUntyped=D,t.insert=function(J,$,Z){return S(Z.ops,D(Z.ops,J,$,Z.root))},t.removeUntyped=ne,t.remove=function(J,$){return S($.ops,ne($.ops,J,$.root))}},8627:function(u,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RingBuffer=void 0;var d=function(){function s(c){c===void 0&&(c=1/0),this.list=c<1/0?new Array(c):new Array,this.counter=0,this.capacity=c,this.readIndex=0,this.writeIndex=0}return s.prototype.count=function(){return this.counter},s.prototype.isEmpty=function(){return this.counter===0},s.prototype.enqueue=function(c){this.list[this.writeIndex]=c,this.counter!==0&&this.writeIndex===this.readIndex?this.readIndex=(this.readIndex+1)%this.capacity:this.counter++,this.writeIndex=(this.writeIndex+1)%this.capacity},s.prototype.dequeue=function(){if(!this.isEmpty()){var c=this.list[this.readIndex];return this.list[this.readIndex]=void 0,this.readIndex=(this.readIndex+1)%this.capacity,this.counter--,c}},s.prototype.executeOnEveryElement=function(c){for(var l=0;l<this.counter;l++){var f=(this.readIndex+l)%this.capacity,p=this.list[f];if(p!==void 0&&!c(p))return!1}return!0},s}();t.RingBuffer=d},4150:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.boundedParetoSetOperations=t.boundedParetoSplitter=t.boundedPareto=void 0;var s=d(995),c=d(8124);function l(p,m,v){var h=Math.pow(m,p),S=1-Math.pow(m/v,p),y=Math.pow(v,p),C=y*h,E=y-h,I=-1/p;return{cdf:p===1?function(F){return(1-h/F)/S}:function(F){return(1-h*Math.pow(F,-p))/S},invCdf:p===1?function(F){return 1/((y-F*E)/C)}:function(F){return Math.pow((y-F*E)/C,I)}}}function f(p,m,v){var h=l(p,m,v);return{canSplit:function(y){var C=y[0];return y[1]-C>1},split:function(y){var C=y[0],E=y[1],I=h.cdf(E),F=h.cdf(C+1),w=h.invCdf((I+F)/2),B=(0,s.fastMin)((0,s.fastMax)(Math.round(w),C+1),E-1);return[[[C,B],h.cdf(B)-h.cdf(C+1)],[[B,E],h.cdf(E)-h.cdf(B)]]}}}t.boundedPareto=l,t.boundedParetoSplitter=f,t.boundedParetoSetOperations=function(p,m,v,h,S){var y=f(p,m,v);return{id:S,split:function(E){return y.split(E)},canSplit:function(E){return y.canSplit(E)},meets:c.ivlMeets,intersect:c.ivlMeet,union:function(E,I){return(0,c.ivlMeetsOrTouches)(E,I)?(0,c.ivlJoin)(E,I):void 0},except:c.ivlExcept,compare:c.ivlCompare,top:h,infimum:function(E){return E[0]},supremum:function(E){return E[1]},combineInfima:function(E,I){return(0,s.fastMin)(E,I)},combineSuprema:function(E,I){return(0,s.fastMax)(E,I)}}}},3897:function(u,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.entry=t.makeEmptyTable=void 0;var d={getCount:function(){return 0},getValue:function(){},getEntry:function(){},contains:function(){return!1},forEach:function(){return!0}};t.makeEmptyTable=function(){return d},t.entry=function(s,c){return{key:s,value:c}}},1757:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logCollisionKey=void 0;var s=d(1821),c=d(3319),l={},f=0;t.logCollisionKey=function(p){var m,v;m=function(h){return typeof h=="object"?h===null?"null":"Object {".concat(Object.keys(h),"}"):typeof h}(p),v=l[m],l[m]=(v===void 0?0:v)+1,(f+=1)%100==0&&(c.ulsLogger.ULS.traceTag(595858520,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"calc.common.hashUtils.logCollision: ".concat(JSON.stringify(l),".")),l={})}},3854:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isTypedChangeGateEnabled=t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;var s,c=d(3319),l=d(1821),f=d(5550);(function(S){S.FeatureCheckingEnabled="FeatureCheckingEnabled",S.CalcPreventSpillingHack="CalcPreventSpillingHack",S.CalcLegacyImplicitIntersection="CalcLegacyImplicitIntersection",S.CalcRecordFunctions="CalcRecordFunctions",S.CalcNestedRecordFunction="CalcNestedRecordFunction",S.CalcLetRecFunction="CalcLetRecFunction",S.CalcLambdaFunction="CalcLambdaFunction",S.CalcLambdaBasicFunctions="CalcLambdaBasicFunctions",S.CalcLambdaHelperFunctions="CalcLambdaHelperFunctions",S.CalcLambdaOptionalParameters="CalcLambdaOptionalParameters",S.CalcLambdaDefaultParameters="CalcLambdaDefaultParameters",S.CalcLambdaCellValues="CalcLambdaCellValues",S.CalcLambdaArrayLifting="CalcLambdaArrayLifting"})(s=t.FeatureName||(t.FeatureName={}));var p=function(y){var C="calc.common.isFeatureEnabledCallback: called with ".concat(y," before initCalc");return c.ulsLogger.ULS.traceTag(526989323,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Warning,C),!1},m={};function v(S){return m[S]===void 0&&(m[S]=p(S)),m[S]}t.initFeatureConfiguration=function(S){typeof S=="function"&&(p=S)},t.isFeatureEnabled=v,t.getFeatures=function(){var S={};for(var y in s){var C=s[y];C!=null&&(S[C]=v(C))}return S},t.getTypedFeatureGate=(0,f.makeGetTypedFeatureGate)({"Microsoft.Office.Excel.ProseFormulaRepairExperimentLogBuggyIsEnabled":!1,"Microsoft.Office.Excel.ProseFormulaRepairExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSDemoFeatureGateString":"DummyStringValue","Microsoft.Office.Excel.CalcTSDemoFeatureGateInt":42,"Microsoft.Office.Excel.CalcTSDemoFeatureGateBoolean":!1,"Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSUnitExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSExceLintExperimentIsEnabled":!1,"Microsoft.Office.Excel.SmartFormulaBarAutocompleteIsEnabled":!1,"Microsoft.Office.Excel.SmartFormulaBarUseDevScheduler":!1,"Microsoft.Office.Excel.x10DoNotThrowOnDoublePluginRegistration":!0,"Microsoft.Office.Excel.ProductSetBugFixFromPR1043532":!0,"Microsoft.Office.ExcelOnline.ArgumentAssistancePlugin":!1,"Microsoft.Office.Excel.AutocompleteRangeSuggestionPlugin":!1,"Microsoft.Office.Excel.x10AutocompletionPrecisionMeasurementsIsEnabled":!1,"Microsoft.Office.Excel.x10AutocompletionAuthoringPrecisionMeasurementsIsEnabled":!1,"Microsoft.Office.Excel.x10AutocompleteWrapperPluginIsEnabled":!1,"Microsoft.Office.Excel.x10AutocompleteBinaryModelExperimentPlugin":!1,"Microsoft.Office.Excel.x10AutocompleteGroundTruthMeasurementsIsEnabled":!1,TESTING_ONLY_RECALC_SERVICE_IMPORTSCRIPTS_FAIL:!1,TESTING_ONLY_SCHEDULER_IMPORTSCRIPTS_FAIL:!1,TESTING_ONLY_TEST_PLUGIN_IMPORTSCRIPTS_FAIL:!1,"Microsoft.Office.Excel.FormulaAssistanceRedesign":!1,"Microsoft.Office.Excel.ParenthesesCoupling":!1,"Microsoft.Office.Excel.ColoredReferences":!1,"Microsoft.Office.Excel.FormulaCollection":!1,"Microsoft.Office.Excel.FormulaAssistanceValuePreview":!1,"Microsoft.Office.Excel.x10ParserPerformanceMeasurements":!1,"Microsoft.Office.Excel.ArgumentAssistanceOnMainThread":!1,"Microsoft.Office.Excel.AutoCompleteOnMainThread":!1,"Microsoft.Office.Excel.UnitlessTimeAndDate":!1,"Microsoft.Office.Excel.UnitExpIgnoreDivMul":!1,"Microsoft.Office.Excel.x10PythonAutocompletionEnabled":!1,"Microsoft.Office.Excel.MockWorkerThreadPlugin":!1,"Microsoft.Office.Excel.EnableFullSessionLogging":!1,"Microsoft.Office.Excel.UseAggregatedLogging":!1,"Microsoft.Office.Excel.SyntaxErrors":!1,"Microsoft.Office.Excel.ChatGPTPluginEnabled":!1});var h=d(5550);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return h.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return h.setFeatureGateDictionaryGetter}}),t.isTypedChangeGateEnabled=(0,f.makeTypedIsChangeGateEnabled)(["OfficeVSO:XXX_TestChangeGate","Microsoft.Office.Excel.ChangeGate.PreciseNowForNodeJS","OfficeVSO:6409219_addPluginNameToPluginDataLog","OfficeVSO:6476056_OnlySendNestedDotNotationPath","Microsoft.Office.Excel.ChangeGate.ParseEditEqFix","Microsoft.Office.Excel.ChangeGate.RCBracketFix","Microsoft.Office.Excel.ChangeGate.LocErrorTokensFix","Microsoft.Office.Excel.ChangeGate.BadlyNestedBracketsFix","OfficeVSO:7125313_handleUnavailableFormat","OfficeVSO:7396249_getTableHeadersFromServer","OfficeVSO:7536593_resolveCorrelatedRequestsWithNoPlugins","OfficeVSO:7549315_ArgumentAssistance"])},2856:function(u,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findIsomorphicSubtrees=void 0,t.findIsomorphicSubtrees=function(d,s,c,l){c===void 0&&(c=function(){return""}),l===void 0&&(l=function(){return 1});for(var f=[d],p=new Set(f),m=0;m<f.length;m+=1)for(var v=0,h=s(f[m]);v<h.length;v++){var S=h[v];p.has(S)||(p.add(S),f.push(S))}p.clear(),f.reverse();var y=new Map,C=[],E=new Map,I=[];f.forEach(function(H,L){var D=s(H).map(function(X){return y.get(X)});if(D.some(function(X){return X===void 0}))throw new Error("Circular references in the tree");var U,V,ne=D.map(function(X){return C[X]}),J=(U=ne.join("/")+"/"+c(H),(V=E.get(U))!==void 0||(V=E.size,E.set(U,V)),V);if(C.push(J),I[J]===void 0){var $=ne.map(function(X){return I[X]}),Z=$.map(function(X){return X.size}).reduce(function(X,Q){return X+Q},l(H)),ie=$.map(function(X){return X.depth}).reduce(function(X,Q){return Math.max(X,Q)},0)+1;I[J]={subtrees:[H],size:Z,depth:ie}}else I[J].subtrees.push(H);y.set(H,L)});for(var F=0,w=I;F<w.length;F++)(G=w[F]).subtrees.reverse();for(var B=new Array(f.length),k=0,x=I;k<x.length;k++){var G=x[k];B[B.length-y.get(G.subtrees[0])-1]=G}return B.filter(function(H){return H!==void 0})}},3551:function(u,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fnv1a=void 0,t.fnv1a=function(d){for(var s=2166136261,c=d.length,l=0;l<c;l+=1)s^=d.charCodeAt(l),s+=(s<<1)+(s<<4)+(s<<7)+(s<<8)+(s<<24);return s>>>0}},3971:function(u,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.excelOnlineCalcPackageVersion=void 0,t.excelOnlineCalcPackageVersion="37.2.0"},637:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.revocableSingleton=t.testUtils=t.pledge=t.machine=t.testConfig=t.arrayLogger=t.wrapIntoAsyncModule=t.unicode=t.result=t.mixin=t.promise=t.stopwatch=t.resolvablePromise=t.config=t.codePoint=t.setTimeoutInterfaceModule=t.asyncLoopModule=t.async=t.arrayUtils=t.table=t.split=t.rTree=t.ringBuffer=t.rbTree=t.rbMapTree=t.productSet=t.priorityQueue=t.interval=t.histogram=t.hashTable=t.hashSet=t.dictionary=t.deque=t.bspSet=t.binaryHeap=t.arrayMapTree=t.testUtil=t.core=t.featureConfiguration=t.assertions=t.util=t.anonymizer=t.combinations=t.findIsomorphicSubtrees=t.JSF32=t.fnv1a=t.PackageName=void 0,t.PackageName="excel-online-calc-common";var s=d(3551);Object.defineProperty(t,"fnv1a",{enumerable:!0,get:function(){return s.fnv1a}});var c=d(1357);Object.defineProperty(t,"JSF32",{enumerable:!0,get:function(){return c.JSF32}});var l=d(2856);Object.defineProperty(t,"findIsomorphicSubtrees",{enumerable:!0,get:function(){return l.findIsomorphicSubtrees}});var f=d(9574);Object.defineProperty(t,"combinations",{enumerable:!0,get:function(){return f.combinations}});var p=d(8908);t.anonymizer=p;var m=d(8515);t.util=m;var v=d(3319);t.assertions=v;var h=d(3854);t.featureConfiguration=h;var S=d(995);t.core=S;var y=d(6745);t.testUtil=y;var C=d(1612);t.arrayMapTree=C;var E=d(3870);t.binaryHeap=E;var I=d(1937);t.bspSet=I;var F=d(2276);t.deque=F;var w=d(6348);t.dictionary=w;var B=d(4642);t.hashSet=B;var k=d(1569);t.hashTable=k;var x=d(8114);t.histogram=x;var G=d(8124);t.interval=G;var H=d(7213);t.priorityQueue=H;var L=d(5100);t.productSet=L;var D=d(6328);t.rbMapTree=D;var U=d(3553);t.rbTree=U;var V=d(8627);t.ringBuffer=V;var ne=d(5273);t.rTree=ne;var J=d(4150);t.split=J;var $=d(3897);t.table=$,t.arrayUtils=d(1826),t.async=d(8314),t.asyncLoopModule=d(6058),t.setTimeoutInterfaceModule=d(2122),t.codePoint=d(3387),t.config=d(8994),t.resolvablePromise=d(245),t.stopwatch=d(4782),t.promise=d(6757);var Z=d(4553);Object.defineProperty(t,"mixin",{enumerable:!0,get:function(){return Z.mixin}}),t.result=d(2443),t.unicode=d(3758),t.wrapIntoAsyncModule=d(6988),t.arrayLogger=d(2005),t.testConfig=d(1080),t.machine=d(5530),t.pledge=d(883),t.testUtils=d(1985),t.revocableSingleton=d(5534)},1357:function(u,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSF32=void 0;var d=function(l,f){return(l<<f|l>>>32-f)>>>0},s=function(){function c(l){this.x=new Uint32Array([4058668781,l,l,l]);for(var f=0;f<20;f+=1)this.nextU32()}return c.prototype.next=function(){return this.nextU32()*23283064365386963e-26},c.prototype.nextU32=function(){var l=this.x[0]-d(this.x[1],27)>>>0;return this.x[0]=(this.x[1]^d(this.x[2],17))>>>0,this.x[1]=this.x[2]+this.x[3]>>>0,this.x[2]=this.x[3]+l>>>0,this.x[3]=l+this.x[0]>>>0},c}();t.JSF32=s},1071:function(u,t){"use strict";var d;Object.defineProperty(t,"__esModule",{value:!0}),t.mathLog2=void 0,t.mathLog2=(d=Math.log2)!==null&&d!==void 0?d:function(s){return Math.log(s)*Math.LOG2E}},4553:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mixin=void 0;var s=d(655),c=0;t.mixin=function(l,f,p){for(var m,v=((m="___mixinField")===void 0&&(m=""),m+(c+=1).toString()),h={},S=function(F){h[F]=function(){for(var w,B=[],k=0;k<arguments.length;k++)B[k]=arguments[k];var x=this[v];return(w=x[F]).call.apply(w,s.__spreadArray([x],B,!1))}},y=0,C=p;y<C.length;y++)S(C[y]);var E=function(I){function F(){for(var w=[],B=0;B<arguments.length;B++)w[B]=arguments[B];for(var k=I.apply(this,w)||this,x=f(k),G=0,H=p;G<H.length;G++){var L=H[G];Object.defineProperty(k,L,{value:h[L],enumerable:!1,configurable:!1})}return k[v]=x,k}return s.__extends(F,I),F}(l);return E}},6757:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.collapseThenable=t.bindMaybeThenable=t.isThenable=t.promiseLoop=t.newPromise=t.promiseFinally=void 0;var s=d(995);function c(l){return(0,s.isDefined)(l)&&typeof l.then=="function"}t.promiseFinally=function(l,f){return l.then(function(p){return f(),p},function(p){return f(),Promise.reject(p)})},t.newPromise=function(){var l;return[new Promise(function(f,p){return l=[f,p]}),l]},t.promiseLoop=function(l,f){var p;return new Promise(function(m,v){Promise.resolve(f).then(function h(S){if(S!==void 0){p=S;try{Promise.resolve(l(p)).then(h,v)}catch(y){v(y)}}else m(p)},v)})},t.isThenable=c,t.bindMaybeThenable=function(l,f,p){return c(l)?l.then(f,p):f(l)},t.collapseThenable=function(l){return l}},245:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResolvablePromise=void 0;var s=d(6757),c=function(){function l(){var f=this;this.promise=new Promise(function(p,m){f._resolve=p,f._reject=m})}return l.prototype.then=function(f,p){return this.promise.then(f,p)},l.prototype.toPromise=function(){return this.promise},l.prototype.resolve=function(f){return this._resolve(f),(0,s.isThenable)(f)?this.promise.then():void 0},l.prototype.reject=function(f){return this._reject(f),(0,s.isThenable)(f)?this.promise.then():void 0},l}();t.ResolvablePromise=c},2443:function(u,t){"use strict";var d,s;function c(l){return{kind:d.Success,value:l}}Object.defineProperty(t,"__esModule",{value:!0}),t.javaScriptError=t.ReasonKind=t.isSuccess=t.failure=t.successUndefined=t.success=t.ResultKind=void 0,function(l){l.Success="Success",l.Failure="Failure",l.Paused="Paused",l.Breaked="Breaked"}(d=t.ResultKind||(t.ResultKind={})),t.success=c,t.successUndefined=c(void 0),t.failure=function(l){return{kind:d.Failure,reason:l}},t.isSuccess=function(l){return l.kind===d.Success},function(l){l.JavaScriptError="JavaScriptError"}(s=t.ReasonKind||(t.ReasonKind={})),t.javaScriptError=function(l){return{kind:s.JavaScriptError,error:l}}},5530:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AllMachine=t.MachineRuntime=t.MachineCycle=t.nextOnSuccessReceiver=t.callMachineTransition=t.breakTransition=t.nextTransition=t.TransitionKind=void 0;var s,c=d(655),l=d(2443);function f(y,C,E){return{kind:y,machine:C,receiver:E}}function p(y,C){return f(s.CallMachine,y,C)}(function(y){y[y.Next=1]="Next",y[y.CallMachine=2]="CallMachine",y[y.Break=3]="Break"})(s=t.TransitionKind||(t.TransitionKind={})),t.nextTransition=f(s.Next,void 0,void 0),t.breakTransition=f(s.Break,void 0,void 0),t.callMachineTransition=p;var m={receiveResult:function(C){return(0,l.isSuccess)(C)?t.nextTransition:C}};t.nextOnSuccessReceiver=function(){return m};var v=function(y){function C(E,I){var F=this.constructor,w=y.call(this,"Cycle detected: tried to call an already-running Machine")||this;w.machine=E,w.stackDepth=I;var B=F.prototype;return Object.getPrototypeOf(w)!==B&&(Object.setPrototypeOf!=null?Object.setPrototypeOf(w,B):w.__proto__=B),w}return c.__extends(C,y),C}(Error);t.MachineCycle=v;var h=function(){function y(C){this.numSteps=0,this.stack=[];try{this.pushFrame(p(C,{receiveResult:function(I){return I}})),this.transition=t.nextTransition}catch(E){this.transition=(0,l.failure)((0,l.javaScriptError)(E))}}return y.resetStats=function(){y.maxStackDepth=0,y.numPauses=0,y.numCycles=0},y.prototype.pushFrame=function(C){var E=this.stack.length,I=C.machine;if(I.runStatus===!0)throw y.numCycles+=1,new v(I,E);I.runStatus===!1&&(I.runStatus=!0),this.stack.push(C),y.maxStackDepth<E+1&&(y.maxStackDepth=E+1)},y.prototype.advanceTopFrame=function(){var C=this.stack[this.stack.length-1].machine;return typeof C.runStatus!="boolean"?C.runStatus:C.next()},y.prototype.step=function(){this.numSteps+=1;var C=this.transition;try{switch(C.kind){case s.Next:return this.transition=this.advanceTopFrame(),t.nextTransition;case s.CallMachine:return this.pushFrame(C),this.transition=this.advanceTopFrame(),t.nextTransition;case s.Break:return this.transition=t.nextTransition,C;default:var E=this.stack.pop();return E?(E.machine.runStatus=C,this.transition=E.receiver.receiveResult(C),t.nextTransition):C}}catch(I){return this.transition=(0,l.failure)((0,l.javaScriptError)(I)),t.nextTransition}},y.prototype.run=function(C){if(C===void 0&&(C=function(){return!1}),this.result)return this.result;try{for(;;){var E=this.step();if(E.kind===s.Break)return E;if(E.kind!==s.Next)return this.result=E;if(C())return y.numPauses+=1,E}}catch(I){return this.result=(0,l.failure)((0,l.javaScriptError)(I))}},y.prototype.runToResult=function(){for(;;){var C=this.run();if(C.kind!==s.Break)return C}},y.maxStackDepth=0,y.numPauses=0,y.numCycles=0,y}();t.MachineRuntime=h;var S=function(){function y(C){this.machines=C,this.runStatus=!1,this.values=[]}return y.prototype.next=function(){return this.values.length<this.machines.length?p(this.machines[this.values.length],this):(0,l.success)(this.values)},y.prototype.receiveResult=function(C){return(0,l.isSuccess)(C)?(this.values.push(C.value),this.next()):C},y}();t.AllMachine=S},883:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pledge=void 0;var s=d(5530),c=d(2443),l=function(){function f(p,m,v){this.transition=p,this.onFulfilled=m,this.onRejected=v,this.runStatus=!(p instanceof f||p.kind===s.TransitionKind.CallMachine)&&p}return f.prototype.setState=function(p,m,v){return this.onFulfilled=m,this.onRejected=v,this.transition=p,p},f.prototype.next=function(){return this.transition instanceof f?this.transition=(0,s.callMachineTransition)(this.transition,this):this.transition},f.prototype.receiveResult=function(p){var m;try{if((0,c.isSuccess)(p)){if(!this.onFulfilled)return this.setState(p,void 0,void 0);m=this.onFulfilled(p.value)}else{if(!this.onRejected)return this.setState(p,void 0,void 0);m=this.onRejected(p.reason)}}catch(v){return this.setState((0,c.failure)((0,c.javaScriptError)(v)),void 0,void 0)}return m instanceof f?(this.setState(m.transition,m.onFulfilled,m.onRejected),m.setState(this,void 0,void 0),this.next()):this.setState((0,c.success)(m),void 0,void 0)},f.prototype.bind=function(p){return new f(this,p,void 0)},f.prototype.catch=function(p){return new f(this,void 0,p)},f.prototype.finally=function(p){return new f(this,function(m){return p(),m},function(m){return p(),f.reject(m)})},f.all=function(p){return f.fromMachine(new s.AllMachine(p.map(f.resolve)))},f.prototype.settle=function(){return new s.MachineRuntime(this).runToResult()},f.settleOrThrow=function(p){var m=p.settle();if((0,c.isSuccess)(m))return m.value;throw m.reason.error},f.resolve=function(p){return p instanceof f?p:new f((0,c.success)(p),void 0,void 0)},f.reject=function(p){return new f((0,c.failure)(p),void 0,void 0)},f.undefinedPledge=f.resolve(void 0),f.fromMachine=function(p){if(p instanceof f)return p;var m=new f(f.undefinedPledge,void 0,void 0);return m.transition=(0,s.callMachineTransition)(p,m),m},f.try=function(p){return f.undefinedPledge.bind(p)},f.RepeatMachine=function(){function p(m,v){this.onLoop=m,this.accum=v,this.runStatus=!1}return p.prototype.next=function(){var m=this.onLoop(this.accum);return m instanceof f?(0,s.callMachineTransition)(m,this):this.receiveSuccess(m)},p.prototype.receiveResult=function(m){return(0,c.isSuccess)(m)?this.receiveSuccess(m.value):m},p.prototype.receiveSuccess=function(m){return m===void 0?(0,c.success)(this.accum):(this.accum=m,s.nextTransition)},p}(),f.repeat=function(p,m){return f.resolve(m).bind(function(v){return f.fromMachine(new f.RepeatMachine(p,v))})},f}();t.Pledge=l},1985:function(u,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.throwAfterSteps=t.pauseAfterSteps=void 0,t.pauseAfterSteps=function(d){var s=Math.max(1,Math.floor(d)),c=0;return function(){return(c+=1)>=s}},t.throwAfterSteps=function(d){var s=Math.max(1,Math.floor(d)),c=0;return function(){if((c+=1)<s)return!1;throw s}}},2122:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultSetTimeoutInterface=t.clearTimerUnified=t.setImmediateUnified=void 0;var s=d(655),c=d(3319);function l(p){for(var m=[],v=1;v<arguments.length;v++)m[v-1]=arguments[v];return{kind:"Immediate",timer:setImmediate.apply(void 0,s.__spreadArray([p],m,!1))}}function f(p){switch(p.kind){case"Immediate":clearImmediate(p.timer);break;case"Timeout":clearTimeout(p.timer);break;case"Mocking":p.delayedCallback.isValid=!1;break;default:(0,c.assertNever)("unknown timer.kind",p)}}t.setImmediateUnified=l,t.clearTimerUnified=f,t.defaultSetTimeoutInterface={setImmediate:l,setTimeout:function(p){function m(v,h){return p.apply(this,arguments)}return m.toString=function(){return p.toString()},m}(function(p,m){for(var v=[],h=2;h<arguments.length;h++)v[h-2]=arguments[h];return{kind:"Timeout",timer:setTimeout.apply(void 0,s.__spreadArray([p,m],v,!1))}}),clearImmediate:f,clearTimeout:f}},4782:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatch=t.ulsStopwatchFactory=void 0;var s=d(1821),c={ULS:new s.NulLogger};t.ulsStopwatchFactory=(0,s.initStopwatchFactory)(function(l){return c.ULS.traceTag(595948114,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,l)}),t.initStopwatch=function(l){c.ULS=l}},6745:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomElement=t.randomShuffled=t.randomIndex=t.randomFloat=void 0;var s,c=d(3319),l=d(1357),f=(s=process.env.BUILD_BUILDID!=null?.4531024141007942:Math.random()*Date.now(),new l.JSF32(s));function p(m){return(0,c.assertTrue)("calc.common.randomIndex",m>0),Math.min(m-1,Math.floor(f.next()*m))}t.randomFloat=function(){return f.next()},t.randomIndex=p,t.randomShuffled=function(m){return m.map(function(v){return[f.next(),v]}).sort(function(v,h){return v[0]<h[0]?-1:v[0]===h[0]?0:1}).map(function(v){return v[1]})},t.randomElement=function(m){return m[p(m.length)]}},2005:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createArrayLogger=void 0;var s=d(655);t.createArrayLogger=function(c,l,f){c===void 0&&(c=!1),l===void 0&&(l=function(){return!0});var p=new Set,m=new Set;return{log:[],addTriggerListener:function(h){p.add(h)},waitForMessage:function(h,S){var y=this;return new Promise(function(C){var E=setTimeout(function(){console.warn("ArrayLogger.waitForMessage: timed out waiting for message; timeout = ".concat(S)),C(!1)},S);y.addTriggerListener(function(I){var F=h(I);return F&&(clearTimeout(E),C(!0)),F})})},waitForReceivedButDelayedMessages:function(){var h=[];return m.forEach(function(S){return h.push(S)}),Promise.all(h).then(function(){})},addLogMessage:function(h){var S=this;if(l(h)){var y=new Promise(function(C){var E;E=function(){S.log.push(h),c&&console.log.apply(console,s.__spreadArray([new Date().toISOString()],h,!1)),p.forEach(function(F){F(h)&&p.delete(F)}),C()},f===void 0?E():setTimeout(function(){return E()},f)}).then(function(){m.delete(y)});m.add(y)}},shipAssertTag:function(){for(var h=[],S=0;S<arguments.length;S++)h[S]=arguments[S];this.addLogMessage(["shipAssertTag",h]);var y=h[2],C=h[3];if(!y)throw new TypeError("shipAssertTag: ".concat(C))},assertTag:function(){for(var h=[],S=0;S<arguments.length;S++)h[S]=arguments[S];this.addLogMessage(["assertTag",h]);var y=h[2],C=h[3];if(!y)throw new TypeError("assertTag: ".concat(C))},traceTag:function(){for(var h=[],S=0;S<arguments.length;S++)h[S]=arguments[S];this.addLogMessage(["traceTag",h])},dnmTraceTag:function(){for(var h=[],S=0;S<arguments.length;S++)h[S]=arguments[S];this.addLogMessage(["dnmTraceTag",h])},debugTraceTag:function(){for(var h=[],S=0;S<arguments.length;S++)h[S]=arguments[S];this.addLogMessage(["debugTraceTag",h])}}}},1080:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.featureEnabledDummyCallback=t.AssertLogger=t.ConsoleLogger=void 0;var s=d(3854),c=function(){function f(){}return f.prototype.shipAssertTag=function(p,m,v,h){if(console.assert(v,"shipAssertTag2 ".concat(p," ").concat(m," ").concat(h)),!v)throw new Error("shipAssertTag2 ".concat(p," ").concat(m," ").concat(h))},f.prototype.assertTag=function(p,m,v,h){if(console.assert(v,"assertTag2 ".concat(p," ").concat(m," ").concat(h)),!v)throw new Error("assertTag2 ".concat(p," ").concat(m," ").concat(h))},f.prototype.traceTag=function(p,m,v,h){console.log("traceTag2",p,h,m,v)},f.prototype.dnmTraceTag=function(p,m,v,h){console.log("dnmTraceTag2",p,h,m,v)},f.prototype.debugTraceTag=function(p,m,v,h){console.log("debugTraceTag2",p,h,m,v)},f}();t.ConsoleLogger=c;var l=function(){function f(){this.traceTag=function(){},this.debugTraceTag=function(){},this.dnmTraceTag=function(){}}return f.prototype.shipAssertTag=function(p,m,v,h){if(!v)throw new Error("shipAssertTag2 ".concat(p," ").concat(m," ").concat(h))},f.prototype.assertTag=function(p,m,v,h){if(!v)throw new Error("assertTag2 ".concat(p," ").concat(m," ").concat(h))},f}();t.AssertLogger=l,t.featureEnabledDummyCallback=function(f){switch(f){case s.FeatureName.FeatureCheckingEnabled:case s.FeatureName.CalcRecordFunctions:case s.FeatureName.CalcNestedRecordFunction:case s.FeatureName.CalcLetRecFunction:case s.FeatureName.CalcLambdaFunction:case s.FeatureName.CalcLambdaBasicFunctions:case s.FeatureName.CalcLambdaHelperFunctions:case s.FeatureName.CalcLambdaOptionalParameters:case s.FeatureName.CalcLambdaDefaultParameters:case s.FeatureName.CalcLambdaCellValues:case s.FeatureName.CalcLambdaArrayLifting:return!0;default:return f.startsWith("OfficeVSO:")}}},5534:function(u,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RevocableSingleton=void 0;var d=function(){function c(l,f){var p=this;this.target=l,this.isRevoked=!1;var m=function(h){if(p.isRevoked)throw new TypeError("".concat(String(h),": ").concat(f))};this.proxy=typeof Proxy=="undefined"?l:new Proxy(l,{get:function(h,S,y){return m(S),Reflect.get(h,S,y)},set:function(h,S,y,C){return m(S),Reflect.set(h,S,y,C)}})}return c.prototype.revoke=function(){this.isRevoked=!0},c}(),s=function(){function c(l){this.message=l}return c.prototype.getInstance=function(){var l;return(l=this.instance)===null||l===void 0?void 0:l.proxy},c.prototype.setInstance=function(l){var f;return(f=this.instance)===null||f===void 0||f.revoke(),l===void 0?this.instance=void 0:(this.instance=new d(l,this.message),this.instance.proxy)},c.prototype.revokeInstance=function(){if(this.instance)return this.instance.revoke(),this.instance=new d(this.instance.target,this.message),this.instance.proxy},c}();t.RevocableSingleton=s},3758:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetCharCodeBits=t.forEachClassInterval=t.CharCodeBits=t.codePointIterator=t.numCodeUnits=t.stringCodePointAt=t.countCodePoints=t.scanCodePointsBack=t.scanCodePoints=t.stringFromCodePoint=t.surrogatePairToCodePoint=t.isAnySurrogate=t.isLowSurrogate=t.isHighSurrogate=void 0;var s,c=d(995);function l(y){return(64512&y)==55296}function f(y){return(64512&y)==56320}function p(y){return(63488&y)==55296}function m(y,C){if(l(y)&&f(C))return 65536+((1023&y)<<10|1023&C)}function v(y,C){var E=y.charCodeAt(C);if(!p(E))return E;if(C+1>=y.length)return 65533;var I=m(E,y.charCodeAt(C+1));return I??65533}function h(y){return y>=65536?2:1}function S(y,C){if((1&y.length)==1)throw new Error("Invalid class length");for(var E=0;E<y.length;E+=2)for(var I=y[E],F=y[E+1],w=I;w<F;w+=1)C(w,I,F)}t.isHighSurrogate=l,t.isLowSurrogate=f,t.isAnySurrogate=p,t.surrogatePairToCodePoint=m,t.stringFromCodePoint=function(y){if(y<=65535)return String.fromCharCode(y);var C=y-65536;return String.fromCharCode(C>>10|55296,1023&C|56320)},t.scanCodePoints=function(y,C,E){for(var I=C,F=0;F<E;F+=1){if(I>=y.length)return;l(y.charCodeAt(I))&&I+1<y.length&&f(y.charCodeAt(I+1))?I+=2:I+=1}return I},t.scanCodePointsBack=function(y,C,E){for(var I=C,F=0;F<E;F+=1){if(I-1<0)return;f(y.charCodeAt(I-1))&&I-2>=0&&l(y.charCodeAt(I-2))?I-=2:I-=1}return I},t.countCodePoints=function(y,C,E){for(var I=0,F=C;F<E;I+=1)l(y.charCodeAt(F))&&F+1<E&&f(y.charCodeAt(F+1))?F+=2:F+=1;return I},t.stringCodePointAt=v,t.numCodeUnits=h,t.codePointIterator=function(y,C){C===void 0&&(C=0);for(var E=[],I=C;I<y.length;){var F=v(y,I);E.push(F),I+=h(F)}return E},function(y){y[y.IdentStartClass=32]="IdentStartClass",y[y.IdentContinueClass=64]="IdentContinueClass"}(s=t.CharCodeBits||(t.CharCodeBits={})),t.forEachClassInterval=S,t.makeGetCharCodeBits=function(y,C){var E;function I(w){E[w]|=s.IdentStartClass}function F(w){E[w]|=s.IdentContinueClass}return function(w){if(E===void 0){var B=(0,c.fastMax)(y[y.length-1],C[C.length-1]);E=new Uint8Array(B),S(y,I),S(C,F)}var k=E[w];return k!==void 0?k:0}}},8515:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.prependErrorMessage=t.messageFromError=t.partialArray=t.arrayFill=t.repeat=t.stringEndsWith=t.stringStartsWith=t.isInteger=t.mathLog2=void 0;var s=d(8908),c=d(1071);Object.defineProperty(t,"mathLog2",{enumerable:!0,get:function(){return c.mathLog2}}),t.isInteger=function(l){return typeof l=="number"&&isFinite(l)&&Math.floor(l)===l},t.stringStartsWith=function(l,f,p){return p===void 0&&(p=0),p+f.length<=l.length&&l.substring(p,p+f.length)===f},t.stringEndsWith=function(l,f){return f.length<=l.length&&l.substring(l.length-f.length,l.length)===f},t.repeat=function(l,f){return Array(f+1).join(l)},t.arrayFill=function(l,f){for(var p=0;p<l.length;p+=1)l[p]=f;return l},t.partialArray=function(l){var f=[];return Object.keys(l).map(Number).forEach(function(p){return f[p]=l[p]}),f},t.messageFromError=function(l){if(l==null||typeof l!="object")return(0,s.anonymize)(l);var f=l,p=String(f.name),m=String(f.message);if(f.stack!=null){var v=String(f.stack);return v.indexOf(m)>=0&&v.indexOf(p)>=0?v:"".concat(p,": ").concat(m,"\n").concat(v)}return m.indexOf(p)>=0?m:"".concat(p,": ").concat(m)},t.prependErrorMessage=function(l,f){if(l==null||typeof l!="object")return l;var p=l;return p.message="".concat(f," ").concat(String(p.message)),p},t.values=function(l){var f=[];for(var p in l)Object.hasOwnProperty.call(l,p)&&f.push(l[p]);return f}},6988:function(u,t){"use strict";function d(){return function(s){return function(c){for(var l=function(h){this.obj=h},f=function(h){l.prototype[h]=function(){for(var S,y=[],C=0;C<arguments.length;C++)y[C]=arguments[C];var E=(S=this.obj)[h].apply(S,y);return Promise.resolve(E)}},p=0,m=c;p<m.length;p++)f(m[p]);return l}(s)}}Object.defineProperty(t,"__esModule",{value:!0}),t.wrapIntoAsync=t.wrapIntoAsyncClass=void 0,t.wrapIntoAsyncClass=d,t.wrapIntoAsync=function(s,c){return new(d()(c))(s)}},6743:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0;var s=d(2228);function c(){return typeof __get_change_gate_dictionary_variable=="undefined"?{}:__get_change_gate_dictionary_variable()}t.getChangeGateDictionary=c,t.isChangeGateEnabled=function(l){var f;return(f=c()[l])===null||f===void 0||f},t.setChangeGateDictionaryGetter=function(l){var f=s.globalThis.__get_change_gate_dictionary_variable;return s.globalThis.__get_change_gate_dictionary_variable=l,f}},8906:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var s=d(2228),c={};function l(){return typeof __get_feature_gate_dictionary_variable=="undefined"?c:__get_feature_gate_dictionary_variable()}function f(p,m){var v;return(v=l()[p])!==null&&v!==void 0?v:m}t.getFeatureGateDictionary=l,t.getStringFeatureGate=f,t.getBooleanFeatureGate=function(p,m){var v,h=(v=f(p))===null||v===void 0?void 0:v.trim().toLowerCase();return h==="true"||h!=="false"&&m},t.getNumberFeatureGate=function(p,m){var v,h=(v=f(p))===null||v===void 0?void 0:v.trim().toLowerCase();if(h===void 0)return m;if(h==="infinity"||h==="+infinity")return 1/0;if(h==="-infinity")return-1/0;var S=parseFloat(h);return isNaN(S)?m:S},t.getIntFeatureGate=function(p,m){var v,h=(v=f(p))===null||v===void 0?void 0:v.trim();if(h===void 0)return m;var S=parseInt(h,10);return isNaN(S)?m:S},t.setFeatureGateDictionaryGetter=function(p){var m=s.globalThis.__get_feature_gate_dictionary_variable;return s.globalThis.__get_feature_gate_dictionary_variable=p,m}},2228:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThis=void 0;var s=d(7933);t.globalThis=s},5550:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=d(655);s.__exportStar(d(8906),t),s.__exportStar(d(581),t),s.__exportStar(d(6743),t),s.__exportStar(d(978),t),s.__exportStar(d(7470),t),s.__exportStar(d(6807),t)},581:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var s=d(8906);t.makeGetTypedFeatureGate=function(c){return function(l){var f=c[l];switch(typeof f){case"boolean":return(0,s.getBooleanFeatureGate)(l,f);case"number":return(0,s.getNumberFeatureGate)(l,f);case"string":return(0,s.getStringFeatureGate)(l,f);default:throw new Error("Wrong defaultValue type")}}}},978:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var s=d(6743);t.makeTypedIsChangeGateEnabled=function(c){return function(l){return(0,s.isChangeGateEnabled)(l)}}},7470:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var s=d(655),c=d(6743);function l(f){var p=(0,c.setChangeGateDictionaryGetter)(void 0);return(0,c.setChangeGateDictionaryGetter)(function(){var m=p!==void 0?p():{};return s.__assign(s.__assign({},m),f)}),p}t.overrideChangeGates=l,t.overrideTypedChangeGates=function(f,p){return l(p)}},6807:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var s=d(655),c=d(8906);function l(f){for(var p,m,v={},h=0,S=Object.keys(f);h<S.length;h++){var y=S[h];v[y]=(p=f[y])===null||p===void 0?void 0:p.toString()}var C=(m=(0,c.setFeatureGateDictionaryGetter)(void 0))!==null&&m!==void 0?m:function(){return{}};return(0,c.setFeatureGateDictionaryGetter)(function(){return s.__assign(s.__assign({},C()),v)}),C}t.overrideFeatureGates=l,t.overrideTypedFeatureGates=function(f,p){return l(p)}},186:function(u,t,d){"use strict";d.r(t),d.d(t,{Endpoint:function(){return R},WorkerError:function(){return h},createWorker:function(){return pe},dispatchWorkerError:function(){return x},importScriptsWithRetry:function(){return Ne},isThreadingSupported:function(){return E},isWorkerThread:function(){return Le},paramInsideDef:function(){return L},setConfig:function(){return I},workerName:function(){return Oe}});var s=d(655);function c(le){return l(le)&&le.name==="WorkerError"&&typeof le.info=="object"}function l(le){if(le==null)return!1;if(le instanceof Error)return!0;var me=le;return typeof me.name=="string"&&typeof me.message=="string"&&(me.stack==null||typeof me.stack=="string")}function f(le){return l(le)?le:new Error("(non-Error object) ".concat(function(me){var Pe=typeof me;switch(Pe){case"function":case"symbol":case"undefined":return"<".concat(Pe,">");case"object":return JSON.stringify(me);default:return"".concat(me)}}(le)))}function p(le){return{name:le.name,message:c(le)?le.baseMessage:le.message,stack:le.stack,info:c(le)?(me=le.info,(0,s.__assign)((0,s.__assign)({},me),{error:me.error?p(me.error):void 0})):void 0};var me}function m(le){return l(le)?{isError:!0,value:p(le)}:{isError:!1,value:le}}var v,h=function(le){function me(Pe,Re){var fe,Se=this.constructor,be=this;(be=le.call(this,"".concat(Pe,"; info = ").concat(JSON.stringify((0,s.__assign)((0,s.__assign)({},Re),{error:(fe=Re.error)===null||fe===void 0?void 0:fe.message}))))||this).baseMessage=Pe,be.info=Re,be.name="WorkerError";var xe=Se.prototype;return Object.getPrototypeOf(be)!==xe&&(Object.setPrototypeOf!=null?Object.setPrototypeOf(be,xe):be.__proto__=xe),be}return(0,s.__extends)(me,le),me.isWorkerError=c,me}(Error),S={Error,EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError};function y(le){var me;if(le.name==="WorkerError")me=new h(le.message,function(Re){return(0,s.__assign)((0,s.__assign)({},Re),{error:Re.error?y(Re.error):void 0})}(le.info));else{var Pe=S[le.name];Pe?me=new Pe(le.message):(me=new Error(le.message)).name=le.name}return le.stack!=null&&(me.stack=le.stack),me}function C(le){return le.isError?y(le.value):le.value}function E(){return typeof Blob!="undefined"&&typeof URL!="undefined"&&URL.createObjectURL!==void 0&&URL.revokeObjectURL!==void 0&&typeof Worker!="undefined"}function I(le){if(v)throw new TypeError("setConfig has already been called");v=le}function F(){var le=v??{};return{createTimeout:le.createTimeout,createMode:le.createMode,importScriptUrls:le.importScriptUrls?(0,s.__spreadArray)([],le.importScriptUrls,!0):void 0,typedWorkersUrl:le.typedWorkersUrl,typedWorkersName:le.typedWorkersName,importScriptsMaxRetries:le.importScriptsMaxRetries}}function w(le){setTimeout(function(){throw le})}function B(){return typeof self!="undefined"&&"__typed_workers_thread"in self?self:void 0}function k(le){var me=B();if(me!==void 0){var Pe={kind:1,error:m(le)};me.postMessage(Pe)}else console.warn(le)}function x(le){var me;try{((me=v==null?void 0:v.onWorkerError)!==null&&me!==void 0?me:k)(le)}catch(Pe){console.warn(le),w(Pe)}}function G(le){var me=B();if(me!==void 0){var Pe={kind:2,stats:le};me.postMessage(Pe)}}function H(le){var me;try{((me=v==null?void 0:v.onCreateWorker)!==null&&me!==void 0?me:G)(le)}catch(Pe){w(Pe)}}var L=function le(me){for(var Pe=[],Re=1;Re<arguments.length;Re++)Pe[Re-1]=arguments[Re];return le.transfer.apply(le,(0,s.__spreadArray)([me,void 0],Pe,!1))};L.transfer=function(le,me){for(var Pe=[],Re=2;Re<arguments.length;Re++)Pe[Re-2]=arguments[Re];return{def:le,args:Pe,transferables:me??[]}};var D=d(5550),U=(0,D.makeTypedIsChangeGateEnabled)(["OfficeVSO:WINum_CGExample","OfficeVSO:5592319_TypedWorkersProxyPromiseFix"]);function V(le,me){return le.then(function(Pe){return me(),Pe},function(Pe){return me(),Promise.reject(Pe)})}(0,D.makeGetTypedFeatureGate)({"Microsoft.Office.Shared.FGExample":!0});var ne,J=1073741824;function $(le,me,Pe){if(le>J)return Pe;var Re=setTimeout(me,Math.max(0,le));return{resolve:function(Se){clearTimeout(Re),Pe.resolve(Se)},reject:function(Se){clearTimeout(Re),Pe.reject(Se)}}}function Z(){var le=Object.create(null);return le.key=void 0,delete le.key,le}function ie(le,me){var Pe=Z(),Re=U("OfficeVSO:5592319_TypedWorkersProxyPromiseFix")?function(fe,Se){var be;return Se==="then"?void 0:(be=fe[Se])!==null&&be!==void 0?be:fe[Se]=le(Se)}:function(fe,Se){var be;return(be=fe[Se])!==null&&be!==void 0?be:fe[Se]=le(Se)};return me?(me.forEach(function(fe){return Re(Pe,fe)}),Pe):new Proxy(Pe,{get:Re})}function X(le){throw le}var Q=-1,b=function(){function le(me,Pe){var Re,fe,Se=this;this.idInfo=me,this.port=Pe,this.isClosed=!1,this.exports={},this.unresolvedCalls=Z();var be=function(){var Ze;return(Ze=Se.onClose)===null||Ze===void 0?void 0:Ze.call(Se)},xe=((Re={})[0]=this.onInvoke.bind(this),Re[1]=this.onResult.bind(this),Re[2]=function(Ve){var Ze,gr=Ve.funcNames;(Ze=Se.onImports)===null||Ze===void 0||Ze.call(Se,ie(Se.createPostProxy.bind(Se),gr),ie(Se.createCallProxy.bind(Se),gr))},Re[3]=be,Re),Ie=((fe={})[0]=this.onSendInvokeFailed.bind(this),fe[1]=this.onSendResultFailed.bind(this),fe[2]=be,fe[3]=be,fe);this.port.onmessage=function(Ve){var Ze=Ve.data;return xe[Ze.kind](Ze)},this.port.onmessageerror=function(Ve){var Ze=Ve.data;return Ie[Ze.kind](Ze)}}return le.prototype.setExports=function(me){this.exports=me;var Pe={kind:2,funcNames:ne??(ne=function(){try{return typeof Proxy=="function"&&new Proxy({},{get:function(){return!0}}).k===!0}catch(Re){return!1}}())?void 0:function(Re){for(var fe=Z();Re!=null;){for(var Se=0,be=Object.getOwnPropertyNames(Re);Se<be.length;Se++){var xe=be[Se];try{typeof Re[xe]=="function"&&(fe[xe]=!0)}catch(Ie){}}Re=Object.getPrototypeOf(Re)}return Object.getOwnPropertyNames(fe)}(me)};this.port.postMessage(Pe)},le.prototype.close=function(){if(!this.isClosed)for(var me in this.isClosed=!0,this.port.postMessage({kind:3}),this.port.close(),this.unresolvedCalls){var Pe=this.unresolvedCalls[me],Re=Pe.reject,fe=Pe.funcName,Se={cause:"Connection",idInfo:this.idInfo,funcName:fe};Re(new h("Importing Endpoint closed while waiting for ".concat(fe," result"),Se))}},le.prototype.onInvoke=function(me){var Pe=this,Re=me.callId,fe=me.funcName,Se=me.args,be=Promise.resolve().then(function(){var xe=Pe.exports[fe];if(xe)return xe.apply(Pe.exports,Se);var Ie=Re>=0?"call":"post",Ve={cause:"Connection",idInfo:Pe.idInfo,callId:Re,funcName:fe};throw new h("Exporting Endpoint received a ".concat(Ie," to unknown function ").concat(fe),Ve)});Re>=0?be.then(function(xe){return Pe.sendResult(Re,fe,!0,xe)},function(xe){return Pe.sendResult(Re,fe,!1,xe)}):be.catch(function(xe){var Ie=f(xe),Ve={cause:"UnhandledError",idInfo:Pe.idInfo,error:Ie,callId:Re,funcName:fe};x(new h("Exporting Endpoint's ".concat(fe," implementation threw or rejected"),Ve))})},le.prototype.sendResult=function(me,Pe,Re,fe){var Se={kind:1,callId:me,funcName:Pe,isFulfilled:Re,resultValue:m(fe)};try{this.port.postMessage(Se,void 0)}catch(be){this.onSendResultFailed(Se,f(be))}},le.prototype.onSendResultFailed=function(me,Pe){var Re=me.callId,fe=me.funcName,Se=me.resultValue,be=Pe?"Exporting Endpoint failed to send ".concat(fe," result"):"Importing Endpoint failed to deserialize ".concat(fe," result"),xe={cause:"MessageError",idInfo:this.idInfo,error:Pe,callId:Re,funcName:fe},Ie=new h(be,xe);Se.isError?x(Ie):this.sendResult(Re,fe,!1,Ie)},le.prototype.takeCallbacks=function(me){var Pe=this.unresolvedCalls[me];return Pe&&delete this.unresolvedCalls[me],Pe},le.prototype.setCallTimeout=function(me,Pe,Re,fe){var Se=this;return Re>J?fe:$(Re,function(){var be=Se.takeCallbacks(me);if(be){var xe={cause:"Timeout",idInfo:Se.idInfo,timeout:Re,callId:me,funcName:Pe};be.reject(new h("Importing Endpoint's call to ".concat(Pe," timed out"),xe))}},fe)},le.prototype.sendCall=function(me,Pe,Re,fe){var Se=this;return new Promise(function(be,xe){var Ie=Q+=1,Ve={kind:0,callId:Ie,funcName:me,args:Pe};Se.unresolvedCalls[Ie]=(0,s.__assign)((0,s.__assign)({},Se.setCallTimeout(Ie,me,Re,{resolve:be,reject:xe})),{funcName:me});try{Se.port.postMessage(Ve,fe)}catch(_r){var Ze=Se.takeCallbacks(Ie);if(Ze){var gr=f(_r),cr={cause:"MessageError",idInfo:Se.idInfo,error:gr,callId:Ie,funcName:me};Ze.reject(new h("Importing Endpoint failed to send call to ".concat(me),cr))}}})},le.prototype.sendPost=function(me,Pe,Re,fe){var Se={kind:0,callId:-1,funcName:me,args:Pe};try{this.port.postMessage(Se,fe)}catch(Ie){var be=f(Ie),xe={cause:"MessageError",idInfo:this.idInfo,error:be,callId:-1,funcName:me};Re(new h("Importing Endpoint failed to post to ".concat(me),xe))}},le.prototype.onSendInvokeFailed=function(me){var Pe,Re=me.callId,fe=me.funcName,Se=Re>=0?"call":"post",be={cause:"MessageError",idInfo:this.idInfo,callId:Re,funcName:fe},xe=new h("Exporting Endpoint failed to deserialize ".concat(Se," to ").concat(fe),be),Ie=Re>=0?this.takeCallbacks(Re):void 0;((Pe=Ie==null?void 0:Ie.reject)!==null&&Pe!==void 0?Pe:x)(xe)},le.prototype.onResult=function(me){var Pe=me.callId,Re=me.funcName,fe=me.isFulfilled,Se=me.resultValue;if(Pe>=0){var be=this.takeCallbacks(Pe);be&&(fe?be.resolve:be.reject)(C(Se))}else{var xe={cause:"InternalError",idInfo:this.idInfo,callId:Pe,funcName:Re};x(new h("Exporting Endpoint sent a result for a post to ".concat(Re),xe))}},le.prototype.createPostProxy=function(me){var Pe=this,Re=function fe(){for(var Se=[],be=0;be<arguments.length;be++)Se[be]=arguments[be];return fe.transfer.apply(fe,(0,s.__spreadArray)([void 0],Se,!1))};return Re.transfer=function(fe){for(var Se,be,xe,Ie=[],Ve=1;Ve<arguments.length;Ve++)Ie[Ve-1]=arguments[Ve];if(!Pe.isClosed){var Ze=(xe=(Se=Re.onPostMessageError)!==null&&Se!==void 0?Se:(be=Pe.getOnPostMessageError)===null||be===void 0?void 0:be.call(Pe))!==null&&xe!==void 0?xe:X;Pe.sendPost(me,Ie,Ze,fe)}},Re},le.prototype.createCallProxy=function(me){var Pe=this,Re=function fe(){for(var Se=[],be=0;be<arguments.length;be++)Se[be]=arguments[be];return fe.transfer.apply(fe,(0,s.__spreadArray)([void 0],Se,!1))};return Re.transfer=function(fe){for(var Se,be,xe,Ie=[],Ve=1;Ve<arguments.length;Ve++)Ie[Ve-1]=arguments[Ve];if(Pe.isClosed){var Ze={cause:"Connection",idInfo:Pe.idInfo,funcName:me};return Promise.reject(new h("".concat(Pe.idInfo.side," Endpoint's call.").concat(me," called after close"),Ze))}var gr=(xe=(Se=Re.callTimeout)!==null&&Se!==void 0?Se:(be=Pe.getCallTimeout)===null||be===void 0?void 0:be.call(Pe))!==null&&xe!==void 0?xe:1/0;return Pe.sendCall(me,Ie,gr,fe)},Re.callTimeout=void 0,Re},le}(),R=function(){function le(me,Pe,Re){this.callTimeout=1/0,this.onPostMessageError=X,this._idInfo=me,this._state=Pe,this.createMode=Re;var fe=function(be){return function(){var xe=me.side==="Outside"?"inside":"outside",Ie={cause:"Connection",idInfo:me};throw new h("".concat(me.side," Endpoint's ").concat(be," referenced before the ").concat(xe," Endpoint started"),Ie)}};Object.defineProperties(this,{post:{configurable:!0,enumerable:!1,get:fe("post")},call:{configurable:!0,enumerable:!1,get:fe("call")}})}return le._create=function(me,Pe,Re){var fe,Se,be=Pe.port,xe=Pe.options,Ie=Pe.createMode,Ve={type:"Endpoint",side:me,id:xe==null?void 0:xe.id};try{fe=new b(Ve,be),Se=new le(Ve,fe,Ie)}catch(Ze){return Promise.reject(Ze)}return new Promise(function(Ze,gr){var cr;fe.getCallTimeout=function(){return Se.callTimeout},fe.getOnPostMessageError=function(){return Se.onPostMessageError},fe.onImports=function(Rr,ir){Object.defineProperties(Se,{post:{configurable:!0,enumerable:!1,writable:!1,value:Rr},call:{configurable:!0,enumerable:!1,writable:!1,value:ir}}),Or.resolve()},fe.onClose=function(){return Se.close("Force")};var _r,xr=function(Rr){var ir,$e;return($e=(ir=Rr==null?void 0:Rr.createTimeout)!==null&&ir!==void 0?ir:v==null?void 0:v.createTimeout)!==null&&$e!==void 0?$e:3e5}(xe),Or=$(xr,function(){var Rr=me==="Outside"?"inside":"outside",ir={cause:"Timeout",idInfo:Ve,timeout:xr},$e=new h("".concat(me," Endpoint timed out waiting for the ").concat(Rr," to start"),ir);Or.reject($e)},{resolve:Ze,reject:gr});Se._closedDuringCreate=function(){Or.resolve()};try{_r=Re(Se)}catch(Rr){return Or.reject(Rr)}(cr=Se._state)===null||cr===void 0||cr.setExports(_r)}).then(function(){return Se._closedDuringCreate=void 0,Se},function(Ze){return Se._closedDuringCreate=void 0,Se.close(),Promise.reject(Ze)})},le.prototype.hasBeenClosed=function(){return this._state===void 0},le.prototype.close=function(me){var Pe,Re;if(this._state){if(this._closedDuringCreate){if(me!=="Force"){var fe={cause:"Connection",idInfo:this._idInfo};throw new h("".concat(this._idInfo.side," Endpoint's close called during creation"),fe)}this._closedDuringCreate()}var Se=this._state;this._state=void 0;try{Se.close(),(Pe=this._onClose)===null||Pe===void 0||Pe.call(this),(Re=this.onClose)===null||Re===void 0||Re.call(this)}catch(be){fe={cause:"Connection",idInfo:this._idInfo,error:f(be)},x(new h("".concat(this._idInfo.side," Endpoint's close threw an error"),fe))}}},le.createOutside=function(me,Pe){return Pe===void 0&&(Pe=function(){}),le._create("Outside",me,Pe)},le.createInside=function(me,Pe){return le._create("Inside",me,Pe)},le}(),P='!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=12)}([function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return o})),r.d(t,"__assign",(function(){return i})),r.d(t,"__rest",(function(){return a})),r.d(t,"__decorate",(function(){return u})),r.d(t,"__param",(function(){return c})),r.d(t,"__metadata",(function(){return f})),r.d(t,"__awaiter",(function(){return l})),r.d(t,"__generator",(function(){return s})),r.d(t,"__createBinding",(function(){return d})),r.d(t,"__exportStar",(function(){return p})),r.d(t,"__values",(function(){return y})),r.d(t,"__read",(function(){return v})),r.d(t,"__spread",(function(){return _})),r.d(t,"__spreadArrays",(function(){return g})),r.d(t,"__spreadArray",(function(){return b})),r.d(t,"__await",(function(){return h})),r.d(t,"__asyncGenerator",(function(){return m})),r.d(t,"__asyncDelegator",(function(){return w})),r.d(t,"__asyncValues",(function(){return O})),r.d(t,"__makeTemplateObject",(function(){return j})),r.d(t,"__importStar",(function(){return S})),r.d(t,"__importDefault",(function(){return P})),r.d(t,"__classPrivateFieldGet",(function(){return T})),r.d(t,"__classPrivateFieldSet",(function(){return x})),r.d(t,"__classPrivateFieldIn",(function(){return E}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function u(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function c(e,t){return function(r,n){t(r,n,e)}}function f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function u(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,u)}c((n=n.apply(e,t||[])).next())}))}function s(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}var d=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function p(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||d(t,e,r)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function _(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function g(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)n[o]=i[a];return n}function b(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function h(e){return this instanceof h?(this.v=e,this):new h(e)}function m(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||u(e,t)}))})}function u(e,t){try{(r=o[e](t)).value instanceof h?Promise.resolve(r.value.v).then(c,f):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function c(e){u("next",e)}function f(e){u("throw",e)}function l(e,t){e(t),i.shift(),i.length&&u(i[0][0],i[0][1])}}function w(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:h(e[n](t)),done:"return"===n}:o?o(t):t}:o}}function O(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=y(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function j(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var G=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&d(t,e,r);return G(t,e),t}function P(e){return e&&e.__esModule?e:{default:e}}function T(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function x(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function E(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use \'in\' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var n=r(4),o={};function i(){return"undefined"==typeof __get_feature_gate_dictionary_variable?o:__get_feature_gate_dictionary_variable()}function a(e,t){var r;return null!==(r=i()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=i,t.getStringFeatureGate=a,t.getBooleanFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;var o=parseFloat(n);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim();if(void 0===n)return t;var o=parseInt(n,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){var t=n.globalThis.__get_feature_gate_dictionary_variable;return n.globalThis.__get_feature_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0;var n=r(4);function o(){return"undefined"==typeof __get_change_gate_dictionary_variable?{}:__get_change_gate_dictionary_variable()}t.getChangeGateDictionary=o,t.isChangeGateEnabled=function(e){var t;return null===(t=o()[e])||void 0===t||t},t.setChangeGateDictionaryGetter=function(e){var t=n.globalThis.__get_change_gate_dictionary_variable;return n.globalThis.__get_change_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);n.__exportStar(r(1),t),n.__exportStar(r(8),t),n.__exportStar(r(2),t),n.__exportStar(r(9),t),n.__exportStar(r(10),t),n.__exportStar(r(11),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThis=void 0;var n=r(5);t.globalThis=n},function(e,t,r){"use strict";e.exports=r(6)()?globalThis:r(7)},function(e,t,r){"use strict";e.exports=function(){return"object"==typeof globalThis&&(!!globalThis&&globalThis.Array===Array)}},function(e,t){var r=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return r()}try{return __global__||r()}finally{delete Object.prototype.__global__}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var n=r(1);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var n=r(2);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,n.isChangeGateEnabled)(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var n=r(0),o=r(2);function i(e){var t=(0,o.setChangeGateDictionaryGetter)(void 0);return(0,o.setChangeGateDictionaryGetter)((function(){var r=void 0!==t?t():{};return n.__assign(n.__assign({},r),e)})),t}t.overrideChangeGates=i,t.overrideTypedChangeGates=function(e,t){return i(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var n=r(0),o=r(1);function i(e){for(var t,r,i={},a=0,u=Object.keys(e);a<u.length;a++){var c=u[a];i[c]=null===(t=e[c])||void 0===t?void 0:t.toString()}var f=null!==(r=(0,o.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,o.setFeatureGateDictionaryGetter)((function(){return n.__assign(n.__assign({},f()),i)})),f}t.overrideFeatureGates=i,t.overrideTypedFeatureGates=function(e,t){return i(t)}},function(e,t,r){"use strict";r.r(t);var n=r(0);function o(e){return i(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function i(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function a(e){return i(e)?e:new Error("(non-Error object) ".concat(function(e){var t=typeof e;switch(t){case"function":case"symbol":case"undefined":return"<".concat(t,">");case"object":return JSON.stringify(e);default:return"".concat(e)}}(e)))}function u(e){return{name:e.name,message:o(e)?e.baseMessage:e.message,stack:e.stack,info:o(e)?(t=e.info,Object(n.__assign)(Object(n.__assign)({},t),{error:t.error?u(t.error):void 0})):void 0};var t}function c(e){throw new ReferenceError("".concat(e," is not defined"))}function f(e,t,r){void 0===r&&(r=c);try{for(var n=t.split("."),o=0,i=n;o<i.length;o++){e=e[i[o]]}return null!=e?e:r(t)}catch(e){return r(t)}}var l=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return l.transfer.apply(l,Object(n.__spreadArray)([e,void 0],t,!1))};l.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var s="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function d(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:s()))}function p(e,t,r){var n=e.indexOf("?");if(n<0)return"".concat(e,"?").concat(t,"=").concat(r);for(var o=e.slice(0,n+1),i=e.slice(n+1).split("&"),a=0;a<i.length&&("="!==i[a][t.length]||i[a].slice(0,t.length)!==t);a+=1);return i[a]="".concat(t,"=").concat(r),o+i.join("&")}function y(e,t){for(var r,n=0;n<=t;n+=1)try{return void importScripts(n>0?p(e,"retries",String(n)):e)}catch(e){r=e}throw r}function v(e,t){if(0!==t)for(var r=0,n=e;r<n.length;r++){y(n[r],t)}else importScripts.apply(void 0,e)}var _=r(3);self.onmessage=function(e){var t,r,c=e.data,l=c.config,p=c.port,y=c.options,g=c.script,b=c.args,h=c.featureGateDictionary,m=c.changeGateDictionary;self.onmessage=null,self.__typed_workers_thread=!0,Object(_.setFeatureGateDictionaryGetter)((function(){return h})),Object(_.setChangeGateDictionaryGetter)((function(){return m}));var w,O=null!==(r=null!==(t=y.importScriptsMaxRetries)&&void 0!==t?t:l.importScriptsMaxRetries)&&void 0!==r?r:0;function j(){var e;if(w)return w;if(void 0===l.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return v([l.typedWorkersUrl],O),(w=f(self,null!==(e=l.typedWorkersName)&&void 0!==e?e:"typedWorkers")).setConfig(l),w}var G={status:"Pending",start:s()};function S(e,t){var r,n={kind:0,error:e?void 0:i(r=a(t))?{isError:!0,value:u(r)}:{isError:!1,value:r},stopwatch:G};self.postMessage(n),e||setTimeout(self.close.bind(self),6e4)}try{(function(e,t){function r(t){throw d(e,o(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!==(r=d(e,"Success"))&&void 0!==r?r:t}),r)}catch(e){r(e)}})(G,(function(){var e,t;return v(Object(n.__spreadArray)(Object(n.__spreadArray)([],null!==(t=null!==(e=null==y?void 0:y.importScriptUrls)&&void 0!==e?e:l.importScriptUrls)&&void 0!==t?t:[],!0),void 0!==g.scriptUrl?[g.scriptUrl]:[],!0),O),f(self,g.insideInitName).apply(void 0,Object(n.__spreadArray)([{config:l,importTypedWorkers:j,connection:{port:p,options:y,createMode:"Thread"}}],b,!1))})).then((function(){return S(!0)}),(function(e){return S(!1,e)}))}catch(e){S(!1,e)}}}]);',A=-1,T=function(){function le(me,Pe){var Re,fe;try{var Se;Re=function(Ie){var Ve="def"in Ie?Ie:L(Ie),Ze=Ve.def,gr=Ve.args,cr=Ve.transferables;if(typeof Ze!="function")return[Ze,gr,cr,void 0];var _r="__generatedInsideInit".concat(A+=1);return[{scriptUrl:void 0,insideInitName:_r},gr,cr,"var ".concat(_r," = ").concat(Ze.toString(),";")]}(Pe),this.script=Re[0],this.args=Re[1],this.transferables=Re[2];var be=(Se=Re[3])===void 0?[P]:[Se,"\n\n",P];this.blobUrl=URL.createObjectURL(new Blob(be,{type:"application/javascript"}));var xe={};me.id!=null&&(xe.name=me.id),this.worker=new Worker(this.blobUrl,xe)}catch(Ie){throw(fe=this.worker)===null||fe===void 0||fe.terminate(),this.revokeBlobUrl(),Ie}}return le.prototype.revokeBlobUrl=function(){this.blobUrl!==void 0&&(URL.revokeObjectURL(this.blobUrl),this.blobUrl=void 0)},le.prototype.createInside=function(me,Pe){var Re=this,fe=me.port,Se=me.options,be={type:"Thread",side:"Outside",id:Se.id},xe=this.worker,Ie=new Promise(function(Ve,Ze){Re.createCallbacks={resolve:Ve,reject:Ze};var gr={config:F(),port:fe,options:Se,script:Re.script,args:Re.args,featureGateDictionary:(0,D.getFeatureGateDictionary)(),changeGateDictionary:(0,D.getChangeGateDictionary)()};xe.postMessage(gr,(0,s.__spreadArray)([fe],Re.transferables,!0)),xe.onerror=function(cr){cr.preventDefault();var _r=function(xr,Or,Rr){if(l(Rr.error)){if(c(Rr.error))return Rr.error;var ir={cause:"UnhandledError",idInfo:xr,error:Rr.error};return new h("".concat(Or," received an unhandled error"),ir)}if(Rr.message==null){var $e={cause:"UnhandledError",idInfo:xr};return new h("".concat(Or," received a non-error (worker script fetch probably failed)"),$e)}var qe={cause:"UnhandledError",idInfo:xr},fr="".concat(Rr.message," at ").concat(Rr.filename,":").concat(Rr.lineno,":").concat(Rr.colno);return new h("".concat(Or," received an unhandled error: ").concat(fr),qe)}(be,"worker.onerror",cr);Re.createCallbacks?Re.createCallbacks.reject(_r):x(_r)},xe.onmessage=function(cr){var _r,xr,Or=cr.data;switch(Or.kind){case 0:return Pe.insideInit=Or.stopwatch,Or.error===void 0?(_r=Re.createCallbacks)===null||_r===void 0?void 0:_r.resolve():(xr=Re.createCallbacks)===null||xr===void 0?void 0:xr.reject(C(Or.error));case 1:return x(C(Or.error));case 2:return H(Or.stats)}}});return V(Ie,function(){Re.createCallbacks=void 0})},le.prototype.terminate=function(){var me;if(this.worker){var Pe=this.worker;this.worker=void 0,(me=this.createCallbacks)===null||me===void 0||me.resolve(),Pe.terminate(),this.revokeBlobUrl()}},le}(),g=typeof performance!="undefined"&&performance.timeOrigin!==void 0?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function O(){return{status:"Pending",start:g()}}function M(le,me,Pe){le.status==="Pending"&&(le.status=me,le.end=Math.max(le.start,Pe??g()))}function K(le,me){function Pe(Re){throw M(le,c(Re)&&Re.info.cause==="Timeout"?"Timeout":"Error"),Re}try{return me().then(function(Re){var fe;return(fe=M(le,"Success"))!==null&&fe!==void 0?fe:Re},Pe)}catch(Re){Pe(Re)}}function W(le){return Math.round(1e3*le)/1e3}function z(le,me,Pe){return le<me?me:le>Pe?Pe:le}function ee(le,me,Pe){var Re,fe,Se,be=z((Re=le==null?void 0:le.start)!==null&&Re!==void 0?Re:1/0,me,Pe),xe=z((fe=le==null?void 0:le.end)!==null&&fe!==void 0?fe:1/0,me,Pe);return{status:(Se=le==null?void 0:le.status)!==null&&Se!==void 0?Se:"Pending",start:W(be-me),end:W(xe-me),duration:W(xe-be)}}var ue=function(){return d(186)};function ce(le,me,Pe,Re,fe){var Se,be=new MessageChannel,xe=be.port1,Ie=be.port2;return Promise.all([Re({port:xe,options:le,createMode:me}),K(Pe.createOutside=O(),function(){return R.createOutside({port:Ie,options:le,createMode:me},function(Ve){return fe(Se=Ve)})})]).then(function(){return Se},function(Ve){return Se?Se.close("Force"):Ie.close(),Promise.reject(Ve)})}function he(le,me,Pe,Re){return ce(le,"Local",me,function(fe){return function(Se,be,xe){var Ie="def"in xe?xe:L(xe),Ve=Ie.def,Ze=Ie.args;if(typeof Ve!="function"){var gr={cause:"InternalError",idInfo:{type:"Endpoint",side:"Inside",id:Se.options.id}};return Promise.reject(new h("Loading an InsideScript to create a local worker is unimplemented",gr))}return Promise.resolve().then(function(){return K(be.insideInit=O(),function(){return Ve.apply(void 0,(0,s.__spreadArray)([{config:F(),importTypedWorkers:ue,connection:Se}],Ze,!1)).then(function(){})})})}(fe,me,Pe)},Re)}function de(le,me,Pe,Re){var fe;me.createThread=O();try{fe=new T(le,Pe)}catch(Se){return M(me.createThread,"Error"),Promise.reject(Se)}return M(me.createThread,"Success"),ce(le,"Thread",me,function(Se){return fe.createInside(Se,me)},Re).then(function(Se){return Se.hasBeenClosed()?fe.terminate():Se._onClose=fe.terminate.bind(fe),Se},function(Se){return fe.terminate(),Promise.reject(Se)})}function pe(le,me,Pe){Pe===void 0&&(Pe=function(){});var Re=function(Ie){var Ve,Ze,gr=(Ze=(Ve=Ie==null?void 0:Ie.createMode)!==null&&Ve!==void 0?Ve:v==null?void 0:v.createMode)!==null&&Ze!==void 0?Ze:"Thread";return gr==="ThreadOrLocal"?E()?"Thread":"Local":gr}(le),fe="local"in me?Re==="Local"?me.local:me.thread:me,Se=Re==="Local"?he:de,be={id:le.id,createMode:Re,createWorker:O()},xe=K(be.createWorker,function(){return Se(function(Ie){return{id:Ie.id,createTimeout:Ie.createTimeout,createMode:Ie.createMode,importScriptUrls:Ie.importScriptUrls,importScriptsMaxRetries:Ie.importScriptsMaxRetries}}(le),be,fe,Pe)});return V(xe,function(){var Ie=function(Ve){var Ze=Ve.id,gr=Ve.createMode,cr=Ve.createWorker,_r=Ve.insideInit,xr=Ve.createOutside,Or=Ve.createThread,Rr=cr.status,ir=cr.start,$e=cr.end;if(Rr!=="Pending"&&$e!==void 0)return{id:Ze,createMode:gr,createWorker:{status:Rr,absStart:ir,duration:W($e-ir)},createThread:gr==="Thread"?ee(Or,ir,$e):void 0,createOutside:ee(xr,ir,$e),insideInit:ee(_r,ir,$e)}}(be);Ie&&H(Ie)})}function _e(le,me,Pe){var Re=le.indexOf("?");if(Re<0)return"".concat(le,"?").concat(me,"=").concat(Pe);for(var fe=le.slice(0,Re+1),Se=le.slice(Re+1).split("&"),be=0;be<Se.length&&(Se[be][me.length]!=="="||Se[be].slice(0,me.length)!==me);be+=1);return Se[be]="".concat(me,"=").concat(Pe),fe+Se.join("&")}function Ce(le,me){for(var Pe,Re=0;Re<=me;Re+=1)try{return void importScripts(Re>0?_e(le,"retries",String(Re)):le)}catch(fe){Pe=fe}throw Pe}function Ne(le,me){if(me!==0)for(var Pe=0,Re=le;Pe<Re.length;Pe++)Ce(Re[Pe],me);else importScripts.apply(void 0,le)}function Le(){return typeof WorkerGlobalScope!="undefined"}function Oe(){return self.name}},6547:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatName=t.formatGridRange=t.quoteQualifier=t.formatQualifier=t.shouldQuoteQualifier=t.canonicaliseRangePos=t.formatRangePos=t.canonicaliseCellPos=t.formatCellPos=t.canonicaliseColRange=t.canonicaliseRowRange=t.formatColRange=t.formatRowRange=t.canonicaliseCol=t.canonicaliseRow=t.formatCol=t.formatRow=t.resolvePosition=t.canonicaliseBrackets=t.columnName=void 0;var s=d(342),c=d(4333),l=d(6789),f=d(8660),p=d(7638),m=d(419),v=d(8678),h=(0,c.pos)(c.PosKind.Abs,0),S=(0,c.pos)(c.PosKind.Abs,s.sheetRows-1),y=p.codePointCapitalA,C=p.codePointFullStop;function E(X){for(var Q=X+1,b="";Q>0;){var R=(Q-1)%26;b=String.fromCharCode(y+R)+b,Q=Math.floor((Q-R)/26)}return b}function I(X,Q,b,R){if(Q.kind===c.PosKind.Abs)return Q.index;if(R)return(0,l.wrapPosition)(X,Q.index,b);var P=X+Q.index;return 0<=P&&P<b?P:void 0}function F(X,Q,b,R,P,A){var T=I(b,R,P,A);if(T!==void 0){if(R.kind===c.PosKind.Abs)return Q+(T+1).toFixed();var g=T-b;return g===0?Q:Q+X.rcLeftBracket+g.toFixed()+X.rcRightBracket}}function w(X,Q,b,R,P){return Q===c.RefStyle.A1?function(A,T,g){var O=I(A,T,s.sheetRows,g);if(O!==void 0){var M=(O+1).toFixed();return T.kind===c.PosKind.Abs?"$"+M:M}}(b,R,P):F(X,X.rowLetter,b,R,s.sheetRows,P)}function B(X,Q,b,R,P){return Q===c.RefStyle.A1?function(A,T,g){var O=I(A,T,s.sheetCols,g);if(O!==void 0){var M=E(O);return T.kind===c.PosKind.Abs?"$"+M:M}}(b,R,P):F(X,X.columnLetter,b,R,s.sheetCols,P)}function k(X,Q,b,R){if(b.kind===c.PosKind.Abs)return b;var P=I(Q,b,X,R);if(P!==void 0){var A=P-Q;return A===b.index?b:(0,c.pos)(c.PosKind.Rel,A)}}function x(X,Q,b,R,P){var A=I(X,Q,R,P),T=I(X,b,R,P);if(A!==void 0&&T!==void 0)return A<=T?[Q,b,A,T]:[b,Q,T,A]}function G(X,Q,b,R,P,A,T,g,O){var M=x(A,T,g,b,O);if(M!==void 0){var K=Mr(M,4),W=K[0],z=K[1],ee=K[2],ue=K[3];if(Q!==void 0&&ee===0&&ue===b-1&&T.kind===g.kind)return Q(R,P,O);var ce=X(R,P,A,W,O);if(ce!==void 0){if(P===c.RefStyle.R1C1&&W.kind===z.kind&&W.index===z.index)return ce;var he=X(R,P,A,z,O);return he!==void 0?ce+":"+he:void 0}}}function H(X,Q,b,R,P,A){var T=x(b,R,P,Q,A);if(T!==void 0){var g=Mr(T,4),O=g[0],M=g[1],K=g[2],W=g[3];if(X!==void 0&&K===0&&W===Q-1&&R.kind===P.kind)return X;var z=k(Q,b,O,A),ee=k(Q,b,M,A);return z!==void 0&&ee!==void 0?[!1,z,ee]:void 0}}function L(X,Q,b,R,P,A){var T=w(X,Q,b.row,R,A),g=B(X,Q,b.col,P,A);if(T!==void 0&&g!==void 0)return Q===c.RefStyle.A1?g+T:T+g}function D(X,Q,b,R,P,A,T,g){var O=x(b.row,R,A,s.sheetRows,g),M=x(b.col,P,T,s.sheetCols,g);if(!(O===void 0||M===void 0)){var K=Mr(O,4),W=K[0],z=K[1],ee=K[2],ue=K[3],ce=Mr(M,4),he=ce[0],de=ce[1],pe=ce[2],_e=ce[3];if(pe===0&&_e===s.sheetCols-1&&P.kind===T.kind)return(0,t.formatRowRange)(X,Q,b.row,W,z,g);if(ee===0&&ue===s.sheetRows-1&&R.kind===A.kind)return(0,t.formatColRange)(X,Q,b.col,he,de,g);var Ce=L(X,Q,b,W,he,g),Ne=L(X,Q,b,z,de,g);return Ce!==void 0&&Ne!==void 0?Ce+":"+Ne:void 0}}function U(X,Q){return Q===C||X.isIdentContinue(Q)}t.columnName=E,t.canonicaliseBrackets=function(X,Q){return X===c.RefStyle.R1C1&&Q.kind===c.PosKind.Rel&&Q.index!==0},t.resolvePosition=I,t.formatRow=w,t.formatCol=B,t.canonicaliseRow=k.bind(void 0,s.sheetRows),t.canonicaliseCol=k.bind(void 0,s.sheetCols),t.formatRowRange=G.bind(void 0,w,void 0,s.sheetRows),t.formatColRange=G.bind(void 0,B,function(X,Q,b){return(0,t.formatRowRange)(X,Q,0,h,S,b)},s.sheetCols),t.canonicaliseRowRange=H.bind(void 0,void 0,s.sheetRows),t.canonicaliseColRange=H.bind(void 0,[!0,h,S],s.sheetCols),t.formatCellPos=L,t.canonicaliseCellPos=function(X,Q,b,R){var P=(0,t.canonicaliseRow)(X.row,Q,R),A=(0,t.canonicaliseCol)(X.col,b,R);if(P!==void 0&&A!==void 0)return{row:P,col:A}},t.formatRangePos=D,t.canonicaliseRangePos=function(X,Q,b,R,P,A){var T=x(X.row,Q,R,s.sheetRows,A),g=x(X.col,b,P,s.sheetCols,A);if(!(T===void 0||g===void 0)){var O=Mr(T,4),M=O[0],K=O[1],W=O[2],z=O[3],ee=Mr(g,4),ue=ee[0],ce=ee[1],he=ee[2],de=ee[3],pe=(0,t.canonicaliseRow)(X.row,M,A),_e=(0,t.canonicaliseCol)(X.col,ue,A),Ce=(0,t.canonicaliseRow)(X.row,K,A),Ne=(0,t.canonicaliseCol)(X.col,ce,A);return pe!==void 0&&_e!==void 0&&Ce!==void 0&&Ne!==void 0?he===0&&de===s.sheetCols-1&&b.kind===P.kind?{row1:pe,row2:Ce,col1:void 0,col2:void 0}:W===0&&z===s.sheetRows-1&&Q.kind===R.kind?{col1:_e,col2:Ne,row1:void 0,row2:void 0}:{row1:pe,col1:_e,row2:Ce,col2:Ne}:void 0}};var V=/'/g;function ne(X,Q){if(Q.length===0)return!1;var b=0,R=(0,m.stringCodePointAt)(Q,b);if(!X.isIdentStart(R))return!1;b+=(0,m.numCodeUnits)(R);for(var P=da((0,m.codePointIterator)(Q,b)),A;!(A=P()).done;){var T=A.value;if(!U(X,T))return!1}return!0}var J=(0,s.gridCell)(0,0);function $(X,Q,b){if(X.stringCompareCI(b,X.trueName)===0||X.stringCompareCI(b,X.falseName)===0)return!0;var R=(0,l.parseCellRef)(X,Q,J,b,0);if(R!==void 0){if(R.refStyle===c.RefStyle.A1){var P=R.i;if(P>=b.length&&X.getWorksheetFuncId(b.substring(0,P))===void 0)return!0}else if(!(0,l.isR1C1IdentStart)(R.row,R.col))return!0}return!ne(X,b)&&!function(A,T){var g=0;if(!(0,v.stringStartsWith)(T,A.leftBracket,g)||(g+=A.leftBracket.length,g===T.length))return!1;var O=(0,m.stringCodePointAt)(T,g);if(!U(A,O))return!1;for(g+=(0,m.numCodeUnits)(O);;){if((0,v.stringStartsWith)(T,A.rightBracket,g)){g+=A.rightBracket.length;break}if(g===T.length)return!1;var M=(0,m.stringCodePointAt)(T,g);if(!U(A,M))return!1;g+=(0,m.numCodeUnits)(M)}var K=T.indexOf(":",g);return K<0?ne(A,T.substring(g)):ne(A,T.substring(g,K))&&ne(A,T.substring(K+1))}(X,b)&&!function(A,T){var g=A.leftBracket.length,O=A.rightBracket.length;return!(T.length<g+O)&&T.substring(0,g)===A.leftBracket&&T.substring(T.length-O)===A.rightBracket&&ne(A,T.substring(g,T.length-O))}(X,b)}function Z(X,Q,b){return $(X,Q,b)?ie(b):b}function ie(X){return"'"+X.replace(V,"''")+"'"}t.shouldQuoteQualifier=$,t.formatQualifier=Z,t.quoteQualifier=ie,t.formatGridRange=function(X,Q){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:c.RefStyle.A1,R=arguments.length>3?arguments[3]:void 0,P=arguments.length>4?arguments[4]:void 0,A=Q.cols===1&&Q.rows===1?L(X,b,(0,s.gridCell)(0,0),(0,c.pos)(c.PosKind.Rel,Q.row),(0,c.pos)(c.PosKind.Rel,Q.col),!1):D(X,b,(0,s.gridCell)(0,0),(0,c.pos)(c.PosKind.Rel,Q.row),(0,c.pos)(c.PosKind.Rel,Q.col),(0,c.pos)(c.PosKind.Rel,Q.row+Q.rows-1),(0,c.pos)(c.PosKind.Rel,Q.col+Q.cols-1),!1);if((0,f.assertTrue)("calc.lang.formatGridRange",A!==void 0),R===void 0&&P===void 0)return A;if(R===void 0||P===void 0)return Z(X,b,R??P)+"!"+A;var T=R+":"+P;return($(X,b,R)||$(X,b,P)?ie(T):T)+"!"+A},t.formatName=function(X,Q){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:c.RefStyle.A1,R=arguments.length>3?arguments[3]:void 0;return R===void 0?Q:Z(X,b,R)+"!"+Q}},6789:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapPosition=t.parseQualifier=t.parseGridRangeA1=t.parseGridCellA1=t.parseCellRef=t.isR1C1IdentStart=t.SpecialPos=void 0;var s=d(342),c=d(5385),l=d(4333),f=d(190),p=d(7638),m=d(8678),v=d(419),h=s.sheetRows,S=h.toString(10).length,y=s.sheetCols,C=y.toString(26).length,E=y.toString(10).length,I=p.codePointCapitalA,F=p.codePointCapitalZ,w=p.codePointSmallA,B=p.codePointSmallZ,k=p.codePointPlusSign,x=p.codePointMinusSign,G=p.codePointColon;function H(A){return A>=w&&A<=B||A>=I&&A<=F}function L(A){return 1+(A>=w?A-w:A-I)}function D(A,T,g,O){return function(M,K,W,z,ee){var ue=function(Oe,le){return(0,m.stringStartsWith)(Oe,"$",le)?[l.PosKind.Abs,le+1]:[l.PosKind.Rel,le]}(W,z),ce=Mr(ue,2),he=ce[0],de=ce[1],pe=A(M,g,W,de),_e=Mr(pe,2),Ce=_e[0],Ne=_e[1];if(Ne>de){if(Ce<1||Ce>T)return he===l.PosKind.Abs||(O===!0?typeof ee=="object"&&ee.kind===l.PosKind.Abs||ee===b.A1BadDollar:(0,m.stringStartsWith)(W,"$",Ne))?[b.A1BadDollar,!0,Ne]:void 0;var Le=he===l.PosKind.Rel?Ce-K:Ce;return[(0,l.pos)(he,Le-1),he===l.PosKind.Abs,Ne]}return he!==l.PosKind.Abs||O!==!0&&Ne!==W.length&&M.isNumeral((0,v.stringCodePointAt)(W,Ne))?[void 0,!1,z]:[b.A1BadDollar,!0,Ne]}}function U(A,T,g){return P(A,T,g)-A}function V(A,T,g,O){return function(M,K,W,z){var ee=T?A?"R":M.rowLetter:A?"C":M.columnLetter;if(z>=W.length||M.stringCompareCI(ee,W[z])!==0)return[void 0,!1,z];var ue=z+ee.length,ce=(0,f.parseUint)(M,O,W,ue),he=Mr(ce,2),de=he[0],pe=he[1];if(pe>ue&&de>=1&&de<=g)return[(0,l.pos)(l.PosKind.Abs,de-1),!1,pe];if((0,m.stringStartsWith)(W,M.rcLeftBracket,ue)){if(ue+=M.rcLeftBracket.length,(0,m.stringStartsWith)(W,M.rcRightBracket,ue))return[(0,l.pos)(l.PosKind.Rel,U(K,0,g)),!0,ue+M.rcRightBracket.length];var _e=1,Ce=W.charCodeAt(ue);Ce===k?ue+=1:Ce===x&&(_e=-1,ue+=1);var Ne=(0,f.parseUint)(M,O,W,ue),Le=Mr(Ne,2),Oe=Le[0],le=Le[1];if(le>ue&&Oe<g&&(0,m.stringStartsWith)(W,M.rcRightBracket,le))return[(0,l.pos)(l.PosKind.Rel,U(K,Oe*_e,g)),!0,le+M.rcRightBracket.length]}return[b.RCNoNum,!1,z+ee.length]}}function ne(A,T,g,O,M,K,W){var z=O(A,T,K,W,void 0);if(z==null)return[void 0,void 0,W];var ee=Mr(z,3),ue=ee[0],ce=ee[1],he=ee[2];if(he>W){var de=M(A,g,K,he,ue);if(de==null)return ce?[ue,void 0,he]:[void 0,void 0,W];var pe=Mr(de,3),_e=pe[0],Ce=pe[2];return Ce>he?[ue,_e,Ce]:[ue,void 0,he]}var Ne=M(A,g,K,W,ue);if(Ne==null)return[void 0,void 0,W];var Le=Mr(Ne,3),Oe=Le[0],le=Le[2];return le>W?[void 0,Oe,le]:[void 0,void 0,W]}var J=D(f.parseUint,h,S,!0),$=D(function(A,T,g,O){return function(M,K,W){for(var z=0,ee=W,ue=(0,c.fastMin)(K.length,W+M);ee<ue;ee+=1){var ce=K.charCodeAt(ee);if(!H(ce))break;z=26*z+L(ce)}return ee===ue&&ee<K.length&&H(K.charCodeAt(ee))?[0,W]:[z,ee]}(T,g,O)},y,C,!1),Z=V(!1,!0,h,S),ie=V(!1,!1,y,E),X=V(!0,!0,h,S),Q=V(!0,!1,y,E),b;function R(A,T){return typeof A!="object"&&typeof T!="object"}function P(A,T,g){return A+T&g-1}(function(A){A[A.RCNoNum=0]="RCNoNum",A[A.A1BadDollar=1]="A1BadDollar"})(b=t.SpecialPos||(t.SpecialPos={})),t.isR1C1IdentStart=R,t.parseCellRef=function(A,T,g,O,M){var K=function(W,z,ee,ue,ce){var he=ee.col,de=ee.row,pe=ne(W,he,de,$,J,ue,ce),_e=Mr(pe,3),Ce=_e[0],Ne=_e[1],Le=_e[2],Oe=typeof Ne=="object"&&Ne.kind===l.PosKind.Abs||Ne===b.A1BadDollar||typeof Ce=="object"&&Ce.kind===l.PosKind.Abs||Ce===b.A1BadDollar;if(Ne!=null&&Ce!=null||Oe||(Ne!=null||Ce!=null)&&(ce-1>=0&&ue.charCodeAt(ce-1)===G||Le<ue.length&&ue.charCodeAt(Le)===G))return Le<ue.length&&W.isIdentContinue((0,v.stringCodePointAt)(ue,Le))||z!==l.RefStyle.A1&&!Oe?void 0:{refStyle:l.RefStyle.A1,row:Ne,col:Ce,i:Le}}(A,T,g,O,M);return K!==void 0?K:function(W,z,ee,ue,ce){var he,de,pe=ee.col,_e=ee.row,Ce=!1,Ne=ne(W,_e,pe,Z,ie,ue,ce),Le=Mr(Ne,3),Oe=Le[0],le=Le[1],me=Le[2];if(Oe!=null||le!=null||W.rowLetter==="R"&&W.columnLetter==="C"||(Ce=!0,he=ne(W,_e,pe,X,Q,ue,ce),de=Mr(he,3),Oe=de[0],le=de[1],me=de[2]),(Oe!=null||le!=null)&&(me>=ue.length||!R(Oe,le)||!W.isIdentContinue((0,v.stringCodePointAt)(ue,me))))return{refStyle:l.RefStyle.R1C1,row:Oe,col:le,i:me,enLocale:Ce}}(A,0,g,O,M)},t.parseGridCellA1=function(A,T){var g=ne(A,0,0,$,J,T,0),O=Mr(g,3),M=O[0],K=O[1],W=O[2];return typeof M=="object"&&typeof K=="object"&&W===T.length?(0,s.gridCell)(K.index,M.index):void 0},t.parseGridRangeA1=function(A,T){var g=ne(A,0,0,$,J,T,0),O=Mr(g,3),M=O[0],K=O[1],W=O[2];if(!(typeof M!="object"||typeof K!="object")){if(W===T.length)return(0,s.gridCell)(K.index,M.index);if(T.charCodeAt(W)===G){var z=ne(A,0,0,$,J,T,W+1),ee=Mr(z,3),ue=ee[0],ce=ee[1],he=ee[2];if(!(typeof ue!="object"||typeof ce!="object")&&he===T.length){var de=(0,c.fastMin)(K.index,ce.index),pe=(0,c.fastMin)(M.index,ue.index);return(0,s.gridRange)(de,pe,(0,c.fastMax)(K.index,ce.index)+1-de,(0,c.fastMax)(M.index,ue.index)+1-pe)}}}},t.parseQualifier=function(A){var T=A.lastIndexOf("!");if(!(T<0||T===0||T===A.length-1)){var g=A.substring(0,T),O=A.substring(T+1);if(g.indexOf("'")<0)return{qualifier:g,unqualified:O};if(!(!(0,m.stringStartsWith)(g,"'")||!(0,m.stringEndsWith)(g,"'"))){for(var M=[],K=1;K<g.length-1;++K){var W=g.charAt(K);if(W==="'"){if(K+1>=g.length-1||g.charAt(K+1)!=="'")return;M.push(W),++K}else M.push(W)}return{qualifier:M.join(""),unqualified:O}}}},t.wrapPosition=P},1033:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.kindAnonymizers=t.anonymizeMagnitude=t.anonymizeFormulaString=t.anonymize=void 0;var s=d(637);t.anonymize=s.anonymizer.anonymize,t.anonymizeFormulaString=s.anonymizer.anonymizeFormulaString,t.anonymizeMagnitude=s.anonymizer.anonymizeMagnitude,t.kindAnonymizers=s.anonymizer.kindAnonymizers},8660:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertPositiveInteger=t.assertInteger=t.assertIndex=t.assertNatural=t.assertNever=t.assertFalse=t.assertTrue=t.ulsLogger=void 0;var s=d(637);t.ulsLogger=s.assertions.ulsLogger,t.assertTrue=s.assertions.assertTrue,t.assertFalse=s.assertions.assertFalse,t.assertNever=s.assertions.assertNever,t.assertNatural=s.assertions.assertNatural,t.assertIndex=s.assertions.assertIndex,t.assertInteger=s.assertions.assertInteger,t.assertPositiveInteger=s.assertions.assertPositiveInteger,t.assertPositiveLength=s.assertions.assertPositiveLength},7638:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codePointExclamationMark=t.codePointEuroSign=t.codePointEqualsSign=t.codePointDoubleQuote=t.codePointDollarSign=t.codePointDigitZero=t.codePointDigitTwo=t.codePointDigitThree=t.codePointDigitSix=t.codePointDigitSeven=t.codePointDigitOne=t.codePointDigitNine=t.codePointDigitFour=t.codePointDigitFive=t.codePointDigitEight=t.codePointComma=t.codePointColon=t.codePointCircumflexAccent=t.codePointCapitalZ=t.codePointCapitalY=t.codePointCapitalX=t.codePointCapitalW=t.codePointCapitalV=t.codePointCapitalU=t.codePointCapitalT=t.codePointCapitalS=t.codePointCapitalR=t.codePointCapitalQ=t.codePointCapitalP=t.codePointCapitalO=t.codePointCapitalN=t.codePointCapitalM=t.codePointCapitalL=t.codePointCapitalK=t.codePointCapitalJ=t.codePointCapitalI=t.codePointCapitalH=t.codePointCapitalG=t.codePointCapitalF=t.codePointCapitalE=t.codePointCapitalD=t.codePointCapitalC=t.codePointCapitalB=t.codePointCapitalA=t.codePointCR=t.codePointBacktick=t.codePointBackslash=t.codePointAtSign=t.codePointAsterisk=t.codePointAmpersand=void 0,t.codePointSmallW=t.codePointSmallV=t.codePointSmallU=t.codePointSmallT=t.codePointSmallS=t.codePointSmallR=t.codePointSmallQ=t.codePointSmallP=t.codePointSmallO=t.codePointSmallN=t.codePointSmallM=t.codePointSmallL=t.codePointSmallK=t.codePointSmallJ=t.codePointSmallI=t.codePointSmallH=t.codePointSmallG=t.codePointSmallF=t.codePointSmallE=t.codePointSmallD=t.codePointSmallC=t.codePointSmallB=t.codePointSmallA=t.codePointSlash=t.codePointSingleQuote=t.codePointSemicolon=t.codePointRightSquareBracket=t.codePointRightParen=t.codePointRightCurlyBracket=t.codePointQuestionMark=t.codePointPlusSign=t.codePointPipe=t.codePointPercentSign=t.codePointMinusSign=t.codePointLessThanSign=t.codePointLeftSquareBracket=t.codePointLeftParen=t.codePointLeftCurlyBracket=t.codePointLF=t.codePointInvertedQuestionMark=t.codePointInvertedExclamationMark=t.codePointHash=t.codePointGreaterThanSign=t.codePointFullwidthLatinSmallZ=t.codePointFullwidthLatinSmallA=t.codePointFullwidthLatinCapitalZ=t.codePointFullwidthLatinCapitalA=t.codePointFullwidthDigitZero=t.codePointFullwidthDigitNine=t.codePointFullStop=void 0,t.codePointUnderscore=t.codePointTilde=t.codePointThaiDigitZero=t.codePointThaiDigitNine=t.codePointTab=t.codePointSpace=t.codePointSmallZ=t.codePointSmallY=t.codePointSmallX=void 0;var s=d(637);t.codePointAmpersand=s.codePoint.codePointAmpersand,t.codePointAsterisk=s.codePoint.codePointAsterisk,t.codePointAtSign=s.codePoint.codePointAtSign,t.codePointBackslash=s.codePoint.codePointBackslash,t.codePointBacktick=s.codePoint.codePointBacktick,t.codePointCR=s.codePoint.codePointCR,t.codePointCapitalA=s.codePoint.codePointCapitalA,t.codePointCapitalB=s.codePoint.codePointCapitalB,t.codePointCapitalC=s.codePoint.codePointCapitalC,t.codePointCapitalD=s.codePoint.codePointCapitalD,t.codePointCapitalE=s.codePoint.codePointCapitalE,t.codePointCapitalF=s.codePoint.codePointCapitalF,t.codePointCapitalG=s.codePoint.codePointCapitalG,t.codePointCapitalH=s.codePoint.codePointCapitalH,t.codePointCapitalI=s.codePoint.codePointCapitalI,t.codePointCapitalJ=s.codePoint.codePointCapitalJ,t.codePointCapitalK=s.codePoint.codePointCapitalK,t.codePointCapitalL=s.codePoint.codePointCapitalL,t.codePointCapitalM=s.codePoint.codePointCapitalM,t.codePointCapitalN=s.codePoint.codePointCapitalN,t.codePointCapitalO=s.codePoint.codePointCapitalO,t.codePointCapitalP=s.codePoint.codePointCapitalP,t.codePointCapitalQ=s.codePoint.codePointCapitalQ,t.codePointCapitalR=s.codePoint.codePointCapitalR,t.codePointCapitalS=s.codePoint.codePointCapitalS,t.codePointCapitalT=s.codePoint.codePointCapitalT,t.codePointCapitalU=s.codePoint.codePointCapitalU,t.codePointCapitalV=s.codePoint.codePointCapitalV,t.codePointCapitalW=s.codePoint.codePointCapitalW,t.codePointCapitalX=s.codePoint.codePointCapitalX,t.codePointCapitalY=s.codePoint.codePointCapitalY,t.codePointCapitalZ=s.codePoint.codePointCapitalZ,t.codePointCircumflexAccent=s.codePoint.codePointCircumflexAccent,t.codePointColon=s.codePoint.codePointColon,t.codePointComma=s.codePoint.codePointComma,t.codePointDigitEight=s.codePoint.codePointDigitEight,t.codePointDigitFive=s.codePoint.codePointDigitFive,t.codePointDigitFour=s.codePoint.codePointDigitFour,t.codePointDigitNine=s.codePoint.codePointDigitNine,t.codePointDigitOne=s.codePoint.codePointDigitOne,t.codePointDigitSeven=s.codePoint.codePointDigitSeven,t.codePointDigitSix=s.codePoint.codePointDigitSix,t.codePointDigitThree=s.codePoint.codePointDigitThree,t.codePointDigitTwo=s.codePoint.codePointDigitTwo,t.codePointDigitZero=s.codePoint.codePointDigitZero,t.codePointDollarSign=s.codePoint.codePointDollarSign,t.codePointDoubleQuote=s.codePoint.codePointDoubleQuote,t.codePointEqualsSign=s.codePoint.codePointEqualsSign,t.codePointEuroSign=s.codePoint.codePointEuroSign,t.codePointExclamationMark=s.codePoint.codePointExclamationMark,t.codePointFullStop=s.codePoint.codePointFullStop,t.codePointFullwidthDigitNine=s.codePoint.codePointFullwidthDigitNine,t.codePointFullwidthDigitZero=s.codePoint.codePointFullwidthDigitZero,t.codePointFullwidthLatinCapitalA=s.codePoint.codePointFullwidthLatinCapitalA,t.codePointFullwidthLatinCapitalZ=s.codePoint.codePointFullwidthLatinCapitalZ,t.codePointFullwidthLatinSmallA=s.codePoint.codePointFullwidthLatinSmallA,t.codePointFullwidthLatinSmallZ=s.codePoint.codePointFullwidthLatinSmallZ,t.codePointGreaterThanSign=s.codePoint.codePointGreaterThanSign,t.codePointHash=s.codePoint.codePointHash,t.codePointInvertedExclamationMark=s.codePoint.codePointInvertedExclamationMark,t.codePointInvertedQuestionMark=s.codePoint.codePointInvertedQuestionMark,t.codePointLF=s.codePoint.codePointLF,t.codePointLeftCurlyBracket=s.codePoint.codePointLeftCurlyBracket,t.codePointLeftParen=s.codePoint.codePointLeftParen,t.codePointLeftSquareBracket=s.codePoint.codePointLeftSquareBracket,t.codePointLessThanSign=s.codePoint.codePointLessThanSign,t.codePointMinusSign=s.codePoint.codePointMinusSign,t.codePointPercentSign=s.codePoint.codePointPercentSign,t.codePointPipe=s.codePoint.codePointPipe,t.codePointPlusSign=s.codePoint.codePointPlusSign,t.codePointQuestionMark=s.codePoint.codePointQuestionMark,t.codePointRightCurlyBracket=s.codePoint.codePointRightCurlyBracket,t.codePointRightParen=s.codePoint.codePointRightParen,t.codePointRightSquareBracket=s.codePoint.codePointRightSquareBracket,t.codePointSemicolon=s.codePoint.codePointSemicolon,t.codePointSingleQuote=s.codePoint.codePointSingleQuote,t.codePointSlash=s.codePoint.codePointSlash,t.codePointSmallA=s.codePoint.codePointSmallA,t.codePointSmallB=s.codePoint.codePointSmallB,t.codePointSmallC=s.codePoint.codePointSmallC,t.codePointSmallD=s.codePoint.codePointSmallD,t.codePointSmallE=s.codePoint.codePointSmallE,t.codePointSmallF=s.codePoint.codePointSmallF,t.codePointSmallG=s.codePoint.codePointSmallG,t.codePointSmallH=s.codePoint.codePointSmallH,t.codePointSmallI=s.codePoint.codePointSmallI,t.codePointSmallJ=s.codePoint.codePointSmallJ,t.codePointSmallK=s.codePoint.codePointSmallK,t.codePointSmallL=s.codePoint.codePointSmallL,t.codePointSmallM=s.codePoint.codePointSmallM,t.codePointSmallN=s.codePoint.codePointSmallN,t.codePointSmallO=s.codePoint.codePointSmallO,t.codePointSmallP=s.codePoint.codePointSmallP,t.codePointSmallQ=s.codePoint.codePointSmallQ,t.codePointSmallR=s.codePoint.codePointSmallR,t.codePointSmallS=s.codePoint.codePointSmallS,t.codePointSmallT=s.codePoint.codePointSmallT,t.codePointSmallU=s.codePoint.codePointSmallU,t.codePointSmallV=s.codePoint.codePointSmallV,t.codePointSmallW=s.codePoint.codePointSmallW,t.codePointSmallX=s.codePoint.codePointSmallX,t.codePointSmallY=s.codePoint.codePointSmallY,t.codePointSmallZ=s.codePoint.codePointSmallZ,t.codePointSpace=s.codePoint.codePointSpace,t.codePointTab=s.codePoint.codePointTab,t.codePointThaiDigitNine=s.codePoint.codePointThaiDigitNine,t.codePointThaiDigitZero=s.codePoint.codePointThaiDigitZero,t.codePointTilde=s.codePoint.codePointTilde,t.codePointUnderscore=s.codePoint.codePointUnderscore},5385:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.now=t.mapFromArrayOfPairs=t.singleton=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0;var s=d(637);t.makeNewtypeIso=s.core.makeNewtypeIso,t.staticAssertExtends=s.core.staticAssertExtends,t.staticAssertSame=s.core.staticAssertSame,t.staticAssertIs=s.core.staticAssertIs,t.staticAssertIsOptional=s.core.staticAssertIsOptional,t.identity=s.core.identity,t.makeStringMap=s.core.makeStringMap,t.cloneStringMap=s.core.cloneStringMap,t.numEnumArray=s.core.numEnumArray,t.numEnumMap=s.core.numEnumMap,t.strEnumArray=s.core.strEnumArray,t.safePush=s.core.safePush,t.safeConcat=s.core.safeConcat,t.isDefined=s.core.isDefined,t.isNone=s.core.isNone,t.filterOutNones=s.core.filterOutNones,t.pair=s.core.pair,t.fastMin=s.core.fastMin,t.fastMax=s.core.fastMax,t.fastAbs=s.core.fastAbs,t.makeStringCompareCI=s.core.makeStringCompareCI,t.typedInstanceCreator=s.core.typedInstanceCreator,t.singleton=s.core.singleton,t.mapFromArrayOfPairs=s.core.mapFromArrayOfPairs,t.now=s.core.now},8391:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.enumerateKeysInOrder=t.enumerateInOrder=t.RootPointer=t.ArrayMapTree=t.floorToPowerOf2=void 0;var s=d(637);t.floorToPowerOf2=s.arrayMapTree.floorToPowerOf2,t.ArrayMapTree=s.arrayMapTree.ArrayMapTree,t.RootPointer=s.arrayMapTree.RootPointer,t.enumerateInOrder=s.arrayMapTree.enumerateInOrder,t.enumerateKeysInOrder=s.arrayMapTree.enumerateKeysInOrder},6553:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ivlCompare=t.ivlExcept=t.ivlMeetsOrTouches=t.ivlMeets=t.ivlDistance=t.ivlMeet=t.ivlJoin=void 0;var s=d(637);t.ivlJoin=s.interval.ivlJoin,t.ivlMeet=s.interval.ivlMeet,t.ivlDistance=s.interval.ivlDistance,t.ivlMeets=s.interval.ivlMeets,t.ivlMeetsOrTouches=s.interval.ivlMeetsOrTouches,t.ivlExcept=s.interval.ivlExcept,t.ivlCompare=s.interval.ivlCompare},292:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.entry=t.makeEmptyTable=void 0;var s=d(637);t.makeEmptyTable=s.table.makeEmptyTable,t.entry=s.table.entry},9124:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.isTypedChangeGateEnabled=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;var s=d(637);t.FeatureName=s.featureConfiguration.FeatureName,t.initFeatureConfiguration=s.featureConfiguration.initFeatureConfiguration,t.isFeatureEnabled=s.featureConfiguration.isFeatureEnabled,t.getFeatures=s.featureConfiguration.getFeatures,t.getTypedFeatureGate=s.featureConfiguration.getTypedFeatureGate,t.isTypedChangeGateEnabled=s.featureConfiguration.isTypedChangeGateEnabled;var c=d(9992);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return c.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return c.setFeatureGateDictionaryGetter}})},6903:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.successUndefined=t.success=t.javaScriptError=t.isSuccess=t.failure=t.ResultKind=t.ReasonKind=void 0;var s=d(637);t.ReasonKind=s.result.ReasonKind,t.ResultKind=s.result.ResultKind,t.failure=s.result.failure,t.isSuccess=s.result.isSuccess,t.javaScriptError=s.result.javaScriptError,t.success=s.result.success,t.successUndefined=s.result.successUndefined},5781:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pledge=void 0;var s=d(637);t.Pledge=s.pledge.Pledge},419:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.surrogatePairToCodePoint=t.stringFromCodePoint=t.stringCodePointAt=t.scanCodePointsBack=t.scanCodePoints=t.numCodeUnits=t.makeGetCharCodeBits=t.isLowSurrogate=t.isHighSurrogate=t.isAnySurrogate=t.forEachClassInterval=t.countCodePoints=t.codePointIterator=t.CharCodeBits=void 0;var s=d(637);t.CharCodeBits=s.unicode.CharCodeBits,t.codePointIterator=s.unicode.codePointIterator,t.countCodePoints=s.unicode.countCodePoints,t.forEachClassInterval=s.unicode.forEachClassInterval,t.isAnySurrogate=s.unicode.isAnySurrogate,t.isHighSurrogate=s.unicode.isHighSurrogate,t.isLowSurrogate=s.unicode.isLowSurrogate,t.makeGetCharCodeBits=s.unicode.makeGetCharCodeBits,t.numCodeUnits=s.unicode.numCodeUnits,t.scanCodePoints=s.unicode.scanCodePoints,t.scanCodePointsBack=s.unicode.scanCodePointsBack,t.stringCodePointAt=s.unicode.stringCodePointAt,t.stringFromCodePoint=s.unicode.stringFromCodePoint,t.surrogatePairToCodePoint=s.unicode.surrogatePairToCodePoint},8678:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.stringStartsWith=t.stringEndsWith=t.repeat=t.prependErrorMessage=t.partialArray=t.messageFromError=t.mathLog2=t.isInteger=t.arrayFill=void 0;var s=d(637);t.arrayFill=s.util.arrayFill,t.isInteger=s.util.isInteger,t.mathLog2=s.util.mathLog2,t.messageFromError=s.util.messageFromError,t.partialArray=s.util.partialArray,t.prependErrorMessage=s.util.prependErrorMessage,t.repeat=s.util.repeat,t.stringEndsWith=s.util.stringEndsWith,t.stringStartsWith=s.util.stringStartsWith,t.values=s.util.values},8556:function(u,t,d){"use strict";var s,c,l,f,p,m;Object.defineProperty(t,"__esModule",{value:!0}),t.getEnglishLocaleInfo=t.createWorksheetFuncNameCallbacks=t.getEnglishWorksheetFuncIdToName=t.operatorIdToName=t.englishOperatorIdToName=t.englishErrorTypeToName=t.englishWorksheetFuncIdToName=t.englishSysTimeFormat=t.englishSysDateFormat=t.englishPictureDbnum=t.englishPictureColor=t.englishPictureSingle=t.englishPictureSpecial=t.englishSpecialRefNames=t.englishErrorNames=t.isIdentContinue=t.isIdentStart=t.getNumberShape=t.getOrdinal=t.isNumeral=t.PictureDbnum=t.PictureColor=t.PictureSingle=t.PictureSpecial=t.LCID=t.Country=t.localeInfo=t.calcConfig=t.ulsLogger=t.NulLogger=t.TraceLevel=t.LogCategory=void 0;var v=d(1821);Object.defineProperty(t,"LogCategory",{enumerable:!0,get:function(){return v.LogCategory}}),Object.defineProperty(t,"TraceLevel",{enumerable:!0,get:function(){return v.TraceLevel}}),Object.defineProperty(t,"NulLogger",{enumerable:!0,get:function(){return v.NulLogger}});var h=d(5385),S=d(8660);Object.defineProperty(t,"ulsLogger",{enumerable:!0,get:function(){return S.ulsLogger}});var y=d(9431),C=d(8678),E=d(419),I=d(873),F=d(8391),w=d(2054),B=d(4333),k=d(378),x=d(9612),G=d(446);function H(g,O,M,K,W,z,ee,ue,ce,he,de,pe,_e,Ce,Ne,Le,Oe,le,me,Pe,Re,fe,Se,be,xe,Ie,Ve,Ze,gr,cr,_r,xr,Or,Rr,ir,$e,qe,fr,lr,dn,Un,Gr,Br,bt,Kr,Pt,Mi,El,Nl,ys,_d,xu,pi,xa,$i,$o,ar,ye,Rd,Ji,By,nr,Rn,IS,jf,qy,Uy,MS){return{getWorksheetFuncId:g,getWorksheetFuncName:O,isNumeral:M,getOrdinal:K,getNumberShape:W,isThousandsPosition:z,isIdentStart:ee,isIdentContinue:ue,stringCompareCI:ce,errorNames:he,specialRefNames:de,trueName:pe,falseName:_e,rowLetter:Ce,columnLetter:Ne,leftBrace:Le,rightBrace:Oe,leftBracket:le,rightBracket:me,rcLeftBracket:Pe,rcRightBracket:Re,decimalSeparator:fe,listSeparator:Se,columnSeparator:be,rowSeparator:xe,thousandsSeparator:Ie,statementSeparator:Ve,lcid:Ze,country:gr,isThai:cr,isEastAsia:_r,isKorea:xr,isJapan:Or,isChinaT:Rr,isChinaS:ir,isComplexScript:$e,numberDecimals:qe,isExpSepBySpace:fr,fractionSeparator:lr,isPercentSepBySpace:dn,currencyFormat:Un,isCurrencySymbolLead:Gr,isCurrencySepBySpace:Br,currencySymbol:bt,currencyDecimals:Kr,dateOrder:Pt,dateSeparator:Mi,dateAltSeparator:El,year4Digits:Nl,month2Digits:ys,day2Digits:_d,longDateFormat:xu,timeSeparator:pi,timeAltSeparator:xa,hour2Digits:$i,clock24Hour:$o,isAMPMSepBySpace:ar,ampmSymbols:ye,dayNameShort:Rd,dayNameLong:Ji,monthNameShort:By,monthNameLong:nr,pictureSpecial:Rn,pictureSingle:IS,pictureColor:jf,pictureDbnum:qy,sysDateFormat:Uy,sysTimeFormat:MS}}var L,D,U,V,ne,J;function $(g){var O=0|g;if(O<128)return O>=48&&O<58;var M=15&O;switch(2147483632&O){case 1632:case 1776:case 3664:case 3792:case 3872:case 4160:case 6112:case 6160:return M<=9;case 2400:case 2528:case 2656:case 2784:case 2912:case 3040:case 3168:case 3296:case 3424:return M>=6&&M<=15;case 4960:return M>=9;case 4976:return M<=1;default:return!1}}function Z(g){var O=0|g;if(O<128)return(O<48||O>=58)&&(0,S.assertFalse)("calc.config.getOrdinal"),15&O;var M=15&O,K;switch(2147483632&O){case 1632:case 1776:case 3664:case 3792:case 3872:case 4160:case 6112:case 6160:K=M;break;case 2400:case 2528:case 2656:case 2784:case 2912:case 3040:case 3168:case 3296:case 3424:K=M-6;break;case 4960:K=M-8;break;case 4976:K=M+8;break;default:return(0,S.assertFalse)("calc.config.getOrdinal")}return(K<0||K>9||O===4968)&&(0,S.assertFalse)("calc.config.getOrdinal"),K}function ie(g){var O=0|g;if(O<128)return(O<48||O>=58)&&(0,S.assertFalse)("calc.config.getNumberShape"),k.NumberShape.ASCII;switch($(O)||(0,S.assertFalse)("calc.config.getNumberShape"),2147483632&O){case 1632:return k.NumberShape.ArabicIndic;case 1776:return k.NumberShape.ExtendedArabicIndic;case 2400:return k.NumberShape.Devanagari;case 2528:return k.NumberShape.Bengali;case 2656:return k.NumberShape.Gurmukhi;case 2784:return k.NumberShape.Gujarati;case 2912:return k.NumberShape.Oriya;case 3040:return k.NumberShape.Tamil;case 3168:return k.NumberShape.Telugu;case 3296:return k.NumberShape.Kannada;case 3424:return k.NumberShape.Malayalam;case 3664:return k.NumberShape.Thai;case 3792:return k.NumberShape.Lao;case 3872:return k.NumberShape.Tibetan;case 4160:return k.NumberShape.Myanmar;case 4960:case 4976:return k.NumberShape.Ethiopic;case 6112:return k.NumberShape.Khmer;case 6160:return k.NumberShape.Mongolian;default:return(0,S.assertFalse)("calc.config.getNumberShape")}}function X(g){return((0,I.getCharCodeBits)(g)&E.CharCodeBits.IdentStartClass)!=0}function Q(g){return((0,I.getCharCodeBits)(g)&E.CharCodeBits.IdentContinueClass)!=0}var b;t.calcConfig=function(g){var O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:B.RefStyle.A1,M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:G.xlMathpack,K=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,W=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,z=arguments.length>5&&arguments[5]!==void 0?arguments[5]:x.tzUTC,ee=arguments.length>6&&arguments[6]!==void 0?arguments[6]:x.xlDatepack;return{localeInfo:g,refStyle:O,mathpack:M,date1904:K,dateCompatibility:W,timezone:z,datepack:ee}},t.localeInfo=H,function(g){g[g.USA=1]="USA",g[g.UK=44]="UK",g[g.AUS=61]="AUS",g[g.NZ=64]="NZ",g[g.UNK=1]="UNK",g[g.CAN=2]="CAN",g[g.DUT=31]="DUT",g[g.FRN=33]="FRN",g[g.SPA=34]="SPA",g[g.ITN=39]="ITN",g[g.SWE=46]="SWE",g[g.GER=49]="GER",g[g.JPN=81]="JPN",g[g.MEX=52]="MEX",g[g.BRA=55]="BRA",g[g.LAM=3]="LAM",g[g.BEL=32]="BEL",g[g.SWZ=41]="SWZ",g[g.SWG=41]="SWG",g[g.SWF=41]="SWF",g[g.AUT=43]="AUT",g[g.DAN=45]="DAN",g[g.NOR=47]="NOR",g[g.POR=351]="POR",g[g.FIN=358]="FIN",g[g.ICE=354]="ICE",g[g.GRK=30]="GRK",g[g.TUR=90]="TUR",g[g.CZE=420]="CZE",g[g.HUN=36]="HUN",g[g.POL=48]="POL",g[g.RUS=7]="RUS",g[g.HEB=972]="HEB",g[g.ARB=966]="ARB",g[g.PER=981]="PER",g[g.ARB_Algeria=213]="ARB_Algeria",g[g.ARB_Bahrain=966]="ARB_Bahrain",g[g.ARB_Djibouti=253]="ARB_Djibouti",g[g.ARB_Egypt=20]="ARB_Egypt",g[g.ARB_Iraq=964]="ARB_Iraq",g[g.ARB_Jordan=962]="ARB_Jordan",g[g.ARB_Kuwait=965]="ARB_Kuwait",g[g.ARB_Lebanon=961]="ARB_Lebanon",g[g.ARB_Libya=218]="ARB_Libya",g[g.ARB_Mauritania=222]="ARB_Mauritania",g[g.ARB_Morocco=216]="ARB_Morocco",g[g.ARB_Oman=968]="ARB_Oman",g[g.ARB_Qatar=974]="ARB_Qatar",g[g.ARB_SaudiArabia=966]="ARB_SaudiArabia",g[g.ARB_Somalia=1]="ARB_Somalia",g[g.ARB_Sudan=249]="ARB_Sudan",g[g.ARB_Syria=963]="ARB_Syria",g[g.ARB_Tunisia=216]="ARB_Tunisia",g[g.ARB_UAE=971]="ARB_UAE",g[g.ARB_Yemen=969]="ARB_Yemen",g[g.KOR=82]="KOR",g[g.TW=886]="TW",g[g.PRC=86]="PRC",g[g.THA=66]="THA",g[g.VIET=84]="VIET"}(L=t.Country||(t.Country={})),function(g){g[g.None=0]="None",g[g.USA=1033]="USA",g[g.Greek=1032]="Greek",g[g.Hungarian=1038]="Hungarian",g[g.Turkish=1055]="Turkish",g[g.Thailand=1054]="Thailand",g[g.Vietnam=1066]="Vietnam",g[g.Arabic=1025]="Arabic",g[g.Hebrew=1037]="Hebrew",g[g.Tamil=1097]="Tamil",g[g.Syriac=1114]="Syriac",g[g.Iraq=2049]="Iraq",g[g.Algerian=5121]="Algerian",g[g.Basque=1069]="Basque",g[g.PortBrazil=1046]="PortBrazil",g[g.Croatian=1050]="Croatian",g[g.Czech=1029]="Czech",g[g.Danish=1030]="Danish",g[g.Dutch=1043]="Dutch",g[g.Australian=3081]="Australian",g[g.CanadianEnglish=4105]="CanadianEnglish",g[g.British=2057]="British",g[g.Finnish=1035]="Finnish",g[g.French=1036]="French",g[g.FrenchCanadian=3084]="FrenchCanadian",g[g.Italian=1040]="Italian",g[g.NorskBokmal=1044]="NorskBokmal",g[g.NorskNynorsk=2068]="NorskNynorsk",g[g.Polish=1045]="Polish",g[g.PortIberian=2070]="PortIberian",g[g.Romanian=1048]="Romanian",g[g.Russian=1049]="Russian",g[g.Ukrainian=1058]="Ukrainian",g[g.Belarusian=1059]="Belarusian",g[g.SerbianCyrillic=3098]="SerbianCyrillic",g[g.SerbianLatin=2074]="SerbianLatin",g[g.Slovak=1051]="Slovak",g[g.Slovenian=1060]="Slovenian",g[g.SpanishModern=3082]="SpanishModern",g[g.Swedish=1053]="Swedish",g[g.HongKong=3076]="HongKong",g[g.ChinaT=1028]="ChinaT",g[g.Korea=1042]="Korea",g[g.Japan=1041]="Japan",g[g.China=2052]="China",g[g.ChinaStroke=133124]="ChinaStroke",g[g.Devihi=1125]="Devihi",g[g.Hindi=1081]="Hindi",g[g.German=1031]="German",g[g.Swiss=4108]="Swiss",g[g.SystemTime=62464]="SystemTime",g[g.SystemLongDate=63488]="SystemLongDate",g[g.EuroTrailing=1]="EuroTrailing",g[g.EuroLeading=2]="EuroLeading",g[g.LANG=1023]="LANG",g[g.COUNTRY=64512]="COUNTRY",g[g.OPTIONS=16711680]="OPTIONS"}(D=t.LCID||(t.LCID={})),function(g){g[g.AP1=0]="AP1",g[g.AP2=1]="AP2",g[g.AP3=2]="AP3",g[g.GeneralOldMAC=3]="GeneralOldMAC",g[g.General=4]="General",g[g.Currency=5]="Currency"}(U=t.PictureSpecial||(t.PictureSpecial={})),function(g){g[g.Sep=1]="Sep",g[g.Hash=2]="Hash",g[g.Zero=3]="Zero",g[g.Decimal=4]="Decimal",g[g.Percent=5]="Percent",g[g.Comma=6]="Comma",g[g.Colon=7]="Colon",g[g.DateSep=8]="DateSep",g[g.Slash=9]="Slash",g[g.Space=10]="Space",g[g.Minus=11]="Minus",g[g.Plus=12]="Plus",g[g.OpenParen=13]="OpenParen",g[g.CloseParen=14]="CloseParen",g[g.Extra=15]="Extra",g[g.Backslash=16]="Backslash",g[g.Star=17]="Star",g[g.Year=18]="Year",g[g.Month=19]="Month",g[g.Day=20]="Day",g[g.Hour=21]="Hour",g[g.Minute=22]="Minute",g[g.Second=23]="Second",g[g.E=24]="E",g[g.APDelim=25]="APDelim",g[g.Quote=26]="Quote",g[g.ColorStart=27]="ColorStart",g[g.ColorEnd=28]="ColorEnd",g[g.Text=29]="Text",g[g.Question=30]="Question",g[g.Underscore=31]="Underscore",g[g.Reign=32]="Reign",g[g.LocDay=33]="LocDay",g[g.Era=34]="Era",g[g.EraYear=35]="EraYear",g[g.Nen1=36]="Nen1",g[g.Gatsu1=37]="Gatsu1",g[g.Nichi1=38]="Nichi1",g[g.Nen2=39]="Nen2",g[g.Gatsu2=40]="Gatsu2",g[g.Nichi2=41]="Nichi2",g[g.BidiDate=42]="BidiDate",g[g.BidiNum=43]="BidiNum",g[g.DayTh=44]="DayTh",g[g.MonthTh=45]="MonthTh",g[g.YearTh=46]="YearTh",g[g.EngYearTh=47]="EngYearTh",g[g.ThYear=48]="ThYear",g[g.HourTh=49]="HourTh",g[g.MinuteTh=50]="MinuteTh",g[g.SecondTh=51]="SecondTh",g[g.ZeroTh=52]="ZeroTh"}(V=t.PictureSingle||(t.PictureSingle={})),function(g){g[g.Black=0]="Black",g[g.White=1]="White",g[g.Red=2]="Red",g[g.Green=3]="Green",g[g.Blue=4]="Blue",g[g.Yellow=5]="Yellow",g[g.Magenta=6]="Magenta",g[g.Cyan=7]="Cyan",g[g.Color=8]="Color"}(ne=t.PictureColor||(t.PictureColor={})),function(g){g[g.DBNUM1=0]="DBNUM1",g[g.DBNUM2=1]="DBNUM2",g[g.DBNUM3=2]="DBNUM3",g[g.DBNUM4=3]="DBNUM4"}(J=t.PictureDbnum||(t.PictureDbnum={})),t.isNumeral=$,t.getOrdinal=Z,t.getNumberShape=ie,t.isIdentStart=X,t.isIdentContinue=Q,t.englishErrorNames=(0,C.partialArray)((s={},Qe(s,w.ErrorType.NULL,"#NULL!"),Qe(s,w.ErrorType.DIV0,"#DIV/0!"),Qe(s,w.ErrorType.VALUE,"#VALUE!"),Qe(s,w.ErrorType.REF,"#REF!"),Qe(s,w.ErrorType.NAME,"#NAME?"),Qe(s,w.ErrorType.NUM,"#NUM!"),Qe(s,w.ErrorType.NA,"#N/A"),Qe(s,w.ErrorType.GETTING_DATA,"#GETTING_DATA"),Qe(s,w.ErrorType.SPILL,"#SPILL!"),Qe(s,w.ErrorType.CONNECT,"#CONNECT!"),Qe(s,w.ErrorType.BLOCKED,"#BLOCKED!"),Qe(s,w.ErrorType.UNKNOWN,"#UNKNOWN!"),Qe(s,w.ErrorType.FIELD,"#FIELD!"),Qe(s,w.ErrorType.CALC,"#CALC!"),Qe(s,w.ErrorType.BUSY,"#BUSY!"),Qe(s,w.ErrorType.EXTERNAL,"#EXTERNAL!"),s)),t.englishSpecialRefNames=(0,C.partialArray)((c={},Qe(c,B.SpecialRefId.All,"#All"),Qe(c,B.SpecialRefId.Data,"#Data"),Qe(c,B.SpecialRefId.Headers,"#Headers"),Qe(c,B.SpecialRefId.Totals,"#Totals"),Qe(c,B.SpecialRefId.ThisRow,"#This Row"),c)),t.englishPictureSpecial=(0,C.partialArray)((l={},Qe(l,U.AP1,"AM/PM"),Qe(l,U.AP2,"A/P"),Qe(l,U.AP3,"\u4E0A\u5348/\u4E0B\u5348"),Qe(l,U.General,"General"),Qe(l,U.Currency,"$"),l)),t.englishPictureSingle=(0,C.partialArray)((f={},Qe(f,V.Sep,";"),Qe(f,V.Hash,"#"),Qe(f,V.Zero,"0"),Qe(f,V.Decimal,"."),Qe(f,V.Percent,"%"),Qe(f,V.Comma,","),Qe(f,V.Colon,":"),Qe(f,V.DateSep,"/"),Qe(f,V.Slash,"/"),Qe(f,V.Space," "),Qe(f,V.Minus,"-"),Qe(f,V.Plus,"+"),Qe(f,V.OpenParen,"("),Qe(f,V.CloseParen,")"),Qe(f,V.Backslash,"\\"),Qe(f,V.Star,"*"),Qe(f,V.Year,"y"),Qe(f,V.Month,"m"),Qe(f,V.Day,"d"),Qe(f,V.Hour,"h"),Qe(f,V.Minute,"m"),Qe(f,V.Second,"s"),Qe(f,V.E,"E"),Qe(f,V.APDelim,"/"),Qe(f,V.Quote,'"'),Qe(f,V.ColorStart,"["),Qe(f,V.ColorEnd,"]"),Qe(f,V.Text,"@"),Qe(f,V.Question,"?"),Qe(f,V.Underscore,"_"),Qe(f,V.Reign,"r"),Qe(f,V.LocDay,"a"),Qe(f,V.Era,"g"),Qe(f,V.EraYear,"e"),Qe(f,V.BidiDate,"B"),Qe(f,V.BidiNum,"N"),Qe(f,V.DayTh,"\u0E27"),Qe(f,V.MonthTh,"\u0E14"),Qe(f,V.YearTh,"\u0E1B"),Qe(f,V.EngYearTh,"b"),Qe(f,V.ThYear,"\u0E04"),Qe(f,V.HourTh,"\u0E0A"),Qe(f,V.MinuteTh,"\u0E19"),Qe(f,V.SecondTh,"\u0E17"),Qe(f,V.ZeroTh,"\u0E50"),f)),t.englishPictureColor=(0,C.partialArray)((p={},Qe(p,ne.Black,"Black"),Qe(p,ne.White,"White"),Qe(p,ne.Red,"Red"),Qe(p,ne.Green,"Green"),Qe(p,ne.Blue,"Blue"),Qe(p,ne.Yellow,"Yellow"),Qe(p,ne.Magenta,"Magenta"),Qe(p,ne.Cyan,"Cyan"),Qe(p,ne.Color,"Color"),p)),t.englishPictureDbnum=(0,C.partialArray)((m={},Qe(m,J.DBNUM1,"DBNum1"),Qe(m,J.DBNUM2,"DBNum2"),Qe(m,J.DBNUM3,"DBNum3"),Qe(m,J.DBNUM4,"DBNum4"),m)),t.englishSysDateFormat="dddd, mmmm dd, yyyy",t.englishSysTimeFormat="h:mm:ss AM/PM",t.englishWorksheetFuncIdToName=function(g){var O=P()[g];return O===void 0?"wsf:"+g:O},t.englishErrorTypeToName=function(g){var O=t.englishErrorNames[g];return O===void 0?"error.type:"+g:O},t.englishOperatorIdToName=function(g){if(g===y.OperatorId.Isect)return" ";if(g===y.OperatorId.Union)return",";var O=y.operatorStrings[g];return O===void 0?"op:"+g:O},t.operatorIdToName=function(g,O,M){return O===y.OperatorId.Isect?M:O===y.OperatorId.Union?g.listSeparator:y.operatorStrings[O]};var R=/_/g;function P(){if(b==null){b=[];for(var g=da((0,h.numEnumArray)(y.WorksheetFuncId)),O;!(O=g()).done;){var M=O.value,K=(0,y.getWorksheetFuncEnglishName)(M),W=K??y.WorksheetFuncId[M].replace(R,".");b[M]=W}}return b}function A(g,O){var M=function(K,W){var z=[];return W.forEach(function(ee,ue){ee!=null&&z.push([ee,ue])}),F.ArrayMapTree.create(K).setValues(z)}(g,O);return{getWorksheetFuncId:function(W){return M.getValue(W)},getWorksheetFuncName:function(W){var z=O[W];return z??(0,S.assertFalse)("calc.config.getWorksheetFuncName: unknown function ID "+W)}}}var T;t.getEnglishWorksheetFuncIdToName=P,t.createWorksheetFuncNameCallbacks=A,t.getEnglishLocaleInfo=function(){return T==null&&(T=function(){var g=P(),O=(0,h.makeStringCompareCI)("en-US"),M=A(O,g),K=M.getWorksheetFuncId,W=M.getWorksheetFuncName;return H(K,W,$,Z,ie,function(z){return z>0&&z%3==0},X,Q,O,t.englishErrorNames,t.englishSpecialRefNames,"TRUE","FALSE","R","C","{","}","[","]","[","]",".",",",",",";",",",";",D.USA,L.USA,!1,!1,!1,!1,!1,!1,!1,2,!1," ",!1,k.CurrencyFormat.Paren,!0,!1,"$",2,k.DateOrder.MDY,"/","-",!0,!1,!1,!0,":",void 0,!1,!1,!0,["AM","PM"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],t.englishPictureSpecial,t.englishPictureSingle,t.englishPictureColor,t.englishPictureDbnum,t.englishSysDateFormat,t.englishSysTimeFormat)}()),T}},9612:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlDatepack=t.TimeGranularity=t.TimeDivision=t.dateTime=t.Rounding=t.tzUTC=t.tzData=void 0;var s=d(9799),c=d(2054),l=d(5385),f;t.tzData=(0,l.typedInstanceCreator)()(function(p,m,v,h,S){return{bias:p,standardDate:m,standardBias:v,daylightDate:h,daylightBias:S}}),t.tzUTC=(0,t.tzData)(0,void 0,0,void 0,0),t.Rounding=s.dtr.Rounding,t.dateTime=s.dtr.dtr,t.TimeDivision=s.dtr.TimeDivision,(f=t.TimeGranularity||(t.TimeGranularity={}))[f.Year=0]="Year",f[f.Day=1]="Day",f[f.Instant=2]="Instant",t.xlDatepack={fromNum:function(m,v,h){return s.dtr.fromNum(m.mathpack.toNumber(v),h,m.date1904,m.dateCompatibility)},toNum:function(m,v){var h=s.dtr.toNum(v,m.date1904,m.dateCompatibility);return typeof h=="number"?m.mathpack.fromNumber(h):c.numErrorOper},toNumWithDuration:function(m,v,h,S){var y=s.dtr.toNumWithDuration(v,m.date1904,m.dateCompatibility,h,S);return typeof y=="number"?m.mathpack.fromNumber(y):c.numErrorOper},daysPerMonth:s.dtr.daysPerMonth,toDays:function(m,v){return s.dtr.toDays(v,m.date1904,m.dateCompatibility)},toTime:function(m,v,h,S){return s.dtr.toTime(m.mathpack.toNumber(v),h,S)},utcToLocal:function(m,v,h){return s.dtr.utcToLocal(v,h,m.date1904,m.dateCompatibility)}}},4333:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parenNode=t.wsfNode=t.operatorNode=t.lambdaNode=t.lambdaParam=t.paramNode=t.paramDefault=t.paramName=t.flattenLambdaArgs=t.letNode=t.letVar=t.indexedArg=t.flattenLetArgs=t.appNode=t.arrayNode=t.literalNode=t.formulaRootAnnotation=t.localNameDeclAnnotation=t.localNameUseAnnotation=t.formulaSpan=t.multiLineComment=t.singleLineComment=t.formula=t.cellRefBad=t.cellRefCol=t.cellRefRow=t.cellRefRange=t.cellRefSingle=t.cellRefError=t.pos=t.badQualifier=t.sheetRangeQualifier=t.identQualifier=t.sheetQualifier=t.documentQualifier=t.relativeQualifier=t.errorQualifier=t.BadType=t.StructRefKind=t.SpecialRefId=t.NamePartKind=t.NodeKind=t.appHeadNameAnnotation=t.AnnotationKind=t.CommentKind=t.PosKind=t.CellRefKind=t.QualifierKind=t.SyntaxFeature=t.RefStyle=void 0,t.getDepthUpperBound=t.badNode=t.structRef=t.badRef=t.missingRef=t.thisRowOpRef=t.commaOpRef=t.rangeOpRef=t.columnRef=t.specialRef=t.structRefNode=t.fieldRef=t.fieldRefNode=t.cellRefNode=t.contextNameNode=t.headNamePart=t.flattenNameParts=t.fieldRefNamePart=t.cellRefNamePart=t.identNamePart=t.nameNode=void 0;var s=d(8660),c=d(5385),l=d(5385),f,p,m,v,h,S,y,C,E,I,F,w;function B(Q){return Array.isArray(Q)}function k(Q){return Q.kind!==void 0}function x(Q){for(var b=[],R=da(Q),P;!(P=R()).done;){var A=P.value,T=A.arg,g=A.index;(0,s.assertIndex)("calc.lang.flattenNumberedArgs: idx",g,Q.length),(0,s.assertTrue)("calc.lang.flattenNumberedArgs: repetition",b[g]===void 0),b[g]=T}return b}function G(Q,b,R){return x((0,l.safeConcat)([].concat(Pc(b===void 0?[]:[b]),Pc(R)),Q.map(function(P){var A=P.name,T=P.binder;return[A,T]})))}function H(Q,b){return{arg:Q,index:b}}function L(Q,b){return{name:Q,binder:b}}function D(Q,b){var R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];return x([].concat(Pc(Q.map(function(P){return P.name})),Pc(b===void 0?[]:[b]),Pc(R)))}function U(Q,b){var R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,P=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return{kind:h.ParamName,label:P,name:Q,isBracketed:b,isClosed:R}}function V(Q,b){var R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return{kind:h.Param,label:R,name:Q,whole:Q.name.kind===h.Name?Q.name.whole:void 0,def:b,isOptional:Q.isBracketed||b!==void 0}}function ne(Q){return{name:Q}}function J(Q,b){var R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,P=typeof Q=="string"?Q:Q.asWhole,A=typeof Q=="string"?$(Q,!0):Q;return{kind:h.Name,label:R,whole:P,parts:A,qualifier:b}}function $(Q){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,P=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return{kind:S.IdentNamePart,label:R,qualifiedLabel:P,asWhole:Q,canDenoteNamedObject:b}}function Z(Q){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,P=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return(0,s.assertTrue)("calc.lang.fieldRef",typeof Q=="string"||Q.kind!==h.Name||Q.qualifier===void 0),{kind:h.FieldRefRHS,label:P,field:typeof Q=="string"?J(Q):Q,isBracketed:b,isClosed:R}}function ie(Q,b){if(b>50)return 1/0;switch(Q.kind){case h.Array:{for(var R=0,P=da(Q.nodes),A;!(A=P()).done;)for(var T=A.value,g=da(T),O;!(O=g()).done;){var M=O.value;R=(0,c.fastMax)(R,ie(M,b+1))}return R+1}case h.Param:return Q.def===void 0?1:ie(Q.def.rhs,b+1)+1;case h.Let:case h.Lambda:case h.App:{for(var K=ie(Q.head,b+1),W=da(Q.args),z;!(z=W()).done;){var ee=z.value;K=(0,c.fastMax)(K,ie(ee,b+1))}return K+1}case h.Paren:return ie(Q.node,b+1)+1;case h.FieldRef:return ie(Q.lhs,b+1)+1;case h.Name:case h.CellRef:case h.StructRef:case h.Literal:case h.Operator:case h.WSF:return 1;case h.Bad:switch(Q.type){case E.Sequence:case E.StructRef:case E.FieldRef:{for(var ue=0,ce=da(Q.contents),he;!(he=ce()).done;){var de=he.value;ue=(0,c.fastMax)(ue,ie(de,b+1))}return ue+1}default:return typeof Q.contents=="string"?1:(0,s.assertNever)("calc.lang.getDepthUpperBound",Q.contents)}default:return(0,s.assertNever)("calc.lang.getDepthUpperBound",Q)}}function X(Q){return ie(Q,0)}(w=t.RefStyle||(t.RefStyle={}))[w.R1C1=1]="R1C1",w[w.A1=2]="A1",(F=t.SyntaxFeature||(t.SyntaxFeature={})).Comments="Comments",F.Statements="Statements",function(Q){Q.Error="ErrorQualifier",Q.Relative="RelativeQualifier",Q.Document="DocumentQualifier",Q.Sheet="SheetQualifier",Q.Ident="IdentQualifier",Q.SheetRange="SheetRangeQualifier",Q.Bad="BadQualifier"}(f=t.QualifierKind||(t.QualifierKind={})),function(Q){Q.Error="CellRefError",Q.Single="CellRefSingle",Q.Range="CellRefRange",Q.Row="CellRefRow",Q.Col="CellRefCol",Q.Bad="CellRefBad"}(p=t.CellRefKind||(t.CellRefKind={})),(I=t.PosKind||(t.PosKind={})).Abs="Abs",I.Rel="Rel",function(Q){Q.SingleLine="SingleLineComment",Q.MultiLine="MultiLineComment"}(m=t.CommentKind||(t.CommentKind={})),function(Q){Q.LocalNameUse="LocalNameUse",Q.LocalNameDecl="LocalNameDecl",Q.AppHeadName="AppHeadName",Q.FormulaRoot="FormulaRoot"}(v=t.AnnotationKind||(t.AnnotationKind={})),t.appHeadNameAnnotation={kind:v.AppHeadName},function(Q){Q.Literal="Literal",Q.Array="Array",Q.App="App",Q.Let="Let",Q.Lambda="Lambda",Q.Paren="Paren",Q.Name="Name",Q.CellRef="CellRef",Q.FieldRef="FieldRef",Q.StructRef="StructRef",Q.Bad="Bad",Q.Operator="Operator",Q.WSF="WSF",Q.Param="Param",Q.ContextName="ContextName",Q.ParamName="ParamName",Q.ParamDef="ParamDef",Q.FieldRefRHS="FieldRefRHS",Q.StructRefRHS="StructRefRHS"}(h=t.NodeKind||(t.NodeKind={})),function(Q){Q.IdentNamePart="IdentNamePart",Q.CellRefNamePart="CellRefNamePart",Q.FieldRefNamePart="FieldRefNamePart"}(S=t.NamePartKind||(t.NamePartKind={})),function(Q){Q[Q.All=1]="All",Q[Q.Data=2]="Data",Q[Q.Headers=3]="Headers",Q[Q.Totals=4]="Totals",Q[Q.ThisRow=5]="ThisRow"}(y=t.SpecialRefId||(t.SpecialRefId={})),function(Q){Q.SpecialRef="SpecialStructRef",Q.ColumnRef="ColumnStructRef",Q.RangeOpRef="RangeOpStructRef",Q.CommaOpRef="CommaOpStructRef",Q.ThisRowOpRef="ThisRowOpStructRef",Q.MissingRef="MissingStructRef",Q.BadRef="BadStructRef"}(C=t.StructRefKind||(t.StructRefKind={})),function(Q){Q.Unexpected="Unexpected",Q.Qualifier="Qualifier",Q.NumberLiteral="NumberLiteral",Q.StringLiteral="StringLiteral",Q.ErrorLiteral="ErrorLiteral",Q.FieldName="FieldName",Q.ParamName="ParamName",Q.Missing="Missing",Q.Sequence="Sequence",Q.StructRef="StructRef",Q.FieldRef="FieldRef"}(E=t.BadType||(t.BadType={})),t.errorQualifier=function(){var Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return{kind:f.Error,isQuoted:!1,label:Q}},t.relativeQualifier=function(){var Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return{kind:f.Relative,isQuoted:!1,label:Q}},t.documentQualifier=function(Q,b){var R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,P=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return{kind:f.Document,isQuoted:R,label:P,document:Q,path:b}},t.sheetQualifier=function(Q,b){var R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,P=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return{kind:f.Sheet,isQuoted:R,label:P,sheet:Q,document:b}},t.identQualifier=function(Q){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return{kind:f.Ident,isQuoted:b,label:R,name:Q}},t.sheetRangeQualifier=function(Q,b,R){var P=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,A=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;return{kind:f.SheetRange,isQuoted:P,label:A,sheet1:Q,sheet2:b,document:R}},t.badQualifier=function(Q){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return{kind:f.Bad,isQuoted:b,label:R,chars:Q}},t.pos=function(Q,b){return{kind:Q,index:b}},t.cellRefError=function(){var Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return{kind:p.Error,label:Q,isBracketed:!1}},t.cellRefSingle=function(Q,b){var R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,P=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return{kind:p.Single,label:P,row:Q,col:b,isBracketed:R}},t.cellRefRange=function(Q,b){var R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,P=Q.isBracketed||b.isBracketed;return{kind:p.Range,label:R,ref1:Q,ref2:b,isBracketed:P}},t.cellRefRow=function(Q,b){var R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,P=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return{kind:p.Row,label:P,row1:Q,row2:b,isBracketed:R}},t.cellRefCol=function(Q,b){var R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,P=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return{kind:p.Col,label:P,col1:Q,col2:b,isBracketed:R}},t.cellRefBad=function(Q){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return{kind:p.Bad,label:R,chars:Q,isBracketed:b}},t.formula=function(Q,b,R,P){return{node:Q,spans:b,annotations:R,depthUpperBound:P??X(Q)}},t.singleLineComment=function(Q){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return{kind:m.SingleLine,label:b,chars:Q,isClosed:!0}},t.multiLineComment=function(Q){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return{kind:m.MultiLine,label:R,chars:Q,isClosed:b}},t.formulaSpan=function(Q,b,R,P,A,T){return(0,s.assertNatural)("calc.lang.formulaSpan",Q),(0,s.assertInteger)("calc.lang.formulaSpan",b),b<Q&&(0,s.assertFalse)("calc.lang.formulaSpan: expected end >= "+Q+"; given "+b),{start:Q,end:b,pre:R,post:P,preComments:A,postComments:T}},t.localNameUseAnnotation=function(Q,b,R){return{kind:v.LocalNameUse,name:Q,whole:b,label:R}},t.localNameDeclAnnotation=function(Q,b){var R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];return{kind:v.LocalNameDecl,name:Q,whole:b,uses:R}},t.formulaRootAnnotation=function(Q,b){return{kind:v.FormulaRoot,contextNames:Q,syntaxFeatures:b}},t.literalNode=function(Q){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return{kind:h.Literal,label:R,oper:Q,isClosed:b}},t.arrayNode=function(Q){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return{kind:h.Array,label:R,nodes:Q,isClosed:b}},t.appNode=function(Q,b){var R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,P=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return{kind:h.App,label:P,head:Q,args:b,isClosed:R}},t.flattenLetArgs=G,t.indexedArg=H,t.letVar=L,t.letNode=function(Q,b,R){var P=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[],A=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,T=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0;(0,s.assertTrue)("calc.lang.letNode",b.every(function(K){return(B(K)?K[0]:K.name.arg).qualifier===void 0}));var g=b.map(function(K,W){return B(K)?L(H(K[0],2*W),H(K[1],2*W+1)):K}).sort(function(K,W){return K.name.index-W.name.index}),O=R!==void 0&&k(R)?H(R,2*b.length):R,M=G(g,O,P);return{kind:h.Let,label:T,head:Q,args:M,isClosed:A,vars:g,body:O,badArgs:P}},t.flattenLambdaArgs=D,t.paramName=U,t.paramDefault=function(Q){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return{kind:h.ParamDef,label:b,rhs:Q}},t.paramNode=V,t.lambdaParam=ne,t.lambdaNode=function(Q,b,R){var P=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[],A=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,T=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0;(0,s.assertTrue)("calc.lang.lambdaNode",b.every(function(K){var W=k(K)?K:K.name.arg,z=W.kind===h.Name?W:W.name.name;return z.kind!==h.Name||z.qualifier===void 0}));var g=b.map(function(K,W){return k(K)?K.kind===h.Name?ne(H(V(U(K,!1),void 0),W)):ne(H(K,W)):K}).sort(function(K,W){return K.name.index-W.name.index}),O=R!==void 0&&k(R)?H(R,b.length):R,M=D(g,O,P);return{kind:h.Lambda,label:T,head:Q,args:M,isClosed:A,params:g,body:O,badArgs:P}},t.operatorNode=function(Q){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return{kind:h.Operator,label:b,id:Q}},t.wsfNode=function(Q,b){var R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return{kind:h.WSF,label:R,id:Q,whole:b}},t.parenNode=function(Q){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return{kind:h.Paren,label:R,node:Q,isClosed:b}},t.nameNode=J,t.identNamePart=$,t.cellRefNamePart=function(Q,b){var R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,P=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return{kind:S.CellRefNamePart,label:R,qualifiedLabel:P,asWhole:b,canDenoteNamedObject:!1,ref:Q}},t.fieldRefNamePart=function(Q,b){var R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,P=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,A=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,T,g,O=typeof b=="string"?Z(b,!1,!0):b;return(0,s.assertTrue)("calc.lang.fieldRefNamePart",((T=O==null?void 0:O.isClosed)===null||T===void 0||T)&&!((g=O==null?void 0:O.isBracketed)!==null&&g!==void 0&&g)),{kind:S.FieldRefNamePart,label:P,qualifiedLabel:A,asWhole:Q.asWhole+"."+(O===void 0?"":O.field.kind===h.Name?O.field.whole:O.field.contents),canDenoteNamedObject:R,lhs:Q,rhs:O}},t.flattenNameParts=function(Q){for(var b=[Q],R=b[0];R.kind===S.FieldRefNamePart;)b.push(R.lhs),R=R.lhs;return b.reverse(),{kind:R.kind,parts:b}},t.headNamePart=function(Q){for(var b=Q;b.kind===S.FieldRefNamePart;)b=b.lhs;return b},t.contextNameNode=function(Q){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return{kind:h.ContextName,label:b,whole:Q}},t.cellRefNode=function(Q,b){var R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return{kind:h.CellRef,label:R,ref:Q,qualifier:b}},t.fieldRefNode=function(Q,b){var R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,P=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return{kind:h.FieldRef,label:P,lhs:Q,rhs:b,shouldBeBracketed:R}},t.fieldRef=Z,t.structRefNode=function(Q,b){var R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return{kind:h.StructRef,label:R,lhs:Q,rhs:b}},t.specialRef=function(Q){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,P=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return{kind:C.SpecialRef,label:P,id:Q,isBracketed:b,isClosed:R}},t.columnRef=function(Q){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,P=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return{kind:C.ColumnRef,label:P,name:Q,isBracketed:b,isClosed:R}},t.rangeOpRef=function(Q,b){var R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return{kind:C.RangeOpRef,label:R,lhs:Q,rhs:b}},t.commaOpRef=function(Q){for(var b,R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,P=(b={},Qe(b,y.All,!1),Qe(b,y.Data,!1),Qe(b,y.Headers,!1),Qe(b,y.Totals,!1),Qe(b,y.ThisRow,!1),b),A=[],T=da(Q),g;!(g=T()).done;){var O=g.value;switch(O.kind){case C.SpecialRef:P[O.id]=!0;break;case C.ColumnRef:case C.RangeOpRef:A.push(O)}}return{kind:C.CommaOpRef,label:R,refs:Q,specialRefs:P,columnRefs:A}},t.thisRowOpRef=function(Q){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return{kind:C.ThisRowOpRef,label:b,ref:Q}},t.missingRef=function(){var Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return{kind:C.MissingRef,label:Q}},t.badRef=function(Q){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,P=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return{kind:C.BadRef,contents:Q,isBracketed:b,isClosed:R,label:P}},t.structRef=function(Q){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return{kind:h.StructRefRHS,label:R,isClosed:b,innerRef:Q}},t.badNode=function(Q,b){var R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return{kind:h.Bad,label:R,type:Q,contents:b}},t.getDepthUpperBound=X},873:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCharCodeBits=void 0;var s=d(637).unicode.makeGetCharCodeBits;t.getCharCodeBits=s([65,91,92,93,95,96,97,123,170,171,181,182,186,187,192,215,216,247,248,706,710,722,736,741,748,749,750,751,880,885,886,888,890,894,895,896,902,903,904,907,908,909,910,930,931,1014,1015,1154,1162,1328,1329,1367,1369,1370,1376,1417,1488,1515,1519,1523,1568,1611,1646,1648,1649,1748,1749,1750,1765,1767,1774,1776,1786,1789,1791,1792,1808,1809,1810,1840,1869,1958,1969,1970,1994,2027,2036,2038,2042,2043,2048,2070,2074,2075,2084,2085,2088,2089,2112,2137,2144,2155,2208,2229,2230,2248,2308,2362,2365,2366,2384,2385,2392,2402,2417,2433,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2493,2494,2510,2511,2524,2526,2527,2530,2544,2546,2556,2557,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2649,2653,2654,2655,2674,2677,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2749,2750,2768,2769,2784,2786,2809,2810,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2877,2878,2908,2910,2911,2914,2929,2930,2947,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3024,3025,3077,3085,3086,3089,3090,3113,3114,3130,3133,3134,3160,3163,3168,3170,3200,3201,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3261,3262,3294,3295,3296,3298,3313,3315,3332,3341,3342,3345,3346,3387,3389,3390,3406,3407,3412,3415,3423,3426,3450,3456,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3585,3643,3648,3663,3713,3715,3716,3717,3718,3723,3724,3748,3749,3750,3751,3761,3762,3764,3773,3774,3776,3781,3782,3783,3804,3808,3840,3841,3904,3912,3913,3949,3976,3981,4096,4139,4159,4160,4176,4182,4186,4190,4193,4194,4197,4199,4206,4209,4213,4226,4238,4239,4256,4294,4295,4296,4301,4302,4304,4347,4348,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4992,5008,5024,5110,5112,5118,5121,5741,5743,5760,5761,5787,5792,5867,5870,5881,5888,5901,5902,5906,5920,5938,5952,5970,5984,5997,5998,6001,6016,6068,6103,6104,6108,6109,6176,6265,6272,6313,6314,6315,6320,6390,6400,6431,6480,6510,6512,6517,6528,6572,6576,6602,6656,6679,6688,6741,6823,6824,6917,6964,6981,6988,7043,7073,7086,7088,7098,7142,7168,7204,7245,7248,7258,7294,7296,7305,7312,7355,7357,7360,7401,7405,7406,7412,7413,7415,7418,7419,7424,7616,7680,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8125,8126,8127,8130,8133,8134,8141,8144,8148,8150,8156,8160,8173,8178,8181,8182,8189,8305,8306,8319,8320,8336,8349,8450,8451,8455,8456,8458,8468,8469,8470,8472,8478,8484,8485,8486,8487,8488,8489,8490,8506,8508,8512,8517,8522,8526,8527,8544,8585,11264,11311,11312,11359,11360,11493,11499,11503,11506,11508,11520,11558,11559,11560,11565,11566,11568,11624,11631,11632,11648,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,12293,12296,12321,12330,12337,12342,12344,12349,12353,12439,12443,12448,12449,12539,12540,12544,12549,12592,12593,12687,12704,12736,12784,12800,13312,19904,19968,40957,40960,42125,42192,42238,42240,42509,42512,42528,42538,42540,42560,42607,42623,42654,42656,42736,42775,42784,42786,42889,42891,42944,42946,42955,42997,43010,43011,43014,43015,43019,43020,43043,43072,43124,43138,43188,43250,43256,43259,43260,43261,43263,43274,43302,43312,43335,43360,43389,43396,43443,43471,43472,43488,43493,43494,43504,43514,43519,43520,43561,43584,43587,43588,43596,43616,43639,43642,43643,43646,43696,43697,43698,43701,43703,43705,43710,43712,43713,43714,43715,43739,43742,43744,43755,43762,43765,43777,43783,43785,43791,43793,43799,43808,43815,43816,43823,43824,43867,43868,43882,43888,44003,44032,55204,55216,55239,55243,55292,63744,64110,64112,64218,64256,64263,64275,64280,64285,64286,64287,64297,64298,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64434,64467,64830,64848,64912,64914,64968,65008,65020,65136,65141,65142,65277,65313,65339,65345,65371,65382,65471,65474,65480,65482,65488,65490,65496,65498,65501],[48,58,63,64,65,91,92,93,95,96,97,123,162,167,168,171,174,177,178,182,183,187,188,191,192,215,216,247,248,888,890,894,895,896,900,907,908,909,910,930,931,1328,1329,1367,1369,1370,1376,1417,1421,1424,1425,1470,1471,1472,1473,1475,1476,1478,1479,1480,1488,1515,1519,1523,1536,1545,1547,1548,1550,1563,1564,1565,1567,1642,1646,1748,1749,1792,1807,1867,1869,1970,1984,2039,2042,2043,2045,2094,2112,2140,2144,2155,2208,2229,2230,2248,2259,2404,2406,2416,2417,2436,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2492,2501,2503,2505,2507,2511,2519,2520,2524,2526,2527,2532,2534,2557,2558,2559,2561,2564,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2620,2621,2622,2627,2631,2633,2635,2638,2641,2642,2649,2653,2654,2655,2662,2678,2689,2692,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2748,2758,2759,2762,2763,2766,2768,2769,2784,2788,2790,2800,2801,2802,2809,2816,2817,2820,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2876,2885,2887,2889,2891,2894,2901,2904,2908,2910,2911,2916,2918,2936,2946,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3006,3011,3014,3017,3018,3022,3024,3025,3031,3032,3046,3067,3072,3085,3086,3089,3090,3113,3114,3130,3133,3141,3142,3145,3146,3150,3157,3159,3160,3163,3168,3172,3174,3184,3192,3204,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3260,3269,3270,3273,3274,3278,3285,3287,3294,3295,3296,3300,3302,3312,3313,3315,3328,3341,3342,3345,3346,3397,3398,3401,3402,3408,3412,3428,3430,3456,3457,3460,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3530,3531,3535,3541,3542,3543,3544,3552,3558,3568,3570,3572,3585,3643,3647,3663,3664,3674,3713,3715,3716,3717,3718,3723,3724,3748,3749,3750,3751,3774,3776,3781,3782,3783,3784,3790,3792,3802,3804,3808,3840,3844,3859,3860,3861,3898,3902,3912,3913,3949,3953,3973,3974,3992,3993,4029,4030,4045,4046,4048,4053,4057,4096,4170,4176,4294,4295,4296,4301,4302,4304,4347,4348,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4957,4960,4969,4989,4992,5018,5024,5110,5112,5118,5121,5742,5743,5760,5761,5787,5792,5867,5870,5881,5888,5901,5902,5909,5920,5941,5952,5972,5984,5997,5998,6001,6002,6004,6016,6100,6103,6104,6107,6110,6112,6122,6128,6138,6155,6159,6160,6170,6176,6265,6272,6315,6320,6390,6400,6431,6432,6444,6448,6460,6464,6465,6470,6510,6512,6517,6528,6572,6576,6602,6608,6619,6622,6684,6688,6751,6752,6781,6783,6794,6800,6810,6823,6824,6832,6849,6912,6988,6992,7002,7009,7037,7040,7156,7168,7224,7232,7242,7245,7294,7296,7305,7312,7355,7357,7360,7376,7379,7380,7419,7424,7674,7675,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8133,8134,8148,8150,8156,8157,8176,8178,8181,8182,8191,8203,8208,8234,8239,8255,8257,8260,8261,8274,8275,8276,8277,8288,8293,8294,8306,8308,8317,8319,8333,8336,8349,8352,8384,8400,8433,8448,8588,8592,9001,9003,9255,9280,9291,9312,10088,10102,10181,10183,10214,10224,10627,10649,10712,10716,10748,10750,11124,11126,11158,11159,11311,11312,11359,11360,11508,11517,11518,11520,11558,11559,11560,11565,11566,11568,11624,11631,11632,11647,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,11744,11776,11823,11824,11856,11858,11904,11930,11931,12020,12032,12246,12272,12284,12292,12296,12306,12308,12320,12336,12337,12349,12350,12352,12353,12439,12441,12448,12449,12539,12540,12544,12549,12592,12593,12687,12688,12772,12784,12831,12832,40957,40960,42125,42128,42183,42192,42238,42240,42509,42512,42540,42560,42611,42612,42622,42623,42738,42752,42944,42946,42955,42997,43053,43056,43066,43072,43124,43136,43206,43216,43226,43232,43256,43259,43260,43261,43310,43312,43348,43360,43389,43392,43457,43471,43482,43488,43519,43520,43575,43584,43598,43600,43610,43616,43715,43739,43742,43744,43760,43762,43767,43777,43783,43785,43791,43793,43799,43808,43815,43816,43823,43824,43884,43888,44011,44012,44014,44016,44026,44032,55204,55216,55239,55243,55292,63744,64110,64112,64218,64256,64263,64275,64280,64285,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64450,64467,64830,64848,64912,64914,64968,65008,65022,65024,65040,65056,65072,65075,65077,65101,65104,65122,65123,65124,65127,65129,65130,65136,65141,65142,65277,65279,65280,65284,65285,65291,65292,65296,65306,65308,65311,65313,65339,65342,65371,65372,65373,65374,65375,65382,65471,65474,65480,65482,65488,65490,65496,65498,65501,65504,65511,65512,65519,65529,65534])},5511:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.worksheetFuncTypes=t.worksheetFuncEnglishNames=t.WorksheetFuncId=void 0;var s=d(7161),c;(c=t.WorksheetFuncId||(t.WorksheetFuncId={}))[c.COUNT=0]="COUNT",c[c.IF=1]="IF",c[c.ISNA=2]="ISNA",c[c.ISERROR=3]="ISERROR",c[c.SUM=4]="SUM",c[c.AVERAGE=5]="AVERAGE",c[c.MIN=6]="MIN",c[c.MAX=7]="MAX",c[c.ROW=8]="ROW",c[c.COLUMN=9]="COLUMN",c[c.NA=10]="NA",c[c.NPV=11]="NPV",c[c.STDEV=12]="STDEV",c[c.DOLLAR=13]="DOLLAR",c[c.FIXED=14]="FIXED",c[c.SIN=15]="SIN",c[c.COS=16]="COS",c[c.TAN=17]="TAN",c[c.ATAN=18]="ATAN",c[c.PI=19]="PI",c[c.SQRT=20]="SQRT",c[c.EXP=21]="EXP",c[c.LN=22]="LN",c[c.LOG10=23]="LOG10",c[c.ABS=24]="ABS",c[c.INT=25]="INT",c[c.SIGN=26]="SIGN",c[c.ROUND=27]="ROUND",c[c.LOOKUP=28]="LOOKUP",c[c.INDEX=29]="INDEX",c[c.REPT=30]="REPT",c[c.MID=31]="MID",c[c.LEN=32]="LEN",c[c.VALUE=33]="VALUE",c[c.TRUE=34]="TRUE",c[c.FALSE=35]="FALSE",c[c.AND=36]="AND",c[c.OR=37]="OR",c[c.NOT=38]="NOT",c[c.MOD=39]="MOD",c[c.DCOUNT=40]="DCOUNT",c[c.DSUM=41]="DSUM",c[c.DAVERAGE=42]="DAVERAGE",c[c.DMIN=43]="DMIN",c[c.DMAX=44]="DMAX",c[c.DSTDEV=45]="DSTDEV",c[c.VAR=46]="VAR",c[c.DVAR=47]="DVAR",c[c.TEXT=48]="TEXT",c[c.LINEST=49]="LINEST",c[c.TREND=50]="TREND",c[c.LOGEST=51]="LOGEST",c[c.GROWTH=52]="GROWTH",c[c.GOTO=53]="GOTO",c[c.HALT=54]="HALT",c[c.RETURN=55]="RETURN",c[c.PV=56]="PV",c[c.FV=57]="FV",c[c.NPER=58]="NPER",c[c.PMT=59]="PMT",c[c.RATE=60]="RATE",c[c.MIRR=61]="MIRR",c[c.IRR=62]="IRR",c[c.RAND=63]="RAND",c[c.MATCH=64]="MATCH",c[c.DATE=65]="DATE",c[c.TIME=66]="TIME",c[c.DAY=67]="DAY",c[c.MONTH=68]="MONTH",c[c.YEAR=69]="YEAR",c[c.WEEKDAY=70]="WEEKDAY",c[c.HOUR=71]="HOUR",c[c.MINUTE=72]="MINUTE",c[c.SECOND=73]="SECOND",c[c.NOW=74]="NOW",c[c.AREAS=75]="AREAS",c[c.ROWS=76]="ROWS",c[c.COLUMNS=77]="COLUMNS",c[c.OFFSET=78]="OFFSET",c[c.ABSREF=79]="ABSREF",c[c.RELREF=80]="RELREF",c[c.ARGUMENT=81]="ARGUMENT",c[c.SEARCH=82]="SEARCH",c[c.TRANSPOSE=83]="TRANSPOSE",c[c.ERROR=84]="ERROR",c[c.STEP=85]="STEP",c[c.TYPE=86]="TYPE",c[c.ECHO=87]="ECHO",c[c.SET_NAME=88]="SET_NAME",c[c.CALLER=89]="CALLER",c[c.DEREF=90]="DEREF",c[c.WINDOWS=91]="WINDOWS",c[c.SERIES=92]="SERIES",c[c.DOCUMENTS=93]="DOCUMENTS",c[c.ACTIVE_CELL=94]="ACTIVE_CELL",c[c.SELECTION=95]="SELECTION",c[c.RESULT=96]="RESULT",c[c.ATAN2=97]="ATAN2",c[c.ASIN=98]="ASIN",c[c.ACOS=99]="ACOS",c[c.CHOOSE=100]="CHOOSE",c[c.HLOOKUP=101]="HLOOKUP",c[c.VLOOKUP=102]="VLOOKUP",c[c.LINKS=103]="LINKS",c[c.INPUT=104]="INPUT",c[c.ISREF=105]="ISREF",c[c.GET_FORMULA=106]="GET_FORMULA",c[c.GET_NAME=107]="GET_NAME",c[c.SET_VALUE=108]="SET_VALUE",c[c.LOG=109]="LOG",c[c.EXEC=110]="EXEC",c[c.CHAR=111]="CHAR",c[c.LOWER=112]="LOWER",c[c.UPPER=113]="UPPER",c[c.PROPER=114]="PROPER",c[c.LEFT=115]="LEFT",c[c.RIGHT=116]="RIGHT",c[c.EXACT=117]="EXACT",c[c.TRIM=118]="TRIM",c[c.REPLACE=119]="REPLACE",c[c.SUBSTITUTE=120]="SUBSTITUTE",c[c.CODE=121]="CODE",c[c.NAMES=122]="NAMES",c[c.DIRECTORY=123]="DIRECTORY",c[c.FIND=124]="FIND",c[c.CELL=125]="CELL",c[c.ISERR=126]="ISERR",c[c.ISTEXT=127]="ISTEXT",c[c.ISNUMBER=128]="ISNUMBER",c[c.ISBLANK=129]="ISBLANK",c[c.T=130]="T",c[c.N=131]="N",c[c.FOPEN=132]="FOPEN",c[c.FCLOSE=133]="FCLOSE",c[c.FSIZE=134]="FSIZE",c[c.FREADLN=135]="FREADLN",c[c.FREAD=136]="FREAD",c[c.FWRITELN=137]="FWRITELN",c[c.FWRITE=138]="FWRITE",c[c.FPOS=139]="FPOS",c[c.DATEVALUE=140]="DATEVALUE",c[c.TIMEVALUE=141]="TIMEVALUE",c[c.SLN=142]="SLN",c[c.SYD=143]="SYD",c[c.DDB=144]="DDB",c[c.GET_DEF=145]="GET_DEF",c[c.REFTEXT=146]="REFTEXT",c[c.TEXTREF=147]="TEXTREF",c[c.INDIRECT=148]="INDIRECT",c[c.REGISTER=149]="REGISTER",c[c.CALL=150]="CALL",c[c.ADD_BAR=151]="ADD_BAR",c[c.ADD_MENU=152]="ADD_MENU",c[c.ADD_COMMAND=153]="ADD_COMMAND",c[c.ENABLE_COMMAND=154]="ENABLE_COMMAND",c[c.CHECK_COMMAND=155]="CHECK_COMMAND",c[c.RENAME_COMMAND=156]="RENAME_COMMAND",c[c.SHOW_BAR=157]="SHOW_BAR",c[c.DELETE_MENU=158]="DELETE_MENU",c[c.DELETE_COMMAND=159]="DELETE_COMMAND",c[c.GET_CHART_ITEM=160]="GET_CHART_ITEM",c[c.DIALOG_BOX=161]="DIALOG_BOX",c[c.CLEAN=162]="CLEAN",c[c.MDETERM=163]="MDETERM",c[c.MINVERSE=164]="MINVERSE",c[c.MMULT=165]="MMULT",c[c.FILES=166]="FILES",c[c.IPMT=167]="IPMT",c[c.PPMT=168]="PPMT",c[c.COUNTA=169]="COUNTA",c[c.CANCEL_KEY=170]="CANCEL_KEY",c[c.FOR=171]="FOR",c[c.WHILE=172]="WHILE",c[c.BREAK=173]="BREAK",c[c.NEXT=174]="NEXT",c[c.INITIATE=175]="INITIATE",c[c.REQUEST=176]="REQUEST",c[c.POKE=177]="POKE",c[c.EXECUTE=178]="EXECUTE",c[c.TERMINATE=179]="TERMINATE",c[c.RESTART=180]="RESTART",c[c.HELP=181]="HELP",c[c.GET_BAR=182]="GET_BAR",c[c.PRODUCT=183]="PRODUCT",c[c.FACT=184]="FACT",c[c.GET_CELL=185]="GET_CELL",c[c.GET_WORKSPACE=186]="GET_WORKSPACE",c[c.GET_WINDOW=187]="GET_WINDOW",c[c.GET_DOCUMENT=188]="GET_DOCUMENT",c[c.DPRODUCT=189]="DPRODUCT",c[c.ISNONTEXT=190]="ISNONTEXT",c[c.GET_NOTE=191]="GET_NOTE",c[c.NOTE=192]="NOTE",c[c.STDEVP=193]="STDEVP",c[c.VARP=194]="VARP",c[c.DSTDEVP=195]="DSTDEVP",c[c.DVARP=196]="DVARP",c[c.TRUNC=197]="TRUNC",c[c.ISLOGICAL=198]="ISLOGICAL",c[c.DCOUNTA=199]="DCOUNTA",c[c.DELETE_BAR=200]="DELETE_BAR",c[c.UNREGISTER=201]="UNREGISTER",c[c.USDOLLAR=204]="USDOLLAR",c[c.FINDB=205]="FINDB",c[c.SEARCHB=206]="SEARCHB",c[c.REPLACEB=207]="REPLACEB",c[c.LEFTB=208]="LEFTB",c[c.RIGHTB=209]="RIGHTB",c[c.MIDB=210]="MIDB",c[c.LENB=211]="LENB",c[c.ROUNDUP=212]="ROUNDUP",c[c.ROUNDDOWN=213]="ROUNDDOWN",c[c.ASC=214]="ASC",c[c.DBCS=215]="DBCS",c[c.RANK=216]="RANK",c[c.ADDRESS=219]="ADDRESS",c[c.DAYS360=220]="DAYS360",c[c.TODAY=221]="TODAY",c[c.VDB=222]="VDB",c[c.ELSE=223]="ELSE",c[c.ELSE_IF=224]="ELSE_IF",c[c.END_IF=225]="END_IF",c[c.FOR_CELL=226]="FOR_CELL",c[c.MEDIAN=227]="MEDIAN",c[c.SUMPRODUCT=228]="SUMPRODUCT",c[c.SINH=229]="SINH",c[c.COSH=230]="COSH",c[c.TANH=231]="TANH",c[c.ASINH=232]="ASINH",c[c.ACOSH=233]="ACOSH",c[c.ATANH=234]="ATANH",c[c.DGET=235]="DGET",c[c.CREATE_OBJECT=236]="CREATE_OBJECT",c[c.VOLATILE=237]="VOLATILE",c[c.LAST_ERROR=238]="LAST_ERROR",c[c.CUSTOM_UNDO=239]="CUSTOM_UNDO",c[c.CUSTOM_REPEAT=240]="CUSTOM_REPEAT",c[c.FORMULA_CONVERT=241]="FORMULA_CONVERT",c[c.GET_LINK_INFO=242]="GET_LINK_INFO",c[c.TEXT_BOX=243]="TEXT_BOX",c[c.INFO=244]="INFO",c[c.GROUP=245]="GROUP",c[c.GET_OBJECT=246]="GET_OBJECT",c[c.DB=247]="DB",c[c.PAUSE=248]="PAUSE",c[c.RESUME=251]="RESUME",c[c.FREQUENCY=252]="FREQUENCY",c[c.ADD_TOOLBAR=253]="ADD_TOOLBAR",c[c.DELETE_TOOLBAR=254]="DELETE_TOOLBAR",c[c._UDF=255]="_UDF",c[c.RESET_TOOLBAR=256]="RESET_TOOLBAR",c[c.EVALUATE=257]="EVALUATE",c[c.GET_TOOLBAR=258]="GET_TOOLBAR",c[c.GET_TOOL=259]="GET_TOOL",c[c.SPELLING_CHECK=260]="SPELLING_CHECK",c[c.ERROR_TYPE=261]="ERROR_TYPE",c[c.APP_TITLE=262]="APP_TITLE",c[c.WINDOW_TITLE=263]="WINDOW_TITLE",c[c.SAVE_TOOLBAR=264]="SAVE_TOOLBAR",c[c.ENABLE_TOOL=265]="ENABLE_TOOL",c[c.PRESS_TOOL=266]="PRESS_TOOL",c[c.REGISTER_ID=267]="REGISTER_ID",c[c.GET_PROJECT=268]="GET_PROJECT",c[c.AVEDEV=269]="AVEDEV",c[c.BETADIST=270]="BETADIST",c[c.GAMMALN=271]="GAMMALN",c[c.BETAINV=272]="BETAINV",c[c.BINOMDIST=273]="BINOMDIST",c[c.CHIDIST=274]="CHIDIST",c[c.CHIINV=275]="CHIINV",c[c.COMBIN=276]="COMBIN",c[c.CONFIDENCE=277]="CONFIDENCE",c[c.CRITBINOM=278]="CRITBINOM",c[c.EVEN=279]="EVEN",c[c.EXPONDIST=280]="EXPONDIST",c[c.FDIST=281]="FDIST",c[c.FINV=282]="FINV",c[c.FISHER=283]="FISHER",c[c.FISHERINV=284]="FISHERINV",c[c.FLOOR=285]="FLOOR",c[c.GAMMADIST=286]="GAMMADIST",c[c.GAMMAINV=287]="GAMMAINV",c[c.CEILING=288]="CEILING",c[c.HYPGEOMDIST=289]="HYPGEOMDIST",c[c.LOGNORMDIST=290]="LOGNORMDIST",c[c.LOGINV=291]="LOGINV",c[c.NEGBINOMDIST=292]="NEGBINOMDIST",c[c.NORMDIST=293]="NORMDIST",c[c.NORMSDIST=294]="NORMSDIST",c[c.NORMINV=295]="NORMINV",c[c.NORMSINV=296]="NORMSINV",c[c.STANDARDIZE=297]="STANDARDIZE",c[c.ODD=298]="ODD",c[c.PERMUT=299]="PERMUT",c[c.POISSON=300]="POISSON",c[c.TDIST=301]="TDIST",c[c.WEIBULL=302]="WEIBULL",c[c.SUMXMY2=303]="SUMXMY2",c[c.SUMX2MY2=304]="SUMX2MY2",c[c.SUMX2PY2=305]="SUMX2PY2",c[c.CHITEST=306]="CHITEST",c[c.CORREL=307]="CORREL",c[c.COVAR=308]="COVAR",c[c.FORECAST=309]="FORECAST",c[c.FTEST=310]="FTEST",c[c.INTERCEPT=311]="INTERCEPT",c[c.PEARSON=312]="PEARSON",c[c.RSQ=313]="RSQ",c[c.STEYX=314]="STEYX",c[c.SLOPE=315]="SLOPE",c[c.TTEST=316]="TTEST",c[c.PROB=317]="PROB",c[c.DEVSQ=318]="DEVSQ",c[c.GEOMEAN=319]="GEOMEAN",c[c.HARMEAN=320]="HARMEAN",c[c.SUMSQ=321]="SUMSQ",c[c.KURT=322]="KURT",c[c.SKEW=323]="SKEW",c[c.ZTEST=324]="ZTEST",c[c.LARGE=325]="LARGE",c[c.SMALL=326]="SMALL",c[c.QUARTILE=327]="QUARTILE",c[c.PERCENTILE=328]="PERCENTILE",c[c.PERCENTRANK=329]="PERCENTRANK",c[c.MODE=330]="MODE",c[c.TRIMMEAN=331]="TRIMMEAN",c[c.TINV=332]="TINV",c[c.MOVIE_COMMAND=334]="MOVIE_COMMAND",c[c.GET_MOVIE=335]="GET_MOVIE",c[c.CONCATENATE=336]="CONCATENATE",c[c.POWER=337]="POWER",c[c.SPREADBASE_DATA_FIELD=338]="SPREADBASE_DATA_FIELD",c[c.GET_VIEW=339]="GET_VIEW",c[c.GET_FIELD=340]="GET_FIELD",c[c.GET_ITEM=341]="GET_ITEM",c[c.RADIANS=342]="RADIANS",c[c.DEGREES=343]="DEGREES",c[c.SUBTOTAL=344]="SUBTOTAL",c[c.SUMIF=345]="SUMIF",c[c.COUNTIF=346]="COUNTIF",c[c.COUNTBLANK=347]="COUNTBLANK",c[c.SCENARIO_GET=348]="SCENARIO_GET",c[c.OPTIONS_LISTS=349]="OPTIONS_LISTS",c[c.ISPMT=350]="ISPMT",c[c.DATEDIF=351]="DATEDIF",c[c.DATESTRING=352]="DATESTRING",c[c.NUMBERSTRING=353]="NUMBERSTRING",c[c.ROMAN=354]="ROMAN",c[c.OPENDIALOG=355]="OPENDIALOG",c[c.SAVEDIALOG=356]="SAVEDIALOG",c[c.VIEW_GET=357]="VIEW_GET",c[c.GETPIVOTDATA=358]="GETPIVOTDATA",c[c.HYPERLINK=359]="HYPERLINK",c[c.FURIGANA=360]="FURIGANA",c[c.AVERAGEA=361]="AVERAGEA",c[c.MAXA=362]="MAXA",c[c.MINA=363]="MINA",c[c.STDEVPA=364]="STDEVPA",c[c.VARPA=365]="VARPA",c[c.STDEVA=366]="STDEVA",c[c.VARA=367]="VARA",c[c.BAHTTEXT=368]="BAHTTEXT",c[c.THAIDOW=369]="THAIDOW",c[c.THAIDIGIT=370]="THAIDIGIT",c[c.THAIMOY=371]="THAIMOY",c[c.THAINUMSOUND=372]="THAINUMSOUND",c[c.THAINUMSTRING=373]="THAINUMSTRING",c[c.THAISTRINGLENGTH=374]="THAISTRINGLENGTH",c[c.ISTHAIDIGIT=375]="ISTHAIDIGIT",c[c.ROUNDBAHTDOWN=376]="ROUNDBAHTDOWN",c[c.ROUNDBAHTUP=377]="ROUNDBAHTUP",c[c.THAIYEAR=378]="THAIYEAR",c[c.RTD=379]="RTD",c[c.CUBEVALUE=380]="CUBEVALUE",c[c.CUBEMEMBER=381]="CUBEMEMBER",c[c.CUBEMEMBERPROPERTY=382]="CUBEMEMBERPROPERTY",c[c.CUBERANKEDMEMBER=383]="CUBERANKEDMEMBER",c[c.HEX2BIN=384]="HEX2BIN",c[c.HEX2DEC=385]="HEX2DEC",c[c.HEX2OCT=386]="HEX2OCT",c[c.DEC2BIN=387]="DEC2BIN",c[c.DEC2HEX=388]="DEC2HEX",c[c.DEC2OCT=389]="DEC2OCT",c[c.OCT2BIN=390]="OCT2BIN",c[c.OCT2HEX=391]="OCT2HEX",c[c.OCT2DEC=392]="OCT2DEC",c[c.BIN2DEC=393]="BIN2DEC",c[c.BIN2OCT=394]="BIN2OCT",c[c.BIN2HEX=395]="BIN2HEX",c[c.IMSUB=396]="IMSUB",c[c.IMDIV=397]="IMDIV",c[c.IMPOWER=398]="IMPOWER",c[c.IMABS=399]="IMABS",c[c.IMSQRT=400]="IMSQRT",c[c.IMLN=401]="IMLN",c[c.IMLOG2=402]="IMLOG2",c[c.IMLOG10=403]="IMLOG10",c[c.IMSIN=404]="IMSIN",c[c.IMCOS=405]="IMCOS",c[c.IMEXP=406]="IMEXP",c[c.IMARGUMENT=407]="IMARGUMENT",c[c.IMCONJUGATE=408]="IMCONJUGATE",c[c.IMAGINARY=409]="IMAGINARY",c[c.IMREAL=410]="IMREAL",c[c.COMPLEX=411]="COMPLEX",c[c.IMSUM=412]="IMSUM",c[c.IMPRODUCT=413]="IMPRODUCT",c[c.SERIESSUM=414]="SERIESSUM",c[c.FACTDOUBLE=415]="FACTDOUBLE",c[c.SQRTPI=416]="SQRTPI",c[c.QUOTIENT=417]="QUOTIENT",c[c.DELTA=418]="DELTA",c[c.GESTEP=419]="GESTEP",c[c.ISEVEN=420]="ISEVEN",c[c.ISODD=421]="ISODD",c[c.MROUND=422]="MROUND",c[c.ERF=423]="ERF",c[c.ERFC=424]="ERFC",c[c.BESSELJ=425]="BESSELJ",c[c.BESSELK=426]="BESSELK",c[c.BESSELY=427]="BESSELY",c[c.BESSELI=428]="BESSELI",c[c.XIRR=429]="XIRR",c[c.XNPV=430]="XNPV",c[c.PRICEMAT=431]="PRICEMAT",c[c.YIELDMAT=432]="YIELDMAT",c[c.INTRATE=433]="INTRATE",c[c.RECEIVED=434]="RECEIVED",c[c.DISC=435]="DISC",c[c.PRICEDISC=436]="PRICEDISC",c[c.YIELDDISC=437]="YIELDDISC",c[c.TBILLEQ=438]="TBILLEQ",c[c.TBILLPRICE=439]="TBILLPRICE",c[c.TBILLYIELD=440]="TBILLYIELD",c[c.PRICE=441]="PRICE",c[c.YIELD=442]="YIELD",c[c.DOLLARDE=443]="DOLLARDE",c[c.DOLLARFR=444]="DOLLARFR",c[c.NOMINAL=445]="NOMINAL",c[c.EFFECT=446]="EFFECT",c[c.CUMPRINC=447]="CUMPRINC",c[c.CUMIPMT=448]="CUMIPMT",c[c.EDATE=449]="EDATE",c[c.EOMONTH=450]="EOMONTH",c[c.YEARFRAC=451]="YEARFRAC",c[c.COUPDAYBS=452]="COUPDAYBS",c[c.COUPDAYS=453]="COUPDAYS",c[c.COUPDAYSNC=454]="COUPDAYSNC",c[c.COUPNCD=455]="COUPNCD",c[c.COUPNUM=456]="COUPNUM",c[c.COUPPCD=457]="COUPPCD",c[c.DURATION=458]="DURATION",c[c.MDURATION=459]="MDURATION",c[c.ODDLPRICE=460]="ODDLPRICE",c[c.ODDLYIELD=461]="ODDLYIELD",c[c.ODDFPRICE=462]="ODDFPRICE",c[c.ODDFYIELD=463]="ODDFYIELD",c[c.RANDBETWEEN=464]="RANDBETWEEN",c[c.WEEKNUM=465]="WEEKNUM",c[c.AMORDEGRC=466]="AMORDEGRC",c[c.AMORLINC=467]="AMORLINC",c[c.CONVERT=468]="CONVERT",c[c.ACCRINT=469]="ACCRINT",c[c.ACCRINTM=470]="ACCRINTM",c[c.WORKDAY=471]="WORKDAY",c[c.NETWORKDAYS=472]="NETWORKDAYS",c[c.GCD=473]="GCD",c[c.MULTINOMIAL=474]="MULTINOMIAL",c[c.LCM=475]="LCM",c[c.FVSCHEDULE=476]="FVSCHEDULE",c[c.CUBEKPIMEMBER=477]="CUBEKPIMEMBER",c[c.CUBESET=478]="CUBESET",c[c.CUBESETCOUNT=479]="CUBESETCOUNT",c[c.IFERROR=480]="IFERROR",c[c.COUNTIFS=481]="COUNTIFS",c[c.SUMIFS=482]="SUMIFS",c[c.AVERAGEIF=483]="AVERAGEIF",c[c.AVERAGEIFS=484]="AVERAGEIFS",c[c.AGGREGATE=485]="AGGREGATE",c[c.BINOM_DIST=486]="BINOM_DIST",c[c.BINOM_INV=487]="BINOM_INV",c[c.CONFIDENCE_NORM=488]="CONFIDENCE_NORM",c[c.CONFIDENCE_T=489]="CONFIDENCE_T",c[c.CHISQ_TEST=490]="CHISQ_TEST",c[c.F_TEST=491]="F_TEST",c[c.COVARIANCE_P=492]="COVARIANCE_P",c[c.COVARIANCE_S=493]="COVARIANCE_S",c[c.EXPON_DIST=494]="EXPON_DIST",c[c.GAMMA_DIST=495]="GAMMA_DIST",c[c.GAMMA_INV=496]="GAMMA_INV",c[c.MODE_MULT=497]="MODE_MULT",c[c.MODE_SNGL=498]="MODE_SNGL",c[c.NORM_DIST=499]="NORM_DIST",c[c.NORM_INV=500]="NORM_INV",c[c.PERCENTILE_EXC=501]="PERCENTILE_EXC",c[c.PERCENTILE_INC=502]="PERCENTILE_INC",c[c.PERCENTRANK_EXC=503]="PERCENTRANK_EXC",c[c.PERCENTRANK_INC=504]="PERCENTRANK_INC",c[c.POISSON_DIST=505]="POISSON_DIST",c[c.QUARTILE_EXC=506]="QUARTILE_EXC",c[c.QUARTILE_INC=507]="QUARTILE_INC",c[c.RANK_AVG=508]="RANK_AVG",c[c.RANK_EQ=509]="RANK_EQ",c[c.STDEV_S=510]="STDEV_S",c[c.STDEV_P=511]="STDEV_P",c[c.T_DIST=512]="T_DIST",c[c.T_DIST_2T=513]="T_DIST_2T",c[c.T_DIST_RT=514]="T_DIST_RT",c[c.T_INV=515]="T_INV",c[c.T_INV_2T=516]="T_INV_2T",c[c.VAR_S=517]="VAR_S",c[c.VAR_P=518]="VAR_P",c[c.WEIBULL_DIST=519]="WEIBULL_DIST",c[c.NETWORKDAYS_INTL=520]="NETWORKDAYS_INTL",c[c.WORKDAY_INTL=521]="WORKDAY_INTL",c[c.ECMA_CEILING=522]="ECMA_CEILING",c[c.ISO_CEILING=523]="ISO_CEILING",c[c.BETA_DIST=525]="BETA_DIST",c[c.BETA_INV=526]="BETA_INV",c[c.CHISQ_DIST=527]="CHISQ_DIST",c[c.CHISQ_DIST_RT=528]="CHISQ_DIST_RT",c[c.CHISQ_INV=529]="CHISQ_INV",c[c.CHISQ_INV_RT=530]="CHISQ_INV_RT",c[c.F_DIST=531]="F_DIST",c[c.F_DIST_RT=532]="F_DIST_RT",c[c.F_INV=533]="F_INV",c[c.F_INV_RT=534]="F_INV_RT",c[c.HYPGEOM_DIST=535]="HYPGEOM_DIST",c[c.LOGNORM_DIST=536]="LOGNORM_DIST",c[c.LOGNORM_INV=537]="LOGNORM_INV",c[c.NEGBINOM_DIST=538]="NEGBINOM_DIST",c[c.NORM_S_DIST=539]="NORM_S_DIST",c[c.NORM_S_INV=540]="NORM_S_INV",c[c.T_TEST=541]="T_TEST",c[c.Z_TEST=542]="Z_TEST",c[c.ERF_PRECISE=543]="ERF_PRECISE",c[c.ERFC_PRECISE=544]="ERFC_PRECISE",c[c.GAMMALN_PRECISE=545]="GAMMALN_PRECISE",c[c.CEILING_PRECISE=546]="CEILING_PRECISE",c[c.FLOOR_PRECISE=547]="FLOOR_PRECISE",c[c.ACOT=548]="ACOT",c[c.ACOTH=549]="ACOTH",c[c.COT=550]="COT",c[c.COTH=551]="COTH",c[c.CSC=552]="CSC",c[c.CSCH=553]="CSCH",c[c.SEC=554]="SEC",c[c.SECH=555]="SECH",c[c.IMTAN=556]="IMTAN",c[c.IMCOT=557]="IMCOT",c[c.IMCSC=558]="IMCSC",c[c.IMCSCH=559]="IMCSCH",c[c.IMSEC=560]="IMSEC",c[c.IMSECH=561]="IMSECH",c[c.BITAND=562]="BITAND",c[c.BITOR=563]="BITOR",c[c.BITXOR=564]="BITXOR",c[c.BITLSHIFT=565]="BITLSHIFT",c[c.BITRSHIFT=566]="BITRSHIFT",c[c.PERMUTATIONA=567]="PERMUTATIONA",c[c.COMBINA=568]="COMBINA",c[c.XOR=569]="XOR",c[c.PDURATION=570]="PDURATION",c[c.BASE=571]="BASE",c[c.DECIMAL=572]="DECIMAL",c[c.DAYS=573]="DAYS",c[c.BINOM_DIST_RANGE=574]="BINOM_DIST_RANGE",c[c.GAMMA=575]="GAMMA",c[c.SKEW_P=576]="SKEW_P",c[c.GAUSS=577]="GAUSS",c[c.PHI=578]="PHI",c[c.RRI=579]="RRI",c[c.UNICHAR=580]="UNICHAR",c[c.UNICODE=581]="UNICODE",c[c.MUNIT=582]="MUNIT",c[c.ARABIC=583]="ARABIC",c[c.ISOWEEKNUM=584]="ISOWEEKNUM",c[c.NUMBERVALUE=585]="NUMBERVALUE",c[c.SHEET=586]="SHEET",c[c.SHEETS=587]="SHEETS",c[c.FORMULATEXT=588]="FORMULATEXT",c[c.ISFORMULA=589]="ISFORMULA",c[c.IFNA=590]="IFNA",c[c.CEILING_MATH=591]="CEILING_MATH",c[c.FLOOR_MATH=592]="FLOOR_MATH",c[c.IMSINH=593]="IMSINH",c[c.IMCOSH=594]="IMCOSH",c[c.FILTERXML=595]="FILTERXML",c[c.WEBSERVICE=596]="WEBSERVICE",c[c.ENCODEURL=597]="ENCODEURL",c[c.FORECAST_ETS=598]="FORECAST_ETS",c[c.FORECAST_ETS_CONFINT=599]="FORECAST_ETS_CONFINT",c[c.FORECAST_ETS_SEASONALITY=600]="FORECAST_ETS_SEASONALITY",c[c.FORECAST_LINEAR=601]="FORECAST_LINEAR",c[c.FORECAST_ETS_STAT=602]="FORECAST_ETS_STAT",c[c.MAXIFS=603]="MAXIFS",c[c.MINIFS=604]="MINIFS",c[c.TEXTJOIN=605]="TEXTJOIN",c[c.CONCAT=606]="CONCAT",c[c.IFS=607]="IFS",c[c.SWITCH=608]="SWITCH",c[c.SINGLE=609]="SINGLE",c[c.AVERAGE_WEIGHTED=610]="AVERAGE_WEIGHTED",c[c.ANCHORARRAY=611]="ANCHORARRAY",c[c._FV=612]="_FV",c[c.FIELDVALUE=613]="FIELDVALUE",c[c.FILTER=614]="FILTER",c[c.SORT=615]="SORT",c[c.UNIQUE=616]="UNIQUE",c[c.RICHSEARCH=617]="RICHSEARCH",c[c.LARGEPROPERTY=618]="LARGEPROPERTY",c[c.SMALLPROPERTY=619]="SMALLPROPERTY",c[c.AVERAGEPROPERTY=620]="AVERAGEPROPERTY",c[c.FINDN=621]="FINDN",c[c.TEXTSLICE=622]="TEXTSLICE",c[c.TEXTBEFORE=623]="TEXTBEFORE",c[c.TEXTAFTER=624]="TEXTAFTER",c[c.TEXTSPLIT=625]="TEXTSPLIT",c[c._SORT=626]="_SORT",c[c._ONEDARRAY=627]="_ONEDARRAY",c[c.XMATCH=628]="XMATCH",c[c.XLOOKUP=629]="XLOOKUP",c[c.SORTBY=630]="SORTBY",c[c.RANDARRAY=631]="RANDARRAY",c[c.SEQUENCE=632]="SEQUENCE",c[c.STOCKHISTORY=633]="STOCKHISTORY",c[c.WRAPROWS=634]="WRAPROWS",c[c.VSTACK=635]="VSTACK",c[c.HSTACK=636]="HSTACK",c[c.CHOOSEROWS=637]="CHOOSEROWS",c[c.CHOOSECOLS=638]="CHOOSECOLS",c[c.LET=639]="LET",c[c.LAMBDA=640]="LAMBDA",c[c.MAKEARRAY=641]="MAKEARRAY",c[c.APPLY=642]="APPLY",c[c.ISLAMBDA=643]="ISLAMBDA",c[c.ARITY=644]="ARITY",c[c.RECURSE=645]="RECURSE",c[c.VALUETOTEXT=647]="VALUETOTEXT",c[c.ARRAYTOTEXT=648]="ARRAYTOTEXT",c[c.FORMATTEDNUMBER=649]="FORMATTEDNUMBER",c[c.TOCOL=650]="TOCOL",c[c.TOROW=651]="TOROW",c[c.WRAPCOLS=652]="WRAPCOLS",c[c.MAP=653]="MAP",c[c.REDUCE=654]="REDUCE",c[c.SCAN=655]="SCAN",c[c.BYROW=656]="BYROW",c[c.BYCOL=657]="BYCOL",c[c.ISOMITTED=658]="ISOMITTED",c[c.EXPAND=659]="EXPAND",c[c.TAKE=660]="TAKE",c[c.DROP=661]="DROP",c[c.PY=662]="PY",c[c.IMAGE=664]="IMAGE",c[c.UNIT=665]="UNIT",c[c.GROUPBY=666]="GROUPBY",c[c.PIVOTBY=667]="PIVOTBY",c[c.PYO=668]="PYO",c[c.TESTFUNCTIONBEGIN=669]="TESTFUNCTIONBEGIN",c[c.GRF=670]="GRF",c[c.RICHERROR=671]="RICHERROR",c[c.COUNTER=672]="COUNTER",c[c.BROKENRECORD=673]="BROKENRECORD",c[c.STREAM=674]="STREAM",c[c.GETRICHERRORS=675]="GETRICHERRORS",c[c.DBGSTAT=676]="DBGSTAT",c[c.RICHNUMBER=677]="RICHNUMBER",c[c.RICHERNUMBER=678]="RICHERNUMBER",c[c.DBGWRITE=679]="DBGWRITE",c[c.TEST=680]="TEST",c[c.AAC=681]="AAC",c[c.AWC=682]="AWC",c[c.WEBADDRESS_IMAGETEST=683]="WEBADDRESS_IMAGETEST",c[c.PARSEDEXPRESSION=684]="PARSEDEXPRESSION",c[c.AGE_CONTACTTEST=685]="AGE_CONTACTTEST",c[c.FIRSTNAME_CONTACTTEST=686]="FIRSTNAME_CONTACTTEST",c[c.FULLNAME_CONTACTTEST=687]="FULLNAME_CONTACTTEST",c[c.LASTNAME_CONTACTTEST=688]="LASTNAME_CONTACTTEST",c[c.TRANSLATENAME_CONTACTTEST=689]="TRANSLATENAME_CONTACTTEST",c[c.ARRAYVALUE=690]="ARRAYVALUE",c[c.RECORD=691]="RECORD",c[c.STR_PYTHON=692]="STR_PYTHON",c[c.TYPE_PYTHON=693]="TYPE_PYTHON",c[c.LOCALIMAGE=694]="LOCALIMAGE",c[c.DISPLAYSTRING_GENERALTEST=695]="DISPLAYSTRING_GENERALTEST",c[c.LETREC=750]="LETREC",c[c.NESTEDRECORD=751]="NESTEDRECORD",t.worksheetFuncEnglishNames=[[255,"255"],[268,"GET.WORKBOOK"],[349,"OPTIONS.LISTS.GET"],[355,"OPEN.DIALOG"],[356,"SAVE.DIALOG"],[360,"PHONETIC"],[369,"THAIDAYOFWEEK"],[371,"THAIMONTHOFYEAR"],[612,"_FV"],[626,"_SORT"],[627,"_ONEDARRAY"],[683,"WEBADDRESS_IMAGETEST"],[685,"AGE_CONTACTTEST"],[686,"FIRSTNAME_CONTACTTEST"],[687,"FULLNAME_CONTACTTEST"],[688,"LASTNAME_CONTACTTEST"],[689,"TRANSLATENAME_CONTACTTEST"],[692,"STR_PYTHON"],[693,"TYPE_PYTHON"],[695,"DISPLAYSTRING_GENERALTEST"]].reduce(function(f,p){return f[p[0]]=p[1],f},[]);var l=[];t.worksheetFuncTypes=[[1,255,l,[57],l,1,0,16],[1,3,[36,831,831],l,l,823,0,0],[1,1,[15],l,l,4,0,0],[1,1,[15],l,l,4,0,0],[1,255,l,[305],l,1,0,16],[1,255,l,[49],l,1,0,16],[1,255,l,[49],l,1,0,16],[1,255,l,[49],l,1,0,16],[0,1,[16],l,l,33,0,0],[0,1,[16],l,l,33,0,0],[0,0,l,l,l,3,0,16],[2,255,[1],[49],l,1,0,16],[1,255,l,[49],l,1,0,16],[1,2,[1,1],l,l,2,0,0],[1,3,[1,65,4],l,l,2,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[0,0,l,l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[2,3,[263,48,48],l,l,263,0,0],[2,4,[48,1,1,1],l,l,311,0,0],[2,2,[2,1],l,l,2,0,0],[3,3,[2,1,1],l,l,2,0,0],[1,1,[2],l,l,1,0,0],[1,1,[7],l,l,1,0,0],[0,0,l,l,l,4,0,16],[0,0,l,l,l,4,0,16],[1,255,l,[52],l,4,0,16],[1,255,l,[52],l,4,0,16],[1,1,[4],l,l,4,0,16],[2,2,[1,1],l,l,1,0,0],[3,3,[16,83,18],l,l,1,0,0],[3,3,[16,19,18],l,l,1,0,0],[3,3,[16,19,18],l,l,1,0,0],[3,3,[16,19,18],l,l,1,0,0],[3,3,[16,19,18],l,l,1,0,0],[3,3,[16,19,18],l,l,1,0,0],[1,255,l,[49],l,1,0,16],[3,3,[16,19,18],l,l,1,0,0],[2,2,[263,2],l,l,2,0,0],[1,4,[48,112,84,84],l,l,32,0,0],[1,4,[48,112,112,84],l,l,32,0,0],[1,4,[48,112,84,84],l,l,32,0,0],[1,4,[48,112,112,84],l,l,32,0,0],[1,1,[16],l,l,512,0,2],[0,1,[4],l,l,512,0,2],[0,1,[575],l,l,512,0,2],[3,5,[1,1,1,1,1],l,l,1,0,0],[3,5,[1,1,1,1,1],l,l,1,0,0],[3,5,[1,1,1,1,1],l,l,1,0,0],[3,5,[1,1,1,1,1],l,l,1,0,0],[3,6,[1,1,1,1,1,1],l,l,1,0,0],[3,3,[48,1,1],l,l,1,0,16],[1,2,[48,1],l,l,1,0,0],[0,0,l,l,l,1,16383,0],[2,3,[263,305,17],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,2,[1,1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[0,0,l,l,l,1,16383,0],[1,1,[16],l,l,1,0,0],[1,1,[48],l,l,1,0,0],[1,1,[48],l,l,1,0,0],[3,5,[16,65,65,65,65],l,l,16,16383,0],[2,2,[2,16],l,l,16,0,2],[2,2,[16,16],l,l,2,0,2],[0,3,[66,81,16],l,l,4,0,2],[2,3,[2,2,1],l,l,1,0,0],[1,1,[39],l,l,32,0,0],[0,2,[1,24],l,l,4,0,2],[0,0,l,l,l,4,0,2],[1,1,[303],l,l,1,0,0],[0,1,[4],l,l,4,0,2],[1,2,[2,63],l,l,4,0,2],[0,0,l,l,l,50,0,2],[1,1,[16],l,l,47,0,2],[0,2,[65,66],l,l,32,0,2],[4,5,[87,117,117,1,117],l,l,4,0,0],[0,2,[1,66],l,l,32,0,2],[0,0,l,l,l,16,0,2],[0,0,l,l,l,16,0,2],[0,1,[1],l,l,4,0,2],[2,2,[1,1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[2,255,[33],[831],l,823,0,0],[3,4,[263,49,49,4],l,l,295,0,0],[3,4,[263,49,49,4],l,l,295,0,0],[0,2,[66,65],l,l,32,0,2],[1,7,[2,65,66,67,65,65,2],l,l,575,0,2],[1,1,[63],l,l,4,0,0],[1,1,[18],l,l,2,0,2],[1,2,[2,4],l,l,6,0,2],[2,2,[16,47],l,l,4,0,2],[1,2,[1,1],l,l,1,0,0],[1,4,[2,1,4,4],l,l,7,0,2],[1,1,[1],l,l,2,0,0],[1,1,[2],l,l,2,0,0],[1,1,[2],l,l,2,0,0],[1,1,[2],l,l,2,0,0],[1,2,[2,9],l,l,2,0,0],[1,2,[2,9],l,l,2,0,0],[2,2,[258,258],l,l,4,0,0],[1,1,[2],l,l,2,0,0],[4,4,[2,1,1,2],l,l,2,0,0],[3,4,[2,2,2,2],l,l,2,0,0],[1,1,[2],l,l,1,0,0],[0,3,[66,65,66],l,l,32,0,2],[0,1,[2],l,l,2,0,2],[2,3,[2,2,1],l,l,1,0,0],[1,2,[2,16],l,l,303,16383,0],[1,1,[15],l,l,4,0,0],[1,1,[143],l,l,4,0,0],[1,1,[143],l,l,4,0,0],[1,1,[143],l,l,4,0,0],[1,1,[23],l,l,2,0,0],[1,1,[23],l,l,1,0,0],[1,2,[2,1],l,l,1,0,2],[1,1,[1],l,l,1,0,2],[1,1,[1],l,l,1,0,2],[1,1,[1],l,l,2,0,2],[2,2,[1,1],l,l,2,0,2],[2,2,[1,2],l,l,1,0,2],[2,2,[1,2],l,l,1,0,2],[1,2,[1,1],l,l,1,0,2],[1,1,[3],l,l,1,0,0],[1,1,[3],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[4,4,[1,1,1,1],l,l,1,0,0],[4,5,[1,1,1,1,1],l,l,1,0,0],[1,3,[2,66,65],l,l,2,0,2],[1,2,[16,4],l,l,2,0,2],[1,2,[2,4],l,l,16,0,2],[1,2,[2,4],l,l,16,16383,0],[1,255,[2,3,66,66,66,65,67,66,67],[66],l,3,0,2],[1,255,[3],[127],l,575,0,2],[0,1,[3],l,l,1,0,2],[2,4,[3,115,83,3],l,l,1,0,2],[3,5,[3,83,115,83,3],l,l,1,0,2],[4,5,[3,3,3,4,3],l,l,4,0,2],[4,5,[3,3,3,4,3],l,l,4,0,2],[4,5,[3,3,3,3,3],l,l,4,0,2],[0,1,[3],l,l,4,0,2],[2,3,[3,3,3],l,l,4,0,2],[3,4,[3,3,3,3],l,l,4,0,2],[1,3,[1,67,66],l,l,1,0,2],[1,1,[52],l,l,36,0,2],[1,1,[2],l,l,2,0,0],[1,1,[32],l,l,1,0,0],[1,1,[32],l,l,32,0,0],[2,2,[32,32],l,l,32,0,0],[0,2,[2,2],l,l,32,0,2],[4,6,[1,1,1,1,1,1],l,l,1,0,0],[4,6,[1,1,1,1,1,1],l,l,1,0,0],[1,255,l,[121],l,1,0,16],[0,2,[1,16],l,l,4,0,2],[3,4,[2,1,1,1],l,l,512,0,2],[1,1,[4],l,l,512,0,2],[0,0,l,l,l,512,0,2],[0,0,l,l,l,512,0,2],[2,2,[2,2],l,l,1,0,2],[2,2,[1,2],l,l,32,0,2],[3,3,[1,18,18],l,l,4,0,2],[2,2,[1,2],l,l,4,0,2],[1,1,[1],l,l,4,0,2],[0,1,[1],l,l,512,0,2],[0,1,[2],l,l,4,0,2],[0,4,[3,3,3,3],l,l,3,0,2],[1,255,l,[113],l,1,0,16],[1,1,[1],l,l,1,0,0],[1,2,[1,16],l,l,47,0,2],[1,1,[1],l,l,47,0,2],[1,2,[1,2],l,l,47,0,2],[1,2,[1,2],l,l,63,0,2],[3,3,[16,19,18],l,l,1,0,0],[1,1,[143],l,l,4,0,0],[0,3,[82,65,65],l,l,2,0,2],[0,4,[66,82,17,17],l,l,1,0,2],[1,255,l,[49],l,1,0,16],[1,255,l,[49],l,1,0,16],[3,3,[16,19,18],l,l,1,0,0],[3,3,[16,19,18],l,l,1,0,0],[1,2,[1,1],l,l,1,0,0],[1,1,[143],l,l,4,0,0],[3,3,[16,83,18],l,l,1,0,0],[1,1,[3],l,l,4,0,2],[1,1,[3],l,l,4,0,2],void 0,void 0,[1,2,[1,1],l,l,2,0,32],[2,3,[2,2,1],l,l,1,0,32],[2,3,[2,2,1],l,l,1,0,32],[4,4,[2,1,1,2],l,l,2,0,32],[1,2,[2,9],l,l,2,0,32],[1,2,[2,9],l,l,2,0,32],[3,3,[2,1,1],l,l,2,0,32],[1,1,[2],l,l,1,0,32],[2,2,[1,1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[1,1,[2],l,l,2,0,32],[1,1,[2],l,l,2,0,32],[2,3,[1,16,4],l,l,1,0,16],void 0,void 0,[2,5,[1,65,65,68,66],l,l,2,0,0],[2,3,[1,1,4],l,l,1,0,0],[0,0,l,l,l,1,16383,0],[5,7,[1,1,1,1,1,1,4],l,l,1,0,0],[0,0,l,l,l,512,0,2],[1,1,[12],l,l,512,0,2],[0,0,l,l,l,512,0,2],[1,3,[2,82,84],l,l,512,0,2],[1,255,l,[49],l,1,0,16],[1,255,l,[32],l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[3,3,[16,19,18],l,l,263,0,0],[2,11,[1,18,17,17,18,17,17,115,84,21,17],l,l,2,0,2],[0,1,[4],l,l,4,0,2],[0,0,l,l,l,16,0,2],[0,2,[2,2],l,l,4,0,2],[0,3,[2,2,2],l,l,4,0,2],[2,5,[2,23,23,23,23],l,l,2,0,2],[2,4,[2,1,1,2],l,l,1,0,2],[1,4,[2,66,65,65],l,l,1,0,2],[1,1,[2],l,l,3,16383,0],[0,0,l,l,l,2,0,2],[1,5,[1,2,1,1,1],l,l,47,0,2],[4,5,[1,1,1,1,1],l,l,1,0,0],[0,1,[4],l,l,512,0,2],void 0,void 0,[0,1,[1],l,l,512,0,2],[2,2,[48,48],l,l,32,0,16],[0,2,[66,96],l,l,2,0,2],[1,1,[2],l,l,4,0,2],[1,255,[17],[127],l,575,0,32],[1,1,[3],l,l,4,0,2],[1,1,[2],l,l,63,0,2],[1,2,[1,3],l,l,47,0,2],[1,3,[1,3,1],l,l,47,0,2],[1,3,[2,66,4],l,l,4,0,2],[1,1,[15],l,l,1,0,0],[0,1,[2],l,l,4,0,2],[0,1,[2],l,l,4,0,2],[0,2,[99,66],l,l,4,0,2],[3,3,[3,1,4],l,l,4,0,2],[3,3,[3,1,4],l,l,4,0,2],[2,3,[2,3,66],l,l,1,0,2],[1,2,[1,2],l,l,35,0,2],[1,255,l,[49],l,1,0,16],[3,5,[1,1,1,65,65],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[3,5,[1,1,1,65,65],l,l,1,0,0],[4,4,[1,1,1,4],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[3,3,[1,1,4],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[4,4,[1,1,1,4],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[4,4,[1,1,1,1],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[4,4,[1,1,1,4],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[3,3,[1,1,4],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[4,4,[1,1,1,4],l,l,1,0,0],[2,2,[32,32],l,l,1,0,0],[2,2,[32,32],l,l,1,0,0],[2,2,[32,32],l,l,1,0,0],[2,2,[32,32],l,l,1,0,0],[2,2,[32,32],l,l,1,0,0],[2,2,[32,32],l,l,1,0,0],[3,3,[1,32,32],l,l,1,0,0],[2,2,[32,32],l,l,1,0,0],[2,2,[32,32],l,l,1,0,0],[2,2,[32,32],l,l,1,0,0],[2,2,[32,32],l,l,1,0,0],[2,2,[32,32],l,l,1,0,0],[2,2,[32,32],l,l,1,0,0],[4,4,[32,32,1,1],l,l,1,0,0],[3,4,[32,32,1,65],l,l,1,0,0],[1,255,l,[49],l,1,0,16],[1,255,l,[49],l,1,0,16],[1,255,l,[49],l,1,0,16],[1,255,l,[49],l,1,0,16],[1,255,l,[49],l,1,0,16],[1,255,l,[49],l,1,0,16],[2,3,[49,1,1],l,l,1,0,16],[2,2,[49,1],l,l,1,0,16],[2,2,[49,1],l,l,1,0,16],[2,2,[49,1],l,l,1,0,16],[2,2,[49,1],l,l,1,0,16],[2,3,[49,1,65],l,l,1,0,16],[1,255,l,[32],l,1,0,16],[2,2,[49,1],l,l,1,0,16],[2,2,[1,1],l,l,1,0,0],void 0,[3,4,[2,1,1,1],l,l,1,0,34],[2,3,[2,1,1],l,l,1,0,34],[1,255,l,[2],l,2,0,0],[2,2,[1,1],l,l,1,0,0],[2,9,[66,2,66,65,65,65,66,66,66],l,l,2,0,2],[1,2,[1,2],l,l,35,0,2],[1,3,[1,66,2],l,l,35,0,2],[1,4,[1,66,66,2],l,l,7,0,2],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[2,255,[1],[16],l,1,0,0],[2,3,[16,15,16],l,l,1,0,0],[2,2,[16,15],l,l,1,0,0],[1,1,[16],l,l,1,0,0],[1,2,[1,2],l,l,19,0,2],[1,1,[33],l,l,33,0,2],[4,4,[1,1,1,1],l,l,1,0,0],[3,3,[1,1,2],l,l,1,0,32],[1,1,[1],l,l,2,0,32],[2,2,[1,1],l,l,2,0,32],[1,2,[1,5],l,l,2,0,0],[0,4,[66,66,66,65],l,l,6,0,2],[0,5,[66,66,66,66,65],l,l,6,0,2],[1,2,[1,2],l,l,19,0,2],[2,255,[18,18],[2,79],l,15,0,0],[1,2,[2,39],l,l,39,0,0],[1,1,[16],l,l,2,0,32],[1,255,l,[49],l,1,0,16],[1,255,l,[49],l,1,0,16],[1,255,l,[49],l,1,0,16],[1,255,l,[49],l,1,0,16],[1,255,l,[49],l,1,0,16],[1,255,l,[49],l,1,0,16],[1,255,l,[49],l,1,0,16],[1,1,[1],l,l,2,0,0],[1,1,[1],l,l,2,0,32],[1,1,[3],l,l,2,0,32],[1,1,[1],l,l,2,0,32],[1,1,[1],l,l,2,0,32],[1,1,[1],l,l,2,0,32],[1,1,[2],l,l,1,0,32],[1,1,[2],l,l,4,0,32],[1,1,[1],l,l,1,0,32],[1,1,[1],l,l,1,0,32],[1,1,[1],l,l,1,0,32],[3,255,l,[2],l,2,0,0],[1,255,[2],[50],l,15,0,0],[2,3,[2,50,2],l,l,10,0,0],[3,3,[2,2,2],l,l,15,0,0],[3,4,[2,2,1,2],l,l,10,0,0],[1,2,[95,95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,2,[95,95],l,l,9,0,0],[1,2,[95,95],l,l,9,0,0],[1,2,[95,95],l,l,9,0,0],[1,2,[95,95],l,l,9,0,0],[1,2,[95,95],l,l,9,0,0],[1,2,[95,95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,2,[95,95],l,l,9,0,0],[1,2,[95,95],l,l,9,0,0],[2,2,[95,95],l,l,9,0,0],[2,2,[95,95],l,l,9,0,0],[2,2,[95,95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[2,3,[95,95,95],l,l,9,0,0],[1,255,l,[127],l,9,0,0],[1,255,l,[127],l,9,0,0],[4,4,[95,95,95,127],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[2,2,[95,95],l,l,9,0,0],[1,2,[95,95],l,l,9,0,0],[1,2,[95,95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[2,2,[95,95],l,l,9,0,0],[1,2,[95,95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[2,2,[95,95],l,l,9,0,0],[2,2,[95,95],l,l,9,0,0],[2,2,[95,95],l,l,9,0,0],[2,2,[95,95],l,l,9,0,0],[2,3,[127,127,95],l,l,9,0,0],[3,3,[95,127,127],l,l,9,0,0],[5,6,[95,95,95,95,95,95],l,l,9,0,0],[5,6,[95,95,95,95,95,95],l,l,9,0,0],[4,5,[95,95,95,95,95],l,l,9,0,0],[4,5,[95,95,95,95,95],l,l,9,0,0],[4,5,[95,95,95,95,95],l,l,9,0,0],[4,5,[95,95,95,95,95],l,l,9,0,0],[4,5,[95,95,95,95,95],l,l,9,0,0],[3,3,[95,95,95],l,l,9,0,0],[3,3,[95,95,95],l,l,9,0,0],[3,3,[95,95,95],l,l,9,0,0],[6,7,[95,95,95,95,95,95,95],l,l,9,0,0],[6,7,[95,95,95,95,95,95,95],l,l,9,0,0],[2,2,[95,95],l,l,9,0,0],[2,2,[95,95],l,l,9,0,0],[2,2,[95,95],l,l,9,0,0],[2,2,[95,95],l,l,9,0,0],[6,6,[95,95,95,95,95,95],l,l,9,0,0],[6,6,[95,95,95,95,95,95],l,l,9,0,0],[2,2,[95,95],l,l,9,0,0],[2,2,[95,95],l,l,9,0,0],[2,3,[95,95,95],l,l,9,0,0],[3,4,[95,95,95,95],l,l,9,0,0],[3,4,[95,95,95,95],l,l,9,0,0],[3,4,[95,95,95,95],l,l,9,0,0],[3,4,[95,95,95,95],l,l,9,0,0],[3,4,[95,95,95,95],l,l,9,0,0],[3,4,[95,95,95,95],l,l,9,0,0],[5,6,[95,95,95,95,95,95],l,l,9,0,0],[5,6,[95,95,95,95,95,95],l,l,9,0,0],[7,8,[95,95,95,95,95,95,95,95],l,l,9,0,0],[7,8,[95,95,95,95,95,95,95,95],l,l,9,0,0],[8,9,[95,95,95,95,95,95,95,95,95],l,l,9,0,0],[8,9,[95,95,95,95,95,95,95,95,95],l,l,9,0,0],[2,2,[95,95],l,l,9,16383,0],[1,2,[95,95],l,l,9,0,0],[6,7,[95,95,95,95,95,95,95],l,l,9,0,32],[6,7,[95,95,95,95,95,95,95],l,l,9,0,0],[3,3,[95,95,95],l,l,9,0,0],[6,8,[95,95,95,95,95,95,95,95],l,l,9,0,0],[4,5,[95,95,95,95,95],l,l,9,0,0],[2,3,[95,95,127],l,l,9,0,0],[2,3,[95,95,127],l,l,9,0,0],[1,255,l,[127],l,9,0,0],[1,255,l,[127],l,9,0,0],[1,255,l,[127],l,9,0,0],[2,2,[95,127],l,l,9,0,0],[3,4,[2,2,1,2],l,l,10,0,0],[2,5,[2,50,2,1,2],l,l,10,0,0],[1,1,[2],l,l,9,0,0],[2,2,[47,575],l,l,303,0,0],[2,255,l,[16,15],l,1,0,0],[3,255,[16],[16,15],l,1,0,0],[2,3,[16,15,16],l,l,1,0,0],[3,255,[16],[16,15],l,1,0,0],[3,254,[1,1,48,17],[16],l,1,0,0],[4,4,[1,1,1,4],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[2,2,[32,32],l,l,1,0,0],[2,2,[32,32],l,l,1,0,0],[2,2,[32,32],l,l,1,0,0],[2,2,[32,32],l,l,1,0,0],[3,3,[1,1,4],l,l,1,0,0],[4,4,[1,1,1,4],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[1,254,l,[32],l,32,0,16],[1,254,l,[32],l,1,0,16],[4,4,[1,1,1,4],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[2,2,[49,1],l,l,1,0,16],[2,2,[49,1],l,l,1,0,16],[2,3,[49,1,65],l,l,1,0,16],[2,3,[49,1,65],l,l,1,0,16],[3,3,[1,1,4],l,l,1,0,0],[2,2,[49,1],l,l,1,0,16],[2,2,[49,1],l,l,1,0,16],[2,3,[1,16,4],l,l,1,0,16],[2,3,[1,16,4],l,l,1,0,16],[1,254,l,[49],l,1,0,16],[1,254,l,[49],l,1,0,16],[3,3,[1,1,4],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[1,254,l,[49],l,1,0,16],[1,254,l,[49],l,1,0,16],[4,4,[1,1,1,4],l,l,1,0,0],[2,4,[95,95,75,127],l,l,9,0,0],[2,4,[95,95,75,127],l,l,9,0,0],[2,2,[1,1],l,l,1,0,32],[1,2,[1,65],l,l,1,0,32],void 0,[4,6,[1,1,1,4,65,65],l,l,1,0,0],[3,5,[1,1,1,65,65],l,l,1,0,0],[3,3,[1,1,4],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[4,4,[1,1,1,4],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[5,5,[1,1,1,1,4],l,l,1,0,0],[4,4,[1,1,1,4],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[4,4,[1,1,1,4],l,l,1,0,0],[2,2,[1,4],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[4,4,[32,32,1,1],l,l,1,0,0],[2,3,[49,1,1],l,l,1,0,16],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[1],l,l,1,0,0],[1,2,[1,65],l,l,1,0,32],[1,2,[1,65],l,l,1,0,32],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[2,2,[1,1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[1,254,l,[52],l,4,0,16],[3,3,[1,1,1],l,l,1,0,0],[2,3,[1,1,65],l,l,2,0,0],[2,2,[2,1],l,l,1,0,0],[2,2,[3,3],l,l,1,0,0],[3,4,[1,1,1,65],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,254,l,[49],l,1,0,16],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[1,1,[1],l,l,2,0,0],[1,1,[2],l,l,1,0,0],[1,1,[1],l,l,32,0,0],[1,1,[2],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,3,[2,66,66],l,l,1,0,0],[0,1,[50],l,l,1,16383,16],[0,1,[48],l,l,1,16383,16],[1,1,[16],l,l,2,16383,0],[1,1,[16],l,l,4,0,0],[2,2,[47,575],l,l,303,0,0],[1,3,[1,65,65],l,l,1,0,0],[1,3,[1,65,65],l,l,1,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[2,2,[2,2],l,l,47,0,0],[1,1,[2],l,l,10,0,0],[1,1,[2],l,l,10,0,0],[3,6,[1,48,48,65,65,65],l,l,1,0,0],[3,7,[1,48,48,65,65,65,65],l,l,1,0,0],[2,4,[48,48,65,65],l,l,1,0,0],[3,3,[1,32,32],l,l,1,0,0],[3,6,[48,48,1,65,65,65],l,l,1,0,0],[3,254,[16],[16,15],l,1,0,0],[3,254,[16],[16,15],l,1,0,0],[3,254,[114,68],[114],l,2,0,16],[1,254,l,[114],l,2,0,16],[2,254,l,[44,575],l,831,0,0],[3,254,[47],[575,575],[575],831,0,0],[1,1,[1527],l,l,1503,0,53],[2,254,l,[113,113],l,1,0,17],[1,1,[16],l,l,48,0,21],[2,3,[271,2,4],l,l,303,0,21],[2,2,[271,2],l,l,303,0,17],[2,3,[48,48,111],l,l,303,0,1],[1,4,[160,96,96,4],l,l,32,0,1],[1,3,[160,4,4],l,l,32,0,1],[2,2,[2,256],l,l,1,0,8],[3,3,[2,49,1],l,l,1,0,25],[3,3,[2,49,1],l,l,1,0,25],[2,254,[2],[49],l,1,0,25],[2,7,[34,2,65,65,65,74,68],l,l,1,0,1],[1,3,[2,65,65],l,l,2,0,1],[2,6,[2,34,65,65,65,74],l,l,2,0,1],[2,6,[2,34,65,65,65,74],l,l,2,0,1],[2,6,[2,98,98,68,65,495],l,l,32,0,1],[1,4,[32,96,96,4],l,l,32,0,9],[2,2,[4,16],l,l,32,0,25],[2,4,[391,48,65,65],l,l,1,0,1],[3,6,[391,48,48,511,65,65],l,l,319,0,1],[2,254,[160],[160,65],l,32,0,1],[0,5,[65,65,65,65,68],l,l,32,16383,1],[1,4,[65,65,65,65],l,l,32,0,1],[2,254,[258,1,65,65,65],[65],l,32,0,17],[2,3,[32,1,463],l,l,32,0,1],[1,254,l,[48],l,32,0,17],[1,254,l,[48],l,32,0,17],[2,254,[48],[33],l,32,0,1],[2,254,[48],[33],l,32,0,1],[3,254,l,[319,319],[319],319,0,1],[1,254,l,[319],l,319,0,1],[3,3,[65,65,319],l,l,32,0,1],[1,254,l,[319],l,319,0,1],[1,1,[319],l,l,4,0,1],[1,1,[319],l,l,9,0,1],[0,0,l,l,l,319,0,1],void 0,[1,2,[399,1],l,l,2,0,1],[1,2,[32,1],l,l,2,0,1],[2,2,[15,2],l,l,256,0,17],[1,3,[48,65,68],l,l,32,0,17],[1,3,[48,65,68],l,l,32,0,17],[2,3,[32,1,463],l,l,32,0,1],[2,254,[48],[319],l,32,0,1],[3,3,[511,48,271],l,l,319,0,1],[3,3,[511,48,271],l,l,32,0,1],[1,2,[48,271],l,l,32,0,1],[1,2,[48,271],l,l,32,0,1],[1,1,[1535],l,l,4,0,1],[2,4,[32,65,65,495],l,l,32,0,1],[2,3,[48,65,65],l,l,48,0,1],[2,3,[48,65,65],l,l,48,0,1],[1,254,[1],[48],l,303,0,17],void 0,[1,5,[2,66,65,65,65],l,l,264,0,1],[2,2,[15,2],l,l,271,0,17],[3,6,[48,32,96,68,97,65],l,l,32,0,1],[3,9,[48,48,32,96,68,97,65,97,65],l,l,32,0,1],[1,254,[1],[48],l,1087,0,17],[0,0,l,l,l,1,0,1],[1,2,[287,2],l,l,288,0,17],[1,2,[1,1],l,l,10,0,17],[0,0,l,l,l,1,0,1],[3,254,[47],[2,47],l,47,0,17],[0,1,[1],l,l,1,0,1],[0,1,[1],l,l,32,0,1],[1,2,[2,1],l,l,47,0,1],[1,1,[1],l,l,264,0,17],[1,1,[1],l,l,264,0,17],[2,2,[2,47],l,l,47,0,1],[1,254,[2],[1151],l,1087,0,16],[1,254,[1],[1151],l,1087,0,0],[1,254,[1],[1151],l,1087,0,0],[1,1,[256],l,l,258,0,17],[1,1,[16],l,l,32,0,1],[1,1,[256],l,l,2,0,17],[1,1,[256],l,l,2,0,17],[1,1,[256],l,l,2,0,17],[1,1,[256],l,l,2,0,17],[2,2,[256,2],l,l,2,0,17],[1,1,[32],l,l,256,0,17],[3,254,[15],[2,47],l,303,0,17],[1,1,[256],l,l,2,0,17],[1,1,[256],l,l,2,0,17],[1,2,[2,66],l,l,264,0,1],[1,1,[256],l,l,2,0,17],void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,[3,254,l,[319,319],[319],319,0,1],[3,254,[15],[2,303],l,303,0,17]].map(function(f){return f===void 0?void 0:s.functionType.apply(void 0,Pc(f))})},190:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseSignedLiteral=t.parseNumberLiteral=t.parseUint=t.isLineBreak=t.isSpace=void 0;var s=d(5385),c=d(8660),l=d(8678),f=d(419),p=d(378),m=d(7638),v=d(8479),h=m.codePointSpace,S=m.codePointLF,y=m.codePointMinusSign,C=m.codePointPlusSign,E=m.codePointSlash;function I(k){return k===h||k===S}function F(k,x,G,H){(0,c.assertIndex)("calc.parse.parseUint",x,16);for(var L=0,D=H,U=G.length;D<U;){var V=(0,f.stringCodePointAt)(G,D);if(!k.isNumeral(V))break;var ne=k.getOrdinal(V);L===0&&ne!==0&&(U=(0,s.fastMin)(U,D+x)),L=10*L+ne,D+=(0,f.numCodeUnits)(V)}return D===U&&D<G.length&&k.isNumeral((0,f.stringCodePointAt)(G,D))?[0,H]:[L,D]}function w(k,x,G,H){var L=H,D=F(k,5,G,L),U=Mr(D,2),V=U[0],ne=U[1];if(ne===L||V>32767||(L=ne,!(L<G.length&&G.charCodeAt(L)===E)))return!1;L+=1;var J=F(k,5,G,L),$=Mr(J,2),Z=$[0],ie=$[1];if(ie===L||Z>32767)return!1;if(L=ie,Z===0)return[!1,0,L];var X=x.div(x.fromNumber(V),x.fromNumber(Z));return(0,c.assertTrue)("calc.lang.tryTokenizeFrac",(0,v.isNumberOper)(X)),[X,Z,L]}function B(k,x,G,H,L,D,U){var V,ne,J,$=H,Z=0,ie="",X=!1,Q=!1,b=p.NumberShape.ASCII;if((0,l.stringStartsWith)(G,k.decimalSeparator,H)||H<G.length&&k.isNumeral((0,f.stringCodePointAt)(G,H))){for(var R=function(){if((D||L&&G.indexOf("%",$)>=0)&&(Z-=2,V!==void 0)){var Pe=x.div(V,x.fromNumber(100));(0,c.assertTrue)("calc.lang.parseNumberLiteral",(0,v.isNumberOper)(Pe)),V=Pe,J=p.KnownFormat.Pct}if((0,s.fastAbs)(Z)>=309)return{value:void 0,i:$,consumedThousands:X,consumedDecimal:Q,numShape:b,format:J};var Re=x.parse(k,!0,Z,ie);if(V!==void 0){var fe=x.add(Re,V);(0,c.assertTrue)("calc.lang.parseNumberLiteral",(0,v.isNumberOper)(fe)),Re=fe}return{value:Re,i:$,consumedThousands:X,consumedDecimal:Q,numShape:b,format:J}};$<G.length;){var P=(0,f.stringCodePointAt)(G,$);if(!k.isNumeral(P)||k.getOrdinal(P)!==0)break;(ne=k.getNumberShape(P))!==p.NumberShape.ASCII&&(b=ne),$+=(0,f.numCodeUnits)(P)}if(U){var A=w(k,x,G,$);if(A!==!1){var T=Mr(A,3),g=T[0],O=T[1],M=T[2];return $=M,g===!1?{value:void 0,i:$,consumedThousands:X,consumedDecimal:Q,numShape:b,format:J}:(J=O>=10?p.KnownFormat.FractBond:p.KnownFormat.Fract,V=g,R())}}for(var K=$;$<G.length;){var W=(0,f.stringCodePointAt)(G,$);if(k.isNumeral(W))Z+=1,(ne=k.getNumberShape(W))!==p.NumberShape.ASCII&&(b=ne),$+=(0,f.numCodeUnits)(W);else{if(!(L&&Z>0&&(0,l.stringStartsWith)(G,k.thousandsSeparator,$)))break;X=!0,$+=k.thousandsSeparator.length}}if(ie+=G.substring(K,$),X){var z=function(me,Pe,Re){for(var fe=Re,Se="",be=0;be<Pe.length;){var xe=(0,f.stringCodePointAt)(Pe,be);if(me.isNumeral(xe)){var Ie=(0,f.numCodeUnits)(xe);Se+=Pe.substring(be,be+Ie),be+=Ie,fe-=1}else{if(fe===0||!me.isThousandsPosition(fe))return;be+=me.thousandsSeparator.length}}return Se}(k,ie,Z);if(z===void 0)return;ie=z}if(H<$&&$<G.length&&I(G.charCodeAt($))){var ee=w(k,x,G,$+1);if(ee!==!1){var ue=Mr(ee,3),ce=ue[0],he=ue[1],de=ue[2];return $=de,ce===!1?{value:void 0,i:$,consumedThousands:X,consumedDecimal:Q,numShape:b,format:J}:(J=he>=10?p.KnownFormat.FractBond:p.KnownFormat.Fract,V=ce,R())}}var pe=!1;if((0,l.stringStartsWith)(G,k.decimalSeparator,$)&&(pe=$===H,Q=!0,$+=k.decimalSeparator.length),Z===0)for(;$<G.length;){var _e=(0,f.stringCodePointAt)(G,$);if(!k.isNumeral(_e)||k.getOrdinal(_e)!==0)break;Z-=1,(ne=k.getNumberShape(_e))!==p.NumberShape.ASCII&&(b=ne),$+=(0,f.numCodeUnits)(_e)}for(K=$;$<G.length;){var Ce=(0,f.stringCodePointAt)(G,$);if(!k.isNumeral(Ce))break;(ne=k.getNumberShape(Ce))!==p.NumberShape.ASCII&&(b=ne),$+=(0,f.numCodeUnits)(Ce)}if(ie+=G.substring(K,$),!(pe&&$<=H+k.decimalSeparator.length)){var Ne=function(me,Pe,Re){var fe=Re;if(fe<Pe.length&&me.stringCompareCI("E",Pe.substring(fe,fe+1))===0)fe+=1;else{if(!(0,l.stringStartsWith)(Pe,"**",fe))return[0,Re];fe+=2}var Se=!1;if(fe<Pe.length){var be=(0,f.stringCodePointAt)(Pe,fe);((Se=be===y)||be===C)&&(fe+=(0,f.numCodeUnits)(be))}if(fe>=Pe.length||!me.isNumeral((0,f.stringCodePointAt)(Pe,fe)))return!1;var xe=F(me,10,Pe,fe),Ie=Mr(xe,2),Ve=Ie[0],Ze=Ie[1];return Ze!==fe&&!(Ve>2147483647)&&[Se?-Ve:Ve,Ze]}(k,G,$);if(Ne!==!1){var Le=Mr(Ne,2),Oe=Le[0],le=Le[1];Z+=Oe,le!==$&&(J=p.KnownFormat.Exp),$=le}return Ne===!1?{value:void 0,i:$,consumedThousands:X,consumedDecimal:Q,numShape:b,format:J}:R()}}}t.isSpace=I,t.isLineBreak=function(k){return k===S},t.parseUint=F,t.parseNumberLiteral=B,t.parseSignedLiteral=function(k,x,G,H,L){var D=H,U=!1;if(D<G.length){var V=G.charCodeAt(D);if((V===C||V===y)&&(U=V===y,D+=1,L))for(;D<G.length&&I(G.charCodeAt(D));)D+=1}var ne=B(k,x,G,D,!1,!1,!1);return(ne==null?void 0:ne.value)===void 0?[x.zero,H]:(D=ne.i,[U?x.neg(ne.value):ne.value,D])}},342:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSheetGridCell=t.isSheetGridRange=t.isGridCell=t.isSheetIndex=t.userDefinedFuncLoc=t.nameLoc=t.nameScope=t.documentScope=t.originCell=t.sheetGridCell=t.sheetGridRange=t.sheetGridCube=t.gridCell=t.gridRange=t.unsafeGridRange=t.sheetRangeIndexes=t.allSheetsRange=t.sheetIndex=t.sheetRange=t.structRefColumnLoc=t.documentLoc=t.sheetCols=t.sheetRows=t.lexicalSourceUDF=t.lexicalSourceWSF=t.lexicalSourceName=t.lexicalSourceGrid=t.lexicalSourceRange=t.lexicalSourceCell=t.NameSource=t.LexicalKind=void 0;var s=d(637),c,l,f=s.assertions.assertIndex,p=s.assertions.assertPositiveLength,m=s.assertions.assertFalse;function v(k){return{kind:c.Cell,range:k}}function h(k){return{kind:c.Range,range:k}}function S(k,x,G){return{document:k,index:x,index2:G}}function y(k,x){return S(k,x,x)}function C(k,x,G,H){return{row:k,col:x,rows:G,cols:H}}function E(k,x){return{sheet:k,range:x}}function I(k){return{document:k,index:void 0}}function F(k){return k.index===k.index2}function w(k){return k.rows===1&&k.cols===1}function B(k){return w(k.range)}(function(k){k[k.Cell=1]="Cell",k[k.Range=2]="Range",k[k.NameManager=3]="NameManager",k[k.CondFormatting=4]="CondFormatting",k[k.DataValidation=5]="DataValidation",k[k.Indirect=6]="Indirect",k[k.WSF=7]="WSF",k[k.UDF=8]="UDF",k[k.Other=9]="Other"})(c=t.LexicalKind||(t.LexicalKind={})),(l=t.NameSource||(t.NameSource={})).AppHead="AppHead",l.Plain="Plain",l.StructRef="StructRef",l.Indirect="Indirect",t.lexicalSourceCell=v,t.lexicalSourceRange=h,t.lexicalSourceGrid=function(k,x){switch(k){case c.Cell:return B(x)?v(x):m("calc.lang.lexicalSourceGrid: expected cell");case c.Range:return h(x)}},t.lexicalSourceName=function(k){return{kind:c.NameManager,name:k}},t.lexicalSourceWSF=function(k){return{kind:c.WSF,id:k}},t.lexicalSourceUDF=function(k){return{kind:c.UDF,udf:k}},t.sheetRows=1048576,t.sheetCols=16384,t.documentLoc=function(k,x){return{path:k,name:x}},t.structRefColumnLoc=function(k,x,G,H){return{name:k,range:x,hasHeadersRow:G,hasTotalsRow:H}},t.sheetRange=S,t.sheetIndex=y,t.allSheetsRange=function(k){return{document:k,index:void 0,index2:void 0}},t.sheetRangeIndexes=function(k,x){return{sheets:k,position:x}},t.unsafeGridRange=C,t.gridRange=function(k,x,G,H){return f("calc.lang.gridRange",k,t.sheetRows),f("calc.lang.gridRange",x,t.sheetCols),p("calc.lang.gridRange",G,t.sheetRows-k),p("calc.lang.gridRange",H,t.sheetCols-x),C(k,x,G,H)},t.gridCell=function(k,x){return f("calc.lang.gridCell",k,t.sheetRows),f("calc.lang.gridCell",x,t.sheetCols),C(k,x,1,1)},t.sheetGridCube=E,t.sheetGridRange=E,t.sheetGridCell=E,t.originCell=E,t.documentScope=I,t.nameScope=function(k,x){return x===void 0?I(k):y(k,x)},t.nameLoc=function(k,x){return{scope:k,name:x}},t.userDefinedFuncLoc=function(k,x){return{document:k,id:x}},t.isSheetIndex=F,t.isGridCell=w,t.isSheetGridRange=function(k){return F(k.sheet)},t.isSheetGridCell=B},446:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlMathpack=void 0;var s=d(9799),c=d(2054),l=d(8660),f=d(7161),p=d(5385);function m(D){return{kind:f.OperKind.Number,_valueXL:D}}var v=m(s.mathpack.zero()),h=m(s.mathpack.one()),S=m(s.mathpack.pi());function y(D){return D.num&s.mathpack.MathErrorNum.DivBy0?c.div0ErrorOper:c.numErrorOper}function C(D){return function(U){return(0,l.assertFalse)("calc.lang."+D+": error "+JSON.stringify(U))}}function E(D,U,V){return function(ne){var J=D(ne._valueXL);return typeof J=="number"?U(J):V(J)}}function I(D,U,V){return function(ne,J){var $=D(ne._valueXL,J._valueXL);return typeof $=="number"?U($):V($)}}var F=I(function(D,U){return s.mathpack.equal(U,2)?s.mathpack.mul(D,D):s.mathpack.power(D,U)},m,y),w=E(function(D){return s.mathpack.div(D,100)},m,C("xlPercent")),B=E(s.mathpack.ceil,m,C("xlCeil")),k=E(s.mathpack.floor,m,C("xlFloor")),x=E(s.mathpack.cond,p.identity,C("xlCond, isSupported = "+(0,s.isSupported)())),G=I(s.mathpack.cond2,p.identity,C("xlCond2")),H=E(s.mathpack.sfix,p.identity,C("xlSfix")),L=E(s.mathpack.viewRound,m,C("xlViewRound"));t.xlMathpack={zero:v,one:h,pi:S,add:I(s.mathpack.add,m,y),sub:I(s.mathpack.sub,m,y),mul:I(s.mathpack.mul,m,y),div:I(s.mathpack.div,m,y),power:F,percent:w,neg:function(U){return x(U)!==0?m(s.mathpack.neg(U._valueXL)):U},compare:function(U,V){return s.mathpack.compare(U._valueXL,V._valueXL)},formatGeneral:function(U,V,ne){var J=V._valueXL,$=s.mathpack.formatGeneral(U,J,ne);return typeof $!="string"?(0,l.assertFalse)("calc.lang.xlFormatGeneral: error "+JSON.stringify($)):$},formatFixed:function(U,V,ne){var J=U._valueXL,$=s.mathpack.formatFixed(J,V,ne);return typeof $!="object"?(0,l.assertFalse)("calc.lang.xlFormatFixed: error "+JSON.stringify($)):$},formatScientific:function(U,V,ne){var J=U._valueXL,$=s.mathpack.formatScientific(J,V,ne);return typeof $!="object"?(0,l.assertFalse)("calc.lang.xlFormatScientific: error "+JSON.stringify($)):$},parse:function(U,V,ne,J){var $=s.mathpack.pack(U,V,ne,J);return typeof $!="number"?(0,l.assertFalse)("calc.lang.xlParse: error "+JSON.stringify($)):m($)},trunc:function(U){return m(s.mathpack.trunc(U._valueXL))},ceil:B,floor:k,abs:function(U){return m(s.mathpack.abs(U._valueXL))},cond:x,cond2:G,fromNumber:function(U){return(0,l.assertTrue)("calc.lang.xlFromNumber",isFinite(U)),m(U)},toNumber:function(U){var V=U._valueXL;return(0,l.assertTrue)("calc.lang.xlToNumber",isFinite(V)),V},sqrt:E(s.mathpack.sqrt,m,y),exp:E(s.mathpack.exp,m,y),ln:E(s.mathpack.ln,m,y),log:E(s.mathpack.log,m,y),sin:E(s.mathpack.sin,m,y),cos:E(s.mathpack.cos,m,y),tan:E(s.mathpack.tan,m,y),asin:E(s.mathpack.asin,m,y),acos:E(s.mathpack.acos,m,y),atan:E(s.mathpack.atan,m,y),atan2:I(s.mathpack.atan2,m,y),round:I(s.mathpack.round,m,y),roundUp:I(s.mathpack.roundUp,m,y),roundDown:I(s.mathpack.roundDown,m,y),tenTo:function(U){(0,l.assertInteger)("calc.lang.xlTenTo",U);var V=s.mathpack.tenTo(U);return typeof V=="number"?m(V):y(V)},checkAlmostCancellation:function(U,V){var ne=U._valueXL,J=V._valueXL;return s.mathpack.exp32(ne)-s.mathpack.exp32(J)>=52428800?v:V},fix:function(U){return s.mathpack.fix(U._valueXL)},lfix:function(U){return s.mathpack.lfix(U._valueXL)},sfix:H,viewRound:L}},378:function(u,t){"use strict";var d,s,c,l,f;Object.defineProperty(t,"__esModule",{value:!0}),t.KnownFormat=t.Calendar=t.NumberShape=t.DateOrder=t.CurrencyFormat=void 0,(f=t.CurrencyFormat||(t.CurrencyFormat={})).Paren="Paren",f.Lead="Lead",f.Intern="Intern",f.Trail="Trail",(l=t.DateOrder||(t.DateOrder={})).MDY="MDY",l.DMY="DMY",l.YMD="YMD",l.MYD="MYD",l.DYM="DYM",l.YDM="YDM",(c=t.NumberShape||(t.NumberShape={})).ASCII="ASCII",c.ArabicIndic="ArabicIndic",c.ExtendedArabicIndic="ExtendedArabicIndic",c.Devanagari="Devanagari",c.Bengali="Bengali",c.Gurmukhi="Gurmukhi",c.Gujarati="Gujarati",c.Oriya="Oriya",c.Tamil="Tamil",c.Telugu="Telugu",c.Kannada="Kannada",c.Malayalam="Malayalam",c.Thai="Thai",c.Lao="Lao",c.Tibetan="Tibetan",c.Myanmar="Myanmar",c.Ethiopic="Ethiopic",c.Khmer="Khmer",c.Mongolian="Mongolian",c.ChineseTrad1="ChineseTrad1",c.ChineseTrad2="ChineseTrad2",c.ChineseTrad3="ChineseTrad3",c.ChineseSimp1="ChineseSimp1",c.ChineseSimp2="ChineseSimp2",c.ChineseSimp3="ChineseSimp3",c.Japanese1="Japanese1",c.Japanese2="Japanese2",c.Japanese3="Japanese3",c.Korean1="Korean1",c.Korean2="Korean2",c.Korean3="Korean3",c.Korean4="Korean4",(s=t.Calendar||(t.Calendar={})).Gregorian="Gregorian",s.GregorianUS="GregorianUS",s.Japan="Japan",s.Taiwan="Taiwan",s.Korea="Korea",s.Hijri="Hijri",s.Thai="Thai",s.Hebrew="Hebrew",s.GregorianMEFrench="GregorianMEFrench",s.GregorianArabic="GregorianArabic",s.GregorianXlitEnglish="GregorianXlitEnglish",s.GregorianXlitFrench="GregorianXlitFrench",s.Persian="Persian",s.UmAlQura="UmAlQura",(d=t.KnownFormat||(t.KnownFormat={}))[d.General=0]="General",d[d.NoComFixed0=-1]="NoComFixed0",d[d.NoComFixed=-2]="NoComFixed",d[d.Fixed0=-3]="Fixed0",d[d.Fixed=-4]="Fixed",d[d.Currency=-9]="Currency",d[d.CoCurrency=-10]="CoCurrency",d[d.CurrencyDec=-11]="CurrencyDec",d[d.CoCurrencyDec=-12]="CoCurrencyDec",d[d.Pct0=-13]="Pct0",d[d.Pct=-14]="Pct",d[d.Exp=-15]="Exp",d[d.Fract=-17]="Fract",d[d.FractBond=-18]="FractBond",d[d.MMDDYY=-19]="MMDDYY",d[d.DDMMMYY=-20]="DDMMMYY",d[d.DDMMM=-21]="DDMMM",d[d.MMMYY=-22]="MMMYY",d[d.HHMMAP=-23]="HHMMAP",d[d.HHMMSSAP=-24]="HHMMSSAP",d[d.HHMM=-25]="HHMM",d[d.HHMMSS=-26]="HHMMSS",d[d.MDYHMS=-27]="MDYHMS",d[d.USCoCurrency=-37]="USCoCurrency",d[d.USCoCurrencyDec=-39]="USCoCurrencyDec",d[d.Currency2=-5]="Currency2",d[d.CoCurrency2=-6]="CoCurrency2",d[d.CurrencyDec2=-7]="CurrencyDec2",d[d.CoCurrencyDec2=-8]="CoCurrencyDec2",d[d.Acct=-33]="Acct",d[d.AcctCur=-32]="AcctCur",d[d.AcctDec=-35]="AcctDec",d[d.AcctDecCur=-34]="AcctDecCur",d[d.MMSS=-28]="MMSS",d[d.AbsHMMSS=-31]="AbsHMMSS",d[d.SS0=-29]="SS0",d[d.Eng=-16]="Eng",d[d.Text=-30]="Text"},1109:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPrinter=t.anonymizeFormula=void 0;var s=d(4333),c=d(2054),l=d(9431),f=d(8660),p=d(8479),m=d(342),v=d(8556),h=d(1033),S=d(6547),y=d(8678),C=d(4388),E=d(4152),I=d(6903),F=d(158),w=d(7161),B=d(292),k=d(3935),x=d(419),G=/"/g,H=(0,m.sheetGridCell)((0,m.sheetIndex)((0,m.documentLoc)(void 0,"Book1"),0),(0,m.gridCell)(0,0));function L(A){if(!(0,I.isSuccess)(A)&&A.reason.kind!==C.ResolveReasonKind.NoOriginSheet&&A.reason.kind!==C.ResolveReasonKind.InvalidQualifier&&A.reason.kind!==C.ResolveReasonKind.InvalidCellRef&&A.reason.kind!==C.ResolveReasonKind.InvalidStructRef&&A.reason.kind!==C.ResolveReasonKind.EmptyIntersection)throw new Z(A.reason)}var D;function U(A){for(var T=[],g=[],O=da(A),M;!(M=O()).done;){var K=M.value;K.length>0&&(0,x.numCodeUnits)((0,x.stringCodePointAt)(K,0))===K.length?T[(0,x.stringCodePointAt)(K,0)]=!0:g.push(K)}return function(W,z){var ee=(0,x.stringCodePointAt)(W,z);if(T[ee]===!0)return!0;for(var ue=0,ce=g;ue<ce.length;ue++){var he=ce[ue];if((0,y.stringStartsWith)(W,he,z))return!0}return!1}}function V(A,T){for(var g="",O=0;O<A.length;){T(A,O)&&(g+="'");var M=(0,x.stringCodePointAt)(A,O);g+=(0,x.stringFromCodePoint)(M),O+=(0,x.numCodeUnits)(M)}return g}(function(A){A[A.Original=0]="Original",A[A.Bracketed=1]="Bracketed",A[A.Unbracketed=2]="Unbracketed"})(D||(D={}));var ne={literalNode:function(T,g,O){return O},arrayNode:function(T,g,O){return O},appNode:function(T,g,O,M){return M},letNode:function(T,g,O,M,K,W){return W},lambdaNode:function(T,g,O,M,K,W){return W},parenNode:function(T,g,O){return O},nameNode:function(T,g,O){return O},cellRefNode:function(T,g,O){return O},fieldRefNode:function(T,g,O,M){return M},structRefNode:function(T,g,O){return O},badSequenceNode:function(T,g,O){return O},badStringNode:function(T,g,O){return O},operatorNode:function(T,g){return g},wsfNode:function(T,g,O){return O}},J=_i(_i({},(0,F.constVisitor)(void 0)),{operatorNode:function(T){return T}}),$=function(){function A(T,g,O,M){var K=this;Yg(this,A);var W,z,ee,ue;this.root=O,this.anonymize=M,this.anon=function(de){return K.anonymize?(0,h.anonymizeFormulaString)(de):de},this.locals=g,this.localeInfo=(z=(W=g.config)===null||W===void 0?void 0:W.localeInfo)!==null&&z!==void 0?z:T.config.localeInfo,this.mathpack=T.config.mathpack,this.refStyle=(ue=(ee=g.config)===null||ee===void 0?void 0:ee.refStyle)!==null&&ue!==void 0?ue:T.config.refStyle,this.resolver=(0,E.createResolver)(T),this.spans=O.spans,this.annotations=O.annotations;var ce=["'",this.localeInfo.leftBracket,this.localeInfo.rightBracket,"#","@"],he=[].concat(ce,["	","\n","\r"," ","!",'"',"$","%","&","(",")","*","+",this.localeInfo.listSeparator,"-",".","/",":",";","<","=",">","?","\\","^","_","`","{","}","~"]);this.isStructRefEscapable=U(ce),this.isStructRefBracketedThisRef=U(he),this.isFieldRefEscapable=U(["'",this.localeInfo.leftBracket,this.localeInfo.rightBracket])}return Jg(A,[{key:"print",value:function(){var g=new F.ZipVisitor({str:this,label:ne,op:J});return"="+this.pre(this.root.node.label,"")+(0,F.reduceBottomUp)(g,this.root).str+this.postIfComments(this.root.node.label)}},{key:"pre",value:function(g,O){var M,K;return this.anonymize?O:(K=(M=this.spans[g])===null||M===void 0?void 0:M.pre)!==null&&K!==void 0?K:O}},{key:"post",value:function(g,O){var M,K;return this.anonymize?O:(K=(M=this.spans[g])===null||M===void 0?void 0:M.post)!==null&&K!==void 0?K:O}},{key:"preIfComments",value:function(g){if(this.anonymize)return"";var O=this.spans[g];return(O==null?void 0:O.preComments)!=null&&O.preComments.length>0?O.pre:""}},{key:"postIfComments",value:function(g){if(this.anonymize)return"";var O=this.spans[g];return(O==null?void 0:O.postComments)!=null&&O.postComments.length>0?O.post:""}},{key:"printRef",value:function(g,O){var M="";switch(g.kind){case s.StructRefKind.SpecialRef:{(O===D.Original&&g.isBracketed||O===D.Bracketed)&&(M+=this.localeInfo.leftBracket);var K=this.localeInfo.specialRefNames[g.id];if(K==null)throw new Z((0,p.internal)("No locale data for specialRefName"));M+=K,(O===D.Original&&g.isBracketed&&g.isClosed||O===D.Bracketed)&&(M+=this.localeInfo.rightBracket);break}case s.StructRefKind.ColumnRef:{var W=g.name.length===0||(0,y.stringStartsWith)(g.name," ")||(0,y.stringEndsWith)(g.name," ");(O===D.Original&&g.isBracketed||O===D.Bracketed||O===D.Unbracketed&&W)&&(M+=this.localeInfo.leftBracket);var z=V(g.name,this.isStructRefEscapable);M+=this.anon(z),(O===D.Original&&g.isBracketed&&g.isClosed||O===D.Bracketed||O===D.Unbracketed&&W)&&(M+=this.localeInfo.rightBracket);break}case s.StructRefKind.RangeOpRef:M+=this.printRef(g.lhs,O===D.Original?O:D.Bracketed)+":"+this.printRef(g.rhs,O===D.Original?O:D.Bracketed);break;case s.StructRefKind.MissingRef:break;case s.StructRefKind.BadRef:g.isBracketed&&(M+=this.localeInfo.leftBracket),M+=g.contents,g.isBracketed&&g.isClosed&&(M+=this.localeInfo.rightBracket)}return M}},{key:"printThisRowOpRef",value:function(g){var O="@";return g&&(g.kind===s.StructRefKind.ColumnRef?O+=this.printRef(g,g.isClosed?function(M,K){for(var W=0;W<M.length;){if(K(M,W))return!0;W+=(0,x.numCodeUnits)((0,x.stringCodePointAt)(M,W))}return!1}(g.name,this.isStructRefBracketedThisRef)?D.Bracketed:D.Unbracketed:D.Original):O+=this.printRef(g,(0,p.isRangeOpClosed)(g)&&(0,p.isRangeOpNoMissing)(g)?D.Bracketed:D.Original)),O}},{key:"printApplication",value:function(g,O,M){var K=this,W=O.map(function(z,ee,ue){return K.pre(z.label,ee===0||z.str===""?"":" ")+z.str+(ee===ue.length-1?K.post(z.label,""):K.postIfComments(z.label))});return g.str+"("+W.join(this.localeInfo.listSeparator)+(M?")":"")}},{key:"printCellRef",value:function(g){var O=g.ref,M=g.qualifier;return(M!==void 0?(0,F.visitQualifier)(this,M)+this.postIfComments(M.label):"")+(0,F.visitCellRef)(this,O)}},{key:"printName",value:function(g){var O=g.whole,M=g.qualifier;return(M!==void 0?(0,F.visitQualifier)(this,M)+this.postIfComments(M.label):"")+this.anon(O)}},{key:"printUnanonymisedDocQual",value:function(g){if(g===void 0)return"";var O=g.path,M=g.document;return(O??"")+this.localeInfo.leftBracket+M+this.localeInfo.rightBracket}},{key:"printOptionalParamName",value:function(g){return g.kind===s.NodeKind.Name?this.anon((0,p.getBoundName)(this.localeInfo,g.whole)):this.pre(g.label,"")+this.anon(g.contents)+this.post(g.label,"")}},{key:"literalNode",value:function(g,O,M){switch(g.kind){case w.OperKind.String:return'"'+this.anon(g.value).replace(G,'""')+'"';case w.OperKind.Boolean:return g.value?this.localeInfo.trueName:this.localeInfo.falseName;case w.OperKind.Number:var K=21;return this.anon(this.mathpack.formatGeneral(this.localeInfo,g,K));case w.OperKind.Missing:return"";case w.OperKind.Error:var W=this.localeInfo.errorNames[g.type];if(W==null)throw new Z((0,p.internal)("No locale data for error type "+g.type));return W;default:return(0,f.assertNever)("calc.lang.printFormula",g)}}},{key:"arrayNode",value:function(g,O,M){var K=this;return this.localeInfo.leftBrace+g.map(function(W){return W.map(function(z){return K.preIfComments(z.label)+z.str+K.postIfComments(z.label)}).join(K.localeInfo.columnSeparator)}).join(this.localeInfo.rowSeparator)+(O?this.localeInfo.rightBrace:"")}},{key:"appNode",value:function(g,O,M,K){if(g.op!==void 0){if(O.length===1){var W=O[0];switch(g.op){case l.OperatorId.Percent:return W.str+this.pre(g.label,"")+g.str;case l.OperatorId.Pound:return W.str+this.preIfComments(g.label)+g.str;default:return g.str+this.post(g.label,"")+W.str}}if(O.length===2){var z=Mr(O,2),ee=z[0],ue=z[1],ce=" ",he=" ";switch(g.op){case l.OperatorId.Range:ce=he="";break;case l.OperatorId.Isect:he="";break;case l.OperatorId.Union:ce=""}return ee.str+this.pre(g.label,ce)+g.str+this.post(g.label,he)+ue.str}return(0,f.assertFalse)("calc.lang.printFormula: invalid number of operator args")}return this.printApplication(g,O,M)}},{key:"letNode",value:function(g,O,M,K,W,z){var ee=this,ue=O.map(function(ce){var he=ce.name,de=ce.binder;return(0,s.letVar)((0,s.indexedArg)({str:ee.anon((0,p.getBoundName)(ee.localeInfo,he.arg.whole)),label:he.arg.label,op:void 0},he.index),de)});return this.printApplication(g,(0,s.flattenLetArgs)(ue,M,K),W)}},{key:"lambdaNode",value:function(g,O,M,K,W,z){var ee=this,ue=O.map(function(ce){var he=ce.name,de=(he.arg.name.isBracketed?ee.localeInfo.leftBracket:"")+ee.printOptionalParamName(he.arg.name.name)+(he.arg.name.isBracketed&&he.arg.name.isClosed?ee.localeInfo.rightBracket:"");return he.arg.def!==void 0&&(de+=ee.pre(he.arg.def.label," ")+":="+ee.pre(he.arg.def.rhs.label,he.arg.def.rhs.str===""?"":" ")+he.arg.def.rhs.str),(0,s.lambdaParam)((0,s.indexedArg)({str:de,label:he.arg.label,op:void 0},he.index))});return this.printApplication(g,(0,s.flattenLambdaArgs)(ue,M,K),W)}},{key:"parenNode",value:function(g,O,M){return"("+this.pre(g.label,"")+g.str+this.post(g.label,"")+(O?")":"")}},{key:"nameNode",value:function(g,O,M){var K=this.resolver.resolveDottedName(this.locals,(0,s.nameNode)(g,O,M),this.annotations),W=K.resolved,z=K.fields;return L(W.resolution),W.kind===C.ResolvedKind.ResolvedCellRef?[this.printCellRef(W.node)].concat(Pc(z.map(this.anon))).join("."):W.kind===C.ResolvedKind.ResolvedLocalName&&W.resolution.value!==void 0?[this.anon(W.resolution.value.name)].concat(Pc(z.map(this.anon))).join("."):W.kind===C.ResolvedKind.ResolvedUserDefinedFunc?[this.anon(W.name)].concat(Pc(z.map(this.anon))).join("."):[this.printName(W.node)].concat(Pc(z.map(this.anon))).join(".")}},{key:"cellRefNode",value:function(g,O,M){var K=this.resolver.resolveCellRef(this.locals,(0,s.cellRefNode)(g,O,M)),W=K.node,z=K.resolution;return L(z),this.printCellRef(W)}},{key:"fieldRefNode",value:function(g,O,M,K){var W=g.str,z=M,ee=O.isBracketed||z?this.localeInfo.leftBracket:"",ue=O.isBracketed&&O.isClosed||z?this.localeInfo.rightBracket:"",ce=O.field.kind===s.NodeKind.Name?V(O.field.whole,this.isFieldRefEscapable):O.field.contents;return O.field.kind!==s.NodeKind.Name?W+=this.pre(O.label,""):W+=this.preIfComments(O.label),W+="."+ee+this.anon(ce)+ue+this.post(O.label,""),W}},{key:"structRefNode",value:function(g,O,M){var K=this,W,z=this.resolver.resolveStructRef(this.locals,(0,s.structRefNode)(g,O,M)),ee=z.node,ue=z.table,ce=z.resolution;L(ce);var he=ee.rhs.innerRef,de=ee.lhs;de!==void 0||ue===void 0||!ee.rhs.isClosed||(he==null?void 0:he.kind)===s.StructRefKind.ColumnRef||(he==null?void 0:he.kind)===s.StructRefKind.ThisRowOpRef&&((W=he.ref)===null||W===void 0?void 0:W.kind)===s.StructRefKind.ColumnRef||(de=(0,s.nameNode)((0,s.identNamePart)(ue.name)));var pe=de!==void 0?this.printName(de):"";if(he===void 0&&ee.rhs.isClosed&&de!==void 0)return pe;switch(pe+=this.localeInfo.leftBracket,he==null?void 0:he.kind){case s.StructRefKind.ColumnRef:case s.StructRefKind.SpecialRef:if(he.kind===s.StructRefKind.SpecialRef&&he.id===s.SpecialRefId.ThisRow&&he.isClosed){pe+=this.printThisRowOpRef(void 0);break}pe+=this.printRef(he,he.isClosed?D.Unbracketed:D.Original);break;case s.StructRefKind.RangeOpRef:{var _e=(0,p.isRangeOpClosed)(he)&&(0,p.isRangeOpNoMissing)(he)?D.Bracketed:D.Original;pe+=this.printRef(he,_e);break}case s.StructRefKind.CommaOpRef:{var Ce=(0,p.isCommaOpRefWellFormed)(he)&&(0,p.isCommaOpClosed)(he)&&(0,p.isCommaOpNoBadOrMissing)(he);if(Ce&&he.specialRefs[s.SpecialRefId.ThisRow]){pe+=this.printThisRowOpRef(he.columnRefs.length===0?void 0:he.columnRefs[0]);break}var Ne=Ce?(0,p.normalizeCommaOpRef)(he):he.refs,Le=Ce?Ne.length===1?D.Unbracketed:D.Bracketed:D.Original;pe+=Ne.map(function(Oe){return K.printRef(Oe,Le)}).join(this.localeInfo.listSeparator);break}case s.StructRefKind.ThisRowOpRef:pe+=this.printThisRowOpRef(he.ref);break;case s.StructRefKind.BadRef:pe+=this.printRef(he,D.Original)}return ee.rhs.isClosed&&(pe+=this.localeInfo.rightBracket),pe}},{key:"badSequenceNode",value:function(g,O,M){var K=this;return O.map(function(W){return K.pre(W.label,"")+W.str+K.post(W.label,"")}).join("")}},{key:"badStringNode",value:function(g,O,M){return this.anon(O)}},{key:"operatorNode",value:function(g,O){var M=(0,v.operatorIdToName)(this.localeInfo,g,"");if(M===void 0)throw new Z((0,p.internal)("Invalid operator"));return M}},{key:"wsfNode",value:function(g,O,M){return this.localeInfo.getWorksheetFuncName(g)}},{key:"cellRefError",value:function(){var g=this.localeInfo.errorNames[c.ErrorType.REF];if(g==null)throw new Z((0,p.internal)("No locale data for #REF"));return g}},{key:"cellRefSingle",value:function(g,O,M){var K=(0,S.formatCellPos)(this.localeInfo,this.refStyle,this.locals.originGridCell.value,g,O,this.locals.wrapCellReferences);return K!==void 0?this.anon(K):this.cellRefError()}},{key:"cellRefRange",value:function(g,O){var M=(0,S.formatRangePos)(this.localeInfo,this.refStyle,this.locals.originGridCell.value,g.row,g.col,O.row,O.col,this.locals.wrapCellReferences);return M!==void 0?this.anon(M):this.cellRefError()}},{key:"cellRefRow",value:function(g,O,M){var K=(0,S.formatRowRange)(this.localeInfo,this.refStyle,this.locals.originGridCell.value.row,g,O,this.locals.wrapCellReferences);return K!==void 0?this.anon(K):this.cellRefError()}},{key:"cellRefCol",value:function(g,O,M){var K=(0,S.formatColRange)(this.localeInfo,this.refStyle,this.locals.originGridCell.value.col,g,O,this.locals.wrapCellReferences);return K!==void 0?this.anon(K):this.cellRefError()}},{key:"cellRefBad",value:function(g,O){return this.anon(g)}},{key:"errorQualifier",value:function(){var g=this.localeInfo.errorNames[c.ErrorType.REF];if(g==null)throw new Z((0,p.internal)("No locale data for #REF"));return g}},{key:"relativeQualifier",value:function(){return"!"}},{key:"documentQualifier",value:function(g,O,M){return(0,S.quoteQualifier)(this.anon(this.printUnanonymisedDocQual((0,s.documentQualifier)(g,O))))+"!"}},{key:"sheetQualifier",value:function(g,O,M){return(0,S.formatQualifier)(this.localeInfo,this.refStyle,this.anon(this.printUnanonymisedDocQual(O)+g))+"!"}},{key:"identQualifier",value:function(g,O){return(0,S.formatQualifier)(this.localeInfo,this.refStyle,this.anon(g))+"!"}},{key:"sheetRangeQualifier",value:function(g,O,M,K){var W=this.anon(this.printUnanonymisedDocQual(M)+g),z=this.anon(O),ee=W+":"+z;return((0,S.shouldQuoteQualifier)(this.localeInfo,this.refStyle,W)||(0,S.shouldQuoteQualifier)(this.localeInfo,this.refStyle,z)?(0,S.quoteQualifier)(ee):ee)+"!"}},{key:"badQualifier",value:function(g,O){return this.anon(g)}}]),A}(),Z=(0,p.createFailureErrorClass)("PrintFormulaError"),ie=(0,p.createFailureErrorClass)("PrintRangeError");function X(A,T,g){var O=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;try{return(0,I.success)(new $(A,T,g,O).print())}catch(M){return M instanceof Z?(0,I.failure)(M.reason):(0,I.failure)((0,I.javaScriptError)(M))}}function Q(A,T){return(0,s.cellRefSingle)((0,s.pos)(s.PosKind.Rel,T.row-A.row),(0,s.pos)(s.PosKind.Rel,T.col-A.col))}function b(A){return(0,I.isSuccess)(A)?((0,f.assertTrue)("calc.lang.printRangeStructRef: NameLoc can't be no-table",A.value!=null),(0,I.success)(A.value)):A.reason.kind===C.ResolveReasonKind.InvalidStructRef?(0,f.assertFalse)("calc.lang.printRangeStructRef: NameLoc can't be InvalidStructRef"):(0,I.failure)(A.reason)}function R(A,T,g){var O=arguments.length>3&&arguments[3]!==void 0?arguments[3]:(0,B.makeEmptyTable)(),M,K;try{var W=T.originSheet.value;if(!(0,p.isDocumentLocEqual)(W.document,g.sheet.document))throw new ie((0,p.notImplemented)(["printRange cross-document"]));return(0,I.success)((K=(M=function(z,ee,ue,ce){var he=ee.originSheet.value,de=z.getNamedRanges(ue);if(!(0,I.isSuccess)(de))throw new ie(de.reason);if(de.value.length!==0){var pe=function(le){return le.index!==void 0&&(he.index===void 0||!(0,p.isSheetIndexEqual)(le,he))},_e=de.value.filter(function(Oe){var le=Oe.scope;return le.index===void 0?(0,p.isDocumentLocEqual)(le.document,ue.sheet.document):(0,p.isSheetIndexEqual)(le,ue.sheet)}).filter(function(Oe){var le=Oe.scope,me=Oe.name;if(le.index!==void 0||he.index===void 0)return!0;var Pe=he,Re=z.getNameLoc(Pe,me,m.NameSource.Plain);if(!(0,I.isSuccess)(Re))throw new ie(Re.reason);return Re.value==null}).filter(function(Oe){var le=Oe.scope,me=Oe.name;return pe(le)||!ce.contains(me)});if(_e.length!==0){var Ce=_e.length===1?_e[0]:Pc(_e).sort(function(Oe,le){return z.config.localeInfo.stringCompareCI(Oe.name,le.name)})[0],Ne;if(pe(Ce.scope)){var Le=z.getSheetName(Ce.scope.document,Ce.scope.index);if(!(0,I.isSuccess)(Le))throw new ie(Le.reason);Ne=(0,s.sheetQualifier)(Le.value)}return(0,s.nameNode)((0,s.identNamePart)(Ce.name),Ne)}}}(A,T,g,O))!==null&&M!==void 0?M:function(z,ee,ue){var ce=ue.sheet,he=ue.range,de=z.getContainingTable((0,m.sheetGridCell)(ce,(0,p.gridRangeAnchor)(he)));if(!(0,I.isSuccess)(de))throw new ie(de.reason);if(de.value!=null){var pe=de.value,_e=b(z.getStructRefSpecialRef(pe,s.SpecialRefId.All));if(!(0,I.isSuccess)(_e))throw new ie(_e.reason);var Ce=_e.value.range,Ne=_e.value.sheet,Le=(0,p.gridRangeCompare)(Ce,he);if(!(Le===void 0||Le<0)){var Oe=b(z.getStructRefSpecialRef(pe,s.SpecialRefId.Data));if(!(0,I.isSuccess)(Oe))throw new ie(Oe.reason);var le=Oe.value.range,me=ee.originGridCell.value,Pe=ee.originSheet.value,Re=Pe.index!==void 0&&(0,p.isSheetIndexEqual)(Pe,Ne)&&(0,p.gridRangeIsects)(Ce,me)?void 0:(0,s.nameNode)((0,s.identNamePart)(pe.name)),fe=Re??(0,s.nameNode)((0,s.identNamePart)(pe.name)),Se=le.cols>1&&he.col===le.col&&he.cols===le.cols,be=function(){var Or=b(z.getStructRefColumn(pe,he.col));if(!(0,I.isSuccess)(Or))throw new ie(Or.reason);if(he.cols===1)return(0,s.columnRef)(Or.value.name);var Rr=b(z.getStructRefColumn(pe,he.col+he.cols-1));if(!(0,I.isSuccess)(Rr))throw new ie(Rr.reason);return(0,s.rangeOpRef)((0,s.columnRef)(Or.value.name),(0,s.columnRef)(Rr.value.name))};if(he.row===Ce.row&&he.rows===Ce.rows)return(0,s.structRefNode)(fe,(0,s.structRef)(Se?(0,s.specialRef)(s.SpecialRefId.All):(0,s.commaOpRef)([(0,s.specialRef)(s.SpecialRefId.All,!0),be()])));if(he.rows===1&&he.row===me.row&&he.row>=le.row&&he.row<le.row+le.rows)return(0,s.structRefNode)(he.cols===1?Re:fe,(0,s.structRef)((0,s.thisRowOpRef)(Se?void 0:be())));if(he.row===le.row&&he.rows===le.rows)return Se?(0,s.structRefNode)(fe,(0,s.structRef)(void 0)):(0,s.structRefNode)(he.cols===1?Re:fe,(0,s.structRef)(be()));var xe=he.row===Ce.row&&he.row+he.rows===le.row,Ie=he.row===le.row+le.rows&&he.row+he.rows===Ce.row+Ce.rows;if(xe||Ie){var Ve=(0,s.specialRef)(xe?s.SpecialRefId.Headers:s.SpecialRefId.Totals,!Se);return(0,s.structRefNode)(fe,(0,s.structRef)(Se?Ve:(0,s.commaOpRef)([Ve,be()])))}var Ze=he.row===Ce.row&&Ce.row<le.row&&he.row+he.rows===le.row+le.rows,gr=he.row===le.row&&Ce.row+Ce.rows>le.row+le.rows&&he.row+he.rows===Ce.row+Ce.rows;if(Ze||gr){var cr=(0,s.specialRef)(Ze?s.SpecialRefId.Headers:s.SpecialRefId.Data,!0),_r=(0,s.specialRef)(Ze?s.SpecialRefId.Data:s.SpecialRefId.Totals,!0);return(0,s.structRefNode)(fe,(0,s.structRef)(Se?(0,s.commaOpRef)([cr,_r]):(0,s.commaOpRef)([cr,_r,be()])))}}}}(A,T,g))!==null&&K!==void 0?K:function(z,ee,ue){var ce=ee.originSheet.value,he=function(_e,Ce){if(Ce.col===0&&Ce.cols===m.sheetCols)return function(Oe,le,me){return(0,s.cellRefRow)((0,s.pos)(s.PosKind.Rel,le-Oe.row),(0,s.pos)(s.PosKind.Rel,le+me-1-Oe.row))}(_e,Ce.row,Ce.rows);if(Ce.row===0&&Ce.rows===m.sheetRows)return function(Oe,le,me){return(0,s.cellRefCol)((0,s.pos)(s.PosKind.Rel,le-Oe.col),(0,s.pos)(s.PosKind.Rel,le+me-1-Oe.col))}(_e,Ce.col,Ce.cols);var Ne=Q(_e,(0,p.gridRangeAnchor)(Ce));if((0,p.isGridCell)(Ce))return Ne;var Le=Q(_e,(0,m.gridCell)(Ce.row+Ce.rows-1,Ce.col+Ce.cols-1));return(0,s.cellRefRange)(Ne,Le)}(ee.originGridCell.value,ue.range),de;if(ce.index===void 0||!(0,p.isSheetIndexEqual)(ce,ue.sheet)){var pe=z.getSheetName(ue.sheet.document,ue.sheet.index);if(!(0,I.isSuccess)(pe))throw new ie(pe.reason);de=(0,s.sheetQualifier)(pe.value)}return(0,s.cellRefNode)(he,de)}(A,T,g))}catch(z){return z instanceof ie?(0,I.failure)(z.reason):(0,I.failure)((0,I.javaScriptError)(z))}}t.anonymizeFormula=function(A,T,g){try{var O=g.kind===m.LexicalKind.Cell||g.kind===m.LexicalKind.Range?(0,k.printLocalsGrid)(g,(0,p.sheetGridRangeAnchor)(g.range)):g.kind===m.LexicalKind.NameManager?(0,k.printLocalsName)(g,H):(0,f.assertNever)("calc.lang.anonymizeFormula",g),M=X((0,k.createSimplePrintGlobals)((0,v.calcConfig)((0,v.getEnglishLocaleInfo)(),s.RefStyle.A1,A.mathpack)),O,T,!0);if(M.kind===I.ResultKind.Success)return M.value;if(M.reason.kind===I.ReasonKind.JavaScriptError)throw M.reason.error}catch(W){var K="calc.lang.anonymizeFormula: Format failed: "+(0,y.messageFromError)(W);f.ulsLogger.ULS.traceTag(556863706,v.LogCategory.msoulscat_ES_EWAJS,v.TraceLevel.Warning,K)}return(0,h.anonymize)(T)};var P={getNamedRanges:function(){return(0,f.assertFalse)("calc.lang.prettyPrinter: default getNamedRanges")}};t.createPrinter=function(A){var T=function(g){var O,M,K;return{config:g.config,getDocumentLoc:g.getDocumentLoc.bind(g),getSheetIndex:g.getSheetIndex.bind(g),getSheetName:g.getSheetName.bind(g),getNameLoc:g.getNameLoc.bind(g),getUserDefinedFuncLoc:g.getUserDefinedFuncLoc.bind(g),getSheetRangeIndexes:g.getSheetRangeIndexes.bind(g),getContainingTable:g.getContainingTable.bind(g),getStructRefColumn:g.getStructRefColumn.bind(g),getStructRefSpecialRef:(O=g.getStructRefSpecialRef)===null||O===void 0?void 0:O.bind(g),getNamedRanges:(K=(M=g.getNamedRanges)===null||M===void 0?void 0:M.bind(g))!==null&&K!==void 0?K:P.getNamedRanges}}(A);return{printFormula:function(O,M){return X(A,O,M)},printRange:function(O,M,K){return R(T,O,M,K)}}}},3935:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.printLocalsName=t.printLocalsGrid=t.createSimplePrintGlobals=void 0;var s=d(342),c=d(6903),l=d(8479),f=function(){function p(m){Yg(this,p),this.config=m}return Jg(p,[{key:"getDocumentLoc",value:function(v,h){return(0,c.success)((0,s.documentLoc)(v,h))}},{key:"getSheetIndex",value:function(v,h){return(0,c.success)(h)}},{key:"getSheetName",value:function(v,h){return(0,c.success)(h)}},{key:"getNameLoc",value:function(v,h){return(0,c.success)(h.indexOf(".")>=0?void 0:(0,s.nameLoc)(v,h))}},{key:"getUserDefinedFuncLoc",value:function(v,h){return(0,c.success)([(0,s.userDefinedFuncLoc)(v,h)])}},{key:"getSheetRangeIndexes",value:function(v){if(v.index===void 0)return(0,c.failure)((0,l.notImplemented)(["simplePrintGlobals.getSheetRangeIndexes"]));var h=[v.index];return v.index2!==v.index&&h.push(v.index2),(0,c.success)((0,s.sheetRangeIndexes)(h,0))}},{key:"getContainingTable",value:function(v){return c.successUndefined}},{key:"getStructRefColumn",value:function(v,h){return c.successUndefined}},{key:"getStructRefSpecialRef",value:function(v,h){return c.successUndefined}},{key:"getNamedRanges",value:function(v){return(0,c.success)([])}}]),p}();t.createSimplePrintGlobals=function(p){return new f(p)},t.printLocalsGrid=function(p,m,v){return{config:v??void 0,lexicalSource:p,originGridCell:(0,c.success)(m.range),originSheet:(0,c.success)(m.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}},t.printLocalsName=function(p,m,v){return{config:v??void 0,lexicalSource:p,originGridCell:(0,c.success)(m.range),originSheet:(0,c.success)(m.sheet),allowUnqualifiedCell:!1,wrapCellReferences:!0}}},4152:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createResolver=t.resolveGridRef=void 0;var s=d(5385),c=d(5385),l=d(8660),f=d(6547),p=d(4333),m=d(8479),v=d(8479),h=d(342),S=d(342),y=d(6903),C=d(4388);function E(B){return(0,y.isSuccess)(B)&&(0,c.isNone)(B.value)?y.successUndefined:B}function I(B){return!(0,y.isSuccess)(B)||B.value===void 0}function F(B,k,x){var G=(0,f.resolvePosition)(B.row,k.row,S.sheetRows,x),H=(0,f.resolvePosition)(B.col,k.col,S.sheetCols,x);return G!==void 0&&H!==void 0?(0,S.gridCell)(G,H):void 0}function w(B,k){if(k.kind===p.CellRefKind.Error)return y.successUndefined;var x=B.originGridCell;if(!(0,y.isSuccess)(x))return x;var G=x.value,H=B.wrapCellReferences;switch(k.kind){case p.CellRefKind.Single:return(0,y.success)(F(G,k,H));case p.CellRefKind.Range:var L=F(G,k.ref1,H),D=F(G,k.ref2,H);return L!==void 0&&D!==void 0?(0,y.success)((0,v.gridCellRange)(L,D)):y.successUndefined;case p.CellRefKind.Row:var U=(0,f.resolvePosition)(G.row,k.row1,S.sheetRows,H),V=(0,f.resolvePosition)(G.row,k.row2,S.sheetRows,H);return U!==void 0&&V!==void 0?(0,y.success)((0,v.gridCellRange)((0,S.gridCell)(U,0),(0,S.gridCell)(V,S.sheetCols-1))):y.successUndefined;case p.CellRefKind.Col:var ne=(0,f.resolvePosition)(G.col,k.col1,S.sheetCols,H),J=(0,f.resolvePosition)(G.col,k.col2,S.sheetCols,H);return ne!==void 0&&J!==void 0?(0,y.success)((0,v.gridCellRange)((0,S.gridCell)(0,ne),(0,S.gridCell)(S.sheetRows-1,J))):y.successUndefined;case p.CellRefKind.Bad:return(0,y.failure)((0,C.invalidCellRef)(C.InvalidCellRefReason.BadCellRef));default:return(0,l.assertNever)("calc.runtime.resolverService.resolveGridRef",k)}}t.resolveGridRef=w,t.createResolver=function(B){function k($,Z){if(Z===void 0){var ie=$.originSheet;return(0,y.isSuccess)(ie)?[Z,(0,y.success)(ie.value.document)]:[Z,ie]}var X=B.getDocumentLoc(Z.path,Z.document);if(!(0,y.isSuccess)(X))return[Z,X];if((0,c.isNone)(X.value))return[Z,(0,y.failure)((0,C.invalidQualifier)(C.InvalidQualifierReason.UndefinedDocument))];var Q=Z.path==null?void 0:X.value.path,b=X.value.name;return[(0,p.documentQualifier)(b,Q,Z.isQuoted,Z.label),(0,y.success)(X.value)]}function x($,Z){if(I(Z))return[$,Z];var ie=E(B.getSheetIndex(Z.value,$));if(!(0,y.isSuccess)(ie))return[$,ie];if((0,c.isNone)(ie.value))return[$,(0,y.failure)((0,C.invalidQualifier)(C.InvalidQualifierReason.UndefinedSheetName))];var X=B.getSheetName(Z.value,ie.value);return(0,y.isSuccess)(X)?[X.value,(0,y.success)((0,S.sheetIndex)(Z.value,ie.value))]:[$,X]}function G($,Z){var ie=k($,Z.document),X=Mr(ie,2),Q=X[0],b=X[1],R=x(Z.sheet,b),P=Mr(R,2),A=P[0],T=P[1];return[(0,p.sheetQualifier)(A,Q,Z.isQuoted,Z.label),T]}function H($,Z){var ie=Z.qualifier,X=Z.ref,Q=w($,X),b,R,P;if(ie===void 0||ie.kind===p.QualifierKind.Relative){b=ie;var A=$.originSheet;if((0,y.isSuccess)(A)){var T=A.value;R=T.index===void 0?(0,y.failure)((0,C.noOriginSheet)(T)):(0,y.success)(T)}else R=A}else{var g=function(M,K){switch(K.kind){case p.QualifierKind.Error:return[K,y.successUndefined];case p.QualifierKind.Sheet:return G(M,K);case p.QualifierKind.SheetRange:return function(W,z){var ee=k(W,z.document),ue=Mr(ee,2),ce=ue[0],he=ue[1],de=x(z.sheet1,he),pe=Mr(de,2),_e=pe[0],Ce=pe[1],Ne=x(z.sheet2,he),Le=Mr(Ne,2),Oe=Le[0],le=Le[1],me,Pe=_e,Re=Oe;if(I(he))me=he;else if(I(Ce))me=Ce;else if(I(le))me=le;else{if((0,v.isSheetIndexEqual)(Ce.value,le.value))return[(0,p.sheetQualifier)(Pe,ce,z.isQuoted,z.label),(0,y.success)((0,S.sheetIndex)(he.value,Ce.value.index))];{var fe=B.getSheetRangeIndexes(Ce.value),Se=B.getSheetRangeIndexes(le.value);(0,y.isSuccess)(fe)?(0,y.isSuccess)(Se)?Se.value.position<fe.value.position&&(Pe=Oe,Re=_e):me=Se:me=fe,me=(0,y.success)((0,S.sheetRange)(he.value,Ce.value.index,le.value.index))}}return[(0,p.sheetRangeQualifier)(Pe,Re,ce,z.isQuoted,z.label),me]}(M,K);case p.QualifierKind.Document:return[K,(0,y.failure)((0,C.invalidQualifier)(C.InvalidQualifierReason.SheetRangeName))];case p.QualifierKind.Bad:return[K,(0,y.failure)((0,C.invalidQualifier)(C.InvalidQualifierReason.BadQualifier))];default:return(0,l.assertNever)("calc.runtime.resolverService.resolveCellRefQualifier",K)}}($,ie),O=Mr(g,2);b=O[0],R=O[1]}return P=I(Q)?Q:I(R)?R:(0,y.success)((0,S.sheetGridCube)(R.value,Q.value)),(0,C.resolvedCellRef)((0,p.cellRefNode)(X,b,Z.label),P)}function L($,Z,ie){var X=Z.qualifier,Q=Z.parts,b,R,P=[];if(X===void 0||X.kind===p.QualifierKind.Relative){var A=$.originSheet;if(!(0,y.isSuccess)(A))return(0,C.resolvedName)(Z,A,P);var T=A.value;if(ie!==S.NameSource.StructRef){if(T.index===void 0)return(0,C.resolvedName)(Z,(0,y.failure)((0,C.noOriginSheet)(T)),P);P.push((0,h.nameLoc)(T,Q.asWhole));var g=E(B.getNameLoc(T,Q.asWhole,ie));if(!(0,y.isSuccess)(g))return(0,C.resolvedName)(Z,g,P);if(g.value)return(0,C.resolvedName)((0,p.nameNode)((0,p.identNamePart)(g.value.name,Q.canDenoteNamedObject,Q.label,Q.qualifiedLabel),X,Z.label),g,P)}b=X,R=(0,y.success)((0,S.documentScope)(T.document))}else{var O=function(z,ee){switch(ee.kind){case p.QualifierKind.Document:{var ue=k(z,ee),ce=Mr(ue,2),he=ce[0],de=ce[1];return[he,I(de)?de:(0,y.success)((0,S.documentScope)(de.value))]}case p.QualifierKind.Sheet:return G(z,ee);case p.QualifierKind.SheetRange:return[ee,(0,y.failure)((0,C.invalidQualifier)(C.InvalidQualifierReason.SheetRangeName))];case p.QualifierKind.Ident:{var pe=(0,p.sheetQualifier)(ee.name,void 0),_e=G(z,pe),Ce=Mr(_e,2),Ne=Ce[0],Le=Ce[1];if(!(0,y.isSuccess)(Le)&&Le.reason.kind!==C.ResolveReasonKind.InvalidQualifier)return[ee,Le];if((0,y.isSuccess)(Le)&&Le.value!==void 0)return[(0,p.identQualifier)(Ne.sheet,ee.isQuoted,ee.label),Le];var Oe=(0,p.documentQualifier)(ee.name),le=k(z,Oe),me=Mr(le,2),Pe=me[0],Re=me[1];return[(0,p.identQualifier)(Pe.document,ee.isQuoted,ee.label),I(Re)?Re:(0,y.success)((0,S.documentScope)(Re.value))]}case p.QualifierKind.Bad:return[ee,(0,y.failure)((0,C.invalidQualifier)(C.InvalidQualifierReason.BadQualifier))];default:return(0,l.assertNever)("calc.runtime.resolverService.resolveNameQualifier",ee)}}($,X),M=Mr(O,2);b=M[0],R=M[1]}var K,W=Q;return I(R)?K=R:(P.push((0,h.nameLoc)(R.value,Q.asWhole)),K=E(B.getNameLoc(R.value,Q.asWhole,ie)),I(K)||(W=(0,p.identNamePart)(K.value.name,Q.canDenoteNamedObject,Q.label,Q.qualifiedLabel))),(0,C.resolvedName)((0,p.nameNode)(W,b,Z.label),K,P)}function D($,Z){var ie=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,X=B.getStructRefColumn($,Z.name);if(!(0,y.isSuccess)(X))return{kind:p.StructRefKind.ColumnRef,innerRef:Z,resolution:X};var Q=X.value;if((0,c.isNone)(Q))return{kind:p.StructRefKind.ColumnRef,innerRef:Z,resolution:(0,y.failure)((0,C.invalidStructRef)(C.InvalidStructRefReason.UndefinedColumnName))};var b=Q.range.range;return ie&&(b=(0,S.gridRange)(b.row-(Q.hasHeadersRow?1:0),b.col,b.rows+(Q.hasHeadersRow?1:0)+(Q.hasTotalsRow?1:0),b.cols)),{kind:p.StructRefKind.ColumnRef,innerRef:(0,p.columnRef)(Q.name,Z.isBracketed,Z.isClosed,Z.label),resolution:(0,y.success)((0,S.sheetGridRange)(Q.range.sheet,b))}}function U($,Z,ie){if(ie===p.SpecialRefId.ThisRow){if(!(0,y.isSuccess)($.originGridCell))return $.originGridCell;var X=U($,Z,p.SpecialRefId.Data);if(I(X))return X;var Q=X.value.range,b=$.originGridCell.value.row;return b<Q.row||b>=Q.row+Q.rows?(0,y.failure)(C.emptyIntersection):(0,y.success)((0,S.sheetGridRange)(X.value.sheet,(0,S.gridRange)(b,Q.col,1,Q.cols)))}return E(B.getStructRefSpecialRef(Z,ie))}function V($,Z,ie){switch(Z.kind){case p.StructRefKind.ColumnRef:return D($,Z,ie);case p.StructRefKind.MissingRef:return{kind:p.StructRefKind.MissingRef,innerRef:Z,resolution:y.successUndefined}}}function ne($,Z){var ie=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,X,Q=V($,Z.lhs,ie),b=Q.innerRef,R=Q.resolution,P=V($,Z.rhs,ie),A=P.innerRef,T=P.resolution,g=(0,p.rangeOpRef)(b,A,Z.label);if(!(0,y.isSuccess)(R)&&R.reason.kind!==C.ResolveReasonKind.InvalidStructRef)return{kind:p.StructRefKind.RangeOpRef,innerRef:g,resolution:R};if(!(0,y.isSuccess)(T)&&T.reason.kind!==C.ResolveReasonKind.InvalidStructRef)return{kind:p.StructRefKind.RangeOpRef,innerRef:g,resolution:T};if(!(0,y.isSuccess)(R))return{kind:p.StructRefKind.RangeOpRef,innerRef:g,resolution:R};if(!(0,y.isSuccess)(T))return{kind:p.StructRefKind.RangeOpRef,innerRef:g,resolution:T};var O,M;if(R.value!==void 0)O=R.value.sheet,M=(0,v.gridRangeJoinOpt)(R.value.range,(X=T.value)===null||X===void 0?void 0:X.range);else{if(T.value===void 0)return{kind:p.StructRefKind.RangeOpRef,innerRef:g,resolution:(0,y.failure)((0,C.invalidStructRef)(C.InvalidStructRefReason.InvalidOp))};O=T.value.sheet,M=T.value.range}return{kind:p.StructRefKind.RangeOpRef,innerRef:g,resolution:(0,y.success)((0,S.sheetGridRange)(O,M))}}function J($,Z){var ie,X,Q=Z.qualifier,b=Z.parts,R=(X=(ie=$.config)===null||ie===void 0?void 0:ie.localeInfo)!==null&&X!==void 0?X:B.config.localeInfo,P,A,T,g;if(Q===void 0){var O=$.originSheet;if(!(0,y.isSuccess)(O))return(0,C.resolvedUserDefinedFunc)(Z,O,[],b.asWhole);P=Q,A=(0,y.success)(O.value.document)}else{var M=function(ee,ue){switch(ue.kind){case p.QualifierKind.Document:return k(ee,ue);case p.QualifierKind.Ident:{var ce=(0,p.documentQualifier)(ue.name),he=k(ee,ce),de=Mr(he,2),pe=de[0],_e=de[1];return[(0,p.identQualifier)(pe.document,ue.isQuoted,ue.label),_e]}default:return(0,l.assertNever)("calc.runtime.resolverService.resolveUserDefinedFuncQualifier",ue)}}($,Q),K=Mr(M,2);P=K[0],A=K[1]}var W=b.asWhole;if(I(A))g=A,T=[];else{W=(0,m.getUserDefinedFuncName)(R,b.asWhole);var z=B.getUserDefinedFuncLoc(A.value,W);T=[(0,h.userDefinedFuncLoc)(A.value,W)],g=(0,y.isSuccess)(z)?z.value.length!==0?z:y.successUndefined:z}return(0,C.resolvedUserDefinedFunc)((0,p.nameNode)((0,p.identNamePart)(b.asWhole,b.canDenoteNamedObject,b.label,b.qualifiedLabel),P,Z.label),g,T,W)}return{resolveGridRef:w,resolveCellRef:H,resolveName:L,resolveStructRef:function(Z,ie){var X=ie.lhs,Q=ie.rhs,b,R,P=X;if(X!==void 0){var A=L(Z,X,S.NameSource.StructRef),T=A.node,g=A.resolution,O=A.precedents,M=g;if(!(0,y.isSuccess)(M))return(0,C.resolvedStructRef)(ie,void 0,M,O);if((0,c.isNone)(M.value))return(0,C.resolvedStructRef)(ie,void 0,(0,y.failure)((0,C.invalidStructRef)(C.InvalidStructRefReason.UndefinedTableName)),O);P=T,b=M.value,R=O}else{var K=Z.originGridCell,W=Z.originSheet;if(!(0,y.isSuccess)(K))return(0,C.resolvedStructRef)(ie,void 0,K,[]);if(!(0,y.isSuccess)(W))return(0,C.resolvedStructRef)(ie,void 0,W,[]);if(W.value.index===void 0)return(0,C.resolvedStructRef)(ie,void 0,(0,y.failure)((0,C.invalidStructRef)(C.InvalidStructRefReason.InvalidOriginSheet)),[]);var z=B.getContainingTable((0,S.sheetGridCell)(W.value,K.value));if(!(0,y.isSuccess)(z))return(0,C.resolvedStructRef)(ie,void 0,z,[]);if((0,c.isNone)(z.value))return(0,C.resolvedStructRef)(ie,void 0,(0,y.failure)((0,C.invalidStructRef)(C.InvalidStructRefReason.MissingTableName)),[]);b=z.value,R=[b]}var ee=function(he,de,pe){var _e;switch((_e=pe.innerRef)===null||_e===void 0?void 0:_e.kind){case p.StructRefKind.ColumnRef:{var Ce=D(de,pe.innerRef),Ne=Ce.innerRef,Le=Ce.resolution;return{structRef:(0,p.structRef)(Ne,pe.isClosed,pe.label),resolution:Le}}case p.StructRefKind.RangeOpRef:{var Oe=ne(de,pe.innerRef),le=Oe.innerRef,me=Oe.resolution;return{structRef:(0,p.structRef)(le,pe.isClosed,pe.label),resolution:me}}case void 0:return{structRef:pe,resolution:U(he,de,p.SpecialRefId.Data)};case p.StructRefKind.SpecialRef:return{structRef:pe,resolution:U(he,de,pe.innerRef.id)};case p.StructRefKind.CommaOpRef:{var Pe=function(gr,cr,_r){for(var xr,Or,Rr=_r.refs.map(function(xu){return function(pi,xa,$i){switch($i.kind){case p.StructRefKind.ColumnRef:return D(xa,$i,!0);case p.StructRefKind.SpecialRef:return{kind:p.StructRefKind.SpecialRef,innerRef:$i,resolution:U(pi,xa,$i.id)};case p.StructRefKind.RangeOpRef:return ne(xa,$i,!0);case p.StructRefKind.MissingRef:return{kind:p.StructRefKind.MissingRef,innerRef:$i,resolution:y.successUndefined};case p.StructRefKind.BadRef:return{kind:p.StructRefKind.BadRef,innerRef:$i,resolution:(0,y.failure)((0,C.invalidStructRef)(C.InvalidStructRefReason.InvalidOp))}}}(gr,cr,xu)}),ir=(0,p.commaOpRef)(Rr.map(function(xu){return xu.innerRef}),_r.label),$e=da(Rr),qe;!(qe=$e()).done;){var fr=qe.value,lr=fr.resolution;if(!(0,y.isSuccess)(lr)&&lr.reason.kind!==C.ResolveReasonKind.InvalidStructRef)return{commaOpRef:ir,resolution:lr}}for(var dn=[],Un=da(Rr),Gr;!(Gr=Un()).done;){var Br=Gr.value;if(!(0,y.isSuccess)(Br.resolution)||Br.kind===p.StructRefKind.BadRef)return{commaOpRef:ir,resolution:Br.resolution};dn.push((Br.kind===p.StructRefKind.SpecialRef||(Br.kind,p.StructRefKind.MissingRef),{kind:Br.kind,resolution:Br.resolution}))}if(!(0,v.isCommaOpRefWellFormed)(_r))return{commaOpRef:ir,resolution:(0,y.failure)((0,C.invalidStructRef)(C.InvalidStructRefReason.InvalidOp))};for(var bt,Kr,Pt=0,Mi=dn;Pt<Mi.length;Pt++){var El=Mi[Pt];El.kind===p.StructRefKind.SpecialRef&&(bt=(0,v.gridRangeJoinOpt)(bt,(xr=El.resolution.value)===null||xr===void 0?void 0:xr.range),Kr===void 0&&(Kr=(Or=El.resolution.value)===null||Or===void 0?void 0:Or.sheet))}if(bt===void 0||Kr===void 0)return{commaOpRef:ir,resolution:y.successUndefined};for(var Nl=0,ys=dn;Nl<ys.length;Nl++){var _d=ys[Nl];if(_d.kind!==p.StructRefKind.SpecialRef&&_d.kind!==p.StructRefKind.MissingRef&&(bt=(0,v.gridRangeIsect)(bt,_d.resolution.value.range),bt===void 0))return{commaOpRef:ir,resolution:(0,y.failure)((0,C.invalidStructRef)(C.InvalidStructRefReason.InvalidOp))}}return{commaOpRef:ir,resolution:(0,y.success)((0,S.sheetGridRange)(Kr,bt))}}(he,de,pe.innerRef),Re=Pe.commaOpRef,fe=Pe.resolution;return{structRef:(0,p.structRef)(Re,pe.isClosed,pe.label),resolution:fe}}case p.StructRefKind.ThisRowOpRef:{var Se=U(he,de,p.SpecialRefId.ThisRow);if(I(Se)||pe.innerRef.ref===void 0)return{structRef:pe,resolution:Se};var be=pe.innerRef.ref.kind===p.StructRefKind.ColumnRef?D(de,pe.innerRef.ref):ne(de,pe.innerRef.ref),xe=be.innerRef,Ie=be.resolution,Ve=(0,p.thisRowOpRef)(xe,xe.label);if(I(Ie))return{structRef:(0,p.structRef)(Ve,pe.isClosed,pe.label),resolution:Ie};var Ze=(0,v.gridRangeIsect)(Se.value.range,Ie.value.range);return Ze?{structRef:(0,p.structRef)(Ve,pe.isClosed,pe.label),resolution:(0,y.success)((0,S.sheetGridRange)(Se.value.sheet,Ze))}:{structRef:pe,resolution:(0,y.failure)((0,C.invalidStructRef)(C.InvalidStructRefReason.InvalidOp))}}case p.StructRefKind.BadRef:return{structRef:pe,resolution:(0,y.failure)((0,C.invalidStructRef)(C.InvalidStructRefReason.InvalidOp))}}}(Z,b,Q),ue=ee.structRef,ce=ee.resolution;return(0,C.resolvedStructRef)(ce.kind===y.ResultKind.Failure&&ce.reason.kind!==C.ResolveReasonKind.EmptyIntersection?ie:(0,p.structRefNode)(P,ue,ie.label),b,ce,R)},resolveUserDefinedFunc:J,resolveDottedName:function(Z,ie,X){var Q,b=ie.qualifier,R=ie.parts,P=[],A={names:new Array,udfs:new Array},T=X[ie.label],g,O=(T==null?void 0:T.kind)===p.AnnotationKind.AppHeadName;if(!b){var M=(0,p.headNamePart)(R);if(M.kind===p.NamePartKind.IdentNamePart){var K=function(pe,_e){var Ce=_e[pe.label];return(Ce==null?void 0:Ce.kind)===p.AnnotationKind.LocalNameUse?(0,C.resolvedLocalName)((0,p.nameNode)((0,p.identNamePart)(Ce.whole,pe.canDenoteNamedObject,pe.label,pe.qualifiedLabel),void 0,pe.qualifiedLabel),(0,y.success)(Ce)):(0,C.resolvedLocalName)((0,p.nameNode)((0,p.identNamePart)(pe.asWhole,pe.canDenoteNamedObject,pe.label,pe.qualifiedLabel),void 0,pe.qualifiedLabel),y.successUndefined)}(M,X);if(K.resolution.value!==void 0){var W=Cxe((0,p.flattenNameParts)(R).parts),z=W.slice(1),ee=z.map(function(pe){var _e=pe.rhs;return(_e==null?void 0:_e.field.kind)===p.NodeKind.Name?_e.field.whole:void 0}).filter(function(pe){return pe!==void 0});if(ee.length===z.length)return(0,C.resolvedDottedName)(K,ee,A)}}}for(;;){if(R.canDenoteNamedObject){var ue=(0,p.nameNode)((0,p.identNamePart)(R.asWhole,R.canDenoteNamedObject,R.label,R.qualifiedLabel),b,R.qualifiedLabel),ce=L(Z,ue,O?S.NameSource.AppHead:S.NameSource.Plain);if(g=(0,C.resolvedDottedName)(ce,[].concat(P).reverse(),A),(0,s.safePush)(A.names,ce.precedents),!(0,y.isSuccess)(ce.resolution)&&ce.resolution.reason.kind!==C.ResolveReasonKind.InvalidQualifier||(0,y.isSuccess)(ce.resolution)&&ce.resolution.value!==void 0)return g;if(O&&(b===void 0||b.kind===p.QualifierKind.Document||b.kind===p.QualifierKind.Ident)){var he=J(Z,ue);if(g=(0,C.resolvedDottedName)(he,[].concat(P).reverse(),A),(0,s.safePush)(A.udfs,he.precedents),!(0,y.isSuccess)(he.resolution)&&he.resolution.reason.kind!==C.ResolveReasonKind.InvalidQualifier||(0,y.isSuccess)(he.resolution)&&he.resolution.value!==void 0)return g}}if(R.kind===p.NamePartKind.CellRefNamePart&&(b==null&&Z.allowUnqualifiedCell||b!=null&&b.kind!==p.QualifierKind.Document)){var de=H(Z,(0,p.cellRefNode)(R.ref,b!=null&&b.kind===p.QualifierKind.Ident?(0,p.sheetQualifier)(b.name):b,R.qualifiedLabel));return(0,C.resolvedDottedName)(de,[].concat(P).reverse(),A)}if(R.kind!==p.NamePartKind.FieldRefNamePart||((Q=R.rhs)===null||Q===void 0?void 0:Q.field.kind)!==p.NodeKind.Name)return g!==void 0?g:(0,C.resolvedDottedName)((0,C.resolvedNever)((0,p.nameNode)((0,p.identNamePart)(R.asWhole,R.canDenoteNamedObject,R.label,R.qualifiedLabel),b,R.qualifiedLabel)),[].concat(P).reverse(),A);P.push(R.rhs.field.whole),R=R.lhs,O=!1}}}}},4388:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolvedDottedName=t.resolvedNever=t.resolvedStructRef=t.resolvedLocalName=t.resolvedUserDefinedFunc=t.resolvedCellRef=t.resolvedName=t.ResolvedKind=t.emptyIntersection=t.invalidStructRef=t.InvalidStructRefReason=t.invalidCellRef=t.InvalidCellRefReason=t.invalidQualifier=t.InvalidQualifierReason=t.noOriginSheet=t.ResolveReasonKind=t.resolveLocalsGrid=void 0;var s=d(6903),c=d(5385),l,f,p,m;t.resolveLocalsGrid=function(v){return{originGridCell:(0,s.success)(v.range),originSheet:(0,s.success)(v.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}},function(v){v.NoOriginSheet="NoOriginSheet",v.InvalidQualifier="InvalidQualifier",v.InvalidCellRef="InvalidCellRef",v.InvalidStructRef="InvalidStructRef",v.EmptyIntersection="EmptyIntersection"}(l=t.ResolveReasonKind||(t.ResolveReasonKind={})),t.noOriginSheet=function(v){return{kind:l.NoOriginSheet,origin:v}},(m=t.InvalidQualifierReason||(t.InvalidQualifierReason={})).UndefinedDocument="UndefinedDocument",m.UndefinedSheetName="UndefinedSheetName",m.SheetRangeName="SheetRangeName",m.DocumentCellRef="DocumentCellRef",m.BadQualifier="BadQualifier",t.invalidQualifier=function(v){return{kind:l.InvalidQualifier,reason:v}},(t.InvalidCellRefReason||(t.InvalidCellRefReason={})).BadCellRef="BadCellRef",t.invalidCellRef=function(v){return{kind:l.InvalidCellRef,reason:v}},(p=t.InvalidStructRefReason||(t.InvalidStructRefReason={})).UndefinedColumnName="UndefinedColumnName",p.UndefinedTableName="UndefinedTableName",p.InvalidOriginSheet="InvalidOriginSheet",p.InvalidOp="InvalidOp",p.MissingTableName="MissingTableName",p.NamedObjectNotTable="NamedObjectNotTable",t.invalidStructRef=function(v){return{kind:l.InvalidStructRef,reason:v}},t.emptyIntersection={kind:l.EmptyIntersection},function(v){v.ResolvedName="ResolvedName",v.ResolvedCellRef="ResolvedCellRef",v.ResolvedUserDefinedFunc="ResolvedUserDefinedFunc",v.ResolvedLocalName="ResolvedLocalName",v.ResolvedStructRef="ResolvedStructRef",v.ResolvedNever="ResolvedNever",v.ResolvedDottedName="ResolvedDottedName"}(f=t.ResolvedKind||(t.ResolvedKind={})),t.resolvedName=(0,c.typedInstanceCreator)()(function(v,h,S){return{kind:f.ResolvedName,node:v,resolution:h,precedents:S}}),t.resolvedCellRef=(0,c.typedInstanceCreator)()(function(v,h){return{kind:f.ResolvedCellRef,node:v,resolution:h}}),t.resolvedUserDefinedFunc=(0,c.typedInstanceCreator)()(function(v,h,S,y){return{kind:f.ResolvedUserDefinedFunc,node:v,resolution:h,precedents:S,name:y}}),t.resolvedLocalName=(0,c.typedInstanceCreator)()(function(v,h){return{kind:f.ResolvedLocalName,node:v,resolution:h}}),t.resolvedStructRef=(0,c.typedInstanceCreator)()(function(v,h,S,y){return{kind:f.ResolvedStructRef,node:v,table:h,resolution:S,precedents:y}}),t.resolvedNever=(0,c.typedInstanceCreator)()(function(v){return{kind:f.ResolvedNever,node:v,resolution:s.successUndefined}}),t.resolvedDottedName=(0,c.typedInstanceCreator)()(function(v,h,S){return{kind:f.ResolvedDottedName,resolved:v,fields:h,precedents:S}})},9431:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWorksheetFuncEnglishName=t.getWorksheetFuncType=t.getOperatorType=t.operatorStrings=t.OperatorId=t.higherOrderFunctionType=t.unknownFunctionType=t.WorksheetFuncId=void 0;var s=d(7161),c=d(5511);Object.defineProperty(t,"WorksheetFuncId",{enumerable:!0,get:function(){return c.WorksheetFuncId}});var l=d(9124),f;t.unknownFunctionType=(0,s.functionType)(0,254,[],[s.SignatureType.All],[],s.SignatureType.All,s.SpecialPrecs.All,s.FunctionFlags.None),t.higherOrderFunctionType=function(){var k=s.OperKind.Number|s.OperKind.String|s.OperKind.Boolean|s.OperKind.Rich|s.OperKind.Error|s.OperKind.Blank|((0,l.isFeatureEnabled)(l.FeatureName.CalcLambdaCellValues)?0:s.OperKind.Range)|((0,l.isFeatureEnabled)(l.FeatureName.CalcLambdaArrayLifting)?0:s.OperKind.Array),x=s.OperKind.Number|s.OperKind.String|s.OperKind.Boolean|s.OperKind.Rich|s.OperKind.Error|s.OperKind.Blank|s.OperKind.Missing|s.OperKind.Array|s.OperKind.Range;return(0,s.functionType)(1,255,[k],[x],[],s.SignatureType.All,s.SpecialPrecs.None,s.FunctionFlags.Allow3dRef)},function(k){k[k.Add=1]="Add",k[k.Sub=2]="Sub",k[k.Mul=3]="Mul",k[k.Div=4]="Div",k[k.Pow=5]="Pow",k[k.Percent=6]="Percent",k[k.Neg=7]="Neg",k[k.Pos=8]="Pos",k[k.Concat=9]="Concat",k[k.Eq=10]="Eq",k[k.Ne=11]="Ne",k[k.Lt=12]="Lt",k[k.Le=13]="Le",k[k.Gt=14]="Gt",k[k.Ge=15]="Ge",k[k.Range=16]="Range",k[k.Isect=17]="Isect",k[k.Union=18]="Union",k[k.And=19]="And",k[k.Or=20]="Or",k[k.Xor=21]="Xor",k[k.Min=22]="Min",k[k.Max=23]="Max",k[k.At=24]="At",k[k.Pound=25]="Pound"}(f=t.OperatorId||(t.OperatorId={})),t.operatorStrings=[void 0,"+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":",void 0,void 0,"&&","||","^^",void 0,void 0,"@","#"];var p=s.OperKind.Number|s.OperKind.String|s.OperKind.Boolean|s.OperKind.Blank,m=s.OperKind.Number|s.OperKind.String|s.OperKind.Boolean|s.OperKind.Blank,v=(0,s.functionType)(2,2,[s.OperKind.Number,s.OperKind.Number],[],[],s.OperKind.Number,s.SpecialPrecs.None,s.FunctionFlags.None),h=(0,s.functionType)(1,1,[s.OperKind.Number],[],[],s.OperKind.Number,s.SpecialPrecs.None,s.FunctionFlags.None),S=(0,s.functionType)(1,1,[p],[],[],p,s.SpecialPrecs.None,s.FunctionFlags.None),y=(0,s.functionType)(2,2,[s.OperKind.String,s.OperKind.String],[],[],s.OperKind.String,s.SpecialPrecs.None,s.FunctionFlags.None),C=(0,s.functionType)(2,2,[m,m],[],[],s.OperKind.Boolean,s.SpecialPrecs.None,s.FunctionFlags.None),E=(0,s.functionType)(2,2,[s.OperKind.Range,s.OperKind.Range],[],[],s.OperKind.Range,s.SpecialPrecs.AllCells,s.FunctionFlags.None),I=(0,s.functionType)(2,2,[s.OperKind.Range,s.OperKind.Range],[],[],s.OperKind.Range,s.SpecialPrecs.None,s.FunctionFlags.None),F=(0,s.functionType)(2,2,[s.OperKind.Boolean,s.OperKind.Boolean],[],[],s.OperKind.Boolean,s.SpecialPrecs.None,s.FunctionFlags.None),w=[];function B(k,x){var G=c.worksheetFuncTypes[k];G!=null&&(G.staticPrecs=x)}w[f.Add]=v,w[f.Sub]=v,w[f.Mul]=v,w[f.Div]=v,w[f.Pow]=v,w[f.Percent]=h,w[f.Neg]=h,w[f.At]=c.worksheetFuncTypes[c.WorksheetFuncId.SINGLE],w[f.Pound]=c.worksheetFuncTypes[c.WorksheetFuncId.ANCHORARRAY],w[f.Pos]=S,w[f.Concat]=y,w[f.Eq]=C,w[f.Ne]=C,w[f.Lt]=C,w[f.Le]=C,w[f.Gt]=C,w[f.Ge]=C,w[f.Range]=E,w[f.Isect]=I,w[f.Union]=I,w[f.And]=F,w[f.Or]=F,w[f.Xor]=F,w[f.Min]=v,w[f.Max]=v,t.getOperatorType=function(k){var x=w[k];return x??t.unknownFunctionType},t.getWorksheetFuncType=function(k){var x=c.worksheetFuncTypes[k];return x??t.unknownFunctionType},t.getWorksheetFuncEnglishName=function(k){return c.worksheetFuncEnglishNames[k]},B(c.WorksheetFuncId.ROW,s.SpecialPrecs.OwnRow),B(c.WorksheetFuncId.COLUMN,s.SpecialPrecs.OwnCol),B(c.WorksheetFuncId.SHEET,s.SpecialPrecs.OwnDocSheets),B(c.WorksheetFuncId.SHEETS,s.SpecialPrecs.OwnDocSheets),B(c.WorksheetFuncId.OFFSET,s.SpecialPrecs.AllCells),B(c.WorksheetFuncId.INDIRECT,s.SpecialPrecs.AllCells),B(c.WorksheetFuncId.SUMIF,s.SpecialPrecs.AllCells),B(c.WorksheetFuncId.AVERAGEIF,s.SpecialPrecs.AllCells),B(c.WorksheetFuncId.LOOKUP,s.SpecialPrecs.AllCells),B(c.WorksheetFuncId.ADDRESS,s.SpecialPrecs.RefStyle),B(c.WorksheetFuncId.FORMULATEXT,s.SpecialPrecs.RefStyle),B(c.WorksheetFuncId.NOW,s.SpecialPrecs.Time),B(c.WorksheetFuncId.TODAY,s.SpecialPrecs.Time),B(c.WorksheetFuncId.RAND,s.SpecialPrecs.Calc),B(c.WorksheetFuncId.RANDBETWEEN,s.SpecialPrecs.Calc),B(c.WorksheetFuncId.RANDARRAY,s.SpecialPrecs.Calc),B(c.WorksheetFuncId.SUBTOTAL,s.SpecialPrecs.CellProps),B(c.WorksheetFuncId.CELL,s.SpecialPrecs.CellProps|s.SpecialPrecs.AllCells),B(c.WorksheetFuncId.INFO,s.SpecialPrecs.None)},9585:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.poundNode=t.atNode=t.maxNode=t.minNode=t.xorNode=t.orNode=t.andNode=t.unionNode=t.isectNode=t.rangeNode=t.geNode=t.gtNode=t.leNode=t.ltNode=t.neNode=t.eqNode=t.concatNode=t.posNode=t.negNode=t.percentNode=t.powNode=t.divNode=t.mulNode=t.subNode=t.addNode=t.badBracketNode=t.badQualNode=t.badCellRefNode=t.badMissingNode=t.badParamNameNode=t.badFieldNameNode=t.badErrorLiteralNode=t.badStringLiteralNode=t.badNumberLiteralNode=t.badUnexpNode=t.badFieldRefNode=t.badStructRefNode=t.badSeqNode=t.absPos=t.relPos=t.expectTrue=t.isNameLocEqual=t.createSingleRange=t.sheet1=t.sheet1Name=t.document1=void 0;var s=d(342),c=d(8479),l=d(4333),f=d(9431);function p(h){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(0,l.badNode)(l.BadType.Sequence,h,S)}function m(h){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(0,l.badNode)(l.BadType.Unexpected,h,S)}function v(h){return function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return(0,l.operatorNode)(h,S)}}t.document1=(0,s.documentLoc)(void 0,"Book1"),t.sheet1Name="Sheet1",t.sheet1=(0,s.sheetIndex)(t.document1,0),t.createSingleRange=function(h,S){var y=(0,s.gridCell)(h,S);return(0,s.sheetGridCell)(t.sheet1,y)},t.isNameLocEqual=function(h,S,y){return(0,c.isNameScopeEqual)(S.scope,y.scope)&&h.stringCompareCI(S.name,y.name)===0},t.expectTrue=function(h){expect(h).toBeTruthy()},t.relPos=function(h){return(0,l.pos)(l.PosKind.Rel,h)},t.absPos=function(h){return(0,l.pos)(l.PosKind.Abs,h)},t.badSeqNode=p,t.badStructRefNode=function(h){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(0,l.badNode)(l.BadType.StructRef,h,S)},t.badFieldRefNode=function(h){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(0,l.badNode)(l.BadType.FieldRef,h,S)},t.badUnexpNode=m,t.badNumberLiteralNode=function(h){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(0,l.badNode)(l.BadType.NumberLiteral,h,S)},t.badStringLiteralNode=function(h){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(0,l.badNode)(l.BadType.StringLiteral,h,S)},t.badErrorLiteralNode=function(h){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(0,l.badNode)(l.BadType.ErrorLiteral,h,S)},t.badFieldNameNode=function(h){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(0,l.badNode)(l.BadType.FieldName,h,S)},t.badParamNameNode=function(h){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(0,l.badNode)(l.BadType.ParamName,h,S)},t.badMissingNode=function(h){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(0,l.badNode)(l.BadType.Missing,h,S)},t.badCellRefNode=function(h){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h.indexOf("[")>=0,y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,C=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return(0,l.cellRefNode)((0,l.cellRefBad)(h,S,y),void 0,C)},t.badQualNode=function(h){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(0,l.badNode)(l.BadType.Qualifier,h,S)},t.badBracketNode=function(h){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,y=[m("["),h];return S&&y.push(m("]")),p(y)},t.addNode=v(f.OperatorId.Add),t.subNode=v(f.OperatorId.Sub),t.mulNode=v(f.OperatorId.Mul),t.divNode=v(f.OperatorId.Div),t.powNode=v(f.OperatorId.Pow),t.percentNode=v(f.OperatorId.Percent),t.negNode=v(f.OperatorId.Neg),t.posNode=v(f.OperatorId.Pos),t.concatNode=v(f.OperatorId.Concat),t.eqNode=v(f.OperatorId.Eq),t.neNode=v(f.OperatorId.Ne),t.ltNode=v(f.OperatorId.Lt),t.leNode=v(f.OperatorId.Le),t.gtNode=v(f.OperatorId.Gt),t.geNode=v(f.OperatorId.Ge),t.rangeNode=v(f.OperatorId.Range),t.isectNode=v(f.OperatorId.Isect),t.unionNode=v(f.OperatorId.Union),t.andNode=v(f.OperatorId.And),t.orNode=v(f.OperatorId.Or),t.xorNode=v(f.OperatorId.Xor),t.minNode=v(f.OperatorId.Min),t.maxNode=v(f.OperatorId.Max),t.atNode=v(f.OperatorId.At),t.poundNode=v(f.OperatorId.Pound)},7161:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionType=t.FunctionFlags=t.SpecialPrecs=t.SignatureType=t.OperKind=void 0;var s=d(637),c,l,f,p,m=s.assertions.assertNatural,v=s.assertions.assertFalse,h=s.assertions.assertIndex;(p=t.OperKind||(t.OperKind={}))[p.Number=1]="Number",p[p.String=2]="String",p[p.Boolean=4]="Boolean",p[p.Error=8]="Error",p[p.Range=16]="Range",p[p.Array=32]="Array",p[p.Missing=64]="Missing",p[p.Blank=128]="Blank",p[p.Rich=256]="Rich",(f=t.SignatureType||(t.SignatureType={}))[f.None=0]="None",f[f.Goto=512]="Goto",f[f.Ref3D=1024]="Ref3D",f[f.All=2047]="All",(l=t.SpecialPrecs||(t.SpecialPrecs={}))[l.None=0]="None",l[l.OwnDoc=1]="OwnDoc",l[l.OwnSheet=2]="OwnSheet",l[l.OwnRow=4]="OwnRow",l[l.OwnCol=8]="OwnCol",l[l.OwnRowCopy=16]="OwnRowCopy",l[l.OwnColCopy=32]="OwnColCopy",l[l.OwnDocSheets=64]="OwnDocSheets",l[l.CellProps=128]="CellProps",l[l.AllCells=256]="AllCells",l[l.AllNames=512]="AllNames",l[l.Time=1024]="Time",l[l.Calc=2048]="Calc",l[l.InFilterMode=4096]="InFilterMode",l[l.RefStyle=8192]="RefStyle",l[l.All=16383]="All",(c=t.FunctionFlags||(t.FunctionFlags={}))[c.None=0]="None",c[c.Dark=1]="Dark",c[c.Macro=2]="Macro",c[c.OnlyParsedDuringLoad=4]="OnlyParsedDuringLoad",c[c.Internal=8]="Internal",c[c.Allow3dRef=16]="Allow3dRef",c[c.HiddenFromUI=32]="HiddenFromUI",t.functionType=function(S,y,C,E,I,F,w,B){if(m("calc.lang.functionType",y),h("calc.lang.functionType",S,y+1),E.length===0?I.length!==0:I.length>=E.length){var k=JSON.stringify(I);v("calc.lang.functionType: expected tailTypes.length < restTypes.length; given "+k)}if(E.length===0&&C.length+I.length<y){var x=JSON.stringify(C);v("calc.lang.functionType: expected headTypes.length + tailTypes.length >= "+y+"; given "+x)}return{minArgs:S,maxArgs:y,headTypes:C,restTypes:E,tailTypes:I,returnType:F,staticPrecs:w,flags:B}}},8479:function(u,t,d){"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0}),t.isReadOperEqual=t.isWriteOper=t.isPrimitiveOper=t.isRichOper=t.isBlankOper=t.isMissingOper=t.isArrayOper=t.isRangeOper=t.isErrorOper=t.isBooleanOper=t.isStringOper=t.isNumberOper=t.shouldFieldRefBeBracketed=t.isValidArgsLength=t.getArgType=t.isBooleanNode=t.isNumberNode=t.isMissingNode=t.isUnqualifiedNameNode=t.isWSFNode=t.isOperatorNode=t.getArguments=t.getSubExpressionFromPosition=t.gridCellRange=t.sheetGridRangeAnchor=t.gridRangeAnchor=t.isSheetGridRangeEqual=t.isSheetGridCellEqual=t.isGridRangeEqual=t.isGridCellEqual=t.isNameScopeEqual=t.sheetRangeToSheetIndex=t.isSheetIndexEqual=t.isDocumentLocEqual=t.gridRangeSize=t.gridRangeExcept=t.gridRangeCompare=t.gridCellImplicitIsect=t.gridRangeIsects=t.gridRangeIsect=t.gridRangesJoin=t.gridRangeJoinOpt=t.gridRangeJoin=t.forEachTileInRange=t.forEachCellInRange=t.isWellFormed=t.isSheetGridRange=t.isSheetIndex=t.isSheetGridCell=t.isGridCell=void 0,t.applyComparison=t.normalizeCommaOpRef=t.isRangeOpNoMissing=t.isRangeOpClosed=t.isCommaOpNoBadOrMissing=t.isCommaOpClosed=t.isCommaOpRefWellFormed=t.getBoundName=t.getUserDefinedFuncName=t.getWorksheetFuncId=t.createFailureErrorClass=t.internal=t.unavailable=t.notImplemented=t.ReasonKind=t.LangReasonKind=void 0;var c=d(8660),l=d(342);Object.defineProperty(t,"isGridCell",{enumerable:!0,get:function(){return l.isGridCell}}),Object.defineProperty(t,"isSheetGridCell",{enumerable:!0,get:function(){return l.isSheetGridCell}});var f=d(4333),p=d(7161),m=d(6903),v=d(5385),h=d(6553),S=d(9431),y=d(342);function C(T,g){var O=T.row,M=T.col,K=T.rows,W=T.cols,z=g.row,ee=g.col,ue=g.rows,ce=g.cols,he=(0,v.fastMin)(O,z),de=(0,v.fastMin)(M,ee),pe=(0,v.fastMax)(O+K,z+ue)-he,_e=(0,v.fastMax)(M+W,ee+ce)-de;return(0,l.unsafeGridRange)(he,de,pe,_e)}function E(T,g){return T===g||T.name===g.name&&T.path===g.path}function I(T,g){return E(T.document,g.document)&&T.index===g.index}function F(T,g){return T.row===g.row&&T.col===g.col}function w(T,g){return T.row===g.row&&T.col===g.col&&T.rows===g.rows&&T.cols===g.cols}function B(T){return(0,l.isGridCell)(T)?T:(0,l.unsafeGridRange)(T.row,T.col,1,1)}Object.defineProperty(t,"isSheetIndex",{enumerable:!0,get:function(){return y.isSheetIndex}}),Object.defineProperty(t,"isSheetGridRange",{enumerable:!0,get:function(){return y.isSheetGridRange}}),t.isWellFormed=function(T){return T.isWellFormed},t.forEachCellInRange=function(T,g){if((0,l.isGridCell)(T))return g(T,0,0);for(var O=T.row,M=T.rows,K=T.col,W=T.cols,z=0;z<M;z+=1)for(var ee=0;ee<W;ee+=1)if(!g((0,l.gridCell)(O+z,K+ee),z,ee))return!1;return!0},t.forEachTileInRange=function(T,g,O){var M=T.row,K=T.rows,W=T.col,z=T.cols;(0,c.assertPositiveInteger)("calc.lang.forEachTileInRange",g),(0,c.assertIndex)("calc.lang.forEachTileInRange",M,l.sheetRows),(0,c.assertIndex)("calc.lang.forEachTileInRange",W,l.sheetCols),(0,c.assertPositiveLength)("calc.lang.forEachTileInRange",K,l.sheetRows-M),(0,c.assertPositiveLength)("calc.lang.forEachTileInRange",z,l.sheetCols-W);for(var ee=M;ee<M+K;ee+=g)for(var ue=W;ue<W+z;ue+=g)if(!O((0,l.unsafeGridRange)(ee,ue,(0,v.fastMin)(g,K+M-ee),(0,v.fastMin)(g,z+W-ue))))return!1;return!0},t.gridRangeJoin=C,t.gridRangeJoinOpt=function(T,g){return T?g?C(T,g):T:g},t.gridRangesJoin=function(T){return T.length===0&&(0,c.assertFalse)("calc.runtime.gridRangesJoin: expected nonempty range array"),T.reduce(C)},t.gridRangeIsect=function(T,g){var O=T.row,M=T.col,K=T.rows,W=T.cols,z=g.row,ee=g.col,ue=g.rows,ce=g.cols,he=(0,v.fastMax)(O,z),de=(0,v.fastMax)(M,ee),pe=(0,v.fastMin)(O+K,z+ue)-he,_e=(0,v.fastMin)(M+W,ee+ce)-de;if(!(pe<=0||_e<=0))return(0,l.unsafeGridRange)(he,de,pe,_e)},t.gridRangeIsects=function(T,g){var O=T.row,M=T.col,K=T.rows,W=T.cols,z=g.row,ee=g.col,ue=g.rows,ce=g.cols;return(0,v.fastMax)(O,z)<(0,v.fastMin)(O+K,z+ue)&&(0,v.fastMax)(M,ee)<(0,v.fastMin)(M+W,ee+ce)},t.gridCellImplicitIsect=function(T,g){var O=T.row,M=T.col,K=g.row,W=g.col,z=g.rows,ee=g.cols,ue=K<=O&&O<K+z,ce=W<=M&&M<W+ee;return ue&&ce?(0,l.gridCell)(O,M):ue&&ee===1?(0,l.gridCell)(O,W):ce&&z===1?(0,l.gridCell)(K,M):ee===1&&z===1?(0,l.gridCell)(K,W):void 0},t.gridRangeCompare=function(T,g){var O=T.row,M=T.col,K=T.rows,W=T.cols,z=g.row,ee=g.col,ue=g.rows,ce=g.cols,he=O+K,de=z+ue,pe=M+W,_e=ee+ce;return O===z&&he===de&&M===ee&&pe===_e?0:O<=z&&he>=de&&M<=ee&&pe>=_e?1:O>=z&&he<=de&&M>=ee&&pe<=_e?-1:void 0},t.gridRangeExcept=function(T,g){var O=[T.row,T.row+T.rows],M=[T.col,T.col+T.cols],K=[g.row,g.row+g.rows],W=[g.col,g.col+g.cols],z=(0,h.ivlCompare)(O,K),ee=(0,h.ivlCompare)(M,W);if(z!==void 0&&z<=0){var ue=(0,h.ivlExcept)(M,W);if(ue!==void 0)return(0,l.gridRange)(T.row,ue[0],T.rows,ue[1]-ue[0])}if(ee!==void 0&&ee<=0){var ce=(0,h.ivlExcept)(O,K);if(ce!==void 0)return(0,l.gridRange)(ce[0],T.col,ce[1]-ce[0],T.cols)}},t.gridRangeSize=function(T){return T.rows*T.cols},t.isDocumentLocEqual=E,t.isSheetIndexEqual=I,t.sheetRangeToSheetIndex=function(T){if(T.index===T.index2)return _i(_i({},T),{__isRange:!1})},t.isNameScopeEqual=function(T,g){return E(T.document,g.document)&&T.index===g.index},t.isGridCellEqual=F,t.isGridRangeEqual=w,t.isSheetGridCellEqual=function(T,g){return I(T.sheet,g.sheet)&&F(T.range,g.range)},t.isSheetGridRangeEqual=function(T,g){return I(T.sheet,g.sheet)&&w(T.range,g.range)},t.gridRangeAnchor=B,t.sheetGridRangeAnchor=function(T){return(0,l.isSheetGridCell)(T)?T:(0,l.sheetGridCell)(T.sheet,B(T.range))},t.gridCellRange=function(T,g){var O=T.row,M=T.col,K=g.row,W=g.col;return(0,l.unsafeGridRange)((0,v.fastMin)(O,K),(0,v.fastMin)(M,W),Math.abs(K-O)+1,Math.abs(W-M)+1)},t.getSubExpressionFromPosition=function(T,g){function O(Ce){var Ne=T.spans[Ce.label];return Ne!==void 0&&Ne.start<=g&&g<Ne.end}for(var M=T.node,K=!0;K;)switch(K=!1,M.kind){case f.NodeKind.Array:for(var W=M.nodes,z=W.length-1;!K&&z>=0;z-=1)for(var ee=W[z],ue=ee.length-1;!K&&ue>=0;ue-=1){var ce=ee[ue];O(ce)&&(M=ce,K=!0)}break;case f.NodeKind.App:case f.NodeKind.Let:case f.NodeKind.Lambda:for(var he=M.args.map(function(Ce){return Ce.kind===f.NodeKind.Param?Ce.name.name:Ce}),de=he.length-1;!K&&de>=0;de-=1){var pe=he[de];O(pe)&&(M=pe,K=!0)}break;case f.NodeKind.Paren:{var _e=M.node;O(_e)&&(M=_e,K=!0)}break;case f.NodeKind.Bad:case f.NodeKind.Name:case f.NodeKind.CellRef:case f.NodeKind.StructRef:case f.NodeKind.Literal:break;case f.NodeKind.FieldRef:O(M.lhs)&&(M=M.lhs,K=!0);break;default:(0,c.assertNever)("getSubExpressionFromPosition",M)}return M};var k=[];function x(T){return T.kind===f.NodeKind.Literal&&D(T.oper)}function G(T){return T.kind===f.NodeKind.Literal&&L(T.oper)}function H(T){return T.kind===p.OperKind.Number}function L(T){return T.kind===p.OperKind.Boolean}function D(T){return T.kind===p.OperKind.Missing}t.getArguments=function(T){return function(g){return g.args.length===1&&x(g.args[0])?0:g.args.length}(T)===0?k:T.args},t.isOperatorNode=function(T){return T.kind===f.NodeKind.Operator},t.isWSFNode=function(T){return T.kind===f.NodeKind.WSF},t.isUnqualifiedNameNode=function(T){return T.kind===f.NodeKind.Name&&T.qualifier===void 0},t.isMissingNode=x,t.isNumberNode=function(T){return T.kind===f.NodeKind.Literal&&H(T.oper)},t.isBooleanNode=G,t.getArgType=function(T,g,O){var M=T.maxArgs,K=T.headTypes,W=T.restTypes,z=T.tailTypes;if((0,c.assertPositiveInteger)("calc.runtime.getArgType: n",O),(0,c.assertIndex)("calc.runtime.getArgType: i",g,O),g>=M)return p.SignatureType.None;if(g<K.length)return K[g];if(W.length===0)return p.SignatureType.None;if(g<K.length+W.length)return W[g-K.length];var ee=(O-K.length)%W.length;return ee>z.length?p.SignatureType.None:g>=O-ee?z[g-(O-ee)]:W[(g-K.length)%W.length]},t.isValidArgsLength=function(T,g){var O=T.minArgs,M=T.maxArgs,K=T.headTypes,W=T.restTypes,z=T.tailTypes;return!(g<O||g>M)&&(g<=K.length+W.length||W.length!==0&&(g-K.length)%W.length<=z.length)},t.shouldFieldRefBeBracketed=function(T,g,O){return O.length>0&&g.field.kind===f.NodeKind.Name&&(G(T)||T.kind===f.NodeKind.Name||T.kind===f.NodeKind.CellRef)},t.isNumberOper=H,t.isStringOper=function(T){return T.kind===p.OperKind.String},t.isBooleanOper=L,t.isErrorOper=function(T){return T.kind===p.OperKind.Error},t.isRangeOper=function(T){return T.kind===p.OperKind.Range},t.isArrayOper=function(T){return T.kind===p.OperKind.Array},t.isMissingOper=D,t.isBlankOper=function(T){return T.kind===p.OperKind.Blank},t.isRichOper=function(T){return T.kind===p.OperKind.Rich};var U=p.OperKind.Number|p.OperKind.String|p.OperKind.Boolean;t.isPrimitiveOper=function(T){return(T.kind&U)!=0};var V=U|p.OperKind.Error|p.OperKind.Array|p.OperKind.Rich,ne;t.isWriteOper=function(T){return(T.kind&V)!=0},t.isReadOperEqual=function T(g,O,M,K){if(M.kind!==O.kind)return!1;switch(M.kind){case p.OperKind.Boolean:case p.OperKind.String:return M.value===O.value;case p.OperKind.Number:return g.cond2(M,O)===0;case p.OperKind.Error:return M.type===O.type;case p.OperKind.Rich:return K;case p.OperKind.Array:var W=O;if(M.cols!==W.cols||M.rows!==W.rows)return!1;for(var z=0;z<M.rows;z+=1)for(var ee=M.opers[z],ue=W.opers[z],ce=0;ce<M.cols;ce+=1)if(!T(g,ue[ce],ee[ce],K))return!1;return!0;case p.OperKind.Blank:return!0;default:return(0,c.assertNever)("calc.lang.readOperEq",M)}},function(T){T.NotImplemented="NotImplemented",T.Unavailable="Unavailable",T.Internal="Internal"}(ne=t.LangReasonKind||(t.LangReasonKind={})),t.ReasonKind=_i(_i({},m.ReasonKind),ne),t.notImplemented=function(T){return{kind:t.ReasonKind.NotImplemented,features:T}},t.unavailable=function(T){return T.length===0&&(0,c.assertFalse)("calc.lang.unavailable: expected nonempty array"),{kind:t.ReasonKind.Unavailable,objects:T}},t.internal=function(T){return{kind:t.ReasonKind.Internal,message:T}},t.createFailureErrorClass=function(T){var g=function(M){this.reason=M,this.name=T,this.stack=T,this.message=M.kind};return(g.prototype=Object.create(Error.prototype)).constructor=g,g};var J="_xlfn.",$="_xlws.";t.getWorksheetFuncId=function(T,g){var O=g;return O.length>J.length&&T.stringCompareCI(O.substring(0,J.length),J)===0&&(O=O.substring(J.length),O.length>$.length&&T.stringCompareCI(O.substring(0,$.length),$)===0&&(O=O.substring($.length))),T.getWorksheetFuncId(O)};var Z="_xludf.";t.getUserDefinedFuncName=function(T,g){var O=g;return O.length>Z.length&&T.stringCompareCI(O.substring(0,Z.length),Z)===0&&(O=O.substring(Z.length)),O};var ie="_xlpm.";function X(T){return T.kind!==f.StructRefKind.SpecialRef&&T.kind!==f.StructRefKind.BadRef||T.isBracketed}function Q(T){return T.kind===f.StructRefKind.MissingRef||T.kind===f.StructRefKind.BadRef}function b(T){switch(T.kind){case f.StructRefKind.SpecialRef:case f.StructRefKind.ColumnRef:return T.isClosed;case f.StructRefKind.RangeOpRef:return b(T.lhs)&&b(T.rhs);case f.StructRefKind.MissingRef:return!0;case f.StructRefKind.BadRef:return T.isClosed}}t.getBoundName=function(T,g){var O=g;return O.length>ie.length&&T.stringCompareCI(O.substring(0,ie.length),ie)===0&&(O=O.substring(ie.length)),O},t.isCommaOpRefWellFormed=function(T){return T.columnRefs.length<=1&&T.refs.every(X)&&function(g){var O=g.specialRefs,M=Object.keys(O).reduce(function(K,W){return K+(O[Number(W)]?1:0)},0);return M===1||M===2&&O[f.SpecialRefId.Data]&&(O[f.SpecialRefId.Headers]||O[f.SpecialRefId.Totals])}(T)},t.isCommaOpClosed=function(T){return T.refs.every(b)},t.isCommaOpNoBadOrMissing=function(T){return!T.refs.some(Q)},t.isRangeOpClosed=function(T){return b(T.lhs)&&b(T.rhs)},t.isRangeOpNoMissing=function(T){return!Q(T.lhs)&&!Q(T.rhs)};var R=(s={},Qe(s,f.SpecialRefId.All,1),Qe(s,f.SpecialRefId.Headers,2),Qe(s,f.SpecialRefId.Data,3),Qe(s,f.SpecialRefId.Totals,4),Qe(s,f.SpecialRefId.ThisRow,5),s),P=function(g){return g.kind===f.StructRefKind.MissingRef?7:g.kind!==f.StructRefKind.SpecialRef?6:R[g.id]};function A(T,g){return P(T)-P(g)}t.normalizeCommaOpRef=function(T){for(var g={},O=[],M=da(T.refs),K;!(K=M()).done;){var W=K.value;W.kind!==f.StructRefKind.SpecialRef?O.push(W):g[W.id]===void 0&&(g[W.id]=!0,O.push(W))}return O.sort(A),O},t.applyComparison=function(T,g){switch(T){case S.OperatorId.Eq:return g===0;case S.OperatorId.Ne:return g!==0;case S.OperatorId.Lt:return g<0;case S.OperatorId.Gt:return g>0;case S.OperatorId.Le:return g<=0;case S.OperatorId.Ge:return g>=0}}},2054:function(u,t,d){"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0}),t.falseOper=t.trueOper=t.blankOper=t.missingOper=t.range3DOper=t.rangeSeqOper=t.arrayOper=t.externalErrorOper=t.busyErrorOper=t.calcErrorOper=t.fieldErrorOper=t.unknownErrorOper=t.blockedErrorOper=t.connectErrorOper=t.spillErrorOper=t.gettingDataErrorOper=t.naErrorOper=t.numErrorOper=t.nameErrorOper=t.refErrorOper=t.valueErrorOper=t.div0ErrorOper=t.nullErrorOper=t.errorOper=t.stringOper=t.booleanOper=t.precedents=t.ErrorType=t.cellStringLimit=t.PrecsBound=void 0;var c=d(637),l=c.assertions.assertNatural,f=c.assertions.assertPositiveInteger,p=c.assertions.assertFalse,m=c.util.partialArray,v=d(7161),h,S;function y(E){return{kind:v.OperKind.Error,type:E}}(S=t.PrecsBound||(t.PrecsBound={}))[S.Lower=-1]="Lower",S[S.Exact=0]="Exact",S[S.Upper=1]="Upper",t.cellStringLimit=32767,function(E){E[E.NULL=1]="NULL",E[E.DIV0=2]="DIV0",E[E.VALUE=3]="VALUE",E[E.REF=4]="REF",E[E.NAME=5]="NAME",E[E.NUM=6]="NUM",E[E.NA=7]="NA",E[E.GETTING_DATA=8]="GETTING_DATA",E[E.SPILL=9]="SPILL",E[E.CONNECT=10]="CONNECT",E[E.BLOCKED=11]="BLOCKED",E[E.UNKNOWN=12]="UNKNOWN",E[E.FIELD=13]="FIELD",E[E.CALC=14]="CALC",E[E.BUSY=16]="BUSY",E[E.EXTERNAL=19]="EXTERNAL"}(h=t.ErrorType||(t.ErrorType={})),t.precedents=function(E,I,F,w,B){return{cells:E,names:I,udfs:F,special:w,bound:B}},t.booleanOper=function(E){return E?t.trueOper:t.falseOper},t.stringOper=function(E){return{kind:v.OperKind.String,value:E}},t.errorOper=function(E){var I=C[E];return I!==void 0?I:y(E)},t.nullErrorOper=y(h.NULL),t.div0ErrorOper=y(h.DIV0),t.valueErrorOper=y(h.VALUE),t.refErrorOper=y(h.REF),t.nameErrorOper=y(h.NAME),t.numErrorOper=y(h.NUM),t.naErrorOper=y(h.NA),t.gettingDataErrorOper=y(h.GETTING_DATA),t.spillErrorOper=y(h.SPILL),t.connectErrorOper=y(h.CONNECT),t.blockedErrorOper=y(h.BLOCKED),t.unknownErrorOper=y(h.UNKNOWN),t.fieldErrorOper=y(h.FIELD),t.calcErrorOper=y(h.CALC),t.busyErrorOper=y(h.BUSY),t.externalErrorOper=y(h.EXTERNAL);var C=m((s={},Qe(s,h.NULL,t.nullErrorOper),Qe(s,h.DIV0,t.div0ErrorOper),Qe(s,h.VALUE,t.valueErrorOper),Qe(s,h.REF,t.refErrorOper),Qe(s,h.NAME,t.nameErrorOper),Qe(s,h.NUM,t.numErrorOper),Qe(s,h.NA,t.naErrorOper),Qe(s,h.GETTING_DATA,t.gettingDataErrorOper),Qe(s,h.SPILL,t.spillErrorOper),Qe(s,h.CONNECT,t.connectErrorOper),Qe(s,h.BLOCKED,t.blockedErrorOper),Qe(s,h.UNKNOWN,t.unknownErrorOper),Qe(s,h.FIELD,t.fieldErrorOper),Qe(s,h.CALC,t.calcErrorOper),Qe(s,h.BUSY,t.busyErrorOper),Qe(s,h.EXTERNAL,t.externalErrorOper),s));t.arrayOper=function(E,I,F){return l("calc.lang.arrayOper",E),l("calc.lang.arrayOper",I),F.length!==E?p("calc.lang.arrayOper: Inconsistent row number"):{kind:v.OperKind.Array,rows:E,cols:I,opers:F}},t.rangeSeqOper=function(E,I){return f("calc.lang.rangeSeqOper",I.length),{kind:v.OperKind.Range,sheets:E,ranges:I}},t.range3DOper=function(E,I){return{kind:v.OperKind.Range,sheets:E,ranges:[I]}},t.missingOper={kind:v.OperKind.Missing},t.blankOper={kind:v.OperKind.Blank},t.trueOper={kind:v.OperKind.Boolean,value:!0},t.falseOper={kind:v.OperKind.Boolean,value:!1}},158:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reducePledge=t.reduceTopDown_Pledge=t.reduceBottomUp=t.reduceBottomUp_MaxDepth=t.reduceBottomUp_Pledge=t.PledgeReducer=t.reduceBottomUp_CPS=t.reduceBottomUp_Recursive=t.zipVisitor=t.ZipVisitor=t.depthVisitor=t.composeVisitor=t.ComposeVisitor=t.binaryVisitor=t.BinaryVisitor=t.DelegatingVisitor=t.voidVisitor=t.constVisitor=t.ConstVisitor=t.identityVisitor=t.IdentityVisitor=t.bindVisitor=t.visitCellRef=t.visitQualifier=t.visitAppHeadNode=t.visitWSFNode=t.visitOperatorNode=t.visitFormulaNode=void 0;var s=d(8660),c=d(5385),l=d(5781),f=d(4333);function p(b,R){switch(R.kind){case f.NodeKind.Literal:{var P=R.oper,A=R.isClosed,T=R.label;return b.literalNode(P,A,T)}case f.NodeKind.Array:{var g=R.nodes,O=R.isClosed,M=R.label;return b.arrayNode(g,O,M)}case f.NodeKind.App:{var K=R.head,W=R.args,z=R.isClosed,ee=R.label;return b.appNode(K,W,z,ee)}case f.NodeKind.Let:{var ue=R.head,ce=R.vars,he=R.body,de=R.badArgs,pe=R.isClosed,_e=R.label;return b.letNode(ue,ce,he,de,pe,_e)}case f.NodeKind.Lambda:{var Ce=R.head,Ne=R.params,Le=R.body,Oe=R.badArgs,le=R.isClosed,me=R.label;return b.lambdaNode(Ce,Ne,Le,Oe,le,me)}case f.NodeKind.Paren:{var Pe=R.node,Re=R.isClosed,fe=R.label;return b.parenNode(Pe,Re,fe)}case f.NodeKind.Name:{var Se=R.parts,be=R.qualifier,xe=R.label;return b.nameNode(Se,be,xe)}case f.NodeKind.CellRef:{var Ie=R.ref,Ve=R.qualifier,Ze=R.label;return b.cellRefNode(Ie,Ve,Ze)}case f.NodeKind.FieldRef:{var gr=R.lhs,cr=R.rhs,_r=R.shouldBeBracketed,xr=R.label;return b.fieldRefNode(gr,cr,_r,xr)}case f.NodeKind.StructRef:{var Or=R.lhs,Rr=R.rhs,ir=R.label;return b.structRefNode(Or,Rr,ir)}case f.NodeKind.Bad:{var $e=R.label;switch(R.type){case f.BadType.Sequence:case f.BadType.StructRef:case f.BadType.FieldRef:return b.badSequenceNode(R.type,R.contents,$e);default:return b.badStringNode(R.type,R.contents,$e)}}default:return(0,s.assertNever)("calc.lang.visitFormulaNode",R)}}function m(b,R){var P=R.id,A=R.label;return b.operatorNode(P,A)}function v(b,R){var P=R.id,A=R.whole,T=R.label;return b.wsfNode(P,A,T)}function h(b,R){switch(R.kind){case f.NodeKind.Operator:return m(b,R);case f.NodeKind.WSF:return v(b,R);default:return p(b,R)}}function S(b){return{literalNode:b.literalNode.bind(b),arrayNode:b.arrayNode.bind(b),appNode:b.appNode.bind(b),letNode:b.letNode.bind(b),lambdaNode:b.lambdaNode.bind(b),parenNode:b.parenNode.bind(b),nameNode:b.nameNode.bind(b),cellRefNode:b.cellRefNode.bind(b),fieldRefNode:b.fieldRefNode.bind(b),structRefNode:b.structRefNode.bind(b),badSequenceNode:b.badSequenceNode.bind(b),badStringNode:b.badStringNode.bind(b),operatorNode:b.operatorNode.bind(b),wsfNode:b.wsfNode.bind(b)}}t.visitFormulaNode=p,t.visitOperatorNode=m,t.visitWSFNode=v,t.visitAppHeadNode=h,t.visitQualifier=function(b,R){switch(R.kind){case f.QualifierKind.Error:{var P=R.label;return b.errorQualifier(P)}case f.QualifierKind.Relative:{var A=R.label;return b.relativeQualifier(A)}case f.QualifierKind.Document:{var T=R.document,g=R.path,O=R.isQuoted,M=R.label;return b.documentQualifier(T,g,O,M)}case f.QualifierKind.Sheet:{var K=R.sheet,W=R.document,z=R.isQuoted,ee=R.label;return b.sheetQualifier(K,W,z,ee)}case f.QualifierKind.Ident:{var ue=R.name,ce=R.isQuoted,he=R.label;return b.identQualifier(ue,ce,he)}case f.QualifierKind.SheetRange:{var de=R.sheet1,pe=R.sheet2,_e=R.document,Ce=R.isQuoted,Ne=R.label;return b.sheetRangeQualifier(de,pe,_e,Ce,Ne)}case f.QualifierKind.Bad:{var Le=R.chars,Oe=R.isQuoted,le=R.label;return b.badQualifier(Le,Oe,le)}default:return(0,s.assertNever)("calc.lang.visitQualifier",R)}},t.visitCellRef=function(b,R){switch(R.kind){case f.CellRefKind.Error:{var P=R.label;return b.cellRefError(P)}case f.CellRefKind.Single:{var A=R.row,T=R.col,g=R.isBracketed,O=R.label;return b.cellRefSingle(A,T,g,O)}case f.CellRefKind.Range:{var M=R.ref1,K=R.ref2,W=R.label;return b.cellRefRange(M,K,W)}case f.CellRefKind.Row:{var z=R.row1,ee=R.row2,ue=R.isBracketed,ce=R.label;return b.cellRefRow(z,ee,ue,ce)}case f.CellRefKind.Col:{var he=R.col1,de=R.col2,pe=R.isBracketed,_e=R.label;return b.cellRefCol(he,de,pe,_e)}case f.CellRefKind.Bad:{var Ce=R.chars,Ne=R.isBracketed,Le=R.label;return b.cellRefBad(Ce,Ne,Le)}default:return(0,s.assertNever)("calc.lang.visitCellRef",R)}},t.bindVisitor=S;var y=function(){function b(){Yg(this,b)}return Jg(b,[{key:"literalNode",value:function(P,A,T){return(0,f.literalNode)(P,A,T)}},{key:"arrayNode",value:function(P,A,T){return(0,f.arrayNode)(P,A,T)}},{key:"appNode",value:function(P,A,T,g){return(0,f.appNode)(P,A,T,g)}},{key:"letNode",value:function(P,A,T,g,O,M){return(0,f.letNode)(P,A,T,g,O,M)}},{key:"lambdaNode",value:function(P,A,T,g,O,M){return(0,f.lambdaNode)(P,A,T,g,O,M)}},{key:"parenNode",value:function(P,A,T){return(0,f.parenNode)(P,A,T)}},{key:"nameNode",value:function(P,A,T){return(0,f.nameNode)(P,A,T)}},{key:"cellRefNode",value:function(P,A,T){return(0,f.cellRefNode)(P,A,T)}},{key:"fieldRefNode",value:function(P,A,T,g){return(0,f.fieldRefNode)(P,A,T,g)}},{key:"structRefNode",value:function(P,A,T){return(0,f.structRefNode)(P,A,T)}},{key:"badSequenceNode",value:function(P,A,T){return(0,f.badNode)(P,A,T)}},{key:"badStringNode",value:function(P,A,T){return(0,f.badNode)(P,A,T)}},{key:"operatorNode",value:function(P,A){return(0,f.operatorNode)(P,A)}},{key:"wsfNode",value:function(P,A,T){return(0,f.wsfNode)(P,A,T)}}]),b}();t.IdentityVisitor=y,t.identityVisitor=S(new y);var C=function(){function b(R){Yg(this,b),this.value=R}return Jg(b,[{key:"literalNode",value:function(P,A,T){return this.value}},{key:"arrayNode",value:function(P,A,T){return this.value}},{key:"appNode",value:function(P,A,T,g){return this.value}},{key:"letNode",value:function(P,A,T,g,O,M){return this.value}},{key:"lambdaNode",value:function(P,A,T,g,O,M){return this.value}},{key:"parenNode",value:function(P,A,T){return this.value}},{key:"nameNode",value:function(P,A,T){return this.value}},{key:"cellRefNode",value:function(P,A,T){return this.value}},{key:"fieldRefNode",value:function(P,A,T,g){return this.value}},{key:"structRefNode",value:function(P,A,T){return this.value}},{key:"badSequenceNode",value:function(P,A,T){return this.value}},{key:"badStringNode",value:function(P,A,T){return this.value}},{key:"operatorNode",value:function(P,A){return this.value}},{key:"wsfNode",value:function(P,A,T){return this.value}}]),b}();function E(b){return S(new C(b))}t.ConstVisitor=C,t.constVisitor=E,t.voidVisitor=E(void 0);var I=function(){function b(R){Yg(this,b),this.visitor=R}return Jg(b,[{key:"literalNode",value:function(P,A,T){return this.visitor.literalNode(P,A,T)}},{key:"arrayNode",value:function(P,A,T){return this.visitor.arrayNode(P,A,T)}},{key:"appNode",value:function(P,A,T,g){return this.visitor.appNode(P,A,T,g)}},{key:"letNode",value:function(P,A,T,g,O,M){return this.visitor.letNode(P,A,T,g,O,M)}},{key:"lambdaNode",value:function(P,A,T,g,O,M){return this.visitor.lambdaNode(P,A,T,g,O,M)}},{key:"parenNode",value:function(P,A,T){return this.visitor.parenNode(P,A,T)}},{key:"nameNode",value:function(P,A,T){return this.visitor.nameNode(P,A,T)}},{key:"cellRefNode",value:function(P,A,T){return this.visitor.cellRefNode(P,A,T)}},{key:"fieldRefNode",value:function(P,A,T,g){return this.visitor.fieldRefNode(P,A,T,g)}},{key:"structRefNode",value:function(P,A,T){return this.visitor.structRefNode(P,A,T)}},{key:"badSequenceNode",value:function(P,A,T){return this.visitor.badSequenceNode(P,A,T)}},{key:"badStringNode",value:function(P,A,T){return this.visitor.badStringNode(P,A,T)}},{key:"operatorNode",value:function(P,A){return this.visitor.operatorNode(P,A)}},{key:"wsfNode",value:function(P,A,T){return this.visitor.wsfNode(P,A,T)}}]),b}();t.DelegatingVisitor=I;var F=function(b){Due(P,b);var R=xue(P);function P(A,T){var g;return Yg(this,P),g=R.call(this,A),g.reducer=function(O,M){return T(O,M)},g}return Jg(P,[{key:"arrayNode",value:function(T,g,O){var M=this;return(0,s.assertTrue)("calc.lang.binaryVisitor: non-empty array",T.length>0&&T[0].length>0),T.map(function(K){return K.reduce(M.reducer)}).reduce(this.reducer)}},{key:"appNode",value:function(T,g,O,M){return g.reduce(this.reducer,T)}},{key:"letNode",value:function(T,g,O,M,K,W){return[].concat(Pc(g.map(function(z){var ee=z.binder;return ee.arg})),Pc(O===void 0?[]:[O.arg]),Pc(M.map(function(z){return z.arg}))).reduce(this.reducer,T)}},{key:"lambdaNode",value:function(T,g,O,M,K,W){return[].concat(Pc(g.map(function(z){var ee=z.name,ue;return(ue=ee.arg.def)===null||ue===void 0?void 0:ue.rhs}).filter(c.isDefined)),Pc(O===void 0?[]:[O.arg]),Pc(M.map(function(z){return z.arg}))).reduce(this.reducer,T)}},{key:"parenNode",value:function(T,g,O){return T}},{key:"fieldRefNode",value:function(T,g,O,M){return T}},{key:"badSequenceNode",value:function(T,g,O){return(0,s.assertTrue)("calc.lang.binaryVisitor: non-empty bad-sequence",g.length>0),g.reduce(this.reducer)}}]),P}(I);function w(b,R){return S(new F(b,R))}t.BinaryVisitor=F,t.binaryVisitor=w;var B=function(){function b(R,P){Yg(this,b),this.a=R,this.b=P}return Jg(b,[{key:"literalNode",value:function(P,A,T){return this.b(this.a.literalNode(P,A,T))}},{key:"arrayNode",value:function(P,A,T){return this.b(this.a.arrayNode(P,A,T))}},{key:"appNode",value:function(P,A,T,g){return this.b(this.a.appNode(P,A,T,g))}},{key:"letNode",value:function(P,A,T,g,O,M){return this.b(this.a.letNode(P,A,T,g,O,M))}},{key:"lambdaNode",value:function(P,A,T,g,O,M){return this.b(this.a.lambdaNode(P,A,T,g,O,M))}},{key:"parenNode",value:function(P,A,T){return this.b(this.a.parenNode(P,A,T))}},{key:"nameNode",value:function(P,A,T){return this.b(this.a.nameNode(P,A,T))}},{key:"cellRefNode",value:function(P,A,T){return this.b(this.a.cellRefNode(P,A,T))}},{key:"fieldRefNode",value:function(P,A,T,g){return this.b(this.a.fieldRefNode(P,A,T,g))}},{key:"structRefNode",value:function(P,A,T){return this.b(this.a.structRefNode(P,A,T))}},{key:"badSequenceNode",value:function(P,A,T){return this.b(this.a.badSequenceNode(P,A,T))}},{key:"badStringNode",value:function(P,A,T){return this.b(this.a.badStringNode(P,A,T))}},{key:"operatorNode",value:function(P,A){return this.b(this.a.operatorNode(P,A))}},{key:"wsfNode",value:function(P,A,T){return this.b(this.a.wsfNode(P,A,T))}}]),b}();function k(b,R){return S(new B(b,R))}t.ComposeVisitor=B,t.composeVisitor=k,t.depthVisitor=k(w(E(0),c.fastMax),function(b){return b+1});var x=function(){function b(R){Yg(this,b),this.visitors=R,this.keys=Object.keys(R)}return Jg(b,[{key:"literalNode",value:function(P,A,T){for(var g={},O=da(this.keys),M;!(M=O()).done;){var K=M.value;g[K]=this.visitors[K].literalNode(P,A,T)}return g}},{key:"arrayNode",value:function(P,A,T){for(var g={},O=da(this.keys),M;!(M=O()).done;){var K=M.value;g[K]=this.visitors[K].arrayNode(P,A,T)}return g}},{key:"appNode",value:function(P,A,T,g){for(var O={},M=da(this.keys),K;!(K=M()).done;){var W=K.value;O[W]=this.visitors[W].appNode(P,A,T,g)}return O}},{key:"letNode",value:function(P,A,T,g,O,M){for(var K={},W=da(this.keys),z;!(z=W()).done;){var ee=z.value;K[ee]=this.visitors[ee].letNode(P,A,T,g,O,M)}return K}},{key:"lambdaNode",value:function(P,A,T,g,O,M){for(var K={},W=da(this.keys),z;!(z=W()).done;){var ee=z.value;K[ee]=this.visitors[ee].lambdaNode(P,A,T,g,O,M)}return K}},{key:"parenNode",value:function(P,A,T){for(var g={},O=da(this.keys),M;!(M=O()).done;){var K=M.value;g[K]=this.visitors[K].parenNode(P,A,T)}return g}},{key:"nameNode",value:function(P,A,T){for(var g={},O=da(this.keys),M;!(M=O()).done;){var K=M.value;g[K]=this.visitors[K].nameNode(P,A,T)}return g}},{key:"cellRefNode",value:function(P,A,T){for(var g={},O=da(this.keys),M;!(M=O()).done;){var K=M.value;g[K]=this.visitors[K].cellRefNode(P,A,T)}return g}},{key:"fieldRefNode",value:function(P,A,T,g){for(var O={},M=da(this.keys),K;!(K=M()).done;){var W=K.value;O[W]=this.visitors[W].fieldRefNode(P,A,T,g)}return O}},{key:"structRefNode",value:function(P,A,T){for(var g={},O=da(this.keys),M;!(M=O()).done;){var K=M.value;g[K]=this.visitors[K].structRefNode(P,A,T)}return g}},{key:"badSequenceNode",value:function(P,A,T){for(var g={},O=da(this.keys),M;!(M=O()).done;){var K=M.value;g[K]=this.visitors[K].badSequenceNode(P,A,T)}return g}},{key:"badStringNode",value:function(P,A,T){for(var g={},O=da(this.keys),M;!(M=O()).done;){var K=M.value;g[K]=this.visitors[K].badStringNode(P,A,T)}return g}},{key:"operatorNode",value:function(P,A){for(var T={},g=da(this.keys),O;!(O=g()).done;){var M=O.value;T[M]=this.visitors[M].operatorNode(P,A)}return T}},{key:"wsfNode",value:function(P,A,T){for(var g={},O=da(this.keys),M;!(M=O()).done;){var K=M.value;g[K]=this.visitors[K].wsfNode(P,A,T)}return g}}]),b}();function G(b,R){var P=function A(T){switch(T.kind){case f.NodeKind.Literal:{var g=T.oper,O=T.isClosed,M=T.label;return b.literalNode(g,O,M)}case f.NodeKind.Array:{var K=T.nodes,W=T.isClosed,z=T.label;return b.arrayNode(K.map(function(dn){return dn.map(A)}),W,z)}case f.NodeKind.App:{var ee=T.head,ue=T.args,ce=T.isClosed,he=T.label;return b.appNode(function(dn){switch(dn.kind){case f.NodeKind.Operator:return m(b,dn);case f.NodeKind.WSF:return v(b,dn);default:return A(dn)}}(ee),ue.map(A),ce,he)}case f.NodeKind.Let:{var de=T.head,pe=T.vars,_e=T.body,Ce=T.badArgs,Ne=T.isClosed,Le=T.label;return b.letNode(v(b,de),pe.map(function(dn){var Un=dn.name,Gr=dn.binder;return(0,f.letVar)(Un,(0,f.indexedArg)(A(Gr.arg),Gr.index))}),_e===void 0?void 0:(0,f.indexedArg)(A(_e.arg),_e.index),Ce.map(function(dn){return(0,f.indexedArg)(A(dn.arg),dn.index)}),Ne,Le)}case f.NodeKind.Lambda:{var Oe=T.head,le=T.params,me=T.body,Pe=T.badArgs,Re=T.isClosed,fe=T.label;return b.lambdaNode(v(b,Oe),le.map(function(dn){var Un=dn.name;return Un.arg.def===void 0?(0,f.lambdaParam)(Un):(0,f.lambdaParam)((0,f.indexedArg)((0,f.paramNode)(Un.arg.name,(0,f.paramDefault)(A(Un.arg.def.rhs),Un.arg.def.label),Un.arg.label),Un.index))}),me===void 0?void 0:(0,f.indexedArg)(A(me.arg),me.index),Pe.map(function(dn){return(0,f.indexedArg)(A(dn.arg),dn.index)}),Re,fe)}case f.NodeKind.Paren:{var Se=T.node,be=T.isClosed,xe=T.label;return b.parenNode(A(Se),be,xe)}case f.NodeKind.Name:{var Ie=T.parts,Ve=T.qualifier,Ze=T.label;return b.nameNode(Ie,Ve,Ze)}case f.NodeKind.CellRef:{var gr=T.ref,cr=T.qualifier,_r=T.label;return b.cellRefNode(gr,cr,_r)}case f.NodeKind.FieldRef:{var xr=T.lhs,Or=T.rhs,Rr=T.shouldBeBracketed,ir=T.label;return b.fieldRefNode(A(xr),Or,Rr,ir)}case f.NodeKind.StructRef:{var $e=T.lhs,qe=T.rhs,fr=T.label;return b.structRefNode($e,qe,fr)}case f.NodeKind.Bad:{var lr=T.label;switch(T.type){case f.BadType.Sequence:case f.BadType.StructRef:case f.BadType.FieldRef:return b.badSequenceNode(T.type,T.contents.map(A),lr);default:return b.badStringNode(T.type,T.contents,lr)}}default:return(0,s.assertNever)("calc.lang.reduceBottomUp_Recursive",T)}};return P(R)}function H(b,R,P,A){var T=[],g=function(K){return T.push(K),O},O=function(){return T.length<R.length?P(b,R[T.length],g):A(T)};return O}function L(b,R,P){return H(b,R,$,P)}function D(b,R,P,A){return function(){return R!==void 0?P(b,R,A):A(void 0)}}function U(b,R,P){var A=R.id,T=R.whole,g=R.label;return function(){return P(b.wsfNode(A,T,g))}}function V(b,R,P){var A=R.name,T=R.binder;return $(b,T.arg,function(g){return P((0,f.letVar)(A,(0,f.indexedArg)(g,T.index)))})}function ne(b,R,P){var A=R.name,T=A.arg;return T.def===void 0?function(){return P((0,f.lambdaParam)(A))}:$(b,T.def.rhs,function(g){return P((0,f.lambdaParam)((0,f.indexedArg)((0,f.paramNode)(T.name,(0,f.paramDefault)(g,T.def.label),T.label),A.index)))})}function J(b,R,P){var A=R.arg,T=R.index;return $(b,A,function(g){return P((0,f.indexedArg)(g,T))})}function $(b,R,P){switch(R.kind){case f.NodeKind.Literal:{var A=R.oper,T=R.isClosed,g=R.label;return function(){return P(b.literalNode(A,T,g))}}case f.NodeKind.Array:{var O=R.nodes,M=R.isClosed,K=R.label;return H(b,O,L,function(Gr){return P(b.arrayNode(Gr,M,K))})}case f.NodeKind.App:{var W=R.head,z=R.args,ee=R.isClosed,ue=R.label;return function(){return function(Gr,Br,bt){switch(Br.kind){case f.NodeKind.Operator:{var Kr=Br.id,Pt=Br.label;return function(){return bt(Gr.operatorNode(Kr,Pt))}}case f.NodeKind.WSF:return U(Gr,Br,bt);default:return $(Gr,Br,bt)}}(b,W,function(Gr){return L(b,z,function(Br){return P(b.appNode(Gr,Br,ee,ue))})})}}case f.NodeKind.Let:{var ce=R.head,he=R.vars,de=R.body,pe=R.badArgs,_e=R.isClosed,Ce=R.label;return function(){return U(b,ce,function(Gr){return H(b,he,V,function(Br){return D(b,de,J,function(bt){return H(b,pe,J,function(Kr){return P(b.letNode(Gr,Br,bt,Kr,_e,Ce))})})})})}}case f.NodeKind.Lambda:{var Ne=R.head,Le=R.params,Oe=R.body,le=R.badArgs,me=R.isClosed,Pe=R.label;return function(){return U(b,Ne,function(Gr){return function(){return H(b,Le,ne,function(Br){return D(b,Oe,J,function(bt){return H(b,le,J,function(Kr){return P(b.lambdaNode(Gr,Br,bt,Kr,me,Pe))})})})}})}}case f.NodeKind.Paren:{var Re=R.node,fe=R.isClosed,Se=R.label;return function(){return $(b,Re,function(Gr){return function(){return P(b.parenNode(Gr,fe,Se))}})}}case f.NodeKind.Name:{var be=R.parts,xe=R.qualifier,Ie=R.label;return function(){return P(b.nameNode(be,xe,Ie))}}case f.NodeKind.CellRef:{var Ve=R.ref,Ze=R.qualifier,gr=R.label;return function(){return P(b.cellRefNode(Ve,Ze,gr))}}case f.NodeKind.FieldRef:{var cr=R.lhs,_r=R.rhs,xr=R.shouldBeBracketed,Or=R.label;return function(){return $(b,cr,function(Gr){return function(){return P(b.fieldRefNode(Gr,_r,xr,Or))}})}}case f.NodeKind.StructRef:{var Rr=R.lhs,ir=R.rhs,$e=R.label;return function(){return P(b.structRefNode(Rr,ir,$e))}}case f.NodeKind.Bad:{var qe=R.label;switch(R.type){case f.BadType.Sequence:case f.BadType.StructRef:case f.BadType.FieldRef:{var fr=R.type,lr=R.contents;return L(b,lr,function(Gr){return P(b.badSequenceNode(fr,Gr,qe))})}default:{var dn=R.type,Un=R.contents;return function(){return P(b.badStringNode(dn,Un,qe))}}}}default:return(0,s.assertNever)("calc.lang.reduceBottomUp_CPS",R)}}function Z(b,R){var P;return function(A){for(var T=A;T!=null;)T=T()}($(b,R,function(A){P=A})),P}t.ZipVisitor=x,t.zipVisitor=function(b){return S(new x(b))},t.reduceBottomUp_Recursive=G,t.reduceBottomUp_CPS=Z;var ie=function(){function b(R){var P=this;Yg(this,b),this.visitor=R,this.visitFormulaNode=function(A){return p(P,A)},this.lazyVisitFormulaNode=function(A){return l.Pledge.resolve(A).bind(P.visitFormulaNode)},this.visitAppHeadNode=function(A){return h(P,A)},this.lazyVisitAppHeadNode=function(A){return l.Pledge.resolve(A).bind(P.visitAppHeadNode)},this.visitWSFNode=function(A){return v(P,A)},this.lazyVisitWSFNode=function(A){return l.Pledge.resolve(A).bind(P.visitWSFNode)},this.lazyVisitVar=function(A){var T=A.name,g=A.binder;return P.lazyVisitFormulaNode(g.arg).bind(function(O){return(0,f.letVar)(T,(0,f.indexedArg)(O,g.index))})},this.lazyVisitParam=function(A){var T=A.name,g=T.arg;return g.def===void 0?l.Pledge.resolve((0,f.lambdaParam)(T)):P.lazyVisitFormulaNode(g.def.rhs).bind(function(O){return(0,f.lambdaParam)((0,f.indexedArg)((0,f.paramNode)(g.name,(0,f.paramDefault)(O,g.def.label),g.label),T.index))})},this.lazyVisitIndexedArg=function(A){var T=A.arg,g=A.index;return P.lazyVisitFormulaNode(T).bind(function(O){return(0,f.indexedArg)(O,g)})}}return Jg(b,[{key:"literalNode",value:function(P,A,T){var g=this;return l.Pledge.try(function(){return g.visitor.literalNode(P,A,T)})}},{key:"arrayNode",value:function(P,A,T){var g=this;return l.Pledge.all(P.map(function(O){return l.Pledge.all(O.map(g.lazyVisitFormulaNode))})).bind(function(O){return g.visitor.arrayNode(O,A,T)})}},{key:"appNode",value:function(P,A,T,g){var O=this;return this.lazyVisitAppHeadNode(P).bind(function(M){return l.Pledge.all(A.map(O.lazyVisitFormulaNode)).bind(function(K){return O.visitor.appNode(M,K,T,g)})})}},{key:"letNode",value:function(P,A,T,g,O,M){var K=this;return this.lazyVisitWSFNode(P).bind(function(W){return l.Pledge.all(A.map(K.lazyVisitVar)).bind(function(z){return(T===void 0?l.Pledge.resolve(void 0):K.lazyVisitIndexedArg(T)).bind(function(ee){return l.Pledge.all(g.map(K.lazyVisitIndexedArg)).bind(function(ue){return K.visitor.letNode(W,z,ee,ue,O,M)})})})})}},{key:"lambdaNode",value:function(P,A,T,g,O,M){var K=this;return this.lazyVisitWSFNode(P).bind(function(W){return l.Pledge.all(A.map(K.lazyVisitParam)).bind(function(z){return(T===void 0?l.Pledge.resolve(void 0):K.lazyVisitIndexedArg(T)).bind(function(ee){return l.Pledge.all(g.map(K.lazyVisitIndexedArg)).bind(function(ue){return K.visitor.lambdaNode(W,z,ee,ue,O,M)})})})})}},{key:"parenNode",value:function(P,A,T){var g=this;return this.lazyVisitFormulaNode(P).bind(function(O){return g.visitor.parenNode(O,A,T)})}},{key:"nameNode",value:function(P,A,T){var g=this;return l.Pledge.try(function(){return g.visitor.nameNode(P,A,T)})}},{key:"cellRefNode",value:function(P,A,T){var g=this;return l.Pledge.try(function(){return g.visitor.cellRefNode(P,A,T)})}},{key:"fieldRefNode",value:function(P,A,T,g){var O=this;return this.lazyVisitFormulaNode(P).bind(function(M){return O.visitor.fieldRefNode(M,A,T,g)})}},{key:"structRefNode",value:function(P,A,T){var g=this;return l.Pledge.try(function(){return g.visitor.structRefNode(P,A,T)})}},{key:"badSequenceNode",value:function(P,A,T){var g=this;return l.Pledge.all(A.map(this.lazyVisitFormulaNode)).bind(function(O){return g.visitor.badSequenceNode(P,O,T)})}},{key:"badStringNode",value:function(P,A,T){var g=this;return l.Pledge.try(function(){return g.visitor.badStringNode(P,A,T)})}},{key:"operatorNode",value:function(P,A){var T=this;return l.Pledge.try(function(){return T.visitor.operatorNode(P,A)})}},{key:"wsfNode",value:function(P,A,T){var g=this;return l.Pledge.try(function(){return g.visitor.wsfNode(P,A,T)})}}]),b}();function X(b,R,P){return P<=50?G(b,R):Z(b,R)}function Q(b,R){return l.Pledge.settleOrThrow(l.Pledge.resolve(p(b,R)))}t.PledgeReducer=ie,t.reduceBottomUp_Pledge=function(b,R){return Q(new ie(b),R)},t.reduceBottomUp_MaxDepth=X,t.reduceBottomUp=function(b,R){return X(b,R.node,R.depthUpperBound)},t.reduceTopDown_Pledge=Q,t.reducePledge=function(b,R){return Q(b,R.node)}},330:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.adjustFormulaOrigin=void 0;var s=d(655),c=d(9937),l=d(3546),f=d(927),p=d(5499),m=d(1646),v=d(7815),h=d(9745),S=d(2195),y=d(7458),C=d(9017);function E(k,x,G,H){if(G.kind===l.PosKind.Abs)return G;var L=(0,m.wrapPosition)(k,G.index,H)-x;return L===G.index?G:(0,l.pos)(l.PosKind.Rel,L)}function I(k,x,G,H){var L=E(x.row,G.row,H.row,c.sheetRows),D=E(x.col,G.col,H.col,c.sheetCols),U=(0,p.canonicaliseBrackets)(k,L)||(0,p.canonicaliseBrackets)(k,D);return(0,l.cellRefSingle)(L,D,U,H.label)}function F(k,x,G,H){switch(H.kind){case l.CellRefKind.Error:case l.CellRefKind.Bad:return H;case l.CellRefKind.Single:return I(k,x,G,H);case l.CellRefKind.Range:var L=I(k,x,G,H.ref1),D=I(k,x,G,H.ref2);return L===H.ref1&&D===H.ref2?H:(0,l.cellRefRange)(L,D,H.label);case l.CellRefKind.Row:var U=E(x.row,G.row,H.row1,c.sheetRows),V=E(x.row,G.row,H.row2,c.sheetRows),ne=(0,p.canonicaliseBrackets)(k,U)||(0,p.canonicaliseBrackets)(k,V);return(0,l.cellRefRow)(U,V,ne,H.label);case l.CellRefKind.Col:var J=E(x.col,G.col,H.col1,c.sheetCols),$=E(x.col,G.col,H.col2,c.sheetCols);return ne=(0,p.canonicaliseBrackets)(k,J)||(0,p.canonicaliseBrackets)(k,$),(0,l.cellRefCol)(J,$,ne,H.label)}}var w=(0,f.createFailureErrorClass)("TransformRefsError"),B=function(k){function x(G,H,L,D){var U=k.call(this)||this;return U.fn=G,U.locals=L,U.annotations=D,U.resolver=(0,y.createResolver)(H),U}return s.__extends(x,k),x.prototype.nameNode=function(G,H,L){var D=(0,l.nameNode)(G,H,L),U=this.resolver.resolveDottedName(this.locals,D,this.annotations).resolved;if(U.kind===S.ResolvedKind.ResolvedCellRef){var V=(0,l.flattenNameParts)(G);(0,h.assertTrue)("calc.lang.adjustFormulaOrigin",V.kind===l.NamePartKind.CellRefNamePart);var ne=V.parts,J=ne[0],$=ne[1],Z=ne.slice(2),ie=function(Q,b){var R=b.rhs,P=b.canDenoteNamedObject,A=b.label,T=b.qualifiedLabel;return(0,l.fieldRefNamePart)(Q,R,P,A,T)};return(0,l.nameNode)(Z.reduce(ie,ie((0,l.cellRefNamePart)(this.fn(J.ref),J.asWhole,J.label,J.qualifiedLabel),$)),H,L)}if(U.resolution.kind!==v.ResultKind.Success&&U.resolution.reason.kind!==S.ResolveReasonKind.NoOriginSheet&&U.resolution.reason.kind!==S.ResolveReasonKind.InvalidQualifier)throw new w(U.resolution.reason);return D},x.prototype.cellRefNode=function(G,H,L){return(0,l.cellRefNode)(this.fn(G),H,L)},x}(C.IdentityVisitor);t.adjustFormulaOrigin=function(k,x,G,H){var L=x.originGridCell.value;if((0,f.isGridCellEqual)(L,G))return(0,v.success)(H);try{var D=(0,C.reduceBottomUp)(new B(F.bind(void 0,k.config.refStyle,L,G),k,x,H.annotations),H);return(0,v.success)(s.__assign(s.__assign({},H),{node:D}))}catch(U){if(U instanceof w)return(0,v.failure)(U.reason);throw U}}},2840:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildAnnotations=void 0;var s=d(655),c=d(9745),l=d(2903),f=d(8308),p=d(3494),m=d(3546),v=d(927),h=d(9017),S=function(y){function C(E,I,F){var w=y.call(this,h.voidVisitor)||this;return w.localeInfo=E,w.annotations=I,w.names=F,w}return s.__extends(C,y),C.prototype.appNode=function(E,I,F,w){var B=this;return f.Pledge.try(function(){return E.kind===m.NodeKind.Name&&(B.annotations[E.label]=m.appHeadNameAnnotation),y.prototype.appNode.call(B,E,I,F,w)})},C.prototype.letNode=function(E,I,F,w){var B=this,k=E.id===p.WorksheetFuncId.LETREC||E.id!==p.WorksheetFuncId.LET&&(0,c.assertFalse)("calc.lang.buildAnnotations"),x=this.bindNames(I),G=x[I.length];return this.lazyVisitAppHeadNode(E).bind(function(H){return k?f.Pledge.all(I.map(function(L){var D=L.binder;return f.Pledge.try(function(){return(0,h.visitFormulaNode)(G,D.arg)})})):f.Pledge.all(I.map(function(L,D){var U=L.binder,V=x[D];return f.Pledge.try(function(){return(0,h.visitFormulaNode)(V,U.arg)})}))}).bind(function(H){return F===void 0?void 0:(0,h.visitFormulaNode)(G,F.arg)}).bind(function(H){return f.Pledge.all(w.map(function(L){return f.Pledge.try(function(){return(0,h.visitFormulaNode)(B,L.arg)})}))}).bind(function(H){})},C.prototype.lambdaNode=function(E,I,F,w){var B=this,k=this.bindNames(I),x=k[I.length];return this.lazyVisitAppHeadNode(E).bind(function(G){return f.Pledge.all(I.map(function(H,L){var D=H.name;if(D.arg.def===void 0)return f.Pledge.resolve(void 0);var U=k[L],V=D.arg.def;return f.Pledge.try(function(){return(0,h.visitFormulaNode)(U,V.rhs)})}))}).bind(function(G){return F===void 0?void 0:(0,h.visitFormulaNode)(x,F.arg)}).bind(function(G){return f.Pledge.all(w.map(function(H){return f.Pledge.try(function(){return(0,h.visitFormulaNode)(B,H.arg)})}))}).bind(function(G){})},C.prototype.bindNames=function(E){var I=this,F=[this];return E.reduce(function(w,B){var k=B.name;if(k.arg.whole===void 0)return F.push(new C(I.localeInfo,I.annotations,w)),w;var x=(0,v.getBoundName)(I.localeInfo,k.arg.whole),G=w.setValue(x,k.arg);return F.push(new C(I.localeInfo,I.annotations,G)),I.annotations[k.arg.label]=(0,m.localNameDeclAnnotation)(x,k.arg.whole),G},this.names),F},C.prototype.nameNode=function(E,I,F){var w=this;return f.Pledge.try(function(){if(I===void 0){var B=(0,m.headNamePart)(E),k=w.names.getEntry((0,v.getBoundName)(w.localeInfo,B.asWhole));k===void 0||(k.value.kind===m.NodeKind.ContextName?w.annotations[B.label]=(0,m.localNameUseAnnotation)(k.key,k.value.whole,k.value.label):(w.annotations[B.label]=(0,m.localNameUseAnnotation)(k.key,k.value.whole,k.value.label),w.annotations[k.value.label].uses.push({label:B.label})))}return y.prototype.nameNode.call(w,E,I,F)})},C}(h.PledgeReducer);t.buildAnnotations=function(y,C,E,I){var F=[];return(0,h.reduceTopDown_Pledge)(new S(y,F,(E??[]).reduce(function(w,B){var k=(0,v.getBoundName)(y,B.whole);return w.setValue(k,B)},l.RedBlackMapTree.create(y.stringCompareCI))),C),F[C.label]=(0,m.formulaRootAnnotation)(E,I),F}},5499:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatName=t.formatGridRange=t.quoteQualifier=t.formatQualifier=t.shouldQuoteQualifier=t.canonicaliseRangePos=t.formatRangePos=t.canonicaliseCellPos=t.formatCellPos=t.canonicaliseColRange=t.canonicaliseRowRange=t.formatColRange=t.formatRowRange=t.canonicaliseCol=t.canonicaliseRow=t.formatCol=t.formatRow=t.resolvePosition=t.canonicaliseBrackets=t.columnName=void 0;var s=d(9937),c=d(3546),l=d(1646),f=d(9745),p=d(1345),m=d(9119),v=d(3883),h=(0,c.pos)(c.PosKind.Abs,0),S=(0,c.pos)(c.PosKind.Abs,s.sheetRows-1),y=p.codePointCapitalA,C=p.codePointFullStop;function E(X){for(var Q=X+1,b="";Q>0;){var R=(Q-1)%26;b=String.fromCharCode(y+R)+b,Q=Math.floor((Q-R)/26)}return b}function I(X,Q,b,R){if(Q.kind===c.PosKind.Abs)return Q.index;if(R)return(0,l.wrapPosition)(X,Q.index,b);var P=X+Q.index;return 0<=P&&P<b?P:void 0}function F(X,Q,b,R,P,A){var T=I(b,R,P,A);if(T!==void 0){if(R.kind===c.PosKind.Abs)return Q+(T+1).toFixed();var g=T-b;return g===0?Q:Q+X.rcLeftBracket+g.toFixed()+X.rcRightBracket}}function w(X,Q,b,R,P){return Q===c.RefStyle.A1?function(A,T,g){var O=I(A,T,s.sheetRows,g);if(O!==void 0){var M=(O+1).toFixed();return T.kind===c.PosKind.Abs?"$"+M:M}}(b,R,P):F(X,X.rowLetter,b,R,s.sheetRows,P)}function B(X,Q,b,R,P){return Q===c.RefStyle.A1?function(A,T,g){var O=I(A,T,s.sheetCols,g);if(O!==void 0){var M=E(O);return T.kind===c.PosKind.Abs?"$"+M:M}}(b,R,P):F(X,X.columnLetter,b,R,s.sheetCols,P)}function k(X,Q,b,R){if(b.kind===c.PosKind.Abs)return b;var P=I(Q,b,X,R);if(P!==void 0){var A=P-Q;return A===b.index?b:(0,c.pos)(c.PosKind.Rel,A)}}function x(X,Q,b,R,P){var A=I(X,Q,R,P),T=I(X,b,R,P);if(A!==void 0&&T!==void 0)return A<=T?[Q,b,A,T]:[b,Q,T,A]}function G(X,Q,b,R,P,A,T,g,O){var M=x(A,T,g,b,O);if(M!==void 0){var K=M[0],W=M[1],z=M[2],ee=M[3];if(Q!==void 0&&z===0&&ee===b-1&&T.kind===g.kind)return Q(R,P,O);var ue=X(R,P,A,K,O);if(ue!==void 0){if(P===c.RefStyle.R1C1&&K.kind===W.kind&&K.index===W.index)return ue;var ce=X(R,P,A,W,O);if(ce!==void 0)return ue+":"+ce}}}function H(X,Q,b,R,P,A){var T=x(b,R,P,Q,A);if(T!==void 0){var g=T[0],O=T[1],M=T[2],K=T[3];if(X!==void 0&&M===0&&K===Q-1&&R.kind===P.kind)return X;var W=k(Q,b,g,A),z=k(Q,b,O,A);if(W!==void 0&&z!==void 0)return[!1,W,z]}}function L(X,Q,b,R,P,A){var T=w(X,Q,b.row,R,A),g=B(X,Q,b.col,P,A);if(T!==void 0&&g!==void 0)return Q===c.RefStyle.A1?g+T:T+g}function D(X,Q,b,R,P,A,T,g){var O=x(b.row,R,A,s.sheetRows,g),M=x(b.col,P,T,s.sheetCols,g);if(O!==void 0&&M!==void 0){var K=O[0],W=O[1],z=O[2],ee=O[3],ue=M[0],ce=M[1],he=M[2],de=M[3];if(he===0&&de===s.sheetCols-1&&P.kind===T.kind)return(0,t.formatRowRange)(X,Q,b.row,K,W,g);if(z===0&&ee===s.sheetRows-1&&R.kind===A.kind)return(0,t.formatColRange)(X,Q,b.col,ue,ce,g);var pe=L(X,Q,b,K,ue,g),_e=L(X,Q,b,W,ce,g);if(pe!==void 0&&_e!==void 0)return pe+":"+_e}}function U(X,Q){return Q===C||X.isIdentContinue(Q)}t.columnName=E,t.canonicaliseBrackets=function(X,Q){return X===c.RefStyle.R1C1&&Q.kind===c.PosKind.Rel&&Q.index!==0},t.resolvePosition=I,t.formatRow=w,t.formatCol=B,t.canonicaliseRow=k.bind(void 0,s.sheetRows),t.canonicaliseCol=k.bind(void 0,s.sheetCols),t.formatRowRange=G.bind(void 0,w,void 0,s.sheetRows),t.formatColRange=G.bind(void 0,B,function(X,Q,b){return(0,t.formatRowRange)(X,Q,0,h,S,b)},s.sheetCols),t.canonicaliseRowRange=H.bind(void 0,void 0,s.sheetRows),t.canonicaliseColRange=H.bind(void 0,[!0,h,S],s.sheetCols),t.formatCellPos=L,t.canonicaliseCellPos=function(X,Q,b,R){var P=(0,t.canonicaliseRow)(X.row,Q,R),A=(0,t.canonicaliseCol)(X.col,b,R);if(P!==void 0&&A!==void 0)return{row:P,col:A}},t.formatRangePos=D,t.canonicaliseRangePos=function(X,Q,b,R,P,A){var T=x(X.row,Q,R,s.sheetRows,A),g=x(X.col,b,P,s.sheetCols,A);if(T!==void 0&&g!==void 0){var O=T[0],M=T[1],K=T[2],W=T[3],z=g[0],ee=g[1],ue=g[2],ce=g[3],he=(0,t.canonicaliseRow)(X.row,O,A),de=(0,t.canonicaliseCol)(X.col,z,A),pe=(0,t.canonicaliseRow)(X.row,M,A),_e=(0,t.canonicaliseCol)(X.col,ee,A);if(he!==void 0&&de!==void 0&&pe!==void 0&&_e!==void 0)return ue===0&&ce===s.sheetCols-1&&b.kind===P.kind?{row1:he,row2:pe,col1:void 0,col2:void 0}:K===0&&W===s.sheetRows-1&&Q.kind===R.kind?{col1:de,col2:_e,row1:void 0,row2:void 0}:{row1:he,col1:de,row2:pe,col2:_e}}};var V=/'/g;function ne(X,Q){if(Q.length===0)return!1;var b=0,R=(0,m.stringCodePointAt)(Q,b);if(!X.isIdentStart(R))return!1;b+=(0,m.numCodeUnits)(R);for(var P=0,A=(0,m.codePointIterator)(Q,b);P<A.length;P++)if(!U(X,A[P]))return!1;return!0}var J=(0,s.gridCell)(0,0);function $(X,Q,b){if(X.stringCompareCI(b,X.trueName)===0||X.stringCompareCI(b,X.falseName)===0)return!0;var R=(0,l.parseCellRef)(X,Q,J,b,0);if(R!==void 0){if(R.refStyle===c.RefStyle.A1){var P=R.i;if(P>=b.length&&X.getWorksheetFuncId(b.substring(0,P))===void 0)return!0}else if(!(0,l.isR1C1IdentStart)(R.row,R.col))return!0}return!ne(X,b)&&!function(A,T){var g=0;if(!(0,v.stringStartsWith)(T,A.leftBracket,g)||(g+=A.leftBracket.length)===T.length)return!1;var O=(0,m.stringCodePointAt)(T,g);if(!U(A,O))return!1;for(g+=(0,m.numCodeUnits)(O);;){if((0,v.stringStartsWith)(T,A.rightBracket,g)){g+=A.rightBracket.length;break}if(g===T.length)return!1;var M=(0,m.stringCodePointAt)(T,g);if(!U(A,M))return!1;g+=(0,m.numCodeUnits)(M)}var K=T.indexOf(":",g);return K<0?ne(A,T.substring(g)):ne(A,T.substring(g,K))&&ne(A,T.substring(K+1))}(X,b)&&!function(A,T){var g=A.leftBracket.length,O=A.rightBracket.length;return!(T.length<g+O)&&T.substring(0,g)===A.leftBracket&&T.substring(T.length-O)===A.rightBracket&&ne(A,T.substring(g,T.length-O))}(X,b)}function Z(X,Q,b){return $(X,Q,b)?ie(b):b}function ie(X){return"'".concat(X.replace(V,"''"),"'")}t.shouldQuoteQualifier=$,t.formatQualifier=Z,t.quoteQualifier=ie,t.formatGridRange=function(X,Q,b,R,P){b===void 0&&(b=c.RefStyle.A1);var A=Q.cols===1&&Q.rows===1?L(X,b,(0,s.gridCell)(0,0),(0,c.pos)(c.PosKind.Rel,Q.row),(0,c.pos)(c.PosKind.Rel,Q.col),!1):D(X,b,(0,s.gridCell)(0,0),(0,c.pos)(c.PosKind.Rel,Q.row),(0,c.pos)(c.PosKind.Rel,Q.col),(0,c.pos)(c.PosKind.Rel,Q.row+Q.rows-1),(0,c.pos)(c.PosKind.Rel,Q.col+Q.cols-1),!1);if((0,f.assertTrue)("calc.lang.formatGridRange",A!==void 0),R===void 0&&P===void 0)return A;if(R===void 0||P===void 0)return Z(X,b,R??P)+"!"+A;var T=R+":"+P;return($(X,b,R)||$(X,b,P)?ie(T):T)+"!"+A},t.formatName=function(X,Q,b,R){return b===void 0&&(b=c.RefStyle.A1),R===void 0?Q:Z(X,b,R)+"!"+Q}},1646:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapPosition=t.parseQualifier=t.parseGridRangeA1=t.parseGridCellA1=t.parseCellRef=t.isR1C1IdentStart=t.SpecialPos=void 0;var s=d(9937),c=d(8350),l=d(3546),f=d(4931),p=d(1345),m=d(3883),v=d(9119),h=s.sheetRows,S=h.toString(10).length,y=s.sheetCols,C=y.toString(26).length,E=y.toString(10).length,I=p.codePointCapitalA,F=p.codePointCapitalZ,w=p.codePointSmallA,B=p.codePointSmallZ,k=p.codePointPlusSign,x=p.codePointMinusSign,G=p.codePointColon;function H(A){return A>=w&&A<=B||A>=I&&A<=F}function L(A){return 1+(A>=w?A-w:A-I)}function D(A,T,g,O){return function(M,K,W,z,ee){var ue=function(Ne,Le){return(0,m.stringStartsWith)(Ne,"$",Le)?[l.PosKind.Abs,Le+1]:[l.PosKind.Rel,Le]}(W,z),ce=ue[0],he=ue[1],de=A(M,g,W,he),pe=de[0],_e=de[1];if(_e>he){if(pe<1||pe>T)return ce===l.PosKind.Abs||(O===!0?typeof ee=="object"&&ee.kind===l.PosKind.Abs||ee===J.A1BadDollar:(0,m.stringStartsWith)(W,"$",_e))?[J.A1BadDollar,!0,_e]:void 0;var Ce=ce===l.PosKind.Rel?pe-K:pe;return[(0,l.pos)(ce,Ce-1),ce===l.PosKind.Abs,_e]}return ce!==l.PosKind.Abs||O!==!0&&_e!==W.length&&M.isNumeral((0,v.stringCodePointAt)(W,_e))?[void 0,!1,z]:[J.A1BadDollar,!0,_e]}}function U(A,T,g){return P(A,T,g)-A}function V(A,T,g,O){return function(M,K,W,z){var ee=T?A?"R":M.rowLetter:A?"C":M.columnLetter;if(z>=W.length||M.stringCompareCI(ee,W[z])!==0)return[void 0,!1,z];var ue=z+ee.length,ce=(0,f.parseUint)(M,O,W,ue),he=ce[0],de=ce[1];if(de>ue&&he>=1&&he<=g)return[(0,l.pos)(l.PosKind.Abs,he-1),!1,de];if((0,m.stringStartsWith)(W,M.rcLeftBracket,ue)){if(ue+=M.rcLeftBracket.length,(0,m.stringStartsWith)(W,M.rcRightBracket,ue))return[(0,l.pos)(l.PosKind.Rel,U(K,0,g)),!0,ue+M.rcRightBracket.length];var pe=1,_e=W.charCodeAt(ue);_e===k?ue+=1:_e===x&&(pe=-1,ue+=1);var Ce=(0,f.parseUint)(M,O,W,ue),Ne=Ce[0],Le=Ce[1];if(Le>ue&&Ne<g&&(0,m.stringStartsWith)(W,M.rcRightBracket,Le))return[(0,l.pos)(l.PosKind.Rel,U(K,Ne*pe,g)),!0,Le+M.rcRightBracket.length]}return[J.RCNoNum,!1,z+ee.length]}}function ne(A,T,g,O,M,K,W){var z=O(A,T,K,W,void 0);if(z==null)return[void 0,void 0,W];var ee=z[0],ue=z[1],ce=z[2];if(ce>W){var he=M(A,g,K,ce,ee);if(he==null)return ue?[ee,void 0,ce]:[void 0,void 0,W];var de=he[0],pe=he[2];return pe>ce?[ee,de,pe]:[ee,void 0,ce]}var _e=M(A,g,K,W,ee);if(_e==null)return[void 0,void 0,W];var Ce=_e[0],Ne=_e[2];return Ne>W?[void 0,Ce,Ne]:[void 0,void 0,W]}var J,$=D(f.parseUint,h,S,!0),Z=D(function(A,T,g,O){return function(M,K,W){for(var z=0,ee=W,ue=(0,c.fastMin)(K.length,W+M);ee<ue;ee+=1){var ce=K.charCodeAt(ee);if(!H(ce))break;z=26*z+L(ce)}return ee===ue&&ee<K.length&&H(K.charCodeAt(ee))?[0,W]:[z,ee]}(T,g,O)},y,C,!1),ie=V(!1,!0,h,S),X=V(!1,!1,y,E),Q=V(!0,!0,h,S),b=V(!0,!1,y,E);function R(A,T){return typeof A!="object"&&typeof T!="object"}function P(A,T,g){return A+T&g-1}(function(A){A[A.RCNoNum=0]="RCNoNum",A[A.A1BadDollar=1]="A1BadDollar"})(J=t.SpecialPos||(t.SpecialPos={})),t.isR1C1IdentStart=R,t.parseCellRef=function(A,T,g,O,M){var K=function(W,z,ee,ue,ce){var he=ne(W,ee.col,ee.row,Z,$,ue,ce),de=he[0],pe=he[1],_e=he[2],Ce=typeof pe=="object"&&pe.kind===l.PosKind.Abs||pe===J.A1BadDollar||typeof de=="object"&&de.kind===l.PosKind.Abs||de===J.A1BadDollar;if(pe!=null&&de!=null||Ce||(pe!=null||de!=null)&&(ce-1>=0&&ue.charCodeAt(ce-1)===G||_e<ue.length&&ue.charCodeAt(_e)===G))return _e<ue.length&&W.isIdentContinue((0,v.stringCodePointAt)(ue,_e))||z!==l.RefStyle.A1&&!Ce?void 0:{refStyle:l.RefStyle.A1,row:pe,col:de,i:_e}}(A,T,g,O,M);return K!==void 0?K:function(W,z,ee,ue,ce){var he,de=ee.col,pe=ee.row,_e=!1,Ce=ne(W,pe,de,ie,X,ue,ce),Ne=Ce[0],Le=Ce[1],Oe=Ce[2];if(Ne!=null||Le!=null||W.rowLetter==="R"&&W.columnLetter==="C"||(_e=!0,Ne=(he=ne(W,pe,de,Q,b,ue,ce))[0],Le=he[1],Oe=he[2]),(Ne!=null||Le!=null)&&(Oe>=ue.length||!R(Ne,Le)||!W.isIdentContinue((0,v.stringCodePointAt)(ue,Oe))))return{refStyle:l.RefStyle.R1C1,row:Ne,col:Le,i:Oe,enLocale:_e}}(A,0,g,O,M)},t.parseGridCellA1=function(A,T){var g=ne(A,0,0,Z,$,T,0),O=g[0],M=g[1],K=g[2];return typeof O=="object"&&typeof M=="object"&&K===T.length?(0,s.gridCell)(M.index,O.index):void 0},t.parseGridRangeA1=function(A,T){var g=ne(A,0,0,Z,$,T,0),O=g[0],M=g[1],K=g[2];if(typeof O=="object"&&typeof M=="object"){if(K===T.length)return(0,s.gridCell)(M.index,O.index);if(T.charCodeAt(K)===G){var W=ne(A,0,0,Z,$,T,K+1),z=W[0],ee=W[1],ue=W[2];if(typeof z=="object"&&typeof ee=="object"&&ue===T.length){var ce=(0,c.fastMin)(M.index,ee.index),he=(0,c.fastMin)(O.index,z.index);return(0,s.gridRange)(ce,he,(0,c.fastMax)(M.index,ee.index)+1-ce,(0,c.fastMax)(O.index,z.index)+1-he)}}}},t.parseQualifier=function(A){var T=A.lastIndexOf("!");if(!(T<0||T===0||T===A.length-1)){var g=A.substring(0,T),O=A.substring(T+1);if(g.indexOf("'")<0)return{qualifier:g,unqualified:O};if((0,m.stringStartsWith)(g,"'")&&(0,m.stringEndsWith)(g,"'")){for(var M=[],K=1;K<g.length-1;++K){var W=g.charAt(K);if(W==="'"){if(K+1>=g.length-1||g.charAt(K+1)!=="'")return;M.push(W),++K}else M.push(W)}return{qualifier:M.join(""),unqualified:O}}}},t.wrapPosition=P},4038:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.kindAnonymizers=t.anonymizeMagnitude=t.anonymizeFormulaString=t.anonymize=void 0;var s=d(637);t.anonymize=s.anonymizer.anonymize,t.anonymizeFormulaString=s.anonymizer.anonymizeFormulaString,t.anonymizeMagnitude=s.anonymizer.anonymizeMagnitude,t.kindAnonymizers=s.anonymizer.kindAnonymizers},9745:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertPositiveInteger=t.assertInteger=t.assertIndex=t.assertNatural=t.assertNever=t.assertFalse=t.assertTrue=t.ulsLogger=void 0;var s=d(637);t.ulsLogger=s.assertions.ulsLogger,t.assertTrue=s.assertions.assertTrue,t.assertFalse=s.assertions.assertFalse,t.assertNever=s.assertions.assertNever,t.assertNatural=s.assertions.assertNatural,t.assertIndex=s.assertions.assertIndex,t.assertInteger=s.assertions.assertInteger,t.assertPositiveInteger=s.assertions.assertPositiveInteger,t.assertPositiveLength=s.assertions.assertPositiveLength},1345:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codePointExclamationMark=t.codePointEuroSign=t.codePointEqualsSign=t.codePointDoubleQuote=t.codePointDollarSign=t.codePointDigitZero=t.codePointDigitTwo=t.codePointDigitThree=t.codePointDigitSix=t.codePointDigitSeven=t.codePointDigitOne=t.codePointDigitNine=t.codePointDigitFour=t.codePointDigitFive=t.codePointDigitEight=t.codePointComma=t.codePointColon=t.codePointCircumflexAccent=t.codePointCapitalZ=t.codePointCapitalY=t.codePointCapitalX=t.codePointCapitalW=t.codePointCapitalV=t.codePointCapitalU=t.codePointCapitalT=t.codePointCapitalS=t.codePointCapitalR=t.codePointCapitalQ=t.codePointCapitalP=t.codePointCapitalO=t.codePointCapitalN=t.codePointCapitalM=t.codePointCapitalL=t.codePointCapitalK=t.codePointCapitalJ=t.codePointCapitalI=t.codePointCapitalH=t.codePointCapitalG=t.codePointCapitalF=t.codePointCapitalE=t.codePointCapitalD=t.codePointCapitalC=t.codePointCapitalB=t.codePointCapitalA=t.codePointCR=t.codePointBacktick=t.codePointBackslash=t.codePointAtSign=t.codePointAsterisk=t.codePointAmpersand=void 0,t.codePointSmallW=t.codePointSmallV=t.codePointSmallU=t.codePointSmallT=t.codePointSmallS=t.codePointSmallR=t.codePointSmallQ=t.codePointSmallP=t.codePointSmallO=t.codePointSmallN=t.codePointSmallM=t.codePointSmallL=t.codePointSmallK=t.codePointSmallJ=t.codePointSmallI=t.codePointSmallH=t.codePointSmallG=t.codePointSmallF=t.codePointSmallE=t.codePointSmallD=t.codePointSmallC=t.codePointSmallB=t.codePointSmallA=t.codePointSlash=t.codePointSingleQuote=t.codePointSemicolon=t.codePointRightSquareBracket=t.codePointRightParen=t.codePointRightCurlyBracket=t.codePointQuestionMark=t.codePointPlusSign=t.codePointPipe=t.codePointPercentSign=t.codePointMinusSign=t.codePointLessThanSign=t.codePointLeftSquareBracket=t.codePointLeftParen=t.codePointLeftCurlyBracket=t.codePointLF=t.codePointInvertedQuestionMark=t.codePointInvertedExclamationMark=t.codePointHash=t.codePointGreaterThanSign=t.codePointFullwidthLatinSmallZ=t.codePointFullwidthLatinSmallA=t.codePointFullwidthLatinCapitalZ=t.codePointFullwidthLatinCapitalA=t.codePointFullwidthDigitZero=t.codePointFullwidthDigitNine=t.codePointFullStop=void 0,t.codePointUnderscore=t.codePointTilde=t.codePointThaiDigitZero=t.codePointThaiDigitNine=t.codePointTab=t.codePointSpace=t.codePointSmallZ=t.codePointSmallY=t.codePointSmallX=void 0;var s=d(637);t.codePointAmpersand=s.codePoint.codePointAmpersand,t.codePointAsterisk=s.codePoint.codePointAsterisk,t.codePointAtSign=s.codePoint.codePointAtSign,t.codePointBackslash=s.codePoint.codePointBackslash,t.codePointBacktick=s.codePoint.codePointBacktick,t.codePointCR=s.codePoint.codePointCR,t.codePointCapitalA=s.codePoint.codePointCapitalA,t.codePointCapitalB=s.codePoint.codePointCapitalB,t.codePointCapitalC=s.codePoint.codePointCapitalC,t.codePointCapitalD=s.codePoint.codePointCapitalD,t.codePointCapitalE=s.codePoint.codePointCapitalE,t.codePointCapitalF=s.codePoint.codePointCapitalF,t.codePointCapitalG=s.codePoint.codePointCapitalG,t.codePointCapitalH=s.codePoint.codePointCapitalH,t.codePointCapitalI=s.codePoint.codePointCapitalI,t.codePointCapitalJ=s.codePoint.codePointCapitalJ,t.codePointCapitalK=s.codePoint.codePointCapitalK,t.codePointCapitalL=s.codePoint.codePointCapitalL,t.codePointCapitalM=s.codePoint.codePointCapitalM,t.codePointCapitalN=s.codePoint.codePointCapitalN,t.codePointCapitalO=s.codePoint.codePointCapitalO,t.codePointCapitalP=s.codePoint.codePointCapitalP,t.codePointCapitalQ=s.codePoint.codePointCapitalQ,t.codePointCapitalR=s.codePoint.codePointCapitalR,t.codePointCapitalS=s.codePoint.codePointCapitalS,t.codePointCapitalT=s.codePoint.codePointCapitalT,t.codePointCapitalU=s.codePoint.codePointCapitalU,t.codePointCapitalV=s.codePoint.codePointCapitalV,t.codePointCapitalW=s.codePoint.codePointCapitalW,t.codePointCapitalX=s.codePoint.codePointCapitalX,t.codePointCapitalY=s.codePoint.codePointCapitalY,t.codePointCapitalZ=s.codePoint.codePointCapitalZ,t.codePointCircumflexAccent=s.codePoint.codePointCircumflexAccent,t.codePointColon=s.codePoint.codePointColon,t.codePointComma=s.codePoint.codePointComma,t.codePointDigitEight=s.codePoint.codePointDigitEight,t.codePointDigitFive=s.codePoint.codePointDigitFive,t.codePointDigitFour=s.codePoint.codePointDigitFour,t.codePointDigitNine=s.codePoint.codePointDigitNine,t.codePointDigitOne=s.codePoint.codePointDigitOne,t.codePointDigitSeven=s.codePoint.codePointDigitSeven,t.codePointDigitSix=s.codePoint.codePointDigitSix,t.codePointDigitThree=s.codePoint.codePointDigitThree,t.codePointDigitTwo=s.codePoint.codePointDigitTwo,t.codePointDigitZero=s.codePoint.codePointDigitZero,t.codePointDollarSign=s.codePoint.codePointDollarSign,t.codePointDoubleQuote=s.codePoint.codePointDoubleQuote,t.codePointEqualsSign=s.codePoint.codePointEqualsSign,t.codePointEuroSign=s.codePoint.codePointEuroSign,t.codePointExclamationMark=s.codePoint.codePointExclamationMark,t.codePointFullStop=s.codePoint.codePointFullStop,t.codePointFullwidthDigitNine=s.codePoint.codePointFullwidthDigitNine,t.codePointFullwidthDigitZero=s.codePoint.codePointFullwidthDigitZero,t.codePointFullwidthLatinCapitalA=s.codePoint.codePointFullwidthLatinCapitalA,t.codePointFullwidthLatinCapitalZ=s.codePoint.codePointFullwidthLatinCapitalZ,t.codePointFullwidthLatinSmallA=s.codePoint.codePointFullwidthLatinSmallA,t.codePointFullwidthLatinSmallZ=s.codePoint.codePointFullwidthLatinSmallZ,t.codePointGreaterThanSign=s.codePoint.codePointGreaterThanSign,t.codePointHash=s.codePoint.codePointHash,t.codePointInvertedExclamationMark=s.codePoint.codePointInvertedExclamationMark,t.codePointInvertedQuestionMark=s.codePoint.codePointInvertedQuestionMark,t.codePointLF=s.codePoint.codePointLF,t.codePointLeftCurlyBracket=s.codePoint.codePointLeftCurlyBracket,t.codePointLeftParen=s.codePoint.codePointLeftParen,t.codePointLeftSquareBracket=s.codePoint.codePointLeftSquareBracket,t.codePointLessThanSign=s.codePoint.codePointLessThanSign,t.codePointMinusSign=s.codePoint.codePointMinusSign,t.codePointPercentSign=s.codePoint.codePointPercentSign,t.codePointPipe=s.codePoint.codePointPipe,t.codePointPlusSign=s.codePoint.codePointPlusSign,t.codePointQuestionMark=s.codePoint.codePointQuestionMark,t.codePointRightCurlyBracket=s.codePoint.codePointRightCurlyBracket,t.codePointRightParen=s.codePoint.codePointRightParen,t.codePointRightSquareBracket=s.codePoint.codePointRightSquareBracket,t.codePointSemicolon=s.codePoint.codePointSemicolon,t.codePointSingleQuote=s.codePoint.codePointSingleQuote,t.codePointSlash=s.codePoint.codePointSlash,t.codePointSmallA=s.codePoint.codePointSmallA,t.codePointSmallB=s.codePoint.codePointSmallB,t.codePointSmallC=s.codePoint.codePointSmallC,t.codePointSmallD=s.codePoint.codePointSmallD,t.codePointSmallE=s.codePoint.codePointSmallE,t.codePointSmallF=s.codePoint.codePointSmallF,t.codePointSmallG=s.codePoint.codePointSmallG,t.codePointSmallH=s.codePoint.codePointSmallH,t.codePointSmallI=s.codePoint.codePointSmallI,t.codePointSmallJ=s.codePoint.codePointSmallJ,t.codePointSmallK=s.codePoint.codePointSmallK,t.codePointSmallL=s.codePoint.codePointSmallL,t.codePointSmallM=s.codePoint.codePointSmallM,t.codePointSmallN=s.codePoint.codePointSmallN,t.codePointSmallO=s.codePoint.codePointSmallO,t.codePointSmallP=s.codePoint.codePointSmallP,t.codePointSmallQ=s.codePoint.codePointSmallQ,t.codePointSmallR=s.codePoint.codePointSmallR,t.codePointSmallS=s.codePoint.codePointSmallS,t.codePointSmallT=s.codePoint.codePointSmallT,t.codePointSmallU=s.codePoint.codePointSmallU,t.codePointSmallV=s.codePoint.codePointSmallV,t.codePointSmallW=s.codePoint.codePointSmallW,t.codePointSmallX=s.codePoint.codePointSmallX,t.codePointSmallY=s.codePoint.codePointSmallY,t.codePointSmallZ=s.codePoint.codePointSmallZ,t.codePointSpace=s.codePoint.codePointSpace,t.codePointTab=s.codePoint.codePointTab,t.codePointThaiDigitNine=s.codePoint.codePointThaiDigitNine,t.codePointThaiDigitZero=s.codePoint.codePointThaiDigitZero,t.codePointTilde=s.codePoint.codePointTilde,t.codePointUnderscore=s.codePoint.codePointUnderscore},8350:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.now=t.mapFromArrayOfPairs=t.singleton=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0;var s=d(637);t.makeNewtypeIso=s.core.makeNewtypeIso,t.staticAssertExtends=s.core.staticAssertExtends,t.staticAssertSame=s.core.staticAssertSame,t.staticAssertIs=s.core.staticAssertIs,t.staticAssertIsOptional=s.core.staticAssertIsOptional,t.identity=s.core.identity,t.makeStringMap=s.core.makeStringMap,t.cloneStringMap=s.core.cloneStringMap,t.numEnumArray=s.core.numEnumArray,t.numEnumMap=s.core.numEnumMap,t.strEnumArray=s.core.strEnumArray,t.safePush=s.core.safePush,t.safeConcat=s.core.safeConcat,t.isDefined=s.core.isDefined,t.isNone=s.core.isNone,t.filterOutNones=s.core.filterOutNones,t.pair=s.core.pair,t.fastMin=s.core.fastMin,t.fastMax=s.core.fastMax,t.fastAbs=s.core.fastAbs,t.makeStringCompareCI=s.core.makeStringCompareCI,t.typedInstanceCreator=s.core.typedInstanceCreator,t.singleton=s.core.singleton,t.mapFromArrayOfPairs=s.core.mapFromArrayOfPairs,t.now=s.core.now},3116:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.enumerateKeysInOrder=t.enumerateInOrder=t.RootPointer=t.ArrayMapTree=t.floorToPowerOf2=void 0;var s=d(637);t.floorToPowerOf2=s.arrayMapTree.floorToPowerOf2,t.ArrayMapTree=s.arrayMapTree.ArrayMapTree,t.RootPointer=s.arrayMapTree.RootPointer,t.enumerateInOrder=s.arrayMapTree.enumerateInOrder,t.enumerateKeysInOrder=s.arrayMapTree.enumerateKeysInOrder},8832:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ivlCompare=t.ivlExcept=t.ivlMeetsOrTouches=t.ivlMeets=t.ivlDistance=t.ivlMeet=t.ivlJoin=void 0;var s=d(637);t.ivlJoin=s.interval.ivlJoin,t.ivlMeet=s.interval.ivlMeet,t.ivlDistance=s.interval.ivlDistance,t.ivlMeets=s.interval.ivlMeets,t.ivlMeetsOrTouches=s.interval.ivlMeetsOrTouches,t.ivlExcept=s.interval.ivlExcept,t.ivlCompare=s.interval.ivlCompare},2903:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RedBlackMapTree=void 0;var s=d(637);t.RedBlackMapTree=s.rbMapTree.RedBlackMapTree},625:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.entry=t.makeEmptyTable=void 0;var s=d(637);t.makeEmptyTable=s.table.makeEmptyTable,t.entry=s.table.entry},4611:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.isTypedChangeGateEnabled=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;var s=d(637);t.FeatureName=s.featureConfiguration.FeatureName,t.initFeatureConfiguration=s.featureConfiguration.initFeatureConfiguration,t.isFeatureEnabled=s.featureConfiguration.isFeatureEnabled,t.getFeatures=s.featureConfiguration.getFeatures,t.getTypedFeatureGate=s.featureConfiguration.getTypedFeatureGate,t.isTypedChangeGateEnabled=s.featureConfiguration.isTypedChangeGateEnabled;var c=d(9992);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return c.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return c.setFeatureGateDictionaryGetter}})},7815:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.successUndefined=t.success=t.javaScriptError=t.isSuccess=t.failure=t.ResultKind=t.ReasonKind=void 0;var s=d(637);t.ReasonKind=s.result.ReasonKind,t.ResultKind=s.result.ResultKind,t.failure=s.result.failure,t.isSuccess=s.result.isSuccess,t.javaScriptError=s.result.javaScriptError,t.success=s.result.success,t.successUndefined=s.result.successUndefined},8308:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pledge=void 0;var s=d(637);t.Pledge=s.pledge.Pledge},9119:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.surrogatePairToCodePoint=t.stringFromCodePoint=t.stringCodePointAt=t.scanCodePointsBack=t.scanCodePoints=t.numCodeUnits=t.makeGetCharCodeBits=t.isLowSurrogate=t.isHighSurrogate=t.isAnySurrogate=t.forEachClassInterval=t.countCodePoints=t.codePointIterator=t.CharCodeBits=void 0;var s=d(637);t.CharCodeBits=s.unicode.CharCodeBits,t.codePointIterator=s.unicode.codePointIterator,t.countCodePoints=s.unicode.countCodePoints,t.forEachClassInterval=s.unicode.forEachClassInterval,t.isAnySurrogate=s.unicode.isAnySurrogate,t.isHighSurrogate=s.unicode.isHighSurrogate,t.isLowSurrogate=s.unicode.isLowSurrogate,t.makeGetCharCodeBits=s.unicode.makeGetCharCodeBits,t.numCodeUnits=s.unicode.numCodeUnits,t.scanCodePoints=s.unicode.scanCodePoints,t.scanCodePointsBack=s.unicode.scanCodePointsBack,t.stringCodePointAt=s.unicode.stringCodePointAt,t.stringFromCodePoint=s.unicode.stringFromCodePoint,t.surrogatePairToCodePoint=s.unicode.surrogatePairToCodePoint},3883:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.stringStartsWith=t.stringEndsWith=t.repeat=t.prependErrorMessage=t.partialArray=t.messageFromError=t.mathLog2=t.isInteger=t.arrayFill=void 0;var s=d(637);t.arrayFill=s.util.arrayFill,t.isInteger=s.util.isInteger,t.mathLog2=s.util.mathLog2,t.messageFromError=s.util.messageFromError,t.partialArray=s.util.partialArray,t.prependErrorMessage=s.util.prependErrorMessage,t.repeat=s.util.repeat,t.stringEndsWith=s.util.stringEndsWith,t.stringStartsWith=s.util.stringStartsWith,t.values=s.util.values},3378:function(u,t,d){"use strict";var s,c,l,f,p,m;Object.defineProperty(t,"__esModule",{value:!0}),t.getEnglishLocaleInfo=t.createWorksheetFuncNameCallbacks=t.getEnglishWorksheetFuncIdToName=t.operatorIdToName=t.englishOperatorIdToName=t.englishErrorTypeToName=t.englishWorksheetFuncIdToName=t.englishSysTimeFormat=t.englishSysDateFormat=t.englishPictureDbnum=t.englishPictureColor=t.englishPictureSingle=t.englishPictureSpecial=t.englishSpecialRefNames=t.englishErrorNames=t.isIdentContinue=t.isIdentStart=t.getNumberShape=t.getOrdinal=t.isNumeral=t.PictureDbnum=t.PictureColor=t.PictureSingle=t.PictureSpecial=t.LCID=t.Country=t.localeInfo=t.calcConfig=t.ulsLogger=t.NulLogger=t.TraceLevel=t.LogCategory=void 0;var v=d(1821);Object.defineProperty(t,"LogCategory",{enumerable:!0,get:function(){return v.LogCategory}}),Object.defineProperty(t,"TraceLevel",{enumerable:!0,get:function(){return v.TraceLevel}}),Object.defineProperty(t,"NulLogger",{enumerable:!0,get:function(){return v.NulLogger}});var h=d(8350),S=d(9745);Object.defineProperty(t,"ulsLogger",{enumerable:!0,get:function(){return S.ulsLogger}});var y,C,E,I,F,w,B=d(5947),k=d(3883),x=d(9119),G=d(624),H=d(3116),L=d(2294),D=d(3546),U=d(9421),V=d(3181),ne=d(3962);function J(g,O,M,K,W,z,ee,ue,ce,he,de,pe,_e,Ce,Ne,Le,Oe,le,me,Pe,Re,fe,Se,be,xe,Ie,Ve,Ze,gr,cr,_r,xr,Or,Rr,ir,$e,qe,fr,lr,dn,Un,Gr,Br,bt,Kr,Pt,Mi,El,Nl,ys,_d,xu,pi,xa,$i,$o,ar,ye,Rd,Ji,By,nr,Rn,IS,jf,qy,Uy,MS){return{getWorksheetFuncId:g,getWorksheetFuncName:O,isNumeral:M,getOrdinal:K,getNumberShape:W,isThousandsPosition:z,isIdentStart:ee,isIdentContinue:ue,stringCompareCI:ce,errorNames:he,specialRefNames:de,trueName:pe,falseName:_e,rowLetter:Ce,columnLetter:Ne,leftBrace:Le,rightBrace:Oe,leftBracket:le,rightBracket:me,rcLeftBracket:Pe,rcRightBracket:Re,decimalSeparator:fe,listSeparator:Se,columnSeparator:be,rowSeparator:xe,thousandsSeparator:Ie,statementSeparator:Ve,lcid:Ze,country:gr,isThai:cr,isEastAsia:_r,isKorea:xr,isJapan:Or,isChinaT:Rr,isChinaS:ir,isComplexScript:$e,numberDecimals:qe,isExpSepBySpace:fr,fractionSeparator:lr,isPercentSepBySpace:dn,currencyFormat:Un,isCurrencySymbolLead:Gr,isCurrencySepBySpace:Br,currencySymbol:bt,currencyDecimals:Kr,dateOrder:Pt,dateSeparator:Mi,dateAltSeparator:El,year4Digits:Nl,month2Digits:ys,day2Digits:_d,longDateFormat:xu,timeSeparator:pi,timeAltSeparator:xa,hour2Digits:$i,clock24Hour:$o,isAMPMSepBySpace:ar,ampmSymbols:ye,dayNameShort:Rd,dayNameLong:Ji,monthNameShort:By,monthNameLong:nr,pictureSpecial:Rn,pictureSingle:IS,pictureColor:jf,pictureDbnum:qy,sysDateFormat:Uy,sysTimeFormat:MS}}function $(g){var O=0|g;if(O<128)return O>=48&&O<58;var M=15&O;switch(2147483632&O){case 1632:case 1776:case 3664:case 3792:case 3872:case 4160:case 6112:case 6160:return M<=9;case 2400:case 2528:case 2656:case 2784:case 2912:case 3040:case 3168:case 3296:case 3424:return M>=6&&M<=15;case 4960:return M>=9;case 4976:return M<=1;default:return!1}}function Z(g){var O=0|g;if(O<128)return(O<48||O>=58)&&(0,S.assertFalse)("calc.config.getOrdinal"),15&O;var M,K=15&O;switch(2147483632&O){case 1632:case 1776:case 3664:case 3792:case 3872:case 4160:case 6112:case 6160:M=K;break;case 2400:case 2528:case 2656:case 2784:case 2912:case 3040:case 3168:case 3296:case 3424:M=K-6;break;case 4960:M=K-8;break;case 4976:M=K+8;break;default:return(0,S.assertFalse)("calc.config.getOrdinal")}return(M<0||M>9||O===4968)&&(0,S.assertFalse)("calc.config.getOrdinal"),M}function ie(g){var O=0|g;if(O<128)return(O<48||O>=58)&&(0,S.assertFalse)("calc.config.getNumberShape"),U.NumberShape.ASCII;switch($(O)||(0,S.assertFalse)("calc.config.getNumberShape"),2147483632&O){case 1632:return U.NumberShape.ArabicIndic;case 1776:return U.NumberShape.ExtendedArabicIndic;case 2400:return U.NumberShape.Devanagari;case 2528:return U.NumberShape.Bengali;case 2656:return U.NumberShape.Gurmukhi;case 2784:return U.NumberShape.Gujarati;case 2912:return U.NumberShape.Oriya;case 3040:return U.NumberShape.Tamil;case 3168:return U.NumberShape.Telugu;case 3296:return U.NumberShape.Kannada;case 3424:return U.NumberShape.Malayalam;case 3664:return U.NumberShape.Thai;case 3792:return U.NumberShape.Lao;case 3872:return U.NumberShape.Tibetan;case 4160:return U.NumberShape.Myanmar;case 4960:case 4976:return U.NumberShape.Ethiopic;case 6112:return U.NumberShape.Khmer;case 6160:return U.NumberShape.Mongolian;default:return(0,S.assertFalse)("calc.config.getNumberShape")}}function X(g){return((0,G.getCharCodeBits)(g)&x.CharCodeBits.IdentStartClass)!=0}function Q(g){return((0,G.getCharCodeBits)(g)&x.CharCodeBits.IdentContinueClass)!=0}t.calcConfig=function(g,O,M,K,W,z,ee){return O===void 0&&(O=D.RefStyle.A1),M===void 0&&(M=ne.xlMathpack),K===void 0&&(K=!1),W===void 0&&(W=!0),z===void 0&&(z=V.tzUTC),ee===void 0&&(ee=V.xlDatepack),{localeInfo:g,refStyle:O,mathpack:M,date1904:K,dateCompatibility:W,timezone:z,datepack:ee}},t.localeInfo=J,function(g){g[g.USA=1]="USA",g[g.UK=44]="UK",g[g.AUS=61]="AUS",g[g.NZ=64]="NZ",g[g.UNK=1]="UNK",g[g.CAN=2]="CAN",g[g.DUT=31]="DUT",g[g.FRN=33]="FRN",g[g.SPA=34]="SPA",g[g.ITN=39]="ITN",g[g.SWE=46]="SWE",g[g.GER=49]="GER",g[g.JPN=81]="JPN",g[g.MEX=52]="MEX",g[g.BRA=55]="BRA",g[g.LAM=3]="LAM",g[g.BEL=32]="BEL",g[g.SWZ=41]="SWZ",g[g.SWG=41]="SWG",g[g.SWF=41]="SWF",g[g.AUT=43]="AUT",g[g.DAN=45]="DAN",g[g.NOR=47]="NOR",g[g.POR=351]="POR",g[g.FIN=358]="FIN",g[g.ICE=354]="ICE",g[g.GRK=30]="GRK",g[g.TUR=90]="TUR",g[g.CZE=420]="CZE",g[g.HUN=36]="HUN",g[g.POL=48]="POL",g[g.RUS=7]="RUS",g[g.HEB=972]="HEB",g[g.ARB=966]="ARB",g[g.PER=981]="PER",g[g.ARB_Algeria=213]="ARB_Algeria",g[g.ARB_Bahrain=966]="ARB_Bahrain",g[g.ARB_Djibouti=253]="ARB_Djibouti",g[g.ARB_Egypt=20]="ARB_Egypt",g[g.ARB_Iraq=964]="ARB_Iraq",g[g.ARB_Jordan=962]="ARB_Jordan",g[g.ARB_Kuwait=965]="ARB_Kuwait",g[g.ARB_Lebanon=961]="ARB_Lebanon",g[g.ARB_Libya=218]="ARB_Libya",g[g.ARB_Mauritania=222]="ARB_Mauritania",g[g.ARB_Morocco=216]="ARB_Morocco",g[g.ARB_Oman=968]="ARB_Oman",g[g.ARB_Qatar=974]="ARB_Qatar",g[g.ARB_SaudiArabia=966]="ARB_SaudiArabia",g[g.ARB_Somalia=1]="ARB_Somalia",g[g.ARB_Sudan=249]="ARB_Sudan",g[g.ARB_Syria=963]="ARB_Syria",g[g.ARB_Tunisia=216]="ARB_Tunisia",g[g.ARB_UAE=971]="ARB_UAE",g[g.ARB_Yemen=969]="ARB_Yemen",g[g.KOR=82]="KOR",g[g.TW=886]="TW",g[g.PRC=86]="PRC",g[g.THA=66]="THA",g[g.VIET=84]="VIET"}(y=t.Country||(t.Country={})),function(g){g[g.None=0]="None",g[g.USA=1033]="USA",g[g.Greek=1032]="Greek",g[g.Hungarian=1038]="Hungarian",g[g.Turkish=1055]="Turkish",g[g.Thailand=1054]="Thailand",g[g.Vietnam=1066]="Vietnam",g[g.Arabic=1025]="Arabic",g[g.Hebrew=1037]="Hebrew",g[g.Tamil=1097]="Tamil",g[g.Syriac=1114]="Syriac",g[g.Iraq=2049]="Iraq",g[g.Algerian=5121]="Algerian",g[g.Basque=1069]="Basque",g[g.PortBrazil=1046]="PortBrazil",g[g.Croatian=1050]="Croatian",g[g.Czech=1029]="Czech",g[g.Danish=1030]="Danish",g[g.Dutch=1043]="Dutch",g[g.Australian=3081]="Australian",g[g.CanadianEnglish=4105]="CanadianEnglish",g[g.British=2057]="British",g[g.Finnish=1035]="Finnish",g[g.French=1036]="French",g[g.FrenchCanadian=3084]="FrenchCanadian",g[g.Italian=1040]="Italian",g[g.NorskBokmal=1044]="NorskBokmal",g[g.NorskNynorsk=2068]="NorskNynorsk",g[g.Polish=1045]="Polish",g[g.PortIberian=2070]="PortIberian",g[g.Romanian=1048]="Romanian",g[g.Russian=1049]="Russian",g[g.Ukrainian=1058]="Ukrainian",g[g.Belarusian=1059]="Belarusian",g[g.SerbianCyrillic=3098]="SerbianCyrillic",g[g.SerbianLatin=2074]="SerbianLatin",g[g.Slovak=1051]="Slovak",g[g.Slovenian=1060]="Slovenian",g[g.SpanishModern=3082]="SpanishModern",g[g.Swedish=1053]="Swedish",g[g.HongKong=3076]="HongKong",g[g.ChinaT=1028]="ChinaT",g[g.Korea=1042]="Korea",g[g.Japan=1041]="Japan",g[g.China=2052]="China",g[g.ChinaStroke=133124]="ChinaStroke",g[g.Devihi=1125]="Devihi",g[g.Hindi=1081]="Hindi",g[g.German=1031]="German",g[g.Swiss=4108]="Swiss",g[g.SystemTime=62464]="SystemTime",g[g.SystemLongDate=63488]="SystemLongDate",g[g.EuroTrailing=1]="EuroTrailing",g[g.EuroLeading=2]="EuroLeading",g[g.LANG=1023]="LANG",g[g.COUNTRY=64512]="COUNTRY",g[g.OPTIONS=16711680]="OPTIONS"}(C=t.LCID||(t.LCID={})),function(g){g[g.AP1=0]="AP1",g[g.AP2=1]="AP2",g[g.AP3=2]="AP3",g[g.GeneralOldMAC=3]="GeneralOldMAC",g[g.General=4]="General",g[g.Currency=5]="Currency"}(E=t.PictureSpecial||(t.PictureSpecial={})),function(g){g[g.Sep=1]="Sep",g[g.Hash=2]="Hash",g[g.Zero=3]="Zero",g[g.Decimal=4]="Decimal",g[g.Percent=5]="Percent",g[g.Comma=6]="Comma",g[g.Colon=7]="Colon",g[g.DateSep=8]="DateSep",g[g.Slash=9]="Slash",g[g.Space=10]="Space",g[g.Minus=11]="Minus",g[g.Plus=12]="Plus",g[g.OpenParen=13]="OpenParen",g[g.CloseParen=14]="CloseParen",g[g.Extra=15]="Extra",g[g.Backslash=16]="Backslash",g[g.Star=17]="Star",g[g.Year=18]="Year",g[g.Month=19]="Month",g[g.Day=20]="Day",g[g.Hour=21]="Hour",g[g.Minute=22]="Minute",g[g.Second=23]="Second",g[g.E=24]="E",g[g.APDelim=25]="APDelim",g[g.Quote=26]="Quote",g[g.ColorStart=27]="ColorStart",g[g.ColorEnd=28]="ColorEnd",g[g.Text=29]="Text",g[g.Question=30]="Question",g[g.Underscore=31]="Underscore",g[g.Reign=32]="Reign",g[g.LocDay=33]="LocDay",g[g.Era=34]="Era",g[g.EraYear=35]="EraYear",g[g.Nen1=36]="Nen1",g[g.Gatsu1=37]="Gatsu1",g[g.Nichi1=38]="Nichi1",g[g.Nen2=39]="Nen2",g[g.Gatsu2=40]="Gatsu2",g[g.Nichi2=41]="Nichi2",g[g.BidiDate=42]="BidiDate",g[g.BidiNum=43]="BidiNum",g[g.DayTh=44]="DayTh",g[g.MonthTh=45]="MonthTh",g[g.YearTh=46]="YearTh",g[g.EngYearTh=47]="EngYearTh",g[g.ThYear=48]="ThYear",g[g.HourTh=49]="HourTh",g[g.MinuteTh=50]="MinuteTh",g[g.SecondTh=51]="SecondTh",g[g.ZeroTh=52]="ZeroTh"}(I=t.PictureSingle||(t.PictureSingle={})),function(g){g[g.Black=0]="Black",g[g.White=1]="White",g[g.Red=2]="Red",g[g.Green=3]="Green",g[g.Blue=4]="Blue",g[g.Yellow=5]="Yellow",g[g.Magenta=6]="Magenta",g[g.Cyan=7]="Cyan",g[g.Color=8]="Color"}(F=t.PictureColor||(t.PictureColor={})),function(g){g[g.DBNUM1=0]="DBNUM1",g[g.DBNUM2=1]="DBNUM2",g[g.DBNUM3=2]="DBNUM3",g[g.DBNUM4=3]="DBNUM4"}(w=t.PictureDbnum||(t.PictureDbnum={})),t.isNumeral=$,t.getOrdinal=Z,t.getNumberShape=ie,t.isIdentStart=X,t.isIdentContinue=Q,t.englishErrorNames=(0,k.partialArray)(((s={})[L.ErrorType.NULL]="#NULL!",s[L.ErrorType.DIV0]="#DIV/0!",s[L.ErrorType.VALUE]="#VALUE!",s[L.ErrorType.REF]="#REF!",s[L.ErrorType.NAME]="#NAME?",s[L.ErrorType.NUM]="#NUM!",s[L.ErrorType.NA]="#N/A",s[L.ErrorType.GETTING_DATA]="#GETTING_DATA",s[L.ErrorType.SPILL]="#SPILL!",s[L.ErrorType.CONNECT]="#CONNECT!",s[L.ErrorType.BLOCKED]="#BLOCKED!",s[L.ErrorType.UNKNOWN]="#UNKNOWN!",s[L.ErrorType.FIELD]="#FIELD!",s[L.ErrorType.CALC]="#CALC!",s[L.ErrorType.BUSY]="#BUSY!",s[L.ErrorType.EXTERNAL]="#EXTERNAL!",s)),t.englishSpecialRefNames=(0,k.partialArray)(((c={})[D.SpecialRefId.All]="#All",c[D.SpecialRefId.Data]="#Data",c[D.SpecialRefId.Headers]="#Headers",c[D.SpecialRefId.Totals]="#Totals",c[D.SpecialRefId.ThisRow]="#This Row",c)),t.englishPictureSpecial=(0,k.partialArray)(((l={})[E.AP1]="AM/PM",l[E.AP2]="A/P",l[E.AP3]="\u4E0A\u5348/\u4E0B\u5348",l[E.General]="General",l[E.Currency]="$",l)),t.englishPictureSingle=(0,k.partialArray)(((f={})[I.Sep]=";",f[I.Hash]="#",f[I.Zero]="0",f[I.Decimal]=".",f[I.Percent]="%",f[I.Comma]=",",f[I.Colon]=":",f[I.DateSep]="/",f[I.Slash]="/",f[I.Space]=" ",f[I.Minus]="-",f[I.Plus]="+",f[I.OpenParen]="(",f[I.CloseParen]=")",f[I.Backslash]="\\",f[I.Star]="*",f[I.Year]="y",f[I.Month]="m",f[I.Day]="d",f[I.Hour]="h",f[I.Minute]="m",f[I.Second]="s",f[I.E]="E",f[I.APDelim]="/",f[I.Quote]='"',f[I.ColorStart]="[",f[I.ColorEnd]="]",f[I.Text]="@",f[I.Question]="?",f[I.Underscore]="_",f[I.Reign]="r",f[I.LocDay]="a",f[I.Era]="g",f[I.EraYear]="e",f[I.BidiDate]="B",f[I.BidiNum]="N",f[I.DayTh]="\u0E27",f[I.MonthTh]="\u0E14",f[I.YearTh]="\u0E1B",f[I.EngYearTh]="b",f[I.ThYear]="\u0E04",f[I.HourTh]="\u0E0A",f[I.MinuteTh]="\u0E19",f[I.SecondTh]="\u0E17",f[I.ZeroTh]="\u0E50",f)),t.englishPictureColor=(0,k.partialArray)(((p={})[F.Black]="Black",p[F.White]="White",p[F.Red]="Red",p[F.Green]="Green",p[F.Blue]="Blue",p[F.Yellow]="Yellow",p[F.Magenta]="Magenta",p[F.Cyan]="Cyan",p[F.Color]="Color",p)),t.englishPictureDbnum=(0,k.partialArray)(((m={})[w.DBNUM1]="DBNum1",m[w.DBNUM2]="DBNum2",m[w.DBNUM3]="DBNum3",m[w.DBNUM4]="DBNum4",m)),t.englishSysDateFormat="dddd, mmmm dd, yyyy",t.englishSysTimeFormat="h:mm:ss AM/PM";var b=void 0;t.englishWorksheetFuncIdToName=function(g){var O=P()[g];return O===void 0?"wsf:".concat(g):O},t.englishErrorTypeToName=function(g){var O=t.englishErrorNames[g];return O===void 0?"error.type:".concat(g):O},t.englishOperatorIdToName=function(g){if(g===B.OperatorId.Isect)return" ";if(g===B.OperatorId.Union)return",";var O=B.operatorStrings[g];return O===void 0?"op:".concat(g):O},t.operatorIdToName=function(g,O,M){return O===B.OperatorId.Isect?M:O===B.OperatorId.Union?g.listSeparator:B.operatorStrings[O]};var R=/_/g;function P(){if(b==null){b=[];for(var g=0,O=(0,h.numEnumArray)(B.WorksheetFuncId);g<O.length;g++){var M=O[g],K=(0,B.getWorksheetFuncEnglishName)(M),W=K??B.WorksheetFuncId[M].replace(R,".");b[M]=W}}return b}function A(g,O){var M=function(K,W){var z=[];return W.forEach(function(ee,ue){ee!=null&&z.push([ee,ue])}),H.ArrayMapTree.create(K).setValues(z)}(g,O);return{getWorksheetFuncId:function(W){return M.getValue(W)},getWorksheetFuncName:function(W){var z=O[W];return z??(0,S.assertFalse)("calc.config.getWorksheetFuncName: unknown function ID ".concat(W))}}}t.getEnglishWorksheetFuncIdToName=P,t.createWorksheetFuncNameCallbacks=A;var T=void 0;t.getEnglishLocaleInfo=function(){return T==null&&(T=function(){var g=P(),O=(0,h.makeStringCompareCI)("en-US"),M=A(O,g);return J(M.getWorksheetFuncId,M.getWorksheetFuncName,$,Z,ie,function(K){return K>0&&K%3==0},X,Q,O,t.englishErrorNames,t.englishSpecialRefNames,"TRUE","FALSE","R","C","{","}","[","]","[","]",".",",",",",";",",",";",C.USA,y.USA,!1,!1,!1,!1,!1,!1,!1,2,!1," ",!1,U.CurrencyFormat.Paren,!0,!1,"$",2,U.DateOrder.MDY,"/","-",!0,!1,!1,!0,":",void 0,!1,!1,!0,["AM","PM"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],t.englishPictureSpecial,t.englishPictureSingle,t.englishPictureColor,t.englishPictureDbnum,t.englishSysDateFormat,t.englishSysTimeFormat)}()),T}},3181:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlDatepack=t.TimeGranularity=t.TimeDivision=t.dateTime=t.Rounding=t.tzUTC=t.tzData=void 0;var s,c=d(9799),l=d(2294),f=d(8350);t.tzData=(0,f.typedInstanceCreator)()(function(p,m,v,h,S){return{bias:p,standardDate:m,standardBias:v,daylightDate:h,daylightBias:S}}),t.tzUTC=(0,t.tzData)(0,void 0,0,void 0,0),t.Rounding=c.dtr.Rounding,t.dateTime=c.dtr.dtr,t.TimeDivision=c.dtr.TimeDivision,(s=t.TimeGranularity||(t.TimeGranularity={}))[s.Year=0]="Year",s[s.Day=1]="Day",s[s.Instant=2]="Instant",t.xlDatepack={fromNum:function(m,v,h){return c.dtr.fromNum(m.mathpack.toNumber(v),h,m.date1904,m.dateCompatibility)},toNum:function(m,v){var h=c.dtr.toNum(v,m.date1904,m.dateCompatibility);return typeof h=="number"?m.mathpack.fromNumber(h):l.numErrorOper},toNumWithDuration:function(m,v,h,S){var y=c.dtr.toNumWithDuration(v,m.date1904,m.dateCompatibility,h,S);return typeof y=="number"?m.mathpack.fromNumber(y):l.numErrorOper},daysPerMonth:c.dtr.daysPerMonth,toDays:function(m,v){return c.dtr.toDays(v,m.date1904,m.dateCompatibility)},toTime:function(m,v,h,S){return c.dtr.toTime(m.mathpack.toNumber(v),h,S)},utcToLocal:function(m,v,h){return c.dtr.utcToLocal(v,h,m.date1904,m.dateCompatibility)}}},3546:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parenNode=t.wsfNode=t.operatorNode=t.lambdaNode=t.lambdaParam=t.paramNode=t.paramDefault=t.paramName=t.flattenLambdaArgs=t.letNode=t.letVar=t.indexedArg=t.flattenLetArgs=t.appNode=t.arrayNode=t.literalNode=t.formulaRootAnnotation=t.localNameDeclAnnotation=t.localNameUseAnnotation=t.formulaSpan=t.multiLineComment=t.singleLineComment=t.formula=t.cellRefBad=t.cellRefCol=t.cellRefRow=t.cellRefRange=t.cellRefSingle=t.cellRefError=t.pos=t.badQualifier=t.sheetRangeQualifier=t.identQualifier=t.sheetQualifier=t.documentQualifier=t.relativeQualifier=t.errorQualifier=t.BadType=t.StructRefKind=t.SpecialRefId=t.NamePartKind=t.NodeKind=t.appHeadNameAnnotation=t.AnnotationKind=t.CommentKind=t.PosKind=t.CellRefKind=t.QualifierKind=t.SyntaxFeature=t.RefStyle=void 0,t.getDepthUpperBound=t.badNode=t.structRef=t.badRef=t.missingRef=t.thisRowOpRef=t.commaOpRef=t.rangeOpRef=t.columnRef=t.specialRef=t.structRefNode=t.fieldRef=t.fieldRefNode=t.cellRefNode=t.contextNameNode=t.headNamePart=t.flattenNameParts=t.fieldRefNamePart=t.cellRefNamePart=t.identNamePart=t.nameNode=void 0;var s,c,l,f,p,m,v,h,S,y,C,E,I=d(655),F=d(9745),w=d(8350),B=d(8350);function k(b){return Array.isArray(b)}function x(b){return b.kind!==void 0}function G(b){for(var R=[],P=0,A=b;P<A.length;P++){var T=A[P],g=T.arg,O=T.index;(0,F.assertIndex)("calc.lang.flattenNumberedArgs: idx",O,b.length),(0,F.assertTrue)("calc.lang.flattenNumberedArgs: repetition",R[O]===void 0),R[O]=g}return R}function H(b,R,P){return G((0,B.safeConcat)(I.__spreadArray(I.__spreadArray([],R===void 0?[]:[R],!0),P,!0),b.map(function(A){return[A.name,A.binder]})))}function L(b,R){return{arg:b,index:R}}function D(b,R){return{name:b,binder:R}}function U(b,R,P){return P===void 0&&(P=[]),G(I.__spreadArray(I.__spreadArray(I.__spreadArray([],b.map(function(A){return A.name}),!0),R===void 0?[]:[R],!0),P,!0))}function V(b,R,P,A){return P===void 0&&(P=!0),A===void 0&&(A=0),{kind:p.ParamName,label:A,name:b,isBracketed:R,isClosed:P}}function ne(b,R,P){return P===void 0&&(P=0),{kind:p.Param,label:P,name:b,whole:b.name.kind===p.Name?b.name.whole:void 0,def:R,isOptional:b.isBracketed||R!==void 0}}function J(b){return{name:b}}function $(b,R,P){P===void 0&&(P=0);var A=typeof b=="string"?b:b.asWhole,T=typeof b=="string"?Z(b,!0):b;return{kind:p.Name,label:P,whole:A,parts:T,qualifier:R}}function Z(b,R,P,A){return R===void 0&&(R=!0),P===void 0&&(P=0),A===void 0&&(A=0),{kind:m.IdentNamePart,label:P,qualifiedLabel:A,asWhole:b,canDenoteNamedObject:R}}function ie(b,R,P,A){return R===void 0&&(R=!1),P===void 0&&(P=!0),A===void 0&&(A=0),(0,F.assertTrue)("calc.lang.fieldRef",typeof b=="string"||b.kind!==p.Name||b.qualifier===void 0),{kind:p.FieldRefRHS,label:A,field:typeof b=="string"?$(b):b,isBracketed:R,isClosed:P}}function X(b,R){if(R>50)return 1/0;switch(b.kind){case p.Array:for(var P=0,A=0,T=b.nodes;A<T.length;A++)for(var g=0,O=T[A];g<O.length;g++){var M=O[g];P=(0,w.fastMax)(P,X(M,R+1))}return P+1;case p.Param:return b.def===void 0?1:X(b.def.rhs,R+1)+1;case p.Let:case p.Lambda:case p.App:P=X(b.head,R+1);for(var K=0,W=b.args;K<W.length;K++){var z=W[K];P=(0,w.fastMax)(P,X(z,R+1))}return P+1;case p.Paren:return X(b.node,R+1)+1;case p.FieldRef:return X(b.lhs,R+1)+1;case p.Name:case p.CellRef:case p.StructRef:case p.Literal:case p.Operator:case p.WSF:return 1;case p.Bad:switch(b.type){case S.Sequence:case S.StructRef:case S.FieldRef:P=0;for(var ee=0,ue=b.contents;ee<ue.length;ee++){var ce=ue[ee];P=(0,w.fastMax)(P,X(ce,R+1))}return P+1;default:return typeof b.contents=="string"?1:(0,F.assertNever)("calc.lang.getDepthUpperBound",b.contents)}default:return(0,F.assertNever)("calc.lang.getDepthUpperBound",b)}}function Q(b){return X(b,0)}(E=t.RefStyle||(t.RefStyle={}))[E.R1C1=1]="R1C1",E[E.A1=2]="A1",(C=t.SyntaxFeature||(t.SyntaxFeature={})).Comments="Comments",C.Statements="Statements",function(b){b.Error="ErrorQualifier",b.Relative="RelativeQualifier",b.Document="DocumentQualifier",b.Sheet="SheetQualifier",b.Ident="IdentQualifier",b.SheetRange="SheetRangeQualifier",b.Bad="BadQualifier"}(s=t.QualifierKind||(t.QualifierKind={})),function(b){b.Error="CellRefError",b.Single="CellRefSingle",b.Range="CellRefRange",b.Row="CellRefRow",b.Col="CellRefCol",b.Bad="CellRefBad"}(c=t.CellRefKind||(t.CellRefKind={})),(y=t.PosKind||(t.PosKind={})).Abs="Abs",y.Rel="Rel",function(b){b.SingleLine="SingleLineComment",b.MultiLine="MultiLineComment"}(l=t.CommentKind||(t.CommentKind={})),function(b){b.LocalNameUse="LocalNameUse",b.LocalNameDecl="LocalNameDecl",b.AppHeadName="AppHeadName",b.FormulaRoot="FormulaRoot"}(f=t.AnnotationKind||(t.AnnotationKind={})),t.appHeadNameAnnotation={kind:f.AppHeadName},function(b){b.Literal="Literal",b.Array="Array",b.App="App",b.Let="Let",b.Lambda="Lambda",b.Paren="Paren",b.Name="Name",b.CellRef="CellRef",b.FieldRef="FieldRef",b.StructRef="StructRef",b.Bad="Bad",b.Operator="Operator",b.WSF="WSF",b.Param="Param",b.ContextName="ContextName",b.ParamName="ParamName",b.ParamDef="ParamDef",b.FieldRefRHS="FieldRefRHS",b.StructRefRHS="StructRefRHS"}(p=t.NodeKind||(t.NodeKind={})),function(b){b.IdentNamePart="IdentNamePart",b.CellRefNamePart="CellRefNamePart",b.FieldRefNamePart="FieldRefNamePart"}(m=t.NamePartKind||(t.NamePartKind={})),function(b){b[b.All=1]="All",b[b.Data=2]="Data",b[b.Headers=3]="Headers",b[b.Totals=4]="Totals",b[b.ThisRow=5]="ThisRow"}(v=t.SpecialRefId||(t.SpecialRefId={})),function(b){b.SpecialRef="SpecialStructRef",b.ColumnRef="ColumnStructRef",b.RangeOpRef="RangeOpStructRef",b.CommaOpRef="CommaOpStructRef",b.ThisRowOpRef="ThisRowOpStructRef",b.MissingRef="MissingStructRef",b.BadRef="BadStructRef"}(h=t.StructRefKind||(t.StructRefKind={})),function(b){b.Unexpected="Unexpected",b.Qualifier="Qualifier",b.NumberLiteral="NumberLiteral",b.StringLiteral="StringLiteral",b.ErrorLiteral="ErrorLiteral",b.FieldName="FieldName",b.ParamName="ParamName",b.Missing="Missing",b.Sequence="Sequence",b.StructRef="StructRef",b.FieldRef="FieldRef"}(S=t.BadType||(t.BadType={})),t.errorQualifier=function(b){return b===void 0&&(b=0),{kind:s.Error,isQuoted:!1,label:b}},t.relativeQualifier=function(b){return b===void 0&&(b=0),{kind:s.Relative,isQuoted:!1,label:b}},t.documentQualifier=function(b,R,P,A){return P===void 0&&(P=!1),A===void 0&&(A=0),{kind:s.Document,isQuoted:P,label:A,document:b,path:R}},t.sheetQualifier=function(b,R,P,A){return P===void 0&&(P=!1),A===void 0&&(A=0),{kind:s.Sheet,isQuoted:P,label:A,sheet:b,document:R}},t.identQualifier=function(b,R,P){return R===void 0&&(R=!1),P===void 0&&(P=0),{kind:s.Ident,isQuoted:R,label:P,name:b}},t.sheetRangeQualifier=function(b,R,P,A,T){return A===void 0&&(A=!1),T===void 0&&(T=0),{kind:s.SheetRange,isQuoted:A,label:T,sheet1:b,sheet2:R,document:P}},t.badQualifier=function(b,R,P){return R===void 0&&(R=!1),P===void 0&&(P=0),{kind:s.Bad,isQuoted:R,label:P,chars:b}},t.pos=function(b,R){return{kind:b,index:R}},t.cellRefError=function(b){return b===void 0&&(b=0),{kind:c.Error,label:b,isBracketed:!1}},t.cellRefSingle=function(b,R,P,A){return P===void 0&&(P=!1),A===void 0&&(A=0),{kind:c.Single,label:A,row:b,col:R,isBracketed:P}},t.cellRefRange=function(b,R,P){P===void 0&&(P=0);var A=b.isBracketed||R.isBracketed;return{kind:c.Range,label:P,ref1:b,ref2:R,isBracketed:A}},t.cellRefRow=function(b,R,P,A){return P===void 0&&(P=!1),A===void 0&&(A=0),{kind:c.Row,label:A,row1:b,row2:R,isBracketed:P}},t.cellRefCol=function(b,R,P,A){return P===void 0&&(P=!1),A===void 0&&(A=0),{kind:c.Col,label:A,col1:b,col2:R,isBracketed:P}},t.cellRefBad=function(b,R,P){return R===void 0&&(R=!1),P===void 0&&(P=0),{kind:c.Bad,label:P,chars:b,isBracketed:R}},t.formula=function(b,R,P,A){return{node:b,spans:R,annotations:P,depthUpperBound:A??Q(b)}},t.singleLineComment=function(b,R){return R===void 0&&(R=0),{kind:l.SingleLine,label:R,chars:b,isClosed:!0}},t.multiLineComment=function(b,R,P){return R===void 0&&(R=!0),P===void 0&&(P=0),{kind:l.MultiLine,label:P,chars:b,isClosed:R}},t.formulaSpan=function(b,R,P,A,T,g){return(0,F.assertNatural)("calc.lang.formulaSpan",b),(0,F.assertInteger)("calc.lang.formulaSpan",R),R<b&&(0,F.assertFalse)("calc.lang.formulaSpan: expected end >= ".concat(b,"; given ").concat(R)),{start:b,end:R,pre:P,post:A,preComments:T,postComments:g}},t.localNameUseAnnotation=function(b,R,P){return{kind:f.LocalNameUse,name:b,whole:R,label:P}},t.localNameDeclAnnotation=function(b,R,P){return P===void 0&&(P=[]),{kind:f.LocalNameDecl,name:b,whole:R,uses:P}},t.formulaRootAnnotation=function(b,R){return{kind:f.FormulaRoot,contextNames:b,syntaxFeatures:R}},t.literalNode=function(b,R,P){return R===void 0&&(R=!0),P===void 0&&(P=0),{kind:p.Literal,label:P,oper:b,isClosed:R}},t.arrayNode=function(b,R,P){return R===void 0&&(R=!0),P===void 0&&(P=0),{kind:p.Array,label:P,nodes:b,isClosed:R}},t.appNode=function(b,R,P,A){return P===void 0&&(P=!0),A===void 0&&(A=0),{kind:p.App,label:A,head:b,args:R,isClosed:P}},t.flattenLetArgs=H,t.indexedArg=L,t.letVar=D,t.letNode=function(b,R,P,A,T,g){A===void 0&&(A=[]),T===void 0&&(T=!0),g===void 0&&(g=0),(0,F.assertTrue)("calc.lang.letNode",R.every(function(W){return(k(W)?W[0]:W.name.arg).qualifier===void 0}));var O=R.map(function(W,z){return k(W)?D(L(W[0],2*z),L(W[1],2*z+1)):W}).sort(function(W,z){return W.name.index-z.name.index}),M=P!==void 0&&x(P)?L(P,2*R.length):P,K=H(O,M,A);return{kind:p.Let,label:g,head:b,args:K,isClosed:T,vars:O,body:M,badArgs:A}},t.flattenLambdaArgs=U,t.paramName=V,t.paramDefault=function(b,R){return R===void 0&&(R=0),{kind:p.ParamDef,label:R,rhs:b}},t.paramNode=ne,t.lambdaParam=J,t.lambdaNode=function(b,R,P,A,T,g){A===void 0&&(A=[]),T===void 0&&(T=!0),g===void 0&&(g=0),(0,F.assertTrue)("calc.lang.lambdaNode",R.every(function(W){var z=x(W)?W:W.name.arg,ee=z.kind===p.Name?z:z.name.name;return ee.kind!==p.Name||ee.qualifier===void 0}));var O=R.map(function(W,z){return x(W)?W.kind===p.Name?J(L(ne(V(W,!1),void 0),z)):J(L(W,z)):W}).sort(function(W,z){return W.name.index-z.name.index}),M=P!==void 0&&x(P)?L(P,R.length):P,K=U(O,M,A);return{kind:p.Lambda,label:g,head:b,args:K,isClosed:T,params:O,body:M,badArgs:A}},t.operatorNode=function(b,R){return R===void 0&&(R=0),{kind:p.Operator,label:R,id:b}},t.wsfNode=function(b,R,P){return P===void 0&&(P=0),{kind:p.WSF,label:P,id:b,whole:R}},t.parenNode=function(b,R,P){return R===void 0&&(R=!0),P===void 0&&(P=0),{kind:p.Paren,label:P,node:b,isClosed:R}},t.nameNode=$,t.identNamePart=Z,t.cellRefNamePart=function(b,R,P,A){return P===void 0&&(P=0),A===void 0&&(A=0),{kind:m.CellRefNamePart,label:P,qualifiedLabel:A,asWhole:R,canDenoteNamedObject:!1,ref:b}},t.fieldRefNamePart=function(b,R,P,A,T){var g,O;P===void 0&&(P=!0),A===void 0&&(A=0),T===void 0&&(T=0);var M=typeof R=="string"?ie(R,!1,!0):R;return(0,F.assertTrue)("calc.lang.fieldRefNamePart",((g=M==null?void 0:M.isClosed)===null||g===void 0||g)&&!((O=M==null?void 0:M.isBracketed)!==null&&O!==void 0&&O)),{kind:m.FieldRefNamePart,label:A,qualifiedLabel:T,asWhole:b.asWhole+"."+(M===void 0?"":M.field.kind===p.Name?M.field.whole:M.field.contents),canDenoteNamedObject:P,lhs:b,rhs:M}},t.flattenNameParts=function(b){for(var R=[b],P=R[0];P.kind===m.FieldRefNamePart;)R.push(P.lhs),P=P.lhs;return R.reverse(),{kind:P.kind,parts:R}},t.headNamePart=function(b){for(var R=b;R.kind===m.FieldRefNamePart;)R=R.lhs;return R},t.contextNameNode=function(b,R){return R===void 0&&(R=0),{kind:p.ContextName,label:R,whole:b}},t.cellRefNode=function(b,R,P){return P===void 0&&(P=0),{kind:p.CellRef,label:P,ref:b,qualifier:R}},t.fieldRefNode=function(b,R,P,A){return P===void 0&&(P=!1),A===void 0&&(A=0),{kind:p.FieldRef,label:A,lhs:b,rhs:R,shouldBeBracketed:P}},t.fieldRef=ie,t.structRefNode=function(b,R,P){return P===void 0&&(P=0),{kind:p.StructRef,label:P,lhs:b,rhs:R}},t.specialRef=function(b,R,P,A){return R===void 0&&(R=!1),P===void 0&&(P=!0),A===void 0&&(A=0),{kind:h.SpecialRef,label:A,id:b,isBracketed:R,isClosed:P}},t.columnRef=function(b,R,P,A){return R===void 0&&(R=!1),P===void 0&&(P=!0),A===void 0&&(A=0),{kind:h.ColumnRef,label:A,name:b,isBracketed:R,isClosed:P}},t.rangeOpRef=function(b,R,P){return P===void 0&&(P=0),{kind:h.RangeOpRef,label:P,lhs:b,rhs:R}},t.commaOpRef=function(b,R){var P;R===void 0&&(R=0);for(var A=((P={})[v.All]=!1,P[v.Data]=!1,P[v.Headers]=!1,P[v.Totals]=!1,P[v.ThisRow]=!1,P),T=[],g=0,O=b;g<O.length;g++){var M=O[g];switch(M.kind){case h.SpecialRef:A[M.id]=!0;break;case h.ColumnRef:case h.RangeOpRef:T.push(M)}}return{kind:h.CommaOpRef,label:R,refs:b,specialRefs:A,columnRefs:T}},t.thisRowOpRef=function(b,R){return R===void 0&&(R=0),{kind:h.ThisRowOpRef,label:R,ref:b}},t.missingRef=function(b){return b===void 0&&(b=0),{kind:h.MissingRef,label:b}},t.badRef=function(b,R,P,A){return R===void 0&&(R=!1),P===void 0&&(P=!0),A===void 0&&(A=0),{kind:h.BadRef,contents:b,isBracketed:R,isClosed:P,label:A}},t.structRef=function(b,R,P){return R===void 0&&(R=!0),P===void 0&&(P=0),{kind:p.StructRefRHS,label:P,isClosed:R,innerRef:b}},t.badNode=function(b,R,P){return P===void 0&&(P=0),{kind:p.Bad,label:P,type:b,contents:R}},t.getDepthUpperBound=Q},624:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCharCodeBits=void 0;var s=d(637).unicode.makeGetCharCodeBits;t.getCharCodeBits=s([65,91,92,93,95,96,97,123,170,171,181,182,186,187,192,215,216,247,248,706,710,722,736,741,748,749,750,751,880,885,886,888,890,894,895,896,902,903,904,907,908,909,910,930,931,1014,1015,1154,1162,1328,1329,1367,1369,1370,1376,1417,1488,1515,1519,1523,1568,1611,1646,1648,1649,1748,1749,1750,1765,1767,1774,1776,1786,1789,1791,1792,1808,1809,1810,1840,1869,1958,1969,1970,1994,2027,2036,2038,2042,2043,2048,2070,2074,2075,2084,2085,2088,2089,2112,2137,2144,2155,2208,2229,2230,2248,2308,2362,2365,2366,2384,2385,2392,2402,2417,2433,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2493,2494,2510,2511,2524,2526,2527,2530,2544,2546,2556,2557,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2649,2653,2654,2655,2674,2677,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2749,2750,2768,2769,2784,2786,2809,2810,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2877,2878,2908,2910,2911,2914,2929,2930,2947,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3024,3025,3077,3085,3086,3089,3090,3113,3114,3130,3133,3134,3160,3163,3168,3170,3200,3201,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3261,3262,3294,3295,3296,3298,3313,3315,3332,3341,3342,3345,3346,3387,3389,3390,3406,3407,3412,3415,3423,3426,3450,3456,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3585,3643,3648,3663,3713,3715,3716,3717,3718,3723,3724,3748,3749,3750,3751,3761,3762,3764,3773,3774,3776,3781,3782,3783,3804,3808,3840,3841,3904,3912,3913,3949,3976,3981,4096,4139,4159,4160,4176,4182,4186,4190,4193,4194,4197,4199,4206,4209,4213,4226,4238,4239,4256,4294,4295,4296,4301,4302,4304,4347,4348,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4992,5008,5024,5110,5112,5118,5121,5741,5743,5760,5761,5787,5792,5867,5870,5881,5888,5901,5902,5906,5920,5938,5952,5970,5984,5997,5998,6001,6016,6068,6103,6104,6108,6109,6176,6265,6272,6313,6314,6315,6320,6390,6400,6431,6480,6510,6512,6517,6528,6572,6576,6602,6656,6679,6688,6741,6823,6824,6917,6964,6981,6988,7043,7073,7086,7088,7098,7142,7168,7204,7245,7248,7258,7294,7296,7305,7312,7355,7357,7360,7401,7405,7406,7412,7413,7415,7418,7419,7424,7616,7680,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8125,8126,8127,8130,8133,8134,8141,8144,8148,8150,8156,8160,8173,8178,8181,8182,8189,8305,8306,8319,8320,8336,8349,8450,8451,8455,8456,8458,8468,8469,8470,8472,8478,8484,8485,8486,8487,8488,8489,8490,8506,8508,8512,8517,8522,8526,8527,8544,8585,11264,11311,11312,11359,11360,11493,11499,11503,11506,11508,11520,11558,11559,11560,11565,11566,11568,11624,11631,11632,11648,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,12293,12296,12321,12330,12337,12342,12344,12349,12353,12439,12443,12448,12449,12539,12540,12544,12549,12592,12593,12687,12704,12736,12784,12800,13312,19904,19968,40957,40960,42125,42192,42238,42240,42509,42512,42528,42538,42540,42560,42607,42623,42654,42656,42736,42775,42784,42786,42889,42891,42944,42946,42955,42997,43010,43011,43014,43015,43019,43020,43043,43072,43124,43138,43188,43250,43256,43259,43260,43261,43263,43274,43302,43312,43335,43360,43389,43396,43443,43471,43472,43488,43493,43494,43504,43514,43519,43520,43561,43584,43587,43588,43596,43616,43639,43642,43643,43646,43696,43697,43698,43701,43703,43705,43710,43712,43713,43714,43715,43739,43742,43744,43755,43762,43765,43777,43783,43785,43791,43793,43799,43808,43815,43816,43823,43824,43867,43868,43882,43888,44003,44032,55204,55216,55239,55243,55292,63744,64110,64112,64218,64256,64263,64275,64280,64285,64286,64287,64297,64298,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64434,64467,64830,64848,64912,64914,64968,65008,65020,65136,65141,65142,65277,65313,65339,65345,65371,65382,65471,65474,65480,65482,65488,65490,65496,65498,65501],[48,58,63,64,65,91,92,93,95,96,97,123,162,167,168,171,174,177,178,182,183,187,188,191,192,215,216,247,248,888,890,894,895,896,900,907,908,909,910,930,931,1328,1329,1367,1369,1370,1376,1417,1421,1424,1425,1470,1471,1472,1473,1475,1476,1478,1479,1480,1488,1515,1519,1523,1536,1545,1547,1548,1550,1563,1564,1565,1567,1642,1646,1748,1749,1792,1807,1867,1869,1970,1984,2039,2042,2043,2045,2094,2112,2140,2144,2155,2208,2229,2230,2248,2259,2404,2406,2416,2417,2436,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2492,2501,2503,2505,2507,2511,2519,2520,2524,2526,2527,2532,2534,2557,2558,2559,2561,2564,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2620,2621,2622,2627,2631,2633,2635,2638,2641,2642,2649,2653,2654,2655,2662,2678,2689,2692,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2748,2758,2759,2762,2763,2766,2768,2769,2784,2788,2790,2800,2801,2802,2809,2816,2817,2820,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2876,2885,2887,2889,2891,2894,2901,2904,2908,2910,2911,2916,2918,2936,2946,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3006,3011,3014,3017,3018,3022,3024,3025,3031,3032,3046,3067,3072,3085,3086,3089,3090,3113,3114,3130,3133,3141,3142,3145,3146,3150,3157,3159,3160,3163,3168,3172,3174,3184,3192,3204,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3260,3269,3270,3273,3274,3278,3285,3287,3294,3295,3296,3300,3302,3312,3313,3315,3328,3341,3342,3345,3346,3397,3398,3401,3402,3408,3412,3428,3430,3456,3457,3460,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3530,3531,3535,3541,3542,3543,3544,3552,3558,3568,3570,3572,3585,3643,3647,3663,3664,3674,3713,3715,3716,3717,3718,3723,3724,3748,3749,3750,3751,3774,3776,3781,3782,3783,3784,3790,3792,3802,3804,3808,3840,3844,3859,3860,3861,3898,3902,3912,3913,3949,3953,3973,3974,3992,3993,4029,4030,4045,4046,4048,4053,4057,4096,4170,4176,4294,4295,4296,4301,4302,4304,4347,4348,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4957,4960,4969,4989,4992,5018,5024,5110,5112,5118,5121,5742,5743,5760,5761,5787,5792,5867,5870,5881,5888,5901,5902,5909,5920,5941,5952,5972,5984,5997,5998,6001,6002,6004,6016,6100,6103,6104,6107,6110,6112,6122,6128,6138,6155,6159,6160,6170,6176,6265,6272,6315,6320,6390,6400,6431,6432,6444,6448,6460,6464,6465,6470,6510,6512,6517,6528,6572,6576,6602,6608,6619,6622,6684,6688,6751,6752,6781,6783,6794,6800,6810,6823,6824,6832,6849,6912,6988,6992,7002,7009,7037,7040,7156,7168,7224,7232,7242,7245,7294,7296,7305,7312,7355,7357,7360,7376,7379,7380,7419,7424,7674,7675,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8133,8134,8148,8150,8156,8157,8176,8178,8181,8182,8191,8203,8208,8234,8239,8255,8257,8260,8261,8274,8275,8276,8277,8288,8293,8294,8306,8308,8317,8319,8333,8336,8349,8352,8384,8400,8433,8448,8588,8592,9001,9003,9255,9280,9291,9312,10088,10102,10181,10183,10214,10224,10627,10649,10712,10716,10748,10750,11124,11126,11158,11159,11311,11312,11359,11360,11508,11517,11518,11520,11558,11559,11560,11565,11566,11568,11624,11631,11632,11647,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,11744,11776,11823,11824,11856,11858,11904,11930,11931,12020,12032,12246,12272,12284,12292,12296,12306,12308,12320,12336,12337,12349,12350,12352,12353,12439,12441,12448,12449,12539,12540,12544,12549,12592,12593,12687,12688,12772,12784,12831,12832,40957,40960,42125,42128,42183,42192,42238,42240,42509,42512,42540,42560,42611,42612,42622,42623,42738,42752,42944,42946,42955,42997,43053,43056,43066,43072,43124,43136,43206,43216,43226,43232,43256,43259,43260,43261,43310,43312,43348,43360,43389,43392,43457,43471,43482,43488,43519,43520,43575,43584,43598,43600,43610,43616,43715,43739,43742,43744,43760,43762,43767,43777,43783,43785,43791,43793,43799,43808,43815,43816,43823,43824,43884,43888,44011,44012,44014,44016,44026,44032,55204,55216,55239,55243,55292,63744,64110,64112,64218,64256,64263,64275,64280,64285,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64450,64467,64830,64848,64912,64914,64968,65008,65022,65024,65040,65056,65072,65075,65077,65101,65104,65122,65123,65124,65127,65129,65130,65136,65141,65142,65277,65279,65280,65284,65285,65291,65292,65296,65306,65308,65311,65313,65339,65342,65371,65372,65373,65374,65375,65382,65471,65474,65480,65482,65488,65490,65496,65498,65501,65504,65511,65512,65519,65529,65534])},3494:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.worksheetFuncTypes=t.worksheetFuncEnglishNames=t.WorksheetFuncId=void 0;var s,c=d(3424);(s=t.WorksheetFuncId||(t.WorksheetFuncId={}))[s.COUNT=0]="COUNT",s[s.IF=1]="IF",s[s.ISNA=2]="ISNA",s[s.ISERROR=3]="ISERROR",s[s.SUM=4]="SUM",s[s.AVERAGE=5]="AVERAGE",s[s.MIN=6]="MIN",s[s.MAX=7]="MAX",s[s.ROW=8]="ROW",s[s.COLUMN=9]="COLUMN",s[s.NA=10]="NA",s[s.NPV=11]="NPV",s[s.STDEV=12]="STDEV",s[s.DOLLAR=13]="DOLLAR",s[s.FIXED=14]="FIXED",s[s.SIN=15]="SIN",s[s.COS=16]="COS",s[s.TAN=17]="TAN",s[s.ATAN=18]="ATAN",s[s.PI=19]="PI",s[s.SQRT=20]="SQRT",s[s.EXP=21]="EXP",s[s.LN=22]="LN",s[s.LOG10=23]="LOG10",s[s.ABS=24]="ABS",s[s.INT=25]="INT",s[s.SIGN=26]="SIGN",s[s.ROUND=27]="ROUND",s[s.LOOKUP=28]="LOOKUP",s[s.INDEX=29]="INDEX",s[s.REPT=30]="REPT",s[s.MID=31]="MID",s[s.LEN=32]="LEN",s[s.VALUE=33]="VALUE",s[s.TRUE=34]="TRUE",s[s.FALSE=35]="FALSE",s[s.AND=36]="AND",s[s.OR=37]="OR",s[s.NOT=38]="NOT",s[s.MOD=39]="MOD",s[s.DCOUNT=40]="DCOUNT",s[s.DSUM=41]="DSUM",s[s.DAVERAGE=42]="DAVERAGE",s[s.DMIN=43]="DMIN",s[s.DMAX=44]="DMAX",s[s.DSTDEV=45]="DSTDEV",s[s.VAR=46]="VAR",s[s.DVAR=47]="DVAR",s[s.TEXT=48]="TEXT",s[s.LINEST=49]="LINEST",s[s.TREND=50]="TREND",s[s.LOGEST=51]="LOGEST",s[s.GROWTH=52]="GROWTH",s[s.GOTO=53]="GOTO",s[s.HALT=54]="HALT",s[s.RETURN=55]="RETURN",s[s.PV=56]="PV",s[s.FV=57]="FV",s[s.NPER=58]="NPER",s[s.PMT=59]="PMT",s[s.RATE=60]="RATE",s[s.MIRR=61]="MIRR",s[s.IRR=62]="IRR",s[s.RAND=63]="RAND",s[s.MATCH=64]="MATCH",s[s.DATE=65]="DATE",s[s.TIME=66]="TIME",s[s.DAY=67]="DAY",s[s.MONTH=68]="MONTH",s[s.YEAR=69]="YEAR",s[s.WEEKDAY=70]="WEEKDAY",s[s.HOUR=71]="HOUR",s[s.MINUTE=72]="MINUTE",s[s.SECOND=73]="SECOND",s[s.NOW=74]="NOW",s[s.AREAS=75]="AREAS",s[s.ROWS=76]="ROWS",s[s.COLUMNS=77]="COLUMNS",s[s.OFFSET=78]="OFFSET",s[s.ABSREF=79]="ABSREF",s[s.RELREF=80]="RELREF",s[s.ARGUMENT=81]="ARGUMENT",s[s.SEARCH=82]="SEARCH",s[s.TRANSPOSE=83]="TRANSPOSE",s[s.ERROR=84]="ERROR",s[s.STEP=85]="STEP",s[s.TYPE=86]="TYPE",s[s.ECHO=87]="ECHO",s[s.SET_NAME=88]="SET_NAME",s[s.CALLER=89]="CALLER",s[s.DEREF=90]="DEREF",s[s.WINDOWS=91]="WINDOWS",s[s.SERIES=92]="SERIES",s[s.DOCUMENTS=93]="DOCUMENTS",s[s.ACTIVE_CELL=94]="ACTIVE_CELL",s[s.SELECTION=95]="SELECTION",s[s.RESULT=96]="RESULT",s[s.ATAN2=97]="ATAN2",s[s.ASIN=98]="ASIN",s[s.ACOS=99]="ACOS",s[s.CHOOSE=100]="CHOOSE",s[s.HLOOKUP=101]="HLOOKUP",s[s.VLOOKUP=102]="VLOOKUP",s[s.LINKS=103]="LINKS",s[s.INPUT=104]="INPUT",s[s.ISREF=105]="ISREF",s[s.GET_FORMULA=106]="GET_FORMULA",s[s.GET_NAME=107]="GET_NAME",s[s.SET_VALUE=108]="SET_VALUE",s[s.LOG=109]="LOG",s[s.EXEC=110]="EXEC",s[s.CHAR=111]="CHAR",s[s.LOWER=112]="LOWER",s[s.UPPER=113]="UPPER",s[s.PROPER=114]="PROPER",s[s.LEFT=115]="LEFT",s[s.RIGHT=116]="RIGHT",s[s.EXACT=117]="EXACT",s[s.TRIM=118]="TRIM",s[s.REPLACE=119]="REPLACE",s[s.SUBSTITUTE=120]="SUBSTITUTE",s[s.CODE=121]="CODE",s[s.NAMES=122]="NAMES",s[s.DIRECTORY=123]="DIRECTORY",s[s.FIND=124]="FIND",s[s.CELL=125]="CELL",s[s.ISERR=126]="ISERR",s[s.ISTEXT=127]="ISTEXT",s[s.ISNUMBER=128]="ISNUMBER",s[s.ISBLANK=129]="ISBLANK",s[s.T=130]="T",s[s.N=131]="N",s[s.FOPEN=132]="FOPEN",s[s.FCLOSE=133]="FCLOSE",s[s.FSIZE=134]="FSIZE",s[s.FREADLN=135]="FREADLN",s[s.FREAD=136]="FREAD",s[s.FWRITELN=137]="FWRITELN",s[s.FWRITE=138]="FWRITE",s[s.FPOS=139]="FPOS",s[s.DATEVALUE=140]="DATEVALUE",s[s.TIMEVALUE=141]="TIMEVALUE",s[s.SLN=142]="SLN",s[s.SYD=143]="SYD",s[s.DDB=144]="DDB",s[s.GET_DEF=145]="GET_DEF",s[s.REFTEXT=146]="REFTEXT",s[s.TEXTREF=147]="TEXTREF",s[s.INDIRECT=148]="INDIRECT",s[s.REGISTER=149]="REGISTER",s[s.CALL=150]="CALL",s[s.ADD_BAR=151]="ADD_BAR",s[s.ADD_MENU=152]="ADD_MENU",s[s.ADD_COMMAND=153]="ADD_COMMAND",s[s.ENABLE_COMMAND=154]="ENABLE_COMMAND",s[s.CHECK_COMMAND=155]="CHECK_COMMAND",s[s.RENAME_COMMAND=156]="RENAME_COMMAND",s[s.SHOW_BAR=157]="SHOW_BAR",s[s.DELETE_MENU=158]="DELETE_MENU",s[s.DELETE_COMMAND=159]="DELETE_COMMAND",s[s.GET_CHART_ITEM=160]="GET_CHART_ITEM",s[s.DIALOG_BOX=161]="DIALOG_BOX",s[s.CLEAN=162]="CLEAN",s[s.MDETERM=163]="MDETERM",s[s.MINVERSE=164]="MINVERSE",s[s.MMULT=165]="MMULT",s[s.FILES=166]="FILES",s[s.IPMT=167]="IPMT",s[s.PPMT=168]="PPMT",s[s.COUNTA=169]="COUNTA",s[s.CANCEL_KEY=170]="CANCEL_KEY",s[s.FOR=171]="FOR",s[s.WHILE=172]="WHILE",s[s.BREAK=173]="BREAK",s[s.NEXT=174]="NEXT",s[s.INITIATE=175]="INITIATE",s[s.REQUEST=176]="REQUEST",s[s.POKE=177]="POKE",s[s.EXECUTE=178]="EXECUTE",s[s.TERMINATE=179]="TERMINATE",s[s.RESTART=180]="RESTART",s[s.HELP=181]="HELP",s[s.GET_BAR=182]="GET_BAR",s[s.PRODUCT=183]="PRODUCT",s[s.FACT=184]="FACT",s[s.GET_CELL=185]="GET_CELL",s[s.GET_WORKSPACE=186]="GET_WORKSPACE",s[s.GET_WINDOW=187]="GET_WINDOW",s[s.GET_DOCUMENT=188]="GET_DOCUMENT",s[s.DPRODUCT=189]="DPRODUCT",s[s.ISNONTEXT=190]="ISNONTEXT",s[s.GET_NOTE=191]="GET_NOTE",s[s.NOTE=192]="NOTE",s[s.STDEVP=193]="STDEVP",s[s.VARP=194]="VARP",s[s.DSTDEVP=195]="DSTDEVP",s[s.DVARP=196]="DVARP",s[s.TRUNC=197]="TRUNC",s[s.ISLOGICAL=198]="ISLOGICAL",s[s.DCOUNTA=199]="DCOUNTA",s[s.DELETE_BAR=200]="DELETE_BAR",s[s.UNREGISTER=201]="UNREGISTER",s[s.USDOLLAR=204]="USDOLLAR",s[s.FINDB=205]="FINDB",s[s.SEARCHB=206]="SEARCHB",s[s.REPLACEB=207]="REPLACEB",s[s.LEFTB=208]="LEFTB",s[s.RIGHTB=209]="RIGHTB",s[s.MIDB=210]="MIDB",s[s.LENB=211]="LENB",s[s.ROUNDUP=212]="ROUNDUP",s[s.ROUNDDOWN=213]="ROUNDDOWN",s[s.ASC=214]="ASC",s[s.DBCS=215]="DBCS",s[s.RANK=216]="RANK",s[s.ADDRESS=219]="ADDRESS",s[s.DAYS360=220]="DAYS360",s[s.TODAY=221]="TODAY",s[s.VDB=222]="VDB",s[s.ELSE=223]="ELSE",s[s.ELSE_IF=224]="ELSE_IF",s[s.END_IF=225]="END_IF",s[s.FOR_CELL=226]="FOR_CELL",s[s.MEDIAN=227]="MEDIAN",s[s.SUMPRODUCT=228]="SUMPRODUCT",s[s.SINH=229]="SINH",s[s.COSH=230]="COSH",s[s.TANH=231]="TANH",s[s.ASINH=232]="ASINH",s[s.ACOSH=233]="ACOSH",s[s.ATANH=234]="ATANH",s[s.DGET=235]="DGET",s[s.CREATE_OBJECT=236]="CREATE_OBJECT",s[s.VOLATILE=237]="VOLATILE",s[s.LAST_ERROR=238]="LAST_ERROR",s[s.CUSTOM_UNDO=239]="CUSTOM_UNDO",s[s.CUSTOM_REPEAT=240]="CUSTOM_REPEAT",s[s.FORMULA_CONVERT=241]="FORMULA_CONVERT",s[s.GET_LINK_INFO=242]="GET_LINK_INFO",s[s.TEXT_BOX=243]="TEXT_BOX",s[s.INFO=244]="INFO",s[s.GROUP=245]="GROUP",s[s.GET_OBJECT=246]="GET_OBJECT",s[s.DB=247]="DB",s[s.PAUSE=248]="PAUSE",s[s.RESUME=251]="RESUME",s[s.FREQUENCY=252]="FREQUENCY",s[s.ADD_TOOLBAR=253]="ADD_TOOLBAR",s[s.DELETE_TOOLBAR=254]="DELETE_TOOLBAR",s[s._UDF=255]="_UDF",s[s.RESET_TOOLBAR=256]="RESET_TOOLBAR",s[s.EVALUATE=257]="EVALUATE",s[s.GET_TOOLBAR=258]="GET_TOOLBAR",s[s.GET_TOOL=259]="GET_TOOL",s[s.SPELLING_CHECK=260]="SPELLING_CHECK",s[s.ERROR_TYPE=261]="ERROR_TYPE",s[s.APP_TITLE=262]="APP_TITLE",s[s.WINDOW_TITLE=263]="WINDOW_TITLE",s[s.SAVE_TOOLBAR=264]="SAVE_TOOLBAR",s[s.ENABLE_TOOL=265]="ENABLE_TOOL",s[s.PRESS_TOOL=266]="PRESS_TOOL",s[s.REGISTER_ID=267]="REGISTER_ID",s[s.GET_PROJECT=268]="GET_PROJECT",s[s.AVEDEV=269]="AVEDEV",s[s.BETADIST=270]="BETADIST",s[s.GAMMALN=271]="GAMMALN",s[s.BETAINV=272]="BETAINV",s[s.BINOMDIST=273]="BINOMDIST",s[s.CHIDIST=274]="CHIDIST",s[s.CHIINV=275]="CHIINV",s[s.COMBIN=276]="COMBIN",s[s.CONFIDENCE=277]="CONFIDENCE",s[s.CRITBINOM=278]="CRITBINOM",s[s.EVEN=279]="EVEN",s[s.EXPONDIST=280]="EXPONDIST",s[s.FDIST=281]="FDIST",s[s.FINV=282]="FINV",s[s.FISHER=283]="FISHER",s[s.FISHERINV=284]="FISHERINV",s[s.FLOOR=285]="FLOOR",s[s.GAMMADIST=286]="GAMMADIST",s[s.GAMMAINV=287]="GAMMAINV",s[s.CEILING=288]="CEILING",s[s.HYPGEOMDIST=289]="HYPGEOMDIST",s[s.LOGNORMDIST=290]="LOGNORMDIST",s[s.LOGINV=291]="LOGINV",s[s.NEGBINOMDIST=292]="NEGBINOMDIST",s[s.NORMDIST=293]="NORMDIST",s[s.NORMSDIST=294]="NORMSDIST",s[s.NORMINV=295]="NORMINV",s[s.NORMSINV=296]="NORMSINV",s[s.STANDARDIZE=297]="STANDARDIZE",s[s.ODD=298]="ODD",s[s.PERMUT=299]="PERMUT",s[s.POISSON=300]="POISSON",s[s.TDIST=301]="TDIST",s[s.WEIBULL=302]="WEIBULL",s[s.SUMXMY2=303]="SUMXMY2",s[s.SUMX2MY2=304]="SUMX2MY2",s[s.SUMX2PY2=305]="SUMX2PY2",s[s.CHITEST=306]="CHITEST",s[s.CORREL=307]="CORREL",s[s.COVAR=308]="COVAR",s[s.FORECAST=309]="FORECAST",s[s.FTEST=310]="FTEST",s[s.INTERCEPT=311]="INTERCEPT",s[s.PEARSON=312]="PEARSON",s[s.RSQ=313]="RSQ",s[s.STEYX=314]="STEYX",s[s.SLOPE=315]="SLOPE",s[s.TTEST=316]="TTEST",s[s.PROB=317]="PROB",s[s.DEVSQ=318]="DEVSQ",s[s.GEOMEAN=319]="GEOMEAN",s[s.HARMEAN=320]="HARMEAN",s[s.SUMSQ=321]="SUMSQ",s[s.KURT=322]="KURT",s[s.SKEW=323]="SKEW",s[s.ZTEST=324]="ZTEST",s[s.LARGE=325]="LARGE",s[s.SMALL=326]="SMALL",s[s.QUARTILE=327]="QUARTILE",s[s.PERCENTILE=328]="PERCENTILE",s[s.PERCENTRANK=329]="PERCENTRANK",s[s.MODE=330]="MODE",s[s.TRIMMEAN=331]="TRIMMEAN",s[s.TINV=332]="TINV",s[s.MOVIE_COMMAND=334]="MOVIE_COMMAND",s[s.GET_MOVIE=335]="GET_MOVIE",s[s.CONCATENATE=336]="CONCATENATE",s[s.POWER=337]="POWER",s[s.SPREADBASE_DATA_FIELD=338]="SPREADBASE_DATA_FIELD",s[s.GET_VIEW=339]="GET_VIEW",s[s.GET_FIELD=340]="GET_FIELD",s[s.GET_ITEM=341]="GET_ITEM",s[s.RADIANS=342]="RADIANS",s[s.DEGREES=343]="DEGREES",s[s.SUBTOTAL=344]="SUBTOTAL",s[s.SUMIF=345]="SUMIF",s[s.COUNTIF=346]="COUNTIF",s[s.COUNTBLANK=347]="COUNTBLANK",s[s.SCENARIO_GET=348]="SCENARIO_GET",s[s.OPTIONS_LISTS=349]="OPTIONS_LISTS",s[s.ISPMT=350]="ISPMT",s[s.DATEDIF=351]="DATEDIF",s[s.DATESTRING=352]="DATESTRING",s[s.NUMBERSTRING=353]="NUMBERSTRING",s[s.ROMAN=354]="ROMAN",s[s.OPENDIALOG=355]="OPENDIALOG",s[s.SAVEDIALOG=356]="SAVEDIALOG",s[s.VIEW_GET=357]="VIEW_GET",s[s.GETPIVOTDATA=358]="GETPIVOTDATA",s[s.HYPERLINK=359]="HYPERLINK",s[s.FURIGANA=360]="FURIGANA",s[s.AVERAGEA=361]="AVERAGEA",s[s.MAXA=362]="MAXA",s[s.MINA=363]="MINA",s[s.STDEVPA=364]="STDEVPA",s[s.VARPA=365]="VARPA",s[s.STDEVA=366]="STDEVA",s[s.VARA=367]="VARA",s[s.BAHTTEXT=368]="BAHTTEXT",s[s.THAIDOW=369]="THAIDOW",s[s.THAIDIGIT=370]="THAIDIGIT",s[s.THAIMOY=371]="THAIMOY",s[s.THAINUMSOUND=372]="THAINUMSOUND",s[s.THAINUMSTRING=373]="THAINUMSTRING",s[s.THAISTRINGLENGTH=374]="THAISTRINGLENGTH",s[s.ISTHAIDIGIT=375]="ISTHAIDIGIT",s[s.ROUNDBAHTDOWN=376]="ROUNDBAHTDOWN",s[s.ROUNDBAHTUP=377]="ROUNDBAHTUP",s[s.THAIYEAR=378]="THAIYEAR",s[s.RTD=379]="RTD",s[s.CUBEVALUE=380]="CUBEVALUE",s[s.CUBEMEMBER=381]="CUBEMEMBER",s[s.CUBEMEMBERPROPERTY=382]="CUBEMEMBERPROPERTY",s[s.CUBERANKEDMEMBER=383]="CUBERANKEDMEMBER",s[s.HEX2BIN=384]="HEX2BIN",s[s.HEX2DEC=385]="HEX2DEC",s[s.HEX2OCT=386]="HEX2OCT",s[s.DEC2BIN=387]="DEC2BIN",s[s.DEC2HEX=388]="DEC2HEX",s[s.DEC2OCT=389]="DEC2OCT",s[s.OCT2BIN=390]="OCT2BIN",s[s.OCT2HEX=391]="OCT2HEX",s[s.OCT2DEC=392]="OCT2DEC",s[s.BIN2DEC=393]="BIN2DEC",s[s.BIN2OCT=394]="BIN2OCT",s[s.BIN2HEX=395]="BIN2HEX",s[s.IMSUB=396]="IMSUB",s[s.IMDIV=397]="IMDIV",s[s.IMPOWER=398]="IMPOWER",s[s.IMABS=399]="IMABS",s[s.IMSQRT=400]="IMSQRT",s[s.IMLN=401]="IMLN",s[s.IMLOG2=402]="IMLOG2",s[s.IMLOG10=403]="IMLOG10",s[s.IMSIN=404]="IMSIN",s[s.IMCOS=405]="IMCOS",s[s.IMEXP=406]="IMEXP",s[s.IMARGUMENT=407]="IMARGUMENT",s[s.IMCONJUGATE=408]="IMCONJUGATE",s[s.IMAGINARY=409]="IMAGINARY",s[s.IMREAL=410]="IMREAL",s[s.COMPLEX=411]="COMPLEX",s[s.IMSUM=412]="IMSUM",s[s.IMPRODUCT=413]="IMPRODUCT",s[s.SERIESSUM=414]="SERIESSUM",s[s.FACTDOUBLE=415]="FACTDOUBLE",s[s.SQRTPI=416]="SQRTPI",s[s.QUOTIENT=417]="QUOTIENT",s[s.DELTA=418]="DELTA",s[s.GESTEP=419]="GESTEP",s[s.ISEVEN=420]="ISEVEN",s[s.ISODD=421]="ISODD",s[s.MROUND=422]="MROUND",s[s.ERF=423]="ERF",s[s.ERFC=424]="ERFC",s[s.BESSELJ=425]="BESSELJ",s[s.BESSELK=426]="BESSELK",s[s.BESSELY=427]="BESSELY",s[s.BESSELI=428]="BESSELI",s[s.XIRR=429]="XIRR",s[s.XNPV=430]="XNPV",s[s.PRICEMAT=431]="PRICEMAT",s[s.YIELDMAT=432]="YIELDMAT",s[s.INTRATE=433]="INTRATE",s[s.RECEIVED=434]="RECEIVED",s[s.DISC=435]="DISC",s[s.PRICEDISC=436]="PRICEDISC",s[s.YIELDDISC=437]="YIELDDISC",s[s.TBILLEQ=438]="TBILLEQ",s[s.TBILLPRICE=439]="TBILLPRICE",s[s.TBILLYIELD=440]="TBILLYIELD",s[s.PRICE=441]="PRICE",s[s.YIELD=442]="YIELD",s[s.DOLLARDE=443]="DOLLARDE",s[s.DOLLARFR=444]="DOLLARFR",s[s.NOMINAL=445]="NOMINAL",s[s.EFFECT=446]="EFFECT",s[s.CUMPRINC=447]="CUMPRINC",s[s.CUMIPMT=448]="CUMIPMT",s[s.EDATE=449]="EDATE",s[s.EOMONTH=450]="EOMONTH",s[s.YEARFRAC=451]="YEARFRAC",s[s.COUPDAYBS=452]="COUPDAYBS",s[s.COUPDAYS=453]="COUPDAYS",s[s.COUPDAYSNC=454]="COUPDAYSNC",s[s.COUPNCD=455]="COUPNCD",s[s.COUPNUM=456]="COUPNUM",s[s.COUPPCD=457]="COUPPCD",s[s.DURATION=458]="DURATION",s[s.MDURATION=459]="MDURATION",s[s.ODDLPRICE=460]="ODDLPRICE",s[s.ODDLYIELD=461]="ODDLYIELD",s[s.ODDFPRICE=462]="ODDFPRICE",s[s.ODDFYIELD=463]="ODDFYIELD",s[s.RANDBETWEEN=464]="RANDBETWEEN",s[s.WEEKNUM=465]="WEEKNUM",s[s.AMORDEGRC=466]="AMORDEGRC",s[s.AMORLINC=467]="AMORLINC",s[s.CONVERT=468]="CONVERT",s[s.ACCRINT=469]="ACCRINT",s[s.ACCRINTM=470]="ACCRINTM",s[s.WORKDAY=471]="WORKDAY",s[s.NETWORKDAYS=472]="NETWORKDAYS",s[s.GCD=473]="GCD",s[s.MULTINOMIAL=474]="MULTINOMIAL",s[s.LCM=475]="LCM",s[s.FVSCHEDULE=476]="FVSCHEDULE",s[s.CUBEKPIMEMBER=477]="CUBEKPIMEMBER",s[s.CUBESET=478]="CUBESET",s[s.CUBESETCOUNT=479]="CUBESETCOUNT",s[s.IFERROR=480]="IFERROR",s[s.COUNTIFS=481]="COUNTIFS",s[s.SUMIFS=482]="SUMIFS",s[s.AVERAGEIF=483]="AVERAGEIF",s[s.AVERAGEIFS=484]="AVERAGEIFS",s[s.AGGREGATE=485]="AGGREGATE",s[s.BINOM_DIST=486]="BINOM_DIST",s[s.BINOM_INV=487]="BINOM_INV",s[s.CONFIDENCE_NORM=488]="CONFIDENCE_NORM",s[s.CONFIDENCE_T=489]="CONFIDENCE_T",s[s.CHISQ_TEST=490]="CHISQ_TEST",s[s.F_TEST=491]="F_TEST",s[s.COVARIANCE_P=492]="COVARIANCE_P",s[s.COVARIANCE_S=493]="COVARIANCE_S",s[s.EXPON_DIST=494]="EXPON_DIST",s[s.GAMMA_DIST=495]="GAMMA_DIST",s[s.GAMMA_INV=496]="GAMMA_INV",s[s.MODE_MULT=497]="MODE_MULT",s[s.MODE_SNGL=498]="MODE_SNGL",s[s.NORM_DIST=499]="NORM_DIST",s[s.NORM_INV=500]="NORM_INV",s[s.PERCENTILE_EXC=501]="PERCENTILE_EXC",s[s.PERCENTILE_INC=502]="PERCENTILE_INC",s[s.PERCENTRANK_EXC=503]="PERCENTRANK_EXC",s[s.PERCENTRANK_INC=504]="PERCENTRANK_INC",s[s.POISSON_DIST=505]="POISSON_DIST",s[s.QUARTILE_EXC=506]="QUARTILE_EXC",s[s.QUARTILE_INC=507]="QUARTILE_INC",s[s.RANK_AVG=508]="RANK_AVG",s[s.RANK_EQ=509]="RANK_EQ",s[s.STDEV_S=510]="STDEV_S",s[s.STDEV_P=511]="STDEV_P",s[s.T_DIST=512]="T_DIST",s[s.T_DIST_2T=513]="T_DIST_2T",s[s.T_DIST_RT=514]="T_DIST_RT",s[s.T_INV=515]="T_INV",s[s.T_INV_2T=516]="T_INV_2T",s[s.VAR_S=517]="VAR_S",s[s.VAR_P=518]="VAR_P",s[s.WEIBULL_DIST=519]="WEIBULL_DIST",s[s.NETWORKDAYS_INTL=520]="NETWORKDAYS_INTL",s[s.WORKDAY_INTL=521]="WORKDAY_INTL",s[s.ECMA_CEILING=522]="ECMA_CEILING",s[s.ISO_CEILING=523]="ISO_CEILING",s[s.BETA_DIST=525]="BETA_DIST",s[s.BETA_INV=526]="BETA_INV",s[s.CHISQ_DIST=527]="CHISQ_DIST",s[s.CHISQ_DIST_RT=528]="CHISQ_DIST_RT",s[s.CHISQ_INV=529]="CHISQ_INV",s[s.CHISQ_INV_RT=530]="CHISQ_INV_RT",s[s.F_DIST=531]="F_DIST",s[s.F_DIST_RT=532]="F_DIST_RT",s[s.F_INV=533]="F_INV",s[s.F_INV_RT=534]="F_INV_RT",s[s.HYPGEOM_DIST=535]="HYPGEOM_DIST",s[s.LOGNORM_DIST=536]="LOGNORM_DIST",s[s.LOGNORM_INV=537]="LOGNORM_INV",s[s.NEGBINOM_DIST=538]="NEGBINOM_DIST",s[s.NORM_S_DIST=539]="NORM_S_DIST",s[s.NORM_S_INV=540]="NORM_S_INV",s[s.T_TEST=541]="T_TEST",s[s.Z_TEST=542]="Z_TEST",s[s.ERF_PRECISE=543]="ERF_PRECISE",s[s.ERFC_PRECISE=544]="ERFC_PRECISE",s[s.GAMMALN_PRECISE=545]="GAMMALN_PRECISE",s[s.CEILING_PRECISE=546]="CEILING_PRECISE",s[s.FLOOR_PRECISE=547]="FLOOR_PRECISE",s[s.ACOT=548]="ACOT",s[s.ACOTH=549]="ACOTH",s[s.COT=550]="COT",s[s.COTH=551]="COTH",s[s.CSC=552]="CSC",s[s.CSCH=553]="CSCH",s[s.SEC=554]="SEC",s[s.SECH=555]="SECH",s[s.IMTAN=556]="IMTAN",s[s.IMCOT=557]="IMCOT",s[s.IMCSC=558]="IMCSC",s[s.IMCSCH=559]="IMCSCH",s[s.IMSEC=560]="IMSEC",s[s.IMSECH=561]="IMSECH",s[s.BITAND=562]="BITAND",s[s.BITOR=563]="BITOR",s[s.BITXOR=564]="BITXOR",s[s.BITLSHIFT=565]="BITLSHIFT",s[s.BITRSHIFT=566]="BITRSHIFT",s[s.PERMUTATIONA=567]="PERMUTATIONA",s[s.COMBINA=568]="COMBINA",s[s.XOR=569]="XOR",s[s.PDURATION=570]="PDURATION",s[s.BASE=571]="BASE",s[s.DECIMAL=572]="DECIMAL",s[s.DAYS=573]="DAYS",s[s.BINOM_DIST_RANGE=574]="BINOM_DIST_RANGE",s[s.GAMMA=575]="GAMMA",s[s.SKEW_P=576]="SKEW_P",s[s.GAUSS=577]="GAUSS",s[s.PHI=578]="PHI",s[s.RRI=579]="RRI",s[s.UNICHAR=580]="UNICHAR",s[s.UNICODE=581]="UNICODE",s[s.MUNIT=582]="MUNIT",s[s.ARABIC=583]="ARABIC",s[s.ISOWEEKNUM=584]="ISOWEEKNUM",s[s.NUMBERVALUE=585]="NUMBERVALUE",s[s.SHEET=586]="SHEET",s[s.SHEETS=587]="SHEETS",s[s.FORMULATEXT=588]="FORMULATEXT",s[s.ISFORMULA=589]="ISFORMULA",s[s.IFNA=590]="IFNA",s[s.CEILING_MATH=591]="CEILING_MATH",s[s.FLOOR_MATH=592]="FLOOR_MATH",s[s.IMSINH=593]="IMSINH",s[s.IMCOSH=594]="IMCOSH",s[s.FILTERXML=595]="FILTERXML",s[s.WEBSERVICE=596]="WEBSERVICE",s[s.ENCODEURL=597]="ENCODEURL",s[s.FORECAST_ETS=598]="FORECAST_ETS",s[s.FORECAST_ETS_CONFINT=599]="FORECAST_ETS_CONFINT",s[s.FORECAST_ETS_SEASONALITY=600]="FORECAST_ETS_SEASONALITY",s[s.FORECAST_LINEAR=601]="FORECAST_LINEAR",s[s.FORECAST_ETS_STAT=602]="FORECAST_ETS_STAT",s[s.MAXIFS=603]="MAXIFS",s[s.MINIFS=604]="MINIFS",s[s.TEXTJOIN=605]="TEXTJOIN",s[s.CONCAT=606]="CONCAT",s[s.IFS=607]="IFS",s[s.SWITCH=608]="SWITCH",s[s.SINGLE=609]="SINGLE",s[s.AVERAGE_WEIGHTED=610]="AVERAGE_WEIGHTED",s[s.ANCHORARRAY=611]="ANCHORARRAY",s[s._FV=612]="_FV",s[s.FIELDVALUE=613]="FIELDVALUE",s[s.FILTER=614]="FILTER",s[s.SORT=615]="SORT",s[s.UNIQUE=616]="UNIQUE",s[s.RICHSEARCH=617]="RICHSEARCH",s[s.LARGEPROPERTY=618]="LARGEPROPERTY",s[s.SMALLPROPERTY=619]="SMALLPROPERTY",s[s.AVERAGEPROPERTY=620]="AVERAGEPROPERTY",s[s.FINDN=621]="FINDN",s[s.TEXTSLICE=622]="TEXTSLICE",s[s.TEXTBEFORE=623]="TEXTBEFORE",s[s.TEXTAFTER=624]="TEXTAFTER",s[s.TEXTSPLIT=625]="TEXTSPLIT",s[s._SORT=626]="_SORT",s[s._ONEDARRAY=627]="_ONEDARRAY",s[s.XMATCH=628]="XMATCH",s[s.XLOOKUP=629]="XLOOKUP",s[s.SORTBY=630]="SORTBY",s[s.RANDARRAY=631]="RANDARRAY",s[s.SEQUENCE=632]="SEQUENCE",s[s.STOCKHISTORY=633]="STOCKHISTORY",s[s.WRAPROWS=634]="WRAPROWS",s[s.VSTACK=635]="VSTACK",s[s.HSTACK=636]="HSTACK",s[s.CHOOSEROWS=637]="CHOOSEROWS",s[s.CHOOSECOLS=638]="CHOOSECOLS",s[s.LET=639]="LET",s[s.LAMBDA=640]="LAMBDA",s[s.MAKEARRAY=641]="MAKEARRAY",s[s.APPLY=642]="APPLY",s[s.ISLAMBDA=643]="ISLAMBDA",s[s.ARITY=644]="ARITY",s[s.RECURSE=645]="RECURSE",s[s.VALUETOTEXT=647]="VALUETOTEXT",s[s.ARRAYTOTEXT=648]="ARRAYTOTEXT",s[s.FORMATTEDNUMBER=649]="FORMATTEDNUMBER",s[s.TOCOL=650]="TOCOL",s[s.TOROW=651]="TOROW",s[s.WRAPCOLS=652]="WRAPCOLS",s[s.MAP=653]="MAP",s[s.REDUCE=654]="REDUCE",s[s.SCAN=655]="SCAN",s[s.BYROW=656]="BYROW",s[s.BYCOL=657]="BYCOL",s[s.ISOMITTED=658]="ISOMITTED",s[s.EXPAND=659]="EXPAND",s[s.TAKE=660]="TAKE",s[s.DROP=661]="DROP",s[s.PY=662]="PY",s[s.IMAGE=664]="IMAGE",s[s.UNIT=665]="UNIT",s[s.GROUPBY=666]="GROUPBY",s[s.PIVOTBY=667]="PIVOTBY",s[s.PYO=668]="PYO",s[s.TESTFUNCTIONBEGIN=669]="TESTFUNCTIONBEGIN",s[s.GRF=670]="GRF",s[s.RICHERROR=671]="RICHERROR",s[s.COUNTER=672]="COUNTER",s[s.BROKENRECORD=673]="BROKENRECORD",s[s.STREAM=674]="STREAM",s[s.GETRICHERRORS=675]="GETRICHERRORS",s[s.DBGSTAT=676]="DBGSTAT",s[s.RICHNUMBER=677]="RICHNUMBER",s[s.RICHERNUMBER=678]="RICHERNUMBER",s[s.DBGWRITE=679]="DBGWRITE",s[s.TEST=680]="TEST",s[s.AAC=681]="AAC",s[s.AWC=682]="AWC",s[s.WEBADDRESS_IMAGETEST=683]="WEBADDRESS_IMAGETEST",s[s.PARSEDEXPRESSION=684]="PARSEDEXPRESSION",s[s.AGE_CONTACTTEST=685]="AGE_CONTACTTEST",s[s.FIRSTNAME_CONTACTTEST=686]="FIRSTNAME_CONTACTTEST",s[s.FULLNAME_CONTACTTEST=687]="FULLNAME_CONTACTTEST",s[s.LASTNAME_CONTACTTEST=688]="LASTNAME_CONTACTTEST",s[s.TRANSLATENAME_CONTACTTEST=689]="TRANSLATENAME_CONTACTTEST",s[s.ARRAYVALUE=690]="ARRAYVALUE",s[s.RECORD=691]="RECORD",s[s.STR_PYTHON=692]="STR_PYTHON",s[s.TYPE_PYTHON=693]="TYPE_PYTHON",s[s.LOCALIMAGE=694]="LOCALIMAGE",s[s.DISPLAYSTRING_GENERALTEST=695]="DISPLAYSTRING_GENERALTEST",s[s.LETREC=750]="LETREC",s[s.NESTEDRECORD=751]="NESTEDRECORD",t.worksheetFuncEnglishNames=[[255,"255"],[268,"GET.WORKBOOK"],[349,"OPTIONS.LISTS.GET"],[355,"OPEN.DIALOG"],[356,"SAVE.DIALOG"],[360,"PHONETIC"],[369,"THAIDAYOFWEEK"],[371,"THAIMONTHOFYEAR"],[612,"_FV"],[626,"_SORT"],[627,"_ONEDARRAY"],[683,"WEBADDRESS_IMAGETEST"],[685,"AGE_CONTACTTEST"],[686,"FIRSTNAME_CONTACTTEST"],[687,"FULLNAME_CONTACTTEST"],[688,"LASTNAME_CONTACTTEST"],[689,"TRANSLATENAME_CONTACTTEST"],[692,"STR_PYTHON"],[693,"TYPE_PYTHON"],[695,"DISPLAYSTRING_GENERALTEST"]].reduce(function(f,p){return f[p[0]]=p[1],f},[]);var l=[];t.worksheetFuncTypes=[[1,255,l,[57],l,1,0,16],[1,3,[36,831,831],l,l,823,0,0],[1,1,[15],l,l,4,0,0],[1,1,[15],l,l,4,0,0],[1,255,l,[305],l,1,0,16],[1,255,l,[49],l,1,0,16],[1,255,l,[49],l,1,0,16],[1,255,l,[49],l,1,0,16],[0,1,[16],l,l,33,0,0],[0,1,[16],l,l,33,0,0],[0,0,l,l,l,3,0,16],[2,255,[1],[49],l,1,0,16],[1,255,l,[49],l,1,0,16],[1,2,[1,1],l,l,2,0,0],[1,3,[1,65,4],l,l,2,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[0,0,l,l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[2,3,[263,48,48],l,l,263,0,0],[2,4,[48,1,1,1],l,l,311,0,0],[2,2,[2,1],l,l,2,0,0],[3,3,[2,1,1],l,l,2,0,0],[1,1,[2],l,l,1,0,0],[1,1,[7],l,l,1,0,0],[0,0,l,l,l,4,0,16],[0,0,l,l,l,4,0,16],[1,255,l,[52],l,4,0,16],[1,255,l,[52],l,4,0,16],[1,1,[4],l,l,4,0,16],[2,2,[1,1],l,l,1,0,0],[3,3,[16,83,18],l,l,1,0,0],[3,3,[16,19,18],l,l,1,0,0],[3,3,[16,19,18],l,l,1,0,0],[3,3,[16,19,18],l,l,1,0,0],[3,3,[16,19,18],l,l,1,0,0],[3,3,[16,19,18],l,l,1,0,0],[1,255,l,[49],l,1,0,16],[3,3,[16,19,18],l,l,1,0,0],[2,2,[263,2],l,l,2,0,0],[1,4,[48,112,84,84],l,l,32,0,0],[1,4,[48,112,112,84],l,l,32,0,0],[1,4,[48,112,84,84],l,l,32,0,0],[1,4,[48,112,112,84],l,l,32,0,0],[1,1,[16],l,l,512,0,2],[0,1,[4],l,l,512,0,2],[0,1,[575],l,l,512,0,2],[3,5,[1,1,1,1,1],l,l,1,0,0],[3,5,[1,1,1,1,1],l,l,1,0,0],[3,5,[1,1,1,1,1],l,l,1,0,0],[3,5,[1,1,1,1,1],l,l,1,0,0],[3,6,[1,1,1,1,1,1],l,l,1,0,0],[3,3,[48,1,1],l,l,1,0,16],[1,2,[48,1],l,l,1,0,0],[0,0,l,l,l,1,16383,0],[2,3,[263,305,17],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,2,[1,1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[0,0,l,l,l,1,16383,0],[1,1,[16],l,l,1,0,0],[1,1,[48],l,l,1,0,0],[1,1,[48],l,l,1,0,0],[3,5,[16,65,65,65,65],l,l,16,16383,0],[2,2,[2,16],l,l,16,0,2],[2,2,[16,16],l,l,2,0,2],[0,3,[66,81,16],l,l,4,0,2],[2,3,[2,2,1],l,l,1,0,0],[1,1,[39],l,l,32,0,0],[0,2,[1,24],l,l,4,0,2],[0,0,l,l,l,4,0,2],[1,1,[303],l,l,1,0,0],[0,1,[4],l,l,4,0,2],[1,2,[2,63],l,l,4,0,2],[0,0,l,l,l,50,0,2],[1,1,[16],l,l,47,0,2],[0,2,[65,66],l,l,32,0,2],[4,5,[87,117,117,1,117],l,l,4,0,0],[0,2,[1,66],l,l,32,0,2],[0,0,l,l,l,16,0,2],[0,0,l,l,l,16,0,2],[0,1,[1],l,l,4,0,2],[2,2,[1,1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[2,255,[33],[831],l,823,0,0],[3,4,[263,49,49,4],l,l,295,0,0],[3,4,[263,49,49,4],l,l,295,0,0],[0,2,[66,65],l,l,32,0,2],[1,7,[2,65,66,67,65,65,2],l,l,575,0,2],[1,1,[63],l,l,4,0,0],[1,1,[18],l,l,2,0,2],[1,2,[2,4],l,l,6,0,2],[2,2,[16,47],l,l,4,0,2],[1,2,[1,1],l,l,1,0,0],[1,4,[2,1,4,4],l,l,7,0,2],[1,1,[1],l,l,2,0,0],[1,1,[2],l,l,2,0,0],[1,1,[2],l,l,2,0,0],[1,1,[2],l,l,2,0,0],[1,2,[2,9],l,l,2,0,0],[1,2,[2,9],l,l,2,0,0],[2,2,[258,258],l,l,4,0,0],[1,1,[2],l,l,2,0,0],[4,4,[2,1,1,2],l,l,2,0,0],[3,4,[2,2,2,2],l,l,2,0,0],[1,1,[2],l,l,1,0,0],[0,3,[66,65,66],l,l,32,0,2],[0,1,[2],l,l,2,0,2],[2,3,[2,2,1],l,l,1,0,0],[1,2,[2,16],l,l,303,16383,0],[1,1,[15],l,l,4,0,0],[1,1,[143],l,l,4,0,0],[1,1,[143],l,l,4,0,0],[1,1,[143],l,l,4,0,0],[1,1,[23],l,l,2,0,0],[1,1,[23],l,l,1,0,0],[1,2,[2,1],l,l,1,0,2],[1,1,[1],l,l,1,0,2],[1,1,[1],l,l,1,0,2],[1,1,[1],l,l,2,0,2],[2,2,[1,1],l,l,2,0,2],[2,2,[1,2],l,l,1,0,2],[2,2,[1,2],l,l,1,0,2],[1,2,[1,1],l,l,1,0,2],[1,1,[3],l,l,1,0,0],[1,1,[3],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[4,4,[1,1,1,1],l,l,1,0,0],[4,5,[1,1,1,1,1],l,l,1,0,0],[1,3,[2,66,65],l,l,2,0,2],[1,2,[16,4],l,l,2,0,2],[1,2,[2,4],l,l,16,0,2],[1,2,[2,4],l,l,16,16383,0],[1,255,[2,3,66,66,66,65,67,66,67],[66],l,3,0,2],[1,255,[3],[127],l,575,0,2],[0,1,[3],l,l,1,0,2],[2,4,[3,115,83,3],l,l,1,0,2],[3,5,[3,83,115,83,3],l,l,1,0,2],[4,5,[3,3,3,4,3],l,l,4,0,2],[4,5,[3,3,3,4,3],l,l,4,0,2],[4,5,[3,3,3,3,3],l,l,4,0,2],[0,1,[3],l,l,4,0,2],[2,3,[3,3,3],l,l,4,0,2],[3,4,[3,3,3,3],l,l,4,0,2],[1,3,[1,67,66],l,l,1,0,2],[1,1,[52],l,l,36,0,2],[1,1,[2],l,l,2,0,0],[1,1,[32],l,l,1,0,0],[1,1,[32],l,l,32,0,0],[2,2,[32,32],l,l,32,0,0],[0,2,[2,2],l,l,32,0,2],[4,6,[1,1,1,1,1,1],l,l,1,0,0],[4,6,[1,1,1,1,1,1],l,l,1,0,0],[1,255,l,[121],l,1,0,16],[0,2,[1,16],l,l,4,0,2],[3,4,[2,1,1,1],l,l,512,0,2],[1,1,[4],l,l,512,0,2],[0,0,l,l,l,512,0,2],[0,0,l,l,l,512,0,2],[2,2,[2,2],l,l,1,0,2],[2,2,[1,2],l,l,32,0,2],[3,3,[1,18,18],l,l,4,0,2],[2,2,[1,2],l,l,4,0,2],[1,1,[1],l,l,4,0,2],[0,1,[1],l,l,512,0,2],[0,1,[2],l,l,4,0,2],[0,4,[3,3,3,3],l,l,3,0,2],[1,255,l,[113],l,1,0,16],[1,1,[1],l,l,1,0,0],[1,2,[1,16],l,l,47,0,2],[1,1,[1],l,l,47,0,2],[1,2,[1,2],l,l,47,0,2],[1,2,[1,2],l,l,63,0,2],[3,3,[16,19,18],l,l,1,0,0],[1,1,[143],l,l,4,0,0],[0,3,[82,65,65],l,l,2,0,2],[0,4,[66,82,17,17],l,l,1,0,2],[1,255,l,[49],l,1,0,16],[1,255,l,[49],l,1,0,16],[3,3,[16,19,18],l,l,1,0,0],[3,3,[16,19,18],l,l,1,0,0],[1,2,[1,1],l,l,1,0,0],[1,1,[143],l,l,4,0,0],[3,3,[16,83,18],l,l,1,0,0],[1,1,[3],l,l,4,0,2],[1,1,[3],l,l,4,0,2],void 0,void 0,[1,2,[1,1],l,l,2,0,32],[2,3,[2,2,1],l,l,1,0,32],[2,3,[2,2,1],l,l,1,0,32],[4,4,[2,1,1,2],l,l,2,0,32],[1,2,[2,9],l,l,2,0,32],[1,2,[2,9],l,l,2,0,32],[3,3,[2,1,1],l,l,2,0,32],[1,1,[2],l,l,1,0,32],[2,2,[1,1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[1,1,[2],l,l,2,0,32],[1,1,[2],l,l,2,0,32],[2,3,[1,16,4],l,l,1,0,16],void 0,void 0,[2,5,[1,65,65,68,66],l,l,2,0,0],[2,3,[1,1,4],l,l,1,0,0],[0,0,l,l,l,1,16383,0],[5,7,[1,1,1,1,1,1,4],l,l,1,0,0],[0,0,l,l,l,512,0,2],[1,1,[12],l,l,512,0,2],[0,0,l,l,l,512,0,2],[1,3,[2,82,84],l,l,512,0,2],[1,255,l,[49],l,1,0,16],[1,255,l,[32],l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[3,3,[16,19,18],l,l,263,0,0],[2,11,[1,18,17,17,18,17,17,115,84,21,17],l,l,2,0,2],[0,1,[4],l,l,4,0,2],[0,0,l,l,l,16,0,2],[0,2,[2,2],l,l,4,0,2],[0,3,[2,2,2],l,l,4,0,2],[2,5,[2,23,23,23,23],l,l,2,0,2],[2,4,[2,1,1,2],l,l,1,0,2],[1,4,[2,66,65,65],l,l,1,0,2],[1,1,[2],l,l,3,16383,0],[0,0,l,l,l,2,0,2],[1,5,[1,2,1,1,1],l,l,47,0,2],[4,5,[1,1,1,1,1],l,l,1,0,0],[0,1,[4],l,l,512,0,2],void 0,void 0,[0,1,[1],l,l,512,0,2],[2,2,[48,48],l,l,32,0,16],[0,2,[66,96],l,l,2,0,2],[1,1,[2],l,l,4,0,2],[1,255,[17],[127],l,575,0,32],[1,1,[3],l,l,4,0,2],[1,1,[2],l,l,63,0,2],[1,2,[1,3],l,l,47,0,2],[1,3,[1,3,1],l,l,47,0,2],[1,3,[2,66,4],l,l,4,0,2],[1,1,[15],l,l,1,0,0],[0,1,[2],l,l,4,0,2],[0,1,[2],l,l,4,0,2],[0,2,[99,66],l,l,4,0,2],[3,3,[3,1,4],l,l,4,0,2],[3,3,[3,1,4],l,l,4,0,2],[2,3,[2,3,66],l,l,1,0,2],[1,2,[1,2],l,l,35,0,2],[1,255,l,[49],l,1,0,16],[3,5,[1,1,1,65,65],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[3,5,[1,1,1,65,65],l,l,1,0,0],[4,4,[1,1,1,4],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[3,3,[1,1,4],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[4,4,[1,1,1,4],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[4,4,[1,1,1,1],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[4,4,[1,1,1,4],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[3,3,[1,1,4],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[4,4,[1,1,1,4],l,l,1,0,0],[2,2,[32,32],l,l,1,0,0],[2,2,[32,32],l,l,1,0,0],[2,2,[32,32],l,l,1,0,0],[2,2,[32,32],l,l,1,0,0],[2,2,[32,32],l,l,1,0,0],[2,2,[32,32],l,l,1,0,0],[3,3,[1,32,32],l,l,1,0,0],[2,2,[32,32],l,l,1,0,0],[2,2,[32,32],l,l,1,0,0],[2,2,[32,32],l,l,1,0,0],[2,2,[32,32],l,l,1,0,0],[2,2,[32,32],l,l,1,0,0],[2,2,[32,32],l,l,1,0,0],[4,4,[32,32,1,1],l,l,1,0,0],[3,4,[32,32,1,65],l,l,1,0,0],[1,255,l,[49],l,1,0,16],[1,255,l,[49],l,1,0,16],[1,255,l,[49],l,1,0,16],[1,255,l,[49],l,1,0,16],[1,255,l,[49],l,1,0,16],[1,255,l,[49],l,1,0,16],[2,3,[49,1,1],l,l,1,0,16],[2,2,[49,1],l,l,1,0,16],[2,2,[49,1],l,l,1,0,16],[2,2,[49,1],l,l,1,0,16],[2,2,[49,1],l,l,1,0,16],[2,3,[49,1,65],l,l,1,0,16],[1,255,l,[32],l,1,0,16],[2,2,[49,1],l,l,1,0,16],[2,2,[1,1],l,l,1,0,0],void 0,[3,4,[2,1,1,1],l,l,1,0,34],[2,3,[2,1,1],l,l,1,0,34],[1,255,l,[2],l,2,0,0],[2,2,[1,1],l,l,1,0,0],[2,9,[66,2,66,65,65,65,66,66,66],l,l,2,0,2],[1,2,[1,2],l,l,35,0,2],[1,3,[1,66,2],l,l,35,0,2],[1,4,[1,66,66,2],l,l,7,0,2],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[2,255,[1],[16],l,1,0,0],[2,3,[16,15,16],l,l,1,0,0],[2,2,[16,15],l,l,1,0,0],[1,1,[16],l,l,1,0,0],[1,2,[1,2],l,l,19,0,2],[1,1,[33],l,l,33,0,2],[4,4,[1,1,1,1],l,l,1,0,0],[3,3,[1,1,2],l,l,1,0,32],[1,1,[1],l,l,2,0,32],[2,2,[1,1],l,l,2,0,32],[1,2,[1,5],l,l,2,0,0],[0,4,[66,66,66,65],l,l,6,0,2],[0,5,[66,66,66,66,65],l,l,6,0,2],[1,2,[1,2],l,l,19,0,2],[2,255,[18,18],[2,79],l,15,0,0],[1,2,[2,39],l,l,39,0,0],[1,1,[16],l,l,2,0,32],[1,255,l,[49],l,1,0,16],[1,255,l,[49],l,1,0,16],[1,255,l,[49],l,1,0,16],[1,255,l,[49],l,1,0,16],[1,255,l,[49],l,1,0,16],[1,255,l,[49],l,1,0,16],[1,255,l,[49],l,1,0,16],[1,1,[1],l,l,2,0,0],[1,1,[1],l,l,2,0,32],[1,1,[3],l,l,2,0,32],[1,1,[1],l,l,2,0,32],[1,1,[1],l,l,2,0,32],[1,1,[1],l,l,2,0,32],[1,1,[2],l,l,1,0,32],[1,1,[2],l,l,4,0,32],[1,1,[1],l,l,1,0,32],[1,1,[1],l,l,1,0,32],[1,1,[1],l,l,1,0,32],[3,255,l,[2],l,2,0,0],[1,255,[2],[50],l,15,0,0],[2,3,[2,50,2],l,l,10,0,0],[3,3,[2,2,2],l,l,15,0,0],[3,4,[2,2,1,2],l,l,10,0,0],[1,2,[95,95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,2,[95,95],l,l,9,0,0],[1,2,[95,95],l,l,9,0,0],[1,2,[95,95],l,l,9,0,0],[1,2,[95,95],l,l,9,0,0],[1,2,[95,95],l,l,9,0,0],[1,2,[95,95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,2,[95,95],l,l,9,0,0],[1,2,[95,95],l,l,9,0,0],[2,2,[95,95],l,l,9,0,0],[2,2,[95,95],l,l,9,0,0],[2,2,[95,95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[2,3,[95,95,95],l,l,9,0,0],[1,255,l,[127],l,9,0,0],[1,255,l,[127],l,9,0,0],[4,4,[95,95,95,127],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[2,2,[95,95],l,l,9,0,0],[1,2,[95,95],l,l,9,0,0],[1,2,[95,95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[2,2,[95,95],l,l,9,0,0],[1,2,[95,95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[2,2,[95,95],l,l,9,0,0],[2,2,[95,95],l,l,9,0,0],[2,2,[95,95],l,l,9,0,0],[2,2,[95,95],l,l,9,0,0],[2,3,[127,127,95],l,l,9,0,0],[3,3,[95,127,127],l,l,9,0,0],[5,6,[95,95,95,95,95,95],l,l,9,0,0],[5,6,[95,95,95,95,95,95],l,l,9,0,0],[4,5,[95,95,95,95,95],l,l,9,0,0],[4,5,[95,95,95,95,95],l,l,9,0,0],[4,5,[95,95,95,95,95],l,l,9,0,0],[4,5,[95,95,95,95,95],l,l,9,0,0],[4,5,[95,95,95,95,95],l,l,9,0,0],[3,3,[95,95,95],l,l,9,0,0],[3,3,[95,95,95],l,l,9,0,0],[3,3,[95,95,95],l,l,9,0,0],[6,7,[95,95,95,95,95,95,95],l,l,9,0,0],[6,7,[95,95,95,95,95,95,95],l,l,9,0,0],[2,2,[95,95],l,l,9,0,0],[2,2,[95,95],l,l,9,0,0],[2,2,[95,95],l,l,9,0,0],[2,2,[95,95],l,l,9,0,0],[6,6,[95,95,95,95,95,95],l,l,9,0,0],[6,6,[95,95,95,95,95,95],l,l,9,0,0],[2,2,[95,95],l,l,9,0,0],[2,2,[95,95],l,l,9,0,0],[2,3,[95,95,95],l,l,9,0,0],[3,4,[95,95,95,95],l,l,9,0,0],[3,4,[95,95,95,95],l,l,9,0,0],[3,4,[95,95,95,95],l,l,9,0,0],[3,4,[95,95,95,95],l,l,9,0,0],[3,4,[95,95,95,95],l,l,9,0,0],[3,4,[95,95,95,95],l,l,9,0,0],[5,6,[95,95,95,95,95,95],l,l,9,0,0],[5,6,[95,95,95,95,95,95],l,l,9,0,0],[7,8,[95,95,95,95,95,95,95,95],l,l,9,0,0],[7,8,[95,95,95,95,95,95,95,95],l,l,9,0,0],[8,9,[95,95,95,95,95,95,95,95,95],l,l,9,0,0],[8,9,[95,95,95,95,95,95,95,95,95],l,l,9,0,0],[2,2,[95,95],l,l,9,16383,0],[1,2,[95,95],l,l,9,0,0],[6,7,[95,95,95,95,95,95,95],l,l,9,0,32],[6,7,[95,95,95,95,95,95,95],l,l,9,0,0],[3,3,[95,95,95],l,l,9,0,0],[6,8,[95,95,95,95,95,95,95,95],l,l,9,0,0],[4,5,[95,95,95,95,95],l,l,9,0,0],[2,3,[95,95,127],l,l,9,0,0],[2,3,[95,95,127],l,l,9,0,0],[1,255,l,[127],l,9,0,0],[1,255,l,[127],l,9,0,0],[1,255,l,[127],l,9,0,0],[2,2,[95,127],l,l,9,0,0],[3,4,[2,2,1,2],l,l,10,0,0],[2,5,[2,50,2,1,2],l,l,10,0,0],[1,1,[2],l,l,9,0,0],[2,2,[47,575],l,l,303,0,0],[2,255,l,[16,15],l,1,0,0],[3,255,[16],[16,15],l,1,0,0],[2,3,[16,15,16],l,l,1,0,0],[3,255,[16],[16,15],l,1,0,0],[3,254,[1,1,48,17],[16],l,1,0,0],[4,4,[1,1,1,4],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[2,2,[32,32],l,l,1,0,0],[2,2,[32,32],l,l,1,0,0],[2,2,[32,32],l,l,1,0,0],[2,2,[32,32],l,l,1,0,0],[3,3,[1,1,4],l,l,1,0,0],[4,4,[1,1,1,4],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[1,254,l,[32],l,32,0,16],[1,254,l,[32],l,1,0,16],[4,4,[1,1,1,4],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[2,2,[49,1],l,l,1,0,16],[2,2,[49,1],l,l,1,0,16],[2,3,[49,1,65],l,l,1,0,16],[2,3,[49,1,65],l,l,1,0,16],[3,3,[1,1,4],l,l,1,0,0],[2,2,[49,1],l,l,1,0,16],[2,2,[49,1],l,l,1,0,16],[2,3,[1,16,4],l,l,1,0,16],[2,3,[1,16,4],l,l,1,0,16],[1,254,l,[49],l,1,0,16],[1,254,l,[49],l,1,0,16],[3,3,[1,1,4],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[1,254,l,[49],l,1,0,16],[1,254,l,[49],l,1,0,16],[4,4,[1,1,1,4],l,l,1,0,0],[2,4,[95,95,75,127],l,l,9,0,0],[2,4,[95,95,75,127],l,l,9,0,0],[2,2,[1,1],l,l,1,0,32],[1,2,[1,65],l,l,1,0,32],void 0,[4,6,[1,1,1,4,65,65],l,l,1,0,0],[3,5,[1,1,1,65,65],l,l,1,0,0],[3,3,[1,1,4],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[4,4,[1,1,1,4],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[5,5,[1,1,1,1,4],l,l,1,0,0],[4,4,[1,1,1,4],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[4,4,[1,1,1,4],l,l,1,0,0],[2,2,[1,4],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[4,4,[32,32,1,1],l,l,1,0,0],[2,3,[49,1,1],l,l,1,0,16],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[1],l,l,1,0,0],[1,2,[1,65],l,l,1,0,32],[1,2,[1,65],l,l,1,0,32],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[2,2,[1,1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[2,2,[1,1],l,l,1,0,0],[1,254,l,[52],l,4,0,16],[3,3,[1,1,1],l,l,1,0,0],[2,3,[1,1,65],l,l,2,0,0],[2,2,[2,1],l,l,1,0,0],[2,2,[3,3],l,l,1,0,0],[3,4,[1,1,1,65],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,254,l,[49],l,1,0,16],[1,1,[1],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[3,3,[1,1,1],l,l,1,0,0],[1,1,[1],l,l,2,0,0],[1,1,[2],l,l,1,0,0],[1,1,[1],l,l,32,0,0],[1,1,[2],l,l,1,0,0],[1,1,[1],l,l,1,0,0],[1,3,[2,66,66],l,l,1,0,0],[0,1,[50],l,l,1,16383,16],[0,1,[48],l,l,1,16383,16],[1,1,[16],l,l,2,16383,0],[1,1,[16],l,l,4,0,0],[2,2,[47,575],l,l,303,0,0],[1,3,[1,65,65],l,l,1,0,0],[1,3,[1,65,65],l,l,1,0,0],[1,1,[95],l,l,9,0,0],[1,1,[95],l,l,9,0,0],[2,2,[2,2],l,l,47,0,0],[1,1,[2],l,l,10,0,0],[1,1,[2],l,l,10,0,0],[3,6,[1,48,48,65,65,65],l,l,1,0,0],[3,7,[1,48,48,65,65,65,65],l,l,1,0,0],[2,4,[48,48,65,65],l,l,1,0,0],[3,3,[1,32,32],l,l,1,0,0],[3,6,[48,48,1,65,65,65],l,l,1,0,0],[3,254,[16],[16,15],l,1,0,0],[3,254,[16],[16,15],l,1,0,0],[3,254,[114,68],[114],l,2,0,16],[1,254,l,[114],l,2,0,16],[2,254,l,[44,575],l,831,0,0],[3,254,[47],[575,575],[575],831,0,0],[1,1,[1527],l,l,1503,0,53],[2,254,l,[113,113],l,1,0,17],[1,1,[16],l,l,48,0,21],[2,3,[271,2,4],l,l,303,0,21],[2,2,[271,2],l,l,303,0,17],[2,3,[48,48,111],l,l,303,0,1],[1,4,[160,96,96,4],l,l,32,0,1],[1,3,[160,4,4],l,l,32,0,1],[2,2,[2,256],l,l,1,0,8],[3,3,[2,49,1],l,l,1,0,25],[3,3,[2,49,1],l,l,1,0,25],[2,254,[2],[49],l,1,0,25],[2,7,[34,2,65,65,65,74,68],l,l,1,0,1],[1,3,[2,65,65],l,l,2,0,1],[2,6,[2,34,65,65,65,74],l,l,2,0,1],[2,6,[2,34,65,65,65,74],l,l,2,0,1],[2,6,[2,98,98,68,65,495],l,l,32,0,1],[1,4,[32,96,96,4],l,l,32,0,9],[2,2,[4,16],l,l,32,0,25],[2,4,[391,48,65,65],l,l,1,0,1],[3,6,[391,48,48,511,65,65],l,l,319,0,1],[2,254,[160],[160,65],l,32,0,1],[0,5,[65,65,65,65,68],l,l,32,16383,1],[1,4,[65,65,65,65],l,l,32,0,1],[2,254,[258,1,65,65,65],[65],l,32,0,17],[2,3,[32,1,463],l,l,32,0,1],[1,254,l,[48],l,32,0,17],[1,254,l,[48],l,32,0,17],[2,254,[48],[33],l,32,0,1],[2,254,[48],[33],l,32,0,1],[3,254,l,[319,319],[319],319,0,1],[1,254,l,[319],l,319,0,1],[3,3,[65,65,319],l,l,32,0,1],[1,254,l,[319],l,319,0,1],[1,1,[319],l,l,4,0,1],[1,1,[319],l,l,9,0,1],[0,0,l,l,l,319,0,1],void 0,[1,2,[399,1],l,l,2,0,1],[1,2,[32,1],l,l,2,0,1],[2,2,[15,2],l,l,256,0,17],[1,3,[48,65,68],l,l,32,0,17],[1,3,[48,65,68],l,l,32,0,17],[2,3,[32,1,463],l,l,32,0,1],[2,254,[48],[319],l,32,0,1],[3,3,[511,48,271],l,l,319,0,1],[3,3,[511,48,271],l,l,32,0,1],[1,2,[48,271],l,l,32,0,1],[1,2,[48,271],l,l,32,0,1],[1,1,[1535],l,l,4,0,1],[2,4,[32,65,65,495],l,l,32,0,1],[2,3,[48,65,65],l,l,48,0,1],[2,3,[48,65,65],l,l,48,0,1],[1,254,[1],[48],l,303,0,17],void 0,[1,5,[2,66,65,65,65],l,l,264,0,1],[2,2,[15,2],l,l,271,0,17],[3,6,[48,32,96,68,97,65],l,l,32,0,1],[3,9,[48,48,32,96,68,97,65,97,65],l,l,32,0,1],[1,254,[1],[48],l,1087,0,17],[0,0,l,l,l,1,0,1],[1,2,[287,2],l,l,288,0,17],[1,2,[1,1],l,l,10,0,17],[0,0,l,l,l,1,0,1],[3,254,[47],[2,47],l,47,0,17],[0,1,[1],l,l,1,0,1],[0,1,[1],l,l,32,0,1],[1,2,[2,1],l,l,47,0,1],[1,1,[1],l,l,264,0,17],[1,1,[1],l,l,264,0,17],[2,2,[2,47],l,l,47,0,1],[1,254,[2],[1151],l,1087,0,16],[1,254,[1],[1151],l,1087,0,0],[1,254,[1],[1151],l,1087,0,0],[1,1,[256],l,l,258,0,17],[1,1,[16],l,l,32,0,1],[1,1,[256],l,l,2,0,17],[1,1,[256],l,l,2,0,17],[1,1,[256],l,l,2,0,17],[1,1,[256],l,l,2,0,17],[2,2,[256,2],l,l,2,0,17],[1,1,[32],l,l,256,0,17],[3,254,[15],[2,47],l,303,0,17],[1,1,[256],l,l,2,0,17],[1,1,[256],l,l,2,0,17],[1,2,[2,66],l,l,264,0,1],[1,1,[256],l,l,2,0,17],void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,[3,254,l,[319,319],[319],319,0,1],[3,254,[15],[2,303],l,303,0,17]].map(function(f){return f===void 0?void 0:c.functionType.apply(void 0,f)})},9860:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.styleServiceTypes=t.testUtil=t.printServiceTypes=t.printService=t.mathpackIEEE=t.relabel=t.visitor=t.mathpack=t.signature=t.literalParse=t.resolveServiceTypes=t.resolveService=t.util=t.numfmt=t.formulaModule=t.datepack=t.mathpackXL=t.config=t.cellParse=t.cellFormat=t.annotations=t.adjust=t.worksheetFuncTypesModule=t.getCharCodeBits=t.location=t.value=t.types=t.PackageName=void 0,t.PackageName="excel-online-calc-lang",t.types=d(3424),t.value=d(2294),t.location=d(9937);var s=d(624);Object.defineProperty(t,"getCharCodeBits",{enumerable:!0,get:function(){return s.getCharCodeBits}}),t.worksheetFuncTypesModule=d(3494),t.adjust=d(330),t.annotations=d(2840),t.cellFormat=d(5499),t.cellParse=d(1646),t.config=d(3378),t.mathpackXL=d(3962),t.datepack=d(3181),t.formulaModule=d(3546),t.numfmt=d(9421),t.util=d(927),t.resolveService=d(7458),t.resolveServiceTypes=d(2195),t.literalParse=d(4931),t.signature=d(5947),t.mathpack=d(7389),t.visitor=d(9017),t.relabel=d(6892),t.mathpackIEEE=d(9173),t.printService=d(1214),t.printServiceTypes=d(4114),t.testUtil=d(6524),t.styleServiceTypes=d(6791)},4931:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseSignedLiteral=t.parseNumberLiteral=t.parseUint=t.isLineBreak=t.isSpace=void 0;var s=d(8350),c=d(9745),l=d(3883),f=d(9119),p=d(9421),m=d(1345),v=d(927),h=m.codePointSpace,S=m.codePointLF,y=m.codePointMinusSign,C=m.codePointPlusSign,E=m.codePointSlash;function I(k){return k===h||k===S}function F(k,x,G,H){(0,c.assertIndex)("calc.parse.parseUint",x,16);for(var L=0,D=H,U=G.length;D<U;){var V=(0,f.stringCodePointAt)(G,D);if(!k.isNumeral(V))break;var ne=k.getOrdinal(V);L===0&&ne!==0&&(U=(0,s.fastMin)(U,D+x)),L=10*L+ne,D+=(0,f.numCodeUnits)(V)}return D===U&&D<G.length&&k.isNumeral((0,f.stringCodePointAt)(G,D))?[0,H]:[L,D]}function w(k,x,G,H){var L=H,D=F(k,5,G,L),U=D[0],V=D[1];if(V===L||U>32767||!((L=V)<G.length&&G.charCodeAt(L)===E))return!1;var ne=F(k,5,G,L+=1),J=ne[0],$=ne[1];if($===L||J>32767)return!1;if(L=$,J===0)return[!1,0,L];var Z=x.div(x.fromNumber(U),x.fromNumber(J));return(0,c.assertTrue)("calc.lang.tryTokenizeFrac",(0,v.isNumberOper)(Z)),[Z,J,L]}function B(k,x,G,H,L,D,U){var V,ne,J,$=H,Z=0,ie="",X=!1,Q=!1,b=p.NumberShape.ASCII;if((0,l.stringStartsWith)(G,k.decimalSeparator,H)||H<G.length&&k.isNumeral((0,f.stringCodePointAt)(G,H))){for(var R=function(){if((D||L&&G.indexOf("%",$)>=0)&&(Z-=2,V!==void 0)){var ce=x.div(V,x.fromNumber(100));(0,c.assertTrue)("calc.lang.parseNumberLiteral",(0,v.isNumberOper)(ce)),V=ce,J=p.KnownFormat.Pct}if((0,s.fastAbs)(Z)>=309)return{value:void 0,i:$,consumedThousands:X,consumedDecimal:Q,numShape:b,format:J};var he=x.parse(k,!0,Z,ie);if(V!==void 0){var de=x.add(he,V);(0,c.assertTrue)("calc.lang.parseNumberLiteral",(0,v.isNumberOper)(de)),he=de}return{value:he,i:$,consumedThousands:X,consumedDecimal:Q,numShape:b,format:J}};$<G.length;){var P=(0,f.stringCodePointAt)(G,$);if(!k.isNumeral(P)||k.getOrdinal(P)!==0)break;(ne=k.getNumberShape(P))!==p.NumberShape.ASCII&&(b=ne),$+=(0,f.numCodeUnits)(P)}if(U&&(O=w(k,x,G,$))!==!1){var A=O[0],T=O[1],g=O[2];return $=g,A===!1?{value:void 0,i:$,consumedThousands:X,consumedDecimal:Q,numShape:b,format:J}:(J=T>=10?p.KnownFormat.FractBond:p.KnownFormat.Fract,V=A,R())}for(var O,M=$;$<G.length;)if(P=(0,f.stringCodePointAt)(G,$),k.isNumeral(P))Z+=1,(ne=k.getNumberShape(P))!==p.NumberShape.ASCII&&(b=ne),$+=(0,f.numCodeUnits)(P);else{if(!(L&&Z>0&&(0,l.stringStartsWith)(G,k.thousandsSeparator,$)))break;X=!0,$+=k.thousandsSeparator.length}if(ie+=G.substring(M,$),X){var K=function(ue,ce,he){for(var de=he,pe="",_e=0;_e<ce.length;){var Ce=(0,f.stringCodePointAt)(ce,_e);if(ue.isNumeral(Ce)){var Ne=(0,f.numCodeUnits)(Ce);pe+=ce.substring(_e,_e+Ne),_e+=Ne,de-=1}else{if(de===0||!ue.isThousandsPosition(de))return;_e+=ue.thousandsSeparator.length}}return pe}(k,ie,Z);if(K===void 0)return;ie=K}if(H<$&&$<G.length&&I(G.charCodeAt($))&&(O=w(k,x,G,$+1))!==!1)return A=O[0],T=O[1],g=O[2],$=g,A===!1?{value:void 0,i:$,consumedThousands:X,consumedDecimal:Q,numShape:b,format:J}:(J=T>=10?p.KnownFormat.FractBond:p.KnownFormat.Fract,V=A,R());var W=!1;if((0,l.stringStartsWith)(G,k.decimalSeparator,$)&&(W=$===H,Q=!0,$+=k.decimalSeparator.length),Z===0)for(;$<G.length&&(P=(0,f.stringCodePointAt)(G,$),k.isNumeral(P))&&k.getOrdinal(P)===0;)Z-=1,(ne=k.getNumberShape(P))!==p.NumberShape.ASCII&&(b=ne),$+=(0,f.numCodeUnits)(P);for(M=$;$<G.length&&(P=(0,f.stringCodePointAt)(G,$),k.isNumeral(P));)(ne=k.getNumberShape(P))!==p.NumberShape.ASCII&&(b=ne),$+=(0,f.numCodeUnits)(P);if(ie+=G.substring(M,$),!(W&&$<=H+k.decimalSeparator.length)){var z=function(ue,ce,he){var de=he;if(de<ce.length&&ue.stringCompareCI("E",ce.substring(de,de+1))===0)de+=1;else{if(!(0,l.stringStartsWith)(ce,"**",de))return[0,he];de+=2}var pe=!1;if(de<ce.length){var _e=(0,f.stringCodePointAt)(ce,de);((pe=_e===y)||_e===C)&&(de+=(0,f.numCodeUnits)(_e))}if(de>=ce.length||!ue.isNumeral((0,f.stringCodePointAt)(ce,de)))return!1;var Ce=F(ue,10,ce,de),Ne=Ce[0],Le=Ce[1];return Le!==de&&!(Ne>2147483647)&&[pe?-Ne:Ne,Le]}(k,G,$);if(z!==!1){var ee=z[0];g=z[1],Z+=ee,g!==$&&(J=p.KnownFormat.Exp),$=g}return z===!1?{value:void 0,i:$,consumedThousands:X,consumedDecimal:Q,numShape:b,format:J}:R()}}}t.isSpace=I,t.isLineBreak=function(k){return k===S},t.parseUint=F,t.parseNumberLiteral=B,t.parseSignedLiteral=function(k,x,G,H,L){var D=H,U=!1;if(D<G.length){var V=G.charCodeAt(D);if((V===C||V===y)&&(U=V===y,D+=1,L))for(;D<G.length&&I(G.charCodeAt(D));)D+=1}var ne=B(k,x,G,D,!1,!1,!1);return(ne==null?void 0:ne.value)===void 0?[x.zero,H]:(D=ne.i,[U?x.neg(ne.value):ne.value,D])}},9937:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSheetGridCell=t.isSheetGridRange=t.isGridCell=t.isSheetIndex=t.userDefinedFuncLoc=t.nameLoc=t.nameScope=t.documentScope=t.originCell=t.sheetGridCell=t.sheetGridRange=t.sheetGridCube=t.gridCell=t.gridRange=t.unsafeGridRange=t.sheetRangeIndexes=t.allSheetsRange=t.sheetIndex=t.sheetRange=t.structRefColumnLoc=t.documentLoc=t.sheetCols=t.sheetRows=t.lexicalSourceUDF=t.lexicalSourceWSF=t.lexicalSourceName=t.lexicalSourceGrid=t.lexicalSourceRange=t.lexicalSourceCell=t.NameSource=t.LexicalKind=void 0;var s,c,l=d(637),f=l.assertions.assertIndex,p=l.assertions.assertPositiveLength,m=l.assertions.assertFalse;function v(k){return{kind:s.Cell,range:k}}function h(k){return{kind:s.Range,range:k}}function S(k,x,G){return{document:k,index:x,index2:G}}function y(k,x){return S(k,x,x)}function C(k,x,G,H){return{row:k,col:x,rows:G,cols:H}}function E(k,x){return{sheet:k,range:x}}function I(k){return{document:k,index:void 0}}function F(k){return k.index===k.index2}function w(k){return k.rows===1&&k.cols===1}function B(k){return w(k.range)}(function(k){k[k.Cell=1]="Cell",k[k.Range=2]="Range",k[k.NameManager=3]="NameManager",k[k.CondFormatting=4]="CondFormatting",k[k.DataValidation=5]="DataValidation",k[k.Indirect=6]="Indirect",k[k.WSF=7]="WSF",k[k.UDF=8]="UDF",k[k.Other=9]="Other"})(s=t.LexicalKind||(t.LexicalKind={})),(c=t.NameSource||(t.NameSource={})).AppHead="AppHead",c.Plain="Plain",c.StructRef="StructRef",c.Indirect="Indirect",t.lexicalSourceCell=v,t.lexicalSourceRange=h,t.lexicalSourceGrid=function(k,x){switch(k){case s.Cell:return B(x)?v(x):m("calc.lang.lexicalSourceGrid: expected cell");case s.Range:return h(x)}},t.lexicalSourceName=function(k){return{kind:s.NameManager,name:k}},t.lexicalSourceWSF=function(k){return{kind:s.WSF,id:k}},t.lexicalSourceUDF=function(k){return{kind:s.UDF,udf:k}},t.sheetRows=1048576,t.sheetCols=16384,t.documentLoc=function(k,x){return{path:k,name:x}},t.structRefColumnLoc=function(k,x,G,H){return{name:k,range:x,hasHeadersRow:G,hasTotalsRow:H}},t.sheetRange=S,t.sheetIndex=y,t.allSheetsRange=function(k){return{document:k,index:void 0,index2:void 0}},t.sheetRangeIndexes=function(k,x){return{sheets:k,position:x}},t.unsafeGridRange=C,t.gridRange=function(k,x,G,H){return f("calc.lang.gridRange",k,t.sheetRows),f("calc.lang.gridRange",x,t.sheetCols),p("calc.lang.gridRange",G,t.sheetRows-k),p("calc.lang.gridRange",H,t.sheetCols-x),C(k,x,G,H)},t.gridCell=function(k,x){return f("calc.lang.gridCell",k,t.sheetRows),f("calc.lang.gridCell",x,t.sheetCols),C(k,x,1,1)},t.sheetGridCube=E,t.sheetGridRange=E,t.sheetGridCell=E,t.originCell=E,t.documentScope=I,t.nameScope=function(k,x){return x===void 0?I(k):y(k,x)},t.nameLoc=function(k,x){return{scope:k,name:x}},t.userDefinedFuncLoc=function(k,x){return{document:k,id:x}},t.isSheetIndex=F,t.isGridCell=w,t.isSheetGridRange=function(k){return F(k.sheet)},t.isSheetGridCell=B},7389:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatScientificLeft=t.numberComponents=void 0;var s=d(8350);t.numberComponents=(0,s.typedInstanceCreator)()(function(c,l,f){return{sign:c,mantissa:l,exponent:f}}),t.formatScientificLeft=function(c,l){if(l<=1)return l;var f=c%l;return f===0?l:f<0?f+l:f}},9173:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ieeeMathpack=void 0;var s=d(2294),c=d(8350),l=d(7389),f=d(1345),p=d(3883),m=d(9745),v=d(3424),h=d(9119),S=f.codePointDigitZero;function y(L){return{kind:v.OperKind.Number,_valueIEEE:L}}var C=y(0),E=y(1),I=y(Math.PI);function F(L){return isFinite(L)?y(L):s.numErrorOper}function w(L,D){var U=L._valueIEEE,V=D._valueIEEE;return U<V?-1:U>V?1:0}function B(L,D){var U=D===void 0?L.toExponential():L.toExponential(D),V=U.indexOf("e"),ne=!(0,p.stringStartsWith)(U,"-"),J=U.substring(ne?0:1,V).replace(".",""),$=parseInt(U.substring(V+1),10)+1;return function(Z){for(var ie=0;ie<Z.length;ie+=1)if(Z.charCodeAt(ie)!==S)return!1;return!0}(J)?{sign:ne,mantissa:"",exponent:0}:{sign:ne,mantissa:J,exponent:$}}var k=["0","1","2","3","4","5","6","7","8","9"];function x(L){var D=L._valueIEEE;return y(D<0?Math.ceil(D):Math.floor(D))}function G(L){var D=L._valueIEEE;return y(Math.floor(D))}function H(L){return L.substring(0,1)+"."+L.substring(1)}t.ieeeMathpack={zero:C,one:E,pi:I,add:function(D,U){return F(D._valueIEEE+U._valueIEEE)},sub:function(D,U){return F(D._valueIEEE-U._valueIEEE)},mul:function(D,U){return F(D._valueIEEE*U._valueIEEE)},div:function(D,U){var V=D._valueIEEE,ne=U._valueIEEE;return ne===0?s.div0ErrorOper:F(V/ne)},power:function(D,U){var V=D._valueIEEE,ne=U._valueIEEE,J=Math.pow(V,ne);return isFinite(J)?y(J):isNaN(J)?s.div0ErrorOper:s.numErrorOper},percent:function(D){return y(D._valueIEEE/100)},neg:function(D){return y(-D._valueIEEE)},compare:w,formatGeneral:function(D,U,V){var ne=D.decimalSeparator,J=U._valueIEEE,$=String(J).replace("e","E");return ne!=="."&&($=$.replace(".",ne)),$},formatFixed:function(D,U,V){var ne,J=D._valueIEEE,$=B(J),Z=$.sign,ie=$.mantissa,X=$.exponent,Q=V+(X+U);if(Q===0){var b=parseFloat("5e"+String(X-1));if(Math.abs(J)>=b)return(0,l.numberComponents)(Z,"1",X+U+1)}if(Q<1)return(0,l.numberComponents)(!0,"",0);Q<=21&&(Z=(ne=B(J,Q-1)).sign,ie=ne.mantissa,Q=V+((X=ne.exponent)+U));var R=ie.substring(0,Q);return(0,l.numberComponents)(Z,R,R.length===0?0:X+U)},formatScientific:function(D,U,V){var ne,J=D._valueIEEE,$=B(J),Z=$.sign,ie=$.mantissa,X=$.exponent,Q=(0,l.formatScientificLeft)(X,U),b=Q+V;if((0,m.assertTrue)("calc.lang.ieeeFormatScientific",b>0),b===0){var R=parseFloat("5e"+String(X-1));if(Math.abs(J)>=R)return(0,l.numberComponents)(Z,"",X+1)}if(b<1)return(0,l.numberComponents)(!0,"",0);b<=21&&(Z=(ne=B(J,b-1)).sign,ie=ne.mantissa,X=ne.exponent,b=(Q=(0,l.formatScientificLeft)(X,U))+V);var P=ie.substring(0,b);return(0,l.numberComponents)(Z,P,P.length===0?0:X)},parse:function(D,U,V,ne){return y(+((U?"":"-")+"0."+function(J,$){for(var Z=J.getOrdinal,ie="",X=0,Q=(0,h.codePointIterator)($);X<Q.length;X++){var b=Q[X];ie+=k[Z(b)]}return ie}(D,ne)+"E"+String(V)))},trunc:x,ceil:function(D){var U=D._valueIEEE;return y(Math.ceil(U))},floor:G,abs:function(D){return y(Math.abs(D._valueIEEE))},cond:function(D){return w(D,C)},cond2:w,fromNumber:y,toNumber:function(D){return D._valueIEEE},sqrt:function(D){return F(Math.sqrt(D._valueIEEE))},exp:function(D){return F(Math.exp(D._valueIEEE))},ln:function(D){return F(Math.log(D._valueIEEE))},log:function(D){return F(Math.log(D._valueIEEE)/Math.LN10)},sin:function(D){return y(Math.sin(D._valueIEEE))},cos:function(D){return y(Math.cos(D._valueIEEE))},tan:function(D){return y(Math.tan(D._valueIEEE))},asin:function(D){return F(Math.asin(D._valueIEEE))},acos:function(D){return F(Math.acos(D._valueIEEE))},atan:function(D){return F(Math.atan(D._valueIEEE))},atan2:function(D,U){return y(Math.atan2(U._valueIEEE,D._valueIEEE))},round:function(D,U){var V=D._valueIEEE;if(V===0)return C;var ne=B(V).exponent,J=x(U)._valueIEEE+ne;if(J===0){var $=parseFloat("5e"+String(ne-1));if(Math.abs(V)>=$)return F((V<0?-1:1)*parseFloat("10e"+String(ne-1)))}return J<1?C:J>21?D:F(parseFloat(V.toExponential(J-1)))},roundUp:function(D,U){var V=D._valueIEEE;if(V===0)return C;var ne=B(V),J=ne.sign,$=ne.mantissa,Z=ne.exponent,ie=x(U)._valueIEEE+Z;return ie<1?F(parseFloat((J?"":"-")+"10e"+String(Z-1-ie))):ie>21?D:F(parseFloat((J?"":"-")+function(X,Q){if(X.length<=Q)return H(X);for(var b=X.substring(0,Q),R=0,P=b.length-1;P>=0&&b.charCodeAt(P)-S==9;P-=1)R+=1;return R===b.length?"10":H(b.substring(0,b.length-R-1)+String.fromCharCode(b.charCodeAt(b.length-R-1)+1))}($,ie)+"e"+String(Z-1)))},roundDown:function(D,U){var V=D._valueIEEE;if(V===0)return C;var ne=B(V),J=ne.sign,$=ne.mantissa,Z=ne.exponent,ie=x(U)._valueIEEE+Z;if(ie<1)return C;if(ie>21)return D;var X=$.substring(0,ie);return F(parseFloat((J?"":"-")+H(X)+"e"+String(Z-1)))},tenTo:function(D){return(0,m.assertInteger)("calc.lang.ieeeTenTo",D),F(Math.pow(10,D))},checkAlmostCancellation:function(D,U){return U},fix:function(D){var U=D._valueIEEE,V=Math.abs(U);return V>=4294967296?4294967295:Math.floor(V)},lfix:function(D){var U=x(D)._valueIEEE;return U<-2147483648||U>2147483647?-2147483648:U},sfix:function(D){var U=G(D)._valueIEEE;return U<-2147483648?-2147483648:U>2147483647?2147483647:U},viewRound:c.identity}},3962:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlMathpack=void 0;var s=d(9799),c=d(2294),l=d(9745),f=d(3424),p=d(8350);function m(D){return{kind:f.OperKind.Number,_valueXL:D}}var v=m(s.mathpack.zero()),h=m(s.mathpack.one()),S=m(s.mathpack.pi());function y(D){return D.num&s.mathpack.MathErrorNum.DivBy0?c.div0ErrorOper:c.numErrorOper}function C(D){return function(U){return(0,l.assertFalse)("calc.lang.".concat(D,": error ").concat(JSON.stringify(U)))}}function E(D,U,V){return function(ne){var J=D(ne._valueXL);return typeof J=="number"?U(J):V(J)}}function I(D,U,V){return function(ne,J){var $=D(ne._valueXL,J._valueXL);return typeof $=="number"?U($):V($)}}var F=I(function(D,U){return s.mathpack.equal(U,2)?s.mathpack.mul(D,D):s.mathpack.power(D,U)},m,y),w=E(function(D){return s.mathpack.div(D,100)},m,C("xlPercent")),B=E(s.mathpack.ceil,m,C("xlCeil")),k=E(s.mathpack.floor,m,C("xlFloor")),x=E(s.mathpack.cond,p.identity,C("xlCond, isSupported = ".concat((0,s.isSupported)()))),G=I(s.mathpack.cond2,p.identity,C("xlCond2")),H=E(s.mathpack.sfix,p.identity,C("xlSfix")),L=E(s.mathpack.viewRound,m,C("xlViewRound"));t.xlMathpack={zero:v,one:h,pi:S,add:I(s.mathpack.add,m,y),sub:I(s.mathpack.sub,m,y),mul:I(s.mathpack.mul,m,y),div:I(s.mathpack.div,m,y),power:F,percent:w,neg:function(U){return x(U)!==0?m(s.mathpack.neg(U._valueXL)):U},compare:function(U,V){return s.mathpack.compare(U._valueXL,V._valueXL)},formatGeneral:function(U,V,ne){var J=V._valueXL,$=s.mathpack.formatGeneral(U,J,ne);return typeof $!="string"?(0,l.assertFalse)("calc.lang.xlFormatGeneral: error ".concat(JSON.stringify($))):$},formatFixed:function(U,V,ne){var J=U._valueXL,$=s.mathpack.formatFixed(J,V,ne);return typeof $!="object"?(0,l.assertFalse)("calc.lang.xlFormatFixed: error ".concat(JSON.stringify($))):$},formatScientific:function(U,V,ne){var J=U._valueXL,$=s.mathpack.formatScientific(J,V,ne);return typeof $!="object"?(0,l.assertFalse)("calc.lang.xlFormatScientific: error ".concat(JSON.stringify($))):$},parse:function(U,V,ne,J){var $=s.mathpack.pack(U,V,ne,J);return typeof $!="number"?(0,l.assertFalse)("calc.lang.xlParse: error ".concat(JSON.stringify($))):m($)},trunc:function(U){return m(s.mathpack.trunc(U._valueXL))},ceil:B,floor:k,abs:function(U){return m(s.mathpack.abs(U._valueXL))},cond:x,cond2:G,fromNumber:function(U){return(0,l.assertTrue)("calc.lang.xlFromNumber",isFinite(U)),m(U)},toNumber:function(U){var V=U._valueXL;return(0,l.assertTrue)("calc.lang.xlToNumber",isFinite(V)),V},sqrt:E(s.mathpack.sqrt,m,y),exp:E(s.mathpack.exp,m,y),ln:E(s.mathpack.ln,m,y),log:E(s.mathpack.log,m,y),sin:E(s.mathpack.sin,m,y),cos:E(s.mathpack.cos,m,y),tan:E(s.mathpack.tan,m,y),asin:E(s.mathpack.asin,m,y),acos:E(s.mathpack.acos,m,y),atan:E(s.mathpack.atan,m,y),atan2:I(s.mathpack.atan2,m,y),round:I(s.mathpack.round,m,y),roundUp:I(s.mathpack.roundUp,m,y),roundDown:I(s.mathpack.roundDown,m,y),tenTo:function(U){(0,l.assertInteger)("calc.lang.xlTenTo",U);var V=s.mathpack.tenTo(U);return typeof V=="number"?m(V):y(V)},checkAlmostCancellation:function(U,V){var ne=U._valueXL,J=V._valueXL;return s.mathpack.exp32(ne)-s.mathpack.exp32(J)>=52428800?v:V},fix:function(U){return s.mathpack.fix(U._valueXL)},lfix:function(U){return s.mathpack.lfix(U._valueXL)},sfix:H,viewRound:L}},9421:function(u,t){"use strict";var d,s,c,l,f;Object.defineProperty(t,"__esModule",{value:!0}),t.KnownFormat=t.Calendar=t.NumberShape=t.DateOrder=t.CurrencyFormat=void 0,(f=t.CurrencyFormat||(t.CurrencyFormat={})).Paren="Paren",f.Lead="Lead",f.Intern="Intern",f.Trail="Trail",(l=t.DateOrder||(t.DateOrder={})).MDY="MDY",l.DMY="DMY",l.YMD="YMD",l.MYD="MYD",l.DYM="DYM",l.YDM="YDM",(c=t.NumberShape||(t.NumberShape={})).ASCII="ASCII",c.ArabicIndic="ArabicIndic",c.ExtendedArabicIndic="ExtendedArabicIndic",c.Devanagari="Devanagari",c.Bengali="Bengali",c.Gurmukhi="Gurmukhi",c.Gujarati="Gujarati",c.Oriya="Oriya",c.Tamil="Tamil",c.Telugu="Telugu",c.Kannada="Kannada",c.Malayalam="Malayalam",c.Thai="Thai",c.Lao="Lao",c.Tibetan="Tibetan",c.Myanmar="Myanmar",c.Ethiopic="Ethiopic",c.Khmer="Khmer",c.Mongolian="Mongolian",c.ChineseTrad1="ChineseTrad1",c.ChineseTrad2="ChineseTrad2",c.ChineseTrad3="ChineseTrad3",c.ChineseSimp1="ChineseSimp1",c.ChineseSimp2="ChineseSimp2",c.ChineseSimp3="ChineseSimp3",c.Japanese1="Japanese1",c.Japanese2="Japanese2",c.Japanese3="Japanese3",c.Korean1="Korean1",c.Korean2="Korean2",c.Korean3="Korean3",c.Korean4="Korean4",(s=t.Calendar||(t.Calendar={})).Gregorian="Gregorian",s.GregorianUS="GregorianUS",s.Japan="Japan",s.Taiwan="Taiwan",s.Korea="Korea",s.Hijri="Hijri",s.Thai="Thai",s.Hebrew="Hebrew",s.GregorianMEFrench="GregorianMEFrench",s.GregorianArabic="GregorianArabic",s.GregorianXlitEnglish="GregorianXlitEnglish",s.GregorianXlitFrench="GregorianXlitFrench",s.Persian="Persian",s.UmAlQura="UmAlQura",(d=t.KnownFormat||(t.KnownFormat={}))[d.General=0]="General",d[d.NoComFixed0=-1]="NoComFixed0",d[d.NoComFixed=-2]="NoComFixed",d[d.Fixed0=-3]="Fixed0",d[d.Fixed=-4]="Fixed",d[d.Currency=-9]="Currency",d[d.CoCurrency=-10]="CoCurrency",d[d.CurrencyDec=-11]="CurrencyDec",d[d.CoCurrencyDec=-12]="CoCurrencyDec",d[d.Pct0=-13]="Pct0",d[d.Pct=-14]="Pct",d[d.Exp=-15]="Exp",d[d.Fract=-17]="Fract",d[d.FractBond=-18]="FractBond",d[d.MMDDYY=-19]="MMDDYY",d[d.DDMMMYY=-20]="DDMMMYY",d[d.DDMMM=-21]="DDMMM",d[d.MMMYY=-22]="MMMYY",d[d.HHMMAP=-23]="HHMMAP",d[d.HHMMSSAP=-24]="HHMMSSAP",d[d.HHMM=-25]="HHMM",d[d.HHMMSS=-26]="HHMMSS",d[d.MDYHMS=-27]="MDYHMS",d[d.USCoCurrency=-37]="USCoCurrency",d[d.USCoCurrencyDec=-39]="USCoCurrencyDec",d[d.Currency2=-5]="Currency2",d[d.CoCurrency2=-6]="CoCurrency2",d[d.CurrencyDec2=-7]="CurrencyDec2",d[d.CoCurrencyDec2=-8]="CoCurrencyDec2",d[d.Acct=-33]="Acct",d[d.AcctCur=-32]="AcctCur",d[d.AcctDec=-35]="AcctDec",d[d.AcctDecCur=-34]="AcctDecCur",d[d.MMSS=-28]="MMSS",d[d.AbsHMMSS=-31]="AbsHMMSS",d[d.SS0=-29]="SS0",d[d.Eng=-16]="Eng",d[d.Text=-30]="Text"},1214:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPrinter=t.anonymizeFormula=void 0;var s,c=d(655),l=d(3546),f=d(2294),p=d(5947),m=d(9745),v=d(927),h=d(9937),S=d(3378),y=d(4038),C=d(5499),E=d(3883),I=d(2195),F=d(7458),w=d(7815),B=d(9017),k=d(3424),x=d(625),G=d(4114),H=d(9119),L=/"/g,D=(0,h.sheetGridCell)((0,h.sheetIndex)((0,h.documentLoc)(void 0,"Book1"),0),(0,h.gridCell)(0,0));function U(T){if(!(0,w.isSuccess)(T)&&T.reason.kind!==I.ResolveReasonKind.NoOriginSheet&&T.reason.kind!==I.ResolveReasonKind.InvalidQualifier&&T.reason.kind!==I.ResolveReasonKind.InvalidCellRef&&T.reason.kind!==I.ResolveReasonKind.InvalidStructRef&&T.reason.kind!==I.ResolveReasonKind.EmptyIntersection)throw new ie(T.reason)}function V(T){for(var g=[],O=[],M=0,K=T;M<K.length;M++){var W=K[M];W.length>0&&(0,H.numCodeUnits)((0,H.stringCodePointAt)(W,0))===W.length?g[(0,H.stringCodePointAt)(W,0)]=!0:O.push(W)}return function(z,ee){var ue=(0,H.stringCodePointAt)(z,ee);if(g[ue]===!0)return!0;for(var ce=0,he=O;ce<he.length;ce++){var de=he[ce];if((0,E.stringStartsWith)(z,de,ee))return!0}return!1}}function ne(T,g){for(var O="",M=0;M<T.length;){g(T,M)&&(O+="'");var K=(0,H.stringCodePointAt)(T,M);O+=(0,H.stringFromCodePoint)(K),M+=(0,H.numCodeUnits)(K)}return O}(function(T){T[T.Original=0]="Original",T[T.Bracketed=1]="Bracketed",T[T.Unbracketed=2]="Unbracketed"})(s||(s={}));var J={literalNode:function(g,O,M){return M},arrayNode:function(g,O,M){return M},appNode:function(g,O,M,K){return K},letNode:function(g,O,M,K,W,z){return z},lambdaNode:function(g,O,M,K,W,z){return z},parenNode:function(g,O,M){return M},nameNode:function(g,O,M){return M},cellRefNode:function(g,O,M){return M},fieldRefNode:function(g,O,M,K){return K},structRefNode:function(g,O,M){return M},badSequenceNode:function(g,O,M){return M},badStringNode:function(g,O,M){return M},operatorNode:function(g,O){return O},wsfNode:function(g,O,M){return M}},$=c.__assign(c.__assign({},(0,B.constVisitor)(void 0)),{operatorNode:function(g){return g}}),Z=function(){function T(g,O,M,K){var W,z,ee,ue,ce=this;this.root=M,this.anonymize=K,this.anon=function(pe){return ce.anonymize?(0,y.anonymizeFormulaString)(pe):pe},this.locals=O,this.localeInfo=(z=(W=O.config)===null||W===void 0?void 0:W.localeInfo)!==null&&z!==void 0?z:g.config.localeInfo,this.mathpack=g.config.mathpack,this.refStyle=(ue=(ee=O.config)===null||ee===void 0?void 0:ee.refStyle)!==null&&ue!==void 0?ue:g.config.refStyle,this.resolver=(0,F.createResolver)(g),this.spans=M.spans,this.annotations=M.annotations;var he=["'",this.localeInfo.leftBracket,this.localeInfo.rightBracket,"#","@"],de=c.__spreadArray(c.__spreadArray([],he,!0),["	","\n","\r"," ","!",'"',"$","%","&","(",")","*","+",this.localeInfo.listSeparator,"-",".","/",":",";","<","=",">","?","\\","^","_","`","{","}","~"],!1);this.isStructRefEscapable=V(he),this.isStructRefBracketedThisRef=V(de),this.isFieldRefEscapable=V(["'",this.localeInfo.leftBracket,this.localeInfo.rightBracket])}return T.prototype.print=function(){var g=new B.ZipVisitor({str:this,label:J,op:$});return"="+this.pre(this.root.node.label,"")+(0,B.reduceBottomUp)(g,this.root).str+this.postIfComments(this.root.node.label)},T.prototype.pre=function(g,O){var M,K;return this.anonymize?O:(K=(M=this.spans[g])===null||M===void 0?void 0:M.pre)!==null&&K!==void 0?K:O},T.prototype.post=function(g,O){var M,K;return this.anonymize?O:(K=(M=this.spans[g])===null||M===void 0?void 0:M.post)!==null&&K!==void 0?K:O},T.prototype.preIfComments=function(g){if(this.anonymize)return"";var O=this.spans[g];return(O==null?void 0:O.preComments)!=null&&O.preComments.length>0?O.pre:""},T.prototype.postIfComments=function(g){if(this.anonymize)return"";var O=this.spans[g];return(O==null?void 0:O.postComments)!=null&&O.postComments.length>0?O.post:""},T.prototype.printRef=function(g,O){var M="";switch(g.kind){case l.StructRefKind.SpecialRef:(O===s.Original&&g.isBracketed||O===s.Bracketed)&&(M+=this.localeInfo.leftBracket);var K=this.localeInfo.specialRefNames[g.id];if(K==null)throw new ie((0,v.internal)("No locale data for specialRefName"));M+=K,(O===s.Original&&g.isBracketed&&g.isClosed||O===s.Bracketed)&&(M+=this.localeInfo.rightBracket);break;case l.StructRefKind.ColumnRef:var W=g.name.length===0||(0,E.stringStartsWith)(g.name," ")||(0,E.stringEndsWith)(g.name," ");(O===s.Original&&g.isBracketed||O===s.Bracketed||O===s.Unbracketed&&W)&&(M+=this.localeInfo.leftBracket);var z=ne(g.name,this.isStructRefEscapable);M+=this.anon(z),(O===s.Original&&g.isBracketed&&g.isClosed||O===s.Bracketed||O===s.Unbracketed&&W)&&(M+=this.localeInfo.rightBracket);break;case l.StructRefKind.RangeOpRef:M+=this.printRef(g.lhs,O===s.Original?O:s.Bracketed)+":"+this.printRef(g.rhs,O===s.Original?O:s.Bracketed);break;case l.StructRefKind.MissingRef:break;case l.StructRefKind.BadRef:g.isBracketed&&(M+=this.localeInfo.leftBracket),M+=g.contents,g.isBracketed&&g.isClosed&&(M+=this.localeInfo.rightBracket)}return M},T.prototype.printThisRowOpRef=function(g){var O="@";return g&&(g.kind===l.StructRefKind.ColumnRef?O+=this.printRef(g,g.isClosed?function(M,K){for(var W=0;W<M.length;){if(K(M,W))return!0;W+=(0,H.numCodeUnits)((0,H.stringCodePointAt)(M,W))}return!1}(g.name,this.isStructRefBracketedThisRef)?s.Bracketed:s.Unbracketed:s.Original):O+=this.printRef(g,(0,v.isRangeOpClosed)(g)&&(0,v.isRangeOpNoMissing)(g)?s.Bracketed:s.Original)),O},T.prototype.printApplication=function(g,O,M){var K=this,W=O.map(function(z,ee,ue){return K.pre(z.label,ee===0||z.str===""?"":" ")+z.str+(ee===ue.length-1?K.post(z.label,""):K.postIfComments(z.label))});return g.str+"("+W.join(this.localeInfo.listSeparator)+(M?")":"")},T.prototype.printCellRef=function(g){var O=g.ref,M=g.qualifier;return(M!==void 0?(0,B.visitQualifier)(this,M)+this.postIfComments(M.label):"")+(0,B.visitCellRef)(this,O)},T.prototype.printName=function(g){var O=g.whole,M=g.qualifier;return(M!==void 0?(0,B.visitQualifier)(this,M)+this.postIfComments(M.label):"")+this.anon(O)},T.prototype.printUnanonymisedDocQual=function(g){if(g===void 0)return"";var O=g.path,M=g.document;return(O??"")+this.localeInfo.leftBracket+M+this.localeInfo.rightBracket},T.prototype.printOptionalParamName=function(g){return g.kind===l.NodeKind.Name?this.anon((0,v.getBoundName)(this.localeInfo,g.whole)):this.pre(g.label,"")+this.anon(g.contents)+this.post(g.label,"")},T.prototype.literalNode=function(g,O,M){switch(g.kind){case k.OperKind.String:return'"'+this.anon(g.value).replace(L,'""')+'"';case k.OperKind.Boolean:return g.value?this.localeInfo.trueName:this.localeInfo.falseName;case k.OperKind.Number:return this.anon(this.mathpack.formatGeneral(this.localeInfo,g,21));case k.OperKind.Missing:return"";case k.OperKind.Error:var K=this.localeInfo.errorNames[g.type];if(K==null)throw new ie((0,v.internal)("No locale data for error type ".concat(g.type)));return K;default:return(0,m.assertNever)("calc.lang.printFormula",g)}},T.prototype.arrayNode=function(g,O,M){var K=this;return this.localeInfo.leftBrace+g.map(function(W){return W.map(function(z){return K.preIfComments(z.label)+z.str+K.postIfComments(z.label)}).join(K.localeInfo.columnSeparator)}).join(this.localeInfo.rowSeparator)+(O?this.localeInfo.rightBrace:"")},T.prototype.appNode=function(g,O,M,K){if(g.op!==void 0){if(O.length===1){var W=O[0];switch(g.op){case p.OperatorId.Percent:return W.str+this.pre(g.label,"")+g.str;case p.OperatorId.Pound:return W.str+this.preIfComments(g.label)+g.str;default:return g.str+this.post(g.label,"")+W.str}}if(O.length===2){var z=O[0],ee=O[1],ue=" ",ce=" ";switch(g.op){case p.OperatorId.Range:ue=ce="";break;case p.OperatorId.Isect:ce="";break;case p.OperatorId.Union:ue=""}return z.str+this.pre(g.label,ue)+g.str+this.post(g.label,ce)+ee.str}return(0,m.assertFalse)("calc.lang.printFormula: invalid number of operator args")}return this.printApplication(g,O,M)},T.prototype.letNode=function(g,O,M,K,W,z){var ee=this,ue=O.map(function(ce){var he=ce.name,de=ce.binder;return(0,l.letVar)((0,l.indexedArg)({str:ee.anon((0,v.getBoundName)(ee.localeInfo,he.arg.whole)),label:he.arg.label,op:void 0},he.index),de)});return this.printApplication(g,(0,l.flattenLetArgs)(ue,M,K),W)},T.prototype.lambdaNode=function(g,O,M,K,W,z){var ee=this,ue=O.map(function(ce){var he=ce.name,de=(he.arg.name.isBracketed?ee.localeInfo.leftBracket:"")+ee.printOptionalParamName(he.arg.name.name)+(he.arg.name.isBracketed&&he.arg.name.isClosed?ee.localeInfo.rightBracket:"");return he.arg.def!==void 0&&(de+=ee.pre(he.arg.def.label," ")+":="+ee.pre(he.arg.def.rhs.label,he.arg.def.rhs.str===""?"":" ")+he.arg.def.rhs.str),(0,l.lambdaParam)((0,l.indexedArg)({str:de,label:he.arg.label,op:void 0},he.index))});return this.printApplication(g,(0,l.flattenLambdaArgs)(ue,M,K),W)},T.prototype.parenNode=function(g,O,M){return"("+this.pre(g.label,"")+g.str+this.post(g.label,"")+(O?")":"")},T.prototype.nameNode=function(g,O,M){var K=this.resolver.resolveDottedName(this.locals,(0,l.nameNode)(g,O,M),this.annotations),W=K.resolved,z=K.fields;return U(W.resolution),W.kind===I.ResolvedKind.ResolvedCellRef?c.__spreadArray([this.printCellRef(W.node)],z.map(this.anon),!0).join("."):W.kind===I.ResolvedKind.ResolvedLocalName&&W.resolution.value!==void 0?c.__spreadArray([this.anon(W.resolution.value.name)],z.map(this.anon),!0).join("."):W.kind===I.ResolvedKind.ResolvedUserDefinedFunc?c.__spreadArray([this.anon(W.name)],z.map(this.anon),!0).join("."):c.__spreadArray([this.printName(W.node)],z.map(this.anon),!0).join(".")},T.prototype.cellRefNode=function(g,O,M){var K=this.resolver.resolveCellRef(this.locals,(0,l.cellRefNode)(g,O,M)),W=K.node;return U(K.resolution),this.printCellRef(W)},T.prototype.fieldRefNode=function(g,O,M,K){var W=g.str,z=M,ee=O.isBracketed||z?this.localeInfo.leftBracket:"",ue=O.isBracketed&&O.isClosed||z?this.localeInfo.rightBracket:"",ce=O.field.kind===l.NodeKind.Name?ne(O.field.whole,this.isFieldRefEscapable):O.field.contents;return O.field.kind!==l.NodeKind.Name?W+=this.pre(O.label,""):W+=this.preIfComments(O.label),W+"."+ee+this.anon(ce)+ue+this.post(O.label,"")},T.prototype.structRefNode=function(g,O,M){var K,W=this,z=this.resolver.resolveStructRef(this.locals,(0,l.structRefNode)(g,O,M)),ee=z.node,ue=z.table;U(z.resolution);var ce=ee.rhs.innerRef,he=ee.lhs;he!==void 0||ue===void 0||!ee.rhs.isClosed||(ce==null?void 0:ce.kind)===l.StructRefKind.ColumnRef||(ce==null?void 0:ce.kind)===l.StructRefKind.ThisRowOpRef&&((K=ce.ref)===null||K===void 0?void 0:K.kind)===l.StructRefKind.ColumnRef||(he=(0,l.nameNode)((0,l.identNamePart)(ue.name)));var de=he!==void 0?this.printName(he):"";if(ce===void 0&&ee.rhs.isClosed&&he!==void 0)return de;switch(de+=this.localeInfo.leftBracket,ce==null?void 0:ce.kind){case l.StructRefKind.ColumnRef:case l.StructRefKind.SpecialRef:if(ce.kind===l.StructRefKind.SpecialRef&&ce.id===l.SpecialRefId.ThisRow&&ce.isClosed){de+=this.printThisRowOpRef(void 0);break}de+=this.printRef(ce,ce.isClosed?s.Unbracketed:s.Original);break;case l.StructRefKind.RangeOpRef:var pe=(_e=(0,v.isRangeOpClosed)(ce)&&(0,v.isRangeOpNoMissing)(ce))?s.Bracketed:s.Original;de+=this.printRef(ce,pe);break;case l.StructRefKind.CommaOpRef:var _e;if((_e=(0,v.isCommaOpRefWellFormed)(ce)&&(0,v.isCommaOpClosed)(ce)&&(0,v.isCommaOpNoBadOrMissing)(ce))&&ce.specialRefs[l.SpecialRefId.ThisRow]){de+=this.printThisRowOpRef(ce.columnRefs.length===0?void 0:ce.columnRefs[0]);break}var Ce=_e?(0,v.normalizeCommaOpRef)(ce):ce.refs,Ne=_e?Ce.length===1?s.Unbracketed:s.Bracketed:s.Original;de+=Ce.map(function(Le){return W.printRef(Le,Ne)}).join(this.localeInfo.listSeparator);break;case l.StructRefKind.ThisRowOpRef:de+=this.printThisRowOpRef(ce.ref);break;case l.StructRefKind.BadRef:de+=this.printRef(ce,s.Original)}return ee.rhs.isClosed&&(de+=this.localeInfo.rightBracket),de},T.prototype.badSequenceNode=function(g,O,M){var K=this;return O.map(function(W){return K.pre(W.label,"")+W.str+K.post(W.label,"")}).join("")},T.prototype.badStringNode=function(g,O,M){return this.anon(O)},T.prototype.operatorNode=function(g,O){var M=(0,S.operatorIdToName)(this.localeInfo,g,"");if(M===void 0)throw new ie((0,v.internal)("Invalid operator"));return M},T.prototype.wsfNode=function(g,O,M){return this.localeInfo.getWorksheetFuncName(g)},T.prototype.cellRefError=function(){var g=this.localeInfo.errorNames[f.ErrorType.REF];if(g==null)throw new ie((0,v.internal)("No locale data for #REF"));return g},T.prototype.cellRefSingle=function(g,O,M){var K=(0,C.formatCellPos)(this.localeInfo,this.refStyle,this.locals.originGridCell.value,g,O,this.locals.wrapCellReferences);return K!==void 0?this.anon(K):this.cellRefError()},T.prototype.cellRefRange=function(g,O){var M=(0,C.formatRangePos)(this.localeInfo,this.refStyle,this.locals.originGridCell.value,g.row,g.col,O.row,O.col,this.locals.wrapCellReferences);return M!==void 0?this.anon(M):this.cellRefError()},T.prototype.cellRefRow=function(g,O,M){var K=(0,C.formatRowRange)(this.localeInfo,this.refStyle,this.locals.originGridCell.value.row,g,O,this.locals.wrapCellReferences);return K!==void 0?this.anon(K):this.cellRefError()},T.prototype.cellRefCol=function(g,O,M){var K=(0,C.formatColRange)(this.localeInfo,this.refStyle,this.locals.originGridCell.value.col,g,O,this.locals.wrapCellReferences);return K!==void 0?this.anon(K):this.cellRefError()},T.prototype.cellRefBad=function(g,O){return this.anon(g)},T.prototype.errorQualifier=function(){var g=this.localeInfo.errorNames[f.ErrorType.REF];if(g==null)throw new ie((0,v.internal)("No locale data for #REF"));return g},T.prototype.relativeQualifier=function(){return"!"},T.prototype.documentQualifier=function(g,O,M){return(0,C.quoteQualifier)(this.anon(this.printUnanonymisedDocQual((0,l.documentQualifier)(g,O))))+"!"},T.prototype.sheetQualifier=function(g,O,M){return(0,C.formatQualifier)(this.localeInfo,this.refStyle,this.anon(this.printUnanonymisedDocQual(O)+g))+"!"},T.prototype.identQualifier=function(g,O){return(0,C.formatQualifier)(this.localeInfo,this.refStyle,this.anon(g))+"!"},T.prototype.sheetRangeQualifier=function(g,O,M,K){var W=this.anon(this.printUnanonymisedDocQual(M)+g),z=this.anon(O),ee=W+":"+z;return((0,C.shouldQuoteQualifier)(this.localeInfo,this.refStyle,W)||(0,C.shouldQuoteQualifier)(this.localeInfo,this.refStyle,z)?(0,C.quoteQualifier)(ee):ee)+"!"},T.prototype.badQualifier=function(g,O){return this.anon(g)},T}(),ie=(0,v.createFailureErrorClass)("PrintFormulaError"),X=(0,v.createFailureErrorClass)("PrintRangeError");function Q(T,g,O,M){M===void 0&&(M=!1);try{return(0,w.success)(new Z(T,g,O,M).print())}catch(K){return K instanceof ie?(0,w.failure)(K.reason):(0,w.failure)((0,w.javaScriptError)(K))}}function b(T,g){return(0,l.cellRefSingle)((0,l.pos)(l.PosKind.Rel,g.row-T.row),(0,l.pos)(l.PosKind.Rel,g.col-T.col))}function R(T){return(0,w.isSuccess)(T)?((0,m.assertTrue)("calc.lang.printRangeStructRef: NameLoc can't be no-table",T.value!=null),(0,w.success)(T.value)):T.reason.kind===I.ResolveReasonKind.InvalidStructRef?(0,m.assertFalse)("calc.lang.printRangeStructRef: NameLoc can't be InvalidStructRef"):(0,w.failure)(T.reason)}function P(T,g,O,M){var K,W;M===void 0&&(M=(0,x.makeEmptyTable)());try{var z=g.originSheet.value;if(!(0,v.isDocumentLocEqual)(z.document,O.sheet.document))throw new X((0,v.notImplemented)(["printRange cross-document"]));return(0,w.success)((W=(K=function(ee,ue,ce,he){var de=ue.originSheet.value,pe=ee.getNamedRanges(ce);if(!(0,w.isSuccess)(pe))throw new X(pe.reason);if(pe.value.length!==0){var _e=function(me){return me.index!==void 0&&(de.index===void 0||!(0,v.isSheetIndexEqual)(me,de))},Ce=pe.value.filter(function(le){var me=le.scope;return me.index===void 0?(0,v.isDocumentLocEqual)(me.document,ce.sheet.document):(0,v.isSheetIndexEqual)(me,ce.sheet)}).filter(function(le){var me=le.scope,Pe=le.name;if(me.index!==void 0||de.index===void 0)return!0;var Re=de,fe=ee.getNameLoc(Re,Pe,h.NameSource.Plain);if(!(0,w.isSuccess)(fe))throw new X(fe.reason);return fe.value==null}).filter(function(le){var me=le.scope,Pe=le.name;return _e(me)||!he.contains(Pe)});if(Ce.length!==0){var Ne,Le=Ce.length===1?Ce[0]:c.__spreadArray([],Ce,!0).sort(function(le,me){return ee.config.localeInfo.stringCompareCI(le.name,me.name)})[0];if(_e(Le.scope)){var Oe=ee.getSheetName(Le.scope.document,Le.scope.index);if(!(0,w.isSuccess)(Oe))throw new X(Oe.reason);Ne=(0,l.sheetQualifier)(Oe.value)}return(0,l.nameNode)((0,l.identNamePart)(Le.name),Ne)}}}(T,g,O,M))!==null&&K!==void 0?K:function(ee,ue,ce){var he=ce.sheet,de=ce.range,pe=ee.getContainingTable((0,h.sheetGridCell)(he,(0,v.gridRangeAnchor)(de)));if(!(0,w.isSuccess)(pe))throw new X(pe.reason);if(pe.value!=null){var _e=pe.value,Ce=R(ee.getStructRefSpecialRef(_e,l.SpecialRefId.All));if(!(0,w.isSuccess)(Ce))throw new X(Ce.reason);var Ne=Ce.value.range,Le=Ce.value.sheet,Oe=(0,v.gridRangeCompare)(Ne,de);if(!(Oe===void 0||Oe<0)){var le=R(ee.getStructRefSpecialRef(_e,l.SpecialRefId.Data));if(!(0,w.isSuccess)(le))throw new X(le.reason);var me=le.value.range,Pe=ue.originGridCell.value,Re=ue.originSheet.value,fe=Re.index!==void 0&&(0,v.isSheetIndexEqual)(Re,Le)&&(0,v.gridRangeIsects)(Ne,Pe)?void 0:(0,l.nameNode)((0,l.identNamePart)(_e.name)),Se=fe??(0,l.nameNode)((0,l.identNamePart)(_e.name)),be=me.cols>1&&de.col===me.col&&de.cols===me.cols,xe=function(){var Rr=R(ee.getStructRefColumn(_e,de.col));if(!(0,w.isSuccess)(Rr))throw new X(Rr.reason);if(de.cols===1)return(0,l.columnRef)(Rr.value.name);var ir=R(ee.getStructRefColumn(_e,de.col+de.cols-1));if(!(0,w.isSuccess)(ir))throw new X(ir.reason);return(0,l.rangeOpRef)((0,l.columnRef)(Rr.value.name),(0,l.columnRef)(ir.value.name))};if(de.row===Ne.row&&de.rows===Ne.rows)return(0,l.structRefNode)(Se,(0,l.structRef)(be?(0,l.specialRef)(l.SpecialRefId.All):(0,l.commaOpRef)([(0,l.specialRef)(l.SpecialRefId.All,!0),xe()])));if(de.rows===1&&de.row===Pe.row&&de.row>=me.row&&de.row<me.row+me.rows)return(0,l.structRefNode)(de.cols===1?fe:Se,(0,l.structRef)((0,l.thisRowOpRef)(be?void 0:xe())));if(de.row===me.row&&de.rows===me.rows)return be?(0,l.structRefNode)(Se,(0,l.structRef)(void 0)):(0,l.structRefNode)(de.cols===1?fe:Se,(0,l.structRef)(xe()));var Ie=de.row===Ne.row&&de.row+de.rows===me.row,Ve=de.row===me.row+me.rows&&de.row+de.rows===Ne.row+Ne.rows;if(Ie||Ve){var Ze=(0,l.specialRef)(Ie?l.SpecialRefId.Headers:l.SpecialRefId.Totals,!be);return(0,l.structRefNode)(Se,(0,l.structRef)(be?Ze:(0,l.commaOpRef)([Ze,xe()])))}var gr=de.row===Ne.row&&Ne.row<me.row&&de.row+de.rows===me.row+me.rows,cr=de.row===me.row&&Ne.row+Ne.rows>me.row+me.rows&&de.row+de.rows===Ne.row+Ne.rows;if(gr||cr){var _r=(0,l.specialRef)(gr?l.SpecialRefId.Headers:l.SpecialRefId.Data,!0),xr=(0,l.specialRef)(gr?l.SpecialRefId.Data:l.SpecialRefId.Totals,!0);return(0,l.structRefNode)(Se,(0,l.structRef)(be?(0,l.commaOpRef)([_r,xr]):(0,l.commaOpRef)([_r,xr,xe()])))}}}}(T,g,O))!==null&&W!==void 0?W:function(ee,ue,ce){var he,de=ue.originSheet.value,pe=function(Ce,Ne){if(Ne.col===0&&Ne.cols===h.sheetCols)return function(le,me,Pe){return(0,l.cellRefRow)((0,l.pos)(l.PosKind.Rel,me-le.row),(0,l.pos)(l.PosKind.Rel,me+Pe-1-le.row))}(Ce,Ne.row,Ne.rows);if(Ne.row===0&&Ne.rows===h.sheetRows)return function(le,me,Pe){return(0,l.cellRefCol)((0,l.pos)(l.PosKind.Rel,me-le.col),(0,l.pos)(l.PosKind.Rel,me+Pe-1-le.col))}(Ce,Ne.col,Ne.cols);var Le=b(Ce,(0,v.gridRangeAnchor)(Ne));if((0,v.isGridCell)(Ne))return Le;var Oe=b(Ce,(0,h.gridCell)(Ne.row+Ne.rows-1,Ne.col+Ne.cols-1));return(0,l.cellRefRange)(Le,Oe)}(ue.originGridCell.value,ce.range);if(de.index===void 0||!(0,v.isSheetIndexEqual)(de,ce.sheet)){var _e=ee.getSheetName(ce.sheet.document,ce.sheet.index);if(!(0,w.isSuccess)(_e))throw new X(_e.reason);he=(0,l.sheetQualifier)(_e.value)}return(0,l.cellRefNode)(pe,he)}(T,g,O))}catch(ee){return ee instanceof X?(0,w.failure)(ee.reason):(0,w.failure)((0,w.javaScriptError)(ee))}}t.anonymizeFormula=function(T,g,O){try{var M=O.kind===h.LexicalKind.Cell||O.kind===h.LexicalKind.Range?(0,G.printLocalsGrid)(O,(0,v.sheetGridRangeAnchor)(O.range)):O.kind===h.LexicalKind.NameManager?(0,G.printLocalsName)(O,D):(0,m.assertNever)("calc.lang.anonymizeFormula",O),K=Q((0,G.createSimplePrintGlobals)((0,S.calcConfig)((0,S.getEnglishLocaleInfo)(),l.RefStyle.A1,T.mathpack)),M,g,!0);if(K.kind===w.ResultKind.Success)return K.value;if(K.reason.kind===w.ReasonKind.JavaScriptError)throw K.reason.error}catch(z){var W="calc.lang.anonymizeFormula: Format failed: "+(0,E.messageFromError)(z);m.ulsLogger.ULS.traceTag(556863706,S.LogCategory.msoulscat_ES_EWAJS,S.TraceLevel.Warning,W)}return(0,y.anonymize)(g)};var A={getNamedRanges:function(){return(0,m.assertFalse)("calc.lang.prettyPrinter: default getNamedRanges")}};t.createPrinter=function(T){var g=function(O){var M,K,W;return{config:O.config,getDocumentLoc:O.getDocumentLoc.bind(O),getSheetIndex:O.getSheetIndex.bind(O),getSheetName:O.getSheetName.bind(O),getNameLoc:O.getNameLoc.bind(O),getUserDefinedFuncLoc:O.getUserDefinedFuncLoc.bind(O),getSheetRangeIndexes:O.getSheetRangeIndexes.bind(O),getContainingTable:O.getContainingTable.bind(O),getStructRefColumn:O.getStructRefColumn.bind(O),getStructRefSpecialRef:(M=O.getStructRefSpecialRef)===null||M===void 0?void 0:M.bind(O),getNamedRanges:(W=(K=O.getNamedRanges)===null||K===void 0?void 0:K.bind(O))!==null&&W!==void 0?W:A.getNamedRanges}}(T);return{printFormula:function(M,K){return Q(T,M,K)},printRange:function(M,K,W){return P(g,M,K,W)}}}},4114:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.printLocalsName=t.printLocalsGrid=t.createSimplePrintGlobals=void 0;var s=d(9937),c=d(7815),l=d(927),f=function(){function p(m){this.config=m}return p.prototype.getDocumentLoc=function(m,v){return(0,c.success)((0,s.documentLoc)(m,v))},p.prototype.getSheetIndex=function(m,v){return(0,c.success)(v)},p.prototype.getSheetName=function(m,v){return(0,c.success)(v)},p.prototype.getNameLoc=function(m,v){return(0,c.success)(v.indexOf(".")>=0?void 0:(0,s.nameLoc)(m,v))},p.prototype.getUserDefinedFuncLoc=function(m,v){return(0,c.success)([(0,s.userDefinedFuncLoc)(m,v)])},p.prototype.getSheetRangeIndexes=function(m){if(m.index===void 0)return(0,c.failure)((0,l.notImplemented)(["simplePrintGlobals.getSheetRangeIndexes"]));var v=[m.index];return m.index2!==m.index&&v.push(m.index2),(0,c.success)((0,s.sheetRangeIndexes)(v,0))},p.prototype.getContainingTable=function(m){return c.successUndefined},p.prototype.getStructRefColumn=function(m,v){return c.successUndefined},p.prototype.getStructRefSpecialRef=function(m,v){return c.successUndefined},p.prototype.getNamedRanges=function(m){return(0,c.success)([])},p}();t.createSimplePrintGlobals=function(p){return new f(p)},t.printLocalsGrid=function(p,m,v){return{config:v??void 0,lexicalSource:p,originGridCell:(0,c.success)(m.range),originSheet:(0,c.success)(m.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}},t.printLocalsName=function(p,m,v){return{config:v??void 0,lexicalSource:p,originGridCell:(0,c.success)(m.range),originSheet:(0,c.success)(m.sheet),allowUnqualifiedCell:!1,wrapCellReferences:!0}}},6892:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.relabelFormula=void 0;var s=d(655),c=d(3546),l=d(9017);t.relabelFormula=function(f,p){var m;p===void 0&&(m=1,p=function(){return m++});var v=f.spans,h=f.annotations,S=f.depthUpperBound,y=[],C=[],E=[],I=[];function F(A){var T=p(),g=v[A];g!=null&&(y[T]=g);var O=h[A];return O!=null&&(C[T]=O),E[A]=T,I[T]=A,T}function w(A){return s.__assign(s.__assign({},A),{label:F(A.label)})}function B(A){if(A.kind===c.CellRefKind.Range){var T=A;return(0,c.cellRefRange)(B(T.ref1),B(T.ref2),F(A.label))}return s.__assign(s.__assign({},A),{label:F(A.label)})}function k(A){return A!=null?(0,c.documentQualifier)(A.document,A.path,A.isQuoted,F(A.label)):void 0}function x(A){return(0,c.fieldRef)((T=A.field).kind===c.NodeKind.Name?H(T.parts,T.qualifier,T.label):(0,c.badNode)(T.type,T.contents,F(T.label)),A.isBracketed,A.isClosed,F(A.label));var T}function G(A){switch(A==null?void 0:A.kind){case void 0:return;case c.StructRefKind.SpecialRef:return(0,c.specialRef)(A.id,A.isBracketed,A.isClosed,F(A.label));case c.StructRefKind.ColumnRef:return(0,c.columnRef)(A.name,A.isBracketed,A.isClosed,F(A.label));case c.StructRefKind.RangeOpRef:return(0,c.rangeOpRef)(G(A.lhs),G(A.rhs),F(A.label));case c.StructRefKind.CommaOpRef:return(0,c.commaOpRef)(A.refs.map(G),F(A.label));case c.StructRefKind.ThisRowOpRef:return(0,c.thisRowOpRef)(A.ref!==void 0?G(A.ref):void 0,F(A.label));case c.StructRefKind.MissingRef:return(0,c.missingRef)(F(A.label));case c.StructRefKind.BadRef:return(0,c.badRef)(A.contents,A.isBracketed,A.isClosed,F(A.label))}}function H(A,T,g){return(0,c.nameNode)(function(O){var M=(0,c.flattenNameParts)(O),K=function(Ne,Le){var Oe=Le.rhs,le=Le.canDenoteNamedObject,me=Le.label,Pe=Le.qualifiedLabel;return(0,c.fieldRefNamePart)(Ne,Oe===void 0?Oe:x(Oe),le,F(me),F(Pe))};if(M.kind===c.NamePartKind.IdentNamePart){var W=M.parts,z=W[0],ee=W.slice(1),ue=(0,c.identNamePart)(z.asWhole,z.canDenoteNamedObject,F(z.label),F(z.qualifiedLabel));return ee.reduce(K,ue)}var ce=M.parts,he=ce[0],de=ce[1],pe=ce.slice(2),_e=(0,c.cellRefNamePart)(B(he.ref),he.asWhole,F(he.label),F(he.qualifiedLabel));return pe.reduce(K,K(_e,de))}(A),function(O){if(O!=null)return O.kind===c.QualifierKind.Sheet||O.kind===c.QualifierKind.SheetRange?s.__assign(s.__assign({},O),{document:k(O.document),label:F(O.label)}):s.__assign(s.__assign({},O),{label:F(O.label)})}(T),F(g))}function L(A){return H(A.parts,A.qualifier,A.label)}for(var D={literalNode:function(T,g,O){return(0,c.literalNode)(T,g,F(O))},arrayNode:function(T,g,O){return(0,c.arrayNode)(T,g,F(O))},appNode:function(T,g,O,M){return(0,c.appNode)(T,g,O,F(M))},letNode:function(T,g,O,M,K,W){return(0,c.letNode)(T,g.map(function(z){var ee=z.name,ue=z.binder;return(0,c.letVar)((0,c.indexedArg)(L(ee.arg),ee.index),ue)}),O,M,K,F(W))},lambdaNode:function(T,g,O,M,K,W){return(0,c.lambdaNode)(T,g.map(function(z){var ee,ue,ce,he=z.name;return(0,c.lambdaParam)((0,c.indexedArg)((ee=he.arg,ue=(0,c.paramName)(function(de){switch(de.kind){case c.NodeKind.Name:return L(de);case c.NodeKind.Bad:return(0,c.badNode)(de.type,de.contents,F(de.label))}}(ee.name.name),ee.name.isBracketed,ee.name.isClosed,F(ee.name.label)),ce=ee.def===void 0?void 0:(0,c.paramDefault)(ee.def.rhs,F(ee.def.label)),(0,c.paramNode)(ue,ce,F(ee.label))),he.index))}),O,M,K,F(W))},parenNode:function(T,g,O){return(0,c.parenNode)(T,g,F(O))},nameNode:function(T,g,O){return H(T,g,O)},cellRefNode:function(T,g,O){return(0,c.cellRefNode)(B(T),function(M){if(M!=null)return M.kind===c.QualifierKind.Sheet||M.kind===c.QualifierKind.SheetRange?s.__assign(s.__assign({},M),{document:k(M.document),label:F(M.label)}):s.__assign(s.__assign({},M),{label:F(M.label)})}(g),F(O))},fieldRefNode:function(T,g,O,M){return(0,c.fieldRefNode)(T,x(g),O,F(M))},structRefNode:function(T,g,O){return(0,c.structRefNode)(T===void 0?void 0:L(T),(M=g,(0,c.structRef)(G(M.innerRef),M.isClosed,F(M.label))),F(O));var M},badSequenceNode:function(T,g,O){return(0,c.badNode)(T,g,F(O))},badStringNode:function(T,g,O){return(0,c.badNode)(T,g,F(O))},operatorNode:function(T,g){return(0,c.operatorNode)(T,F(g))},wsfNode:function(T,g,O){return(0,c.wsfNode)(T,g,F(O))}},U=(0,c.formula)((0,l.reduceBottomUp)(D,f),y,C,S),V=0,ne=Object.keys(C);V<ne.length;V++){var J=ne[V],$=Number(J),Z=C[$];switch(Z==null?void 0:Z.kind){case c.AnnotationKind.LocalNameUse:C[$]=(0,c.localNameUseAnnotation)(Z.name,Z.whole,E[Z.label]);break;case c.AnnotationKind.LocalNameDecl:C[$]=(0,c.localNameDeclAnnotation)(Z.name,Z.whole,Z.uses.map(function(A){var T=A.label;return{label:E[T]}}))}}for(var ie=0,X=Object.keys(y).map(Number);ie<X.length;ie++){var Q=X[ie],b=y[Q],R=b==null?void 0:b.preComments,P=b==null?void 0:b.postComments;(R||P)&&(y[Q]=s.__assign(s.__assign({},b),{preComments:R?R.map(w):void 0,postComments:P?P.map(w):void 0}))}return{formula:U,oldToNewLabel:E,newToOldLabel:I}}},7458:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createResolver=t.resolveGridRef=void 0;var s=d(655),c=d(8350),l=d(8350),f=d(9745),p=d(5499),m=d(3546),v=d(927),h=d(927),S=d(9937),y=d(9937),C=d(7815),E=d(2195);function I(k){return(0,C.isSuccess)(k)&&(0,l.isNone)(k.value)?C.successUndefined:k}function F(k){return!(0,C.isSuccess)(k)||k.value===void 0}function w(k,x,G){var H=(0,p.resolvePosition)(k.row,x.row,y.sheetRows,G),L=(0,p.resolvePosition)(k.col,x.col,y.sheetCols,G);return H!==void 0&&L!==void 0?(0,y.gridCell)(H,L):void 0}function B(k,x){if(x.kind===m.CellRefKind.Error)return C.successUndefined;var G=k.originGridCell;if(!(0,C.isSuccess)(G))return G;var H=G.value,L=k.wrapCellReferences;switch(x.kind){case m.CellRefKind.Single:return(0,C.success)(w(H,x,L));case m.CellRefKind.Range:var D=w(H,x.ref1,L),U=w(H,x.ref2,L);return D!==void 0&&U!==void 0?(0,C.success)((0,h.gridCellRange)(D,U)):C.successUndefined;case m.CellRefKind.Row:var V=(0,p.resolvePosition)(H.row,x.row1,y.sheetRows,L),ne=(0,p.resolvePosition)(H.row,x.row2,y.sheetRows,L);return V!==void 0&&ne!==void 0?(0,C.success)((0,h.gridCellRange)((0,y.gridCell)(V,0),(0,y.gridCell)(ne,y.sheetCols-1))):C.successUndefined;case m.CellRefKind.Col:var J=(0,p.resolvePosition)(H.col,x.col1,y.sheetCols,L),$=(0,p.resolvePosition)(H.col,x.col2,y.sheetCols,L);return J!==void 0&&$!==void 0?(0,C.success)((0,h.gridCellRange)((0,y.gridCell)(0,J),(0,y.gridCell)(y.sheetRows-1,$))):C.successUndefined;case m.CellRefKind.Bad:return(0,C.failure)((0,E.invalidCellRef)(E.InvalidCellRefReason.BadCellRef));default:return(0,f.assertNever)("calc.runtime.resolverService.resolveGridRef",x)}}t.resolveGridRef=B,t.createResolver=function(k){function x(Z,ie){if(ie===void 0){var X=Z.originSheet;return(0,C.isSuccess)(X)?[ie,(0,C.success)(X.value.document)]:[ie,X]}var Q=k.getDocumentLoc(ie.path,ie.document);if(!(0,C.isSuccess)(Q))return[ie,Q];if((0,l.isNone)(Q.value))return[ie,(0,C.failure)((0,E.invalidQualifier)(E.InvalidQualifierReason.UndefinedDocument))];var b=ie.path==null?void 0:Q.value.path,R=Q.value.name;return[(0,m.documentQualifier)(R,b,ie.isQuoted,ie.label),(0,C.success)(Q.value)]}function G(Z,ie){if(F(ie))return[Z,ie];var X=I(k.getSheetIndex(ie.value,Z));if(!(0,C.isSuccess)(X))return[Z,X];if((0,l.isNone)(X.value))return[Z,(0,C.failure)((0,E.invalidQualifier)(E.InvalidQualifierReason.UndefinedSheetName))];var Q=k.getSheetName(ie.value,X.value);return(0,C.isSuccess)(Q)?[Q.value,(0,C.success)((0,y.sheetIndex)(ie.value,X.value))]:[Z,Q]}function H(Z,ie){var X=x(Z,ie.document),Q=X[0],b=X[1],R=G(ie.sheet,b),P=R[0],A=R[1];return[(0,m.sheetQualifier)(P,Q,ie.isQuoted,ie.label),A]}function L(Z,ie){var X,Q,b,R,P=ie.qualifier,A=ie.ref,T=B(Z,A);if(P===void 0||P.kind===m.QualifierKind.Relative){Q=P;var g=Z.originSheet;if((0,C.isSuccess)(g)){var O=g.value;b=O.index===void 0?(0,C.failure)((0,E.noOriginSheet)(O)):(0,C.success)(O)}else b=g}else Q=(X=function(M,K){switch(K.kind){case m.QualifierKind.Error:return[K,C.successUndefined];case m.QualifierKind.Sheet:return H(M,K);case m.QualifierKind.SheetRange:return function(W,z){var ee,ue=x(W,z.document),ce=ue[0],he=ue[1],de=G(z.sheet1,he),pe=de[0],_e=de[1],Ce=G(z.sheet2,he),Ne=Ce[0],Le=Ce[1],Oe=pe,le=Ne;if(F(he))ee=he;else if(F(_e))ee=_e;else if(F(Le))ee=Le;else{if((0,h.isSheetIndexEqual)(_e.value,Le.value))return[(0,m.sheetQualifier)(Oe,ce,z.isQuoted,z.label),(0,C.success)((0,y.sheetIndex)(he.value,_e.value.index))];var me=k.getSheetRangeIndexes(_e.value),Pe=k.getSheetRangeIndexes(Le.value);(0,C.isSuccess)(me)?(0,C.isSuccess)(Pe)?Pe.value.position<me.value.position&&(Oe=Ne,le=pe):ee=Pe:ee=me,ee=(0,C.success)((0,y.sheetRange)(he.value,_e.value.index,Le.value.index))}return[(0,m.sheetRangeQualifier)(Oe,le,ce,z.isQuoted,z.label),ee]}(M,K);case m.QualifierKind.Document:return[K,(0,C.failure)((0,E.invalidQualifier)(E.InvalidQualifierReason.SheetRangeName))];case m.QualifierKind.Bad:return[K,(0,C.failure)((0,E.invalidQualifier)(E.InvalidQualifierReason.BadQualifier))];default:return(0,f.assertNever)("calc.runtime.resolverService.resolveCellRefQualifier",K)}}(Z,P))[0],b=X[1];return R=F(T)?T:F(b)?b:(0,C.success)((0,y.sheetGridCube)(b.value,T.value)),(0,E.resolvedCellRef)((0,m.cellRefNode)(A,Q,ie.label),R)}function D(Z,ie,X){var Q,b,R,P=ie.qualifier,A=ie.parts,T=[];if(P===void 0||P.kind===m.QualifierKind.Relative){var g=Z.originSheet;if(!(0,C.isSuccess)(g))return(0,E.resolvedName)(ie,g,T);var O=g.value;if(X!==y.NameSource.StructRef){if(O.index===void 0)return(0,E.resolvedName)(ie,(0,C.failure)((0,E.noOriginSheet)(O)),T);T.push((0,S.nameLoc)(O,A.asWhole));var M=I(k.getNameLoc(O,A.asWhole,X));if(!(0,C.isSuccess)(M))return(0,E.resolvedName)(ie,M,T);if(M.value)return(0,E.resolvedName)((0,m.nameNode)((0,m.identNamePart)(M.value.name,A.canDenoteNamedObject,A.label,A.qualifiedLabel),P,ie.label),M,T)}b=P,R=(0,C.success)((0,y.documentScope)(O.document))}else Q=function(z,ee){switch(ee.kind){case m.QualifierKind.Document:var ue=x(z,ee);return[_e=ue[0],F(Ce=ue[1])?Ce:(0,C.success)((0,y.documentScope)(Ce.value))];case m.QualifierKind.Sheet:return H(z,ee);case m.QualifierKind.SheetRange:return[ee,(0,C.failure)((0,E.invalidQualifier)(E.InvalidQualifierReason.SheetRangeName))];case m.QualifierKind.Ident:var ce=H(z,(0,m.sheetQualifier)(ee.name,void 0)),he=ce[0],de=ce[1];if(!(0,C.isSuccess)(de)&&de.reason.kind!==E.ResolveReasonKind.InvalidQualifier)return[ee,de];if((0,C.isSuccess)(de)&&de.value!==void 0)return[(0,m.identQualifier)(he.sheet,ee.isQuoted,ee.label),de];var pe=x(z,(0,m.documentQualifier)(ee.name)),_e=pe[0],Ce=pe[1];return[(0,m.identQualifier)(_e.document,ee.isQuoted,ee.label),F(Ce)?Ce:(0,C.success)((0,y.documentScope)(Ce.value))];case m.QualifierKind.Bad:return[ee,(0,C.failure)((0,E.invalidQualifier)(E.InvalidQualifierReason.BadQualifier))];default:return(0,f.assertNever)("calc.runtime.resolverService.resolveNameQualifier",ee)}}(Z,P),b=Q[0],R=Q[1];var K,W=A;return F(R)?K=R:(T.push((0,S.nameLoc)(R.value,A.asWhole)),F(K=I(k.getNameLoc(R.value,A.asWhole,X)))||(W=(0,m.identNamePart)(K.value.name,A.canDenoteNamedObject,A.label,A.qualifiedLabel))),(0,E.resolvedName)((0,m.nameNode)(W,b,ie.label),K,T)}function U(Z,ie,X){X===void 0&&(X=!1);var Q=k.getStructRefColumn(Z,ie.name);if(!(0,C.isSuccess)(Q))return{kind:m.StructRefKind.ColumnRef,innerRef:ie,resolution:Q};var b=Q.value;if((0,l.isNone)(b))return{kind:m.StructRefKind.ColumnRef,innerRef:ie,resolution:(0,C.failure)((0,E.invalidStructRef)(E.InvalidStructRefReason.UndefinedColumnName))};var R=b.range.range;return X&&(R=(0,y.gridRange)(R.row-(b.hasHeadersRow?1:0),R.col,R.rows+(b.hasHeadersRow?1:0)+(b.hasTotalsRow?1:0),R.cols)),{kind:m.StructRefKind.ColumnRef,innerRef:(0,m.columnRef)(b.name,ie.isBracketed,ie.isClosed,ie.label),resolution:(0,C.success)((0,y.sheetGridRange)(b.range.sheet,R))}}function V(Z,ie,X){if(X===m.SpecialRefId.ThisRow){if(!(0,C.isSuccess)(Z.originGridCell))return Z.originGridCell;var Q=V(Z,ie,m.SpecialRefId.Data);if(F(Q))return Q;var b=Q.value.range,R=Z.originGridCell.value.row;return R<b.row||R>=b.row+b.rows?(0,C.failure)(E.emptyIntersection):(0,C.success)((0,y.sheetGridRange)(Q.value.sheet,(0,y.gridRange)(R,b.col,1,b.cols)))}return I(k.getStructRefSpecialRef(ie,X))}function ne(Z,ie,X){switch(ie.kind){case m.StructRefKind.ColumnRef:return U(Z,ie,X);case m.StructRefKind.MissingRef:return{kind:m.StructRefKind.MissingRef,innerRef:ie,resolution:C.successUndefined}}}function J(Z,ie,X){var Q;X===void 0&&(X=!1);var b,R,P=ne(Z,ie.lhs,X),A=P.innerRef,T=P.resolution,g=ne(Z,ie.rhs,X),O=g.innerRef,M=g.resolution,K=(0,m.rangeOpRef)(A,O,ie.label);if(!(0,C.isSuccess)(T)&&T.reason.kind!==E.ResolveReasonKind.InvalidStructRef)return{kind:m.StructRefKind.RangeOpRef,innerRef:K,resolution:T};if(!(0,C.isSuccess)(M)&&M.reason.kind!==E.ResolveReasonKind.InvalidStructRef)return{kind:m.StructRefKind.RangeOpRef,innerRef:K,resolution:M};if(!(0,C.isSuccess)(T))return{kind:m.StructRefKind.RangeOpRef,innerRef:K,resolution:T};if(!(0,C.isSuccess)(M))return{kind:m.StructRefKind.RangeOpRef,innerRef:K,resolution:M};if(T.value!==void 0)b=T.value.sheet,R=(0,h.gridRangeJoinOpt)(T.value.range,(Q=M.value)===null||Q===void 0?void 0:Q.range);else{if(M.value===void 0)return{kind:m.StructRefKind.RangeOpRef,innerRef:K,resolution:(0,C.failure)((0,E.invalidStructRef)(E.InvalidStructRefReason.InvalidOp))};b=M.value.sheet,R=M.value.range}return{kind:m.StructRefKind.RangeOpRef,innerRef:K,resolution:(0,C.success)((0,y.sheetGridRange)(b,R))}}function $(Z,ie){var X,Q,b,R,P,A,T,g=ie.qualifier,O=ie.parts,M=(b=(Q=Z.config)===null||Q===void 0?void 0:Q.localeInfo)!==null&&b!==void 0?b:k.config.localeInfo;if(g===void 0){var K=Z.originSheet;if(!(0,C.isSuccess)(K))return(0,E.resolvedUserDefinedFunc)(ie,K,[],O.asWhole);R=g,P=(0,C.success)(K.value.document)}else X=function(ee,ue){switch(ue.kind){case m.QualifierKind.Document:return x(ee,ue);case m.QualifierKind.Ident:var ce=x(ee,(0,m.documentQualifier)(ue.name)),he=ce[0],de=ce[1];return[(0,m.identQualifier)(he.document,ue.isQuoted,ue.label),de];default:return(0,f.assertNever)("calc.runtime.resolverService.resolveUserDefinedFuncQualifier",ue)}}(Z,g),R=X[0],P=X[1];var W=O.asWhole;if(F(P))T=P,A=[];else{W=(0,v.getUserDefinedFuncName)(M,O.asWhole);var z=k.getUserDefinedFuncLoc(P.value,W);A=[(0,S.userDefinedFuncLoc)(P.value,W)],T=(0,C.isSuccess)(z)?z.value.length!==0?z:C.successUndefined:z}return(0,E.resolvedUserDefinedFunc)((0,m.nameNode)((0,m.identNamePart)(O.asWhole,O.canDenoteNamedObject,O.label,O.qualifiedLabel),R,ie.label),T,A,W)}return{resolveGridRef:B,resolveCellRef:L,resolveName:D,resolveStructRef:function(ie,X){var Q,b,R=X.lhs,P=X.rhs,A=R;if(R!==void 0){var T=D(ie,R,y.NameSource.StructRef),g=T.node,O=T.resolution,M=T.precedents,K=O;if(!(0,C.isSuccess)(K))return(0,E.resolvedStructRef)(X,void 0,K,M);if((0,l.isNone)(K.value))return(0,E.resolvedStructRef)(X,void 0,(0,C.failure)((0,E.invalidStructRef)(E.InvalidStructRefReason.UndefinedTableName)),M);A=g,Q=K.value,b=M}else{var W=ie.originGridCell,z=ie.originSheet;if(!(0,C.isSuccess)(W))return(0,E.resolvedStructRef)(X,void 0,W,[]);if(!(0,C.isSuccess)(z))return(0,E.resolvedStructRef)(X,void 0,z,[]);if(z.value.index===void 0)return(0,E.resolvedStructRef)(X,void 0,(0,C.failure)((0,E.invalidStructRef)(E.InvalidStructRefReason.InvalidOriginSheet)),[]);if(K=k.getContainingTable((0,y.sheetGridCell)(z.value,W.value)),!(0,C.isSuccess)(K))return(0,E.resolvedStructRef)(X,void 0,K,[]);if((0,l.isNone)(K.value))return(0,E.resolvedStructRef)(X,void 0,(0,C.failure)((0,E.invalidStructRef)(E.InvalidStructRefReason.MissingTableName)),[]);b=[Q=K.value]}var ee=function(he,de,pe){var _e;switch((_e=pe.innerRef)===null||_e===void 0?void 0:_e.kind){case m.StructRefKind.ColumnRef:var Ce=U(de,pe.innerRef),Ne=Ce.innerRef,Le=Ce.resolution;return{structRef:(0,m.structRef)(Ne,pe.isClosed,pe.label),resolution:Le};case m.StructRefKind.RangeOpRef:var Oe=J(de,pe.innerRef);return Ne=Oe.innerRef,Le=Oe.resolution,{structRef:(0,m.structRef)(Ne,pe.isClosed,pe.label),resolution:Le};case void 0:return{structRef:pe,resolution:Le=V(he,de,m.SpecialRefId.Data)};case m.StructRefKind.SpecialRef:return{structRef:pe,resolution:Le=V(he,de,pe.innerRef.id)};case m.StructRefKind.CommaOpRef:var le=function(be,xe,Ie){for(var Ve,Ze,gr=Ie.refs.map(function(bt){return function(Kr,Pt,Mi){switch(Mi.kind){case m.StructRefKind.ColumnRef:return U(Pt,Mi,!0);case m.StructRefKind.SpecialRef:return{kind:m.StructRefKind.SpecialRef,innerRef:Mi,resolution:V(Kr,Pt,Mi.id)};case m.StructRefKind.RangeOpRef:return J(Pt,Mi,!0);case m.StructRefKind.MissingRef:return{kind:m.StructRefKind.MissingRef,innerRef:Mi,resolution:C.successUndefined};case m.StructRefKind.BadRef:return{kind:m.StructRefKind.BadRef,innerRef:Mi,resolution:(0,C.failure)((0,E.invalidStructRef)(E.InvalidStructRefReason.InvalidOp))}}}(be,xe,bt)}),cr=(0,m.commaOpRef)(gr.map(function(bt){return bt.innerRef}),Ie.label),_r=0,xr=gr;_r<xr.length;_r++){var Or=xr[_r].resolution;if(!(0,C.isSuccess)(Or)&&Or.reason.kind!==E.ResolveReasonKind.InvalidStructRef)return{commaOpRef:cr,resolution:Or}}for(var Rr,ir,$e=[],qe=0,fr=gr;qe<fr.length;qe++){var lr=fr[qe];if(!(0,C.isSuccess)(lr.resolution)||lr.kind===m.StructRefKind.BadRef)return{commaOpRef:cr,resolution:lr.resolution};$e.push((lr.kind===m.StructRefKind.SpecialRef||(lr.kind,m.StructRefKind.MissingRef),{kind:lr.kind,resolution:lr.resolution}))}if(!(0,h.isCommaOpRefWellFormed)(Ie))return{commaOpRef:cr,resolution:(0,C.failure)((0,E.invalidStructRef)(E.InvalidStructRefReason.InvalidOp))};for(var dn=0,Un=$e;dn<Un.length;dn++)(lr=Un[dn]).kind===m.StructRefKind.SpecialRef&&(Rr=(0,h.gridRangeJoinOpt)(Rr,(Ve=lr.resolution.value)===null||Ve===void 0?void 0:Ve.range),ir===void 0&&(ir=(Ze=lr.resolution.value)===null||Ze===void 0?void 0:Ze.sheet));if(Rr===void 0||ir===void 0)return{commaOpRef:cr,resolution:C.successUndefined};for(var Gr=0,Br=$e;Gr<Br.length;Gr++)if((lr=Br[Gr]).kind!==m.StructRefKind.SpecialRef&&lr.kind!==m.StructRefKind.MissingRef&&(Rr=(0,h.gridRangeIsect)(Rr,lr.resolution.value.range))===void 0)return{commaOpRef:cr,resolution:(0,C.failure)((0,E.invalidStructRef)(E.InvalidStructRefReason.InvalidOp))};return{commaOpRef:cr,resolution:(0,C.success)((0,y.sheetGridRange)(ir,Rr))}}(he,de,pe.innerRef);return Ne=le.commaOpRef,Le=le.resolution,{structRef:(0,m.structRef)(Ne,pe.isClosed,pe.label),resolution:Le};case m.StructRefKind.ThisRowOpRef:var me=V(he,de,m.SpecialRefId.ThisRow);if(F(me)||pe.innerRef.ref===void 0)return{structRef:pe,resolution:me};var Pe=pe.innerRef.ref.kind===m.StructRefKind.ColumnRef?U(de,pe.innerRef.ref):J(de,pe.innerRef.ref),Re=(Ne=Pe.innerRef,Pe.resolution),fe=(0,m.thisRowOpRef)(Ne,Ne.label);if(F(Re))return{structRef:(0,m.structRef)(fe,pe.isClosed,pe.label),resolution:Re};var Se=(0,h.gridRangeIsect)(me.value.range,Re.value.range);return Se?{structRef:(0,m.structRef)(fe,pe.isClosed,pe.label),resolution:(0,C.success)((0,y.sheetGridRange)(me.value.sheet,Se))}:{structRef:pe,resolution:(0,C.failure)((0,E.invalidStructRef)(E.InvalidStructRefReason.InvalidOp))};case m.StructRefKind.BadRef:return{structRef:pe,resolution:(0,C.failure)((0,E.invalidStructRef)(E.InvalidStructRefReason.InvalidOp))}}}(ie,Q,P),ue=ee.structRef,ce=ee.resolution;return(0,E.resolvedStructRef)(ce.kind===C.ResultKind.Failure&&ce.reason.kind!==E.ResolveReasonKind.EmptyIntersection?X:(0,m.structRefNode)(A,ue,X.label),Q,ce,b)},resolveUserDefinedFunc:$,resolveDottedName:function(ie,X,Q){var b,R,P=X.qualifier,A=X.parts,T=[],g={names:new Array,udfs:new Array},O=Q[X.label],M=(O==null?void 0:O.kind)===m.AnnotationKind.AppHeadName;if(!P){var K=(0,m.headNamePart)(A);if(K.kind===m.NamePartKind.IdentNamePart){var W=function(pe,_e){var Ce=_e[pe.label];return(Ce==null?void 0:Ce.kind)===m.AnnotationKind.LocalNameUse?(0,E.resolvedLocalName)((0,m.nameNode)((0,m.identNamePart)(Ce.whole,pe.canDenoteNamedObject,pe.label,pe.qualifiedLabel),void 0,pe.qualifiedLabel),(0,C.success)(Ce)):(0,E.resolvedLocalName)((0,m.nameNode)((0,m.identNamePart)(pe.asWhole,pe.canDenoteNamedObject,pe.label,pe.qualifiedLabel),void 0,pe.qualifiedLabel),C.successUndefined)}(K,Q);if(W.resolution.value!==void 0){var z=(0,m.flattenNameParts)(A).parts.slice(1),ee=z.map(function(pe){var _e=pe.rhs;return(_e==null?void 0:_e.field.kind)===m.NodeKind.Name?_e.field.whole:void 0}).filter(function(pe){return pe!==void 0});if(ee.length===z.length)return(0,E.resolvedDottedName)(W,ee,g)}}}for(;;){if(A.canDenoteNamedObject){var ue=(0,m.nameNode)((0,m.identNamePart)(A.asWhole,A.canDenoteNamedObject,A.label,A.qualifiedLabel),P,A.qualifiedLabel),ce=D(ie,ue,M?y.NameSource.AppHead:y.NameSource.Plain);if(R=(0,E.resolvedDottedName)(ce,s.__spreadArray([],T,!0).reverse(),g),(0,c.safePush)(g.names,ce.precedents),!(0,C.isSuccess)(ce.resolution)&&ce.resolution.reason.kind!==E.ResolveReasonKind.InvalidQualifier||(0,C.isSuccess)(ce.resolution)&&ce.resolution.value!==void 0)return R;if(M&&(P===void 0||P.kind===m.QualifierKind.Document||P.kind===m.QualifierKind.Ident)){var he=$(ie,ue);if(R=(0,E.resolvedDottedName)(he,s.__spreadArray([],T,!0).reverse(),g),(0,c.safePush)(g.udfs,he.precedents),!(0,C.isSuccess)(he.resolution)&&he.resolution.reason.kind!==E.ResolveReasonKind.InvalidQualifier||(0,C.isSuccess)(he.resolution)&&he.resolution.value!==void 0)return R}}if(A.kind===m.NamePartKind.CellRefNamePart&&(P==null&&ie.allowUnqualifiedCell||P!=null&&P.kind!==m.QualifierKind.Document)){var de=L(ie,(0,m.cellRefNode)(A.ref,P!=null&&P.kind===m.QualifierKind.Ident?(0,m.sheetQualifier)(P.name):P,A.qualifiedLabel));return(0,E.resolvedDottedName)(de,s.__spreadArray([],T,!0).reverse(),g)}if(A.kind!==m.NamePartKind.FieldRefNamePart||((b=A.rhs)===null||b===void 0?void 0:b.field.kind)!==m.NodeKind.Name)return R!==void 0?R:(0,E.resolvedDottedName)((0,E.resolvedNever)((0,m.nameNode)((0,m.identNamePart)(A.asWhole,A.canDenoteNamedObject,A.label,A.qualifiedLabel),P,A.qualifiedLabel)),s.__spreadArray([],T,!0).reverse(),g);T.push(A.rhs.field.whole),A=A.lhs,M=!1}}}}},2195:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolvedDottedName=t.resolvedNever=t.resolvedStructRef=t.resolvedLocalName=t.resolvedUserDefinedFunc=t.resolvedCellRef=t.resolvedName=t.ResolvedKind=t.emptyIntersection=t.invalidStructRef=t.InvalidStructRefReason=t.invalidCellRef=t.InvalidCellRefReason=t.invalidQualifier=t.InvalidQualifierReason=t.noOriginSheet=t.ResolveReasonKind=t.resolveLocalsGrid=void 0;var s,c,l,f,p=d(7815),m=d(8350);t.resolveLocalsGrid=function(v){return{originGridCell:(0,p.success)(v.range),originSheet:(0,p.success)(v.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}},function(v){v.NoOriginSheet="NoOriginSheet",v.InvalidQualifier="InvalidQualifier",v.InvalidCellRef="InvalidCellRef",v.InvalidStructRef="InvalidStructRef",v.EmptyIntersection="EmptyIntersection"}(s=t.ResolveReasonKind||(t.ResolveReasonKind={})),t.noOriginSheet=function(v){return{kind:s.NoOriginSheet,origin:v}},(f=t.InvalidQualifierReason||(t.InvalidQualifierReason={})).UndefinedDocument="UndefinedDocument",f.UndefinedSheetName="UndefinedSheetName",f.SheetRangeName="SheetRangeName",f.DocumentCellRef="DocumentCellRef",f.BadQualifier="BadQualifier",t.invalidQualifier=function(v){return{kind:s.InvalidQualifier,reason:v}},(t.InvalidCellRefReason||(t.InvalidCellRefReason={})).BadCellRef="BadCellRef",t.invalidCellRef=function(v){return{kind:s.InvalidCellRef,reason:v}},(l=t.InvalidStructRefReason||(t.InvalidStructRefReason={})).UndefinedColumnName="UndefinedColumnName",l.UndefinedTableName="UndefinedTableName",l.InvalidOriginSheet="InvalidOriginSheet",l.InvalidOp="InvalidOp",l.MissingTableName="MissingTableName",l.NamedObjectNotTable="NamedObjectNotTable",t.invalidStructRef=function(v){return{kind:s.InvalidStructRef,reason:v}},t.emptyIntersection={kind:s.EmptyIntersection},function(v){v.ResolvedName="ResolvedName",v.ResolvedCellRef="ResolvedCellRef",v.ResolvedUserDefinedFunc="ResolvedUserDefinedFunc",v.ResolvedLocalName="ResolvedLocalName",v.ResolvedStructRef="ResolvedStructRef",v.ResolvedNever="ResolvedNever",v.ResolvedDottedName="ResolvedDottedName"}(c=t.ResolvedKind||(t.ResolvedKind={})),t.resolvedName=(0,m.typedInstanceCreator)()(function(v,h,S){return{kind:c.ResolvedName,node:v,resolution:h,precedents:S}}),t.resolvedCellRef=(0,m.typedInstanceCreator)()(function(v,h){return{kind:c.ResolvedCellRef,node:v,resolution:h}}),t.resolvedUserDefinedFunc=(0,m.typedInstanceCreator)()(function(v,h,S,y){return{kind:c.ResolvedUserDefinedFunc,node:v,resolution:h,precedents:S,name:y}}),t.resolvedLocalName=(0,m.typedInstanceCreator)()(function(v,h){return{kind:c.ResolvedLocalName,node:v,resolution:h}}),t.resolvedStructRef=(0,m.typedInstanceCreator)()(function(v,h,S,y){return{kind:c.ResolvedStructRef,node:v,table:h,resolution:S,precedents:y}}),t.resolvedNever=(0,m.typedInstanceCreator)()(function(v){return{kind:c.ResolvedNever,node:v,resolution:p.successUndefined}}),t.resolvedDottedName=(0,m.typedInstanceCreator)()(function(v,h,S){return{kind:c.ResolvedDottedName,resolved:v,fields:h,precedents:S}})},5947:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWorksheetFuncEnglishName=t.getWorksheetFuncType=t.getOperatorType=t.operatorStrings=t.OperatorId=t.higherOrderFunctionType=t.unknownFunctionType=t.WorksheetFuncId=void 0;var s=d(3424),c=d(3494);Object.defineProperty(t,"WorksheetFuncId",{enumerable:!0,get:function(){return c.WorksheetFuncId}});var l,f=d(4611);t.unknownFunctionType=(0,s.functionType)(0,254,[],[s.SignatureType.All],[],s.SignatureType.All,s.SpecialPrecs.All,s.FunctionFlags.None),t.higherOrderFunctionType=function(){var k=s.OperKind.Number|s.OperKind.String|s.OperKind.Boolean|s.OperKind.Rich|s.OperKind.Error|s.OperKind.Blank|((0,f.isFeatureEnabled)(f.FeatureName.CalcLambdaCellValues)?0:s.OperKind.Range)|((0,f.isFeatureEnabled)(f.FeatureName.CalcLambdaArrayLifting)?0:s.OperKind.Array),x=s.OperKind.Number|s.OperKind.String|s.OperKind.Boolean|s.OperKind.Rich|s.OperKind.Error|s.OperKind.Blank|s.OperKind.Missing|s.OperKind.Array|s.OperKind.Range;return(0,s.functionType)(1,255,[k],[x],[],s.SignatureType.All,s.SpecialPrecs.None,s.FunctionFlags.Allow3dRef)},function(k){k[k.Add=1]="Add",k[k.Sub=2]="Sub",k[k.Mul=3]="Mul",k[k.Div=4]="Div",k[k.Pow=5]="Pow",k[k.Percent=6]="Percent",k[k.Neg=7]="Neg",k[k.Pos=8]="Pos",k[k.Concat=9]="Concat",k[k.Eq=10]="Eq",k[k.Ne=11]="Ne",k[k.Lt=12]="Lt",k[k.Le=13]="Le",k[k.Gt=14]="Gt",k[k.Ge=15]="Ge",k[k.Range=16]="Range",k[k.Isect=17]="Isect",k[k.Union=18]="Union",k[k.And=19]="And",k[k.Or=20]="Or",k[k.Xor=21]="Xor",k[k.Min=22]="Min",k[k.Max=23]="Max",k[k.At=24]="At",k[k.Pound=25]="Pound"}(l=t.OperatorId||(t.OperatorId={})),t.operatorStrings=[void 0,"+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":",void 0,void 0,"&&","||","^^",void 0,void 0,"@","#"];var p=s.OperKind.Number|s.OperKind.String|s.OperKind.Boolean|s.OperKind.Blank,m=s.OperKind.Number|s.OperKind.String|s.OperKind.Boolean|s.OperKind.Blank,v=(0,s.functionType)(2,2,[s.OperKind.Number,s.OperKind.Number],[],[],s.OperKind.Number,s.SpecialPrecs.None,s.FunctionFlags.None),h=(0,s.functionType)(1,1,[s.OperKind.Number],[],[],s.OperKind.Number,s.SpecialPrecs.None,s.FunctionFlags.None),S=(0,s.functionType)(1,1,[p],[],[],p,s.SpecialPrecs.None,s.FunctionFlags.None),y=(0,s.functionType)(2,2,[s.OperKind.String,s.OperKind.String],[],[],s.OperKind.String,s.SpecialPrecs.None,s.FunctionFlags.None),C=(0,s.functionType)(2,2,[m,m],[],[],s.OperKind.Boolean,s.SpecialPrecs.None,s.FunctionFlags.None),E=(0,s.functionType)(2,2,[s.OperKind.Range,s.OperKind.Range],[],[],s.OperKind.Range,s.SpecialPrecs.AllCells,s.FunctionFlags.None),I=(0,s.functionType)(2,2,[s.OperKind.Range,s.OperKind.Range],[],[],s.OperKind.Range,s.SpecialPrecs.None,s.FunctionFlags.None),F=(0,s.functionType)(2,2,[s.OperKind.Boolean,s.OperKind.Boolean],[],[],s.OperKind.Boolean,s.SpecialPrecs.None,s.FunctionFlags.None),w=[];function B(k,x){var G=c.worksheetFuncTypes[k];G!=null&&(G.staticPrecs=x)}w[l.Add]=v,w[l.Sub]=v,w[l.Mul]=v,w[l.Div]=v,w[l.Pow]=v,w[l.Percent]=h,w[l.Neg]=h,w[l.At]=c.worksheetFuncTypes[c.WorksheetFuncId.SINGLE],w[l.Pound]=c.worksheetFuncTypes[c.WorksheetFuncId.ANCHORARRAY],w[l.Pos]=S,w[l.Concat]=y,w[l.Eq]=C,w[l.Ne]=C,w[l.Lt]=C,w[l.Le]=C,w[l.Gt]=C,w[l.Ge]=C,w[l.Range]=E,w[l.Isect]=I,w[l.Union]=I,w[l.And]=F,w[l.Or]=F,w[l.Xor]=F,w[l.Min]=v,w[l.Max]=v,t.getOperatorType=function(k){var x=w[k];return x??t.unknownFunctionType},t.getWorksheetFuncType=function(k){var x=c.worksheetFuncTypes[k];return x??t.unknownFunctionType},t.getWorksheetFuncEnglishName=function(k){return c.worksheetFuncEnglishNames[k]},B(c.WorksheetFuncId.ROW,s.SpecialPrecs.OwnRow),B(c.WorksheetFuncId.COLUMN,s.SpecialPrecs.OwnCol),B(c.WorksheetFuncId.SHEET,s.SpecialPrecs.OwnDocSheets),B(c.WorksheetFuncId.SHEETS,s.SpecialPrecs.OwnDocSheets),B(c.WorksheetFuncId.OFFSET,s.SpecialPrecs.AllCells),B(c.WorksheetFuncId.INDIRECT,s.SpecialPrecs.AllCells),B(c.WorksheetFuncId.SUMIF,s.SpecialPrecs.AllCells),B(c.WorksheetFuncId.AVERAGEIF,s.SpecialPrecs.AllCells),B(c.WorksheetFuncId.LOOKUP,s.SpecialPrecs.AllCells),B(c.WorksheetFuncId.ADDRESS,s.SpecialPrecs.RefStyle),B(c.WorksheetFuncId.FORMULATEXT,s.SpecialPrecs.RefStyle),B(c.WorksheetFuncId.NOW,s.SpecialPrecs.Time),B(c.WorksheetFuncId.TODAY,s.SpecialPrecs.Time),B(c.WorksheetFuncId.RAND,s.SpecialPrecs.Calc),B(c.WorksheetFuncId.RANDBETWEEN,s.SpecialPrecs.Calc),B(c.WorksheetFuncId.RANDARRAY,s.SpecialPrecs.Calc),B(c.WorksheetFuncId.SUBTOTAL,s.SpecialPrecs.CellProps),B(c.WorksheetFuncId.CELL,s.SpecialPrecs.CellProps|s.SpecialPrecs.AllCells),B(c.WorksheetFuncId.INFO,s.SpecialPrecs.None)},6791:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VerticalAlignment=t.HorizontalAlignment=t.BorderLineType=t.PatternType=t.FillKind=t.FontVerticalAlignment=t.FontUnderline=void 0;var s,c,l,f,p,m,v,h=d(8350);(v=t.FontUnderline||(t.FontUnderline={})).None="None",v.Single="Single",v.Double="Double",v.SingleAccounting="SingleAccounting",v.DoubleAccounting="DoubleAccounting",(0,h.staticAssertSame)(),(m=t.FontVerticalAlignment||(t.FontVerticalAlignment={})).None="None",m.Subscript="Subscript",m.Superscript="Superscript",(0,h.staticAssertSame)(),(p=t.FillKind||(t.FillKind={})).Pattern="Pattern",p.Gradient="Gradient",(f=t.PatternType||(t.PatternType={})).None="None",f.Solid="Solid",f.MediumGray="MediumGray",f.DarkGray="DarkGray",f.LightGray="LightGray",f.DarkHorizontal="DarkHorizontal",f.DarkVertical="DarkVertical",f.DarkDown="DarkDown",f.DarkUp="DarkUp",f.DarkGrid="DarkGrid",f.DarkTrellis="DarkTrellis",f.LightHorizontal="LightHorizontal",f.LightVertical="LightVertical",f.LightDown="LightDown",f.LightUp="LightUp",f.LightGrid="LightGrid",f.LightTrellis="LightTrellis",f.Gray125="Gray125",f.Gray0625="Gray0625",(l=t.BorderLineType||(t.BorderLineType={})).None="None",l.Thin="Thin",l.Medium="Medium",l.Dashed="Dashed",l.Dotted="Dotted",l.Thick="Thick",l.Double="Double",l.Hair="Hair",l.MediumDashed="MediumDashed",l.DashDot="DashDot",l.MediumDashDot="MediumDashDot",l.DashDotDot="DashDotDot",l.MediumDashDotDot="MediumDashDotDot",l.SlantDashDot="SlantDashDot",(0,h.staticAssertSame)(),(c=t.HorizontalAlignment||(t.HorizontalAlignment={})).Automatic="Automatic",c.Left="Left",c.Center="Center",c.Right="Right",c.Fill="Fill",c.Justify="Justify",c.CenterAcrossSelection="CenterAcrossSelection",c.Distributed="Distributed",c.JustifyDistributed="JustifyDistributed",(0,h.staticAssertSame)(),(s=t.VerticalAlignment||(t.VerticalAlignment={})).Top="Top",s.Center="Center",s.Bottom="Bottom",s.Justify="Justify",s.Distributed="Distributed",(0,h.staticAssertSame)()},6524:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.poundNode=t.atNode=t.maxNode=t.minNode=t.xorNode=t.orNode=t.andNode=t.unionNode=t.isectNode=t.rangeNode=t.geNode=t.gtNode=t.leNode=t.ltNode=t.neNode=t.eqNode=t.concatNode=t.posNode=t.negNode=t.percentNode=t.powNode=t.divNode=t.mulNode=t.subNode=t.addNode=t.badBracketNode=t.badQualNode=t.badCellRefNode=t.badMissingNode=t.badParamNameNode=t.badFieldNameNode=t.badErrorLiteralNode=t.badStringLiteralNode=t.badNumberLiteralNode=t.badUnexpNode=t.badFieldRefNode=t.badStructRefNode=t.badSeqNode=t.absPos=t.relPos=t.expectTrue=t.isNameLocEqual=t.createSingleRange=t.sheet1=t.sheet1Name=t.document1=void 0;var s=d(9937),c=d(927),l=d(3546),f=d(5947);function p(h,S){return S===void 0&&(S=0),(0,l.badNode)(l.BadType.Sequence,h,S)}function m(h,S){return S===void 0&&(S=0),(0,l.badNode)(l.BadType.Unexpected,h,S)}function v(h){return function(S){return S===void 0&&(S=0),(0,l.operatorNode)(h,S)}}t.document1=(0,s.documentLoc)(void 0,"Book1"),t.sheet1Name="Sheet1",t.sheet1=(0,s.sheetIndex)(t.document1,0),t.createSingleRange=function(h,S){var y=(0,s.gridCell)(h,S);return(0,s.sheetGridCell)(t.sheet1,y)},t.isNameLocEqual=function(h,S,y){return(0,c.isNameScopeEqual)(S.scope,y.scope)&&h.stringCompareCI(S.name,y.name)===0},t.expectTrue=function(h){expect(h).toBeTruthy()},t.relPos=function(h){return(0,l.pos)(l.PosKind.Rel,h)},t.absPos=function(h){return(0,l.pos)(l.PosKind.Abs,h)},t.badSeqNode=p,t.badStructRefNode=function(h,S){return S===void 0&&(S=0),(0,l.badNode)(l.BadType.StructRef,h,S)},t.badFieldRefNode=function(h,S){return S===void 0&&(S=0),(0,l.badNode)(l.BadType.FieldRef,h,S)},t.badUnexpNode=m,t.badNumberLiteralNode=function(h,S){return S===void 0&&(S=0),(0,l.badNode)(l.BadType.NumberLiteral,h,S)},t.badStringLiteralNode=function(h,S){return S===void 0&&(S=0),(0,l.badNode)(l.BadType.StringLiteral,h,S)},t.badErrorLiteralNode=function(h,S){return S===void 0&&(S=0),(0,l.badNode)(l.BadType.ErrorLiteral,h,S)},t.badFieldNameNode=function(h,S){return S===void 0&&(S=0),(0,l.badNode)(l.BadType.FieldName,h,S)},t.badParamNameNode=function(h,S){return S===void 0&&(S=0),(0,l.badNode)(l.BadType.ParamName,h,S)},t.badMissingNode=function(h,S){return S===void 0&&(S=0),(0,l.badNode)(l.BadType.Missing,h,S)},t.badCellRefNode=function(h,S,y,C){return S===void 0&&(S=h.indexOf("[")>=0),y===void 0&&(y=0),C===void 0&&(C=0),(0,l.cellRefNode)((0,l.cellRefBad)(h,S,y),void 0,C)},t.badQualNode=function(h,S){return S===void 0&&(S=0),(0,l.badNode)(l.BadType.Qualifier,h,S)},t.badBracketNode=function(h,S){S===void 0&&(S=!0);var y=[m("["),h];return S&&y.push(m("]")),p(y)},t.addNode=v(f.OperatorId.Add),t.subNode=v(f.OperatorId.Sub),t.mulNode=v(f.OperatorId.Mul),t.divNode=v(f.OperatorId.Div),t.powNode=v(f.OperatorId.Pow),t.percentNode=v(f.OperatorId.Percent),t.negNode=v(f.OperatorId.Neg),t.posNode=v(f.OperatorId.Pos),t.concatNode=v(f.OperatorId.Concat),t.eqNode=v(f.OperatorId.Eq),t.neNode=v(f.OperatorId.Ne),t.ltNode=v(f.OperatorId.Lt),t.leNode=v(f.OperatorId.Le),t.gtNode=v(f.OperatorId.Gt),t.geNode=v(f.OperatorId.Ge),t.rangeNode=v(f.OperatorId.Range),t.isectNode=v(f.OperatorId.Isect),t.unionNode=v(f.OperatorId.Union),t.andNode=v(f.OperatorId.And),t.orNode=v(f.OperatorId.Or),t.xorNode=v(f.OperatorId.Xor),t.minNode=v(f.OperatorId.Min),t.maxNode=v(f.OperatorId.Max),t.atNode=v(f.OperatorId.At),t.poundNode=v(f.OperatorId.Pound)},3424:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionType=t.FunctionFlags=t.SpecialPrecs=t.SignatureType=t.OperKind=void 0;var s,c,l,f,p=d(637),m=p.assertions.assertNatural,v=p.assertions.assertFalse,h=p.assertions.assertIndex;(f=t.OperKind||(t.OperKind={}))[f.Number=1]="Number",f[f.String=2]="String",f[f.Boolean=4]="Boolean",f[f.Error=8]="Error",f[f.Range=16]="Range",f[f.Array=32]="Array",f[f.Missing=64]="Missing",f[f.Blank=128]="Blank",f[f.Rich=256]="Rich",(l=t.SignatureType||(t.SignatureType={}))[l.None=0]="None",l[l.Goto=512]="Goto",l[l.Ref3D=1024]="Ref3D",l[l.All=2047]="All",(c=t.SpecialPrecs||(t.SpecialPrecs={}))[c.None=0]="None",c[c.OwnDoc=1]="OwnDoc",c[c.OwnSheet=2]="OwnSheet",c[c.OwnRow=4]="OwnRow",c[c.OwnCol=8]="OwnCol",c[c.OwnRowCopy=16]="OwnRowCopy",c[c.OwnColCopy=32]="OwnColCopy",c[c.OwnDocSheets=64]="OwnDocSheets",c[c.CellProps=128]="CellProps",c[c.AllCells=256]="AllCells",c[c.AllNames=512]="AllNames",c[c.Time=1024]="Time",c[c.Calc=2048]="Calc",c[c.InFilterMode=4096]="InFilterMode",c[c.RefStyle=8192]="RefStyle",c[c.All=16383]="All",(s=t.FunctionFlags||(t.FunctionFlags={}))[s.None=0]="None",s[s.Dark=1]="Dark",s[s.Macro=2]="Macro",s[s.OnlyParsedDuringLoad=4]="OnlyParsedDuringLoad",s[s.Internal=8]="Internal",s[s.Allow3dRef=16]="Allow3dRef",s[s.HiddenFromUI=32]="HiddenFromUI",t.functionType=function(S,y,C,E,I,F,w,B){if(m("calc.lang.functionType",y),h("calc.lang.functionType",S,y+1),E.length===0?I.length!==0:I.length>=E.length){var k=JSON.stringify(I);v("calc.lang.functionType: expected tailTypes.length < restTypes.length; given ".concat(k))}return E.length===0&&C.length+I.length<y&&(k=JSON.stringify(C),v("calc.lang.functionType: expected headTypes.length + tailTypes.length >= ".concat(y,"; given ").concat(k))),{minArgs:S,maxArgs:y,headTypes:C,restTypes:E,tailTypes:I,returnType:F,staticPrecs:w,flags:B}}},927:function(u,t,d){"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0}),t.isReadOperEqual=t.isWriteOper=t.isPrimitiveOper=t.isRichOper=t.isBlankOper=t.isMissingOper=t.isArrayOper=t.isRangeOper=t.isErrorOper=t.isBooleanOper=t.isStringOper=t.isNumberOper=t.shouldFieldRefBeBracketed=t.isValidArgsLength=t.getArgType=t.isBooleanNode=t.isNumberNode=t.isMissingNode=t.isUnqualifiedNameNode=t.isWSFNode=t.isOperatorNode=t.getArguments=t.getSubExpressionFromPosition=t.gridCellRange=t.sheetGridRangeAnchor=t.gridRangeAnchor=t.isSheetGridRangeEqual=t.isSheetGridCellEqual=t.isGridRangeEqual=t.isGridCellEqual=t.isNameScopeEqual=t.sheetRangeToSheetIndex=t.isSheetIndexEqual=t.isDocumentLocEqual=t.gridRangeSize=t.gridRangeExcept=t.gridRangeCompare=t.gridCellImplicitIsect=t.gridRangeIsects=t.gridRangeIsect=t.gridRangesJoin=t.gridRangeJoinOpt=t.gridRangeJoin=t.forEachTileInRange=t.forEachCellInRange=t.isWellFormed=t.isSheetGridRange=t.isSheetIndex=t.isSheetGridCell=t.isGridCell=void 0,t.applyComparison=t.normalizeCommaOpRef=t.isRangeOpNoMissing=t.isRangeOpClosed=t.isCommaOpNoBadOrMissing=t.isCommaOpClosed=t.isCommaOpRefWellFormed=t.getBoundName=t.getUserDefinedFuncName=t.getWorksheetFuncId=t.createFailureErrorClass=t.internal=t.unavailable=t.notImplemented=t.ReasonKind=t.LangReasonKind=void 0;var c=d(655),l=d(9745),f=d(9937);Object.defineProperty(t,"isGridCell",{enumerable:!0,get:function(){return f.isGridCell}}),Object.defineProperty(t,"isSheetGridCell",{enumerable:!0,get:function(){return f.isSheetGridCell}});var p=d(3546),m=d(3424),v=d(7815),h=d(8350),S=d(8832),y=d(5947),C=d(9937);function E(g,O){var M=g.row,K=g.col,W=g.rows,z=g.cols,ee=O.row,ue=O.col,ce=O.rows,he=O.cols,de=(0,h.fastMin)(M,ee),pe=(0,h.fastMin)(K,ue),_e=(0,h.fastMax)(M+W,ee+ce)-de,Ce=(0,h.fastMax)(K+z,ue+he)-pe;return(0,f.unsafeGridRange)(de,pe,_e,Ce)}function I(g,O){return g===O||g.name===O.name&&g.path===O.path}function F(g,O){return I(g.document,O.document)&&g.index===O.index}function w(g,O){return g.row===O.row&&g.col===O.col}function B(g,O){return g.row===O.row&&g.col===O.col&&g.rows===O.rows&&g.cols===O.cols}function k(g){return(0,f.isGridCell)(g)?g:(0,f.unsafeGridRange)(g.row,g.col,1,1)}Object.defineProperty(t,"isSheetIndex",{enumerable:!0,get:function(){return C.isSheetIndex}}),Object.defineProperty(t,"isSheetGridRange",{enumerable:!0,get:function(){return C.isSheetGridRange}}),t.isWellFormed=function(g){return g.isWellFormed},t.forEachCellInRange=function(g,O){if((0,f.isGridCell)(g))return O(g,0,0);for(var M=g.row,K=g.rows,W=g.col,z=g.cols,ee=0;ee<K;ee+=1)for(var ue=0;ue<z;ue+=1)if(!O((0,f.gridCell)(M+ee,W+ue),ee,ue))return!1;return!0},t.forEachTileInRange=function(g,O,M){var K=g.row,W=g.rows,z=g.col,ee=g.cols;(0,l.assertPositiveInteger)("calc.lang.forEachTileInRange",O),(0,l.assertIndex)("calc.lang.forEachTileInRange",K,f.sheetRows),(0,l.assertIndex)("calc.lang.forEachTileInRange",z,f.sheetCols),(0,l.assertPositiveLength)("calc.lang.forEachTileInRange",W,f.sheetRows-K),(0,l.assertPositiveLength)("calc.lang.forEachTileInRange",ee,f.sheetCols-z);for(var ue=K;ue<K+W;ue+=O)for(var ce=z;ce<z+ee;ce+=O)if(!M((0,f.unsafeGridRange)(ue,ce,(0,h.fastMin)(O,W+K-ue),(0,h.fastMin)(O,ee+z-ce))))return!1;return!0},t.gridRangeJoin=E,t.gridRangeJoinOpt=function(g,O){return g?O?E(g,O):g:O},t.gridRangesJoin=function(g){return g.length===0&&(0,l.assertFalse)("calc.runtime.gridRangesJoin: expected nonempty range array"),g.reduce(E)},t.gridRangeIsect=function(g,O){var M=g.row,K=g.col,W=g.rows,z=g.cols,ee=O.row,ue=O.col,ce=O.rows,he=O.cols,de=(0,h.fastMax)(M,ee),pe=(0,h.fastMax)(K,ue),_e=(0,h.fastMin)(M+W,ee+ce)-de,Ce=(0,h.fastMin)(K+z,ue+he)-pe;if(!(_e<=0||Ce<=0))return(0,f.unsafeGridRange)(de,pe,_e,Ce)},t.gridRangeIsects=function(g,O){var M=g.row,K=g.col,W=g.rows,z=g.cols,ee=O.row,ue=O.col,ce=O.rows,he=O.cols;return(0,h.fastMax)(M,ee)<(0,h.fastMin)(M+W,ee+ce)&&(0,h.fastMax)(K,ue)<(0,h.fastMin)(K+z,ue+he)},t.gridCellImplicitIsect=function(g,O){var M=g.row,K=g.col,W=O.row,z=O.col,ee=O.rows,ue=O.cols,ce=W<=M&&M<W+ee,he=z<=K&&K<z+ue;return ce&&he?(0,f.gridCell)(M,K):ce&&ue===1?(0,f.gridCell)(M,z):he&&ee===1?(0,f.gridCell)(W,K):ue===1&&ee===1?(0,f.gridCell)(W,z):void 0},t.gridRangeCompare=function(g,O){var M=g.row,K=g.col,W=g.rows,z=g.cols,ee=O.row,ue=O.col,ce=M+W,he=ee+O.rows,de=K+z,pe=ue+O.cols;return M===ee&&ce===he&&K===ue&&de===pe?0:M<=ee&&ce>=he&&K<=ue&&de>=pe?1:M>=ee&&ce<=he&&K>=ue&&de<=pe?-1:void 0},t.gridRangeExcept=function(g,O){var M=[g.row,g.row+g.rows],K=[g.col,g.col+g.cols],W=[O.row,O.row+O.rows],z=[O.col,O.col+O.cols],ee=(0,S.ivlCompare)(M,W),ue=(0,S.ivlCompare)(K,z);if(ee!==void 0&&ee<=0){var ce=(0,S.ivlExcept)(K,z);if(ce!==void 0)return(0,f.gridRange)(g.row,ce[0],g.rows,ce[1]-ce[0])}if(ue!==void 0&&ue<=0){var he=(0,S.ivlExcept)(M,W);if(he!==void 0)return(0,f.gridRange)(he[0],g.col,he[1]-he[0],g.cols)}},t.gridRangeSize=function(g){return g.rows*g.cols},t.isDocumentLocEqual=I,t.isSheetIndexEqual=F,t.sheetRangeToSheetIndex=function(g){if(g.index===g.index2)return c.__assign(c.__assign({},g),{__isRange:!1})},t.isNameScopeEqual=function(g,O){return I(g.document,O.document)&&g.index===O.index},t.isGridCellEqual=w,t.isGridRangeEqual=B,t.isSheetGridCellEqual=function(g,O){return F(g.sheet,O.sheet)&&w(g.range,O.range)},t.isSheetGridRangeEqual=function(g,O){return F(g.sheet,O.sheet)&&B(g.range,O.range)},t.gridRangeAnchor=k,t.sheetGridRangeAnchor=function(g){return(0,f.isSheetGridCell)(g)?g:(0,f.sheetGridCell)(g.sheet,k(g.range))},t.gridCellRange=function(g,O){var M=g.row,K=g.col,W=O.row,z=O.col;return(0,f.unsafeGridRange)((0,h.fastMin)(M,W),(0,h.fastMin)(K,z),Math.abs(W-M)+1,Math.abs(z-K)+1)},t.getSubExpressionFromPosition=function(g,O){function M(pe){var _e=g.spans[pe.label];return _e!==void 0&&_e.start<=O&&O<_e.end}for(var K=g.node,W=!0;W;)switch(W=!1,K.kind){case p.NodeKind.Array:for(var z=K.nodes,ee=z.length-1;!W&&ee>=0;ee-=1)for(var ue=z[ee],ce=ue.length-1;!W&&ce>=0;ce-=1)M(de=ue[ce])&&(K=de,W=!0);break;case p.NodeKind.App:case p.NodeKind.Let:case p.NodeKind.Lambda:var he=K.args.map(function(pe){return pe.kind===p.NodeKind.Param?pe.name.name:pe});for(ce=he.length-1;!W&&ce>=0;ce-=1)M(de=he[ce])&&(K=de,W=!0);break;case p.NodeKind.Paren:var de;M(de=K.node)&&(K=de,W=!0);break;case p.NodeKind.Bad:case p.NodeKind.Name:case p.NodeKind.CellRef:case p.NodeKind.StructRef:case p.NodeKind.Literal:break;case p.NodeKind.FieldRef:M(K.lhs)&&(K=K.lhs,W=!0);break;default:(0,l.assertNever)("getSubExpressionFromPosition",K)}return K};var x=[];function G(g){return g.kind===p.NodeKind.Literal&&U(g.oper)}function H(g){return g.kind===p.NodeKind.Literal&&D(g.oper)}function L(g){return g.kind===m.OperKind.Number}function D(g){return g.kind===m.OperKind.Boolean}function U(g){return g.kind===m.OperKind.Missing}t.getArguments=function(g){return function(O){return O.args.length===1&&G(O.args[0])?0:O.args.length}(g)===0?x:g.args},t.isOperatorNode=function(g){return g.kind===p.NodeKind.Operator},t.isWSFNode=function(g){return g.kind===p.NodeKind.WSF},t.isUnqualifiedNameNode=function(g){return g.kind===p.NodeKind.Name&&g.qualifier===void 0},t.isMissingNode=G,t.isNumberNode=function(g){return g.kind===p.NodeKind.Literal&&L(g.oper)},t.isBooleanNode=H,t.getArgType=function(g,O,M){var K=g.maxArgs,W=g.headTypes,z=g.restTypes,ee=g.tailTypes;if((0,l.assertPositiveInteger)("calc.runtime.getArgType: n",M),(0,l.assertIndex)("calc.runtime.getArgType: i",O,M),O>=K)return m.SignatureType.None;if(O<W.length)return W[O];if(z.length===0)return m.SignatureType.None;if(O<W.length+z.length)return z[O-W.length];var ue=(M-W.length)%z.length;return ue>ee.length?m.SignatureType.None:O>=M-ue?ee[O-(M-ue)]:z[(O-W.length)%z.length]},t.isValidArgsLength=function(g,O){var M=g.minArgs,K=g.maxArgs,W=g.headTypes,z=g.restTypes,ee=g.tailTypes;return!(O<M||O>K)&&(O<=W.length+z.length||z.length!==0&&(O-W.length)%z.length<=ee.length)},t.shouldFieldRefBeBracketed=function(g,O,M){return M.length>0&&O.field.kind===p.NodeKind.Name&&(H(g)||g.kind===p.NodeKind.Name||g.kind===p.NodeKind.CellRef)},t.isNumberOper=L,t.isStringOper=function(g){return g.kind===m.OperKind.String},t.isBooleanOper=D,t.isErrorOper=function(g){return g.kind===m.OperKind.Error},t.isRangeOper=function(g){return g.kind===m.OperKind.Range},t.isArrayOper=function(g){return g.kind===m.OperKind.Array},t.isMissingOper=U,t.isBlankOper=function(g){return g.kind===m.OperKind.Blank},t.isRichOper=function(g){return g.kind===m.OperKind.Rich};var V=m.OperKind.Number|m.OperKind.String|m.OperKind.Boolean;t.isPrimitiveOper=function(g){return(g.kind&V)!=0};var ne,J=V|m.OperKind.Error|m.OperKind.Array|m.OperKind.Rich;t.isWriteOper=function(g){return(g.kind&J)!=0},t.isReadOperEqual=function g(O,M,K,W){if(K.kind!==M.kind)return!1;switch(K.kind){case m.OperKind.Boolean:case m.OperKind.String:return K.value===M.value;case m.OperKind.Number:return O.cond2(K,M)===0;case m.OperKind.Error:return K.type===M.type;case m.OperKind.Rich:return W;case m.OperKind.Array:var z=M;if(K.cols!==z.cols||K.rows!==z.rows)return!1;for(var ee=0;ee<K.rows;ee+=1)for(var ue=K.opers[ee],ce=z.opers[ee],he=0;he<K.cols;he+=1)if(!g(O,ce[he],ue[he],W))return!1;return!0;case m.OperKind.Blank:return!0;default:return(0,l.assertNever)("calc.lang.readOperEq",K)}},function(g){g.NotImplemented="NotImplemented",g.Unavailable="Unavailable",g.Internal="Internal"}(ne=t.LangReasonKind||(t.LangReasonKind={})),t.ReasonKind=c.__assign(c.__assign({},v.ReasonKind),ne),t.notImplemented=function(g){return{kind:t.ReasonKind.NotImplemented,features:g}},t.unavailable=function(g){for(var O=[],M=1;M<arguments.length;M++)O[M-1]=arguments[M];return g.length===0&&(0,l.assertFalse)("calc.lang.unavailable: expected nonempty array"),{kind:t.ReasonKind.Unavailable,objects:g}},t.internal=function(g){return{kind:t.ReasonKind.Internal,message:g}},t.createFailureErrorClass=function(g){var O=function(K){this.reason=K,this.name=g,this.stack=g,this.message=K.kind};return(O.prototype=Object.create(Error.prototype)).constructor=O,O};var $="_xlfn.",Z="_xlws.";t.getWorksheetFuncId=function(g,O){var M=O;return M.length>$.length&&g.stringCompareCI(M.substring(0,$.length),$)===0&&(M=M.substring($.length)).length>Z.length&&g.stringCompareCI(M.substring(0,Z.length),Z)===0&&(M=M.substring(Z.length)),g.getWorksheetFuncId(M)};var ie="_xludf.";t.getUserDefinedFuncName=function(g,O){var M=O;return M.length>ie.length&&g.stringCompareCI(M.substring(0,ie.length),ie)===0&&(M=M.substring(ie.length)),M};var X="_xlpm.";function Q(g){return g.kind!==p.StructRefKind.SpecialRef&&g.kind!==p.StructRefKind.BadRef||g.isBracketed}function b(g){return g.kind===p.StructRefKind.MissingRef||g.kind===p.StructRefKind.BadRef}function R(g){switch(g.kind){case p.StructRefKind.SpecialRef:case p.StructRefKind.ColumnRef:return g.isClosed;case p.StructRefKind.RangeOpRef:return R(g.lhs)&&R(g.rhs);case p.StructRefKind.MissingRef:return!0;case p.StructRefKind.BadRef:return g.isClosed}}t.getBoundName=function(g,O){var M=O;return M.length>X.length&&g.stringCompareCI(M.substring(0,X.length),X)===0&&(M=M.substring(X.length)),M},t.isCommaOpRefWellFormed=function(g){return g.columnRefs.length<=1&&g.refs.every(Q)&&function(O){var M=O.specialRefs,K=Object.keys(M).reduce(function(W,z){return W+(M[Number(z)]?1:0)},0);return K===1||K===2&&M[p.SpecialRefId.Data]&&(M[p.SpecialRefId.Headers]||M[p.SpecialRefId.Totals])}(g)},t.isCommaOpClosed=function(g){return g.refs.every(R)},t.isCommaOpNoBadOrMissing=function(g){return!g.refs.some(b)},t.isRangeOpClosed=function(g){return R(g.lhs)&&R(g.rhs)},t.isRangeOpNoMissing=function(g){return!b(g.lhs)&&!b(g.rhs)};var P=((s={})[p.SpecialRefId.All]=1,s[p.SpecialRefId.Headers]=2,s[p.SpecialRefId.Data]=3,s[p.SpecialRefId.Totals]=4,s[p.SpecialRefId.ThisRow]=5,s),A=function(O){return O.kind===p.StructRefKind.MissingRef?7:O.kind!==p.StructRefKind.SpecialRef?6:P[O.id]};function T(g,O){return A(g)-A(O)}t.normalizeCommaOpRef=function(g){for(var O={},M=[],K=0,W=g.refs;K<W.length;K++){var z=W[K];z.kind!==p.StructRefKind.SpecialRef?M.push(z):O[z.id]===void 0&&(O[z.id]=!0,M.push(z))}return M.sort(T),M},t.applyComparison=function(g,O){switch(g){case y.OperatorId.Eq:return O===0;case y.OperatorId.Ne:return O!==0;case y.OperatorId.Lt:return O<0;case y.OperatorId.Gt:return O>0;case y.OperatorId.Le:return O<=0;case y.OperatorId.Ge:return O>=0}}},2294:function(u,t,d){"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0}),t.falseOper=t.trueOper=t.blankOper=t.missingOper=t.range3DOper=t.rangeSeqOper=t.arrayOper=t.externalErrorOper=t.busyErrorOper=t.calcErrorOper=t.fieldErrorOper=t.unknownErrorOper=t.blockedErrorOper=t.connectErrorOper=t.spillErrorOper=t.gettingDataErrorOper=t.naErrorOper=t.numErrorOper=t.nameErrorOper=t.refErrorOper=t.valueErrorOper=t.div0ErrorOper=t.nullErrorOper=t.errorOper=t.stringOper=t.booleanOper=t.precedents=t.ErrorType=t.cellStringLimit=t.PrecsBound=void 0;var c,l,f=d(637),p=f.assertions.assertNatural,m=f.assertions.assertPositiveInteger,v=f.assertions.assertFalse,h=f.util.partialArray,S=d(3424);function y(E){return{kind:S.OperKind.Error,type:E}}(l=t.PrecsBound||(t.PrecsBound={}))[l.Lower=-1]="Lower",l[l.Exact=0]="Exact",l[l.Upper=1]="Upper",t.cellStringLimit=32767,function(E){E[E.NULL=1]="NULL",E[E.DIV0=2]="DIV0",E[E.VALUE=3]="VALUE",E[E.REF=4]="REF",E[E.NAME=5]="NAME",E[E.NUM=6]="NUM",E[E.NA=7]="NA",E[E.GETTING_DATA=8]="GETTING_DATA",E[E.SPILL=9]="SPILL",E[E.CONNECT=10]="CONNECT",E[E.BLOCKED=11]="BLOCKED",E[E.UNKNOWN=12]="UNKNOWN",E[E.FIELD=13]="FIELD",E[E.CALC=14]="CALC",E[E.BUSY=16]="BUSY",E[E.EXTERNAL=19]="EXTERNAL"}(c=t.ErrorType||(t.ErrorType={})),t.precedents=function(E,I,F,w,B){return{cells:E,names:I,udfs:F,special:w,bound:B}},t.booleanOper=function(E){return E?t.trueOper:t.falseOper},t.stringOper=function(E){return{kind:S.OperKind.String,value:E}},t.errorOper=function(E){var I=C[E];return I!==void 0?I:y(E)},t.nullErrorOper=y(c.NULL),t.div0ErrorOper=y(c.DIV0),t.valueErrorOper=y(c.VALUE),t.refErrorOper=y(c.REF),t.nameErrorOper=y(c.NAME),t.numErrorOper=y(c.NUM),t.naErrorOper=y(c.NA),t.gettingDataErrorOper=y(c.GETTING_DATA),t.spillErrorOper=y(c.SPILL),t.connectErrorOper=y(c.CONNECT),t.blockedErrorOper=y(c.BLOCKED),t.unknownErrorOper=y(c.UNKNOWN),t.fieldErrorOper=y(c.FIELD),t.calcErrorOper=y(c.CALC),t.busyErrorOper=y(c.BUSY),t.externalErrorOper=y(c.EXTERNAL);var C=h(((s={})[c.NULL]=t.nullErrorOper,s[c.DIV0]=t.div0ErrorOper,s[c.VALUE]=t.valueErrorOper,s[c.REF]=t.refErrorOper,s[c.NAME]=t.nameErrorOper,s[c.NUM]=t.numErrorOper,s[c.NA]=t.naErrorOper,s[c.GETTING_DATA]=t.gettingDataErrorOper,s[c.SPILL]=t.spillErrorOper,s[c.CONNECT]=t.connectErrorOper,s[c.BLOCKED]=t.blockedErrorOper,s[c.UNKNOWN]=t.unknownErrorOper,s[c.FIELD]=t.fieldErrorOper,s[c.CALC]=t.calcErrorOper,s[c.BUSY]=t.busyErrorOper,s[c.EXTERNAL]=t.externalErrorOper,s));t.arrayOper=function(E,I,F){return p("calc.lang.arrayOper",E),p("calc.lang.arrayOper",I),F.length!==E?v("calc.lang.arrayOper: Inconsistent row number"):{kind:S.OperKind.Array,rows:E,cols:I,opers:F}},t.rangeSeqOper=function(E,I){return m("calc.lang.rangeSeqOper",I.length),{kind:S.OperKind.Range,sheets:E,ranges:I}},t.range3DOper=function(E,I){return{kind:S.OperKind.Range,sheets:E,ranges:[I]}},t.missingOper={kind:S.OperKind.Missing},t.blankOper={kind:S.OperKind.Blank},t.trueOper={kind:S.OperKind.Boolean,value:!0},t.falseOper={kind:S.OperKind.Boolean,value:!1}},9017:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reducePledge=t.reduceTopDown_Pledge=t.reduceBottomUp=t.reduceBottomUp_MaxDepth=t.reduceBottomUp_Pledge=t.PledgeReducer=t.reduceBottomUp_CPS=t.reduceBottomUp_Recursive=t.zipVisitor=t.ZipVisitor=t.depthVisitor=t.composeVisitor=t.ComposeVisitor=t.binaryVisitor=t.BinaryVisitor=t.DelegatingVisitor=t.voidVisitor=t.constVisitor=t.ConstVisitor=t.identityVisitor=t.IdentityVisitor=t.bindVisitor=t.visitCellRef=t.visitQualifier=t.visitAppHeadNode=t.visitWSFNode=t.visitOperatorNode=t.visitFormulaNode=void 0;var s=d(655),c=d(9745),l=d(8350),f=d(8308),p=d(3546);function m(R,P){switch(P.kind){case p.NodeKind.Literal:var A=P.oper,T=P.isClosed,g=P.label;return R.literalNode(A,T,g);case p.NodeKind.Array:var O=P.nodes;return T=P.isClosed,g=P.label,R.arrayNode(O,T,g);case p.NodeKind.App:var M=P.head,K=P.args;return T=P.isClosed,g=P.label,R.appNode(M,K,T,g);case p.NodeKind.Let:M=P.head;var W=P.vars,z=P.body,ee=P.badArgs;return T=P.isClosed,g=P.label,R.letNode(M,W,z,ee,T,g);case p.NodeKind.Lambda:M=P.head;var ue=P.params;return z=P.body,ee=P.badArgs,T=P.isClosed,g=P.label,R.lambdaNode(M,ue,z,ee,T,g);case p.NodeKind.Paren:var ce=P.node;return T=P.isClosed,g=P.label,R.parenNode(ce,T,g);case p.NodeKind.Name:var he=P.parts,de=P.qualifier;return g=P.label,R.nameNode(he,de,g);case p.NodeKind.CellRef:var pe=P.ref;return de=P.qualifier,g=P.label,R.cellRefNode(pe,de,g);case p.NodeKind.FieldRef:var _e=P.lhs,Ce=P.rhs,Ne=P.shouldBeBracketed;return g=P.label,R.fieldRefNode(_e,Ce,Ne,g);case p.NodeKind.StructRef:return _e=P.lhs,Ce=P.rhs,g=P.label,R.structRefNode(_e,Ce,g);case p.NodeKind.Bad:switch(g=P.label,P.type){case p.BadType.Sequence:case p.BadType.StructRef:case p.BadType.FieldRef:return R.badSequenceNode(P.type,P.contents,g);default:return R.badStringNode(P.type,P.contents,g)}default:return(0,c.assertNever)("calc.lang.visitFormulaNode",P)}}function v(R,P){var A=P.id,T=P.label;return R.operatorNode(A,T)}function h(R,P){var A=P.id,T=P.whole,g=P.label;return R.wsfNode(A,T,g)}function S(R,P){switch(P.kind){case p.NodeKind.Operator:return v(R,P);case p.NodeKind.WSF:return h(R,P);default:return m(R,P)}}function y(R){return{literalNode:R.literalNode.bind(R),arrayNode:R.arrayNode.bind(R),appNode:R.appNode.bind(R),letNode:R.letNode.bind(R),lambdaNode:R.lambdaNode.bind(R),parenNode:R.parenNode.bind(R),nameNode:R.nameNode.bind(R),cellRefNode:R.cellRefNode.bind(R),fieldRefNode:R.fieldRefNode.bind(R),structRefNode:R.structRefNode.bind(R),badSequenceNode:R.badSequenceNode.bind(R),badStringNode:R.badStringNode.bind(R),operatorNode:R.operatorNode.bind(R),wsfNode:R.wsfNode.bind(R)}}t.visitFormulaNode=m,t.visitOperatorNode=v,t.visitWSFNode=h,t.visitAppHeadNode=S,t.visitQualifier=function(R,P){switch(P.kind){case p.QualifierKind.Error:var A=P.label;return R.errorQualifier(A);case p.QualifierKind.Relative:return A=P.label,R.relativeQualifier(A);case p.QualifierKind.Document:var T=P.document,g=P.path,O=P.isQuoted;return A=P.label,R.documentQualifier(T,g,O,A);case p.QualifierKind.Sheet:var M=P.sheet,K=P.document;return O=P.isQuoted,A=P.label,R.sheetQualifier(M,K,O,A);case p.QualifierKind.Ident:var W=P.name;return O=P.isQuoted,A=P.label,R.identQualifier(W,O,A);case p.QualifierKind.SheetRange:var z=P.sheet1,ee=P.sheet2,ue=P.document;return O=P.isQuoted,A=P.label,R.sheetRangeQualifier(z,ee,ue,O,A);case p.QualifierKind.Bad:var ce=P.chars;return O=P.isQuoted,A=P.label,R.badQualifier(ce,O,A);default:return(0,c.assertNever)("calc.lang.visitQualifier",P)}},t.visitCellRef=function(R,P){switch(P.kind){case p.CellRefKind.Error:var A=P.label;return R.cellRefError(A);case p.CellRefKind.Single:var T=P.row,g=P.col,O=P.isBracketed;return A=P.label,R.cellRefSingle(T,g,O,A);case p.CellRefKind.Range:var M=P.ref1,K=P.ref2;return A=P.label,R.cellRefRange(M,K,A);case p.CellRefKind.Row:var W=P.row1,z=P.row2;return O=P.isBracketed,A=P.label,R.cellRefRow(W,z,O,A);case p.CellRefKind.Col:var ee=P.col1,ue=P.col2;return O=P.isBracketed,A=P.label,R.cellRefCol(ee,ue,O,A);case p.CellRefKind.Bad:var ce=P.chars;return O=P.isBracketed,A=P.label,R.cellRefBad(ce,O,A);default:return(0,c.assertNever)("calc.lang.visitCellRef",P)}},t.bindVisitor=y;var C=function(){function R(){}return R.prototype.literalNode=function(P,A,T){return(0,p.literalNode)(P,A,T)},R.prototype.arrayNode=function(P,A,T){return(0,p.arrayNode)(P,A,T)},R.prototype.appNode=function(P,A,T,g){return(0,p.appNode)(P,A,T,g)},R.prototype.letNode=function(P,A,T,g,O,M){return(0,p.letNode)(P,A,T,g,O,M)},R.prototype.lambdaNode=function(P,A,T,g,O,M){return(0,p.lambdaNode)(P,A,T,g,O,M)},R.prototype.parenNode=function(P,A,T){return(0,p.parenNode)(P,A,T)},R.prototype.nameNode=function(P,A,T){return(0,p.nameNode)(P,A,T)},R.prototype.cellRefNode=function(P,A,T){return(0,p.cellRefNode)(P,A,T)},R.prototype.fieldRefNode=function(P,A,T,g){return(0,p.fieldRefNode)(P,A,T,g)},R.prototype.structRefNode=function(P,A,T){return(0,p.structRefNode)(P,A,T)},R.prototype.badSequenceNode=function(P,A,T){return(0,p.badNode)(P,A,T)},R.prototype.badStringNode=function(P,A,T){return(0,p.badNode)(P,A,T)},R.prototype.operatorNode=function(P,A){return(0,p.operatorNode)(P,A)},R.prototype.wsfNode=function(P,A,T){return(0,p.wsfNode)(P,A,T)},R}();t.IdentityVisitor=C,t.identityVisitor=y(new C);var E=function(){function R(P){this.value=P}return R.prototype.literalNode=function(P,A,T){return this.value},R.prototype.arrayNode=function(P,A,T){return this.value},R.prototype.appNode=function(P,A,T,g){return this.value},R.prototype.letNode=function(P,A,T,g,O,M){return this.value},R.prototype.lambdaNode=function(P,A,T,g,O,M){return this.value},R.prototype.parenNode=function(P,A,T){return this.value},R.prototype.nameNode=function(P,A,T){return this.value},R.prototype.cellRefNode=function(P,A,T){return this.value},R.prototype.fieldRefNode=function(P,A,T,g){return this.value},R.prototype.structRefNode=function(P,A,T){return this.value},R.prototype.badSequenceNode=function(P,A,T){return this.value},R.prototype.badStringNode=function(P,A,T){return this.value},R.prototype.operatorNode=function(P,A){return this.value},R.prototype.wsfNode=function(P,A,T){return this.value},R}();function I(R){return y(new E(R))}t.ConstVisitor=E,t.constVisitor=I,t.voidVisitor=I(void 0);var F=function(){function R(P){this.visitor=P}return R.prototype.literalNode=function(P,A,T){return this.visitor.literalNode(P,A,T)},R.prototype.arrayNode=function(P,A,T){return this.visitor.arrayNode(P,A,T)},R.prototype.appNode=function(P,A,T,g){return this.visitor.appNode(P,A,T,g)},R.prototype.letNode=function(P,A,T,g,O,M){return this.visitor.letNode(P,A,T,g,O,M)},R.prototype.lambdaNode=function(P,A,T,g,O,M){return this.visitor.lambdaNode(P,A,T,g,O,M)},R.prototype.parenNode=function(P,A,T){return this.visitor.parenNode(P,A,T)},R.prototype.nameNode=function(P,A,T){return this.visitor.nameNode(P,A,T)},R.prototype.cellRefNode=function(P,A,T){return this.visitor.cellRefNode(P,A,T)},R.prototype.fieldRefNode=function(P,A,T,g){return this.visitor.fieldRefNode(P,A,T,g)},R.prototype.structRefNode=function(P,A,T){return this.visitor.structRefNode(P,A,T)},R.prototype.badSequenceNode=function(P,A,T){return this.visitor.badSequenceNode(P,A,T)},R.prototype.badStringNode=function(P,A,T){return this.visitor.badStringNode(P,A,T)},R.prototype.operatorNode=function(P,A){return this.visitor.operatorNode(P,A)},R.prototype.wsfNode=function(P,A,T){return this.visitor.wsfNode(P,A,T)},R}();t.DelegatingVisitor=F;var w=function(R){function P(A,T){var g=R.call(this,A)||this;return g.reducer=function(O,M){return T(O,M)},g}return s.__extends(P,R),P.prototype.arrayNode=function(A,T,g){var O=this;return(0,c.assertTrue)("calc.lang.binaryVisitor: non-empty array",A.length>0&&A[0].length>0),A.map(function(M){return M.reduce(O.reducer)}).reduce(this.reducer)},P.prototype.appNode=function(A,T,g,O){return T.reduce(this.reducer,A)},P.prototype.letNode=function(A,T,g,O,M,K){return s.__spreadArray(s.__spreadArray(s.__spreadArray([],T.map(function(W){return W.binder.arg}),!0),g===void 0?[]:[g.arg],!0),O.map(function(W){return W.arg}),!0).reduce(this.reducer,A)},P.prototype.lambdaNode=function(A,T,g,O,M,K){return s.__spreadArray(s.__spreadArray(s.__spreadArray([],T.map(function(W){var z;return(z=W.name.arg.def)===null||z===void 0?void 0:z.rhs}).filter(l.isDefined),!0),g===void 0?[]:[g.arg],!0),O.map(function(W){return W.arg}),!0).reduce(this.reducer,A)},P.prototype.parenNode=function(A,T,g){return A},P.prototype.fieldRefNode=function(A,T,g,O){return A},P.prototype.badSequenceNode=function(A,T,g){return(0,c.assertTrue)("calc.lang.binaryVisitor: non-empty bad-sequence",T.length>0),T.reduce(this.reducer)},P}(F);function B(R,P){return y(new w(R,P))}t.BinaryVisitor=w,t.binaryVisitor=B;var k=function(){function R(P,A){this.a=P,this.b=A}return R.prototype.literalNode=function(P,A,T){return this.b(this.a.literalNode(P,A,T))},R.prototype.arrayNode=function(P,A,T){return this.b(this.a.arrayNode(P,A,T))},R.prototype.appNode=function(P,A,T,g){return this.b(this.a.appNode(P,A,T,g))},R.prototype.letNode=function(P,A,T,g,O,M){return this.b(this.a.letNode(P,A,T,g,O,M))},R.prototype.lambdaNode=function(P,A,T,g,O,M){return this.b(this.a.lambdaNode(P,A,T,g,O,M))},R.prototype.parenNode=function(P,A,T){return this.b(this.a.parenNode(P,A,T))},R.prototype.nameNode=function(P,A,T){return this.b(this.a.nameNode(P,A,T))},R.prototype.cellRefNode=function(P,A,T){return this.b(this.a.cellRefNode(P,A,T))},R.prototype.fieldRefNode=function(P,A,T,g){return this.b(this.a.fieldRefNode(P,A,T,g))},R.prototype.structRefNode=function(P,A,T){return this.b(this.a.structRefNode(P,A,T))},R.prototype.badSequenceNode=function(P,A,T){return this.b(this.a.badSequenceNode(P,A,T))},R.prototype.badStringNode=function(P,A,T){return this.b(this.a.badStringNode(P,A,T))},R.prototype.operatorNode=function(P,A){return this.b(this.a.operatorNode(P,A))},R.prototype.wsfNode=function(P,A,T){return this.b(this.a.wsfNode(P,A,T))},R}();function x(R,P){return y(new k(R,P))}t.ComposeVisitor=k,t.composeVisitor=x,t.depthVisitor=x(B(I(0),l.fastMax),function(R){return R+1});var G=function(){function R(P){this.visitors=P,this.keys=Object.keys(P)}return R.prototype.literalNode=function(P,A,T){for(var g={},O=0,M=this.keys;O<M.length;O++){var K=M[O];g[K]=this.visitors[K].literalNode(P,A,T)}return g},R.prototype.arrayNode=function(P,A,T){for(var g={},O=0,M=this.keys;O<M.length;O++){var K=M[O];g[K]=this.visitors[K].arrayNode(P,A,T)}return g},R.prototype.appNode=function(P,A,T,g){for(var O={},M=0,K=this.keys;M<K.length;M++){var W=K[M];O[W]=this.visitors[W].appNode(P,A,T,g)}return O},R.prototype.letNode=function(P,A,T,g,O,M){for(var K={},W=0,z=this.keys;W<z.length;W++){var ee=z[W];K[ee]=this.visitors[ee].letNode(P,A,T,g,O,M)}return K},R.prototype.lambdaNode=function(P,A,T,g,O,M){for(var K={},W=0,z=this.keys;W<z.length;W++){var ee=z[W];K[ee]=this.visitors[ee].lambdaNode(P,A,T,g,O,M)}return K},R.prototype.parenNode=function(P,A,T){for(var g={},O=0,M=this.keys;O<M.length;O++){var K=M[O];g[K]=this.visitors[K].parenNode(P,A,T)}return g},R.prototype.nameNode=function(P,A,T){for(var g={},O=0,M=this.keys;O<M.length;O++){var K=M[O];g[K]=this.visitors[K].nameNode(P,A,T)}return g},R.prototype.cellRefNode=function(P,A,T){for(var g={},O=0,M=this.keys;O<M.length;O++){var K=M[O];g[K]=this.visitors[K].cellRefNode(P,A,T)}return g},R.prototype.fieldRefNode=function(P,A,T,g){for(var O={},M=0,K=this.keys;M<K.length;M++){var W=K[M];O[W]=this.visitors[W].fieldRefNode(P,A,T,g)}return O},R.prototype.structRefNode=function(P,A,T){for(var g={},O=0,M=this.keys;O<M.length;O++){var K=M[O];g[K]=this.visitors[K].structRefNode(P,A,T)}return g},R.prototype.badSequenceNode=function(P,A,T){for(var g={},O=0,M=this.keys;O<M.length;O++){var K=M[O];g[K]=this.visitors[K].badSequenceNode(P,A,T)}return g},R.prototype.badStringNode=function(P,A,T){for(var g={},O=0,M=this.keys;O<M.length;O++){var K=M[O];g[K]=this.visitors[K].badStringNode(P,A,T)}return g},R.prototype.operatorNode=function(P,A){for(var T={},g=0,O=this.keys;g<O.length;g++){var M=O[g];T[M]=this.visitors[M].operatorNode(P,A)}return T},R.prototype.wsfNode=function(P,A,T){for(var g={},O=0,M=this.keys;O<M.length;O++){var K=M[O];g[K]=this.visitors[K].wsfNode(P,A,T)}return g},R}();function H(R,P){var A=function T(g){switch(g.kind){case p.NodeKind.Literal:var O=g.oper,M=g.isClosed,K=g.label;return R.literalNode(O,M,K);case p.NodeKind.Array:var W=g.nodes;return M=g.isClosed,K=g.label,R.arrayNode(W.map(function(me){return me.map(T)}),M,K);case p.NodeKind.App:var z=g.head,ee=g.args;return M=g.isClosed,K=g.label,R.appNode(function(me){switch(me.kind){case p.NodeKind.Operator:return v(R,me);case p.NodeKind.WSF:return h(R,me);default:return T(me)}}(z),ee.map(T),M,K);case p.NodeKind.Let:z=g.head;var ue=g.vars,ce=g.body,he=g.badArgs;return M=g.isClosed,K=g.label,R.letNode(h(R,z),ue.map(function(me){var Pe=me.name,Re=me.binder;return(0,p.letVar)(Pe,(0,p.indexedArg)(T(Re.arg),Re.index))}),ce===void 0?void 0:(0,p.indexedArg)(T(ce.arg),ce.index),he.map(function(me){return(0,p.indexedArg)(T(me.arg),me.index)}),M,K);case p.NodeKind.Lambda:z=g.head;var de=g.params;return ce=g.body,he=g.badArgs,M=g.isClosed,K=g.label,R.lambdaNode(h(R,z),de.map(function(me){var Pe=me.name;return Pe.arg.def===void 0?(0,p.lambdaParam)(Pe):(0,p.lambdaParam)((0,p.indexedArg)((0,p.paramNode)(Pe.arg.name,(0,p.paramDefault)(T(Pe.arg.def.rhs),Pe.arg.def.label),Pe.arg.label),Pe.index))}),ce===void 0?void 0:(0,p.indexedArg)(T(ce.arg),ce.index),he.map(function(me){return(0,p.indexedArg)(T(me.arg),me.index)}),M,K);case p.NodeKind.Paren:var pe=g.node;return M=g.isClosed,K=g.label,R.parenNode(T(pe),M,K);case p.NodeKind.Name:var _e=g.parts,Ce=g.qualifier;return K=g.label,R.nameNode(_e,Ce,K);case p.NodeKind.CellRef:var Ne=g.ref;return Ce=g.qualifier,K=g.label,R.cellRefNode(Ne,Ce,K);case p.NodeKind.FieldRef:var Le=g.lhs,Oe=g.rhs,le=g.shouldBeBracketed;return K=g.label,R.fieldRefNode(T(Le),Oe,le,K);case p.NodeKind.StructRef:return Le=g.lhs,Oe=g.rhs,K=g.label,R.structRefNode(Le,Oe,K);case p.NodeKind.Bad:switch(K=g.label,g.type){case p.BadType.Sequence:case p.BadType.StructRef:case p.BadType.FieldRef:return R.badSequenceNode(g.type,g.contents.map(T),K);default:return R.badStringNode(g.type,g.contents,K)}default:return(0,c.assertNever)("calc.lang.reduceBottomUp_Recursive",g)}};return A(P)}function L(R,P,A,T){var g=[],O=function(W){return g.push(W),M},M=function(){return g.length<P.length?A(R,P[g.length],O):T(g)};return M}function D(R,P,A){return L(R,P,Z,A)}function U(R,P,A,T){return function(){return P!==void 0?A(R,P,T):T(void 0)}}function V(R,P,A){var T=P.id,g=P.whole,O=P.label;return function(){return A(R.wsfNode(T,g,O))}}function ne(R,P,A){var T=P.name,g=P.binder;return Z(R,g.arg,function(O){return A((0,p.letVar)(T,(0,p.indexedArg)(O,g.index)))})}function J(R,P,A){var T=P.name,g=T.arg;return g.def===void 0?function(){return A((0,p.lambdaParam)(T))}:Z(R,g.def.rhs,function(O){return A((0,p.lambdaParam)((0,p.indexedArg)((0,p.paramNode)(g.name,(0,p.paramDefault)(O,g.def.label),g.label),T.index)))})}function $(R,P,A){var T=P.arg,g=P.index;return Z(R,T,function(O){return A((0,p.indexedArg)(O,g))})}function Z(R,P,A){switch(P.kind){case p.NodeKind.Literal:var T=P.oper,g=P.isClosed,O=P.label;return function(){return A(R.literalNode(T,g,O))};case p.NodeKind.Array:var M=P.nodes,K=P.isClosed,W=P.label;return L(R,M,D,function(Br){return A(R.arrayNode(Br,K,W))});case p.NodeKind.App:var z=P.head,ee=P.args,ue=P.isClosed,ce=P.label;return function(){return function(Br,bt,Kr){switch(bt.kind){case p.NodeKind.Operator:var Pt=bt.id,Mi=bt.label;return function(){return Kr(Br.operatorNode(Pt,Mi))};case p.NodeKind.WSF:return V(Br,bt,Kr);default:return Z(Br,bt,Kr)}}(R,z,function(Br){return D(R,ee,function(bt){return A(R.appNode(Br,bt,ue,ce))})})};case p.NodeKind.Let:var he=P.head,de=P.vars,pe=P.body,_e=P.badArgs,Ce=P.isClosed,Ne=P.label;return function(){return V(R,he,function(Br){return L(R,de,ne,function(bt){return U(R,pe,$,function(Kr){return L(R,_e,$,function(Pt){return A(R.letNode(Br,bt,Kr,Pt,Ce,Ne))})})})})};case p.NodeKind.Lambda:var Le=P.head,Oe=P.params,le=P.body,me=P.badArgs,Pe=P.isClosed,Re=P.label;return function(){return V(R,Le,function(Br){return function(){return L(R,Oe,J,function(bt){return U(R,le,$,function(Kr){return L(R,me,$,function(Pt){return A(R.lambdaNode(Br,bt,Kr,Pt,Pe,Re))})})})}})};case p.NodeKind.Paren:var fe=P.node,Se=P.isClosed,be=P.label;return function(){return Z(R,fe,function(Br){return function(){return A(R.parenNode(Br,Se,be))}})};case p.NodeKind.Name:var xe=P.parts,Ie=P.qualifier,Ve=P.label;return function(){return A(R.nameNode(xe,Ie,Ve))};case p.NodeKind.CellRef:var Ze=P.ref,gr=P.qualifier,cr=P.label;return function(){return A(R.cellRefNode(Ze,gr,cr))};case p.NodeKind.FieldRef:var _r=P.lhs,xr=P.rhs,Or=P.shouldBeBracketed,Rr=P.label;return function(){return Z(R,_r,function(Br){return function(){return A(R.fieldRefNode(Br,xr,Or,Rr))}})};case p.NodeKind.StructRef:var ir=P.lhs,$e=P.rhs,qe=P.label;return function(){return A(R.structRefNode(ir,$e,qe))};case p.NodeKind.Bad:var fr=P.label;switch(P.type){case p.BadType.Sequence:case p.BadType.StructRef:case p.BadType.FieldRef:var lr=P.type,dn=P.contents;return D(R,dn,function(Br){return A(R.badSequenceNode(lr,Br,fr))});default:var Un=P.type,Gr=P.contents;return function(){return A(R.badStringNode(Un,Gr,fr))}}default:return(0,c.assertNever)("calc.lang.reduceBottomUp_CPS",P)}}function ie(R,P){var A;return function(T){for(var g=T;g!=null;)g=g()}(Z(R,P,function(T){A=T})),A}t.ZipVisitor=G,t.zipVisitor=function(R){return y(new G(R))},t.reduceBottomUp_Recursive=H,t.reduceBottomUp_CPS=ie;var X=function(){function R(P){var A=this;this.visitor=P,this.visitFormulaNode=function(T){return m(A,T)},this.lazyVisitFormulaNode=function(T){return f.Pledge.resolve(T).bind(A.visitFormulaNode)},this.visitAppHeadNode=function(T){return S(A,T)},this.lazyVisitAppHeadNode=function(T){return f.Pledge.resolve(T).bind(A.visitAppHeadNode)},this.visitWSFNode=function(T){return h(A,T)},this.lazyVisitWSFNode=function(T){return f.Pledge.resolve(T).bind(A.visitWSFNode)},this.lazyVisitVar=function(T){var g=T.name,O=T.binder;return A.lazyVisitFormulaNode(O.arg).bind(function(M){return(0,p.letVar)(g,(0,p.indexedArg)(M,O.index))})},this.lazyVisitParam=function(T){var g=T.name,O=g.arg;return O.def===void 0?f.Pledge.resolve((0,p.lambdaParam)(g)):A.lazyVisitFormulaNode(O.def.rhs).bind(function(M){return(0,p.lambdaParam)((0,p.indexedArg)((0,p.paramNode)(O.name,(0,p.paramDefault)(M,O.def.label),O.label),g.index))})},this.lazyVisitIndexedArg=function(T){var g=T.arg,O=T.index;return A.lazyVisitFormulaNode(g).bind(function(M){return(0,p.indexedArg)(M,O)})}}return R.prototype.literalNode=function(P,A,T){var g=this;return f.Pledge.try(function(){return g.visitor.literalNode(P,A,T)})},R.prototype.arrayNode=function(P,A,T){var g=this;return f.Pledge.all(P.map(function(O){return f.Pledge.all(O.map(g.lazyVisitFormulaNode))})).bind(function(O){return g.visitor.arrayNode(O,A,T)})},R.prototype.appNode=function(P,A,T,g){var O=this;return this.lazyVisitAppHeadNode(P).bind(function(M){return f.Pledge.all(A.map(O.lazyVisitFormulaNode)).bind(function(K){return O.visitor.appNode(M,K,T,g)})})},R.prototype.letNode=function(P,A,T,g,O,M){var K=this;return this.lazyVisitWSFNode(P).bind(function(W){return f.Pledge.all(A.map(K.lazyVisitVar)).bind(function(z){return(T===void 0?f.Pledge.resolve(void 0):K.lazyVisitIndexedArg(T)).bind(function(ee){return f.Pledge.all(g.map(K.lazyVisitIndexedArg)).bind(function(ue){return K.visitor.letNode(W,z,ee,ue,O,M)})})})})},R.prototype.lambdaNode=function(P,A,T,g,O,M){var K=this;return this.lazyVisitWSFNode(P).bind(function(W){return f.Pledge.all(A.map(K.lazyVisitParam)).bind(function(z){return(T===void 0?f.Pledge.resolve(void 0):K.lazyVisitIndexedArg(T)).bind(function(ee){return f.Pledge.all(g.map(K.lazyVisitIndexedArg)).bind(function(ue){return K.visitor.lambdaNode(W,z,ee,ue,O,M)})})})})},R.prototype.parenNode=function(P,A,T){var g=this;return this.lazyVisitFormulaNode(P).bind(function(O){return g.visitor.parenNode(O,A,T)})},R.prototype.nameNode=function(P,A,T){var g=this;return f.Pledge.try(function(){return g.visitor.nameNode(P,A,T)})},R.prototype.cellRefNode=function(P,A,T){var g=this;return f.Pledge.try(function(){return g.visitor.cellRefNode(P,A,T)})},R.prototype.fieldRefNode=function(P,A,T,g){var O=this;return this.lazyVisitFormulaNode(P).bind(function(M){return O.visitor.fieldRefNode(M,A,T,g)})},R.prototype.structRefNode=function(P,A,T){var g=this;return f.Pledge.try(function(){return g.visitor.structRefNode(P,A,T)})},R.prototype.badSequenceNode=function(P,A,T){var g=this;return f.Pledge.all(A.map(this.lazyVisitFormulaNode)).bind(function(O){return g.visitor.badSequenceNode(P,O,T)})},R.prototype.badStringNode=function(P,A,T){var g=this;return f.Pledge.try(function(){return g.visitor.badStringNode(P,A,T)})},R.prototype.operatorNode=function(P,A){var T=this;return f.Pledge.try(function(){return T.visitor.operatorNode(P,A)})},R.prototype.wsfNode=function(P,A,T){var g=this;return f.Pledge.try(function(){return g.visitor.wsfNode(P,A,T)})},R}();function Q(R,P,A){return A<=50?H(R,P):ie(R,P)}function b(R,P){return f.Pledge.settleOrThrow(f.Pledge.resolve(m(R,P)))}t.PledgeReducer=X,t.reduceBottomUp_Pledge=function(R,P){return b(new X(R),P)},t.reduceBottomUp_MaxDepth=Q,t.reduceBottomUp=function(R,P){return Q(R,P.node,P.depthUpperBound)},t.reduceTopDown_Pledge=b,t.reducePledge=function(R,P){return b(R,P.node)}},3684:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0;var s=d(6059);function c(){return typeof __get_change_gate_dictionary_variable=="undefined"?{}:__get_change_gate_dictionary_variable()}t.getChangeGateDictionary=c,t.isChangeGateEnabled=function(l){var f;return(f=c()[l])===null||f===void 0||f},t.setChangeGateDictionaryGetter=function(l){var f=s.globalThis.__get_change_gate_dictionary_variable;return s.globalThis.__get_change_gate_dictionary_variable=l,f}},8830:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var s=d(6059),c={};function l(){return typeof __get_feature_gate_dictionary_variable=="undefined"?c:__get_feature_gate_dictionary_variable()}function f(p,m){var v;return(v=l()[p])!==null&&v!==void 0?v:m}t.getFeatureGateDictionary=l,t.getStringFeatureGate=f,t.getBooleanFeatureGate=function(p,m){var v,h=(v=f(p))===null||v===void 0?void 0:v.trim().toLowerCase();return h==="true"||h!=="false"&&m},t.getNumberFeatureGate=function(p,m){var v,h=(v=f(p))===null||v===void 0?void 0:v.trim().toLowerCase();if(h===void 0)return m;if(h==="infinity"||h==="+infinity")return 1/0;if(h==="-infinity")return-1/0;var S=parseFloat(h);return isNaN(S)?m:S},t.getIntFeatureGate=function(p,m){var v,h=(v=f(p))===null||v===void 0?void 0:v.trim();if(h===void 0)return m;var S=parseInt(h,10);return isNaN(S)?m:S},t.setFeatureGateDictionaryGetter=function(p){var m=s.globalThis.__get_feature_gate_dictionary_variable;return s.globalThis.__get_feature_gate_dictionary_variable=p,m}},6059:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThis=void 0;var s=d(7933);t.globalThis=s},9992:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=d(655);s.__exportStar(d(8830),t),s.__exportStar(d(3851),t),s.__exportStar(d(3684),t),s.__exportStar(d(3623),t),s.__exportStar(d(1352),t),s.__exportStar(d(5106),t)},3851:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var s=d(8830);t.makeGetTypedFeatureGate=function(c){return function(l){var f=c[l];switch(typeof f){case"boolean":return(0,s.getBooleanFeatureGate)(l,f);case"number":return(0,s.getNumberFeatureGate)(l,f);case"string":return(0,s.getStringFeatureGate)(l,f);default:throw new Error("Wrong defaultValue type")}}}},3623:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var s=d(3684);t.makeTypedIsChangeGateEnabled=function(c){return function(l){return(0,s.isChangeGateEnabled)(l)}}},1352:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var s=d(655),c=d(3684);function l(f){var p=(0,c.setChangeGateDictionaryGetter)(void 0);return(0,c.setChangeGateDictionaryGetter)(function(){var m=p!==void 0?p():{};return s.__assign(s.__assign({},m),f)}),p}t.overrideChangeGates=l,t.overrideTypedChangeGates=function(f,p){return l(p)}},5106:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var s=d(655),c=d(8830);function l(f){for(var p,m,v={},h=0,S=Object.keys(f);h<S.length;h++){var y=S[h];v[y]=(p=f[y])===null||p===void 0?void 0:p.toString()}var C=(m=(0,c.setFeatureGateDictionaryGetter)(void 0))!==null&&m!==void 0?m:function(){return{}};return(0,c.setFeatureGateDictionaryGetter)(function(){return s.__assign(s.__assign({},C()),v)}),C}t.overrideFeatureGates=l,t.overrideTypedFeatureGates=function(f,p){return l(p)}},4143:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createAnalyzer=void 0;var s=d(4063),c=d(2720),l=d(4319);t.createAnalyzer=function(f){return{checkFormula:function(m,v){return(0,s.checkFormula)(f,m,v)},checkFormulaWithDiagnostics:function(m,v){return(0,s.checkFormulaWithDiagnostics)(f,m,v)},autocorrectFormula:function(m,v){return(0,c.autocorrectFormula)(f,m,v)},resolveStaticPrecedents:function(m,v){return(0,l.resolveStaticPrecedents)(f,m,v)}}}},2720:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocorrectFormula=void 0;var s=d(9866),c=d(6982),l=d(4666),f=d(3357),p=d(7512),m=d(73),v=d(8449),h={getDocumentLoc:function(){return(0,l.assertFalse)("calc.analyze.autocorrectFormula: default getDocumentLoc")},getSheetIndex:function(){return(0,l.assertFalse)("calc.analyze.autocorrectFormula: default getSheetIndex")},getSheetName:function(){return(0,l.assertFalse)("calc.analyze.autocorrectFormula: default getSheetName")},getNameLoc:function(){return(0,l.assertFalse)("calc.analyze.autocorrectFormula: default getNameLoc")},getUserDefinedFuncLoc:function(){return(0,l.assertFalse)("calc.analyze.autocorrectFormula: default getUserDefinedFuncLoc")},getSheetRangeIndexes:function(){return(0,l.assertFalse)("calc.analyze.autocorrectFormula: default getSheetRangeIndexes")},getContainingTable:function(){return(0,l.assertFalse)("calc.analyze.autocorrectFormula: default getContainingTable")},getStructRefColumn:function(){return(0,l.assertFalse)("calc.analyze.autocorrectFormula: default getStructRefColumn")},getStructRefSpecialRef:function(){return(0,l.assertFalse)("calc.analyze.autocorrectFormula: default getStructRefSpecialRef")}},S=(0,c.createFailureErrorClass)("AutocorrectError"),y=_i(_i({},(0,p.binaryVisitor)((0,p.constVisitor)(!1),function(E,I){return E||I})),{badSequenceNode:function(I,F,w){return!0},badStringNode:function(I,F,w){return!0}}),C=function(E){Due(F,E);var I=xue(F);function F(w,B,k){var x;return Yg(this,F),x=I.call(this),x.f=k,x.seenUnclosed=!1,x.seenParen=!1,x.seenMissingOperand=!1,x.globals=function(G){var H,L,D,U,V,ne,J,$,Z,ie,X,Q,b,R,P,A,T,g;return{config:G.config,getDocumentLoc:(L=(H=G.getDocumentLoc)===null||H===void 0?void 0:H.bind(G))!==null&&L!==void 0?L:h.getDocumentLoc,getSheetIndex:(U=(D=G.getSheetIndex)===null||D===void 0?void 0:D.bind(G))!==null&&U!==void 0?U:h.getSheetIndex,getSheetName:(ne=(V=G.getSheetName)===null||V===void 0?void 0:V.bind(G))!==null&&ne!==void 0?ne:h.getSheetName,getNameLoc:($=(J=G.getNameLoc)===null||J===void 0?void 0:J.bind(G))!==null&&$!==void 0?$:h.getNameLoc,getUserDefinedFuncLoc:(ie=(Z=G.getUserDefinedFuncLoc)===null||Z===void 0?void 0:Z.bind(G))!==null&&ie!==void 0?ie:h.getUserDefinedFuncLoc,getSheetRangeIndexes:(Q=(X=G.getSheetRangeIndexes)===null||X===void 0?void 0:X.bind(G))!==null&&Q!==void 0?Q:h.getSheetRangeIndexes,getContainingTable:(R=(b=G.getContainingTable)===null||b===void 0?void 0:b.bind(G))!==null&&R!==void 0?R:h.getContainingTable,getStructRefColumn:(A=(P=G.getStructRefColumn)===null||P===void 0?void 0:P.bind(G))!==null&&A!==void 0?A:h.getStructRefColumn,getStructRefSpecialRef:(g=(T=G.getStructRefSpecialRef)===null||T===void 0?void 0:T.bind(G))!==null&&g!==void 0?g:h.getStructRefSpecialRef}}(w),x.locals=B,x.resolver=(0,v.createResolver)(x.globals),x}return Jg(F,[{key:"autocorrect",value:function(){return(0,p.reduceBottomUp)(y,this.f)?this.f.node:(0,p.reduceBottomUp)(this,this.f)}},{key:"literalNode",value:function(B,k,x){return k||(this.seenUnclosed=!0),(0,s.literalNode)(B,k,x)}},{key:"nameNode",value:function(B,k,x){var G=(0,s.nameNode)(B,k,x),H=(0,s.flattenNameParts)(B);if(H.kind===s.NamePartKind.CellRefNamePart){var L=this.resolver.resolveDottedName(this.locals,G,this.f.annotations),D=L.resolved;if(D.kind===m.ResolvedKind.ResolvedCellRef){var U=D.node,V=U.ref,ne=U.qualifier,J=U.label,$=this.cellRefNode(V,ne,J),Z=$.ref;(0,l.assertTrue)("calc.analyze.autocorrectFormula",H.kind===s.NamePartKind.CellRefNamePart);var ie=Cxe(H.parts),X=ie[0],Q=ie[1],b=ie.slice(2),R=function(A,T){var g=T.rhs,O=T.canDenoteNamedObject,M=T.label,K=T.qualifiedLabel;return(0,s.fieldRefNamePart)(A,g,O,M,K)};return(0,s.nameNode)(b.reduce(R,R((0,s.cellRefNamePart)(Z,X.asWhole,X.label,X.qualifiedLabel),Q)),k,J)}if(D.resolution.kind!==f.ResultKind.Success&&D.resolution.reason.kind!==m.ResolveReasonKind.NoOriginSheet&&D.resolution.reason.kind!==m.ResolveReasonKind.InvalidQualifier)throw new S(D.resolution.reason)}return G}},{key:"arrayNode",value:function(B,k,x){return k||(this.seenUnclosed=!0),(0,s.arrayNode)(B,k,x)}},{key:"appNode",value:function(B,k,x,G){var H=this.appNodeBase(B,x,G);return x||(this.seenUnclosed=!0),(0,c.isOperatorNode)(B)||(this.seenParen=!0),(0,c.isOperatorNode)(B)&&k.some(c.isMissingNode)&&(this.seenMissingOperand=!0),(0,s.appNode)(B,k,H,G)}},{key:"letNode",value:function(B,k,x,G,H,L){var D=this.appNodeBase(B,H,L);return H||(this.seenUnclosed=!0),this.seenParen=!0,(0,s.letNode)(B,k,x,G,D,L)}},{key:"lambdaNode",value:function(B,k,x,G,H,L){var D=this.appNodeBase(B,H,L);return H||(this.seenUnclosed=!0),this.seenParen=!0,(0,s.lambdaNode)(B,k,x,G,D,L)}},{key:"parenNode",value:function(B,k,x){return k||(this.seenUnclosed=!0),this.seenParen=!0,(0,s.parenNode)(B,k,x)}},{key:"cellRefNode",value:function(B,k,x){var G=this.globals.config.localeInfo;return B.isBracketed&&G.rcLeftBracket==="("&&(this.seenParen=!0),this.locals.allowUnqualifiedCell||k!==void 0?(0,s.cellRefNode)(B,k,x):(0,s.cellRefNode)(B,this.qualifyCellRef(),x)}},{key:"fieldRefNode",value:function(B,k,x,G){return k.isClosed||(this.seenUnclosed=!0),(0,s.fieldRefNode)(B,k,x,G)}},{key:"structRefNode",value:function(B,k,x){return k.isClosed||(this.seenUnclosed=!0),(0,s.structRefNode)(B,k,x)}},{key:"qualifyCellRef",value:function(){var B=this.locals.originSheet;if(!(0,f.isSuccess)(B))throw new S(B.reason);if(B.value.index!==void 0){var k=this.globals.getSheetName(B.value.document,B.value.index);if(!(0,f.isSuccess)(k))throw new S(k.reason);return(0,s.sheetQualifier)(k.value,void 0)}}},{key:"appNodeBase",value:function(B,k,x){return k||!(0,c.isOperatorNode)(B)&&this.isFormulaRoot(x)&&!this.seenParen&&!this.seenUnclosed&&!this.seenMissingOperand}},{key:"isFormulaRoot",value:function(B){var k;return((k=this.f.annotations[B])===null||k===void 0?void 0:k.kind)===s.AnnotationKind.FormulaRoot}}]),F}(p.IdentityVisitor);t.autocorrectFormula=function(E,I,F){try{var w=F.spans,B=F.annotations,k=F.depthUpperBound,x=new C(E,I,F).autocorrect();return(0,f.success)((0,s.formula)(x,w,B,k))}catch(G){return G instanceof S?(0,f.failure)(G.reason):(0,f.failure)((0,f.javaScriptError)(G))}}},4063:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkFormula=t.checkFormulaWithDiagnostics=void 0;var s=d(4666),c=d(2518),l=d(5761),f=d(3477),p=d(6982),m=d(6672),v=d(9866),h=d(5630),S=d(1416),y=d(3357),C=d(7082),E=d(869),I={};function F(b,R){return{context:b,result:R}}function w(b){return function(R){return R.kind===v.NodeKind.Literal&&b(R.oper)}}var B=w(p.isMissingOper),k=w(p.isNumberOper),x=m.OperKind.String|m.OperKind.Boolean|m.OperKind.Error,G=w(function(b){return(b.kind&x)!=0});function H(b,R,P){var A=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;A||(b.errorData=b.reportError(R,P,b.errorData))}function L(b,R){return R!==m.OperKind.Range||(b&m.OperKind.Range)!=0}function D(b,R){return E.Pledge.try(function(){switch(R.type){case v.BadType.Sequence:return H(b,R,l.baseErrors.Bad_node,R.contents.some(function(P){return P.kind===v.NodeKind.Bad})),E.Pledge.all(R.contents.map(function(P){return P.kind===v.NodeKind.Bad?D(b,P):Z(b,P)}));case v.BadType.StructRef:return H(b,R,l.baseErrors.Invalid_struct_ref_table_name);case v.BadType.FieldRef:return H(b,R,l.baseErrors.Unexpected_field_ref);case v.BadType.Unexpected:switch(R.contents){case")":return H(b,R,l.baseErrors.Unexpected_closing_paren);case b.localeInfo.rightBrace:return H(b,R,l.baseErrors.Unexpected_closing_brace);case b.localeInfo.rightBracket:return H(b,R,l.baseErrors.Unexpected_closing_bracket);case".":return H(b,R,l.baseErrors.Unexpected_dot);default:return H(b,R,{kind:l.SyntaxError.Unexpected_character,text:R.contents})}case v.BadType.NumberLiteral:return H(b,R,l.baseErrors.Invalid_number_literal);case v.BadType.StringLiteral:return H(b,R,l.baseErrors.Invalid_string_literal);case v.BadType.ErrorLiteral:return H(b,R,l.baseErrors.Invalid_error_literal);case v.BadType.FieldName:case v.BadType.ParamName:case v.BadType.Missing:return H(b,R,l.baseErrors.Bad_node);case v.BadType.Qualifier:return H(b,R,l.baseErrors.Invalid_qualifier);default:(0,s.assertNever)("calc.analyze.diagnoseBadNode",R)}})}function U(b,R){if(R.kind===v.NodeKind.Literal)switch(H(b,R,l.baseErrors.Unclosed_literal,R.isClosed),R.oper.kind){case m.OperKind.Number:case m.OperKind.Boolean:case m.OperKind.String:case m.OperKind.Error:return;default:return void H(b,R,l.baseErrors.Illegal_array_literal_element)}H(b,R,l.baseErrors.Illegal_array_literal_element)}function V(b,R,P,A){return E.Pledge.try(function(){if(b.earlyExit&&!b.isOk())throw I;return Z(b,R)}).bind(function(T){return L(T.result,P)||((0,s.assertTrue)("calc.analyze.checker.check: typeSource passed",A!==void 0),H(b,R,{kind:l.TypeError.Types_not_related,typeGiven:T.result,typeExpected:P,typeSource:A})),T.result=P,T})}function ne(b,R,P){if((0,p.isUnqualifiedNameNode)(P)&&P.parts.kind===v.NamePartKind.IdentNamePart){var A=(0,p.getBoundName)(b.localeInfo,P.whole);return H(b,P,l.baseErrors.Invalid_binder,A.indexOf(".")<0),H(b,P,l.baseErrors.Duplicate_binder,!R.contains(A)),R.setValue(A,!0)}return H(b,P,P.kind===v.NodeKind.Bad&&P.type===v.BadType.Missing?l.baseErrors.Missing_binder:l.baseErrors.Invalid_binder),R}var J=function(R){return R.args.length===0?R:R.args[R.args.length-1]};function $(b,R,P){return E.Pledge.try(function(){var A,T=(0,S.getWorksheetFuncType)(R),g=T.minArgs,O=T.maxArgs,M=T.headTypes,K=T.restTypes,W=T.tailTypes,z=T.flags,ee=P.args,ue=ee.length,ce=(0,p.getArguments)(P).length;if(H(b,P.head,l.baseErrors.Invalid_function_name,(z&m.FunctionFlags.OnlyParsedDuringLoad)==0||b.locals.workbookLoad),ce<g)switch(R){case S.WorksheetFuncId.IF:case S.WorksheetFuncId.LET:case S.WorksheetFuncId.LETREC:case S.WorksheetFuncId.LAMBDA:break;default:var he=ee[ue-1];H(b,he===void 0?P:he,{kind:l.TypeError.Insufficient_function_arguments,funcId:R,numArgsGiven:ce,numArgsExpected:g})}if(ce>O){var de=ee[ue-1];H(b,de===void 0?P:de,{kind:l.TypeError.Excess_function_arguments,funcId:R,numArgsGiven:ce,numArgsExpected:O})}else if(K.length>1&&ce>M.length+K.length){var pe=(ce-M.length)%K.length;pe>W.length&&H(b,J(P),{kind:l.TypeError.Insufficient_function_arguments,funcId:R,numArgsGiven:ce,numArgsExpected:ce+(K.length-pe)})}var _e=P.kind===v.NodeKind.App?(0,p.getArguments)(P).map(function(Ce,Ne){return V(b,Ce,(0,p.getArgType)(T,Ne,ce),{kind:l.TypeSourceKind.WSFArgument,head:R,argIndex:Ne,numArgsGiven:ce})}):[].concat(Pc(P.kind===v.NodeKind.Let?P.vars.map(function(Ce){var Ne=Ce.binder;return Ne.arg}):P.params.map(function(Ce){var Ne=Ce.name,Le;return(Le=Ne.arg.def)===null||Le===void 0?void 0:Le.rhs})),[(A=P.body)===null||A===void 0?void 0:A.arg]).filter(c.isDefined).map(function(Ce){return Z(b,Ce)});return E.Pledge.all(_e).bind(function(Ce){return function(Ne,Le,Oe){var le=(0,p.getArguments)(Oe).length;switch(Le){case S.WorksheetFuncId.IF:var me=Ne.locals.lexicalKind===C.LexicalKind.NameManager?1:2;return void(le<me&&H(Ne,J(Oe),{kind:l.TypeError.Insufficient_function_arguments,funcId:Le,numArgsGiven:le,numArgsExpected:me}));case S.WorksheetFuncId._UDF:return H(Ne,Oe,l.baseErrors.Unexpected_application_head);case S.WorksheetFuncId.LET:case S.WorksheetFuncId.LETREC:{(0,s.assertTrue)("calc.analyze.applySpecificWorksheetFunctionChecks",Oe.kind===v.NodeKind.Let);for(var Pe=f.RedBlackMapTree.create(Ne.localeInfo.stringCompareCI),Re=da(Oe.vars),fe;!(fe=Re()).done;){var Se=fe.value,be=Se.name;Pe=ne(Ne,Pe,be.arg)}for(var xe=da(Oe.badArgs),Ie;!(Ie=xe()).done;){var Ve=Ie.value;H(Ne,Ve.arg,l.baseErrors.Invalid_binder)}H(Ne,J(Oe),{kind:l.TypeError.Insufficient_function_arguments,funcId:Le,numArgsGiven:le,numArgsExpected:(0,c.fastMax)(3,le+1+le%2)},le>=3&&Oe.body!==void 0);break}case S.WorksheetFuncId.LAMBDA:{(0,s.assertTrue)("calc.analyze.applySpecificWorksheetFunctionChecks",Oe.kind===v.NodeKind.Lambda);for(var Ze=f.RedBlackMapTree.create(Ne.localeInfo.stringCompareCI),gr=!1,cr=da(Oe.params),_r;!(_r=cr()).done;){var xr=_r.value,Or=xr.name;H(Ne,Or.arg.name,l.baseErrors.Unclosed_bracket,Or.arg.name.isClosed),Or.arg.def!==void 0&&(H(Ne,Or.arg.name,l.baseErrors.Binder_requires_brackets,Or.arg.name.isBracketed),H(Ne,Or.arg.def.rhs,l.baseErrors.Missing_default_expression,!(0,p.isMissingNode)(Or.arg.def.rhs))),Or.arg.isOptional?gr=!0:H(Ne,Or.arg,l.baseErrors.Mandatory_binder_after_optional,!gr),Ze=ne(Ne,Ze,Or.arg.name.name)}for(var Rr=da(Oe.badArgs),ir;!(ir=Rr()).done;){var $e=ir.value;H(Ne,$e.arg,l.baseErrors.Invalid_binder)}H(Ne,J(Oe),{kind:l.TypeError.Insufficient_function_arguments,funcId:Le,numArgsGiven:le,numArgsExpected:le+1},le>=1&&Oe.body!==void 0),Oe.body!==void 0&&H(Ne,Oe.body.arg,l.baseErrors.Invalid_body,le===0||!(0,p.isMissingNode)(Oe.body.arg));break}}}(b,R,P),F(b,T.returnType)})})}function Z(b,R){return E.Pledge.try(function(){var P,A,T,g,O,M,K,W,z;if(b.earlyExit&&!b.isOk())throw I;switch(R.kind){case v.NodeKind.App:case v.NodeKind.Let:case v.NodeKind.Lambda:return function(de,pe){return E.Pledge.try(function(){if(H(de,pe,l.baseErrors.Unclosed_application,pe.isClosed),(0,p.isWSFNode)(pe.head))return $(de,pe.head.id,pe);var _e=pe,Ce=_e.args,Ne=Ce.length,Le=(0,p.getArguments)(_e).length;if((0,p.isOperatorNode)(pe.head))return function(Pe,Re,fe){return E.Pledge.try(function(){var Se=(0,S.getOperatorType)(Re.id),be=fe.length,xe=be===Se.minArgs;return H(Pe,Re,{kind:l.TypeError.Incorrect_number_of_operator_arguments,opId:Re.id},xe),E.Pledge.all(fe.map(function(Ie,Ve){return E.Pledge.try(function(){return B(Ie)&&(xe=!1,H(Pe,Ie,{kind:l.SyntaxError.Missing_operation_argument,opId:Re.id})),V(Pe,Ie,(0,p.getArgType)(Se,Ve,be),{kind:l.TypeSourceKind.OperatorArgument,head:Re.id,argIndex:Ve,numArgsGiven:be})})})).bind(function(Ie){return F(Pe,xe?Se.returnType:m.SignatureType.All)})})}(de,pe.head,Ce);var Oe=pe.head,le=Ce[Ne-1],me=(0,S.higherOrderFunctionType)().maxArgs-1;return Le>me&&H(de,le===void 0?pe:le,{kind:l.SyntaxError.Excess_higher_order_function_arguments,numArgsGiven:Le,numArgsExpected:me}),E.Pledge.all(Ce.map(function(Pe){return V(de,Pe,m.SignatureType.All,void 0)})).bind(function(Pe){return Z(de,Oe).bind(function(Re){return L(Re.result,m.OperKind.Range)||Re.result&(m.OperKind.Array|m.OperKind.Rich)||H(de,Oe,G(Oe)||Oe.kind===v.NodeKind.Array?l.baseErrors.Unexpected_application_head:l.baseErrors.Unexpected_application_head_with_fix),F(de,m.SignatureType.All)})})})}(b,R);case v.NodeKind.Array:return function(de,pe){return E.Pledge.try(function(){H(de,pe,l.baseErrors.Unclosed_array,pe.isClosed);var _e=pe.nodes.length>0&&!(pe.nodes.length===1&&pe.nodes[0].length===1&&(0,p.isMissingNode)(pe.nodes[0][0]));if(H(de,pe,l.baseErrors.Empty_array_literal,_e),!_e)return F(de,m.OperKind.Array);for(var Ce=pe.nodes[0].length,Ne=0;Ne<pe.nodes.length;Ne+=1){var Le=pe.nodes[Ne],Oe=Le.length;H(de,pe,l.baseErrors.Irregular_array_shape,Oe===Ce);for(var le=0;le<Oe;le+=1)U(de,Le[le])}return F(de,m.OperKind.Array)})}(b,R);case v.NodeKind.Bad:return D(b,R).bind(function(){return F(b,m.SignatureType.All)});case v.NodeKind.CellRef:return b.locals.allowRelativeQualifier||((P=R.qualifier)===null||P===void 0?void 0:P.kind)!==v.QualifierKind.Relative?b.locals.allowUnqualifiedCell||R.qualifier!==void 0?((A=R.qualifier)===null||A===void 0?void 0:A.kind)===v.QualifierKind.Document||((T=R.qualifier)===null||T===void 0?void 0:T.kind)===v.QualifierKind.Bad?(H(b,R,l.baseErrors.Invalid_qualifier),F(b,m.SignatureType.All)):R.ref.kind===v.CellRefKind.Bad?(H(b,R,l.baseErrors.Invalid_cell_ref),F(b,m.SignatureType.All)):F(b,m.OperKind.Range):(H(b,R,l.baseErrors.Invalid_unqualified_cell),F(b,m.SignatureType.All)):(H(b,R,l.baseErrors.Invalid_rel_sheet_qualifier_in_cell),F(b,m.SignatureType.All));case v.NodeKind.Literal:return H(b,R,l.baseErrors.Unclosed_literal,R.isClosed),(0,p.isErrorOper)(R.oper)&&H(b,R,l.baseErrors.Invalid_error_literal,!((z=R.oper.type)>h.ErrorType.GETTING_DATA&&z!==h.ErrorType.BUSY&&z!==h.ErrorType.EXTERNAL)),F(b,R.oper.kind|((0,p.isErrorOper)(R.oper)&&R.oper.type===h.ErrorType.REF?m.OperKind.Range:0));case v.NodeKind.Name:{if(!b.locals.allowRelativeQualifier&&((g=R.qualifier)===null||g===void 0?void 0:g.kind)===v.QualifierKind.Relative)return H(b,R,l.baseErrors.Invalid_rel_sheet_qualifier_in_name),F(b,m.SignatureType.All);if(!b.locals.workbookLoad&&((O=R.qualifier)===null||O===void 0?void 0:O.kind)===v.QualifierKind.Document&&!R.qualifier.isQuoted||((M=R.qualifier)===null||M===void 0?void 0:M.kind)===v.QualifierKind.SheetRange||((K=R.qualifier)===null||K===void 0?void 0:K.kind)===v.QualifierKind.Bad)return H(b,R,l.baseErrors.Invalid_qualifier),F(b,m.SignatureType.All);var ee=(0,v.flattenNameParts)(R.parts).parts,ue=b.annotations[ee[0].label],ce=b.annotations[R.label];return(ue==null?void 0:ue.kind)===v.AnnotationKind.LocalNameUse?H(b,R,l.baseErrors.Invalid_name,ee.every(function(de){var pe;return de.kind!==v.NamePartKind.FieldRefNamePart||((pe=de.rhs)===null||pe===void 0?void 0:pe.field.kind)===v.NodeKind.Name})):(ce==null?void 0:ce.kind)===v.AnnotationKind.LocalNameDecl||H(b,R,l.baseErrors.Invalid_name,ee.reduceRight(function(de,pe){var _e=de.anyCanDenoteNamedObject,Ce=de.rhsValid,Ne;return{anyCanDenoteNamedObject:_e||pe.canDenoteNamedObject&&Ce,rhsValid:Ce&&(pe.kind!==v.NamePartKind.FieldRefNamePart||((Ne=pe.rhs)===null||Ne===void 0?void 0:Ne.field.kind)===v.NodeKind.Name)}},{anyCanDenoteNamedObject:!1,rhsValid:!0}).anyCanDenoteNamedObject),F(b,m.SignatureType.All)}case v.NodeKind.Paren:return H(b,R,l.baseErrors.Unclosed_paren,R.isClosed),H(b,R,l.baseErrors.Empty_parenthesis,!B(R.node)),Z(b,R.node);case v.NodeKind.FieldRef:return H(b,R,l.baseErrors.Unclosed_bracket,R.rhs.isClosed),H(b,R,l.baseErrors.Unexpected_field_ref,!B(R.lhs)&&!k(R.lhs)),(0,p.isUnqualifiedNameNode)(R.rhs.field)||H(b,R.rhs.field,R.rhs.field.kind===v.NodeKind.Bad&&R.rhs.field.type===v.BadType.Missing?l.baseErrors.Missing_field_name:l.baseErrors.Invalid_field_name),Z(b,R.lhs).bind(function(de){return F(b,m.SignatureType.All)});case v.NodeKind.StructRef:if(H(b,R,l.baseErrors.Invalid_struct_ref_table_name,R.lhs===void 0&&b.locals.allowImplicitTable||((W=R.lhs)===null||W===void 0?void 0:W.kind)===v.NodeKind.Name&&R.lhs.parts.kind===v.NamePartKind.IdentNamePart&&R.lhs.parts.canDenoteNamedObject),R.rhs.innerRef!==void 0){H(b,R.rhs.innerRef,l.baseErrors.Invalid_struct_ref_comma_parts,R.rhs.innerRef.kind!==v.StructRefKind.CommaOpRef||(0,p.isCommaOpRefWellFormed)(R.rhs.innerRef));var he=function de(pe){switch(pe==null?void 0:pe.kind){case void 0:break;case v.StructRefKind.RangeOpRef:de(pe.lhs),de(pe.rhs);break;case v.StructRefKind.CommaOpRef:pe.refs.forEach(de);break;case v.StructRefKind.SpecialRef:case v.StructRefKind.ColumnRef:H(b,pe,l.baseErrors.Unclosed_bracket,pe.isClosed);break;case v.StructRefKind.ThisRowOpRef:de(pe.ref);break;case v.StructRefKind.MissingRef:H(b,pe,l.baseErrors.Invalid_struct_ref_missing_part);break;case v.StructRefKind.BadRef:H(b,pe,l.baseErrors.Unclosed_bracket,pe.isClosed),H(b,pe,l.baseErrors.Invalid_struct_ref_bad_part)}};he(R.rhs.innerRef)}return H(b,R,l.baseErrors.Unclosed_bracket,R.rhs.isClosed),(R.lhs===void 0?E.Pledge.resolve(void 0):Z(b,R.lhs)).bind(function(de){return F(b,m.SignatureType.All)});default:return(0,s.assertNever)("calc.analyze.checker.infer: unhandled formula case",R)}})}var ie={ok:!0,isOk:c.identity,collect:function(R,P,A){return!1}};function X(b,R,P,A){var T=P.annotations,g=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,O,M,K={globals:b,locals:R,localeInfo:(M=(O=R.config)===null||O===void 0?void 0:O.localeInfo)!==null&&M!==void 0?M:b.config.localeInfo,annotations:T,reportError:A.collect,isOk:function(){return A.isOk(K.errorData)},earlyExit:g,errorData:A.ok};return K}function Q(b,R){try{H(b,R.node,l.baseErrors.Empty_formula,!B(R.node));var P=E.Pledge.settleOrThrow(V(b,R.node,m.SignatureType.All,void 0));return function(A,T){var g=T.annotations[T.node.label];function O(K){for(var W=da(K),z;!(z=W()).done;){var ee=z.value;H(A,ee,l.baseErrors.Unclosed_comment,ee.isClosed)}}function M(K){var W=T.spans[K];W!=null&&(W.preComments&&O(W.preComments),W.postComments&&O(W.postComments))}(g==null?void 0:g.kind)===v.AnnotationKind.FormulaRoot&&g.syntaxFeatures!==void 0&&g.syntaxFeatures[v.SyntaxFeature.Comments]&&E.Pledge.settleOrThrow(function K(W){return E.Pledge.try(function(){switch(M(W.label),W.kind){case v.NodeKind.Literal:break;case v.NodeKind.App:case v.NodeKind.Let:case v.NodeKind.Lambda:return W.head.kind===v.NodeKind.Operator&&M(W.head.label),E.Pledge.all(W.args.map(K));case v.NodeKind.Array:return E.Pledge.all((0,c.safeConcat)([],W.nodes.map(function(z){return z.map(K)})));case v.NodeKind.Bad:if(typeof W.contents!="string")return E.Pledge.all(W.contents.map(K));break;case v.NodeKind.CellRef:case v.NodeKind.Name:W.qualifier&&M(W.qualifier.label);break;case v.NodeKind.Paren:return K(W.node);case v.NodeKind.FieldRef:return M(W.rhs.label),M(W.rhs.field.label),K(W.lhs);case v.NodeKind.StructRef:return W.lhs?K(W.lhs):void 0;case v.NodeKind.Param:if(M(W.name.label),M(W.name.name.label),W.def)return M(W.def.label),K(W.def.rhs);break;default:return(0,s.assertNever)("calc.analyze.checker.comments",W)}})}(T.node))}(b,R),P}catch(A){if(A===I)return F(b,m.SignatureType.All);throw A}}t.checkFormulaWithDiagnostics=function(b,R,P){try{var A=Q(X(b,R,P,{ok:void 0,isOk:function(g){return g===void 0},collect:function(g,O,M){var K,W=M??[];return((K=W[g.label])!==null&&K!==void 0?K:W[g.label]=[]).push(O),W}},!1),P).context.errorData;return(0,y.success)([_i(_i({},P),{isWellFormed:A===void 0}),A])}catch(T){return(0,y.failure)((0,y.javaScriptError)(T))}},t.checkFormula=function(b,R,P){try{var A=Q(X(b,R,P,ie),P).context.errorData;return(0,y.success)(_i(_i({},P),{isWellFormed:A}))}catch(T){return(0,y.failure)((0,y.javaScriptError)(T))}}},5761:function(u,t,d){"use strict";var s,c;Object.defineProperty(t,"__esModule",{value:!0}),t.convertDiagnosticToNLMessage=t.baseNLErrors=t.formatDiagnostic=t.baseErrors=t.TypeSourceKind=t.TypeError=t.SyntaxError=void 0;var l=d(4546),f=d(7081),p,m,v;(function(S){S.Unclosed_application="Unclosed_application",S.Unclosed_paren="Unclosed_paren",S.Unclosed_bracket="Unclosed_bracket",S.Unclosed_array="Unclosed_array",S.Unclosed_literal="Unclosed_literal",S.Unclosed_comment="Unclosed_comment",S.Invalid_number_literal="Invalid_number_literal",S.Invalid_string_literal="Invalid_string_literal",S.Invalid_error_literal="Invalid_error_literal",S.Invalid_function_name="Invalid_function_name",S.Invalid_name="Invalid_name",S.Illegal_array_literal_element="Illegal_array_literal_element",S.Empty_array_literal="Empty_array_literal",S.Irregular_array_shape="Irregular_array_shape",S.Empty_parenthesis="Empty_parenthesis",S.Missing_operation_argument="Missing_operation_argument",S.Bad_node="Bad_node",S.Invalid_qualifier="Invalid_qualifier",S.Invalid_cell_ref="Invalid_cell_ref",S.Invalid_binder="Invalid_binder",S.Missing_binder="Missing_binder",S.Duplicate_binder="Duplicate_binder",S.Invalid_body="Invalid_body",S.Mandatory_binder_after_optional="Mandatory_binder_after_optional",S.Missing_default_expression="Missing_default_expression",S.Binder_requires_brackets="Binder_requires_brackets",S.Invalid_field_name="Invalid_field_name",S.Missing_field_name="Missing_field_name",S.Empty_formula="Empty_formula",S.Invalid_rel_sheet_qualifier_in_cell="Invalid_rel_sheet_qualifier_in_cell",S.Invalid_rel_sheet_qualifier_in_name="Invalid_rel_sheet_qualifier_in_name",S.Invalid_unqualified_cell="Invalid_unqualified_cell",S.Unexpected_closing_paren="Unexpected_closing_paren",S.Unexpected_closing_brace="Unexpected_closing_brace",S.Unexpected_closing_bracket="Unexpected_closing_bracket",S.Unexpected_character="Unexpected_character",S.Unexpected_field_ref="Unexpected_field_ref",S.Unexpected_dot="Unexpected_dot",S.Invalid_struct_ref_table_name="Invalid_struct_ref_table_name",S.Invalid_struct_ref_comma_parts="Invalid_struct_ref_comma_parts",S.Invalid_struct_ref_missing_part="Invalid_struct_ref_missing_part",S.Invalid_struct_ref_bad_part="Invalid_struct_ref_bad_part",S.Excess_higher_order_function_arguments="Excess_higher_order_function_arguments"})(p=t.SyntaxError||(t.SyntaxError={})),function(S){S.Types_not_related="Types_not_related",S.Unexpected_application_head="Unexpected_application_head",S.Unexpected_application_head_with_fix="Unexpected_application_head_with_fix",S.Incorrect_number_of_operator_arguments="Incorrect_number_of_operator_arguments",S.Excess_function_arguments="Excess_function_arguments",S.Insufficient_function_arguments="Insufficient_function_arguments"}(m=t.TypeError||(t.TypeError={})),function(S){S.WSFArgument="WSFArgument",S.OperatorArgument="OperatorArgument"}(v=t.TypeSourceKind||(t.TypeSourceKind={})),t.baseErrors=(s={},Qe(s,p.Unclosed_application,{kind:p.Unclosed_application}),Qe(s,p.Unclosed_paren,{kind:p.Unclosed_paren}),Qe(s,p.Unclosed_bracket,{kind:p.Unclosed_bracket}),Qe(s,p.Unclosed_array,{kind:p.Unclosed_array}),Qe(s,p.Unclosed_literal,{kind:p.Unclosed_literal}),Qe(s,p.Unclosed_comment,{kind:p.Unclosed_comment}),Qe(s,p.Invalid_number_literal,{kind:p.Invalid_number_literal}),Qe(s,p.Invalid_string_literal,{kind:p.Invalid_string_literal}),Qe(s,p.Invalid_error_literal,{kind:p.Invalid_error_literal}),Qe(s,p.Invalid_function_name,{kind:p.Invalid_function_name}),Qe(s,p.Invalid_name,{kind:p.Invalid_name}),Qe(s,p.Illegal_array_literal_element,{kind:p.Illegal_array_literal_element}),Qe(s,p.Empty_array_literal,{kind:p.Empty_array_literal}),Qe(s,p.Irregular_array_shape,{kind:p.Irregular_array_shape}),Qe(s,p.Empty_parenthesis,{kind:p.Empty_parenthesis}),Qe(s,p.Bad_node,{kind:p.Bad_node}),Qe(s,p.Invalid_qualifier,{kind:p.Invalid_qualifier}),Qe(s,p.Invalid_cell_ref,{kind:p.Invalid_cell_ref}),Qe(s,p.Invalid_binder,{kind:p.Invalid_binder}),Qe(s,p.Missing_binder,{kind:p.Missing_binder}),Qe(s,p.Duplicate_binder,{kind:p.Duplicate_binder}),Qe(s,p.Invalid_body,{kind:p.Invalid_body}),Qe(s,p.Mandatory_binder_after_optional,{kind:p.Mandatory_binder_after_optional}),Qe(s,p.Missing_default_expression,{kind:p.Missing_default_expression}),Qe(s,p.Binder_requires_brackets,{kind:p.Binder_requires_brackets}),Qe(s,p.Invalid_field_name,{kind:p.Invalid_field_name}),Qe(s,p.Missing_field_name,{kind:p.Missing_field_name}),Qe(s,p.Empty_formula,{kind:p.Empty_formula}),Qe(s,p.Invalid_rel_sheet_qualifier_in_cell,{kind:p.Invalid_rel_sheet_qualifier_in_cell}),Qe(s,p.Invalid_rel_sheet_qualifier_in_name,{kind:p.Invalid_rel_sheet_qualifier_in_name}),Qe(s,p.Invalid_unqualified_cell,{kind:p.Invalid_unqualified_cell}),Qe(s,p.Unexpected_closing_paren,{kind:p.Unexpected_closing_paren}),Qe(s,p.Unexpected_closing_brace,{kind:p.Unexpected_closing_brace}),Qe(s,p.Unexpected_closing_bracket,{kind:p.Unexpected_closing_bracket}),Qe(s,p.Unexpected_field_ref,{kind:p.Unexpected_field_ref}),Qe(s,p.Unexpected_dot,{kind:p.Unexpected_dot}),Qe(s,p.Invalid_struct_ref_table_name,{kind:p.Invalid_struct_ref_table_name}),Qe(s,p.Invalid_struct_ref_comma_parts,{kind:p.Invalid_struct_ref_comma_parts}),Qe(s,p.Invalid_struct_ref_missing_part,{kind:p.Invalid_struct_ref_missing_part}),Qe(s,p.Invalid_struct_ref_bad_part,{kind:p.Invalid_struct_ref_bad_part}),Qe(s,m.Unexpected_application_head,{kind:m.Unexpected_application_head}),Qe(s,m.Unexpected_application_head_with_fix,{kind:m.Unexpected_application_head_with_fix}),s),t.formatDiagnostic=function(S){switch(S.kind){case m.Insufficient_function_arguments:case m.Excess_function_arguments:return S.kind+": "+(0,l.englishWorksheetFuncIdToName)(S.funcId);case p.Missing_operation_argument:case m.Incorrect_number_of_operator_arguments:return S.kind+": "+(0,l.englishOperatorIdToName)(S.opId);case p.Unexpected_character:return S.kind+": "+(0,f.anonymizeFormulaString)(S.text);case m.Types_not_related:return S.kind+": "+function(y){var C=y.kind,E=y.argIndex;switch(y.kind){case v.WSFArgument:return JSON.stringify({kind:C,head:(0,l.englishWorksheetFuncIdToName)(y.head),argIndex:E});case v.OperatorArgument:return JSON.stringify({kind:C,head:(0,l.englishOperatorIdToName)(y.head),argIndex:E})}}(S.typeSource);default:return S.kind}};var h="The formulas has an error";t.baseNLErrors=(c={},Qe(c,p.Unclosed_application,"The formula is missing a parenthesis"),Qe(c,p.Unclosed_paren,"The formula is missing a parenthesis"),Qe(c,p.Unclosed_bracket,"The formula is missing a bracket"),Qe(c,p.Unclosed_array,"The formula is missing a brace"),Qe(c,p.Unclosed_literal,"The formula is missing a quote"),Qe(c,p.Unclosed_comment,"The formula comment is missing an end"),Qe(c,p.Invalid_number_literal,"The formula has an invalid number"),Qe(c,p.Invalid_string_literal,"The formula has an invalid string"),Qe(c,p.Invalid_error_literal,"The formula has an invalid value"),Qe(c,p.Invalid_function_name,"The formula has an invalid function name"),Qe(c,p.Invalid_name,"The formula has an invalid name"),Qe(c,p.Illegal_array_literal_element,"The formula has an invalid value"),Qe(c,p.Empty_array_literal,"The formula has an empty array"),Qe(c,p.Irregular_array_shape,"The formula has an incorrectly shaped array"),Qe(c,p.Empty_parenthesis,"The formula is missing values between parentheses"),Qe(c,p.Missing_operation_argument,"The formula has an extra operator"),Qe(c,p.Bad_node,h),Qe(c,p.Invalid_qualifier,"The formula has an invalid sheet reference"),Qe(c,p.Invalid_cell_ref,"The formula has an invalid cell reference"),Qe(c,p.Invalid_binder,h),Qe(c,p.Missing_binder,h),Qe(c,p.Duplicate_binder,h),Qe(c,p.Invalid_body,h),Qe(c,p.Mandatory_binder_after_optional,h),Qe(c,p.Missing_default_expression,h),Qe(c,p.Binder_requires_brackets,h),Qe(c,p.Invalid_field_name,"The formula has an invalid field name"),Qe(c,p.Missing_field_name,"The formula is missing a field name"),Qe(c,p.Empty_formula,"The formula is empty"),Qe(c,p.Invalid_rel_sheet_qualifier_in_cell,"The formula has an incorrect reference"),Qe(c,p.Invalid_rel_sheet_qualifier_in_name,"The formula has an incorrect reference"),Qe(c,p.Invalid_unqualified_cell,"The formula has an incorrect reference"),Qe(c,p.Unexpected_closing_paren,"The formula has an extra parenthesis"),Qe(c,p.Unexpected_closing_brace,"The formula has an extra brace"),Qe(c,p.Unexpected_closing_bracket,"The formula has an extra bracket"),Qe(c,p.Unexpected_character,"The formula has some extra characters"),Qe(c,p.Unexpected_field_ref,"The formula has an extra field"),Qe(c,p.Unexpected_dot,"The formula has an extra dot"),Qe(c,p.Invalid_struct_ref_table_name,"The formula has a malformed table name in a structured reference"),Qe(c,p.Invalid_struct_ref_comma_parts,"The formula has a structured reference with commas that has issues between its brackets"),Qe(c,p.Invalid_struct_ref_missing_part,"The formula has a structured reference with missing references between its brackets"),Qe(c,p.Invalid_struct_ref_bad_part,"The formula has a bad reference in a structured reference"),Qe(c,p.Excess_higher_order_function_arguments,"The formula has a function call with too many arguments"),Qe(c,m.Types_not_related,"The formula has an operation using data that cannot be mixed together"),Qe(c,m.Unexpected_application_head,"The formula has a malformed function call"),Qe(c,m.Unexpected_application_head_with_fix,"The formula has a malformed function call"),Qe(c,m.Incorrect_number_of_operator_arguments,"The formula has an operation with the wrong number of arguments"),Qe(c,m.Excess_function_arguments,"The formula has a function call with too many arguments"),Qe(c,m.Insufficient_function_arguments,"The formula has a function call with missing arguments"),c),t.convertDiagnosticToNLMessage=function(S){return t.baseNLErrors[S.kind]}},4319:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveStaticPrecedents=void 0;var s=d(4666),c=d(2518),l=d(3357),f=d(9866),p=d(7082),m=d(8449),v=d(73),h=d(1416),S=d(6672),y=d(6982),C=d(5630),E=d(7512),I=d(9213),F={getDocumentLoc:function(){return(0,s.assertFalse)("calc.analyze.resolveStaticPrecedents: default getDocumentLoc")},getSheetIndex:function(){return(0,s.assertFalse)("calc.analyze.resolveStaticPrecedents: default getSheetIndex")},getSheetName:function(){return(0,s.assertFalse)("calc.analyze.resolveStaticPrecedents: default getSheetName")},getNameLoc:function(){return(0,s.assertFalse)("calc.analyze.resolveStaticPrecedents: default getNameLoc")},getUserDefinedFuncLoc:function(){return(0,s.assertFalse)("calc.analyze.resolveStaticPrecedents: default getUserDefinedFuncLoc")},getSheetRangeIndexes:function(){return(0,s.assertFalse)("calc.analyze.resolveStaticPrecedents: default getSheetRangeIndexes")},getContainingTable:function(){return(0,s.assertFalse)("calc.analyze.resolveStaticPrecedents: default getContainingTable")},getStructRefColumn:function(){return(0,s.assertFalse)("calc.analyze.resolveStaticPrecedents: default getStructRefColumn")},getStructRefSpecialRef:function(){return(0,s.assertFalse)("calc.analyze.resolveStaticPrecedents: default getStructRefSpecialRef")}},w=(0,y.createFailureErrorClass)("ResolveStaticPrecedentsError"),B=function(k){Due(G,k);var x=xue(G);function G(H,L,D){var U;return Yg(this,G),U=x.call(this),U.locals=L,U.annotations=D,U.cells=[],U.names=[],U.udfs=[],U.nameSpecial=S.SpecialPrecs.None,U.ownSpecial=S.SpecialPrecs.None,U.resolutions=[],U.globals=function(V){var ne,J,$,Z,ie,X,Q,b,R,P,A,T,g,O,M,K,W,z;return{config:V.config,getDocumentLoc:(J=(ne=V.getDocumentLoc)===null||ne===void 0?void 0:ne.bind(V))!==null&&J!==void 0?J:F.getDocumentLoc,getSheetIndex:(Z=($=V.getSheetIndex)===null||$===void 0?void 0:$.bind(V))!==null&&Z!==void 0?Z:F.getSheetIndex,getSheetName:(X=(ie=V.getSheetName)===null||ie===void 0?void 0:ie.bind(V))!==null&&X!==void 0?X:F.getSheetName,getNameLoc:(b=(Q=V.getNameLoc)===null||Q===void 0?void 0:Q.bind(V))!==null&&b!==void 0?b:F.getNameLoc,getUserDefinedFuncLoc:(P=(R=V.getUserDefinedFuncLoc)===null||R===void 0?void 0:R.bind(V))!==null&&P!==void 0?P:F.getUserDefinedFuncLoc,getSheetRangeIndexes:(T=(A=V.getSheetRangeIndexes)===null||A===void 0?void 0:A.bind(V))!==null&&T!==void 0?T:F.getSheetRangeIndexes,getContainingTable:(O=(g=V.getContainingTable)===null||g===void 0?void 0:g.bind(V))!==null&&O!==void 0?O:F.getContainingTable,getStructRefColumn:(K=(M=V.getStructRefColumn)===null||M===void 0?void 0:M.bind(V))!==null&&K!==void 0?K:F.getStructRefColumn,getStructRefSpecialRef:(z=(W=V.getStructRefSpecialRef)===null||W===void 0?void 0:W.bind(V))!==null&&z!==void 0?z:F.getStructRefSpecialRef}}(H),U.resolver=(0,m.createResolver)(U.globals),U}return Jg(G,[{key:"appNode",value:function(L,D,U,V){var ne=this;if(L.kind===f.NodeKind.WSF){var J=L.id,$=(0,h.getWorksheetFuncType)(J).staticPrecs;switch(J){case h.WorksheetFuncId.LOOKUP:case h.WorksheetFuncId.SUMIF:case h.WorksheetFuncId.AVERAGEIF:var Z=function(Q){var b=Q.label,R=ne.resolutions[b],P=(R==null?void 0:R.kind)===v.ResolvedKind.ResolvedCellRef||(R==null?void 0:R.kind)===v.ResolvedKind.ResolvedStructRef?R.resolution:void 0;return(P==null?void 0:P.kind)===l.ResultKind.Success?P.value:void 0},ie=function(Q,b){var R=Z(Q),P=Z(b);return R!==void 0&&P!==void 0&&(0,p.isSheetGridRange)(R)&&(0,p.isSheetGridRange)(P)&&(0,y.isDocumentLocEqual)(R.sheet.document,P.sheet.document)&&R.range.rows===P.range.rows&&R.range.cols===P.range.cols};(D.length<3||D[2].kind===f.NodeKind.Literal||D[2].kind===f.NodeKind.Array||ie(D[2],J===h.WorksheetFuncId.LOOKUP?D[1]:D[0]))&&($&=~S.SpecialPrecs.AllCells)}$!==S.SpecialPrecs.None&&(this.ownSpecial|=$)}return mW(aI(G.prototype),"appNode",this).call(this,L,D,U,V)}},{key:"nameNode",value:function(L,D,U){var V=this.resolver.resolveDottedName(this.locals,(0,f.nameNode)(L,D,U),this.annotations);this.resolutions[U]=V,(0,c.safePush)(this.names,V.precedents.names),(0,c.safePush)(this.udfs,V.precedents.udfs);var ne=V.resolved;switch(ne.kind){case v.ResolvedKind.ResolvedName:if(!(0,l.isSuccess)(ne.resolution)){this.handleResolutionError(ne.resolution.reason);break}ne.resolution.value!==void 0&&(this.nameSpecial|=S.SpecialPrecs.All);break;case v.ResolvedKind.ResolvedUserDefinedFunc:if(!(0,l.isSuccess)(ne.resolution)){this.handleResolutionError(ne.resolution.reason);break}break;case v.ResolvedKind.ResolvedCellRef:this.pushResolvedGridRef(ne.resolution)}return mW(aI(G.prototype),"nameNode",this).call(this,L,D,U)}},{key:"cellRefNode",value:function(L,D,U){var V=this.resolver.resolveCellRef(this.locals,(0,f.cellRefNode)(L,D,U));this.resolutions[U]=V;var ne=V.resolution;return this.pushResolvedGridRef(ne),mW(aI(G.prototype),"cellRefNode",this).call(this,L,D,U)}},{key:"structRefNode",value:function(L,D,U){var V=this.resolver.resolveStructRef(this.locals,(0,f.structRefNode)(L,D,U));this.resolutions[U]=V,(0,c.safePush)(this.names,V.precedents);var ne=V.resolution;return this.pushResolvedGridRef(ne),mW(aI(G.prototype),"structRefNode",this).call(this,L,D,U)}},{key:"pushResolvedGridRef",value:function(L){if(L.kind!==l.ResultKind.Success)return this.handleResolutionError(L.reason);if(L.value!==void 0){var D=L.value;if((0,p.isSheetGridRange)(D))this.cells.push(D);else{this.ownSpecial|=S.SpecialPrecs.OwnDocSheets;var U=this.globals.getSheetRangeIndexes(D.sheet);if(!(0,l.isSuccess)(U))throw new w(U.reason);(0,c.safePush)(this.cells,U.value.sheets.map(function(V){return(0,p.sheetGridRange)((0,p.sheetIndex)(D.sheet.document,V),D.range)}))}}}},{key:"handleResolutionError",value:function(L){switch(L.kind){case v.ResolveReasonKind.NoOriginSheet:case v.ResolveReasonKind.InvalidStructRef:case v.ResolveReasonKind.InvalidCellRef:case v.ResolveReasonKind.InvalidQualifier:case v.ResolveReasonKind.EmptyIntersection:return}throw new w(L)}}]),G}(E.IdentityVisitor);t.resolveStaticPrecedents=function(k,x,G){try{var H=new B(k,x,G.annotations);return(0,E.reduceBottomUp)(H,G),(0,l.success)((0,I.staticPrecedents)(H.cells,H.names,H.udfs,H.nameSpecial|H.ownSpecial,H.ownSpecial,C.PrecsBound.Upper,H.resolutions))}catch(L){return L instanceof w?(0,l.failure)(L.reason):(0,l.failure)((0,l.javaScriptError)(L))}}},9213:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.analyzeLocalsName=t.analyzeLocalsGrid=t.createAnalyzeGlobals=t.staticPrecedents=t.summarizeFormulaDiagnostics=t.diagnostics=void 0;var s=d(7082),c=d(5761);t.diagnostics=c;var l=d(3357);t.summarizeFormulaDiagnostics=function(f){if(f!==void 0){var p={};return Object.keys(f).forEach(function(m){f[Number(m)].forEach(function(v){var h,S=c.formatDiagnostic(v);p[S]=((h=p[S])!==null&&h!==void 0?h:0)+1})}),p}},t.staticPrecedents=function(f,p,m,v,h,S,y){return{cells:f,names:p,udfs:m,special:v,ownSpecial:h,bound:S,resolutions:y}},t.createAnalyzeGlobals=function(f,p){return{config:f,getSheetName:p}},t.analyzeLocalsGrid=function(f,p,m){var v=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return{config:m??void 0,lexicalKind:f,originGridCell:(0,l.success)(p.range),originSheet:(0,l.success)(p.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!0,wrapCellReferences:!1,workbookLoad:v}},t.analyzeLocalsName=function(f,p){var m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return{config:p??void 0,lexicalKind:s.LexicalKind.NameManager,originGridCell:(0,l.success)(f.range),originSheet:(0,l.success)(f.sheet),allowRelativeQualifier:!0,allowUnqualifiedCell:!1,allowImplicitTable:!1,wrapCellReferences:!0,workbookLoad:m}}},7081:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.kindAnonymizers=t.anonymizeMagnitude=t.anonymizeFormulaString=t.anonymize=void 0;var s=d(637);t.anonymize=s.anonymizer.anonymize,t.anonymizeFormulaString=s.anonymizer.anonymizeFormulaString,t.anonymizeMagnitude=s.anonymizer.anonymizeMagnitude,t.kindAnonymizers=s.anonymizer.kindAnonymizers},4666:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertPositiveInteger=t.assertInteger=t.assertIndex=t.assertNatural=t.assertNever=t.assertFalse=t.assertTrue=t.ulsLogger=void 0;var s=d(637);t.ulsLogger=s.assertions.ulsLogger,t.assertTrue=s.assertions.assertTrue,t.assertFalse=s.assertions.assertFalse,t.assertNever=s.assertions.assertNever,t.assertNatural=s.assertions.assertNatural,t.assertIndex=s.assertions.assertIndex,t.assertInteger=s.assertions.assertInteger,t.assertPositiveInteger=s.assertions.assertPositiveInteger,t.assertPositiveLength=s.assertions.assertPositiveLength},3206:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codePointExclamationMark=t.codePointEuroSign=t.codePointEqualsSign=t.codePointDoubleQuote=t.codePointDollarSign=t.codePointDigitZero=t.codePointDigitTwo=t.codePointDigitThree=t.codePointDigitSix=t.codePointDigitSeven=t.codePointDigitOne=t.codePointDigitNine=t.codePointDigitFour=t.codePointDigitFive=t.codePointDigitEight=t.codePointComma=t.codePointColon=t.codePointCircumflexAccent=t.codePointCapitalZ=t.codePointCapitalY=t.codePointCapitalX=t.codePointCapitalW=t.codePointCapitalV=t.codePointCapitalU=t.codePointCapitalT=t.codePointCapitalS=t.codePointCapitalR=t.codePointCapitalQ=t.codePointCapitalP=t.codePointCapitalO=t.codePointCapitalN=t.codePointCapitalM=t.codePointCapitalL=t.codePointCapitalK=t.codePointCapitalJ=t.codePointCapitalI=t.codePointCapitalH=t.codePointCapitalG=t.codePointCapitalF=t.codePointCapitalE=t.codePointCapitalD=t.codePointCapitalC=t.codePointCapitalB=t.codePointCapitalA=t.codePointCR=t.codePointBacktick=t.codePointBackslash=t.codePointAtSign=t.codePointAsterisk=t.codePointAmpersand=void 0,t.codePointSmallW=t.codePointSmallV=t.codePointSmallU=t.codePointSmallT=t.codePointSmallS=t.codePointSmallR=t.codePointSmallQ=t.codePointSmallP=t.codePointSmallO=t.codePointSmallN=t.codePointSmallM=t.codePointSmallL=t.codePointSmallK=t.codePointSmallJ=t.codePointSmallI=t.codePointSmallH=t.codePointSmallG=t.codePointSmallF=t.codePointSmallE=t.codePointSmallD=t.codePointSmallC=t.codePointSmallB=t.codePointSmallA=t.codePointSlash=t.codePointSingleQuote=t.codePointSemicolon=t.codePointRightSquareBracket=t.codePointRightParen=t.codePointRightCurlyBracket=t.codePointQuestionMark=t.codePointPlusSign=t.codePointPipe=t.codePointPercentSign=t.codePointMinusSign=t.codePointLessThanSign=t.codePointLeftSquareBracket=t.codePointLeftParen=t.codePointLeftCurlyBracket=t.codePointLF=t.codePointInvertedQuestionMark=t.codePointInvertedExclamationMark=t.codePointHash=t.codePointGreaterThanSign=t.codePointFullwidthLatinSmallZ=t.codePointFullwidthLatinSmallA=t.codePointFullwidthLatinCapitalZ=t.codePointFullwidthLatinCapitalA=t.codePointFullwidthDigitZero=t.codePointFullwidthDigitNine=t.codePointFullStop=void 0,t.codePointRightSingleQuotationMark=t.codePointLeftSingleQuotationMark=t.codePointUnderscore=t.codePointTilde=t.codePointThaiDigitZero=t.codePointThaiDigitNine=t.codePointTab=t.codePointSpace=t.codePointSmallZ=t.codePointSmallY=t.codePointSmallX=void 0;var s=d(637);t.codePointAmpersand=s.codePoint.codePointAmpersand,t.codePointAsterisk=s.codePoint.codePointAsterisk,t.codePointAtSign=s.codePoint.codePointAtSign,t.codePointBackslash=s.codePoint.codePointBackslash,t.codePointBacktick=s.codePoint.codePointBacktick,t.codePointCR=s.codePoint.codePointCR,t.codePointCapitalA=s.codePoint.codePointCapitalA,t.codePointCapitalB=s.codePoint.codePointCapitalB,t.codePointCapitalC=s.codePoint.codePointCapitalC,t.codePointCapitalD=s.codePoint.codePointCapitalD,t.codePointCapitalE=s.codePoint.codePointCapitalE,t.codePointCapitalF=s.codePoint.codePointCapitalF,t.codePointCapitalG=s.codePoint.codePointCapitalG,t.codePointCapitalH=s.codePoint.codePointCapitalH,t.codePointCapitalI=s.codePoint.codePointCapitalI,t.codePointCapitalJ=s.codePoint.codePointCapitalJ,t.codePointCapitalK=s.codePoint.codePointCapitalK,t.codePointCapitalL=s.codePoint.codePointCapitalL,t.codePointCapitalM=s.codePoint.codePointCapitalM,t.codePointCapitalN=s.codePoint.codePointCapitalN,t.codePointCapitalO=s.codePoint.codePointCapitalO,t.codePointCapitalP=s.codePoint.codePointCapitalP,t.codePointCapitalQ=s.codePoint.codePointCapitalQ,t.codePointCapitalR=s.codePoint.codePointCapitalR,t.codePointCapitalS=s.codePoint.codePointCapitalS,t.codePointCapitalT=s.codePoint.codePointCapitalT,t.codePointCapitalU=s.codePoint.codePointCapitalU,t.codePointCapitalV=s.codePoint.codePointCapitalV,t.codePointCapitalW=s.codePoint.codePointCapitalW,t.codePointCapitalX=s.codePoint.codePointCapitalX,t.codePointCapitalY=s.codePoint.codePointCapitalY,t.codePointCapitalZ=s.codePoint.codePointCapitalZ,t.codePointCircumflexAccent=s.codePoint.codePointCircumflexAccent,t.codePointColon=s.codePoint.codePointColon,t.codePointComma=s.codePoint.codePointComma,t.codePointDigitEight=s.codePoint.codePointDigitEight,t.codePointDigitFive=s.codePoint.codePointDigitFive,t.codePointDigitFour=s.codePoint.codePointDigitFour,t.codePointDigitNine=s.codePoint.codePointDigitNine,t.codePointDigitOne=s.codePoint.codePointDigitOne,t.codePointDigitSeven=s.codePoint.codePointDigitSeven,t.codePointDigitSix=s.codePoint.codePointDigitSix,t.codePointDigitThree=s.codePoint.codePointDigitThree,t.codePointDigitTwo=s.codePoint.codePointDigitTwo,t.codePointDigitZero=s.codePoint.codePointDigitZero,t.codePointDollarSign=s.codePoint.codePointDollarSign,t.codePointDoubleQuote=s.codePoint.codePointDoubleQuote,t.codePointEqualsSign=s.codePoint.codePointEqualsSign,t.codePointEuroSign=s.codePoint.codePointEuroSign,t.codePointExclamationMark=s.codePoint.codePointExclamationMark,t.codePointFullStop=s.codePoint.codePointFullStop,t.codePointFullwidthDigitNine=s.codePoint.codePointFullwidthDigitNine,t.codePointFullwidthDigitZero=s.codePoint.codePointFullwidthDigitZero,t.codePointFullwidthLatinCapitalA=s.codePoint.codePointFullwidthLatinCapitalA,t.codePointFullwidthLatinCapitalZ=s.codePoint.codePointFullwidthLatinCapitalZ,t.codePointFullwidthLatinSmallA=s.codePoint.codePointFullwidthLatinSmallA,t.codePointFullwidthLatinSmallZ=s.codePoint.codePointFullwidthLatinSmallZ,t.codePointGreaterThanSign=s.codePoint.codePointGreaterThanSign,t.codePointHash=s.codePoint.codePointHash,t.codePointInvertedExclamationMark=s.codePoint.codePointInvertedExclamationMark,t.codePointInvertedQuestionMark=s.codePoint.codePointInvertedQuestionMark,t.codePointLF=s.codePoint.codePointLF,t.codePointLeftCurlyBracket=s.codePoint.codePointLeftCurlyBracket,t.codePointLeftParen=s.codePoint.codePointLeftParen,t.codePointLeftSquareBracket=s.codePoint.codePointLeftSquareBracket,t.codePointLessThanSign=s.codePoint.codePointLessThanSign,t.codePointMinusSign=s.codePoint.codePointMinusSign,t.codePointPercentSign=s.codePoint.codePointPercentSign,t.codePointPipe=s.codePoint.codePointPipe,t.codePointPlusSign=s.codePoint.codePointPlusSign,t.codePointQuestionMark=s.codePoint.codePointQuestionMark,t.codePointRightCurlyBracket=s.codePoint.codePointRightCurlyBracket,t.codePointRightParen=s.codePoint.codePointRightParen,t.codePointRightSquareBracket=s.codePoint.codePointRightSquareBracket,t.codePointSemicolon=s.codePoint.codePointSemicolon,t.codePointSingleQuote=s.codePoint.codePointSingleQuote,t.codePointSlash=s.codePoint.codePointSlash,t.codePointSmallA=s.codePoint.codePointSmallA,t.codePointSmallB=s.codePoint.codePointSmallB,t.codePointSmallC=s.codePoint.codePointSmallC,t.codePointSmallD=s.codePoint.codePointSmallD,t.codePointSmallE=s.codePoint.codePointSmallE,t.codePointSmallF=s.codePoint.codePointSmallF,t.codePointSmallG=s.codePoint.codePointSmallG,t.codePointSmallH=s.codePoint.codePointSmallH,t.codePointSmallI=s.codePoint.codePointSmallI,t.codePointSmallJ=s.codePoint.codePointSmallJ,t.codePointSmallK=s.codePoint.codePointSmallK,t.codePointSmallL=s.codePoint.codePointSmallL,t.codePointSmallM=s.codePoint.codePointSmallM,t.codePointSmallN=s.codePoint.codePointSmallN,t.codePointSmallO=s.codePoint.codePointSmallO,t.codePointSmallP=s.codePoint.codePointSmallP,t.codePointSmallQ=s.codePoint.codePointSmallQ,t.codePointSmallR=s.codePoint.codePointSmallR,t.codePointSmallS=s.codePoint.codePointSmallS,t.codePointSmallT=s.codePoint.codePointSmallT,t.codePointSmallU=s.codePoint.codePointSmallU,t.codePointSmallV=s.codePoint.codePointSmallV,t.codePointSmallW=s.codePoint.codePointSmallW,t.codePointSmallX=s.codePoint.codePointSmallX,t.codePointSmallY=s.codePoint.codePointSmallY,t.codePointSmallZ=s.codePoint.codePointSmallZ,t.codePointSpace=s.codePoint.codePointSpace,t.codePointTab=s.codePoint.codePointTab,t.codePointThaiDigitNine=s.codePoint.codePointThaiDigitNine,t.codePointThaiDigitZero=s.codePoint.codePointThaiDigitZero,t.codePointTilde=s.codePoint.codePointTilde,t.codePointUnderscore=s.codePoint.codePointUnderscore,t.codePointLeftSingleQuotationMark=s.codePoint.codePointLeftSingleQuotationMark,t.codePointRightSingleQuotationMark=s.codePoint.codePointRightSingleQuotationMark},2518:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.now=t.mapFromArrayOfPairs=t.singleton=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0;var s=d(637);t.makeNewtypeIso=s.core.makeNewtypeIso,t.staticAssertExtends=s.core.staticAssertExtends,t.staticAssertSame=s.core.staticAssertSame,t.staticAssertIs=s.core.staticAssertIs,t.staticAssertIsOptional=s.core.staticAssertIsOptional,t.identity=s.core.identity,t.makeStringMap=s.core.makeStringMap,t.cloneStringMap=s.core.cloneStringMap,t.numEnumArray=s.core.numEnumArray,t.numEnumMap=s.core.numEnumMap,t.strEnumArray=s.core.strEnumArray,t.safePush=s.core.safePush,t.safeConcat=s.core.safeConcat,t.isDefined=s.core.isDefined,t.isNone=s.core.isNone,t.filterOutNones=s.core.filterOutNones,t.pair=s.core.pair,t.fastMin=s.core.fastMin,t.fastMax=s.core.fastMax,t.fastAbs=s.core.fastAbs,t.makeStringCompareCI=s.core.makeStringCompareCI,t.typedInstanceCreator=s.core.typedInstanceCreator,t.singleton=s.core.singleton,t.mapFromArrayOfPairs=s.core.mapFromArrayOfPairs,t.now=s.core.now},3477:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RedBlackMapTree=void 0;var s=d(637);t.RedBlackMapTree=s.rbMapTree.RedBlackMapTree},719:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.isTypedChangeGateEnabled=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;var s=d(637);t.FeatureName=s.featureConfiguration.FeatureName,t.initFeatureConfiguration=s.featureConfiguration.initFeatureConfiguration,t.isFeatureEnabled=s.featureConfiguration.isFeatureEnabled,t.getFeatures=s.featureConfiguration.getFeatures,t.getTypedFeatureGate=s.featureConfiguration.getTypedFeatureGate,t.isTypedChangeGateEnabled=s.featureConfiguration.isTypedChangeGateEnabled;var c=d(1292);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return c.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return c.setFeatureGateDictionaryGetter}})},3357:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.successUndefined=t.success=t.javaScriptError=t.isSuccess=t.failure=t.ResultKind=t.ReasonKind=void 0;var s=d(637);t.ReasonKind=s.result.ReasonKind,t.ResultKind=s.result.ResultKind,t.failure=s.result.failure,t.isSuccess=s.result.isSuccess,t.javaScriptError=s.result.javaScriptError,t.success=s.result.success,t.successUndefined=s.result.successUndefined},869:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pledge=void 0;var s=d(637);t.Pledge=s.pledge.Pledge},2636:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.surrogatePairToCodePoint=t.stringFromCodePoint=t.stringCodePointAt=t.scanCodePointsBack=t.scanCodePoints=t.numCodeUnits=t.makeGetCharCodeBits=t.isLowSurrogate=t.isHighSurrogate=t.isAnySurrogate=t.forEachClassInterval=t.countCodePoints=t.codePointIterator=t.CharCodeBits=void 0;var s=d(637);t.CharCodeBits=s.unicode.CharCodeBits,t.codePointIterator=s.unicode.codePointIterator,t.countCodePoints=s.unicode.countCodePoints,t.forEachClassInterval=s.unicode.forEachClassInterval,t.isAnySurrogate=s.unicode.isAnySurrogate,t.isHighSurrogate=s.unicode.isHighSurrogate,t.isLowSurrogate=s.unicode.isLowSurrogate,t.makeGetCharCodeBits=s.unicode.makeGetCharCodeBits,t.numCodeUnits=s.unicode.numCodeUnits,t.scanCodePoints=s.unicode.scanCodePoints,t.scanCodePointsBack=s.unicode.scanCodePointsBack,t.stringCodePointAt=s.unicode.stringCodePointAt,t.stringFromCodePoint=s.unicode.stringFromCodePoint,t.surrogatePairToCodePoint=s.unicode.surrogatePairToCodePoint},327:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.stringStartsWith=t.stringEndsWith=t.repeat=t.prependErrorMessage=t.partialArray=t.messageFromError=t.mathLog2=t.isInteger=t.arrayFill=void 0;var s=d(637);t.arrayFill=s.util.arrayFill,t.isInteger=s.util.isInteger,t.mathLog2=s.util.mathLog2,t.messageFromError=s.util.messageFromError,t.partialArray=s.util.partialArray,t.prependErrorMessage=s.util.prependErrorMessage,t.repeat=s.util.repeat,t.stringEndsWith=s.util.stringEndsWith,t.stringStartsWith=s.util.stringStartsWith,t.values=s.util.values},5815:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildAnnotations=void 0;var s=d(9860);t.buildAnnotations=s.annotations.buildAnnotations},8952:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldQuoteQualifier=t.resolvePosition=t.quoteQualifier=t.formatRowRange=t.formatRow=t.formatRangePos=t.formatQualifier=t.formatGridRange=t.formatColRange=t.formatCol=t.formatCellPos=t.columnName=t.canonicaliseRowRange=t.canonicaliseRow=t.canonicaliseRangePos=t.canonicaliseColRange=t.canonicaliseCol=t.canonicaliseCellPos=t.canonicaliseBrackets=void 0;var s=d(9860);t.canonicaliseBrackets=s.cellFormat.canonicaliseBrackets,t.canonicaliseCellPos=s.cellFormat.canonicaliseCellPos,t.canonicaliseCol=s.cellFormat.canonicaliseCol,t.canonicaliseColRange=s.cellFormat.canonicaliseColRange,t.canonicaliseRangePos=s.cellFormat.canonicaliseRangePos,t.canonicaliseRow=s.cellFormat.canonicaliseRow,t.canonicaliseRowRange=s.cellFormat.canonicaliseRowRange,t.columnName=s.cellFormat.columnName,t.formatCellPos=s.cellFormat.formatCellPos,t.formatCol=s.cellFormat.formatCol,t.formatColRange=s.cellFormat.formatColRange,t.formatGridRange=s.cellFormat.formatGridRange,t.formatQualifier=s.cellFormat.formatQualifier,t.formatRangePos=s.cellFormat.formatRangePos,t.formatRow=s.cellFormat.formatRow,t.formatRowRange=s.cellFormat.formatRowRange,t.quoteQualifier=s.cellFormat.quoteQualifier,t.resolvePosition=s.cellFormat.resolvePosition,t.shouldQuoteQualifier=s.cellFormat.shouldQuoteQualifier},5079:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapPosition=t.parseGridRangeA1=t.parseGridCellA1=t.parseCellRef=t.isR1C1IdentStart=t.SpecialPos=void 0;var s=d(9860);t.SpecialPos=s.cellParse.SpecialPos,t.isR1C1IdentStart=s.cellParse.isR1C1IdentStart,t.parseCellRef=s.cellParse.parseCellRef,t.parseGridCellA1=s.cellParse.parseGridCellA1,t.parseGridRangeA1=s.cellParse.parseGridRangeA1,t.wrapPosition=s.cellParse.wrapPosition},4546:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ulsLogger=t.operatorIdToName=t.localeInfo=t.isNumeral=t.isIdentStart=t.isIdentContinue=t.getOrdinal=t.getNumberShape=t.getEnglishWorksheetFuncIdToName=t.getEnglishLocaleInfo=t.englishWorksheetFuncIdToName=t.englishSysTimeFormat=t.englishSysDateFormat=t.englishSpecialRefNames=t.englishPictureSpecial=t.englishPictureSingle=t.englishPictureDbnum=t.englishPictureColor=t.englishOperatorIdToName=t.englishErrorTypeToName=t.englishErrorNames=t.createWorksheetFuncNameCallbacks=t.calcConfig=t.TraceLevel=t.PictureSpecial=t.PictureSingle=t.PictureDbnum=t.PictureColor=t.NulLogger=t.LogCategory=t.LCID=t.Country=void 0;var s=d(9860);t.Country=s.config.Country,t.LCID=s.config.LCID,t.LogCategory=s.config.LogCategory,t.NulLogger=s.config.NulLogger,t.PictureColor=s.config.PictureColor,t.PictureDbnum=s.config.PictureDbnum,t.PictureSingle=s.config.PictureSingle,t.PictureSpecial=s.config.PictureSpecial,t.TraceLevel=s.config.TraceLevel,t.calcConfig=s.config.calcConfig,t.createWorksheetFuncNameCallbacks=s.config.createWorksheetFuncNameCallbacks,t.englishErrorNames=s.config.englishErrorNames,t.englishErrorTypeToName=s.config.englishErrorTypeToName,t.englishOperatorIdToName=s.config.englishOperatorIdToName,t.englishPictureColor=s.config.englishPictureColor,t.englishPictureDbnum=s.config.englishPictureDbnum,t.englishPictureSingle=s.config.englishPictureSingle,t.englishPictureSpecial=s.config.englishPictureSpecial,t.englishSpecialRefNames=s.config.englishSpecialRefNames,t.englishSysDateFormat=s.config.englishSysDateFormat,t.englishSysTimeFormat=s.config.englishSysTimeFormat,t.englishWorksheetFuncIdToName=s.config.englishWorksheetFuncIdToName,t.getEnglishLocaleInfo=s.config.getEnglishLocaleInfo,t.getEnglishWorksheetFuncIdToName=s.config.getEnglishWorksheetFuncIdToName,t.getNumberShape=s.config.getNumberShape,t.getOrdinal=s.config.getOrdinal,t.isIdentContinue=s.config.isIdentContinue,t.isIdentStart=s.config.isIdentStart,t.isNumeral=s.config.isNumeral,t.localeInfo=s.config.localeInfo,t.operatorIdToName=s.config.operatorIdToName,t.ulsLogger=s.config.ulsLogger},9866:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.localNameDeclAnnotation=t.literalNode=t.letVar=t.letNode=t.lambdaParam=t.lambdaNode=t.indexedArg=t.identQualifier=t.identNamePart=t.headNamePart=t.formulaSpan=t.multiLineComment=t.singleLineComment=t.formulaRootAnnotation=t.formula=t.flattenNameParts=t.flattenLetArgs=t.flattenLambdaArgs=t.fieldRefNode=t.fieldRefNamePart=t.fieldRef=t.errorQualifier=t.documentQualifier=t.commaOpRef=t.columnRef=t.cellRefSingle=t.cellRefRow=t.cellRefRange=t.cellRefNode=t.cellRefNamePart=t.cellRefError=t.cellRefCol=t.cellRefBad=t.badRef=t.badQualifier=t.badNode=t.arrayNode=t.appNode=t.appHeadNameAnnotation=t.StructRefKind=t.SpecialRefId=t.RefStyle=t.QualifierKind=t.PosKind=t.NodeKind=t.NamePartKind=t.CellRefKind=t.BadType=t.AnnotationKind=t.SyntaxFeature=void 0,t.getDepthUpperBound=t.wsfNode=t.thisRowOpRef=t.contextNameNode=t.structRefNode=t.structRef=t.specialRef=t.sheetRangeQualifier=t.sheetQualifier=t.relativeQualifier=t.rangeOpRef=t.pos=t.parenNode=t.paramNode=t.paramName=t.paramDefault=t.operatorNode=t.nameNode=t.missingRef=t.localNameUseAnnotation=void 0;var s=d(9860);t.SyntaxFeature=s.formulaModule.SyntaxFeature,t.AnnotationKind=s.formulaModule.AnnotationKind,t.BadType=s.formulaModule.BadType,t.CellRefKind=s.formulaModule.CellRefKind,t.NamePartKind=s.formulaModule.NamePartKind,t.NodeKind=s.formulaModule.NodeKind,t.PosKind=s.formulaModule.PosKind,t.QualifierKind=s.formulaModule.QualifierKind,t.RefStyle=s.formulaModule.RefStyle,t.SpecialRefId=s.formulaModule.SpecialRefId,t.StructRefKind=s.formulaModule.StructRefKind,t.appHeadNameAnnotation=s.formulaModule.appHeadNameAnnotation,t.appNode=s.formulaModule.appNode,t.arrayNode=s.formulaModule.arrayNode,t.badNode=s.formulaModule.badNode,t.badQualifier=s.formulaModule.badQualifier,t.badRef=s.formulaModule.badRef,t.cellRefBad=s.formulaModule.cellRefBad,t.cellRefCol=s.formulaModule.cellRefCol,t.cellRefError=s.formulaModule.cellRefError,t.cellRefNamePart=s.formulaModule.cellRefNamePart,t.cellRefNode=s.formulaModule.cellRefNode,t.cellRefRange=s.formulaModule.cellRefRange,t.cellRefRow=s.formulaModule.cellRefRow,t.cellRefSingle=s.formulaModule.cellRefSingle,t.columnRef=s.formulaModule.columnRef,t.commaOpRef=s.formulaModule.commaOpRef,t.documentQualifier=s.formulaModule.documentQualifier,t.errorQualifier=s.formulaModule.errorQualifier,t.fieldRef=s.formulaModule.fieldRef,t.fieldRefNamePart=s.formulaModule.fieldRefNamePart,t.fieldRefNode=s.formulaModule.fieldRefNode,t.flattenLambdaArgs=s.formulaModule.flattenLambdaArgs,t.flattenLetArgs=s.formulaModule.flattenLetArgs,t.flattenNameParts=s.formulaModule.flattenNameParts,t.formula=s.formulaModule.formula,t.formulaRootAnnotation=s.formulaModule.formulaRootAnnotation,t.singleLineComment=s.formulaModule.singleLineComment,t.multiLineComment=s.formulaModule.multiLineComment,t.formulaSpan=s.formulaModule.formulaSpan,t.headNamePart=s.formulaModule.headNamePart,t.identNamePart=s.formulaModule.identNamePart,t.identQualifier=s.formulaModule.identQualifier,t.indexedArg=s.formulaModule.indexedArg,t.lambdaNode=s.formulaModule.lambdaNode,t.lambdaParam=s.formulaModule.lambdaParam,t.letNode=s.formulaModule.letNode,t.letVar=s.formulaModule.letVar,t.literalNode=s.formulaModule.literalNode,t.localNameDeclAnnotation=s.formulaModule.localNameDeclAnnotation,t.localNameUseAnnotation=s.formulaModule.localNameUseAnnotation,t.missingRef=s.formulaModule.missingRef,t.nameNode=s.formulaModule.nameNode,t.operatorNode=s.formulaModule.operatorNode,t.paramDefault=s.formulaModule.paramDefault,t.paramName=s.formulaModule.paramName,t.paramNode=s.formulaModule.paramNode,t.parenNode=s.formulaModule.parenNode,t.pos=s.formulaModule.pos,t.rangeOpRef=s.formulaModule.rangeOpRef,t.relativeQualifier=s.formulaModule.relativeQualifier,t.sheetQualifier=s.formulaModule.sheetQualifier,t.sheetRangeQualifier=s.formulaModule.sheetRangeQualifier,t.specialRef=s.formulaModule.specialRef,t.structRef=s.formulaModule.structRef,t.structRefNode=s.formulaModule.structRefNode,t.contextNameNode=s.formulaModule.contextNameNode,t.thisRowOpRef=s.formulaModule.thisRowOpRef,t.wsfNode=s.formulaModule.wsfNode,t.getDepthUpperBound=s.formulaModule.getDepthUpperBound},3453:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseUint=t.parseSignedLiteral=t.parseNumberLiteral=t.isLineBreak=t.isSpace=void 0;var s=d(9860);t.isSpace=s.literalParse.isSpace,t.isLineBreak=s.literalParse.isLineBreak,t.parseNumberLiteral=s.literalParse.parseNumberLiteral,t.parseSignedLiteral=s.literalParse.parseSignedLiteral,t.parseUint=s.literalParse.parseUint},7082:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.userDefinedFuncLoc=t.unsafeGridRange=t.structRefColumnLoc=t.sheetRows=t.sheetRangeIndexes=t.sheetRange=t.sheetIndex=t.sheetGridRange=t.sheetGridCube=t.sheetGridCell=t.sheetCols=t.originCell=t.nameScope=t.nameLoc=t.lexicalSourceUDF=t.lexicalSourceWSF=t.lexicalSourceRange=t.lexicalSourceName=t.lexicalSourceGrid=t.lexicalSourceCell=t.isSheetIndex=t.isSheetGridRange=t.isSheetGridCell=t.isGridCell=t.gridRange=t.gridCell=t.documentScope=t.documentLoc=t.allSheetsRange=t.NameSource=t.LexicalKind=void 0;var s=d(9860);t.LexicalKind=s.location.LexicalKind,t.NameSource=s.location.NameSource,t.allSheetsRange=s.location.allSheetsRange,t.documentLoc=s.location.documentLoc,t.documentScope=s.location.documentScope,t.gridCell=s.location.gridCell,t.gridRange=s.location.gridRange,t.isGridCell=s.location.isGridCell,t.isSheetGridCell=s.location.isSheetGridCell,t.isSheetGridRange=s.location.isSheetGridRange,t.isSheetIndex=s.location.isSheetIndex,t.lexicalSourceCell=s.location.lexicalSourceCell,t.lexicalSourceGrid=s.location.lexicalSourceGrid,t.lexicalSourceName=s.location.lexicalSourceName,t.lexicalSourceRange=s.location.lexicalSourceRange,t.lexicalSourceWSF=s.location.lexicalSourceWSF,t.lexicalSourceUDF=s.location.lexicalSourceUDF,t.nameLoc=s.location.nameLoc,t.nameScope=s.location.nameScope,t.originCell=s.location.originCell,t.sheetCols=s.location.sheetCols,t.sheetGridCell=s.location.sheetGridCell,t.sheetGridCube=s.location.sheetGridCube,t.sheetGridRange=s.location.sheetGridRange,t.sheetIndex=s.location.sheetIndex,t.sheetRange=s.location.sheetRange,t.sheetRangeIndexes=s.location.sheetRangeIndexes,t.sheetRows=s.location.sheetRows,t.structRefColumnLoc=s.location.structRefColumnLoc,t.unsafeGridRange=s.location.unsafeGridRange,t.userDefinedFuncLoc=s.location.userDefinedFuncLoc},8449:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveGridRef=t.createResolver=void 0;var s=d(9860);t.createResolver=s.resolveService.createResolver,t.resolveGridRef=s.resolveService.resolveGridRef},73:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolvedUserDefinedFunc=t.resolvedStructRef=t.resolvedNever=t.resolvedName=t.resolvedLocalName=t.resolvedDottedName=t.resolvedCellRef=t.resolveLocalsGrid=t.noOriginSheet=t.invalidStructRef=t.invalidQualifier=t.invalidCellRef=t.emptyIntersection=t.ResolvedKind=t.ResolveReasonKind=t.InvalidStructRefReason=t.InvalidQualifierReason=t.InvalidCellRefReason=void 0;var s=d(9860);t.InvalidCellRefReason=s.resolveServiceTypes.InvalidCellRefReason,t.InvalidQualifierReason=s.resolveServiceTypes.InvalidQualifierReason,t.InvalidStructRefReason=s.resolveServiceTypes.InvalidStructRefReason,t.ResolveReasonKind=s.resolveServiceTypes.ResolveReasonKind,t.ResolvedKind=s.resolveServiceTypes.ResolvedKind,t.emptyIntersection=s.resolveServiceTypes.emptyIntersection,t.invalidCellRef=s.resolveServiceTypes.invalidCellRef,t.invalidQualifier=s.resolveServiceTypes.invalidQualifier,t.invalidStructRef=s.resolveServiceTypes.invalidStructRef,t.noOriginSheet=s.resolveServiceTypes.noOriginSheet,t.resolveLocalsGrid=s.resolveServiceTypes.resolveLocalsGrid,t.resolvedCellRef=s.resolveServiceTypes.resolvedCellRef,t.resolvedDottedName=s.resolveServiceTypes.resolvedDottedName,t.resolvedLocalName=s.resolveServiceTypes.resolvedLocalName,t.resolvedName=s.resolveServiceTypes.resolvedName,t.resolvedNever=s.resolveServiceTypes.resolvedNever,t.resolvedStructRef=s.resolveServiceTypes.resolvedStructRef,t.resolvedUserDefinedFunc=s.resolveServiceTypes.resolvedUserDefinedFunc},1416:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unknownFunctionType=t.operatorStrings=t.higherOrderFunctionType=t.getWorksheetFuncType=t.getWorksheetFuncEnglishName=t.getOperatorType=t.WorksheetFuncId=t.OperatorId=void 0;var s=d(9860);t.OperatorId=s.signature.OperatorId,t.WorksheetFuncId=s.signature.WorksheetFuncId,t.getOperatorType=s.signature.getOperatorType,t.getWorksheetFuncEnglishName=s.signature.getWorksheetFuncEnglishName,t.getWorksheetFuncType=s.signature.getWorksheetFuncType,t.higherOrderFunctionType=s.signature.higherOrderFunctionType,t.operatorStrings=s.signature.operatorStrings,t.unknownFunctionType=s.signature.unknownFunctionType},6672:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionType=t.SpecialPrecs=t.SignatureType=t.OperKind=t.FunctionFlags=void 0;var s=d(9860);t.FunctionFlags=s.types.FunctionFlags,t.OperKind=s.types.OperKind,t.SignatureType=s.types.SignatureType,t.SpecialPrecs=s.types.SpecialPrecs,t.functionType=s.types.functionType},6982:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSheetGridRange=t.isSheetGridCellEqual=t.isSheetGridCell=t.isRichOper=t.isReadOperEqual=t.isRangeOper=t.isRangeOpNoMissing=t.isRangeOpClosed=t.isPrimitiveOper=t.isOperatorNode=t.isNumberOper=t.isNumberNode=t.isNameScopeEqual=t.isMissingOper=t.isMissingNode=t.isGridRangeEqual=t.isGridCellEqual=t.isGridCell=t.isErrorOper=t.isDocumentLocEqual=t.isCommaOpRefWellFormed=t.isCommaOpNoBadOrMissing=t.isCommaOpClosed=t.isBooleanOper=t.isBooleanNode=t.isBlankOper=t.isArrayOper=t.internal=t.gridRangesJoin=t.gridRangeSize=t.gridRangeJoinOpt=t.gridRangeJoin=t.gridRangeIsects=t.gridRangeIsect=t.gridRangeExcept=t.gridRangeCompare=t.gridRangeAnchor=t.gridCellRange=t.gridCellImplicitIsect=t.getWorksheetFuncId=t.getUserDefinedFuncName=t.getSubExpressionFromPosition=t.getBoundName=t.getArguments=t.getArgType=t.forEachTileInRange=t.forEachCellInRange=t.createFailureErrorClass=t.ReasonKind=t.LangReasonKind=void 0,t.unavailable=t.shouldFieldRefBeBracketed=t.sheetGridRangeAnchor=t.notImplemented=t.normalizeCommaOpRef=t.isWriteOper=t.isWellFormed=t.isWSFNode=t.isValidArgsLength=t.isUnqualifiedNameNode=t.isStringOper=t.isSheetIndexEqual=t.isSheetIndex=t.isSheetGridRangeEqual=void 0;var s=d(9860);t.LangReasonKind=s.util.LangReasonKind,t.ReasonKind=s.util.ReasonKind,t.createFailureErrorClass=s.util.createFailureErrorClass,t.forEachCellInRange=s.util.forEachCellInRange,t.forEachTileInRange=s.util.forEachTileInRange,t.getArgType=s.util.getArgType,t.getArguments=s.util.getArguments,t.getBoundName=s.util.getBoundName,t.getSubExpressionFromPosition=s.util.getSubExpressionFromPosition,t.getUserDefinedFuncName=s.util.getUserDefinedFuncName,t.getWorksheetFuncId=s.util.getWorksheetFuncId,t.gridCellImplicitIsect=s.util.gridCellImplicitIsect,t.gridCellRange=s.util.gridCellRange,t.gridRangeAnchor=s.util.gridRangeAnchor,t.gridRangeCompare=s.util.gridRangeCompare,t.gridRangeExcept=s.util.gridRangeExcept,t.gridRangeIsect=s.util.gridRangeIsect,t.gridRangeIsects=s.util.gridRangeIsects,t.gridRangeJoin=s.util.gridRangeJoin,t.gridRangeJoinOpt=s.util.gridRangeJoinOpt,t.gridRangeSize=s.util.gridRangeSize,t.gridRangesJoin=s.util.gridRangesJoin,t.internal=s.util.internal,t.isArrayOper=s.util.isArrayOper,t.isBlankOper=s.util.isBlankOper,t.isBooleanNode=s.util.isBooleanNode,t.isBooleanOper=s.util.isBooleanOper,t.isCommaOpClosed=s.util.isCommaOpClosed,t.isCommaOpNoBadOrMissing=s.util.isCommaOpNoBadOrMissing,t.isCommaOpRefWellFormed=s.util.isCommaOpRefWellFormed,t.isDocumentLocEqual=s.util.isDocumentLocEqual,t.isErrorOper=s.util.isErrorOper,t.isGridCell=s.util.isGridCell,t.isGridCellEqual=s.util.isGridCellEqual,t.isGridRangeEqual=s.util.isGridRangeEqual,t.isMissingNode=s.util.isMissingNode,t.isMissingOper=s.util.isMissingOper,t.isNameScopeEqual=s.util.isNameScopeEqual,t.isNumberNode=s.util.isNumberNode,t.isNumberOper=s.util.isNumberOper,t.isOperatorNode=s.util.isOperatorNode,t.isPrimitiveOper=s.util.isPrimitiveOper,t.isRangeOpClosed=s.util.isRangeOpClosed,t.isRangeOpNoMissing=s.util.isRangeOpNoMissing,t.isRangeOper=s.util.isRangeOper,t.isReadOperEqual=s.util.isReadOperEqual,t.isRichOper=s.util.isRichOper,t.isSheetGridCell=s.util.isSheetGridCell,t.isSheetGridCellEqual=s.util.isSheetGridCellEqual,t.isSheetGridRange=s.util.isSheetGridRange,t.isSheetGridRangeEqual=s.util.isSheetGridRangeEqual,t.isSheetIndex=s.util.isSheetIndex,t.isSheetIndexEqual=s.util.isSheetIndexEqual,t.isStringOper=s.util.isStringOper,t.isUnqualifiedNameNode=s.util.isUnqualifiedNameNode,t.isValidArgsLength=s.util.isValidArgsLength,t.isWSFNode=s.util.isWSFNode,t.isWellFormed=s.util.isWellFormed,t.isWriteOper=s.util.isWriteOper,t.normalizeCommaOpRef=s.util.normalizeCommaOpRef,t.notImplemented=s.util.notImplemented,t.sheetGridRangeAnchor=s.util.sheetGridRangeAnchor,t.shouldFieldRefBeBracketed=s.util.shouldFieldRefBeBracketed,t.unavailable=s.util.unavailable},5630:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.valueErrorOper=t.trueOper=t.stringOper=t.refErrorOper=t.rangeSeqOper=t.range3DOper=t.precedents=t.numErrorOper=t.nullErrorOper=t.nameErrorOper=t.naErrorOper=t.missingOper=t.gettingDataErrorOper=t.fieldErrorOper=t.falseOper=t.errorOper=t.div0ErrorOper=t.cellStringLimit=t.booleanOper=t.blankOper=t.arrayOper=t.PrecsBound=t.ErrorType=void 0;var s=d(9860);t.ErrorType=s.value.ErrorType,t.PrecsBound=s.value.PrecsBound,t.arrayOper=s.value.arrayOper,t.blankOper=s.value.blankOper,t.booleanOper=s.value.booleanOper,t.cellStringLimit=s.value.cellStringLimit,t.div0ErrorOper=s.value.div0ErrorOper,t.errorOper=s.value.errorOper,t.falseOper=s.value.falseOper,t.fieldErrorOper=s.value.fieldErrorOper,t.gettingDataErrorOper=s.value.gettingDataErrorOper,t.missingOper=s.value.missingOper,t.naErrorOper=s.value.naErrorOper,t.nameErrorOper=s.value.nameErrorOper,t.nullErrorOper=s.value.nullErrorOper,t.numErrorOper=s.value.numErrorOper,t.precedents=s.value.precedents,t.range3DOper=s.value.range3DOper,t.rangeSeqOper=s.value.rangeSeqOper,t.refErrorOper=s.value.refErrorOper,t.stringOper=s.value.stringOper,t.trueOper=s.value.trueOper,t.valueErrorOper=s.value.valueErrorOper},7512:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.zipVisitor=t.voidVisitor=t.visitWSFNode=t.visitQualifier=t.visitOperatorNode=t.visitFormulaNode=t.visitCellRef=t.visitAppHeadNode=t.reduceTopDown_Pledge=t.reducePledge=t.reduceBottomUp_Recursive=t.reduceBottomUp_Pledge=t.reduceBottomUp_MaxDepth=t.reduceBottomUp_CPS=t.reduceBottomUp=t.identityVisitor=t.depthVisitor=t.constVisitor=t.composeVisitor=t.bindVisitor=t.binaryVisitor=t.ZipVisitor=t.PledgeReducer=t.IdentityVisitor=t.DelegatingVisitor=t.ConstVisitor=t.ComposeVisitor=t.BinaryVisitor=void 0;var s=d(9860);t.BinaryVisitor=s.visitor.BinaryVisitor,t.ComposeVisitor=s.visitor.ComposeVisitor,t.ConstVisitor=s.visitor.ConstVisitor,t.DelegatingVisitor=s.visitor.DelegatingVisitor,t.IdentityVisitor=s.visitor.IdentityVisitor,t.PledgeReducer=s.visitor.PledgeReducer,t.ZipVisitor=s.visitor.ZipVisitor,t.binaryVisitor=s.visitor.binaryVisitor,t.bindVisitor=s.visitor.bindVisitor,t.composeVisitor=s.visitor.composeVisitor,t.constVisitor=s.visitor.constVisitor,t.depthVisitor=s.visitor.depthVisitor,t.identityVisitor=s.visitor.identityVisitor,t.reduceBottomUp=s.visitor.reduceBottomUp,t.reduceBottomUp_CPS=s.visitor.reduceBottomUp_CPS,t.reduceBottomUp_MaxDepth=s.visitor.reduceBottomUp_MaxDepth,t.reduceBottomUp_Pledge=s.visitor.reduceBottomUp_Pledge,t.reduceBottomUp_Recursive=s.visitor.reduceBottomUp_Recursive,t.reducePledge=s.visitor.reducePledge,t.reduceTopDown_Pledge=s.visitor.reduceTopDown_Pledge,t.visitAppHeadNode=s.visitor.visitAppHeadNode,t.visitCellRef=s.visitor.visitCellRef,t.visitFormulaNode=s.visitor.visitFormulaNode,t.visitOperatorNode=s.visitor.visitOperatorNode,t.visitQualifier=s.visitor.visitQualifier,t.visitWSFNode=s.visitor.visitWSFNode,t.voidVisitor=s.visitor.voidVisitor,t.zipVisitor=s.visitor.zipVisitor},7110:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseBracketedTokens=t.parseIdentContinue=t.parseEnd=t.parseEscape=t.parseAtOp=t.parseRangeOp=t.parseDotSepTokenNotFollowedByLeftBracket=t.parseRightBracket=t.parseLeftBracket=t.parseRightSQuote=t.parseLeftSQuote=t.parseRightBrace=t.parseLeftBrace=t.parseRightParen=t.parseLeftParen=t.parseAssignToken=t.parseDotSepToken=t.parseQualSep=t.parseColSep=t.parseRowSep=t.parseListSep=t.parseCharIndex=t.parseSpacesOnly=t.parseWhitespace=t.isWhitespaceToken=t.isCommentToken=t.isBracketToken=t.isRightBracketToken=t.isLeftBracketToken=t.isRefErrorToken=t.isAtOpToken=t.isRangeOpToken=t.isListSepToken=t.isDotSepToken=void 0;var s=d(7081),c=d(4666),l=d(5630),f=d(1416),p=d(7577),m=d(7971),v=d(6672);function h(G){return G.kind===p.TokenKind.Sep&&G.value===p.SepId.Dot}function S(G){return G.kind===p.TokenKind.Operator&&G.value===f.OperatorId.Range}function y(G){return G.kind===p.TokenKind.Operator&&G.value===f.OperatorId.At}function C(G){return G.kind===p.TokenKind.Left&&G.value===p.DelimId.Bracket}function E(G){return(G.kind===p.TokenKind.Left||G.kind===p.TokenKind.Right)&&G.value===p.DelimId.Bracket}function I(G){return G.kind===p.TokenKind.Spaces||G.kind===p.TokenKind.SingleLineComment||G.kind===p.TokenKind.MultiLineComment}function F(G){return(0,m.take)(function(H,L){return L.kind===p.TokenKind.Sep&&L.value===G?L:void 0})}function w(G){return(0,m.take)(function(H,L){return L.kind===p.TokenKind.Left&&L.value===G?L:void 0})}function B(G){return(0,m.take)(function(H,L){return L.kind===p.TokenKind.Right&&L.value===G?L:void 0})}t.isDotSepToken=h,t.isListSepToken=function(G){return G.kind===p.TokenKind.Sep&&G.value===p.SepId.List},t.isRangeOpToken=S,t.isAtOpToken=y,t.isRefErrorToken=function(G){return G.kind===p.TokenKind.Literal&&G.oper.kind===v.OperKind.Error&&G.oper.type===l.ErrorType.REF},t.isLeftBracketToken=C,t.isRightBracketToken=function(G){return G.kind===p.TokenKind.Right&&G.value===p.DelimId.Bracket},t.isBracketToken=E,t.isCommentToken=function(G){return G.kind===p.TokenKind.SingleLineComment||G.kind===p.TokenKind.MultiLineComment},t.isWhitespaceToken=I,t.parseWhitespace=(0,m.many)((0,m.take)(function(G,H){return I(H)?H:void 0})),t.parseSpacesOnly=(0,m.opt)((0,m.take)(function(G,H){return H.kind===p.TokenKind.Spaces?H.chars:void 0}),""),t.parseCharIndex=function(G,H,L,D,U){var V=G[H];if(V==null){var ne="calc.parse.pStart: internal error: expected token at "+H+" in "+(0,s.anonymize)(G);return(0,c.assertFalse)(ne)}return D(V.start,H)},t.parseListSep=F(p.SepId.List),t.parseRowSep=F(p.SepId.Row),t.parseColSep=F(p.SepId.Col),t.parseQualSep=F(p.SepId.Qual),t.parseDotSepToken=F(p.SepId.Dot),t.parseAssignToken=F(p.SepId.Assign),t.parseLeftParen=w(p.DelimId.Paren),t.parseRightParen=B(p.DelimId.Paren),t.parseLeftBrace=w(p.DelimId.Brace),t.parseRightBrace=B(p.DelimId.Brace),t.parseLeftSQuote=w(p.DelimId.SQuote),t.parseRightSQuote=B(p.DelimId.SQuote),t.parseLeftBracket=w(p.DelimId.Bracket),t.parseRightBracket=B(p.DelimId.Bracket),t.parseDotSepTokenNotFollowedByLeftBracket=(0,m.takePeek)(function(G,H,L){return h(H)&&!C(L)?H:void 0}),t.parseRangeOp=(0,m.take)(function(G,H){return S(H)?H:void 0}),t.parseAtOp=(0,m.take)(function(G,H){return y(H)?H:void 0}),t.parseEscape=(0,m.take)(function(G,H){return H.kind===p.TokenKind.Escape?H:void 0}),t.parseEnd=(0,m.take)(function(G,H){return H.kind===p.TokenKind.End?H:void 0}),t.parseIdentContinue=(0,m.apply)((0,m.many1)((0,m.take)(function(G,H){return H.isIdentContinue?H:void 0})),function(G,H){var L=H[0];return H.length===1?L:(0,p.identToken)(L.start,H.map(function(D){return D.chars}).join(""))});var k=(0,m.take)(function(G,H){return E(H)||H.kind===p.TokenKind.End?void 0:H}),x=(0,m.lazy)(function(){return(0,m.flatten)((0,m.many)((0,m.any)((0,m.many1)(k),(0,m.concat)((0,m.tuple)(t.parseLeftBracket),x,(0,m.opt)((0,m.tuple)(t.parseRightBracket),[])))))});t.parseBracketedTokens=(0,m.apply)((0,m.tuple)(t.parseLeftBracket,x,t.parseCharIndex,(0,m.opt)(t.parseRightBracket,void 0)),function(G,H){var L=Mr(H,4),D=L[0],U=L[1],V=L[2],ne=L[3];return U.push((0,p.endToken)(V)),[U,ne!==void 0]})},3075:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseFieldRef=t.isUnbracketedField=void 0;var s=d(9866),c=d(7577),l=d(7971),f=d(4828),p=d(7371),m=d(7110),v=d(3357),h=d(2636),S=d(3206),y=S.codePointQuestionMark,C=S.codePointBackslash,E=S.codePointUnderscore;function I(H,L){if(L.length===0)return!1;var D=(0,h.stringCodePointAt)(L,0);return!((U=D)===E||U===C||!H.isIdentStart(U)&&!H.isNumeral(U))&&(0,h.codePointIterator)(L,(0,h.numCodeUnits)(D)).every(function(V){return V!==y&&V!==C&&H.isIdentContinue(V)});var U}t.isUnbracketedField=I;var F=(0,l.take)(function(H,L){return(0,m.isBracketToken)(L)||L.kind===c.TokenKind.Escape||L.kind===c.TokenKind.End?void 0:L.chars}),w=(0,l.take)(function(H,L){return L.kind!==c.TokenKind.Ident||L.chars!==H.localeInfo.leftBracket&&L.chars!==H.localeInfo.rightBracket&&L.chars!=="'"?void 0:L.chars}),B=(0,l.any)(F,(0,l.right)(m.parseEscape,w)),k=(0,l.apply)((0,l.tuple)((0,l.many)(B),m.parseEnd),function(H,L){var D=Mr(L,2),U=D[0],V=D[1];return U.join("")}),x=(0,l.applyTake)(m.parseBracketedTokens,function(H,L){var D=Mr(L,2),U=D[0],V=D[1],ne=(0,l.runParser)(k,U,0,H);if((0,v.isSuccess)(ne)){var J=U[0].start,$=U[U.length-1].start,Z=ne.value.output;if(Z.length>255){var ie=U.map(function(b){return b.chars}).join("");return[(0,s.badNode)(s.BadType.FieldName,ie,(0,p.addSpan)(H,J,$,"","")),!1,!0]}var X=(0,p.addSpan)(H,J,$,"",""),Q=(0,p.addSpan)(H,J,$,"","");return[(0,s.nameNode)((0,s.identNamePart)(Z,void 0,X,X),void 0,Q),!0,V]}}),G=(0,l.apply)(m.parseIdentContinue,function(H,L){var D=L.start,U=L.start+L.chars.length;if(!I(H.localeInfo,L.chars)||L.chars.length>255)return[(0,s.badNode)(s.BadType.FieldName,L.chars,(0,p.addSpan)(H,D,U,"","")),!1,!0];var V=(0,p.addSpan)(H,D,U,"",""),ne=(0,p.addSpan)(H,D,U,"","");return[(0,s.nameNode)((0,s.identNamePart)(L.chars,void 0,V,V),void 0,ne),!1,!0]});t.parseFieldRef=(0,l.apply)((0,l.tuple)(m.parseCharIndex,m.parseWhitespace,m.parseDotSepToken,(0,l.any)(G,x),m.parseCharIndex),function(H,L){var D=Mr(L,5),U=D[0],V=D[1],ne=D[2],J=Mr(D[3],3),$=J[0],Z=J[1],ie=J[2],X=D[4],Q=(0,p.addSpan)(H,ne.start,X,V,""),b=(0,s.fieldRef)($,Z,ie,Q);return(0,f.fieldRefTerm)(V.length>0,b,U,X)})},6845:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseSpParam=t.runFormulaParser=t.parseFormula=void 0;var s=d(7081),c=d(4666),l=d(9866),f=d(9866),p=d(5630),m=d(1416),v=d(7577),h=d(7971),S=d(4828),y=d(7371),C=d(7110),E=d(7914),I=d(6465),F=d(3075),w=d(1913),B=d(3357),k=d(5815),x=d(2636),G=d(637),H=d(5079),L=d(719),D=d(6982),U=(0,h.apply)((0,h.tuple)(C.parseWhitespace,(0,h.lazy)(function(){return t.parseFormula}),C.parseWhitespace),function(de,pe){var _e,Ce,Ne,Le,Oe=Mr(pe,3),le=Oe[0],me=Oe[1],Pe=Oe[2],Re=(0,y.getNodeSpan)(de,me);return(0,c.assertTrue)("calc.parse.parseSpFormula",!(Re.pre.length>0&&le.length>0)),(0,c.assertTrue)("calc.parse.parseSpFormula",!(Re.post.length>0&&Pe.length>0)),le.length>0&&(_e=(0,y.addWhitespace)(de,le),Ce=Mr(_e,2),Re.pre=Ce[0],Re.preComments=Ce[1]),Pe.length>0&&(Ne=(0,y.addWhitespace)(de,Pe),Le=Mr(Ne,2),Re.post=Le[0],Re.postComments=Le[1]),me}),V=(0,h.apply)((0,h.tuple)(C.parseLeftParen,(0,y.withDelim)({delimId:v.DelimId.Paren,listSep:y.ListSep.Union},U),(0,h.opt)(C.parseRightParen,void 0),C.parseCharIndex),function(de,pe){var _e=Mr(pe,4),Ce=_e[0],Ne=_e[1],Le=_e[2],Oe=_e[3];return(0,l.parenNode)(Ne,Le!==void 0,(0,y.addSpan)(de,Ce.start,Oe,"",""))}),ne=(0,h.many1)(U,(0,h.right)(C.parseColSep,U)),J=(0,h.many1)(ne,(0,h.right)(C.parseRowSep,ne)),$=(0,h.apply)((0,h.tuple)(C.parseLeftBrace,(0,y.withDelim)({delimId:v.DelimId.Brace,listSep:y.ListSep.Union},J),(0,h.opt)(C.parseRightBrace,void 0),C.parseCharIndex),function(de,pe){var _e=Mr(pe,4),Ce=_e[0],Ne=_e[1],Le=_e[2],Oe=_e[3];return(0,l.arrayNode)(Ne,Le!==void 0,(0,y.addSpan)(de,Ce.start,Oe,"",""))});function Z(de){return(0,h.takePeek)(function(pe,_e,Ce){return de(_e)?(0,l.badNode)(l.BadType.Unexpected,_e.chars,(0,y.addSpan)(pe,_e.start,Ce.start,"","")):void 0})}var ie=(0,h.apply)((0,h.tuple)(C.parseCharIndex,Z(C.isLeftBracketToken),(0,y.withDelim)({delimId:v.DelimId.Bracket,listSep:y.ListSep.Union},U),(0,h.opt)(Z(C.isRightBracketToken),void 0),C.parseCharIndex),function(de,pe){var _e=Mr(pe,5),Ce=_e[0],Ne=_e[1],Le=_e[2],Oe=_e[3],le=_e[4],me=[Ne,Le];return Oe!=null&&me.push(Oe),(0,l.badNode)(l.BadType.Sequence,me,(0,y.addSpan)(de,Ce,le,"",""))}),X=(0,h.takePeek)(function(de,pe,_e){switch(pe.kind){case v.TokenKind.End:case v.TokenKind.Operator:case v.TokenKind.Spaces:case v.TokenKind.SingleLineComment:case v.TokenKind.MultiLineComment:return;case v.TokenKind.Sep:if(pe.value===v.SepId.Dot)return;if(pe.value===v.SepId.Qual||pe.value===v.SepId.Assign)break;if(de.delim.delimId===v.DelimId.Brace||pe.value!==v.SepId.Col&&pe.value!==v.SepId.Row)return;break;case v.TokenKind.Right:if((0,L.isTypedChangeGateEnabled)("Microsoft.Office.Excel.ChangeGate.BadlyNestedBracketsFix")){if(pe.value!==v.DelimId.SQuote&&de.delim.stack[pe.value])return}else if(pe.value===de.delim.delimId)return}return(0,l.badNode)(l.BadType.Unexpected,pe.chars,(0,y.addSpan)(de,pe.start,_e.start,"",""))}),Q=(0,h.any)(E.parseRef,I.parseLiteral,V,$,F.parseFieldRef,w.parseStructRef,ie,E.parseUnqualBadRef,X);function b(de){return(0,h.tuple)(C.parseLeftParen,(0,y.withDelim)({delimId:v.DelimId.Paren,listSep:y.ListSep.Arg},(0,h.many1)(de,(0,h.right)(C.parseListSep,de))),(0,h.opt)(C.parseRightParen,void 0),C.parseCharIndex)}var R=(0,h.apply)(b(U),function(de,pe){var _e=Mr(pe,4),Ce=_e[0],Ne=_e[1],Le=_e[2],Oe=_e[3];return(0,S.argsTerm)(Ne,Le!==void 0,Ce.start,Oe)}),P=(0,h.apply)(b((0,h.any)((0,h.lazy)(function(){return t.parseSpParam}),U)),function(de,pe){var _e=Mr(pe,4),Ce=_e[0],Ne=_e[1],Le=_e[2],Oe=_e[3];return(0,S.lambdaArgsTerm)(Ne,Le!==void 0,Ce.start,Oe)}),A=(0,h.take)(function(de,pe){return pe.kind!==v.TokenKind.Operator||pe.value!==m.OperatorId.Percent&&pe.value!==m.OperatorId.Pound?void 0:pe}),T=(0,h.take)(function(de,pe){return pe.kind===v.TokenKind.Operator||(0,C.isDotSepToken)(pe)?pe:function(_e,Ce){return Ce.kind===v.TokenKind.Sep&&Ce.value===v.SepId.List&&_e.delim.listSep===y.ListSep.Union?(0,v.operatorToken)(Ce.start,_e.localeInfo.listSeparator,m.OperatorId.Union):void 0}(de,pe)}),g=(0,h.many)((0,h.take)(function(de,pe){return(0,C.isWhitespaceToken)(pe)?pe:void 0})),O=(0,h.any)((0,h.concat)((0,h.bind)((0,h.any)(Q,A),function(de,pe){var _e=(0,S.isWSFNode)(de.localeInfo,pe);return(_e==null?void 0:_e.id)===m.WorksheetFuncId.LAMBDA?(0,h.concat)((0,h.parseSucceed)([pe]),(0,h.opt)((0,h.tuple)(P),[])):(0,h.parseSucceed)([pe])}),(0,h.many)((0,h.any)(R,F.parseFieldRef,w.parseStructRef))),(0,h.tuple)(T)),M=(0,h.flatten)((0,h.many1)(O,(0,h.concat)(g,O)));t.parseFormula=(0,h.apply)((0,h.tuple)((0,h.opt)(M,void 0),C.parseCharIndex),function(de,pe){var _e=Mr(pe,2),Ce=_e[0],Ne=_e[1];if(Ce==null){var Le=(0,y.addSpan)(de,Ne,Ne,"","");return(0,l.literalNode)(p.missingOper,!0,Le)}var Oe=Ce;return Oe.push((0,v.endToken)(Ne)),(0,S.runOperatorPrecedenceParser)(de,Oe)}),t.runFormulaParser=function(de,pe,_e,Ce,Ne,Le,Oe,le){var me,Pe=le.length-1;if(Pe<0){var Re="calc.parse.runTokenParser: internal error: expected at least 1 token";return(0,c.assertFalse)(Re)}if(le[Pe].kind!==v.TokenKind.End){var fe="calc.parse.runTokenParser: internal error: array[n] !== End in "+(0,s.anonymize)(le);return(0,c.assertFalse)(fe)}var Se=(0,y.makeState)(de,pe,_e,Ce,Ne),be=(0,h.runParser)(U,le,0,Se);if(!(0,B.isSuccess)(be)||be.value.index<Pe){var xe="calc.parse.runTokenParser: internal error: consumed "+((0,B.isSuccess)(be)?be.value.index:0)+" out of "+Pe+" in "+(0,s.anonymize)(le);return(0,c.assertFalse)(xe)}var Ie=be.value.output,Ve=Se.spans,Ze=(0,k.buildAnnotations)(de,Ie,Le,Oe===void 0?void 0:(me={},Qe(me,f.SyntaxFeature.Comments,Oe[f.SyntaxFeature.Comments]===!0),Qe(me,f.SyntaxFeature.Statements,Oe[f.SyntaxFeature.Statements]===!0),me));return(0,l.formula)(Ie,Ve,Ze)};var K=G.codePoint.codePointFullStop,W=(0,h.apply)((0,h.many1)((0,h.take)(function(de,pe){return pe.isIdentContinue||(0,C.isDotSepToken)(pe)?pe:void 0})),function(de,pe){var _e=pe[0].start,Ce=pe.map(function(Oe){return Oe.chars}).join(""),Ne=(0,y.addSpan)(de,_e,_e+Ce.length,"","");if(!function(Oe,le){if(!Oe.localeInfo.isIdentStart((0,x.stringCodePointAt)(le,0))||!(0,x.codePointIterator)(le).every(function(Re){return Re===K||Oe.localeInfo.isIdentContinue(Re)}))return!1;var me=(0,H.parseCellRef)(Oe.localeInfo,Oe.refStyle,Oe.origin,le,0);if(me!==void 0&&me.i===le.length){var Pe=me.refStyle===l.RefStyle.A1?(0,v.cellRefA1Token)(0,le,me.row,me.col):(0,v.cellRefR1C1Token)(0,le,me.row,me.col,me.enLocale);if((0,E.isCompleteCellRefToken)(Oe,Pe))return!1}return!0}(de,Ce))return(0,l.badNode)(l.BadType.ParamName,Ce,Ne);var Le=(0,y.addSpan)(de,_e,_e+Ce.length,"","");return(0,l.nameNode)((0,l.identNamePart)(Ce,void 0,Le,Le),void 0,Ne)}),z=(0,h.applyTake)((0,h.tuple)(C.parseCharIndex,C.parseLeftBracket,C.parseCharIndex,C.parseSpacesOnly,(0,h.opt)(W,void 0),C.parseSpacesOnly,C.parseCharIndex,(0,h.opt)(C.parseRightBracket,void 0),C.parseCharIndex),function(de,pe){var _e=Mr(pe,9),Ce=_e[0],Ne=_e[1],Le=_e[2],Oe=_e[3],le=_e[4],me=_e[5],Pe=_e[6],Re=_e[7],fe=_e[8];if(le!==void 0){var Se=(0,y.getNodeSpan)(de,le);Se.pre=Oe,Se.post=me}var be=le??(0,l.badNode)(l.BadType.Missing,Oe+me,(0,y.addSpan)(de,Le,Pe,"",""));return(0,l.paramName)(be,!0,Re!==void 0,(0,y.addSpan)(de,Ce,fe,"",""))}),ee=(0,h.lazy)(function(){return(0,L.isFeatureEnabled)(L.FeatureName.CalcLambdaOptionalParameters)?z:(0,h.parseFail)()}),ue=(0,h.applyTake)((0,h.tuple)(C.parseCharIndex,E.parseRef,C.parseCharIndex),function(de,pe){var _e=Mr(pe,3),Ce=_e[0],Ne=_e[1],Le=_e[2],Oe=Ne.kind===S.TermKind.MaybeWSFTerm?Ne.node:Ne;if((0,D.isUnqualifiedNameNode)(Oe))return(0,l.paramName)(Oe,!1,!0,(0,y.addSpan)(de,Ce,Le,"",""))}),ce=(0,h.apply)((0,h.tuple)(C.parseWhitespace,C.parseCharIndex,C.parseAssignToken,C.parseWhitespace,(0,h.lazy)(function(){return t.parseFormula}),C.parseCharIndex),function(de,pe){var _e,Ce,Ne=Mr(pe,6),Le=Ne[0],Oe=Ne[1],le=Ne[2],me=Ne[3],Pe=Ne[4],Re=Ne[5],fe=(0,y.getNodeSpan)(de,Pe);return _e=(0,y.addWhitespace)(de,me),Ce=Mr(_e,2),fe.pre=Ce[0],fe.preComments=Ce[1],(0,l.paramDefault)(Pe,(0,y.addSpan)(de,Oe,Re,Le,""))}),he=(0,h.lazy)(function(){return(0,L.isFeatureEnabled)(L.FeatureName.CalcLambdaDefaultParameters)?ce:(0,h.parseFail)()});t.parseSpParam=(0,h.applyTake)((0,h.tuple)(C.parseWhitespace,C.parseCharIndex,(0,h.bind)((0,h.any)(ue,ee),function(de,pe){return pe.isClosed?(0,h.apply)((0,h.opt)(he,void 0),function(_e,Ce){return[pe,Ce]}):(0,h.parseSucceed)([pe,void 0])}),C.parseCharIndex,C.parseWhitespace,(0,h.peek)(function(de,pe){return pe})),function(de,pe){var _e=Mr(pe,6),Ce=_e[0],Ne=_e[1],Le=Mr(_e[2],2),Oe=Le[0],le=Le[1],me=_e[3],Pe=_e[4],Re=_e[5];if(le!==void 0||Re.kind===v.TokenKind.End&&Oe.isBracketed||(0,C.isListSepToken)(Re)&&Oe.isClosed)return(0,l.paramNode)(Oe,le,(0,y.addSpan)(de,Ne,me,Ce,Pe))})},6465:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseLiteral=void 0;var s=d(9866),c=d(7577),l=d(7971),f=d(4828),p=d(7371),m=d(7110),v=d(5630),h=d(6982),S=d(6672),y=(0,l.take)(function(E,I){return I.kind===c.TokenKind.Literal&&I.oper.kind!==S.OperKind.Boolean?I:I.kind===c.TokenKind.CellRef&&function(F){return F.refStyle===s.RefStyle.A1&&F.col==null&&typeof F.row=="object"&&F.row.kind===s.PosKind.Rel}(I)?(0,c.literalToken)(I.start,I.chars,E.mathpack.fromNumber(I.row.index+E.origin.row+1)):void 0}),C=(0,l.take)(function(E,I){return I.kind===c.TokenKind.Literal&&I.oper.kind===S.OperKind.Boolean?I:void 0});t.parseLiteral=(0,l.apply)((0,l.tuple)((0,l.any)(y,(0,l.left)(C,(0,l.fails)(m.parseDotSepTokenNotFollowedByLeftBracket))),m.parseCharIndex),function(E,I){var F=Mr(I,2),w=F[0],B=F[1],k=(0,p.addSpan)(E,w.start,B,"","");if((0,c.isBadNumberOper)(w.oper))return(0,s.badNode)(s.BadType.NumberLiteral,w.chars,k);if((0,c.isBadErrorOper)(w.oper))return(0,s.badNode)(s.BadType.ErrorLiteral,w.chars,k);if((0,h.isStringOper)(w.oper)&&w.oper.value.length>v.cellStringLimit)return(0,s.badNode)(s.BadType.StringLiteral,w.chars,k);var x=(0,s.literalNode)(w.oper,w.hasRight,k);return(0,h.isBooleanOper)(w.oper)?(0,f.maybeWSFTerm)(x,w.chars):x})},4828:function(u,t,d){"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0}),t.runOperatorPrecedenceParser=t.isWSFNode=t.maybeWSFTerm=t.structRefTerm=t.fieldRefTerm=t.argsTerm=t.lambdaArgsTerm=t.TermKind=void 0;var c=d(7081),l=d(4666),f=d(9866),p=d(1416),m=d(5630),v=d(7577),h=d(7971),S=d(7371),y=d(6982),C=d(7110),E=d(3357),I=d(719),F;function w($e,qe,fr,lr){return{kind:F.FieldRefTerm,hasDotPreSpace:$e,rhs:qe,start:fr,end:lr}}function B($e){return $e.kind!==v.TokenKind.Operator&&$e.kind!==v.TokenKind.Sep&&$e.kind!==v.TokenKind.End&&$e.kind!==v.TokenKind.Spaces&&$e.kind!==v.TokenKind.SingleLineComment&&$e.kind!==v.TokenKind.MultiLineComment&&!($e.kind in F)}function k($e){return $e.kind===v.TokenKind.Spaces||$e.kind===v.TokenKind.SingleLineComment||$e.kind===v.TokenKind.MultiLineComment}function x($e,qe){return B(qe=qe.kind===F.MaybeWSFTerm?qe.node:qe)?(0,S.getNodeSpan)($e,qe).start:qe.start}(function($e){$e.LambdaArgsTerm="LambdaArgsTerm",$e.ArgsTerm="ArgsTerm",$e.FieldRefTerm="FieldRefTerm",$e.StructRefTerm="StructRefTerm",$e.MaybeWSFTerm="MaybeWSFTerm"})(F=t.TermKind||(t.TermKind={})),t.lambdaArgsTerm=function($e,qe,fr,lr){return{kind:F.LambdaArgsTerm,nodes:$e,isClosed:qe,start:fr,end:lr}},t.argsTerm=function($e,qe,fr,lr){return{kind:F.ArgsTerm,nodes:$e,isClosed:qe,start:fr,end:lr}},t.fieldRefTerm=w,t.structRefTerm=function($e,qe,fr){return{kind:F.StructRefTerm,rhs:$e,start:qe,end:fr}},t.maybeWSFTerm=function($e,qe){return{kind:F.MaybeWSFTerm,node:$e,whole:qe}};var G=(0,h.many)((0,h.take)(function($e,qe){return k(qe)?qe:void 0})),H=(0,h.many1)((0,h.take)(function($e,qe){return k(qe)?qe:void 0})),L=(0,h.peek)(function($e,qe){return qe}),D=function(qe,fr,lr,dn,Un){var Gr=qe[fr];if(Gr==null){var Br="calc.parse.pStart: internal error: expected term at "+fr+" in "+(0,c.anonymize)(qe);return(0,l.assertFalse)(Br)}return dn(x(lr,Gr),fr)};function U($e){return(0,h.apply)((0,h.tuple)(G,D,(0,h.take)($e),D,G),function(qe,fr){var lr=Mr(fr,5),dn=lr[0],Un=lr[1],Gr=lr[2],Br=lr[3],bt=lr[4];return(0,f.operatorNode)(Gr,(0,S.addSpan)(qe,Un,Br,dn,bt))})}function V($e){return(0,h.apply)((0,h.tuple)(G,D,(0,h.take)($e),D),function(qe,fr){var lr=Mr(fr,4),dn=lr[0],Un=lr[1],Gr=lr[2],Br=lr[3];return(0,f.operatorNode)(Gr,(0,S.addSpan)(qe,Un,Br,dn,""))})}function ne($e){return(0,h.apply)((0,h.tuple)(D,(0,h.take)($e),D,G),function(qe,fr){var lr=Mr(fr,4),dn=lr[0],Un=lr[1],Gr=lr[2],Br=lr[3];return(0,f.operatorNode)(Un,(0,S.addSpan)(qe,dn,Gr,"",Br))})}var J=U(function($e,qe){return qe.kind!==v.TokenKind.Operator||qe.value!==p.OperatorId.Add&&qe.value!==p.OperatorId.Sub?void 0:qe.value}),$=ne(function($e,qe){if(qe.kind===v.TokenKind.Operator){if(qe.value===p.OperatorId.Add)return p.OperatorId.Pos;if(qe.value===p.OperatorId.Sub)return p.OperatorId.Neg}}),Z=ne(function($e,qe){return qe.kind===v.TokenKind.Operator&&qe.value===p.OperatorId.At?qe.value:void 0}),ie=V(function($e,qe){return qe.kind===v.TokenKind.Operator&&qe.value===p.OperatorId.Pound?qe.value:void 0}),X=(0,h.take)(function($e,qe){return qe.kind===F.StructRefTerm?qe:void 0}),Q=U(function($e,qe){return qe.kind!==v.TokenKind.Operator||qe.value!==p.OperatorId.Mul&&qe.value!==p.OperatorId.Div?void 0:qe.value}),b=U(function($e,qe){return qe.kind===v.TokenKind.Operator&&qe.value===p.OperatorId.Pow?qe.value:void 0}),R=V(function($e,qe){return qe.kind===v.TokenKind.Operator&&qe.value===p.OperatorId.Percent?qe.value:void 0}),P=U(function($e,qe){return qe.kind===v.TokenKind.Operator&&qe.value===p.OperatorId.Concat?qe.value:void 0}),A=U(function($e,qe){return qe.kind===v.TokenKind.Operator&&qe.value>=p.OperatorId.Eq&&qe.value<=p.OperatorId.Ge?qe.value:void 0}),T=U(function($e,qe){return qe.kind===v.TokenKind.Operator&&qe.value===p.OperatorId.Range?qe.value:void 0}),g=U(function($e,qe){return qe.kind===v.TokenKind.Operator&&qe.value===p.OperatorId.Union?qe.value:void 0}),O=(0,h.applyTake)((0,h.tuple)(H,L),function($e,qe){var fr=Mr(qe,2),lr=fr[0],dn=fr[1];if(!(dn.kind===v.TokenKind.End||dn.kind===v.TokenKind.Operator&&dn.value!==p.OperatorId.At||dn.kind===v.TokenKind.Sep&&(0,C.isDotSepToken)(dn))){if(lr.length!==1||lr[0].kind!==v.TokenKind.Spaces)return lr;var Un=x($e,dn),Gr=(0,S.addSpan)($e,Un,Un,lr[0].chars,"");return(0,f.operatorNode)(p.OperatorId.Isect,Gr)}}),M=(0,h.take)(function($e,qe){return qe.kind===v.TokenKind.Sep&&(0,C.isDotSepToken)(qe)?qe:void 0}),K=(0,h.take)(function($e,qe){return qe.kind===F.ArgsTerm?qe:void 0}),W=(0,h.take)(function($e,qe){return qe.kind===F.LambdaArgsTerm?qe:void 0}),z=(0,h.take)(function($e,qe){return qe.kind===F.ArgsTerm||qe.kind===F.FieldRefTerm?qe:void 0}),ee=(s={},Qe(s,p.WorksheetFuncId.LETREC,I.FeatureName.CalcLetRecFunction),Qe(s,p.WorksheetFuncId.LAMBDA,I.FeatureName.CalcLambdaFunction),s);function ue($e,qe){if(qe.kind===F.MaybeWSFTerm&&qe.whole!==void 0){var fr=(0,y.getWorksheetFuncId)($e,qe.whole);if(fr===void 0)return;(0,l.assertTrue)("calc.parse.parseWSFName: unexpected UDF",fr!==p.WorksheetFuncId._UDF);var lr=ee[fr];return lr!==void 0&&!(0,I.isFeatureEnabled)(lr)?void 0:(0,f.wsfNode)(fr,qe.whole,qe.node.label)}}t.isWSFNode=ue;var ce=(0,h.take)(function($e,qe){return ue($e.localeInfo,qe)}),he=(0,h.take)(function($e,qe){var fr=ue($e.localeInfo,qe);return(fr==null?void 0:fr.id)===p.WorksheetFuncId.LAMBDA?fr:void 0}),de=(0,h.apply)((0,h.tuple)(he,W),function($e,qe){for(var fr=Mr(qe,2),lr=fr[0],dn=fr[1],Un=(0,S.getNodeSpan)($e,lr).start,Gr=dn.nodes,Br=(lr.id,[]),bt,Kr=[],Pt=0;Pt<Gr.length;Pt+=1){var Mi=Gr[Pt];Mi.kind===f.NodeKind.Param?Br.push((0,f.lambdaParam)((0,f.indexedArg)(Mi,Pt))):Pt===Gr.length-1?bt=(0,f.indexedArg)(Mi,Pt):Kr.push((0,f.indexedArg)(Mi,Pt))}var El=(0,S.addSpan)($e,Un,dn.end,"","");return(0,f.lambdaNode)(lr,Br,bt,Kr,dn.isClosed,El)}),pe=(0,h.apply)((0,h.tuple)(ce,K),function($e,qe){var fr=Mr(qe,2),lr=fr[0],dn=fr[1],Un=(0,S.getNodeSpan)($e,lr).start,Gr=dn.nodes;switch(lr.id){case p.WorksheetFuncId.LET:case p.WorksheetFuncId.LETREC:{lr.id;for(var Br=[],bt=[],Kr,Pt=0;Pt<Gr.length;Pt+=1){var Mi=Gr[Pt];Pt!==Gr.length-1?!(Pt+1<Gr.length&&(0,y.isUnqualifiedNameNode)(Mi))||Pt+3<Gr.length&&(Nl=$e.refStyle,ys=Gr[Pt+2],!((0,y.isUnqualifiedNameNode)(ys)||Nl===f.RefStyle.A1&&ys.kind===f.NodeKind.CellRef&&ys.qualifier===void 0&&ys.ref.kind===f.CellRefKind.Single&&ys.ref.col.kind===f.PosKind.Rel&&ys.ref.row.kind===f.PosKind.Rel))&&(0,y.isUnqualifiedNameNode)(Gr[Pt+1])?bt.push((0,f.indexedArg)(Mi,Pt)):(Br.push((0,f.letVar)((0,f.indexedArg)(Mi,Pt),(0,f.indexedArg)(Gr[Pt+1],Pt+1))),Pt+=1):Kr=(0,f.indexedArg)(Mi,Pt)}var El=(0,S.addSpan)($e,Un,dn.end,"","");return(0,f.letNode)(lr,Br,Kr,bt,dn.isClosed,El)}case p.WorksheetFuncId.LAMBDA:return(0,l.assertFalse)("calc.parse.parseWSFApp: unexpected LAMBDA+ArgTerm")}var Nl,ys;return Le($e,lr,Gr,dn.isClosed,Un,dn.end)});function _e($e,qe,fr){return(0,h.apply)((0,h.tuple)((0,h.many)($e),qe),function(lr,dn){var Un=Mr(dn,2),Gr=Un[0],Br=Un[1];return Gr.reduceRight(fr(lr),Br)})}function Ce($e,qe,fr){return(0,h.apply)((0,h.tuple)($e,(0,h.many)(qe)),function(lr,dn){var Un=Mr(dn,2),Gr=Un[0],Br=Un[1];return Br.reduce(fr(lr),Gr)})}function Ne($e){return function(qe,fr){var lr=Mr(fr,2),dn=lr[0],Un=lr[1];if(Mi=dn,Array.isArray(Mi)){var Gr,Br,bt=(0,S.getNodeSpan)($e,qe);(0,l.assertTrue)("calc.parse.makeAppNodeInfix",bt.post.length===0),Gr=(0,S.addWhitespace)($e,dn),Br=Mr(Gr,2),bt.post=Br[0],bt.postComments=Br[1];var Kr=(0,S.getNodeSpan)($e,Un),Pt=(0,S.addSpan)($e,bt.start,Kr.end,"","");return(0,f.badNode)(f.BadType.Sequence,[qe,Un],Pt)}var Mi,El=(0,S.getNodeSpan)($e,qe).start,Nl=(0,S.getNodeSpan)($e,Un).end,ys=(0,S.addSpan)($e,El,Nl,"","");return(0,f.appNode)(dn,[qe,Un],!0,ys)}}function Le($e,qe,fr,lr,dn,Un){var Gr=(0,S.addSpan)($e,dn,Un,"","");return(0,f.appNode)(qe,fr,lr,Gr)}function Oe($e){return function(qe,fr){var lr=(0,S.getNodeSpan)($e,qe).start;switch(fr.kind){case F.ArgsTerm:return Le($e,qe,fr.nodes,fr.isClosed,lr,fr.end);case F.FieldRefTerm:{var dn=(0,S.addSpan)($e,lr,fr.end,"",""),Un=(0,S.getNodeSpan)($e,fr.rhs),Gr=Un.start,Br=Un.end,bt=Un.pre;if((0,y.isNumberNode)(qe)){var Kr=(0,S.addSpan)($e,Gr,Gr,"",""),Pt=(0,f.literalNode)(m.missingOper,!0,Kr),Mi=fr.rhs.label,El=(0,S.addSpan)($e,Gr,Br,"",""),Nl=(0,f.fieldRef)(fr.rhs.field,fr.rhs.isBracketed,fr.rhs.isClosed,El),ys=!1;return(0,f.badNode)(f.BadType.FieldRef,[qe,(0,f.fieldRefNode)(Pt,Nl,ys,Mi)],dn)}var _d=!fr.rhs.isBracketed&&(0,y.shouldFieldRefBeBracketed)(qe,fr.rhs,bt);return(0,f.fieldRefNode)(qe,fr.rhs,_d,dn)}case F.StructRefTerm:{var xu=(0,S.addSpan)($e,lr,fr.end,"","");return qe.kind===f.NodeKind.Name||(0,y.isMissingNode)(qe)?(0,f.structRefNode)(qe.kind===f.NodeKind.Name?qe:void 0,fr.rhs,xu):(0,f.badNode)(f.BadType.StructRef,[qe,(0,f.structRefNode)(void 0,fr.rhs,(0,S.addSpan)($e,fr.start,fr.end,"",""))],xu)}case f.NodeKind.Operator:return Le($e,fr,[qe],!0,lr,(0,S.getNodeSpan)($e,fr).end)}}}function le($e){var qe=!0;return function(fr,lr){var dn=(0,S.getNodeSpan)($e,lr).start,Un=(0,S.getNodeSpan)($e,fr).end,Gr=(0,S.addSpan)($e,dn,Un,"","");if((lr.id===p.OperatorId.Pos||lr.id===p.OperatorId.Neg)&&qe&&(qe=!1,(0,y.isNumberNode)(fr)&&(0,S.getNodeSpan)($e,lr).post==="")){var Br=lr.id===p.OperatorId.Pos?fr.oper:$e.mathpack.neg(fr.oper);return(0,f.literalNode)(Br,!0,Gr)}return(0,f.appNode)(lr,[fr],!0,Gr)}}var me=(0,h.take)(function($e,qe){return qe.kind===F.MaybeWSFTerm?qe.node:B(qe)?qe:void 0}),Pe=(0,h.apply)((0,h.tuple)(G,M,D,G),function($e,qe){var fr=Mr(qe,4),lr=fr[0],dn=fr[1],Un=fr[2],Gr=fr[3];return(0,f.badNode)(f.BadType.Unexpected,dn.chars,(0,S.addSpan)($e,dn.start,Un,lr,Gr))}),Re=(0,h.apply)((0,h.tuple)(D,G,M,D),function($e,qe){var fr=Mr(qe,4),lr=fr[0],dn=fr[1],Un=fr[2],Gr=fr[3],Br=(0,S.addSpan)($e,Gr,Gr,"",""),bt=(0,S.addSpan)($e,Un.start,Gr,dn,""),Kr=(0,f.fieldRef)((0,f.badNode)(f.BadType.Missing,"",Br),!1,!0,bt);return w(dn.length>0,Kr,lr,Gr)}),fe=(0,h.lazy)(function(){return(0,h.apply)((0,h.tuple)(D,(0,h.many)((0,h.any)(de,pe,me,Pe),(0,h.any)(de,pe,me,(0,h.right)((0,h.succeeds)(Z),Ve))),D),function($e,qe){var fr=Mr(qe,3),lr=fr[0],dn=fr[1],Un=fr[2];if(dn.length===1)return dn[0];var Gr=(0,S.addSpan)($e,lr,Un,"","");return dn.length===0?(0,f.literalNode)(m.missingOper,!0,Gr):(0,f.badNode)(f.BadType.Sequence,dn,Gr)})}),Se=Ce((0,h.lazy)(function(){return(0,h.any)((0,h.right)((0,h.succeeds)(Z),Ve),(0,h.right)((0,h.succeeds)($),gr),fe)}),(0,h.any)(ie,X),Oe),be=Ce(Se,(0,h.tuple)(T,Se),Ne),xe=Ce(be,(0,h.tuple)(O,be),Ne),Ie=Ce(xe,(0,h.any)(z,Re),Oe),Ve=_e(Z,Ie,le),Ze=Ce(Ve,(0,h.tuple)(g,Ve),Ne),gr=_e($,Ze,le),cr=Ce(gr,R,Oe),_r=Ce(cr,(0,h.tuple)(b,cr),Ne),xr=Ce(_r,(0,h.tuple)(Q,_r),Ne),Or=Ce(xr,(0,h.tuple)(J,xr),Ne),Rr=Ce(Or,(0,h.tuple)(P,Or),Ne),ir=Ce(Rr,(0,h.tuple)(A,Rr),Ne);t.runOperatorPrecedenceParser=function($e,qe){var fr=qe.length-1;if(fr<1){var lr="calc.parse.runTermParser: internal error: expected at least 1 term";return(0,l.assertFalse)(lr)}if(qe[fr].kind!==v.TokenKind.End){var dn="calc.parse.runTermParser: internal error: array[n].kind !== End in "+(0,c.anonymize)(qe);return(0,l.assertFalse)(dn)}if(fr===1&&B(qe[0]))return qe[0];if(k(qe[0])){var Un="calc.parse.runTermParser: internal error: array[0].kind === Spaces/comment in "+(0,c.anonymize)(qe);return(0,l.assertFalse)(Un)}if(k(qe[fr-1])){var Gr="calc.parse.runTermParser: internal error: array[n-1].kind === Spaces/comment in "+(0,c.anonymize)(qe);return(0,l.assertFalse)(Gr)}for(;;){var Br=(0,h.runParser)(ir,qe,0,$e);if((0,E.isSuccess)(Br)&&Br.value.index>=fr)return Br.value.output;if(!(0,E.isSuccess)(Br)||Br.value.index===0||Br.value.index===1&&B(qe[0])){var bt="calc.parse.runTermParser: internal error: consumed "+((0,E.isSuccess)(Br)?Br.value.index:0)+" out of "+fr+" in "+(0,c.anonymize)(qe);return(0,l.assertFalse)(bt)}fr=(qe=[Br.value.output].concat(Pc(qe.slice(Br.value.index)))).length-1}}},6738:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseQualifier=void 0;var s=d(9866),c=d(7971),l=d(7371),f=d(7110),p=d(7577),m=d(3206),v=d(6672),h=d(8952),S=d(4666);function y(R){return R.kind===p.TokenKind.Literal&&R.oper.kind===v.OperKind.Boolean}var C=m.codePointFullStop,E=(0,c.opt)((0,c.takePeek)(function(R,P,A){return P.kind!==p.TokenKind.Spaces||(0,f.isWhitespaceToken)(A)?void 0:P.chars}),""),I=(0,c.take)(function(R,P){return P.isIdentContinue&&!y(P)&&P.chars.length>0&&P.chars.charCodeAt(0)!==C?P.chars:void 0}),F=(0,c.take)(function(R,P){return P.isIdentContinue||(0,f.isDotSepToken)(P)?P.chars:void 0}),w=(0,c.apply)((0,c.many1)(I,F),function(R,P){return P.join("")}),B=(0,c.take)(function(R,P){return P.kind===p.TokenKind.Ident?P.chars:void 0}),k=function(P,A){var T;return((T=A.path)!==null&&T!==void 0?T:"")+P.leftBracket+A.document+P.rightBracket};function x(R,P,A,T,g,O){var M,K;if(P==null)T==null?(M=(0,s.identQualifier)(A,g,O),K=A):(M=(0,s.sheetRangeQualifier)(A,T,void 0,g,O),K=A+":"+T);else{var W=k(R.localeInfo,P);T==null?(M=(0,s.sheetQualifier)(A,P,g,O),K=""+W+A):(M=(0,s.sheetRangeQualifier)(A,T,P,g,O),K=""+W+A+":"+T)}return[M,g?(0,h.quoteQualifier)(K):K]}var G=(0,c.take)(function(R,P){return P.kind===p.TokenKind.Ident||(0,f.isRangeOpToken)(P)?P.chars:void 0}),H=(0,c.apply)((0,c.tuple)(f.parseCharIndex,(0,c.many)(G),f.parseLeftBracket,(0,c.many1)(G),f.parseRightBracket,f.parseCharIndex),function(R,P){var A=Mr(P,6),T=A[0],g=A[1],O=A[2],M=A[3],K=A[4],W=A[5],z=g.join(""),ee=M.join("");return(0,s.documentQualifier)(ee,z!==""?z:void 0,!0,(0,l.addSpan)(R,T,W,"",""))}),L=(0,c.apply)((0,c.tuple)(f.parseCharIndex,f.parseLeftBracket,(0,c.many1)(F),f.parseRightBracket,f.parseCharIndex),function(R,P){var A=Mr(P,5),T=A[0],g=A[1],O=A[2],M=A[3],K=A[4],W=O.join("");return(0,s.documentQualifier)(W,void 0,!1,(0,l.addSpan)(R,T,K,"",""))}),D=(0,c.apply)((0,c.tuple)(f.parseCharIndex,(0,c.opt)(L,void 0),w,(0,c.opt)((0,c.right)(f.parseRangeOp,w),void 0),f.parseCharIndex),function(R,P){var A=Mr(P,5),T=A[0],g=A[1],O=A[2],M=A[3],K=A[4];return x(R,g,O,M,!1,(0,l.addSpan)(R,T,K,"",""))}),U=(0,c.apply)((0,c.tuple)(f.parseLeftSQuote,(0,c.opt)(H,void 0),B,(0,c.opt)((0,c.right)(f.parseRangeOp,B),void 0),f.parseRightSQuote,f.parseCharIndex),function(R,P){var A=Mr(P,6),T=A[0],g=A[1],O=A[2],M=A[3],K=A[4],W=A[5];return x(R,g,O,M,!0,(0,l.addSpan)(R,T.start,W,"",""))}),V=(0,c.apply)(L,function(R,P){return[P,k(R.localeInfo,P)]}),ne=(0,c.apply)((0,c.tuple)(f.parseLeftSQuote,H,f.parseRightSQuote),function(R,P){var A=Mr(P,3),T=A[0],g=A[1],O=A[2];return[g,(0,h.quoteQualifier)(k(R.localeInfo,g))]}),J=(0,c.take)(function(R,P){return P.kind===p.TokenKind.End||P.kind===p.TokenKind.Right&&P.value===p.DelimId.SQuote?void 0:P.chars}),$=(0,c.apply)((0,c.tuple)(f.parseLeftSQuote,(0,c.many)(J),(0,c.opt)((0,c.tuple)(f.parseRightSQuote,(0,c.opt)((0,c.tuple)(f.parseQualSep,E),[void 0,""])),[void 0,[void 0,""]]),f.parseCharIndex),function(R,P){var A=Mr(P,4),T=A[0],g=A[1],O=Mr(A[2],2),M=O[0],K=Mr(O[1],2),W=K[0],z=K[1],ee=A[3],ue="'"+g.join("")+(M!==void 0?"'":"")+(W!==void 0?"!":""),ce=(0,l.addSpan)(R,T.start,ee-z.length,"",z);return[(0,s.badQualifier)(ue,!0,ce),ue]}),Z=(0,c.takePeek)(function(R,P,A){if((0,f.isRefErrorToken)(P)){var T=(0,l.addSpan)(R,P.start,A.start,"","");return[(0,s.errorQualifier)(T),P.chars]}}),ie=(0,c.peek)(function(R,P){var A=(0,l.addSpan)(R,P.start,P.start,"","");return[(0,s.relativeQualifier)(A),""]}),X=(0,c.apply)((0,c.tuple)((0,c.any)(D,U,V,ne,ie),f.parseQualSep,E),function(R,P){var A=Mr(P,3),T=Mr(A[0],2),g=T[0],O=T[1],M=A[1],K=A[2],W=(0,l.getNodeSpan)(R,g);return W.end+=1,(0,S.assertTrue)("calc.parse.parseGoodQualifier",W.post.length===0),W.post=K,[g,O+"!"]}),Q=(0,c.take)(function(R,P){return P.isIdentContinue||(0,f.isDotSepToken)(P)||y(P)||function(A){return A.kind===p.TokenKind.Literal&&(0,p.isNumberLikeOper)(A.oper)}(P)?P.chars:void 0}),b=(0,c.apply)((0,c.tuple)(f.parseCharIndex,(0,c.many)(Q),f.parseQualSep,f.parseCharIndex,E),function(R,P){var A=Mr(P,5),T=A[0],g=A[1],O=A[2],M=A[3],K=A[4],W=g.join("")+"!",z=(0,l.addSpan)(R,T,M,"",K);return[(0,s.badQualifier)(W,!1,z),W]});t.parseQualifier=(0,c.any)(Z,X,b,$)},7914:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseRef=t.parseUnqualBadRef=t.isCompleteCellRefToken=void 0;var s=d(7081),c=d(4666),l=d(9866),f=d(5630),p=d(5079),m=d(7577),v=d(7971),h=d(4828),S=d(7371),y=d(6982),C=d(7110),E=d(6738),I=d(6672),F=d(2636),w=d(3075);function B(M,K){return M.refStyle===K.refStyle&&!K.isBadLocale&&K.row!==p.SpecialPos.A1BadDollar&&K.col!==p.SpecialPos.A1BadDollar}function k(M){return M.refStyle===l.RefStyle.R1C1||typeof M.row=="object"&&typeof M.col=="object"}function x(M,K){return K.kind===m.TokenKind.CellRef&&B(M,K)&&k(K)}t.isCompleteCellRefToken=x;var G=(0,l.pos)(l.PosKind.Rel,0);function H(M){return M===p.SpecialPos.RCNoNum?G:M}function L(M,K){if(M.row!==p.SpecialPos.A1BadDollar&&M.col!==p.SpecialPos.A1BadDollar){var W=M.refStyle===l.RefStyle.R1C1&&!M.isIdentContinue;if(M.row!=null&&M.col!=null)return(0,l.cellRefSingle)(H(M.row),H(M.col),W,K);if(M.row!=null){var z=H(M.row);return(0,l.cellRefRow)(z,z,W,K)}if(M.col!=null){var ee=H(M.col);return(0,l.cellRefCol)(ee,ee,W,K)}}var ue="calc.parse.cellRefToken2cellRef: bad token "+(0,s.anonymize)(M);return(0,c.assertFalse)(ue)}function D(M,K){return K.isIdentContinue&&M.localeInfo.isIdentStart((0,F.stringCodePointAt)(K.chars,0))}var U=(0,v.take)(function(M,K){return x(M,K)&&!D(M,K)||(0,C.isRefErrorToken)(K)?K:void 0}),V=(0,v.take)(function(M,K){return x(M,K)&&D(M,K)?K:void 0}),ne=(0,v.apply)((0,v.tuple)((0,v.any)(U,(0,v.withState)(function(M){return M.cellRefMustBeCellRefNode?V:(0,v.left)(V,(0,v.fails)((0,v.any)(C.parseIdentContinue,C.parseDotSepTokenNotFollowedByLeftBracket)))})),C.parseCharIndex),function(M,K){var W=Mr(K,2),z=W[0],ee=W[1],ue=z.kind===m.TokenKind.CellRef?L(z,(0,S.addSpan)(M,z.start,ee,"","")):(0,l.cellRefError)((0,S.addSpan)(M,z.start,ee,"","")),ce=z.kind===m.TokenKind.CellRef?z.chars:void 0;return(0,h.maybeWSFTerm)((0,l.cellRefNode)(ue,void 0,(0,S.addSpan)(M,z.start,ee,"","")),ce)}),J=(0,v.takePeek)(function(M,K,W){return K.kind!==m.TokenKind.CellRef||!B(M,K)||function(z,ee,ue){return ue.kind===m.TokenKind.Left&&ue.value===m.DelimId.Paren&&ee.isIdentContinue&&(0,y.getWorksheetFuncId)(z.localeInfo,ee.chars)!=null}(M,K,W)||W.isIdentContinue?void 0:[K,W.start]}),$=(0,v.bind)((0,v.tuple)(J,C.parseSpacesOnly,C.parseRangeOp,C.parseSpacesOnly,J),function(M,K){var W=Mr(K,5),z=Mr(W[0],2),ee=z[0],ue=z[1],ce=W[1],he=W[2],de=W[3],pe=Mr(W[4],2),_e=pe[0],Ce=pe[1],Ne=(0,S.addSpan)(M,ee.start,ue,"",ce),Le=(0,S.addSpan)(M,_e.start,Ce,de,""),Oe=L(ee,Ne),le=L(_e,Le),me;if(Oe.kind===l.CellRefKind.Single&&le.kind===l.CellRefKind.Single){var Pe=(0,S.addSpan)(M,ee.start,Ce,"","");me=(0,l.cellRefRange)(Oe,le,Pe)}else if(ce.length===0&&de.length===0){if(Oe.kind===l.CellRefKind.Row&&le.kind===l.CellRefKind.Row){var Re=Oe.isBracketed||le.isBracketed,fe=(0,S.addSpan)(M,ee.start,Ce,"","");me=(0,l.cellRefRow)(Oe.row1,le.row1,Re,fe)}else if(Oe.kind===l.CellRefKind.Col&&le.kind===l.CellRefKind.Col){var Se=Oe.isBracketed||le.isBracketed,be=(0,S.addSpan)(M,ee.start,Ce,"","");me=(0,l.cellRefCol)(Oe.col1,le.col1,Se,be)}}if(me==null)return(0,v.parseFail)();var xe=(0,h.maybeWSFTerm)((0,l.cellRefNode)(me,void 0,(0,S.addSpan)(M,ee.start,Ce,"","")),void 0);return ee.isIdentContinue&&_e.isIdentContinue?(0,v.peek)(function(Ie,Ve){return Ve.kind===m.TokenKind.Sep&&Ve.value===m.SepId.Qual?void 0:xe}):(0,v.parseSucceed)(xe)}),Z=(0,v.any)($,ne);t.parseUnqualBadRef=(0,v.apply)((0,v.take)(function(M,K){return K.kind===m.TokenKind.CellRef?K:void 0}),function(M,K){var W=K.start+K.chars.length,z=K.refStyle===l.RefStyle.R1C1&&!K.isIdentContinue;return(0,h.maybeWSFTerm)((0,l.cellRefNode)((0,l.cellRefBad)(K.chars,z,(0,S.addSpan)(M,K.start,W,"","")),void 0,(0,S.addSpan)(M,K.start,W,"","")),K.chars)});var ie=(0,v.take)(function(M,K){return K.kind===m.TokenKind.Ident&&M.localeInfo.isIdentStart((0,F.stringCodePointAt)(K.chars,0))||K.kind===m.TokenKind.CellRef&&D(M,K)?K:void 0}),X=(0,v.take)(function(M,K){return K.kind===m.TokenKind.Literal&&K.oper.kind===I.OperKind.Boolean?K:void 0}),Q=(0,v.any)(ie,(0,v.left)(X,(0,v.succeeds)(C.parseDotSepTokenNotFollowedByLeftBracket))),b=(0,v.peek)(function(M,K){return(0,C.isLeftBracketToken)(K)}),R=(0,v.tuple)((0,v.many1)(Q,C.parseIdentContinue),(0,v.many)((0,v.any)(C.parseIdentContinue,C.parseDotSepTokenNotFollowedByLeftBracket)),b,C.parseCharIndex),P=(0,v.apply)(R,function(M,K){var W=Mr(K,4),z=W[0],ee=W[1],ue=W[2],ce=W[3],he,de,pe,_e,Ce,Ne=z[0],Le=z.length===1&&((he=ee[0])===null||he===void 0?void 0:he.kind)===m.TokenKind.Sep,Oe=Ne.kind!==m.TokenKind.CellRef||(le=Ne).refStyle===l.RefStyle.A1&&le.row==null&&typeof le.col=="object"&&le.col.kind===l.PosKind.Rel||function(qe,fr){return fr.refStyle===l.RefStyle.A1&&qe.refStyle===l.RefStyle.A1&&fr.isIdentContinue||fr.refStyle===l.RefStyle.R1C1&&(0,p.isR1C1IdentStart)(fr.row,fr.col)}(M,Ne)&&Le,le;if(ue||function(qe,fr,lr){return lr.length===0||fr.length===1&&fr[0].kind===m.TokenKind.Literal||lr.some(function(dn,Un){return Un%2==0?dn.kind!==m.TokenKind.Sep:dn.kind===m.TokenKind.Sep||!(0,w.isUnbracketedField)(qe.localeInfo,dn.chars)})}(M,z,ee)){var me=[].concat(Pc(z),Pc(ee)).map(function(qe){return qe.chars}).join(""),Pe=(0,S.addSpan)(M,Ne.start,ce,"",""),Re=(0,S.addSpan)(M,Ne.start,ce,"",""),fe=(0,l.identNamePart)(me,Oe,Pe,Re),Se=(0,l.nameNode)(fe,void 0,(0,S.addSpan)(M,Ne.start,ce,"",""));return(0,h.maybeWSFTerm)(Se,Se.whole)}var be,xe=Oe,Ie=0,Ve=(pe=(de=ee[Ie])===null||de===void 0?void 0:de.start)!==null&&pe!==void 0?pe:ce,Ze=(0,S.addSpan)(M,Ne.start,Ve,"",""),gr=(0,S.addSpan)(M,Ne.start,Ve,"","");if(z.length===1&&Ne.kind===m.TokenKind.CellRef)if(B(M,Ne))if(k(Ne)){var cr=L(Ne,(0,S.addSpan)(M,Ne.start,Ve,"",""));be=(0,l.cellRefNamePart)(cr,Ne.chars,Ze,gr)}else be=(0,l.identNamePart)(Ne.chars,xe,Ze,gr);else xe=!1,be=(0,l.identNamePart)(Ne.chars,xe,Ze,gr);else{var _r=z.map(function(qe){return qe.chars}).join("");M.localeInfo.stringCompareCI(_r,"_xlpm")===0&&Ie+1<ee.length&&(_r+="."+ee[Ie+1].chars,Ie+=2),be=(0,l.identNamePart)(_r,xe,Ze,gr)}for(var xr=be;Ie+1<ee.length;Ie+=2){var Or=ee[Ie+1],Rr=(Ce=(_e=ee[Ie+2])===null||_e===void 0?void 0:_e.start)!==null&&Ce!==void 0?Ce:ce,ir=(0,S.addSpan)(M,Or.start,Rr,"","");xr=(0,l.fieldRefNamePart)(xr,(0,l.fieldRef)((0,l.nameNode)((0,l.identNamePart)(Or.chars,void 0,ir,ir),void 0,(0,S.addSpan)(M,Or.start,Rr,"","")),!1,!0,(0,S.addSpan)(M,Or.start,Rr,"","")),Ie+2>=ee.length?Oe:xe,(0,S.addSpan)(M,Ne.start,Rr,"",""),(0,S.addSpan)(M,Ne.start,Rr,"",""))}Ie<ee.length&&(xr=(0,l.fieldRefNamePart)(xr,void 0,Oe,(0,S.addSpan)(M,Ne.start,ce,"",""),(0,S.addSpan)(M,Ne.start,ce,"","")),Ie+=1),(0,c.assertTrue)("calc.parse.pUnqualName: i == tailTokens",Ie===ee.length),xr.kind===l.NamePartKind.CellRefNamePart&&(0,c.assertFalse)("calc.parse.pUnqualName: expected lhs.kind !== NamePartKind.CellRefNamePart");var $e=(0,l.nameNode)(xr,void 0,(0,S.addSpan)(M,Ne.start,ce,"",""));return(0,h.maybeWSFTerm)($e,$e.whole)}),A=(0,v.opt)((0,v.any)(Z,P,t.parseUnqualBadRef),{node:void 0}),T=(0,v.any)(Z,(0,v.right)((0,v.fails)(P),t.parseUnqualBadRef)),g=(0,v.bind)(E.parseQualifier,function(M,K){var W=Mr(K,2),z=W[0],ee=W[1];return(0,v.apply)(z.kind===l.QualifierKind.SheetRange?(0,S.cellRefMustBeCellRefNode)(z.isQuoted?A:T):z.kind===l.QualifierKind.Error?(0,S.cellRefMustBeCellRefNode)(A):A,function(ue,ce){var he=ce.node;if(he==null)return z.kind===l.QualifierKind.Error?(0,l.literalNode)(f.refErrorOper,!0,z.label):(0,l.badNode)(l.BadType.Qualifier,ee,z.label);var de=(0,S.getNodeSpan)(ue,z).start,pe=(0,S.getNodeSpan)(ue,he).end;if(he.kind===l.NodeKind.Name){var _e=(0,S.addSpan)(ue,de,pe,"","");if(z.kind===l.QualifierKind.Error){var Ce=(0,l.literalNode)(f.refErrorOper,!0,z.label);return(0,l.badNode)(l.BadType.Sequence,[Ce,he],_e)}return(0,c.assertTrue)("calc.parse.pQualRef: sheet-range-name quoted",z.kind!==l.QualifierKind.SheetRange||z.isQuoted),(0,l.nameNode)(function(Le,Oe,le){for(var me=Oe;(0,S.getSpan)(Le,me.qualifiedLabel).start=le,me.kind===l.NamePartKind.FieldRefNamePart;)me=me.lhs;return Oe}(ue,he.parts,de),z,_e)}var Ne=(0,S.addSpan)(ue,de,pe,"","");return z.kind===l.QualifierKind.Ident&&(z=(0,l.sheetQualifier)(z.name,void 0,z.isQuoted,z.label)),(0,l.cellRefNode)(he.ref,z,Ne)})}),O=(0,v.apply)((0,v.any)(Z,P),function(M,K){return K.node.kind===l.NodeKind.CellRef&&K.node.ref.kind===l.CellRefKind.Error?(0,l.literalNode)(f.refErrorOper,!0,K.node.label):K});t.parseRef=(0,v.any)(g,O)},1913:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseStructRef=void 0;var s=d(7971),c=d(4828),l=d(7110),f=d(9866),p=d(7371),m=d(7577),v=d(3357),h=(0,s.take)(function(A,T){return T.isIdentContinue||T.kind===m.TokenKind.Spaces?T:void 0}),S=(0,s.apply)((0,s.many1)(h),function(A,T){var g=T[0];return T.length===1?g:(0,m.identToken)(g.start,T.map(function(O){return O.kind===m.TokenKind.Escape?"":O.chars}).join(""))}),y=(0,s.take)(function(A,T){return T.isIdentContinue||T.kind===m.TokenKind.Spaces||T.kind===m.TokenKind.Escape||(0,l.isListSepToken)(T)||(0,l.isRangeOpToken)(T)?T:void 0}),C=(0,s.apply)((0,s.many1)(y),function(A,T){var g=T[0];return T.length===1?g:(0,m.identToken)(g.start,T.map(function(O){return O.kind===m.TokenKind.Escape?"":O.chars}).join(""))}),E=(0,s.take)(function(A,T){return T.kind===m.TokenKind.SpecialRef?T:void 0}),I=(0,s.apply)((0,s.tuple)(l.parseCharIndex,E,l.parseCharIndex),function(A,T){var g=Mr(T,3),O=g[0],M=g[1],K=g[2];return(0,f.specialRef)(M.value,!1,!0,(0,p.addSpan)(A,O,K,"",""))}),F=(0,s.apply)((0,s.tuple)(l.parseCharIndex,l.parseLeftBracket,E,(0,s.opt)(l.parseRightBracket,void 0),l.parseCharIndex),function(A,T){var g=Mr(T,5),O=g[0],M=g[1],K=g[2],W=g[3],z=g[4];return(0,f.specialRef)(K.value,!0,W!==void 0,(0,p.addSpan)(A,O,z,"",""))}),w=(0,s.any)(I,F),B=(0,s.apply)((0,s.tuple)(l.parseCharIndex,S,l.parseCharIndex),function(A,T){var g=Mr(T,3),O=g[0],M=g[1],K=g[2];return(0,f.columnRef)(M.chars,!1,!0,(0,p.addSpan)(A,O,K,"",""))}),k=(0,s.apply)((0,s.tuple)(l.parseCharIndex,l.parseLeftBracket,(0,s.opt)(C,void 0),(0,s.opt)(l.parseRightBracket,void 0),l.parseCharIndex),function(A,T){var g=Mr(T,5),O=g[0],M=g[1],K=g[2],W=g[3],z=g[4],ee;return(0,f.columnRef)((ee=K==null?void 0:K.chars)!==null&&ee!==void 0?ee:"",!0,W!==void 0,(0,p.addSpan)(A,O,z,"",""))}),x=(0,s.apply)((0,s.tuple)(l.parseCharIndex,C,l.parseCharIndex),function(A,T){var g=Mr(T,3),O=g[0],M=g[1],K=g[2];return(0,f.columnRef)(M.chars,!1,!0,(0,p.addSpan)(A,O,K,"",""))}),G=(0,s.any)(B,k),H=(0,s.apply)(l.parseCharIndex,function(A,T){return(0,f.missingRef)((0,p.addSpan)(A,T,T,"",""))}),L=(0,s.any)(G,H),D=(0,s.take)(function(A,T){return T.chars==="#"?T:void 0}),U=(0,s.apply)((0,s.many1)(D,h),function(A,T){return(0,m.unexpectedToken)(T[0].start,T.map(function(g){return g.chars}).join(""))}),V=(0,s.apply)((0,s.many1)(D,y),function(A,T){return(0,m.unexpectedToken)(T[0].start,T.map(function(g){return g.chars}).join(""))}),ne=(0,s.apply)((0,s.tuple)(l.parseCharIndex,U,l.parseCharIndex),function(A,T){var g=Mr(T,3),O=g[0],M=g[1],K=g[2];return(0,f.badRef)(M.chars,!1,!0,(0,p.addSpan)(A,O,K,"",""))}),J=(0,s.apply)((0,s.tuple)(l.parseCharIndex,l.parseLeftBracket,V,(0,s.opt)(l.parseRightBracket,void 0),l.parseCharIndex),function(A,T){var g=Mr(T,5),O=g[0],M=g[1],K=g[2],W=g[3],z=g[4];return(0,f.badRef)(K.chars,!0,W!==void 0,(0,p.addSpan)(A,O,z,"",""))}),$=(0,s.any)(ne,J),Z=(0,s.apply)((0,s.tuple)(l.parseCharIndex,L,l.parseRangeOp,L,l.parseCharIndex),function(A,T){var g=Mr(T,5),O=g[0],M=g[1],K=g[2],W=g[3],z=g[4];return(0,f.rangeOpRef)(M,W,(0,p.addSpan)(A,O,z,"",""))}),ie=(0,s.any)(Z,G),X=(0,s.any)(w,$,Z,G,H),Q=(0,s.apply)((0,s.tuple)(l.parseCharIndex,X,(0,s.many1)((0,s.tuple)(l.parseListSep,X)),l.parseCharIndex),function(A,T){var g=Mr(T,4),O=g[0],M=g[1],K=g[2],W=g[3];return(0,f.commaOpRef)([M].concat(Pc(K.map(function(z){var ee=Mr(z,2),ue=ee[0],ce=ee[1];return ce}))),(0,p.addSpan)(A,O,W,"",""))}),b=(0,s.apply)((0,s.tuple)(l.parseCharIndex,l.parseAtOp,(0,s.opt)(ie,void 0),l.parseCharIndex),function(A,T){var g=Mr(T,4),O=g[0],M=g[1],K=g[2],W=g[3];return(0,f.thisRowOpRef)(K,(0,p.addSpan)(A,O,W,"",""))}),R=(0,s.apply)(l.parseSpacesOnly,function(){}),P=(0,s.any)((0,s.left)(R,l.parseEnd),(0,s.left)(x,l.parseEnd),(0,s.left)(Q,l.parseEnd),(0,s.left)(b,l.parseEnd),(0,s.left)(Z,l.parseEnd),(0,s.left)(w,l.parseEnd),(0,s.left)($,l.parseEnd),(0,s.left)(k,l.parseEnd));t.parseStructRef=(0,s.applyTake)((0,s.tuple)(l.parseCharIndex,l.parseBracketedTokens,l.parseCharIndex),function(A,T){var g=Mr(T,3),O=g[0],M=Mr(g[1],2),K=M[0],W=M[1],z=g[2],ee=(0,s.runParser)(P,K,0,A);return(0,v.isSuccess)(ee)?(0,c.structRefTerm)((0,f.structRef)(ee.value.output,W,(0,p.addSpan)(A,O,z,"","")),O,z):void 0})},7971:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.concat=t.flatten=t.middle=t.right=t.left=t.tuple=t.many1=t.many=t.reduce=t.applyTake=t.takePeek=t.peek=t.take=t.fails=t.succeeds=t.opt=t.any=t.withState=t.apply=t.bind=t.parseFail=t.parseSucceed=t.warnSucceedOrFail=t.setDebugging=t.lazy=t.runParser=void 0;var s=d(4666),c=d(7081),l=d(3357),f=d(2518);t.runParser=function(k,x,G,H){var L;if(function(U){for(var V=U;V!=null;)V=V()}(k(x,G,H,function(U,V){L=(0,l.success)({output:U,index:V})},function(){L=(0,l.failure)(void 0)})),L==null){var D="calc.parse.runParser: internal error: parser did not call resolve or reject on "+(0,c.anonymize)(x);return(0,s.assertFalse)(D)}return L},t.lazy=function(k){var x;return function(G,H,L,D,U){var V=x??(x=k());return function(){return V(G,H,L,D,U)}}};var p=!1;function m(k){return function(x,G,H,L,D){return L(k,G)}}t.setDebugging=function(k){p=k},t.warnSucceedOrFail=function(k,x){return function(G,H,L,D,U){return k(G,H,L,function(V,ne){return p&&console.warn(x+" succeeded, returning index "+ne+" (of "+G.length+") with",V),D(V,ne)},function(){return p&&console.warn(x+" failed at index "+H+" (of "+G.length+")"),U})}},t.parseSucceed=m;var v=function(x,G,H,L,D){return D};function h(){return v}function S(k,x){return function(G,H,L,D,U){return k(G,H,L,function(V,ne){return x(L,V)(G,ne,L,D,U)},U)}}function y(k,x){return function(G,H,L,D,U){return k(G,H,L,function(V,ne){return D(x(L,V),ne)},U)}}function C(k,x){return function(G,H,L,D,U){return k(G,H,L,D,function(){return x(G,H,L,D,U)})}}function E(k,x){return function(G,H,L,D,U){var V=G[H];if(V==null)return U;var ne=k(L,V);return ne==null?U:D(ne,H+x)}}function I(k,x,G){return function(H,L,D,U,V){var ne=G,J=L;function $(){return k(H,J,D,Z,ie)}function Z(X,Q){if(Q<=J){var b=(0,c.anonymize)(H),R="calc.parse.reduce: internal error: no progress made at index "+J+" on "+b;return(0,s.assertFalse)(R)}return ne=x(D,X,ne),J=Q,$}function ie(){return U(ne,J)}return $}}function F(k,x){return I(k,function(G,H,L){return L.push(H),L},x)}function w(){for(var k=arguments.length,x=new Array(k),G=0;G<k;G++)x[G]=arguments[G];if(x.length===0)return m([]);if(x.length===1)return y(x[0],function(L,D){return[D]});var H=x.length;return function(L,D,U,V,ne){var J=D,$=[];function Z(){return x[$.length](L,J,U,ie,ne)}function ie(X,Q){return J=Q,$.push(X),$.length<H?Z:V($,J)}return Z}}function B(k){return y(k,function(x,G){return(0,f.safeConcat)([],G)})}t.parseFail=h,t.bind=S,t.apply=y,t.withState=function(k){return function(x,G,H,L,D){return k(H)(x,G,H,L,D)}},t.any=function(){for(var k=arguments.length,x=new Array(k),G=0;G<k;G++)x[G]=arguments[G];return x.length===0?h():x.reduce(C)},t.opt=function(k,x){return function(G,H,L,D,U){return k(G,H,L,D,function(){return D(x,H)})}},t.succeeds=function(k){return function(x,G,H,L,D){return k(x,G,H,function(){return L(!0,G)},D)}},t.fails=function(k){return function(x,G,H,L,D){return k(x,G,H,D,function(){return L(!0,G)})}},t.take=function(k){return E(k,1)},t.peek=function(k){return E(k,0)},t.takePeek=function(k){return function(x,G,H,L,D){var U=x[G],V=x[G+1];if(U==null||V==null)return D;var ne=k(H,U,V);return ne==null?D:L(ne,G+1)}},t.applyTake=function(k,x){return function(G,H,L,D,U){return k(G,H,L,function(V,ne){var J=x(L,V);return J==null?U:D(J,ne)},U)}},t.reduce=I,t.many=function(k,x){return x===void 0?function(G,H,L,D,U){return F(k,[])(G,H,L,D,U)}:function(G,H,L,D,U){return k(G,H,L,function(V,ne){return F(x,[V])(G,ne,L,D,U)},function(){return D([],H)})}},t.many1=function(k){var x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:k;return S(k,function(G,H){return F(x,[H])})},t.tuple=w,t.left=function(k,x){return y(w(k,x),function(G,H){var L=Mr(H,1),D=L[0];return D})},t.right=function(k,x){return y(w(k,x),function(G,H){var L=Mr(H,2),D=L[1];return D})},t.middle=function(k,x,G){return y(w(k,x,G),function(H,L){var D=Mr(L,2),U=D[1];return U})},t.flatten=B,t.concat=function(){return B(w.apply(void 0,arguments))}},1677:function(u,t,d){"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0}),t.createParser=void 0;var c=d(931),l=d(6845),f=d(1866),p=d(6982),m=d(3357),v=d(3206),h=v.codePointEqualsSign,S=v.codePointPlusSign,y=v.codePointMinusSign,C=v.codePointAtSign,E=(s={},Qe(s,h,1),Qe(s,S,0),Qe(s,y,0),Qe(s,C,-1),s);function I(F,w,B,k){var x,G,H,L,D=(G=(x=w.config)===null||x===void 0?void 0:x.localeInfo)!==null&&G!==void 0?G:F.config.localeInfo,U=(L=(H=w.config)===null||H===void 0?void 0:H.refStyle)!==null&&L!==void 0?L:F.config.refStyle,V=F.config.mathpack,ne=(0,c.tokenizeFormula)(D,V,U,w.originGridCell.value,B,k,w.syntaxFeatures),J=(0,l.runFormulaParser)(D,V,U,w.lexicalKind,w.originGridCell.value,w.contextNames,w.syntaxFeatures,ne);return(0,m.success)(J)}t.createParser=function(F){return{parseFormula:function(B,k,x){return function(G,H,L){var D=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;try{var U=D>=0&&D<L.length?E[L.charCodeAt(D)]:void 0;return U==null?(0,m.failure)((0,f.notFormulaString)("first character is not '=', '+', '-' or '@'")):U<0?(0,m.failure)((0,p.notImplemented)(["Lotus 1-2-3 syntax"])):I(G,H,L,D+U)}catch(V){return(0,m.failure)((0,m.javaScriptError)(V))}}(F,B,k,x)},parseFormulaExpression:function(B,k,x){return function(G,H,L){var D=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;try{return I(G,H,L,D)}catch(U){return(0,m.failure)((0,m.javaScriptError)(U))}}(F,B,k,x)}}}},7371:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cellRefMustBeCellRefNode=t.withDelim=t.addSpan=t.addWhitespace=t.getSpan=t.getNodeSpan=t.makeState=t.ListSep=void 0;var s=d(7081),c=d(4666),l=d(7577),f=d(9866),p=d(7110),m;(function(C){C[C.Union=1]="Union",C[C.Arg=2]="Arg"})(m=t.ListSep||(t.ListSep={})),t.makeState=function(C,E,I,F,w){var B;return{localeInfo:C,mathpack:E,refStyle:I,lexicalKind:F,origin:w,delim:{delimId:void 0,listSep:m.Union,stack:(B={},Qe(B,l.DelimId.Paren,!1),Qe(B,l.DelimId.Brace,!1),Qe(B,l.DelimId.Bracket,!1),B)},cellRefMustBeCellRefNode:!1,label:1,spans:[]}},t.getNodeSpan=function(C,E){var I=C.spans[E.label];if(I==null){var F="calc.parse.getNodeSpan: internal error: expected node to have a span; given "+(0,s.anonymize)(E);(0,c.assertFalse)(F)}return I},t.getSpan=function(C,E){var I=C.spans[E];return(0,c.assertTrue)("calc.parse.getSpan: internal error: expected label to have a span",I!=null),I};var v=[];function h(C,E){var I=typeof E=="string"?v:E.filter(p.isCommentToken);return[typeof E=="string"?E:E.map(function(F){return F.chars}).join(""),I.length>0?I.map(function(F){return function(w,B){var k=S(w,B.start,B.start+B.chars.length,"","");return B.kind===l.TokenKind.SingleLineComment?(0,f.singleLineComment)(B.chars,k):(0,f.multiLineComment)(B.chars,B.isClosed,k)}(C,F)}):void 0]}function S(C,E,I,F,w){var B=C.label;C.label+=1;var k=h(C,F),x=Mr(k,2),G=x[0],H=x[1],L=h(C,w),D=Mr(L,2),U=D[0],V=D[1];return C.spans[B]=(0,f.formulaSpan)(E,I,G,U,H,V),B}function y(C,E,I){return function(F,w,B,k,x){var G=C(B);return I(F,w,B,function(H,L){return E(B,G),k(H,L)},function(){return E(B,G),x})}}t.addWhitespace=h,t.addSpan=S,t.withDelim=function(C,E){var I=C.delimId,F=C.listSep;return y(function(w){var B=w.delim;return w.delim={delimId:I,listSep:F,stack:_i(_i({},B.stack),Qe({},I,!0))},B},function(w,B){return w.delim=B},E)},t.cellRefMustBeCellRefNode=function(C){return y(function(E){var I=E.cellRefMustBeCellRefNode;return E.cellRefMustBeCellRefNode=!0,I},function(E,I){return E.cellRefMustBeCellRefNode=I},C)}},1866:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.notFormulaString=t.ReasonKind=t.parseLocals=t.createParseGlobals=void 0;var s=d(6982),c=d(3357),l;t.createParseGlobals=function(f){return{config:f}},t.parseLocals=function(f,p,m,v,h){return{config:m??void 0,lexicalKind:f,originGridCell:(0,c.success)(p),contextNames:v,syntaxFeatures:h}},function(f){f.NotFormulaString="NotFormulaString"}(l||(l={})),t.ReasonKind=_i(_i({},s.ReasonKind),l),t.notFormulaString=function(f){return{kind:t.ReasonKind.NotFormulaString,message:f}}},7577:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rangeOperatorToken=t.geOperatorToken=t.leOperatorToken=t.neOperatorToken=t.gtOperatorToken=t.ltOperatorToken=t.eqOperatorToken=t.concatOperatorToken=t.percentOperatorToken=t.powOperatorToken=t.divOperatorToken=t.mulOperatorToken=t.subOperatorToken=t.addOperatorToken=t.operatorToken=t.identOrBooleanToken=t.literalToken=t.cellRefR1C1Token=t.cellRefA1Token=t.specialRefToken=t.assignSepToken=t.dotSepToken=t.qualSepToken=t.rowSepToken=t.colSepToken=t.listSepToken=t.rightSQuoteToken=t.rightBraceToken=t.rightBracketToken=t.rightParenToken=t.leftSQuoteToken=t.leftBraceToken=t.leftBracketToken=t.leftParenToken=t.identToken=t.multiLineCommentToken=t.singleLineCommentToken=t.escapeToken=t.unexpectedToken=t.spacesToken=t.endToken=t.badErrorOper=t.isBadErrorOper=t.badNumberOper=t.isNumberLikeOper=t.isBadNumberOper=t.TokenOperKind=t.SepId=t.DelimId=t.TokenKind=void 0,t.appendToken=t.poundOperatorToken=t.atOperatorToken=void 0;var s=d(1416),c=d(9866),l=d(5630),f=d(6672),p=d(2636),m=d(3206),v=d(5079),h=m.codePointAsterisk,S=m.codePointMinusSign,y=m.codePointPlusSign,C=m.codePointSlash,E=m.codePointSpace,I,F,w,B;function k(V){return V.kind===B.BadNumber||V.kind===f.OperKind.Number}function x(V,ne,J,$){return{kind:V,start:ne,chars:J,isIdentContinue:$}}function G(V,ne,J,$){return{kind:V,start:ne,chars:J,isIdentContinue:!1,value:$}}function H(V,ne,J,$,Z,ie,X){return{kind:I.CellRef,start:V,chars:ne,isIdentContinue:J,row:$,col:Z,refStyle:ie,isBadLocale:X}}function L(V,ne,J){var $=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,Z=J.kind===f.OperKind.Boolean||k(J)&&function(ie){for(var X=da((0,p.codePointIterator)(ie)),Q;!(Q=X()).done;){var b=Q.value;if(b===y||b===S||b===h||b===E||b===C)return!1}return!0}(ne);return{kind:I.Literal,start:V,chars:ne,isIdentContinue:Z,oper:J,hasRight:$}}function D(V,ne,J){return{kind:I.Operator,start:V,chars:ne,isIdentContinue:!1,value:J}}function U(V){var ne=s.operatorStrings[V];if(ne==null)throw new Error("operatorTokenMaker: invalid operator "+V);return function(J){return D(J,ne,V)}}(function(V){V[V.End=1]="End",V[V.Left=2]="Left",V[V.Right=3]="Right",V[V.Sep=4]="Sep",V[V.Operator=5]="Operator",V[V.Spaces=6]="Spaces",V[V.Ident=7]="Ident",V[V.CellRef=8]="CellRef",V[V.Literal=9]="Literal",V[V.SpecialRef=10]="SpecialRef",V[V.Unexpected=11]="Unexpected",V[V.Escape=12]="Escape",V[V.SingleLineComment=13]="SingleLineComment",V[V.MultiLineComment=14]="MultiLineComment"})(I=t.TokenKind||(t.TokenKind={})),function(V){V[V.Paren=1]="Paren",V[V.Bracket=2]="Bracket",V[V.Brace=3]="Brace",V[V.SQuote=4]="SQuote"}(F=t.DelimId||(t.DelimId={})),function(V){V[V.List=1]="List",V[V.Row=2]="Row",V[V.Col=3]="Col",V[V.Qual=4]="Qual",V[V.Dot=5]="Dot",V[V.Assign=6]="Assign"}(w=t.SepId||(t.SepId={})),function(V){V.BadNumber="BadNumber",V.BadError="BadError"}(B=t.TokenOperKind||(t.TokenOperKind={})),t.isBadNumberOper=function(V){return V.kind===B.BadNumber},t.isNumberLikeOper=k,t.badNumberOper={kind:B.BadNumber},t.isBadErrorOper=function(V){return V.kind===B.BadError},t.badErrorOper={kind:B.BadError},t.endToken=function(V){return x(I.End,V,"",!1)},t.spacesToken=function(V,ne){return x(I.Spaces,V,ne,!1)},t.unexpectedToken=function(V,ne){return x(I.Unexpected,V,ne,!1)},t.escapeToken=function(V,ne){return x(I.Escape,V,ne,!1)},t.singleLineCommentToken=function(V,ne){return x(I.SingleLineComment,V,ne,!1)},t.multiLineCommentToken=function(V,ne,J){return{kind:I.MultiLineComment,start:V,chars:ne,isIdentContinue:!1,isClosed:J}},t.identToken=function(V,ne){return x(I.Ident,V,ne,!0)},t.leftParenToken=function(V){return G(I.Left,V,"(",F.Paren)},t.leftBracketToken=function(V,ne){return G(I.Left,V,ne,F.Bracket)},t.leftBraceToken=function(V,ne){return G(I.Left,V,ne,F.Brace)},t.leftSQuoteToken=function(V){return G(I.Left,V,"'",F.SQuote)},t.rightParenToken=function(V){return G(I.Right,V,")",F.Paren)},t.rightBracketToken=function(V,ne){return G(I.Right,V,ne,F.Bracket)},t.rightBraceToken=function(V,ne){return G(I.Right,V,ne,F.Brace)},t.rightSQuoteToken=function(V){return G(I.Right,V,"'",F.SQuote)},t.listSepToken=function(V,ne){return G(I.Sep,V,ne,w.List)},t.colSepToken=function(V,ne){return G(I.Sep,V,ne,w.Col)},t.rowSepToken=function(V,ne){return G(I.Sep,V,ne,w.Row)},t.qualSepToken=function(V){return G(I.Sep,V,"!",w.Qual)},t.dotSepToken=function(V){return G(I.Sep,V,".",w.Dot)},t.assignSepToken=function(V){return G(I.Sep,V,":=",w.Assign)},t.specialRefToken=function(V,ne,J){return G(I.SpecialRef,V,ne,J)},t.cellRefA1Token=function(V,ne,J,$){return H(V,ne,(J==null||typeof J=="object"&&J.kind===c.PosKind.Rel)&&($==null||typeof $=="object"&&$.kind===c.PosKind.Rel),J,$,c.RefStyle.A1,!1)},t.cellRefR1C1Token=function(V,ne,J,$){var Z=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;return H(V,ne,!(J!==v.SpecialPos.RCNoNum&&J!=null&&J.kind!==c.PosKind.Abs||$!==v.SpecialPos.RCNoNum&&$!=null&&$.kind!==c.PosKind.Abs),J,$,c.RefStyle.R1C1,Z)},t.literalToken=L,t.identOrBooleanToken=function(V,ne,J){return V.stringCompareCI(V.falseName,J)===0?L(ne,J,l.falseOper):V.stringCompareCI(V.trueName,J)===0?L(ne,J,l.trueOper):(0,t.identToken)(ne,J)},t.operatorToken=D,t.addOperatorToken=U(s.OperatorId.Add),t.subOperatorToken=U(s.OperatorId.Sub),t.mulOperatorToken=U(s.OperatorId.Mul),t.divOperatorToken=U(s.OperatorId.Div),t.powOperatorToken=U(s.OperatorId.Pow),t.percentOperatorToken=U(s.OperatorId.Percent),t.concatOperatorToken=U(s.OperatorId.Concat),t.eqOperatorToken=U(s.OperatorId.Eq),t.ltOperatorToken=U(s.OperatorId.Lt),t.gtOperatorToken=U(s.OperatorId.Gt),t.neOperatorToken=U(s.OperatorId.Ne),t.leOperatorToken=U(s.OperatorId.Le),t.geOperatorToken=U(s.OperatorId.Ge),t.rangeOperatorToken=U(s.OperatorId.Range),t.atOperatorToken=U(s.OperatorId.At),t.poundOperatorToken=U(s.OperatorId.Pound),t.appendToken=function(V,ne,J){return J.push(ne),ne.start+V}},931:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tokenizeFormula=void 0;var s=d(4666),c=d(7577),l=d(5630),f=d(5079),p=d(3453),m=d(2518),v=d(9866),h=d(5942),S=d(2636),y=d(3206),C=d(327),E=d(719),I=d(7110),F=y.codePointAsterisk,w=y.codePointAtSign,B=y.codePointColon,k=y.codePointDoubleQuote,x=y.codePointExclamationMark,G=y.codePointHash,H=y.codePointLeftParen,L=y.codePointQuestionMark,D=y.codePointRightParen,U=y.codePointSingleQuote,V=y.codePointFullStop,ne=y.codePointDigitZero,J=y.codePointSlash,$=y.codePointMinusSign,Z=y.codePointSpace,ie=y.codePointInvertedExclamationMark,X=y.codePointInvertedQuestionMark,Q=y.codePointLeftSingleQuotationMark,b=y.codePointRightSingleQuotationMark,R;function P(Oe){if(!R){R=(0,m.makeStringMap)();for(var le=da(Object.getOwnPropertyNames(A)),me;!(me=le()).done;){var Pe=me.value;R[Pe.charCodeAt(0)]=!0}for(var Re=da(Object.getOwnPropertyNames(T)),fe;!(fe=Re()).done;){var Se=fe.value;R[Se.charCodeAt(0)]=!0}}return R[Oe]===!0}var A={"+":c.addOperatorToken,"-":c.subOperatorToken,"*":c.mulOperatorToken,"/":c.divOperatorToken,"^":c.powOperatorToken,"%":c.percentOperatorToken,"&":c.concatOperatorToken,"=":c.eqOperatorToken,"<":c.ltOperatorToken,">":c.gtOperatorToken,":":c.rangeOperatorToken,".":c.dotSepToken,"@":c.atOperatorToken,"#":c.poundOperatorToken},T={"<>":c.neOperatorToken,"<=":c.leOperatorToken,">=":c.geOperatorToken};function g(Oe,le,me){if(le<Oe.length-1){var Pe=T[Oe.substring(le,le+2)];if(Pe!=null)return(0,c.appendToken)(2,Pe(le),me)}var Re=A[Oe.charAt(le)];return Re!=null?(0,c.appendToken)(1,Re(le),me):(0,s.assertFalse)("calc.parse.tokenizeOperator: internal error: expected operator")}function O(Oe,le,me,Pe,Re){var fe=(0,p.parseNumberLiteral)(Oe,le,me,Pe,!1,!1,!1);if(fe!==void 0){var Se=fe.value,be=fe.i,xe=me.substring(Pe,be);return(0,c.appendToken)(be-Pe,(0,c.literalToken)(Pe,xe,Se??c.badNumberOper,!0),Re),be}}var M=function(le,me){return le.charCodeAt(me)!==k},K=function(le,me){return le.charCodeAt(me)===k};function W(Oe,le,me){var Pe=(0,h.scanEscapedWhile)(Oe,le+1,M,'"',K),Re=Mr(Pe,2),fe=Re[0],Se=Re[1],be=Oe.substring(le,Se+1);return Se<Oe.length?(0,c.appendToken)(Se+1-le,(0,c.literalToken)(le,be,(0,l.stringOper)(fe),!0),me):(0,c.appendToken)(Se-le,(0,c.literalToken)(le,be,(0,l.stringOper)(fe),!1),me)}function z(Oe,le,me,Pe){if(!(0,E.isTypedChangeGateEnabled)("Microsoft.Office.Excel.ChangeGate.LocErrorTokensFix"))return function(Ze,gr,cr,_r){for(var xr=1;xr<Ze.errorNames.length;xr+=1){var Or=Ze.errorNames[xr];if(Or!=null){var Rr=gr.substring(cr,cr+Or.length);if(Ze.stringCompareCI(Or,Rr)===0)return(0,c.appendToken)(Or.length,(0,c.literalToken)(cr,Rr,(0,l.errorOper)(xr)),_r)}}for(var ir=cr+1,$e=!1;ir<gr.length;){var qe=(0,S.stringCodePointAt)(gr,ir);if(ir!==cr+1||qe!==ie&&qe!==X)if(ir>cr+1&&qe===J&&!$e)$e=!0,ir+=1;else if(ir>cr+1&&qe===V)ir+=1;else{if(ir>cr+1&&qe===ne){ir+=1,ir<gr.length&&gr.charCodeAt(ir)===x&&(ir+=1);break}if(qe===x||qe===L){ir!==cr+1&&(ir+=1);break}if(!Ze.isIdentStart(qe))break;ir+=(0,S.numCodeUnits)(qe)}else ir+=1}if(ir>cr+1){var fr=gr.substring(cr,ir);return(0,c.appendToken)(ir-cr,(0,c.literalToken)(cr,fr,c.badErrorOper),_r)}}(Oe,le,me,Pe);for(var Re=1;Re<Oe.errorNames.length;Re+=1){var fe=Oe.errorNames[Re];if(fe!=null){var Se=le.substring(me,me+fe.length);if(Oe.stringCompareCI(fe,Se)===0)return(0,c.appendToken)(fe.length,(0,c.literalToken)(me,Se,(0,l.errorOper)(Re)),Pe)}}for(var be=me+1,xe=!1;be<le.length;){var Ie=(0,S.stringCodePointAt)(le,be);if(be!==me+1||Ie!==ie&&Ie!==X)if(!(be>me+1)||Ie!==J&&Ie!==$&&Ie!==Z||xe)if(be>me+1&&Ie===V)be+=1;else{if(be>me+1&&Ie===ne){be+=1,be<le.length&&le.charCodeAt(be)===x&&(be+=1);break}if(Ie===x||Ie===L){be!==me+1&&(be+=1);break}if(!Oe.isIdentContinue(Ie)||Oe.isNumeral(Ie)){if(Ie!==Q&&Ie!==b)break;be+=1}else be+=(0,S.numCodeUnits)(Ie)}else xe=!0,be+=1;else be+=1}for(;be>me+1&&le.charCodeAt(be-1)===Z;)--be;if(be>me+1){var Ve=le.substring(me,be);return(0,c.appendToken)(be-me,(0,c.literalToken)(me,Ve,c.badErrorOper),Pe)}}function ee(Oe,le,me,Pe){for(var Re=1;Re<Oe.specialRefNames.length;Re+=1){var fe=Oe.specialRefNames[Re];if(fe!=null){var Se=le.substring(me,me+fe.length);if(Oe.stringCompareCI(fe,Se)===0)return(0,c.appendToken)(fe.length,(0,c.specialRefToken)(me,Se,Re),Pe)}}}function ue(Oe,le,me){var Pe=le.charCodeAt(me);return!((0,p.isSpace)(Pe)||Pe===U||Pe===G||Pe===B||Pe===w||(0,C.stringStartsWith)(le,Oe.listSeparator,me)||(0,C.stringStartsWith)(le,Oe.leftBracket,me)||(0,C.stringStartsWith)(le,Oe.rightBracket,me))}var ce=function(le,me){return(0,p.isSpace)((0,S.stringCodePointAt)(le,me))},he=function(le,me){return!(0,p.isLineBreak)((0,S.stringCodePointAt)(le,me))},de=function(le,me){return!(me+1<le.length&&le.charCodeAt(me)===F&&le.charCodeAt(me+1)===J)};function pe(Oe,le,me,Pe){for(var Re=me,fe=0,Se=function(qe,fr){return ue(Oe,qe,fr)},be=function(qe,fr){return!ue(Oe,qe,fr)},xe=(0,h.makeProgressAsserter)("calc.parse.tokenizeBracketedRef",Re);Re<le.length;){xe(Re);var Ie=(0,S.stringCodePointAt)(le,Re);if(Pe.length>0&&Pe[Pe.length-1].kind===c.TokenKind.Escape&&be(le,Re))Re=(0,c.appendToken)((0,S.numCodeUnits)(Ie),(0,c.identToken)(Re,(0,S.stringFromCodePoint)(Ie)),Pe);else if(Ie!==w){if(Ie===G){var Ve=ee(Oe,le,Re,Pe);if(Ve!=null){Re=Ve;continue}}if(Ie!==U)if((0,C.stringStartsWith)(le,Oe.rightBracket,Re)){if(Re=(0,c.appendToken)(Oe.rightBracket.length,(0,c.rightBracketToken)(Re,Oe.rightBracket),Pe),fe-=1,fe===0)return Re}else if(Se(le,Re)){var Ze=(0,h.scanWhile)(le,Re,Se),gr=Mr(Ze,2),cr=gr[0],_r=gr[1];Re=(0,c.appendToken)(_r-Re,(0,c.identToken)(Re,cr),Pe)}else if((0,p.isSpace)(Ie)){var xr=(0,h.scanWhile)(le,Re,ce),Or=Mr(xr,2),Rr=Or[0],ir=Or[1];Re=(0,c.appendToken)(ir-Re,(0,c.spacesToken)(Re,Rr),Pe)}else Ie!==B?(0,C.stringStartsWith)(le,Oe.listSeparator,Re)?Re=(0,c.appendToken)(Oe.listSeparator.length,(0,c.listSepToken)(Re,Oe.listSeparator),Pe):(0,C.stringStartsWith)(le,Oe.leftBracket,Re)&&fe<2?(Re=(0,c.appendToken)(Oe.leftBracket.length,(0,c.leftBracketToken)(Re,Oe.leftBracket),Pe),fe+=1):Re=(0,c.appendToken)((0,S.numCodeUnits)(Ie),(0,c.unexpectedToken)(Re,(0,S.stringFromCodePoint)(Ie)),Pe):Re=(0,c.appendToken)(1,(0,c.rangeOperatorToken)(Re),Pe);else Re=(0,c.appendToken)(1,(0,c.escapeToken)(Re,"'"),Pe)}else Re=(0,c.appendToken)(1,(0,c.atOperatorToken)(Re),Pe)}return Re}function _e(Oe,le,me,Pe){for(var Re=(0,c.appendToken)(1,(0,c.leftSQuoteToken)(me),Pe),fe=function(_r,xr){return function(Or,Rr,ir){var $e=Rr.charCodeAt(ir);return $e!==U&&$e!==B&&$e!==F&&$e!==L&&!(0,C.stringStartsWith)(Rr,Or.leftBracket,ir)&&!(0,C.stringStartsWith)(Rr,Or.rightBracket,ir)}(Oe,_r,xr)},Se=function(_r,xr){return _r.charCodeAt(xr)===U},be=(0,h.makeProgressAsserter)("calc.parse.tokenizeQuotedQualifier",Re);Re<le.length;){be(Re);var xe=(0,S.stringCodePointAt)(le,Re);if(xe===U&&!(Re+1<le.length&&le.charCodeAt(Re+1)===U))return(0,c.appendToken)(1,(0,c.rightSQuoteToken)(Re),Pe);if(xe!==B)if((0,C.stringStartsWith)(le,Oe.leftBracket,Re))Re=(0,c.appendToken)(Oe.leftBracket.length,(0,c.leftBracketToken)(Re,Oe.leftBracket),Pe);else if((0,C.stringStartsWith)(le,Oe.rightBracket,Re))Re=(0,c.appendToken)(Oe.rightBracket.length,(0,c.rightBracketToken)(Re,Oe.rightBracket),Pe);else if((0,h.getEscapedSkip)(le,Re,fe,"'",Se)>0){var Ie=(0,h.scanEscapedWhile)(le,Re,fe,"'",Se),Ve=Mr(Ie,2),Ze=Ve[0],gr=Ve[1];Re=(0,c.appendToken)(gr-Re,(0,c.identToken)(Re,Ze),Pe)}else Re=(0,c.appendToken)((0,S.numCodeUnits)(xe),(0,c.unexpectedToken)(Re,(0,S.stringFromCodePoint)(xe)),Pe);else Re=(0,c.appendToken)(1,(0,c.rangeOperatorToken)(Re),Pe)}return Re}function Ce(Oe,le,me,Pe,Re,fe){var Se=(0,f.parseCellRef)(Oe,le,me,Pe,Re);if(Se!=null){var be=Se.i,xe=Pe.substring(be,Re),Ie=Se.refStyle===v.RefStyle.A1?(0,c.cellRefA1Token)(Re,xe,Se.row,Se.col):(0,c.cellRefR1C1Token)(Re,xe,Se.row,Se.col,Se.enLocale);return(0,c.appendToken)(be-Re,Ie,fe)}}function Ne(Oe,le,me,Pe){var Re=Pe.length-1,fe=Pe[Re];if(fe==null)return!0;if(fe.kind===c.TokenKind.Sep&&fe.value===c.SepId.Dot)return!1;if((0,C.stringStartsWith)(le,Oe.decimalSeparator,me)){for(;fe!=null&&(0,I.isWhitespaceToken)(fe);)fe=Pe[--Re];return fe==null||fe.kind!==c.TokenKind.Ident&&fe.kind!==c.TokenKind.CellRef&&fe.kind!==c.TokenKind.Right&&(fe.kind!==c.TokenKind.Literal||(0,c.isNumberLikeOper)(fe.oper))}return Oe.isNumeral((0,S.stringCodePointAt)(le,me))}function Le(Oe,le,me,Pe){for(var Re=Oe[le],fe=le+1;fe<Oe.length;fe+=1){var Se=Oe[fe];if(Se.kind!==me)break;Re=Pe(Re,Se)}return[Re,fe]}t.tokenizeFormula=function(Oe,le,me,Pe,Re,fe,Se){for(var be=function(ir,$e,qe,fr,lr,dn,Un){for(var Gr=[],Br=[],bt=(0,E.isTypedChangeGateEnabled)("Microsoft.Office.Excel.ChangeGate.BadlyNestedBracketsFix"),Kr=dn,Pt=(Un==null?void 0:Un[v.SyntaxFeature.Comments])===!0,Mi=(Un==null?void 0:Un[v.SyntaxFeature.Statements])===!0,El=!(0,C.stringStartsWith)(ir.statementSeparator,ir.columnSeparator)&&!(0,C.stringStartsWith)(ir.statementSeparator,ir.rowSeparator),Nl=!(0,C.stringStartsWith)(ir.statementSeparator,ir.listSeparator)&&!(0,C.stringStartsWith)(ir.statementSeparator,ir.decimalSeparator),ys=(0,h.makeProgressAsserter)("calc.parse.tokenize",Kr);Kr<lr.length;){ys(Kr);var _d=Ce(ir,qe,fr,lr,Kr,Gr);if(_d!=null){Kr=_d;continue}var xu=(0,S.stringCodePointAt)(lr,Kr);if(Ne(ir,lr,Kr,Gr)){var pi=O(ir,$e,lr,Kr,Gr);if(pi!=null){Kr=pi;continue}}if(xu!==k)if(ir.isIdentContinue(xu)){var xa=(0,h.scanWhile)(lr,Kr,function(x_,pI){return ir.isIdentContinue((0,S.stringCodePointAt)(x_,pI))}),$i=Mr(xa,2),$o=$i[0],ar=$i[1];Kr=(0,c.appendToken)(ar-Kr,(0,c.identOrBooleanToken)(ir,Kr,$o),Gr)}else if(xu!==G)if((0,p.isSpace)(xu)){var ye=(0,h.scanWhile)(lr,Kr,ce),Rd=Mr(ye,2),Ji=Rd[0],By=Rd[1];Kr=(0,c.appendToken)(By-Kr,(0,c.spacesToken)(Kr,Ji),Gr)}else if(xu!==H)if(xu!==D)if((0,C.stringStartsWith)(lr,ir.leftBrace,Kr))Br.push({delim:c.DelimId.Brace,lastParen:Br.length>0?Br[Br.length-1].lastParen:void 0,lastBrace:Br.length}),Kr=(0,c.appendToken)(ir.leftBrace.length,(0,c.leftBraceToken)(Kr,ir.leftBrace),Gr);else if((0,C.stringStartsWith)(lr,ir.rightBrace,Kr)){if(bt){var nr=Br.length>0?Br[Br.length-1].lastBrace:void 0;nr!==void 0&&(Br.length=nr)}else Br.length>0&&Br[Br.length-1].delim===c.DelimId.Brace&&Br.pop();Kr=(0,c.appendToken)(ir.rightBrace.length,(0,c.rightBraceToken)(Kr,ir.rightBrace),Gr)}else if((0,C.stringStartsWith)(lr,ir.leftBracket,Kr))Kr=pe(ir,lr,Kr,Gr);else if((0,C.stringStartsWith)(lr,ir.rightBracket,Kr))Kr=(0,c.appendToken)(ir.rightBracket.length,(0,c.rightBracketToken)(Kr,ir.rightBracket),Gr);else{if(Br.length>0&&Br[Br.length-1].delim===c.DelimId.Brace){if(Mi&&El&&(0,C.stringStartsWith)(lr,ir.statementSeparator,Kr))break;if((0,C.stringStartsWith)(lr,ir.columnSeparator,Kr)){Kr=(0,c.appendToken)(ir.columnSeparator.length,(0,c.colSepToken)(Kr,ir.columnSeparator),Gr);continue}if((0,C.stringStartsWith)(lr,ir.rowSeparator,Kr)){Kr=(0,c.appendToken)(ir.rowSeparator.length,(0,c.rowSepToken)(Kr,ir.rowSeparator),Gr);continue}}if(Mi&&(0,C.stringStartsWith)(lr,ir.statementSeparator,Kr)&&(Nl||Br.length===0))break;if((0,C.stringStartsWith)(lr,ir.listSeparator,Kr))Kr=(0,c.appendToken)(ir.listSeparator.length,(0,c.listSepToken)(Kr,ir.listSeparator),Gr);else if(xu!==x)if(xu!==U){if(xu===J&&Kr+1<lr.length&&Pt){var Rn=lr.charCodeAt(Kr+1);if(Rn===J){var IS=(0,h.scanWhile)(lr,Kr,he),jf=Mr(IS,2),qy=jf[0],Uy=jf[1];Kr=(0,c.appendToken)(Uy-Kr,(0,c.singleLineCommentToken)(Kr,qy),Gr);continue}if(Rn===F){var MS=(0,h.scanWhile)(lr,Kr+2,de),cb=Mr(MS,2),db=cb[0],w_=cb[1],D_=(0,C.stringStartsWith)(lr,"*/",w_);(0,s.assertTrue)("calc.parse.tokenize: /**/",D_||w_===lr.length),w_+=D_?2:0,db="/*"+db+(D_?"*/":""),Kr=(0,c.appendToken)(w_-Kr,(0,c.multiLineCommentToken)(Kr,db,D_),Gr);continue}}if(P(xu)){if((0,C.stringStartsWith)(lr,":=",Kr)&&(0,E.isFeatureEnabled)(E.FeatureName.CalcLambdaDefaultParameters)){Kr=(0,c.appendToken)(2,(0,c.assignSepToken)(Kr),Gr);continue}Kr=g(lr,Kr,Gr)}else Kr=(0,c.appendToken)((0,S.numCodeUnits)(xu),(0,c.unexpectedToken)(Kr,(0,S.stringFromCodePoint)(xu)),Gr)}else Kr=_e(ir,lr,Kr,Gr);else Kr=(0,c.appendToken)(1,(0,c.qualSepToken)(Kr),Gr)}else{if(bt){var MN=Br.length>0?Br[Br.length-1].lastParen:void 0;MN!==void 0&&(Br.length=MN)}else Br.length>0&&Br[Br.length-1].delim===c.DelimId.Paren&&Br.pop();Kr=(0,c.appendToken)(1,(0,c.rightParenToken)(Kr),Gr)}else Br.push({delim:c.DelimId.Paren,lastParen:Br.length,lastBrace:Br.length>0?Br[Br.length-1].lastBrace:void 0}),Kr=(0,c.appendToken)(1,(0,c.leftParenToken)(Kr),Gr);else{var wN=z(ir,lr,Kr,Gr);if(wN!=null){Kr=wN;continue}Kr=g(lr,Kr,Gr)}else Kr=W(lr,Kr,Gr)}return[Gr,Kr]}(Oe,le,me,Pe,Re,fe,Se),xe=Mr(be,2),Ie=xe[0],Ve=xe[1],Ze=[],gr=0;gr<Ie.length;){var cr=Ie[gr];if(cr.kind!==c.TokenKind.Unexpected)Ze.push(cr),gr+=1;else{var _r=Le(Ie,gr,c.TokenKind.Unexpected,function(ir,$e){var qe=ir,fr=$e;return(0,c.unexpectedToken)(qe.start,qe.chars+fr.chars)}),xr=Mr(_r,2),Or=xr[0],Rr=xr[1];Ze.push(Or),gr=Rr}}return Ze.push((0,c.endToken)(Ve)),Ze}},5942:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scanEscapedWhile=t.getEscapedSkip=t.scanWhile=t.makeProgressAsserter=void 0;var s=d(4666),c=d(2636),l=d(327);function f(p,m,v,h,S){return v(p,m)?1:(0,l.stringStartsWith)(p,h,m)&&m+h.length<p.length&&S(p,m+h.length)?2:0}t.makeProgressAsserter=function(p,m){var v=m-1;return function(h){if(h<=v){var S=p+": internal error: no progress made at index "+h;return(0,s.assertFalse)(S)}v=h}},t.scanWhile=function(p,m,v){for(var h=m;h<p.length&&v(p,h);)h+=(0,c.numCodeUnits)((0,c.stringCodePointAt)(p,h));return[p.substring(m,h),h]},t.getEscapedSkip=f,t.scanEscapedWhile=function(p,m,v,h,S){for(var y=[],C=m,E=m;E<p.length;){var I=f(p,E,v,h,S);if(I===0)break;I===2&&(C!==E&&y.push(p.substring(C,E)),C=E+h.length,E+=h.length),E+=(0,c.numCodeUnits)((0,c.stringCodePointAt)(p,E))}return C!==E&&y.push(p.substring(C,E)),[y.join(""),E]}},3389:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0;var s=d(9231);function c(){return typeof __get_change_gate_dictionary_variable=="undefined"?{}:__get_change_gate_dictionary_variable()}t.getChangeGateDictionary=c,t.isChangeGateEnabled=function(l){var f;return(f=c()[l])===null||f===void 0||f},t.setChangeGateDictionaryGetter=function(l){var f=s.globalThis.__get_change_gate_dictionary_variable;return s.globalThis.__get_change_gate_dictionary_variable=l,f}},3796:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var s=d(9231),c={};function l(){return typeof __get_feature_gate_dictionary_variable=="undefined"?c:__get_feature_gate_dictionary_variable()}function f(p,m){var v;return(v=l()[p])!==null&&v!==void 0?v:m}t.getFeatureGateDictionary=l,t.getStringFeatureGate=f,t.getBooleanFeatureGate=function(p,m){var v,h=(v=f(p))===null||v===void 0?void 0:v.trim().toLowerCase();return h==="true"||h!=="false"&&m},t.getNumberFeatureGate=function(p,m){var v,h=(v=f(p))===null||v===void 0?void 0:v.trim().toLowerCase();if(h===void 0)return m;if(h==="infinity"||h==="+infinity")return 1/0;if(h==="-infinity")return-1/0;var S=parseFloat(h);return isNaN(S)?m:S},t.getIntFeatureGate=function(p,m){var v,h=(v=f(p))===null||v===void 0?void 0:v.trim();if(h===void 0)return m;var S=parseInt(h,10);return isNaN(S)?m:S},t.setFeatureGateDictionaryGetter=function(p){var m=s.globalThis.__get_feature_gate_dictionary_variable;return s.globalThis.__get_feature_gate_dictionary_variable=p,m}},9231:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThis=void 0;var s=d(7933);t.globalThis=s},1292:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=d(655);s.__exportStar(d(3796),t),s.__exportStar(d(818),t),s.__exportStar(d(3389),t),s.__exportStar(d(2250),t),s.__exportStar(d(2910),t),s.__exportStar(d(8347),t)},818:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var s=d(3796);t.makeGetTypedFeatureGate=function(c){return function(l){var f=c[l];switch(typeof f){case"boolean":return(0,s.getBooleanFeatureGate)(l,f);case"number":return(0,s.getNumberFeatureGate)(l,f);case"string":return(0,s.getStringFeatureGate)(l,f);default:throw new Error("Wrong defaultValue type")}}}},2250:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var s=d(3389);t.makeTypedIsChangeGateEnabled=function(c){return function(l){return(0,s.isChangeGateEnabled)(l)}}},2910:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var s=d(655),c=d(3389);function l(f){var p=(0,c.setChangeGateDictionaryGetter)(void 0);return(0,c.setChangeGateDictionaryGetter)(function(){var m=p!==void 0?p():{};return s.__assign(s.__assign({},m),f)}),p}t.overrideChangeGates=l,t.overrideTypedChangeGates=function(f,p){return l(p)}},8347:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var s=d(655),c=d(3796);function l(f){for(var p,m,v={},h=0,S=Object.keys(f);h<S.length;h++){var y=S[h];v[y]=(p=f[y])===null||p===void 0?void 0:p.toString()}var C=(m=(0,c.setFeatureGateDictionaryGetter)(void 0))!==null&&m!==void 0?m:function(){return{}};return(0,c.setFeatureGateDictionaryGetter)(function(){return s.__assign(s.__assign({},C()),v)}),C}t.overrideFeatureGates=l,t.overrideTypedFeatureGates=function(f,p){return l(p)}},2875:function(u,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promises=void 0;var d={};t.promises=function(){return d.promises===void 0&&(d.promises=typeof Promise!="undefined"&&typeof Promise.resolve=="function"&&typeof Promise.resolve(0).then=="function"),d.promises}},7859:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initEwaUtils=t.ewaUtils=void 0;var s=d(1880),c={isChangeGateEnabled:function(f){return!1}};t.ewaUtils=function(){return c},t.initEwaUtils=function(l){if(!l)throw new Error("the 'ewaUtils' argument is missing");(0,s.setChangeGatesManager)({isChangeGateEnabled:l.isChangeGateEnabled}),c=l}},3076:function(u,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=void 0,t.getNewGuid=function(){var d=new Uint8Array(31),s=function(l){var f={crypto:!1,perfNow:!1,exceptions:[]},p=typeof self!="undefined"?self:window,m=p.crypto||p.msCrypto;if(m){f.crypto=!0;try{return m.getRandomValues(l),f}catch(E){f.exceptions.push("crypto: ".concat(JSON.stringify(E)))}}var v=!1,h=p.performance;try{h&&h.now&&h.now()!==1/0&&(v=!0)}catch(E){f.exceptions.push("perfNow: ".concat(JSON.stringify(E)))}for(var S=0;S<l.length;S+=1){try{if(v){f.perfNow=!0;var y=Math.floor(100*h.now())%10;(y<0||y>9)&&(y=0);for(var C=0;C<y;C+=1)Math.random()}}catch(E){f.exceptions.push("Math.random: ".concat(JSON.stringify(E)))}l[S]=Math.floor(16*Math.random())}return f}(d),c=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(l){var f=15&d[c];return c+=1,(l==="x"?f:3&f|8).toString(16)}),s]}},7702:function(u,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isReplaceChildrenSupported=t.replaceChildren=void 0,t.replaceChildren=function(d){if(d)if((0,t.isReplaceChildrenSupported)(d))d.replaceChildren();else for(;d.lastChild;)d.removeChild(d.lastChild)},t.isReplaceChildrenSupported=function(d){return!!d.replaceChildren}},1821:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=t.initStopwatchFactory=t.ewaUtils=t.initEwaUtils=t.ConsoleLogger=t.NulLogger=t.perfWatch=t.browserSupport=t.LogCategory=t.TraceLevel=t.ULS=t.utils=t.replaceChildren=t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=t.getNewGuid=void 0;var s=d(69);t.utils=s;var c=d(2714);Object.defineProperty(t,"ULS",{enumerable:!0,get:function(){return c.ULS}}),Object.defineProperty(t,"TraceLevel",{enumerable:!0,get:function(){return c.TraceLevel}}),Object.defineProperty(t,"LogCategory",{enumerable:!0,get:function(){return c.LogCategory}}),Object.defineProperty(t,"NulLogger",{enumerable:!0,get:function(){return c.NulLogger}}),Object.defineProperty(t,"ConsoleLogger",{enumerable:!0,get:function(){return c.ConsoleLogger}});var l=d(2875);t.browserSupport=l;var f=d(6062);t.perfWatch=f;var p=d(7859);Object.defineProperty(t,"initEwaUtils",{enumerable:!0,get:function(){return p.initEwaUtils}}),Object.defineProperty(t,"ewaUtils",{enumerable:!0,get:function(){return p.ewaUtils}});var m=d(9371);Object.defineProperty(t,"initStopwatchFactory",{enumerable:!0,get:function(){return m.initStopwatchFactory}});var v=d(5933);Object.defineProperty(t,"TelemetryCollector",{enumerable:!0,get:function(){return v.TelemetryCollector}});var h=d(3076);Object.defineProperty(t,"getNewGuid",{enumerable:!0,get:function(){return h.getNewGuid}});var S=d(8978);Object.defineProperty(t,"TextAreaVirtualKeyboardPolicy",{enumerable:!0,get:function(){return S.TextAreaVirtualKeyboardPolicy}}),Object.defineProperty(t,"TextAreaInputMode",{enumerable:!0,get:function(){return S.TextAreaInputMode}});var y=d(7702);Object.defineProperty(t,"replaceChildren",{enumerable:!0,get:function(){return y.replaceChildren}})},2714:function(u,t){"use strict";var d,s;Object.defineProperty(t,"__esModule",{value:!0}),t.NulLogger=t.ConsoleLogger=t.ULS=t.LogCategory=t.TraceLevel=void 0,(s=t.TraceLevel||(t.TraceLevel={}))[s.Error=10]="Error",s[s.Warning=15]="Warning",s[s.Info=50]="Info",s[s.Verbose=100]="Verbose",s[s.Spam=200]="Spam",(d=t.LogCategory||(t.LogCategory={}))[d.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",t.ULS={getFromExternalLogger:function(p){var m=p;return{ULS:{trace:function(h,S,y){return m.traceTag(0,h,S,y)},traceTag:function(h,S,y,C){return m.traceTag(h,S,y,C)},debugTrace:function(h,S,y){return m.debugTraceTag(0,h,S,y)},debugTraceTag:function(h,S,y,C){return m.debugTraceTag(h,S,y,C)},assert:function(h,S,y){return m.assertTag(0,h,S,y)},assertTag:function(h,S,y,C){return m.assertTag(h,S,y,C)},shipAssert:function(h,S,y){return m.shipAssertTag(0,h,S,y)},shipAssertTag:function(h,S,y,C){return m.shipAssertTag(h,S,y,C)},dnmTrace:function(h,S,y){return m.dnmTraceTag(0,h,S,y)},dnmTraceTag:function(h,S,y,C){return m.dnmTraceTag(h,S,y,C)}}}}};var c=function(){function f(){}return f.prototype.shipAssertTag=function(p,m,v,h){console.assert(v,"shipAssertTag:",p,m,h)},f.prototype.assertTag=function(p,m,v,h){console.assert(v,"assertTag",p,m,h)},f.prototype.traceTag=function(p,m,v,h){console.log("traceTag",p,h,m,v)},f.prototype.dnmTraceTag=function(p,m,v,h){console.log("dnmTraceTag",p,h,m,v)},f.prototype.debugTraceTag=function(p,m,v,h){console.log("debugTraceTag",p,h,m,v)},f}();t.ConsoleLogger=c;var l=function(){function f(){}return f.prototype.shipAssertTag=function(){},f.prototype.assertTag=function(){},f.prototype.traceTag=function(){},f.prototype.debugTraceTag=function(){},f.prototype.dnmTraceTag=function(){},f}();t.NulLogger=l},6062:function(u,t){"use strict";function d(){var c=typeof self!="undefined"?self:window;return c.performance&&c.performance.now?c.performance.now():Date.now()}function s(c,l,f){c[l]=d()-f}Object.defineProperty(t,"__esModule",{value:!0}),t.timeStamp=t.failure=t.success=t.end=t.mark=t.start=void 0,t.start=function(c){var l=d(),f=c,p=l,m={},v=function(S,y,C){return function(E,I,F,w,B,k){s(E,"end",F);var x={sessionName:I,result:w?"success":"failure",message:k,marks:E};B(JSON.stringify(x))}(m,f,p,S,y,C)};return m.start=0,{mark:function(S){return function(y){return s(m,y,p)}(S)},end:function(S){return v(!0,S)},success:function(S,y){return v(!0,S,y)},failure:function(S,y){return v(!1,S,y)}}},t.mark=function(c,l){c!==void 0&&c.mark(l)},t.end=function(c,l){c!==void 0&&c.end(l)},t.success=function(c,l,f){c!==void 0&&c.success(l,f)},t.failure=function(c,l,f){c!==void 0&&c.failure(l,f)},t.timeStamp=d},8978:function(u,t){"use strict";var d,s;Object.defineProperty(t,"__esModule",{value:!0}),t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=void 0,(s=t.TextAreaVirtualKeyboardPolicy||(t.TextAreaVirtualKeyboardPolicy={})).Auto="auto",s.Manual="manual",(d=t.TextAreaInputMode||(t.TextAreaInputMode={})).None="none",d.Text="text",d.Tel="tel",d.Url="url",d.Email="email",d.Numeric="numeric",d.Decimal="decimal",d.Search="search"},9371:function(u,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatchFactory=void 0;var d=function(){return Date.now()};t.initStopwatchFactory=function(s,c){return c===void 0&&(c=1),typeof self!="undefined"&&self.performance&&self.performance.now&&(d=function(){return self.performance.now()}),function(l){var f=d(),p=l;return{reset:function(v){v!=null&&(p=v),f=d()},stop:function(v){var h=d()-f,S=JSON.stringify({Target:p,Duration:h.toFixed(c),StopInfo:v});s(S)}}}}},5933:function(u,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=void 0;var d=function(){function s(){this.counters={},this.timers={},this.events={}}return s.prototype.getJsonForLogging=function(){return'{"Events":'+this.getEventsLoggableString()+',"Counters":'+this.getCountersLoggableString()+',"Timers":'+this.getTimersLoggableString()+"}"},s.prototype.addEvent=function(c,l){c!=null&&l!=null&&(this.events[c]=l)},s.prototype.clearEvents=function(){this.events={}},s.prototype.getEventsLoggableString=function(){return JSON.stringify(this.events)},s.prototype.incrementCounter=function(c){c!=null&&(this.counters.hasOwnProperty(c)?this.counters[c]+=1:this.counters[c]=1)},s.prototype.getCountersLoggableString=function(){return JSON.stringify(this.counters)},s.prototype.clearCounters=function(){this.counters={}},s.prototype.startTimer=function(c){c!=null&&(this.timers[c]={name:c,startTime:Date.now(),endTime:void 0,isRunning:!0,duration:void 0})},s.prototype.endTimer=function(c){c!=null&&this.timers.hasOwnProperty(c)&&(this.timers[c].endTime=Date.now(),this.timers[c].isRunning=!1,this.timers[c].duration=this.timers[c].endTime-this.timers[c].startTime)},s.prototype.getTimerDuration=function(c){return c==null?"-1":this.timers.hasOwnProperty(c)&&this.timers[c].duration!==void 0?this.timers[c].duration:"-1"},s.prototype.getTimersLoggableString=function(){return JSON.stringify(this.timers)},s}();t.TelemetryCollector=d},69:function(u,t){"use strict";function d(c,l){if(l===void 0&&(l=0),l<0||l>5||c==null||typeof c!="object")return c;var f={};Object.getOwnPropertyNames(c).forEach(function(v){v!=="stack"&&v.toUpperCase()!==v&&(f[v]=c[v])});var p=Object.getPrototypeOf(c);p&&typeof p=="object"&&Object.keys(p).forEach(function(v){v!=="stack"&&v.toUpperCase()!==v&&(f[v]=c[v])});var m={};return Object.keys(f).forEach(function(v){m[v]=d(f[v],l+1)}),m}Object.defineProperty(t,"__esModule",{value:!0}),t.getBoundingRectForText=t.getCharIndexInTextFromPoint=t.calcHashCode=t.decodeHtml=t.getQueryParameterByName=t.chainFallbackPromises=t.retry=t.getPerfWatchMarkName=t.getStringifiedError=t.defaultToJSONResultWhenStringifyFails=t.forEachPromise=void 0,t.forEachPromise=function(c,l,f){return c.reduce(function(p,m){return p.then(function(){return f&&f.stop?Promise.resolve(void 0):l(m,f)})},Promise.resolve(void 0))},t.defaultToJSONResultWhenStringifyFails="...",t.getStringifiedError=function(c){if(c===0)return"0";if(!c)return"";try{return JSON.stringify(d(c))}catch(l){return t.defaultToJSONResultWhenStringifyFails}};var s=new RegExp("".concat("\\W","+"),"g");t.getPerfWatchMarkName=function(c){if(!c)return"";var l=c.trim().substring(0,200).trim().replace(s,"_").substring(0,80);return l&&l.length>0&&l.substr(l.length-1,1)==="_"&&(l=l.substr(0,l.length-1)),l&&l.length>0&&l.substr(0,1)==="_"&&(l=l.substr(1)),l},t.retry=function(c,l){if(!c)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(l<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got ".concat(l)));for(var f=Promise.reject(),p=function(h){f=f.catch(function(S){return c(h,S)})},m=1;m<=l;m+=1)p(m);return f},t.chainFallbackPromises=function(c,l){if(!c||c.length===0)return Promise.reject();for(var f=l(c[0]),p=function(h){var S=c[h];f=f.catch(function(){return l(S)})},m=1;m<c.length;m+=1)p(m);return f},t.getQueryParameterByName=function(c,l){var f=new RegExp("[?&]".concat(l,"(=([^&#]*)|&|#|$)")).exec(c);if(f)return f[2]?decodeURIComponent(f[2].replace(/\+/g," ")):""},t.decodeHtml=function(c){return typeof c=="string"?new DOMParser().parseFromString(c,"text/html").documentElement.textContent:c},t.calcHashCode=function(c){if(!c)return 0;for(var l=5381,f=l,p=c.length,m=0;m<p&&(l=4294967295&((l<<5)+l^c.charCodeAt(m)),m!==p-1);m+=2)f=4294967295&((f<<5)+f^c.charCodeAt(m+1));var v=l+35685*f+(23896*f<<16)&4294967295;return v<0&&(v+=4294967296),v},t.getCharIndexInTextFromPoint=function(c,l,f){f===void 0&&(f=!1);var p=-1,m=null;if(document.caretPositionFromPoint!==void 0)(v=document.caretPositionFromPoint(c,l))!==null&&(p=v.offset,m=v.offsetNode!=null&&v.offsetNode.parentElement!=null&&v.offsetNode.parentElement.nodeName==="SPAN"?v.offsetNode.parentElement:v.offsetNode);else if(document.caretRangeFromPoint!==void 0)(v=document.caretRangeFromPoint(c,l))!==null&&(p=v.startOffset,m=v.startContainer!=null&&v.startContainer.parentElement!=null&&v.startContainer.parentElement.nodeName==="SPAN"?v.startContainer.parentElement:v.startContainer);else try{var v;m=document.elementFromPoint(c,l),(v=document.body.createTextRange()).moveToPoint(c,l);var h=document.body.createTextRange();h.moveToElementText(m),h.setEndPoint("EndToStart",v),p=h.text.length}catch(y){return p}if(f)for(var S=!1;m!=null;)m.previousSibling===null&&m.parentNode!==null&&m.parentNode.parentNode!==null&&m.parentNode.parentNode.childNodes.length>1&&!S?(m=m.parentNode,S=!0):(m=m.previousSibling)!=null&&m.textContent!=null&&(p+=m.textContent.length,S&&(p+=1));else for(;m!=null;)(m=m.previousSibling)!=null&&m.textContent!=null&&(p+=m.textContent.length);return p},t.getBoundingRectForText=function(c,l,f,p){function m(h,S,y){if(!h||!h.textContent)return S;if(p&&(S<0||S>h.textContent.length&&(h.childNodes.length===0||h.childNodes[0].nodeName!=="DIV"))||S<0||S>h.textContent.length)return S-h.textContent.length;if(!h.hasChildNodes())return y(h,S),S-h.textContent.length;for(var C=h.childNodes,E=0;E<C.length&&S>=0;E+=1)S=m(C[E],S,y),p&&C[E].nodeName==="DIV"&&(S-=1);return S}p===void 0&&(p=!1);var v=document.createRange();return m(c,l,function(h,S){return v.setStart(h,S)}),m(c,f,function(h,S){return v.setEnd(h,S)}),v.getBoundingClientRect()}},2914:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stackSave=t.stackRestore=t.stackAlloc=t.setThrew=t.memory=t._start=t.__growWasmMemory=t.__errno_location=t.Mathpack_Zero=t.Mathpack_ViewRound=t.Mathpack_Trunc=t.Mathpack_TenTo=t.Mathpack_Tan=t.Mathpack_TakeMathError=t.Mathpack_Sub=t.Mathpack_Sqrt=t.Mathpack_Sin=t.Mathpack_SFloat=t.Mathpack_SFix=t.Mathpack_RoundUp=t.Mathpack_RoundDown=t.Mathpack_Round=t.Mathpack_Power=t.Mathpack_Pi=t.Mathpack_Pack=t.Mathpack_One=t.Mathpack_Neg=t.Mathpack_Mul=t.Mathpack_Log=t.Mathpack_Ln=t.Mathpack_LFix=t.Mathpack_GetExp32=t.Mathpack_FormatScientific=t.Mathpack_FormatGetSign=t.Mathpack_FormatGetExponent=t.Mathpack_FormatGeneral=t.Mathpack_FormatFixed=t.Mathpack_Floor=t.Mathpack_Float=t.Mathpack_Fix=t.Mathpack_Exp=t.Mathpack_Equal=t.Mathpack_Div=t.Mathpack_Cos=t.Mathpack_Cond2=t.Mathpack_Cond=t.Mathpack_Compare=t.Mathpack_Ceil=t.Mathpack_Atan2=t.Mathpack_Atan=t.Mathpack_Asin=t.Mathpack_Add=t.Mathpack_Acos=t.Mathpack_Abs=t.Dtr_Yr=t.Dtr_Write=t.Dtr_Wdy=t.Dtr_UtcToLocal=t.Dtr_ToTime=t.Dtr_ToNumWithDuration=t.Dtr_ToNum=t.Dtr_ToDays=t.Dtr_Sec=t.Dtr_Rounding=t.Dtr_Mon=t.Dtr_Min=t.Dtr_Hour=t.Dtr_FromNum=t.Dtr_FracSec=t.Dtr_DaysPerMonth=t.Dtr_Days=t.Dtr_DOM=t.Base_StrBufSize=t.Base_StrBuf=void 0;var s=d(3263),c=d(3231),l=d(1721),f=new ArrayBuffer(8),p=new Int32Array(f),m=(new Float32Array(f),new Float64Array(f));function v(pi){return p[pi]}function h(pi,xa){p[pi]=xa}function S(){return m[0]}function y(pi){m[0]=pi}var C,E=new ArrayBuffer(65536),I=(C=new Uint8Array(E),function(pi,xa){var $i,$o;if(typeof Buffer=="undefined")for($i=atob(xa),$o=0;$o<$i.length;$o++)C[pi+$o]=$i.charCodeAt($o);else for($i=Buffer.from(xa,"base64"),$o=0;$o<$i.length;$o++)C[pi+$o]=$i[$o]});I(1024,"GAwAAAEAAAACAAAAAwAAAAAAAAAE"),I(1056,"6AsAAPALAAD4CwAAAAwAAB8dHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8dHx4fHh8fHh8eHw=="),I(1152,"sAsAAMgLAADACwAA0As="),I(1199,"AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQECAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsAAAAAHwA8AFsAeQCYALYA1QD0ABIBMQFPAW4B"),I(1599,"AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwAAAAAAHwA7AFoAeACXALUA1ADzABEBMAFOAW0B"),I(1975,"oAQ="),I(1991,"yAc="),I(2007,"+go="),I(2022,"QJwO"),I(2038,"UMMR"),I(2054,"JPQU"),I(2069,"gJaYGA=="),I(2085,"ILy+Gw=="),I(2101,"KGvuHg=="),I(2117,"+QKVIg=="),I(2132,"QLdDuiU="),I(2148,"EKXU6Cg="),I(2164,"KueEkSw="),I(2179,"gPQg5rUv"),I(2195,"oDGpX+My"),I(2211,"BL/JG442AAAAAAAAAJ61cCuorcWdawAAAAAAAADXlUMOBY0pr6AAAAAAAAAA1abP/0kfeMLVAAAAAAAAAPz32oePeufXCgEAAAAAAACjFJvFFquz7z8BAAAAAAAAnjIjmcCtD4V1AQAAAAAAAOCM6YDJR7qTqgEAAAAAAADnptOoxbkCpN8BAAAAAAAAqhfmfyuhFrYUAgAAAAAAAJO/m4WRoijKSQIAAAAAAABrVSc5jfdw4H4CAAAAAAAARmGCNzUMLvmzAgAAAAAAADDJPOP/llKK6QIAAAAAAABmF7/W86aRmR4DAAAAAAAAjt75nfvrfqpTAwAAAAAAAM3MzMzMzMzM/f///wAAAAAK16NwPQrXo/r///8AAAAAO99PjZduEoP3////AAAAACxlGeJYF7fR8////wAAAAAjhEcbR6zFp/D///8AAAAAtmlsrwW9N4bt////AAAAALxCeuXVlL/W6f///wAAAAD9zmGEEXfMq+b///8AAAAAl6W0NkFfcInj////AAAAAL/V7b3O/ubb3////wAAAAD/qiTLC//rr9z///8AAAAAzIhQbwnMvIzZ////AAAAABMOtEtCEy7h1f///wAAAAAP2FwJNdwktNL///8AAAAA2aywOvd8HZDP////AAAAAFvhTcS+lJXmy////wAAAAC6lDlFrR6xz5b///8AAAAAWcF+sVN8Erth////AAAAAKXpOaUn6n+oLP///wAAAACmGQlrumDFl/f+//8AAAAAm1N1/fcCtIjC/v//AAAAAH3TZfC8NUP2jP7//wAAAACh5LxkfEbQ3Vf+//8AAAAAyYJTfG66ysci/v//AAAAAJOgc9uT4PSz7f3//wAAAAAwAMs42ycXorj9//8AAAAABswjVHeD/5GD/f//AAAAAGC8pD2p3oCDTv3//wAAAAC+TjFK7Dzl7Bj9//8AAAAA1+Eyz81fYNXj/P//AAAAADoZemMlQzHArvz//wAAAAAYLURU+yEJQAAAAAAAAOA/AAAAAAAAAEAYLURU+yH5PwAAAAAAAPA/"),I(3014,"WUAAAAAAAAAkQAAAAAAAQI9AAAAAAAAAOEAAAAAAAABOQClRzqDIRdg+IXQL5wZroz41IN+kpBFvPvZNfx3q2jg+AADA////30EAAAAAAADgwQQEAAAQBA=="),I(3728,"ME8=");var F=function(pi,xa,$i){var $o=new pi.Int8Array($i),ar=new pi.Int16Array($i),ye=new pi.Int32Array($i),Rd=new pi.Uint8Array($i),Ji=new pi.Uint16Array($i),By=new pi.Uint32Array($i),nr=(new pi.Float32Array($i),new pi.Float64Array($i)),Rn=pi.Math.imul,IS=(pi.Math.fround,pi.Math.abs),jf=pi.Math.clz32,qy=pi.Math.min,Uy=(pi.Math.max,pi.Math.floor),MS=pi.Math.ceil,cb=pi.Math.sqrt,BS=xa.abort,db=(pi.NaN,pi.Infinity,xa.Base_LocaleIsNumeral),w_=xa.Base_LocaleGetOrdinal,D_=xa.Base_LocaleDecimalSeparator,MN=xa.Math_log10,wN=xa.Math_log,x_=(cb=xa.Math_sqrt,xa.Math_sin),pI=xa.Math_cos,BW=xa.Math_tan,qW=xa.Math_atan,UW=xa.Math_exp,DN=xa.proc_exit,Ut=20112,Td=0;function E4(){}function $g(we,Ee,Fe){e:if(we>>>0<=Ee>>>0){if(!Fe)break e;for(;$o[0|we]=Rd[0|Ee],we=we+1|0,Ee=Ee+1|0,Fe=Fe+-1|0;);}else if(Fe)for(we=we+Fe|0,Ee=Ee+Fe|0;Ee=Ee+-1|0,$o[0|(we=we+-1|0)]=Rd[0|Ee],Fe=Fe+-1|0;);}function N4(we,Ee){var Fe,De,ke=0,Me=0,Be=0,er=0;if(Me=3680,Ut=Fe=Ut-48|0,ye[Fe+40>>2]=0,ar[Fe+30>>1]=0,ar[Fe+32>>1]=0,nr[460]=we,De=Gy(we),nr[460]=De,Wy(De,Fe+40|0,Fe,15),Ji[Fe+42>>1]){ke=(0|(ke=pb(Ee)<<16))<0?100:ke>>16,y(+Ee),Be=0|v(1),v(0),(er=-65536&Be)&&((2146435072&Be)!=2146435072?ke=(0|er)<1?0-ke|0:ke:ye[922]=1);e:{if(!((0|(ke=ar[Fe+40>>1]+ke|0))>=ar[Fe+42>>1])){if((0|ke)<1){Me=3e3;break e}(255&ke)>>>0>=Rd[Fe+30|0]||($o[Fe+30|0]=ke)}m0(3100,3680,Fe)}we=nr[Me>>3]}return Ut=Fe+48|0,we}function A4(we,Ee){var Fe,De=0,ke=0,Me=0;if(nr[460]=we,y(+we),ke=0|v(1),v(0),Me=ke,ke=0,(De=-65536&Me)&&((2146435072&Me)!=2146435072?ke=(0|De)<1:(ye[922]=1,ke=0)),ye[921]=2147483647&Me,bd(nr[374]),De=-65536&(Me=ye[921]))if((2146435072&Me)!=2146435072){if(!((0|De)<1))return DS(8),0}else ye[922]=1;Fe=xS(nr[374],we),nr[460]=xS(nr[372],Fe),ef(Fe),CI();e:{r:{if((De=ye[921])>>>0>=65536){if((2146435072&De)!=2146435072)break r;ye[922]=1}if(Ee){if(ye[920]=0,ye[921]=0,!ke)break e;return Ee=ye[741],ye[920]=ye[740],ye[921]=Ee,nr[460]}if(De=ye[747],ye[920]=ye[746],ye[921]=De,Ee=De,1^ke|De>>>0<65536)break e;return ye[921]=-2147483648^Ee,nr[460]}LN(we),_I(),Ee&&(nr[460]=xS(nr[373],nr[460]))}return nr[460]}function ev(we,Ee,Fe,De){var ke,Me=0,Be=0,er=0,Tr=0,Lr=0,pr=0,q=0;if(Me=ye[we+4>>2],Lr=-2146827284,!((0|(ke=(Be=Ji[we>>1])+(we=(0|(er=ar[we+2>>1]))>=1?(er+-1|0)/12|0:(0|er)/-12^-1)<<16>>16))>9999|((Fe?1900:-9999)+(Ee?4:0)|0)>(0|ke)||((er=er+Rn(we,-12)<<16>>16)-1&65535)>>>0>11|(!Me|(0|ke)==1900&(0|er)==2&(0|Me)==29?!Fe:0))){if(pr=(0|(we=(Tr=(0|(Be=ke+1e4|0))/4|0)<<2))%100|0,q=(0|we)%400|0,Me=(((Tr=Rn(Tr,1461)+Me|0)+((0|(Me=we+-1|0))/-100|0)|0)+((0|Me)/400|0)|0)-1|0,Be=(Rn(Be-we|0,12)+er|0)-1|0)for(Be=Be+(we=q?pr?0:12:0)|0;Me=Rd[we+1072|0]+Me|0,(0|Be)!=(0|(we=we+1|0)););e:if(Fe||Ee){if(we=Me+-4346385|0,!((0|ke)>1900|(0|er)>=3))break e;we=Me+-4346384|0}else we=Me+-4346384|0;we>>>0>2958465||(ye[De>>2]=we,Lr=0)}return Lr}function Th(we,Ee,Fe){var De,ke,Me,Be=0,er=0,Tr=0;er=Tr=O4(we,Ee,711573504,201),ye[Fe+28>>2]=(er+1>>>0)%7,Be=er+Rn(De=(er>>>0)/146097|0,-146097)|0,ke=(Rn(Be,100)+75>>>0)/3652425|0,Be=((Me=Rn(ke,-36524)+Be|0)>>>0)/1461|0,er=(((er+(((Be=((Rn(ke,100)+Rn(De,400)|0)+(Be<<2)|0)+((Rn(Me+Rn(Be,-1461)|0,100)+75>>>0)/36525|0)|0)>>>0)/100|0)|0)-(Be>>>2)|0)-((Be>>>0)/400|0)|0)+Rn(Be,-365)|0,Tr=g0(Tr,Td,-864e5,-1),we=O4(we,Ee,1e4,0)+Tr|0,Tr=!(((Ee=Be+1|0)>>>0)%100)|3&Ee&&(Ee>>>0)%400|0?1936+((Ee=Rd[er+1568|0])<<1)|0:1536+((Ee=Rd[er+1168|0])<<1)|0,ye[Fe+12>>2]=(we>>>0)/36e5,ye[Fe+4>>2]=Ee+1,ye[Fe>>2]=Be+1601,Ee=(we>>>0)/1e3|0,ye[Fe+20>>2]=(Ee>>>0)%60,ye[Fe+16>>2]=((we>>>0)/6e4>>>0)%60,ye[Fe+24>>2]=we-Rn(Ee,1e3),ye[Fe+8>>2]=1+(er-ar[Tr>>1]|0)}function wS(we,Ee){var Fe=0,De=0,ke=0,Me=0,Be=0,er=0,Tr=0,Lr=0,pr=0,q=0,ae=0,oe=0;return(0|(Me=ye[we+4>>2]))<1||(Lr=Me+-1|0)>>>0>11||(De=(Fe=ye[we>>2])+-1601|0)>>>0>29226||(0|(Be=ye[we+8>>2]))<1||(ke=1536,((er=65535&Fe)>>>0)%400&&(ke=3&Fe?1936:(er>>>0)%100|0?1536:1936),(pr=ye[we+24>>2])>>>0>999||(er=ye[we+20>>2])>>>0>59||(q=ye[we+16>>2])>>>0>59||(ae=ye[we+12>>2])>>>0>23||(Be=Be+-1|0)>>>0>=ar[ke+(Me<<1)>>1]-ar[ke+(Lr<<1)>>1]>>>0||(ke=De>>>2,Me=Rn(De,365),De=((we=65535&De)>>>0)/400|0,oe=(we>>>0)/100|0,((Tr=65535&(Fe=Fe+-1600|0))>>>0)%400&&(we=1936,!((Tr>>>0)%100)|3&Fe)||(we=1536),Tr=1,Fe=(Fe=Rn(Rn(Rn(ae,60)+q|0,60)+er|0,1e3)+pr|0)+(De=g0(we=ar[(Lr<<1)+we>>1]+(De+((Be+(Me+ke|0)|0)-oe|0)|0)|0,we>>31,864e5,0))|0,we=Td,ye[Ee>>2]=g0(Fe,Fe>>>0<De>>>0?we+1|0:we,1e4,0),ye[Ee+4>>2]=Td)),Tr}function mI(we,Ee,Fe,De){var ke,Me=0,Be=0,er=0,Tr=0;Ut=ke=Ut-112|0,Th(Fe,De,ke+80|0);e:{if(ye[we>>2]){if(!wS(we,Ee))break e}else{if((0|(Be=ye[we+8>>2]))>5|!Be)break e;if(Fe=ye[we+4>>2],De=ye[we+28>>2],Me=ye[ke+80>>2],ye[ke+56>>2]=1,ye[ke+52>>2]=Fe,ye[ke+48>>2]=Me,ye[ke+60>>2]=ye[we+12>>2],ye[ke+64>>2]=ye[we+16>>2],ye[ke+68>>2]=ye[we+20>>2],we=ye[we+24>>2],ye[ke+76>>2]=0,ye[ke+72>>2]=we,!wS(ke+48|0,ke+8|0)){Me=0;break e}we=De+8|0,Fe=De+1|0,er=(0|Be)<2,Th(ye[ke+8>>2],ye[ke+12>>2],ke+16|0),Tr=ke;r:{if((0|De)<(0|(Me=ye[ke+44>>2])))we=we-Me|0;else{if(we=1,(0|De)<=(0|Me))break r;we=Fe-Me|0}ye[Tr+56>>2]=we}r:if(!er&&(Fe=we+7|0,ye[ke+56>>2]=Fe,Me=1,wS(ke+48|0,ke+8|0)))for(;;){if(Th(ye[ke+8>>2],ye[ke+12>>2],ke+16|0),we=ye[ke+24>>2],(0|Be)==(0|(Me=Me+1|0)))break r;if(Fe=Fe+7|0,ye[ke+56>>2]=Fe,!wS(ke+48|0,ke+8|0))break}if(ye[ke+56>>2]=we,!wS(ke+48|0,ke+8|0)){Me=0;break e}we=ye[ke+12>>2],ye[Ee>>2]=ye[ke+8>>2],ye[Ee+4>>2]=we}Me=1}return Ut=ke+112|0,Me}function bh(we,Ee,Fe){var De,ke=0,Me=0,Be=0,er=0,Tr=0;if(Ut=De=Ut-16|0,Fe&&(Be=Fe>>31,Be^=Be+Fe))for(Fe=(0|Fe)>0?1952:2448;(ke=15&Be)&&(Me=ar[8+(ke=(ke<<4)+Fe|0)>>1],Tr=GW(nr[we>>3],nr[ke>>3],De),Ee=Ee+Me|0,ar[De+14>>1]<=0?(ke=Ji[De+6>>1],Me=Ji[De+8>>1]):(Me=ye[De+4>>2],ke=Ji[De+6>>1]<<1,ar[De+6>>1]=ke,er=ye[De+8>>2],ye[De+12>>2]=ye[De+12>>2]<<1|er>>>31,Me=er<<1|Me>>>31,ye[De+8>>2]=Me,Ee=Ee+-1|0),(65535&ke|1&Me|(0|Tr)!=0)>>>0<32769||(Me=(ke=ye[De+8>>2])+1|0,ye[De+8>>2]=Me,Me>>>0>=ke>>>0||(Me=(ke=ye[De+12>>2])+1|0,ye[De+12>>2]=Me,Me>>>0>=ke>>>0||(ye[De+12>>2]=-2147483648,Ee=Ee+1|0))),ke=ye[De+12>>2],ye[we>>2]=ye[De+8>>2],ye[we+4>>2]=ke),Fe=Fe+240|0,Be>>=4;);return Ut=De+16|0,Ee}function GW(we,Ee,Fe){var De,ke,Me,Be=0,er=0,Tr=0,Lr=0,pr=0,q=0,ae=0,oe=0,re=0,te=0,ge=0,Te=0;return y(+Ee),Lr=0|v(1),pr=65535&(er=0|v(0)),y(+we),te=0|v(1),Be=0|v(0),Tr=te,ke=Rn(oe=65535&Be,pr),ar[Fe>>1]=ke,Me=((65535&(ge=Rn(re=Be>>>16,pr)))+(ke>>>16)|0)+(65535&(ae=Rn(er>>>=16,oe)))|0,ar[Fe+2>>1]=Me,ge=(((q=((65535&(Be=Rn(De=65535&Tr,pr)))+(ge>>>16)|0)+(ae>>>16)|0)+(65535&(ae=Rn(er,re)))|0)+(65535&(Te=Rn(te=65535&Lr,oe)))|0)+(Me>>>16)|0,ar[Fe+4>>1]=ge,ae=(((((((65535&(q=Rn(Lr>>>=16,oe)))+(Be>>>16)|0)+(65535&(Tr=Rn(Be=Tr>>>16,pr)))|0)+(ae>>>16)|0)+(Te>>>16)|0)+(65535&(pr=Rn(te,re)))|0)+(65535&(oe=Rn(er,De)))|0)+(ge>>>16)|0,ar[Fe+6>>1]=ae,re=((((((Te=(Tr>>>16)+(q>>>16)|0)+(65535&(Tr=Rn(Lr,re)))|0)+(pr>>>16)|0)+(oe>>>16)|0)+(65535&(q=Rn(Be,er)))|0)+(65535&(er=Rn(te,De)))|0)+(ae>>>16)|0,ar[Fe+8>>1]=re,q=((er=(((65535&(pr=Rn(Lr,De)))+(Tr>>>16)|0)+(q>>>16)|0)+(er>>>16)|0)+(65535&(Tr=Rn(Be,te)))|0)+(re>>>16)|0,ar[Fe+10>>1]=q,Be=(((65535&(Lr=Rn(Be,Lr)))+(pr>>>16)|0)+(Tr>>>16)|0)+(q>>>16)|0,ar[Fe+12>>1]=Be,ar[Fe+14>>1]=(Be>>>16)+(Lr>>>16),65535&(ke|Me|ge)}function Gy(we){var Ee,Fe,De=0,ke=0,Me=0,Be=0,er=0,Tr=0;return Ut=Ee=Ut-16|0,nr[Ee+8>>3]=we,y(+we),De=0|v(1),ke=0|v(0),Fe=De,(De&=2146435072)&&(ye[Ee+8>>2]=ke<<11,ye[Ee+12>>2]=Fe<<11|ke>>>21|-2147483648,Be=(De=Rn(ke=(De>>>20)-1022|0,39457)>>17)-14|0,Me=bh(Ee+8|0,ke,14-De|0),ke=ye[Ee+8>>2],(0|Me)>=(0|(By[Ee+12>>2]<(ke>>>0<2147477094?-1243209483:-1243209484)>>>0?48:47))||(Me=bh(Ee+8|0,Me,1),ke=ye[Ee+8>>2],Be=De+-15|0),De=Be,Be=(Be=ke)+(ke=-2147483648>>>(31&Me))|0,ye[Ee+8>>2]=Be,Be>>>0>=ke>>>0||(Tr=(er=ye[Ee+12>>2])+1|0,ye[Ee+12>>2]=Tr,Tr>>>0>=er>>>0||(ye[Ee+12>>2]=-2147483648,Me=Me+1|0)),ye[Ee+8>>2]=Be&0-(ke<<1),Me=bh(Ee+8|0,Me,De),3071&(De=ye[Ee+8>>2])?(ke=De+1024|0,ye[Ee+8>>2]=ke,De>>>0<4294966272||(Be=(De=ye[Ee+12>>2])+1|0,ye[Ee+12>>2]=Be,Me=(Be>>>0<De>>>0)+Me|0)):ke=De,(0|Me)<=-1023?(ye[Ee+8>>2]=0,ye[Ee+12>>2]=0):(0|(De=1071644672+(Me<<20)|0))<=-1||(Me=ye[Ee+12>>2],ye[Ee+8>>2]=Me<<21|ke>>>11,ye[Ee+12>>2]=Me>>>11&1048575|De|-2147483648&Fe),we=nr[Ee+8>>3]),Ut=Ee+16|0,we}function DS(we){var Ee;return Ee=ye[922],ye[922]=we,Ee}function gI(){var we,Ee,Fe;return we=ye[920],Ee=ye[921],ps(1048576),ps(2146435072),ar[1843]<0?(ye[920]=we,ye[921]=Ee,-2147483648):(Fe=ng(),ye[920]=we,ye[921]=Ee,-2147483648^Fe)}function vI(we){var Ee,Fe=0,De=0,ke=0,Me=0;if(y(+we),Fe=0|v(1),Ee=0|v(0),Me=Fe,ke=0,!((Fe=2047&(De=Fe>>>20))>>>0<1023||(ke=we,Fe>>>0>1075))){if(De=-1<<(19-De&31),Fe>>>0>=1044)return h(0,De&Ee),h(1,0|Me),+S();Me&=De,h(0,0),h(1,0|Me),ke=+S()}return ke}function hI(we){var Ee=0,Fe=0,De=0;if(we+307>>>0<=615)return ye[920]=0,ye[921]=-2147483648,De=bh(3680,1,we),Fe=ye[920],we=ye[921],3071&Fe&&(Ee=ye[921],(we=ye[920]+1024|0)>>>0<1024&&(Ee=Ee+1|0),ye[920]=we,ye[921]=Ee,Fe=we,we=Ee),ye[920]=we<<21|Fe>>>11,void(ye[921]=1071644672+(we>>>11&1048575|De<<20));(0|we)>=309&&(ye[922]=1),ye[920]=0,ye[921]=0}function sl(we,Ee,Fe,De){var ke=0,Me=0,Be=0;e:{r:{n:{t:{if(!De){if(Ji[we>>1]<=52)break t;break r}if(!((0|De)<1)&&(0|De)<15)break n}return ye[Ee>>2]=1,void(ye[Fe>>2]=0)}if(Ji[(De<<1)+we>>1]<=52)break e;for(;;){if(Be=Ji[(Me=((ke=De+-1|0)<<1)+we|0)>>1]+1|0,ar[Me>>1]=Be,(65535&Be)!=58)break e;if(!(De=ke))break}}return ar[we>>1]=49,ye[Ee>>2]=ye[Ee>>2]+1,void(ye[Fe>>2]=1)}for(;Ee=De,(0|De)>=2&&Ji[((De=Ee+-1|0)<<1)+we>>1]==48;);ye[Fe>>2]=Ee}function SI(){var we=0,Ee=0,Fe=0;e:{if(Fe=ye[920],Ee=-65536&(we=ye[921])){if((2146435072&we)==2146435072)return ye[922]=1,void tg();if((0|Ee)<1)break e}return void tg()}tg(),(0|Fe)==ye[920]&&ye[921]==(0|we)||bd(1)}function ps(we){nr[460]=Ky(nr[460],we)}function Ky(we,Ee){var Fe;return y(+(we+=Ee)),Fe=0|v(1),v(0),(2146435072&Fe)==2146435072&&(ye[922]=1,we=nr[375]),we}function bd(we){nr[460]=xS(nr[460],we)}function xS(we,Ee){var Fe;return y(+(we-=Ee)),Fe=0|v(1),v(0),(2146435072&Fe)==2146435072&&(ye[922]=1,we=nr[375]),we}function ef(we){nr[460]=Vy(nr[460],we)}function Vy(we,Ee){var Fe,De=0,ke=0,Me=0;return y(+we*Ee),De=0|v(1),Fe=0|v(0),0|(0|(ke=2146435072&De))!=2146435072?(Me=(ke=!(ke|Me))?ye[750]:Fe,De=ke?ye[751]:De,h(0,0|Me),h(1,0|De),+S()):(ye[922]=1,De=ye[751],h(0,ye[750]),h(1,0|De),+S())}function Ph(we){nr[460]=Pd(nr[460],we)}function Pd(we,Ee){var Fe=0,De=0,ke=0,Me=0;if(y(+Ee),Fe=0|v(1),v(0),2146435072&Fe){if(De=1,y(+we/Ee),Fe=0|v(1),ke=0|v(0),!(!0&(0|(Me=2146435072&Fe))==2146435072))return ke=(De=!(0|Me))?ye[750]:ke,Fe=De?ye[751]:Fe,h(0,0|ke),h(1,0|Fe),+S()}else De=4;return ye[922]=De,Fe=ye[751],h(0,ye[750]),h(1,0|Fe),+S()}function fb(we){nr[460]=we>>>0}function Hf(we){nr[460]=0|we}function rv(){var we,Ee;we=+wN(+nr[460]),nr[460]=we,y(+we),Ee=0|v(1),v(0),(2146435072&Ee)==2146435072&&(ye[922]=8)}function ng(){return pb(nr[460])}function pb(we){var Ee,Fe=0,De=0,ke=0,Me=0;return y(+we),Me=(0|(ke=2146435072&(Fe=0|v(1))))==1106247680&Me>>>0<0|ke>>>0<1106247680,Ee=Fe&=2147483647,h(0,0|(De=0|v(0))),h(1,0|Fe),(we=+S())<18446744073709552e3&we>=0?(ke=IS(we)>=1?we>0?~~qy(Uy(we/4294967296),4294967295)>>>0:~~MS((we-+(~~we>>>0>>>0))/4294967296)>>>0:0,Fe=~~we>>>0):(ke=0,Fe=0),De=Me?Fe:De,!(Fe=Me?ke:Ee)&De>>>0<4294967295|Fe>>>0<0?De:-1}function yI(){return xN(nr[460])}function xN(we){var Ee=0,Fe=0;return y(+we),Ee=0|v(1),v(0),Fe=(0|(Ee&=2145386496))==1105199104&Fe>>>0<0|Ee>>>0<1105199104,Ee=IS(we)<2147483648?~~we:-2147483648,Fe?Ee:-2147483648}function CI(){var we,Ee;we=+cb(+nr[460]),nr[460]=we,y(+we),Ee=0|v(1),v(0),(2146435072&Ee)==2146435072&&(ye[922]=8)}function _I(){var we,Ee;we=+qW(+nr[460]),nr[460]=we,y(+we),Ee=0|v(1),v(0),(2146435072&Ee)==2146435072&&(ye[922]=8)}function tg(){nr[460]=vI(nr[460])}function mb(){var we,Ee;we=+UW(+nr[460]),nr[460]=we,y(+we),Ee=0|v(1),v(0),(2146435072&Ee)==2146435072&&(ye[922]=1)}function m0(we,Ee,Fe){return function(De,ke,Me){var Be=0,er=0,Tr=0,Lr=0;if(Be=Rd[Me+30|0]){for(er=Me;Lr=10*Lr+ +(0|F4[ye[ye[De>>2]+4>>2]](De,Ji[er>>1])),er=er+2|0,Tr=(0|Be)>1,Be=Be+-1|0,Tr;);if(y(+Lr),Be=0|v(1),De=0|v(0),ye[ke>>2]=De<<11,ye[ke+4>>2]=2147481600&((2097151&Be)<<11|De>>>21)|De>>>21|-2147483648,Be=bh(ke,(Be>>>20&2047)-1022|0,((32767&Ji[Me+32>>1])-Rd[Me+30|0]|0)-16384|0),3071&(er=ye[ke>>2])?(De=er+1024|0,ye[ke>>2]=De,er>>>0<4294966272||(Tr=(er=ye[ke+4>>2])+1|0,ye[ke+4>>2]=Tr,Be=(Tr>>>0<er>>>0)+Be|0)):De=er,!((0|Be)<=-1022))return(0|(er=1071644672+(Be<<20)|0))<0?1:(Be=ye[ke+4>>2],ye[ke>>2]=Be<<21|De>>>11,ye[ke+4>>2]=-2147483648&ar[Me+32>>1]|er|Be>>>11&1048575,0)}return ye[ke>>2]=0,ye[ke+4>>2]=0,0}(we,Ee,Fe)}function Wy(we,Ee,Fe,De){(function(ke,Me,Be,er){var Tr,Lr,pr=0,q=0,ae=0,oe=0,re=0,te=0,ge=0,Te=0,Je=0,Xe=0;Ut=Tr=Ut-16|0,nr[Tr+8>>3]=ke,Lr=Me,y(+ke),q=0|v(1),ae=0|v(0),oe=pr=q;e:if(q=2146435072&pr){if(q=Rn(re=(q>>>20)-1022|0,39457)>>17,ar[Be+32>>1]=q+16385|pr>>>16&32768,(0|er)<=14){if((0|(er=1+(er+q|0)|0))<=-1){$o[Be+30|0]=0,ar[Be+32>>1]=0,ar[Me+2>>1]=0,Me=0;break e}er=(0|er)<15?er:15}if(ye[Tr+8>>2]=ae<<11,ye[Tr+12>>2]=oe<<11|ae>>>21|-2147483648,(0|(pr=bh(Tr+8|0,re,-1^q)))>=1)for(ae=Be+32|0;q=Ji[ae>>1],ar[ae>>1]=q+1&32767|32768&q,(0|(pr=bh(Tr+8|0,pr,-1)))>0;);if(pr?(q=(ae=ye[Tr+12>>2])>>>(oe=0-pr|0),ye[Tr+12>>2]=q,pr=ae<<pr+32|ye[Tr+8>>2]>>>oe,ye[Tr+8>>2]=pr):(pr=ye[Tr+8>>2],q=ye[Tr+12>>2]),pr=(ae=q>>>0<(pr>>>0<2576980377?429496730:429496729)>>>0?922:9223)+pr|0,ye[Tr+8>>2]=pr,pr>>>0<ae>>>0&&(q=q+1|0,ye[Tr+12>>2]=q),(0|er)<1)ae=Be;else{for(te=pr>>>16,ge=Ji[Tr+14>>1],Te=Be+32|0,Xe=(0|er)==15,ae=Be,oe=1;;){re=er;r:{n:{for(;;){if(er=Rn(te,10)+(Rn(65535&pr,10)>>>16)>>>16,Je=Rn(ge,10)+(er+Rn(65535&q,10)>>>16)>>>16|48,ar[ae>>1]=Je,ge=(q=er+Rn(q,10)|0)>>>16,te=(pr=Rn(pr,10))>>>16,1&(-1^oe|(0|Je)!=48))break n;if(er=Ji[Te>>1],ar[Te>>1]=er+-1&32767|32768&er,!Xe)break}oe=1;break r}ae=ae+2|0,oe=0}if(er=re+-1|0,!((0|re)>1))break}ye[Tr+12>>2]=q,ye[Tr+8>>2]=pr}pr=(er=ae-Be|0)>>1;r:{if((0|er)<=29){if((0|q)<=-1){ar[ae>>1]=57,q=pr+1|0;break r}ar[ae>>1]=48}for(;;){if(q=pr,(0|pr)<1)break r;if(pr=q+-1|0,Ji[(ae=ae+-2|0)>>1]!=48)break}}$o[Be+30|0]=q,ar[Me+2>>1]=q,Me=(32767&Ji[Be+32>>1])-16384|0}else $o[Be+30|0]=0,ar[Be+32>>1]=0,ar[Me+2>>1]=0,Me=0;ar[Lr>>1]=Me,Ut=Tr+16|0})(we,Ee,Fe,De)}function gb(we){return xS(nr[460],we)}function LS(we){return Pd(nr[460],we)}function LN(we){nr[460]=Pd(we,nr[460])}function vb(we,Ee){nr[460]=Pd(we,Ee)}function BS(){DN(1),BS()}function jy(we,Ee){var Fe,De;Fe=0|we,De=0|Ee,p[0]=Fe,p[1]=De}function g0(we,Ee,Fe,De){return we=function(ke,Me,Be,er){var Tr,Lr,pr,q,ae=0,oe=0;return q=Rn(ae=Be>>>16,oe=ke>>>16),ae=(65535&(oe=((pr=Rn(Tr=65535&Be,Lr=65535&ke))>>>16)+Rn(oe,Tr)|0))+Rn(ae,Lr)|0,ke=(((Rn(Me,Be)+q|0)+Rn(ke,er)|0)+(oe>>>16)|0)+(ae>>>16)|0,Td=ke,65535&pr|ae<<16}(we,Ee,Fe,De),we}function O4(we,Ee,Fe,De){return function(ke,Me,Be,er){var Tr=0,Lr=0;return Be=function(pr,q,ae,oe){var re=0,te=0,ge=0,Te=0,Je=0,Xe=0,yr=0,Nn=0,on=0,nt=0;e:{r:{n:{t:{a:{i:{o:{u:{s:{l:{if(ge=q){if(!(re=ae))break l;if(!(te=oe))break s;if((re=jf(te)-jf(ge)|0)>>>0<=31)break u;break r}if((0|oe)==1&ae>>>0>=0|oe>>>0>1)break r;return jy(pr-Rn(q=(pr>>>0)/(ae>>>0)|0,ae)|0,0),Td=0,q}if(re=oe,!pr)break o;if(!re||(te=re+-1|0)&re)break i;return jy(pr,ge&te),pr=ge>>>(31&k4(re)),Td=0,pr}if(!((te=re+-1|0)&re))break a;Xe=0-(Je=(jf(re)+33|0)-jf(ge)|0)|0;break n}Je=re+1|0,Xe=63-re|0;break n}return jy(0,ge-Rn(pr=(ge>>>0)/(re>>>0)|0,re)|0),Td=0,pr}if((re=jf(re)-jf(ge)|0)>>>0<31)break t;break r}if(jy(pr&te,0),(0|re)==1)break e;return oe=pr,pr=31&(ae=k4(re)),32<=(63&ae)>>>0?(re=0,pr=q>>>pr):(re=q>>>pr,pr=((1<<pr)-1&q)<<32-pr|oe>>>pr),Td=re,pr}Je=re+1|0,Xe=63-re|0}if(te=q,on=pr,ge=31&(re=63&Je),32<=(63&re)>>>0?(re=0,Te=te>>>ge):(re=te>>>ge,Te=((1<<ge)-1&te)<<32-ge|on>>>ge),te=re,ge=pr,pr=31&(re=63&Xe),32<=(63&re)>>>0?(re=ge<<pr,pr=0):(re=(1<<pr)-1&ge>>>32-pr|q<<pr,pr=ge<<pr),q=re,Je)for(re=oe+-1|0,(ge=ae+-1|0)>>>0<4294967295&&(re=re+1|0),Xe=re;re=te<<1|Te>>>31,te=Te<<1,on=re,re=(Te=Xe-((ge>>>0<(te|=q>>>31)>>>0)+re|0)|0)>>31,Te=(Nn=te)-(te=ae&(yr=Te>>31))|0,te=on-((oe&re)+(Nn>>>0<te>>>0)|0)|0,re=q<<1|pr>>>31,pr=nt|pr<<1,q=0|re,Nn=0,nt=yr&=1,Je=Je+-1|0;);return jy(Te,te),Td=(re=q<<1|pr>>>31)|Nn,yr|pr<<1}jy(pr,q),pr=0,q=0}return Td=q,pr}((ke^=Tr=Me>>31)-Tr|0,Lr=((Lr=Me>>31)^Me)-((ke>>>0<Tr>>>0)+Lr|0)|0,(Be^=ke=er>>31)-ke|0,((Tr=er>>31)^er)-((Be>>>0<ke>>>0)+Tr|0)|0),Td=((ke=(Me^=er)>>31)^Td)-(((Be^=Me>>=31)>>>0<Me>>>0)+ke|0)|0,Be-Me|0}(we,Ee,Fe,De)}function k4(we){return we?31-jf(we+-1^we)|0:32}var F4=[null,function(we,Ee){return(0|db(0|(Ee|=0)))!=0|0},function(we,Ee){return 0|w_(0|(Ee|=0))},function(we){return 0|D_()},function(we,Ee){return(Ee|=0)-48|0},E4];return{memory:Object.create(Object.prototype,{grow:{},buffer:{get:function(){return $i}}}),Base_StrBuf:function(){return 3104},Base_StrBufSize:function(){return 255},Dtr_DaysPerMonth:function(Ee,Fe,De){return 0|function(ke,Me,Be){var er=0;er=3&Me;e:if(Be){if(er|(0|Me)<2100)break e;er=!((Me>>>0)%100)&((Me>>>0)%400|0)!=0}else er||(er=!((0|Me)%100)&((0|Me)%400|0)!=0);return Rd[1072+(((Rn(er,12)+ke|0)-1|0)%48|0)|0]}(Ee|=0,Fe|=0,(0|(De|=0))!=0)},Dtr_FromNum:function(Ee,Fe,De,ke,Me){return Ee=+Ee,Fe|=0,ke|=0,Me|=0,De=Rn(De|=0,20)+3616|0,ar[De>>1]=0,Fe=function(Be,er,Tr,Lr,pr){var q=0,ae=0,oe=0,re=0,te=0,ge=0,Te=0,Je=0,Xe=0;e:if(!Ji[Be>>1]){if(nr[460]=er,y(+er),q=0|v(1),oe=0|v(0),ge=q,Xe=-65536&q)if((2146435072&q)!=2146435072){if(!((0|Xe)>=1))return-2147467259}else ye[922]=1;te=ye[770],re=-1;r:{if(!((0|q)<(0|(ae=Te=ye[771]))||(re=1,(0|q)>(0|ae)))){if((0|te)==(0|(ae=oe)))break r;re=ae>>>0<te>>>0?-1:1}if(ae=-2147467259,(0|((ge&Te)>-1?re:0-re|0))==1)break e}r:{if(te=ye[772],Te=ae=ye[773],re=-1,!((0|q)<(0|ae)||(re=1,(0|q)>(0|Te)))){if((0|oe)==(0|te))break r;re=oe>>>0<te>>>0?-1:1}if(te=re,(0|((ae&ge)>-1?te:0-te|0))==-1)return-2147467259}r:{n:{if(!(pr|!Xe))if((2146435072&q)!=2146435072){if((0|Xe)<1)break n}else ye[922]=1;ps(nr[ye[1056+(Tr<<2)>>2]>>3]),Je=nr[460];break r}SI(),bd(er),oe=ge=ye[921],h(0,0|(q=ye[920])),h(1,0|oe),Je=+S(),ye[750]==(0|q)&&ye[751]==(0|oe)||(ae=ye[921])>>>0<65536||(ye[921]=-2147483648^ae,y(+(Je=nr[460])),oe=0|v(1),q=0|v(0)),ge=oe,te=oe,oe=ye[1056+(Tr<<2)>>2],Te=ye[oe+4>>2],ae=ye[oe>>2],re=-1;n:{if(!((0|te)<(0|(oe=Te))||(re=1,(0|te)>(0|oe)))){if((0|q)==(0|ae)){nr[460]=er;break n}re=q>>>0<ae>>>0?-1:1}if(te=re,nr[460]=er,(0|((ge&Te)>-1?te:0-te|0))==-1)break r}bd(nr[374])}if(ar[Be+18>>1]=Tr,q=yI(),ae=-2147467259,!DS(0)){if(Lr){if((0|q)>2957003)break e;q=q+1462|0}else if(q+4346018>>>0>7304483)break e;if(ar[Be+14>>1]=1+((q+6|0)%7|0),!pr|q)if(q){if((0|q)<=-1?(oe=-4-((Lr=(-1^q)/1461|0)<<2)|0,ae=1461+(Rn(Lr,1461)+q|0)|0):(oe=(Lr=(q+-1|0)/1461|0)<<2,ae=Rn(Lr,-1461)+q|0),!(pr&&(0|oe)<=199))if((0|(ae=(((0|(Lr=oe+-101|0))/100|0)-((0|Lr)/400|0)|0)+ae|0))>=1462){q=3&(Lr=oe+1900|0);r:if(pr){if(q|(0|oe)<200)break r;q=!((Lr>>>0)%100)&((Lr>>>0)%400|0)!=0}else q||(q=!((0|Lr)%100)&((0|Lr)%400|0)!=0);oe=oe+4|0,ae=((0|Rn(q,12))==12?-1460:-1461)+ae|0}else(0|ae)>0||(oe=oe+-4|0,ae=ae+1461|0);q=3&(Lr=oe+1900|0);r:if(pr){if(q|(0|oe)<200)break r;q=!((Lr>>>0)%100)&((Lr>>>0)%400|0)!=0}else q||(q=!((0|Lr)%100)&((0|Lr)%400|0)!=0);for(q=ge=Rn(q,12);pr=q,q=q+1|0,(0|(ae=(Lr=ae)-Rd[pr+1072|0]|0))>0;);pr=((ae=pr)-((0|ge)<(0|(pr=pr+-11|0))?ge:pr)>>>0)/12|0,ar[Be>>1]=1900+(pr+oe|0),ar[Be+2>>1]=(Rn(pr,-12)+q|0)-ge}else ye[Be>>2]=788331,Lr=30;else ye[Be>>2]=67436;if(ye[Be+4>>2]=Lr,nr[460]=Je,tg(),(Lr=ye[921])>>>0>=65536&&(ye[921]=-2147483648^Lr),ps(Je),ef(nr[379]),er=nr[460],Lr=ng(),ar[Be+8>>1]=Lr,fb(Lr<<16>>16),(Lr=ye[921])>>>0>=65536&&(ye[921]=-2147483648^Lr),ps(er),ef(nr[380]),er=nr[460],Lr=ng(),ar[Be+10>>1]=Lr,fb(Lr<<16>>16),(Lr=ye[921])>>>0>=65536&&(ye[921]=-2147483648^Lr),ps(er),ef(nr[380]),!Tr)return Tr=ng(),ar[Be+16>>1]=0,ar[Be+12>>1]=Tr,0;er=nr[460],Lr=ng(),ar[Be+12>>1]=Lr,fb(Lr<<16>>16),(Lr=ye[921])>>>0>=65536&&(ye[921]=-2147483648^Lr),ps(er),ef(nr[ye[1152+(Tr<<2)>>2]>>3]),nr[460]=Gy(nr[460]),ar[Be+16>>1]=ng(),ae=0}}return ae}(De,Ee,Fe,(0|ke)!=0,(0|Me)!=0),ye[922]=0,0|Fe},Dtr_Yr:function(Ee){return ar[Rn(Ee|=0,20)+3616>>1]},Dtr_Mon:function(Ee){return ar[Rn(Ee|=0,20)+3618>>1]},Dtr_DOM:function(Ee){return ye[Rn(Ee|=0,20)+3620>>2]},Dtr_Hour:function(Ee){return ar[Rn(Ee|=0,20)+3624>>1]},Dtr_Min:function(Ee){return ar[Rn(Ee|=0,20)+3626>>1]},Dtr_Sec:function(Ee){return ar[Rn(Ee|=0,20)+3628>>1]},Dtr_Wdy:function(Ee){return ar[Rn(Ee|=0,20)+3630>>1]},Dtr_FracSec:function(Ee){return ar[Rn(Ee|=0,20)+3632>>1]},Dtr_Rounding:function(Ee){return ar[Rn(Ee|=0,20)+3634>>1]},Dtr_Write:function(Ee,Fe,De,ke,Me,Be,er,Tr,Lr,pr){Ee|=0,Fe|=0,De|=0,ke|=0,Me|=0,Be|=0,er|=0,Tr|=0,Lr|=0,pr=Rn(pr|=0,20),ar[pr+3634>>1]=Lr,ar[pr+3632>>1]=Tr,ar[pr+3630>>1]=er,ar[pr+3628>>1]=Be,ar[pr+3626>>1]=Me,ar[pr+3624>>1]=ke,ye[pr+3620>>2]=De,ar[pr+3618>>1]=Fe,ar[pr+3616>>1]=Ee},Dtr_ToNum:function(Ee,Fe,De){return Ee|=0,Fe|=0,De|=0,ye[920]=0,ye[921]=0,function(ke,Me,Be){var er,Tr=0;Ut=er=Ut-16|0;e:{r:{n:{if((Ji[ke+2>>1]+-32767&65535)>>>0>1){if(ar[ke+18>>1]>=1?(Hf(ar[ke+16>>1]),Tr=LS(nr[ye[1152+(ar[ke+18>>1]<<2)>>2]>>3]),Hf(ar[ke+12>>1]),ps(Tr)):Hf(ar[ke+12>>1]),Tr=LS(nr[380]),Hf(ar[ke+10>>1]),ps(Tr),Tr=LS(nr[380]),Hf(ar[ke+8>>1]),ps(Tr),Tr=LS(nr[379]),!((0|ev(ke,Me,Be,er+12|0))<0)){if(ke=ye[er+12>>2],!Me)break n;if(Hf(ke+-1462|0),!((0|ke)<1462)){if(!(Me=-65536&(ke=ye[921])))break r;if((2146435072&ke)==2146435072){ye[922]=1;break r}if((0|Me)>=1)break r}}ye[920]=0,ye[921]=0}ye[920]=0,ye[921]=0,DS(8);break e}fb(ke)}ps(Tr)}Ut=er+16|0}(Rn(Ee,20)+3616|0,(0|Fe)!=0,(0|De)!=0),+nr[460]},Dtr_ToNumWithDuration:function(Ee,Fe,De,ke,Me){return Ee|=0,Fe|=0,De|=0,ke|=0,Me|=0,ye[920]=0,ye[921]=0,function(Be,er,Tr,Lr,pr){var q,ae=0;Ut=q=Ut-16|0;e:{r:{n:{if((Ji[Be+2>>1]+-32767&65535)>>>0>1){t:if(ar[Be+18>>1]>=1){if(Hf(ar[Be+16>>1]),Ph(nr[ye[1152+(ar[Be+18>>1]<<2)>>2]>>3]),ae=nr[460],(0|pr)==2){nr[460]=Lr,ps(ae);break t}Hf(ar[Be+12>>1]),ps(ae)}else(0|pr)!=2?Hf(ar[Be+12>>1]):nr[460]=Lr;if(Ph(nr[380]),ae=nr[460],(0|pr)!=1?Hf(ar[Be+10>>1]):nr[460]=Lr,ps(ae),Ph(nr[380]),ae=nr[460],pr?Hf(ar[Be+8>>1]):nr[460]=Lr,ps(ae),Ph(nr[379]),Lr=nr[460],!((0|ev(Be,er,Tr,q+12|0))<0)){if(Be=ye[q+12>>2],!er)break n;if(Hf(Be+-1462|0),!((0|Be)<1462)){if(!(er=-65536&(Be=ye[921])))break r;if((2146435072&Be)==2146435072){ye[922]=1;break r}if((0|er)>=1)break r}}ye[920]=0,ye[921]=0}ye[920]=0,ye[921]=0,DS(8);break e}fb(Be)}ps(Lr)}Ut=q+16|0}(Rn(Ee,20)+3616|0,(0|Fe)!=0,(0|De)!=0,+(0|Me),ke),+nr[460]},Dtr_Days:function(){return ye[919]},Dtr_ToDays:function(Ee,Fe,De){return Fe|=0,De|=0,0|ev(Rn(Ee|=0,20)+3616|0,(0|Fe)!=0,(0|De)!=0,3676)},Dtr_ToTime:function(Ee,Fe,De){return function(ke,Me,Be){nr[460]=ke,ps(nr[ye[1056+(Be<<2)>>2]>>3]);e:{if(Me>>>0<=1){if(Me-1)break e}else ef(nr[380]);ef(nr[380])}ef(nr[379]),tg()}(Ee=+Ee,Fe|=0,De|=0),+nr[460]},Dtr_UtcToLocal:function(Ee,Fe,De,ke,Me,Be,er,Tr){var Lr;return Ee|=0,Fe|=0,De|=0,ke|=0,Me|=0,Be|=0,er|=0,Tr|=0,Ut=Lr=Ut-32|0,ye[Lr+24>>2]=Be,ye[Lr+16>>2]=ke,ye[Lr+8>>2]=Fe,ye[Lr+20>>2]=(0|Me)>-1?Rn(Me,20)+3616|0:0,ye[Lr+12>>2]=(0|De)>-1?Rn(De,20)+3616|0:0,Ee=function(pr,q,ae,oe){var re,te=0;return Ut=re=Ut-32|0,function(ge,Te,Je){var Xe,yr=0,Nn=0,on=0,nt=0,Qa=0,ju=0,Ls=0,ag=0,qS=0,RI=0,vse=0,hse=0;if(Ut=Xe=Ut-96|0,ye[Xe+64>>2]=ar[Te>>1],ye[Xe+68>>2]=ar[Te+2>>1],ye[Xe+72>>2]=ye[Te+4>>2],ye[Xe+76>>2]=ar[Te+8>>1],ye[Xe+80>>2]=ar[Te+10>>1],ye[Xe+84>>2]=ar[Te+12>>1],ye[Xe+92>>2]=ar[Te+14>>1]+-1,(yr=ar[Te+18>>1])>>>0<=3){e:{r:switch(yr-1|0){case 0:yr=Rn(ar[Te+16>>1],100);break e;case 1:yr=Rn(ar[Te+16>>1],10);break e;case 2:break r;default:break e}yr=ar[Te+16>>1]}ye[Xe+88>>2]=yr}Te=0;e:if(wS(Xe- -64|0,Xe+40|0)){if(on=g0(on=Rn(ye[ge>>2],60),on>>31,1e7,0),Qa=Td,(Nn=ye[ge+4>>2])&&(nt=ye[ge+12>>2])){if(ye[Xe+64>>2]=ar[Nn>>1],ye[Xe+68>>2]=ar[Nn+2>>1],ye[Xe+72>>2]=ye[Nn+4>>2],ye[Xe+76>>2]=ar[Nn+8>>1],ye[Xe+80>>2]=ar[Nn+10>>1],ye[Xe+84>>2]=ar[Nn+12>>1],ye[Xe+92>>2]=ar[Nn+14>>1]+-1,(yr=ar[Nn+18>>1])>>>0<=3){r:{n:switch(yr-1|0){case 0:yr=Rn(ar[Nn+16>>1],100);break r;case 1:yr=Rn(ar[Nn+16>>1],10);break r;case 2:break n;default:break r}yr=ar[Nn+16>>1]}ye[Xe+88>>2]=yr}if(ye[Xe+8>>2]=ar[nt>>1],ye[Xe+12>>2]=ar[nt+2>>1],ye[Xe+16>>2]=ye[nt+4>>2],ye[Xe+20>>2]=ar[nt+8>>1],ye[Xe+24>>2]=ar[nt+10>>1],ye[Xe+28>>2]=ar[nt+12>>1],ye[Xe+36>>2]=ar[nt+14>>1]+-1,(yr=ar[nt+18>>1])>>>0<=3){r:{n:switch(yr-1|0){case 0:yr=Rn(ar[nt+16>>1],100);break r;case 1:yr=Rn(ar[nt+16>>1],10);break r;case 2:break n;default:break r}yr=ar[nt+16>>1]}ye[Xe+32>>2]=yr}if(nt=Nn=ye[Xe+44>>2],!mI(Xe- -64|0,Xe+56|0,yr=ye[Xe+40>>2],Nn)||!mI(Xe+8|0,Xe+48|0,yr,nt))break e;qS=ye[Xe+40>>2],Ls=ye[Xe+44>>2],RI=on,vse=ge+16|0,hse=ge+8|0,ag=(nt=Qa)+ye[Xe+52>>2]|0,(ju=(yr=on)+ye[Xe+48>>2]|0)>>>0<yr>>>0&&(ag=ag+1|0),Nn=ju,ju=g0(yr=Rn(ye[ge+8>>2],60),yr>>31,1e7,0),yr=Td+ag|0,ag=Nn=Nn+ju|0,ju=yr=Nn>>>0<ju>>>0?yr+1|0:yr,Nn=Qa+ye[Xe+60>>2]|0,(Qa=on+ye[Xe+56>>2]|0)>>>0<on>>>0&&(Nn=Nn+1|0),on=g0(ge=Rn(ye[ge+16>>2],60),ge>>31,1e7,0),ge=Td+Nn|0,ge=(Qa=on+Qa|0)>>>0<on>>>0?ge+1|0:ge,on=Qa,ge=g0(ge=Rn(ye[((ge=(0|yr)<(0|ge)||(0|yr)<=(0|ge)&&!(ag>>>0>=on>>>0)?((0|Ls)<(0|ge)?1:(0|Ls)<=(0|ge)?qS>>>0>=on>>>0?0:1:0)&((0|Ls)>(0|ju)?1:(0|Ls)>=(0|ju)?qS>>>0<ag>>>0?0:1:0):((0|Ls)<(0|ge)?1:(0|Ls)<=(0|ge)?qS>>>0>=on>>>0?0:1:0)|((0|Ls)>(0|ju)?1:(0|Ls)>=(0|ju)?qS>>>0<ag>>>0?0:1:0))?vse:hse)>>2],60),ge>>31,1e7,0),yr=Td+nt|0,Qa=yr=(on=RI+ge|0)>>>0<ge>>>0?yr+1|0:yr}ge=ye[Xe+40>>2],yr=ye[Xe+44>>2]-(Qa+(ge>>>0<on>>>0)|0)|0,on=ge-on|0,(0|(ge=yr))<0||(0|ge)<=0&&!(on>>>0>=0)||(Th(on,ge,Xe- -64|0),ar[Je>>1]=ye[Xe+64>>2],ar[Je+2>>1]=ye[Xe+68>>2],ye[Je+4>>2]=ye[Xe+72>>2],Te=1,ar[Je+14>>1]=Ji[Xe+92>>1]+1,ar[Je+8>>1]=ye[Xe+76>>2],ar[Je+10>>1]=ye[Xe+80>>2],ar[Je+12>>1]=ye[Xe+84>>2],ge=ye[Xe+88>>2],ar[Je+18>>1]=3,ar[Je+16>>1]=ge)}return Ut=Xe+96|0,Te}(oe,pr,re+8|0)&&(oe=ye[re+12>>2],ye[pr>>2]=ye[re+8>>2],ye[pr+4>>2]=oe,ye[pr+16>>2]=ye[re+24>>2],oe=ye[re+20>>2],ye[pr+8>>2]=ye[re+16>>2],ye[pr+12>>2]=oe,oe=pr,(0|ev(pr,q,ae,re+28|0))>=0?pr=1+((ye[re+28>>2]+6|0)%7|0)|0:(ye[re+28>>2]=-1,pr=6),ar[oe+14>>1]=pr,te=1),Ut=re+32|0,te}(Rn(Ee,20)+3616|0,(0|er)!=0,(0|Tr)!=0,Lr+8|0),Ut=Lr+32|0,0|Ee},Mathpack_Zero:function(){return+nr[375]},Mathpack_One:function(){return+nr[374]},Mathpack_Pi:function(){return+nr[370]},Mathpack_Div:function(Ee,Fe){return+Pd(Ee=+Ee,Fe=+Fe)},Mathpack_Mul:function(Ee,Fe){return+Vy(Ee=+Ee,Fe=+Fe)},Mathpack_Sub:function(Ee,Fe){return+xS(Ee=+Ee,Fe=+Fe)},Mathpack_Add:function(Ee,Fe){return+Ky(Ee=+Ee,Fe=+Fe)},Mathpack_Power:function(Ee,Fe){return+function(De,ke){var Me=0,Be=0,er=0,Tr=0;nr[460]=ke,y(+ke),Me=0|v(1),v(0),er=Me,ye[921]=2147483647&Me,ke=nr[460];e:{if(y(+gb(nr[371])),(0|(Me=0|v(1)))==65535&(Be=0|v(0))>>>0<=4294967295|Me>>>0<65535)nr[460]=De,CI();else if(tg(),y(+gb(ke)),(0|(Me=0|v(1)))==65535&(Be=0|v(0))>>>0>4294967295|Me>>>0>65535||(0|(Me=ng()))==-1){if(nr[460]=De,y(+De),Be=0|v(1),v(0),(0|(Be=(Me=Be)>>>16<<16))>=1)rv(),ef(ke),mb();else if(!((0|Be)>-1)){if(vb(nr[374],ke),Tr=Gy(nr[460]),nr[460]=Tr,tg(),y(+gb(Tr)),(0|(Be=0|v(1)))==65535&v(0)>>>0>4294967295|Be>>>0>65535||(0|(Be=yI()))==2147483647|!(1&Be))break e;nr[460]=De,ye[921]=2147483647&Me,rv(),ef(ke),mb(),(Me=ye[921])>>>0<65536||(ye[921]=-2147483648^Me)}}else nr[460]=De,function(Lr){var pr,q=0;if((pr=ar[1843])|Lr){if(!((0|pr)<1)&&(0|ng())==10){if(q=nr[460],tg(),bd(q),!Ji[1843])return void hI(Lr);nr[460]=q}for(q=1;1&Lr&&(q=Vy(nr[460],q)),Lr>>>=1;)ef(nr[460]);nr[460]=q}else ye[922]=4&ye[922]?4:64}(Me);if(er>>>16<<16>>16<=-1){if(1&(er=ye[922]))return ye[920]=0,ye[921]=0,ye[922]=-2&er,nr[460];LN(nr[374])}return nr[460]}return ye[922]=8,nr[460]}(Ee=+Ee,Fe=+Fe)},Mathpack_Cond:function(Ee){var Fe,De;return y(+(Ee=+Ee)),Fe=0|v(1),v(0),(De=-65536&Fe)?(2146435072&Fe)==2146435072?(ye[922]=1,0):0|((0|De)<1?-1:1):0},Mathpack_Cond2:function(Ee,Fe){Fe=+Fe;var De,ke,Me,Be,er=0,Tr=0,Lr=0;y(+(Ee=+Ee)),er=0|v(1),De=0|v(0),ke=er,Be=er,y(+Fe),Me=0|v(1),er=0|v(0),Lr=-1;e:{if(!((0|ke)<(0|(Tr=Me))||(Lr=1,(0|Be)>(0|Tr)))){if(Tr=0,(0|er)==(0|De))break e;Lr=De>>>0<er>>>0?-1:1}er=Lr,Tr=(Me&ke)>-1?er:0-er|0}return 0|Tr},Mathpack_TakeMathError:function(){var Ee;return Ee=ye[922],ye[922]=0,0|Ee},Mathpack_Trunc:function(Ee){return+vI(Ee=+Ee)},Mathpack_Ceil:function(Ee){return Ee=+Ee,nr[460]=Ee,function(){var Fe=0,De=0,ke=0;e:{if(ke=ye[920],De=-65536&(Fe=ye[921])){if((2146435072&Fe)==2146435072)return ye[922]=1,void tg();if((0|De)>0)break e}return void tg()}tg(),(0|ke)==ye[920]&&ye[921]==(0|Fe)||ps(1)}(),+nr[460]},Mathpack_Floor:function(Ee){return Ee=+Ee,nr[460]=Ee,SI(),+nr[460]},Mathpack_Abs:function(Ee){var Fe=0;return y(+(Ee=+Ee)),Fe=0|v(1),Fe&=2147483647,h(0,0|v(0)),h(1,0|Fe),+S()},Mathpack_Neg:function(Ee){var Fe,De,ke,Me;return y(+(Ee=+Ee)),ke=-2147483648^(Fe=0|v(1)),h(0,0|(De=0|v(0))),h(1,0|ke),Me=+S(),+((0|Fe)==65535&De>>>0>4294967295|Fe>>>0>65535?Me:Ee)},Mathpack_Float:function(Ee){return+((Ee|=0)>>>0)},Mathpack_SFloat:function(Ee){return+(0|(Ee|=0))},Mathpack_Fix:function(Ee){return 0|pb(Ee=+Ee)},Mathpack_LFix:function(Ee){return 0|xN(Ee=+Ee)},Mathpack_SFix:function(Ee){return Ee=+Ee,nr[460]=Ee,0|gI()},Mathpack_Round:function(Ee,Fe){return+function(De,ke){var Me,Be=0,er=0,Tr=0,Lr=0;Ut=Me=Ut+-64|0,ye[Me+56>>2]=0,ar[Me+46>>1]=0,ar[Me+48>>1]=0,nr[460]=De,y(+De),Be=0|v(1),v(0);e:if(er=-65536&Be)if((2146435072&Be)!=2146435072){(0|er)>0||(Lr=32768,Be>>>0<65536||(ye[921]=-2147483648^Be,De=nr[460])),Wy(De,Me+56|0,Me+16|0,15),Ji[Me+58>>1]||(ar[Me+56>>1]=1),nr[460]=ke,Be=(0|(Be=gI()))<0?100:Be;r:{if(Tr=-65536&(er=ye[921]))if((2146435072&er)!=2146435072){if(!((0|Tr)>0)){if((Be=ye[921])>>>0>=65536&&(ye[921]=-2147483648^Be),(0|(Be=gI()))<=-1)break r;Be=0-Be|0}}else ye[922]=1;(0|(Tr=Be+(er=ar[Me+56>>1])|0))<(0|(Be=ar[Me+58>>1]))&&(ye[Me+12>>2]=Be,ye[Me+8>>2]=er,sl(Me+16|0,Me+8|0,Me+12|0,Tr),Be=ye[Me+12>>2],ar[Me+58>>1]=Be,er=ye[Me+8>>2],ar[Me+56>>1]=er),$o[Me+46|0]=Be,ar[Me+48>>1]=er+16384&32767|Lr,m0(3100,3680,Me+16|0),De=nr[460];break e}De=nr[375]}else ye[922]=1;return Ut=Me- -64|0,De}(Ee=+Ee,Fe=+Fe)},Mathpack_RoundUp:function(Ee,Fe){return+function(De,ke){var Me=0,Be=0,er=0,Tr=0,Lr=0;if(y(+De),Me=0|v(1),v(0),(Be=-65536&Me)&&((2146435072&Me)!=2146435072?Lr=(0|Be)<1?-1:1:ye[922]=1),er=N4(De,ke),nr[460]=De,nr[460]=Gy(De),bd(er),(Me=ye[921])>>>0>=65536){if((2146435072&Me)==2146435072)return ye[922]=1,er;if(Me=(0|(Me=pb(ke)<<16))<0?309:Me>>16,y(+ke),Be=0|v(1),v(0),(Tr=-65536&Be)&&((2146435072&Be)!=2146435072?Me=(0|Tr)<1?0-Me|0:Me:ye[922]=1),(0|Me)<=-309)return DS(8),0;hI(0-Me|0),(0|Lr)>-1||(Me=ye[921])>>>0<65536||(ye[921]=-2147483648^Me),ps(er),er=nr[460]}return er}(Ee=+Ee,Fe=+Fe)},Mathpack_RoundDown:function(Ee,Fe){var De;return y(+(Ee=N4(Ee=+Ee,Fe=+Fe))),De=0|v(1),v(0),(2146435072&De)==2146435072&&(ye[922]=1,Ee=-1),+Ee},Mathpack_TenTo:function(Ee){return hI(Ee|=0),+nr[460]},Mathpack_Compare:function(Ee,Fe){return+(0|function(De,ke){var Me,Be=0,er=0,Tr=0,Lr=0,pr=0;Ut=Me=Ut-16|0,nr[Me+8>>3]=De,nr[Me>>3]=ke,y(+De),Be=0|v(1),er=0|v(0),Tr=Be,y(+ke),pr=Be=0|v(1);e:{if((0|er)!=(0|(Lr=0|v(0)))||(0|Tr)!=(0|Be)){if((pr+2097152&2146435072)-(2146435072&Tr)>>>0<=5242879&&(De=Gy(De),nr[Me+8>>3]=De,y(+De),Be=0|v(1),v(0),Tr=Be,De=Gy(ke),nr[Me>>3]=De,y(+De),Be=0|v(1),v(0),pr=Be),Be=1,(0|(Tr=ye[(Lr=(er=(pr&Tr)>-1)?Me+8|0:Me)+4>>2]))>(0|(pr=ye[(er=er?Me:Me+8|0)+4>>2])))break e;if((0|Tr)<(0|pr)){Be=-1;break e}if((Lr=ye[Lr>>2])>>>0>(er=ye[er>>2])>>>0||(Be=-1,Lr>>>0<er>>>0))break e}Be=0}return Ut=Me+16|0,Be}(Ee=+Ee,Fe=+Fe))},Mathpack_GetExp32:function(Ee){var Fe;return y(+(Ee=+Ee)),Fe=0|v(1),v(0),2146435072&Fe},Mathpack_Equal:function(Ee,Fe){Fe=+Fe;var De,ke,Me=0;return y(+(Ee=+Ee)),Me=0|v(1),De=0|v(0),y(+Fe),ke=0|v(1),0|((0|De)==(0|v(0))?(0|Me)==(0|ke):0)},Mathpack_ViewRound:function(Ee){var Fe;return y(+(Ee=+Ee)),Fe=0|v(1),v(0),(2146435072&Fe)==2146435072?(ye[922]=1,-1):+Gy(Ee)},Mathpack_Sqrt:function(Ee){return Ee=+Ee,nr[460]=Ee,CI(),+nr[460]},Mathpack_Exp:function(Ee){return Ee=+Ee,nr[460]=Ee,mb(),+nr[460]},Mathpack_Ln:function(Ee){return Ee=+Ee,nr[460]=Ee,rv(),+nr[460]},Mathpack_Log:function(Ee){return Ee=+Ee,nr[460]=Ee,function(){var Fe,De;Fe=+MN(+nr[460]),nr[460]=Fe,y(+Fe),De=0|v(1),v(0),(2146435072&De)==2146435072&&(ye[922]=8)}(),+nr[460]},Mathpack_Sin:function(Ee){return Ee=+Ee,nr[460]=Ee,function(){var Fe=0,De=0;y(+(De=nr[460])),Fe=0|v(1),v(0),(0|(Fe&=2145386496))==1101004799&!0|Fe>>>0<1101004799&&(De=+x_(+De),nr[460]=De,y(+De),Fe=0|v(1),v(0),(2146435072&Fe)!=2146435072)||(ye[922]=8)}(),+nr[460]},Mathpack_Cos:function(Ee){return Ee=+Ee,nr[460]=Ee,function(){var Fe=0,De=0;y(+(De=nr[460])),Fe=0|v(1),v(0),(0|(Fe&=2145386496))==1101004799&!0|Fe>>>0<1101004799&&(De=+pI(+De),nr[460]=De,y(+De),Fe=0|v(1),v(0),(2146435072&Fe)!=2146435072)||(ye[922]=8)}(),+nr[460]},Mathpack_Tan:function(Ee){return Ee=+Ee,nr[460]=Ee,function(){var Fe=0,De=0,ke=0;ke=8,y(+(De=nr[460])),Fe=0|v(1),v(0),(0|(Fe&=2145386496))==1101004799&!0|Fe>>>0<1101004799&&(De=+BW(+De),nr[460]=De,ke=4,y(+De),Fe=0|v(1),v(0),(2146435072&Fe)!=2146435072)||(ye[922]=ke)}(),+nr[460]},Mathpack_Asin:function(Ee){return+A4(Ee=+Ee,0)},Mathpack_Acos:function(Ee){return+A4(Ee=+Ee,1)},Mathpack_Atan:function(Ee){return Ee=+Ee,nr[460]=Ee,_I(),+nr[460]},Mathpack_Atan2:function(Ee,Fe){return+function(De,ke){var Me=0,Be=0,er=0,Tr=0,Lr=0;nr[460]=De;e:{if(y(+De),Me=0|v(1),v(0),Me>>>0>=65536){if((2146435072&Me)!=2146435072)break e;ye[922]=1}nr[460]=ke;r:{if(y(+ke),Me=0|v(1),v(0),Be=-65536&Me){if((2146435072&Me)!=2146435072)break r;ye[922]=1}return DS(4),0}return Hf((0|Be)<1?-1:1),ef(nr[370]),Ph(nr[372]),nr[460]}e:if((0|Me)<=-1){y(+ke),Me=0|v(1),v(0);r:{if(Be=-65536&Me)if((2146435072&Me)!=2146435072){if((0|Be)<1)break r}else ye[922]=1;er=nr[370];break e}y(+(er=nr[370])),Tr=-2147483648^(Me=0|v(1)),h(0,0|(Be=0|v(0))),h(1,0|Tr),Lr=+S(),er=(0|Me)==65535&Be>>>0>4294967295|Me>>>0>65535?Lr:er}else er=nr[375];return vb(ke,De),_I(),ps(er),nr[460]}(Ee=+Ee,Fe=+Fe)},Mathpack_FormatGeneral:function(Ee,Fe){Fe|=0;var De,ke,Me,Be=0,er=0;return y(+(Ee=+Ee)),De=0|v(1),Me=0|v(0),(2146435072&De)==2146435072?(ye[922]=1,-1):(nr[460]=Ee,Be=3104,(ke=-65536&(er=De))&&((2146435072&er)!=2146435072?(Be=3104,(0|ke)>0||(er>>>0>=65536&&(ye[921]=-2147483648^er),Be=3104,!Me&(0|De)==-2147483648||(ar[1552]=45,Be=3106))):(ye[922]=1,Be=3104)),er=Be,Fe=(0|Fe)<255?Fe:255,Fe=function(Tr,Lr,pr,q){var ae;Ut=ae=Ut-16|0,Tr=0|F4[ye[ye[Tr>>2]+8>>2]](Tr),ye[ae+8>>2]=0;e:if(pr<<1>>>0<=33){if((0|pr)<1)break e;ar[Lr>>1]=0}else Wy(nr[460],ae+8|0,Lr,15),Lr=function(oe,re,te,ge,Te,Je){var Xe,yr,Nn,on=0,nt=0,Qa=0,ju=0,Ls=0;Ut=yr=Ut-16|0,Xe=(re<<1)+oe|0,Nn=yr+12|0;r:{n:{t:{a:if(!(Qa=(0|te)<5&(nt=Te?ge:1)+3>>>0<8)){i:if(!((0|nt)>(0|te))){if((0|(ge=te+nt|0))>=3){if((0|te)<5|(0|nt)>-4)break a;if((ge+-2|0)<(0|Te))break i;break a}if((0|te)<5)break a}if(ju=1,ge=1,(0|te)<7)break t;ge=te-(nt+97>>>0>196?6:5)|0;break t}((0|te)!=1||(ge=0,nt))&&(ge=te-((0|nt)<(0|te)?(0|nt)<1?2-nt|0:1:0)|0)}t:{if((0|ge)<(0|Te)){on=1,Te=0;a:if(!((0|re)<1)){i:{o:{if(!ge){if(Ji[oe>>1]>52)break o;break a}if((0|ge)<1|(0|ge)>=(0|re))break a;if(Ji[(ge<<1)+oe>>1]<=52)break i;for(;;){if(Ls=Ji[(on=((Te=ge+-1|0)<<1)+oe|0)>>1]+1|0,ar[on>>1]=Ls,(65535&Ls)!=58)break i;if(ge=Te,!Te)break}}ar[oe>>1]=49,Te=1,on=nt+1|0;break a}for(;(0|(Te=ge))>=2&&Ji[((ge=Te+-1|0)<<1)+oe>>1]==48;);on=nt}if((-1^Qa)&(0|on)>(0|te)|ju)break t;break n}if(on=nt,!ju)break n}if(ye[Nn>>2]=32768,te=oe+2|0,(0|Te)<2||(ge=te+(Te<<1)|0)>>>0>=Xe>>>0?ge=te:(Te=Te+-1|0,ye[Nn>>2]=32768|Te,oe=oe+4|0,(re<<1)-4>>1>>>0<Te>>>0&&BS(),$g(oe,te,Te<<1),ar[te>>1]=Je),ge>>>0<Xe>>>0&&(ar[ge>>1]=69,ge=ge+2|0),ge>>>0>=Xe>>>0?Te=ge:(Te=ge+2|0,(0|on)<=0?(ar[ge>>1]=45,on=1-on|0):(ar[ge>>1]=43,on=on+-1|0)),(0|on)<100|Te>>>0>=Xe>>>0||(oe=(on>>>0)/100|0,ar[Te>>1]=oe+48,on=on-Rn(oe,100)|0,Te=Te+2|0),Te>>>0<Xe>>>0&&(ar[Te>>1]=48+((0|on)/10|0),Te=Te+2|0),Te>>>0>=Xe>>>0)break r;ar[Te>>1]=48+((0|on)%10|0),Te=Te+2|0;break r}if((0|Te)<0|(0|Te)>(0|on))if(te=Te-on|0,ye[Nn>>2]=te,(0|on)>=1){if(!((te=(ge=((Qa=(te=(nt=(0|on)>(0|re)?re:on)<<1)+oe|0)+(Te<<1)|0)-te|0)-2|0)>>>0<oe>>>0|ge>>>0>=Xe>>>0))for(;ar[ge>>1]=Ji[te>>1],ge=ge+-2|0,(te=te+-2|0)>>>0>=Qa>>>0;);(0|on)<(0|re)&&(ar[Qa>>1]=Je),Te=Qa+(((0|(oe=Xe-Qa>>1))>(0|(re=Te-nt|0))?re+1|0:oe)<<1)|0}else{if(!((ge=2+((oe-(on<<1)|0)+(Te<<1)|0)|0)>>>0>=Xe>>>0||(Te=((Te<<1)+oe|0)-2|0)>>>0<oe>>>0))for(;ar[ge>>1]=Ji[Te>>1],ge=ge+-2|0,(Te=Te+-2|0)>>>0>=oe>>>0;);if((0|re)>=1&&(ar[oe>>1]=48,oe=oe+2|0),oe>>>0<Xe>>>0&&(ar[oe>>1]=Je,oe=oe+2|0),ge=Xe-oe>>1,on&&(re=(0|ge)<(0|(re=0-on|0))?ge:re))for(Te=0;ar[(Te<<1)+oe>>1]=48,(0|re)!=(0|(Te=Te+1|0)););Te=(((0|ge)<(0|te)?ge:te)<<1)+oe|0}else{if(te=(ge=(0|on)>(0|re)?re:on)-Te|0)for(re=(Te<<1)+oe|0,Te=0;ar[re+(Te<<1)>>1]=48,(0|te)!=(0|(Te=Te+1|0)););Te=(ge<<1)+oe|0}}return Ut=yr+16|0,Te}(Lr,pr,q,ar[ae+8>>1],ar[ae+10>>1],Tr);return Ut=ae+16|0,Lr}(ye[256],er,3614-er>>1,(0|Fe)>0?Fe:0),ye[920]=0,ye[921]=0,Fe-3104>>1)},Mathpack_FormatGetExponent:function(){return ye[924]},Mathpack_FormatGetSign:function(){return ye[925]},Mathpack_FormatFixed:function(Ee,Fe,De){Fe|=0,De|=0;var ke,Me=0,Be=0;return Ut=ke=Ut+-64|0,y(+(Ee=+Ee)),Me=0|v(1),v(0),(2146435072&Me)!=2146435072?(ye[ke+56>>2]=0,ar[ke+46>>1]=0,ar[ke+48>>1]=0,Wy(Ee,ke+56|0,ke+16|0,(Me=Fe+De|0)>>>0<15?Me:15),Be=ar[ke+56>>1],Me=ar[ke+58>>1],ye[ke+8>>2]=Me,Fe=Fe+Be|0,ye[ke+12>>2]=Fe,(0|(Fe=Fe+De|0))<(0|Me)&&(sl(ke+16|0,ke+12|0,ke+8|0,Fe),Me=ye[ke+8>>2]),Me?((0|(De=De+(Fe=ye[ke+12>>2])|0))<(0|Me)&&(ye[ke+8>>2]=De,Me=De),(0|Me)>-1||(ye[922]=1)):(Me=0,ye[ke+12>>2]=0,Fe=0),ye[924]=Fe,ye[925]=Ji[ke+48>>1]>>>15^1,De=Me,Me>>>0>=256&&(BS(),De=ye[ke+8>>2]),$g(3104,ke+16|0,Me<<1)):(ye[922]=1,De=-1),Ut=ke- -64|0,0|De},Mathpack_FormatScientific:function(Ee,Fe,De){Fe|=0,De|=0;var ke,Me=0,Be=0,er=0;if(Ut=ke=Ut+-64|0,y(+(Ee=+Ee)),Be=0|v(1),v(0),(2146435072&Be)!=2146435072){if(ye[ke+56>>2]=0,ar[ke+46>>1]=0,ar[ke+48>>1]=0,Wy(Ee,ke+56|0,ke+16|0,15),er=ar[ke+56>>1],ye[ke+12>>2]=er,Be=ar[ke+58>>1],ye[ke+8>>2]=Be,(0|(Me=Fe))>=2&&(Me=(0|er)%(0|Fe)|0,Me=((0|er)<1?Fe:Me?0:Fe)+Me|0),!((0|(Me=De+Me|0))>=(0|Be))){for(sl(ke+16|0,ke+12|0,ke+8|0,Me),Me=(0|Me)<(0|(Be=ye[ke+8>>2]))?Me:Be;Be=Me,(0|Me)>=1&&Ji[(ke+16|0)+((Me=Be+-1|0)<<1)>>1]==48;);ye[ke+8>>2]=Be,(0|Fe)<2||(0|(Me=ye[ke+12>>2]))!=(0|er)&&((((er=De)+(De=(0|Me)%(0|Fe)|0)|0)+((0|Me)<1?Fe:De?0:Fe)|0)>=(0|Be)||(BS(),Be=ye[ke+8>>2]))}(0|Be)<=-1&&(ye[922]=1),ye[924]=ye[ke+12>>2],ye[925]=Ji[ke+48>>1]>>>15^1,(Me=Be)>>>0>=256&&(BS(),Me=ye[ke+8>>2]),$g(3104,ke+16|0,Be<<1)}else ye[922]=1,Me=-1;return Ut=ke- -64|0,0|Me},Mathpack_Pack:function(Ee,Fe,De){var ke;return Ee|=0,Fe|=0,De|=0,Ut=ke=Ut-48|0,$o[ke+39|0]=0,$g(ke+8|0,3104,(De=(0|De)<15?De:15)<<1),ar[ke+40>>1]=Fe+16384&32767|!Ee<<15,$o[ke+38|0]=De,ye[ke>>2]=0,ye[ke+4>>2]=0,m0(ye[256],ke,ke+8|0)&&(ye[922]=1),Ut=ke+48|0,+nr[ke>>3]},_start:E4,__errno_location:function(){return 3712},setThrew:function(Ee,Fe){Ee|=0,Fe|=0,ye[926]||(ye[927]=Fe,ye[926]=Ee)},stackSave:function(){return 0|Ut},stackAlloc:function(Ee){return Ut=Ee=Ut-(Ee|=0)&-16,0|Ee},stackRestore:function(Ee){Ut=Ee|=0},__growWasmMemory:function(Ee){return 0|BS()}}}({Math:s.Math,Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,NaN:NaN,Infinity:1/0},{abort:function(){throw new Error("abort")},Base_LocaleIsNumeral:c.Base_LocaleIsNumeral,Base_LocaleGetOrdinal:c.Base_LocaleGetOrdinal,Base_LocaleDecimalSeparator:c.Base_LocaleDecimalSeparator,Math_log10:c.Math_log10,Math_log:c.Math_log,Math_sqrt:c.Math_sqrt,Math_sin:c.Math_sin,Math_cos:c.Math_cos,Math_tan:c.Math_tan,Math_atan:c.Math_atan,Math_exp:c.Math_exp,proc_exit:l.proc_exit},E),w=F.memory;t.memory=w;var B=F.Base_StrBuf;t.Base_StrBuf=B;var k=F.Base_StrBufSize;t.Base_StrBufSize=k;var x=F.Dtr_DaysPerMonth;t.Dtr_DaysPerMonth=x;var G=F.Dtr_FromNum;t.Dtr_FromNum=G;var H=F.Dtr_Yr;t.Dtr_Yr=H;var L=F.Dtr_Mon;t.Dtr_Mon=L;var D=F.Dtr_DOM;t.Dtr_DOM=D;var U=F.Dtr_Hour;t.Dtr_Hour=U;var V=F.Dtr_Min;t.Dtr_Min=V;var ne=F.Dtr_Sec;t.Dtr_Sec=ne;var J=F.Dtr_Wdy;t.Dtr_Wdy=J;var $=F.Dtr_FracSec;t.Dtr_FracSec=$;var Z=F.Dtr_Rounding;t.Dtr_Rounding=Z;var ie=F.Dtr_Write;t.Dtr_Write=ie;var X=F.Dtr_ToNum;t.Dtr_ToNum=X;var Q=F.Dtr_ToNumWithDuration;t.Dtr_ToNumWithDuration=Q;var b=F.Dtr_Days;t.Dtr_Days=b;var R=F.Dtr_ToDays;t.Dtr_ToDays=R;var P=F.Dtr_ToTime;t.Dtr_ToTime=P;var A=F.Dtr_UtcToLocal;t.Dtr_UtcToLocal=A;var T=F.Mathpack_Zero;t.Mathpack_Zero=T;var g=F.Mathpack_One;t.Mathpack_One=g;var O=F.Mathpack_Pi;t.Mathpack_Pi=O;var M=F.Mathpack_Div;t.Mathpack_Div=M;var K=F.Mathpack_Mul;t.Mathpack_Mul=K;var W=F.Mathpack_Sub;t.Mathpack_Sub=W;var z=F.Mathpack_Add;t.Mathpack_Add=z;var ee=F.Mathpack_Power;t.Mathpack_Power=ee;var ue=F.Mathpack_Cond;t.Mathpack_Cond=ue;var ce=F.Mathpack_Cond2;t.Mathpack_Cond2=ce;var he=F.Mathpack_TakeMathError;t.Mathpack_TakeMathError=he;var de=F.Mathpack_Trunc;t.Mathpack_Trunc=de;var pe=F.Mathpack_Ceil;t.Mathpack_Ceil=pe;var _e=F.Mathpack_Floor;t.Mathpack_Floor=_e;var Ce=F.Mathpack_Abs;t.Mathpack_Abs=Ce;var Ne=F.Mathpack_Neg;t.Mathpack_Neg=Ne;var Le=F.Mathpack_Float;t.Mathpack_Float=Le;var Oe=F.Mathpack_SFloat;t.Mathpack_SFloat=Oe;var le=F.Mathpack_Fix;t.Mathpack_Fix=le;var me=F.Mathpack_LFix;t.Mathpack_LFix=me;var Pe=F.Mathpack_SFix;t.Mathpack_SFix=Pe;var Re=F.Mathpack_Round;t.Mathpack_Round=Re;var fe=F.Mathpack_RoundUp;t.Mathpack_RoundUp=fe;var Se=F.Mathpack_RoundDown;t.Mathpack_RoundDown=Se;var be=F.Mathpack_TenTo;t.Mathpack_TenTo=be;var xe=F.Mathpack_Compare;t.Mathpack_Compare=xe;var Ie=F.Mathpack_GetExp32;t.Mathpack_GetExp32=Ie;var Ve=F.Mathpack_Equal;t.Mathpack_Equal=Ve;var Ze=F.Mathpack_ViewRound;t.Mathpack_ViewRound=Ze;var gr=F.Mathpack_Sqrt;t.Mathpack_Sqrt=gr;var cr=F.Mathpack_Exp;t.Mathpack_Exp=cr;var _r=F.Mathpack_Ln;t.Mathpack_Ln=_r;var xr=F.Mathpack_Log;t.Mathpack_Log=xr;var Or=F.Mathpack_Sin;t.Mathpack_Sin=Or;var Rr=F.Mathpack_Cos;t.Mathpack_Cos=Rr;var ir=F.Mathpack_Tan;t.Mathpack_Tan=ir;var $e=F.Mathpack_Asin;t.Mathpack_Asin=$e;var qe=F.Mathpack_Acos;t.Mathpack_Acos=qe;var fr=F.Mathpack_Atan;t.Mathpack_Atan=fr;var lr=F.Mathpack_Atan2;t.Mathpack_Atan2=lr;var dn=F.Mathpack_FormatGeneral;t.Mathpack_FormatGeneral=dn;var Un=F.Mathpack_FormatGetExponent;t.Mathpack_FormatGetExponent=Un;var Gr=F.Mathpack_FormatGetSign;t.Mathpack_FormatGetSign=Gr;var Br=F.Mathpack_FormatFixed;t.Mathpack_FormatFixed=Br;var bt=F.Mathpack_FormatScientific;t.Mathpack_FormatScientific=bt;var Kr=F.Mathpack_Pack;t.Mathpack_Pack=Kr;var Pt=F._start;t._start=Pt;var Mi=F.__errno_location;t.__errno_location=Mi;var El=F.setThrew;t.setThrew=El;var Nl=F.stackSave;t.stackSave=Nl;var ys=F.stackAlloc;t.stackAlloc=ys;var _d=F.stackRestore;t.stackRestore=_d;var xu=F.__growWasmMemory;t.__growWasmMemory=xu},3231:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Base_LocaleDecimalSeparator",{enumerable:!0,get:function(){return s.Base_LocaleDecimalSeparator}}),Object.defineProperty(t,"Base_LocaleGetOrdinal",{enumerable:!0,get:function(){return s.Base_LocaleGetOrdinal}}),Object.defineProperty(t,"Base_LocaleIsNumeral",{enumerable:!0,get:function(){return s.Base_LocaleIsNumeral}}),t.Math_tan=t.Math_sqrt=t.Math_sin=t.Math_log10=t.Math_log=t.Math_exp=t.Math_cos=t.Math_atan=void 0;var s=d(4700),c=Math.sqrt;t.Math_sqrt=c;var l=Math.log10||function(y){return Math.log(y)*Math.LOG10E};t.Math_log10=l;var f=Math.log;t.Math_log=f;var p=Math.exp;t.Math_exp=p;var m=Math.sin;t.Math_sin=m;var v=Math.cos;t.Math_cos=v;var h=Math.tan;t.Math_tan=h;var S=Math.atan;t.Math_atan=S},3263:function(u,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Math=void 0;var d=function(s){if(s.imul&&s.fround&&s.clz32)return s;var c=new Float32Array(1);return Object.create(s,{imul:{value:function(f,p){var m=(4194303&f)*(p|=0);return 4290772992&f&&(m+=(4290772992&f)*p|0),0|m}},fround:{value:function(f){return c[0]=f,c[0]}},clz32:{value:function(f){var p=f>>>0;return p===0?32:31-(s.log(p)/s.LN2|0)|0}}})}(Math);t.Math=d},1721:function(u,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.proc_exit=function(d){throw new Error("unexpected process termination: "+d)}},2472:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.utcToLocal=t.toTime=t.TimeDivision=t.toDays=t.toNumWithDuration=t.toNum=t.fromNum=t.dtr=t.Rounding=t.daysPerMonth=void 0;var s,c,l=d(2914),f=d(1039);function p(h,S,y,C,E,I,F,w,B){return{yr:h,mon:S,dom:y,hour:C,min:E,sec:I,wdy:F,fracSec:w,rounding:B}}function m(h){return p((0,l.Dtr_Yr)(h),(0,l.Dtr_Mon)(h),(0,l.Dtr_DOM)(h),(0,l.Dtr_Hour)(h),(0,l.Dtr_Min)(h),(0,l.Dtr_Sec)(h),(0,l.Dtr_Wdy)(h),(0,l.Dtr_FracSec)(h),(0,l.Dtr_Rounding)(h))}function v(h,S){(0,l.Dtr_Write)(S.yr,S.mon,S.dom,S.hour,S.min,S.sec,S.wdy,S.fracSec,S.rounding,h)}t.daysPerMonth=function(h,S,y){return(0,l.Dtr_DaysPerMonth)(h,S,y?1:0)},(c=t.Rounding||(t.Rounding={}))[c.RoundSec=0]="RoundSec",c[c.Round10ths=1]="Round10ths",c[c.Round100ths=2]="Round100ths",c[c.Round1000ths=3]="Round1000ths",t.dtr=p,t.fromNum=function(h,S,y,C){var E=S;return(0,l.Dtr_FromNum)(h,E,0,y?1:0,C?1:0)===0&&m(0)},t.toNum=function(h,S,y){v(0,h);var C=(0,l.Dtr_ToNum)(0,S?1:0,y?1:0),E=(0,l.Mathpack_TakeMathError)();return E===f.MathErrorNum.None?C:(0,f.mathError)(E)},t.toNumWithDuration=function(h,S,y,C,E){v(0,h);var I=C,F=(0,l.Dtr_ToNumWithDuration)(0,S?1:0,y?1:0,I,E),w=(0,l.Mathpack_TakeMathError)();return w===f.MathErrorNum.None?F:(0,f.mathError)(w)},t.toDays=function(h,S,y){return v(0,h),(0,l.Dtr_ToDays)(0,S?1:0,y?1:0)===0&&(0,l.Dtr_Days)()},(s=t.TimeDivision||(t.TimeDivision={}))[s.Hour=0]="Hour",s[s.Minute=1]="Minute",s[s.Second=2]="Second",t.toTime=function(h,S,y){var C=S,E=y,I=(0,l.Dtr_ToTime)(h,C,E);return(0,l.Mathpack_TakeMathError)()===f.MathErrorNum.None&&I},t.utcToLocal=function(h,S,y,C){return v(0,h),S.standardDate!=null&&v(1,S.standardDate),S.daylightDate!=null&&v(2,S.daylightDate),(0,l.Dtr_UtcToLocal)(0,S.bias,S.standardDate!=null?1:-1,S.standardBias,S.daylightDate!=null?2:-1,S.daylightBias,y?1:0,C?1:0)!==0&&m(0)}},9799:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSupported=t.dtr=t.mathpack=void 0;var s=d(1039);t.mathpack=s;var c=d(2472);t.dtr=c;var l=d(4700);Object.defineProperty(t,"isSupported",{enumerable:!0,get:function(){return l.isSupported}}),(0,d(2914)._start)()},1039:function(u,t,d){"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0}),t.pack=t.formatScientific=t.formatFixed=t.formatGeneral=t.atan2=t.atan=t.acos=t.asin=t.tan=t.cos=t.sin=t.log=t.ln=t.exp=t.sqrt=t.viewRound=t.cond2=t.cond=t.power=t.add=t.sub=t.mul=t.div=t.compare=t.tenTo=t.roundDown=t.roundUp=t.round=t.sfix=t.lfix=t.fix=t.float=t.neg=t.abs=t.floor=t.ceil=t.trunc=t.equal=t.exp32=t.pi=t.one=t.zero=t.mathError=t.MathErrorNum=void 0;var c,l=d(2914),f=d(4700),p=d(2914);function m(E,I){for(var F=new Uint16Array(p.memory.buffer),w="",B=0;B<I;B+=1)w+=String.fromCharCode(F[E+(B<<1)>>1]);return w}function v(E){return{num:E}}(function(E){E[E.None=0]="None",E[E.Over=1]="Over",E[E.Under=2]="Under",E[E.DivBy0=4]="DivBy0",E[E.Trans=8]="Trans",E[E._NA=16]="_NA",E[E._Val=32]="_Val",E[E._Num=64]="_Num"})(c=t.MathErrorNum||(t.MathErrorNum={}));var h=((s={})[c.Over]=v(c.Over),s[c.Under]=v(c.Under),s[c.DivBy0]=v(c.DivBy0),s[c.Trans]=v(c.Trans),s);function S(E){var I;return(I=h[E])!==null&&I!==void 0?I:v(E)}function y(E){return function(I){var F=E(I),w=(0,l.Mathpack_TakeMathError)();return w===c.None?F:S(w)}}function C(E){return function(I,F){var w=E(I,F),B=(0,l.Mathpack_TakeMathError)();return B===c.None?w:S(B)}}t.mathError=S,t.zero=l.Mathpack_Zero,t.one=l.Mathpack_One,t.pi=l.Mathpack_Pi,t.exp32=l.Mathpack_GetExp32,t.equal=function(E,I){return(0,l.Mathpack_Equal)(E,I)!==0},t.trunc=l.Mathpack_Trunc,t.ceil=y(l.Mathpack_Ceil),t.floor=y(l.Mathpack_Floor),t.abs=l.Mathpack_Abs,t.neg=l.Mathpack_Neg,t.float=function(E){return E<0?(0,l.Mathpack_SFloat)(E):(0,l.Mathpack_Float)(E)},t.fix=function(E){return(0,l.Mathpack_Fix)(E)>>>0},t.lfix=l.Mathpack_LFix,t.sfix=y(l.Mathpack_SFix),t.round=C(l.Mathpack_Round),t.roundUp=C(l.Mathpack_RoundUp),t.roundDown=C(l.Mathpack_RoundDown),t.tenTo=function(E){if(E<-1e3)return 0;if(E>1e3||!isFinite(E))return S(c.Over);var I=(0,l.Mathpack_TenTo)(E),F=(0,l.Mathpack_TakeMathError)();return F===c.None?I:S(F)},t.compare=l.Mathpack_Compare,t.div=C(l.Mathpack_Div),t.mul=C(l.Mathpack_Mul),t.sub=C(l.Mathpack_Sub),t.add=C(l.Mathpack_Add),t.power=C(l.Mathpack_Power),t.cond=function(E){var I=(0,l.Mathpack_Cond)(E),F=(0,l.Mathpack_TakeMathError)();return F===c.None?I:S(F)},t.cond2=l.Mathpack_Cond2,t.viewRound=y(l.Mathpack_ViewRound),t.sqrt=y(l.Mathpack_Sqrt),t.exp=y(l.Mathpack_Exp),t.ln=y(l.Mathpack_Ln),t.log=y(l.Mathpack_Log),t.sin=y(l.Mathpack_Sin),t.cos=y(l.Mathpack_Cos),t.tan=y(l.Mathpack_Tan),t.asin=y(l.Mathpack_Asin),t.acos=y(l.Mathpack_Acos),t.atan=y(l.Mathpack_Atan),t.atan2=C(l.Mathpack_Atan2),t.formatGeneral=function(E,I,F){try{(0,f.setLocale)(E);var w=(0,l.Mathpack_FormatGeneral)(I,F);return w<0?S((0,l.Mathpack_TakeMathError)()):m((0,l.Base_StrBuf)(),w)}finally{(0,f.setLocale)(void 0)}},t.formatFixed=function(E,I,F){var w=(0,l.Mathpack_FormatFixed)(E,I,F);if(w<0)return(0,l.Mathpack_TakeMathError)();var B=m((0,l.Base_StrBuf)(),w),k=(0,l.Mathpack_FormatGetExponent)();return{sign:(0,l.Mathpack_FormatGetSign)()!==0,mantissa:B,exponent:k}},t.formatScientific=function(E,I,F){var w=(0,l.Mathpack_FormatScientific)(E,I,F);if(w<0)return(0,l.Mathpack_TakeMathError)();var B=m((0,l.Base_StrBuf)(),w),k=(0,l.Mathpack_FormatGetExponent)();return{sign:(0,l.Mathpack_FormatGetSign)()!==0,mantissa:B,exponent:k}},t.pack=function(E,I,F,w){try{(0,f.setLocale)(E);var B=(0,f.fastMin)(w.length,(0,l.Base_StrBufSize)());(function(G,H){for(var L=new Uint16Array(p.memory.buffer),D=0;D<H.length;D+=1)L[G+(D<<1)>>1]=H.charCodeAt(D)})((0,l.Base_StrBuf)(),w.substring(0,B));var k=(0,l.Mathpack_Pack)(!!I,F,B),x=(0,l.Mathpack_TakeMathError)();return x!==c.None?S(x):isNaN(k)?S(c.Over):k}finally{(0,f.setLocale)(void 0)}}},4700:function(u,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSupported=t.fastMin=t.Base_LocaleDecimalSeparator=t.Base_LocaleGetOrdinal=t.Base_LocaleIsNumeral=t.setLocale=void 0;var d=void 0;t.setLocale=function(s){d=s},t.Base_LocaleIsNumeral=function(s){return d.isNumeral(s)?1:0},t.Base_LocaleGetOrdinal=function(s){return d.getOrdinal(s)},t.Base_LocaleDecimalSeparator=function(){var s=d.decimalSeparator;return s.length===0?46:s.charCodeAt(0)},t.fastMin=function(s,c){return s<c?s:c},t.isSupported=function(){var s=new ArrayBuffer(2);return new Uint16Array(s)[0]=1,new Uint8Array(s)[0]===1}},7857:function(u,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2825:function(u,t){"use strict";var d;Object.defineProperty(t,"__esModule",{value:!0}),t.isChangeGateEnabled=t.setChangeGatesManager=void 0,t.setChangeGatesManager=function(s){d=s},t.isChangeGateEnabled=function(s){return!d||d.isChangeGateEnabled(s)}},1880:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=d(655);s.__exportStar(d(2825),t),s.__exportStar(d(7857),t)},7145:function(u){var t=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};u.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(d){return t()}try{return __global__||t()}finally{delete Object.prototype.__global__}}()},7933:function(u,t,d){"use strict";u.exports=d(6344)()?globalThis:d(7145)},6344:function(u){"use strict";u.exports=function(){return typeof globalThis=="object"&&!!globalThis&&globalThis.Array===Array}},4011:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.adHocDeduplication=t.adHocPostFormat=t.cleanSpacesWithinParens=t.adHocPostFilter=t.adHocValidAggregation=t.adHocValidRangeOps=t.adHocPostRepair=t.adHocStringLiteralTokenRepair=t.adHocFixParens=t.adHocPreRepair=t.adHocFixTrailingOps=t.adHocFixBadSepAndApp=t.adHocFixSingleDoubleQuotes=t.adHocLogicalOperatorRepair=t.deleteExtraArgs=t.refactorLiftParenExpr=t.deleteExtraOpeningParens=t.deleteExtraClosingParens=t.trimLeadingOps=t.trimTrailingOps=t.closeOffBracket=t.adHocFixQuotesAtCharLevel=t.closeOffQuotes=t.fixSemiColon=void 0;var s=d(1583),c=d(7577),l=d(3546),f=d(5947),p=d(4719),m=d(3424),v=d(2294),h=d(9431);function S(fe){return fe.kind===c.TokenKind.Ident}function y(fe){return fe.kind===c.TokenKind.CellRef}function C(fe){return fe.kind===c.TokenKind.Literal&&(0,c.isNumberLikeOper)(fe.oper)}function E(fe){return fe.chars==="("}function I(fe){return fe.chars===")"}function F(fe){return fe.kind===c.TokenKind.Literal&&fe.oper.kind===m.OperKind.String}function w(fe){return fe.kind===c.TokenKind.Operator&&fe.value===h.OperatorId.Range}function B(fe){return fe.kind===c.TokenKind.Sep&&fe.value===c.SepId.List}function k(fe){return fe.kind===c.TokenKind.Spaces}function x(fe){var Se=new Set([h.OperatorId.Eq,h.OperatorId.Ge,h.OperatorId.Gt,h.OperatorId.Ne,h.OperatorId.Le,h.OperatorId.Lt]);return fe.kind===c.TokenKind.Operator&&Se.has(fe.value)}function G(fe){for(var Se=[],be=-1,xe=da(fe),Ie;!(Ie=xe()).done;){var Ve=Ie.value;if(be+=1,!((_r=Ve).kind===c.TokenKind.Unexpected&&_r.chars.indexOf(";")>-1)){Se.push(Ve);continue}var Ze=Se.slice(-1)[0],gr=fe[be+1];if(Ze===void 0||gr===void 0){Se.push((0,c.listSepToken)(Ve.start,","));continue}if(I(gr)){Se.push((0,c.listSepToken)(Ve.start,","));continue}if((y(Ze)||C(Ze)||F(Ze))&&(C(gr)||F(gr))){Se.push((0,c.listSepToken)(Ve.start,","));continue}if((C(Ze)||F(Ze))&&y(gr)){Se.push((0,c.listSepToken)(Ve.start,","));continue}var cr=fe[be+2];cr!==void 0?y(Ze)&&y(gr)&&w(cr)?Se.push((0,c.listSepToken)(Ve.start,",")):y(Ze)&&y(gr)&&B(cr)?Se.push((0,c.rangeOperatorToken)(Ve.start)):Se.push((0,c.listSepToken)(Ve.start,",")):Se.push((0,c.listSepToken)(Ve.start,","))}var _r;return Se.map(function(xr){return xr.chars}).join("")}function H(fe){return["]",")","(","[","&"].some(function(Se){return fe.includes(Se)})}function L(fe){var Se=new p.ExcelChecker,be=fe.map(function(xe){return xe.chars}).join("");return Se.validate(be)?be:D(be)}function D(fe){var Se='"';if(fe.search(Se)<0)return fe;for(var be=[],xe=0,Ie=fe.length,Ve=new Set(["="," ","	"]);xe<Ie&&Ve.has(fe.at(xe));)xe+=1;be.push(fe.slice(0,xe)),fe=fe.slice(xe);for(var Ze=new RegExp(/[\s&\+\-\*)(,]/),gr=new RegExp("[^"+Ze.source.slice(1,-1)+"]"),cr;fe.length>0&&(cr===void 0||fe.length!==cr);){cr=fe.length;var _r=fe.search(Ze),xr=_r<0?fe:fe.slice(0,_r);if(xr=xr.at(0)===Se&&xr.at(-1)!==Se?xr+Se:xr,xr=xr.at(0)!==Se&&xr.at(-1)===Se?Se+xr:xr,be.push(xr),_r<0){fe="";continue}var Or=fe.slice(_r),Rr=Or.search(gr);if(Rr<0)be.push(Or),fe="";else{var ir=Or.slice(0,Rr);be.push(ir),fe=Or.slice(Rr)}}return be.join("")}function U(fe){return fe.slice(0,1)==="["}function V(fe,Se){var be=function(xe){var Ie=new Set(["]","(",")"]);return Array.from(xe).findIndex(function(Ve){return Ie.has(Ve)})}(fe);return be>-1?fe.slice(be,be+1)==="]"?(Se??"")+fe:(Se??"")+fe.slice(0,be)+"]"+fe.slice(be):(Se??"")+fe+"]"}function ne(fe){return["]","(",")"].some(function(Se){return fe.includes(Se)})}function J(fe){return function(Se,be,xe,Ie){for(var Ve=[],Ze,gr=da(Se),cr;!(cr=gr()).done;){var _r=cr.value;if(be(_r.chars)){if(Ze!==void 0){var xr=xe(Ze);Ve.push({chars:xr}),Ze=void 0}if(Ie(_r.chars)){var Or=xe(_r.chars);Ve.push({chars:Or});continue}Ze=_r.chars}else if(Ze!==void 0)if(H(_r.chars)){var Rr=xe(_r.chars,Ze);Ve.push({chars:Rr}),Ze=void 0}else Ze+=_r.chars;else Ve.push(_r)}return Ze!==void 0&&Ve.push({chars:xe(Ze)}),Ve.map(function(ir){return ir.chars}).join("")}(fe,U,V,ne)}function $(){return new Set(["+","*","/",".","=","	"," ","<",">"])}function Z(fe){for(var Se=$(),be=fe.map(function(Ie){return Ie.chars}).join(""),xe=be.length-1;xe>=0&&Se.has(be.charAt(xe));)xe-=1;return xe<0?be:be.slice(0,xe+1)}function ie(fe){for(var Se=$(),be=fe.map(function(Ve){return Ve.chars}).join(""),xe=0,Ie=be.length;xe<Ie&&Se.has(be.charAt(xe));)xe+=1;return"="+be.slice(xe,Ie)}function X(fe,Se,be){for(var xe=0,Ie=[],Ve=-1,Ze=da(fe),gr;!(gr=Ze()).done;){var cr=gr.value;if(Ve+=1,cr.chars===Se||cr.chars===be)if(cr.chars!==Se){if(cr.chars===be){var _r=Ie.slice(-1)[0],xr=fe[Ve+1];if(_r!==void 0&&xr!==void 0&&(function(ir,$e){return(S(ir)||y(ir))&&(S($e)||y($e))}(Or=_r,Rr=xr)||function(ir,$e){return(S(ir)||y(ir))&&C($e)}(Or,Rr)||function(ir,$e){return C(ir)&&C($e)}(Or,Rr))){Ie.push(cr);continue}if(xe>0){xe-=1,Ie.push(cr);continue}}}else xe+=1,Ie.push(cr);else Ie.push(cr)}var Or,Rr;return Ie}function Q(fe){return X(fe,"(",")").map(function(Se){return Se.chars}).join("")}function b(fe){var Se=X(fe.slice().reverse(),")","(");return Se.reverse(),Se.map(function(be){return be.chars}).join("")}function R(fe){switch(fe.kind){case l.NodeKind.Array:return[!1,fe];case l.NodeKind.App:{var Se=fe.args.map(function(Rr){return R(Rr)}),be=Se.map(function(Rr){return Rr[0]}).some(function(Rr){return Rr}),xe=Se.map(function(Rr){return Rr[1]});if(fe.head.kind===l.NodeKind.WSF){for(var Ie=[],Ve=da(xe),Ze;!(Ze=Ve()).done;){var gr=Ze.value;gr.kind===l.NodeKind.Paren?(be=!0,Ie.push(gr.node)):Ie.push(gr)}return[be,_i(_i({},fe),{args:Ie})]}return[be,_i(_i({},fe),{args:xe})]}case l.NodeKind.Paren:var cr=R(fe.node),_r=Mr(cr,2),xr=_r[0],Or=_r[1];return function(Rr){return!!new Set(["Literal","Name","CellRef","FieldRef","StructRef","Paren"]).has(Rr.kind)||Rr.kind===l.NodeKind.App&&Rr.head.kind===l.NodeKind.WSF}(Or)?[!0,Or]:[xr,_i(_i({},fe),{node:Or})];default:return[!1,fe]}}function P(fe){var Se=new p.ExcelChecker,be=Se.parse(fe);if(!(0,s.isSuccess)(be))return fe;for(var xe=be.value,Ie=xe.node,Ve=!1;Ie.kind===l.NodeKind.Paren;)Ie=Ie.node,Ve=!0;var Ze=R(Ie),gr=Mr(Ze,2),cr=gr[0],_r=gr[1];if(Ve=Ve||cr,!Ve)return fe;var xr=_i(_i({},xe),{node:_r}),Or=Se.printRawFormula(xr);return Or!==void 0?Or:fe}function A(fe){switch(fe.kind){case l.NodeKind.App:{var Se=fe.args,be=!1;if(fe.head.kind===l.NodeKind.WSF){var xe=(0,f.getWorksheetFuncType)(fe.head.id),Ie=Se.length;if(Ie>xe.maxArgs){be=!0;var Ve=Ie-xe.maxArgs;Se=function(Rr,ir){return Rr.slice(0,-ir)}(Se.slice(),Ve)}}var Ze=Se.map(A);be=be||Ze.map(function(Rr){return Rr[0]}).some(function(Rr){return Rr});var gr=Ze.map(function(Rr){return Rr[1]});return[be,_i(_i({},fe),{args:gr})]}case l.NodeKind.Paren:{var cr=A(fe.node),_r=Mr(cr,2),xr=_r[0],Or=_r[1];return[xr,_i(_i({},fe),{node:Or})]}default:return[!1,fe]}}function T(fe){var Se=new p.ExcelChecker,be=Se.parse(fe);if(!(0,s.isSuccess)(be))return fe;var xe=be.value,Ie=xe.node,Ve=A(Ie),Ze=Mr(Ve,2),gr=Ze[0],cr=Ze[1];if(!gr)return fe;var _r=_i(_i({},xe),{node:cr}),xr=Se.printRawFormula(_r);return xr!==void 0?xr:fe}function g(fe,Se){for(var be=0,xe=fe.length;be<xe&&fe.charAt(be)===Se;)be+=1;for(var Ie=xe-1;Ie>0&&fe.charAt(Ie)===Se;)Ie-=1;return fe.slice(be,Ie+1)}function O(fe){for(var Se=[{first:function(ir){return ir.kind===c.TokenKind.Sep&&ir.value===c.SepId.Qual},second:function(ir){return ir.kind===c.TokenKind.Operator&&ir.value===h.OperatorId.Eq},newToken:c.neOperatorToken},{first:function(ir){return ir.kind===c.TokenKind.Operator&&ir.value===h.OperatorId.Eq},second:function(ir){return ir.kind===c.TokenKind.Operator&&ir.value===h.OperatorId.Gt},newToken:c.geOperatorToken}],be=[],xe=fe.length,Ie=0;Ie<xe;Ie+=1){var Ve=fe.at(Ie);if(Ie+1>xe){be.push(Ve);continue}for(var Ze=!1,gr=da(Se),cr;!(cr=gr()).done;){var _r=cr.value,xr=fe.at(Ie+1);if(_r.first(Ve)&&_r.second(xr)){var Or=_r.newToken(Ve.start);be.push(Or),Ie+=1,Ze=!0;break}}Ze||be.push(Ve)}return be.map(function(Rr){return Rr.chars}).join("")}function M(fe){for(var Se=[],be=function(lr){return lr.kind===c.TokenKind.Left&&lr.value===c.DelimId.SQuote},xe=function(lr){return lr.kind===c.TokenKind.Right&&lr.value===c.DelimId.SQuote},Ie=function(lr){return lr.kind===c.TokenKind.Sep&&lr.value===c.SepId.Qual},Ve=function(lr){return lr.kind===c.TokenKind.Ident},Ze=fe.length,gr=0;gr<Ze;gr+=1){var cr=fe.at(gr);if(Ie(cr)&&Se.length>0&&(qe=Se.at(-1)).kind===c.TokenKind.Literal&&qe.oper.kind===m.OperKind.String){var _r=Se.pop(),xr=(0,c.leftSQuoteToken)(_r.start),Or=(0,c.identToken)(_r.start+1,_r.chars.slice(1,-1)),Rr=(0,c.rightSQuoteToken)(Or.start+Or.chars.length);Se.push(xr,Or,Rr,cr)}else{if(xe(cr)&&gr+1<Ze&&!Ie(fe.at(gr+1))&&Se.length>=2&&Ve(Se.at(-1))&&be(Se.at(-2))){var ir=Se.pop();Se.pop();var $e=(0,c.literalToken)(ir.start-1,'"'+ir.chars+'"',(0,v.stringOper)(ir.chars));Se.push($e);continue}Se.push(cr)}}var qe;return Se.map(function(fr){return fr.chars}).join("")}function K(fe){for(var Se=[],be=0;be<fe.length;be+=1){var xe=fe[be];if(xe.kind!==c.TokenKind.Operator){Se.push(xe);continue}if(xe.value===h.OperatorId.Percent){Se.push(xe);continue}for(var Ie=be+1;Ie<fe.length&&fe[Ie]!==void 0&&(k(fe[Ie])||fe[Ie].kind===c.TokenKind.Operator);)Ie+=1;var Ve=fe[Ie];Ve===void 0||I(Ve)||Ve.kind===c.TokenKind.End||Se.push(xe)}return Se.map(function(Ze){return Ze.chars}).join("")}function W(fe){return fe.map(function(Se){return(be=Se).kind===c.TokenKind.Unexpected&&be.chars.indexOf("	")>-1?" ":Se.chars;var be}).join("")}function z(fe){for(var Se=0,be=da(fe),xe;!(xe=be()).done;){var Ie=xe.value;if(E(Ie))Se+=1;else if(I(Ie)){if(Se===0)return fe.map(function(Rr){return Rr.chars}).join("");Se-=1}}if(Se===0)return fe.map(function(Rr){return Rr.chars}).join("");for(var Ve=Se,Ze=!1,gr=[],cr=da(fe),_r;!(_r=cr()).done;){var xr=_r.value;if(!Ze&&E(xr)&&(Ze=!0),Ze&&Ve>0&&x(xr)){var Or=(0,c.rightParenToken)(xr.start);gr.push(Or),Ve-=1}gr.push(xr)}return gr.map(function(Rr){return Rr.chars}).join("")}function ee(fe,Se){var be=(0,v.stringOper)(Se),xe='"'+Se+'"';return _i(_i({},fe),{oper:be,chars:xe})}function ue(fe){for(var Se=[],be=da(fe),xe;!(xe=be()).done;){var Ie=xe.value;if(Ie.kind===c.TokenKind.Literal&&Ie.oper.kind===m.OperKind.String&&Ie.oper.value.endsWith('"')){var Ve=g(Ie.oper.value,'"');Se.push(ee(Ie,Ve))}else if(Ie.kind===c.TokenKind.Literal&&Ie.oper.kind===m.OperKind.String&&Ie.oper.value.endsWith('")')){var Ze=Ie.chars.slice(1,-4);Se.push(ee(Ie,Ze))}else Se.push(Ie)}return Se}function ce(fe){return fe.kind===c.TokenKind.CellRef&&!function(Se){var be="0".charCodeAt(0),xe="9".charCodeAt(0),Ie=Se.charCodeAt(0);return Ie>=be&&Ie<=xe}(fe.chars)}function he(fe,Se){return!(fe<1)&&ce(Se[fe-1])}function de(fe,Se){var be=Se.length;if(fe>=be-1)return!1;if(ce(Se[fe+1]))return!0;var xe=Se.slice(fe).findIndex(function(Ve){return Ve.chars==="!"});if(xe<0||!Se.slice(fe+1,xe).every(function(Ve){return Ve.kind===c.TokenKind.Ident}))return!1;var Ie=fe+xe+1;return!(Ie>be-1)&&ce(Se[Ie])}function pe(fe){var Se=fe.map(function(Ve,Ze){return Ze}).filter(function(Ve){return fe[Ve].chars===":"});if(Se.length===0)return!0;for(var be=da(Se),xe;!(xe=be()).done;){var Ie=xe.value;if(!he(Ie,fe)||!de(Ie,fe))return!1}return!0}t.fixSemiColon=G,t.closeOffQuotes=L,t.adHocFixQuotesAtCharLevel=D,t.closeOffBracket=J,t.trimTrailingOps=Z,t.trimLeadingOps=ie,t.deleteExtraClosingParens=Q,t.deleteExtraOpeningParens=b,t.refactorLiftParenExpr=P,t.deleteExtraArgs=T,t.adHocLogicalOperatorRepair=O,t.adHocFixSingleDoubleQuotes=M,t.adHocFixBadSepAndApp=function(fe,Se){for(var be=[],xe=0;xe<fe.length;xe+=1){var Ie=be.slice(-1)[0],Ve=fe[xe],Ze=fe[xe+1];if(Ie!==void 0&&Ze!==void 0)if(C(Ie)&&C(Ze)&&B(Ve)&&Se.localeInfo.decimalSeparator==="."&&Ie.chars.indexOf(".")<0){be.pop();var gr=Ie.chars+"."+Ze.chars,cr=_i(_i({},Ie),{chars:gr});be.push(cr),xe+=1}else{if(E(Ve)){var _r=be[be.length-1];if(_r=k(_r)?be[be.length-2]:_r,_r!==void 0&&(C(_r)||y(_r))&&E(Ve)){var xr=(0,c.mulOperatorToken)(Ve.start);be.push(xr),be.push(Ve);continue}}if(F(Ie)&&(F(Ze)||C(Ze)||y(Ze))&&k(Ve)){var Or=(0,c.concatOperatorToken)(Ve.start);be.push(Or)}else if((F(Ie)||C(Ie)||y(Ie))&&F(Ze)&&k(Ve)){var Rr=(0,c.concatOperatorToken)(Ve.start);be.push(Rr)}else if(C(Ie)&&(C(Ze)||y(Ze))&&k(Ve)){var ir=(0,c.mulOperatorToken)(Ve.start);be.push(ir)}else if((C(Ie)||y(Ie))&&C(Ze)&&k(Ve)){var $e=(0,c.mulOperatorToken)(Ve.start);be.push($e)}else be.push(Ve)}else be.push(Ve)}return be.map(function(qe){return qe.chars}).join("")},t.adHocFixTrailingOps=K,t.adHocPreRepair=function(fe){for(var Se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,be=[W,G,ie,Z,J,O,M,L,K],xe=fe,Ie=!1,Ve=0;Ve<Se;){for(var Ze=da(be),gr;!(gr=Ze()).done;){var cr=gr.value,_r=xe.map(function(Or){return Or.chars}).join(""),xr=_r;try{xr=cr(xe)}catch(Or){}xr!=_r&&(xe=(0,p.lexFormula)(xr),Ie=!0)}if(!Ie)break;Ve+=1}return xe.map(function(Or){return Or.chars}).join("")},t.adHocFixParens=function(fe){for(var Se=[Q,b,z],be=[],xe=fe.map(function(cr){return cr.chars}).join(""),Ie=0,Ve=Se;Ie<Ve.length;Ie++){var Ze=Ve[Ie],gr=xe;try{gr=Ze(fe),gr!==xe&&be.push(gr)}catch(cr){}}return be},t.adHocStringLiteralTokenRepair=ue,t.adHocPostRepair=function(fe){for(var Se=[T,P],be=ue(fe).map(function(Ze){return Ze.chars}).join(""),xe=0,Ie=Se;xe<Ie.length;xe++){var Ve=Ie[xe];try{be=Ve(be)}catch(Ze){continue}}return be},t.adHocValidRangeOps=pe;var _e=new Set([f.WorksheetFuncId.SUM,f.WorksheetFuncId.PRODUCT,f.WorksheetFuncId.AVERAGE,f.WorksheetFuncId.COUNTBLANK,f.WorksheetFuncId.MAX,f.WorksheetFuncId.MIN,f.WorksheetFuncId.AND,f.WorksheetFuncId.COUNTA,f.WorksheetFuncId.OR,f.WorksheetFuncId.CONCAT,f.WorksheetFuncId.AVERAGEIF,f.WorksheetFuncId.AVERAGEIFS,f.WorksheetFuncId.COUNT,f.WorksheetFuncId.COUNTIF,f.WorksheetFuncId.COUNTIFS,f.WorksheetFuncId.MEDIAN,f.WorksheetFuncId.SUMSQ,f.WorksheetFuncId.SUMIF,f.WorksheetFuncId.SUMIFS,f.WorksheetFuncId.LARGE,f.WorksheetFuncId.SMALL,f.WorksheetFuncId.RANK,f.WorksheetFuncId.RANK_EQ,f.WorksheetFuncId.RANK_AVG,f.WorksheetFuncId.PERCENTILE,f.WorksheetFuncId.PERCENTILE_INC,f.WorksheetFuncId.PERCENTILE_EXC,f.WorksheetFuncId.QUARTILE,f.WorksheetFuncId.QUARTILE_INC,f.WorksheetFuncId.QUARTILE_EXC,f.WorksheetFuncId.TRIMMEAN,f.WorksheetFuncId.AVERAGEA,f.WorksheetFuncId.MAXA,f.WorksheetFuncId.MINA,f.WorksheetFuncId.MAXIFS,f.WorksheetFuncId.MINIFS,f.WorksheetFuncId.XOR,f.WorksheetFuncId.AGGREGATE,f.WorksheetFuncId.SUBTOTAL,f.WorksheetFuncId.VAR,f.WorksheetFuncId.VAR_S,f.WorksheetFuncId.VARP,f.WorksheetFuncId.VAR_P,f.WorksheetFuncId.STDEV,f.WorksheetFuncId.STDEV_S,f.WorksheetFuncId.STDEVP,f.WorksheetFuncId.STDEV_P,f.WorksheetFuncId.VARA,f.WorksheetFuncId.VARPA,f.WorksheetFuncId.STDEVA,f.WorksheetFuncId.STDEVPA,f.WorksheetFuncId.AVEDEV,f.WorksheetFuncId.DEVSQ,f.WorksheetFuncId.MODE,f.WorksheetFuncId.MODE_SNGL,f.WorksheetFuncId.MODE_MULT,f.WorksheetFuncId.TEXTJOIN]);function Ce(fe){switch(fe.kind){case l.NodeKind.App:{var Se=fe.args;if(fe.head.kind===l.NodeKind.WSF){var be=_e.has(fe.head.id),xe=Se.length;if(be&&xe===1){var Ie=Se[0];if(Ie.kind===l.NodeKind.Literal||Ie.kind===l.NodeKind.CellRef&&Ie.ref.kind===l.CellRefKind.Single)return!0}}return Se.some(Ce)}case l.NodeKind.Paren:return Ce(fe.node);default:return!1}}function Ne(fe){return!Ce(fe)}function Le(fe,Se){var be=new Set([f.WorksheetFuncId.SUMIF,f.WorksheetFuncId.COUNTIF,f.WorksheetFuncId.AVERAGEIF,f.WorksheetFuncId.SUMIFS,f.WorksheetFuncId.MAXIFS,f.WorksheetFuncId.MINIFS,f.WorksheetFuncId.AVERAGEIFS]);switch(fe.kind){case l.NodeKind.App:if(fe.head.kind===l.NodeKind.WSF&&be.has(fe.head.id))for(var xe=da(fe.args),Ie;!(Ie=xe()).done;){var Ve=Ie.value;Ve.kind===l.NodeKind.Literal&&Ve.oper.kind===m.OperKind.String?Se.push(Ve.oper.value):Le(Ve,Se)}else fe.args.map(function(Ze){return Le(Ze,Se)});break;case l.NodeKind.Paren:Le(fe.node,Se)}}function Oe(fe){var Se=[];return Le(fe,Se),Se.every(function(be){return be.indexOf('"')<0&&be.indexOf(")")<0})}function le(fe,Se){switch(fe.kind){case l.NodeKind.App:return fe.head.kind!==l.NodeKind.WSF&&fe.head.kind!==l.NodeKind.Name||Se.push(fe),void fe.args.map(function(be){return le(be,Se)});case l.NodeKind.Paren:return void le(fe.node,Se);case l.NodeKind.Name:return void Se.push(fe);default:return}}function me(fe,Se){var be=[];le(fe,be);for(var xe=0,Ie=be;xe<Ie.length;xe++){var Ve=Ie[xe];if(Ve.kind===l.NodeKind.App&&Ve.head.kind!==l.NodeKind.WSF||Ve.kind===l.NodeKind.Name&&Se.localeInfo.getWorksheetFuncId(Ve.whole)!==void 0)return!1}return!0}function Pe(fe,Se,be){for(var xe=new Set,Ie=da(Se),Ve;!(Ve=Ie()).done;){var Ze=Ve.value;F(Ze)&&xe.add(Ze.chars)}for(var gr=RegExp(/[a-zA-Z][a-zA-Z0-9]*\(/g),cr=da(fe),_r;!(_r=cr()).done;){var xr=_r.value;if(F(xr)&&!xe.has(xr.chars))for(var Or=xr.chars.matchAll(gr),Rr=da(Or),ir;!(ir=Rr()).done;){var $e=ir.value,qe=$e[0],fr=qe.substring(0,qe.length-1);if(be.localeInfo.getWorksheetFuncId(fr)!==void 0)return!1}}return!0}function Re(fe){for(var Se=[],be=da(fe),xe;!(xe=be()).done;){var Ie=xe.value;if(Ie.kind!==c.TokenKind.Spaces)Ie.kind===c.TokenKind.Right&&Ie.value===c.DelimId.Paren&&Se.length>0&&Se.at(-1).kind===c.TokenKind.Spaces&&Se.pop(),Se.push(Ie);else{if(Se.length===0){Se.push(Ie);continue}var Ve=Se.at(-1);if(Ve.kind===c.TokenKind.Left&&Ve.value===c.DelimId.Paren)continue;Se.push(Ie)}}return Se.map(function(Ze){return Ze.chars}).join("")}t.adHocValidAggregation=Ne,t.adHocPostFilter=function(fe,Se,be){for(var xe=[],Ie=new p.ExcelChecker,Ve=(0,p.lexFormula)(Se),Ze=da(fe),gr;!(gr=Ze()).done;){var cr=gr.value,_r=(0,p.lexFormula)(cr),xr=Ie.parse(cr);if((0,s.isSuccess)(xr)){var Or=xr.value.node;pe(_r)&&Ne(Or)&&Oe(Or)&&me(Or,be)&&Pe(_r,Ve,be)&&xe.push(cr)}}return xe},t.cleanSpacesWithinParens=Re,t.adHocPostFormat=function(fe){for(var Se=[],be=da(fe),xe;!(xe=be()).done;){var Ie=xe.value,Ve=Re((0,p.lexFormula)(Ie));Se.push(Ve)}return Se},t.adHocDeduplication=function(fe,Se){for(var be=[],xe=new Set,Ie=da(Se),Ve;!(Ve=Ie()).done;){var Ze=Ve.value,gr=fe.parse(Ze),cr=void 0;(0,s.isSuccess)(gr)&&(cr=fe.printFormula(gr.value)),xe.has(Ze)||cr!==void 0&&xe.has(cr)||(be.push(Ze),xe.add(Ze),xe.add(cr))}return be}},4719:function(u,t,d){"use strict";var s=this&&this.__createBinding||(Object.create?function(l,f,p,m){m===void 0&&(m=p);var v=Object.getOwnPropertyDescriptor(f,p);v&&!("get"in v?!f.__esModule:v.writable||v.configurable)||(v={enumerable:!0,get:function(){return f[p]}}),Object.defineProperty(l,m,v)}:function(l,f,p,m){m===void 0&&(m=p),l[m]=f[p]}),c=this&&this.__exportStar||function(l,f){for(var p in l)p==="default"||Object.prototype.hasOwnProperty.call(f,p)||s(f,l,p)};Object.defineProperty(t,"__esModule",{value:!0}),c(d(7837),t),c(d(4011),t)},7837:function(u,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.levenshteinOverStrings=t.levenshteinOverTokens=t.defaultExcelTokenUpdateCostFn=t.EditOp=t.EDIT_OP_ENUM=t.ExcelChecker=t.getDefaultEnglishConfig=t.rawPrintFormula=t.hackReplaceWSFWithName=t.prettyPrintFormula=t.lexFormula=void 0;var s=d(1866),c=d(1677),l=d(8556),f=d(342),p=d(1583),m=d(4143),v=d(9213),h=d(4333),S=d(446),y=d(931),C=d(9585),E=d(3935),I=d(1109),F=d(9937),w=d(3546);function B(J,$,Z,ie){var X=(0,E.createSimplePrintGlobals)(J),Q=(0,F.lexicalSourceCell)(Z),b=(0,E.printLocalsGrid)(Q,Q.range,J),R=(0,I.createPrinter)(X),P=$;return ie&&(P=_i(_i({},$),{spans:{}})),R.printFormula(b,P)}function k(J,$,Z){return B(J,$,Z,!0)}function x(J){switch(J.kind){case w.NodeKind.App:{var $=J.head;J.head.kind===w.NodeKind.WSF&&($=(0,w.nameNode)((0,w.identNamePart)(J.head.whole)));var Z=J.args.map(function(Q){return x(Q)}),ie=_i(_i({},J),{head:$});return _i(_i({},ie),{args:Z})}case w.NodeKind.Paren:var X=x(J.node);return _i(_i({},J),{node:X});default:return J}}function G(J,$,Z){return B(J,_i(_i({},$),{node:x($.node)}),Z,!1)}function H(){return(0,l.calcConfig)((0,l.getEnglishLocaleInfo)())}function L(J,$,Z){return Array(J).fill([]).map(function(){return Array($).fill(Z)})}var D;t.lexFormula=function(J){var $=(0,l.getEnglishLocaleInfo)(),Z=S.xlMathpack,ie=h.RefStyle.A1,X=(0,C.createSingleRange)(3,2);return(0,y.tokenizeFormula)($,Z,ie,X.range,J,0,{})},t.prettyPrintFormula=k,t.hackReplaceWSFWithName=x,t.rawPrintFormula=G,t.getDefaultEnglishConfig=H,t.ExcelChecker=function(){function J($){Yg(this,J),$===void 0&&($=H());var Z=(0,s.createParseGlobals)($),ie=(0,v.createAnalyzeGlobals)($);this.config=$,this.parser=(0,c.createParser)(Z),this.analyzer=(0,m.createAnalyzer)(ie)}return Jg(J,[{key:"getDefaultActiveCell",value:function(){var Z=(0,f.documentLoc)(void 0,"Book1"),ie=(0,f.sheetIndex)(Z,-1);return(0,f.sheetGridCell)(ie,(0,f.gridCell)(0,0))}},{key:"printFormula",value:function(Z,ie){ie===void 0&&(ie=this.getDefaultActiveCell());var X=k(this.config,Z,ie);return(0,p.isSuccess)(X)?X.value:void 0}},{key:"printRawFormula",value:function(Z,ie){ie===void 0&&(ie=this.getDefaultActiveCell());var X=G(this.config,Z,ie);return(0,p.isSuccess)(X)?X.value:void 0}},{key:"parse",value:function(Z,ie){ie===void 0&&(ie=this.getDefaultActiveCell());var X=ie.range;return this.parser.parseFormula((0,s.parseLocals)(f.LexicalKind.Cell,X),Z)}},{key:"validate",value:function(Z,ie){ie===void 0&&(ie=this.getDefaultActiveCell());var X=this.parse(Z,ie);if(!(0,p.isSuccess)(X))return!1;var Q=this.analyzer.checkFormula((0,v.analyzeLocalsGrid)(f.LexicalKind.Cell,(0,f.sheetGridCell)(ie.sheet,ie.range)),X.value);return!!(0,p.isSuccess)(Q)&&Q.value.isWellFormed}}]),J}(),function(J){J[J.EQUAL=0]="EQUAL",J[J.INSERT=1]="INSERT",J[J.DELETE=2]="DELETE",J[J.REPLACE=3]="REPLACE"}(D=t.EDIT_OP_ENUM||(t.EDIT_OP_ENUM={}));var U=Jg(function J($,Z,ie){Yg(this,J),this.op=$,this.from_elem=Z,this.to_elem=ie});function V(J,$,Z){var ie,X,Q=J<=$?[J,D.DELETE]:[$,D.INSERT],b=Mr(Q,2),R=b[0],P=b[1];return ie=Z<=R?[Z,D.REPLACE]:[R,P],X=Mr(ie,2),R=X[0],P=X[1],[R,P]}function ne(J,$,Z,ie,X){Z=Z||function(le){return 1},ie=ie||function(le){return 1},X=X||function(le,me){return le!=me?1:0};var Q=J.length,b=$.length,R=L(Q+1,b+1,0),P=L(Q+1,b+1,null);J.forEach(function(le,me){R[me+1][0]=me+1}),$.forEach(function(le,me){R[0][me+1]=me+1});for(var A=da(J.entries()),T;!(T=A()).done;){var g=T.value,O=Mr(g,2),M=O[0],K=O[1];M+=1;for(var W=da($.entries()),z;!(z=W()).done;){var ee=z.value,ue=Mr(ee,2),ce=ue[0],he=ue[1];{ce+=1;var de=X(K,he),pe=V(R[M-1][ce]+ie(K),R[M][ce-1]+Z(he),R[M-1][ce-1]+de),_e=Mr(pe,2),Ce=_e[0],Ne=_e[1];R[M][ce]=Ce,Ne=Ne==D.REPLACE&&de==0?D.EQUAL:Ne,P[M][ce]=Ne}}}var Le=R[Q][b],Oe=function(le,me,Pe){for(var Re=[],fe=le.length,Se=me.length,be=null;fe>0&&Se>0;){var xe=Pe[fe][Se];switch(xe){case D.EQUAL:case D.REPLACE:be=[le[fe-1],me[Se-1]],fe-=1,Se-=1;break;case D.INSERT:be=[null,me[Se-1]],Se-=1;break;case D.DELETE:be=[le[fe-1],null],fe-=1;break;default:throw Error("Encountered invalid EDIT_OP value")}Re.push(new U(xe,be[0],be[1]))}for(;Se>0&&fe==0;)Re.push(new U(D.INSERT,null,me[Se-1])),Se-=1;for(;fe>0&&Se==0;)Re.push(new U(D.DELETE,le[fe-1],null)),fe-=1;return Re.reverse(),Re}(J,$,P);return[Le,Oe]}t.EditOp=U,t.defaultExcelTokenUpdateCostFn=function(J,$){return J.chars!=$.chars?1:0},t.levenshteinOverTokens=ne,t.levenshteinOverStrings=function(J,$){return ne(Array.from(J),Array.from($))}},655:function(u,t,d){"use strict";d.r(t),d.d(t,{__assign:function(){return l},__asyncDelegator:function(){return G},__asyncGenerator:function(){return x},__asyncValues:function(){return H},__await:function(){return k},__awaiter:function(){return h},__classPrivateFieldGet:function(){return ne},__classPrivateFieldIn:function(){return $},__classPrivateFieldSet:function(){return J},__createBinding:function(){return y},__decorate:function(){return p},__exportStar:function(){return C},__extends:function(){return c},__generator:function(){return S},__importDefault:function(){return V},__importStar:function(){return U},__makeTemplateObject:function(){return L},__metadata:function(){return v},__param:function(){return m},__read:function(){return I},__rest:function(){return f},__spread:function(){return F},__spreadArray:function(){return B},__spreadArrays:function(){return w},__values:function(){return E}});var s=function(ie,X){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Q,b){Q.__proto__=b}||function(Q,b){for(var R in b)Object.prototype.hasOwnProperty.call(b,R)&&(Q[R]=b[R])},s(ie,X)};function c(Z,ie){if(typeof ie!="function"&&ie!==null)throw new TypeError("Class extends value "+String(ie)+" is not a constructor or null");function X(){this.constructor=Z}s(Z,ie),Z.prototype=ie===null?Object.create(ie):(X.prototype=ie.prototype,new X)}var l=function(){return l=Object.assign||function(ie){for(var X,Q=1,b=arguments.length;Q<b;Q++)for(var R in X=arguments[Q])Object.prototype.hasOwnProperty.call(X,R)&&(ie[R]=X[R]);return ie},l.apply(this,arguments)};function f(Z,ie){var X={};for(var Q in Z)Object.prototype.hasOwnProperty.call(Z,Q)&&ie.indexOf(Q)<0&&(X[Q]=Z[Q]);if(Z!=null&&typeof Object.getOwnPropertySymbols=="function"){var b=0;for(Q=Object.getOwnPropertySymbols(Z);b<Q.length;b++)ie.indexOf(Q[b])<0&&Object.prototype.propertyIsEnumerable.call(Z,Q[b])&&(X[Q[b]]=Z[Q[b]])}return X}function p(Z,ie,X,Q){var b,R=arguments.length,P=R<3?ie:Q===null?Q=Object.getOwnPropertyDescriptor(ie,X):Q;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")P=Reflect.decorate(Z,ie,X,Q);else for(var A=Z.length-1;A>=0;A--)(b=Z[A])&&(P=(R<3?b(P):R>3?b(ie,X,P):b(ie,X))||P);return R>3&&P&&Object.defineProperty(ie,X,P),P}function m(Z,ie){return function(X,Q){ie(X,Q,Z)}}function v(Z,ie){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(Z,ie)}function h(Z,ie,X,Q){return new(X||(X=Promise))(function(b,R){function P(g){try{T(Q.next(g))}catch(O){R(O)}}function A(g){try{T(Q.throw(g))}catch(O){R(O)}}function T(g){var O;g.done?b(g.value):(O=g.value,O instanceof X?O:new X(function(M){M(O)})).then(P,A)}T((Q=Q.apply(Z,ie||[])).next())})}function S(Z,ie){var X,Q,b,R,P={label:0,sent:function(){if(1&b[0])throw b[1];return b[1]},trys:[],ops:[]};return R={next:A(0),throw:A(1),return:A(2)},typeof Symbol=="function"&&(R[Symbol.iterator]=function(){return this}),R;function A(T){return function(g){return function(O){if(X)throw new TypeError("Generator is already executing.");for(;P;)try{if(X=1,Q&&(b=2&O[0]?Q.return:O[0]?Q.throw||((b=Q.return)&&b.call(Q),0):Q.next)&&!(b=b.call(Q,O[1])).done)return b;switch(Q=0,b&&(O=[2&O[0],b.value]),O[0]){case 0:case 1:b=O;break;case 4:return P.label++,{value:O[1],done:!1};case 5:P.label++,Q=O[1],O=[0];continue;case 7:O=P.ops.pop(),P.trys.pop();continue;default:if(!((b=(b=P.trys).length>0&&b[b.length-1])||O[0]!==6&&O[0]!==2)){P=0;continue}if(O[0]===3&&(!b||O[1]>b[0]&&O[1]<b[3])){P.label=O[1];break}if(O[0]===6&&P.label<b[1]){P.label=b[1],b=O;break}if(b&&P.label<b[2]){P.label=b[2],P.ops.push(O);break}b[2]&&P.ops.pop(),P.trys.pop();continue}O=ie.call(Z,P)}catch(M){O=[6,M],Q=0}finally{X=b=0}if(5&O[0])throw O[1];return{value:O[0]?O[1]:void 0,done:!0}}([T,g])}}}var y=Object.create?function(Z,ie,X,Q){Q===void 0&&(Q=X);var b=Object.getOwnPropertyDescriptor(ie,X);b&&!("get"in b?!ie.__esModule:b.writable||b.configurable)||(b={enumerable:!0,get:function(){return ie[X]}}),Object.defineProperty(Z,Q,b)}:function(Z,ie,X,Q){Q===void 0&&(Q=X),Z[Q]=ie[X]};function C(Z,ie){for(var X in Z)X==="default"||Object.prototype.hasOwnProperty.call(ie,X)||y(ie,Z,X)}function E(Z){var ie=typeof Symbol=="function"&&Symbol.iterator,X=ie&&Z[ie],Q=0;if(X)return X.call(Z);if(Z&&typeof Z.length=="number")return{next:function(){return Z&&Q>=Z.length&&(Z=void 0),{value:Z&&Z[Q++],done:!Z}}};throw new TypeError(ie?"Object is not iterable.":"Symbol.iterator is not defined.")}function I(Z,ie){var X=typeof Symbol=="function"&&Z[Symbol.iterator];if(!X)return Z;var Q,b,R=X.call(Z),P=[];try{for(;(ie===void 0||ie-- >0)&&!(Q=R.next()).done;)P.push(Q.value)}catch(A){b={error:A}}finally{try{Q&&!Q.done&&(X=R.return)&&X.call(R)}finally{if(b)throw b.error}}return P}function F(){for(var Z=[],ie=0;ie<arguments.length;ie++)Z=Z.concat(I(arguments[ie]));return Z}function w(){for(var Z=0,ie=0,X=arguments.length;ie<X;ie++)Z+=arguments[ie].length;var Q=Array(Z),b=0;for(ie=0;ie<X;ie++)for(var R=arguments[ie],P=0,A=R.length;P<A;P++,b++)Q[b]=R[P];return Q}function B(Z,ie,X){if(X||arguments.length===2)for(var Q,b=0,R=ie.length;b<R;b++)!Q&&b in ie||(Q||(Q=Array.prototype.slice.call(ie,0,b)),Q[b]=ie[b]);return Z.concat(Q||Array.prototype.slice.call(ie))}function k(Z){return this instanceof k?(this.v=Z,this):new k(Z)}function x(Z,ie,X){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Q,b=X.apply(Z,ie||[]),R=[];return Q={},P("next"),P("throw"),P("return"),Q[Symbol.asyncIterator]=function(){return this},Q;function P(M){b[M]&&(Q[M]=function(K){return new Promise(function(W,z){R.push([M,K,W,z])>1||A(M,K)})})}function A(M,K){try{(W=b[M](K)).value instanceof k?Promise.resolve(W.value.v).then(T,g):O(R[0][2],W)}catch(z){O(R[0][3],z)}var W}function T(M){A("next",M)}function g(M){A("throw",M)}function O(M,K){M(K),R.shift(),R.length&&A(R[0][0],R[0][1])}}function G(Z){var ie,X;return ie={},Q("next"),Q("throw",function(b){throw b}),Q("return"),ie[Symbol.iterator]=function(){return this},ie;function Q(b,R){ie[b]=Z[b]?function(P){return(X=!X)?{value:k(Z[b](P)),done:b==="return"}:R?R(P):P}:R}}function H(Z){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var ie,X=Z[Symbol.asyncIterator];return X?X.call(Z):(Z=E(Z),ie={},Q("next"),Q("throw"),Q("return"),ie[Symbol.asyncIterator]=function(){return this},ie);function Q(b){ie[b]=Z[b]&&function(R){return new Promise(function(P,A){(function(T,g,O,M){Promise.resolve(M).then(function(K){T({value:K,done:O})},g)})(P,A,(R=Z[b](R)).done,R.value)})}}}function L(Z,ie){return Object.defineProperty?Object.defineProperty(Z,"raw",{value:ie}):Z.raw=ie,Z}var D=Object.create?function(Z,ie){Object.defineProperty(Z,"default",{enumerable:!0,value:ie})}:function(Z,ie){Z.default=ie};function U(Z){if(Z&&Z.__esModule)return Z;var ie={};if(Z!=null)for(var X in Z)X!=="default"&&Object.prototype.hasOwnProperty.call(Z,X)&&y(ie,Z,X);return D(ie,Z),ie}function V(Z){return Z&&Z.__esModule?Z:{default:Z}}function ne(Z,ie,X,Q){if(X==="a"&&!Q)throw new TypeError("Private accessor was defined without a getter");if(typeof ie=="function"?Z!==ie||!Q:!ie.has(Z))throw new TypeError("Cannot read private member from an object whose class did not declare it");return X==="m"?Q:X==="a"?Q.call(Z):Q?Q.value:ie.get(Z)}function J(Z,ie,X,Q,b){if(Q==="m")throw new TypeError("Private method is not writable");if(Q==="a"&&!b)throw new TypeError("Private accessor was defined without a setter");if(typeof ie=="function"?Z!==ie||!b:!ie.has(Z))throw new TypeError("Cannot write private member to an object whose class did not declare it");return Q==="a"?b.call(Z,X):b?b.value=X:ie.set(Z,X),X}function $(Z,ie){if(ie===null||typeof ie!="object"&&typeof ie!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof Z=="function"?ie===Z:Z.has(ie)}}},r={};function n(o){var u=r[o];if(u!==void 0)return u.exports;var t=r[o]={exports:{}};return e[o].call(t.exports,t,t.exports,n),t.exports}n.d=function(o,u){for(var t in u)n.o(u,t)&&!n.o(o,t)&&Object.defineProperty(o,t,{enumerable:!0,get:u[t]})},n.o=function(o,u){return Object.prototype.hasOwnProperty.call(o,u)},n.r=function(o){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})};var a=n(4719);Rxe.excelHelper=a})()});var Uue=Y(ha=>{_();var que=An();Object.defineProperty(ha,"__esModule",{value:!0});ha.ProseExcelRepairEngine=ha.EditOp=ha.EDIT_OP_ENUM=void 0;Object.defineProperty(ha,"RepairOptions",{enumerable:!0,get:function(){return Ln.RepairOptions}});ha.TOK_KIND_MAPPER=void 0;Object.defineProperty(ha,"T_Add",{enumerable:!0,get:function(){return Ln.T_Add}});Object.defineProperty(ha,"T_Bang",{enumerable:!0,get:function(){return Ln.T_Bang}});Object.defineProperty(ha,"T_BooleanLiteral",{enumerable:!0,get:function(){return Ln.T_BooleanLiteral}});Object.defineProperty(ha,"T_BraceClose",{enumerable:!0,get:function(){return Ln.T_BraceClose}});Object.defineProperty(ha,"T_BraceOpen",{enumerable:!0,get:function(){return Ln.T_BraceOpen}});Object.defineProperty(ha,"T_BracketClose",{enumerable:!0,get:function(){return Ln.T_BracketClose}});Object.defineProperty(ha,"T_BracketOpen",{enumerable:!0,get:function(){return Ln.T_BracketOpen}});Object.defineProperty(ha,"T_CellRef",{enumerable:!0,get:function(){return Ln.T_CellRef}});Object.defineProperty(ha,"T_Comma",{enumerable:!0,get:function(){return Ln.T_Comma}});Object.defineProperty(ha,"T_Concat",{enumerable:!0,get:function(){return Ln.T_Concat}});Object.defineProperty(ha,"T_Div",{enumerable:!0,get:function(){return Ln.T_Div}});Object.defineProperty(ha,"T_Dot",{enumerable:!0,get:function(){return Ln.T_Dot}});Object.defineProperty(ha,"T_EOF",{enumerable:!0,get:function(){return Ln.T_EOF}});Object.defineProperty(ha,"T_Eq",{enumerable:!0,get:function(){return Ln.T_Eq}});Object.defineProperty(ha,"T_Ge",{enumerable:!0,get:function(){return Ln.T_Ge}});Object.defineProperty(ha,"T_Gt",{enumerable:!0,get:function(){return Ln.T_Gt}});Object.defineProperty(ha,"T_Ident",{enumerable:!0,get:function(){return Ln.T_Ident}});Object.defineProperty(ha,"T_Le",{enumerable:!0,get:function(){return Ln.T_Le}});Object.defineProperty(ha,"T_Lt",{enumerable:!0,get:function(){return Ln.T_Lt}});Object.defineProperty(ha,"T_Mul",{enumerable:!0,get:function(){return Ln.T_Mul}});Object.defineProperty(ha,"T_Ne",{enumerable:!0,get:function(){return Ln.T_Ne}});Object.defineProperty(ha,"T_NumberLiteral",{enumerable:!0,get:function(){return Ln.T_NumberLiteral}});Object.defineProperty(ha,"T_ParenClose",{enumerable:!0,get:function(){return Ln.T_ParenClose}});Object.defineProperty(ha,"T_ParenOpen",{enumerable:!0,get:function(){return Ln.T_ParenOpen}});Object.defineProperty(ha,"T_Percent",{enumerable:!0,get:function(){return Ln.T_Percent}});Object.defineProperty(ha,"T_Pow",{enumerable:!0,get:function(){return Ln.T_Pow}});Object.defineProperty(ha,"T_Quote",{enumerable:!0,get:function(){return Ln.T_Quote}});Object.defineProperty(ha,"T_RangeOp",{enumerable:!0,get:function(){return Ln.T_RangeOp}});Object.defineProperty(ha,"T_Spaces",{enumerable:!0,get:function(){return Ln.T_Spaces}});Object.defineProperty(ha,"T_StringLiteral",{enumerable:!0,get:function(){return Ln.T_StringLiteral}});Object.defineProperty(ha,"T_Sub",{enumerable:!0,get:function(){return Ln.T_Sub}});Object.defineProperty(ha,"T_Unexpected",{enumerable:!0,get:function(){return Ln.T_Unexpected}});ha.excelTokensToFramework=Nxe;ha.lexFormula=void 0;Object.defineProperty(ha,"newToken",{enumerable:!0,get:function(){return Ln.newToken}});Object.defineProperty(ha,"niceStringOfToken",{enumerable:!0,get:function(){return Ln.niceStringOfToken}});ha.refactorLiftParenExpr=void 0;Object.defineProperty(ha,"repair",{enumerable:!0,get:function(){return Ln.repair}});ha.repairExcelFormula=Bue;ha.repairToString=Axe;var ub=que(GS()),Utn=que(at()),Gtn=que(it()),Ln=vxe(),Wf=Txe();function Lue(e,r){var n=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=Ktn(e))||r&&e&&typeof e.length=="number"){n&&(e=n);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ktn(e,r){if(e){if(typeof e=="string")return bxe(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bxe(e,r)}}function bxe(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,a=new Array(r);n<r;n++)a[n]=e[n];return a}var Vtn=Wf.excelHelper.ExcelChecker,Wtn=Wf.excelHelper.refactorLiftParenExpr;ha.refactorLiftParenExpr=Wtn;var jtn=Wf.excelHelper.EDIT_OP_ENUM;ha.EDIT_OP_ENUM=jtn;var Htn=Wf.excelHelper.EditOp;ha.EditOp=Htn;var iI=Wf.excelHelper.lexFormula;ha.lexFormula=iI;var Exe=new Map([[1,"End"],[2,"Left"],[3,"Right"],[4,"Sep"],[5,"Operator"],[6,"Spaces"],[7,"Ident"],[8,"CellRef"],[9,"Literal"],[10,"SpecialRef"],[11,"Unexpected"],[12,"Escape"]]);ha.TOK_KIND_MAPPER=Exe;var Qtn=new Map([[1,"("],[2,"["],[3,"{"],[4,"'"]]),ztn=new Map([[1,")"],[2,"]"],[3,"}"],[4,"'"]]),Ytn=new Map([[1,","],[2,"RowSep"],[3,"ColSep"],[4,"!"],[5,"."]]),Jtn=new Map([[1,"Add"],[2,"Sub"],[3,"Mul"],[4,"Div"],[5,"Pow"],[6,"Percent"],[9,"Concat"],[10,"Eq"],[11,"Ne"],[12,"Lt"],[13,"Le"],[14,"Gt"],[15,"Ge"],[16,"RangeOp"],[18,"UnionOp"],[24,"At"],[25,"Pound"]]),Pxe=new Map([[1,"Number"],[2,"String"],[4,"Boolean"]]),NN=new Map([["Eq",Ln.T_Eq],["Ident",Ln.T_Ident],["(",Ln.T_ParenOpen],[")",Ln.T_ParenClose],["[",Ln.T_BracketOpen],["]",Ln.T_BracketClose],["{",Ln.T_BraceOpen],["}",Ln.T_BraceClose],[",",Ln.T_Comma],['"',Ln.T_Quote],["CellRef",Ln.T_CellRef],["Ident",Ln.T_Ident],["RangeOp",Ln.T_RangeOp],["BooleanLiteral",Ln.T_BooleanLiteral],["StringLiteral",Ln.T_StringLiteral],["NumberLiteral",Ln.T_NumberLiteral],["Ne",Ln.T_Ne],["Le",Ln.T_Le],["Lt",Ln.T_Lt],["Gt",Ln.T_Gt],["Ge",Ln.T_Ge],["Add",Ln.T_Add],["Sub",Ln.T_Sub],["Mul",Ln.T_Mul],["Div",Ln.T_Div],["Pow",Ln.T_Pow],["Concat",Ln.T_Concat],["Spaces",Ln.T_Spaces],["!",Ln.T_Bang],[".",Ln.T_Dot],["Percent",Ln.T_Percent],["EOF",Ln.T_EOF],["Unexpected",Ln.T_Unexpected],["ColSep",Ln.T_Comma]]);function Xtn(e){var r=Exe.get(e.kind),n=void 0,a=void 0;if(r=="End")return[];if(r=="Left")n=Qtn.get(e.value),a=null;else if(r=="Right")n=ztn.get(e.value),a=null;else if(r=="Sep")n=Ytn.get(e.value),a=null;else if(r=="Operator")n=Jtn.get(e.value),a=null;else if(r=="Spaces")n="Spaces",a=e.chars;else if(r=="Ident")n="Ident",a=e.chars;else if(r=="CellRef")n="CellRef",a=e.chars;else if(r=="Literal"){var o=e.oper.kind;if(!Pxe.has(o))throw"Undefined literal kind: "+e;n=Pxe.get(o)+"Literal",a=e.chars}else if(r=="SpecialRef")n="SpecialRef",a=e.chars;else{if(r=="Escape")throw"Escape not yet implemented: "+e;if(r=="Unexpected")e.chars.trim().length==0?(n="Spaces",a=null):(n="Unexpected",a=null);else throw"Unknown token kind: "+e}if(n=="StringLiteral"){var u=[],t='"',d=a;return d.startsWith(t)&&(d=d.substring(1),u.push((0,Ln.newToken)(NN.get(t),null))),d.endsWith(t)?(d=d.substring(0,d.length-1),u.push((0,Ln.newToken)(NN.get("StringLiteral"),d)),u.push((0,Ln.newToken)(NN.get(t),null))):NN.has(d)?u.push((0,Ln.newToken)(NN.get(d),d)):u.push((0,Ln.newToken)(NN.get("StringLiteral"),d)),u}if(n===void 0)return[];var s=[(0,Ln.newToken)(NN.get(n),a)];return s}function Nxe(e){var r=e.flatMap(function(n){return Xtn(n)});return r.push((0,Ln.newToken)(Ln.T_EOF,null)),r}function Axe(e){return e.length>0&&e[e.length-1].symbol==Ln.T_EOF&&e.pop(),e.map(Ln.niceStringOfToken).join("")}function Ztn(e){for(var r=[],n=new Set,a=Lue(e),o;!(o=a()).done;){var u=o.value;n.has(u)||(r.push(u),n.add(u))}return r}var $tn=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0;(0,Utn.default)(this,e),r===void 0&&(r=Wf.excelHelper.getDefaultEnglishConfig()),this.validator=new Vtn(r),this.config=r}return(0,Gtn.default)(e,[{key:"repairExcelFormula",value:function(n){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,t=n.map(function(H){return H.chars}).join(""),d=[],s=[t];if(!u){var c=Bue(n);return c.filter(function(H){return a.validator.validate(H,o)})}function l(H,L,D,U,V){for(var ne=L.slice(),J=[],$=Lue(D),Z;!(Z=$()).done;){var ie=Z.value,X=U(ie);if(X.length==0){J.push(ie);continue}for(var Q=Lue(X),b;!(b=Q()).done;){var R=b.value;H.validate(R,o)&&!V.has(R)?ne.push(R):J.push(R)}}return[ne,J]}var f=new Set;f.add(t);var p=l(this.validator,d,s,function(H){var L=iI(H),D=Wf.excelHelper.adHocPreRepair(L);return[D]},f),m=(0,ub.default)(p,2);d=m[0],s=m[1];var v=l(this.validator,d,s,function(H){var L=Wf.excelHelper.adHocFixQuotesAtCharLevel(H);return[L]},f),h=(0,ub.default)(v,2);d=h[0],s=h[1],s.push(t);var S=l(this.validator,d,s,function(H){var L=iI(H);return Bue(L)},f),y=(0,ub.default)(S,2);d=y[0],s=y[1];var C=l(this.validator,d,s,function(H){var L=iI(H);return Wf.excelHelper.adHocFixParens(L)},f),E=(0,ub.default)(C,2);d=E[0],s=E[1],s.push(t);var I=l(this.validator,d,s,function(H){var L=iI(H),D=Wf.excelHelper.adHocFixBadSepAndApp(L,a.config);return D!==H?[D]:[]},f),F=(0,ub.default)(I,2);d=F[0],s=F[1];var w=l(this.validator,[],d.concat(s),function(H){var L=iI(H),D=Wf.excelHelper.adHocPostRepair(L);return[D]},f),B=(0,ub.default)(w,2);d=B[0],s=B[1];var k=Wf.excelHelper.adHocPostFilter(d,t,this.config),x=[];k.length>0?x=k:d.length>0?x=d:this.validator.validate(t,o)&&Wf.excelHelper.adHocValidRangeOps(n)&&(x=[t]),x=Wf.excelHelper.adHocPostFormat(x);var G=Wf.excelHelper.adHocDeduplication(this.validator,x);return G}},{key:"validate",value:function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;return this.validator.validate(n,a)}},{key:"getDiff",value:function(n,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return o?this.getDiffOverTokens(n,a):this.getDiffOverStrings(n,a)}},{key:"getDiffOverTokens",value:function(n,a){var o=Wf.excelHelper.levenshteinOverTokens(n,a,void 0,void 0,Wf.excelHelper.defaultExcelTokenUpdateCostFn),u=(0,ub.default)(o,2),t=u[0],d=u[1];return d}},{key:"getDiffOverStrings",value:function(n,a){var o=Wf.excelHelper.levenshteinOverStrings(n,a),u=(0,ub.default)(o,2),t=u[0],d=u[1];return d}}]),e}();ha.ProseExcelRepairEngine=$tn;function Bue(e){var r=Nxe(e),n={Timeout:1e3,MaxBacktrack:1,MaxGlobalEditDistance:5,MaxLocalEditDistance:5,ValidateCandidateRepairs:!0};try{var a=(0,Ln.repair)(r,n),o=a.map(Axe);return Ztn(o)}catch(u){return[]}}});var Kue=Y(Gue=>{_();Object.defineProperty(Gue,"__esModule",{value:!0});Gue.lexFormula=ran;var ean=B7();function ran(e,r,n){var a,o,u,t,d=(o=(a=r.config)===null||a===void 0?void 0:a.localeInfo)!==null&&o!==void 0?o:e.config.localeInfo,s=(t=(u=r.config)===null||u===void 0?void 0:u.refStyle)!==null&&t!==void 0?t:e.config.refStyle,c=e.config.mathpack,l=r.originGridCell.value;return(0,ean.tokenizeFormula)(d,c,s,l,n,0,{})}});var Lxe=Y(z0=>{_();Object.defineProperty(z0,"__esModule",{value:!0});z0.formulaRepairShadowEvalPluginDependenciesResolved=z0.REPAIR_SHADOW_EVALUATION_LOG_BUGGY=z0.FormulaRepairShadowEvalPluginFactory=z0.FormulaRepairShadowEvalPlugin=z0.FormulaRepairShadowEvalLogKind=void 0;z0.getRepairMatchVector=xxe;z0.prettyPrintFormula=Hue;var C4=br(),AN=ds(),nan=Cd(),Vue=tu(),tan=r3(),Oxe=n3(),aan=gs(),Que=Di(),ian=ft(),oan=Jc(),uan=Ll(),san=U2(),Wue=OP(),lan=cu(),kxe=Jd(),can=B7(),dan=AP(),jue=Uae(),fan=gT(),pan=Ol(),man=G7(),gan=Uue(),zue=Fu(),van=Kue(),Mxe="Microsoft.Office.Excel.ProseFormulaRepairExperimentLogBuggyIsEnabled";z0.REPAIR_SHADOW_EVALUATION_LOG_BUGGY=Mxe;var wxe=function(){function e(){this.factoryName=zue.PluginFactoryName.FormulaRepairShadowEvalPlugin}return e.prototype.create=function(){return new Dxe},e}();z0.FormulaRepairShadowEvalPluginFactory=wxe;var Dxe=function(){function e(){this.canLogBuggyFormula=(0,oan.getTypedFeatureGate)(Mxe),this.churnInfoManager=new yan,this.consistentAnonymizer=new man.ConsistentAnonymizer}return e.prototype.run=function(r){var n,a,o,u,t,d,s,c,l,f,p,m,v,h,S,y,C,E,I,F,w,B,k,x,G,H,L,D,U,V,ne,J,$,Z,ie,X,Q,b,R,P,A,T=this,g;return(0,C4.__generator)(this,function(O){switch(O.label){case 0:return r.content===null||r.content===void 0?[2,null]:[4,{kind:AN.ComputationRequestKind.GetActiveCell}];case 1:return n=O.sent(),n.kind!==AN.ComputationRequestKind.GetActiveCell?[2,null]:(a=n.activeCell,[4,{kind:AN.ComputationRequestKind.ParseActiveCell,formulaText:r.content}]);case 2:return o=O.sent(),u=(R=Fxe(o),R[0]),t=R[1],u===FS.FAILED_REQUEST?[2,null]:(d=this.churnInfoManager.getChurnInfo(a),u===FS.OK&&d===void 0?[2,null]:[4,{kind:AN.ComputationRequestKind.GetConfig}]);case 3:if(s=O.sent(),s.kind!==AN.ComputationRequestKind.GetConfig)return[2,null];if(c=s.config,l=(0,Wue.createAnalyzeGlobals)(c),f=(0,aan.lexicalSourceCell)(a),p=(0,Wue.analyzeLocalsGrid)(f.kind,f.range),m=(0,Oxe.createSimplePrintGlobals)(c),v=(0,Oxe.printLocalsGrid)(f,f.range,c),h=(0,tan.createPrinter)(m),S=(0,pan.getNewGuid)()[0],u===FS.OK)return y=void 0,this.canLogBuggyFormula&&(y=this.consistentAnonymizer.anonymize(r.content,c,a.range)),C=Hue(h,v,t),E=xxe(d.normalizedRepairCandidateLists,C),I={logKind:_4.CORRECT_LOG,id:S,version:e.formulaRepairVersion,rootId:d.rootId,priorId:d.priorId,repairMatchVector:E,formula:y},Ixe(I),this.churnInfoManager.clearChurnInfo(a),[2,null];F=(0,ian.isNone)(t)?void 0:_an(l,p,t),w=new gan.ProseExcelRepairEngine(c),B=(P=Can(w,l,(0,dan.parseLocals)(f.kind,f.range.range),f.range,r.content),P[0]),k=P[1],x=P[2],G=[],H=[],L=[],D=0,O.label=4;case 4:return D<B.length?(U=B[D],[4,{kind:AN.ComputationRequestKind.ParseActiveCell,formulaText:U}]):[3,7];case 5:V=O.sent(),ne=(A=Fxe(V),A[0]),J=A[1],G.push(ne===FS.OK),H.push(U.length),$=ne===FS.OK?Hue(h,v,J):void 0,L.push($),O.label=6;case 6:return D+=1,[3,4];case 7:return Z=Tan(r.content,c,a.range),ie=void 0,X=void 0,this.canLogBuggyFormula&&(ie=this.consistentAnonymizer.anonymize(r.content,c,a.range),X=B.map(function(M){return T.consistentAnonymizer.anonymize(M,c,a.range)})),Q={logKind:_4.BUGGY_LOG,version:e.formulaRepairVersion,origLength:r.content.length,origNumCalls:Z,diagnostics:F,wellFormed:G,repairLengths:H,repairTime:k,exceptionRaised:x,formula:ie,repairs:X,id:S,rootId:(g=d==null?void 0:d.rootId)!==null&&g!==void 0?g:S,priorId:d==null?void 0:d.priorId},Ixe(Q),d===void 0?(b=new San(S),b.priorId=S,b.normalizedRepairCandidateLists.push(L),this.churnInfoManager.setChurnInfo(a,b)):(d.priorId=S,d.normalizedRepairCandidateLists.push(L)),[2,null]}})},e.factoryName=zue.PluginFactoryName.FormulaRepairShadowEvalPlugin,e.formulaRepairVersion=2,e}();z0.FormulaRepairShadowEvalPlugin=Dxe;(0,nan.registerPluginFactory)(new wxe);var han=(0,lan.asyncLazy)(function(){return(0,C4.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,C4.__generator)(this,function(r){switch(r.label){case 0:return[4,kxe.workerThreadSpread.getValue()];case 1:return e=r.sent(),[4,e.createAndAttachPlugin(zue.PluginFactoryName.FormulaRepairShadowEvalPlugin)];case 2:return r.sent(),[4,kxe.schedulerWithRecalcServiceAttached.getValue()];case 3:return r.sent(),[2]}})})});z0.formulaRepairShadowEvalPluginDependenciesResolved=han;var _4;z0.FormulaRepairShadowEvalLogKind=_4;(function(e){e.BUGGY_LOG="buggy",e.CORRECT_LOG="correct"})(_4||(z0.FormulaRepairShadowEvalLogKind=_4={}));var San=function(){function e(r){this.rootId=r,this.normalizedRepairCandidateLists=[]}return e}(),yan=function(){function e(){this.churnInfoByLocation=new Map}return e.prototype.getChurnInfo=function(r){var n,a=r.sheet.index,o=(n=this.churnInfoByLocation.get(a))===null||n===void 0?void 0:n.getValue(r.range);return o},e.prototype.setChurnInfo=function(r,n){var a=r.sheet.index;if(!this.churnInfoByLocation.has(a)){var o=(0,fan.makeGridRangeTable)();this.churnInfoByLocation.set(a,o)}var u=this.churnInfoByLocation.get(a).setValue(r.range,n);this.churnInfoByLocation.set(a,u)},e.prototype.clearChurnInfo=function(r){var n=r.sheet.index,a=this.churnInfoByLocation.get(n);if(a!==void 0){var o=a.remove(r.range);this.churnInfoByLocation.set(n,o)}},e}();function Hue(e,r,n){var a=(0,C4.__assign)((0,C4.__assign)({},n),{spans:{}}),o=e.printFormula(r,a);return(0,Que.isSuccess)(o)?o.value:void 0}function xxe(e,r){return e.map(function(n){return r===void 0?-2:n.findIndex(function(a){return a===r})})}function Can(e,r,n,a,o){var u=(0,van.lexFormula)(r,n,o),t=window.performance.now(),d=[],s=!1;try{d=e.repairExcelFormula(u,a)}catch(f){s=!0}finally{var c=window.performance.now(),l=c-t;return[d,l,s]}}var FS;(function(e){e[e.FAILED_REQUEST=0]="FAILED_REQUEST",e[e.OK=1]="OK",e[e.BUGGY=2]="BUGGY"})(FS||(FS={}));function Fxe(e){if(e.kind!==AN.ComputationRequestKind.ParseActiveCell||!(0,Que.isSuccess)(e.result))return[FS.FAILED_REQUEST,null];if(e.result.value.kind!==uan.EditKind.Formula)return[FS.FAILED_REQUEST,null];var r=e.result.value.formula,n=r.isWellFormed;return[n?FS.OK:FS.BUGGY,r]}function _an(e,r,n){var a=(0,san.createAnalyzer)(e),o=a.checkFormulaWithDiagnostics(r,n);if((0,Que.isSuccess)(o))return(0,Wue.summarizeFormulaDiagnostics)(o==null?void 0:o.value[1])}function Ran(e){return e===void 0?!1:e.kind===jue.TokenKind.Left&&e.value===jue.DelimId.Paren}function Tan(e,r,n){for(var a=(0,can.tokenizeFormula)(r.localeInfo,r.mathpack,r.refStyle,n,e,0,{}),o=a.length,u=0,t=0;t<a.length;t++){var d=a[t];if(d.kind===jue.TokenKind.Ident&&t<o-1){var s=a[t+1];u+=Ran(s)?1:0}}return u}function Ixe(e){var r=JSON.stringify(e);Vue.ulsLogger.ULS.dnmTraceTag(537962258,Vue.LogCategory.msoulscat_ES_EWAJS,Vue.TraceLevel.Info,r)}});var qxe=Y(vW=>{_();Object.defineProperty(vW,"__esModule",{value:!0});vW.pythonAutocompletePluginAttach=void 0;var gW=br(),Bxe=cu(),ban=Fu(),Pan=Jd(),Ean=(0,Bxe.asyncLazy)(function(){return(0,gW.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,gW.__generator)(this,function(r){switch(r.label){case 0:return[4,Pan.workerThreadSpread.getValue()];case 1:return e=r.sent(),[4,e.loadPluginScript("pythonIntelliSense",!1)];case 2:return r.sent(),[2,e]}})})}),Nan=(0,Bxe.asyncLazy)(function(){return(0,gW.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,gW.__generator)(this,function(r){switch(r.label){case 0:return[4,Ean.getValue()];case 1:return e=r.sent(),[4,e.createAndAttachPlugin(ban.PluginFactoryName.PythonAutocompletePlugin)];case 2:return r.sent(),[2]}})})});vW.pythonAutocompletePluginAttach=Nan});var zxe=Y(sb=>{_();Object.defineProperty(sb,"__esModule",{value:!0});sb.syntaxErrorsPluginDependenciesResolved=sb.SyntaxErrorsPluginFactory=sb.SyntaxErrorsPlugin=void 0;var Jue=br(),Aan=cu(),Uxe=ft(),Wxe=Fu(),Oan=Cd(),Gxe=Jd(),oI=ds(),jxe=Ai(),hW=Ol(),kan=Di(),Fan=Ll(),Ian=Uue(),Man=Kue(),wan=OP(),Dan=gs(),xan=AP(),Kxe=eh(),Lan=Jc(),Hxe=function(){function e(){this.factoryName=Wxe.PluginFactoryName.SyntaxErrorsPlugin}return e.prototype.create=function(){return new Qxe},e}();sb.SyntaxErrorsPluginFactory=Hxe;var Qxe=function(){function e(){this.suggestionsLimit=(0,Lan.getTypedFeatureGate)("Microsoft.Office.Excel.FormulaRepairSuggestionsLimit")}return e.prototype.run=function(r){var n,a,o,u,t,d,s,c,l,f,p,m,v,h=r.formula;return(0,Jue.__generator)(this,function(S){switch(S.label){case 0:return(0,Uxe.isNone)(h)?(ON("Missing request arguments"),[2,null]):[4,{kind:oI.ComputationRequestKind.ParseActiveCell,formulaText:h}];case 1:return n=S.sent(),n.kind!==oI.ComputationRequestKind.ParseActiveCell||!(0,kan.isSuccess)(n.result)?(ON("ParseActiveCell"),[2,null]):(a=n.result.value,a.kind!==Fan.EditKind.Formula?(Yue("Parsed result isn't formula"),[2,null]):a.formula.isWellFormed?(Yue("Formula is already well formed"),[2,null]):[4,{kind:oI.ComputationRequestKind.GetActiveCell}]);case 2:return o=S.sent(),o.kind!==oI.ComputationRequestKind.GetActiveCell?(ON("GetActiveCell"),[2,null]):(u=o.activeCell,[4,{kind:oI.ComputationRequestKind.GetConfig}]);case 3:if(t=S.sent(),t.kind!==oI.ComputationRequestKind.GetConfig)return ON("GetConfig"),[2,null];d=t.config;try{s=new Ian.ProseExcelRepairEngine(d)}catch(y){return ON("failed to create prose engine: ".concat(y)),[2,null]}c=(0,wan.createAnalyzeGlobals)(d),l=(0,Dan.lexicalSourceCell)(u),f=(0,xan.parseLocals)(l.kind,l.range.range),p=(0,Man.lexFormula)(c,f,h);try{m=s.repairExcelFormula(p)}catch(y){return ON("Repair failed: ".concat(y)),[2,null]}return(0,Uxe.isNone)(m)?(ON("Repair result in none"),[2,null]):m.length===0?(Yue("No repairs found"),[2,null]):(v=Ban(s,m,h,this.suggestionsLimit),[2,{formula:h,repairs:v}])}})},e}();sb.SyntaxErrorsPlugin=Qxe;function Ban(e,r,n,a){var o=[];return r.slice(0,a).forEach(function(u){var t=e.getDiff(n,u,!1),d=Vxe(t,Kxe.RepairItemPartType.Removed),s=Vxe(t,Kxe.RepairItemPartType.Added);o.push({text:u,repairedFormulaParts:d,originalFormulaParts:s})}),o}function Vxe(e,r){return e.filter(function(n){return n.op!==r}).reduce(function(n,a){return n.length===0?n.push({type:a.op,location:{start:0,end:1}}):n[n.length-1].type!==a.op?n.push({type:a.op,location:{start:n[n.length-1].location.end,end:n[n.length-1].location.end+1}}):n[n.length-1].location.end+=1,n},[])}function ON(e){jxe.ulsLogger.ULS.traceTag(509441991,hW.LogCategory.msoulscat_ES_EWAJS,hW.TraceLevel.Warning,"SyntaxErrorsPlugin encountered a failure with msg ".concat(e))}function Yue(e){jxe.ulsLogger.ULS.traceTag(509441990,hW.LogCategory.msoulscat_ES_EWAJS,hW.TraceLevel.Info,"SyntaxErrorsPlugin: ".concat(e))}(0,Oan.registerPluginFactory)(new Hxe);var qan=(0,Aan.asyncLazy)(function(){return(0,Jue.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,Jue.__generator)(this,function(r){switch(r.label){case 0:return[4,Gxe.workerThreadSpread.getValue()];case 1:return e=r.sent(),[4,e.createAndAttachPlugin(Wxe.PluginFactoryName.SyntaxErrorsPlugin)];case 2:return r.sent(),[4,Gxe.schedulerWithRecalcServiceAttached.getValue()];case 3:return r.sent(),[2]}})})});sb.syntaxErrorsPluginDependenciesResolved=qan});var Xxe=Y(yW=>{_();Object.defineProperty(yW,"__esModule",{value:!0});yW.formulaByExamplePluginAttach=void 0;var SW=br(),Yxe=cu(),Uan=Fu(),Jxe=Jd(),Gan=(0,Yxe.asyncLazy)(function(){return(0,SW.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,SW.__generator)(this,function(r){switch(r.label){case 0:return[4,Jxe.workerThreadSpread.getValue()];case 1:return e=r.sent(),[4,e.loadPluginScript("excelOnlineX10Plugins",!1)];case 2:return r.sent(),[2,e]}})})}),Kan=(0,Yxe.asyncLazy)(function(){return(0,SW.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,SW.__generator)(this,function(r){switch(r.label){case 0:return[4,Gan.getValue()];case 1:return e=r.sent(),[4,Jxe.schedulerWithRecalcServiceAttached.getValue()];case 2:return r.sent(),[4,e.createAndAttachPlugin(Uan.PluginFactoryName.FormulaByExamplePlugin)];case 3:return r.sent(),[2]}})})});yW.formulaByExamplePluginAttach=Kan});var n4e=Y(_W=>{_();Object.defineProperty(_W,"__esModule",{value:!0});_W.ensureGroupAttached=min;_W.ensurePluginAttached=r4e;var CW=br(),Xue=Jc(),Van=oae(),uI=Wke(),$xe=Jd(),Wan=sae(),jan=cae(),Han=Tae(),Qan=Iae(),zan=qae(),Yan=dae(),Jan=mae(),Xan=tFe(),Zan=Sae(),$an=_ae(),ein=zae(),rin=Lxe(),nin=qxe(),tin=Ai(),Zxe=tu(),ain=ft(),qo=Fu(),iin=zxe(),oin=Xv(),uin=rF(),sin=m_(),lin=Xxe(),ul,R4,T4,Zue,$ue,e4e=(ul={},ul[qo.PluginFactoryName.ArgumentAssistancePlugin]=[Van.argumentAssistancePluginDependenciesResolved,void 0,void 0,"ArgumentAssistance"],ul[qo.PluginFactoryName.AutocompletePlugin]=[uI.autocompletePluginDependenciesResolved,void 0,void 0,"SmartSuggestionsAutoComplete"],ul[qo.PluginFactoryName.AutocompleteFunctionPlugin]=[Wan.autocompleteFunctionPluginDependenciesResolved,void 0,void 0,"SimpleAutoComplete"],ul[qo.PluginFactoryName.ParenthesesCouplingPlugin]=[Han.parenthesesCouplingPluginDependenciesResolved,void 0,void 0,"ParenthesisCoupling"],ul[qo.PluginFactoryName.ColoredReferencesPlugin]=[Qan.coloredReferencesPluginDependenciesResolved,void 0,void 0,"ColoredReferences"],ul[qo.PluginFactoryName.GotoCtrlClickPlugin]=[zan.gotoCtrlClickPluginDependenciesResolved,void 0,void 0,"GotoCtrlClick"],ul[qo.PluginFactoryName.AutocompleteLetPlugin]=[Yan.autocompleteLetPluginDependenciesResolved,void 0,void 0,"SimpleAutoComplete"],ul[qo.PluginFactoryName.AutocompleteRichValuePlugin]=[Jan.autocompleteRichValuePluginDependenciesResolved,void 0,void 0,"SimpleAutoComplete"],ul[qo.PluginFactoryName.FormulaCollectionPlugin]=[Xan.formulaCollectionPluginDependenciesResolved,"Microsoft.Office.Excel.FormulaCollection"],ul[qo.PluginFactoryName.AutocompleteNamedObjectsPlugin]=[Zan.autocompleteNamedObjectsPluginDependenciesResolved,void 0,void 0,"SimpleAutoComplete"],ul[qo.PluginFactoryName.ParserPerformanceMeasurements]=[uI.parserPerformanceMeasurementsAttach,"Microsoft.Office.Excel.x10ParserPerformanceMeasurements"],ul[qo.PluginFactoryName.AutocompleteTableHeadersPlugin]=[$an.autocompleteTableHeadersPluginDependenciesResolved,void 0,void 0,"SimpleAutoComplete"],ul[qo.PluginFactoryName.ValuePreviewPlugin]=[ein.valuePreviewPluginDependenciesResolved,void 0,void 0,"ValuePreview"],ul[qo.PluginFactoryName.SyntaxErrorsPlugin]=[iin.syntaxErrorsPluginDependenciesResolved,void 0,void 0,"SyntaxErrors"],ul[qo.PluginFactoryName.AutocompleteRangeSuggestionPlugin]=[uI.autocompleteRangeSuggestionPluginAttach,"Microsoft.Office.Excel.AutocompleteRangeSuggestionPlugin"],ul[qo.PluginFactoryName.AutocompleteWrapperPlugin]=[uI.autocompleteWrapperPluginAttach,"Microsoft.Office.Excel.x10AutocompleteWrapperPluginIsEnabled"],ul[qo.PluginFactoryName.AutocompleteBinaryModelExperimentPlugin]=[uI.autocompleteBinaryModelExperimentPluginAttach,"Microsoft.Office.Excel.x10AutocompleteBinaryModelExperimentPlugin"],ul[qo.PluginFactoryName.FormulaRepairShadowEvalPlugin]=[rin.formulaRepairShadowEvalPluginDependenciesResolved,"Microsoft.Office.Excel.ProseFormulaRepairExperimentIsEnabled"],ul[qo.PluginFactoryName.PythonAutocompletePlugin]=[nin.pythonAutocompletePluginAttach,"Microsoft.Office.Excel.x10PythonAutocompletionEnabled"],ul[qo.PluginFactoryName.ChatGPTPlugin]=[uI.chatGPTPluginAttach,"Microsoft.Office.Excel.ChatGPTPluginEnabled"],ul[qo.PluginFactoryName.FormulaByExamplePlugin]=[lin.formulaByExamplePluginAttach,"Microsoft.Office.Excel.FormulaByExamplePluginEnabled"],ul[qo.PluginFactoryName.TestPlugin]=[$xe.workerThreadInitialized,"Microsoft.Office.Excel.MockWorkerThreadPlugin"],ul[qo.PluginFactoryName.AutocompleteEnumPlugin]=[jan.autocompleteEnumPluginDependenciesResolved,void 0,void 0,"EnumAutoComplete"],ul),cin=(R4={},R4[qo.PluginAttachGroup.Core]=!0,R4[qo.PluginAttachGroup.Python]=!1,R4[qo.PluginAttachGroup.SmartSuggestionsAutoComplete]=!1,R4);(0,ain.staticAssertExtends)();var din=(T4={},T4[qo.PluginAttachGroup.Core]=(Zue={},Zue[qo.PluginFactoryName.AutocompletePlugin]=!1,Zue),T4[qo.PluginAttachGroup.Python]={},T4[qo.PluginAttachGroup.SmartSuggestionsAutoComplete]=($ue={},$ue[qo.PluginFactoryName.AutocompletePlugin]=!0,$ue),T4);function r4e(e,r,n){return n===void 0&&(n=[]),(0,CW.__awaiter)(this,void 0,void 0,function(){var a,o,u,t,d,s,c;return(0,CW.__generator)(this,function(l){switch(l.label){case 0:if((0,Xue.isTypedChangeGateEnabled)("OfficeVSO:7903424_Microsoft.Office.Excel.ProvideX10FeaturesFromSchedulerFeatures")&&(a=uin.PluginSchedulerSingleton.instance(),a.doNotify(sin.NotificationKind.setSchedulerFeatures,[n.map(function(f){return qo.SchedulerFeature[f]})])),$xe.scriptLoaderPromise.resolve(r),o=e4e[e],o===void 0)return[2,!1];if(u=o[0],t=o[1],d=o[2],s=o[3],!((t===void 0||(0,Xue.getTypedFeatureGate)(t))&&(d===void 0||(0,Xue.isTypedChangeGateEnabled)(d))&&(s===void 0||n.indexOf(s)!==-1)))return[3,4];l.label=1;case 1:return l.trys.push([1,3,,4]),[4,u.getValue()];case 2:return l.sent(),[2,!0];case 3:return c=l.sent(),tin.ulsLogger.ULS.traceTag(523352029,Zxe.LogCategory.msoulscat_ES_EWAJS,Zxe.TraceLevel.Error,oin.x10Logger.formatLogMessage("ensurePluginAttached",{description:'Failed to ensure plugin "'.concat(qo.PluginFactoryName[e],'" is attached with exception'),data:c})),[3,4];case 4:return[2,!1]}})})}function fin(e){return Object.keys(e).map(function(r){return parseInt(r,10)})}function pin(e,r){var n;return(n=din[r][e])!==null&&n!==void 0?n:cin[r]}function min(e,r,n){return n===void 0&&(n=[]),(0,CW.__awaiter)(this,void 0,void 0,function(){var a,o,u,t,d;return(0,CW.__generator)(this,function(s){switch(s.label){case 0:a=0,o=0,u=fin(e4e),s.label=1;case 1:return o<u.length?(t=u[o],pin(t,r)?[4,r4e(t,e,n)]:[3,3]):[3,4];case 2:d=s.sent(),d&&(a+=1),s.label=3;case 3:return o++,[3,1];case 4:return[2,a]}})})}});var i4e=Y(lI=>{_();Object.defineProperty(lI,"__esModule",{value:!0});lI.ChatGPTPluginFactory=lI.ChatGPTPlugin=void 0;var gin=br(),vin=ft(),hin=Fu(),Sin=Cd(),sI=ds(),t4e=function(){function e(){this.factoryName=hin.PluginFactoryName.ChatGPTPlugin}return e.prototype.create=function(){return new a4e},e}();lI.ChatGPTPluginFactory=t4e;var a4e=function(){function e(){}return e.prototype.run=function(r){var n,a,o,u;return(0,gin.__generator)(this,function(t){switch(t.label){case 0:return n=r.query,(0,vin.isDefined)(n)?[4,{kind:sI.ComputationRequestKind.CreateChatGPTSession,options:r.context}]:[2,{}];case 1:if(a=t.sent(),a.kind!==sI.ComputationRequestKind.CreateChatGPTSession)throw new Error("Inconsistent yield request response type");return[4,{kind:sI.ComputationRequestKind.SendChatGPTRequest,session:a.result,request:n}];case 2:if(o=t.sent(),o.kind!==sI.ComputationRequestKind.SendChatGPTRequest)throw new Error("Inconsistent yield request response type");return[4,{kind:sI.ComputationRequestKind.SendChatGPTRequest,session:a.result,request:"Explain your answer"}];case 3:if(u=t.sent(),u.kind!==sI.ComputationRequestKind.SendChatGPTRequest)throw new Error("Inconsistent yield request response type");return[2,{result:o.result,details:u.result}]}})},e}();lI.ChatGPTPlugin=a4e;(0,Sin.registerPluginFactory)(new t4e)});var u4e=Y(RW=>{_();Object.defineProperty(RW,"__esModule",{value:!0});RW.EventRegistry=void 0;var yin=ft(),o4e=J8(),Cin=Ete();(0,yin.staticAssertExtends)();var _in=function(r,n,a){return function(u,t){(0,Cin.registerComputation)(o4e.ComputationType.Event,r,o4e.ExecutionType.Async,n,u,a)}},Rin=function(r){return{eventHandler:function(a,o){return _in(a,r.factoryName,o)}}};RW.EventRegistry=Rin});var s4e=Y(TW=>{_();Object.defineProperty(TW,"__esModule",{value:!0});Object.defineProperty(TW,"EventKind",{enumerable:!0,get:function(){return bin.EventKind}});Object.defineProperty(TW,"EventRegistry",{enumerable:!0,get:function(){return Tin.EventRegistry}});var Tin=u4e(),bin=z8()});var f4e=Y(b4=>{_();Object.defineProperty(b4,"__esModule",{value:!0});b4.x10=void 0;var Pin=Du(ft()),Ein=Du(mte()),bW=Du(rF()),PW=Du(_Oe()),Nin=Du(TOe()),Ain=Du(Cd()),Xg=Du(ds()),Oin=Du(m_()),kin=Du(kk()),Fin=Du(oae()),Iin=Du(sae()),Min=Du(cae()),win=Du(dae()),Din=Du(mae()),xin=Du(Sae()),Lin=Du(_ae()),Bin=Du(Tae()),qin=Du(Iae()),ese=Du(Fu()),Uin=Du(cte()),l4e=Du(n4e()),Gin=Du(Xte()),Kin=Du(d8()),Vin=Du(zae()),Win=Du(jae()),jin=Du(qae()),Hin=Du(FD()),Qin=Du(i4e()),zin=Du(eh()),c4e=Du(s4e());function d4e(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,n=new WeakMap;return(d4e=function(o){return o?n:r})(e)}function Du(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var n=d4e(r);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(u!=="default"&&Object.prototype.hasOwnProperty.call(e,u)){var t=o?Object.getOwnPropertyDescriptor(e,u):null;t&&(t.get||t.set)?Object.defineProperty(a,u,t):a[u]=e[u]}return a.default=e,n&&n.set(e,a),a}var rse;b4.x10=rse;(function(e){e.formulaAssistanceModule=zin,e.core=Pin,e.ChatGPTPlugin=Qin.ChatGPTPlugin,e.defaultPluginResponseWindows=Ein.defaultPluginResponseWindows,e.getSchedulerFactories=bW.getSchedulerFactories,e.PluginSchedulerSingleton=bW.PluginSchedulerSingleton,e.GridImportManagerSingleton=bW.GridImportManagerSingleton,e.FormulaKind=kin.FormulaKind,e.SchedulerVersionCompatibility=Xg.SchedulerVersionCompatibility,e.RecalcSideGrid=Kin.RecalcSideGrid,e.createMockAsyncGrid=PW.createMockAsyncGrid,e.createMockGridProvider=PW.createMockGridProvider,e.createMockGridExporter=PW.createMockGridExporter,e.setMockGridSheetAndNotify=PW.setMockGridSheetAndNotify,e.MockTimerImmediate=Nin.MockTimerImmediate,e.PluginGroup=ese.PluginGroup,e.PluginFactoryName=ese.PluginFactoryName,e.registerPluginFactory=Ain.registerPluginFactory,e.DefaultComputationGroup=Xg.DefaultComputationGroup,e.stableDynamicPluginLoaderInsideInit=bW.dynamicPluginLoaderInsideInit,e.ComputationRequestKind=Xg.ComputationRequestKind,e.PluginRequestKind=Xg.ComputationRequestKind,e.typedRequest=Xg.typedRequest,e.awaitPromise=Xg.awaitPromise,e.wrapIntoAsync=Gin.wrapIntoAsync,e.delay=Xg.delay,e.delayRequest=Xg.delayRequest,e.getSheetNamesRequest=Xg.getSheetNamesRequest,e.getRangeRequest=Xg.getRangeRequest,e.getCellRequest=Xg.getCellRequest,e.parseCellFormulaRequest=Xg.parseCellFormulaRequest,e.RequestKind=Xg.RequestKind,e.NotificationKind=Oin.NotificationKind,e.PluginSchedulerResultKind=ese.PluginSchedulerResultKind,e.EventRegistry=c4e.EventRegistry,e.EventKind=c4e.EventKind,e.ArgumentAssistancePluginFactory=Fin.ArgumentAssistancePluginFactory,e.AutocompleteFunctionPluginFactory=Iin.AutocompleteFunctionPluginFactory,e.AutocompleteEnumPluginFactory=Min.AutocompleteEnumPluginFactory,e.AutocompleteLetPluginFactory=win.AutocompleteLetPluginFactory,e.AutocompleteRichValuePluginFactory=Din.AutocompleteRichValuePluginFactory,e.AutocompleteNamedObjectsPluginFactory=xin.AutocompleteNamedObjectsPluginFactory,e.AutocompleteTableHeadersPluginFactory=Lin.AutocompleteTableHeadersPluginFactory,e.ParenthesesCouplingPluginFactory=Bin.ParenthesesCouplingPluginFactory,e.ColoredReferencesPluginFactory=qin.ColoredReferencesPluginFactory,e.ValuePreviewPluginFactory=Vin.ValuePreviewPluginFactory,e.GotoCtrlClickPluginFactory=jin.GotoCtrlClickPluginFactory,e.ValuePreviewResultExtractor=Win.ValuePreviewResultExtractor,e.spanToLSPRange=Uin.spanToLSPRange,e.ensurePluginAttached=l4e.ensurePluginAttached,e.ensureGroupAttached=l4e.ensureGroupAttached,e.defaultTimerInterface=Hin.defaultTimerInterface})(rse||(b4.x10=rse={}))});var p4e=Y(EW=>{_();Object.defineProperty(EW,"__esModule",{value:!0});EW.PluginSchedulerSingletonGlobal=void 0;var Yin=rF(),Jin=new Yin.PluginSchedulerSingleton;EW.PluginSchedulerSingletonGlobal=Jin});var m4e=Y(nse=>{_();Object.defineProperty(nse,"__esModule",{value:!0});nse.getWorksheetFuncTypeWrapper=Zin;var Xin=Ql(),kN=sg(),P4;function Zin(e){return $in(e)?eon[e.FunctionIndexInServer][e.signatureIndex]:(0,kN.getWorksheetFuncType)(e.FunctionIndexInServer)}var $in=function(r){if(!(0,Xin.isChangeGateEnabled)("OfficeVSO:8059750_multipleSignaturesHelperEnabled")||r===void 0)return!1;var n=r,a=n.FunctionIndexInServer,o=n.signatureIndex;return(o===0||o===1)&&(a===kN.WorksheetFuncId.AGGREGATE||a===kN.WorksheetFuncId.INDEX||a===kN.WorksheetFuncId.LOOKUP)},eon=(P4={},P4[kN.WorksheetFuncId.AGGREGATE]=[{headTypes:[1,1,48,17],restTypes:[],tailTypes:[],minArgs:3,maxArgs:4},{headTypes:[1,1],restTypes:[16],tailTypes:[],minArgs:3,maxArgs:255}],P4[kN.WorksheetFuncId.INDEX]=[{headTypes:[48,1,1],restTypes:[],tailTypes:[],minArgs:2,maxArgs:3},{headTypes:[48,1,1,1],restTypes:[],tailTypes:[],minArgs:2,maxArgs:4}],P4[kN.WorksheetFuncId.LOOKUP]=[{headTypes:[263,48,48],restTypes:[],tailTypes:[],minArgs:2,maxArgs:3},{headTypes:[263,48],restTypes:[],tailTypes:[],minArgs:2,maxArgs:2}],P4)});var g4e=Y(AW=>{_();Object.defineProperty(AW,"__esModule",{value:!0});AW.FormulaAuthoringHelper=void 0;var FN=ft(),tse=tu(),NW=eae(),ron=G7(),ase=m4e(),non=function(){function e(){var r=this;this.hasRepeatingParams=function(n){return(0,FN.isNone)(n)?(r.logError("hasRepeatingParams: funcInfo is null or undefined"),!1):(0,ase.getWorksheetFuncTypeWrapper)(n).restTypes.length>0}}return e.prototype.getMinimalParamArray=function(r,n){var a;if(!(0,FN.isNone)(n)){for(var o=(0,ase.getWorksheetFuncTypeWrapper)(n),u=o.minArgs,t=o.restTypes,d=t.length>0?Math.max(u,2):(a=r==null?void 0:r.length)!==null&&a!==void 0?a:0,s=[],c=0;c<d;c+=1){var l=this.getFunctionParamByIndex(r,n,c);(0,FN.isDefined)(l)&&s.push(l)}return s}},e.prototype.getFunctionParamByIndex=function(r,n,a){if(!(!ton(r)||(0,FN.isNone)(n))){var o=(0,ase.getWorksheetFuncTypeWrapper)(n),u=o.headTypes.length,t=n.ParamsHelp.split("!"),d=(0,NW.getParamIndexToHighlight)(a,r.length,o,!1,!0);if(d===-1){this.logError("Trying to get param by index that is out of bounds");return}else if(d>=r.length){this.logError("Trying to add param for a signature that doesn't have rest params.");return}var s=a<u?r[d].match(/[^\[\]]+/).toString():"".concat((0,NW.getBaseParamName)(r[d])).concat((0,NW.getParamNumberSuffix)(a,u,o.restTypes.length)),c=(0,NW.getParamIndexToHighlight)(a,n.ParamsHelp.split("!").length,o),l=t[c];return{name:s,isOptional:a>=o.minArgs,description:l,type:"TO DO"}}},e.prototype.getFormulaAnonymizer=function(r){var n=this,a=new ron.ConsistentAnonymizer,o=function(t,d){try{return aon(t)?ion(r)?oon(d)?a.anonymize(t,r,d):(n.logError("getFormulaAnonymizer: Origin"),null):(n.logError("getFormulaAnonymizer: Config"),null):(n.logError("getFormulaAnonymizer: Formula"),null)}catch(s){return n.logError("getFormulaAnonymizer: ".concat(s)),null}};return{anonymize:o}},e.prototype.logError=function(r){tse.ulsLogger.ULS.traceTag(512331973,tse.LogCategory.msoulscat_ES_EWAJS,tse.TraceLevel.Error,"FormulaAuthoringHelper error: ".concat(r))},e}();AW.FormulaAuthoringHelper=non;function ton(e){return!0}function aon(e){return(0,FN.isDefined)(e)&&typeof e=="string"}function ion(e){return(0,FN.isDefined)(e)&&typeof e=="object"&&"localeInfo"in e&&"mathpack"in e&&"refStyle"in e}function oon(e){return(0,FN.isDefined)(e)&&typeof e=="object"&&"row"in e&&"col"in e&&e.rows===1&&e.cols===1}});var v4e=Y(OW=>{_();Object.defineProperty(OW,"__esModule",{value:!0});OW.FormulaAuthoringHelperSingleton=void 0;var uon=ft(),son=g4e(),lon=(0,uon.singleton)(function(){return new son.FormulaAuthoringHelper});OW.FormulaAuthoringHelperSingleton=lon});var h4e=Y(kW=>{_();Object.defineProperty(kW,"__esModule",{value:!0});kW.FormulaAuthoringHelperSingletonGlobal=void 0;var con=v4e(),don=new con.FormulaAuthoringHelperSingleton;kW.FormulaAuthoringHelperSingletonGlobal=don});var ise=Y(Yi=>{_();Object.defineProperty(Yi,"__esModule",{value:!0});Object.defineProperty(Yi,"FormulaAuthoringHelperSingletonGlobal",{enumerable:!0,get:function(){return bon.FormulaAuthoringHelperSingletonGlobal}});Object.defineProperty(Yi,"PluginSchedulerSingletonGlobal",{enumerable:!0,get:function(){return Ton.PluginSchedulerSingletonGlobal}});Object.defineProperty(Yi,"analyze",{enumerable:!0,get:function(){return gon.analyze}});Object.defineProperty(Yi,"calc",{enumerable:!0,get:function(){return Son.calc}});Object.defineProperty(Yi,"common",{enumerable:!0,get:function(){return pon.common}});Yi.commonSubpackage=void 0;Object.defineProperty(Yi,"config",{enumerable:!0,get:function(){return lb.config}});Object.defineProperty(Yi,"date",{enumerable:!0,get:function(){return lb.date}});Object.defineProperty(Yi,"formula",{enumerable:!0,get:function(){return lb.formula}});Object.defineProperty(Yi,"funcs",{enumerable:!0,get:function(){return yon.funcs}});Object.defineProperty(Yi,"getTypedFeatureGate",{enumerable:!0,get:function(){return S4e.getTypedFeatureGate}});Object.defineProperty(Yi,"isTypedChangeGateEnabled",{enumerable:!0,get:function(){return S4e.isTypedChangeGateEnabled}});Yi.langSubpackage=void 0;Object.defineProperty(Yi,"location",{enumerable:!0,get:function(){return lb.location}});Object.defineProperty(Yi,"math",{enumerable:!0,get:function(){return lb.math}});Object.defineProperty(Yi,"numfmt",{enumerable:!0,get:function(){return von.numfmt}});Yi.numfmtSubpackage=void 0;Object.defineProperty(Yi,"packageVersion",{enumerable:!0,get:function(){return fon.packageVersion}});Object.defineProperty(Yi,"parse",{enumerable:!0,get:function(){return mon.parse}});Yi.recalcSubpackage=void 0;Object.defineProperty(Yi,"runtime",{enumerable:!0,get:function(){return hon.runtime}});Yi.runtimeSubpackage=void 0;Object.defineProperty(Yi,"sheetName",{enumerable:!0,get:function(){return Pon.sheetName}});Object.defineProperty(Yi,"signature",{enumerable:!0,get:function(){return lb.signature}});Object.defineProperty(Yi,"style",{enumerable:!0,get:function(){return Con.style}});Yi.syntaxSubpackage=void 0;Object.defineProperty(Yi,"util",{enumerable:!0,get:function(){return lb.util}});Object.defineProperty(Yi,"value",{enumerable:!0,get:function(){return lb.value}});Object.defineProperty(Yi,"worker",{enumerable:!0,get:function(){return _on.worker}});Object.defineProperty(Yi,"x10",{enumerable:!0,get:function(){return Ron.x10}});Yi.x10TypesSubpackage=void 0;var fon=kfe(),pon=wme(),lb=dhe(),mon=F1e(),gon=w1e(),von=lCe(),hon=Bbe(),Son=aOe(),yon=oOe(),Con=sOe(),_on=fOe(),Ron=f4e(),Ton=p4e(),bon=h4e(),Pon=dT(),S4e=Jc(),Eon=IN(Cn());Yi.commonSubpackage=Eon;var Non=IN(et());Yi.langSubpackage=Non;var Aon=IN(gm());Yi.numfmtSubpackage=Aon;var Oon=IN(Rte());Yi.recalcSubpackage=Oon;var kon=IN(Gv());Yi.runtimeSubpackage=kon;var Fon=IN(N0());Yi.syntaxSubpackage=Fon;var Ion=IN(fy());Yi.x10TypesSubpackage=Ion;function y4e(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,n=new WeakMap;return(y4e=function(o){return o?n:r})(e)}function IN(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var n=y4e(r);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(u!=="default"&&Object.prototype.hasOwnProperty.call(e,u)){var t=o?Object.getOwnPropertyDescriptor(e,u):null;t&&(t.get||t.set)?Object.defineProperty(a,u,t):a[u]=e[u]}return a.default=e,n&&n.set(e,a),a}});var P4e=Y(MW=>{_();var IW=An(),Mon=Y0();Object.defineProperty(MW,"__esModule",{value:!0});MW.DragPluginFactory=void 0;var use=IW(Y0()),R4e=IW(at()),T4e=IW(it()),C4e=IW(V_()),rg=ise(),FW,won=Mon.mark(sse);function b4e(e,r){var n=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=Don(e))||r&&e&&typeof e.length=="number"){n&&(e=n);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Don(e,r){if(e){if(typeof e=="string")return _4e(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _4e(e,r)}}function _4e(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,a=new Array(r);n<r;n++)a[n]=e[n];return a}var xon=rg.x10.formulaAssistanceModule.CompletionItemKind;function Lon(e){for(var r,n=!0,a=b4e(e),o;!(o=a()).done;){var u=o.value;if(n)r=u;else if(n=!1,u!==r)return!1}return!0}var cI;(function(e){e.Left="Left",e.Up="Up"})(cI||(cI={}));var Bon=(FW={},(0,C4e.default)(FW,cI.Left,{dRow:0,dCol:1}),(0,C4e.default)(FW,cI.Up,{dRow:1,dCol:0}),FW),ose=2;function qon(){for(var e={},r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];for(var o=0,u=n;o<u.length;o++)for(var t=u[o],d=b4e(t),s;!(s=d()).done;){var c=s.value;e[c]=!0}return Object.keys(e)}function sse(e){var r,n,a,o,u,t,d,s,c,l,f,p,m,v,h,S,y;return use.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return r=Bon[e],n=r.dRow,a=r.dCol,E.delegateYield(rg.x10.typedRequest(rg.x10.PluginRequestKind.GetActiveCell,{}),"t0",2);case 2:if(o=E.t0,u=o.activeCell,!(n!==0&&n*ose>u.range.row)){E.next=6;break}return E.abrupt("return",[]);case 6:if(!(a!==0&&a*ose>u.range.col)){E.next=8;break}return E.abrupt("return",[]);case 8:t=[],d=1;case 10:if(!(d<=ose)){E.next=33;break}return s=rg.location.sheetGridCell(u.sheet,rg.location.gridCell(u.range.row-d*n,u.range.col-d*a)),E.delegateYield(rg.x10.getCellRequest(s),"t1",13);case 13:if(c=E.t1,l=c.result,rg.util.isSuccess(l)){E.next=17;break}return E.abrupt("break",33);case 17:if(f=l.value.formula,f.kind===rg.x10.FormulaKind.CellFormula){E.next=20;break}return E.abrupt("continue",30);case 20:return p=f,E.delegateYield(rg.x10.parseCellFormulaRequest(s,p),"t2",22);case 22:if(m=E.t2,v=m.result,rg.util.isSuccess(v)){E.next=26;break}return E.abrupt("continue",30);case 26:return E.delegateYield(rg.x10.typedRequest(rg.x10.PluginRequestKind.PrintFormula,{formula:v.value,origin:u}),"t3",27);case 27:h=E.t3,S=h.result,rg.util.isSuccess(S)&&(y=S.value,t.push(y));case 30:d+=1,E.next=10;break;case 33:if(!(t.length===0||!Lon(t))){E.next=35;break}return E.abrupt("return",[]);case 35:return E.abrupt("return",[t[0].slice(1)]);case 36:case"end":return E.stop()}},won)}var Uon=function(){function e(){(0,R4e.default)(this,e),this.factoryName=rg.x10.PluginFactoryName.DragPlugin}return(0,T4e.default)(e,[{key:"create",value:function(){return new Gon}}]),e}();MW.DragPluginFactory=Uon;var Gon=function(){function e(){(0,R4e.default)(this,e)}return(0,T4e.default)(e,[{key:"run",value:use.default.mark(function r(){var n,a,o;return use.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(sse(cI.Up),"t0",1);case 1:return n=t.t0,t.delegateYield(sse(cI.Left),"t1",3);case 3:return a=t.t1,o=qon(n,a),t.abrupt("return",{items:o.map(function(d){return{label:d,kind:xon.Function}})});case 6:case"end":return t.stop()}},r)})}]),e}()});var cse=Y(lse=>{_();Object.defineProperty(lse,"__esModule",{value:!0});lse.debugLog=Von;var Kon=pL();function Von(e){(0,Kon.getTypedFeatureGate)("Microsoft.Office.Excel.DesktopX10JavascriptDebug")&&console.log(e)}});var k4e=Y(DW=>{_();var fse=An();Object.defineProperty(DW,"__esModule",{value:!0});DW.X10Scheduler=void 0;var wW=fse(Y0()),Won=fse(at()),jon=fse(it()),Hon=zon(Afe());Ofe();var Zg=ise(),Qon=P4e(),E4e=cse();function N4e(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,n=new WeakMap;return(N4e=function(o){return o?n:r})(e)}function zon(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var n=N4e(r);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(u!=="default"&&Object.prototype.hasOwnProperty.call(e,u)){var t=o?Object.getOwnPropertyDescriptor(e,u):null;t&&(t.get||t.set)?Object.defineProperty(a,u,t):a[u]=e[u]}return a.default=e,n&&n.set(e,a),a}function dI(e){return e!=null}var tMn=Zg.x10.PluginResponseWindows,Yon=Zg.x10.createMockAsyncGrid,Jon=Zg.x10.createMockGridProvider,Xon=Zg.x10.core.mapFromArrayOfPairs,Zon=Zg.x10.core.strEnumArray;(0,E4e.debugLog)("x10Scheduler.ts loaded");var $on=3e4,eun={startDelta:5,stopDelta:$on},run=Xon(Zon(Zg.x10.RequestKind).map(function(e){return[e,eun]})),pse=Yon(),A4e=[["=B1",26],["=B2",12],["=B3"],["","love",void 0]],O4e="0123-4567-89ab-cdef",nun="fedc-ba98-7654-3210";pse.setSheet(O4e,"Sheet1",A4e);pse.setSheet(nun,"Sheet2",A4e);var tun=Jon(pse);function aun(e,r){var n=e.createFormulaBarScheduler(r,run);return n.registerAsyncGrid(),n.notifier().setActiveCell({rowIndex:3,colIndex:0,docName:"myDoc",docPath:"mypath",sheetIndex:O4e}),n}var dse=aun(Zg.x10.getSchedulerFactories(),tun);dse.createAndAttachPlugin(new Qon.DragPluginFactory);var iun=function(){function e(){(0,Won.default)(this,e),this.ServiceInfo=Hon.ServiceInfos.SchedulerJsService,(0,E4e.debugLog)("X10Scheduler created")}return(0,jon.default)(e,[{key:"valuePreview",value:function(n){var a,o,u,t,d;return wW.default.async(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,wW.default.awrap(dse.doRequest(Zg.x10.RequestKind.valuePreview,n,Zg.x10.PluginGroup.Excel,Zg.x10.DefaultComputationGroup));case 2:if(d=c.sent,dI(d)){c.next=5;break}return c.abrupt("return",{kind:"Failed"});case 5:if(d.kind!==Zg.x10.PluginSchedulerResultKind.Superseded){c.next=7;break}return c.abrupt("return",{kind:"Superseded"});case 7:if(dI(d.payload)){c.next=9;break}return c.abrupt("return",{kind:"Failed"});case 9:return c.abrupt("return",{kind:"Done",index:d.payload.index,length:d.payload.length,color:(a=d.payload.color)!=null?a:void 0,evaluatedFormula:(o=d.payload.evaluatedFormula)!=null?o:void 0,value:(u=d.payload.value)!=null?u:void 0,unformattedValue:(t=d.payload.unformattedValue)!=null?t:void 0});case 10:case"end":return c.stop()}},null,null,null,Promise)}},{key:"suggestion",value:function(n){var a,o,u,t;return wW.default.async(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,wW.default.awrap(dse.requester().functionSuggestion(n,Zg.x10.PluginGroup.Excel,void 0));case 2:if(t=s.sent,dI(t)){s.next=5;break}return s.abrupt("return",{kind:"Failed"});case 5:if(t.kind!==Zg.x10.PluginSchedulerResultKind.Superseded){s.next=7;break}return s.abrupt("return",{kind:"Superseded"});case 7:return s.abrupt("return",{kind:"Done",payload:{items:(a=(o=t.payload)==null||(u=o.items)==null?void 0:u.filter(dI).map(function(c){var l,f,p,m=c.label,v=c.detail,h=c.evaluation,S=c.isPrefixed,y=c.shouldRequestAutocompleteOnCommit,C=c.kind,E=c.textEdit,I=c.type;return{label:m??void 0,detail:v??void 0,evaluation:h??void 0,isPrefixed:S??void 0,shouldRequestAutocompleteOnCommit:y??void 0,kind:C,textEdit:dI(E)?{newText:(l=E.newText)!=null?l:void 0,range:dI(E.range)?{start:(f=E.range.start)!=null?f:void 0,end:(p=E.range.end)!=null?p:void 0}:void 0}:void 0,type:I??void 0}}))!=null?a:[]}});case 8:case"end":return s.stop()}},null,null,null,Promise)}}]),e}();DW.X10Scheduler=iun});var M4e=Y(fI=>{_();var F4e=An();Object.defineProperty(fI,"__esModule",{value:!0});fI.ServiceInfos=fI.NativeServices=void 0;var oun=F4e(at()),uun=F4e(it()),sun=Ec(),I4e={GridService:["X10::GridService",{stub:["ReturnsPromiseMethod","$any",[]]}]};fI.ServiceInfos=I4e;var lun=function(){function e(){(0,oun.default)(this,e)}return(0,uun.default)(e,null,[{key:"GridService",get:function(){return e._GridService??=sun.RekaServiceRegistry.getNativeService(I4e.GridService)}}]),e}();fI.NativeServices=lun});var x4e=Y(LW=>{_();var mse=An();Object.defineProperty(LW,"__esModule",{value:!0});LW.DesktopGrid=void 0;var w4e=mse(Y0()),cun=mse(at()),dun=mse(it()),fun=pun(M4e()),xW=cse();function D4e(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,n=new WeakMap;return(D4e=function(o){return o?n:r})(e)}function pun(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var n=D4e(r);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(u!=="default"&&Object.prototype.hasOwnProperty.call(e,u)){var t=o?Object.getOwnPropertyDescriptor(e,u):null;t&&(t.get||t.set)?Object.defineProperty(a,u,t):a[u]=e[u]}return a.default=e,n&&n.set(e,a),a}(0,xW.debugLog)("desktopGrid.ts loaded");var mun=function(){function e(){(0,cun.default)(this,e),this.service=fun.NativeServices.GridService,(0,xW.debugLog)("DesktopGrid created")}return(0,dun.default)(e,[{key:"init",value:function(){return w4e.default.async(function(a){for(;;)switch(a.prev=a.next){case 0:return(0,xW.debugLog)("DesktopGrid init"),a.next=3,w4e.default.awrap(this.service.stub());case 3:(0,xW.debugLog)("DesktopGrid init done");case 4:case"end":return a.stop()}},null,this,null,Promise)}}]),e}();LW.DesktopGrid=mun});var B4e=Y(gse=>{_();var gun=An();Object.defineProperty(gse,"__esModule",{value:!0});gse.default=Sun;var L4e=gun(Y0()),vun=k4e(),hun=x4e();function Sun(e){var r,n;return L4e.default.async(function(o){for(;;)switch(o.prev=o.next){case 0:return r=new vun.X10Scheduler,e.registerServiceInstances(r),n=new hun.DesktopGrid,o.next=5,L4e.default.awrap(n.init());case 5:case"end":return o.stop()}},null,null,null,Promise)}});_();var yun=sM(),q4e=dde(),Cun=pL(),_un={appName:q4e.AppName,ariaTenantToken:q4e.AriaTenantToken,headlessApps:[{name:"DataCleansing",enableOption:!0,importModule:function(){return Promise.resolve().then(()=>KW(Nfe()))}},{name:"x10",enableOption:function(){return(0,Cun.getTypedFeatureGate)("Microsoft.Office.Excel.DesktopX10UxppEnabled")},importModule:function(){return Promise.resolve().then(()=>KW(B4e()))}}]};(0,yun.initHeadlessUxpp)(_un);})();
//# sourceMappingURL=index.win32.bundle.map
