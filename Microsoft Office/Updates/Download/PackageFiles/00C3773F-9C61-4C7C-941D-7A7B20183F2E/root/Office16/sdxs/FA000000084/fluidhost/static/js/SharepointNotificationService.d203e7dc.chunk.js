"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[4617],{88753:function(e,t,r){r.r(t),r.d(t,{SharepointNotificationService:function(){return Oo}});var n=r(1413),i=r(74165),o=r(15861),a=r(15671),u=r(43144),s=r(92810),c=r(98846),l=r(30288),d=r(24466),f=r(97326),v=r(4942),p=r(11752),h=r(61120),y=r(60136),m=r(29388),Z=r(37762),g="writeToJsonObject",I="writeToFacetJsonObject",C="processJsonObject";function P(e){return null!==e&&"undefined"!==typeof e}function A(e,t,r){return P(t)?Array.isArray(t)?G(t,r,(function(t,r){return A(e,t,r)})):function(e,t){return(t|=0)<e.Min?e.Min:t>e.Max?e.Max:t}(e,t):null}A.bind(null,{Min:-128,Max:127}),A.bind(null,{Min:0,Max:255}),A.bind(null,{Min:-32768,Max:32767}),A.bind(null,{Min:0,Max:65535});var k=A.bind(null,{Min:-2147483648,Max:2147483647}),w=A.bind(null,{Min:0,Max:4294967295});A.bind(null,{Min:Number.MIN_SAFE_INTEGER,Max:Number.MAX_SAFE_INTEGER}),A.bind(null,{Min:0,Max:Number.MAX_SAFE_INTEGER});var S=function e(t,r){return P(t)?Array.isArray(t)?G(t,r,e):t:null},x=function e(t,r){return P(t)?Array.isArray(t)?G(t,r,e):P(t)&&""!==t?t:null:null},T=function e(t,r){return P(t)?Array.isArray(t)?G(t,r,e):x(t.toISOString(),r):null},b=new Date(0),N=function(){function e(t){(0,a.Z)(this,e),this.value=t}return(0,u.Z)(e,[{key:"toString",value:function(){return this.value}}],[{key:"createNew",value:function(){return new e("xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})))}}]),e}();N.Empty=new N("00000000-0000-0000-0000-000000000000");var E=function e(t,r){return P(t)?Array.isArray(t)?G(t,r,e):t!==N.Empty?x(t.toString(),r):null:null},R=N.Empty;function M(e){return function(e){return null!==e&&["number","string","boolean","object"].indexOf(typeof e)>=0}(e)&&!Array.isArray(e)}function D(e){return null!==e&&"object"===typeof e&&!Array.isArray(e)}function O(e){if(D(e)){var t={};for(var r in e)t[r]=O(e[r]);return t}if(Array.isArray(e)){for(var n=[],i=0;i<e.length;++i){var o=e[i];M(o)&&n.push(o)}return n}return e}var U=function e(t,r){return P(t)?Array.isArray(t)?G(t,r,e):O(t):null},L=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;(0,a.Z)(this,e),this.Major=t,this.Minor=r,this.Build=n,this.Revision=i}return(0,u.Z)(e,[{key:"toString",value:function(){var e=this.Major+"."+this.Minor;return(this.Build>0||this.Revision>0)&&(e+="."+this.Build,this.Revision>0&&(e+="."+this.Revision)),e}}]),e}(),F=function e(t,r){return P(t)?Array.isArray(t)?G(t,r,e):x(t.toString(),r):null};new L;function j(e){for(var t=[],r=0;r<e;++r)t.push(r);return t}function _(e){return Object.keys(e).sort((function(t,r){return e[t]-e[r]}))}function q(e,t,r,n){if(!P(e))return null;if(Array.isArray(e))return G(e,n,(function(e,n){return q(e,t,r,n)}));if(8&n)return w(e,n);for(var i=Math.min(t.length,r.length),o=0;o<i;++o)if(t[o]===e)return x(r[o],n);return x(e.toString(),n)}function B(e,t,r,n){if(!P(e))return null;if(Array.isArray(e))return G(e,n,(function(e,n){return B(e,t,r,n)}));if(8&n)return w(e,n);for(var i=[],o=Math.min(t.length,r.length),a=0;a<o;++a){var u=t[a];if(e&u&&(i.push(r[a]),(e&=~u)<1))break}return e>0&&i.push(e.toString()),i.length<1?x("None",n):x(i.join(","),n)}function G(e,t,r){if(!P(e)||e.length<1)return null;var n,i=[],o=(0,Z.Z)(e);try{for(o.s();!(n=o.n()).done;){var a=r(n.value,t);P(a)&&!Array.isArray(a)&&i.push(a)}}catch(u){o.e(u)}finally{o.f()}return i}var W=function(e){return 16777215&(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)|(255&e)<<24|4},V=function(e){return(-16777216&e)>>24};var J=function(){function e(){(0,a.Z)(this,e),this.artifacts=new Map,this.parent=e.current,e.current=this}return(0,u.Z)(e,[{key:"exit",value:function(){e.current=this.parent}}],[{key:"getOrCreateArtifact",value:function(t,r){for(var n=e.current;n;n=n.parent){var i=n.artifacts.get(r);if(i)return i}var o=t();return P(e.current)&&e.current.artifacts.set(r,o),o}}]),e}();J.current=null;var H=function e(t,r){return P(t)?Array.isArray(t)?G(t,r,e):t.toJsonValue(r):null},z=function e(t,r,n){return P(t)?Array.isArray(t)?G(t,r,(function(t,r){return e(t,r,n)})):(1&r||4&r||t.TypeName!=n||(r|=1),t.toJsonValue(r)):null};function K(e,t,r,n){if(P(r)){var i,o=(0,Z.Z)(r);try{for(o.s();!(i=o.n()).done;){var a=i.value,u=e[a];D(u)||(e[a]=u={}),e=u}}catch(s){o.e(s)}finally{o.f()}}P(n)&&(e[t]=n)}var X=function(){function e(){(0,a.Z)(this,e)}return(0,u.Z)(e,[{key:"update",value:function(e){}},{key:"toJsonValue",value:function(e){var t=function(e,t){return 1&t||4&t?{}:2&t?{__metadata:{type:e}}:{__type:e}}(this.TypeName,e);return this[C](t,e,this[g],this[I]),t}},{key:"toFacetJsonValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.toJsonValue(W(e,t))}},{key:"toJson",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return JSON.stringify(this.toJsonValue(e))}},{key:"toFacetJson",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.toJson(W(e,t))}},{key:g,value:function(e,t){}},{key:I,value:function(e,t){}},{key:C,value:function(e,t,r,n){var i=this;!function(e,t){try{return t(e)}finally{e.exit()}}(new J,(function(){4&t?n.call(i,e,t):r.call(i,e,t)}))}}]),e}(),Q=function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.apply(this,arguments)).TypeClassification=2,e}return(0,u.Z)(r)}(X),$=function(){function e(){(0,a.Z)(this,e)}return(0,u.Z)(e,null,[{key:"convertTo",value:function(e,t){return Pe(t)}}]),e}(),Y=function(){function e(){(0,a.Z)(this,e)}return(0,u.Z)(e,null,[{key:"getOrCreate",value:function(){return J.getOrCreateArtifact(e.create,e.artifactId)}},{key:"getPersonIndex",value:function(t){return P(t)?e.findPerson(t):null}},{key:"addPerson",value:function(t){if(P(t)){var r=e.findAndUpdatePerson(t);P(r)||(r=new lr,e.updatePerson(r,t),e.getOrCreate().push(r));for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];for(var a=0,u=i;a<u.length;a++){var s=u[a];P(r.Roles)?r.Roles.indexOf(s)<0&&r.Roles.push(s):r.Roles=[s]}}}},{key:"addPeople",value:function(t){if(P(t)){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];var o,a=(0,Z.Z)(t);try{for(a.s();!(o=a.n()).done;){var u=o.value;e.addPerson.apply(e,[u].concat(n))}}catch(s){a.e(s)}finally{a.f()}}}},{key:"create",value:function(){return[]}},{key:"findAndUpdatePerson",value:function(t){var r=e.findPerson(t);if(r>=0){var n=e.getOrCreate()[r];return e.updatePerson(n,t),n}return null}},{key:"findPerson",value:function(t){for(var r=e.getOrCreate(),n=0;n<r.length;++n){var i=r[n];if(P(i.Provider)&&""!==i.Provider){if(i.Provider===t.Provider&&i.Id===t.Id)return n;if(P(t.Provider)&&""!==t.Provider)continue}if(P(i.Email)&&""!==i.Email){if(i.Email===t.Email)return n;if(P(t.Email)&&""!==t.Email)continue}if(P(i.Name)&&""!==i.Name&&i.Name===t.Name)return n}return-1}},{key:"updatePerson",value:function(e,t){P(e.Provider)&&""!==e.Provider||(e.Provider=t.Provider,e.Id=t.Id),P(e.Email)&&""!==e.Email||(e.Email=t.Email),P(e.Name)&&""!==e.Name||(e.Name=t.Name)}}]),e}();Y.artifactId=Symbol();var ee,te,re,ne,ie,oe,ae,ue,se,ce,le,de,fe,ve,pe,he=function(){function e(){(0,a.Z)(this,e)}return(0,u.Z)(e,null,[{key:"convertToArray",value:function(t,r){var n=Y.getOrCreate();return r instanceof Qr?(Y.addPerson(r.Creator,"Creator","InThread"),Y.addPeople(r.AnchorCreators,"AnchorCreator"),Y.addPerson(r.ParentAuthor,"RepliedTo","InThread"),Y.addPeople(r.Participants,"InThread"),Y.addPerson(r.TaskCreator,"TaskCreator"),Y.addPeople(r.TaskAssignees,"ExistingAssignee"),e.processCommentPreview(r.Preview),n):r instanceof Xr?(Y.addPerson(r.Creator,"Creator"),Y.addPeople(r.AnchorCreators,"AnchorCreator"),Y.addPerson(r.TaskCreator,"TaskCreator"),Y.addPeople(r.TaskAssignees,"ExistingAssignee"),e.processCommentPreview(r.Preview),n):r instanceof Kr?(Y.addPerson(r.Creator,"Creator"),Y.addPerson(r.Mentionee,"Mentioned"),Y.addPerson(r.TaskCreator,"TaskCreator"),Y.addPeople(r.TaskAssignees,"ExistingAssignee"),e.processCommentPreview(r.CommentPreview),n):r instanceof Fr?(Y.addPerson(r.Creator,"Creator"),Y.addPerson(r.Mentionee,"Mentioned"),n):r instanceof Yr?(Y.addPerson(r.Creator,"Creator"),Y.addPerson(r.CommentThreadCreator,"CommentThreadCreator"),Y.addPeople(r.Assignees,"NewAssignee"),e.processCommentPreview(r.CommentPreview),n):r instanceof tn?(Y.addPerson(r.Creator,"Creator"),Y.addPerson(r.TaskCreator,"TaskCreator"),Y.addPeople(r.Assignees,"ExistingAssignee"),Y.addPeople(r.NewAssignees,"NewAssignee"),e.processCommentPreview(r.CommentPreview),n):r instanceof en?(Y.addPerson(r.Creator,"Creator"),Y.addPerson(r.TaskCreator,"TaskCreator"),Y.addPeople(r.Assignees,"ExistingAssignee"),e.processCommentPreview(r.CommentPreview),n):r instanceof rn?(Y.addPerson(r.Creator,"Creator"),Y.addPerson(r.TaskCreator,"TaskCreator"),Y.addPeople(r.Assignees,"Assignee"),Y.addPeople(r.PreviousAssignees,"PreviousAssignee"),n):r instanceof nn?(Y.addPerson(r.Creator,"Creator"),n):r instanceof an?(Y.addPerson(r.Creator,"Creator"),Y.addPerson(r.CommentCreator,"CommentCreator"),Y.addPerson(r.LatestReactor,"LatestReactor"),n):r instanceof sn?(Y.addPerson(r.Creator,"Creator"),Y.addPeople(r.NudgedUsers,"NudgedUser"),n):r instanceof cn?(Y.addPerson(r.Creator,"Creator"),Y.addPeople(r.Mentionees,"Mentioned"),n):r instanceof un?(Y.addPerson(r.Creator,"Creator"),Y.addPerson(r.LatestReactor,"LatestReactor"),Y.addPeople(r.TargetActors,"TargetActor"),n):r instanceof ln?(Y.addPerson(r.Creator,"Creator"),Y.addPeople(r.Actors,"Actor"),n):n}},{key:"processCommentPreview",value:function(t){if(P(t))if(e.processPreviewFragment(t.Anchor,"AnchorCreator"),t instanceof Hr){if(e.processPreviewFragment(t.Comment,"CommentCreator","InThread"),e.processPreviewFragment(t.RootComment,"RepliedTo","InThread"),P(t.RecentComments)){var r,n=(0,Z.Z)(t.RecentComments);try{for(n.s();!(r=n.n()).done;){var i=r.value;e.processPreviewFragment(i,"InThread")}}catch(o){n.e(o)}finally{n.f()}}}else e.processPreviewFragment(t.Comment,"CommentCreator")}},{key:"processPreviewFragment",value:function(e){if(P(e)){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];Y.addPerson.apply(Y,[e.Creator].concat(r))}}}]),e}(),ye=function(){function e(){(0,a.Z)(this,e)}return(0,u.Z)(e,null,[{key:"convertToArray",value:function(e,t){if(P(t)){var r,n=[],i=(0,Z.Z)(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;P(o)&&n.push(o.RevisionID)}}catch(a){i.e(a)}finally{i.f()}return n}return null}}]),e}(),me=function(){function e(){(0,a.Z)(this,e)}return(0,u.Z)(e,null,[{key:"convertTo",value:function(e,t){if(t instanceof _r&&P(t.Data)){var r="Office"+Pe(t.Data);return t.Data instanceof Lr?r+wr(t.Data.Action,0):r}return Pe(t)}}]),e}(),Ze=function(){function e(){(0,a.Z)(this,e)}return(0,u.Z)(e,null,[{key:"convertTo",value:function(e,t){return t instanceof _r&&P(t.Data)&&P(t.Data.SourceAppId)?t.Data.SourceAppId.toString():P(t.SourceAppId)?t.SourceAppId.toString():"3d9f2b8c-fab8-4011-a098-2652bdd0b55d"}}]),e}(),ge=function(){function e(){(0,a.Z)(this,e)}return(0,u.Z)(e,null,[{key:"convertTo",value:function(e,t){switch(t.SourcePlatform){case Pr.Win32:case Pr.WinRT:case Pr.Windows:return hr.Windows;case Pr.Android:return hr.Android;case Pr.Mac:return hr.MacOS;case Pr.iOS:return hr.iOS;case Pr.Linux:return hr.Linux;case Pr.tvOS:return hr.tvOS;default:return hr.Unknown}}}]),e}(),Ie=function(){function e(){(0,a.Z)(this,e)}return(0,u.Z)(e,null,[{key:"convertTo",value:function(e,t){var r;if(!P(t)||!P(t.Creator)||!P(t.Creator.RawId)&&t.Creator.RawIdKind!=Tr.Self)return null;var n=new mr,i=t.Creator.RawProvider==Sr.LiveId,o=null!==(r=t.Creator.RawId)&&void 0!==r?r:"";return n.IdKind=i?dr.MSA:dr.AAD,n.TenantId=t.Creator.TenantId,P(t.Creator.RawIdKind)?t.Creator.RawIdKind==Tr.OID?n.Id=i?"OID:"+o:o:t.Creator.RawIdKind==Tr.PUID?n.Id=i?o:"PUID:"+o:t.Creator.RawIdKind==Tr.CID?n.Id="CID:"+o:n.Id="Self":n.Id=i?"CID:"+o:o,n}}]),e}(),Ce=function(){function e(){(0,a.Z)(this,e)}return(0,u.Z)(e,null,[{key:"convertTo",value:function(e,t){return t.TypeClassification}}]),e}();function Pe(e){var t=e.TypeName,r="",n=t.lastIndexOf(".");return n>=0&&(r=t.substring(0,n),t=t.substring(n+1)),"Common"===r?t:r+t}var Ae="Name",ke="Email",we="Provider",Se="PictureUrl",xe="Roles",Te="User",be="Unknown",Ne="File",Ee="Windows",Re="Android",Me="Linux",De="tvOS",Oe="IdKind",Ue="TenantId",Le="DriveId",Fe="DriveItemId",je="SiteUrl",_e="SiteId",qe="WebId",Be="ListId",Ge="ItemId",We="Unspecified",Ve="Count",Je="CustomerContent",He="EUII",ze="Completed",Ke="InProgress",Xe="RawProvider",Qe="RawId",$e="RawIdKind",Ye="Created",et="Observed",tt="SourceApp",rt="SourcePlatform",nt="SourceSessionId",it="Timestamp",ot="ActivitySource",at="Creator",ut="CustomProperties",st="Application",ct="AppName",lt="SourceAppVersion",dt="Device",ft="SourceAppContext",vt="NotifiedInBand",pt="SuppressSendToSubstrate",ht="ContentId",yt="Data",mt="NavigationId",Zt="Action",gt="StartTime",It="EndTime",Ct="Status",Pt="Locale",At="Item",kt="NotStarted",wt="Title",St="DueDate",xt="Priority",Tt="Content",bt="Common.PreviewOptions",Nt="Anchor",Et="Comment",Rt="ThreadId",Mt="CommentThreadId",Dt="Options",Ot="Common.CommentPreview",Ut="ThreadLength",Lt="RootComment",Ft="RecentComments",jt="Revisions",_t="CommentThreadIsTask",qt="CommentPreview",Bt="Preview",Gt="CommentPreviewAbsenceReason",Wt="PreviewAbsenceReason",Vt="TaskCreatedDate",Jt="Updates",Ht="LatestEmoji",zt="EmojiCounts",Kt="LatestReaction",Xt="ReactionCounts",Qt="TargetId",$t="TargetPreview",Yt="TotalReactorCount",er="NudgeEmoji",tr="MessagePreview",rr="State",nr="StatusLabel",ir="PreviousState",or="ActivityCompliance",ar=Object.assign,ur=0,sr=2,cr=3,lr=function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.call(this)).TypeName="Unified.Person",e}return(0,u.Z)(r,[{key:I,value:function(e,t){(0,p.Z)((0,h.Z)(r.prototype),I,this).call(this,e,t);var n=V(t);n!==ur&&1!==n||(K(e,"Id",null,x(this.Id,t)),K(e,Ae,null,x(this[Ae],t)),K(e,ke,null,x(this[ke],t)),K(e,we,null,x(this[we],t)),K(e,Se,null,x(this[Se],t)),K(e,xe,null,x(this[xe],t)))}}]),r}(X),dr=(function(e){var t=j(2),r=_(e)}((ee={},(0,v.Z)(ee,Te,0),(0,v.Z)(ee,"System",1),ee)),{AAD:0,MSA:1}),fr=function(e){var t=j(2),r=_(e);return function(e,n){return q(e,t,r,n)}}(dr),vr=(te={},(0,v.Z)(te,be,0),(0,v.Z)(te,"EXO",1),(0,v.Z)(te,"SPO",2),(0,v.Z)(te,"OXO",3),(0,v.Z)(te,"MileIQ",4),(0,v.Z)(te,"AFS",5),(0,v.Z)(te,"Teams",6),(0,v.Z)(te,"Stream",7),(0,v.Z)(te,"ODB",8),(0,v.Z)(te,"MicrosoftPowerBI",9),(0,v.Z)(te,"Yammer",10),te),pr=function(e){var t=j(11),r=_(e);return function(e,n){return q(e,t,r,n)}}(vr),hr=(function(e){var t=j(4),r=_(e)}((re={},(0,v.Z)(re,be,0),(0,v.Z)(re,"Message",1),(0,v.Z)(re,Ne,2),(0,v.Z)(re,"Calendar",3),re)),ne={},(0,v.Z)(ne,be,0),(0,v.Z)(ne,Ee,1),(0,v.Z)(ne,Re,2),(0,v.Z)(ne,"iOS",3),(0,v.Z)(ne,"MacOS",4),(0,v.Z)(ne,Me,5),(0,v.Z)(ne,De,6),ne),yr=function(e){var t=j(7),r=_(e);return function(e,n){return q(e,t,r,n)}}(hr),mr=function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.call(this)).TypeName="SIGS.Actor",e[Oe]=0,e}return(0,u.Z)(r,[{key:I,value:function(e,t){(0,p.Z)((0,h.Z)(r.prototype),I,this).call(this,e,t);var n=V(t);n!==sr&&n!==cr||(K(e,"ActorIdType",null,fr(this[Oe],t)),K(e,"ActorId",null,x(this.Id,t)),K(e,"AadTenantId",null,x(this[Ue],t)),K(e,"ActorType",null,x(Te,t)))}}]),r}(X),Zr=function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){return(0,a.Z)(this,r),t.apply(this,arguments)}return(0,u.Z)(r,[{key:I,value:function(e,t){(0,p.Z)((0,h.Z)(r.prototype),I,this).call(this,e,t);var n=V(t);n!==sr&&n!==cr||K(e,"Url",null,x(this.Url,t))}}]),r}(X),gr=function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.call(this)).TypeName="SIGS.SharePointDocumentInfo",e}return(0,u.Z)(r,[{key:I,value:function(e,t){(0,p.Z)((0,h.Z)(r.prototype),I,this).call(this,e,t);var n=V(t);n!==sr&&n!==cr||(K(e,je,null,x(this[je],t)),K(e,Ue,null,E(this[Ue],t)),K(e,_e,null,E(this[_e],t)),K(e,qe,null,E(this[qe],t)),K(e,Be,null,E(this[Be],t)),K(e,Ge,null,E(this[Ge],t)))}}]),r}(function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.call(this)).TypeName="SIGS.GraphDocumentInfo",e}return(0,u.Z)(r,[{key:I,value:function(e,t){(0,p.Z)((0,h.Z)(r.prototype),I,this).call(this,e,t);var n=V(t);n!==sr&&n!==cr||(K(e,Le,null,x(this[Le],t)),K(e,Fe,null,x(this[Fe],t)))}}]),r}(Zr)),Ir=(ie={},(0,v.Z)(ie,be,0),(0,v.Z)(ie,"Word",1),(0,v.Z)(ie,"Excel",2),(0,v.Z)(ie,"PowerPoint",3),(0,v.Z)(ie,"Outlook",4),(0,v.Z)(ie,"OneNote",5),(0,v.Z)(ie,"FluidApp",6),(0,v.Z)(ie,"Visio",7),(0,v.Z)(ie,"Planner",8),(0,v.Z)(ie,"Whiteboard",9),ie),Cr=function(e){var t=j(10),r=_(e);return function(e,n){return q(e,t,r,n)}}(Ir),Pr=(oe={},(0,v.Z)(oe,be,0),(0,v.Z)(oe,"Win32",1),(0,v.Z)(oe,"WinRT",2),(0,v.Z)(oe,Re,3),(0,v.Z)(oe,"Mac",4),(0,v.Z)(oe,"iOS",5),(0,v.Z)(oe,"Web",6),(0,v.Z)(oe,"Server",7),(0,v.Z)(oe,Ee,8),(0,v.Z)(oe,Me,9),(0,v.Z)(oe,De,10),oe),Ar=function(e){var t=j(11),r=_(e);return function(e,n){return q(e,t,r,n)}}(Pr),kr=(function(e){var t=j(3),r=_(e)}((ae={},(0,v.Z)(ae,We,0),(0,v.Z)(ae,"EditSession",1),(0,v.Z)(ae,"PreExisting",2),ae)),{Create:0,Update:1,Delete:2}),wr=function(e){var t=j(3),r=_(e);return function(e,n){return q(e,t,r,n)}}(kr),Sr=(ue={},(0,v.Z)(ue,be,0),(0,v.Z)(ue,"LiveId",1),(0,v.Z)(ue,"OrgId",2),(0,v.Z)(ue,"ActiveDirectory",3),(0,v.Z)(ue,"ADAL",4),(0,v.Z)(ue,"SSPI",5),(0,v.Z)(ue,"OAuth2",6),(0,v.Z)(ue,"Badger",7),(0,v.Z)(ue,Ve,8),ue),xr=function(e){var t=j(9),r=_(e);return function(e,n){return q(e,t,r,n)}}(Sr),Tr={OID:0,PUID:1,CID:2,Self:3},br=function(e){var t=j(4),r=_(e);return function(e,n){return q(e,t,r,n)}}(Tr),Nr=function(e){var t=j(12),r=_(e),n=[[r[0],"AccessControl",r[2],r[3],r[4],r[5],r[6],r[7],r[8],"SystemMetaData",r[10],r[11]]],i=new Map([[sr,n[0]],[cr,n[0]]]),o=function(e){return 4&e?function(e){var t;return null!==(t=i.get(e))&&void 0!==t?t:r}(V(e)):r};return function(e,r){return q(e,t,o(r),r)}}((se={},(0,v.Z)(se,We,0),(0,v.Z)(se,"AccessControlData",1),(0,v.Z)(se,Je,2),(0,v.Z)(se,He,3),(0,v.Z)(se,"SupportData",4),(0,v.Z)(se,"AccountData",5),(0,v.Z)(se,"PublicPersonalData",6),(0,v.Z)(se,"EUPI",7),(0,v.Z)(se,"OII",8),(0,v.Z)(se,"SystemMetadata",9),(0,v.Z)(se,"PublicNonPersonalData",10),(0,v.Z)(se,Ve,11),se)),Er=function(e){var t=j(3),r=_(e);return function(e,n){return q(e,t,r,n)}}((ce={},(0,v.Z)(ce,ze,0),(0,v.Z)(ce,Ke,1),(0,v.Z)(ce,"CompletedMissingStart",2),ce)),Rr=function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.call(this)).TypeName="Base.UserInfo",e}return(0,u.Z)(r,[{key:I,value:function(e,t){(0,p.Z)((0,h.Z)(r.prototype),I,this).call(this,e,t);var n=V(t);n!==sr&&n!==cr||(K(e,"Id",null,x(this.Id,t)),K(e,Ae,null,x(this[Ae],t)),K(e,ke,null,x(this[ke],t)),K(e,we,null,x(this[we],t)),K(e,Ue,null,x(this[Ue],t)),K(e,Xe,null,xr(this[Xe],t)),K(e,Qe,null,x(this[Qe],t)),K(e,$e,null,br(this[$e],t)))}}]),r}(X),Mr=function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){var e,n;return(0,a.Z)(this,r),n=t.call(this),ar((0,f.Z)(n),(e={Id:R},(0,v.Z)(e,Ye,b),(0,v.Z)(e,"Finalized",b),(0,v.Z)(e,et,b),(0,v.Z)(e,tt,0),(0,v.Z)(e,rt,0),(0,v.Z)(e,nt,R),e)),n}return(0,u.Z)(r,[{key:I,value:function(e,t){(0,p.Z)((0,h.Z)(r.prototype),I,this).call(this,e,t);var n=V(t);n!==ur&&1!==n||(K(e,"Id",null,E(this.Id,t)),K(e,it,null,T(this[Ye],t)),K(e,"AppSessionId",[ot],E(this[nt],t))),n===cr&&K(e,"SignalInstanceId",["PreprocessorOptions"],E(this.Id,t)),n!==sr&&n!==cr||(K(e,"ActorDetails",[ut],H(this[at],1|t)),K(e,ct,[st],Cr(this[tt],t)),K(e,"AppVer",[st],F(this[lt],t)),K(e,"Platform",[ut,"DeviceDetails"],Ar(this[rt],t)),K(e,"OsVer",[dt],F(this.SourcePlatformVersion,t)),K(e,"DeviceId",[dt],x(this.SourceDeviceId,t)),K(e,"UserAgent",[dt],x(this.SourceUserAgent,t)),K(e,"ClientIp",[dt],x(this.SourceIpAddress,t)),K(e,"Context",[ut,"ApplicationDetails"],U(this[ft],t)),K(e,vt,[ut],S(this[vt],t))),n===ur&&(K(e,"HostTimestamp",null,T(this[et],t)),K(e,ct,[ot],Cr(this[tt],t)),K(e,"AppVersion",[ot],F(this[lt],t)),K(e,"AppPlatform",[ot],Ar(this[rt],t)),K(e,"AppContext",[ot],U(this[ft],t)),K(e,vt,null,S(this[vt],t)))}}]),r}(Q),Dr=function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){return(0,a.Z)(this,r),t.apply(this,arguments)}return(0,u.Z)(r,[{key:I,value:function(e,t){(0,p.Z)((0,h.Z)(r.prototype),I,this).call(this,e,t);var n=V(t);n===ur&&K(e,pt,null,S(this[pt],t)),n!==ur&&1!==n||(K(e,"Type",null,x($.convertTo({},this),t)),K(e,"People",null,H(he.convertToArray({},this),1|t)))}}]),r}(Mr),Or=function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){return(0,a.Z)(this,r),t.apply(this,arguments)}return(0,u.Z)(r)}(Dr),Ur=function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.call(this)).ContentOrigin=0,e}return(0,u.Z)(r,[{key:I,value:function(e,t){(0,p.Z)((0,h.Z)(r.prototype),I,this).call(this,e,t);var n=V(t);n!==ur&&1!==n||(K(e,ht,[yt],x(this[ht],t)),K(e,mt,[yt],x(this[mt],t)))}}]),r}(Or),Lr=function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.call(this))[Zt]=0,e}return(0,u.Z)(r,[{key:I,value:function(e,t){(0,p.Z)((0,h.Z)(r.prototype),I,this).call(this,e,t);var n=V(t);n!==ur&&1!==n||K(e,"ContentAction",[yt],wr(this[Zt],t))}}]),r}(Ur),Fr=function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){return(0,a.Z)(this,r),t.apply(this,arguments)}return(0,u.Z)(r)}(Lr),jr=function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.call(this))[gt]=b,e[It]=b,e}return(0,u.Z)(r,[{key:I,value:function(e,t){(0,p.Z)((0,h.Z)(r.prototype),I,this).call(this,e,t);var n=V(t);n!==sr&&n!==cr||(K(e,gt,null,T(this[gt],t)),K(e,It,null,T(this[It],t)),K(e,Ct,null,Er(this[Ct],t)),K(e,"CV",null,x(this.CorrelationVector,t)),K(e,Pt,null,x(this[Pt],t)),K(e,"Workload",[st],pr(this.AppWorkload,t)),K(e,Ge,[At],x(this[Ge],t)),K(e,"ContainerType",[At],x(this.ItemContainerKind,t)),K(e,"ContainerId",[At],x(this.ItemContainerId,t)),K(e,"ContainerTypeId",[ut],x(this.CustomContainerTypeId,t)),K(e,"SignalType",null,x(me.convertTo({},this),t)),K(e,"Actor",null,H(Ie.convertTo({},this),1|t)),K(e,"Os",[dt],yr(ge.convertTo({DefaultValue:0},this),t)),K(e,"Compliance",null,Nr(Ce.convertTo({DefaultValue:0},this),t)),K(e,"AadAppId",[st],x(Ze.convertTo({},this),t)),K(e,"ItemType",[At],x(Ne,t)))}}]),r}(Mr),_r=function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){return(0,a.Z)(this,r),t.apply(this,arguments)}return(0,u.Z)(r,[{key:I,value:function(e,t){(0,p.Z)((0,h.Z)(r.prototype),I,this).call(this,e,t);var n=V(t);n!==sr&&n!==cr||(K(e,"FileDetails",[ut],z(this.DocumentInfo,-2&t,"SIGS.DocumentInfo")),K(e,"ActivityDetails",[ut],z(this[yt],-2&W(1,t),"Base.NormalActivity")))}}]),r}(jr),qr={UnsupportedClient:0,ProtectedDocument:1,Unnecessary:2},Br=function(e){var t=j(3),r=_(e),n=[["Unsupported_Client","Encrypted","NotNeeded"]],i=new Map([[ur,n[0]],[1,n[0]]]),o=function(e){return 4&e?function(e){var t;return null!==(t=i.get(e))&&void 0!==t?t:r}(V(e)):r};return function(e,r){return q(e,t,o(r),r)}}(qr),Gr=function(e){var t=j(3),r=_(e);return function(e,n){return q(e,t,r,n)}}((le={},(0,v.Z)(le,kt,0),(0,v.Z)(le,Ke,1),(0,v.Z)(le,ze,2),le)),Wr=function(e){var t=j(4),r=_(e);return function(e,n){return q(e,t,r,n)}}({Urgent:0,Important:1,Medium:2,Low:3}),Vr=function(e){var t=function(e){for(var t=[],r=0;r<e;++r)t.push(1<<r);return t}(5),r=function(e){return Object.keys(e).filter((function(e){return"None"!==e})).sort((function(t,r){return e[t]-e[r]}))}(e);return function(e,n){return B(e,t,r,n)}}((de={None:0,Assignees:1},(0,v.Z)(de,wt,2),(0,v.Z)(de,St,4),(0,v.Z)(de,Ct,8),(0,v.Z)(de,xt,16),de)),Jr=function(e){var t=j(1),r=_(e);return function(e,n){return q(e,t,r,n)}}({Like:0}),Hr=(function(e){var t=j(3),r=_(e)}((fe={},(0,v.Z)(fe,be,0),(0,v.Z)(fe,"Local",1),(0,v.Z)(fe,"Sharepoint",2),fe)),function(e){var t=j(4),r=_(e)}((ve={},(0,v.Z)(ve,be,0),(0,v.Z)(ve,"ReuseFile",1),(0,v.Z)(ve,"SmartLookup",2),(0,v.Z)(ve,"TellMe",3),ve)),function(e){var t=j(4),r=_(e)}({Slide:0,Table:1,Image:2,Other:3}),function(e){var t=j(6),r=_(e)}((pe={},(0,v.Z)(pe,kt,0),(0,v.Z)(pe,Ke,1),(0,v.Z)(pe,"ReadyForReview",2),(0,v.Z)(pe,ze,3),(0,v.Z)(pe,"Blocked",4),(0,v.Z)(pe,"Custom",5),pe)),function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.call(this)).TypeName="Common.CommentReplyPreview",e[Ut]=0,e}return(0,u.Z)(r,[{key:I,value:function(e,t){(0,p.Z)((0,h.Z)(r.prototype),I,this).call(this,e,t);var n=V(t);n!==ur&&1!==n||(K(e,Lt,null,H(this[Lt],1|t)),K(e,Ft,null,H(this[Ft],1|t)),K(e,"ThreadCommentCount",null,k(this[Ut],t)))}}]),r}(function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.call(this)).TypeName=Ot,e}return(0,u.Z)(r,[{key:I,value:function(e,t){(0,p.Z)((0,h.Z)(r.prototype),I,this).call(this,e,t);var n=V(t);n!==ur&&1!==n||(K(e,"LocationText",null,x(this.Location,t)),K(e,Nt,null,H(this[Nt],1|t)),K(e,Et,null,H(this[Et],1|t)),K(e,Mt,null,x(this[Rt],t)),K(e,Dt,null,z(this[Dt],-2&t,bt)))}}]),r}(X))),zr=function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.call(this)).TypeName="Common.RevisionSet",e.TypeClassification=3,e}return(0,u.Z)(r,[{key:I,value:function(e,t){(0,p.Z)((0,h.Z)(r.prototype),I,this).call(this,e,t);var n=V(t);n!==ur&&1!==n||K(e,jt,[yt],x(ye.convertToArray({},this[jt]),t))}}]),r}(Or),Kr=function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.call(this)).TypeName="Common.Mention",e}return(0,u.Z)(r,[{key:I,value:function(e,t){(0,p.Z)((0,h.Z)(r.prototype),I,this).call(this,e,t);var n=V(t);n!==ur&&1!==n||(K(e,"ParentContentId",[yt],x(this.CommentContentId,t)),K(e,Mt,[yt],x(this[Mt],t)),K(e,_t,[yt],S(this[_t],t)),K(e,Bt,null,z(this[qt],-2&t,Ot)),K(e,Wt,[yt],Br(this[Gt],t)))}}]),r}(Fr),Xr=function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.call(this)).TypeName="Common.Comment",e}return(0,u.Z)(r,[{key:I,value:function(e,t){(0,p.Z)((0,h.Z)(r.prototype),I,this).call(this,e,t);var n=V(t);n!==ur&&1!==n||(K(e,Mt,[yt],x(this[Rt],t)),K(e,_t,[yt],S(this.ThreadIsTask,t)),K(e,Bt,null,z(this[Bt],-2&t,Ot)),K(e,Wt,[yt],Br(this[Wt],t)))}}]),r}(Lr),Qr=function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.call(this)).TypeName="Common.CommentReply",e}return(0,u.Z)(r)}(Xr),$r=function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){return(0,a.Z)(this,r),t.apply(this,arguments)}return(0,u.Z)(r,[{key:I,value:function(e,t){(0,p.Z)((0,h.Z)(r.prototype),I,this).call(this,e,t);var n=V(t);n!==ur&&1!==n||(K(e,Mt,[yt],x(this[Mt],t)),K(e,mt,[yt],x(this[mt],t)),K(e,Bt,null,z(this[qt],-2&t,Ot)),K(e,Wt,[yt],Br(this[Gt],t)))}}]),r}(Or),Yr=function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.call(this)).TypeName="Common.TaskCreation",e}return(0,u.Z)(r)}($r),en=function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){return(0,a.Z)(this,r),t.apply(this,arguments)}return(0,u.Z)(r)}($r),tn=function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.call(this)).TypeName="Common.TaskReassignment",e}return(0,u.Z)(r)}(en),rn=function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.call(this)).TypeName="Common.CanvasTask",e}return(0,u.Z)(r,[{key:I,value:function(e,t){(0,p.Z)((0,h.Z)(r.prototype),I,this).call(this,e,t);var n=V(t);n!==ur&&1!==n||(K(e,wt,[yt],x(this[wt],t)),K(e,Vt,[yt],T(this[Vt],t)),K(e,St,[yt],T(this[St],t)),K(e,Ct,[yt],Gr(this[Ct],t)),K(e,xt,[yt],Wr(this[xt],t)),K(e,Jt,[yt],Vr(this[Jt],t)))}}]),r}(Lr),nn=function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){return(0,a.Z)(this,r),t.apply(this,arguments)}return(0,u.Z)(r)}(Or),on=function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){return(0,a.Z)(this,r),t.apply(this,arguments)}return(0,u.Z)(r,[{key:I,value:function(e,t){(0,p.Z)((0,h.Z)(r.prototype),I,this).call(this,e,t);var n=V(t);n!==ur&&1!==n||(K(e,Ht,[yt],x(this[Ht],t)),K(e,zt,[yt],H(this[zt],1|t)))}}]),r}(Ur),an=function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.call(this)).TypeName="Common.CommentReactionUpdate",e}return(0,u.Z)(r,[{key:I,value:function(e,t){(0,p.Z)((0,h.Z)(r.prototype),I,this).call(this,e,t);var n=V(t);n!==ur&&1!==n||(K(e,Kt,[yt],Jr(this[Kt],t)),K(e,Xt,[yt],H(this[Xt],1|t)))}}]),r}(on),un=function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.call(this)).TypeName="Common.TargetedReactionUpdate",e}return(0,u.Z)(r,[{key:I,value:function(e,t){(0,p.Z)((0,h.Z)(r.prototype),I,this).call(this,e,t);var n=V(t);n!==ur&&1!==n||(K(e,Qt,[yt],x(this[Qt],t)),K(e,$t,[yt],U(this[$t],t)),K(e,Yt,[yt],w(this[Yt],t)))}}]),r}(on),sn=function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.call(this)).TypeName="Common.Nudge",e}return(0,u.Z)(r,[{key:I,value:function(e,t){(0,p.Z)((0,h.Z)(r.prototype),I,this).call(this,e,t);var n=V(t);n!==ur&&1!==n||(K(e,er,[yt],x(this[er],t)),K(e,tr,[yt],U(this[tr],t)))}}]),r}(Lr),cn=function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.call(this)).TypeName="Common.Recap",e}return(0,u.Z)(r,[{key:I,value:function(e,t){(0,p.Z)((0,h.Z)(r.prototype),I,this).call(this,e,t);var n=V(t);n!==ur&&1!==n||K(e,Tt,["Recap"],U(this[Tt],t))}}]),r}(Lr),ln=function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.call(this)).TypeName="Common.StatusLabel",e}return(0,u.Z)(r,[{key:I,value:function(e,t){(0,p.Z)((0,h.Z)(r.prototype),I,this).call(this,e,t);var n=V(t);n!==ur&&1!==n||(K(e,rr,[nr],H(this[rr],1|t)),K(e,ir,[nr],H(this[ir],1|t)),K(e,tr,[nr],U(this[tr],t)))}}]),r}(Lr),dn=function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.call(this)).TypeName="Common.ActivitySignalWithoutContent",e.TypeClassification=3,e}return(0,u.Z)(r,[{key:I,value:function(e,t){(0,p.Z)((0,h.Z)(r.prototype),I,this).call(this,e,t);var n=V(t);n!==sr&&n!==cr||K(e,or,[ut],x(He,t))}}]),r}(_r),fn=function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.call(this)).TypeName="Common.ActivitySignalWithContent",e}return(0,u.Z)(r,[{key:I,value:function(e,t){(0,p.Z)((0,h.Z)(r.prototype),I,this).call(this,e,t);var n=V(t);n!==sr&&n!==cr||K(e,or,[ut],x(Je,t))}}]),r}(_r),vn=function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.call(this)).TypeName="Vroom.WrappedActivity",e.Id=R,e}return(0,u.Z)(r,[{key:I,value:function(e,t){(0,p.Z)((0,h.Z)(r.prototype),I,this).call(this,e,t);var n=V(t);n!==ur&&1!==n||(K(e,"Id",null,E(this.Id,t)),K(e,"activity",null,z(this.Activity,-2&t,"Base.Activity")))}}]),r}(X),pn=function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.call(this)).TypeName="Vroom.PatchStreamPayload",e}return(0,u.Z)(r,[{key:I,value:function(e,t){(0,p.Z)((0,h.Z)(r.prototype),I,this).call(this,e,t);var n=V(t);n!==ur&&1!==n||K(e,"value",null,H(this.Activities,1|t))}}]),r}(X),hn=function(e){(0,y.Z)(r,e);var t=(0,m.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.call(this)).TypeName="Transport.PreprocessorPayload",e}return(0,u.Z)(r,[{key:I,value:function(e,t){(0,p.Z)((0,h.Z)(r.prototype),I,this).call(this,e,t);var n=V(t);n!==sr&&n!==cr||K(e,"activities",null,z(this.Signals,-2&t,"Base.ActivitySignal"))}}]),r}(X);!function(e){var t=j(11),r=_(e)}((0,v.Z)({Success:0,UnknownError:1,BadRequest:2,AccessDenied:3,SignalTypeNotFound:4,SignalAlreadyExists:5,Disabled:6,InternalError:7,Throttled:8,ServiceUnavailable:9},be,10));function yn(e,t){this.v=e,this.k=t}function mn(e){return new yn(e,0)}function Zn(e){var t,r;function n(t,r){try{var o=e[t](r),a=o.value,u=a instanceof yn;Promise.resolve(u?a.v:a).then((function(r){if(u){var s="return"===t?"return":"next";if(!a.k||r.done)return n(s,r);r=e[s](r).value}i(o.done?"return":"normal",r)}),(function(e){n("throw",e)}))}catch(s){i("throw",s)}}function i(e,i){switch(e){case"return":t.resolve({value:i,done:!0});break;case"throw":t.reject(i);break;default:t.resolve({value:i,done:!1})}(t=t.next)?n(t.key,t.arg):r=null}this._invoke=function(e,i){return new Promise((function(o,a){var u={key:e,arg:i,resolve:o,reject:a,next:null};r?r=r.next=u:(t=r=u,n(e,i))}))},"function"!=typeof e.return&&(this.return=void 0)}function gn(e){var t,r,n,i=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);i--;){if(r&&null!=(t=e[r]))return t.call(e);if(n&&null!=(t=e[n]))return new In(t.call(e));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function In(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return In=function(e){this.s=e,this.n=e.next},In.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var r=this.s.return;return void 0===r?Promise.resolve({value:e,done:!0}):t(r.apply(this.s,arguments))},throw:function(e){var r=this.s.return;return void 0===r?Promise.reject(e):t(r.apply(this.s,arguments))}},new In(e)}Zn.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},Zn.prototype.next=function(e){return this._invoke("next",e)},Zn.prototype.throw=function(e){return this._invoke("throw",e)},Zn.prototype.return=function(e){return this._invoke("return",e)};var Cn=function(){function e(t,r,u){var s=this;if((0,a.Z)(this,e),this.namespace=t,this.disposable={get Disposable(){return this},dispose:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.logger=null;case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},r instanceof e){var c=(0,n.Z)((0,n.Z)({},r.persistedProperties),u);this.logger=r.logger,this.persistedProperties=c}else this.logger=r,this.persistedProperties=u}return(0,u.Z)(e,[{key:"NamespaceLogger",get:function(){return this}},{key:"PersistedProperties",get:function(){return this}},{key:"Disposable",get:function(){return this.disposable}},{key:"addPersistedProperties",value:function(e){this.persistedProperties=(0,n.Z)((0,n.Z)({},this.persistedProperties),e)}},{key:"send",value:function(e){this.sendWithNamespace(e,this.namespace)}},{key:"sendWithNamespace",value:function(e,t){var r;null===(r=this.logger)||void 0===r||r.sendWithNamespace((0,n.Z)((0,n.Z)({},this.persistedProperties),e),t)}},{key:"dispose",value:function(){this.logger=null}}]),e}();function Pn(e){var t=window.btoa(e);return t.replace(/(\+|\/|\=)/g,(function(e){if("+"===e)return"-";if("/"===e)return"_";if("="===e)return"";throw new TypeError("Unexpected match ".concat(e," encountered in urlEncodeBase64String. Only +/= are to be replaced."))}))}function An(e){return new URL(e).origin}function kn(e,t,r){e.headers instanceof Headers?e.headers.set(t,r):e.headers=(0,n.Z)((0,n.Z)({},e.headers),{},(0,v.Z)({},t,r))}var wn,Sn,xn="Bearer";function Tn(e,t,r,i){var o=!1,a=new URL(e);i.queryParam&&(a.searchParams.set(i.queryParam,r),(o=!i.doNotExceedQueryParamsLength||a.search.length<=i.doNotExceedQueryParamsLength)||a.searchParams.delete(i.queryParam));var u=t;if(!o){u=(0,n.Z)({},t);var c=!1,l=null!==t&&void 0!==t&&t.method?t.method.toUpperCase():"GET";if(i.preferAuthorizationInMultipartFormBody&&["GET","POST"].includes(l)){u.method="POST";var d=(0,s.Z)(),f=[];f.push("--".concat(d)),f.push("Authorization: ".concat(i.scheme," ").concat(r)),f.push("X-HTTP-Method-Override: ".concat(l)),f.push("_post: 1"),null!==t&&void 0!==t&&t.body&&f.push("\r\n".concat(t.body,"\r\n")),f.push("\r\n--".concat(d,"--"));var v=f.join("\r\n");(c=!i.doNotExceedMultipartFormBodyLength||v.length<=i.doNotExceedMultipartFormBodyLength)&&(u.body=v,kn(u,"Content-Type","multipart/form-data;boundary=".concat(d)),a.searchParams.set("ump","1"))}c||(i.scheme?kn(u,"Authorization","".concat(i.scheme," ").concat(r)):kn(u,"Authorization",r))}return{url:a.href,request:u}}!function(e){e.Generic="Generic",e.Error="Error",e.UserAction="UserAction",e.Activity="Activity"}(wn||(wn={})),function(e){e.Success="Success",e.Failure="Failure",e.Cancelled="Cancelled"}(Sn||(Sn={}));var bn=["facetCodes","statusCode","innerMostErrorCode","sprequestguid"];function Nn(e){var t=/[A-Z0-9._%`'+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}/gi;return Object.getOwnPropertyNames(e).map((function(r){if(-1!==r.toLowerCase().indexOf("message")||-1!==r.toLowerCase().indexOf("error")||-1!==r.toLowerCase().indexOf("stack")||!1!==bn.includes(r)){var n=e[r];if(void 0!==n&&"string"===typeof n)n=n.toString().replace(t,"scrubbed_email"),e[r]=n.toString().replace(/(https:\/\/)(\w)+(.sharepoint.com|-my.sharepoint.com|.sharepoint-df.com)/,"(redacted)").replace(/(https:\/\/)(dev.loop.microsoft.com|df.loop.microsoft.com|loop.microsoft.com)(\/p\/)([a-zA-Z0-9%]+)/,"(redacted)")}})),e}function En(e,t){var r=Nn(t);e.send((0,n.Z)((0,n.Z)({},r),{},{category:wn.Generic}))}function Rn(e,t,r){r&&Mn(t,r);var i=Nn(t);e.send((0,n.Z)((0,n.Z)({},i),{},{category:wn.Error}))}new Set,new Set,new Map([["Automation",1],["SyntheticTraffic",1],["Local",1],["Staging",1],["Dogfood",.1],["Preview",.1],["Microsoft",.01],["Production",.001],["GCC",0],["GCC-High",0],["DoD",0]]);function Mn(e,t){!function(e,t){var r,n="object"===typeof e&&null!==e;function i(t){if(n){var r=e[t];return"string"===typeof r?r:void 0}}t.errorMessage=null!==(r=i("message"))&&void 0!==r?r:String(e),t.errorName=i("name"),t.stack=i("stack"),t.errorType=i("errorType"),t.errorInstanceId=i("errorInstanceId"),bn.forEach((function(r){var n=e[r];n&&(t[r]="object"===typeof n?JSON.stringify(n):n)}))}(t,e),e.message?e.message="".concat(e.message,"\n").concat(e.errorMessage):e.message=e.errorMessage,void 0===e.stack&&(e.stack=Dn())}function Dn(){var e=(new Error).stack;if(!e)try{throw new Error}catch(t){e=t.stack}return e}function On(e){return new Promise((function(t){return setTimeout((function(){return t()}),e)}))}function Un(e){return function(){return e}}function Ln(e,t,r){return Fn(e,[],t,r)}function Fn(e,t,r,n){var i,o=[e(t.length).then((function(e){return i=e,!1}))];return n&&n.timeoutMs>0&&o.push(On(n.timeoutMs).then((function(){return!0}))),Promise.race(o).then((function(o){return o&&(i=n.onTimeout()),null===r||void 0===r||!r.filter(i)||t.length>=r.maxRetries?{result:i,tries:t}:On(r.backoffFn(t.length,i)).then((function(){return t.push(i),Fn(e,t,r,n)}))}))}var jn=709,_n=710;function qn(e){return function(t){return t&&e.includes(t.status)}}function Bn(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=r;return null!==r&&void 0!==r&&r.respectRetryAfterHeader&&((o=(0,n.Z)({},r)).backoffFn=function(e,t){if(429===t.status||503===t.status){var n=t.headers.get("Retry-After");if(n){var i=parseInt(n,10);if(!isNaN(i))return 1e3*i}}return r.backoffFn(e,t)}),Ln((function(){var r=performance.now();return fetch(e,t).then((function(e){var t=e;return t.durationMs=Math.round(performance.now()-r),t})).catch((function(e){if(function(e,t){return e===(null===t||void 0===t?void 0:t.reason)||"object"===typeof e&&null!==e&&("AbortError"===e.name||20===e.code)}(e,null===t||void 0===t?void 0:t.signal))throw e;var n="Error does not provide a message";return e.name&&e.message?n="Error type: ".concat(e.name,", ").concat(e.message):e.name?n="Error type: ".concat(e.name):e.message&&(n="Error message: ".concat(e.message)),{status:window.navigator.onLine?_n:jn,ok:!1,durationMs:Math.round(performance.now()-r),statusText:n,json:function(){return Promise.resolve(void 0)}}}))}),o,{timeoutMs:i,onTimeout:function(){return{status:707,ok:!1,durationMs:i}}})}function Gn(e,t,r,n,i,o){var a=arguments.length>7?arguments[7]:void 0;return Bn(e,t,o,arguments.length>6&&void 0!==arguments[6]?arguments[6]:0).then((function(e){return n&&r?((!i&&e.result.ok||!e.result.ok)&&Wn(r,!0,e.result,e.tries.length+1,n,a),e.tries.forEach((function(e,t){Wn(r,!1,e,t+1,n,a)})),e):e}))}function Wn(e,t,r,n,i,o){return Vn.apply(this,arguments)}function Vn(){return(Vn=(0,o.Z)((0,i.Z)().mark((function e(t,r,o,a,u,s){var c,l;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=s,!e.t0){e.next=5;break}return e.next=4,s(o,r);case 4:e.t0=e.sent;case 5:l=e.t0,En(u,(0,n.Z)({subCategory:"Request",eventName:t,isFinalAttempt:r,status:o.status,durationMs:o.durationMs,size:(null===(c=o.headers)||void 0===c?void 0:c.get("Content-Length"))||-1,attempt:a},l));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Jn(e,t,r){try{return JSON.parse(e,t)}catch(n){return void(r&&Rn(r.logger,r.event,n))}}function Hn(e){var t=e.get("www-authenticate");if(t){var r,n=!1;return t.split(",").map((function(e){var t=e.split("=");if(t.length>=2)if(n||"error"!==t[0].trim().toLowerCase()){if(!r&&"claims"===t[0].trim().toLowerCase()){var i=Jn(e.substring(e.indexOf("=")+1).trim());i&&(r=atob(i))}}else n="insufficient_claims"===Jn(t[1].trim().toLowerCase())})),n?r:void 0}}function zn(e){var t=e.get("www-authenticate");if(t){var r,n,i=!1,o=(0,Z.Z)(t.split(","));try{for(o.s();!(n=o.n()).done;){var a=n.value.split("=");a.length>=2&&(i||"error"!==a[0].trim().toLowerCase()?void 0===r&&"error_description"===a[0].trim().toLowerCase()&&(r=Jn(a[1].trim())):i="invalid_token"===Jn(a[1].trim().toLowerCase()))}}catch(u){o.e(u)}finally{o.f()}return i?{errorDescription:r}:void 0}}function Kn(e){var t=e.get("www-authenticate");if(t){var r,n=t.indexOf(xn);if(!(n<0))return t.substring(n+xn.length).split(",").map((function(e){if(!r){var t=e.split("=");t.length>=2&&"realm"===t[0].trim().toLowerCase()&&(r=JSON.parse(t[1].trim()))}})),r}}var Xn={scheme:xn};function Qn(e){var t;return e.tenantId&&(t={tenantId:e.tenantId}),ei(e,t)}function $n(e){var t;return e.tenantId&&(t={tenantId:e.tenantId}),ei(e,t)}var Yn=3;function ei(e,t){return ti.apply(this,arguments)}function ti(){return ti=(0,o.Z)((0,i.Z)().mark((function e(t,r){var o,a,u,s,c,l,d,f,v,p,h,y,m,Z,g,I,C,P,A,k,w,S,x=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=x.length>2&&void 0!==x[2]?x[2]:1,c=null!==(o=null===(a=t.retryPolicy)||void 0===a?void 0:a.maxAuthRetries)&&void 0!==o?o:Yn,e.next=4,t.getToken(r);case 4:if(l=e.sent.token,d=t.url,f=t.requestInit,v=t.retryPolicy,p=t.timeoutMs,h=null!==(u=t.tokenPolicy)&&void 0!==u?u:Xn,y=Tn(d,f,l,h),m=y.url,Z=y.request,g=function(e){return 401===e.status&&Hn(e.headers)||void 0},I=function(e){return 401===e.status&&void 0!==zn(e.headers)||void 0},C=function(e){if(401===e.status){var t=Kn(e.headers);if(t&&t!==(null===r||void 0===r?void 0:r.tenantId))return t}},v&&(P=(0,n.Z)((0,n.Z)({},v),{},{filter:function(e){return!g(e)&&!I(e)&&!C(e)&&v.filter(e)}})),!("logger"in t)||!("nameForLogging"in t)){e.next=18;break}return e.next=15,Gn(m,Z,t.nameForLogging,t.logger,t.doNotLogOnSuccess,P,p,t.getAdditionalProps);case 15:e.t0=e.sent,e.next=21;break;case 18:return e.next=20,Bn(m,Z,P,p);case 20:e.t0=e.sent;case 21:if(A=e.t0,!(s<=c)){e.next=35;break}if(k=s===c,!(w=g(A.result))){e.next=28;break}return ri(t,"InsufficientClaims",s,k),e.abrupt("return",ei(t,(0,n.Z)((0,n.Z)({},r),{},{claims:w,forceRefresh:!0}),s+1));case 28:if(!I(A.result)){e.next=31;break}return ri(t,"InvalidToken",s,k),e.abrupt("return",ei(t,(0,n.Z)((0,n.Z)({},r),{},{forceRefresh:!0}),s+1));case 31:if(!(S=C(A.result))){e.next=35;break}return ri(t,"SpecificTenant",s,k),e.abrupt("return",ei(t,(0,n.Z)((0,n.Z)({},r),{},{tenantId:S}),s+1));case 35:return e.abrupt("return",A);case 36:case"end":return e.stop()}}),e)}))),ti.apply(this,arguments)}function ri(e,t,r,n){"logger"in e&&"nameForLogging"in e&&En(e.logger,{eventName:"Retry".concat(e.nameForLogging,"OnAuthError"),subCategory:t,attempt:r,isFinalAttempt:n})}var ni=[{headerName:"sprequestguid",logName:"spRequestGuid"},{headerName:"request-id",logName:"requestId"},{headerName:"client-request-id",logName:"clientRequestId"},{headerName:"x-msedge-ref",logName:"xMsedgeRef"}];function ii(e){var t={};return null!==e&&void 0!==e&&e.headers&&ni.forEach((function(r){var n=e.headers.get(r.headerName);n&&(t[r.logName]=n)})),t}var oi={maxRetries:2,backoffFn:Un(500),filter:qn([408,409,429,503]),respectRetryAfterHeader:!0},ai={scheme:xn,queryParam:"access_token",doNotExceedQueryParamsLength:2048,preferAuthorizationInMultipartFormBody:!0,doNotExceedMultipartFormBodyLength:81920},ui={scheme:xn,preferAuthorizationInMultipartFormBody:!0,doNotExceedMultipartFormBodyLength:81920};function si(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r="Consumer"===e.identityType?ui:ai;return(0,n.Z)((0,n.Z)({},r),{},{preferAuthorizationInMultipartFormBody:t})}var ci=new Map;function li(e,t,r,a,u,s){var c=An(t),l="".concat(c,"_").concat(r,"_").concat(a);if(!ci.has(l)){var d=function(){var d=(0,o.Z)((0,i.Z)().mark((function d(){var f,v,p,h,y,m,Z,g;return(0,i.Z)().wrap((function(d){for(;;)switch(d.prev=d.next){case 0:return p="".concat(c,"/_api/v2.0/drives/").concat(r,"/items/").concat(a,"?select=sharepointIds"),h={getToken:function(i){var o=(0,n.Z)((0,n.Z)({},i),{},{siteUrl:t,driveId:r,itemId:a});return e.getToken(["".concat(c,"/files.readwrite.all")],o)},url:p,tenantId:s,requestInit:{method:"GET"},retryPolicy:oi,tokenPolicy:si(e)},y=u?$n((0,n.Z)((0,n.Z)({},h),{},{logger:u,nameForLogging:"GetFileSharepointIds",doNotLogOnSuccess:!0,getAdditionalProps:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t,r){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ii(t));case 1:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()})):Qn(h),d.prev=3,d.next=6,y;case 6:m=d.sent.result,d.next=11;break;case 9:d.prev=9,d.t0=d.catch(3);case 11:if(null===(f=m)||void 0===f||!f.ok){d.next=26;break}return d.prev=12,d.next=15,m.json();case 15:g=d.sent,d.next=21;break;case 18:d.prev=18,d.t1=d.catch(12),u&&Rn(u,{eventName:"GetFileSharepointIdsResponseParseError"},d.t1);case 21:if(null===(Z=g)||void 0===Z||!Z.sharepointIds){d.next=25;break}return d.abrupt("return",g.sharepointIds);case 25:u&&Rn(u,{eventName:"GetFileSharepointIdsUnexpectedResponse"},new Error("sharepointIds is missing from response body"));case 26:return 404!==(null===(v=m)||void 0===v?void 0:v.status)&&ci.delete(l),d.abrupt("return",void 0);case 28:case"end":return d.stop()}}),d,null,[[3,9],[12,18]])})));return function(){return d.apply(this,arguments)}}();ci.set(l,d())}return ci.get(l).then()}var di,fi;function vi(e,t,r){return pi.apply(this,arguments)}function pi(){return(pi=(0,o.Z)((0,i.Z)().mark((function e(t,r,n){var o,a,u,s;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=r.siteUrl,a=r.driveId,u=r.fileId,e.next=3,li(t,o,a,u,n);case 3:if(s=e.sent){e.next=6;break}throw new Error("Failed to fetch file sharepoint ids");case 6:return e.abrupt("return",hi(s,u));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function hi(e,t){var r=e.siteId,n=e.webId,i=e.listId;return"SPO_".concat(Pn("".concat(r,",").concat(n,",").concat(i)),"_").concat(t)}try{di=localStorage}catch(Uo){}di||(di=void 0);try{fi=sessionStorage}catch(Lo){}fi||(fi=void 0);var yi=new URLSearchParams("undefined"!==typeof location?location.search:""),mi=new Map;function Zi(e,t){var r=function(e,t){var r,n,i,o=mi.get(e);if(void 0!==o)return o;i=void 0!==(r=function(e){var t=yi.get(e);return gi(t)}(e))?r:void 0!==(n=function(e){var t,r=null===(t=di)||void 0===t?void 0:t.getItem(e);return gi(r)}(e))?n:t;return mi.set(e,i),i}(e,t);return r}function gi(e){if(null!==e&&void 0!==e){var t=Jn(e),r=void 0!==t?t:e;return"on"===r||"off"===r?"on"===r:r}}function Ii(e,t,r,n){return r?r.getSetting(e,t,n):Zi(e,t)}var Ci="@onedrive.errorReasonForTelemetry",Pi=0,Ai=1,ki=2,wi=(function(){for(var e=0,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(var i=0,o=r;i<o.length;i++){e|=o[i]}}(Ai,ki),Ai);function Si(e,t){var r=Ui(e,"Pipelines."+t.TypeName,function(e){if(e instanceof Fr||e instanceof zr||e instanceof $r)return wi;return ki}(t));return t instanceof Lr&&t.Action!==kr.Create?t instanceof Fr&&t.Action!==kr.Delete?Pi:function(e){for(var t=e,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];for(var o=0,a=n;o<a.length;o++)t&=~a[o];return t}(r,Ai):r}function xi(e,t,r){return Ui(e,t,r)}function Ti(e){return Li(e)&&"string"===typeof e.code&&Fi(e.message)&&ji(e[Ci])}function bi(e){return Li(e)&&Ti(e.error)}function Ni(e){return Li(e)&&"string"===typeof e.Id&&Fi(e.ServerId)&&Fi(e.Message)&&ji(e.Status)&&("undefined"===typeof e.Error||Ti(e.Error))}function Ei(e){return Li(e)&&_i(e.Status,0,"Success")&&"undefined"===typeof e.Error}function Ri(e){return Li(e)&&"string"===typeof e.Id&&ji(e.Status)}function Mi(e){return Li(e)&&_i(e.Status,0,"Success")}function Di(e,t,r,n){var i=r.siteUrl,o=r.siteId,a=r.webId,u=r.listId,c=r.listItemUniqueId,l=function(e,t){if(e){if("Enterprise"===e.tokenProvider.identityType&&e.tenantId)return"SPO:SPO_".concat(t.siteId,"@SPO_").concat(e.tenantId);if("Consumer"===e.tokenProvider.identityType)return e.rosterId}return}(e,r),d=new gr;d.SiteUrl=i,d.TenantId=null!==e&&void 0!==e&&e.tenantId?new N(e.tenantId):void 0,d.SiteId=new N(o),d.WebId=new N(a),d.ListId=new N(u),d.ItemId=new N(c);var f=function(e){if(e.TypeClassification===Oi)return new fn;return new dn}(n);return n.SignalId||(n.SignalId=new N((0,s.Z)())),f.Id=n.SignalId,f.Creator=n.Creator,f.SourceApp=n.SourceApp,f.SourceAppVersion=n.SourceAppVersion,f.SourcePlatform=n.SourcePlatform,f.SourcePlatformVersion=n.SourcePlatformVersion,f.SourceDeviceId=n.SourceDeviceId,f.SourceUserAgent=n.SourceUserAgent,f.SourceIpAddress=n.SourceIpAddress,f.SourceAppContext=n.SourceAppContext,f.NotifiedInBand=n.NotifiedInBand,f.StartTime=n.Created,f.EndTime=n.Created,f.ItemId=t,f.Data=n,f.DocumentInfo=d,f.AppWorkload=vr.SPO,f.ItemContainerId=l,f.CustomContainerTypeId=null===e||void 0===e?void 0:e.containerTypeId,f}var Oi=2;function Ui(e,t,r){return function(e,t,r){return Ii(e,t,r,"FluidExperiences")}("ActivityTransport."+t,r,null===e||void 0===e?void 0:e.settingsProvider)}function Li(e){return"object"===typeof e&&null!==e}function Fi(e){return"undefined"===typeof e||"string"===typeof e}function ji(e){return"undefined"===typeof e||"number"===typeof e||"string"===typeof e}function _i(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return"undefined"===typeof e||r.includes(e)}var qi="OutgoingActivity",Bi="ActivityResult";function Gi(e,t,r,n,i){var o=Hi(Bi,t,Si(e,t));o.TryCount=r.tries.length;var a=r.result.headers.get("SPRequestGuid");if(a&&(o.RequestId=a),o.Status=r.result.status,o.Success=!1,n){var u=function(e,t){var r=t.toLowerCase();return e.value.find((function(e){return e.Id.toLowerCase()===r}))}(n,t.Id.toString());u&&(o.Success=!u.Error&&(!u.Status||"Success"===u.Status),u.Error?o.Error=u.Error.code:o.Success||(o.Error=u.Status),u.ServerId&&(o.ServerId=u.ServerId))}else i&&(o.Error=i.error.code);return o}function Wi(e,t,r,n,i){var o,a;t instanceof _r&&P(t.Data)?(o=zi(Bi,t,Si(e,t.Data)),a=t.Data.Id):(o=Ji(Bi,t),a=t.Id),o.TryCount=r.tries.length;var u=r.result.headers.get("Request-Id");if(u&&(o.RequestId=u),o.Status=r.result.status,o.Success=!1,n){var s=function(e,t){var r=t.toLowerCase();return e.find((function(e){return e.Id.toLowerCase()===r}))}(n,a.toString());s&&(o.Success=!s.Status||"Success"===s.Status,o.Success||(o.Error=s.Status))}else i&&(o.Error=i.error.code);return o}function Vi(e,t,r){var n=Ji(Bi,e);n.TryCount=t.tries.length;var i=t.result.headers.get("Request-Id");return i&&(n.RequestId=i),n.Status=t.result.status,n.Success=t.result.ok,r&&(n.Error=r.error.code),n}function Ji(e,t){return Ki(e,t)}function Hi(e,t,r){var n=Ki(e,t);return n.Pipelines=r,n}function zi(e,t,r){var n;return P(t.Data)?(n=Hi(e,t.Data,r)).ActivitySignalId=t.Id.toString():n=Ji(e,t),n}function Ki(e,t){var r={eventName:e,category:"Generic",TypeName:t.TypeName,ActivityId:t.Id.toString(),Age:new Date(Date.now()).valueOf()-t.Created.valueOf()};return t instanceof Lr&&(r.Action=t.Action),t instanceof Xr&&(r.HasParent=t instanceof Qr&&P(t.ParentAuthor),r.HasPreview=P(t.Preview),P(t.PreviewAbsenceReason)&&(r.PreviewAbsenceReason=t.PreviewAbsenceReason)),(t instanceof Kr||t instanceof $r)&&(r.HasPreview=P(t.CommentPreview),P(t.CommentPreviewAbsenceReason)&&(r.PreviewAbsenceReason=t.CommentPreviewAbsenceReason)),r}function Xi(e,t){return Qi.apply(this,arguments)}function Qi(){return(Qi=(0,o.Z)((0,i.Z)().mark((function e(t,r){var o,a,u;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.logger?(0,n.Z)((0,n.Z)({},t),{},{logger:new Cn("ActivityTransport",t.logger)}):t,r.forEach(Co.bind(null,o)),e.next=4,Yi(o,r);case 4:return a=e.sent,e.next=7,Promise.all([lo(o,a.filter(Ao)),po(o,a.filter(ko))]);case 7:return u=e.sent,e.abrupt("return",u.every((function(e){return e})));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var $i=(0,u.Z)((function e(t,r,n){(0,a.Z)(this,e),this.provider=t,this.kind=r,this.id=n}));function Yi(e,t){return eo.apply(this,arguments)}function eo(){return(eo=(0,o.Z)((0,i.Z)().mark((function e(t,r){var n,o,a,u,s,c,l;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],o=!1,a=!1,e.prev=3,s=gn(to(t,r));case 5:return e.next=7,s.next();case 7:if(!(o=!(c=e.sent).done)){e.next=13;break}l=c.value,n.push(l);case 10:o=!1,e.next=5;break;case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(3),a=!0,u=e.t0;case 19:if(e.prev=19,e.prev=20,!o||null==s.return){e.next=24;break}return e.next=24,s.return();case 24:if(e.prev=24,!a){e.next=27;break}throw u;case 27:return e.finish(24);case 28:return e.finish(19);case 29:return e.abrupt("return",n);case 30:case"end":return e.stop()}}),e,null,[[3,15,19,29],[20,,24,28]])})))).apply(this,arguments)}function to(e,t){return ro.apply(this,arguments)}function ro(){var e;return e=(0,i.Z)().mark((function e(t,r){var n,o,a,u,s,c,l,d,f,v,p,h,y;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,mn(no(t));case 2:return n=e.sent,e.next=5,mn(oo(t));case 5:o=e.sent,a=(0,Z.Z)(r),e.prev=7,a.s();case 9:if((u=a.n()).done){e.next=34;break}if(s=u.value,!n||!ko(s)){e.next=18;break}return l=Ji(qi,s),null===(c=t.logger)||void 0===c||c.send(l),e.next=16,s;case 16:e.next=32;break;case 18:if(!Ao(s)){e.next=32;break}if(!((d=Si(t,s))&Ai)){e.next=25;break}return v=Hi(qi,s,d),null===(f=t.logger)||void 0===f||f.send(v),e.next=25,s;case 25:if(!(n&&o&&d&ki)){e.next=32;break}return h=Di(t,n,o,s),y=zi(qi,h,d),null===(p=t.logger)||void 0===p||p.send(y),e.next=31,h;case 31:s.SuppressSendToSubstrate=!0;case 32:e.next=9;break;case 34:e.next=39;break;case 36:e.prev=36,e.t0=e.catch(7),a.e(e.t0);case 39:return e.prev=39,a.f(),e.finish(39);case 42:case"end":return e.stop()}}),e,null,[[7,36,39,42]])})),ro=function(){return new Zn(e.apply(this,arguments))},ro.apply(this,arguments)}function no(e){return io.apply(this,arguments)}function io(){return(io=(0,o.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(uo(t)){e.next=2;break}return e.abrupt("return",void 0);case 2:return e.prev=2,e.next=5,vi(t.tokenProvider,t);case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",void 0);case 11:case"end":return e.stop()}}),e,null,[[2,8]])})))).apply(this,arguments)}function oo(e){return ao.apply(this,arguments)}function ao(){return(ao=(0,o.Z)((0,i.Z)().mark((function e(t){var r,n,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(uo(t)){e.next=2;break}return e.abrupt("return",void 0);case 2:return r=t.siteUrl,n=t.driveId,o=t.fileId,e.prev=3,e.next=6,li(t.tokenProvider,r,n,o);case 6:return e.abrupt("return",e.sent);case 9:return e.prev=9,e.t0=e.catch(3),e.abrupt("return",void 0);case 12:case"end":return e.stop()}}),e,null,[[3,9]])})))).apply(this,arguments)}function uo(e){var t,r,n;return!!(null!==(t=e.senderIdentity)&&void 0!==t&&t.oid||null!==(r=e.senderIdentity)&&void 0!==r&&r.puid||so(e)&&null!==(n=e.senderIdentity)&&void 0!==n&&n.cid)}function so(e){return xi(e,"EnableCidSupport",!0)}function co(e){return xi(e,"UseInstrumentedAuthorizedFetchWithRetry",!0)}function lo(e,t){return fo.apply(this,arguments)}function fo(){return(fo=(0,o.Z)((0,i.Z)().mark((function e(t,r){var o,a,u,s,c,l;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.length<1)){e.next=2;break}return e.abrupt("return",!0);case 2:if((o=new pn).Activities=r.map(Po),a=An(t.siteUrl),u="".concat(a,"/_api/v2.1/drives/").concat(t.driveId,"/items/").concat(t.fileId,"/office_activityStream"),s={getToken:function(e){var r=(0,n.Z)((0,n.Z)({},e),{},{siteUrl:t.siteUrl,driveId:t.driveId,itemId:t.fileId});return t.tokenProvider.getToken(["".concat(a,"/files.readwrite.all")],r)},url:u,tenantId:t.tenantId,requestInit:{method:"PATCH",headers:{"Content-Type":"application/json"},body:o.toFacetJson(ur)},retryPolicy:oi,tokenPolicy:si(t.tokenProvider)},!co(t)||!t.logger){e.next=13;break}return e.next=10,$n((0,n.Z)((0,n.Z)({},s),{},{logger:t.logger,nameForLogging:"SendActivitiesToHost"}));case 10:e.t0=e.sent,e.next=16;break;case 13:return e.next=15,Qn(s);case 15:e.t0=e.sent;case 16:return c=e.t0,e.next=19,c.result.json();case 19:return l=e.sent,vo(t,r,c,l),e.abrupt("return",c.result.ok&&(Li(i=l)&&Array.isArray(i.value)&&i.value.every(Ei)));case 22:case"end":return e.stop()}var i}),e)})))).apply(this,arguments)}function vo(e,t,r,n){var i,o,a=r.result.ok&&(Li(i=n)&&Array.isArray(i.value)&&i.value.every(Ni))?n:void 0,u=!r.result.ok&&bi(n)?n:void 0,s=(0,Z.Z)(t);try{for(s.s();!(o=s.n()).done;){var c,l=Gi(e,o.value,r,a,u);null===(c=e.logger)||void 0===c||c.send(l)}}catch(d){s.e(d)}finally{s.f()}}function po(e,t){return ho.apply(this,arguments)}function ho(){return(ho=(0,o.Z)((0,i.Z)().mark((function e(t,r){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.length<1)){e.next=2;break}return e.abrupt("return",!0);case 2:return e.prev=2,e.next=5,Promise.all(r.map(yo.bind(null,t)));case 5:return n=e.sent,e.abrupt("return",n.every((function(e){return e})));case 9:return e.prev=9,e.t0=e.catch(2),e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}function yo(e,t){return mo.apply(this,arguments)}function mo(){return(mo=(0,o.Z)((0,i.Z)().mark((function e(t,r){var o,a,u,s,c,l,d,f,v;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Io(r)){e.next=2;break}return e.abrupt("return",!1);case 2:if(s=go(t),(c=r instanceof _r)?(o="".concat(s,"/signalpreprocessor/v1/office"),(l=new hn).Signals=[r],a=l,u=cr):(o="".concat(s,"/api/v2.0/me/signals"),a=r,u=sr),d={getToken:function(e){return t.tokenProvider.getToken(["".concat(s,"/Signals-Internal.ReadWrite")],e)},url:o,tenantId:t.tenantId,requestInit:{method:"POST",headers:{"Content-Type":"application/json",Prefer:'exchange.behavior="SignalAccessV2,OpenComplexTypeExtensions"',"X-SignalInstanceId":r.Id.toString(),"X-AnchorMailbox":t.senderIdentity.upn},body:a.toFacetJson(u)},retryPolicy:{maxRetries:2,backoffFn:Un(500),filter:qn([429,500])}},!co(t)||!t.logger){e.next=12;break}return e.next=9,$n((0,n.Z)((0,n.Z)({},d),{},{logger:t.logger,nameForLogging:"SendSignalToSubstrate"}));case 9:e.t0=e.sent,e.next=15;break;case 12:return e.next=14,Qn(d);case 14:e.t0=e.sent;case 15:return f=e.t0,e.next=18,f.result.json();case 18:if(v=e.sent,Zo(t,[r],f,v,c),!c){e.next=22;break}return e.abrupt("return",f.result.ok&&(i=v,Array.isArray(i)&&i.every(Mi)));case 22:return e.abrupt("return",f.result.ok);case 23:case"end":return e.stop()}var i}),e)})))).apply(this,arguments)}function Zo(e,t,r,n,i){var o,a=!r.result.ok&&bi(n)?n:void 0;if(i){var u,s=r.result.ok&&(o=n,Array.isArray(o)&&o.every(Ri))?n:void 0,c=(0,Z.Z)(t);try{for(c.s();!(u=c.n()).done;){var l,d=Wi(e,u.value,r,s,a);null===(l=e.logger)||void 0===l||l.send(d)}}catch(y){c.e(y)}finally{c.f()}}else{var f,v=(0,Z.Z)(t);try{for(v.s();!(f=v.n()).done;){var p,h=Vi(f.value,r,a);null===(p=e.logger)||void 0===p||p.send(h);break}}catch(y){v.e(y)}finally{v.f()}}}function go(e){var t;switch(null===(t=e.environment)||void 0===t?void 0:t.audience){case"GCC":return"https://substrate.office365.us";case"GCC-High":case"DoD":return"https://substrate-dod.office365.us";default:return"https://substrate.office.com"}}function Io(e){return P(e.Creator)&&P(e.Creator.RawIdKind)}function Co(e,t){if(e.senderIdentity&&!t.Creator)if(so(e)){var r=function(e,t){var r=Sr.LiveId,n=Sr.ADAL,i=Tr.OID,o=Tr.PUID,a=Tr.CID,u=t.oid,s=t.puid,c=t.cid;if("Consumer"===e.identityType)return s?new $i(r,o,s):c?new $i(r,a,c):u?new $i(r,i,u):new $i(r);var l="Enterprise"===e.identityType?n:void 0;return u?new $i(l,i,u):s?new $i(l,o,s):c?new $i(l,a,c):new $i(l)}(e.tokenProvider,e.senderIdentity),n=r.provider,i=r.kind,o=r.id;t.Creator=new Rr,t.Creator.Id=o,t.Creator.Name=e.senderIdentity.name,t.Creator.Email=e.senderIdentity.upn,t.Creator.TenantId=e.senderIdentity.tenantId,t.Creator.RawProvider=n,t.Creator.RawId=t.Creator.Id,t.Creator.RawIdKind=i}else t.Creator=new Rr,t.Creator.Id=function(e){var t,r,n;if("Consumer"===e.tokenProvider.identityType&&null!==(t=e.senderIdentity)&&void 0!==t&&t.puid)return e.senderIdentity.puid;if(null!==(r=e.senderIdentity)&&void 0!==r&&r.oid)return e.senderIdentity.oid;if(null!==(n=e.senderIdentity)&&void 0!==n&&n.puid)return e.senderIdentity.puid;return}(e),t.Creator.Name=e.senderIdentity.name,t.Creator.Email=e.senderIdentity.upn,t.Creator.TenantId=e.senderIdentity.tenantId,t.Creator.RawProvider=function(e){if("Consumer"===e.tokenProvider.identityType)return Sr.LiveId;if("Enterprise"===e.tokenProvider.identityType)return Sr.ADAL;return}(e),t.Creator.RawId=t.Creator.Id,t.Creator.RawIdKind=function(e){var t,r,n;if("Consumer"===e.tokenProvider.identityType&&null!==(t=e.senderIdentity)&&void 0!==t&&t.puid)return Tr.PUID;if(null!==(r=e.senderIdentity)&&void 0!==r&&r.oid)return Tr.OID;if(null!==(n=e.senderIdentity)&&void 0!==n&&n.puid)return Tr.PUID;return}(e)}function Po(e){var t=new vn;return t.Activity=e,t.Id=e.Id,t}function Ao(e){return e instanceof Dr}function ko(e){return e instanceof jr}var wo=r(13891),So=r(75815),xo=r(66786),To=function(e,t){var r=t.siteUrl,n=t.driveId,i=t.itemId,o=new URL(r).hostname,a=e.siteUrl,u=e.driveId,s=e.itemId;return o!==new URL(a).hostname||n!==u||i!==s},bo="AppContextError",No="MissingAuthorInformation",Eo="NotificationActivityStreamError",Ro="NonODSPResolvedUrl",Mo="NotifyAtMention",Do="QueueAtMentionNotification",Oo=function(){function e(t){if((0,a.Z)(this,e),this.props=t,!this.props.fileId||!this.props.driveId||!this.props.siteUrl)throw new Error("Invalid file information: fileId, driveId or siteUrl might be missing")}return(0,u.Z)(e,[{key:"NotificationService",get:function(){return this}},{key:"notifyAtMention",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t,r,n){var o,a,u,s,c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.props,a=o.siteUrl,u=o.driveId,s=o.fileId,c={siteUrl:a,driveId:u,itemId:s,dataStorePath:r},e.abrupt("return",this.sendNotification(t,r,n,Mo,c));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"queueAtMentionNotification",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var r,o,a,u,s,l,f,v,p,h,y,m,Z,g,I,C,P,A,k,w,S;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.recipient,o=t.atMentionId,a=t.contentId,u=t.navigationPath,s=t.resolvedUrl,l=t.threadId,f=this.props,v=f.siteUrl,p=f.driveId,h=f.fileId,y=f.appName,m=f.logger,Z={itemId:h,driveId:p,siteUrl:v},g=(0,So.di)(this.props.settingsProvider)?(0,xo.t)(Z,s,m):Z,!s||!(0,d.tS)(s)){e.next=15;break}if(w={siteUrl:s.siteUrl,driveId:s.driveId,itemId:s.itemId},I=null===(P=s.codeHint)||void 0===P?void 0:P.containerPackageName,!(0,So.di)(this.props.settingsProvider)||!To(Z,w)){e.next=11;break}e.t0=void 0,e.next=14;break;case 11:return e.next=13,null===(A=(k=this.props).getFileContext)||void 0===A?void 0:A.call(k,s,a);case 13:e.t0=e.sent;case 14:C=e.t0;case 15:return S=(0,n.Z)((0,n.Z)({},g),{},{dataStorePath:a,containerPackageName:I,appName:y,context:C}),(0,So.di)(this.props.settingsProvider)&&s&&!(0,d.tS)(s)&&(S.dataStorePath="",m&&(0,c.uX)(m,{eventName:Ro})),e.abrupt("return",this.sendNotification(r.userPrincipalName,a,u,Do,S,o,l,s));case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAppContext",value:function(e){var t=void 0,r=void 0;if(e)try{t={fluidComponents:JSON.parse(e)}}catch(n){r=n}return{appContext:t,appContextError:r}}},{key:"notifyOfficeActivityStream",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t,r,o,a,u,c,l){var d,f,v,p;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d=this.props.correlationId,f=(0,So.di)(this.props.settingsProvider)?(0,n.Z)((0,n.Z)({},this.props),{},{fileId:a.itemId,driveId:a.driveId,siteUrl:a.siteUrl}):(0,n.Z)({},this.props),v=(0,wo.$)(a,{includeFluidSignature:!0}),(p=new Kr).Id=new N((0,s.Z)()),p.Created=p.Observed=new Date,p.SourceApp=Ir.FluidApp,p.SourcePlatform=Pr.Web,p.SourceSessionId=d?new N(d):R,p.SourceAppContext=u,p.ContentId=null!==c&&void 0!==c?c:r,p.NavigationId=v,p.CommentThreadId=l,p.Action=kr.Create,p.Mentionee=new Rr,p.Mentionee.Email=t,p.CommentPreviewAbsenceReason=qr.UnsupportedClient,o.addAdditionalProps({activityId:p.Id.toString(),contentId:p.ContentId}),e.next=20,Xi(f,[p]);case 20:return e.abrupt("return",e.sent);case 21:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i,o,a,u){return e.apply(this,arguments)}}()},{key:"sendNotification",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t,r,o,a,u,s,c,d){var f,v,p,h,y,m;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f=this.props.getHostAppContext,v=l.a.start("NotifyOfficeActivityStream",this.props.logger),t){e.next=5;break}return v.setResult(!1,{navigationPath:o.length>0,entryPoint:a,errorType:No}),e.abrupt("return",!1);case 5:return p=f?{appContext:f(d)}:this.getAppContext(o),h=p.appContext,y=p.appContextError,e.prev=6,e.next=9,this.notifyOfficeActivityStream(t,r,v,u,h,s,c);case 9:return m=e.sent,v.setResult(m&&!y,(0,n.Z)({appContextSent:!!h,notifyActivity:m,navigationPath:o.length>0,entryPoint:a},y&&{errorType:bo}),y),e.abrupt("return",m);case 14:return e.prev=14,e.t0=e.catch(6),v.setResult(!1,{appContextSent:!!h,notifyActivity:!1,navigationPath:o.length>0,entryPoint:a,errorType:Eo},e.t0),e.abrupt("return",!1);case 18:case"end":return e.stop()}}),e,this,[[6,14]])})));return function(t,r,n,i,o,a,u,s){return e.apply(this,arguments)}}()}]),e}()},13891:function(e,t,r){r.d(t,{$:function(){return i}});var n=r(56061);function i(e,t){var r=(0,n.mt)(e);if(t.includeFluidSignature)return r;var i=new URLSearchParams(atob(r));return i.delete("fluid"),btoa(i.toString())}},66786:function(e,t,r){r.d(t,{t:function(){return a}});var n=r(98846),i=r(24466),o="GetDocumentInfoError",a=function(e,t,r){var a;if(!t)return r&&(0,n.ve)(r,{eventName:o}),e;if(!(0,i.tS)(t)){var u=new Error("Invalid file information: ResolvedUrl is not of the expected ODSP type");return r&&(0,n.uX)(r,{eventName:o},u),e}return{driveId:t.driveId,siteUrl:t.siteUrl,itemId:t.itemId,containerPackageName:null===(a=t.codeHint)||void 0===a?void 0:a.containerPackageName}}},75815:function(e,t,r){r.d(t,{az:function(){return o},di:function(){return i},qU:function(){return a}});var n=r(29979);function i(e){return(0,n.L5)("share.isResolvedUrlUsedForLocator",!0,e)}function o(e){return(0,n.L5)("share.enterpriseEndpointEnabled",!1,e)}function a(e){return(0,n.L5)("share.crossDomainClipboardAccessEnabled",!0,e)}}}]);
//# sourceMappingURL=SharepointNotificationService.d203e7dc.chunk.js.map