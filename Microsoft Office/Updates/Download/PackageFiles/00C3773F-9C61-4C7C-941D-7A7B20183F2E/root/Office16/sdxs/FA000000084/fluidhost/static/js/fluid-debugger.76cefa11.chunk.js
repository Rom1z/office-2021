/*! For license information please see fluid-debugger.76cefa11.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[5145],{24908:function(e,t,r){r.d(t,{FE:function(){return c},Qp:function(){return p},VN:function(){return d},eB:function(){return l},sG:function(){return h}});var n=r(43144),i=r(15671),a=r(37762),s=r(24713),o=r(74847),u=r(89591);function c(e){var t=e.type===s.J.Handle?e.handleType:e.type;switch(t){case s.J.Blob:case s.J.Attachment:return"blob";case s.J.Tree:return"tree";default:(0,u.U)(t,"Unknown type: ".concat(t))}}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n={},i={id:e.sha,blobs:{},trees:{}};n[""]=i;var s,o=(0,a.Z)(e.tree);try{for(o.s();!(s=o.n()).done;){var u=s.value,c=r?u.path.replace(/^\.app\//,""):u.path,l=c.lastIndexOf("/"),p=c.slice(0,Math.max(0,l)),d=c.slice(l+1),h=n[p];if("tree"===u.type){var f={id:u.sha,blobs:{},commits:{},trees:{}};h.trees[decodeURIComponent(d)]=f,n[c]=f}else{if("blob"!==u.type)throw new Error("Unknown entry type!!");h.blobs[decodeURIComponent(d)]=u.sha,t.set(u.sha,"/".concat(c))}}}catch(m){o.e(m)}finally{o.f()}return i}var p=(0,n.Z)((function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"utf-8";(0,i.Z)(this,e),this.path=t,this.mode=o.m.File,this.type=o.S.Blob,this.value={contents:r,encoding:n}})),d=(0,n.Z)((function e(t,r){(0,i.Z)(this,e),this.path=t,this.value=r,this.mode=o.m.Directory,this.type=o.S.Tree})),h=(0,n.Z)((function e(t,r){(0,i.Z)(this,e),this.path=t,this.id=r,this.mode=o.m.File,this.type=o.S.Attachment,this.value={id:r}}))},74847:function(e,t,r){var n,i;r.d(t,{S:function(){return i},m:function(){return n}}),function(e){e.File="100644",e.Executable="100755",e.Directory="040000",e.Symlink="120000"}(n||(n={})),function(e){e.Blob="Blob",e.Tree="Tree",e.Attachment="Attachment"}(i||(i={}))},45025:function(e,t,r){r.r(t),r.d(t,{FluidDebugger:function(){return ae}});var n=r(74165),i=r(15861),a=r(15671),s=r(43144),o=r(41721),u=function(){function e(){(0,a.Z)(this,e)}return(0,s.Z)(e,[{key:"fetchMessages",value:function(e,t,r,n){return o.jC}}]),e}(),c=r(60136),l=r(29388),p=r(45108),d=r(5927),h=r(46115),f=function(){function e(){(0,a.Z)(this,e)}return(0,s.Z)(e,[{key:"uploadSummaryWithContext",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.reject(new Error("Invalid operation")));case 1:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"createBlob",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.reject(new Error("Invalid operation")));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"downloadSummary",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.reject(new Error("Invalid operation")));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"repositoryUrl",get:function(){throw new Error("Invalid operation")}}]),e}(),m=function(e){(0,c.Z)(r,e);var t=(0,l.Z)(r);function r(){return(0,a.Z)(this,r),t.apply(this,arguments)}return(0,s.Z)(r)}(f),F="documentId",y=function(e){(0,c.Z)(r,e);var t=(0,l.Z)(r);function r(e,n,i){var s;return(0,a.Z)(this,r),(s=t.call(this)).replayFrom=e,s.replayTo=n,s.unitIsTime=i,s.replayCurrent=0,!0!==i&&(s.replayTo=0),s}return(0,s.Z)(r,[{key:"initStorage",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getVersions",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",[]);case 1:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getSnapshotTree",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t?Promise.reject(new Error("Invalid operation")):null);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"readBlob",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.reject(new Error("Invalid operation")));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getStartingOpSequence",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"fetchTo",value:function(e){if(!0!==this.unitIsTime&&this.replayTo>=0)return this.replayTo}},{key:"isDoneFetch",value:function(e,t){return this.replayTo>=0?!0===this.unitIsTime?void 0!==t&&void 0!==this.firstTimeStamp&&t-this.firstTimeStamp>=this.replayTo:e>=this.replayTo:void 0===t}},{key:"skipToIndex",value:function(e){if(this.replayFrom<=0)return 0;if(!0===this.unitIsTime)for(var t=0;t<e.length;t+=1){var r=e[t].timestamp;if(void 0!==r&&(void 0===this.firstTimeStamp&&(this.firstTimeStamp=r),r-this.firstTimeStamp>=this.replayFrom))return t}else if(this.replayFrom>this.replayCurrent)return this.replayFrom-this.replayCurrent;return 0}},{key:"replay",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,i){var a,s=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.skipToIndex(i),e.abrupt("return",new Promise((function(e){var n=function(){var e=i[a],n=[e],u=r.DelayInterval;if(a+=1,!0===s.unitIsTime){var c=e.timestamp;if(void 0!==c){for(;a<i.length;){var l=i[a];if(void 0===l.timestamp)break;var p=l.timestamp-c;if(p>=r.ReplayResolution){u=p;break}if(p<0)break;n.push(l),a+=1}void 0!==s.firstTimeStamp&&s.replayTo>=0&&c+u-s.firstTimeStamp>s.replayTo&&(u=-1)}}o(u),t(n)},o=function(t){t>=0&&a<i.length?setTimeout(n,t):(s.replayCurrent+=a,e())};o(r.DelayInterval)})));case 2:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()}]),r}(m);y.DelayInterval=50,y.ReplayResolution=15;var v=function(e){(0,c.Z)(r,e);var t=(0,l.Z)(r);function r(e){var n;return(0,a.Z)(this,r),(n=t.call(this)).details=e,n.maxMessageSize=r.ReplayMaxMessageSize,n._disposed=!1,n}return(0,s.Z)(r,[{key:"clientId",get:function(){return this.details.clientId}},{key:"mode",get:function(){return this.details.mode}},{key:"claims",get:function(){return this.details.claims}},{key:"existing",get:function(){return this.details.existing}},{key:"version",get:function(){return this.details.version}},{key:"initialMessages",get:function(){return this.details.initialMessages}},{key:"initialSignals",get:function(){return this.details.initialSignals}},{key:"initialClients",get:function(){return this.details.initialClients}},{key:"serviceConfiguration",get:function(){return this.details.serviceConfiguration}},{key:"submit",value:function(e){throw new Error("ReplayDocumentDeltaConnection.submit() can't be called")}},{key:"submitSignal",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"disposed",get:function(){return this._disposed}},{key:"dispose",value:function(){this._disposed=!0}},{key:"fetchAndEmitOps",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){var a,s,o,u,c,l,p,h=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=Promise.resolve(),e.next=3,r.getStartingOpSequence();case 3:o=e.sent;case 4:u=r.fetchTo(o),c=new AbortController,l=t.fetchMessages(o+1,u,c.signal),p=(0,n.Z)().mark((function e(){var t,u;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.read();case 2:if(!(t=e.sent).done){e.next=9;break}if(a=r.isDoneFetch(o,void 0)){e.next=8;break}return e.next=8,(0,d.g)(2e3);case 8:return e.abrupt("return","break");case 9:s=s.then((0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.replay((function(e){return h.emit("op",F,e)}),u));case 1:case"end":return e.stop()}}),e)})))),u=t.value,o+=u.length,a=r.isDoneFetch(o,u[u.length-1].timestamp);case 13:case"end":return e.stop()}}),e)}));case 8:return e.delegateYield(p(),"t0",9);case 9:if("break"!==e.t0){e.next=12;break}return e.abrupt("break",13);case 12:if(!a){e.next=8;break}case 13:c.abort();case 14:if(!a){e.next=4;break}case 15:return e.abrupt("return",s);case 16:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()}],[{key:"create",value:function(e,t){var n=new r({claims:r.claims,clientId:"PseudoClientId",existing:!0,initialMessages:[],initialSignals:[],initialClients:[],maxMessageSize:r.ReplayMaxMessageSize,mode:"read",serviceConfiguration:{blockSize:64436,maxMessageSize:r.ReplayMaxMessageSize},supportedVersions:[r.replayProtocolVersion],version:r.replayProtocolVersion});return n.fetchAndEmitOps(e,t),n}}]),r}(h.L);v.replayProtocolVersion="^0.1.0",v.ReplayMaxMessageSize=16384,v.claims={documentId:F,scopes:[p.p.DocRead],tenantId:"",user:{id:""},iat:Math.round((new Date).getTime()/1e3),exp:Math.round((new Date).getTime()/1e3)+3600,ver:"1.0"};var g=function(){function e(t,r){(0,a.Z)(this,e),this.controller=t,this.deltaStorage=r}return(0,s.Z)(e,[{key:"dispose",value:function(){}},{key:"resolvedUrl",get:function(){throw new Error("Not implemented")}},{key:"connectToStorage",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.controller);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"connectToDeltaStorage",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new u);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"connectToDeltaStream",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.deltaStorage);case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}],[{key:"create",value:function(){var t=(0,i.Z)((0,n.Z)().mark((function t(r,i){var a;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.initStorage(r);case 2:if(t.sent){t.next=5;break}return t.abrupt("return",r);case 5:return t.t0=v,t.next=8,r.connectToDeltaStorage();case 8:return t.t1=t.sent,t.t2=i,a=t.t0.create.call(t.t0,t.t1,t.t2),t.abrupt("return",new e(i,a));case 12:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()}]),e}(),b=r(82486),D=function(){function e(t,r){(0,a.Z)(this,e),this.documentServiceFactory=t,this.controller=r}return(0,s.Z)(e,[{key:"createDocumentService",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r,i){var a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=b.G2.create(r,void 0,{all:{isReplay:!0}}),e.t0=g,e.next=4,this.documentServiceFactory.createDocumentService(t,a,i);case 4:return e.t1=e.sent,e.t2=this.controller,e.abrupt("return",e.t0.create.call(e.t0,e.t1,e.t2));case 7:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"createContainer",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r,i,a){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented");case 1:case"end":return e.stop()}}),e)})));return function(t,r,n,i){return e.apply(this,arguments)}}()}],[{key:"create",value:function(t,r,n){return new e(n,new y(t,r))}}]),e}(),w=r(69163),x=r(27186),k=r(91688),A=r(93433),Z=r(37762),S=r(24071),E=r(74847),C=r(24908),O=r(92810);function T(e,t,r){var n,i=[],a=(0,Z.Z)(t);try{for(a.s();!(n=a.n()).done;){var s=n.value,o="".concat(e).concat(s.path);if(s.type===E.S.Blob){var u=s.value,c=(0,S.k8)(u.contents,u.encoding),l=(0,O.Z)();r.set(l,c);var p={mode:E.m[s.mode],path:o,sha:l,size:0,type:"blob",url:""};i.push(p)}else if(s.type===E.S.Tree){(0,x.h)(s.type===E.S.Tree,257);var d=s.value,h={mode:E.m[s.mode],path:o,sha:"",size:-1,type:"tree",url:""};i.push(h);var f=T("".concat(o,"/"),d.entries,r);i.push.apply(i,(0,A.Z)(f))}}}catch(m){a.e(m)}finally{a.f()}return i}function B(e,t){return{sha:"",tree:T("",e,t),url:""}}function z(e,t){var r=B(e,t);return(0,C.eB)(r)}var j=function(e){(0,c.Z)(r,e);var t=(0,l.Z)(r);function r(e){var n;return(0,a.Z)(this,r),(n=t.call(this)).commits={},n.trees={},n.commits=e.commits,n.blobs=new Map,n.docTree=z(e.tree.entries,n.blobs),n}return(0,s.Z)(r,[{key:"getVersions",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,i){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.docId&&this.docId!==t&&null!==t){e.next=3;break}return null!==t&&(this.docId=t),e.abrupt("return",[{id:"latest",treeId:""}]);case 3:if(void 0===this.commits[t]){e.next=5;break}return e.abrupt("return",[{id:t,treeId:r.FileStorageVersionTreeId}]);case 5:throw new Error("Unknown version ID: ".concat(t));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getSnapshotTree",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var i,a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&"latest"!==t.id){e.next=2;break}return e.abrupt("return",this.docTree);case 2:if(t.treeId===r.FileStorageVersionTreeId){e.next=4;break}throw new Error("Unknown version id: ".concat(t));case 4:if(void 0!==(i=this.trees[t.id])){e.next=10;break}if(void 0!==(a=this.commits[t.id])){e.next=9;break}throw new Error("Can't find version ".concat(t.id));case 9:this.trees[t.id]=i=z(a.entries,this.blobs);case 10:return e.abrupt("return",i);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readBlob",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===(r=this.blobs.get(t))){e.next=3;break}return e.abrupt("return",r);case 3:throw new Error("Unknown blob ID: ".concat(t));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),r}(f);j.FileStorageVersionTreeId="FileStorageTreeId";var P,M=function(e){(0,c.Z)(r,e);var t=(0,l.Z)(r);function r(e,n){var i;return(0,a.Z)(this,r),(i=t.call(this)).storage=e,i.docTree=n,(0,x.h)(!!i.docTree,176),i}return(0,s.Z)(r,[{key:"getVersions",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.docId&&this.docId!==t&&null!==t){e.next=3;break}return null!==t&&(this.docId=t),e.abrupt("return",[{id:"latest",treeId:""}]);case 3:return e.abrupt("return",this.storage.getVersions(t,r));case 4:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getSnapshotTree",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||"latest"===t.id){e.next=2;break}return e.abrupt("return",this.storage.getSnapshotTree(t));case 2:return e.abrupt("return",this.docTree);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readBlob",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.storage.readBlob(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),r}(f),$=r(34984),I={type:"null"},q={type:"object",properties:{clientId:{type:"string"},detail:{type:"object",properties:{details:{type:"object"},mode:{type:"string"},permission:{type:"array"},scopes:{type:"array"},type:{type:"string"},user:{type:"object",properties:{id:{type:"string"},name:{type:"string"},email:{type:"string"}},required:["id","name","email"],additionalProperties:!1}},required:["user"],additionalProperties:!1}},required:["clientId","detail"],additionalProperties:!1},V={type:["string","object"],properties:{key:{type:"string"},value:{type:"string"}},required:["key"],additionalProperties:!1},N={type:"object",properties:{mode:{type:"string"},path:{type:"string"},type:{enum:["Blob","Tree"]},value:{type:"object",oneOf:[{properties:{contents:{type:"string"},encoding:{type:"string"},id:{type:"null"}},required:["contents","encoding"],additionalProperties:!1},{properties:{entries:{type:"array",items:{$ref:"#/definitions/entries"}},id:{type:"null"}},required:["entries"],additionalProperties:!1}]}},required:["mode","path","type","value"],additionalProperties:!1},_={definitions:{entries:N},type:"object",properties:{id:{type:"string"},snapshot:{type:"object",properties:{entries:{type:"array",items:{$ref:"#/definitions/entries"}},id:{type:"null"}},required:["entries"],additionalProperties:!1},type:{type:"string"}},required:["id","snapshot","type"],additionalProperties:!1},R={type:"object",properties:{chunkId:{type:"number"},contents:{type:"string"},originalType:{type:"string"},totalChunks:{type:"number"}},required:["chunkId","contents","originalType","totalChunks"],additionalProperties:!1},J={definitions:{content:{type:"object",properties:{address:{type:"string"},contents:{type:"object",properties:{content:{type:"object"},type:{type:"string"}},required:["content","type"],additionalProperties:!1}},required:["address","contents"],additionalProperties:!1},entries:N,attachContents:_,chunkedOpContents:R},type:"object",oneOf:[{properties:{type:{enum:["component"]},contents:{$ref:"#/definitions/content"}},required:["type","contents"],additionalProperties:!1},{properties:{type:{enum:["attach"]},contents:{$ref:"#/definitions/attachContents"}},required:["type","contents"],additionalProperties:!1},{properties:{type:{enum:["chunkedOp"]},contents:{$ref:"#/definitions/chunkedOpContents"}},required:["type","contents"],additionalProperties:!1},{$ref:"#/definitions/content"}]},L={type:"object",properties:{address:{type:"string"},contents:{type:"object",properties:{key:{type:"string"},refSeq:{type:"number"},serializedValue:{type:"string"},value:{type:"object",properties:{type:{type:"string"},value:{}},required:["type","value"],additionalProperties:!1},type:{type:"string",enum:["write"]}},required:["key","type"],additionalProperties:!1}},required:["address","contents"],additionalProperties:!1},U={type:"object",properties:{address:{type:"string"},contents:{type:"object",properties:{key:{type:"string"},path:{type:"string"},subdirName:{type:"string"},value:{type:"object",properties:{type:{type:"string"},value:{}},required:["type"],additionalProperties:!1},type:{type:"string",enum:["act","set","delete","clear","createSubDirectory","deleteSubDirectory"]}},required:["type"],additionalProperties:!1,oneOf:[{properties:{type:{enum:["act"]}},required:["key","path","value"]},{properties:{type:{enum:["set"]}},required:["key","value"]},{properties:{type:{enum:["delete"]}},required:["key"]},{properties:{type:{enum:["clear"]}},required:["path"]},{properties:{type:{enum:["createSubDirectory","deleteSubDirectory"]}},required:["path","subdirName"]}]}},required:["address","contents"],additionalProperties:!1},K={type:"object",properties:{id:{type:"string"},before:{type:"boolean"},offset:{type:"number"}},additionalProperties:!1},G={type:"object",properties:{type:{type:"number",minimum:0,maximum:2}},required:["type"],oneOf:[{properties:{type:{enum:[0]},seg:{type:["string","object"]},pos1:{type:"number"}},required:["pos1"],additionalProperties:!1},{properties:{type:{enum:[1]},register:{type:"string"},pos1:{type:"number"},pos2:{type:"number"}},required:["pos1"],additionalProperties:!1},{properties:{type:{enum:[2]},combiningOp:{type:"object",properties:{defaultValue:{},maxValue:{},minValue:{},name:{type:"string"}},required:["name"],additionalProperties:!1},pos1:{type:"number"},pos2:{type:"number"},props:{type:"object"},register:{type:"string"},relativePos1:{$ref:"#/definitions/relativePos"},relativePos2:{$ref:"#/definitions/relativePos"}},required:["props"],additionalProperties:!1}]},W={definitions:{relativePos:K,deltaOp:G},type:"object",properties:{address:{type:"string"},contents:{$ref:"#/definitions/deltaOp"}},required:["address","contents"],additionalProperties:!1},H={definitions:{relativePos:K,deltaOp:G,groupOp:{type:"object",properties:{ops:{type:"array",items:{$ref:"#/definitions/deltaOp"}},type:{type:"number",minimum:3,maximum:3}},required:["ops","type"],additionalProperties:!1}},type:"object",properties:{address:{type:"string"},contents:{$ref:"#/definitions/groupOp"}},required:["address","contents"],additionalProperties:!1};!function(e){e[e.Generic=0]="Generic",e[e.Email=1]="Email",e[e.Name=2]="Name",e[e.FluidObject=3]="FluidObject",e[e.MapKey=4]="MapKey"}(P||(P={}));var X={valid:!1,toString:function(){return"Unmatched format"}},Y=function(){function e(t,r){(0,a.Z)(this,e),this.validateSchemaFn=t,this.debug=r,this.messages=new Array,this.parsedMessageContents=new Array,this.writtenBack=!1,this.concatenatedLength=0}return(0,s.Z)(e,[{key:"debugMsg",value:function(e){this.debug&&console.error(e)}},{key:"addMessage",value:function(e){var t;this.messages.push(e);try{t=JSON.parse(e.contents),"op"===e.type&&(t=t.contents)}catch(r){this.debugMsg(r),this.debugMsg(e.contents)}this.validateSchemaFn(t,R),this.parsedMessageContents.push(t)}},{key:"hasAllMessages",value:function(){var e=this.parsedMessageContents[this.parsedMessageContents.length-1];return void 0!==e.chunkId&&e.chunkId===e.totalChunks}},{key:"getConcatenatedContents",value:function(){var e=this.parsedMessageContents.reduce((function(e,t){return e+t.contents}),"");this.concatenatedLength=e.length;try{return JSON.parse(e)}catch(t){return this.debugMsg(e),void this.debugMsg(t)}}},{key:"writeSanitizedContents",value:function(e){var t,r=this.parsedMessageContents[0].contents.length;try{t=JSON.stringify(e),(0,x.h)(t.length<=this.concatenatedLength,137)}catch(c){throw this.debugMsg(c),c}for(var n=0;n<this.messages.length;n++){var i=t.substring(n*r,(n+1)*r),a=this.parsedMessageContents[n];a.contents=i;var s=this.messages[n],o=void 0;try{if("op"===s.type){var u={type:"chunkedOp",contents:a};o=JSON.stringify(u)}else o=JSON.stringify(a)}catch(c){this.debugMsg(c)}s.contents=o}this.writtenBack=!0}},{key:"reset",value:function(){(0,x.h)(this.writtenBack,138),this.messages=new Array,this.parsedMessageContents=new Array,this.writtenBack=!1,this.concatenatedLength=0}},{key:"isPendingProcessing",value:function(){return 0!==this.messages.length}}]),e}(),Q=function(){function e(t,r,n){var i=this,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(0,a.Z)(this,e),this.messages=t,this.fullScrub=r,this.noBail=n,this.debug=s,this.validator=new $.Validator,this.defaultExcludedKeys=new Set,this.mergeTreeExcludedKeys=new Set,this.replacementMap=new Map,this.objectMatchesSchema=function(e,t){var r=!1===t?X:i.validator.validate(e,t);if(!r.valid){var n="Bad msg fmt:\n".concat(r.toString(),"\n").concat(JSON.stringify(e,void 0,2));if(!i.fullScrub&&!i.noBail)throw new Error(n);i.debugMsg(n)}return r.valid},this.chunkProcessor=new Y(this.objectMatchesSchema,this.debug),this.wordTokenRegex=/\S+/g,this.replaceRandomTextFn=function(e){if(i.replacementMap.has(e))return i.replacementMap.get(e);var t=i.getRandomText(e.length);return i.replacementMap.set(e,t),t},this.defaultExcludedKeys.add("type"),this.defaultExcludedKeys.add("id"),this.defaultExcludedKeys.add("pkg"),this.defaultExcludedKeys.add("snapshotFormatVersion"),this.defaultExcludedKeys.add("packageVersion"),this.mergeTreeExcludedKeys.add("nodeType")}return(0,s.Z)(e,[{key:"debugMsg",value:function(e){this.debug&&console.error(e)}},{key:"isFluidObjectKey",value:function(e){return"type"===e||"id"===e}},{key:"getRandomText",value:function(e){for(var t="";t.length<e;)t+=Math.random().toString(36).substring(2);return t.substr(0,e)}},{key:"replaceText",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:P.Generic;if(void 0!==e){if(t===P.FluidObject){if(this.replacementMap.has(e))return this.replacementMap.get(e);var r=this.fullScrub?this.getRandomText(e.length):e;return this.replacementMap.set(e,r),r}return e.replace(this.wordTokenRegex,this.replaceRandomTextFn)}}},{key:"replaceArray",value:function(e){for(var t=0;t<e.length;t++){var r=e[t];"string"===typeof r?e[t]=this.replaceText(r):Array.isArray(r)?e[t]=this.replaceArray(r):"object"===typeof r&&(e[t]=this.replaceObject(r))}return e}},{key:"replaceObject",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultExcludedKeys;return null===e||void 0===e||Object.keys(e).forEach((function(n){if(t.fullScrub||!r.has(n)){var i=e[n];"string"===typeof i?e[n]=t.replaceText(i,t.isFluidObjectKey(n)?P.FluidObject:P.Generic):Array.isArray(i)?e[n]=t.replaceArray(i):"object"===typeof i&&(e[n]=t.replaceObject(i,r))}})),e}},{key:"replaceAny",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultExcludedKeys;return null===e||void 0===e?e:"string"===typeof e?this.replaceText(e):Array.isArray(e)?this.replaceArray(e):"object"===typeof e?this.replaceObject(e,t):e}},{key:"fixJoin",value:function(e){this.objectMatchesSchema(e.contents,I)||(e.contents=this.replaceAny(e.contents));try{var t=JSON.parse(e.data);if(this.objectMatchesSchema(t,q)){var r=t.detail.user;r.id=this.replaceText(r.id,P.Email),r.email=this.replaceText(r.email,P.Email),r.name=this.replaceText(r.name,P.Name)}else t=this.replaceAny(t);e.data=JSON.stringify(t)}catch(n){this.debugMsg(n)}}},{key:"fixPropose",value:function(e){var t,r,n,i;if(this.objectMatchesSchema(e.contents,V))if("string"===typeof e.contents)try{var a=JSON.parse(e.contents);if(this.fullScrub){var s=null===(t=a.value)||void 0===t?void 0:t.package;(null===s||void 0===s?void 0:s.name)&&(s.name=this.replaceText(s.name,P.FluidObject)),Array.isArray(null===(i=null===(n=null===(r=null===s||void 0===s?void 0:s.fluid)||void 0===r?void 0:r.browser)||void 0===n?void 0:n.umd)||void 0===i?void 0:i.files)&&(s.fluid.browser.umd.files=this.replaceArray(s.fluid.browser.umd.files))}}catch(o){this.debugMsg(o)}else this.fullScrub&&(e.contents.value=this.replaceText(e.contents.value,P.FluidObject));else e.contents=this.replaceAny(e.contents)}},{key:"fixAttachEntries",value:function(e){var t=this;e.forEach((function(e){if(e.value.entries)t.fixAttachEntries(e.value.entries);else try{if("string"===typeof e.value.contents){var r=JSON.parse(e.value.contents);r=t.replaceObject(r),e.value.contents=JSON.stringify(r)}}catch(n){t.debugMsg(n)}}))}},{key:"fixAttachContents",value:function(e){(0,x.h)("object"===typeof e,139),this.objectMatchesSchema(e,_)?(this.fullScrub&&(e.id=this.replaceText(e.id,P.FluidObject),e.type=this.replaceText(e.type,P.FluidObject)),this.fixAttachEntries(e.snapshot.entries)):this.replaceObject(e)}},{key:"fixAttach",value:function(e){if("string"===typeof e.contents)try{var t=JSON.parse(e.contents);this.fixAttachContents(t),e.contents=JSON.stringify(t)}catch(r){return void this.debugMsg(r)}else this.fixAttachContents(e.contents)}},{key:"fixDeltaOp",value:function(e){e.seg="string"===typeof e.seg?this.replaceText(e.seg):this.replaceObject(e.seg,this.mergeTreeExcludedKeys)}},{key:"fixOpContentsObject",value:function(e){var t=this;if(this.objectMatchesSchema(e,J)){this.fullScrub&&(e.address=this.replaceText(e.address,P.FluidObject));var r=e.contents.content;if((0,x.h)(void 0!==r,140),"attach"===e.contents.type)if("string"===typeof e.contents.content)try{var n=JSON.parse(e.contents.content);this.fixAttachContents(n),e.contents.content=JSON.stringify(n)}catch(i){this.debugMsg(i)}else this.fixAttachContents(e.contents.content);else this.validator.validate(r,U).valid?(this.fullScrub&&(r.address=this.replaceText(r.address,P.FluidObject),r.contents.key=this.replaceText(r.contents.key,P.MapKey)),void 0!==r.contents.value&&(r.contents.value.value=this.replaceAny(r.contents.value.value))):this.validator.validate(r,H).valid?(this.fullScrub&&(r.address=this.replaceText(r.address,P.FluidObject)),r.contents.ops.forEach((function(e){t.fixDeltaOp(e)}))):this.validator.validate(r,W).valid?(this.fullScrub&&(r.address=this.replaceText(r.address,P.FluidObject)),this.fixDeltaOp(r.contents)):this.validator.validate(r,L).valid?(this.fullScrub&&(r.address=this.replaceText(r.address,P.FluidObject),r.contents.key=this.replaceText(r.contents.key,P.MapKey)),void 0!==r.contents.value&&(r.contents.value.value=this.replaceAny(r.contents.value.value))):this.objectMatchesSchema(e,!1)}else this.replaceAny(e)}},{key:"fixOp",value:function(e){var t;if("string"===typeof e.contents)try{t=JSON.parse(e.contents)}catch(r){return void this.debugMsg(r)}else t=e.contents;switch(t.type){case"attach":this.fixAttach(t);break;case"component":this.fixOpContentsObject(t.contents);break;case"chunkedOp":return this.fixChunkedOp(e);case"blobAttach":return void this.debugMsg("TODO: blobAttach ops are skipped/unhandled");default:this.fixOpContentsObject(t)}if("string"===typeof e.contents)try{e.contents=JSON.stringify(t)}catch(r){return void this.debugMsg(r)}}},{key:"fixChunkedOp",value:function(e){if(this.chunkProcessor.addMessage(e),this.chunkProcessor.hasAllMessages()){var t=this.chunkProcessor.getConcatenatedContents();this.fixOpContentsObject(t),this.chunkProcessor.writeSanitizedContents(t),this.chunkProcessor.reset()}}},{key:"sanitize",value:function(){var e=this,t=0;try{this.messages.map((function(r){switch(t=r.sequenceNumber,r.type){case"join":e.fixJoin(r);break;case"propose":e.fixPropose(r);break;case"attach":e.fixAttach(r);break;case"op":e.fixOp(r);break;case"chunkedOp":e.fixChunkedOp(r);break;case"noop":case"leave":case"noClient":case"summarize":case"summaryAck":case"summaryNack":break;default:e.debugMsg("Unexpected op type ".concat(r.type))}})),(0,x.h)(!this.chunkProcessor.isPendingProcessing(),141)}catch(r){throw this.debugMsg("Error while processing sequenceNumber ".concat(t)),r}return this.messages}}]),e}(),ee=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"===typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,i){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,i,(t=e[r](t)).done,t.value)}))}}},te=function(e){return this instanceof te?(this.v=e,this):new te(e)},re=function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),a=[];return n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n;function s(e){i[e]&&(n[e]=function(t){return new Promise((function(r,n){a.push([e,t,r,n])>1||o(e,t)}))})}function o(e,t){try{(r=i[e](t)).value instanceof te?Promise.resolve(r.value.v).then(u,c):l(a[0][2],r)}catch(n){l(a[0][3],n)}var r}function u(e){o("next",e)}function c(e){o("throw",e)}function l(e,t){e(t),a.shift(),a.length&&o(a[0][0],a[0][1])}},ne=function(e){(0,c.Z)(r,e);var t=(0,l.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.apply(this,arguments)).ui=null,e.startSeqDeferred=new w.B,e.retryFetchOpsOnEndOfFile=!1,e.versions=[],e.stepsToPlay=0,e.lastOpReached=!1,e.versionCount=0,e}return(0,s.Z)(r,[{key:"connectToUi",value:function(e){this.ui=e}},{key:"onClose",value:function(){this.startSeqDeferred.resolve(r.WindowClosedSeq)}},{key:"onVersionSelection",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var i,a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.documentStorageService){e.next=2;break}throw new Error("onVersionSelection: no storage");case 2:return e.next=4,this.documentStorageService.getSnapshotTree(t);case 4:return i=e.sent,e.next=7,r.seqFromTree(this.documentStorageService,i);case 7:a=e.sent,this.resolveStorage(a,new M(this.documentStorageService,i),t);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onOpButtonClick",value:function(e){this.stepsDeferred&&!Number.isNaN(e)&&e>0&&this.stepsDeferred.resolve(e)}},{key:"onSnapshotFileSelection",value:function(e){var t=this;if(/^snapshot.*\.json/.exec(e.name))if(/.*_expanded.*/.exec(e.name))alert("Incorrect file name - please use non-extended files: ".concat(e.name));else{var r=new FileReader;r.onload=(0,i.Z)((0,n.Z)().mark((function i(){var a,s;return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.documentStorageService){n.next=13;break}a=r.result,n.prev=2,s=JSON.parse(a),t.retryFetchOpsOnEndOfFile=!1,t.lastOpReached=!0,t.resolveStorage(Number.MAX_SAFE_INTEGER,new j(s),e.name),n.next=13;break;case 9:return n.prev=9,n.t0=n.catch(2),alert("Error parsing file: ".concat(n.t0)),n.abrupt("return");case 13:case"end":return n.stop()}}),i,null,[[2,9]])}))),r.readAsText(e,"utf-8")}else alert("Incorrect file name: ".concat(e.name))}},{key:"onDownloadOpsButtonClick",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,i,a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.documentService){e.next=2;break}throw new Error("DocumentService required");case 2:return e.next=4,this.documentService.connectToDeltaStorage();case 4:return r=e.sent,e.next=7,this.fetchOpsFromDeltaStorage(r);case 7:return i=e.sent,t&&(a=new Q(i,!1,!1),i=a.sanitize()),e.abrupt("return",JSON.stringify(i,void 0,2));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchOpsFromDeltaStorage",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,i,a,s,o,u,c;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=ie(t),s=[],e.prev=2,o=ee(a);case 4:return e.next=6,o.next();case 6:if((u=e.sent).done){e.next=12;break}c=u.value,s=s.concat(c);case 10:e.next=4;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),r={error:e.t0};case 17:if(e.prev=17,e.prev=18,!u||u.done||!(i=o.return)){e.next=22;break}return e.next=22,i.call(o);case 22:if(e.prev=22,!r){e.next=25;break}throw r.error;case 25:return e.finish(22);case 26:return e.finish(17);case 27:return e.abrupt("return",s);case 28:case"end":return e.stop()}}),e,null,[[2,14,17,27],[18,,22,26]])})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchTo",value:function(e){}},{key:"isSelectionMade",value:function(){return void 0!==this.storage}},{key:"downloadVersionInfo",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,i,a,s){var o,u;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isSelectionMade()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,i;case 4:return e.next=6,t.getSnapshotTree(s);case 6:return o=e.sent,e.next=9,r.seqFromTree(t,o);case 9:u=e.sent,this.isSelectionMade()||(this.versionCount--,this.ui.updateVersionText(this.versionCount),this.ui.updateVersion(a,s,u));case 11:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i){return e.apply(this,arguments)}}()},{key:"initStorage",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var i,a,s,o,u,c=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===this.shouldUseController){e.next=2;break}return e.abrupt("return",this.shouldUseController);case 2:return(0,x.h)(!!t,128),(0,x.h)(!this.documentService,129),(0,x.h)(!this.documentStorageService,130),this.documentService=t,e.next=8,t.connectToStorage();case 8:if(this.documentStorageService=e.sent,this.isSelectionMade()){e.next=14;break}return e.next=12,this.documentStorageService.getVersions("",50);case 12:this.versions=e.sent,this.isSelectionMade()||(this.ui.addVersions(this.versions),this.ui.updateVersionText(this.versionCount));case 14:for(this.versionCount=this.versions.length,10,i=[],a=0;a<10;a++){for(s=Promise.resolve(),o=a;o<this.versions.length;o+=10)u=this.versions[o],s=this.downloadVersionInfo(this.documentStorageService,s,o,u);i.push(s)}return Promise.all(i).then((function(){c.ui.updateVersionText(0)})),e.next=21,this.startSeqDeferred.promise;case 21:return e.t0=e.sent,e.t1=r.WindowClosedSeq,this.shouldUseController=e.t0!==e.t1,(0,x.h)(this.isSelectionMade()===this.shouldUseController,131),e.abrupt("return",this.shouldUseController);case 26:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readBlob",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===this.storage){e.next=2;break}return e.abrupt("return",this.storage.readBlob(t));case 2:throw new Error("Reading blob before storage is setup properly");case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getVersions",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===this.storage){e.next=2;break}return e.abrupt("return",this.storage.getVersions(t,r));case 2:throw new Error("initStorage() was not called!");case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getSnapshotTree",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===this.storage){e.next=2;break}return e.abrupt("return",this.storage.getSnapshotTree(t));case 2:throw new Error("Reading snapshot tree before storage is setup properly");case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getStartingOpSequence",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.startSeqDeferred.promise);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isDoneFetch",value:function(e,t){return void 0===t?(this.lastOpReached=!0,e===Number.MAX_SAFE_INTEGER?this.ui.updateLastOpText(-1,!1):this.ui.updateLastOpText(e,!1)):this.ui.updateLastOpText(e,!0),this.lastOpReached&&!this.retryFetchOpsOnEndOfFile}},{key:"replay",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){var i,a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=r;case 1:if(0!==i.length){e.next=5;break}return this.ui.updateNextOpText([]),e.abrupt("return");case 5:if(0!==this.stepsToPlay){e.next=14;break}return this.ui.disableNextOpButton(!1),this.stepsDeferred=new w.B,this.ui.updateNextOpText(i),e.next=11,this.stepsDeferred.promise;case 11:this.stepsToPlay=e.sent,this.stepsDeferred=void 0,this.ui.disableNextOpButton(!0);case 14:a=void 0,this.stepsToPlay>=i.length?(a=i,this.stepsToPlay-=i.length,i=[]):(a=i.splice(0,this.stepsToPlay),this.stepsToPlay=0),t(a),e.next=1;break;case 19:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"resolveStorage",value:function(e,t,r){(0,x.h)(!this.isSelectionMade(),132),(0,x.h)(!!t,133),this.storage=t,(0,x.h)(this.isSelectionMade(),134),this.ui.versionSelected(e,r),this.startSeqDeferred.resolve(e)}}],[{key:"create",value:function(e){if("object"===typeof localStorage&&null!==localStorage&&localStorage.FluidDebugger){var t=new r;if(e(t))return t}return null}},{key:"seqFromTree",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){var i,a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return",0);case 2:return i=r.trees[".protocol"].blobs.attributes,e.next=5,(0,k.g)(t,i);case 5:return a=e.sent,e.abrupt("return",a.sequenceNumber);case 7:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()}]),r}(m);function ie(e){return re(this,arguments,(0,n.Z)().mark((function t(){var r,i;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=e.fetchMessages(1,void 0);case 1:return t.next=4,te(r.read());case 4:if(!(i=t.sent).done){t.next=9;break}return t.next=8,te(void 0);case 8:return t.abrupt("return",t.sent);case 9:return t.next=11,te(i.value);case 11:return t.next=13,t.sent;case 13:t.next=1;break;case 15:case"end":return t.stop()}}),t)})))}ne.WindowClosedSeq=-1;var ae,se=function(){function e(t,r){var n=this;(0,a.Z)(this,e),this.controller=t,this.debuggerWindow=r,this.wasVersionSelected=!1,this.versions=[],this.documentClosed=!1;var i=this.debuggerWindow.document;i.write("<Title>Fluid Debugger</Title>\n<body>\n<h3>Fluid Debugger</h3>\nPlease select snapshot or file to start with<br/>\nClose debugger window to proceed to live document<br/><br/>\n<select style='width:250px' id='selector'>\n</select>\n&nbsp; &nbsp; &nbsp;\n<button id='buttonVers' style='width:60px'>Go</button><br/>\n<input id='file' type='file' value='Load from file'/>\n<br/><br/>\n<h4>Download the current document's ops</h4>\n<input type='checkbox' id='anonymize' value='Anonymize'>\n<label for='anonymize'>Anonymize</label>\n<button type='button' id='downloadOps'>Download ops</button>\n<br/><br/><div id='versionText'></div>\n</body>"),window.addEventListener("beforeunload",(function(e){n.documentClosed=!0,n.debuggerWindow.close()}),!1),this.debuggerWindow.addEventListener("beforeunload",(function(e){n.documentClosed||n.controller.onClose()}),!1),this.selector=i.getElementById("selector"),i.getElementById("buttonVers").onclick=function(){var e=n.selector.selectedIndex;t.onVersionSelection(n.versions[e])};var s=i.getElementById("file");s.addEventListener("change",(function(){var e=s.files;e&&t.onSnapshotFileSelection(e[0])}),!1);var o=i.getElementById("downloadOps"),u=i.getElementById("anonymize");this.attachDownloadOpsListener(o,u),this.versionText=i.getElementById("versionText"),this.versionText.textContent="Fetching snapshots, please wait...",t.connectToUi(this)}return(0,s.Z)(e,[{key:"attachDownloadOpsListener",value:function(e,t){var r=this;e.addEventListener("click",(function(){r.controller.onDownloadOpsButtonClick(t.checked).then((function(e){r.download("opStream.json",e)})).catch((function(e){console.log("Error downloading ops: ".concat(e))}))}))}},{key:"addVersions",value:function(e){if(this.selector){this.versions=e;var t,r=(0,Z.Z)(e);try{for(r.s();!(t=r.n()).done;){var n=t.value,i=document.createElement("option");i.text=void 0!==n.date?"id = ".concat(n.id,",  time = ").concat(n.date):"id = ".concat(n.id),this.selector.add(i)}}catch(a){r.e(a)}finally{r.f()}}}},{key:"updateVersion",value:function(e,t,r){if(this.selector){var n=this.selector[e];n.text="".concat(n.text,",  seq = ").concat(r),this.selector[e]=n}}},{key:"versionSelected",value:function(e,t){var r=this,n="string"===typeof t?"Playing ".concat(t," file"):"Playing from ".concat(t.id,", seq# ").concat(e);this.wasVersionSelected=!0,this.selector=void 0;var i=this.debuggerWindow.document;i.open(),i.write("<Title>Fluid Debugger</Title>\n<body>\n<h3>Fluid Debugger</h3>\n<div id='versionText'></div>\n<div id='lastOp'></div>\n<br/>\nStep to move: <input type='number' id='steps' value='1' min='1' style='width:50px'/>\n&nbsp; &nbsp; &nbsp;<button id='buttonOps' style='width:60px'>Go</button>\n<br/><br/>\n<div id='text1'></div><div id='text2'></div><div id='text3'></div>\n<br/>\n<h4>Download the current document's ops</h4>\n<input type='checkbox' id='anonymize' value='Anonymize'>\n<label for='anonymize'>Anonymize</label>\n<button type='button' id='downloadOps'>Download ops</button>\n</body>"),i.close(),this.lastOpText=i.getElementById("lastOp"),this.text1=i.getElementById("text1"),this.text2=i.getElementById("text2"),this.text3=i.getElementById("text3");var a=i.getElementById("steps");this.buttonOps=i.getElementById("buttonOps"),this.buttonOps.disabled=!0,this.buttonOps.onclick=function(){r.controller.onOpButtonClick(Number(a.value))},this.versionText=i.getElementById("versionText"),this.versionText.textContent=n;var s=i.getElementById("downloadOps"),o=i.getElementById("anonymize");this.attachDownloadOpsListener(s,o)}},{key:"disableNextOpButton",value:function(e){(0,x.h)(!!this.buttonOps,136),this.buttonOps.disabled=e}},{key:"updateNextOpText",value:function(t){if(0===t.length)this.text1.textContent="",this.text2.textContent="",this.text3.textContent="";else{var r=t[0],n=r.sequenceNumber,i=e.formatDate(r.timestamp);this.text1.textContent="Next op seq#: ".concat(n),this.text2.textContent="Type: ".concat(r.type),this.text3.textContent="".concat(i)}}},{key:"updateVersionText",value:function(e){if(!this.wasVersionSelected){var t=0===e?"":"Fetching information about ".concat(e," snapshots...");this.versionText.textContent=t}}},{key:"updateLastOpText",value:function(e,t){var r=t?"Last op (still loading): ".concat(e):"Document's last op seq#: ".concat(e);this.lastOpText.textContent=r}},{key:"download",value:function(e,t){var r=document.createElement("a");r.setAttribute("href","data:text/plain;charset=utf-8,".concat(encodeURIComponent(t))),r.setAttribute("download",e),r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r)}}],[{key:"create",value:function(t){if("object"!==typeof window||null===window||"object"!==typeof window.document||null==window.document)return console.log("Can't create debugger window - not running in browser!"),null;var r=window.open("","","width=400,height=400,resizable=yes,location=no,menubar=no,titlebar=no,status=no,toolbar=no");return r?new e(t,r):(console.error("Can't create debugger window - please enable pop-up windows in your browser!"),null)}},{key:"formatDate",value:function(e){return new Date(e).toUTCString()}}]),e}();!function(e){function t(){return(t=(0,i.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a()){e.next=3;break}return e.abrupt("return",t);case 3:return e.abrupt("return",g.create(t,r));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function r(){return(r=(0,i.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a()){e.next=3;break}return e.abrupt("return",t);case 3:return e.abrupt("return",new D(t,r));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}e.createFromService=function(e){return t.apply(this,arguments)},e.createFromServiceFactory=function(e){return r.apply(this,arguments)};var a=function(){return ne.create((function(e){return se.create(e)}))}}(ae||(ae={}))},50109:function(e,t,r){var n=r(53137),i=n.ValidatorResult,a=n.SchemaError,s={ignoreProperties:{id:!0,default:!0,description:!0,title:!0,additionalItems:!0,then:!0,else:!0,$schema:!0,$ref:!0,extends:!0}},o=s.validators={};function u(e,t,r,n,i){var a=t.throwError,s=t.throwAll;t.throwError=!1,t.throwAll=!1;var o=this.validateSchema(e,i,t,r);return t.throwError=a,t.throwAll=s,!o.valid&&n instanceof Function&&n(o),o.valid}function c(e,t){if(Object.hasOwnProperty.call(e,t))return e[t];if(t in e)for(;e=Object.getPrototypeOf(e);)if(Object.propertyIsEnumerable.call(e,t))return e[t]}function l(e,t,r,n,i,a){if(this.types.object(e)&&(!t.properties||void 0===t.properties[i]))if(!1===t.additionalProperties)a.addError({name:"additionalProperties",argument:i,message:"is not allowed to have the additional property "+JSON.stringify(i)});else{var s=t.additionalProperties||{};"function"==typeof r.preValidateProperty&&r.preValidateProperty(e,i,s,r,n);var o=this.validateSchema(e[i],s,r,n.makeChild(s,i));o.instance!==a.instance[i]&&(a.instance[i]=o.instance),a.importErrors(o)}}o.type=function(e,t,r,n){if(void 0===e)return null;var a=new i(e,t,r,n),s=Array.isArray(t.type)?t.type:[t.type];if(!s.some(this.testType.bind(this,e,t,r,n))){var o=s.map((function(e){if(e){var t=e.$id||e.id;return t?"<"+t+">":e+""}}));a.addError({name:"type",argument:o,message:"is not of a type(s) "+o})}return a},o.anyOf=function(e,t,r,n){if(void 0===e)return null;var s=new i(e,t,r,n),o=new i(e,t,r,n);if(!Array.isArray(t.anyOf))throw new a("anyOf must be an array");if(!t.anyOf.some(u.bind(this,e,r,n,(function(e){o.importErrors(e)})))){var c=t.anyOf.map((function(e,t){var r=e.$id||e.id;return r?"<"+r+">":e.title&&JSON.stringify(e.title)||e.$ref&&"<"+e.$ref+">"||"[subschema "+t+"]"}));r.nestedErrors&&s.importErrors(o),s.addError({name:"anyOf",argument:c,message:"is not any of "+c.join(",")})}return s},o.allOf=function(e,t,r,n){if(void 0===e)return null;if(!Array.isArray(t.allOf))throw new a("allOf must be an array");var s=new i(e,t,r,n),o=this;return t.allOf.forEach((function(t,i){var a=o.validateSchema(e,t,r,n);if(!a.valid){var u=t.$id||t.id||t.title&&JSON.stringify(t.title)||t.$ref&&"<"+t.$ref+">"||"[subschema "+i+"]";s.addError({name:"allOf",argument:{id:u,length:a.errors.length,valid:a},message:"does not match allOf schema "+u+" with "+a.errors.length+" error[s]:"}),s.importErrors(a)}})),s},o.oneOf=function(e,t,r,n){if(void 0===e)return null;if(!Array.isArray(t.oneOf))throw new a("oneOf must be an array");var s=new i(e,t,r,n),o=new i(e,t,r,n),c=t.oneOf.filter(u.bind(this,e,r,n,(function(e){o.importErrors(e)}))).length,l=t.oneOf.map((function(e,t){return e.$id||e.id||e.title&&JSON.stringify(e.title)||e.$ref&&"<"+e.$ref+">"||"[subschema "+t+"]"}));return 1!==c&&(r.nestedErrors&&s.importErrors(o),s.addError({name:"oneOf",argument:l,message:"is not exactly one from "+l.join(",")})),s},o.if=function(e,t,r,a){if(void 0===e)return null;if(!n.isSchema(t.if))throw new Error('Expected "if" keyword to be a schema');var s,o=u.call(this,e,r,a,null,t.if),c=new i(e,t,r,a);if(o){if(void 0===t.then)return;if(!n.isSchema(t.then))throw new Error('Expected "then" keyword to be a schema');s=this.validateSchema(e,t.then,r,a.makeChild(t.then)),c.importErrors(s)}else{if(void 0===t.else)return;if(!n.isSchema(t.else))throw new Error('Expected "else" keyword to be a schema');s=this.validateSchema(e,t.else,r,a.makeChild(t.else)),c.importErrors(s)}return c},o.propertyNames=function(e,t,r,s){if(this.types.object(e)){var o=new i(e,t,r,s),u=void 0!==t.propertyNames?t.propertyNames:{};if(!n.isSchema(u))throw new a('Expected "propertyNames" to be a schema (object or boolean)');for(var l in e)if(void 0!==c(e,l)){var p=this.validateSchema(l,u,r,s.makeChild(u));o.importErrors(p)}return o}},o.properties=function(e,t,r,n){if(this.types.object(e)){var s=new i(e,t,r,n),o=t.properties||{};for(var u in o){var l=o[u];if(void 0!==l){if(null===l)throw new a('Unexpected null, expected schema in "properties"');"function"==typeof r.preValidateProperty&&r.preValidateProperty(e,u,l,r,n);var p=c(e,u),d=this.validateSchema(p,l,r,n.makeChild(l,u));d.instance!==s.instance[u]&&(s.instance[u]=d.instance),s.importErrors(d)}}return s}},o.patternProperties=function(e,t,r,n){if(this.types.object(e)){var s=new i(e,t,r,n),o=t.patternProperties||{};for(var u in e){var c=!0;for(var p in o){var d=o[p];if(void 0!==d){if(null===d)throw new a('Unexpected null, expected schema in "patternProperties"');try{var h=new RegExp(p,"u")}catch(m){h=new RegExp(p)}if(h.test(u)){c=!1,"function"==typeof r.preValidateProperty&&r.preValidateProperty(e,u,d,r,n);var f=this.validateSchema(e[u],d,r,n.makeChild(d,u));f.instance!==s.instance[u]&&(s.instance[u]=f.instance),s.importErrors(f)}}}c&&l.call(this,e,t,r,n,u,s)}return s}},o.additionalProperties=function(e,t,r,n){if(this.types.object(e)){if(t.patternProperties)return null;var a=new i(e,t,r,n);for(var s in e)l.call(this,e,t,r,n,s,a);return a}},o.minProperties=function(e,t,r,n){if(this.types.object(e)){var a=new i(e,t,r,n);return Object.keys(e).length>=t.minProperties||a.addError({name:"minProperties",argument:t.minProperties,message:"does not meet minimum property length of "+t.minProperties}),a}},o.maxProperties=function(e,t,r,n){if(this.types.object(e)){var a=new i(e,t,r,n);return Object.keys(e).length<=t.maxProperties||a.addError({name:"maxProperties",argument:t.maxProperties,message:"does not meet maximum property length of "+t.maxProperties}),a}},o.items=function(e,t,r,n){var a=this;if(this.types.array(e)&&void 0!==t.items){var s=new i(e,t,r,n);return e.every((function(e,i){if(Array.isArray(t.items))var o=void 0===t.items[i]?t.additionalItems:t.items[i];else o=t.items;if(void 0===o)return!0;if(!1===o)return s.addError({name:"items",message:"additionalItems not permitted"}),!1;var u=a.validateSchema(e,o,r,n.makeChild(o,i));return u.instance!==s.instance[i]&&(s.instance[i]=u.instance),s.importErrors(u),!0})),s}},o.contains=function(e,t,r,a){var s=this;if(this.types.array(e)&&void 0!==t.contains){if(!n.isSchema(t.contains))throw new Error('Expected "contains" keyword to be a schema');var o=new i(e,t,r,a);return!1===e.some((function(e,n){return 0===s.validateSchema(e,t.contains,r,a.makeChild(t.contains,n)).errors.length}))&&o.addError({name:"contains",argument:t.contains,message:"must contain an item matching given schema"}),o}},o.minimum=function(e,t,r,n){if(this.types.number(e)){var a=new i(e,t,r,n);return t.exclusiveMinimum&&!0===t.exclusiveMinimum?e>t.minimum||a.addError({name:"minimum",argument:t.minimum,message:"must be greater than "+t.minimum}):e>=t.minimum||a.addError({name:"minimum",argument:t.minimum,message:"must be greater than or equal to "+t.minimum}),a}},o.maximum=function(e,t,r,n){if(this.types.number(e)){var a=new i(e,t,r,n);return t.exclusiveMaximum&&!0===t.exclusiveMaximum?e<t.maximum||a.addError({name:"maximum",argument:t.maximum,message:"must be less than "+t.maximum}):e<=t.maximum||a.addError({name:"maximum",argument:t.maximum,message:"must be less than or equal to "+t.maximum}),a}},o.exclusiveMinimum=function(e,t,r,n){if("boolean"!==typeof t.exclusiveMinimum&&this.types.number(e)){var a=new i(e,t,r,n);return e>t.exclusiveMinimum||a.addError({name:"exclusiveMinimum",argument:t.exclusiveMinimum,message:"must be strictly greater than "+t.exclusiveMinimum}),a}},o.exclusiveMaximum=function(e,t,r,n){if("boolean"!==typeof t.exclusiveMaximum&&this.types.number(e)){var a=new i(e,t,r,n);return e<t.exclusiveMaximum||a.addError({name:"exclusiveMaximum",argument:t.exclusiveMaximum,message:"must be strictly less than "+t.exclusiveMaximum}),a}};var p=function(e,t,r,s,o,u){if(this.types.number(e)){var c=t[o];if(0==c)throw new a(o+" cannot be zero");var l=new i(e,t,r,s),p=n.getDecimalPlaces(e),d=n.getDecimalPlaces(c),h=Math.max(p,d),f=Math.pow(10,h);return Math.round(e*f)%Math.round(c*f)!==0&&l.addError({name:o,argument:c,message:u+JSON.stringify(c)}),l}};function d(e,t,r){var i,a=r.length;for(i=t+1;i<a;i++)if(n.deepCompareStrict(e,r[i]))return!1;return!0}o.multipleOf=function(e,t,r,n){return p.call(this,e,t,r,n,"multipleOf","is not a multiple of (divisible by) ")},o.divisibleBy=function(e,t,r,n){return p.call(this,e,t,r,n,"divisibleBy","is not divisible by (multiple of) ")},o.required=function(e,t,r,n){var a=new i(e,t,r,n);return void 0===e&&!0===t.required?a.addError({name:"required",message:"is required"}):this.types.object(e)&&Array.isArray(t.required)&&t.required.forEach((function(t){void 0===c(e,t)&&a.addError({name:"required",argument:t,message:"requires property "+JSON.stringify(t)})})),a},o.pattern=function(e,t,r,n){if(this.types.string(e)){var a=new i(e,t,r,n),s=t.pattern;try{var o=new RegExp(s,"u")}catch(u){o=new RegExp(s)}return e.match(o)||a.addError({name:"pattern",argument:t.pattern,message:"does not match pattern "+JSON.stringify(t.pattern.toString())}),a}},o.format=function(e,t,r,a){if(void 0!==e){var s=new i(e,t,r,a);return s.disableFormat||n.isFormat(e,t.format,this)||s.addError({name:"format",argument:t.format,message:"does not conform to the "+JSON.stringify(t.format)+" format"}),s}},o.minLength=function(e,t,r,n){if(this.types.string(e)){var a=new i(e,t,r,n),s=e.match(/[\uDC00-\uDFFF]/g);return e.length-(s?s.length:0)>=t.minLength||a.addError({name:"minLength",argument:t.minLength,message:"does not meet minimum length of "+t.minLength}),a}},o.maxLength=function(e,t,r,n){if(this.types.string(e)){var a=new i(e,t,r,n),s=e.match(/[\uDC00-\uDFFF]/g);return e.length-(s?s.length:0)<=t.maxLength||a.addError({name:"maxLength",argument:t.maxLength,message:"does not meet maximum length of "+t.maxLength}),a}},o.minItems=function(e,t,r,n){if(this.types.array(e)){var a=new i(e,t,r,n);return e.length>=t.minItems||a.addError({name:"minItems",argument:t.minItems,message:"does not meet minimum length of "+t.minItems}),a}},o.maxItems=function(e,t,r,n){if(this.types.array(e)){var a=new i(e,t,r,n);return e.length<=t.maxItems||a.addError({name:"maxItems",argument:t.maxItems,message:"does not meet maximum length of "+t.maxItems}),a}},o.uniqueItems=function(e,t,r,n){if(!0===t.uniqueItems&&this.types.array(e)){var a=new i(e,t,r,n);return e.every(d)||a.addError({name:"uniqueItems",message:"contains duplicate item"}),a}},o.dependencies=function(e,t,r,n){if(this.types.object(e)){var a=new i(e,t,r,n);for(var s in t.dependencies)if(void 0!==e[s]){var o=t.dependencies[s],u=n.makeChild(o,s);if("string"==typeof o&&(o=[o]),Array.isArray(o))o.forEach((function(t){void 0===e[t]&&a.addError({name:"dependencies",argument:u.propertyPath,message:"property "+t+" not found, required by "+u.propertyPath})}));else{var c=this.validateSchema(e,o,r,u);a.instance!==c.instance&&(a.instance=c.instance),c&&c.errors.length&&(a.addError({name:"dependencies",argument:u.propertyPath,message:"does not meet dependency required by "+u.propertyPath}),a.importErrors(c))}}return a}},o.enum=function(e,t,r,s){if(void 0===e)return null;if(!Array.isArray(t.enum))throw new a("enum expects an array",t);var o=new i(e,t,r,s);return t.enum.some(n.deepCompareStrict.bind(null,e))||o.addError({name:"enum",argument:t.enum,message:"is not one of enum values: "+t.enum.map(String).join(",")}),o},o.const=function(e,t,r,a){if(void 0===e)return null;var s=new i(e,t,r,a);return n.deepCompareStrict(t.const,e)||s.addError({name:"const",argument:t.const,message:"does not exactly match expected constant: "+t.const}),s},o.not=o.disallow=function(e,t,r,n){var a=this;if(void 0===e)return null;var s=new i(e,t,r,n),o=t.not||t.disallow;return o?(Array.isArray(o)||(o=[o]),o.forEach((function(i){if(a.testType(e,t,r,n,i)){var o=i&&(i.$id||i.id)||i;s.addError({name:"not",argument:o,message:"is of prohibited type "+o})}})),s):null},e.exports=s},53137:function(e,t,r){var n=r(12114),i=t.ValidationError=function(e,t,r,n,i,a){if(Array.isArray(n)?(this.path=n,this.property=n.reduce((function(e,t){return e+p(t)}),"instance")):void 0!==n&&(this.property=n),e&&(this.message=e),r){var s=r.$id||r.id;this.schema=s||r}void 0!==t&&(this.instance=t),this.name=i,this.argument=a,this.stack=this.toString()};i.prototype.toString=function(){return this.property+" "+this.message};var a=t.ValidatorResult=function(e,t,r,n){this.instance=e,this.schema=t,this.options=r,this.path=n.path,this.propertyPath=n.propertyPath,this.errors=[],this.throwError=r&&r.throwError,this.throwFirst=r&&r.throwFirst,this.throwAll=r&&r.throwAll,this.disableFormat=r&&!0===r.disableFormat};function s(e,t){return t+": "+e.toString()+"\n"}function o(e){Error.captureStackTrace&&Error.captureStackTrace(this,o),this.instance=e.instance,this.schema=e.schema,this.options=e.options,this.errors=e.errors}a.prototype.addError=function(e){var t;if("string"==typeof e)t=new i(e,this.instance,this.schema,this.path);else{if(!e)throw new Error("Missing error detail");if(!e.message)throw new Error("Missing error message");if(!e.name)throw new Error("Missing validator type");t=new i(e.message,this.instance,this.schema,this.path,e.name,e.argument)}if(this.errors.push(t),this.throwFirst)throw new o(this);if(this.throwError)throw t;return t},a.prototype.importErrors=function(e){"string"==typeof e||e&&e.validatorType?this.addError(e):e&&e.errors&&(this.errors=this.errors.concat(e.errors))},a.prototype.toString=function(e){return this.errors.map(s).join("")},Object.defineProperty(a.prototype,"valid",{get:function(){return!this.errors.length}}),e.exports.ValidatorResultError=o,o.prototype=new Error,o.prototype.constructor=o,o.prototype.name="Validation Error";var u=t.SchemaError=function e(t,r){this.message=t,this.schema=r,Error.call(this,t),Error.captureStackTrace(this,e)};u.prototype=Object.create(Error.prototype,{constructor:{value:u,enumerable:!1},name:{value:"SchemaError",enumerable:!1}});var c=t.SchemaContext=function(e,t,r,n,i){this.schema=e,this.options=t,Array.isArray(r)?(this.path=r,this.propertyPath=r.reduce((function(e,t){return e+p(t)}),"instance")):this.propertyPath=r,this.base=n,this.schemas=i};c.prototype.resolve=function(e){return n.resolve(this.base,e)},c.prototype.makeChild=function(e,t){var r=void 0===t?this.path:this.path.concat([t]),i=e.$id||e.id,a=n.resolve(this.base,i||""),s=new c(e,this.options,r,a,Object.create(this.schemas));return i&&!s.schemas[a]&&(s.schemas[a]=e),s};var l=t.FORMAT_REGEXPS={"date-time":/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])[tT ](2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])(\.\d+)?([zZ]|[+-]([0-5][0-9]):(60|[0-5][0-9]))$/,date:/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])$/,time:/^(2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])$/,duration:/P(T\d+(H(\d+M(\d+S)?)?|M(\d+S)?|S)|\d+(D|M(\d+D)?|Y(\d+M(\d+D)?)?)(T\d+(H(\d+M(\d+S)?)?|M(\d+S)?|S))?|\d+W)/i,email:/^(?:[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+\.)*[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+@(?:(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!\.)){0,61}[a-zA-Z0-9]?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!$)){0,61}[a-zA-Z0-9]?)|(?:\[(?:(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\]))$/,"idn-email":/^("(?:(?:[!#-\[\]-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])|\\(?:[\t -\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))*"|(?:[!#-'\*\+\x2D\/-9=\?A-Z\^-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])(?:\.?(?:[!#-'\*\+\x2D\/-9=\?A-Z\^-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))*)@((?:[!#-'\*\+\x2D\/-9=\?A-Z\^-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])(?:\.?(?:[!#-'\*\+\x2D\/-9=\?A-Z\^-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))*|\[(?:[!-Z\^-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*\])$/,"ip-address":/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,ipv6:/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,uri:/^[a-zA-Z][a-zA-Z0-9+.-]*:[^\s]*$/,"uri-reference":/^(((([A-Za-z][+\-.0-9A-Za-z]*(:%[0-9A-Fa-f]{2}|:[!$&-.0-;=?-Z_a-z~]|[/?])|\?)(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|([A-Za-z][+\-.0-9A-Za-z]*:?)?)|([A-Za-z][+\-.0-9A-Za-z]*:)?\/((%[0-9A-Fa-f]{2}|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?[/?]|[!$&-.0-;=?-Z_a-z~])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|(\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?)?))#(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|(([A-Za-z][+\-.0-9A-Za-z]*)?%[0-9A-Fa-f]{2}|[!$&-.0-9;=@_~]|[A-Za-z][+\-.0-9A-Za-z]*[!$&-*,;=@_~])(%[0-9A-Fa-f]{2}|[!$&-.0-9;=@-Z_a-z~])*((([/?](%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*)?#|[/?])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*)?|([A-Za-z][+\-.0-9A-Za-z]*(:%[0-9A-Fa-f]{2}|:[!$&-.0-;=?-Z_a-z~]|[/?])|\?)(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|([A-Za-z][+\-.0-9A-Za-z]*:)?\/((%[0-9A-Fa-f]{2}|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?[/?]|[!$&-.0-;=?-Z_a-z~])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+(:\d*)?|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?:\d*|\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)?|[A-Za-z][+\-.0-9A-Za-z]*:?)?$/,iri:/^[a-zA-Z][a-zA-Z0-9+.-]*:[^\s]*$/,"iri-reference":/^(((([A-Za-z][\+\x2D\.0-9A-Za-z]*(:%[0-9A-Fa-f]{2}|:(?:[!\$&-\.0-;=\?-Z_a-z~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])|[\/\?])|\?)(%[0-9A-Fa-f]{2}|(?:[!\$&-;=\?-Z_a-z~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))*|([A-Za-z][\+\x2D\.0-9A-Za-z]*:?)?)|([A-Za-z][\+\x2D\.0-9A-Za-z]*:)?\/((%[0-9A-Fa-f]{2}|\/((%[0-9A-Fa-f]{2}|(?:[!\$&-\.0-9;=A-Z_a-z~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))+|(\[(([Vv][0-9A-Fa-f]+\.(?:[!\$&-\.0-;=A-Z_a-z~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)?|[\.0-:A-Fa-f]+)\])?)(:[0-9]*)?[\/\?]|(?:[!\$&-\.0-;=\?-Z_a-z~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))(%[0-9A-Fa-f]{2}|(?:[!\$&-;=\?-Z_a-z~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))*|(\/((%[0-9A-Fa-f]{2}|(?:[!\$&-\.0-9;=A-Z_a-z~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))+|(\[(([Vv][0-9A-Fa-f]+\.(?:[!\$&-\.0-;=A-Z_a-z~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)?|[\.0-:A-Fa-f]+)\])?)(:[0-9]*)?)?))#(%[0-9A-Fa-f]{2}|(?:[!\$&-;=\?-Z_a-z~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))*|(([A-Za-z][\+\x2D\.0-9A-Za-z]*)?%[0-9A-Fa-f]{2}|(?:[!\$&-\.0-9;=@_~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])|[A-Za-z][\+\x2D\.0-9A-Za-z]*(?:[!\$&-\*,;=@_~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))(%[0-9A-Fa-f]{2}|(?:[!\$&-\.0-9;=@-Z_a-z~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))*((([\/\?](%[0-9A-Fa-f]{2}|(?:[!\$&-;=\?-Z_a-z~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))*)?#|[\/\?])(%[0-9A-Fa-f]{2}|(?:[!\$&-;=\?-Z_a-z~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))*)?|([A-Za-z][\+\x2D\.0-9A-Za-z]*(:%[0-9A-Fa-f]{2}|:(?:[!\$&-\.0-;=\?-Z_a-z~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])|[\/\?])|\?)(%[0-9A-Fa-f]{2}|(?:[!\$&-;=\?-Z_a-z~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))*|([A-Za-z][\+\x2D\.0-9A-Za-z]*:)?\/((%[0-9A-Fa-f]{2}|\/((%[0-9A-Fa-f]{2}|(?:[!\$&-\.0-9;=A-Z_a-z~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))+|(\[(([Vv][0-9A-Fa-f]+\.(?:[!\$&-\.0-;=A-Z_a-z~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)?|[\.0-:A-Fa-f]+)\])?)(:[0-9]*)?[\/\?]|(?:[!\$&-\.0-;=\?-Z_a-z~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))(%[0-9A-Fa-f]{2}|(?:[!\$&-;=\?-Z_a-z~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))*|\/((%[0-9A-Fa-f]{2}|(?:[!\$&-\.0-9;=A-Z_a-z~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))+(:[0-9]*)?|(\[(([Vv][0-9A-Fa-f]+\.(?:[!\$&-\.0-;=A-Z_a-z~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)?|[\.0-:A-Fa-f]+)\])?:[0-9]*|\[(([Vv][0-9A-Fa-f]+\.(?:[!\$&-\.0-;=A-Z_a-z~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)?|[\.0-:A-Fa-f]+)\])?)?|[A-Za-z][\+\x2D\.0-9A-Za-z]*:?)?$/,uuid:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i,"uri-template":/(%[0-9a-f]{2}|[!#\$&\(-;=\?@\[\]_a-z~\u017F\u212A]|\{[!#&\+,\.\/;=\?@\|]?(%[0-9a-f]{2}|[0-9_a-z\u017F\u212A])(\.?(%[0-9a-f]{2}|[0-9_a-z\u017F\u212A]))*(:[1-9][0-9]{0,3}|\*)?(,(%[0-9a-f]{2}|[0-9_a-z\u017F\u212A])(\.?(%[0-9a-f]{2}|[0-9_a-z\u017F\u212A]))*(:[1-9][0-9]{0,3}|\*)?)*\})*/i,"json-pointer":/^(\/([\0-\.0-@\[-\}\x7F\u017F\u212A]|~[01])*)*$/i,"relative-json-pointer":/^[0-9]+(#|(\/([\0-\.0-@\[-\}\x7F\u017F\u212A]|~[01])*)*)$/i,hostname:/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,"host-name":/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,"utc-millisec":function(e){return"string"===typeof e&&parseFloat(e)===parseInt(e,10)&&!isNaN(e)},regex:function(e){var t=!0;try{new RegExp(e)}catch(r){t=!1}return t},style:/[\r\n\t ]*[^\r\n\t ][^:]*:[\r\n\t ]*[^\r\n\t ;]*[\r\n\t ]*;?/,color:/^(#?([0-9A-Fa-f]{3}){1,2}\b|aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|(rgb\(\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*\))|(rgb\(\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*\)))$/,phone:/^\+(?:[0-9] ?){6,14}[0-9]$/,alpha:/^[a-zA-Z]+$/,alphanumeric:/^[a-zA-Z0-9]+$/};l.regexp=l.regex,l.pattern=l.regex,l.ipv4=l["ip-address"],t.isFormat=function(e,t,r){if("string"===typeof e&&void 0!==l[t]){if(l[t]instanceof RegExp)return l[t].test(e);if("function"===typeof l[t])return l[t](e)}else if(r&&r.customFormats&&"function"===typeof r.customFormats[t])return r.customFormats[t](e);return!0};var p=t.makeSuffix=function(e){return(e=e.toString()).match(/[.\s\[\]]/)||e.match(/^[\d]/)?e.match(/^\d+$/)?"["+e+"]":"["+JSON.stringify(e)+"]":"."+e};function d(e,t,r,n){"object"===typeof r?t[n]=m(e[n],r):-1===e.indexOf(r)&&t.push(r)}function h(e,t,r){t[r]=e[r]}function f(e,t,r,n){"object"===typeof t[n]&&t[n]&&e[n]?r[n]=m(e[n],t[n]):r[n]=t[n]}function m(e,t){var r=Array.isArray(t),n=r&&[]||{};return r?(e=e||[],n=n.concat(e),t.forEach(d.bind(null,e,n))):(e&&"object"===typeof e&&Object.keys(e).forEach(h.bind(null,e,n)),Object.keys(t).forEach(f.bind(null,e,t,n))),n}function F(e){return"/"+encodeURIComponent(e).replace(/~/g,"%7E")}t.deepCompareStrict=function e(t,r){if(typeof t!==typeof r)return!1;if(Array.isArray(t))return!!Array.isArray(r)&&(t.length===r.length&&t.every((function(n,i){return e(t[i],r[i])})));if("object"===typeof t){if(!t||!r)return t===r;var n=Object.keys(t),i=Object.keys(r);return n.length===i.length&&n.every((function(n){return e(t[n],r[n])}))}return t===r},e.exports.deepMerge=m,t.objectGetPath=function(e,t){for(var r,n=t.split("/").slice(1);"string"==typeof(r=n.shift());){var i=decodeURIComponent(r.replace(/~0/,"~").replace(/~1/g,"/"));if(!(i in e))return;e=e[i]}return e},t.encodePath=function(e){return e.map(F).join("")},t.getDecimalPlaces=function(e){var t=0;if(isNaN(e))return t;"number"!==typeof e&&(e=Number(e));var r=e.toString().split("e");if(2===r.length){if("-"!==r[1][0])return t;t=Number(r[1].slice(1))}var n=r[0].split(".");return 2===n.length&&(t+=n[1].length),t},t.isSchema=function(e){return"object"===typeof e&&e||"boolean"===typeof e}},34984:function(e,t,r){var n=e.exports.Validator=r(54390);r(53137).ValidatorResult,r(53137).ValidatorResultError,r(53137).ValidationError,r(53137).SchemaError,r(98849),r(98849).R},98849:function(e,t,r){var n=r(12114),i=r(53137);function a(e,t){this.id=e,this.ref=t}e.exports.R=function(e,t){function r(e,t){if(t&&"object"==typeof t)if(t.$ref){var a=n.resolve(e,t.$ref);c[a]=c[a]?c[a]+1:0}else{var l=t.$id||t.id,p=l?n.resolve(e,l):e;if(p){if(p.indexOf("#")<0&&(p+="#"),u[p]){if(!i.deepCompareStrict(u[p],t))throw new Error("Schema <"+p+"> already exists with different definition");return u[p]}u[p]=t,"#"==p[p.length-1]&&(u[p.substring(0,p.length-1)]=t)}s(p+"/items",Array.isArray(t.items)?t.items:[t.items]),s(p+"/extends",Array.isArray(t.extends)?t.extends:[t.extends]),r(p+"/additionalItems",t.additionalItems),o(p+"/properties",t.properties),r(p+"/additionalProperties",t.additionalProperties),o(p+"/definitions",t.definitions),o(p+"/patternProperties",t.patternProperties),o(p+"/dependencies",t.dependencies),s(p+"/disallow",t.disallow),s(p+"/allOf",t.allOf),s(p+"/anyOf",t.anyOf),s(p+"/oneOf",t.oneOf),r(p+"/not",t.not)}}function s(e,t){if(Array.isArray(t))for(var n=0;n<t.length;n++)r(e+"/"+n,t[n])}function o(e,t){if(t&&"object"==typeof t)for(var n in t)r(e+"/"+n,t[n])}var u={},c={};return r(e,t),new a(u,c)}},54390:function(e,t,r){var n=r(12114),i=r(50109),a=r(53137),s=r(98849).R,o=a.ValidatorResult,u=a.ValidatorResultError,c=a.SchemaError,l=a.SchemaContext,p=function e(){this.customFormats=Object.create(e.prototype.customFormats),this.schemas={},this.unresolvedRefs=[],this.types=Object.create(h),this.attributes=Object.create(i.validators)};function d(e){var t="string"===typeof e?e:e.$ref;return"string"==typeof t&&t}p.prototype.customFormats={},p.prototype.schemas=null,p.prototype.types=null,p.prototype.attributes=null,p.prototype.unresolvedRefs=null,p.prototype.addSchema=function(e,t){var r=this;if(!e)return null;var n=s(t||"/",e),i=t||e.$id||e.id;for(var a in n.id)this.schemas[a]=n.id[a];for(var a in n.ref)this.unresolvedRefs.push(a);return this.unresolvedRefs=this.unresolvedRefs.filter((function(e){return"undefined"===typeof r.schemas[e]})),this.schemas[i]},p.prototype.addSubSchemaArray=function(e,t){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addSubSchema(e,t[r])},p.prototype.addSubSchemaObject=function(e,t){if(t&&"object"==typeof t)for(var r in t)this.addSubSchema(e,t[r])},p.prototype.setSchemas=function(e){this.schemas=e},p.prototype.getSchema=function(e){return this.schemas[e]},p.prototype.validate=function(e,t,r,i){if("boolean"!==typeof t&&"object"!==typeof t||null===t)throw new c("Expected `schema` to be an object or boolean");r||(r={});var a,p=t.$id||t.id,d=n.resolve(r.base||"/",p||"");if(!i){(i=new l(t,r,[],d,Object.create(this.schemas))).schemas[d]||(i.schemas[d]=t);var h=s(d,t);for(var f in h.id){var m=h.id[f];i.schemas[f]=m}}if(r.required&&void 0===e)return(a=new o(e,t,r,i)).addError("is required, but is undefined"),a;if(!(a=this.validateSchema(e,t,r,i)))throw new Error("Result undefined");if(r.throwAll&&a.errors.length)throw new u(a);return a},p.prototype.validateSchema=function(e,t,r,n){var s=new o(e,t,r,n);if("boolean"===typeof t)!0===t?t={}:!1===t&&(t={type:[]});else if(!t)throw new Error("schema is undefined");if(t.extends)if(Array.isArray(t.extends)){var u={schema:t,ctx:n};t.extends.forEach(this.schemaTraverser.bind(this,u)),t=u.schema,u.schema=null,u.ctx=null,u=null}else t=a.deepMerge(t,this.superResolve(t.extends,n));var p=d(t);if(p){var h=this.resolve(t,p,n),f=new l(h.subschema,r,n.path,h.switchSchema,n.schemas);return this.validateSchema(e,h.subschema,r,f)}var m=r&&r.skipAttributes||[];for(var F in t)if(!i.ignoreProperties[F]&&m.indexOf(F)<0){var y=null,v=this.attributes[F];if(v)y=v.call(this,e,t,r,n);else if(!1===r.allowUnknownAttributes)throw new c("Unsupported attribute: "+F,t);y&&s.importErrors(y)}if("function"==typeof r.rewrite){var g=r.rewrite.call(this,e,t,r,n);s.instance=g}return s},p.prototype.schemaTraverser=function(e,t){e.schema=a.deepMerge(e.schema,this.superResolve(t,e.ctx))},p.prototype.superResolve=function(e,t){var r=d(e);return r?this.resolve(e,r,t).subschema:e},p.prototype.resolve=function(e,t,r){if(t=r.resolve(t),r.schemas[t])return{subschema:r.schemas[t],switchSchema:t};var i=n.parse(t),s=i&&i.hash,o=s&&s.length&&t.substr(0,t.length-s.length);if(!o||!r.schemas[o])throw new c("no such schema <"+t+">",e);var u=a.objectGetPath(r.schemas[o],s.substr(1));if(void 0===u)throw new c("no such schema "+s+" located in <"+o+">",e);return{subschema:u,switchSchema:t}},p.prototype.testType=function(e,t,r,n,i){if(void 0!==i){if(null===i)throw new c('Unexpected null in "type" keyword');if("function"==typeof this.types[i])return this.types[i].call(this,e);if(i&&"object"==typeof i){var a=this.validateSchema(e,i,r,n);return void 0===a||!(a&&a.errors.length)}return!0}};var h=p.prototype.types={};h.string=function(e){return"string"==typeof e},h.number=function(e){return"number"==typeof e&&isFinite(e)},h.integer=function(e){return"number"==typeof e&&e%1===0},h.boolean=function(e){return"boolean"==typeof e},h.array=function(e){return Array.isArray(e)},h.null=function(e){return null===e},h.date=function(e){return e instanceof Date},h.any=function(e){return!0},h.object=function(e){return e&&"object"===typeof e&&!Array.isArray(e)&&!(e instanceof Date)},e.exports=p}}]);
//# sourceMappingURL=fluid-debugger.76cefa11.chunk.js.map