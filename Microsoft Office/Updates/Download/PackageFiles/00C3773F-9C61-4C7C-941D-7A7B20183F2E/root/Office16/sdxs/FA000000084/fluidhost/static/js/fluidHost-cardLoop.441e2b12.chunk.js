"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[9110],{48278:function(e,n,t){t.r(n),t.d(n,{getCardChanelProvider:function(){return ee},getCodeLoaderFactory:function(){return te},getMetaOSProvider:function(){return ne},getUrlHandlerProvider:function(){return ie}});var r=t(74165),i=t(15861),a=t(52820),o=t(17842),u=t(15671),s=t(43144);function c(e){var n,t,r,i,a,o,u,s,c,l,p,d,v,f,h,w,y,x,k=e.titleDefinition,g=null===k||void 0===k?void 0:k.elementDefinitions;if(Array.isArray(g)){var Z=g.find((function(e){return"ComposeExtensions"===e.elementType}));if(null!==Z&&void 0!==Z&&Z.definition){var b=JSON.parse(Z.definition);y=Array.isArray(b)?b:[b]}}else y=null===g||void 0===g?void 0:g.composeExtensions;switch(null===e||void 0===e?void 0:e.acquisitionState){case"Acquired":case"NeedsConsentForUpgrade":default:x="Installed";break;case"Blocked":x="Blocked";break;case"Unacquired":x="NotInstalled"}return{id:null!==(n=e.appId)&&void 0!==n?n:"",manifestVersion:null!==(t=null===k||void 0===k?void 0:k.manifestVersion)&&void 0!==t?t:"",version:null===k||void 0===k?void 0:k.version,categories:null!==(r=null===k||void 0===k?void 0:k.categories)&&void 0!==r?r:[],developerName:null!==(i=null===k||void 0===k?void 0:k.developerName)&&void 0!==i?i:"",developerUrl:null!==(a=null===k||void 0===k?void 0:k.developerUrl)&&void 0!==a?a:"",externalId:null!==(o=e.manifestId)&&void 0!==o?o:"",termsOfUseUrl:null!==(u=null===k||void 0===k?void 0:k.termsOfUseUrl)&&void 0!==u?u:"",privacyUrl:null!==(s=null===k||void 0===k?void 0:k.privacyUrl)&&void 0!==s?s:"",validDomains:null!==(c=null===k||void 0===k?void 0:k.validDomains)&&void 0!==c?c:[],isFullScreen:!1,devicePermissions:[],isFullTrust:null!==(l=null===k||void 0===k?void 0:k.isFullTrust)&&void 0!==l&&l,inputExtensions:y,showLoadingIndicator:null!==(p=!(null===k||void 0===k||!k.showLoadingIndicator))&&void 0!==p&&p,shortDescription:null===k||void 0===k?void 0:k.shortDescription,longDescription:null===k||void 0===k?void 0:k.longDescription,largeImageUrl:null!==(d=null===k||void 0===k||null===(v=k.iconLarge)||void 0===v?void 0:v.uri)&&void 0!==d?d:"",smallImageUrl:null!==(f=null===k||void 0===k||null===(h=k.iconSmall)||void 0===h?void 0:h.uri)&&void 0!==f?f:"",name:null!==(w=null===k||void 0===k?void 0:k.name)&&void 0!==w?w:"",state:x}}function l(e){var n;return{appId:null!==(n=null===e||void 0===e?void 0:e.id)&&void 0!==n?n:"",validDomains:(null===e||void 0===e?void 0:e.validDomains)||[],showTabLoadingIndicator:!(null===e||void 0===e||!e.showLoadingIndicator),version:(null===e||void 0===e?void 0:e.version)||""}}function p(e){return"titleId"in e}var d=t(62190),v=12e4,f=1e4,h=6e5,w=3e5,y=12e4,x=3e5,k=function(e){return e[e.BotInvoke=1]="BotInvoke",e[e.OpenAuthWindow=2]="OpenAuthWindow",e[e.VerifyCard=3]="VerifyCard",e[e.GetAppFromAppId=4]="GetAppFromAppId",e[e.GetImage=5]="GetImage",e[e.OpenUrlAction=7]="OpenUrlAction",e[e.AnchorClicked=11]="AnchorClicked",e[e.SSOToken=17]="SSOToken",e[e.InstallApp=18]="InstallApp",e[e.EmbedCard=19]="EmbedCard",e[e.OpenStageView=20]="OpenStageView",e[e.OpenTaskModule=21]="OpenTaskModule",e}({}),g="Unable to get app definition!",Z="No botId found",b="SSO token fetch failed",m="Unable to complete action",I=t(1413),A=t(53748),C=t(52230),U=t(14423);function D(e,n,t,r,i){return O.apply(this,arguments)}function O(){return(O=(0,i.Z)((0,r.Z)().mark((function e(n,t,i,a,o){var u,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a&&(i.value.state=a),o&&(i.value.authentication={token:o}),u=(0,I.Z)((0,I.Z)({},G()),{},{payload:{appId:n,botId:t,requestBody:i}}),e.next=5,(0,C.O$)(k.BotInvoke,u);case 5:return s=e.sent,e.abrupt("return",s);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){return z.apply(this,arguments)}function z(){return(z=(0,i.Z)((0,r.Z)().mark((function e(n){var t,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,I.Z)((0,I.Z)({},G(y)),{},{payload:{resource:n}}),e.next=3,(0,C.O$)(k.SSOToken,t);case 3:return i=e.sent,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e){return N.apply(this,arguments)}function N(){return(N=(0,i.Z)((0,r.Z)().mark((function e(n){var t,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,I.Z)((0,I.Z)({},G()),{},{payload:{appId:n}}),e.next=3,(0,C.O$)(k.GetAppFromAppId,t);case 3:return i=e.sent,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(e,n){return P.apply(this,arguments)}function P(){return(P=(0,i.Z)((0,r.Z)().mark((function e(n,t){var i,a,o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=l(t),a=(0,I.Z)((0,I.Z)({},G(v)),{},{payload:{authConfigUrl:n,hubAppDefinition:i}}),e.next=4,(0,C.O$)(k.OpenAuthWindow,a);case 4:return o=e.sent,e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e){return R.apply(this,arguments)}function R(){return(R=(0,i.Z)((0,r.Z)().mark((function e(n){var t,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,I.Z)((0,I.Z)({},G(w)),{},{payload:{appId:n}}),e.next=3,(0,C.O$)(k.InstallApp,t);case 3:return i=e.sent,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(e,n){return M.apply(this,arguments)}function M(){return(M=(0,i.Z)((0,r.Z)().mark((function e(n,t){var i,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,I.Z)((0,I.Z)({},G(x)),{},{payload:{appId:null!==(i=t.appId)&&void 0!==i?i:t.deepLinkAppId,botId:n,stageInfo:t.stageInfo}}),e.next=3,(0,C.O$)(k.OpenStageView,a);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e){return F.apply(this,arguments)}function F(){return(F=(0,i.Z)((0,r.Z)().mark((function e(n){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,I.Z)((0,I.Z)({},G()),{},{payload:{url:n}}),e.next=3,(0,C.O$)(k.OpenUrlAction,t);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(e){return $.apply(this,arguments)}function $(){return($=(0,i.Z)((0,r.Z)().mark((function e(n){var t,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,I.Z)((0,I.Z)({},G()),{},{payload:{appId:n.appId,cardId:n.cardId,contentType:n.cardType,content:n.payload,signature:n.signature,serializedContent:JSON.stringify(n.payload),verificationStatus:n.verificationStatus}}),e.next=3,(0,C.O$)(k.VerifyCard,t);case 3:return i=e.sent,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(e){if(!e.composeExtension)throw new d.gz("No compose extensions found");try{var n=e.composeExtension.type;switch(n){case"result":var t=e.composeExtension.attachments,r=null===t||void 0===t?void 0:t[0];if(!r)throw new d.gz("Attachments not defined for successful unfurl");return{cardType:r.contentType,payload:r.content,signature:r.signature,fallbackHtml:r.fallbackHtml};case"silentAuth":return{cardType:"SignInCard",payload:{type:"silentAuth",requiresUserConsent:!1}};case"auth":var i,a=e.composeExtension.suggestedActions,o=null===a||void 0===a||null===(i=a.actions)||void 0===i?void 0:i[0].value;if(!o)throw new d.gz("Url not present for Nominal auth response");return{cardType:"SignInCard",payload:{type:"auth",authUrl:new URL(o)}};default:throw new d.gz("Unknown response type: ".concat(n))}}catch(u){throw new d.gz("Error while parsing the Unfurl response",u)}}function G(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f;return U.yG&&(e=h),{requestContext:{id:(0,A.u)(),timeoutDurationInMS:e},payload:{}}}var H=function(){function e(){(0,u.Z)(this,e),this.appDefinition=void 0}return(0,s.Z)(e,[{key:"CardChannelProvider",get:function(){return this}},{key:"unfurl",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(n,t,i,a){var o,u,s,l,v,f,h,w,y,x;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.appDefinition){e.next=9;break}return e.next=3,E(t);case 3:if(s=e.sent,l=null===s||void 0===s?void 0:s.requestContext.rejectionReason,s&&!l){e.next=7;break}throw new d.gz(null!==l&&void 0!==l?l:g);case 7:v=s.payload,this.appDefinition=p(v)?c(v):v;case 9:if(f=null===(o=this.appDefinition.inputExtensions)||void 0===o||null===(u=o[0])||void 0===u?void 0:u.botId){e.next=12;break}throw new d.gz(Z);case 12:return h={name:"composeExtension/queryLink",value:{url:n.href}},e.next=15,D(t,f,h,i,a);case 15:if(w=e.sent,y=null===w||void 0===w?void 0:w.requestContext.rejectionReason,w&&!y){e.next=19;break}throw new d.gz(null!==y&&void 0!==y?y:m);case 19:return x=B(w.payload),e.abrupt("return",x);case 21:case"end":return e.stop()}}),e,this)})));return function(n,t,r,i){return e.apply(this,arguments)}}()},{key:"executeAdaptiveCardAction",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(n){var t,i,a,o,u,s,l,v,f,h,w;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.cardDetails){e.next=3;break}throw new d.gz("No card details found");case 3:if(this.appDefinition){e.next=12;break}return e.next=6,E(a.appId);case 6:if(o=e.sent,u=null===o||void 0===o?void 0:o.requestContext.rejectionReason,o&&!u){e.next=10;break}throw new d.gz(null!==u&&void 0!==u?u:g);case 10:s=o.payload,this.appDefinition=p(s)?c(s):s;case 12:if(l=null===(t=this.appDefinition.inputExtensions)||void 0===t||null===(i=t[0])||void 0===i?void 0:i.botId){e.next=15;break}throw new d.gz(Z);case 15:return v={name:"adaptiveCard/action",type:"invoke",value:{action:{type:"Action.Execute",id:n.actionProps.id,verb:n.actionProps.verb,data:n.actionProps.data},trigger:n.trigger},cardId:a.cardId,contentType:a.cardType,serializedContent:JSON.stringify(a.payload),signature:a.signature},e.next=18,D(a.appId,l,v,n.authCode,n.authToken);case 18:if(f=e.sent,h=null===f||void 0===f?void 0:f.requestContext.rejectionReason,f&&!h){e.next=22;break}throw new d.gz(null!==h&&void 0!==h?h:m);case 22:return w=f.payload,e.abrupt("return",{statusCode:String(w.statusCode),content:w.value,contentType:w.type,signature:w.signature});case 24:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"verifyCard",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(n){var t,i,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.updateExtension){e.next=2;break}throw new d.gz("Unable to verify without UpdateExtension data");case 2:if("updateExtendedProps"===n.updateExtension.type){e.next=4;break}throw new d.gz("Unable to verify without UpdateExtendedProps type");case 4:return e.next=6,V(n);case 6:if(i=e.sent,a=null===i||void 0===i?void 0:i.requestContext.rejectionReason,i&&!a){e.next=10;break}throw new d.gz(null!==a&&void 0!==a?a:"Unable to verify the card!");case 10:return e.abrupt("return",null===(t=i.payload.cards)||void 0===t?void 0:t[0].verificationStatus);case 11:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()}]),e}(),W=function(){function e(){(0,u.Z)(this,e),this.appDefinition=void 0}return(0,s.Z)(e,[{key:"MetaOSProvider",get:function(){return this}},{key:"getAppDefinition",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(n){var t,i,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.appDefinition){e.next=2;break}return e.abrupt("return",this.appDefinition);case 2:return e.next=4,E(n);case 4:if(t=e.sent,i=null===t||void 0===t?void 0:t.requestContext.rejectionReason,t&&!i){e.next=8;break}throw new d.gz(null!==i&&void 0!==i?i:g);case 8:return a=t.payload,this.appDefinition=p(a)?c(a):a,e.abrupt("return",this.appDefinition);case 11:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"getAppStatus",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(n){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.appDefinition){e.next=9;break}return e.prev=1,e.next=4,this.getAppDefinition(n);case 4:e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(1),e.abrupt("return","NotInstalled");case 9:e.t1=null===(t=this.appDefinition)||void 0===t?void 0:t.state,e.next="AdminPreInstalled"===e.t1||"Featured"===e.t1||"Installed"===e.t1||"InstalledAndDeprecated"===e.t1||"InstalledAndHidden"===e.t1||"InstalledAndPermanent"===e.t1||"PreConsented"===e.t1?12:"Blocked"===e.t1?13:"NotInstalled"===e.t1?14:15;break;case 12:case 15:return e.abrupt("return","Installed");case 13:return e.abrupt("return","Unknown");case 14:return e.abrupt("return","NotInstalled");case 16:case"end":return e.stop()}}),e,this,[[1,6]])})));return function(n){return e.apply(this,arguments)}}()},{key:"getAppInstalledStatus",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(n){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAppStatus(n);case 2:return t="NotAvailable"===(t=e.sent)||"Error"===t?"Unknown":t,e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"openAuth",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(n,t){var i,a,o,u,s,c;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=t.authUrl,a=t.tokenExchangeResourceUri,e.t0=t.type,e.next="auth"===e.t0?5:"silentAuth"===e.t0?14:23;break;case 5:if(i){e.next=7;break}throw new d.gz("No auth url found");case 7:return e.next=9,T(i.href,this.appDefinition);case 9:if(o=e.sent,u=null===o||void 0===o?void 0:o.requestContext.rejectionReason,o&&u){e.next=13;break}throw new d.gz(null!==u&&void 0!==u?u:b);case 13:return e.abrupt("return",{status:o.payload.success,message:o.payload.result});case 14:if(a&&"string"===typeof a){e.next=16;break}throw new d.gz("No resource url found");case 16:return e.next=18,S(a);case 18:if(s=e.sent,c=null===s||void 0===s?void 0:s.requestContext.rejectionReason,s&&c){e.next=22;break}throw new d.gz(null!==c&&void 0!==c?c:b);case 22:return e.abrupt("return",{status:s.payload.success,message:s.payload.result});case 23:return e.abrupt("return",{status:!1});case 24:case"end":return e.stop()}}),e,this)})));return function(n,t){return e.apply(this,arguments)}}()},{key:"installApp",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(n){var t,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q(n);case 2:return i=e.sent,e.abrupt("return",null!==i&&void 0!==i&&null!==(t=i.payload)&&void 0!==t&&t.success?"Installed":"NotInstalled");case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},{key:"openStageView",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(n){var t,i,a,o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.appDefinition){e.next=2;break}return e.abrupt("return");case 2:return o=null!==(t=null===(i=this.appDefinition.inputExtensions)||void 0===i||null===(a=i[0])||void 0===a?void 0:a.botId)&&void 0!==t?t:"",e.next=5,L(o,n);case 5:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()}]),e}(),J=function(){function e(){(0,u.Z)(this,e)}return(0,s.Z)(e,[{key:"UrlHandlerProvider",get:function(){return this}},{key:"onClick",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(n){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(n.href);case 2:return e.abrupt("return",!0);case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()}]),e}(),K=t(61960),X=t(88861),Q=t(72791),Y=t(54164),_=t(58320);function ee(){return new H}function ne(){return new W}function te(){return re.apply(this,arguments)}function re(){return(re=(0,i.Z)((0,r.Z)().mark((function e(){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,X.Lh)();case 2:return e.sent?((0,K.cM)("Using CDN code loader."),window||(0,K.cM)("Unable to prepare external dependencies. Window is not defined."),window.React=Q,window.ReactDOM=Y,window.LoopSDK=_,n=a.X):((0,K.cM)("Using NPM code loader."),n=o.j),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ie(){return new J}}}]);
//# sourceMappingURL=fluidHost-cardLoop.441e2b12.chunk.js.map