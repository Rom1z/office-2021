/*! For license information please see main.3276f88b.js.LICENSE.txt */
!function(){var e={39660:function(e,t,r){"use strict";r.d(t,{Q:function(){return f}});var n=r(74165),o=r(15861),i=r(15671),a=r(43144),s=r(14423),c=r(83978),u=r(61960),l=r(62190),d=r(75757),f=function(){function e(){(0,i.Z)(this,e),this.getTokenCallCount=0,this.getTokenTotalDuration=0}return(0,a.Z)(e,[{key:"TokenProvider",get:function(){return this}},{key:"getAppId",value:function(){return s.Jf}},{key:"getToken",value:function(){var e=(0,o.Z)((0,n.Z)().mark((function e(t,r){var o,i,a,f,h,p,v,g,m;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(++this.getTokenCallCount,o=d.g.startNew(),!(t&&t.length>0)){e.next=36;break}if(!(t[0]&&t[0].indexOf("/")>=0)){e.next=16;break}e.prev=4,a=new URL(t[0]),(f=a.pathname.lastIndexOf("/"))>0?(h=a.pathname.substring(0,f),a.pathname=h,i=a.href):i="".concat(a.protocol,"//").concat(a.hostname),e.next=14;break;case 10:throw e.prev=10,e.t0=e.catch(4),(0,l.w5)("getToken()",new l.gz("scopes resource url is invalid",e.t0)),new l.gz("scopes resource url is invalid");case 14:e.next=17;break;case 16:i="https://graph.microsoft.com";case 17:return e.prev=17,v=null===r||void 0===r?void 0:r.claims,g=null!==(p=null===r||void 0===r?void 0:r.forceRefresh)&&void 0!==p&&p,e.next=22,c.Z.GetInstance().getToken(i,v,g);case 22:if(m=e.sent,o.setSuccess(),this.getTokenTotalDuration+=o.getDuration(),!("fromCache"in m)){e.next=29;break}return e.abrupt("return",{token:m.token,fromCache:m.fromCache});case 29:return e.abrupt("return",{token:m.token});case 30:e.next=36;break;case 32:throw e.prev=32,e.t1=e.catch(17),s.Y8||(0,u.H)(e.t1),e.t1;case 36:throw new l.gz("No scopes provided to getToken");case 37:case"end":return e.stop()}}),e,this,[[4,10],[17,32]])})));return function(t,r){return e.apply(this,arguments)}}()}]),e}()},14423:function(e,t,r){"use strict";r.d(t,{EW:function(){return d},Ib:function(){return o},Ie:function(){return v},Jf:function(){return s},Kh:function(){return i},Nl:function(){return a},OP:function(){return n},Rp:function(){return h},UB:function(){return m},VP:function(){return f},Y8:function(){return l},gV:function(){return p},iJ:function(){return g},ju:function(){return b},mh:function(){return k},xf:function(){return y},yG:function(){return c},yv:function(){return u}});var n="fluidElement",o=".fluid",i=".loop",a="animatedSplashScreen",s="FluidHostWin32",c=!1,u=!0,l=!1,d=100,f="FormsLoop",h="fluidLink",p="componentPartHostingElementId",v=864e5,g=290,m=835,y=245,b="white solid 1px",k="black solid 1px"},61960:function(e,t,r){"use strict";r.d(t,{H:function(){return c},cM:function(){return u},yj:function(){return s}});var n,o=r(74165),i=r(15861),a=r(14423);function s(e){n=a.yG||e}function c(e){!0===n&&console.error(e)}function u(e){return l.apply(this,arguments)}function l(){return(l=(0,i.Z)((0,o.Z)().mark((function e(t){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:!0===n&&console.log(t);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},62190:function(e,t,r){"use strict";r.d(t,{CR:function(){return v},SS:function(){return m},e$:function(){return g},gz:function(){return p},w5:function(){return y}});var n=r(43144),o=r(15671),i=r(60136),a=r(29388),s=r(28664),c=r(11012),u=r(96914),l=r(14423),d=r(8280),f=r(61960),h=r(6232),p=function(e){(0,i.Z)(r,e);var t=(0,a.Z)(r);function r(e,n,i){var a;return(0,o.Z)(this,r),(a=t.call(this,e)).name=void 0,a.message=void 0,a.innerError=void 0,a.hydrateResult=void 0,a.name="AppError",a.message=e,a.innerError=n,a.hydrateResult=null!==i&&void 0!==i?i:h.l.Error_FluidHostWebApp_Exception,a}return(0,n.Z)(r)}((0,s.Z)(Error));function v(e){return e instanceof p?e:new p(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Exception occurred.",e)}function g(e){return"string"===typeof e?e:e instanceof Error?e.message:e instanceof PromiseRejectionEvent?e.reason:"".concat(e)}function m(e){return e instanceof p?e.message:""}function y(e,t){if(l.yG){var r=g(t);(0,f.H)("UNEXPECTED ERROR: ".concat(r))}else{var n={eventName:"Office.Extensibility.Fluid.HostWebAppErrors",eventFlags:{dataCategories:c.K.DataCategories.ProductServiceUsage,diagnosticLevel:c.K.DiagnosticLevel.FullEvent},dataFields:[(0,u.dt)("Message",m(t)),(0,u.dt)("Source",e)]};l.Y8||d.k.sendTelemetryEvent(n)}}},82863:function(e,t,r){"use strict";r.d(t,{Qj:function(){return l},f3:function(){return c},g6:function(){return d},mW:function(){return p},ol:function(){return v},z1:function(){return h},zS:function(){return u}});var n=r(74165),o=r(15861),i=r(72532),a=r(52230),s=r(55617);function c(e){(0,i.mx)((function(t){var r=t.detail.isDarkBackground;e.forEach((function(e){e(r)}))}))}function u(e){(0,i.oD)((function(t){var r=t.detail.newTheme,n=(0,s.$o)(r);e.forEach((function(e){e(n)}))}))}function l(e){(0,i.NN)((function(t){e(t.detail.documentUrl)}))}function d(e){return f.apply(this,arguments)}function f(){return(f=(0,o.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,i.xH)((function(e){t(e.detail.linkProblemState)})),e.next=3,(0,a.Gc)();case 3:(r=e.sent.linkProblemState)&&t(r);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){(0,i.zR)((function(t){t.detail.isPermissionError&&e(i.Nb.Error)}))}function p(e){(0,i.v6)((function(t){var r=t.detail.isContentHeightLimited;e(r)}))}function v(e){(0,i.JL)((function(t){var r=t.detail.showLoopGlowBorder;e(r)}))}},29331:function(e,t,r){"use strict";r.d(t,{GW:function(){return o},KF:function(){return s},MQ:function(){return a},Wx:function(){return i}});var n=r(29439),o=window.external;function i(){return o.GetContext?o.GetContext().GetAppUILocale():void 0}function a(){var e;return(null===(e=o.GetContext())||void 0===e?void 0:e.GetCorrelationId())||""}function s(){var e=(null===o||void 0===o?void 0:o.GetHostInfo()).split("="),t=(0,n.Z)(e,2)[1].split("$"),r=(0,n.Z)(t,2),i=r[0],a=r[1],s="string"===typeof a?a:"";return{appName:"string"===typeof i?i:"Unknown",appVersion:(null===o||void 0===o?void 0:o.GetContext().GetHostFullVersion())||"",platform:s}}},88861:function(e,t,r){"use strict";r.d(t,{$G:function(){return p},Bm:function(){return l.Bm},H8:function(){return g},Lh:function(){return y},SZ:function(){return h},UG:function(){return i},UT:function(){return l.UT},VS:function(){return x},XA:function(){return k},dT:function(){return l.dT},g2:function(){return E},p:function(){return C},xO:function(){return l.xO}});var n,o,i,a,s=r(74165),c=r(15861),u=r(62190),l=r(52230),d=r(50224),f=r(61960),h=function(e){return e.OEP="OEP",e}({});function p(){return v.apply(this,arguments)}function v(){return(v=(0,c.Z)((0,s.Z)().mark((function e(){var t,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.g)();case 2:return r=e.sent,e.abrupt("return",null!==(t=null===r||void 0===r?void 0:r.loopComponentPropertiesAreEnabled)&&void 0!==t&&t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(){return m.apply(this,arguments)}function m(){return(m=(0,c.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n||(n=(0,l.UT)(h.OEP,"ChangeGate.FluidOutlook.HandleAuthChallengeFromFetch")),e.abrupt("return",n);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(){return b.apply(this,arguments)}function b(){return(b=(0,c.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o||(o=(0,l.Bm)(h.OEP,"FluidHost.IsCardLoopCdnCodeLoaderEnabled")),e.abrupt("return",o);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(){return S.apply(this,arguments)}function S(){return(S=(0,c.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i||(i=(0,l.UT)(h.OEP,"ChangeGate.FluidHost.DependencySynthesizerChange")),e.abrupt("return",i);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(){return w.apply(this,arguments)}function w(){return(w=(0,c.Z)((0,s.Z)().mark((function e(){var t,r,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.g)();case 2:return r=e.sent,(n=null!==(t=null===r||void 0===r?void 0:r.useGenericLoader)&&void 0!==t&&t)&&(0,f.cM)("Generic loader is enabled."),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(){return P.apply(this,arguments)}function P(){return(P=(0,c.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a||(a=(0,l.UT)(h.OEP,"FluidHost.IsSaveEmbeddedDataEnabled")),e.abrupt("return",a);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e,t){if(!t||t.startsWith(".")||t.endsWith(".")||t.startsWith("Microsoft.Office."))throw new u.gz("The feature name is not valid.");return"Microsoft.Office.".concat(e,".").concat(t)}},56058:function(e,t,r){"use strict";r.d(t,{r:function(){return Wa}});var n=r(74165),o=r(29439),i=r(15861),a=r(56061);function s(e){var t=(0,a.KT)(e);if(t){var r;try{(null===t||void 0===t?void 0:t.siteUrl)&&(r=new URL(null===t||void 0===t?void 0:t.siteUrl).origin)}catch(n){}return{codeDetailsHint:null===t||void 0===t?void 0:t.containerPackageName,criticalBootDomains:r?[r]:void 0}}}var c=r(43144),u=r(15671),l=r(75489),d=r(54555),f=["mousemove","keydown","wheel","DOMMouseScroll","mouseWheel","mousedown","touchstart","touchmove","MSPointerDown","MSPointerMove","visibilitychange"],h=function(){function e(t,r,n){var o=this;(0,u.Z)(this,e),this.timeoutMs=t,this.onUserActivityStateChange=r,this.logger=n,this.isActive=!0,this.userActivityCallback=function(){o.onUserActivityDetected()},f.forEach((function(e){document.addEventListener(e,o.userActivityCallback,{passive:!0,capture:!1})})),this.startUserInactiveTimer()}return(0,c.Z)(e,[{key:"isUserActive",get:function(){return this.isActive}},{key:"dispose",value:function(){var e=this;this.isActive=!0,clearTimeout(this.userInactiveTimerId),f.forEach((function(t){document.removeEventListener(t,e.userActivityCallback,{capture:!1})}))}},{key:"onUserActivityDetected",value:function(){this.isActive||(this.isActive=!0,this.onUserActivityStateChange(!0),this.logger&&(0,l.ve)(this.logger,{eventName:"UserActive"})),this.resetUserInactiveTimer()}},{key:"resetUserInactiveTimer",value:function(){clearTimeout(this.userInactiveTimerId),this.startUserInactiveTimer()}},{key:"startUserInactiveTimer",value:function(){var e=this;this.userInactiveTimerId=setTimeout((function(){e.isActive=!1,e.onUserActivityStateChange(!1),e.logger&&(0,l.ve)(e.logger,{eventName:"UserInactive"})}),this.timeoutMs)}}]),e}(),p=(0,c.Z)((function e(t){var r=this;(0,u.Z)(this,e),this.heartbeatSendTimerId=void 0,this.onUserActivityStateChanged=function(e){e?r.resume():r.stop()},this.registerSessionEndingErrorObserver=function(e){(0,i.Z)((0,n.Z)().mark((function t(){var o;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e;case 3:(o=t.sent).component.catch((function(){return r.dispose()})),o.container.then((function(e){e.on("closed",(function(){r.dispose()}))})).catch((function(){r.dispose()})),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),r.dispose();case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},this.stop=function(){r.clearHeartbeatSendTimer()},this.resume=function(){r.sendHeartbeatAndReQueue()},this.queueHeartbeat=function(){r.heartbeatSendTimerId=window.setTimeout((function(){r.sendHeartbeatAndReQueue()}),e.heartbeatIntervalMs)},this.sendHeartbeatAndReQueue=function(){r.heartbeatLogger&&(0,l.ve)(r.heartbeatLogger,{eventName:"Heartbeat"}),r.queueHeartbeat()},this.clearHeartbeatSendTimer=function(){window.clearTimeout(r.heartbeatSendTimerId),r.heartbeatSendTimerId=void 0},this.dispose=function(){var e;r.stop(),null===(e=r.userActivityTracker)||void 0===e||e.dispose(),r.heartbeatLogger=void 0},this.heartbeatLogger=new d.g("Heartbeat",t),this.sendHeartbeatAndReQueue(),this.userActivityTracker=new h(e.userInactiveAfterMs,this.onUserActivityStateChanged)}));p.heartbeatIntervalMs=3e5,p.userInactiveAfterMs=3e5;var v=r(62190),g=r(88861),m=r(4942),y=r(65452),b=r(89175);function k(e,t,r,n,o){var i=(0,b.Wd)(o);return{url:"".concat(e,"?driveId=").concat(encodeURIComponent(t),"&path=").concat(encodeURIComponent(r)).concat(i?"&".concat(i):""),headers:(0,m.Z)({},y.i.createNew,{fileName:n})}}var S=r(11503),C=r(36690),w=r(1413),x=function(e){return"object"===typeof e&&"string"===typeof(null===e||void 0===e?void 0:e.name)&&"object"===typeof(null===e||void 0===e?void 0:e.fluid)},P=function(e){var t=e;return"object"===typeof t&&("string"===typeof(null===t||void 0===t?void 0:t.package)||x(null===t||void 0===t?void 0:t.package))&&(void 0===(null===t||void 0===t?void 0:t.config)||"object"===typeof(null===t||void 0===t?void 0:t.config))},E=r(46569),Z=r(44925),T=r(42437),N="13.20.0",F=r(76890);function I(){var e;return!("1"!==(null===(e=(0,F.E)())||void 0===e?void 0:e.FluidDebugger))}var B,D=r(97180),A=["logger"];function O(e){var t=Date.now(),r=(0,T.n3)(),n=e.logger,o=(0,Z.Z)(e,A);return{logger:n&&new d.g(D.gL,n,{isReplay:I()||void 0,owhVersion:N}),newConfig:o,perfMetadata:{fluidBootstrapperStartTime:t},documentHiddenTrackerId:r}}var L=function(){function e(){var t=this;(0,u.Z)(this,e),this[B]="Deferred",this.isPending=!0,this.p=new Promise((function(e,r){t.res=e,t.rej=r}))}return(0,c.Z)(e,[{key:"then",value:function(e,t){return this.p.then(e,t)}},{key:"catch",value:function(e){return this.p.catch(e)}},{key:"resolve",value:function(e){this.isPending=!1,this.res(e)}},{key:"reject",value:function(e){this.isPending=!1,this.rej(e)}},{key:"pending",value:function(){return this.isPending}},{key:"finally",value:function(e){return this.p.finally(e)}}]),e}();B=Symbol.toStringTag;var _={afZa:"af-za",amEt:"am-et",arSa:"ar-sa",asIn:"as-in",azLatnAz:"az-latn-az",bgBg:"bg-bg",bnIn:"bn-in",bsLatnBa:"bs-latn-ba",caEs:"ca-es",caEsValencia:"ca-es-valencia",csCz:"cs-cz",cyGb:"cy-gb",daDk:"da-dk",deDe:"de-de",elGr:"el-gr",enGb:"en-gb",enUs:"en-us",esEs:"es-es",esMx:"es-mx",etEe:"et-ee",euEs:"eu-es",faIr:"fa-ir",fiFi:"fi-fi",filPh:"fil-ph",frCa:"fr-ca",frFr:"fr-fr",gaIe:"ga-ie",gdGb:"gd-gb",glEs:"gl-es",guIn:"gu-in",heIl:"he-il",hiIn:"hi-in",hrHr:"hr-hr",huHu:"hu-hu",hyAm:"hy-am",idId:"id-id",isIs:"is-is",itIt:"it-it",jaJp:"ja-jp",kaGe:"ka-ge",kkKz:"kk-kz",kmKh:"km-kh",knIn:"kn-in",kokIn:"kok-in",koKr:"ko-kr",lbLu:"lb-lu",loLa:"lo-la",ltLt:"lt-lt",lvLv:"lv-lv",miNz:"mi-nz",mkMk:"mk-mk",mlIn:"ml-in",mrIn:"mr-in",msMy:"ms-my",mtMt:"mt-mt",nbNo:"nb-no",neNp:"ne-np",nlNl:"nl-nl",nnNo:"nn-no",orIn:"or-in",paIn:"pa-in",plPl:"pl-pl",ptBr:"pt-br",ptPt:"pt-pt",quzPe:"quz-pe",roRo:"ro-ro",ruRu:"ru-ru",skSk:"sk-sk",slSi:"sl-si",sqAl:"sq-al",srCyrlBa:"sr-cyrl-ba",srCyrlRs:"sr-cyrl-rs",srLatnRs:"sr-latn-rs",svSe:"sv-se",taIn:"ta-in",teIn:"te-in",thTh:"th-th",trTr:"tr-tr",ttRu:"tt-ru",ugCn:"ug-cn",ukUa:"uk-ua",urPk:"ur-pk",viVn:"vi-vn",zhCn:"zh-cn",zhTw:"zh-tw"},M={af:_.afZa,am:_.amEt,ar:_.arSa,as:_.asIn,az:_.azLatnAz,bg:_.bgBg,bn:_.enGb,bs:_.bsLatnBa,"bs-cyrl-ba":_.enGb,ca:_.caEs,cs:_.csCz,cy:_.cyGb,da:_.daDk,de:_.deDe,el:_.elGr,"el-cy":_.enGb,en:_.enUs,es:_.esEs,et:_.etEe,eu:_.euEs,fa:_.faIr,fi:_.fiFi,fil:_.filPh,fr:_.frFr,ga:_.gaIe,gd:_.gdGb,gl:_.glEs,gu:_.guIn,he:_.heIl,hi:_.hiIn,hr:_.hrHr,hu:_.huHu,hy:_.hyAm,id:_.idId,is:_.isIs,it:_.itIt,iw:_.heIl,"iw-il":_.heIl,ja:_.jaJp,ka:_.kaGe,kk:_.kkKz,km:_.kmKh,kn:_.knIn,ko:_.koKr,kok:_.kokIn,lb:_.lbLu,lo:_.loLa,lt:_.ltLt,lv:_.lvLv,mi:_.miNz,mk:_.mkMk,ml:_.mlIn,mr:_.mrIn,ms:_.msMy,mt:_.mtMt,nb:_.nbNo,ne:_.neNp,nl:_.nlNl,nn:_.nnNo,or:_.orIn,pa:_.paIn,pl:_.plPl,pt:_.ptBr,quz:_.quzPe,ro:_.roRo,ru:_.ruRu,sk:_.skSk,sl:_.slSi,sq:_.sqAl,sv:_.svSe,ta:_.taIn,te:_.teIn,th:_.thTh,tr:_.trTr,"tr-cy":_.enGb,tt:_.ttRu,ug:_.ugCn,uk:_.ukUa,ur:_.urPk,uz:_.enUs,vi:_.viVn,zh:_.enUs,"zh-hans-tw":_.zhTw},R=_.enUs,H=/^([^-]+)-.+/;function j(e){if(void 0===e||null===e)return!1;var t=e.toLowerCase();return Object.values(_).includes(t)||void 0!==M[t]}function U(e){if(void 0===e||null===e)return R;var t=e.toLowerCase();if(Object.values(_).includes(t))return t;var r=M[t];if(void 0!==r)return r;var n=function(e){var t=H.exec(e.trim().toLowerCase());if(null!==t&&t.length>1)return t[1];return}(t);if(void 0!==n){var o=M[n];if(void 0!==o)return o}return R}var q=function(){return"undefined"===typeof window},z=void 0,Y=void 0,V=void 0,G=function(){return void 0===z&&(z=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document),z},W=function(){if(void 0===Y){var e=navigator.userAgentData;Y=null!==e&&void 0!==e&&e.platform?"Android"===e.platform:navigator.userAgent.indexOf("Android")>=0}return Y},J=function(){if(q())return!1;if(void 0===V){var e=navigator.userAgentData;if(null!==e&&void 0!==e&&e.mobile)return!0;V=/Android|BlackBerry|Windows Phone|IEMobile|Opera Mini|iPhone|iPad|iPod/i.test(navigator.userAgent)||G()||W()}return V};var K,Q=function(e,t){if(void 0!==e&&void 0!==t)return e-t};!function(e){e.Detached="Detached",e.Attaching="Attaching",e.Attached="Attached"}(K||(K={}));var X,$=r(61919),ee="Open",te="PostBoot",re="FileOpenFailed",ne="ComponentLoadError",oe="ContainerConnectedTimeout",ie="ContainerLoadError";!function(e){e.genericError="genericError",e.genericNetworkError="genericNetworkError",e.authorizationError="authorizationError",e.fileNotFoundOrAccessDeniedError="fileNotFoundOrAccessDeniedError",e.throttlingError="throttlingError",e.offlineError="offlineError",e.unsupportedClientProtocolVersion="unsupportedClientProtocolVersion",e.writeError="writeError",e.fetchFailure="fetchFailure",e.fetchTokenError="fetchTokenError",e.incorrectServerResponse="incorrectServerResponse",e.fileOverwrittenInStorage="fileOverwrittenInStorage",e.deltaStreamConnectionForbidden="deltaStreamConnectionForbidden",e.locationRedirection="locationRedirection",e.fluidInvalidSchema="fluidInvalidSchema",e.usageError="usageError",e.fileIsLocked="fileIsLocked"}(X||(X={}));var ae=r(20427),se="Loading chunk\\s[a-zA-Z0-9_-]+\\sfailed";function ce(e,t,r,n,o,i,a){var s=new d.g("QoS",e);(0,l.uX)(s,(0,w.Z)({eventName:t,pillar:r,veto:n,errorType:o,isAce:!ue(a)},i),a)}function ue(e){if(!e)return!1;var t=e;return!(!t.errorType||![X.offlineError,X.fileNotFoundOrAccessDeniedError,X.authorizationError,ae.x.snapshotTooBig,ae.x.invalidFileNameError,X.fileOverwrittenInStorage,oe].some((function(e){return e===t.errorType})))||!(!t.message||!new RegExp(se).test(t.message))}var le=function(e,t,r){(0,$.s)(6e4,[r]).then((function(r){if(r&&!e.closed){var n=oe;t&&ce(t,D.FW,te,"ContainerConnectFailed",n,{},{message:"Timed out while connecting the container",errorType:n})}})).catch((function(){}))},de=function(e,t){var r,n={},o=e.resolvedUrl;o&&"id"in o&&(n.docId=o.id),null===(r=t.PersistedProperties)||void 0===r||r.addPersistedProperties(n)},fe=function(e,t){var r=new L;e.attachState!==K.Attached?e.once("attached",(function(){de(e,t),le(e,t,r)})):(de(e,t),le(e,t,r)),e.once("closed",(function(e){e&&t&&ce(t,D.FW,te,"PostBootContainerClosed",e.errorType,{},e)})),e.once("connected",(function(){r.resolve()}))},he=r(55471),pe=function(){function e(t,r,o){var a=this;(0,u.Z)(this,e),this.perfMetadata=r,this.documentHiddenTrackerId=o,this.disposable={get Disposable(){return this},dispose:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.runtimeLogger.Disposable.dispose();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},this.runtimeLogger=new d.g("FluidRuntime",t)}return(0,c.Z)(e,[{key:"Disposable",get:function(){return this.disposable}},{key:"NamespaceLogger",get:function(){return this}},{key:"sendWithNamespace",value:function(e,t){this.runtimeLogger.sendWithNamespace(e,t)}},{key:"send",value:function(e){var t=e;if("performance"===e.category){var r=e.duration,n=Date.now(),o="number"===typeof r?n-r:void 0;t=(0,w.Z)((0,w.Z)({},this.perfMetadata),{},{startTime:o,documentEverHidden:this.documentHiddenTrackerId&&(0,T.yv)(this.documentHiddenTrackerId)>-1},t)}void 0===t.opMessageAgeMs&&"number"===typeof t.messageTimestamp&&(t=(0,w.Z)({opMessageAgeMs:Date.now()-t.messageTimestamp},t)),t.message&&(t.message=(0,he.NU)(t.message.toString())),t.stack&&(t.stack=(0,he.NU)(t.stack.toString())),t.error&&(t.error=(0,he.NU)(t.error.toString())),t.errorMessage&&(t.errorMessage=(0,he.NU)(t.errorMessage.toString())),t.responseMessage&&(t.responseMessage=(0,he.NU)(t.responseMessage.toString())),this.runtimeLogger.send(t)}},{key:"dispose",value:function(){this.runtimeLogger.Disposable.dispose().then((function(){})).catch((function(){}))}}]),e}();function ve(e){e.closed||e.attachState!==K.Attached&&void 0!==e.attachState||e.connect()}function ge(e,t,r){void 0===r||r<=0?ve(e):Promise.race([(0,$.g)(r),t]).then((function(){setTimeout((function(){ve(e)}),50)})).catch((function(){}))}var me,ye,be=r(60136),ke=r(29388),Se=r(28664);!function(e){e.IframeLoadFailed="IframeLoadFailed",e.ContainerUpgradeRequired="ContainerUpgradeRequired",e.ComponentNotFound="ComponentNotFound"}(me||(me={})),function(e){e.RootComponentCreateFailed="RootComponentCreateFailed",e.RaasNotSupported="RaasNotSupported"}(ye||(ye={}));var Ce,we=function(e){(0,be.Z)(r,e);var t=(0,ke.Z)(r);function r(e,n,o,i){var a;if((0,u.Z)(this,r),(a=t.call(this,e)).internalError=o,a.name=n,i)try{a.stack=i}catch(s){}return a}return(0,c.Z)(r)}((0,Se.Z)(Error));!function(e){e.UndefinedInitializeIframeMethod="UndefinedInitializeIframeMethod"}(Ce||(Ce={}));var xe=function(e){(0,be.Z)(r,e);var t=(0,ke.Z)(r);function r(e,n,o,i){var a;return(0,u.Z)(this,r),(a=t.call(this,e,me.ComponentNotFound,n,i)).code=o,a}return(0,c.Z)(r)}(we);function Pe(e,t){for(var r={},n=0,o=Object.keys(t);n<o.length;n++){var i=o[n];Object.defineProperty(r,i,{value:e[i]})}return r}function Ee(e,t,r,n,o,i){return Ze.apply(this,arguments)}function Ze(){return Ze=(0,i.Z)((0,n.Z)().mark((function e(t,r,o,i,a,s){var c,u,l,d,f,h,p,v,g;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=E.a.start(D.W_,i,{addUserTiming:!0}),u="/",!a){e.next=29;break}if(d=(0,w.Z)((0,w.Z)({},null===o||void 0===o?void 0:o.headers),{},{wait:!1,externalRequest:!1}),!o){e.next=10;break}return e.next=7,r.request({url:o.url,headers:(0,w.Z)({},d)});case 7:e.t0=e.sent,e.next=13;break;case 10:return e.next=12,t.request({url:u,headers:(0,w.Z)({},d)});case 12:e.t0=e.sent;case 13:if(404!==(l=e.t0).status){e.next=27;break}if(ve(t),f=(0,w.Z)((0,w.Z)({},null===o||void 0===o?void 0:o.headers),{},{externalRequest:!1}),!o){e.next=23;break}return e.next=20,r.request({url:o.url,headers:(0,w.Z)({},f)});case 20:e.t1=e.sent,e.next=26;break;case 23:return e.next=25,t.request({url:u,headers:(0,w.Z)({},f)});case 25:e.t1=e.sent;case 26:l=e.t1;case 27:e.next=40;break;case 29:if(h=(0,w.Z)((0,w.Z)({},null===o||void 0===o?void 0:o.headers),{},{externalRequest:!1}),!o){e.next=36;break}return e.next=33,r.request({url:o.url,headers:(0,w.Z)({},h)});case 33:e.t2=e.sent,e.next=39;break;case 36:return e.next=38,t.request({url:u,headers:(0,w.Z)({},h)});case 38:e.t2=e.sent;case 39:l=e.t2;case 40:if(200===l.status&&("fluid/component"===l.mimeType||"fluid/object"===l.mimeType)&&l.value){e.next=45;break}throw p=new xe("Component not found: status=".concat(l.status,", value=").concat(l.value),void 0,l.status,l.stack),v={externalRequest:!1,mimeType:l.mimeType},c.setResult(!1,v,p),p;case 45:return g=l.value,c.setResult(!0),e.abrupt("return",s?Pe(g,s):g);case 48:case"end":return e.stop()}}),e)}))),Ze.apply(this,arguments)}function Te(e,t,r,n,o,i,a,s){return Ne.apply(this,arguments)}function Ne(){return Ne=(0,i.Z)((0,n.Z)().mark((function e(t,r,o,i,a,s,c,u){var l,d,f,h,p,v,g,m,y,b,k,S;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p=function(e){(0,T.Zm)(h),f.setResult(!1,void 0,e)},f=E.a.start(D.pV,i,{addUserTiming:!0,isAPerformanceMetric:!0}),h=(0,T.n3)(),e.prev=3,e.next=6,Ee(t,r,o,i,c);case 6:v=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),p(e.t0),e.abrupt("return",Promise.reject(e.t0));case 13:return e.next=15,null===(l=v.ComponentCanvasProvider)||void 0===l?void 0:l.getCanvasComponent();case 15:if(e.t1=e.sent,e.t1){e.next=18;break}e.t1=v;case 18:return g=e.t1,m=v.ComponentMetadata||g.ComponentMetadata,e.next=22,null===m||void 0===m?void 0:m.packageName;case 22:return y=e.sent,b=null===(d=v.IFluidLoadable)||void 0===d?void 0:d.handle.absolutePath,k=(0,T.yv)(h,!0),S=(0,T.yv)(s),f.setResult(!0,(0,w.Z)((0,w.Z)({},a),{},{componentType:y,componentUrl:b,documentEverHidden:S>-1,documentHidden:k>-1})),c&&ge(t,void 0,0),e.abrupt("return",u?Pe(v,u):v);case 29:case"end":return e.stop()}}),e,null,[[3,9]])}))),Ne.apply(this,arguments)}var Fe,Ie=r(92810);!function(e){e.cache="fluid-cache",e.clientDetails="fluid-client-details",e.loadMode="loadMode",e.reconnect="fluid-reconnect",e.sequenceNumber="fluid-sequence-number",e.version="version"}(Fe||(Fe={}));var Be,De=r(15318),Ae=r(9070),Oe=r(18392),Le=r(82486),_e=function(e){(0,be.Z)(r,e);var t=(0,ke.Z)(r);function r(e,n,o){var i;return(0,u.Z)(this,r),(i=t.call(this,void 0,o)).debug=e,i.debugErr=n,i}return(0,c.Z)(r,[{key:"send",value:function(e){var t=this.prepareEvent(e),r="error"===t.category,n=r?this.debugErr:this.debug,o=e.eventName.lastIndexOf(Le.hy.eventNamespaceSeparator),i=e.eventName.substring(o+1);o>0&&(n=n.extend(e.eventName.substring(0,o))),t.eventName=void 0;var a;a="tick=".concat(Le.hy.formatTick(Ae.S.now()));var s,c=t.stack?t.stack:"";t.stack=void 0;try{s=JSON.stringify(t)}catch(Ht){t.error=void 0,s=JSON.stringify(t)}"{}"===s&&(s=""),r&&(n.enabled=!0),n("".concat(i," ").concat(s," ").concat(a," ").concat(c))}}],[{key:"create",value:function(e,t){var n=(0,Oe.debug)(e),o=(0,Oe.debug)(e);return o.log=function(){var e;n.enabled?Oe.debug.log.apply(Oe.debug,arguments):(e=console).error.apply(e,arguments)},o.enabled=!0,new r(n,o,t)}},{key:"mixinDebugLogger",value:function(e,t,n){if(!t)return r.create(e,n);var o=new Le.yw(void 0,n);return o.addLogger(r.create(e,this.tryGetBaseLoggerProps(t))),o.addLogger(Le.G2.create(t,e)),o}},{key:"tryGetBaseLoggerProps",value:function(e){if(e instanceof Le.hy)return e.properties}}]),r}(Le.hy),Me=r(78077),Re=r(5647),He=r(37762),je=r(79286),Ue=r.n(je),qe=r(27186),ze=r(89591);!function(e){e.genericError="genericError",e.throttlingError="throttlingError",e.dataCorruptionError="dataCorruptionError",e.dataProcessingError="dataProcessingError",e.usageError="usageError",e.clientSessionExpiredError="clientSessionExpiredError"}(Be||(Be={}));var Ye=r(65059),Ve=function(e){(0,be.Z)(r,e);var t=(0,ke.Z)(r);function r(e,n,o){var i;return(0,u.Z)(this,r),(i=t.call(this,e,o,new Set(["error"]))).error=n,i.errorType=Be.genericError,i}return(0,c.Z)(r)}(Ye.j4),Ge=function(e){(0,be.Z)(r,e);var t=(0,ke.Z)(r);function r(e,n,o){var i;return(0,u.Z)(this,r),(i=t.call(this,e,o)).retryAfterSeconds=n,i.errorType=Be.throttlingError,i}return(0,c.Z)(r,null,[{key:"wrap",value:function(e,t,n){return(0,Ye.bO)(e,(function(e){return new r(e,t)}),n)}}]),r}(Ye.j4),We=function(e){(0,be.Z)(r,e);var t=(0,ke.Z)(r);function r(e,n){var o;return(0,u.Z)(this,r),(o=t.call(this,e,Object.assign(Object.assign({},n),{usageError:!0}))).errorType=Be.usageError,o}return(0,c.Z)(r)}(Ye.j4),Je=function(e){(0,be.Z)(r,e);var t=(0,ke.Z)(r);function r(e,n){var o;return(0,u.Z)(this,r),(o=t.call(this,e,Object.assign(Object.assign({},n),{dataProcessingError:1}))).errorType=Be.dataCorruptionError,o.canRetry=!1,o}return(0,c.Z)(r)}(Ye.j4),Ke=function(e){(0,be.Z)(r,e);var t=(0,ke.Z)(r);function r(e){var n;return(0,u.Z)(this,r),(n=t.call(this,e)).errorType=Be.dataProcessingError,n.canRetry=!1,n}return(0,c.Z)(r,null,[{key:"create",value:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=r.wrapIfUnrecognized(e,t,n);return i.addTelemetryProperties(o),i}},{key:"wrapIfUnrecognized",value:function(e,t,n){var o=Object.assign({dataProcessingError:1,dataProcessingCodepath:t},void 0===n?void 0:Qe(n)),i=(0,Ye.SC)(e,{props:o});if((0,Ye.XY)(i)||i.errorType===Ye.Vu){var a=(0,Ye.Jn)(i,(function(e){return new r(e)}));return a.addTelemetryProperties(i.getTelemetryProperties()),a}return i}}]),r}(Ye.j4),Qe=function(e){return{messageClientId:e.clientId,messageSequenceNumber:e.sequenceNumber,messageClientSequenceNumber:e.clientSequenceNumber,messageReferenceSequenceNumber:e.referenceSequenceNumber,messageMinimumSequenceNumber:e.minimumSequenceNumber,messageTimestamp:e.timestamp}},Xe=r(65675),$e=r(5927),et=r(79616),tt=r(1244),rt=r(76692);function nt(e,t,r,n){return ot.apply(this,arguments)}function ot(){return(ot=(0,i.Z)((0,n.Z)().mark((function e(t,r,o,i){var a,s,c,u,l,d,f,h;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u=!1,l=1e3,d=0,f=Ae.S.now();case 4:return e.prev=4,e.next=7,t(i.cancel);case 7:c=e.sent,u=!0,e.next=26;break;case 11:if(e.prev=11,e.t0=e.catch(4),(0,tt.ms)(e.t0)){e.next=16;break}throw o.sendTelemetryEvent({eventName:"".concat(r,"_cancel"),retry:d,duration:Ae.S.now()-f,fetchCallName:r},e.t0),e.t0;case 16:if(!0!==(null===(a=i.cancel)||void 0===a?void 0:a.aborted)){e.next=19;break}throw o.sendTelemetryEvent({eventName:"".concat(r,"_runWithRetryAborted"),retry:d,duration:Ae.S.now()-f,fetchCallName:r},e.t0),new tt.V2("runWithRetry was Aborted",et.C.genericError,{driverVersion:rt.Z,fetchCallName:r});case 19:return 0===d&&o.sendTelemetryEvent({eventName:"".concat(r,"_firstFailed"),duration:Ae.S.now()-f,fetchCallName:r},e.t0),d++,h=e.t0,l=null!==(s=(0,tt.ZZ)(e.t0))&&void 0!==s?s:Math.min(2*l,8e3),i.onRetry&&i.onRetry(l,e.t0),e.next=26,(0,$e.g)(l);case 26:if(!u){e.next=4;break}case 27:return d>0&&o.sendTelemetryEvent({eventName:"".concat(r,"_lastError"),retry:d,duration:Ae.S.now()-f,fetchCallName:r},h),e.abrupt("return",c);case 29:case"end":return e.stop()}}),e,null,[[4,11]])})))).apply(this,arguments)}var it=r(91688),at=r(24713),st=r(34977),ct="connected";var ut,lt=r(59125),dt=r(11752),ft=r(61120),ht=r(47465),pt=function(e){(0,be.Z)(r,e);var t=(0,ke.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=t.apply(this,arguments)).members=new Map,e}return(0,c.Z)(r,[{key:"on",value:function(e,t){return(0,dt.Z)((0,ft.Z)(r.prototype),"on",this).call(this,e,t)}},{key:"addMember",value:function(e,t){if(this.members.has(e)){var r=this.members.get(e);(0,qe.h)(JSON.stringify(r)===JSON.stringify(t),1202)}else this.members.set(e,t),this.emit("addMember",e,t)}},{key:"removeMember",value:function(e){var t=this.members.get(e);return void 0!==t&&(this.members.delete(e),this.emit("removeMember",e,t),!0)}},{key:"getMembers",value:function(){return new Map(this.members)}},{key:"getMember",value:function(e){return this.members.get(e)}}]),r}(ht.EventEmitter),vt=r(46115),gt=r(69163),mt=function(){function e(t,r,o,a,s,c,l,d,f,h,p,v,g,m,y,b,k,S){var C=this;(0,u.Z)(this,e),this.container=t,this.scope=r,this.codeLoader=o,this._codeDetails=a,this._baseSnapshot=s,this.deltaManager=c,this.loader=d,this.submitFn=f,this.submitSummaryFn=h,this.submitBatchFn=p,this.submitSignalFn=v,this.disposeFn=g,this.closeFn=m,this.version=y,this.updateDirtyContainerState=b,this.existing=k,this.pendingLocalState=S,this._disposed=!1,this.lifecycleEvents=new vt.L,this._connected=this.container.connected,this._quorum=l,this.taggedLogger=t.subLogger,this._fluidModuleP=new gt.d((0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",C.loadCodeModule(a));case 1:case"end":return e.stop()}}),e)})))),this.supportedFeatures=new Map([["referenceSequenceNumbers",!0]]),this.attachListener()}return(0,c.Z)(e,[{key:"clientId",get:function(){return this.container.clientId}},{key:"id",get:function(){var e=this.container.resolvedUrl;return(0,Me.P)(e)?e.id:""}},{key:"clientDetails",get:function(){return this.container.clientDetails}},{key:"connected",get:function(){return this._connected}},{key:"canSummarize",get:function(){return"summarize"in this.runtime}},{key:"serviceConfiguration",get:function(){return this.container.serviceConfiguration}},{key:"audience",get:function(){return this.container.audience}},{key:"options",get:function(){return this.container.options}},{key:"baseSnapshot",get:function(){return this._baseSnapshot}},{key:"storage",get:function(){return this.container.storage}},{key:"runtime",get:function(){if(void 0===this._runtime)throw new Error("Attempted to access runtime before it was defined");return this._runtime}},{key:"disposed",get:function(){return this._disposed}},{key:"codeDetails",get:function(){return this._codeDetails}},{key:"quorum",get:function(){return this._quorum}},{key:"getEntryPoint",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(){var t,r,o=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._disposed){e.next=2;break}throw new We("The context is already disposed");case 2:if(void 0===this._runtime){e.next=4;break}return e.abrupt("return",null===(r=null===(t=this._runtime)||void 0===t?void 0:t.getEntryPoint)||void 0===r?void 0:r.call(t));case 4:return e.abrupt("return",new Promise((function(e,t){var r=function(){var t,r;(0,qe.h)(void 0!==o._runtime,1443),e(null===(r=(t=o._runtime).getEntryPoint)||void 0===r?void 0:r.call(t)),o.lifecycleEvents.off("disposed",n)},n=function(){t(new Error("ContainerContext was disposed")),o.lifecycleEvents.off("runtimeInstantiated",r)};o.lifecycleEvents.once("runtimeInstantiated",r),o.lifecycleEvents.once("disposed",n)})));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getSpecifiedCodeDetails",value:function(){var e;return null!==(e=this._quorum.get("code"))&&void 0!==e?e:this._quorum.get("code2")}},{key:"dispose",value:function(e){this._disposed||(this._disposed=!0,this.lifecycleEvents.emit("disposed"),this.runtime.dispose(e),this._quorum.dispose(),this.deltaManager.dispose())}},{key:"getLoadedFromVersion",value:function(){return this.container.loadedFromVersion}},{key:"attachState",get:function(){return this.container.attachState}},{key:"createSummary",value:function(e){return this.runtime.createSummary(e)}},{key:"setConnectionState",value:function(e,t){var r=this.runtime;this._connected=e,r.setConnectionState(e,t)}},{key:"process",value:function(e,t){this.runtime.process(e,t)}},{key:"processSignal",value:function(e,t){this.runtime.processSignal(e,t)}},{key:"request",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.runtime.request(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAbsoluteUrl",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.container.getAbsoluteUrl(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPendingLocalState",value:function(){return this.runtime.getPendingLocalState()}},{key:"satisfies",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,o,i,a,s,c,u,l;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=[],void 0!==(i=this.codeLoader).IFluidCodeDetailsComparer&&o.push(i.IFluidCodeDetailsComparer),e.next=5,this._fluidModuleP;case 5:if(a=e.sent,void 0!==(null===(s=null===(r=a.module)||void 0===r?void 0:r.fluidExport)||void 0===s?void 0:s.IFluidCodeDetailsComparer)&&o.push(s.IFluidCodeDetailsComparer),0!==o.length){e.next=10;break}return e.abrupt("return",!1);case 10:c=0,u=o;case 11:if(!(c<u.length)){e.next=21;break}return l=u[c],e.next=15,l.satisfies(a.details,t);case 15:if(!1!==e.sent){e.next=18;break}return e.abrupt("return",!1);case 18:c++,e.next=11;break;case 21:return e.abrupt("return",!0);case 22:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"notifyOpReplay",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===(o=(r=this.runtime).notifyOpReplay)||void 0===o?void 0:o.call(r,t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getRuntimeFactory",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(){var t,r,o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._fluidModuleP;case 2:if(e.t1=t=e.sent.module,e.t0=null===e.t1,e.t0){e.next=6;break}e.t0=void 0===t;case 6:if(!e.t0){e.next=10;break}e.t2=void 0,e.next=11;break;case 10:e.t2=t.fluidExport;case 11:if(r=e.t2,void 0!==(o=null===r||void 0===r?void 0:r.IRuntimeFactory)){e.next=15;break}throw new Error("Code package does not implement IRuntimeFactory");case 15:return e.abrupt("return",o);case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"instantiateRuntime",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,o=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getRuntimeFactory();case 2:return r=e.sent,e.next=5,Le.Xr.timedExecAsync(this.taggedLogger,{eventName:"InstantiateRuntime"},(0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.instantiateRuntime(o,t));case 1:case"end":return e.stop()}}),e)}))));case 5:this._runtime=e.sent,this.lifecycleEvents.emit("runtimeInstantiated");case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"attachListener",value:function(){var e=this;this.container.once("attaching",(function(){e.runtime.setAttachState(K.Attaching)})),this.container.once("attached",(function(){e.runtime.setAttachState(K.Attached)}))}},{key:"loadCodeModule",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,o,a,s=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Le.Xr.timedExecAsync(this.taggedLogger,{eventName:"CodeLoad"},(0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",s.codeLoader.load(t));case 1:case"end":return e.stop()}}),e)}))));case 2:if(!("module"in(r=e.sent))){e.next=8;break}return o=r.module,a=r.details,e.abrupt("return",{module:o,details:null!==a&&void 0!==a?a:t});case 8:return this.taggedLogger.sendTelemetryEvent({eventName:"LegacyCodeLoader"}),e.abrupt("return",r);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}],[{key:"createOrLoad",value:function(){var t=(0,i.Z)((0,n.Z)().mark((function t(r,o,i,a,s,c,u,l,d,f,h,p,v,g,m,y,b,k){var S;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return S=new e(r,o,i,a,s,c,u,l,d,f,h,p,v,g,m,y,b,k),t.next=3,S.instantiateRuntime(b);case 3:return t.abrupt("return",S);case 4:case"end":return t.stop()}}),t)})));return function(e,r,n,o,i,a,s,c,u,l,d,f,h,p,v,g,m,y){return t.apply(this,arguments)}}()}]),e}();!function(e){e.Never="Never",e.Disabled="Disabled",e.Enabled="Enabled"}(ut||(ut={}));var yt=r(97326),bt=r(35935),kt=r.n(bt);var St=r(26795),Ct=r(63133),wt=r.n(Ct),xt=function(e){(0,be.Z)(r,e);var t=(0,ke.Z)(r);function r(e){var n;return(0,u.Z)(this,r),(n=t.call(this)).worker=e,n.isDisposed=!1,n.q=new(wt()),n.pauseCount=1,n}return(0,c.Z)(r,[{key:"disposed",get:function(){return this.isDisposed}},{key:"paused",get:function(){return 0!==this.pauseCount}},{key:"length",get:function(){return this.q.length}},{key:"idle",get:function(){return void 0===this.processingPromise&&0===this.q.length}},{key:"waitTillProcessingDone",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null!==(t=this.processingPromise)&&void 0!==t?t:{count:0,duration:0});case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dispose",value:function(){throw new Error("Not implemented.")}},{key:"clear",value:function(){this.q.clear()}},{key:"peek",value:function(){return this.q.peekFront()}},{key:"toArray",value:function(){return this.q.toArray()}},{key:"push",value:function(e){try{this.q.push(e),this.emit("push",e),this.ensureProcessing()}catch(Ht){this.emit("error",Ht)}}},{key:"pause",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.pauseCount++,e.next=3,this.waitTillProcessingDone();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"resume",value:function(){(0,qe.h)(this.pauseCount>0,244),this.pauseCount--,this.ensureProcessing()}},{key:"ensureProcessing",value:function(){var e=this;this.anythingToProcess()&&void 0===this.processingPromise&&(this.processingPromise=Promise.resolve().then((function(){(0,qe.h)(void 0!==e.processingPromise,895);var t=e.processDeltas();return(0,qe.h)(void 0!==e.processingPromise,896),e.processingPromise=void 0,t})).catch((function(t){return e.error=t,e.processingPromise=void 0,e.emit("error",t),{count:0,duration:0}})),(0,qe.h)(void 0!==this.processingPromise,897))}},{key:"anythingToProcess",value:function(){return 0!==this.q.length&&!this.paused&&void 0===this.error}},{key:"processDeltas",value:function(){for(var e=Ae.S.now(),t=0;this.anythingToProcess();){var r=this.q.shift();t++,this.worker(r),this.emit("op",r)}var n=Ae.S.now()-e;return 0===this.q.length&&this.emit("idle",t,n),{count:t,duration:n}}}]),r}(vt.L),Pt=(0,c.Z)((function e(t,r,n,o){(0,u.Z)(this,e),this.sequenceNumber=t,this.key=r,this.value=n,this.local=o})),Et=function(e){(0,be.Z)(r,e);var t=(0,ke.Z)(r);function r(e){var n;return(0,u.Z)(this,r),(n=t.call(this)).isDisposed=!1,n.members=new Map(e),n.snapshotCache=e,n}return(0,c.Z)(r,[{key:"disposed",get:function(){return this.isDisposed}},{key:"snapshot",value:function(){var e;return null!==(e=this.snapshotCache)&&void 0!==e||(this.snapshotCache=Array.from(this.members)),this.snapshotCache}},{key:"addMember",value:function(e,t){(0,qe.h)(!!e,1135),(0,qe.h)(!this.members.has(e),462),this.members.set(e,t),this.emit("addMember",e,t),this.snapshotCache=void 0}},{key:"removeMember",value:function(e){(0,qe.h)(!!e,1136),(0,qe.h)(this.members.has(e),463),this.members.delete(e),this.emit("removeMember",e),this.snapshotCache=void 0}},{key:"getMembers",value:function(){return new Map(this.members)}},{key:"getMember",value:function(e){return this.members.get(e)}},{key:"dispose",value:function(){this.isDisposed=!0}}]),r}(vt.L),Zt=function(e){(0,be.Z)(r,e);var t=(0,ke.Z)(r);function r(e,n){var i;return(0,u.Z)(this,r),(i=t.call(this)).sendProposal=n,i.isDisposed=!1,i.stateEvents=new ht.EventEmitter,i.proposals=new Map(e.proposals.map((function(e){var t=(0,o.Z)(e,2)[1];return[t.sequenceNumber,new Pt(t.sequenceNumber,t.key,t.value,!1)]}))),i.values=new Map(e.values),i.proposalsSnapshotCache=e.proposals,i.valuesSnapshotCache=e.values,i}return(0,c.Z)(r,[{key:"disposed",get:function(){return this.isDisposed}},{key:"snapshot",value:function(){var e,t;return null!==(e=this.proposalsSnapshotCache)&&void 0!==e||(this.proposalsSnapshotCache=Array.from(this.proposals).map((function(e){var t=(0,o.Z)(e,2),r=t[0],n=t[1];return[r,{sequenceNumber:r,key:n.key,value:n.value},[]]}))),null!==(t=this.valuesSnapshotCache)&&void 0!==t||(this.valuesSnapshotCache=Array.from(this.values)),{proposals:this.proposalsSnapshotCache,values:this.valuesSnapshotCache}}},{key:"has",value:function(e){return this.values.has(e)}},{key:"get",value:function(e){var t;return null===(t=this.values.get(e))||void 0===t?void 0:t.value}},{key:"getApprovalData",value:function(e){return this.values.get(e)}},{key:"propose",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){var o,i=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((o=this.sendProposal(t,r))<0)){e.next=4;break}throw this.emit("error",{eventName:"ProposalInDisconnectedState",key:t}),new Error("Can't propose in disconnected state");case 4:return e.abrupt("return",new Promise((function(e,t){var r,n=function e(t,n){t===o&&(r=n,i.stateEvents.off("localProposalSequenced",e),i.stateEvents.off("disconnected",s),i.stateEvents.on("localProposalApproved",a))},a=function(t){t===r&&(e(),u())},s=function(){void 0===r&&i.stateEvents.once("connected",(function(){void 0===r&&(t(new Error("Client disconnected without successfully sending proposal")),u())}))},c=function(){t(new Error("QuorumProposals was disposed")),u()},u=function(){i.stateEvents.off("localProposalSequenced",n),i.stateEvents.off("localProposalApproved",a),i.stateEvents.off("disconnected",s),i.stateEvents.off("disposed",c)};i.stateEvents.on("localProposalSequenced",n),i.stateEvents.on("disconnected",s),i.stateEvents.on("disposed",c)})));case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"addProposal",value:function(e,t,r,n,o){(0,qe.h)(!this.proposals.has(r),464);var i=new Pt(r,e,t,n);this.proposals.set(r,i),this.emit("addProposal",i),n&&this.stateEvents.emit("localProposalSequenced",o,r),this.proposalsSnapshotCache=void 0}},{key:"updateMinimumSequenceNumber",value:function(e){var t,r=e.minimumSequenceNumber,n=[],i=(0,He.Z)(this.proposals);try{for(i.s();!(t=i.n()).done;){var a=(0,o.Z)(t.value,2),s=a[0],c=a[1];s<=r&&n.push(c)}}catch(h){i.e(h)}finally{i.f()}n.sort((function(e,t){return e.sequenceNumber-t.sequenceNumber}));for(var u=0,l=n;u<l.length;u++){var d=l[u],f={approvalSequenceNumber:e.sequenceNumber,commitSequenceNumber:-1,key:d.key,sequenceNumber:d.sequenceNumber,value:d.value};this.values.set(f.key,f),this.valuesSnapshotCache=void 0,this.emit("approveProposal",f.sequenceNumber,f.key,f.value,f.approvalSequenceNumber),this.proposals.delete(d.sequenceNumber),this.proposalsSnapshotCache=void 0,d.local&&this.stateEvents.emit("localProposalApproved",d.sequenceNumber)}}},{key:"setConnectionState",value:function(e){e?this.stateEvents.emit("connected"):this.stateEvents.emit("disconnected")}},{key:"dispose",value:function(){this.isDisposed=!0,this.stateEvents.emit("disposed")}}]),r}(vt.L),Tt=function(e){(0,be.Z)(r,e);var t=(0,ke.Z)(r);function r(e,n,o,i){var a;return(0,u.Z)(this,r),(a=t.call(this)).isDisposed=!1,a.quorumClients=new Et(e),a.quorumClients.on("addMember",(function(e,t){a.emit("addMember",e,t)})),a.quorumClients.on("removeMember",(function(e){a.emit("removeMember",e)})),a.quorumProposals=new Zt({proposals:n,values:o},i),a.quorumProposals.on("addProposal",(function(e){a.emit("addProposal",e)})),a.quorumProposals.on("approveProposal",(function(e,t,r,n){a.emit("approveProposal",e,t,r,n)})),a}return(0,c.Z)(r,[{key:"disposed",get:function(){return this.isDisposed}},{key:"close",value:function(){this.removeAllListeners()}},{key:"snapshot",value:function(){var e=this.quorumClients.snapshot(),t=this.quorumProposals.snapshot();return{members:e,proposals:t.proposals,values:t.values}}},{key:"has",value:function(e){return this.quorumProposals.has(e)}},{key:"get",value:function(e){return this.quorumProposals.get(e)}},{key:"getApprovalData",value:function(e){return this.quorumProposals.getApprovalData(e)}},{key:"addMember",value:function(e,t){this.quorumClients.addMember(e,t)}},{key:"removeMember",value:function(e){this.quorumClients.removeMember(e)}},{key:"getMembers",value:function(){return this.quorumClients.getMembers()}},{key:"getMember",value:function(e){return this.quorumClients.getMember(e)}},{key:"propose",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.quorumProposals.propose(t,r));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"addProposal",value:function(e,t,r,n,o){return this.quorumProposals.addProposal(e,t,r,n,o)}},{key:"updateMinimumSequenceNumber",value:function(e){this.quorumProposals.updateMinimumSequenceNumber(e)}},{key:"setConnectionState",value:function(e,t){this.quorumProposals.setConnectionState(e)}},{key:"dispose",value:function(){throw new Error("Not implemented.")}}]),r}(vt.L);var Nt,Ft=function(){function e(t,r,n,o,i,a,s){(0,u.Z)(this,e),this.minimumSequenceNumber=t,this.sequenceNumber=r,this.term=null!==n&&void 0!==n?n:1,this._quorum=new Tt(o,i,a,s)}return(0,c.Z)(e,[{key:"quorum",get:function(){return this._quorum}},{key:"attributes",get:function(){return{minimumSequenceNumber:this.minimumSequenceNumber,sequenceNumber:this.sequenceNumber,term:this.term}}},{key:"setConnectionState",value:function(e,t){this._quorum.setConnectionState(e,t)}},{key:"snapshot",value:function(){return this._quorum.snapshot()}},{key:"close",value:function(){this._quorum.close()}},{key:"processMessage",value:function(e,t){if(e.sequenceNumber!==this.sequenceNumber+1)throw new Error("Protocol state is not moving sequentially. "+"Current is ".concat(this.sequenceNumber,". Next is ").concat(e.sequenceNumber));this.sequenceNumber=e.sequenceNumber,this.minimumSequenceNumber=e.minimumSequenceNumber;var r=!1;switch(e.type){case st.Cs.ClientJoin:var n=e,o=JSON.parse(n.data),i={client:o.detail,sequenceNumber:n.sequenceNumber};this._quorum.addMember(o.clientId,i);break;case st.Cs.ClientLeave:var a=e,s=JSON.parse(a.data);this._quorum.removeMember(s);break;case st.Cs.Propose:"string"===typeof e.contents&&(e.contents=JSON.parse(e.contents));var c=e.contents;this._quorum.addProposal(c.key,c.value,e.sequenceNumber,t,e.clientSequenceNumber),r=!0}return this._quorum.updateMinimumSequenceNumber(e),{immediateNoOp:r}}},{key:"getProtocolState",value:function(){return Object.assign({sequenceNumber:this.sequenceNumber,minimumSequenceNumber:this.minimumSequenceNumber},this._quorum.snapshot())}}]),e}();!function(e){e.ClientJoin="join",e.ClientLeave="leave",e.Clear="clear"}(Nt||(Nt={}));var It=function(e){(0,be.Z)(r,e);var t=(0,ke.Z)(r);function r(e,n,i,a){var s;(0,u.Z)(this,r),(s=t.call(this,e.minimumSequenceNumber,e.sequenceNumber,1,n.members,n.proposals,n.values,i)).audience=a,s.quorum.on("addMember",(function(e,t){return a.addMember(e,t.client)})),s.quorum.on("removeMember",(function(e){return a.removeMember(e)}));var c,l=(0,He.Z)(s.quorum.getMembers());try{for(l.s();!(c=l.n()).done;){var d=(0,o.Z)(c.value,2),f=d[0],h=d[1];s.audience.addMember(f,h.client)}}catch(p){l.e(p)}finally{l.f()}return s}return(0,c.Z)(r,[{key:"processMessage",value:function(e,t){var n=this.quorum.getMember(e.clientId);if(null!=e.clientId){if(void 0===n&&e.type!==st.Cs.ClientJoin)throw new Error("Remote message's clientId is missing from the quorum");if(!0===(null===n||void 0===n?void 0:n.shouldHaveLeft)&&!(0,St.eK)(e))throw new Error("Remote message's clientId already should have left")}return(0,dt.Z)((0,ft.Z)(r.prototype),"processMessage",this).call(this,e,t)}},{key:"processSignal",value:function(e){var t,r=e.content;switch(r.type){case Nt.Clear:var n,i=this.audience.getMembers(),a=(0,He.Z)(i);try{for(a.s();!(n=a.n()).done;){var s=(0,o.Z)(n.value,2),c=s[0];"read"===s[1].mode&&this.audience.removeMember(c)}}catch(d){a.e(d)}finally{a.f()}break;case Nt.ClientJoin:var u=r.content;"read"===u.client.mode&&this.audience.addMember(u.clientId,u.client);break;case Nt.ClientLeave:var l=r.content;"read"===(null===(t=this.audience.getMember(l))||void 0===t?void 0:t.mode)&&this.audience.removeMember(l)}}}]),r}(Ft);function Bt(e){if((0,St.LW)(e))return!0;switch(e.type){case st.Cs.Propose:case st.Cs.Reject:case st.Cs.NoOp:case St.UH.Accept:case st.Cs.Summarize:return!0;default:return!1}}var Dt=function(e){(0,be.Z)(r,e);var t=(0,ke.Z)(r);function r(e,n,o,i){var a;(0,u.Z)(this,r),(a=t.call(this)).serviceProvider=e,a.logger=n,a._active=o,a.pending=[],a.currentlyProcessingOps=!1,a.minSequenceNumber=0,a.lastQueuedSequenceNumber=0,a.lastObservedSeqNumber=0,a.lastProcessedSequenceNumber=0,a.noOpCount=0,a.lastClientSequenceNumber=0,a.opsSize=0,a.initSequenceNumber=0,a._closed=!1,a._disposed=!1,a.throttlingIdSet=new Set,a.timeTillThrottling=0,a.closeAbortController=new(kt()),a.deltaStorageDelayId=(0,Ie.Z)(),a.deltaStreamDelayId=(0,Ie.Z)(),a.messageBuffer=[];var s={incomingOpHandler:function(e,t){try{a.enqueueMessages(e,t)}catch(Ht){a.logger.sendErrorEvent({eventName:"EnqueueMessages_Exception"},Ht),a.close((0,Ye.SC)(Ht))}},signalHandler:function(e){return a._inboundSignal.push(e)},reconnectionDelayHandler:function(e,t){return a.emitDelayInfo(a.deltaStreamDelayId,e,t)},closeHandler:function(e){return a.close(e)},disconnectHandler:function(e,t){return a.disconnectHandler(e,t)},connectHandler:function(e){return a.connectHandler(e)},pongHandler:function(e){return a.emit("pong",e)},readonlyChangeHandler:function(e){return function(e,t,r){try{for(var n=arguments.length,o=new Array(n>3?n-3:0),i=3;i<n;i++)o[i-3]=arguments[i];e.emit.apply(e,[r].concat(o))}catch(Ht){t.sendErrorEvent({eventName:"RaiseEventError",event:r},Ht)}}((0,yt.Z)(a),a.logger,"readonly",e)}};return a.connectionManager=i(s),a._inbound=new xt((function(e){a.processInboundMessage(e)})),a._inbound.on("error",(function(e){a.close(Ke.wrapIfUnrecognized(e,"deltaManagerInboundErrorHandler",a.lastMessage))})),a._inboundSignal=new xt((function(e){if(void 0===a.handler)throw new Error("Attempted to process an inbound signal without a handler attached");a.handler.processSignal({clientId:e.clientId,content:JSON.parse(e.content)})})),a._inboundSignal.on("error",(function(e){a.close((0,Ye.SC)(e))})),a}return(0,c.Z)(r,[{key:"active",get:function(){return this._active()}},{key:"disposed",get:function(){return this._closed}},{key:"IDeltaSender",get:function(){return this}},{key:"inbound",get:function(){return this._inbound}},{key:"inboundSignal",get:function(){return this._inboundSignal}},{key:"initialSequenceNumber",get:function(){return this.initSequenceNumber}},{key:"lastSequenceNumber",get:function(){return this.lastProcessedSequenceNumber}},{key:"lastMessage",get:function(){return this.lastProcessedMessage}},{key:"lastKnownSeqNumber",get:function(){return this.lastObservedSeqNumber}},{key:"minimumSequenceNumber",get:function(){return this.minSequenceNumber}},{key:"hasCheckpointSequenceNumber",get:function(){return(0,qe.h)(this.connectionManager.connected,223),void 0!==this._checkpointSequenceNumber}},{key:"maxMessageSize",get:function(){return this.connectionManager.maxMessageSize}},{key:"version",get:function(){return this.connectionManager.version}},{key:"serviceConfiguration",get:function(){return this.connectionManager.serviceConfiguration}},{key:"outbound",get:function(){return this.connectionManager.outbound}},{key:"readOnlyInfo",get:function(){return this.connectionManager.readOnlyInfo}},{key:"clientDetails",get:function(){return this.connectionManager.clientDetails}},{key:"submit",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0,i={contents:t,metadata:arguments.length>3?arguments[3]:void 0,referenceSequenceNumber:null!==o&&void 0!==o?o:this.lastProcessedSequenceNumber,type:e,compression:n};r||this.flush();var a=this.connectionManager.prepareMessageToSend(i);return void 0===a?-1:((0,qe.h)(Bt(a),1049),void 0!==t&&(this.opsSize+=t.length),this.messageBuffer.push(a),a.type===st.Cs.NoOp&&this.noOpCount++,this.emit("submitOp",a),r||this.flush(),a.clientSequenceNumber)}},{key:"submitSignal",value:function(e){return this.connectionManager.submitSignal(e)}},{key:"flush",value:function(){var e,t,r,n=this.messageBuffer;0!==n.length&&(this.messageBuffer=[],this.emit("prepareSend",n),1===n.length?(0,qe.h)(void 0===(null===(e=n[0].metadata)||void 0===e?void 0:e.batch),969):((0,qe.h)(!0===(null===(t=n[0].metadata)||void 0===t?void 0:t.batch),970),(0,qe.h)(!1===(null===(r=n[n.length-1].metadata)||void 0===r?void 0:r.batch),971)),this.connectionManager.sendMessages(n),(0,qe.h)(0===this.messageBuffer.length,972))}},{key:"connectionProps",get:function(){return Object.assign({sequenceNumber:this.lastSequenceNumber,opsSize:this.opsSize>0?this.opsSize:void 0},this.connectionManager.connectionProps)}},{key:"logConnectionIssue",value:function(e){var t;(0,qe.h)(this.connectionManager.connected,568);var r=this.pending.sort((function(e,t){return e.sequenceNumber-t.sequenceNumber}));this.logger.sendErrorEvent(Object.assign(Object.assign(Object.assign(Object.assign({},e),{fetchReason:this.fetchReason,lastQueuedSequenceNumber:this.lastQueuedSequenceNumber,lastProcessedSequenceNumber:this.lastProcessedSequenceNumber,lastObserved:this.lastObservedSeqNumber}),this.connectionManager.connectionVerboseProps),{pendingOps:this.pending.length,pendingFirst:null===(t=r[0])||void 0===t?void 0:t.sequenceNumber,haveHandler:void 0!==this.handler,inboundLength:this.inbound.length,inboundPaused:this.inbound.paused}))}},{key:"connectHandler",value:function(e){this.refreshDelayInfo(this.deltaStreamDelayId);var t=this.connectionManager.connectionVerboseProps;t.connectionLastQueuedSequenceNumber=this.lastQueuedSequenceNumber,t.connectionLastObservedSeqNumber=this.lastObservedSeqNumber;var r=e.checkpointSequenceNumber;this._checkpointSequenceNumber=r,void 0!==r&&this.updateLatestKnownOpSeqNumber(r),(0,qe.h)(0===this.messageBuffer.length,233),this.opsSize=0,this.noOpCount=0,this.emit("connect",e,void 0!==r?this.lastObservedSeqNumber-this.lastSequenceNumber:void 0),void 0!==r?r>this.lastQueuedSequenceNumber&&this.fetchMissingDeltas("AfterConnection"):"read"===e.mode&&this.fetchMissingDeltas("AfterReadConnection")}},{key:"dispose",value:function(){throw new Error("Not implemented.")}},{key:"attachOpHandler",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r,o){var i,a,s=arguments;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=s.length>3&&void 0!==s[3]?s[3]:"none",this.initSequenceNumber=r,this.lastProcessedSequenceNumber=r,this.minSequenceNumber=t,this.lastQueuedSequenceNumber=r,this.lastObservedSeqNumber=r,(0,qe.h)(void 0===this.handler,226),this.handler=o,(0,qe.h)(!!this.handler,227),(0,qe.h)(void 0===this.fetchReason,616),!this._closed){e.next=12;break}return e.abrupt("return");case 12:if(this._inbound.resume(),this._inboundSignal.resume(),"none"===i){e.next=19;break}return a="cached"===i,e.next=18,this.fetchMissingDeltasCore("DocumentOpen_".concat(i),a);case 18:a&&this.fetchMissingDeltas("PostDocumentOpen");case 19:(0,qe.h)(void 0!==this.fetchReason||0===this.pending.length,617);case 20:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"connect",value:function(e){var t,r=null===(t=e.fetchOpsFromStorage)||void 0===t||t;!function(e,t,r){if(e)return!0;var n="string"===typeof r?{eventName:r,category:"error"}:Object.assign({category:"error"},r);t.send(n)}(void 0!==this.handler||!r,this.logger,"CantFetchWithoutBaseline"),r&&this.fetchMissingDeltas(e.reason),this.connectionManager.connect(e.reason,e.mode)}},{key:"getDeltas",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r,o,i,a){var s,c,u,l,d,f,h,p,v=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(s=this.serviceProvider())){e.next=3;break}throw new Error("Delta manager is not attached");case 3:if(void 0!==this.deltaStorage){e.next=7;break}return e.next=6,s.connectToDeltaStorage();case 6:this.deltaStorage=e.sent;case 7:if(void 0===r){e.next=15;break}if(u=r-1,!(this.lastQueuedSequenceNumber>=u)){e.next=12;break}return this.logger.sendPerformanceEvent(Object.assign({reason:o,eventName:"ExtraStorageCall",early:!0,from:t,to:r},this.connectionManager.connectionVerboseProps)),e.abrupt("return");case 12:c=function(e){return e.sequenceNumber>=u},e.next=16;break;case 15:c=function(e){return e.sequenceNumber>=v.lastObservedSeqNumber};case 16:l=new(kt()),d=!1,f=function e(t){(0,qe.h)(t.sequenceNumber===v.lastQueuedSequenceNumber,570),!d&&c(t)&&(l.abort(),v._inbound.off("push",e))},e.prev=19,this._inbound.on("push",f),(0,qe.h)(null===this.closeAbortController.signal.onabort,488),this.closeAbortController.signal.onabort=function(){return l.abort()},h=this.deltaStorage.fetchMessages(t,r,l.signal,a,o);case 24:return e.next=27,h.read();case 27:if(!(p=e.sent).done){e.next=30;break}return e.abrupt("break",33);case 30:try{d=!0,i(p.value)}finally{d=!1}e.next=24;break;case 33:return e.prev=33,this.closeAbortController.signal.onabort=null,this._inbound.off("push",f),(0,qe.h)(!d,649),e.finish(33);case 38:case"end":return e.stop()}}),e,this,[[19,,33,38]])})));return function(t,r,n,o,i){return e.apply(this,arguments)}}()},{key:"close",value:function(e,t){this._closed?!0===t&&this.disposeInternal(e):(this._closed=!0,this.connectionManager.dispose(e,!0!==t),this.closeAbortController.abort(),this._inbound.clear(),this._inboundSignal.clear(),this._inbound.pause(),this._inboundSignal.pause(),this.pending=[],!0===t||this.emit("closed",e),this.disposeInternal(e))}},{key:"disposeInternal",value:function(e){this._disposed||(this._disposed=!0,this.emit("disposed",e),this.removeAllListeners())}},{key:"refreshDelayInfo",value:function(e){this.throttlingIdSet.delete(e),0===this.throttlingIdSet.size&&(this.timeTillThrottling=0)}},{key:"disconnectHandler",value:function(e,t){this.messageBuffer.length=0,this.emit("disconnect",e,t)}},{key:"emitDelayInfo",value:function(e,t,r){var n=Date.now();if(this.throttlingIdSet.add(e),t>0&&n+t>this.timeTillThrottling){this.timeTillThrottling=n+t;var o=Ge.wrap(r,t/1e3,this.logger);this.emit("throttled",o)}}},{key:"comparableMessagePayload",value:function(e){return"".concat(e.clientId,"-").concat(e.type,"-").concat(e.minimumSequenceNumber,"-").concat(e.referenceSequenceNumber,"-").concat(e.timestamp)}},{key:"enqueueMessages",value:function(e,t){var r,n,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(void 0!==this.handler){if((0,qe.h)(0===this.pending.length||void 0!==this.fetchReason,489),0!==e.length){var i=e[0].sequenceNumber,a=e[e.length-1].sequenceNumber;if(a>this.lastQueuedSequenceNumber){var s,c,u,l=i-1,d=l-this.lastQueuedSequenceNumber,f=0,h=0,p=(0,He.Z)(e);try{for(p.s();!(c=p.n()).done;){var v=c.value;v.sequenceNumber===l?f++:v.sequenceNumber!==l+1&&(h++,void 0===s&&(s=l+1)),l=v.sequenceNumber}}catch(w){p.e(w)}finally{p.f()}0!==f||0!==h&&!o||d>0&&void 0===this.fetchReason?u="enqueueMessages":void 0!==this.fetchReason&&this.fetchReason!==t&&i<=this.lastQueuedSequenceNumber+1&&a>this.lastQueuedSequenceNumber&&(u="enqueueMessagesExtraFetch"),void 0!==u&&this.logger.sendPerformanceEvent(Object.assign({eventName:u,reason:t,previousReason:this.prevEnqueueMessagesReason,from:i,to:a+1,length:e.length,fetchReason:this.fetchReason,duplicate:f>0?f:void 0,initialGap:0!==d?d:void 0,gap:h>0?h:void 0,firstMissing:s,dmInitialSeqNumber:this.initialSequenceNumber},this.connectionManager.connectionVerboseProps))}this.updateLatestKnownOpSeqNumber(e[e.length-1].sequenceNumber);var g=null===(r=this.previouslyProcessedMessage)||void 0===r?void 0:r.sequenceNumber;(0,qe.h)(void 0===g||g===this.lastQueuedSequenceNumber,236);var m,y=(0,He.Z)(e);try{for(y.s();!(m=y.n()).done;){var b=m.value;if(b.sequenceNumber<=this.lastQueuedSequenceNumber){if((null===(n=this.previouslyProcessedMessage)||void 0===n?void 0:n.sequenceNumber)===b.sequenceNumber){var k=this.comparableMessagePayload(this.previouslyProcessedMessage),S=this.comparableMessagePayload(b);if(k!==S){var C=new tt.V2("Found two messages with the same sequenceNumber but different payloads. Likely to be a service issue",X.fileOverwrittenInStorage,{clientId:this.connectionManager.clientId,sequenceNumber:b.sequenceNumber,message1:k,message2:S,driverVersion:void 0});this.close(C)}}}else b.sequenceNumber!==this.lastQueuedSequenceNumber+1?(this.pending.push(b),this.fetchMissingDeltas(t,b.sequenceNumber)):(this.lastQueuedSequenceNumber=b.sequenceNumber,this.previouslyProcessedMessage=b,this._inbound.push(b))}}catch(w){y.e(w)}finally{y.f()}this.prevEnqueueMessagesReason=this.pending.length>0?"unknown":t}}else this.pending=this.pending.concat(e)}},{key:"processInboundMessage",value:function(e){var t=Date.now();(0,qe.h)(!this.currentlyProcessingOps,943),this.currentlyProcessingOps=!0,this.lastProcessedMessage=e;var r="string"===typeof e.clientId;if((0,qe.h)(null===e.clientId||r,1050),!r&&Bt(e)&&e.type!==st.Cs.NoOp)throw new Je("Mismatch in clientId",Object.assign(Object.assign({},Qe(e)),{messageType:e.type}));if("string"===typeof e.contents&&""!==e.contents&&e.type!==st.Cs.ClientLeave&&(e.contents=JSON.parse(e.contents)),void 0!==this.connectionManager.clientId&&this.connectionManager.clientId===e.clientId){e.type===st.Cs.NoOp&&this.noOpCount--;var n=e.clientSequenceNumber-this.lastClientSequenceNumber-1;if(this.noOpCount-=n,this.noOpCount<0)throw new Error("gap in client sequence number: ".concat(n));this.lastClientSequenceNumber=e.clientSequenceNumber}if(this.connectionManager.beforeProcessingIncomingOp(e),this.minSequenceNumber>e.minimumSequenceNumber)throw new Je("Found a lower minimumSequenceNumber (msn) than previously recorded",Object.assign(Object.assign({},Qe(e)),{clientId:this.connectionManager.clientId}));var o=e.sequenceNumber-e.minimumSequenceNumber;if(o<0||0===o&&null!==e.clientId)throw new Je("MSN has to be lower than sequence #",Qe(e));if(this.minSequenceNumber=e.minimumSequenceNumber,e.sequenceNumber!==this.lastProcessedSequenceNumber+1)throw new Je("Found a non-Sequential sequenceNumber",Object.assign(Object.assign({},Qe(e)),{clientId:this.connectionManager.clientId}));if(this.lastProcessedSequenceNumber=e.sequenceNumber,(0,qe.h)(this.lastProcessedSequenceNumber<=this.lastObservedSeqNumber,615),void 0===e.term&&(e.term=1),void 0===this.handler)throw new Error("Attempted to process an inbound message without a handler attached");this.handler.process(e),this.currentlyProcessingOps=!1;var i=Date.now();this.emit("op",e,i-t)}},{key:"fetchMissingDeltas",value:function(e,t){var r=this;this.fetchMissingDeltasCore(e,!1,t).catch((function(e){r.logger.sendErrorEvent({eventName:"fetchMissingDeltasException"},e)}))}},{key:"fetchMissingDeltasCore",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r,o){var i,a,s,c,u=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===this.fetchReason){e.next=2;break}return e.abrupt("return");case 2:if(!this._closed){e.next=5;break}return this.logger.sendTelemetryEvent({eventName:"fetchMissingDeltasClosedConnection",reason:t}),e.abrupt("return");case 5:if(void 0!==this.handler){e.next=8;break}return(0,qe.h)(0===this.lastQueuedSequenceNumber,619),e.abrupt("return");case 8:return e.prev=8,a=this.lastQueuedSequenceNumber+1,void 0!==(s=null===(i=this.previouslyProcessedMessage)||void 0===i?void 0:i.sequenceNumber)&&((0,qe.h)(s===this.lastQueuedSequenceNumber,242),(0,qe.h)(a>1,243),a--),c="".concat(t,"_fetch"),this.fetchReason=c,e.next=16,this.getDeltas(a,o,c,(function(e){u.refreshDelayInfo(u.deltaStorageDelayId),u.enqueueMessages(e,c)}),r);case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(8),this.logger.sendErrorEvent({eventName:"GetDeltas_Exception"},e.t0),this.close((0,Ye.SC)(e.t0));case 22:return e.prev=22,this.refreshDelayInfo(this.deltaStorageDelayId),this.fetchReason=void 0,this.processPendingOps(t),e.finish(22);case 27:case"end":return e.stop()}}),e,this,[[8,18,22,27]])})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"processPendingOps",value:function(e){if(!this._closed){(0,qe.h)(void 0!==this.handler,620);var t=this.pending.sort((function(e,t){return e.sequenceNumber-t.sequenceNumber}));this.pending=[],this.enqueueMessages(t,"".concat(e,"_pending"),!0),void 0===this.fetchReason&&this.lastQueuedSequenceNumber<this.lastObservedSeqNumber&&this.fetchMissingDeltas("OpsBehind")}}},{key:"updateLatestKnownOpSeqNumber",value:function(e){this.lastObservedSeqNumber<e&&(this.lastObservedSeqNumber=e)}}]),r}(vt.L),At=r(1987),Ot=function(e){(0,be.Z)(r,e);var t=(0,ke.Z)(r);function r(e){var n;return(0,u.Z)(this,r),(n=t.call(this,e)).deltaManager=e,n}return(0,c.Z)(r,[{key:"IDeltaSender",get:function(){return this}},{key:"inbound",get:function(){return this.deltaManager.inbound}},{key:"outbound",get:function(){return this.deltaManager.outbound}},{key:"inboundSignal",get:function(){return this.deltaManager.inboundSignal}},{key:"minimumSequenceNumber",get:function(){return this.deltaManager.minimumSequenceNumber}},{key:"lastSequenceNumber",get:function(){return this.deltaManager.lastSequenceNumber}},{key:"lastMessage",get:function(){return this.deltaManager.lastMessage}},{key:"lastKnownSeqNumber",get:function(){return this.deltaManager.lastKnownSeqNumber}},{key:"initialSequenceNumber",get:function(){return this.deltaManager.initialSequenceNumber}},{key:"hasCheckpointSequenceNumber",get:function(){return this.deltaManager.hasCheckpointSequenceNumber}},{key:"clientDetails",get:function(){return this.deltaManager.clientDetails}},{key:"version",get:function(){return this.deltaManager.version}},{key:"maxMessageSize",get:function(){return this.deltaManager.maxMessageSize}},{key:"serviceConfiguration",get:function(){return this.deltaManager.serviceConfiguration}},{key:"active",get:function(){return this.deltaManager.active}},{key:"readOnlyInfo",get:function(){return this.deltaManager.readOnlyInfo}},{key:"dispose",value:function(){(0,dt.Z)((0,ft.Z)(r.prototype),"dispose",this).call(this)}},{key:"submitSignal",value:function(e){return this.deltaManager.submitSignal(e)}},{key:"flush",value:function(){return this.deltaManager.flush()}}]),r}(At._),Lt=function(e){(0,be.Z)(r,e);var t=(0,ke.Z)(r);function r(e){var n;return(0,u.Z)(this,r),(n=t.call(this,e)).queue=e,n}return(0,c.Z)(r,[{key:"paused",get:function(){return this.queue.paused}},{key:"length",get:function(){return this.queue.length}},{key:"idle",get:function(){return this.queue.idle}},{key:"peek",value:function(){return this.queue.peek()}},{key:"toArray",value:function(){return this.queue.toArray()}},{key:"systemPause",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.pause());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pause",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.queue.pause());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"systemResume",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.resume());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"resume",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.queue.resume();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"waitTillProcessingDone",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.queue.waitTillProcessingDone());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),r}(At._),_t=function(e){(0,be.Z)(r,e);var t=(0,ke.Z)(r);function r(e){var n;return(0,u.Z)(this,r),(n=t.call(this,e))._inbound=new Lt(e.inbound),n._outbound=new Lt(e.outbound),n._inboundSignal=new Lt(e.inboundSignal),n}return(0,c.Z)(r,[{key:"inbound",get:function(){return this._inbound}},{key:"outbound",get:function(){return this._outbound}},{key:"inboundSignal",get:function(){return this._inboundSignal}},{key:"dispose",value:function(){this._inbound.dispose(),this._outbound.dispose(),this._inboundSignal.dispose(),(0,dt.Z)((0,ft.Z)(r.prototype),"dispose",this).call(this)}}]),r}(Ot),Mt="2.0.0-internal.4.4.3",Rt=r(24071),Ht=r(74033),jt=function(){function e(t,r){(0,u.Z)(this,e),this.internalStorageService=t,this.addProtocolSummaryIfMissing=r,this.getSnapshotTree=this.internalStorageService.getSnapshotTree.bind(this.internalStorageService),this.getVersions=this.internalStorageService.getVersions.bind(this.internalStorageService),this.createBlob=this.internalStorageService.createBlob.bind(this.internalStorageService),this.readBlob=this.internalStorageService.readBlob.bind(this.internalStorageService),this.downloadSummary=this.internalStorageService.downloadSummary.bind(this.internalStorageService),this.dispose=this.internalStorageService.dispose.bind(this.internalStorageService)}return(0,c.Z)(e,[{key:"policies",get:function(){return this.internalStorageService.policies}},{key:"repositoryUrl",get:function(){return this.internalStorageService.repositoryUrl}},{key:"disposed",get:function(){return this.internalStorageService.disposed}},{key:"uploadSummaryWithContext",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.internalStorageService.uploadSummaryWithContext(this.addProtocolSummaryIfMissing(t),r));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()}]),e}(),Ut=function(){function e(t,r){(0,u.Z)(this,e),this.internalStorageService=t,this.logger=r,this._disposed=!1}return(0,c.Z)(e,[{key:"policies",get:function(){return this.internalStorageService.policies}},{key:"disposed",get:function(){return this._disposed}},{key:"dispose",value:function(){this._disposed=!0}},{key:"repositoryUrl",get:function(){return this.internalStorageService.repositoryUrl}},{key:"getSnapshotTree",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){var o=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.runWithRetry((0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o.internalStorageService.getSnapshotTree(t,r));case 1:case"end":return e.stop()}}),e)}))),"storage_getSnapshotTree"));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"readBlob",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.runWithRetry((0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.internalStorageService.readBlob(t));case 1:case"end":return e.stop()}}),e)}))),"storage_readBlob"));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getVersions",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r,o,a){var s=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.runWithRetry((0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",s.internalStorageService.getVersions(t,r,o,a));case 1:case"end":return e.stop()}}),e)}))),"storage_getVersions"));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r,n,o){return e.apply(this,arguments)}}()},{key:"uploadSummaryWithContext",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){var o=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,qe.h)(0===r.referenceSequenceNumber===(void 0===r.ackHandle),593),0===r.referenceSequenceNumber){e.next=3;break}return e.abrupt("return",this.internalStorageService.uploadSummaryWithContext(t,r));case 3:return e.abrupt("return",this.runWithRetry((0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o.internalStorageService.uploadSummaryWithContext(t,r));case 1:case"end":return e.stop()}}),e)}))),"storage_uploadSummaryWithContext"));case 4:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"downloadSummary",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.runWithRetry((0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.internalStorageService.downloadSummary(t));case 1:case"end":return e.stop()}}),e)}))),"storage_downloadSummary"));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createBlob",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.runWithRetry((0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.internalStorageService.createBlob(t));case 1:case"end":return e.stop()}}),e)}))),"storage_createBlob"));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"checkStorageDisposed",value:function(e,t){if(this._disposed)throw this.logger.sendTelemetryEvent({eventName:"".concat(e,"_abortedStorageDisposed"),fetchCallName:e},t),new Ve("Storage Service is disposed. Cannot retry",{canRetry:!1})}},{key:"runWithRetry",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){var o=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",nt(t,r,this.logger,{onRetry:function(e,t){return o.checkStorageDisposed(r,t)}}));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()}]),e}(),qt=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;(0,u.Z)(this,e),this.logger=r,this.blobContents=n,this.addProtocolSummaryIfMissing=o,this.disposed=!1,this._storageService=new zt(t,r),this._summarizeProtocolTree=i}return(0,c.Z)(e,[{key:"summarizeProtocolTree",get:function(){return!0===this._summarizeProtocolTree}},{key:"dispose",value:function(e){var t,r;null===(r=null===(t=this._storageService)||void 0===t?void 0:t.dispose)||void 0===r||r.call(t,e),this.disposed=!0}},{key:"connectToService",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,o,i,a,s,c;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._storageService instanceof zt){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.connectToStorage();case 4:s=e.sent,c=this._storageService=new Ut(s,this.logger),this._summarizeProtocolTree=null!==(r=this._summarizeProtocolTree)&&void 0!==r?r:null===(o=t.policies)||void 0===o?void 0:o.summarizeProtocolTree,this.summarizeProtocolTree&&(this.logger.sendTelemetryEvent({eventName:"summarizeProtocolTreeEnabled"}),this._storageService=new jt(c,this.addProtocolSummaryIfMissing)),(0,qe.h)((null===(i=s.policies)||void 0===i?void 0:i.minBlobSize)===(null===(a=this._storageService.policies)||void 0===a?void 0:a.minBlobSize),224);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadSnapshotForRehydratingContainer",value:function(e){this.getBlobContents(e)}},{key:"getBlobContents",value:function(e){for(var t=0,r=Object.entries(e.blobsContents);t<r.length;t++){var n=(0,o.Z)(r[t],2),i=n[0],a=n[1];this.blobContents[i]=a}for(var s=0,c=Object.entries(e.trees);s<c.length;s++){var u=(0,o.Z)(c[s],2),l=(u[0],u[1]);this.getBlobContents(l)}}},{key:"policies",get:function(){try{return this._storageService.policies}catch(e){}}},{key:"repositoryUrl",get:function(){return this._storageService.repositoryUrl}},{key:"getSnapshotTree",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._storageService.getSnapshotTree(t,r));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"readBlob",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===(r=this.blobContents[t])){e.next=6;break}if("string"!==typeof r){e.next=5;break}return o=(0,Rt.k8)(r,"utf8"),e.abrupt("return",o);case 5:return e.abrupt("return",r);case 6:return e.abrupt("return",this._storageService.readBlob(t));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getVersions",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r,o,i){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._storageService.getVersions(t,r,o,i));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r,n,o){return e.apply(this,arguments)}}()},{key:"uploadSummaryWithContext",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._storageService.uploadSummaryWithContext(t,r));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"downloadSummary",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._storageService.downloadSummary(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createBlob",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._storageService.createBlob(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),zt=function(){function e(t,r){(0,u.Z)(this,e),this.detachedStorage=t,this.logger=r,this.getSnapshotTree=this.notCalled,this.getVersions=this.notCalled,this.write=this.notCalled,this.uploadSummaryWithContext=this.notCalled,this.downloadSummary=this.notCalled}return(0,c.Z)(e,[{key:"createBlob",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.verifyStorage().createBlob(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readBlob",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.verifyStorage().readBlob(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"verifyStorage",value:function(){if(void 0===this.detachedStorage)throw new Ht.O("Real storage calls not allowed in Unattached container");return this.detachedStorage}},{key:"policies",get:function(){return this.notCalled()}},{key:"repositoryUrl",get:function(){return this.notCalled()}},{key:"notCalled",value:function(){this.verifyStorage();try{throw new Error("BlobOnlyStorage not implemented method used")}catch(e){throw this.logger.sendTelemetryEvent({eventName:"BlobOnlyStorageWrongCall"},e),e}}}]),e}(),Yt=".blobs";function Vt(e,t){return Gt.apply(this,arguments)}function Gt(){return(Gt=(0,i.Z)((0,n.Z)().mark((function e(t,r){var o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={},e.next=3,Wt(t,o,r);case 3:return e.abrupt("return",o);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Wt(e,t,r){return Jt.apply(this,arguments)}function Jt(){return Jt=(0,i.Z)((0,n.Z)().mark((function e(t,r,i){var a,s,c,u,l,d,f,h,p,v,g,m=arguments;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=!(m.length>3&&void 0!==m[3])||m[3],s=[],c=0,u=Object.entries(t.trees);c<u.length;c++)l=(0,o.Z)(u[c],2),d=l[0],f=l[1],a&&d===Yt||s.push(Wt(f,r,i,!1));h=0,p=Object.values(t.blobs);case 4:if(!(h<p.length)){e.next=13;break}return v=p[h],e.next=8,i.readBlob(v);case 8:g=e.sent,r[v]=(0,Rt.zT)(g,"utf8");case 10:h++,e.next=4;break;case 13:return e.abrupt("return",Promise.all(s));case 14:case"end":return e.stop()}}),e)}))),Jt.apply(this,arguments)}function Kt(e){var t={};return Qt(e,t),t}function Qt(e,t){for(var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=0,i=Object.entries(e.trees);n<i.length;n++){var a=(0,o.Z)(i[n],2),s=a[0],c=a[1];r&&s===Yt||Qt(c,t,!1)}for(var u=0,l=Object.values(e.blobs);u<l.length;u++){var d=l[u],f=e.blobsContents[d];(0,qe.h)(void 0!==f,748),t[d]=(0,Rt.zT)(f,"utf8")}}var Xt=2147483647;function $t(e,t,r){var n;if(t>Xt){var o=t-Xt;n=setTimeout((function(){return $t(e,o,r)}),Xt)}else n=setTimeout((function(){return e()}),Math.max(t,0));return null===r||void 0===r||r(n),n}var er,tr=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return Date.now()};(0,u.Z)(this,e),this.defaultTimeout=t,this.defaultHandler=r,this.getCurrentTick=n}return(0,c.Z)(e,[{key:"hasTimer",get:function(){return!!this.runningState}},{key:"start",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.defaultTimeout,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultHandler;this.startCore(e,t,e)}},{key:"clear",value:function(){this.runningState&&(clearTimeout(this.runningState.timeout),this.runningState=void 0)}},{key:"restart",value:function(e,t){var r,n;if(this.runningState){var o=null!==e&&void 0!==e?e:this.runningState.intendedDuration,i=null!==(n=null!==t&&void 0!==t?t:null===(r=this.runningState.restart)||void 0===r?void 0:r.handler)&&void 0!==n?n:this.runningState.handler,a=this.calculateRemainingTime(this.runningState);o<a?this.start(o,i):o===a?(this.runningState.handler=i,this.runningState.restart=void 0,this.runningState.intendedDuration=o):this.runningState.restart={startTick:this.getCurrentTick(),duration:o,handler:i}}else this.start(e,t)}},{key:"startCore",value:function(e,t,r){var n=this;this.clear(),this.runningState={startTick:this.getCurrentTick(),duration:e,intendedDuration:r,handler:t,timeout:$t((function(){return n.handler()}),e,(function(e){void 0!==n.runningState&&(n.runningState.timeout=e)}))}}},{key:"handler",value:function(){(0,qe.h)(!!this.runningState,10);var e=this.runningState.restart;if(void 0!==e){var t=this.calculateRemainingTime(e);this.startCore(t,(function(){return e.handler()}),e.duration)}else{var r=this.runningState.handler;this.clear(),r()}}},{key:"calculateRemainingTime",value:function(e){var t=this.getCurrentTick()-e.startTick;return e.duration-t}}]),e}();!function(e){e[e.Disconnected=0]="Disconnected",e[e.EstablishingConnection=3]="EstablishingConnection",e[e.CatchingUp=1]="CatchingUp",e[e.Connected=2]="Connected"}(er||(er={}));var rr=function(){function e(t,r){var n=this;(0,u.Z)(this,e),this.deltaManager=t,this.listener=r,this.caughtUp=!1,this.opHandler=function(e){!n.caughtUp&&e.sequenceNumber>=n.targetSeqNumber&&(n.caughtUp=!0,n.listener())},this.disposed=!1,this.targetSeqNumber=this.deltaManager.lastKnownSeqNumber,(0,qe.h)(this.targetSeqNumber>=this.deltaManager.lastSequenceNumber,892),this.deltaManager.on("op",this.opHandler),this.opHandler({sequenceNumber:this.deltaManager.lastSequenceNumber})}return(0,c.Z)(e,[{key:"dispose",value:function(){this.disposed||(this.disposed=!0,this.deltaManager.off("op",this.opHandler))}}]),e}();function nr(e,t,r){var n=(0,De.rZ)(e.logger);return function(e,t,r,n,o){if(!e)return new ar(r,t,o);return new ir(r,(function(e){return new ar(e,t,o)}),n)}(!0===n.config.getBoolean("Fluid.Container.CatchUpBeforeDeclaringConnected"),!0===n.config.getBoolean("Fluid.Container.EnableJoinSignalWait"),e,t,r)}var or=function(){function e(t,r){(0,u.Z)(this,e),this.inputs=t,this.pimpl=r(this)}return(0,c.Z)(e,[{key:"connectionState",get:function(){return this.pimpl.connectionState}},{key:"pendingClientId",get:function(){return this.pimpl.pendingClientId}},{key:"containerSaved",value:function(){return this.pimpl.containerSaved()}},{key:"dispose",value:function(){return this.pimpl.dispose()}},{key:"initProtocol",value:function(e){return this.pimpl.initProtocol(e)}},{key:"receivedDisconnectEvent",value:function(e,t){return this.pimpl.receivedDisconnectEvent(e,t)}},{key:"receivedConnectEvent",value:function(e){return this.pimpl.receivedConnectEvent(e)}},{key:"logger",get:function(){return this.inputs.logger}},{key:"connectionStateChanged",value:function(e,t,r,n){return this.inputs.connectionStateChanged(e,t,r,n)}},{key:"shouldClientJoinWrite",value:function(){return this.inputs.shouldClientJoinWrite()}},{key:"maxClientLeaveWaitTime",get:function(){return this.inputs.maxClientLeaveWaitTime}},{key:"logConnectionIssue",value:function(e,t,r){return this.inputs.logConnectionIssue(e,t,r)}}]),e}(),ir=function(e){(0,be.Z)(r,e);var t=(0,ke.Z)(r);function r(e,n,o){var i;return(0,u.Z)(this,r),(i=t.call(this,e,n)).deltaManager=o,i.transitionToConnectedState=function(){var e=i.pimpl.connectionState;(0,qe.h)(e===er.Connected,997),(0,qe.h)(i._connectionState===er.CatchingUp,998),i._connectionState=er.Connected,i.inputs.connectionStateChanged(er.Connected,er.CatchingUp,"caught up")},i._connectionState=i.pimpl.connectionState,i}return(0,c.Z)(r,[{key:"connectionState",get:function(){return this._connectionState}},{key:"connectionStateChanged",value:function(e,t,r,n){var o;switch(e){case er.Connected:return(0,qe.h)(this._connectionState===er.CatchingUp,993),(0,qe.h)(void 0===this.catchUpMonitor,1003),void(this.catchUpMonitor=new rr(this.deltaManager,this.transitionToConnectedState));case er.Disconnected:null===(o=this.catchUpMonitor)||void 0===o||o.dispose(),this.catchUpMonitor=void 0;break;case er.CatchingUp:(0,qe.h)(this._connectionState===er.Disconnected,995)}this._connectionState=e,this.inputs.connectionStateChanged(e,t,r,n)}}]),r}(or),ar=function(){function e(t,r,n){var o,i=this;(0,u.Z)(this,e),this.handler=t,this.readClientsWaitForJoinSignal=r,this._connectionState=er.Disconnected,this._clientId=n,this.prevClientLeftTimer=new tr(null!==(o=this.handler.maxClientLeaveWaitTime)&&void 0!==o?o:3e5,(function(){(0,qe.h)(i.connectionState!==er.Connected,684),i.applyForConnectedState("timeout")})),this.joinOpTimer=new tr(0,(function(){if(i.connectionState===er.CatchingUp){var e={protocolInitialized:void 0!==i.protocol,pendingClientId:i.pendingClientId,clientJoined:i.hasMember(i.pendingClientId),waitingForLeaveOp:i.waitingForLeaveOp};i.handler.logConnectionIssue("NoJoinOp","error",e)}}))}return(0,c.Z)(e,[{key:"connectionState",get:function(){return this._connectionState}},{key:"clientId",get:function(){return this._clientId}},{key:"pendingClientId",get:function(){return this._pendingClientId}},{key:"startJoinOpTimer",value:function(){(0,qe.h)(!this.joinOpTimer.hasTimer,564),(0,qe.h)(void 0!==this.connection,1203),this.joinOpTimer.start("write"===this.connection.mode?45e3:5e3)}},{key:"stopJoinOpTimer",value:function(){(0,qe.h)(this.joinOpTimer.hasTimer,565),this.joinOpTimer.clear()}},{key:"waitingForLeaveOp",get:function(){return this.prevClientLeftTimer.hasTimer}},{key:"dispose",value:function(){(0,qe.h)(!this.joinOpTimer.hasTimer,677),this.prevClientLeftTimer.clear()}},{key:"containerSaved",value:function(){this.waitingForLeaveOp&&(this.prevClientLeftTimer.clear(),this.applyForConnectedState("containerSaved"))}},{key:"receivedAddMemberEvent",value:function(e){e===this.pendingClientId?(this.joinOpTimer.hasTimer?this.stopJoinOpTimer():this.shouldWaitForJoinSignal()&&this.handler.logConnectionIssue("ReceivedJoinOp","generic"),this.waitingForLeaveOp&&(this.waitEvent=Le.Xr.start(this.handler.logger,{eventName:"WaitBeforeClientLeave",details:JSON.stringify({waitOnClientId:this._clientId,hadOutstandingOps:this.handler.shouldClientJoinWrite()})})),this.applyForConnectedState("addMemberEvent")):e===this.clientId&&((0,qe.h)(!this.waitingForLeaveOp,1490),(0,qe.h)(this.connectionState!==er.Connected,1491),this.prevClientLeftTimer.restart())}},{key:"applyForConnectedState",value:function(e){var t;if((0,qe.h)(void 0!==this.protocol,566),(0,qe.h)(!this.waitingForLeaveOp||this.hasMember(this.clientId),738),this.pendingClientId!==this.clientId&&this.hasMember(this.pendingClientId)&&!this.waitingForLeaveOp)null===(t=this.waitEvent)||void 0===t||t.end({source:e}),this.setConnectionState(er.Connected);else{var r="timeout"===e&&this.connectionState!==er.Disconnected;this.handler.logger.sendTelemetryEvent({eventName:"connectedStateRejected",category:r?"error":"generic",details:JSON.stringify({source:e,pendingClientId:this.pendingClientId,clientId:this.clientId,waitingForLeaveOp:this.waitingForLeaveOp,clientJoined:this.hasMember(this.pendingClientId)})})}}},{key:"receivedRemoveMemberEvent",value:function(e){this.clientId===e&&(this.prevClientLeftTimer.clear(),this.applyForConnectedState("removeMemberEvent"))}},{key:"receivedDisconnectEvent",value:function(e,t){this.connection=void 0,this.setConnectionState(er.Disconnected,e,t)}},{key:"shouldWaitForJoinSignal",value:function(){return(0,qe.h)(void 0!==this.connection,1204),"write"===this.connection.mode||this.readClientsWaitForJoinSignal}},{key:"receivedConnectEvent",value:function(e){this.connection=e;var t=this._connectionState;this._connectionState=er.CatchingUp,this._pendingClientId=e.clientId,this.handler.connectionStateChanged(er.CatchingUp,t,e.reason),!this.hasMember(this._pendingClientId)&&this.shouldWaitForJoinSignal()?this.startJoinOpTimer():this.waitingForLeaveOp||this.setConnectionState(er.Connected)}},{key:"setConnectionState",value:function(e,t,r){var n,o;if(this.connectionState!==e){var i,a=this._connectionState;this._connectionState=e,void 0!==this._clientId&&(i=null===(o=null===(n=this.protocol)||void 0===n?void 0:n.quorum)||void 0===o?void 0:o.getMember(this._clientId)),e===er.Connected?((0,qe.h)(a===er.CatchingUp,472),void 0!==i&&(i.shouldHaveLeft=!0),this._clientId=this.pendingClientId):e===er.Disconnected&&(this._pendingClientId=void 0,this.joinOpTimer.hasTimer&&this.stopJoinOpTimer(),void 0!==i&&this.handler.shouldClientJoinWrite()&&!this.waitingForLeaveOp?this.prevClientLeftTimer.restart():this.handler.logger.sendTelemetryEvent({eventName:"noWaitOnDisconnected",details:JSON.stringify({clientId:this._clientId,inQuorum:void 0!==i,waitingForLeaveOp:this.waitingForLeaveOp,hadOutstandingOps:this.handler.shouldClientJoinWrite()})})),this.handler.connectionStateChanged(this._connectionState,a,t,r)}else this.handler.logger.sendErrorEvent({eventName:"setConnectionStateSame",value:e})}},{key:"membership",get:function(){var e,t;return this.readClientsWaitForJoinSignal?null===(e=this.protocol)||void 0===e?void 0:e.audience:null===(t=this.protocol)||void 0===t?void 0:t.quorum}},{key:"initProtocol",value:function(e){var t,r,n=this;this.protocol=e,null===(t=this.membership)||void 0===t||t.on("addMember",(function(t,r){(0,qe.h)("read"===r.mode||void 0!==e.quorum.getMember(t),1205),n.receivedAddMemberEvent(t)})),null===(r=this.membership)||void 0===r||r.on("removeMember",(function(t){(0,qe.h)(void 0===e.quorum.getMember(t),1206),n.receivedRemoveMemberEvent(t)})),this.hasMember(this.pendingClientId)&&this.receivedAddMemberEvent(this.pendingClientId),void 0!==this.clientId&&this.hasMember(this.clientId)&&this.prevClientLeftTimer.restart()}},{key:"hasMember",value:function(e){var t;return void 0!==(null===(t=this.membership)||void 0===t?void 0:t.getMember(null!==e&&void 0!==e?e:""))}}]),e}(),sr=r(12114),cr=r(95576);function ur(e){var t,r=(0,sr.parse)(e,!0);if("string"!==typeof r.pathname)throw new Ye.j4("Failed to parse pathname");var n=null!==(t=r.search)&&void 0!==t?t:"",o=/^\/([^/]*\/[^/]*)(\/?.*)$/.exec(r.pathname);return 3===(null===o||void 0===o?void 0:o.length)?{id:o[1],path:o[2],query:n,version:r.query.version}:void 0}function lr(e){for(var t={blobs:{},blobsContents:{},trees:{},id:(0,Ie.Z)(),unreferenced:e.unreferenced},r=0,n=Object.keys(e.tree);r<n.length;r++){var o=n[r],i=e.tree[o];switch(i.type){case at.J.Tree:t.trees[o]=lr(i);break;case at.J.Attachment:t.blobs[o]=i.id;break;case at.J.Blob:var a=(0,Ie.Z)();t.blobs[o]=a;var s="string"===typeof i.content?(0,Rt.k8)(i.content,"utf8"):(0,cr.H)(i.content);t.blobsContents[a]=s;break;case at.J.Handle:throw new Ye.j4("No handles should be there in summary in detached container!!");default:(0,ze.U)(i,"Unknown tree type ".concat(i.type))}}return t}function dr(e,t){var r={type:at.J.Tree,tree:Object.assign({},t.tree)};return r.tree[".protocol"]=e,lr(r)}var fr=function(e){return(0,qe.h)((0,Xe.F2)(e),480),dr(e.tree[".protocol"],e.tree[".app"])};function hr(e){return".protocol"in e.trees?e.trees[".protocol"]:e}function pr(e,t){return function(){if(e.disposed)throw new Error("Already disposed");return t.apply(void 0,arguments)}}var vr=function(e){(0,be.Z)(r,e);var t=(0,ke.Z)(r);function r(e){var n,o;return(0,u.Z)(this,r),o=t.call(this,e),(0,dt.Z)((n=(0,yt.Z)(o),(0,ft.Z)(r.prototype)),"setMaxListeners",n).call(n,50),o.propose=pr((0,yt.Z)(o),e.propose.bind(e)),o.has=pr((0,yt.Z)(o),e.has.bind(e)),o.get=pr((0,yt.Z)(o),e.get.bind(e)),o.getMembers=pr((0,yt.Z)(o),e.getMembers.bind(e)),o.getMember=pr((0,yt.Z)(o),e.getMember.bind(e)),o}return(0,c.Z)(r)}(At._);function gr(e){var t=new Map(e).get("code");return(0,qe.h)(void 0!==t,732),null===t||void 0===t?void 0:t.value}function mr(e){return[["code",{key:"code",value:e,approvalSequenceNumber:0,commitSequenceNumber:0,sequenceNumber:0}]]}var yr=function(){function e(t){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;(0,u.Z)(this,e),this.submit=t,this.NoopCountFrequency=o,this.opsCountSinceNoop=0,n!==1/0&&(this.timer=new tr(n,(function(){0!==r.opsCountSinceNoop&&r.submitNoop(!1)})))}return(0,c.Z)(e,[{key:"scheduleSequenceNumberUpdate",value:function(e,t){var r=this;t?this.submitNoop(!0):(0,St.LW)(e)&&(this.opsCountSinceNoop++,this.opsCountSinceNoop===this.NoopCountFrequency&&Promise.resolve().then((function(){r.opsCountSinceNoop>=r.NoopCountFrequency&&(r.submitNoop(!1),r.opsCountSinceNoop=0)})),void 0!==this.timer&&(1===this.opsCountSinceNoop&&this.timer.restart(),(0,qe.h)(this.timer.hasTimer,578)))}},{key:"submitNoop",value:function(e){this.submit(e?St.UH.Accept:st.Cs.NoOp),(0,qe.h)(0===this.opsCountSinceNoop,579)}},{key:"stopSequenceNumberUpdate",value:function(){this.opsCountSinceNoop=0}}]),e}(),br=r(20851),kr=r(45108),Sr={fatalConnectError:!0};var Cr={mode:"read",details:{capabilities:{interactive:!0}},permission:[],user:{id:"storage-only client"},scopes:[]},wr="storage-only client",xr=function(e){(0,be.Z)(r,e);var t=(0,ke.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=t.apply(this,arguments)).clientId=wr,e.claims={scopes:[kr.p.DocRead]},e.mode="read",e.existing=!0,e.maxMessageSize=0,e.version="",e.initialMessages=[],e.initialSignals=[],e.initialClients=[{client:Cr,clientId:wr}],e.serviceConfiguration={maxMessageSize:0,blockSize:0},e.checkpointSequenceNumber=void 0,e._disposed=!1,e}return(0,c.Z)(r,[{key:"submit",value:function(e){this.emit("nack",this.clientId,e.map((function(e){return{operation:e,content:{message:"Cannot submit with storage-only connection",code:403}}})))}},{key:"submitSignal",value:function(e){this.emit("nack",this.clientId,{operation:e,content:{message:"Cannot submit signal with storage-only connection",code:403}})}},{key:"disposed",get:function(){return this._disposed}},{key:"dispose",value:function(){this._disposed=!0}}]),r}(vt.L),Pr=function(){var e=(0,i.Z)((0,n.Z)().mark((function e(){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!1!==(null===(t=globalThis.navigator)||void 0===t?void 0:t.onLine)||void 0===globalThis.addEventListener){e.next=2;break}return e.abrupt("return",new Promise((function(e){globalThis.addEventListener("online",(function t(){e(),globalThis.removeEventListener("online",t)}))})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Er=function(){function e(t,r,n,o,i,a){var s=this;(0,u.Z)(this,e),this.serviceProvider=t,this.containerDirty=r,this.client=n,this.logger=i,this.props=a,this._forceReadonly=!1,this.pendingReconnect=!1,this.clientSequenceNumber=0,this.clientSequenceNumberObserved=0,this.localOpsToIgnore=0,this.connectFirstConnection=!0,this._connectionVerboseProps={},this._connectionProps={},this._disposed=!1,this.opHandler=function(e,t){var r=Array.isArray(t)?t:[t];s.props.incomingOpHandler(r,"opHandler")},this.nackHandler=function(e,t){var r=t[0];if(!0!==s._readonlyPermissions){var n=function(e){var t="Nack (".concat(e.type,"): ").concat(e.message),r=403!==e.code,n=void 0!==e.retryAfter?1e3*e.retryAfter:void 0;return(0,tt.jx)(t,{canRetry:r,retryAfterMs:n},{statusCode:e.code,driverVersion:void 0})}(r.content);n.canRetry?s.reconnectOnError("write",n):s.props.closeHandler(n)}else s.props.closeHandler((0,tt.j)("writeOnReadOnlyDocument",{driverVersion:void 0}))},this.disconnectHandlerInternal=function(e){s.reconnectOnError(s.defaultReconnectionMode,e)},this.errorHandler=function(e){s.reconnectOnError(s.defaultReconnectionMode,e)},this.clientDetails=this.client.details,this.defaultReconnectionMode=this.client.mode,this._reconnectMode=o?ut.Enabled:ut.Never,this._outbound=new xt((function(e){if(void 0===s.connection)throw new Error("Attempted to submit an outbound message without connection");s.connection.submit(e)})),this._outbound.on("error",(function(e){s.props.closeHandler((0,Ye.SC)(e))}))}return(0,c.Z)(e,[{key:"connectionVerboseProps",get:function(){return this._connectionVerboseProps}},{key:"connectionMode",get:function(){var e,t;return null!==(t=null===(e=this.connection)||void 0===e?void 0:e.mode)&&void 0!==t?t:"read"}},{key:"connected",get:function(){return void 0!==this.connection}},{key:"clientId",get:function(){var e;return null===(e=this.connection)||void 0===e?void 0:e.clientId}},{key:"reconnectMode",get:function(){return this._reconnectMode}},{key:"maxMessageSize",get:function(){var e,t,r;return null!==(r=null===(t=null===(e=this.connection)||void 0===e?void 0:e.serviceConfiguration)||void 0===t?void 0:t.maxMessageSize)&&void 0!==r?r:16384}},{key:"version",get:function(){if(void 0===this.connection)throw new Error("Cannot check version without a connection");return this.connection.version}},{key:"serviceConfiguration",get:function(){var e;return null===(e=this.connection)||void 0===e?void 0:e.serviceConfiguration}},{key:"scopes",get:function(){var e;return null===(e=this.connection)||void 0===e?void 0:e.claims.scopes}},{key:"outbound",get:function(){return this._outbound}},{key:"connectionProps",get:function(){return void 0!==this.connection?this._connectionProps:Object.assign(Object.assign({},this._connectionProps),{sentOps:this.clientSequenceNumber})}},{key:"shouldJoinWrite",value:function(){var e=this.clientSequenceNumberObserved<this.clientSequenceNumber-this.localOpsToIgnore,t=this.containerDirty();return e!==t&&this.logger.sendTelemetryEvent({eventName:"DesiredConnectionModeMismatch",details:JSON.stringify({outstandingOps:e,isDirty:t})}),e||t}},{key:"readonly",get:function(){return this.readOnlyInfo.readonly}},{key:"readOnlyInfo",get:function(){var e=void 0!==this.connection&&this.connection instanceof xr;return e||this._forceReadonly||!0===this._readonlyPermissions?{readonly:!0,forced:this._forceReadonly,permissions:this._readonlyPermissions,storageOnly:e}:{readonly:this._readonlyPermissions}}},{key:"dispose",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this._disposed){this._disposed=!0,this.pendingConnection=void 0,this._reconnectMode=ut.Never,this._outbound.clear();this.disconnectFromDeltaStream("Closing DeltaManager"),t&&this.set_readonlyPermissions(!0)}}},{key:"setAutoReconnect",value:function(e){(0,qe.h)(e!==ut.Never&&this._reconnectMode!==ut.Never,632),this._reconnectMode=e,e!==ut.Enabled&&this.disconnectFromDeltaStream("setAutoReconnect")}},{key:"forceReadonly",value:function(e){e!==this._forceReadonly&&this.logger.sendTelemetryEvent({eventName:"ForceReadOnly",value:e});var t=this.readonly;if(this._forceReadonly=e,t!==this.readonly){if(this._reconnectMode===ut.Never)throw new We("API is not supported for non-connecting or closed container");var r=!1;!0===this.readonly&&(this.shouldJoinWrite()&&this.logger.sendErrorEvent({eventName:"ForceReadonlyPendingChanged"}),r=this.disconnectFromDeltaStream("Force readonly")),this.props.readonlyChangeHandler(this.readonly),r&&this.triggerConnect("Force Readonly","read")}}},{key:"set_readonlyPermissions",value:function(e){var t=this.readonly;this._readonlyPermissions=e,t!==this.readonly&&this.props.readonlyChangeHandler(this.readonly)}},{key:"connect",value:function(e,t){var r=this;this.connectCore(e,t).catch((function(e){var t=(0,Ye.SC)(e,{props:Sr});r.props.closeHandler(t)}))}},{key:"connectCore",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){var o,i,a,s,c,u,l,d,f,h,p,v,g,m,y,b=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,qe.h)(!this._disposed,618),void 0===this.connection){e.next=3;break}return e.abrupt("return");case 3:if(void 0!==this.pendingConnection&&(s=this.pendingConnection.connectionMode,this.cancelConnection(),(0,qe.h)(void 0===this.pendingConnection,836)),c=null!==(o=null!==r&&void 0!==r?r:s)&&void 0!==o?o:this.defaultReconnectionMode,this.shouldJoinWrite()&&(c="write"),u=this.serviceProvider(),(0,qe.h)(void 0!==u,679),!0!==(null===(i=u.policies)||void 0===i?void 0:i.storageOnly)){e.next=13;break}return l=new xr,this.setupNewSuccessfulConnection(l,"read",t),(0,qe.h)(void 0===this.pendingConnection,691),e.abrupt("return");case 13:d=1e3,f=0,h=Ae.S.now(),v=new(kt()),g=v.signal,this.pendingConnection={abort:function(){v.abort()},connectionMode:c},m=(0,n.Z)().mark((function e(){var t,r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!b._disposed){e.next=2;break}throw new Error("Attempting to connect a closed DeltaManager");case 2:if(!0!==g.aborted){e.next=5;break}return b.logger.sendTelemetryEvent({eventName:"ConnectionAttemptCancelled",attempts:f,duration:Le.hy.formatTick(Ae.S.now()-h),connectionEstablished:!1}),e.abrupt("return",{v:void 0});case 5:return f++,e.prev=6,b.client.mode=c,e.next=10,u.connectToDeltaStream(Object.assign(Object.assign({},b.client),{mode:c}));case 10:(l=e.sent).disposed&&(b.logger.sendTelemetryEvent({eventName:"ReceivedClosedConnection"}),l=void 0),e.next=38;break;case 14:if(e.prev=14,e.t0=e.catch(6),"object"!==typeof e.t0||null===e.t0||(null===e.t0||void 0===e.t0?void 0:e.t0.errorType)!==X.deltaStreamConnectionForbidden){e.next=20;break}return l=new xr,c="read",e.abrupt("return","break");case 20:if((0,tt.ms)(e.t0)){e.next=24;break}throw t=(0,Ye.SC)(e.t0,{props:Sr}),b.props.closeHandler(t),t;case 24:if((0,br.f)(b.logger,{attempts:f,delay:d,eventName:"DeltaConnectionFailureToConnect",duration:Le.hy.formatTick(Ae.S.now()-h)},e.t0),p=e.t0,void 0===(r=(0,tt.ZZ)(e.t0))){e.next=33;break}return b.props.reconnectionDelayHandler(r,e.t0),e.next=31,new Promise((function(e){setTimeout(e,r)}));case 31:e.next=36;break;case 33:if(!1===(null===(a=globalThis.navigator)||void 0===a?void 0:a.onLine)){e.next=36;break}return e.next=36,new Promise((function(e){setTimeout(e,d),d=Math.min(2*d,8e3)}));case 36:return e.next=38,Pr();case 38:case"end":return e.stop()}}),e,null,[[6,14]])}));case 20:if(void 0!==l){e.next=29;break}return e.delegateYield(m(),"t0",22);case 22:if("break"!==(y=e.t0)){e.next=25;break}return e.abrupt("break",29);case 25:if("object"!==typeof y){e.next=27;break}return e.abrupt("return",y.v);case 27:e.next=20;break;case 29:if(f>1&&(0,br.f)(this.logger,{eventName:"MultipleDeltaConnectionFailures",attempts:f,duration:Le.hy.formatTick(Ae.S.now()-h)},p),!0!==g.aborted){e.next=34;break}return l.dispose(),this.logger.sendTelemetryEvent({eventName:"ConnectionAttemptCancelled",attempts:f,duration:Le.hy.formatTick(Ae.S.now()-h),connectionEstablished:!0}),e.abrupt("return");case 34:this.setupNewSuccessfulConnection(l,c,t);case 35:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"triggerConnect",value:function(e,t){this.reconnectMode===ut.Enabled&&this.connect(e,t)}},{key:"disconnectFromDeltaStream",value:function(e,t){if(this.pendingReconnect=!1,void 0===this.connection)return void 0!==this.pendingConnection&&(this.cancelConnection(),!0);(0,qe.h)(void 0===this.pendingConnection,635);var r=this.connection;return this.connection=void 0,r.off("op",this.opHandler),r.off("signal",this.props.signalHandler),r.off("nack",this.nackHandler),r.off("disconnect",this.disconnectHandlerInternal),r.off("error",this.errorHandler),r.off("pong",this.props.pongHandler),this._outbound.pause(),this._outbound.clear(),r.dispose(),this.props.disconnectHandler(e,t),this._connectionVerboseProps={},!0}},{key:"cancelConnection",value:function(){(0,qe.h)(void 0!==this.pendingConnection,837),this.pendingConnection.abort(),this.pendingConnection=void 0,this.logger.sendTelemetryEvent({eventName:"ConnectionCancelReceived"})}},{key:"setupNewSuccessfulConnection",value:function(t,r,n){var o;(0,qe.h)(void 0===this.connection,230),(0,qe.h)(!t.disposed,650),this.pendingConnection=void 0,this.connection=t;var i=!t.claims.scopes.includes(kr.p.DocWrite);if(t.mode!==r&&this.logger.sendTelemetryEvent({eventName:"ConnectionModeMismatch",requestedMode:r,mode:t.mode}),(0,qe.h)("read"===r||i===("read"===this.connectionMode),231),(0,qe.h)(!i||"read"===this.connectionMode,232),this.set_readonlyPermissions(i),this._disposed)this.disconnectFromDeltaStream("ConnectionManager already closed");else{this._outbound.resume(),t.on("op",this.opHandler),t.on("signal",this.props.signalHandler),t.on("nack",this.nackHandler),t.on("disconnect",this.disconnectHandlerInternal),t.on("error",this.errorHandler),t.on("pong",this.props.pongHandler);var a=t.initialMessages.sort((function(e,t){return e.sequenceNumber-t.sequenceNumber})),s=t.checkpointSequenceNumber;this._connectionVerboseProps={clientId:t.clientId,mode:t.mode},this._connectionProps={},void 0!==t.relayServiceAgent&&(this._connectionVerboseProps.relayServiceAgent=t.relayServiceAgent,this._connectionProps.relayServiceAgent=t.relayServiceAgent),this._connectionProps.socketDocumentId=t.claims.documentId,this._connectionProps.connectionMode=t.mode;var c=-1;0!==a.length&&(this._connectionVerboseProps.connectionInitialOpsFrom=a[0].sequenceNumber,c=a[a.length-1].sequenceNumber,this._connectionVerboseProps.connectionInitialOpsTo=c+1,(void 0===s||s<c)&&(s=c)),this.props.incomingOpHandler(a,this.connectFirstConnection?"InitialOps":"ReconnectOps");var u=e.detailsFromConnection(t,n);u.checkpointSequenceNumber=s,this.props.connectHandler(u),this.connectFirstConnection=!1;var l={clientId:null,content:JSON.stringify({type:Nt.Clear})};this.props.signalHandler(l);var d,f=(0,He.Z)(null!==(o=t.initialClients)&&void 0!==o?o:[]);try{for(f.s();!(d=f.n()).done;){var h=d.value,p={clientId:null,content:JSON.stringify({type:Nt.ClientJoin,content:h})};this.props.signalHandler(p)}}catch(y){f.e(y)}finally{f.f()}if(void 0!==t.initialSignals){var v,g=(0,He.Z)(t.initialSignals);try{for(g.s();!(v=g.n()).done;){var m=v.value;this.props.signalHandler(m)}}catch(y){g.e(y)}finally{g.f()}}}}},{key:"reconnectOnError",value:function(e,t){this.reconnect(e,t.message,t).catch(this.props.closeHandler)}},{key:"reconnect",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r,o){var i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,qe.h)(void 0!==this.connection,235),this.disconnectFromDeltaStream(r,o),void 0===o||o.canRetry||this.logger.sendTelemetryEvent({eventName:"reconnectingDespiteFatalError",reconnectMode:this.reconnectMode},o),this.reconnectMode===ut.Never&&this.props.closeHandler(),!this._disposed&&this.reconnectMode===ut.Enabled){e.next=6;break}return e.abrupt("return");case 6:if(i=(0,tt.ZZ)(o),void 0===o||void 0===i){e.next=11;break}return this.props.reconnectionDelayHandler(i,o),e.next=11,new Promise((function(e){setTimeout(e,i)}));case 11:return e.next=13,Pr();case 13:this.triggerConnect(void 0!==o?"Reconnect on Error":"Reconnecting due to: ".concat(r),t);case 14:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"prepareMessageToSend",value:function(e){var t,r;if(!0!==this.readonly)return(0,qe.h)(!!this.connection,228),this.lastSubmittedClientId!==(null===(t=this.connection)||void 0===t?void 0:t.clientId)&&(this.lastSubmittedClientId=null===(r=this.connection)||void 0===r?void 0:r.clientId,this.clientSequenceNumber=0,this.clientSequenceNumberObserved=0),(0,St.LW)(e)?this.localOpsToIgnore=0:this.localOpsToIgnore++,Object.assign(Object.assign({},e),{clientSequenceNumber:++this.clientSequenceNumber});(0,qe.h)(!0===this.readOnlyInfo.readonly,496);var n=new Ve("deltaManagerReadonlySubmit",void 0,{readonly:this.readOnlyInfo.readonly,forcedReadonly:this.readOnlyInfo.forced,readonlyPermissions:this.readOnlyInfo.permissions,storageOnly:this.readOnlyInfo.storageOnly});this.props.closeHandler(n)}},{key:"submitSignal",value:function(e){void 0!==this.connection?this.connection.submitSignal(e):this.logger.sendErrorEvent({eventName:"submitSignalDisconnected"})}},{key:"sendMessages",value:function(e){var t=this;(0,qe.h)(this.connected,692),"read"!==this.connectionMode?((0,qe.h)(!this.pendingReconnect,693),this._outbound.push(e)):this.pendingReconnect||(this.pendingReconnect=!0,Promise.resolve().then((0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.pendingReconnect){e.next=3;break}return e.next=3,t.reconnect("write","Switch to write");case 3:case"end":return e.stop()}}),e)})))).catch((function(){})))}},{key:"beforeProcessingIncomingOp",value:function(e){var t=this;if((0,qe.h)(this.clientId!==e.clientId||this.lastSubmittedClientId===e.clientId,238),void 0!==this.lastSubmittedClientId&&this.lastSubmittedClientId===e.clientId){var r=e.clientSequenceNumber;(0,qe.h)(this.clientSequenceNumberObserved<r,239),(0,qe.h)(r<=this.clientSequenceNumber,240),this.clientSequenceNumberObserved=r}if(e.type===st.Cs.ClientLeave){var n=e;JSON.parse(n.data)===this.clientId&&(this.logger.sendPerformanceEvent({eventName:"ReadConnectionTransition"}),this.reconnect("read","Switch to read").catch((function(e){t.logger.sendErrorEvent({eventName:"SwitchToReadConnection"},e)})))}}}],[{key:"detailsFromConnection",value:function(e,t){return{claims:e.claims,clientId:e.clientId,checkpointSequenceNumber:e.checkpointSequenceNumber,get initialClients(){return e.initialClients},mode:e.mode,serviceConfiguration:e.serviceConfiguration,version:e.version,reason:t}}}]),e}(),Zr="saved";function Tr(e){return Nr.apply(this,arguments)}function Nr(){return(Nr=(0,i.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.closed){e.next=2;break}throw new We("waitContainerToCatchUp: Container closed");case 2:return e.abrupt("return",new Promise((function(e,r){var n=t.deltaManager,o=function e(n){t.off("closed",e);var o="Container closed while waiting to catch up";r(void 0!==n?(0,Ye.Jn)(n,(function(e){return new Ve("".concat(o,": ").concat(e))})):new Ve(o))};t.on("closed",o);var i=function(){(0,qe.h)(t.connectionState===er.CatchingUp||t.connectionState===er.Connected,205);var r=n.hasCheckpointSequenceNumber,i=n.lastKnownSeqNumber;if((0,qe.h)(n.lastSequenceNumber<=i,614),n.lastSequenceNumber===i)return t.off("closed",o),void e(r);n.on("op",(function a(s){i<=s.sequenceNumber&&(t.off("closed",o),e(r),n.off("op",a))}))};if(t.connectionState!==er.Connected){t.on(ct,(function e(){t.off(ct,e),i()})),t.connectionState===er.Disconnected&&t.connect()}else i()})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Fr="summarizer",Ir=function(e){(0,be.Z)(r,e);var t=(0,ke.Z)(r);function r(e,n,o){var i,a,s,c;(0,u.Z)(this,r),i=t.call(this,(function(e,t){i.mc.logger.sendErrorEvent({eventName:"ContainerEventHandlerException",name:"string"===typeof e?e:void 0},t)})),i.loader=e,i.protocolHandlerBuilder=o,i._canReconnect=!0,i._lifecycleState="loading",i._attachState=K.Detached,i.inboundQueuePausedFromInit=!0,i.firstConnection=!0,i.connectionTransitionTimes=[],i.messageCountAfterDisconnection=0,i.attachStarted=!1,i._dirtyContainer=!1,i.savedOps=[],i.setAutoReconnectTime=Ae.S.now(),i._disposed=!1,i.clientDetailsOverride=n.clientDetailsOverride,i._resolvedUrl=n.resolvedUrl,void 0!==n.canReconnect&&(i._canReconnect=n.canReconnect);var l=i.client.details.type,d=i.client.details.capabilities.interactive,f="".concat(d?"interactive":"noninteractive").concat(void 0!==l&&""!==l?"/".concat(l):"");i.subLogger=Le.G2.create(e.services.subLogger,void 0,{all:{clientType:f,containerId:(0,Ie.Z)(),docId:function(){var e,t;return null!==(t=null===(e=i._resolvedUrl)||void 0===e?void 0:e.id)&&void 0!==t?t:void 0},containerAttachState:function(){return i._attachState},containerLifecycleState:function(){return i._lifecycleState},containerConnectionState:function(){return er[i.connectionState]},serializedContainer:void 0!==n.serializedContainerState},error:{dmInitialSeqNumber:function(){var e;return null===(e=i._deltaManager)||void 0===e?void 0:e.initialSequenceNumber},dmLastProcessedSeqNumber:function(){var e;return null===(e=i._deltaManager)||void 0===e?void 0:e.lastSequenceNumber},dmLastKnownSeqNumber:function(){var e;return null===(e=i._deltaManager)||void 0===e?void 0:e.lastKnownSeqNumber},containerLoadedFromVersionId:function(){var e;return null===(e=i.loadedFromVersion)||void 0===e?void 0:e.id},containerLoadedFromVersionDate:function(){var e;return null===(e=i.loadedFromVersion)||void 0===e?void 0:e.date},dmLastMsqSeqNumber:function(){var e,t;return null===(t=null===(e=i.deltaManager)||void 0===e?void 0:e.lastMessage)||void 0===t?void 0:t.sequenceNumber},dmLastMsqSeqTimestamp:function(){var e,t;return null===(t=null===(e=i.deltaManager)||void 0===e?void 0:e.lastMessage)||void 0===t?void 0:t.timestamp},dmLastMsqSeqClientId:function(){var e,t;return null===(t=null===(e=i.deltaManager)||void 0===e?void 0:e.lastMessage)||void 0===t?void 0:t.clientId},dmLastMsgClientSeq:function(){var e,t;return null===(t=null===(e=i.deltaManager)||void 0===e?void 0:e.lastMessage)||void 0===t?void 0:t.clientSequenceNumber},connectionStateDuration:function(){return Ae.S.now()-i.connectionTransitionTimes[i.connectionState]}}}),i.mc=(0,De.rZ)(Le.G2.create(i.subLogger,"Container")),i.options=Object.assign({},i.loader.services.options),i._deltaManager=i.createDeltaManager(),i.connectionStateHandler=nr({logger:i.mc.logger,connectionStateChanged:function(e,t,r,n){e===er.Connected&&(i._clientId=i.connectionStateHandler.pendingClientId),i.logConnectionStateChangeTelemetry(e,t,r,n),"loaded"===i._lifecycleState&&i.propagateConnectionState(!1,e===er.Disconnected?r:void 0)},shouldClientJoinWrite:function(){return i._deltaManager.connectionManager.shouldJoinWrite()},maxClientLeaveWaitTime:i.loader.services.options.maxClientLeaveWaitTime,logConnectionIssue:function(e,t,r){var n=i.connectionMode;i._deltaManager.logConnectionIssue(Object.assign({eventName:e,mode:n,category:"loading"===i._lifecycleState?"generic":t,duration:Ae.S.now()-i.connectionTransitionTimes[er.CatchingUp]},void 0===r?{}:{details:JSON.stringify(r)})),"read"===n&&(i.disconnect(),i.connect())}},i.deltaManager,null===(a=n.serializedContainerState)||void 0===a?void 0:a.clientId),i.on(Zr,(function(){i.connectionStateHandler.containerSaved()}));var h=null!==(s=i.mc.config.getBoolean("Fluid.Container.summarizeProtocolTree2"))&&void 0!==s?s:i.loader.services.options.summarizeProtocolTree;return i.storageAdapter=new qt(i.loader.services.detachedBlobStorage,i.mc.logger,null===(c=n.serializedContainerState)||void 0===c?void 0:c.snapshotBlobs,(function(e){return!0===(0,Xe.F2)(e)?e:(0,Xe.dM)(e,i.captureProtocolSummary())}),h),"object"===typeof document&&null!==document&&"function"===typeof document.addEventListener&&null!==document.addEventListener&&(i.lastVisible=document.hidden?Ae.S.now():void 0,i.visibilityEventHandler=function(){document.hidden?i.lastVisible=Ae.S.now():setTimeout((function(){i.lastVisible=void 0}),0)},document.addEventListener("visibilitychange",i.visibilityEventHandler)),i}return(0,c.Z)(r,[{key:"setLoaded",value:function(){"loading"===this._lifecycleState&&(this.propagateConnectionState(!0),this._lifecycleState="loaded")}},{key:"closed",get:function(){return"closing"===this._lifecycleState||"closed"===this._lifecycleState||"disposing"===this._lifecycleState||"disposed"===this._lifecycleState}},{key:"storage",get:function(){return this.storageAdapter}},{key:"context",get:function(){if(void 0===this._context)throw new Ve("Attempted to access context before it was defined");return this._context}},{key:"protocolHandler",get:function(){if(void 0===this._protocolHandler)throw new Error("Attempted to access protocolHandler before it was defined");return this._protocolHandler}},{key:"connectionMode",get:function(){return this._deltaManager.connectionManager.connectionMode}},{key:"IFluidRouter",get:function(){return this}},{key:"resolvedUrl",get:function(){return this._resolvedUrl}},{key:"loadedFromVersion",get:function(){return this._loadedFromVersion}},{key:"readOnlyInfo",get:function(){return this._deltaManager.readOnlyInfo}},{key:"closeSignal",get:function(){return this._deltaManager.closeAbortController.signal}},{key:"forceReadonly",value:function(e){this._deltaManager.connectionManager.forceReadonly(e)}},{key:"deltaManager",get:function(){return this._deltaManager}},{key:"connectionState",get:function(){return this.connectionStateHandler.connectionState}},{key:"connected",get:function(){return this.connectionStateHandler.connectionState===er.Connected}},{key:"serviceConfiguration",get:function(){return this._deltaManager.serviceConfiguration}},{key:"clientId",get:function(){return this._clientId}},{key:"scopes",get:function(){return this._deltaManager.connectionManager.scopes}},{key:"clientDetails",get:function(){return this._deltaManager.clientDetails}},{key:"offlineLoadEnabled",get:function(){var e,t;return(null!==(e=this.mc.config.getBoolean("Fluid.Container.enableOfflineLoad"))&&void 0!==e?e:!0===(null===(t=this.options)||void 0===t?void 0:t.enableOfflineLoad))&&this.clientDetails.capabilities.interactive}},{key:"getSpecifiedCodeDetails",value:function(){return this.getCodeDetailsFromQuorum()}},{key:"getLoadedCodeDetails",value:function(){var e;return null===(e=this._context)||void 0===e?void 0:e.codeDetails}},{key:"audience",get:function(){return this.protocolHandler.audience}},{key:"isDirty",get:function(){return this._dirtyContainer}},{key:"serviceFactory",get:function(){return this.loader.services.documentServiceFactory}},{key:"urlResolver",get:function(){return this.loader.services.urlResolver}},{key:"scope",get:function(){return this.loader.services.scope}},{key:"codeLoader",get:function(){return this.loader.services.codeLoader}},{key:"getEntryPoint",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(){var t,r,o=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("disposing"!==this._lifecycleState&&"disposed"!==this._lifecycleState){e.next=2;break}throw new We("The container is disposing or disposed");case 2:if(void 0!==this._context){e.next=8;break}return e.next=5,new Promise((function(e,t){var r=function(){e(),o.off("disposed",n)},n=function(e){t(null!==e&&void 0!==e?e:"The Container is disposed"),o.off("contextChanged",r)};o.once("contextChanged",r),o.once("disposed",n)}));case 5:(0,qe.h)(void 0!==this._context,1442),e.next=2;break;case 8:return e.next=10,null===(r=(t=this._context).getEntryPoint)||void 0===r?void 0:r.call(t);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getQuorum",value:function(){return this.protocolHandler.quorum}},{key:"dispose",value:function(e){this._deltaManager.close(e,!0),this.verifyClosed()}},{key:"close",value:function(e){this._deltaManager.close(e),this.verifyClosed()}},{key:"verifyClosed",value:function(){(0,qe.h)(this.connectionState===er.Disconnected,207),(0,qe.h)("closed"===this._lifecycleState||"disposed"===this._lifecycleState,788)}},{key:"closeCore",value:function(e){var t,r,n;(0,qe.h)(!this.closed,789);try{try{this.mc.logger.sendTelemetryEvent({eventName:"ContainerClose",category:"loading"!==this._lifecycleState&&void 0!==e?"error":"generic"},e),this._lifecycleState="closing",null===(t=this._protocolHandler)||void 0===t||t.close(),this.connectionStateHandler.dispose(),null===(r=this._context)||void 0===r||r.dispose(void 0!==e?new Error(e.message):void 0),this.storageAdapter.dispose(),null===(n=this.service)||void 0===n||n.dispose(e)}catch(o){this.mc.logger.sendErrorEvent({eventName:"ContainerCloseException"},o)}this.emit("closed",e),void 0!==this.visibilityEventHandler&&document.removeEventListener("visibilitychange",this.visibilityEventHandler)}finally{this._lifecycleState="closed"}}},{key:"disposeCore",value:function(e){var t,r,n;(0,qe.h)(!this._disposed,1356),this._disposed=!0;try{try{this.mc.logger.sendTelemetryEvent({eventName:"ContainerDispose",category:"generic"},e),"closed"!==this._lifecycleState&&(this._lifecycleState="disposing"),null===(t=this._protocolHandler)||void 0===t||t.close(),this.connectionStateHandler.dispose(),null===(r=this._context)||void 0===r||r.dispose(void 0!==e?new Error(e.message):void 0),this.storageAdapter.dispose(),null===(n=this.service)||void 0===n||n.dispose(e)}catch(o){this.mc.logger.sendErrorEvent({eventName:"ContainerDisposeException"},o)}this.emit("disposed",e),this.removeAllListeners(),void 0!==this.visibilityEventHandler&&document.removeEventListener("visibilitychange",this.visibilityEventHandler)}finally{this._lifecycleState="disposed"}}},{key:"closeAndGetPendingLocalState",value:function(){var e=this.getPendingLocalState();return this.close(),e}},{key:"getPendingLocalState",value:function(){if(!this.offlineLoadEnabled)throw new We("Can't get pending local state unless offline load is enabled");(0,qe.h)(this.attachState===K.Attached,209),(0,qe.h)(void 0!==this.resolvedUrl&&"fluid"===this.resolvedUrl.type,210),(0,qe.h)(!!this.baseSnapshot,1492),(0,qe.h)(!!this.baseSnapshotBlobs,1493);var e={pendingRuntimeState:this.context.getPendingLocalState(),baseSnapshot:this.baseSnapshot,snapshotBlobs:this.baseSnapshotBlobs,savedOps:this.savedOps,url:this.resolvedUrl.url,term:1,clientId:this.clientId};return this.mc.logger.sendTelemetryEvent({eventName:"GetPendingLocalState"}),JSON.stringify(e)}},{key:"attachState",get:function(){return this._attachState}},{key:"serialize",value:function(){(0,qe.h)(this.attachState===K.Detached,211);var e=this.context.createSummary(),t=this.captureProtocolSummary(),r=(0,Xe.dM)(e,t);return this.loader.services.detachedBlobStorage&&this.loader.services.detachedBlobStorage.size>0&&(r.tree[".hasAttachmentBlobs"]={type:at.J.Blob,content:"true"}),JSON.stringify(r)}},{key:"attach",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Le.Xr.timedExecAsync(this.mc.logger,{eventName:"Attach"},(0,i.Z)((0,n.Z)().mark((function e(){var o,a,s,c,u,l,d,f,h,p,v,g,m,y,b,k,S,C,w,x;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("loaded"===r._lifecycleState){e.next=2;break}throw new We("The Container is not in a valid state for attach [".concat(r._lifecycleState,"]"));case 2:return(0,qe.h)(r._attachState===K.Detached&&!r.attachStarted,517),r.attachStarted=!0,a=void 0!==r.loader.services.detachedBlobStorage&&r.loader.services.detachedBlobStorage.size>0,e.prev=5,(0,qe.h)(0===r.deltaManager.inbound.length,214),a||(c=r.context.createSummary(),u=r.captureProtocolSummary(),s=(0,Xe.dM)(c,u),r._attachState=K.Attaching,r.emit("attaching"),r.offlineLoadEnabled&&(l=fr(s),r.baseSnapshot=l,r.baseSnapshotBlobs=Kt(l))),e.next=10,r.urlResolver.resolve(t);case 10:if(d=e.sent,(0,Me.$)(d),void 0!==r.service){e.next=17;break}return(0,qe.h)(r.client.details.type!==Fr,708),e.next=16,nt((0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.serviceFactory.createContainer(s,d,r.subLogger,!1));case 1:case"end":return e.stop()}}),e)}))),"containerAttach",r.mc.logger,{cancel:r.closeSignal});case 16:r.service=e.sent;case 17:return f=r.service.resolvedUrl,(0,Me.$)(f),r._resolvedUrl=f,e.next=22,r.storageAdapter.connectToService(r.service);case 22:if(!a){e.next=59;break}(0,qe.h)(!!r.loader.services.detachedBlobStorage,590),h=new Map;case 25:if(!(h.size<r.loader.services.detachedBlobStorage.size)){e.next=51;break}p=r.loader.services.detachedBlobStorage.getBlobIds().filter((function(e){return!h.has(e)})),v=(0,He.Z)(p),e.prev=28,v.s();case 30:if((g=v.n()).done){e.next=41;break}return m=g.value,e.next=34,r.loader.services.detachedBlobStorage.readBlob(m);case 34:return y=e.sent,e.next=37,r.storageAdapter.createBlob(y);case 37:b=e.sent,h.set(m,b.id);case 39:e.next=30;break;case 41:e.next=46;break;case 43:e.prev=43,e.t0=e.catch(28),v.e(e.t0);case 46:return e.prev=46,v.f(),e.finish(46);case 49:e.next=25;break;case 51:return k=r.context.createSummary(h),S=r.captureProtocolSummary(),s=(0,Xe.dM)(k,S),r._attachState=K.Attaching,r.emit("attaching"),r.offlineLoadEnabled&&(C=fr(s),r.baseSnapshot=C,r.baseSnapshotBlobs=Kt(C)),e.next=59,r.storageAdapter.uploadSummaryWithContext(s,{referenceSequenceNumber:0,ackHandle:void 0,proposalHandle:void 0});case 59:r._attachState=K.Attached,r.emit("attached"),r.closed||r.resumeInternal({fetchOpsFromStorage:!1,reason:"createDetached"}),e.next=72;break;case 64:throw e.prev=64,e.t1=e.catch(5),w=(0,Ye.SC)(e.t1),x=r.resolvedUrl,(0,Me.P)(x)&&w.addTelemetryProperties({resolvedUrl:x.url}),r.close(w),null===(o=r.dispose)||void 0===o||o.call(r,w),w;case 72:case"end":return e.stop()}}),e,null,[[5,64],[28,43,46,49]])}))),{start:!0,end:!0,cancel:"generic"});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"request",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Le.Xr.timedExecAsync(this.mc.logger,{eventName:"Request"},(0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.context.request(t));case 1:case"end":return e.stop()}}),e)}))),{end:!0,cancel:"error"}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setAutoReconnectInternal",value:function(e){if(this._deltaManager.connectionManager.reconnectMode!==e){var t=Ae.S.now(),r=t-this.setAutoReconnectTime;this.setAutoReconnectTime=t,this.mc.logger.sendTelemetryEvent({eventName:e===ut.Enabled?"AutoReconnectEnabled":"AutoReconnectDisabled",connectionMode:this.connectionMode,connectionState:er[this.connectionState],duration:r}),this._deltaManager.connectionManager.setAutoReconnect(e)}}},{key:"connect",value:function(){if(this.closed)throw new We("The Container is closed and cannot be connected");if(this._attachState!==K.Attached)throw new We("The Container is not attached and cannot be connected");this.connected||this.connectInternal({reason:"DocumentConnect",fetchOpsFromStorage:!1})}},{key:"connectInternal",value:function(e){(0,qe.h)(!this.closed,709),(0,qe.h)(this._attachState===K.Attached,710),this.resumeInternal(e);var t=ut.Enabled;this.setAutoReconnectInternal(t)}},{key:"disconnect",value:function(){if(this.closed)throw new We("The Container is closed and cannot be disconnected");this.disconnectInternal()}},{key:"disconnectInternal",value:function(){(0,qe.h)(!this.closed,711);var e=ut.Disabled;this.setAutoReconnectInternal(e)}},{key:"resumeInternal",value:function(e){(0,qe.h)(!this.closed,217),this.inboundQueuePausedFromInit&&(this.inboundQueuePausedFromInit=!1,this._deltaManager.inbound.resume(),this._deltaManager.inboundSignal.resume()),this.connectToDeltaStream(e)}},{key:"getAbsoluteUrl",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.resolvedUrl){e.next=2;break}return e.abrupt("return",void 0);case 2:return e.abrupt("return",this.urlResolver.getAbsoluteUrl(this.resolvedUrl,t,{name:(n=null===(r=this._context)||void 0===r?void 0:r.codeDetails)&&"name"in n?n:x(null===n||void 0===n?void 0:n.package)?null===n||void 0===n?void 0:n.package.name:null===n||void 0===n?void 0:n.package}));case 3:case"end":return e.stop()}var n}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"proposeCodeDetails",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(P(t)){e.next=2;break}throw new Error("Provided codeDetails are not IFluidCodeDetails");case 2:if(!this.codeLoader.IFluidCodeDetailsComparer){e.next=8;break}return e.next=5,this.codeLoader.IFluidCodeDetailsComparer.compare(t,this.getCodeDetailsFromQuorum());case 5:if(!(void 0!==(r=e.sent)&&r<=0)){e.next=8;break}throw new Error("Proposed code details should be greater than the current");case 8:return e.abrupt("return",this.protocolHandler.quorum.propose("code",t).then((function(){return!0})).catch((function(){return!1})));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"processCodeProposal",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(){var t,r,o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.getCodeDetailsFromQuorum(),e.next=3,Promise.all([this.deltaManager.inbound.pause(),this.deltaManager.inboundSignal.pause()]);case 3:return e.next=5,this.context.satisfies(r);case 5:if(e.t0=e.sent,!0!==e.t0){e.next=10;break}return this.deltaManager.inbound.resume(),this.deltaManager.inboundSignal.resume(),e.abrupt("return");case 10:o=new Ve("Existing context does not satisfy incoming proposal"),this.close(o),null===(t=this.dispose)||void 0===t||t.call(this,o);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getVersion",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.storageAdapter.getVersions(t,1);case 2:return r=e.sent,e.abrupt("return",r[0]);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"recordConnectStartTime",value:function(){void 0===this.connectionTransitionTimes[er.Disconnected]&&(this.connectionTransitionTimes[er.Disconnected]=Ae.S.now())}},{key:"connectToDeltaStream",value:function(e){this.recordConnectStartTime(),this._canReconnect&&this.client.details.capabilities.interactive||(e.mode="write"),this._deltaManager.connect(e)}},{key:"load",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r,o){var a,s,c,u,l,d,f,h,p,v,g,m,y,b=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this._resolvedUrl){e.next=2;break}throw new Error("Attempting to load without a resolved url");case 2:return e.next=4,this.serviceFactory.createDocumentService(this._resolvedUrl,this.subLogger,this.client.details.type===Fr);case 4:if(this.service=e.sent,s={reason:"DocumentOpen",mode:"write",fetchOpsFromStorage:!1},void 0!==r.deltaConnection||o||this.connectToDeltaStream(s),o){e.next=12;break}return e.next=10,this.storageAdapter.connectToService(this.service);case 10:e.next=13;break;case 12:this.storageAdapter.connectToService(this.service).catch((function(e){var t;b.close(e),null===(t=b.dispose)||void 0===t||t.call(b,e)}));case 13:if(this._attachState=K.Attached,void 0!==o){e.next=20;break}return e.next=17,this.fetchSnapshotTree(t);case 17:e.t0=e.sent,e.next=21;break;case 20:e.t0={snapshot:o.baseSnapshot,versionId:void 0};case 21:if(c=e.t0,u=c.snapshot,l=c.versionId,!o){e.next=29;break}this.baseSnapshot=o.baseSnapshot,this.baseSnapshotBlobs=o.snapshotBlobs,e.next=35;break;case 29:if((0,qe.h)(void 0!==u,567),!this.offlineLoadEnabled){e.next=35;break}return this.baseSnapshot=u,e.next=34,Vt(u,this.storage);case 34:this.baseSnapshotBlobs=e.sent;case 35:return e.next=37,this.getDocumentAttributes(this.storageAdapter,u);case 37:d=e.sent,f=null===(a=null===o||void 0===o?void 0:o.savedOps[o.savedOps.length-1])||void 0===a?void 0:a.sequenceNumber,h=void 0!==f?Object.assign(Object.assign({},d),{sequenceNumber:f}):d,e.t1=r.opsBeforeReturn,e.next=void 0===e.t1?43:"cached"===e.t1?45:"all"===e.t1?47:49;break;case 43:return this.attachDeltaManagerOpHandler(h,"none"!==r.deltaConnection?"all":"none"),e.abrupt("break",50);case 45:return p=this.attachDeltaManagerOpHandler(h,"cached"),e.abrupt("break",50);case 47:return p=this.attachDeltaManagerOpHandler(h,"all"),e.abrupt("break",50);case 49:(0,ze.U)(r.opsBeforeReturn);case 50:return e.next=52,this.initializeProtocolStateFromSnapshot(d,this.storageAdapter,u);case 52:return v=this.getCodeDetailsFromQuorum(),e.next=55,this.instantiateContext(!0,v,u,null===o||void 0===o?void 0:o.pendingRuntimeState);case 55:if(!o){e.next=77;break}g=(0,He.Z)(o.savedOps),e.prev=57,g.s();case 59:if((m=g.n()).done){e.next=66;break}return y=m.value,this.processRemoteMessage(y),e.next=64,this.context.notifyOpReplay(y);case 64:e.next=59;break;case 66:e.next=71;break;case 68:e.prev=68,e.t2=e.catch(57),g.e(e.t2);case 71:return e.prev=71,g.f(),e.finish(71);case 74:o.savedOps=[],(0,qe.h)(void 0===this.clientId,1494),this._clientId=null===o||void 0===o?void 0:o.clientId;case 77:if(this.closed){e.next=96;break}if(void 0===p){e.next=85;break}return this._deltaManager.inbound.resume(),e.next=82,Le.Xr.timedExecAsync(this.mc.logger,{eventName:"WaitOps"},(0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",p);case 1:case"end":return e.stop()}}),e)}))));case 82:return e.next=84,Le.Xr.timedExecAsync(this.mc.logger,{eventName:"WaitOpProcessing"},(0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",b._deltaManager.inbound.waitTillProcessingDone());case 1:case"end":return e.stop()}}),e)}))));case 84:this._deltaManager.inbound.pause();case 85:e.t3=r.deltaConnection,e.next=void 0===e.t3?88:"delayed"===e.t3?89:"none"===e.t3?94:95;break;case 88:o&&this.connectToDeltaStream(s);case 89:return(0,qe.h)(this.inboundQueuePausedFromInit,838),this.inboundQueuePausedFromInit=!1,this._deltaManager.inbound.resume(),this._deltaManager.inboundSignal.resume(),e.abrupt("break",96);case 94:return e.abrupt("break",96);case 95:(0,ze.U)(r.deltaConnection);case 96:if(!this.closed){e.next=98;break}throw new Error("Container was closed while load()");case 98:return this.setLoaded(),e.abrupt("return",{sequenceNumber:d.sequenceNumber,version:l,dmLastProcessedSeqNumber:this._deltaManager.lastSequenceNumber,dmLastKnownSeqNumber:this._deltaManager.lastKnownSeqNumber});case 100:case"end":return e.stop()}}),e,this,[[57,68,71,74]])})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"createDetached",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={sequenceNumber:0,term:1,minimumSequenceNumber:0},e.next=3,this.attachDeltaManagerOpHandler(r);case 3:return o=mr(t),this.initializeProtocolState(r,{members:[],proposals:[],values:o}),e.next=7,this.instantiateContextDetached(!1);case 7:this.setLoaded();case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"rehydrateDetachedFromSnapshot",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,o,i,a,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0!==t.tree[".hasAttachmentBlobs"]&&((0,qe.h)(!!this.loader.services.detachedBlobStorage&&this.loader.services.detachedBlobStorage.size>0,592),delete t.tree[".hasAttachmentBlobs"]),r=fr(t),this.storageAdapter.loadSnapshotForRehydratingContainer(r),e.next=5,this.getDocumentAttributes(this.storageAdapter,r);case 5:return o=e.sent,e.next=8,this.attachDeltaManagerOpHandler(o);case 8:return i=hr(r),e.next=11,(0,it.g)(this.storageAdapter,i.blobs.quorumValues);case 11:return a=e.sent,s=gr(a),this.initializeProtocolState(o,{members:[],proposals:[],values:void 0!==s?mr(s):[]}),e.next=16,this.instantiateContextDetached(!0,r);case 16:this.setLoaded();case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getDocumentAttributes",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){var o,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==r){e.next=2;break}return e.abrupt("return",{minimumSequenceNumber:0,sequenceNumber:0,term:1});case 2:return o=".protocol"in r.trees?r.trees[".protocol"].blobs.attributes:r.blobs[".attributes"],e.next=5,(0,it.g)(t,o);case 5:return i=e.sent,e.abrupt("return",i);case 7:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"initializeProtocolStateFromSnapshot",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r,i){var a,s,c,u;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={members:[],proposals:[],values:[]},void 0===i){e.next=10;break}return s=hr(i),e.next=5,Promise.all([(0,it.g)(r,s.blobs.quorumMembers),(0,it.g)(r,s.blobs.quorumProposals),(0,it.g)(r,s.blobs.quorumValues)]);case 5:c=e.sent,u=(0,o.Z)(c,3),a.members=u[0],a.proposals=u[1],a.values=u[2];case 10:this.initializeProtocolState(t,a);case 11:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"initializeProtocolState",value:function(e,t){var r,n=this,o=null!==(r=this.protocolHandlerBuilder)&&void 0!==r?r:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,Re.Z)(It,t.concat([new pt]))},i=o(e,t,(function(e,t){return n.submitMessage(st.Cs.Propose,JSON.stringify({key:e,value:t}))})),a=Le.G2.create(this.subLogger,"ProtocolHandler");i.quorum.on("error",(function(e){a.sendErrorEvent(e)})),this.connectionStateHandler.initProtocol(i),i.quorum.on("addProposal",(function(e){"code"!==e.key&&"code2"!==e.key||n.emit("codeDetailsProposed",e.value,e)})),i.quorum.on("approveProposal",(function(e,t,r){"code"!==t&&"code2"!==t||(P(r)||n.mc.logger.sendErrorEvent({eventName:"CodeProposalNotIFluidCodeDetails"}),n.processCodeProposal().catch((function(e){var t,r=(0,Ye.SC)(e);throw n.close(r),null===(t=n.dispose)||void 0===t||t.call(n,r),e})))})),this._protocolHandler=i}},{key:"captureProtocolSummary",value:function(){var e=this.protocolHandler.snapshot();return{tree:{attributes:{content:JSON.stringify(this.protocolHandler.attributes),type:at.J.Blob},quorumMembers:{content:JSON.stringify(e.members),type:at.J.Blob},quorumProposals:{content:JSON.stringify(e.proposals),type:at.J.Blob},quorumValues:{content:JSON.stringify(e.values),type:at.J.Blob}},type:at.J.Tree}}},{key:"getCodeDetailsFromQuorum",value:function(){var e=function(e){var t;return null!==(t=e.get("code"))&&void 0!==t?t:e.get("code2")}(this.protocolHandler.quorum);return e}},{key:"client",get:function(){var e,t=void 0!==(null===(e=this.options)||void 0===e?void 0:e.client)?this.options.client:{details:{capabilities:{interactive:!0}},mode:"read",permission:[],scopes:[],user:{id:""}};return void 0!==this.clientDetailsOverride&&Ue()(t.details,this.clientDetailsOverride),t.details.environment=[t.details.environment," loaderVersion:".concat(Mt)].join(";"),t}},{key:"activeConnection",value:function(){return this.connectionState===er.Connected&&"write"===this.connectionMode}},{key:"createDeltaManager",value:function(){var e=this,t=function(){return e.service},r=new Dt(t,Le.G2.create(this.subLogger,"DeltaManager"),(function(){return e.activeConnection()}),(function(r){return new Er(t,(function(){return e.isDirty}),e.client,e._canReconnect,Le.G2.create(e.subLogger,"ConnectionManager"),r)}));return r.inbound.pause(),r.inboundSignal.pause(),r.on("connect",(function(t,r){(0,qe.h)(e.connectionMode===t.mode,1207),e.connectionStateHandler.receivedConnectEvent(t)})),r.on("disconnect",(function(t,r){var n;null===(n=e.collabWindowTracker)||void 0===n||n.stopSequenceNumberUpdate(),e.closed||e.connectionStateHandler.receivedDisconnectEvent(t,r)})),r.on("throttled",(function(t){var r=t;!0!==r.logged&&e.mc.logger.sendTelemetryEvent({eventName:"ContainerWarning"},r),e.emit("warning",r)})),r.on("readonly",(function(t){e.setContextConnectedState(e.connectionState===er.Connected,t),e.emit("readonly",t)})),r.on("closed",(function(t){e.closeCore(t)})),r.on("disposed",(function(t){e.disposeCore(t)})),r}},{key:"attachDeltaManagerOpHandler",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){var o=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._deltaManager.attachOpHandler(t.minimumSequenceNumber,t.sequenceNumber,{process:function(e){return o.processRemoteMessage(e)},processSignal:function(e){o.processSignal(e)}},r));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"logConnectionStateChangeTelemetry",value:function(e,t,r,n){var o,i=Ae.S.now();this.connectionTransitionTimes[e]=i;var a,s,c,u,l,d=i-this.connectionTransitionTimes[t];e===er.Disconnected?c=this._deltaManager.connectionManager.reconnectMode:(e===er.Connected?(a=i-this.connectionTransitionTimes[er.Disconnected],a=Le.hy.formatTick(a)):(u=this.deltaManager.lastKnownSeqNumber,this.deltaManager.hasCheckpointSequenceNumber&&(l=u-this.deltaManager.lastSequenceNumber)),s=this.firstConnection?"InitialConnect":"AutoReconnect"),this.mc.logger.sendPerformanceEvent(Object.assign({eventName:"ConnectionStateChange_".concat(er[e]),from:er[t],duration:d,durationFromDisconnected:a,reason:r,connectionInitiationReason:s,pendingClientId:this.connectionStateHandler.pendingClientId,clientId:this.clientId,autoReconnect:c,opsBehind:l,online:tt.Yz[(0,tt.Gg)()],lastVisible:void 0!==this.lastVisible?Ae.S.now()-this.lastVisible:void 0,checkpointSequenceNumber:u,quorumSize:null===(o=this._protocolHandler)||void 0===o?void 0:o.quorum.getMembers().size},this._deltaManager.connectionProps),n),e===er.Connected&&(this.firstConnection=!1)}},{key:"propagateConnectionState",value:function(e,t){var r;if(e||this.connectionState===er.Connected||this.connectionState===er.Disconnected){var n=this.connectionState===er.Connected,o=this.connectionState===er.Connected&&!this.firstConnection&&"write"===this.connectionMode;o&&(this.messageCountAfterDisconnection=0),this.setContextConnectedState(n,null!==(r=this.readOnlyInfo.readonly)&&void 0!==r&&r),this.protocolHandler.setConnectionState(n,this.clientId),function(e,t,r,n,o){try{r?t.emit(ct,n):t.emit("disconnected",o)}catch(Ht){e.sendErrorEvent({eventName:"RaiseConnectedEventError"},Ht)}}(this.mc.logger,this,n,this.clientId,t),o&&this.mc.logger.sendTelemetryEvent({eventName:"OpsSentOnReconnect",count:this.messageCountAfterDisconnection})}}},{key:"submitContainerMessage",value:function(e,t,r,n){var o;switch(e){case st.Cs.Operation:return this.submitMessage(e,JSON.stringify(t),r,n);case st.Cs.Summarize:return this.submitSummaryMessage(t);default:var i=new Ve("invalidContainerSubmitOpType",void 0,{messageType:e});return this.close(i),null===(o=this.dispose)||void 0===o||o.call(this,i),-1}}},{key:"submitBatch",value:function(e,t){var r,n=-1,o=(0,He.Z)(e);try{for(o.s();!(r=o.n()).done;){var i=r.value;n=this.submitMessage(st.Cs.Operation,i.contents,!0,i.metadata,i.compression,t)}}catch(a){o.e(a)}finally{o.f()}return this._deltaManager.flush(),n}},{key:"submitSummaryMessage",value:function(e,t){return void 0===e.details&&(e.details={}),e.details.includesProtocolTree=this.storageAdapter.summarizeProtocolTree,this.submitMessage(st.Cs.Summarize,JSON.stringify(e),!1,void 0,void 0,t)}},{key:"submitMessage",value:function(e,t,r,n,o,i){var a;return this.connectionState!==er.Connected?(this.mc.logger.sendErrorEvent({eventName:"SubmitMessageWithNoConnection",type:e}),-1):(this.messageCountAfterDisconnection+=1,null===(a=this.collabWindowTracker)||void 0===a||a.stopSequenceNumberUpdate(),this._deltaManager.submit(e,t,r,n,o,i))}},{key:"processRemoteMessage",value:function(e){var t=this;this.offlineLoadEnabled&&this.savedOps.push(e);var r=this.clientId===e.clientId,n=this.protocolHandler.processMessage(e,r);this.context.process(e,r),this.activeConnection()&&(void 0===this.collabWindowTracker&&((0,qe.h)(void 0!==this.serviceConfiguration,740),this.collabWindowTracker=new yr((function(e){(0,qe.h)(t.activeConnection(),577),t.submitMessage(e)}),this.serviceConfiguration.noopTimeFrequency,this.serviceConfiguration.noopCountFrequency)),this.collabWindowTracker.scheduleSequenceNumberUpdate(e,!0===n.immediateNoOp)),this.emit("op",e)}},{key:"submitSignal",value:function(e){this._deltaManager.submitSignal(JSON.stringify(e))}},{key:"processSignal",value:function(e){if(null===e.clientId)this.protocolHandler.processSignal(e);else{var t=this.clientId===e.clientId;this.context.processSignal(e,t)}}},{key:"fetchSnapshotTree",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,o,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getVersion(null!==t&&void 0!==t?t:null);case 2:return void 0===(o=e.sent)&&void 0!==t&&this.mc.logger.sendErrorEvent({eventName:"NoVersionFoundWhenSpecified",id:t}),this._loadedFromVersion=o,e.next=7,this.storageAdapter.getSnapshotTree(o);case 7:if(e.t1=r=e.sent,e.t0=null!==e.t1,!e.t0){e.next=11;break}e.t0=void 0!==r;case 11:if(!e.t0){e.next=15;break}e.t2=r,e.next=16;break;case 15:e.t2=void 0;case 16:return void 0===(i=e.t2)&&void 0!==o&&this.mc.logger.sendErrorEvent({eventName:"getSnapshotTreeFailed",id:o.id}),e.abrupt("return",{snapshot:i,versionId:null===o||void 0===o?void 0:o.id});case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"instantiateContextDetached",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){var o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(o=this.getCodeDetailsFromQuorum())){e.next=3;break}throw new Error("pkg should be provided in create flow!!");case 3:return e.next=5,this.instantiateContext(t,o,r);case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"instantiateContext",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,o,i,a){var s,c,u=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,qe.h)(!1!==(null===(s=this._context)||void 0===s?void 0:s.disposed),221),c=new Dr(this,this.loader),e.next=4,mt.createOrLoad(this,this.scope,this.codeLoader,o,i,new _t(this._deltaManager),new vr(this.protocolHandler.quorum),c,(function(e,t,r,n){return u.submitContainerMessage(e,t,r,n)}),(function(e,t){return u.submitSummaryMessage(e,t)}),(function(e,t){return u.submitBatch(e,t)}),(function(e){return u.submitSignal(e)}),(function(e){var t;return null===(t=u.dispose)||void 0===t?void 0:t.call(u,e)}),(function(e){return u.close(e)}),r.version,(function(e){return u.updateDirtyContainerState(e)}),t,a);case 4:this._context=e.sent,this.emit("contextChanged",o);case 6:case"end":return e.stop()}}),e,this)})));return function(t,r,n,o){return e.apply(this,arguments)}}()},{key:"updateDirtyContainerState",value:function(e){this._dirtyContainer!==e&&(this._dirtyContainer=e,this.emit(e?"dirty":Zr))}},{key:"setContextConnectedState",value:function(e,t){var r;!1===(null===(r=this._context)||void 0===r?void 0:r.disposed)&&this.context.setConnectionState(e&&!t,this.clientId)}}],[{key:"load",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,o,a,s){var c;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=new r(t,{clientDetailsOverride:o.clientDetailsOverride,resolvedUrl:o.resolvedUrl,canReconnect:o.canReconnect,serializedContainerState:a},s),e.abrupt("return",Le.Xr.timedExecAsync(c.mc.logger,{eventName:"Load"},function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var n,i,s=o.version,u={opsBeforeReturn:"cached"},l=a?Object.assign(Object.assign({},null!==(n=o.loadMode)&&void 0!==n?n:u),{opsBeforeReturn:void 0}):null!==(i=o.loadMode)&&void 0!==i?i:u,d=function(e){r(null!==e&&void 0!==e?e:new Ve("Container closed without error during load"))};c.on("closed",d),c.load(s,l,a).finally((function(){c.removeListener("closed",d)})).then((function(r){t.end(Object.assign(Object.assign({},r),o.loadMode)),e(c)}),(function(e){var t=(0,Ye.SC)(e);c.close(t),d(t)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{start:!0,end:!0,cancel:"generic"}));case 2:case"end":return e.stop()}}),e)})));return function(t,r,n,o){return e.apply(this,arguments)}}()},{key:"createDetached",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,o,a){var s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=new r(t,{},a),e.abrupt("return",Le.Xr.timedExecAsync(s.mc.logger,{eventName:"CreateDetached"},function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.createDetached(o);case 2:return e.abrupt("return",s);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{start:!0,end:!0,cancel:"generic"}));case 2:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"rehydrateDetachedFromSnapshot",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,o,a){var s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=new r(t,{},a),e.abrupt("return",Le.Xr.timedExecAsync(s.mc.logger,{eventName:"RehydrateDetachedFromSnapshot"},function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=JSON.parse(o),e.next=3,s.rehydrateDetachedFromSnapshot(r);case 3:return e.abrupt("return",s);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{start:!0,end:!0,cancel:"generic"}));case 2:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()}]),r}(lt.M);function Br(e){return void 0===e.headers||!1!==e.headers[Fe.cache]}Ir.version="^0.1.0";var Dr=function(){function e(t,r){(0,u.Z)(this,e),this.container=t,this.loader=r}return(0,c.Z)(e,[{key:"IFluidRouter",get:function(){return this}},{key:"resolve",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,o,i,a,s,c,u;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.url.startsWith("/")){e.next=11;break}if(!Br(t)){e.next=5;break}return e.abrupt("return",this.container);case 5:return c=this.container.resolvedUrl,(0,Me.$)(c),e.next=9,Ir.load(this.loader,{canReconnect:null===(r=t.headers)||void 0===r?void 0:r[Fe.reconnect],clientDetailsOverride:null===(o=t.headers)||void 0===o?void 0:o[Fe.clientDetails],resolvedUrl:Object.assign({},c),version:null!==(a=null===(i=t.headers)||void 0===i?void 0:i[Fe.version])&&void 0!==a?a:void 0,loadMode:null===(s=t.headers)||void 0===s?void 0:s[Fe.loadMode]});case 9:return u=e.sent,e.abrupt("return",u);case 11:if(void 0!==this.loader){e.next=13;break}throw new Error("Cannot resolve external containers");case 13:return e.abrupt("return",this.loader.resolve(t));case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"request",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.url.startsWith("/")){e.next=5;break}return e.next=3,this.resolve(t);case 3:return r=e.sent,e.abrupt("return",r.request(t));case 5:if(void 0!==this.loader){e.next=7;break}return e.abrupt("return",{status:404,value:"Cannot request external containers",mimeType:"plain/text"});case 7:return e.abrupt("return",this.loader.request(t));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();var Ar=function(){function e(t){var r,n;(0,u.Z)(this,e),this.containers=new Map;var o=Object.assign({},t.scope);!1!==(null===(r=t.options)||void 0===r?void 0:r.provideScopeLoader)&&(o.ILoader=this);var i={loaderId:(0,Ie.Z)(),loaderVersion:Mt},a=(0,De.UK)(_e.mixinDebugLogger("fluid:telemetry",t.logger,{all:i}),De.of.value,t.configProvider);this.services={urlResolver:t.urlResolver,documentServiceFactory:t.documentServiceFactory,codeLoader:t.codeLoader,options:null!==(n=t.options)&&void 0!==n?n:{},scope:o,subLogger:a.logger,detachedBlobStorage:t.detachedBlobStorage},this.mc=(0,De.rZ)(Le.G2.create(this.services.subLogger,"Loader")),this.protocolHandlerBuilder=t.protocolHandlerBuilder}return(0,c.Z)(e,[{key:"IFluidRouter",get:function(){return this}},{key:"createDetachedContainer",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,o=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ir.createDetached(this,t,this.protocolHandlerBuilder);case 2:return r=e.sent,this.cachingEnabled&&r.once("attached",(function(){(0,Me.$)(r.resolvedUrl);var e=ur(r.resolvedUrl.url);void 0!==e&&o.addToContainerCache(e.id,Promise.resolve(r))})),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"rehydrateDetachedContainerFromSnapshot",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ir.rehydrateDetachedFromSnapshot(this,t,this.protocolHandlerBuilder));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"resolve",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){var o,a=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=void 0===r?"Resolve":"ResolveWithPendingState",e.abrupt("return",Le.Xr.timedExecAsync(this.mc.logger,{eventName:o},(0,i.Z)((0,n.Z)().mark((function e(){var o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.resolveCore(t,void 0!==r?JSON.parse(r):void 0);case 2:return o=e.sent,e.abrupt("return",o.container);case 4:case"end":return e.stop()}}),e)})))));case 2:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"request",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Le.Xr.timedExecAsync(this.mc.logger,{eventName:"Request"},(0,i.Z)((0,n.Z)().mark((function e(){var o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.resolveCore(t);case 2:return o=e.sent,e.abrupt("return",o.container.request(Object.assign(Object.assign({},t),{url:"".concat(o.parsed.path).concat(o.parsed.query)})));case 4:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getKeyForContainerCache",value:function(e,t){var r;return void 0!==(null===(r=e.headers)||void 0===r?void 0:r[Fe.version])?"".concat(t.id,"@").concat(e.headers[Fe.version]):t.id}},{key:"addToContainerCache",value:function(e,t){var r=this;this.containers.set(e,t),t.then((function(t){t.closed?r.containers.delete(e):t.once("closed",(function(){r.containers.delete(e)}))})).catch((function(e){}))}},{key:"resolveCore",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){var o,i,a,s,c,u,l,d,f,h,p;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.urlResolver.resolve(t);case 2:if(o=e.sent,(0,Me.$)(o),void 0!==(i=ur(o.url))){e.next=7;break}throw new Error("Invalid URL ".concat(o.url));case 7:if(void 0===r){e.next=12;break}if((null===(a=ur(r.url))||void 0===a?void 0:a.id)===i.id&&(null===a||void 0===a?void 0:a.path.replace(/\/$/,""))===i.path.replace(/\/$/,"")){e.next=12;break}throw s="URL ".concat(o.url," does not match pending state URL ").concat(r.url),new Error(s);case 12:if(c=this.parseHeader(i,t),u=c.canCache,l=c.fromSequenceNumber,!(void 0===r&&u)){e.next=30;break}return f=this.getKeyForContainerCache(t,i),e.next=18,this.containers.get(f);case 18:if(void 0===(h=e.sent)){e.next=23;break}d=h,e.next=28;break;case 23:return p=this.loadContainer(t,o),this.addToContainerCache(f,p),e.next=27,p;case 27:d=e.sent;case 28:e.next=33;break;case 30:return e.next=32,this.loadContainer(t,o,r);case 32:d=e.sent;case 33:if(!(d.deltaManager.lastSequenceNumber<=l)){e.next=36;break}return e.next=36,new Promise((function(e,t){d.on("op",(function t(r){r.sequenceNumber>l&&(e(),d.removeListener("op",t))}))}));case 36:return e.abrupt("return",{container:d,parsed:i});case 37:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"cachingEnabled",get:function(){return!1!==this.services.options.cache}},{key:"canCacheForRequest",value:function(e){return this.cachingEnabled&&!1!==e[Fe.cache]}},{key:"parseHeader",value:function(e,t){var r,n,o=-1;t.headers=null!==(r=t.headers)&&void 0!==r?r:{};var i=t.headers[Fe.sequenceNumber];return void 0!==i&&(o=i),t.headers[Fe.version]=null!==(n=e.version)&&void 0!==n?n:t.headers[Fe.version],{canCache:this.canCacheForRequest(t.headers),fromSequenceNumber:o}}},{key:"loadContainer",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r,o){var i,a,s,c,u;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ir.load(this,{canReconnect:null===(i=t.headers)||void 0===i?void 0:i[Fe.reconnect],clientDetailsOverride:null===(a=t.headers)||void 0===a?void 0:a[Fe.clientDetails],resolvedUrl:r,version:null!==(c=null===(s=t.headers)||void 0===s?void 0:s[Fe.version])&&void 0!==c?c:void 0,loadMode:null===(u=t.headers)||void 0===u?void 0:u[Fe.loadMode]},o,this.protocolHandlerBuilder));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()}]),e}();function Or(e){var t=Lr(null===e||void 0===e?void 0:e.audience);return t||(null!==e&&void 0!==e&&e.ring?e.ring:"Prod")}function Lr(e){switch(e){case"Development":return"Development";case"Staging":return"Staging";case"Dogfood":return"Dogfood";case"Preview":case"Microsoft":case"Production":return"Prod";case"GCC":return"Gcc";case"GCC-High":return"GccHigh";case"DoD":return"DoD";case"USNat":return"USNat";case"USSec":return"USSec";default:return}}function _r(e,t){var r;return e?Or(e):null!==(r=Lr(t))&&void 0!==r?r:"Prod"}var Mr=r(81803),Rr=r(96418);function Hr(e){return e?Object.keys(e).sort().join(","):""}var jr=function(){function e(){var t=this;(0,u.Z)(this,e),this.providers=new Map,this.memo=new Map,this.resolveLocalProvider=function(e){var r=t.providers.get(e);if(r)return"function"===typeof r?{get:function(){if("function"===typeof r)return Promise.resolve(t.IFluidDependencySynthesizer).then(function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(t){return null===t||void 0===t?void 0:t[e]}))}}:{get:function(){return new gt.d((0,i.Z)((0,n.Z)().mark((function t(){return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.resolve(r).then((function(t){if(t)return t[e]})));case 1:case"end":return t.stop()}}),t)}))))}}};for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];this.parents=o.filter((function(e){return void 0!==e}))}return(0,c.Z)(e,[{key:"IFluidDependencySynthesizer",get:function(){return this}},{key:"register",value:function(e,t){if(this.providers.has(e))throw new Error("Attempting to register a provider of type ".concat(String(e)," that already exists"));this.providers.set(e,t)}},{key:"unregister",value:function(e){this.providers.has(e)&&(this.providers.delete(e),this.clearMemo())}},{key:"clearMemo",value:function(){this.memo.clear()}},{key:"synthesize",value:function(e,t){var r=this,n="required:".concat(Hr(t),",optional:").concat(Hr(e));if(this.memo.has(n))return this.memo.get(n);var o={};return this.generateRequired(o,t),this.generateOptional(o,e),Object.defineProperty(o,Rr.i,{get:function(){return r}}),this.memo.set(n,o),o}},{key:"has",value:function(e,t){return!!this.providers.has(e)||!0!==t&&this.parents.some((function(t){return t.has(e)}))}},{key:"generateRequired",value:function(e,t){if(void 0!==t){var r=this.generate(e,t);if(0!==r.size){var n=Array.from(r).join(", ");throw new Error("Object attempted to be created without registered required providers ".concat(n))}}}},{key:"generateOptional",value:function(e,t){if(void 0!==t){var r,o=this.generate(e,t),a=(0,He.Z)(o);try{for(a.s();!(r=a.n()).done;){var s=r.value,c={get:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",void 0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()};Object.defineProperty(e,s,c)}}catch(u){a.e(u)}finally{a.f()}}}},{key:"generate",value:function(e,t){var r,n=new Set(Object.keys(t)),o=(0,He.Z)(n);try{for(o.s();!(r=o.n()).done;){var i=r.value,a=this.resolveLocalProvider(i);a&&(n.delete(i),Object.defineProperty(e,i,a))}}catch(b){o.e(b)}finally{o.f()}var s,c=(0,He.Z)(this.parents);try{for(c.s();!(s=c.n()).done;){var u,l=s.value,d={},f=(0,He.Z)(n);try{for(f.s();!(u=f.n()).done;){var h=u.value;d[h]=h}}catch(b){f.e(b)}finally{f.f()}var p,v=l.synthesize(d,void 0),g=(0,He.Z)(n);try{for(g.s();!(p=g.n()).done;){var m=p.value,y=Object.getOwnPropertyDescriptor(v,m);y&&(n.delete(m),Object.defineProperty(e,m,y))}}catch(b){g.e(b)}finally{g.f()}}}catch(b){c.e(b)}finally{c.f()}return n}}]),e}(),Ur=r(29979),qr=new Map([["Automation",0],["Local",1],["Staging",2],["Dogfood",3],["Preview",4],["Microsoft",5],["SyntheticTraffic",5],["Production",6],["GCC",7],["GCC-High",8],["DoD",8]]);function zr(e,t){return(0,Ur.L5)("optimizedDependencyContainer",function(e,t){var r=t;void 0===r&&(r="Production");var n=qr.get(e),o=qr.get(r);return void 0!==n&&void 0!==o&&o<=n}("Local",null===t||void 0===t?void 0:t.audience),t)?new jr(e):new Mr.Q(e)}var Yr=r(93433),Vr=["https://cdn.dev.fluidpreview.office.net","https://cdn.fluidpreview.office.net","https://res-sdf.cdn.office.net","https://res.cdn.office.net","https://dev.loop.microsoft.com","https://df.loop.microsoft.com","https://preview.loop.microsoft.com","https://loop.microsoft.com","https://dev.ch5.fluidpreview.office.net","https://ch5.fluidpreview.office.net","https://blobs.officehome.msocdn.com","https://app.int.whiteboard.microsoft.com","https://app.whiteboard.microsoft.com","https://whiteboard.microsoft.com","https://whiteboard.office.com","https://cdn.forms.office.net","https://loop.cloud.microsoft","https://loop.cloud-dev.microsoft"],Gr=["https://res-gcch.cdn.office.net","https://whiteboard.office365.us"],Wr=["https://res-dod.cdn.office.net"],Jr=[].concat(Vr,Gr,Wr),Kr="@ms/office-fluid-container",Qr="@ms/onenote-meetings",Xr="@ms/whiteboard-container",$r="@fluidx/loop-page-container";function en(e){switch(e){case"Development":return"https://cdn.dev.fluidpreview.office.net/fluid/dev";case"Staging":return"https://cdn.dev.fluidpreview.office.net/fluid/stg";case"Dogfood":return"https://cdn.fluidpreview.office.net/fluid/df";case"Gcc":return"https://cdn.fluidpreview.office.net/fluid/gcc";case"GccHigh":return"https://res-gcch.cdn.office.net/fluid/gcch";case"DoD":return"https://res-dod.cdn.office.net/fluid/dod";default:return"https://cdn.fluidpreview.office.net/fluid/prod"}}function tn(e){switch(e){case"Staging":return"https://dev.loop.microsoft.com/fluid/stg";case"Dogfood":return"https://ch5.fluidpreview.office.net/fluid/df";default:return"https://ch5.fluidpreview.office.net/fluid/prod"}}var rn=r(94465),nn=r(98678),on=r(5362),an="fluidCodeLoaderCache",sn="codeLoaderStorage";function cn(){return(0,on.X3)(an,1,{upgrade:function(e,t){return(0,i.Z)((0,n.Z)().mark((function t(){return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.createObjectStore(sn).createIndex("lastUpdatedTime","lastUpdatedTime");case 2:case"end":return t.stop()}}),t)})))()},blocked:function(){throw new Error("Could not open code loader cache DB since it is blocked by an older client that has the DB open")}})}function un(e){return"".concat(e.packageName,"_").concat(e.containerEnvironment)}function ln(e,t){var r=e.find((function(e){return!function(e,t){var r=new URL(e);return t.includes(r.origin)}(e,t)}));return void 0===r}var dn=6048e5;function fn(e,t,r){return hn.apply(this,arguments)}function hn(){return(hn=(0,i.Z)((0,n.Z)().mark((function e(t,r,o){var i,a,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,cn();case 3:return i=e.sent,e.next=6,i.get(sn,un({packageName:t,containerEnvironment:r}));case 6:if(a=e.sent,i.close(),!a){e.next=16;break}if(!((s=Date.now()-a.lastUpdatedTime)>dn)){e.next=12;break}return e.abrupt("return",{metadata:{cacheStatus:"expired",cacheAge:s},codeDetails:void 0});case 12:if(ln(a.codeDetailsPackage.fluid.browser.umd.files,o)){e.next=15;break}return pn(t,r).catch((function(){})),e.abrupt("return",{metadata:{cacheStatus:"unsafe"},codeDetails:void 0});case 15:return e.abrupt("return",{metadata:{cacheStatus:"hit",cacheAge:s},codeDetails:a.codeDetailsPackage});case 16:e.next=20;break;case 18:e.prev=18,e.t0=e.catch(0);case 20:return e.abrupt("return",{metadata:{cacheStatus:"miss"},codeDetails:void 0});case 21:case"end":return e.stop()}}),e,null,[[0,18]])})))).apply(this,arguments)}function pn(e,t){return vn.apply(this,arguments)}function vn(){return(vn=(0,i.Z)((0,n.Z)().mark((function e(t,r){var o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,cn();case 3:return o=e.sent,e.next=6,o.delete(sn,un({packageName:t,containerEnvironment:r}));case 6:o.close(),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(0);case 11:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}function gn(){return(gn=(0,i.Z)((0,n.Z)().mark((function e(t,r,o,i,a){var s,c,u,l,d,f,h;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=(0,T.n3)(),c=E.a.start("GetCodeDetailsPackage",a,{addUserTiming:!0}),u=fn(t,r,o).then((function(e){return{method:"cache",cacheDetails:e}})),l=i(r,o).then((function(e){return{method:"network",codeDetails:e}})),e.next=6,Promise.race([u,l]);case 6:if(d=e.sent,f={documentEverHidden:(0,T.yv)(s,!0)>-1},"cache"!==d.method){e.next=14;break}if(h=d.cacheDetails,f=(0,w.Z)((0,w.Z)({},f),h.metadata),!h.codeDetails){e.next=14;break}return c.setResult(!0,(0,w.Z)({method:"cache"},f)),e.abrupt("return",h.codeDetails);case 14:return e.abrupt("return",l.then((function(e){return c.setResult(!0,(0,w.Z)({method:"network"},f)),e.codeDetails})));case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function mn(e,t,r,o,a){var s=r.getLatestContainerCodeDetails,c=r.upgradeNeeded,u=r.preCacheContainerCode,l=function(r){return function(e,t,r,o,a,s){var c=o(r),u=c.then(function(){var o=(0,i.Z)((0,n.Z)().mark((function o(i){var c,u,l;return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,cn();case 2:return c=n.sent,u=un({packageName:t,containerEnvironment:r}),n.next=6,c.get(sn,u);case 6:return(l=n.sent)&&l.codeDetailsPackage.version===i.fluidCodeDetailsOverride.package.version||a(e,i,s),n.next=10,c.put(sn,{codeDetailsPackage:i.fluidCodeDetailsOverride.package,lastUpdatedTime:Date.now()},u);case 10:c.close();case 11:case"end":return n.stop()}}),o)})));return function(e){return o.apply(this,arguments)}}()).catch((function(){}));return{codePackagePromise:c.then((function(e){var t=e.maxUnsupportedContainerScriptVersion;return(0,w.Z)((0,w.Z)({},e.fluidCodeDetailsOverride.package),{},{maxUnsupportedVersion:t})})),cacheUpdatePromise:u}}(e,t,r,s,u,a)};return{getCodeDetailsPackage:function(e,r){return function(e,t,r,n,o){return gn.apply(this,arguments)}(t,e,r,(function(e){return l(e).codePackagePromise}),o)},upgradeNeeded:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(r,o){var i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c){e.next=2;break}return e.abrupt("return",!1);case 2:return e.next=4,c(r,o);case 4:if(!(i=e.sent)){e.next=9;break}return e.next=8,pn(t,r);case 8:l(r);case 9:return e.abrupt("return",i);case 10:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),preCacheLatestContainerCode:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(t).cacheUpdatePromise;case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}function yn(e,t){var r=e.document,n=r.createDocumentFragment();t.forEach((function(e){var t=r.createElement("link");t.rel="prefetch",t.href=e,e.endsWith(".js")?(t.as="script",t.crossOrigin="anonymous",n.appendChild(t)):e.endsWith(".css")&&(t.as="style",n.appendChild(t))})),r.head.appendChild(n)}function bn(e,t,r){var n=t.preload.manifest,o=(0,Yr.Z)(n.assets);if(n.localizedAssets){var i=U(r),a=n.localizedAssets[i];a&&o.push.apply(o,(0,Yr.Z)(a))}yn(e,o.map((function(e){return"".concat(t.preload.jsBaseUrl,"/").concat(e)})))}function kn(e,t){return Sn.apply(this,arguments)}function Sn(){return(Sn=(0,i.Z)((0,n.Z)().mark((function e(t,r){var o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r?(0,rn.tj)(t,{method:"GET"},"GetCodeLoadDetailsFromNetwork",r,!1,{maxRetries:3,filter:(0,rn.mE)([709,710]),backoffFn:(0,nn.py)(500)}):(0,rn.q4)(t,{method:"GET"},{maxRetries:3,filter:(0,rn.mE)([709,710]),backoffFn:(0,nn.py)(500)});case 2:if(!(o=e.sent).result.ok){e.next=5;break}return e.abrupt("return",o.result.json());case 5:throw new Error("getCodeLoadDetailsFromNetwork: Failed to fetch: ".concat(t," ; StatusCode: ").concat(o.result.status));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Cn(e){return!isNaN(e)&&isFinite(e)}function wn(e,t,r){var n=parseFloat(e);if(!Cn(n))return!1;var o=parseFloat(t);if(!Cn(o))return!1;var i=parseFloat(r);return!!(Cn(i)&&n>i)||n<=o}var xn=function(e,t,r,o,a){return mn(e,t,{getLatestContainerCodeDetails:r,preCacheContainerCode:bn,upgradeNeeded:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,o){var i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r(t);case 3:return i=e.sent,e.abrupt("return",wn(o,i.maxUnsupportedContainerScriptVersion,i.fluidCodeDetailsOverride.package.version));case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,r){return e.apply(this,arguments)}}()},o,a)};function Pn(){return(Pn=(0,i.Z)((0,n.Z)().mark((function e(t,r){var o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o="".concat(en(t),"/container/versionless/officeContainerCodeLoadDetails.json"),e.abrupt("return",kn(o,r));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var En=function(e,t,r){return xn(e,Kr,(function(e){return function(e,t){return Pn.apply(this,arguments)}(e,t)}),t,r)};function Zn(){return(Zn=(0,i.Z)((0,n.Z)().mark((function e(t,r){var o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o="".concat(tn(t),"/loop-page-container/versionless/loopPageContainerCodeLoadDetails.json"),e.abrupt("return",kn(o,r));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Tn=function(e,t,r){return xn(e,$r,(function(e){return function(e,t){return Zn.apply(this,arguments)}(e,t)}),t,r)},Nn=function(e){var t,r,n,o,i,a;return x(e)&&"string"===typeof(null===(n=null===(r=null===(t=null===e||void 0===e?void 0:e.fluid)||void 0===t?void 0:t.browser)||void 0===r?void 0:r.umd)||void 0===n?void 0:n.library)&&Array.isArray(null===(a=null===(i=null===(o=null===e||void 0===e?void 0:e.fluid)||void 0===o?void 0:o.browser)||void 0===i?void 0:i.umd)||void 0===a?void 0:a.files)},Fn=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"low",o=3;return function i(){return In(e,t,r,n).catch((function(){return 0===(o-=1)?In(e,t,r,n):i()}))}()};function In(e,t,r,n){return Bn.apply(this,arguments)}function Bn(){return(Bn=(0,i.Z)((0,n.Z)().mark((function e(t,r,o,i){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var a,s,c=t.document,u=c.createElement("script");u.setAttribute("fetchpriority",i);var l=null!==(a=null===o||void 0===o||null===(s=o.trustedTypesPolicy)||void 0===s?void 0:s.createScriptURL(r,{allowedScriptOrigins:o.allowedOrigins}))&&void 0!==a?a:r;u.src=l,u.async=!1,u.charset="utf-8",u.crossOrigin="anonymous",u.onload=e,u.onerror=function(){return n(new Error("Failed to download the script at url: ".concat(r,", isUserDefinitelyOffline: ").concat(!t.navigator.onLine)))},c.head.appendChild(u)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Dn=function(e){switch(e){case Qr:case Kr:case"@msstream/experiences-fluid-embed":case"@office-start/space-container":case Xr:case $r:return e;default:return"(redacted)"}},An="NPM",On="CDN",Ln=function(e,t){var r=3;return function n(){return _n(e,t).catch((function(){return 0===(r-=1)?_n(e,t):n()}))}()};function _n(e,t){return new Promise((function(r,n){var o=e.document,i=o.createElement("link");return i.rel="stylesheet",i.type="text/css",i.href=t,i.onload=function(){r()},i.onerror=function(){return n(new Error("Failed to download the style sheet at url: ".concat(t,", isUserDefinitelyOffline: ").concat(!e.navigator.onLine)))},o.head.appendChild(i),i}))}function Mn(e){if(!Nn(e)||void 0===e.version)throw new Error("Codeloader does not know how to load from this source")}var Rn=new Map,Hn=function(e){return"string"===typeof e.package?e.package:e.package.name},jn="0.0.1",Un=function(e){return!Number.isNaN(e)&&Number.isFinite(e)},qn=function(e){return"string"!==typeof e.package&&(t=e.package,Nn(t)&&(t.version===jn||Un(Number(t.version))))?{name:e.package.name,version:e.package.version===jn?jn:Number(e.package.version)}:void 0;var t},zn=function(e){var t=Number(e.maxUnsupportedVersion);return Un(t)?t:void 0},Yn=function(){function e(t,r){(0,u.Z)(this,e),this.wrappedFactory=t,this.config=r}return(0,c.Z)(e,[{key:"IRuntimeFactory",get:function(){return this}},{key:"instantiateRuntime",value:function(e,t){return this.wrappedFactory.configure(this.config),this.wrappedFactory.instantiateRuntime(e,t)}}]),e}(),Vn=function(){function e(t){(0,u.Z)(this,e),this.config=t,this.actualCodeDetailsMap=new Map}return(0,c.Z)(e,[{key:"IFluidCodeDetailsComparer",get:function(){return this}},{key:"tryFormActualCodeDetailsMapKey",value:function(e){var t=qn(e);if(void 0!==t)return"".concat(t.version,"|").concat(t.name)}},{key:"getActualCodeDetails",value:function(e){var t=this.tryFormActualCodeDetailsMapKey(e);return void 0===t?void 0:this.actualCodeDetailsMap.get(t)}},{key:"load",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){var o,i,a,s,c,u,d,f,h,p,v,g,m,y,b;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Hn(t),a=t.config,s=this.config,c=s.windowContext,u=s.getBundledPackageFactoryOverride,d=s.disableCdnCodeLoadingFallback,f=Rn.get(c),void 0===(h=null===(o=f)||void 0===o?void 0:o.get(i))){e.next=15;break}return e.next=8,h;case 8:if(p=e.sent,void 0===(v=p.fluidExport.ConfigurableRuntimeFactory)){e.next=14;break}return e.abrupt("return",{module:{fluidExport:new Yn(v,a)},details:t});case 14:return e.abrupt("return",{module:p,details:t});case 15:if(!(g=null===u||void 0===u?void 0:u(i))){e.next=20;break}g.then((function(e){var t,n=null===(t=e.fluidExport.CodeVersionDetailsProvider)||void 0===t||null===(t=t.codeVersionDetails)||void 0===t?void 0:t.version;Gn(r,{packageName:i,deliveryType:An,codeVersion:n})})).catch((function(){r&&(0,l.uX)(r,{eventName:"NpmCodeLoaderOverrideFailed",packageName:Dn(i)})})),e.next=26;break;case 20:if(!d){e.next=24;break}throw new Error("CDN code loading fallback set to false but no factory provided by host for container named ".concat(Dn(i)));case 24:r&&(0,l.ve)(r,{eventName:"CodeLoaderFallbackToCDN",containerType:Dn(i)}),g=this.loadInternal(t,r);case 26:return f||(f=new Map,Rn.set(c,f),c!==window&&c.addEventListener("unload",(function(){Rn.delete(c)}))),f.set(i,g),g.catch((function(){return f.delete(i)})),e.next=31,g;case 31:if(m=e.sent,y=m.fluidExport,void 0===(b=y.ConfigurableRuntimeFactory)){e.next=38;break}return e.abrupt("return",{module:{fluidExport:new Yn(b,a)},details:t});case 38:return e.abrupt("return",{module:m,details:t});case 39:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"loadInternal",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){var o,i,a,s,c,u,l,d,f,h,p,v,g,m,y;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.config,i=o.windowContext,a=o.trustedTypesPolicy,s=o.allowedCodeOrigins,c=o.getFluidCodeVersionDetails,u=o.scriptLoadPriority,e.next=3,this.getEffectiveFluidCodeDetailsPackage(t);case 3:if(l=e.sent,d=Hn(t),Gn(r,{packageName:d,deliveryType:On,codeVersion:l.version}),void 0!==l){e.next=8;break}throw new Error("Failed to get Fluid Package. Trying to load ContainerType: ".concat(Dn(t.package.name)));case 8:if(f=l.fluid.browser.umd,this.shouldLoad(f.files)){e.next=11;break}throw new Error("Unsupported container files, check that CDN is on allow list");case 11:if(void 0!==(h=this.tryFormActualCodeDetailsMapKey(t))&&"string"!==typeof t.package&&(p=(0,w.Z)((0,w.Z)({},t),{},{package:(0,w.Z)((0,w.Z)({},t.package),l)}),this.actualCodeDetailsMap.set(h,p)),e.t0=a,!e.t0){e.next=20;break}return e.next=17,a;case 17:e.t1=e.sent,e.t2=s,e.t0={trustedTypesPolicy:e.t1,allowedOrigins:e.t2};case 20:return v=e.t0,e.next=23,Promise.all(f.files.map((function(e){var t=e.toLowerCase();if(t.endsWith(".js"))return Fn(i,e,v,u);if(t.endsWith(".css"))return Ln(i,e);throw new Error("Codeloader does not know how to load: ".concat(e))})));case 23:if(void 0!==(g=i[f.library])){e.next=26;break}throw new Error("Entry point of loaded package not a Fluid module. Trying to load ContainerType: ".concat(Dn(t.package.name)));case 26:return(m=g.fluidExport.CodeVersionDetailsProvider)&&(y=null===c||void 0===c?void 0:c(l))&&m.setCodeVersionDetails(y),e.abrupt("return",g);case 29:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"preCache",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,o,i,a,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.config,o=r.getFluidCodeDetailsPackageOverride,i=r.windowContext,!o){e.next=10;break}return e.next=4,o(t);case 4:if(!(a=e.sent)){e.next=10;break}if(s=a.fluid.browser.umd,this.shouldLoad(s.files)){e.next=9;break}throw new Error("Unsupported container files, check that CDN is on allow list");case 9:yn(i,s.files);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getEffectiveFluidCodeDetailsPackage",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,o,i,a,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i="string"===typeof t.package?t.package:t.package.name,e.next=3,null===(r=(o=this.config).getFluidCodeDetailsPackageOverride)||void 0===r?void 0:r.call(o,i);case 3:if(a=e.sent,"string"!==typeof(s=a||t.package)){e.next=7;break}throw new Error("Codeloader does not know how to load from this source");case 7:return Mn(s),e.abrupt("return",s);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"shouldLoad",value:function(e){return ln(e,this.config.allowedCodeOrigins)}},{key:"satisfies",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){var o,i,a,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(o=this.getActualCodeDetails(t))){e.next=3;break}return e.abrupt("return",!0);case 3:if("string"!==typeof r.package&&"string"!==typeof o.package){e.next=5;break}return e.abrupt("return",!0);case 5:if(void 0===(i=zn(r.package))){e.next=10;break}if(void 0===(s=null===(a=qn(o))||void 0===a?void 0:a.version)){e.next=10;break}return e.abrupt("return",s===jn||s>i);case 10:return e.abrupt("return",!0);case 11:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"compare",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){var o,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(o=qn(t))){e.next=3;break}return e.abrupt("return",void 0);case 3:if(void 0!==(i=qn(r))){e.next=6;break}return e.abrupt("return",void 0);case 6:if(o.name===i.name){e.next=8;break}return e.abrupt("return",void 0);case 8:if(o.version!==i.version){e.next=10;break}return e.abrupt("return",0);case 10:if(o.version!==jn){e.next=12;break}return e.abrupt("return",-1);case 12:if(i.version!==jn){e.next=14;break}return e.abrupt("return",1);case 14:return e.abrupt("return",o.version-i.version);case 15:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()}]),e}();function Gn(e,t){var r=t.packageName,n=t.deliveryType,o=t.codeVersion;if(e){var i={eventName:"FluidCodeDetails",subCategory:"FluidCodeDetails",containerType:Dn(r),deliveryType:n};o&&(i.codeVersion=o),(0,l.ve)(e,i)}}var Wn=function(){function e(t){var r,a,s=this;(0,u.Z)(this,e),this.config=t;var c=null!==(r=t.additionalAllowedCodeOrigins)&&void 0!==r?r:[],f=this.config,h=f.windowContext,p=f.logger,v=f.localeHint,g=null!==p&&void 0!==p&&p.NamespaceLogger?new d.g("OfficeWebHost",p.NamespaceLogger):p;this.logger=g,this.settingsProvider=t.settingsProvider;var m=En(h,g,v),y=Tn(h,g,v),b=function(e,t,r){var n={name:Xr,version:"0.0.1",fluid:{browser:{umd:{files:["https://whiteboard.office.com/root/index.fluid.js"],library:"microsoftWhiteboard"}}}};return{getCodeDetailsPackage:function(e,t){return Promise.resolve(n)}}}();this.containerCodeDetailsProviderMap=new Map([[Kr,m],[Qr,m],[$r,y],[Xr,b]]),null===(a=t.additionalCodeDetailsProviders)||void 0===a||a.forEach((function(e){var t=(0,o.Z)(e,2),r=t[0],n=t[1];return s.containerCodeDetailsProviderMap.set(r,n)}));var k=[].concat((0,Yr.Z)(function(e,t,r){var n;if(null===(n=null===t||void 0===t?void 0:t.getSetting("bohemiaCodeLoader.environmentSpecificCDNs",!0))||void 0===n||n){var o="DoD"===e?Wr:"GccHigh"===e?Gr:Vr;return r&&((0,l.ve)(r,{eventName:"DefaultAllowedCodeOrigins",environment:e}),0===o.length&&(0,l.uX)(r,{eventName:"DefaultAllowedCodeOriginsEmptyEnvironment"},"{message: ${deploymentRing} environment does not have any default code origins}")),o}return Jr}(this.config.containerEnvironment,this.settingsProvider,g)),(0,Yr.Z)(function(e){var t,r=null===(t=(0,F.E)())||void 0===t?void 0:t.AllowListOverride;return r?(e&&(0,l.ve)(e,{eventName:"CodeLoaderAllowListOverwritten",subCategory:"LocalStorageOverride"}),JSON.parse(r)):[]}(g)),(0,Yr.Z)(c));this.simpleCodeLoader=new Vn({windowContext:t.windowContext,trustedTypesPolicy:t.trustedTypesPolicy,getBundledPackageFactoryOverride:function(e){var r,n=null===(r=t.locallyBundledPackageFactories)||void 0===r?void 0:r.get(e);return n?Promise.resolve(n):void 0},disableCdnCodeLoadingFallback:t.disableCdnCodeLoadingFallback,getFluidCodeDetailsPackageOverride:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(r){var o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(o=s.containerCodeDetailsProviderMap.get(r))){e.next=3;break}return e.abrupt("return",o.getCodeDetailsPackage(t.containerEnvironment,k));case 3:return e.abrupt("return",void 0);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),allowedCodeOrigins:k,getFluidCodeVersionDetails:function(e){var r,o=t.containerEnvironment,a=e.version,c=null===(r=s.containerCodeDetailsProviderMap.get(e.name))||void 0===r?void 0:r.upgradeNeeded;return{version:a,containerEnvironment:o||"Local",needUpgrade:c?function(){return c(o,a)}:(0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)})))}},scriptLoadPriority:t.scriptLoadPriority})}return(0,c.Z)(e,[{key:"IFluidCodeDetailsComparer",get:function(){return this.simpleCodeLoader}},{key:"getActualCodeDetails",value:function(e){return this.simpleCodeLoader.getActualCodeDetails(e)}},{key:"preCache",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(r=this.config.locallyBundledPackageFactories)||void 0===r||!r.has(t)){e.next=2;break}return e.abrupt("return");case 2:if(null===(o=this.containerCodeDetailsProviderMap.get(t))||void 0===o||!o.preCacheLatestContainerCode){e.next=5;break}return e.abrupt("return",o.preCacheLatestContainerCode(this.config.containerEnvironment));case 5:return e.abrupt("return",this.simpleCodeLoader.preCache(t));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.simpleCodeLoader.load(t,this.logger));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Jn=function(){function e(t){var r=this;(0,u.Z)(this,e),this.bohemiaConfig=t,this.instantiateFluidCodeLoader=function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var i,a,s,c,u,l,d,f;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={LoopTrustedTypesPolicy:"LoopTrustedTypesPolicy",NamespaceLogger:"NamespaceLogger",SettingsProvider:"SettingsProvider"},a=t.dependencySynthesizer.synthesize(i,void 0),e.next=4,Promise.all([a.LoopTrustedTypesPolicy,a.SettingsProvider,a.NamespaceLogger]);case 4:return s=e.sent,c=(0,o.Z)(s,3),u=c[0],l=c[1],d=c[2],f=new Wn((0,w.Z)((0,w.Z)({},r.bohemiaConfig),{},{windowContext:t.windowContext,trustedTypesPolicy:u,settingsProvider:l,logger:d})),e.abrupt("return",f);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}return(0,c.Z)(e,[{key:"FluidCodeLoaderFactory",get:function(){return this}}]),e}();var Kn=new URLSearchParams("undefined"!==typeof location?location.search:""),Qn=new Map;function Xn(e,t){var r=function(e,t){var r,n,o,i=Qn.get(e);if(void 0!==i)return i;o=void 0!==(r=function(e){var t=Kn.get(e);return $n(t)}(e))?r:void 0!==(n=function(e){var t,r=null===(t=(0,F.E)())||void 0===t?void 0:t.getItem(e);return $n(r)}(e))?n:t;return Qn.set(e,o),o}(e,t);return r}function $n(e){if(null!==e&&void 0!==e){var t=function(e,t,r){try{return JSON.parse(e,t)}catch(Ht){return void(r&&(0,l.uX)(r.logger,r.event,Ht))}}(e),r=void 0!==t?t:e;return"on"===r||"off"===r?"on"===r:r}}function eo(e,t,r,n){return r?r.getSetting(e,t,n):Xn(e,t)}function to(e,t,r){return eo(e,t,r,"FluidExperiences")}var ro=function(){function e(t){(0,u.Z)(this,e),this.settingsProvider=t}return(0,c.Z)(e,[{key:"getRawConfig",value:function(e){var t=to(e,null,this.settingsProvider);return null===t?void 0:t}}]),e}();var no=r(67425),oo={maxRetries:2,backoffFn:(0,nn.py)(500),filter:(0,rn.mE)([408,409,429,503]),respectRetryAfterHeader:!0};no.g,no.g;function io(e,t){return ao.apply(this,arguments)}function ao(){return(ao=(0,i.Z)((0,n.Z)().mark((function e(t,r){var o,i,a,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=E.a.start(D.k5,r),a=new URL(t),e.prev=2,e.next=5,(0,rn.tj)("".concat(a),{method:"GET"},"ContainerManifestFetch",r,!1,oo,3e3);case 5:if(!(s=e.sent).result.ok){e.next=12;break}return e.next=9,s.result.json();case 9:o=e.sent,e.next=13;break;case 12:throw new Error("Component manifest fetch returned an error response. status: ".concat(s.result.status,": ").concat(s.result.statusText,"."));case 13:e.next=19;break;case 15:return e.prev=15,e.t0=e.catch(2),i.setResult(!1,{errorType:D.uv},e.t0,{sampleEvent:!0}),e.abrupt("return",void 0);case 19:return i.setResult(!0,void 0,void 0,{sampleEvent:!0}),e.abrupt("return",o);case 21:case"end":return e.stop()}}),e,null,[[2,15]])})))).apply(this,arguments)}var so="{locale}",co=[{genericUrl:"/officeContainerManifest.json",localizableUrl:"/officeContainerManifest.".concat(so,".json")}];function uo(e,t,r,n){return lo.apply(this,arguments)}function lo(){return(lo=(0,i.Z)((0,n.Z)().mark((function e(t,r,o,i){var a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=o&&new d.g(D.gL,o),e.abrupt("return",fo(t,r,a).then((function(e){return po(e,i)})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function fo(e,t,r){return ho.apply(this,arguments)}function ho(){return ho=(0,i.Z)((0,n.Z)().mark((function e(t,r,o){var a,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=j(t)?U(t):void 0,s=Or(r),e.abrupt("return",Promise.all(co.map(function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,i,c,u;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=en(s)+"/container/versionless",i=r+t.genericUrl,c=r+t.localizableUrl,void 0===a||!c){e.next=9;break}return e.next=6,io(c.replace(so,a),o);case 6:if(void 0===(u=e.sent)){e.next=9;break}return e.abrupt("return",u);case 9:return e.abrupt("return",io(i,o));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())));case 3:case"end":return e.stop()}}),e)}))),ho.apply(this,arguments)}function po(e,t){var r=[];return e.forEach((function(e){if(void 0!==e){var n=e.fluidCodeDetailsPackage;if(t){var o=function(){return{package:{name:"@ms/office-fluid-container",version:"0.0.1",fluid:{browser:{umd:{files:["https://officefluiddev.blob.core.windows.net/staticcontent/versionless/container/codeLoader.js"],library:"codeLoader"}}}},config:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}}}(),i={package:{name:"@fluidx/loop-page-container",version:"0.0.1",fluid:{browser:{umd:{files:[],library:""}}}}};"object"===typeof o.package&&"object"===typeof i.package&&e.fluidCodeDetailsPackage.name===o.package.name&&(n=i.package)}e.configurations.forEach((function(e){return r.push({codeDetails:{package:n,config:e.config},queryableData:e.queryableData,heroConfiguration:e.heroConfiguration})}))}})),r}function vo(e){if("string"!==typeof e.package&&x(e.package))return e.package.name}var go=r(92337),mo="LoopBootSettingsKeyName",yo={loadScriptsPriority:"loop.owh.loadScriptsPriority"};function bo(e,t,r){var n=e;n.loopBootSettings=n.loopBootSettings||{};var o,i=e.localStorage.getItem(mo);if(i){try{o=JSON.parse(i)}catch(a){}o&&(n.loopBootSettings=o,r&&(0,go.F)((function(){(0,l.ve)(r,{eventName:"reportBootSettings",bootSettings:i})})))}!function(e){var t,r=null===(t=e.loopBootSettings)||void 0===t?void 0:t.loadScriptsPriority;void 0!==r&&(e.__webpack_hack_fetchpriority__=r)}(n),(0,go.F)((function(){!function(e,t,r){var n,o=t.synthesize({SettingsProvider:"SettingsProvider"},void 0);null===(n=o.SettingsProvider)||void 0===n||n.then((function(t){if(t){var n={};for(var o in yo){var i=to(yo[o],"<unknown>",t);"<unknown>"!==i&&(n[o]=i)}Object.keys(n).length>0&&e.localStorage.setItem(mo,JSON.stringify((0,w.Z)((0,w.Z)({},r),n)))}})).catch((function(){}))}(e,t,o)}))}function ko(e){var t,r=null===(t=e.loopBootSettings)||void 0===t?void 0:t.loadScriptsPriority;if("high"===r||"low"===r)return r}var So="FluidCodeLoaderFactory";function Co(e){return"preCache"in e&&!!e.preCache}function wo(e){var t;if(void 0!==e.getSpecifiedCodeDetails)return e.getSpecifiedCodeDetails();var r=e.getQuorum();return null!==(t=r.getMember("code"))&&void 0!==t?t:r.getMember("code2")}function xo(e,t){(0,i.Z)((0,n.Z)().mark((function r(){var o,i,a,s;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!(o=wo(e))){r.next=10;break}if(!(a=null===(i=t.getActualCodeDetails)||void 0===i?void 0:i.call(t,o))||!t.IFluidCodeDetailsComparer){r.next=10;break}return r.next=6,t.IFluidCodeDetailsComparer.compare(o,a);case 6:if(!(void 0!==(s=r.sent)&&s<0)){r.next=10;break}return r.next=10,e.proposeCodeDetails(a);case 10:case"end":return r.stop()}}),r)})))().catch((function(){}))}function Po(){var e=function(){var e;return null===(e=(0,F.E)())||void 0===e?void 0:e.FluidCodeDetailsOverride}();if(void 0!==e)return JSON.parse(e)}function Eo(e){return Zo.apply(this,arguments)}function Zo(){return Zo=(0,i.Z)((0,n.Z)().mark((function e(t){var r,a,s,c,u,l,d,f,h,p,v,g,m,y;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.hostConfig,s=t.dependencySynthesizer,c=t.windowContext,!(u=a.codeLoader)){e.next=7;break}return e.t0=Promise,e.t1=function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.windowContext,e.abrupt("return",u(r));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.t2={get FluidCodeLoaderFactory(){return this},instantiateFluidCodeLoader:e.t1},e.abrupt("return",e.t0.resolve.call(e.t0,e.t2));case 7:return l={HostContext:"HostContext",SettingsProvider:"SettingsProvider",InternationalizationContext:"InternationalizationContext"},d=s.synthesize(l,void 0),e.next=11,Promise.all([d.HostContext,d.SettingsProvider,d.InternationalizationContext]);case 11:return f=e.sent,h=(0,o.Z)(f,3),p=h[0],v=h[1],g=h[2],m=_r(a.environment,null===v||void 0===v?void 0:v.audience),y=(null===g||void 0===g?void 0:g.uiLocale)||(null===p||void 0===p||null===(r=p.hostLocaleContext)||void 0===r?void 0:r.uiLanguage)||R,e.abrupt("return",new Jn({containerEnvironment:m,localeHint:y,scriptLoadPriority:ko(c)}));case 19:case"end":return e.stop()}}),e)}))),Zo.apply(this,arguments)}function To(){return To=(0,i.Z)((0,n.Z)().mark((function e(t,i,a,s,c,u,f,h){var p,v,g,m,y,b,k,S,C,w,x,P,Z,T,N,F;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.synthesize({SettingsProvider:"SettingsProvider"},void 0).SettingsProvider;case 2:return p=e.sent,v=zr(c,p),f&&!v.has("NamespaceLogger")&&v.register("NamespaceLogger",new d.g(D.lw,f)),g={SettingsProvider:"SettingsProvider",FluidCodeLoaderFactory:So},m=v.synthesize(g,void 0),e.next=9,Promise.all([m.SettingsProvider,Promise.resolve(m.FluidCodeLoaderFactory).then((function(e){return null!==e&&void 0!==e?e:Eo({hostConfig:a,dependencySynthesizer:v,windowContext:t})}))]);case 9:return y=e.sent,b=(0,o.Z)(y,2),k=b[0],S=b[1],v.has(So)||v.register(So,S),e.next=16,S.instantiateFluidCodeLoader({windowContext:t,dependencySynthesizer:v});case 16:if(C=e.sent,!I()){e.next=24;break}return e.next=20,s.documentServiceFactory;case 20:return w=e.sent,e.next=23,Promise.all([r.e(1721),r.e(5145)]).then(r.bind(r,45025)).then((function(e){return e.FluidDebugger.createFromServiceFactory(w)}));case 23:s.documentServiceFactory=e.sent;case 24:return"Existing"===i.type&&(x=i.containerCodeHint),x&&(f&&(0,l.ve)(f,{eventName:D.zy}),a.loadCodeFromHint&&(P=E.a.start(D.VR,f,{addUserTiming:!0}),C.load({package:x}).then((function(){P.setResult(!0)})).catch((function(e){P.setResult(!1,void 0,e)}))),Co(C)&&(null===h||void 0===h||h.addAdditionalProps({precachedContainerPackageName:Dn(x)}),C.preCache(x).catch((function(e){f&&(0,l.uX)(f,{eventName:D.v2},e)})))),k&&(Z=new ro(k)),e.next=29,s.urlResolver;case 29:return T=e.sent,e.next=32,s.documentServiceFactory;case 32:return N=e.sent,F={urlResolver:T,documentServiceFactory:N,options:a.loaderOptions,scope:{IFluidDependencySynthesizer:v},codeLoader:C,detachedBlobStorage:a.detachedBlobStorage,logger:u,configProvider:Z},e.abrupt("return",new Ar(F));case 35:case"end":return e.stop()}}),e)}))),To.apply(this,arguments)}function No(e,t,r,n,o){return Fo.apply(this,arguments)}function Fo(){return Fo=(0,i.Z)((0,n.Z)().mark((function e(t,r,o,a,s){var c,u,l,d,f,h,p;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=(0,m.Z)({},Fe.loadMode,{opsBeforeReturn:"cached",deltaConnection:o.startContainerInPausedState?"none":"delayed"}),d=t.services.codeLoader,e.t0=r.type,e.next="Existing"===e.t0?5:"DetachedFromCode"===e.t0?10:"DetachedFromSnapshot"===e.t0?13:15;break;case 5:return f=r.containerRequest,h={url:f.url,headers:(0,w.Z)((0,w.Z)({},c),f.headers)},l=r.containerCodeHint,u=t.resolve(h,o.pendingLocalState),e.abrupt("break",16);case 10:return p=Po()||r.codeDetails,u=t.createDetachedContainer(p),e.abrupt("break",16);case 13:return u=t.rehydrateDetachedContainerFromSnapshot(r.snapshot),e.abrupt("break",16);case 15:throw new Error("loadContainerProps type is invalid");case 16:return u.then(function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,i,c,u,f,h,p,v;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.startContainerInPausedState||ve(t),i=null===(r=t.getSpecifiedCodeDetails)||void 0===r?void 0:r.call(t),c=i&&vo(i),u=c?Dn(c):"Unknown",s&&(h=s,(p={}).containerCodeDetailsName=u,null===(f=h.PersistedProperties)||void 0===f||f.addPersistedProperties(p)),null===a||void 0===a||a.addAdditionalProps({loadedContainerPackageName:u,codeHintPackageName:l,containerPackageMatchedCodeHint:l===c}),t.deltaManager.active?xo(t,d):(v=function e(){t.deltaManager.active&&(xo(t,d),t.off("connected",e))},t.on("connected",v));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.abrupt("return",u);case 18:case"end":return e.stop()}}),e)}))),Fo.apply(this,arguments)}function Io(){return Io=(0,i.Z)((0,n.Z)().mark((function e(t,r,o,a,s,c){var u;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=E.a.start(D.rb,a,{addUserTiming:!0}),e.abrupt("return",r.then(function(){var e=(0,i.Z)((0,n.Z)().mark((function e(r){var l,d;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u.markSubActivityStart("TemplateLoadContainer"),e.next=3,No(r,{type:"Existing",containerRequest:{url:t.fromExistingTemplateUrl,headers:t.loadTemplateRequestHeaders}},o,void 0,a);case 3:return l=e.sent,u.markSubActivityEnd("TemplateLoadContainer"),e.next=7,Tr(l);case 7:return u.markSubActivityStart("TemplateLoadComponent"),d=Te(l,r,{url:t.fromExistingTemplateUrl},a,s,c,o.startContainerInPausedState),e.abrupt("return",d.then(function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u.markSubActivityEnd("TemplateLoadComponent"),null!==t&&void 0!==t&&t.ComponentSerializable){e.next=3;break}throw new Error(D.qo);case 3:return e.next=5,t.ComponentSerializable.serialize();case 5:return r=e.sent,u.setResult(!0),e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){throw u.setResult(!1,void 0,e),e.name=D.Fl,e})));case 2:case"end":return e.stop()}}),e)}))),Io.apply(this,arguments)}function Bo(e){var t=e.windowContextForLoader,r=e.driverFetcher,n=e.dependencySynthesizer,o=e.hostConfig,i=e.logger,a=e.perfMetadata,s=e.documentEverHiddenTrackerID,c=e.containerRequest,u=e.driver,l=e.preCheckInfo,d=e.requiredProviderTypes;_o(u,r,o,n);var f={type:"Existing",containerRequest:c,containerCodeHint:null===l||void 0===l?void 0:l.codeDetailsHint},h=u?Oo(t,f,u,c,n,o,i,a,s,d,void 0):Ao(t,f,r,c,n,o,i,a,s,d,void 0);return{container:h.containerPromise,component:h.componentPromise}}function Do(e,t,r,n,o,i,a,s){_o(r,n,o,t.dependencySynthesizer);var c=r?Oo(e,{type:"DetachedFromCode",codeDetails:t.codeDetails},r,void 0,t.dependencySynthesizer,o,i,a,s,t.requiredProviderTypes,t.loadTemplateProps):Ao(e,{type:"DetachedFromCode",codeDetails:t.codeDetails},n,void 0,t.dependencySynthesizer,o,i,a,s,t.requiredProviderTypes,t.loadTemplateProps);return{component:c.componentPromise,container:c.containerPromise}}function Ao(e,t,r,a,s,c,u,l,d,f,h){var p=new L,v=new L;return function(){return g.apply(this,arguments)}().then(function(){var r=(0,i.Z)((0,n.Z)().mark((function r(o){var i;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:i=Oo(e,t,o,a,s,c,u,l,d,f,h),p.resolve(i.containerPromise),v.resolve(i.componentPromise);case 3:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()).catch((function(e){p.reject(e),v.reject(e)})),{containerPromise:p,componentPromise:v};function g(){return g=(0,i.Z)((0,n.Z)().mark((function t(){var i,a,f,h,p,v,g,m,y,b,k,S,C,x,P,Z,N;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=E.a.start(D._7,u,{addUserTiming:!0}),a=(0,w.Z)((0,w.Z)({},l),{},{documentEverHidden:(0,T.yv)(d)>-1}),!(f=c.driverImplementationOverride)){t.next=6;break}return i.setResult(!0,(0,w.Z)((0,w.Z)({},a),{},{driverType:"Override"})),t.abrupt("return",f);case 6:return h={DriverImplementation:"DriverImplementation",FluidUrlResolverProvider:"FluidUrlResolverProvider",FluidDocumentServiceFactoryProvider:"FluidDocumentServiceFactoryProvider"},p=s.synthesize(h,void 0),v=p.DriverImplementation,g=p.FluidDocumentServiceFactoryProvider,m=p.FluidUrlResolverProvider,t.next=10,Promise.all([v,null===m||void 0===m?void 0:m.then((function(e){return null===e||void 0===e?void 0:e.urlResolver})),null===g||void 0===g?void 0:g.then((function(e){return null===e||void 0===e?void 0:e.documentServiceFactory}))]);case 10:if(y=t.sent,b=(0,o.Z)(y,3),k=b[0],S=b[1],C=b[2],!k){t.next=18;break}return i.setResult(!0,(0,w.Z)((0,w.Z)({},a),{},{driverType:"SynthesizedLegacy"})),t.abrupt("return",k);case 18:if(!S||!C){t.next=21;break}return i.setResult(!0,(0,w.Z)((0,w.Z)({},a),{},{driverType:"Synthesized"})),t.abrupt("return",{documentServiceFactory:C,urlResolver:S});case 21:if(!r){t.next=29;break}return t.next=24,r(e,s,c,u);case 24:return x=t.sent,P=x.type,Z=x.impl,i.setResult(!0,(0,w.Z)((0,w.Z)({},a),{},{driverType:P})),t.abrupt("return",Z);case 29:throw N=new Error("Driver unavailable"),i.setResult(!1,a,N),N;case 32:case"end":return t.stop()}}),t)}))),g.apply(this,arguments)}}function Oo(e,t,r,a,s,c,u,d,f,h,p){var v=d.fluidBootstrapperStartTime;bo(e,s,u);var g="Existing"!==t.type&&{createNew:"DetachedFromCode"===t.type?"DetachedContainer":t.type},m=g&&{additionalPropsToLog:g}||void 0,y=s.synthesize({HostContext:"HostContext",InternationalizationContext:"InternationalizationContext"},void 0);Promise.all([y.HostContext,y.InternationalizationContext]).then((function(e){var t,r,n=(0,o.Z)(e,2),i=n[0],a=n[1],s=null!==(t=null===a||void 0===a?void 0:a.uiLocale)&&void 0!==t?t:null===i||void 0===i||null===(r=i.hostLocaleContext)||void 0===r?void 0:r.uiLanguage;u&&(0,l.ve)(u,{eventName:"HostLocaleContext",subCategory:"HostLocaleContext",uiLanguage:s||R})})).catch((function(){}));var b=E.a.start(D.jJ,u,(0,w.Z)({addUserTiming:!0},m));u&&function(e){var t,r=null===(t=navigator)||void 0===t?void 0:t.connection;(0,l.ve)(e,{eventName:"Metadata",subCategory:"browserMetadata",doNotTrack:navigator.doNotTrack?navigator.doNotTrack:"false",documentHidden:document.hidden,networkType:null===r||void 0===r?void 0:r.effectiveType,networkRoundTripTime:null===r||void 0===r?void 0:r.rtt,cpuCoreCount:navigator.hardwareConcurrency,isMobile:J(),timeStamp:Date.now()})}(u);var k=u&&new pe(u,d,f),S=E.a.start(D.Hf,u,{addUserTiming:!0,additionalPropsToLog:{LoadContainerType:t.type},isAPerformanceMetric:!0}),C=function(e,t,r,n,o,i,a,s){return To.apply(this,arguments)}(e,t,c,r,s,k,u,S),x=C.then((function(e){return No(e,t,c,S,u)}));x.then((function(e){u&&fe(e,u);var t=(0,T.yv)(f),r=S.startTimeSinceEpoch;S.setResult(!0,(0,w.Z)((0,w.Z)({},d),{},{offsetFromFluidBootstrapperStartTime:Q(r,v),documentEverHidden:t>-1}))})).catch((function(e){S.setResult(!1,{errorType:e.errorType},e),b.setResult(!1,{errorType:e.errorType},e),u&&ce(u,D.jJ,ee,re,e.errorType||ne,{},e)}));var P=x.then((function(e){if(!e)throw b.setResult(!1),u&&ce(u,D.jJ,ee,re,ie),new Error("Failed to Load Container");var t=C.then((function(t){return Te(e,t,a,u,d,f,c.startContainerInPausedState)})),r=t;if(null!==p&&void 0!==p&&p.fromExistingTemplateUrl){var o=function(e,t,r,n,o,i){return Io.apply(this,arguments)}(p,C,c,u,d,f);r=t.then((function(e){var t,r=e.ComponentSerializable;if(!r)throw new Error(D.qo);return o.then(function(){var o=(0,i.Z)((0,n.Z)().mark((function o(i){return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=E.a.start(D.sS,u,{addUserTiming:!0}),void 0!==i){n.next=5;break}throw new Error(D.wS);case 5:return n.next=7,r.rehydrate(i);case 7:return t.setResult(!0),n.abrupt("return",e);case 9:case"end":return n.stop()}}),o)})));return function(e){return o.apply(this,arguments)}}()).catch((function(e){var r;throw null===(r=t)||void 0===r||r.setResult(!1,void 0,e),e}))}))}return r.then((function(){b.setResult(!0)})).catch((function(t){e.close(),b.setResult(!1,{errorType:t.errorType},t),u&&ce(u,D.jJ,ee,re,t.errorType||ne,{},t)})),r}));return{containerPromise:x,componentPromise:P.then((function(e){return h?Pe(e,h):e}))}}var Lo=new Error("Invalid configuration for driver. Please provide either a driver, driverFetcher, or driverImplementationOverride.");function _o(e,t,r,n){var o=e||t||r.driverImplementationOverride||function(e){return e.has("DriverImplementation")||["FluidUrlResolverProvider","FluidDocumentServiceFactoryProvider"].every((function(t){return e.has(t)}))}(n);if(!o)throw Lo}var Mo=function(e){return to("owh.useComponentInitialize",!0,e)},Ro=function(e){return to("owh.refactorGetLoopComponent",!0,e)},Ho=r(2770),jo=r(81543),Uo=r(78030);function qo(e,t){return zo.apply(this,arguments)}function zo(){return zo=(0,i.Z)((0,n.Z)().mark((function e(t,r){var o,i,a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Data"===t.type&&t.dataType===Ho.en){e.next=2;break}return e.abrupt("return",void 0);case 2:return o=t.data.url,e.next=5,r;case 5:if(!(!(i=e.sent)||i instanceof jo.D||i instanceof Uo.D)){e.next=8;break}return e.abrupt("return",s(o));case 8:return e.prev=8,e.next=11,i.resolve({url:o.href});case 11:if("fluid"!==(null===(a=e.sent)||void 0===a?void 0:a.type)){e.next=14;break}return e.abrupt("return",{});case 14:e.next=18;break;case 16:e.prev=16,e.t0=e.catch(8);case 18:return e.abrupt("return",void 0);case 19:case"end":return e.stop()}}),e,null,[[8,16]])}))),zo.apply(this,arguments)}var Yo=function(e){function t(e){(0,u.Z)(this,t),this.execute=e}return(0,c.Z)(t,[{key:e,get:function(){return this.getPromise()[Symbol.toStringTag]}},{key:"then",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){var o,i=arguments;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(o=this.getPromise()).then.apply(o,i));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"catch",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,o=arguments;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(r=this.getPromise()).catch.apply(r,o));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"finally",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,o=arguments;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(r=this.getPromise()).finally.apply(r,o));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPromise",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===this.result&&(this.result=this.execute()),e.abrupt("return",this.result);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),t}(Symbol.toStringTag),Vo="IFluidDependencySynthesizer",Go=function(){function e(){(0,u.Z)(this,e),this.providers=new Map;for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];this.parents=r.filter((function(e){return void 0!==e}))}return(0,c.Z)(e,[{key:"IFluidDependencySynthesizer",get:function(){return this}},{key:"register",value:function(e,t){if(this.providers.has(e))throw new Error("Attempting to register a provider of type ".concat(String(e)," that already exists"));this.providers.set(e,t)}},{key:"unregister",value:function(e){this.providers.has(e)&&this.providers.delete(e)}},{key:"synthesize",value:function(e,t){var r=this,n={};return this.generateRequired(n,t),this.generateOptional(n,e),Object.defineProperty(n,Vo,{get:function(){return r}}),n}},{key:"has",value:function(e,t){return!!this.providers.has(e)||!0!==t&&this.parents.some((function(t){return t.has(e)}))}},{key:"getProvider",value:function(t){if(this.has(t)){if(this.providers.has(t))return this.providers.get(t);var r,n=(0,He.Z)(this.parents);try{for(n.s();!(r=n.n()).done;){var o=r.value;if(o instanceof e)return o.getProvider(t);var i=o;if(void 0!==(null===i||void 0===i?void 0:i.getProvider))return i.getProvider(t)}}catch(a){n.e(a)}finally{n.f()}}}},{key:"generateRequired",value:function(e,t){if(void 0!==t)for(var r=0,n=Object.keys(t);r<n.length;r++){var o=n[r],i=this.resolveProvider(o);if(void 0===i)throw new Error("Object attempted to be created without registered required provider ".concat(String(o)));Object.defineProperty(e,o,i)}}},{key:"generateOptional",value:function(e,t){var r;if(void 0!==t)for(var o=0,a=Object.keys(t);o<a.length;o++){var s=a[o],c=null!==(r=this.resolveProvider(s))&&void 0!==r?r:{get:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",void 0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()};Object.defineProperty(e,s,c)}}},{key:"resolveProvider",value:function(e){var t=this.providers.get(e);if(void 0!==t)return"function"===typeof t?{get:function(){if(t&&"function"===typeof t)return Promise.resolve(this[Vo]).then(function(){var e=(0,i.Z)((0,n.Z)().mark((function e(r){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t(r));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(t){return null===t||void 0===t?void 0:t[e]}))}}:{get:function(){if(t)return new Yo((0,i.Z)((0,n.Z)().mark((function r(){return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",Promise.resolve(t).then((function(t){if(t)return t[e]})));case 1:case"end":return r.stop()}}),r)}))))}};var r,o=(0,He.Z)(this.parents);try{for(o.s();!(r=o.n()).done;){var a=r.value,s=(0,m.Z)({},e,e),c=a.synthesize(s,{}),u=Object.getOwnPropertyDescriptor(c,e);if(void 0!==u)return u}}catch(l){o.e(l)}finally{o.f()}}}]),e}();function Wo(e){return e?Object.keys(e).sort().join(","):""}var Jo,Ko,Qo=function(){function e(){var t=this;(0,u.Z)(this,e),this.providers=new Map,this.memo=new Map,this.resolveLocalProvider=function(e){var r=t.providers.get(e);if(r)return"function"===typeof r?{get:function(){if("function"===typeof r)return Promise.resolve(t.IFluidDependencySynthesizer).then(function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(t){return null===t||void 0===t?void 0:t[e]}))}}:{get:function(){return new gt.d((0,i.Z)((0,n.Z)().mark((function t(){return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.resolve(r).then((function(t){if(t)return t[e]})));case 1:case"end":return t.stop()}}),t)}))))}}};for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];this.parents=o.filter((function(e){return void 0!==e}))}return(0,c.Z)(e,[{key:"IFluidDependencySynthesizer",get:function(){return this}},{key:"register",value:function(e,t){if(this.providers.has(e))throw new Error("Attempting to register a provider of type ".concat(String(e)," that already exists"));this.clearMemo(),this.providers.set(e,t)}},{key:"unregister",value:function(e){this.providers.has(e)&&(this.providers.delete(e),this.clearMemo())}},{key:"clearMemo",value:function(){this.memo.clear()}},{key:"synthesize",value:function(e,t){var r=this,n="required:".concat(Wo(t),",optional:").concat(Wo(e));if(this.memo.has(n))return this.memo.get(n);var o={};return this.generateRequired(o,t),this.generateOptional(o,e),Object.defineProperty(o,Vo,{get:function(){return r}}),this.memo.set(n,o),o}},{key:"has",value:function(e,t){return!!this.providers.has(e)||!0!==t&&this.parents.some((function(t){return t.has(e)}))}},{key:"generateRequired",value:function(e,t){if(void 0!==t){var r=this.generate(e,t);if(0!==r.size){var n=Array.from(r).join(", ");throw new Error("Object attempted to be created without registered required providers ".concat(n))}}}},{key:"generateOptional",value:function(e,t){if(void 0!==t){var r,o=this.generate(e,t),a=(0,He.Z)(o);try{for(a.s();!(r=a.n()).done;){var s=r.value,c={get:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",void 0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()};Object.defineProperty(e,s,c)}}catch(u){a.e(u)}finally{a.f()}}}},{key:"generate",value:function(e,t){var r,n=new Set(Object.keys(t)),o=(0,He.Z)(n);try{for(o.s();!(r=o.n()).done;){var i=r.value,a=this.resolveLocalProvider(i);a&&(n.delete(i),Object.defineProperty(e,i,a))}}catch(b){o.e(b)}finally{o.f()}var s,c=(0,He.Z)(this.parents);try{for(c.s();!(s=c.n()).done;){var u,l=s.value,d={},f=(0,He.Z)(n);try{for(f.s();!(u=f.n()).done;){var h=u.value;d[h]=h}}catch(b){f.e(b)}finally{f.f()}var p,v=l.synthesize(d,void 0),g=(0,He.Z)(n);try{for(g.s();!(p=g.n()).done;){var m=p.value,y=Object.getOwnPropertyDescriptor(v,m);y&&(n.delete(m),Object.defineProperty(e,m,y))}}catch(b){g.e(b)}finally{g.f()}}}catch(b){c.e(b)}finally{c.f()}return n}}]),e}();!function(e){e.Generic="Generic",e.Error="Error",e.UserAction="UserAction",e.Activity="Activity"}(Jo||(Jo={})),function(e){e.Success="Success",e.Failure="Failure",e.Cancelled="Cancelled"}(Ko||(Ko={}));var Xo=["facetCodes","statusCode","innerMostErrorCode","sprequestguid"];function $o(e,t,r){r&&ri(t,r);var n=function(e){var t=/[A-Z0-9._%`'+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}/gi;return Object.getOwnPropertyNames(e).map((function(r){if(-1!==r.toLowerCase().indexOf("message")||-1!==r.toLowerCase().indexOf("error")||-1!==r.toLowerCase().indexOf("stack")||!1!==Xo.includes(r)){var n=e[r];void 0!==n&&"string"===typeof n&&(n=n.toString().replace(t,"scrubbed_email"),e[r]=n.toString().replace(/(https:\/\/)(\w)+(.sharepoint.com|-my.sharepoint.com|.sharepoint-df.com)/,"(redacted)").replace(/(https:\/\/)(dev.loop.microsoft.com|df.loop.microsoft.com|loop.microsoft.com)(\/p\/)([a-zA-Z0-9%]+)/,"(redacted)"))}})),e}(t);e.send((0,w.Z)((0,w.Z)({},n),{},{category:Jo.Error}))}var ei,ti;new Set,new Set,new Map([["Automation",1],["SyntheticTraffic",1],["Local",1],["Staging",1],["Dogfood",.1],["Preview",.1],["Microsoft",.01],["Production",.001],["GCC",0],["GCC-High",0],["DoD",0]]);function ri(e,t){!function(e,t){var r,n="object"===typeof e&&null!==e;function o(t){if(n){var r=e[t];return"string"===typeof r?r:void 0}}t.errorMessage=null!==(r=o("message"))&&void 0!==r?r:String(e),t.errorName=o("name"),t.stack=o("stack"),t.errorType=o("errorType"),t.errorInstanceId=o("errorInstanceId"),Xo.forEach((function(r){var n=e[r];n&&(t[r]="object"===typeof n?JSON.stringify(n):n)}))}(t,e),e.message?e.message="".concat(e.message,"\n").concat(e.errorMessage):e.message=e.errorMessage,void 0===e.stack&&(e.stack=ni())}function ni(){var e=(new Error).stack;if(!e)try{throw new Error}catch(t){e=t.stack}return e}try{ei=localStorage}catch(Xa){}ei||(ei=void 0);try{ti=sessionStorage}catch($a){}ti||(ti=void 0);var oi=new URLSearchParams("undefined"!==typeof location?location.search:""),ii=new Map;function ai(e,t){var r=function(e,t){var r,n,o,i=ii.get(e);if(void 0!==i)return i;o=void 0!==(r=function(e){var t=oi.get(e);return si(t)}(e))?r:void 0!==(n=function(e){var t,r=null===(t=ei)||void 0===t?void 0:t.getItem(e);return si(r)}(e))?n:t;return ii.set(e,o),o}(e,t);return r}function si(e){if(null!==e&&void 0!==e){var t=function(e,t,r){try{return JSON.parse(e,t)}catch(Ht){return void(r&&$o(r.logger,r.event,Ht))}}(e),r=void 0!==t?t:e;return"on"===r||"off"===r?"on"===r:r}}function ci(e,t,r,n){return r?r.getSetting(e,t,n):ai(e,t)}function ui(e){switch(e){case"Automation":return 0;case"Local":return 1;case"Staging":return 2;case"Dogfood":return 3;case"Preview":return 4;case"Microsoft":case"SyntheticTraffic":return 5;case"Production":return 6;case"GCC":return 7;case"GCC-High":case"DoD":return 8;default:return}}function li(e,t){return function(e,t,r){return ci(e,t,r,"FluidExperiences")}("optimizedDependencyContainer",function(e,t){var r=ui(e),n=ui(null!==t&&void 0!==t?t:"Production");return void 0!==r&&void 0!==n&&n<=r}("Local",null===t||void 0===t?void 0:t.audience),t)?new Qo(e):new Go(e)}var di=function(e){if(void 0!==e.hostLocaleContext)return{get InternationalizationContext(){return this},uiLocale:e.hostLocaleContext.uiLanguage,defaultContentDirection:e.hostLocaleContext.defaultContentDirection}},fi=function(e,t){var r;return t.audience?t:{get SettingsProvider(){return this},getSetting:function(e,r,n){return t.getSetting(e,r,n)},audience:null!==(r=e.environment)&&void 0!==r&&r.audience?e.environment.audience:"audience"in e?e.audience:"Production"}},hi=function(e){var t,r=e.userContext.user,n=null!==(t=null===r||void 0===r?void 0:r.id)&&void 0!==t?t:null===r||void 0===r?void 0:r.oid,o=function(e,t){return t||(function(e){var t=/(\{){0,1}[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}(\}){0,1}/g;return e&&!!e.match(t)}(e)?"UserObjectId":function(e){var t=/[1-2]{1}[0-9a-fA-F]{15}/g;return null===e||void 0===e?void 0:e.match(t)}(e)?"OrgIdPuid":void 0)}(n,null===r||void 0===r?void 0:r.userIdSpace);if(void 0!==r&&void 0!==n&&void 0!==o)return{get UserContext(){return this},user:{id:n,tenantId:r.tenantId,userIdSpace:o},displayName:e.userContext.displayName}};var pi=function(e,t){var r,n,o;return null!==t&&void 0!==t&&t.hostCorrelationId&&t.hostSessionId&&t.scenarioStartTime?t:{get TelemetryConfig(){return this},disallowServiceTelemetry:null===t||void 0===t?void 0:t.disallowServiceTelemetry,hostCorrelationId:null!==(r=null===t||void 0===t?void 0:t.hostCorrelationId)&&void 0!==r?r:e.hostCorrelationId,hostSessionId:null!==(n=null===t||void 0===t?void 0:t.hostSessionId)&&void 0!==n?n:e.hostSessionId,scenarioStartTime:null!==(o=null===t||void 0===t?void 0:t.scenarioStartTime)&&void 0!==o?o:e.hostScenarioStartTime}},vi=function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){var i,a,s,c,u,l,d,f,h,p;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===t||void 0===t?void 0:t.synthesize({SettingsProvider:"SettingsProvider"},void 0).SettingsProvider;case 2:if(i=e.sent,(a=li(t,i)).has("HostContext")){e.next=6;break}return e.abrupt("return",a);case 6:return s=a.synthesize({HostContext:"HostContext",SettingsProvider:"SettingsProvider",TelemetryConfig:"TelemetryConfig"},void 0),e.next=9,Promise.all([s.HostContext,s.SettingsProvider,s.TelemetryConfig]);case 9:return c=e.sent,u=(0,o.Z)(c,3),l=u[0],d=u[1],f=u[2],void 0!==l&&(a.has("InternationalizationContext")||void 0!==(h=di(l))&&a.register("InternationalizationContext",h),a.has("UserContext")||void 0!==(p=hi(l))&&a.register("UserContext",p),a.has("SettingsProvider")&&void 0!==d&&void 0===d.audience&&a.register("SettingsProvider",fi(l,d)),null!==f&&void 0!==f&&f.hostCorrelationId&&f.hostSessionId||a.register("TelemetryConfig",pi(l,f))),e.abrupt("return",a);case 16:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),gi=function(){function e(t){(0,u.Z)(this,e),this.props=t,t.logger&&(this.logger=new d.g("LoopLoader",t.logger))}return(0,c.Z)(e,[{key:"instantiateLoopComponent",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,o,i,a,s,c,u,l;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.props,o=r.loopCodeLoader,i=r.dependencySynthesizer,a=t.registrationId){e.next=4;break}throw new Error("registrationId is required.");case 4:return e.next=6,o.load({packageName:a});case 6:return s=e.sent,e.next=9,i.synthesize({SettingsProvider:"SettingsProvider"},void 0).SettingsProvider;case 9:return c=e.sent,u=zr(i,c),this.logger&&u.register("NamespaceLogger",this.logger),l="Data"===t.type?{creationData:t,manifestData:t.manifestData,componentPersistentInputData:t.componentPersistentInputData}:"Creation"===t.type?{creationData:{},manifestData:t.manifestData,componentPersistentInputData:t.componentPersistentInputData}:t,e.t0=s.module.loopExport,e.t1=l,e.t2=mi,e.next=18,vi(u,this.logger);case 18:return e.t3=e.sent,e.next=21,(0,e.t2)(e.t3);case 21:return e.t4=e.sent,e.abrupt("return",e.t0.instantiateLoopComponent.call(e.t0,e.t1,e.t4));case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function mi(e){return yi.apply(this,arguments)}function yi(){return(yi=(0,i.Z)((0,n.Z)().mark((function e(t){var r,o,i,a,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.has("HostContext")){e.next=2;break}return e.abrupt("return",t);case 2:return r=t.synthesize({HostContext:"HostContext"},void 0),e.next=5,r.HostContext;case 5:if(!(o=e.sent)){e.next=26;break}return e.t0=o.environment,e.t1=o.hostCorrelationId,e.t2=o.hostSessionId,e.t3=o.userContext,e.t4=o.hostLocaleContext,e.t5=void 0,e.t6=void 0,e.t7=void 0,e.t8=void 0,e.t9=void 0,e.t10=void 0,e.t11=void 0,i={get HostContext(){return this},environment:e.t0,hostCorrelationId:e.t1,hostSessionId:e.t2,userContext:e.t3,hostLocaleContext:e.t4,hostName:"",hostScenarioLifecycle:e.t5,hostScenarioEntryPoint:e.t6,hostScenarioName:e.t7,hostAppVersion:e.t8,hostScenarioStartTime:e.t9,hostPerformanceData:e.t10,hostAppName:"",hostAppPlatform:"",hostLoopContext:e.t11},e.next=22,t.synthesize({SettingsProvider:"SettingsProvider"},void 0).SettingsProvider;case 22:return a=e.sent,(s=zr(t,a)).register("HostContext",i),e.abrupt("return",s);case 26:return e.abrupt("return",t);case 27:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function bi(e,t,r,n,o){return ki.apply(this,arguments)}function ki(){return ki=(0,i.Z)((0,n.Z)().mark((function e(t,r,i,a,s){var c,u,l,d,f,h,p,v,g,m,y,b,k,S,C;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=t.environment,d={HostContext:"HostContext",InternationalizationContext:"InternationalizationContext",SettingsProvider:"SettingsProvider",TokenProvider:"TokenProvider",LoopTrustedTypesPolicy:"LoopTrustedTypesPolicy"},f=i.synthesize(d,void 0),e.next=5,Promise.all([f.HostContext,f.InternationalizationContext,f.SettingsProvider,f.TokenProvider,f.LoopTrustedTypesPolicy]);case 5:return h=e.sent,p=(0,o.Z)(h,5),v=p[0],g=p[1],m=p[2],y=p[3],b=p[4],k=null!==(c=null===g||void 0===g?void 0:g.uiLocale)&&void 0!==c?c:null===v||void 0===v||null===(u=v.hostLocaleContext)||void 0===u?void 0:u.uiLanguage,S=(0,w.Z)({audience:(null===l||void 0===l?void 0:l.audience)||"Production",localeHint:k||R,settingsProvider:m,windowContext:r,trustedTypesPolicy:b,tokenProvider:y,dependencySynthesizer:i},{logger:a}),e.next=16,s.instantiateLoopCodeLoader(S);case 16:return C=e.sent,e.abrupt("return",new gi({loopCodeLoader:C,dependencySynthesizer:i,logger:a}));case 18:case"end":return e.stop()}}),e)}))),ki.apply(this,arguments)}function Si(e){return Ci.apply(this,arguments)}function Ci(){return(Ci=(0,i.Z)((0,n.Z)().mark((function e(t){var r,o,i,a,s,c,u,l,d;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.loopComponentRouterInput,o=t.windowContextForLoader,i=t.dependencySynthesizer,a=t.config,s=t.logger,c=t.loopCodeLoaderFactory,u=t.requiredProviderTypes,e.next=3,bi(a,o,i,s,c);case 3:return l=e.sent,e.next=6,l.instantiateLoopComponent(r);case 6:if(d=e.sent,!u){e.next=9;break}return e.abrupt("return",Pe(d,u));case 9:return e.abrupt("return",d);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function wi(){return wi=(0,i.Z)((0,n.Z)().mark((function e(t){var r,o,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.dependencySynthesizer,o=r.synthesize({SettingsProvider:"SettingsProvider"},void 0),e.next=4,o.SettingsProvider;case 4:return i=e.sent,e.abrupt("return",Ro(i)?xi(t):Ei(t));case 6:case"end":return e.stop()}}),e)}))),wi.apply(this,arguments)}function xi(e){return Pi.apply(this,arguments)}function Pi(){return Pi=(0,i.Z)((0,n.Z)().mark((function e(t){var r,o,i,a,s,c,u,l,d,f,h,p,v,g;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.windowContextForLoader,o=t.loopComponentRouterInput,i=t.dependencySynthesizer,a=t.driver,s=t.urlResolver,c=t.config,u=void 0===c?{}:c,l=t.logger,d=t.perfMetadata,f=t.documentHiddenTrackerId,h=t.fluidRequestHeaders,p=t.loopCodeLoaderFactory,!o.registrationId||"fluid"===o.registrationId){e.next=8;break}if(p){e.next=4;break}throw new Error("loopCodeLoaderFactory is required for non-fluid components.");case 4:return v=Si({loopComponentRouterInput:o,windowContextForLoader:r,dependencySynthesizer:i,config:u,logger:l,loopCodeLoaderFactory:p}),e.abrupt("return",{component:v,container:Promise.resolve(void 0)});case 8:if("Data"!==o.type||o.dataType!==Ho.en){e.next=11;break}return g=qo(o,Zi({dependencySynthesizer:i,urlResolver:s})).then((function(e){if(!e)throw new Error("Failed to create Fluid component from the provided url.");return Bo({windowContextForLoader:r,driverFetcher:void 0,dependencySynthesizer:i,hostConfig:u,logger:l,perfMetadata:d,documentEverHiddenTrackerID:f,containerRequest:{url:o.data.url.href,headers:h},driver:a,preCheckInfo:e})})),e.abrupt("return",g);case 11:throw new Error("Failed to create component.");case 12:case"end":return e.stop()}}),e)}))),Pi.apply(this,arguments)}function Ei(e){var t=e.windowContextForLoader,r=e.loopComponentRouterInput,n=e.dependencySynthesizer,o=e.driver,i=e.urlResolver,a=e.config,s=void 0===a?{}:a,c=e.logger,u=e.perfMetadata,l=e.documentHiddenTrackerId,d=e.fluidRequestHeaders,f=e.loopCodeLoaderFactory;return qo(r,Zi({dependencySynthesizer:n,urlResolver:i})).then((function(e){var i;if(e&&"Data"===r.type&&r.dataType===Ho.en)i=Bo({windowContextForLoader:t,driverFetcher:void 0,dependencySynthesizer:n,hostConfig:s,logger:c,perfMetadata:u,documentEverHiddenTrackerID:l,containerRequest:{url:r.data.url.href,headers:d},driver:o,preCheckInfo:e});else{if(!f)throw new Error("loopCodeLoaderFactory is required for non-fluid components.");i={component:Si({loopComponentRouterInput:r,windowContextForLoader:t,dependencySynthesizer:n,config:s,logger:c,loopCodeLoaderFactory:f}),container:Promise.resolve(void 0)}}return i}))}function Zi(e){return Ti.apply(this,arguments)}function Ti(){return Ti=(0,i.Z)((0,n.Z)().mark((function e(t){var r,o,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.dependencySynthesizer,!(o=t.urlResolver)){e.next=3;break}return e.abrupt("return",o);case 3:return e.next=5,r.synthesize({DriverImplementation:"DriverImplementation"},void 0).DriverImplementation;case 5:return i=e.sent,e.abrupt("return",null===i||void 0===i?void 0:i.urlResolver);case 7:case"end":return e.stop()}}),e)}))),Ti.apply(this,arguments)}function Ni(e){var t=e.loopComponentRouterInput,r=e.dependencySynthesizer,o=e.documentServiceFactory,a=e.urlResolver,s=e.config,c=e.fluidRequestHeaders,u=e.loopCodeLoaderFactory,l=e.requiredProviderTypes,d=O(s||{}),f=d.logger,h=d.newConfig,p=d.perfMetadata,v=d.documentHiddenTrackerId;return function(e){var t=e.windowContextForLoader,r=e.loopComponentRouterInput,o=e.dependencySynthesizer,a=e.documentServiceFactory,s=e.urlResolver,c=e.config,u=e.logger,l=e.perfMetadata,d=e.documentHiddenTrackerId,f=e.requiredProviderTypes,h=a&&s?{documentServiceFactory:a,urlResolver:s}:void 0,p=(0,w.Z)({},c),v=E.a.start(D.s9,u,{addUserTiming:!0});if("Fluid"===r.type){if(null!==u&&void 0!==u&&u.PersistedProperties){var g={isFluid:!0};u.PersistedProperties.addPersistedProperties(g)}var m=x(r.codeDetails.package)?r.codeDetails.package.name:r.codeDetails.package;try{var y=Do(t,{dependencySynthesizer:o,codeDetails:r.codeDetails,loadTemplateProps:r.templateProps,requiredProviderTypes:f},h,void 0,p,u,l,d);return v.setResult(!0,{packageName:m}),y}catch(Ht){throw v.setResult(!1,{packageName:m},Ht),Ht}}var b=function(e){return wi.apply(this,arguments)}((0,w.Z)((0,w.Z)({},e),{},{driver:h,loopComponentRouterInput:r}));if(null!==u&&void 0!==u&&u.PersistedProperties){var k=r.registrationId,S="fluid"===k||!k?{isFluid:!0}:{isFluid:!1,loopRegistrationId:k};u.PersistedProperties.addPersistedProperties(S)}return{component:b.then((function(e){return e.component})).then(function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fi(t,v,o);case 2:return v.setResult(!0),u&&Di(t,"owh-getLoopComponentInternal",u),e.abrupt("return",f?Pe(t,f):t);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){throw v.setResult(!1,void 0,e),e})),container:b.then((function(e){return e.container})).catch((function(e){throw v.setResult(!1,void 0,e),e}))}}({windowContextForLoader:window,loopComponentRouterInput:t,dependencySynthesizer:r,documentServiceFactory:o,urlResolver:a,config:h,logger:f,perfMetadata:p,documentHiddenTrackerId:v,fluidRequestHeaders:c,loopCodeLoaderFactory:u,requiredProviderTypes:l})}function Fi(e,t,r){return Ii.apply(this,arguments)}function Ii(){return Ii=(0,i.Z)((0,n.Z)().mark((function e(t,r,o){var i,a,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((i=t).ComponentInitializer){e.next=3;break}return e.abrupt("return");case 3:return a=o.synthesize({SettingsProvider:"SettingsProvider"},void 0),e.next=6,a.SettingsProvider;case 6:if(s=e.sent,!Mo(s)){e.next=12;break}return r.markSubActivityStart("ComponentInitialize"),e.next=11,i.ComponentInitializer.initialize();case 11:r.markSubActivityEnd("ComponentInitialize");case 12:case"end":return e.stop()}}),e)}))),Ii.apply(this,arguments)}var Bi=new Set;function Di(e,t,r){var n;null===(n=e.ComponentMetadata)||void 0===n||null===(n=n.identityName)||void 0===n||n.then((function(e){Bi.has(e)||((0,l.ve)(r,{eventName:"LoadComponentMetadata",identityName:e,source:t}),Bi.add(e))})).catch((function(e){(0,l.uX)(r,{eventName:"LoadComponentMetadataLogError"},e)}))}function Ai(e){var t=O(e.config||{}),r=t.logger,n=t.newConfig,o=t.perfMetadata,i=t.documentHiddenTrackerId;return Do(window,e,e.urlResolver&&e.documentServiceFactory?{urlResolver:e.urlResolver,documentServiceFactory:e.documentServiceFactory}:void 0,void 0,n,r,o,i)}function Oi(e){var t=O(e.config||{}),r=t.logger,n=t.newConfig,o=t.perfMetadata,i=t.documentHiddenTrackerId;return function(e,t,r,n,o,i,a,s){_o(r,n,o,t.dependencySynthesizer);var c=r?Oo(e,{type:"DetachedFromSnapshot",snapshot:t.snapshot},r,void 0,t.dependencySynthesizer,o,i,a,s,t.requiredProviderTypes,void 0):Ao(e,{type:"DetachedFromSnapshot",snapshot:t.snapshot},n,void 0,t.dependencySynthesizer,o,i,a,s,t.requiredProviderTypes,void 0);return{component:c.componentPromise,container:c.containerPromise}}(window,e,e.urlResolver&&e.documentServiceFactory?{urlResolver:e.urlResolver,documentServiceFactory:e.documentServiceFactory}:void 0,void 0,n,r,o,i)}var Li=r(14423),_i=r(57115),Mi=r(72911),Ri=r(61960),Hi=r(72532),ji=r(52230),Ui=function(){function e(t,r){(0,u.Z)(this,e),this.container=void 0,this.isProvidingDataToSave=void 0,this.hasDataToSave=void 0,this.container=t,this.isProvidingDataToSave=!1,this.hasDataToSave=r}return(0,c.Z)(e,[{key:"startProvidingDataToSave",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(){var t=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isProvidingDataToSave){e.next=8;break}return(0,Ri.cM)("Will start providing data to save..."),(0,Hi.yF)((function(e){(0,Ri.cM)("RequestDataToSave event"),t.onDataToSaveRequest(e)})),(0,Hi.ot)((function(){(0,Ri.cM)("FluidComponentSaved event"),t.onFluidComponentDataSaved()})),e.next=6,(0,ji.lF)(!0);case 6:this.isProvidingDataToSave=!0,this.hasDataToSave||this.detectWhenFluidComponentIsEdited();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stopProvidingDataToSave",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isProvidingDataToSave){e.next=7;break}return(0,Ri.cM)("Will stop providing data to save..."),e.next=4,(0,ji.lF)(!1);case 4:(0,Hi.dd)(this.onDataToSaveRequest),(0,Hi.Hp)(this.onFluidComponentDataSaved),this.isProvidingDataToSave=!1;case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onDataToSaveRequest",value:function(e){var t,r=e.detail.requestId,n=!1,o="",i=(null===(t=this.container)||void 0===t?void 0:t.attachState)==_i.m.Attached;if(this.container)if(i)n=this.container.isDirty;else try{o=this.container.serialize(),n=o.length>0}catch(a){(0,v.w5)("DataToSaveProvider.onDataToSaveRequest()",new v.gz("Unable to get data to save from the container.",a))}(0,ji.qc)(r,i,n,o).then((function(){(0,Ri.cM)("Provided data to save. (Request: ".concat(r,", isAttached: ").concat(i,", hasDataToSave: ").concat(n,")"))})).catch((function(e){(0,Ri.H)("Unable to provide data to save. (Request: ".concat(r,") ").concat(e))}))}},{key:"onFluidComponentDataSaved",value:function(){(0,Ri.cM)("Fluid component was saved."),this.hasDataToSave=!1,this.detectWhenFluidComponentIsEdited()}},{key:"fluidComponentEdited",value:function(){this.hasDataToSave||((0,Ri.cM)("Fluid component was edited, so there is now data to save."),this.hasDataToSave=!0,(0,ji.oE)())}},{key:"detectWhenFluidComponentIsEdited",value:function(){var e=this,t=function t(r){r.defaultPrevented||(0,Mi.jc)(r)&&(document.removeEventListener("keydown",t),document.removeEventListener("mousedown",t),e.fluidComponentEdited())};document.addEventListener("keydown",t),document.addEventListener("mousedown",t)}}]),e}(),qi=r(13885),zi=r(82863),Yi=r(25178),Vi=function(){function e(t,r,n){(0,u.Z)(this,e),this.component=t,this.loopInfo=r,this.isFluidLoop=n,this.loopInfoChangedEventListeners=new Set,this.hasBeenUpdated=!1}return(0,c.Z)(e,[{key:"determineLinkText",value:function(e,t,r){return e?r?r+Li.Kh:t:r||t}},{key:"off",value:function(e,t){this.loopInfoChangedEventListeners.delete(t)}},{key:"on",value:function(e,t){this.loopInfoChangedEventListeners.add(t)}},{key:"onLinkUrlChanged",value:function(e){(0,Ri.cM)("Received native event LinkUrlChanged"),e!==this.loopInfo.linkUrl&&((0,Ri.cM)("Link url: ".concat(e)),this.loopInfo.linkUrl=e,this.onLoopInfoChanged({linkUrl:e}))}},{key:"onLoopInfoChanged",value:function(e){Object.keys(e).length&&(this.loopInfoChangedEventListeners.forEach((function(t){t(new CustomEvent("LoopInfoChanged",{detail:e}))})),(0,ji.Dt)(e))}},{key:"onTitleChanged",value:function(e){var t={};(0,Ri.cM)("LoopComponentProperties.onTitleChanged() called."),e&&e!==this.loopInfo.loopTitle&&((0,Ri.cM)("Loop title: ".concat(e)),this.loopInfo.loopTitle=e,t.loopTitle=e);var r=this.determineLinkText(this.isFluidLoop,this.loopInfo.loopName,this.loopInfo.loopTitle);r&&r!==this.loopInfo.linkText&&((0,Ri.cM)("Link text: ".concat(r)),this.loopInfo.linkText=r,t.linkText=r),this.onLoopInfoChanged(t)}},{key:"updateFluidFilename",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(){var t,r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isFluidLoop&&this.loopInfo.linkUrl){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,Yi.bY)(this.loopInfo.linkUrl,this.loopInfo.linkText||null);case 4:t=e.sent,r=(0,Yi.ed)(t||""),this.onTitleChanged(r);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"update",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(){var t,r,o,i,a,s,c,u,l,d,f,h,p=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.component.ComponentProperties,r=this.component.ComponentTitle,o=this.component.ComponentWithTitle,i=this.component.ContentURL,a={},!i){e.next=16;break}return e.prev=6,e.next=9,i.getContentURL();case 9:(s=e.sent).href&&s.href!==this.loopInfo.linkUrl&&((0,Ri.cM)("Link url: ".concat(s.href)),this.loopInfo.linkUrl=s.href,a.linkUrl=s.href),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(6),(0,Ri.H)("Unable to get the content url for the Loop component.");case 16:if(!t){e.next=43;break}if(e.prev=17,e.t1=t.iconUrl,e.t1){e.next=23;break}return e.next=22,null===(c=t.getIconUrl)||void 0===c?void 0:c.call(t);case 22:e.t1=e.sent;case 23:(u=e.t1)&&u!==this.loopInfo.loopIconUrl&&((0,Ri.cM)("Loop icon url: ".concat(u)),this.loopInfo.loopIconUrl=u,a.loopIconUrl=u),e.next=30;break;case 27:e.prev=27,e.t2=e.catch(17),(0,Ri.H)("Unable to get the icon url of the Loop component.");case 30:if(e.prev=30,e.t3=t.name,e.t3){e.next=36;break}return e.next=35,null===(l=t.getName)||void 0===l?void 0:l.call(t);case 35:e.t3=e.sent;case 36:(d=e.t3)&&d!==this.loopInfo.loopName&&((0,Ri.cM)("Loop name: ".concat(d)),this.loopInfo.loopName=d,a.loopName=d),e.next=43;break;case 40:e.prev=40,e.t4=e.catch(30),(0,Ri.H)("Unable to get the name of the Loop component.");case 43:if(!r&&!o){e.next=59;break}if(void 0===r&&((0,Ri.cM)("Component does not provide ComponentTitle."),o&&(0,Ri.cM)("Using ComponentWithTitle instead.")),this.isFluidLoop){e.next=59;break}if(e.prev=46,e.t5=null===r||void 0===r?void 0:r.title,e.t5){e.next=52;break}return e.next=51,null===o||void 0===o?void 0:o.getTitleText();case 51:e.t5=e.sent;case 52:(f=e.t5)&&f!==this.loopInfo.loopTitle&&((0,Ri.cM)("Loop title: ".concat(f)),this.loopInfo.loopTitle=f,a.loopTitle=f),e.next=59;break;case 56:e.prev=56,e.t6=e.catch(46),(0,Ri.H)("Unable to get the title of the Loop component.");case 59:(h=this.determineLinkText(this.isFluidLoop,this.loopInfo.loopName,this.loopInfo.loopTitle))&&h!==this.loopInfo.linkText&&((0,Ri.cM)("Link text: ".concat(h)),this.loopInfo.linkText=h,a.linkText=h),this.onLoopInfoChanged(a),this.hasBeenUpdated||((0,zi.Qj)(this.onLinkUrlChanged.bind(this)),null===r||void 0===r||r.on("titleChanged",(function(e){(0,Ri.cM)("Received event ComponentTitle.titleChanged"),p.onTitleChanged(e)}))),this.hasBeenUpdated=!0;case 64:case"end":return e.stop()}}),e,this,[[6,13],[17,27],[30,40],[46,56]])})));return function(){return e.apply(this,arguments)}}()}]),e}(),Gi=r(55477),Wi=r(78832),Ji=r(49069),Ki=r(75757),Qi=function(e){return e[e.Success=0]="Success",e[e.Failure=1]="Failure",e}({}),Xi=function(e){(0,be.Z)(r,e);var t=(0,ke.Z)(r);function r(e){var n;return(0,u.Z)(this,r),(n=t.call(this,"CreateDocument",e)).AttachDocumentPerfTracker=void 0,n.CreateDocumentPerfTracker=void 0,n.setAttachDocumentPerfTracker(),n}return(0,c.Z)(r,[{key:"setAttachDocumentPerfTracker",value:function(){var e=Ki.g.startNew();this.AttachDocumentPerfTracker=e}},{key:"setCreateDocumentPerfTracker",value:function(){var e=Ki.g.startNew();this.CreateDocumentPerfTracker=e}},{key:"sendTelemetryForSuccess",value:function(){this.endActivity(!0,Qi.Success)}},{key:"sendTelemetryForFailure",value:function(e){this.endActivity(!1,e)}},{key:"addDataFieldsToActivity",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){var o,i,a,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(null===(o=this.AttachDocumentPerfTracker)||void 0===o?void 0:o.startTime)&&this.addInt64DataField("AttachDocumentStartTime",this.AttachDocumentPerfTracker.startTime),(null===(i=this.AttachDocumentPerfTracker)||void 0===i?void 0:i.getDuration)&&this.addInt64DataField("AttachDocumentDuration",this.AttachDocumentPerfTracker.getDuration()),this.AttachDocumentPerfTracker&&this.addBooleanDataField("AttachDocumentSuccess",this.AttachDocumentPerfTracker.isSuccess),(null===(a=this.CreateDocumentPerfTracker)||void 0===a?void 0:a.startTime)&&this.addInt64DataField("CreateDocumentStartTime",this.CreateDocumentPerfTracker.startTime),(null===(s=this.CreateDocumentPerfTracker)||void 0===s?void 0:s.getDuration)&&this.addInt64DataField("CreateDocumentDuration",this.CreateDocumentPerfTracker.getDuration()),this.CreateDocumentPerfTracker&&this.addBooleanDataField("CreateDocumentSuccess",this.CreateDocumentPerfTracker.isSuccess),this.addStringDataField("ResultType",Qi[t]),r&&this.addStringDataField("ErrorMessage",r);case 8:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()}]),r}(Ji.D),$i=r(6232),ea=r(72278),ta=r(84456),ra=r(30408);function na(e){return new Promise((function(t){return setTimeout((function(){return t()}),e)}))}function oa(e){return function(t){return e}}function ia(e,t,r){return aa(e,[],t,r)}function aa(e,t,r,n){var o,i=[e(t.length).then((function(e){return o=e,!1}))];return n&&n.timeoutMs>0&&i.push(na(n.timeoutMs).then((function(){return!0}))),Promise.race(i).then((function(i){return i&&(o=null===n||void 0===n?void 0:n.onTimeout()),!r||!r.filter(o)||t.length>=r.maxRetries?{result:o,tries:t}:na(r.backoffFn(t.length)).then((function(){return t.push(o),aa(e,t,r,n)}))}))}function sa(e){return function(t){return t&&e.includes(t.status)}}function ca(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return ia((function(){var r=performance.now();return fetch(e,t).then((function(e){var t=e;return t.durationMs=Math.round(performance.now()-r),t})).catch((function(e){return{status:window.navigator.onLine?710:709,ok:!1,durationMs:Math.round(performance.now()-r)}}))}),r,{timeoutMs:n,onTimeout:function(){return{status:707,ok:!1,durationMs:n}}})}var ua=function(e,t,r){var n=3;return function o(){return la(e,t,r).catch((function(){return 0===(n-=1)?la(e,t,r):o()}))}()};function la(e,t,r){return da.apply(this,arguments)}function da(){return(da=(0,i.Z)((0,n.Z)().mark((function e(t,r,o){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var i,a,s=t.document,c=s.createElement("script"),u=null!==(i=null===o||void 0===o||null===(a=o.trustedTypesPolicy)||void 0===a?void 0:a.createScriptURL(r,{allowedScriptOrigins:o.allowedOrigins}))&&void 0!==i?i:r;c.src=u,c.async=!1,c.charset="utf-8",c.crossOrigin="anonymous",c.onload=e,c.onerror=function(){return n(new Error("Failed to download the script at url: ".concat(r,", isUserOnline: ").concat(t.navigator.onLine)))},s.head.appendChild(c)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var fa=function(){function e(t){(0,u.Z)(this,e),this.audience=t.audience,this.windowContext=t.windowContext,this.trustedTypesPolicy=t.trustedTypesPolicy}return(0,c.Z)(e,[{key:"canLoad",value:function(e){return e.packageName===ra.E}},{key:"load",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,o,i,a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canLoad(t)){e.next=2;break}throw new Error("Incompatible loop code details.");case 2:return e.next=4,this.determineCdnUrl();case 4:if(r=e.sent,o=["https://cdn.forms.office.net"],e.t0=this.trustedTypesPolicy,!e.t0){e.next=13;break}return e.next=10,this.trustedTypesPolicy;case 10:e.t1=e.sent,e.t2=o,e.t0={trustedTypesPolicy:e.t1,allowedOrigins:e.t2};case 13:return i=e.t0,e.next=16,ua(this.windowContext,r,i);case 16:if(a=this.windowContext[ra.E]){e.next=19;break}throw new Error("Could not fetch loop module from the window object.");case 19:return e.abrupt("return",{module:a,details:t});case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"determineCdnUrl",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(){var t,r,o,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.getTargetEnvironment(),r="https://cdn.forms.office.net/forms/loop/formsCodeLoaderDetails-".concat(t,".json?r=").concat((0,Ie.Z)()),e.next=4,ca(r,{method:"GET"},{maxRetries:3,filter:sa([500,599]),backoffFn:oa(500)});case 4:if((o=e.sent).result.ok&&200===o.result.status){e.next=7;break}throw new Error("Failed to fetch ".concat(r));case 7:return e.next=9,o.result.json();case 9:return i=e.sent,e.abrupt("return",i.codeLoaderFile);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getTargetEnvironment",value:function(){switch(this.audience){case"Automation":case"SyntheticTraffic":case"Local":case"Staging":return"staging";case"Dogfood":return"df";case"Microsoft":return"msft";default:return"prod"}}}]),e}(),ha={instantiateLoopCodeLoader:function(e){return Promise.resolve(new fa(e))}},pa=r(80565);function va(e){return ga.apply(this,arguments)}function ga(){return(ga=(0,i.Z)((0,n.Z)().mark((function e(t){var r,o,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next=e.t0===ea.E?3:e.t0===ra.E?10:e.t0===ta.Ey?12:17;break;case 3:return e.next=5,(0,pa.sr)();case 5:return o=e.sent,e.next=8,o.getCodeLoaderFactory();case 8:return r=e.sent,e.abrupt("break",17);case 10:return r=ha,e.abrupt("break",17);case 12:return e.next=14,(0,pa.iF)();case 14:return i=e.sent,r=i.getNpmCodeLoader(),e.abrupt("break",17);case 17:return e.abrupt("return",r);case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ma(e,t,r,n,o){return ya.apply(this,arguments)}function ya(){return ya=(0,i.Z)((0,n.Z)().mark((function e(t,r,o,i,a){var s,c,u,l,d,f,h,p;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=a?S.L.startActivity(a,C.a.GetDriveInfo):void 0,u=(0,g.dT)(g.SZ.OEP,"FluidHost.AttachDelay",0),e.next=4,(0,Gi.cM)().catch((function(e){var t;throw null===(t=i.AttachDocumentPerfTracker)||void 0===t||t.setFailure(e),null===c||void 0===c||c.setFailure(e),new Error("Unable to get driver info.")}));case 4:return l=e.sent,null===c||void 0===c||c.setSuccess(),e.next=8,r.catch((function(e){var t;throw null===(t=i.AttachDocumentPerfTracker)||void 0===t||t.setFailure(e),new Error("Unable to get special folder name.")}));case 8:return d=e.sent,f=k(l.siteUrl,l.id,d,o),h=a?S.L.startActivity(a,C.a.AttachContainer):void 0,e.next=13,u;case 13:if(!((p=e.sent)>0)){e.next=17;break}return e.next=17,(0,Wi._)(p);case 17:return e.next=19,t.attach(f).catch((function(e){var r;throw t.close(),null===(r=i.AttachDocumentPerfTracker)||void 0===r||r.setFailure(e),null===h||void 0===h||h.setFailure(e),new Error("Unable to attach document.")}));case 19:null===(s=i.AttachDocumentPerfTracker)||void 0===s||s.setSuccess(),null===h||void 0===h||h.setSuccess();case 21:case"end":return e.stop()}}),e)}))),ya.apply(this,arguments)}function ba(e,t,r,n,o,i){return ka.apply(this,arguments)}function ka(){return(ka=(0,i.Z)((0,n.Z)().mark((function e(t,r,o,i,a,s){var c,u,l,d,f,h,p;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,Ri.cM)("Attaching document to container..."),c=new Xi(s||""),e.next=4,ma(r,o,i,c,a);case 4:return(0,Ri.cM)("Document attached."),c.setCreateDocumentPerfTracker(),e.prev=6,e.next=9,La(t,r,c,a);case 9:return u=e.sent,l="",e.prev=11,e.next=14,(0,Gi.xv)(new URL(u));case 14:l=e.sent,e.next=20;break;case 17:e.prev=17,e.t0=e.catch(11),(0,Ri.H)("Unable to get file name from Sharepoint.");case 20:return l||(l=i),(0,Ri.cM)('Document created.\nFile name: "'.concat(l,'"\nUrl: ').concat(u)),e.next=24,(0,g.$G)();case 24:if(!e.sent){e.next=33;break}return d=new Vi(t,{linkText:l,linkUrl:u},!0),e.next=29,d.update();case 29:return f={loopComponentProperties:d,createDocumentActivity:c},e.abrupt("return",f);case 33:return h={url:u,linkText:l,createDocumentActivity:c},e.abrupt("return",h);case 35:e.next=41;break;case 37:throw e.prev=37,e.t1=e.catch(6),null===c||void 0===c||null===(p=c.CreateDocumentPerfTracker)||void 0===p||p.setFailure(e.t1),new Error("Unable to create document.");case 41:case"end":return e.stop()}}),e,null,[[6,37],[11,17]])})))).apply(this,arguments)}function Sa(e,t,r,n,o,i,a,s,c,u){return Ca.apply(this,arguments)}function Ca(){return Ca=(0,i.Z)((0,n.Z)().mark((function e(t,r,a,s,c,u,l,d,f,h){var p,m,y,b,k,S,C,w,x,P,E,Z,T,N,F,I,B,D,A,O,L,_,M,R,H;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y=Za(t),e.t0=!y,e.t0){e.next=6;break}return e.next=5,(0,g.p)();case 5:e.t0=e.sent;case 6:return b=e.t0,e.next=9,g.UG;case 9:return k=e.sent,e.next=12,(0,g.$G)();case 12:if(S=e.sent,!t){e.next=34;break}if(w=c.environment,x=null===(C=l.hostLocaleContext)||void 0===C?void 0:C.uiLanguage,!b){e.next=28;break}return(0,Ri.cM)("Creating Loop component..."),P=Ta(t),e.next=21,Na(t,w,x,P,h);case 21:return E=e.sent,e.next=24,va(P);case 24:Z=e.sent,m=Ni(k?{config:c,dependencySynthesizer:f,hostContext:l,loopCodeLoaderFactory:Z,loopComponentRouterInput:E}:{config:c,dependencySynthesizer:f,documentServiceFactory:u,hostContext:l,loopCodeLoaderFactory:Z,loopComponentRouterInput:E,urlResolver:d}),e.next=32;break;case 28:return e.next=30,Da(t,w,x,h);case 30:T=e.sent,m=Ai(k?{codeDetails:T.codeDetails,config:c,dependencySynthesizer:f,hostContext:l}:{codeDetails:T.codeDetails,config:c,dependencySynthesizer:f,documentServiceFactory:u,hostContext:l,urlResolver:d});case 32:e.next=38;break;case 34:return e.next=36,Ra();case 36:N=e.sent,m=Oi(k?{config:c,dependencySynthesizer:f,hostContext:l,snapshot:N}:{config:c,dependencySynthesizer:f,documentServiceFactory:u,hostContext:l,snapshot:N,urlResolver:d});case 38:return e.next=40,Promise.all([m.component,m.container]);case 40:if(F=e.sent,I=(0,o.Z)(F,2),B=I[0],D=I[1],void 0,A=null===D||void 0===D?void 0:D.getSpecifiedCodeDetails(),L=void 0,void 0!==B){e.next=48;break}throw new v.gz("Unable to create Fluid component. The component is undefined.");case 48:if(!y){e.next=64;break}if(D){e.next=53;break}O=Promise.reject(new v.gz("Unable to attach Fluid component. The container is undefined.")),e.next=62;break;case 53:return e.next=55,(0,qi.p)();case 55:_=e.sent,M=_.NewLoopComponentFileName,R=Ma(a.trim()||M,A),O=ba(B,D,r,R,h,s),(L=new Ui(D,!!t)).startProvidingDataToSave().catch((function(){(0,v.w5)("createFluidComponent()",new v.gz("Unable to start providing data to save."))}));case 62:e.next=65;break;case 64:O=S?wa(B):Pa(B,t);case 65:return null===(p=O)||void 0===p||p.then(function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null===(r=L)||void 0===r||r.stopProvidingDataToSave(),S?t.loopComponentProperties&&(0,ji.xF)(t.loopComponentProperties.loopInfo.linkUrl||"",t.loopComponentProperties.loopInfo.linkText||""):t.url&&t.linkText&&(0,ji.xF)(t.url,t.linkText);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),H={component:B,container:D,createDocumentPromise:O,loadedInfoPromise:Promise.resolve({component:Promise.resolve(B),container:Promise.resolve(D)})},e.abrupt("return",H);case 68:case"end":return e.stop()}}),e)}))),Ca.apply(this,arguments)}function wa(e){return xa.apply(this,arguments)}function xa(){return(xa=(0,i.Z)((0,n.Z)().mark((function e(t){var r,o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!1,r=new Vi(t,{},false),e.next=5,r.update();case 5:return o={loopComponentProperties:r},e.abrupt("return",o);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Pa(e,t){return Ea.apply(this,arguments)}function Ea(){return(Ea=(0,i.Z)((0,n.Z)().mark((function e(t,r){var o,i,a,s,c,u,l;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,null===(a=t.ContentURL)||void 0===a?void 0:a.getContentURL();case 3:c=e.sent,o=null!==(s=null===c||void 0===c?void 0:c.href)&&void 0!==s?s:"",e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),(0,Ri.H)("Unable to get the content url for the Loop component."),o="";case 11:return e.prev=11,e.next=14,null===(u=t.ComponentWithTitle)||void 0===u?void 0:u.getTitleText();case 14:i=e.sent,e.next=21;break;case 17:e.prev=17,e.t1=e.catch(11),i="Loop component",(0,Ri.H)("Unable to get the title for the Loop component.");case 21:return i||(i=r===Li.VP?"Poll":"Loop component"),l={linkText:i,url:o},e.abrupt("return",l);case 24:case"end":return e.stop()}}),e,null,[[0,7],[11,17]])})))).apply(this,arguments)}function Za(e){return e!==Li.VP}function Ta(e){return e===Li.VP?"@ms/forms-loop":""}function Na(e,t,r,n,o){return Fa.apply(this,arguments)}function Fa(){return(Fa=(0,i.Z)((0,n.Z)().mark((function e(t,r,o,i,a){var s,c,u;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!i||"@ms/office-fluid-container"==i)){e.next=9;break}return e.next=4,Da(t,r,o,a);case 4:return s=e.sent,c={type:"Fluid",codeDetails:s.codeDetails},e.abrupt("return",c);case 9:return u={type:"Creation",registrationId:i},e.abrupt("return",u);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ia(e,t,r){return Ba.apply(this,arguments)}function Ba(){return(Ba=(0,i.Z)((0,n.Z)().mark((function e(t,r,o){var i,a,s,c,u;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i="containerManifests",e.next=3,(0,g.UT)(g.SZ.OEP,"FluidHost.CacheContainerManifestEntries");case 3:return a=e.sent,e.next=6,(0,g.UT)(g.SZ.OEP,"FluidHost.ManifestUpgradeParameter");case 6:if(s=e.sent,c=s?uo(r,t,o,!0):uo(r,t,o),!a){e.next=20;break}if(c.then((function(e){localStorage.setItem(i,JSON.stringify(e))})).catch((function(e){(0,v.w5)("fetchAndCacheContainerManifestEntries()",new v.gz("failed to fetch container manifest.",e))})),!(u=localStorage.getItem(i))){e.next=20;break}return e.prev=12,e.abrupt("return",JSON.parse(u));case 16:e.prev=16,e.t0=e.catch(12),(0,v.w5)("fetchAndCacheContainerManifestEntries()",new v.gz("cannot parse from cache.",e.t0)),localStorage.removeItem(i);case 20:return e.abrupt("return",c);case 21:case"end":return e.stop()}}),e,null,[[12,16]])})))).apply(this,arguments)}function Da(e,t,r,n){return Aa.apply(this,arguments)}function Aa(){return(Aa=(0,i.Z)((0,n.Z)().mark((function e(t,r,o,i){var a,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ia(r,o,i);case 2:if(0!=(a=e.sent).length){e.next=9;break}return e.next=6,(0,g.UT)(g.SZ.OEP,"FluidHost.UseEmptyManifestHydrateResult");case 6:if(!e.sent){e.next=9;break}throw new v.gz("failed to get any manifests",void 0,$i.l.ExpectedError_FluidHostWebApp_CannotFetchContainerManifest);case 9:if((s=Oa(a,t))||(s=Oa(a,"FFX-Paragraph"),(0,v.w5)("createFluidComponent()",new v.gz('No container manifest entry with id "'.concat(t,'".')))),s){e.next=13;break}throw new v.gz("Unable to create a Fluid component of type: ".concat(t,". There is no container manifest entry for this type."));case 13:return e.abrupt("return",s);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Oa(e,t){return e.find((function(e){var r;return(null===e||void 0===e||null===(r=e.queryableData)||void 0===r?void 0:r.id)==t}))}function La(e,t,r,n){return _a.apply(this,arguments)}function _a(){return _a=(0,i.Z)((0,n.Z)().mark((function e(t,r,o,i){var a,s,c,u,l,d,f;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=null===t||void 0===t?void 0:t.IFluidLoadable,c=(null===s||void 0===s?void 0:s.handle.absolutePath)||"/",u=i?S.L.startActivity(i,C.a.GetFileLink):void 0,e.next=5,r.getAbsoluteUrl(c).catch((function(e){var t;throw r.close(),null===(t=o.CreateDocumentPerfTracker)||void 0===t||t.setFailure(e),null===u||void 0===u||u.setFailure(e),new Error("Unable to get the url of the new Fluid component. ".concat((0,v.e$)(e)))}));case 5:if(l=e.sent){e.next=12;break}throw r.close(),f=new Error("Unable to get the absolute url from the container."),null===u||void 0===u||u.setFailure(f),null===(d=o.CreateDocumentPerfTracker)||void 0===d||d.setFailure(f),f;case 12:return null===(a=o.CreateDocumentPerfTracker)||void 0===a||a.setSuccess(),null===u||void 0===u||u.setSuccess(),e.abrupt("return",l);case 15:case"end":return e.stop()}}),e)}))),_a.apply(this,arguments)}function Ma(e,t){var r=e.replace(/[~#%&*{}\\:<>?/+|".]/g,"").trim();return t?function(e,t,r){var n=vo(e);return"".concat(t,"@ms/whiteboard-container"===n?".whiteboard":r?".fluid":".loop")}(t,r):((0,v.w5)("toFullSharepointFileName()",new v.gz("Using default extension since no code details provided.")),"".concat(r,".fluid"))}function Ra(){return Ha.apply(this,arguments)}function Ha(){return(Ha=(0,i.Z)((0,n.Z)().mark((function e(){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,ji.l_)();case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ja(e){var t=e.dependencySynthesizer,r=e.documentServiceFactory,n=e.urlResolver,o=e.containerRequest,i=e.preCheckInfo,a=e.config,s=e.requiredProviderTypes,c=O(a||{}),u=c.logger,l=c.newConfig,d=c.perfMetadata,f=c.documentHiddenTrackerId;return Bo({windowContextForLoader:window,driverFetcher:void 0,dependencySynthesizer:t,hostConfig:l,logger:u,perfMetadata:d,documentEverHiddenTrackerID:f,containerRequest:o,driver:r&&n?{documentServiceFactory:r,urlResolver:n}:void 0,preCheckInfo:i,requiredProviderTypes:s})}function Ua(e,t,r,n,o,i,a){return qa.apply(this,arguments)}function qa(){return qa=(0,i.Z)((0,n.Z)().mark((function e(t,r,o,i,a,s,c){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.UG;case 2:if(!e.sent){e.next=7;break}return e.abrupt("return",ja({hostContext:r,config:t,containerRequest:o,preCheckInfo:s,dependencySynthesizer:c}));case 7:return e.abrupt("return",ja({hostContext:r,config:t,containerRequest:o,documentServiceFactory:i,preCheckInfo:s,urlResolver:a,dependencySynthesizer:c}));case 8:case"end":return e.stop()}}),e)}))),qa.apply(this,arguments)}function za(e,t,r,n,o,i){return Ya.apply(this,arguments)}function Ya(){return Ya=(0,i.Z)((0,n.Z)().mark((function e(t,r,o,i,a,s){var c;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,Ri.cM)("Loading Loop component..."),e.next=3,va(a.registrationId);case 3:return c=e.sent,e.next=6,g.UG;case 6:if(!e.sent){e.next=11;break}return e.abrupt("return",Ni({config:t,dependencySynthesizer:r,hostContext:i,loopCodeLoaderFactory:c,loopComponentRouterInput:a}));case 11:return e.abrupt("return",Ni({config:t,dependencySynthesizer:r,documentServiceFactory:o,hostContext:i,loopCodeLoaderFactory:c,loopComponentRouterInput:a,urlResolver:s}));case 12:case"end":return e.stop()}}),e)}))),Ya.apply(this,arguments)}var Va=void 0;function Ga(e){var t,r;if(e.linkUrl)try{t=new URL(e.linkUrl)}catch(o){throw new v.gz("LoopInfo.loopLinkUrl is not a valid URL.")}if(e.manifestData)try{r=JSON.parse(e.manifestData)}catch(o){throw new v.gz("Manifest data is not valid JSON.",o)}if(e.loopData){if(e.registrationId===ea.E){var n;try{n=JSON.parse(e.loopData)}catch(o){throw new v.gz("Loop data is not valid JSON.",o)}return{type:"Data",dataType:"Card",data:n,manifestData:r,registrationId:e.registrationId}}throw new v.gz("Cannot provide loop data for registration id: ".concat(e.registrationId))}if(!t)throw new v.gz("A url is required.");return{type:"Data",dataType:"URL",data:{url:t},manifestData:r,registrationId:"@fluidx/office-fluid-container"==e.registrationId?void 0:e.registrationId}}function Wa(e,t,r,n,o,i,a,s,c,u,l,d,f){return Ja.apply(this,arguments)}function Ja(){return Ja=(0,i.Z)((0,n.Z)().mark((function e(t,r,i,a,s,c,u,l,d,f,h,v,m){var y,b,k,S,C,w,x,P,E,Z,T,N,F,I,B,D;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}return e.next=3,Sa(r,i,a,l,c,f,u,h,v,m);case 3:return e.abrupt("return",e.sent);case 6:return e.next=8,(0,g.p)();case 8:return b=e.sent,e.next=11,(0,g.$G)();case 11:if(k=e.sent,S=!s.registrationId||"@fluidx/office-fluid-container"===s.registrationId,!b){e.next=18;break}C=Ga(s),y=za(c,v,f,u,C,h),e.next=24;break;case 18:return e.next=20,Ka(d.url);case 20:Va=e.sent,y=Ua(c,u,d,f,h,Va,v),null===(w=new p(m))||void 0===w||w.registerSessionEndingErrorObserver(y);case 24:return x=(0,g.VS)(),e.next=27,y;case 27:return P=e.sent,e.next=30,Promise.all([P.container,P.component]);case 30:return E=e.sent,Z=(0,o.Z)(E,2),T=Z[0],N=Z[1],e.next=36,x;case 36:if(!e.sent){e.next=39;break}null===(I=N)||void 0===I||null===(F=I.EmbedCardData)||void 0===F||F.getData().then((function(e){var t=JSON.stringify(e);(0,ji.AZ)(t),(0,Ri.cM)("Saved embedded data: ".concat(t))}));case 39:if(!k){e.next=44;break}return B=new Vi(N,s,S),e.next=43,B.update();case 43:B.updateFluidFilename();case 44:return D={component:N,container:T,loadedInfoPromise:y,loopComponentProperties:B},e.abrupt("return",D);case 46:case"end":return e.stop()}}),e)}))),Ja.apply(this,arguments)}function Ka(e){return Qa.apply(this,arguments)}function Qa(){return Qa=(0,i.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s(new URL(t)),e.abrupt("return",r||{});case 2:case"end":return e.stop()}}),e)}))),Qa.apply(this,arguments)}},62908:function(e,t,r){"use strict";var n;r.d(t,{u:function(){return f.u},td:function(){return i.td},C1:function(){return n},q0:function(){return y},_6:function(){return i._6},xO:function(){return o.x},Dg:function(){return b}}),function(e){e.genericError="genericError",e.genericNetworkError="genericNetworkError",e.authorizationError="authorizationError",e.fileNotFoundOrAccessDeniedError="fileNotFoundOrAccessDeniedError",e.throttlingError="throttlingError",e.offlineError="offlineError",e.unsupportedClientProtocolVersion="unsupportedClientProtocolVersion",e.writeError="writeError",e.fetchFailure="fetchFailure",e.fetchTokenError="fetchTokenError",e.incorrectServerResponse="incorrectServerResponse",e.fileOverwrittenInStorage="fileOverwrittenInStorage",e.deltaStreamConnectionForbidden="deltaStreamConnectionForbidden",e.locationRedirection="locationRedirection",e.fluidInvalidSchema="fluidInvalidSchema",e.usageError="usageError",e.fileIsLocked="fileIsLocked"}(n||(n={}));var o=r(20427),i=r(10889),a=r(14034),s=r(38020),c=r(81268),u=r(17246),l=r(61960),d=r(25178),f=r(90142),h=r(4972),p=r(49395),v=r(94815),g=r(14423),m=r(62190),y="unknownError";function b(e,t,r){var n,o,i;if(e instanceof m.gz)o=e.hydrateResult;else{var f=function(e){return(0,a.B3)(e)||(0,s.hh)(e)||(0,c.ds)(e)||(0,u.ep)(e)}(e);o=(0,v.W)(f)}((0,l.H)("Unable to load the Fluid container or component. ".concat(e)),null===(n=r.LoadPerfTracker)||void 0===n||n.setFailure(e),r.sendTelemetryForFailure(h.D.LoadComponentError,o,e),(0,p.m)(),t)&&(null===(i=document.getElementById(g.Rp))||void 0===i||i.focus());d.VW&&(d.VW.notify=!0)}},25178:function(e,t,r){"use strict";r.d(t,{_N:function(){return De},To:function(){return Oe},tl:function(){return Re},bY:function(){return Le},vg:function(){return Ie},ed:function(){return Te},Wp:function(){return Ae},kO:function(){return Fe},Rn:function(){return Me},VW:function(){return ke},DT:function(){return Ee},ls:function(){return Ne}});var n=r(74165),o=r(29439),i=r(37762),a=r(93433),s=r(15861),c=r(53313),u=r(73284),l=r(15671),d=r(43144),f=r(60136),h=r(29388),p=r(47465),v=r(15555),g="sans-serif",m="Segoe UI",y="Segoe UI Emoji",b=r(72858),k=r(47699),S=m+", "+y+", "+g,C="var(".concat(k.xE.BodyTextChecked,", var(").concat(k.xE.BodyText,", ").concat(b.cG.Neutral.neutralPrimary,"))"),w=[["Heading 1",[{name:"fontFamily",cssPropertyName:"font-family",value:{customPropertyName:k.W2.FontFamilyHeading1,fallbackValue:S}},{name:"fontSize",cssPropertyName:"font-size",value:{customPropertyName:k.W2.FontSizeHeading1,fallbackValue:"24px"}},{name:"fontWeight",cssPropertyName:"font-weight",value:{customPropertyName:k.W2.FontWeightHeading1,fallbackValue:"700"}},{name:"color",cssPropertyName:"color",value:{customPropertyName:k.Yf.HeadingText,fallbackValue:C}},{name:"marginTop",cssPropertyName:"margin-top",value:{customPropertyName:k.nm.MarginTopHeading1}},{name:"lineHeight",cssPropertyName:"line-height",value:{customPropertyName:k.nm.LineHeightHeading1,fallbackValue:"normal"}},{name:"role",cssPropertyName:"role",value:"heading"},{name:"ariaLevel",cssPropertyName:"aria-level",value:"1"},{name:"outline",cssPropertyName:"outline",value:{customPropertyName:k.nm.OutlineHeading1}},{name:"backgroundColor",cssPropertyName:"background-color",value:{customPropertyName:k.xE.BodyBackground,fallbackValue:"transparent"}}]],["Heading 2",[{name:"fontFamily",cssPropertyName:"font-family",value:{customPropertyName:k.W2.FontFamilyHeading2,fallbackValue:S}},{name:"fontSize",cssPropertyName:"font-size",value:{customPropertyName:k.W2.FontSizeHeading2,fallbackValue:"20px"}},{name:"fontWeight",cssPropertyName:"font-weight",value:{customPropertyName:k.W2.FontWeightHeading2,fallbackValue:"700"}},{name:"color",cssPropertyName:"color",value:{customPropertyName:k.Yf.HeadingText,fallbackValue:C}},{name:"marginTop",cssPropertyName:"margin-top",value:{customPropertyName:k.nm.MarginTopHeading2}},{name:"lineHeight",cssPropertyName:"line-height",value:{customPropertyName:k.nm.LineHeightHeading2,fallbackValue:"normal"}},{name:"role",cssPropertyName:"role",value:"heading"},{name:"ariaLevel",cssPropertyName:"aria-level",value:"2"},{name:"outline",cssPropertyName:"outline",value:{customPropertyName:k.nm.OutlineHeading2}},{name:"backgroundColor",cssPropertyName:"background-color",value:{customPropertyName:k.xE.BodyBackground,fallbackValue:"transparent"}}]],["Heading 3",[{name:"fontFamily",cssPropertyName:"font-family",value:{customPropertyName:k.W2.FontFamilyHeading3,fallbackValue:S}},{name:"fontSize",cssPropertyName:"font-size",value:{customPropertyName:k.W2.FontSizeHeading3,fallbackValue:"14px"}},{name:"fontWeight",cssPropertyName:"font-weight",value:{customPropertyName:k.W2.FontWeightHeading3,fallbackValue:"700"}},{name:"color",cssPropertyName:"color",value:{customPropertyName:k.Yf.HeadingText,fallbackValue:C}},{name:"marginTop",cssPropertyName:"margin-top",value:{customPropertyName:k.nm.MarginTopHeading3}},{name:"lineHeight",cssPropertyName:"line-height",value:{customPropertyName:k.nm.LineHeightHeading3,fallbackValue:"normal"}},{name:"role",cssPropertyName:"role",value:"heading"},{name:"ariaLevel",cssPropertyName:"aria-level",value:"3"},{name:"outline",cssPropertyName:"outline",value:{customPropertyName:k.nm.OutlineHeading3}},{name:"backgroundColor",cssPropertyName:"background-color",value:{customPropertyName:k.xE.BodyBackground,fallbackValue:"transparent"}}]],["Body",[{name:"fontFamily",cssPropertyName:"font-family",value:{customPropertyName:k.W2.FontFamilyBody,fallbackValue:S}},{name:"fontSize",cssPropertyName:"font-size",value:{customPropertyName:k.W2.FontSizeBody,fallbackValue:"14px"}},{name:"fontWeight",cssPropertyName:"font-weight",value:{customPropertyName:k.W2.FontWeightBody}},{name:"color",cssPropertyName:"color",value:{customPropertyName:k.xE.BodyText,fallbackValue:b.cG.Neutral.neutralPrimary}},{name:"lineHeight",cssPropertyName:"line-height",value:{customPropertyName:k.nm.LineHeightBody,fallbackValue:"normal"}},{name:"outline",cssPropertyName:"outline",value:{customPropertyName:k.nm.OutlineBody}},{name:"backgroundColor",cssPropertyName:"background-color",value:{customPropertyName:k.xE.BodyBackground,fallbackValue:"transparent"}}]]],x=function(e){(0,f.Z)(r,e);var t=(0,h.Z)(r);function r(){var e;return(0,l.Z)(this,r),(e=t.call(this)).setMaxListeners(0),e.appTextStyles=new Map(w),e}return(0,d.Z)(r,[{key:"Disposable",get:function(){return this}},{key:"dispose",value:function(){var e=(0,s.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:delete this._themeName,delete this.appThemeProperties,delete this.appTextStyles;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Theming",get:function(){return this}},{key:"themeName",get:function(){return this._themeName},set:function(e){e!==this._themeName&&(this._themeName=e,this.emit("themeNameChanged"))}},{key:"themeProperties",get:function(){return this.appThemeProperties},set:function(e){this.setThemeProperties(new Map(e))}},{key:"StylingProvider",get:function(){return this}},{key:"textStyles",get:function(){return this.appTextStyles}},{key:"setThemeProperties",value:function(e){var t=this.appThemeProperties?new Map(this.appThemeProperties):void 0;this.appThemeProperties=e,this.emit(v.F.themePropertiesChanged,t)}},{key:"setTextStyles",value:function(e){var t=this.appTextStyles?new Map(this.appTextStyles):void 0;this.appTextStyles=e,this.emit(v.F.textStylesChanged,t)}}]),r}(p.EventEmitter),P=r(93322),E=r(1413),Z=r(11752),T=r(61120),N=r(44925),F=["category"],I=1e4,B=function(){function e(t,r){(0,l.Z)(this,e),this.namespace=r,this.persistentProps=t||{},this.namespace=r}return(0,d.Z)(e,[{key:"NamespaceLogger",get:function(){return this}},{key:"PersistedProperties",get:function(){return this}},{key:"send",value:function(e){this.sendWithNamespace(e,this.namespace)}},{key:"sendWithNamespace",value:function(e,t){var r=t||this.namespace,n=(0,E.Z)((0,E.Z)({},this.persistentProps),e),o=n.category,i=(0,N.Z)(n,F),a=Object.keys(i).length>100;"error"!==o&&"Error"!==o||(i=function(e){var t=void 0;return"string"===typeof e.message&&e.message.length>I&&(t="message",e.message=e.message.substr(0,I)),"string"===typeof e.stack&&e.stack.length>I&&(t=t?t.concat(", stack"):"stack",e.stack=e.stack.substr(0,I)),t?(0,E.Z)((0,E.Z)({},e),{},{cappedFields:t}):e}(i)),this.logEvent({category:o,props:(0,E.Z)((0,E.Z)({},i),{},{exceedsMaxAllowedFields:a}),namespace:r})}},{key:"addPersistedProperties",value:function(e){this.persistentProps=(0,E.Z)((0,E.Z)({},this.persistentProps),e)}}]),e}(),D=r(38546),A=new(function(){function e(){(0,l.Z)(this,e)}return(0,d.Z)(e,[{key:"logEvent",value:function(e){if(e.category===D.J.Error)console.error("%cPurple: %c%s","color: purple; font-style: italic","",JSON.stringify(e));else console.log("%cPurple: %c%s","color: purple; font-style: italic","",JSON.stringify(e))}},{key:"setUserContext",value:function(e){}},{key:"shutdown",value:function(){}},{key:"loadFull",value:function(){return Promise.resolve()}},{key:"loadAsha",value:function(){}}]),e}()),O=r(27188),L=r(96914),_=r(82732),M=r(11012),R=r(7429),H=r(66051),j={Open:"Open",Interruptions:"Interruptions",VetoMissingClassification:"VetoMissingClassification"},U="LoadFailed",q="UnhandledError",z="UnhandledRejection",Y=[{pillar:j.Open,vetos:[U]},{pillar:j.Interruptions,vetos:[q,z]}];function V(e){var t,r=(0,i.Z)(Y);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n.vetos.includes(e))return n.pillar}}catch(o){r.e(o)}finally{r.f()}return j.VetoMissingClassification}function G(e){var t,r,n,o,i;return(0,E.Z)((0,E.Z)({},e),{},{pillar:null!==(t=e.pillar)&&void 0!==t?t:V(e.veto),isIntentional:null!==(r=e.isIntentional)&&void 0!==r&&r,isInternal:null===(n=e.isInternal)||void 0===n||n,alertOnPillar:null===(o=e.alertOnPillar)||void 0===o||o,isSessionEndingError:null!==(i=e.isSessionEndingError)&&void 0!==i&&i})}function W(e){return"eventName"in e&&"veto"in e}var J={token:"6a8929bcfc6d44e9b13fee392ada9cf0-4dea6a88-32c5-404b-8af1-4a43b94ef559-7393",namespacePrefix:"Office.Fluid"},K={token:"742fa5a288b045e5beab1a2b8e445a71-66618038-43f3-4a1f-a680-59d90da7d572-7251",namespacePrefix:"Office.Fluid"};function Q(e){return function(){var e=!1;try{e=!!localStorage.getItem("FluidCodeDetailsOverride")}catch(t){}return e}()||function(e){return"Local"===e||"Automation"===e||"SyntheticTraffic"===e}(e)?K:J}var X=["durationMs","succeeded","resultType"],$=["eventName","actionId","commandSurface","parentName","triggerMethod","timeOffsetMs"],ee=function(){function e(t,r){(0,l.Z)(this,e),this.initialPersistentProps=r,this.ashaLoadStarted=!1,this.telemetryLogger=new O.Dw(void 0,void 0,this.getTelemetryConfig(t)),this.telemetryLogger.partAFields.push((0,L.dt)("Loop.Audience",t)),this.ariaInfo=Q(t),this.telemetryLogger.setTenantToken(this.ariaInfo.namespacePrefix,this.ariaInfo.token,O.Vp),this.isNonProductionAudience(t)&&this.registerOtelErrorsListener()}return(0,d.Z)(e,[{key:"logEvent",value:function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t){var r,o,i,a,s,c=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.namespace,o=t.category,i=t.props,a=t.sampleEvent,o!==D.J.UserAction){e.next=5;break}this.logUserActionEventToOtel(t),e.next=15;break;case 5:if(o!==D.J.Activity){e.next=9;break}this.logActivityEventToOtel(t),e.next=15;break;case 9:if(!["AshaPillarAdd","AshaPillarRemove","AshaError"].includes(i.eventName)){e.next=13;break}return this.loadAsha(),null===(s=this.ashaUtils)||void 0===s||s.then((function(e){return(0,e.handleAshaEvent)(t)})).catch((function(){c.logDefaultEventToOtel({category:D.J.Error,namespace:r,props:{eventName:"".concat(i.eventName,"Failure")},sampleEvent:a})})),e.abrupt("return");case 13:o===D.J.Error&&W(i)&&(i=G(i)),this.logDefaultEventToOtel({namespace:r,category:o,props:i,sampleEvent:a});case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"shutdown",value:function(){var e,t=this;null===(e=this.ashaUtils)||void 0===e||e.then((function(e){return(0,e.shutdownAshaForFluid)()})).catch((function(){t.logDefaultEventToOtel({category:D.J.Error,props:{eventName:"AshaShutdownFailure"}})}))}},{key:"logDefaultEventToOtel",value:function(e){var t=this;this.logEventToOtelInternal(e,(function(r){t.prepareDefaultOtelEvent(r,e)}))}},{key:"logActivityEventToOtel",value:function(e){var t=this;this.logEventToOtelInternal(e,(function(r){t.prepareActivityOtelEvent(r,(0,E.Z)({},e.props))}))}},{key:"logUserActionEventToOtel",value:function(e){var t=this;this.logEventToOtelInternal(e,(function(r){t.prepareUserActionOtelEvent(r,(0,E.Z)({},e.props),e.namespace)}))}},{key:"getTelemetryConfig",value:function(e){var t={enableQueue:!0};return this.isNonProductionAudience(e)?t:(0,E.Z)((0,E.Z)({},t),{},{disableValidation:!0})}},{key:"isNonProductionAudience",value:function(e){return"Automation"===e||"Local"===e||"Staging"===e}},{key:"registerOtelErrorsListener",value:function(){(0,_.kr)().addListener((function(e){0===e.category&&0===e.level&&console.error(e.message())}))}},{key:"getDataFieldsFromProps",value:function(e){var t=[];return Object.keys(e).forEach((function(r){var n=(0,H.r)(e[r],r);n&&t.push(n)})),t}},{key:"logEventToOtelInternal",value:function(e,t){var r=this.getBasicOtelEvent(e);t(r),this.telemetryLogger.sendTelemetryEvent(r)}},{key:"getBasicOtelEvent",value:function(e){var t=e.category&&"".concat(e.category.charAt(0).toUpperCase()).concat(e.category.substring(1));e.props.subCategory&&e.category===D.J.Generic&&(t+=".".concat(e.props.subCategory.charAt(0).toUpperCase()).concat(e.props.subCategory.substring(1)));var r=!1;return e.sampleEvent&&(r=e.sampleEvent),{eventName:"".concat(this.ariaInfo.namespacePrefix).concat(e.namespace?"."+e.namespace:"",".").concat(t),eventFlags:{diagnosticLevel:M.K.DiagnosticLevel.RequiredServiceData,samplingPolicy:r?M.K.SamplingPolicy.Measure:void 0}}}},{key:"prepareDefaultOtelEvent",value:function(e,t){e.eventFlags.dataCategories=M.K.DataCategories.ProductServicePerformance,e.dataFields=this.getDataFieldsFromProps((0,E.Z)({},t.props))}},{key:"mapActivityResultTypeToCode",value:function(e){switch(e){case D.u.Failure:return 0;case D.u.Success:return 1;case D.u.Cancelled:return 2}}},{key:"prepareBaseActivityOtelEvent",value:function(e,t,r){t.durationMs||(t.durationMs=0);var n=Math.floor(1e3*t.durationMs),o=(t.durationMs,t.succeeded),i=t.resultType,a=(0,N.Z)(t,X);return e.eventContract={name:R.cS.contractName,dataFields:R.cS.getFields({duration:n,count:1,aggMode:0,success:o,result:!r&&i?{code:this.mapActivityResultTypeToCode(i),type:i}:void 0})},a}},{key:"prepareActivityOtelEvent",value:function(e,t){var r=t.eventName;e.eventName+=".".concat(r.charAt(0).toUpperCase()).concat(r.substring(1)),e.eventFlags.dataCategories=M.K.DataCategories.ProductServicePerformance;var n=this.prepareBaseActivityOtelEvent(e,t,!1);e.dataFields=this.getDataFieldsFromProps(n||{})}},{key:"prepareUserActionOtelEvent",value:function(e,t,r){var n=t.eventName;e.eventName+=".".concat(n.charAt(0).toUpperCase()).concat(n.substring(1)),e.eventFlags.dataCategories=M.K.DataCategories.ProductServiceUsage;var o=R.oe.getFields("Funnel",{name:r,state:"Successful"}),i=t,s=R.Vw.getFields({id:i.actionId,name:n,commandSurface:i.commandSurface,parentName:i.parentName,triggerMethod:i.triggerMethod,timeOffsetMs:i.timeOffsetMs}),c=this.prepareBaseActivityOtelEvent(e,t,!0),u=(c.eventName,c.actionId,c.commandSurface,c.parentName,c.triggerMethod,c.timeOffsetMs,(0,N.Z)(c,$));e.dataFields=[].concat((0,a.Z)(o),(0,a.Z)(s),(0,a.Z)(this.getDataFieldsFromProps(u||{})))}},{key:"loadAsha",value:function(){var e=this;this.ashaLoadStarted||(this.ashaLoadStarted=!0,this.ashaUtils=r.e(9576).then(r.bind(r,98023)),this.ashaUtils.then((function(t){return(0,t.initializeAshaForFluid)(e.ariaInfo.namespacePrefix,e.initialPersistentProps,(function(t){delete t.eventContract,e.telemetryLogger.sendTelemetryEvent(t)}))})).catch((function(){e.ashaLoadStarted=!1,e.logDefaultEventToOtel({category:D.J.Error,props:{eventName:"AshaLoadFailure"}})})))}}]),e}(),te=function(e){(0,f.Z)(r,e);var t=(0,h.Z)(r);function r(e,n,o){var i;return(0,l.Z)(this,r),(i=t.call(this,n,o)).hostTelemetrySink=e,i.loadFullCalled=!1,i}return(0,d.Z)(r,[{key:"setUserContext",value:function(e){}},{key:"loadFull",value:function(){var e=(0,s.Z)((0,n.Z)().mark((function e(){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.loadFullCalled){e.next=2;break}return e.abrupt("return");case 2:return this.loadFullCalled=!0,e.prev=3,e.next=6,this.hostTelemetrySink;case 6:t=e.sent,this.telemetryLogger.addSink(t),this.telemetryLogger.flushQueue(),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),this.logDefaultEventToOtel({category:D.J.Error,props:{eventName:"FailedToLoadTelemetrySink",message:"".concat(e.t0)}});case 14:case"end":return e.stop()}}),e,this,[[3,11]])})));return function(){return e.apply(this,arguments)}}()}]),r}(ee),re=r(69163),ne=function(){function e(t){(0,l.Z)(this,e),this.telemetrySink=t}return(0,d.Z)(e,[{key:"LoopTelemetrySink",get:function(){return this}},{key:"sendTelemetryEvent",value:function(e,t){this.telemetrySink.sendTelemetryEvent(e,t)}},{key:"sendCustomerContent",value:function(e){var t,r;null===(t=(r=this.telemetrySink).sendCustomerContent)||void 0===t||t.call(r,e)}},{key:"sendNonStandardEvent",value:function(e,t){var r,n;null===(r=(n=this.telemetrySink).sendNonStandardEvent)||void 0===r||r.call(n,e,t)}}]),e}(),oe=function(e){(0,f.Z)(o,e);var t=(0,h.Z)(o);function o(e,r){var n;return(0,l.Z)(this,o),(n=t.call(this,e.audience,r)).context=e,n.loadFullCalled=!1,n.deferredLoopTelemetrySink=new re.B,n}return(0,d.Z)(o,[{key:"getLoopTelemetrySinkPromise",value:function(){return this.deferredLoopTelemetrySink.promise.then()}},{key:"logEvent",value:function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.category===D.J.Error&&(this.loadFullCalled||this.loadFull().catch((function(){}))),e.abrupt("return",(0,Z.Z)((0,T.Z)(o.prototype),"logEvent",this).call(this,t));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setUserContext",value:function(e){var t;this.context=(0,E.Z)((0,E.Z)({},this.context),e),null===(t=this.telemetrySink)||void 0===t||t.setPartADataFields(this.context)}},{key:"shutdown",value:function(){var e=this;(0,Z.Z)((0,T.Z)(o.prototype),"shutdown",this).call(this),this.loadFull().then((function(){var t;return null===(t=e.telemetrySink)||void 0===t?void 0:t.shutdown()})).catch((function(){}))}},{key:"loadFull",value:function(){var e=(0,s.Z)((0,n.Z)().mark((function e(){var t=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.loadFullCalled){e.next=2;break}return e.abrupt("return");case 2:this.loadFullCalled=!0,r.e(3206).then(r.bind(r,64743)).then((function(e){t.telemetrySink=new e.OfficeFluidOneDsSink(t.context);var r=t.telemetrySink.createOneDsSink();t.telemetryLogger.addSink(r),t.telemetryLogger.flushQueue(),t.deferredLoopTelemetrySink.resolve(new ne(r))})).catch((function(e){t.logDefaultEventToOtel({category:D.J.Error,props:{eventName:"LoggerLoadFailure",message:e.message,stack:e.stack}})}));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),o}(ee),ie=function(e){(0,f.Z)(o,e);var t=(0,h.Z)(o);function o(e){var r,i;(0,l.Z)(this,o);var c=null!==(r=e.hostTelemetryContext)&&void 0!==r?r:e.hostContextProps,u=(0,E.Z)((0,E.Z)({},e.persistentProps),{},{hostCorrelationId:c.hostCorrelationId,hostScenarioName:[c.hostScenarioLifecycle,c.hostScenarioName,c.hostScenarioEntryPoint].filter((function(e){return e})).join("_"),hostName:c.hostName,hostScenarioStartTime:c.hostScenarioStartTime,loopAudience:e.audience});(i=t.call(this,u,e.namespace)).forceTelemetryToConsole=!1,i.disposable={get Disposable(){return this},dispose:function(){var e=(0,s.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i.logProcessors.forEach((function(e){return e.shutdown()}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},i.dispose=function(){i.logProcessors.forEach((function(e){return e.shutdown()}))},i.shutdown=(0,s.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.disposable.Disposable.dispose();case 2:case"end":return e.stop()}}),e)})));var d=e.delayLoadLogger,f=e.hostTelemetrySink;i.audience=e.audience,i.logProcessors=(0,a.Z)(e.additionalLogProcessors||[]);try{i.forceTelemetryToConsole="1"===localStorage.getItem("debugPurple"),i.forceTelemetryToConsole&&i.logProcessors.push(A)}catch(b){}if(f)i.telemetrySinkPromise=Promise.resolve(f).then((function(e){return new ne(e)})),i.logProcessors.push(new te(f,i.audience,u));else{var h,p,v,g=new oe({appPlatform:c.hostAppPlatform,appName:c.hostAppName,appVersion:c.hostAppVersion,user:c.userContext.user,sessionId:c.hostSessionId,audience:i.audience,uiLanguage:null!==(h=null===(p=e.hostTelemetryContext)||void 0===p?void 0:p.uiLanguage)&&void 0!==h?h:null===(v=e.hostContextProps.hostLocaleContext)||void 0===v?void 0:v.uiLanguage},u);i.telemetrySinkPromise=g.getLoopTelemetrySinkPromise(),i.logProcessors.push(g)}if(i.sendWithNamespace({eventName:"HostPassedTelemetrySink",sinkPassed:void 0!==f,category:"Generic",sampleEvent:!0},"HostPassedTelemetrySink"),d||i.loadFull().catch((function(){})),e.hostMetadata){var m=e.hostMetadata,y=m.hostFlights;i.sendWithNamespace({eventName:"HostMetadata",hostRing:m.hostRing,hostFlights:y&&JSON.stringify(y),category:"Generic"},"HostMetadata")}return i}return(0,d.Z)(o,[{key:"Disposable",get:function(){return this.disposable}},{key:"PersistedProperties",get:function(){return this}},{key:"getTelemetrySinkPromise",value:function(){return this.telemetrySinkPromise.then()}},{key:"loadFull",value:function(){var e=(0,s.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.allSettled([this.logProcessors.map((function(e){return e.loadFull()}))]);case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(){return e.apply(this,arguments)}}()},{key:"setUserContext",value:function(e){this.logProcessors.forEach((function(t){return t.setUserContext(e)}))}},{key:"logEvent",value:function(e){if(this.logProcessors.forEach((function(t){return t.logEvent(e)})),"Local"===this.audience){var t="UnhandledError"!==e.props.eventName&&"UnhandledRejection"!==e.props.eventName,r=e.category===D.J.Error||e.category===D.J.Activity&&!1===e.props.succeeded;t&&r&&!this.forceTelemetryToConsole&&console.error("OfficeFluidLogger %s %s event:",e.props.eventName,e.category,e.props,e.props.stack)}}},{key:"addPersistedProperties",value:function(e){var t=this;(0,Z.Z)((0,T.Z)(o.prototype),"addPersistedProperties",this).call(this,e),r.e(9576).then(r.bind(r,98023)).then((function(t){return(0,t.updateAshaAdditionalPartCEventDataFromTelemetryProperties)(e)})).catch((function(){t.send({category:"Error",eventName:"AshaUpdatePartCEventDataFailure"})}))}}]),o}(B),ae=r(834),se=r(75458);function ce(e){var t;t=null===e||void 0===e?void 0:e.dir,document.documentElement.setAttribute("dir",t||(0,se.e)(ae.al)),document.documentElement.setAttribute("lang",(null===e||void 0===e?void 0:e.lang)||ae.al)}var ue=r(14423),le=r(62190),de=r(29331),fe=r(61960),he=function(){function e(t,r,n,o,i,a,s,c,u){(0,l.Z)(this,e),this.audience=void 0,this.hostLocaleContext=void 0,this.hostName=void 0,this.hostAppName=void 0,this.hostAppPlatform=void 0,this.hostAppVersion=void 0,this.hostCorrelationId=void 0,this.hostScenarioEntryPoint=void 0,this.hostScenarioLifecycle=void 0,this.hostScenarioName=void 0,this.hostScenarioStartTime=void 0,this.hostSessionId=void 0,this.pageCorrelationId=void 0,this.userContext=void 0,this.audience=n,this.hostLocaleContext=s,this.pageCorrelationId=c,this.hostAppName=o,this.hostAppPlatform=i,this.hostAppVersion=a,this.hostScenarioEntryPoint=r.entryPoint,this.hostScenarioLifecycle=r.lifecycle,this.hostScenarioName=r.name,this.hostScenarioStartTime=r.startTime,this.hostSessionId=t,this.userContext=u,this.hostCorrelationId=this.pageCorrelationId,this.hostName="".concat(o,"_").concat(i)}return(0,d.Z)(e,[{key:"HostContext",get:function(){return this}}],[{key:"toAppPlatform",value:function(e){switch(null===e||void 0===e?void 0:e.toLowerCase()){case"android":return"Android";case"ios":return"iOS";case"mac":return"Mac";case"web":return"Web";case"win32":return"Win32";default:throw new Error('"'.concat(e,'" is not a valid app platform.'))}}},{key:"toAppName",value:function(e){switch(e){case"Demo App":case"Demo Host":case"Fluid Preview App":case"Loop App":case"Office.com":case"OfficeMobile":case"OneNote":case"Outlook":case"Scriptor Pad":case"Teams":case"Whiteboard":case"Word":return e;default:return ue.Y8||(0,fe.cM)('"'.concat(e,'" is not a valid app name, set to Unknown')),"Unknown"}}}]),e}(),pe=r(13885),ve=r(52230),ge=r(55477),me=r(50224),ye=r(78832),be=function(){function e(t,r,n,o){(0,l.Z)(this,e),this.beforeNotify=void 0,this.useDevicePixelRatio=void 0,this.hasSizeChanged=!1,this.height=0,this.isNotifying=!1,this.layoutMode=P.X.fixedByHost,this._notify=!0,this.resizeObserver=void 0,this.sizeChanged=void 0,this.width=0,this.beforeNotify=this.waitBeforeNotifying,this.layoutMode=r,this.notify=n,this.sizeChanged=o,this.observeResize(t)}return(0,d.Z)(e,[{key:"notify",get:function(){return this._notify},set:function(e){this._notify=e,this.notifySizeChanged()}},{key:"currentHeight",get:function(){return this.height}},{key:"notifySizeChanged",value:function(){var t=(0,s.Z)((0,n.Z)().mark((function t(){return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.layoutMode==P.X.fixedByHost||this.isNotifying){t.next=18;break}case 1:if(!this.notify||!this.hasSizeChanged){t.next=18;break}return this.hasSizeChanged=!1,this.isNotifying=!0,t.prev=4,t.next=7,this.beforeNotify();case 7:return this.hasSizeChanged&&(e.isVerboseLoggingEnabled&&(0,fe.cM)("Size changed while waiting."),this.hasSizeChanged=!1),e.isVerboseLoggingEnabled&&(0,fe.cM)("Notifying about size change (".concat(this.width," x ").concat(this.height,")...")),t.next=11,this.sizeChanged(this.width,this.height,this.layoutMode);case 11:t.next=15;break;case 13:t.prev=13,t.t0=t.catch(4);case 15:this.isNotifying=!1,t.next=1;break;case 18:case"end":return t.stop()}}),t,this,[[4,13]])})));return function(){return t.apply(this,arguments)}}()},{key:"observeResize",value:function(e){var t=this;this.layoutMode!=P.X.fixedByHost&&e&&(this.resizeObserver=new ResizeObserver(function(){var e=(0,s.Z)((0,n.Z)().mark((function e(r){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.resizeObserverCallback(r);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.resizeObserver.observe(e))}},{key:"resizeObserverCallback",value:function(){var t=(0,s.Z)((0,n.Z)().mark((function t(r){var o,i,a,s,c,u,l;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==this.useDevicePixelRatio){t.next=5;break}return t.next=3,(0,me.g)();case 3:i=t.sent,this.useDevicePixelRatio=null!==(o=null===i||void 0===i?void 0:i.useDevicePixelRatio)&&void 0!==o&&o;case 5:if(!(r.length>0)){t.next=14;break}if(a=r[r.length-1],this.useDevicePixelRatio?(s=Math.ceil(a.contentRect.height*devicePixelRatio),c=Math.ceil(a.contentRect.width*devicePixelRatio),e.isVerboseLoggingEnabled&&((0,fe.cM)("Device pixel ratio: ".concat(devicePixelRatio)),(0,fe.cM)("ResizeObserverEntry:"),(0,fe.cM)("  .contentRect =                    ".concat(a.contentRect.width," W x ").concat(a.contentRect.height," H")),null===(u=a.contentBoxSize)||void 0===u||u.forEach((function(e,t){return(0,fe.cM)("  .contentBoxSize[".concat(t,"] =              ").concat(e.inlineSize," W x ").concat(e.blockSize," H"))})),null===(l=a.devicePixelContentBoxSize)||void 0===l||l.forEach((function(e,t){return(0,fe.cM)("  .devicePixelContentBoxSize[".concat(t,"] =   ").concat(e.inlineSize," W x ").concat(e.blockSize," H"))})),(0,fe.cM)("  .contentRect * devicePixelRatio = ".concat(a.contentRect.width*devicePixelRatio," W x ").concat(a.contentRect.height*devicePixelRatio," H")))):(s=Math.ceil(a.contentRect.height),c=Math.ceil(a.contentRect.width)),s==this.height&&c==this.width){t.next=14;break}return this.height=s,this.width=c,this.hasSizeChanged=!0,ue.Y8||(0,fe.cM)("Observed size change. ".concat(this.width," W x ").concat(this.height," H  (devicePixelRatio: ").concat(devicePixelRatio,")")),t.abrupt("return",this.notifySizeChanged());case 14:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"setBeforeNotifyFunction",value:function(e){this.beforeNotify=e}},{key:"waitBeforeNotifying",value:function(){var t=(0,s.Z)((0,n.Z)().mark((function t(){return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isVerboseLoggingEnabled&&(0,fe.cM)("Waiting for ".concat(e.delayBeforeSizeChanged," ms before notifying about size change (").concat(this.width," x ").concat(this.height,")...")),t.next=3,(0,ye._)(e.delayBeforeSizeChanged);case 3:e.isVerboseLoggingEnabled&&(0,fe.cM)("Finished waiting.");case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),e}();be.delayBeforeSizeChanged=10,be.isVerboseLoggingEnabled=!1;var ke,Se=r(94497),Ce=r(55617),we=r(10795),xe=r(40722),Pe=r(5442);function Ee(e){switch(e){case"fixed":return P.X.fixedByHost;case"grow":return P.X.grow;default:return P.X.growHeight}}function Ze(e){try{var t=new URL(e).pathname,r=/^.*[/\\]([^/\\]+)$/.exec(t);if(r&&r.length>1){var n=decodeURIComponent(r[1]);if(n.endsWith(ue.Ib)||n.endsWith(ue.Kh))return n}}catch(o){}return null}function Te(e){var t=new RegExp(/\.(fluid|loop)$/,"i");return e.replace(t,"")}function Ne(e){if(!e)throw new le.gz("A Loop url was not provided.");var t;try{t=new URL(e)}catch(n){throw new le.gz("The Loop url that was provided is not a valid url.")}var r=t.protocol;if(!r||"https:"!==r.toLowerCase())throw new le.gz("The Loop url must use the HTTPS protocol.")}function Fe(e,t){t&&!e.ctrlKey&&(e.preventDefault(),(0,ve.Es)())}function Ie(e){return Be.apply(this,arguments)}function Be(){return(Be=(0,s.Z)((0,n.Z)().mark((function e(t){var r,o,i,a,s,c;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,ae.jR)(t.toLowerCase()),o=(0,se.e)(r),ce({lang:r,dir:o}),e.next=5,(0,pe.p)();case 5:return i=e.sent,a={locale:r,localeDirection:o,stringOverrides:{permissionsPanelPeopleOutsideWithLinkText:i.CustomPermissionsPanelPeopleOutsideWithLinkText,permissionsPanelSpecificPermissionText:i.CustomPermissionsPanelSpecificPermissionText,permissionsPanelPeopleOutsideText:i.CustomPermissionsPanelPeopleOutsideText,permissionsPanelSomePeopleText:i.CustomPermissionsPanelSomePeopleText}},s={uiLanguage:t,defaultContentDirection:o},e.t0=r,e.t1=o,c={get InternationalizationContext(){return this},uiLocale:e.t0,defaultContentDirection:e.t1},e.abrupt("return",{localeContext:s,localization:a,internationalizationContext:c});case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function De(e,t,r,n,o){var i=(0,de.KF)(),a=he.toAppPlatform(i.platform),s=he.toAppName(i.appName),c=new he(e,r,n,s,a,i.appVersion,o,t,{});return(0,fe.cM)("Fluid host context: {\n"+"  audience: ".concat(c.audience,", \n")+"  correlationId: ".concat(c.pageCorrelationId,", \n")+"  hostAppName: ".concat(c.hostAppName," \n")+"  hostAppPlatform: ".concat(c.hostAppPlatform," \n")+"  hostAppVersion: ".concat(c.hostAppVersion,", \n")+"  scenarioLifecycle: ".concat(c.hostScenarioLifecycle,", \n")+"  scenarioName: ".concat(c.hostScenarioName,", \n")+"  scenarioEntryPoint: ".concat(c.hostScenarioEntryPoint,", \n")+"}"),c}function Ae(e,t,r){var n=function(e){var t={};if(null!==e&&void 0!==e&&e.audienceGroup||null!==e&&void 0!==e&&e.channel){var r,n,o=null!==(r=null===e||void 0===e?void 0:e.audienceGroup)&&void 0!==r?r:"Unknown",i=null!==(n=null===e||void 0===e?void 0:e.channel)&&void 0!==n?n:"Unknown";t.hostRing="".concat(o,"/").concat(i)}return t}(t);return new ie({hostContextProps:e,hostTelemetrySink:Se.y,hostMetadata:n,audience:r})}function Oe(e,t){var r,n,s,l=new x,d=(0,Ce.TB)(e),f=new Map(d.properties),h=void 0;if(t){var p=(0,Pe.X)({fluentThemeV9:e?we._:xe.w}),v=new Map;p.forEach((function(e){v.set(e.name,e.value)}));var g=new Map([].concat((0,a.Z)(v.entries()),(0,a.Z)(f.entries())));null===l||void 0===l||l.setThemeProperties(g);var m,y=[],b=(0,i.Z)(f);try{for(b.s();!(m=b.n()).done;){var k=(0,o.Z)(m.value,2),S=k[0],C=k[1];y.push({name:S,value:C})}}catch(I){b.e(I)}finally{b.f()}var w=y.concat(p);r=(0,c.k)(w),h=(0,u.C)(w)}else{var P,E=[],Z=(0,i.Z)(f);try{for(Z.s();!(P=Z.n()).done;){var T=(0,o.Z)(P.value,2),N=T[0],F=T[1];E.push({name:N,value:F})}}catch(I){Z.e(I)}finally{Z.f()}r=(0,c.k)(E),null===l||void 0===l||l.setThemeProperties(f)}e&&(null===(n=document)||void 0===n||null===(s=n.body)||void 0===s||s.style.setProperty("background-color",Ce.jl));return{stylingProvider:l,initialTheme:r,initialThemeV9:h}}function Le(e,t){return _e.apply(this,arguments)}function _e(){return(_e=(0,s.Z)((0,n.Z)().mark((function e(t,r){var o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,ge.xv)(new URL(t)).catch((function(e){return(0,fe.H)("Unable to get fluid file name from Sharepoint.\n".concat((0,le.e$)(e))),null}));case 2:return o=e.sent,e.abrupt("return",o||Ze(t)||r||"");case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Me(e){var t=document.getElementById(ue.OP);ke=t?new be(t,e,!1,ve.$7):void 0}function Re(e){switch(e){case"Automation":case"Local":case"Staging":case"SyntheticTraffic":return{audience:"Staging"};case"Dogfood":return{audience:"Dogfood"};case"Microsoft":return{audience:"Microsoft"};case"Preview":return{audience:"Preview"};case"DoD":case"GCC":case"GCC-High":case"Production":return{audience:"Production"};default:return ue.Y8||(0,fe.H)("Audience ".concat(e," is not a known value.")),{audience:"Production"}}}},8663:function(e,t,r){"use strict";r.d(t,{Jg:function(){return se},x1:function(){return ce},Rx:function(){return ae}});var n=r(74165),o=r(15861),i=r(15671),a=r(43144),s=r(28002),c=r(30288),u=r(98846),l=r(75879);function d(e){var t=f(null===e||void 0===e?void 0:e.audience);return t||(null!==e&&void 0!==e&&e.ring?e.ring:"Prod")}function f(e){switch(e){case"Development":return"Development";case"Staging":return"Staging";case"Dogfood":return"Dogfood";case"Preview":case"Microsoft":case"Production":return"Prod";case"GCC":return"Gcc";case"GCC-High":return"GccHigh";case"DoD":return"DoD";case"USNat":return"USNat";case"USSec":return"USSec";default:return}}var h=["https://cdn.dev.fluidpreview.office.net","https://cdn.fluidpreview.office.net","https://res-sdf.cdn.office.net","https://res.cdn.office.net","https://dev.loop.microsoft.com","https://df.loop.microsoft.com","https://preview.loop.microsoft.com","https://loop.microsoft.com","https://dev.ch5.fluidpreview.office.net","https://ch5.fluidpreview.office.net","https://blobs.officehome.msocdn.com","https://app.int.whiteboard.microsoft.com","https://app.whiteboard.microsoft.com","https://whiteboard.microsoft.com","https://whiteboard.office.com","https://cdn.forms.office.net","https://loop.cloud.microsoft","https://loop.cloud-dev.microsoft"],p=["https://res-gcch.cdn.office.net","https://whiteboard.office365.us"],v=["https://res-dod.cdn.office.net"],g=[].concat(h,p,v),m=function(e,t,r){var n;if(null===(n=null===t||void 0===t?void 0:t.getSetting("bohemiaCodeLoader.environmentSpecificCDNs",!0))||void 0===n||n){var o="DoD"===e?v:"GccHigh"===e?p:h;return r&&((0,u.ve)(r,{eventName:"DefaultAllowedCodeOrigins",environment:e}),0===o.length&&(0,u.uX)(r,{eventName:"DefaultAllowedCodeOriginsEmptyEnvironment"},"{message: ${deploymentRing} environment does not have any default code origins}")),o}return g},y=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"low",o=3;return function i(){return b(e,t,r,n).catch((function(){return 0===(o-=1)?b(e,t,r,n):i()}))}()};function b(e,t,r,n){return k.apply(this,arguments)}function k(){return(k=(0,o.Z)((0,n.Z)().mark((function e(t,r,o,i){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var a,s,c=t.document,u=c.createElement("script");u.setAttribute("fetchpriority",i);var l=null!==(a=null===o||void 0===o||null===(s=o.trustedTypesPolicy)||void 0===s?void 0:s.createScriptURL(r,{allowedScriptOrigins:o.allowedOrigins}))&&void 0!==a?a:r;u.src=l,u.async=!1,u.charset="utf-8",u.crossOrigin="anonymous",u.onload=e,u.onerror=function(){return n(new Error("Failed to download the script at url: ".concat(r,", isUserDefinitelyOffline: ").concat(!t.navigator.onLine)))},c.head.appendChild(u)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var S="FluidOdspDriver";function C(e){delete e[S]}var w=r(1413),x=r(98245),P="fluidDevOverrides";function E(e){try{var t;return null===(t=window.top[P])||void 0===t?void 0:t[e]}catch(r){return}}function Z(e){switch(e){case"Development":return"https://cdn.dev.fluidpreview.office.net/fluid/dev";case"Staging":return"https://cdn.dev.fluidpreview.office.net/fluid/stg";case"Dogfood":return"https://cdn.fluidpreview.office.net/fluid/df";case"Gcc":return"https://cdn.fluidpreview.office.net/fluid/gcc";case"GccHigh":return"https://res-gcch.cdn.office.net/fluid/gcch";case"DoD":return"https://res-dod.cdn.office.net/fluid/dod";default:return"https://cdn.fluidpreview.office.net/fluid/prod"}}var T="odspDriverManifestUrl",N=r(72633),F="fluidOdspDriverManifestCache_";function I(e,t){var r;if((0,N.E)()){var n=(0,w.Z)((0,w.Z)({},e),{},{lastUpdatedTime:Date.now()});null===(r=(0,N.E)())||void 0===r||r.setItem(B(t),JSON.stringify(n))}}function B(e){return F+(e||"Prod")}var D="v1",A="/odsp-driver/versionless/deploymentManifestOdspDriver.json",O=6048e5;function L(e){return _.apply(this,arguments)}function _(){return(_=(0,o.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=M(t))){e.next=4;break}return R(t),e.abrupt("return",r);case 4:return e.next=6,H(t);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e){try{var t=function(e){var t,r=null===(t=(0,N.E)())||void 0===t?void 0:t.getItem(B(e));return r?JSON.parse(r):null}(e);return t?Date.now()-t.lastUpdatedTime>O?null:t:null}catch(r){return null}}function R(e){(0,N.E)()&&(0,x.F)((function(){return H(e,"low").catch((function(e){}))}))}function H(e){return j.apply(this,arguments)}function j(){return j=(0,o.Z)((0,n.Z)().mark((function e(t){var r,o,i,a,s,c,u=arguments;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.length>1&&void 0!==u[1]?u[1]:"high",o=E(T),i=o||Z(t)+A,a={method:"GET"},e.next=6,fetch(i,(0,w.Z)((0,w.Z)({},a),{},{priority:r}));case 6:if(!(s=e.sent).ok){e.next=13;break}return e.next=10,s.json();case 10:return I(c=e.sent,t),e.abrupt("return",c);case 13:throw new Error("Error fetching ODSP Driver manifest");case 14:case"end":return e.stop()}}),e)}))),j.apply(this,arguments)}function U(e){return q.apply(this,arguments)}function q(){return(q=(0,o.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L(t);case 2:return r=e.sent,e.abrupt("return",z(r));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(e){return e.jsBaseUrl+"/"+e[D].index}var Y={GetOdspCode:"GetOdspCode"},V="OdspDriverCodeLoader",G="getServiceDeliveredOdspCode",W="Could not load service-delivered ODSP Driver Code";function J(e){return K.apply(this,arguments)}function K(){return(K=(0,o.Z)((0,n.Z)().mark((function e(t){var r,o,i,a,u,f,h,p,v,g,b,k,w,x,P,E,Z;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.windowContext,o=t.environment,i=t.logger,a=t.trustedTypesPolicy,u=t.disposeOnCompletion,f=i&&new s.g(V,i),h=c.a.start(Y.GetOdspCode,f,{addUserTiming:!0}),(p=r)[S]||(p[S]={}),v=p[S],e.prev=6,!v.getDocumentServiceFactory){e.next=10;break}return h.setResult(!0,{message:"Namespace already loaded."}),e.abrupt("return",v);case 10:if(!v.scriptLoadingStarted){e.next=18;break}return b=new l.B,v.pending||(v.pending=[]),v.pending.push({promise:b,logger:f}),e.next=16,b;case 16:return h.setResult(!0,{message:"Loaded from existing call."}),e.abrupt("return",v);case 18:return v.scriptLoadingStarted=!0,k=d(o),e.next=22,U(k);case 22:if(w=e.sent,x=m(k),e.t0=a,!e.t0){e.next=31;break}return e.next=28,a;case 28:e.t1=e.sent,e.t2=x,e.t0={trustedTypesPolicy:e.t1,allowedOrigins:e.t2};case 31:return P=e.t0,e.next=34,y(p,w,P);case 34:return null===(g=v.pending)||void 0===g||g.forEach((function(e){return e.promise.resolve()})),delete v.pending,h.setResult(!0,{message:"Loaded from first call."}),e.abrupt("return",v);case 40:throw e.prev=40,e.t3=e.catch(6),Z=new Error(W),Q(f,e.t3),delete v.scriptLoadingStarted,null===(E=v.pending)||void 0===E||E.forEach((function(t){Q(t.logger,e.t3),t.promise.reject(Z)})),delete v.pending,h.setResult(!1,{},Z),Z;case 49:return e.prev=49,u&&C(p),e.finish(49);case 52:case"end":return e.stop()}}),e,null,[[6,40,49,52]])})))).apply(this,arguments)}function Q(e,t){e&&(0,u.uX)(e,{eventName:G},t)}function X(e){return $.apply(this,arguments)}function $(){return($=(0,o.Z)((0,n.Z)().mark((function e(t){var r,o,i,a,c,u,l,d,f,h;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.windowContext,o=t.environment,i=t.tokenProvider,a=t.trustedTypesPolicy,c=t.logger,u=t.driverCache,l=t.hostStoragePolicy,d=t.disposeOnCompletion,f=c&&new s.g(V,c),e.next=4,J({windowContext:r,environment:o,logger:f,trustedTypesPolicy:a,disposeOnCompletion:d});case 4:return h=e.sent,e.abrupt("return",h.getDocumentServiceFactory({tokenProvider:i,logger:f,driverCache:u,hostStoragePolicy:l}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ee=r(14423),te=r(62190),re=r(88861),ne=r(75757),oe=r(80565),ie=r(31876),ae=!1,se=function(){function e(t,r){(0,i.Z)(this,e),this.urlResolver=t,this.documentServiceFactory=r}return(0,a.Z)(e,[{key:"DriverImplementation",get:function(){return this}}]),e}();function ce(e,t,r,n,o,i,a){return ue.apply(this,arguments)}function ue(){return(ue=(0,o.Z)((0,n.Z)().mark((function e(t,r,o,i,a,s,c){var u,l,d,f,h,p,v,g,m;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=3*ee.Ie,d=s?new ie.a({partitionKey:c,logger:o,maxCacheItemAge:l}):void 0,f=r.environment,h=null!==(u=r.hostStoragePolicy)&&void 0!==u?u:{},e.next=6,(0,re.Bm)(re.SZ.OEP,"FluidHost.ServiceDeliveredODSPDriver");case 6:if(p=e.sent,v=o,h.enableRedeemFallback=!0,!p){e.next=20;break}return e.prev=10,ae=!0,e.next=14,X({windowContext:window,driverCache:d,environment:f,hostStoragePolicy:h,logger:v,tokenProvider:a,settingsProvider:i,disposeOnCompletion:!0,trustedTypesPolicy:void 0});case 14:return e.abrupt("return",e.sent);case 17:e.prev=17,e.t0=e.catch(10),(0,te.w5)("getDocumentServiceFactory()",new te.gz("getServiceDeliveredDocumentServiceFactory() failed.",e.t0));case 20:return e.prev=20,ae=!1,t.odspModuleImportTracker=new ne.g,e.next=25,t.odspModuleImportTracker.measure((function(){return(0,oe.px)()}));case 25:return g=e.sent,e.next=28,g.getNpmSharepointDriver(a,v,d,h,{appName:void 0},i);case 28:return m=e.sent,e.abrupt("return",m.documentServiceFactory);case 32:e.prev=32,e.t1=e.catch(20),(0,te.w5)("getSharepointDriver()",(0,te.CR)(e.t1));case 35:throw new te.gz("Unable to get the document service factory.");case 36:case"end":return e.stop()}}),e,null,[[10,17],[20,32]])})))).apply(this,arguments)}},53748:function(e,t,r){"use strict";function n(){return"".concat(o()+o(),"-").concat(o(),"-").concat(o(),"-").concat(o(),"-").concat(o()).concat(o()).concat(o())}function o(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}r.d(t,{u:function(){return n}})},72911:function(e,t,r){"use strict";r.d(t,{Ru:function(){return c},jc:function(){return u},wQ:function(){return s}});var n,o=r(52230),i="ms-ContextualMenu",a="ms-Callout";function s(e){e.defaultPrevented||"Escape"==e.key&&function(e){var t=e.target;if(!t)return!1;if(t===n)return!0;if(n&&n.contains(t))return!1;if(function(e){for(;e;){var t,r=null===(t=e)||void 0===t?void 0:t.className;if(r&&(r.indexOf(i)>-1||r.indexOf(a)>-1))return!0;e=e.parentElement}return!1}(t))return!1;return!0}(e)&&((0,o.zV)(e.key),e.preventDefault())}function c(e){e&&(n=e)}function u(e){if(e.target&&n){var t=e.target;if(n.contains(t))return!0}return!1}},13885:function(e,t,r){"use strict";var n;r.d(t,{p:function(){return u}});var o,i=r(74165),a=r(15861),s=r(29331),c=r(26617);function u(){return l.apply(this,arguments)}function l(){return(l=(0,a.Z)((0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(0,s.Wx)(),e.prev=1,o){e.next=6;break}return e.next=5,r(79501)("./".concat(t,"/strings.json"));case 5:o=e.sent;case 6:return e.abrupt("return",o);case 9:return e.prev=9,e.t0=e.catch(1),e.abrupt("return",n||(n=r.t(c,2)));case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}},80565:function(e,t,r){"use strict";r.d(t,{iF:function(){return u},px:function(){return s},sr:function(){return i}});var n=r(74165),o=r(15861);function i(){return a.apply(this,arguments)}function a(){return(a=(0,o.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([r.e(4164),r.e(6906),r.e(9110)]).then(r.bind(r,48278)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function s(){return c.apply(this,arguments)}function c(){return(c=(0,o.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([r.e(1721),r.e(6732),r.e(2537)]).then(r.bind(r,79012)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function u(){return l.apply(this,arguments)}function l(){return(l=(0,o.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([r.e(3711),r.e(8507),r.e(4164),r.e(5262),r.e(1657),r.e(3984),r.e(1724)]).then(r.bind(r,49227)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},50224:function(e,t,r){"use strict";r.d(t,{g:function(){return s}});var n,o=r(74165),i=r(15861),a=r(52230);function s(){return c.apply(this,arguments)}function c(){return(c=(0,i.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n||(n=(0,a.Gc)()),e.abrupt("return",n);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},72532:function(e,t,r){"use strict";r.d(t,{Hp:function(){return b},JL:function(){return Z},NN:function(){return w},Nb:function(){return h},Nx:function(){return f},OX:function(){return N},dd:function(){return E},iX:function(){return v},mx:function(){return m},oD:function(){return T},ot:function(){return y},v6:function(){return k},xH:function(){return C},yF:function(){return P},zR:function(){return S}});var n=r(74165),o=r(15861),i=r(43144),a=r(15671),s=r(60136),c=r(29388),u=r(28664),l=r(50224),d=function(e){(0,s.Z)(r,e);var t=(0,c.Z)(r);function r(){return(0,a.Z)(this,r),t.call(this)}return(0,i.Z)(r)}((0,u.Z)(EventTarget)),f=function(e){return e.BackgroundChanged="BackgroundChanged",e.FluidComponentDataSaved="FluidComponentDataSaved",e.IsContentHeightLimitedChanged="IsContentHeightLimitedChanged",e.LinkPermissionChanged="LinkPermissionChanged",e.LinkProblemStateChanged="LinkProblemStateChanged",e.LinkUrlChanged="LinkUrlChanged",e.RequestDataToSave="RequestDataToSave",e.ShowLoopGlowBorder="ShowLoopGlowBorder",e.ThemeChanged="ThemeChanged",e}({}),h=function(e){return e[e.None=0]="None",e[e.Warning=1]="Warning",e[e.Error=2]="Error",e}({}),p=new d;function v(e){return g.apply(this,arguments)}function g(){return(g=(0,o.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.g)();case 2:if((r=e.sent).version){e.next=5;break}return e.abrupt("return",!1);case 5:e.t0=t,e.next=e.t0===f.LinkUrlChanged||e.t0===f.ThemeChanged?8:e.t0===f.LinkPermissionChanged?9:e.t0===f.LinkProblemStateChanged?10:e.t0===f.BackgroundChanged?11:e.t0===f.IsContentHeightLimitedChanged?12:e.t0===f.RequestDataToSave||e.t0===f.FluidComponentDataSaved?13:e.t0===f.ShowLoopGlowBorder?14:15;break;case 8:return e.abrupt("return",r.version>=2);case 9:return e.abrupt("return",r.version>=2&&r.version<=5);case 10:return e.abrupt("return",r.version>=5);case 11:return e.abrupt("return",r.version>=6);case 12:return e.abrupt("return",r.version>=15);case 13:return e.abrupt("return",r.version>=16);case 14:return e.abrupt("return",r.version>=20);case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){p.addEventListener(f.BackgroundChanged,e)}function y(e){p.addEventListener(f.FluidComponentDataSaved,e)}function b(e){p.removeEventListener(f.FluidComponentDataSaved,e)}function k(e){p.addEventListener(f.IsContentHeightLimitedChanged,e)}function S(e){p.addEventListener(f.LinkPermissionChanged,e)}function C(e){p.addEventListener(f.LinkProblemStateChanged,e)}function w(e){p.addEventListener(f.LinkUrlChanged,e)}function x(e,t){p.dispatchEvent(new CustomEvent(e,{detail:t}))}function P(e){p.addEventListener(f.RequestDataToSave,e)}function E(e){p.removeEventListener(f.RequestDataToSave,e)}function Z(e){p.addEventListener(f.ShowLoopGlowBorder,e)}function T(e){p.addEventListener(f.ThemeChanged,e)}function N(){Object.defineProperty(window,"onNativeEvent",{value:x})}},43806:function(e,t,r){"use strict";r.d(t,{g8:function(){return m},jd:function(){return y},st:function(){return P},KE:function(){return C}});var n=r(29439),o=r(83878),i=r(59199),a=r(40181),s=r(25267);var c=r(43144),u=r(15671),l=r(60136),d=r(29388),f=r(28664),h=r(29331),p=r(93322),v=r(61960),g=r(62190),m=function(e){return e[e.GetToken=1e3]="GetToken",e[e.SizeChanged=1001]="SizeChanged",e[e.GetFeature=1002]="GetFeature",e[e.SendTelemetry=1003]="SendTelemetry",e[e.ReportActivityResult=1004]="ReportActivityResult",e[e.GetUserIdentity=1006]="GetUserIdentity",e[e.GetNativeInfo=1007]="GetNativeInfo",e[e.ShowPermissionCallout=1008]="ShowPermissionCallout",e[e.CaretPositionChanged=1009]="CaretPositionChanged",e[e.OnAtMention=1010]="OnAtMention",e[e.OnInvokeFromInjectedScript=1011]="OnInvokeFromInjectedScript",e[e.FluidComponentCreated=1012]="FluidComponentCreated",e[e.IsChangeGateEnabled=1013]="IsChangeGateEnabled",e[e.FluidHostIsReady=1015]="FluidHostIsReady",e[e.PassKeyToHost=1016]="PassKeyToHost",e[e.GetDataForCreate=1017]="GetDataForCreate",e[e.SetCanProvideDataToSave=1018]="SetCanProvideDataToSave",e[e.ProvideDataToSave=1019]="ProvideDataToSave",e[e.FluidComponentEdited=1020]="FluidComponentEdited",e[e.TeachingCalloutDismissed=1021]="TeachingCalloutDismissed",e[e.TeachingCalloutShown=1022]="TeachingCalloutShown",e[e.FluidComponentCreateFailed=1023]="FluidComponentCreateFailed",e[e.InvokeMessageExtensionCommand=1024]="InvokeMessageExtensionCommand",e[e.LoopComponentCreated=1025]="LoopComponentCreated",e[e.Dehydrate=1026]="Dehydrate",e[e.SaveEmbeddedData=1027]="SaveEmbeddedData",e[e.UpdateLoopInfo=1028]="UpdateLoopInfo",e}({}),y=function(e){return e[e.Hydrate=0]="Hydrate",e}({}),b=function(e){(0,l.Z)(r,e);var t=(0,d.Z)(r);function r(e,n){var o;return(0,u.Z)(this,r),(o=t.call(this,n)).errorCode=void 0,o.errorCode=e,o}return(0,c.Z)(r)}((0,f.Z)(Error)),k=function(e){return e[e.fixed=0]="fixed",e[e.growHeight=1]="growHeight",e[e.grow=2]="grow",e}({});function S(e){return m[e]}function C(e){switch(e){case p.X.grow:return k.grow;case p.X.growHeight:return k.growHeight;case p.X.fixedByHost:return k.fixed;default:throw new g.gz("Unknown LayoutMode")}}var w=0,x=!1;function P(e,t){return new Promise((function(r,c){try{var u=function(e){if(x){++w;var t=m[e];return(0,v.cM)("[".concat(w,"] Native method called: ").concat(t)),{invocation:w,methodName:t,timeStart:performance.now()}}return}(e);h.GW&&h.GW.Execute||c(new b(void 0,"Native requests are not supported.")),h.GW.Execute(e,t,(function(t,l){if(function(e){if(e){var t=performance.now()-e.timeStart;(0,v.cM)("[".concat(e.invocation,"] Native method return: ").concat(e.methodName," (Duration: ").concat(t,")"))}}(u),!t)throw new g.gz("The callback did not provide any data.");var d=t.toArray();if(!Array.isArray(d))throw new g.gz("The callback data is not an array.");0===d.length&&d.push("number"===typeof l?l:0);var f,h=(f=d,(0,o.Z)(f)||(0,i.Z)(f)||(0,a.Z)(f)||(0,s.Z)()),p=h[0],m=h.slice(1);if("number"!==typeof p)throw new g.gz("The first item returned should be an error code number.");if(0===p)r(m);else{var y=(0,n.Z)(m,1)[0],k="string"===typeof y?"\n".concat(y):"";c(new b(p,"".concat(S(e)," native method failed. Error code: ").concat(p).concat(k)))}}))}catch(l){c(new b(void 0,"Unexpected response from native request: ".concat(S(e),".\n").concat(l instanceof Error?l.message:l)))}}))}},52230:function(e,t,r){"use strict";r.d(t,{$7:function(){return ie},AZ:function(){return te},Bm:function(){return Z},D:function(){return v},Dt:function(){return de},Es:function(){return ne},Gc:function(){return D},LP:function(){return O},NS:function(){return w},O$:function(){return _},P3:function(){return Q},UT:function(){return R},W8:function(){return b},X_:function(){return J},cQ:function(){return h},dT:function(){return N},hx:function(){return q},lF:function(){return $},l_:function(){return P},mj:function(){return ue},oE:function(){return S},qc:function(){return G},xF:function(){return m},xO:function(){return I},zV:function(){return Y},zc:function(){return se}});var n=r(29439),o=r(74165),i=r(15861),a=r(14423),s=r(62190),c=r(88861),u=r(61960),l=r(50224),d=r(43806),f=function(e){return e[e.boolean=0]="boolean",e[e.integer=1]="integer",e[e.string=2]="string",e}({});function h(e){return p.apply(this,arguments)}function p(){return(p=(0,i.Z)((0,o.Z)().mark((function e(t){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.st)(d.g8.CaretPositionChanged,[t]);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(){return g.apply(this,arguments)}function g(){return(g=(0,i.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(d.g8.Dehydrate);case 2:if(!e.sent){e.next=5;break}return e.next=5,(0,d.st)(d.g8.Dehydrate,[]);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e,t){return y.apply(this,arguments)}function y(){return(y=(0,i.Z)((0,o.Z)().mark((function e(t,r){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.st)(d.g8.FluidComponentCreated,[t,r]);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e){return k.apply(this,arguments)}function k(){return(k=(0,i.Z)((0,o.Z)().mark((function e(t){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(d.g8.FluidComponentCreateFailed);case 2:if(!e.sent){e.next=5;break}return e.next=5,(0,d.st)(d.g8.FluidComponentCreateFailed,[t]);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(){return C.apply(this,arguments)}function C(){return(C=(0,i.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(d.g8.FluidComponentEdited);case 2:if(!e.sent){e.next=5;break}return e.next=5,(0,d.st)(d.g8.FluidComponentEdited,[]);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(){return x.apply(this,arguments)}function x(){return(x=(0,i.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j(d.g8.FluidHostIsReady);case 3:if(!e.sent){e.next=6;break}return e.next=6,(0,d.st)(d.g8.FluidHostIsReady,[]);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),(0,s.w5)("fluidHostIsReady()",(0,s.CR)(e.t0));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function P(){return E.apply(this,arguments)}function E(){return(E=(0,i.Z)((0,o.Z)().mark((function e(){var t,r,i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(d.g8.GetDataForCreate);case 2:if(!e.sent){e.next=13;break}return e.next=5,(0,d.st)(d.g8.GetDataForCreate,[]);case 5:if(t=e.sent,r=(0,n.Z)(t,1),"string"===typeof(i=r[0])){e.next=10;break}throw new s.gz("The data returned is not a string.");case 10:return e.abrupt("return",i);case 13:return e.abrupt("return","");case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(e,t){return T.apply(this,arguments)}function T(){return(T=(0,i.Z)((0,o.Z)().mark((function e(t,r){var i,s,l,h,p;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(0,c.g2)(t,r),s=[i,f.boolean],e.next=4,(0,d.st)(d.g8.GetFeature,s).catch((function(e){return a.Y8||(0,u.H)(e),[!1]}));case 4:return l=e.sent,h=(0,n.Z)(l,1),p=h[0],e.abrupt("return","boolean"===typeof p&&p);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(e,t){return F.apply(this,arguments)}function F(){return F=(0,i.Z)((0,o.Z)().mark((function e(t,r){var i,l,h,p,v,g,m=arguments;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=m.length>2&&void 0!==m[2]?m[2]:0,Number.isInteger(i)){e.next=3;break}throw new s.gz("The default value must be an integer.");case 3:return l=(0,c.g2)(t,r),h=[l,f.integer,i],e.next=7,(0,d.st)(d.g8.GetFeature,h).catch((function(e){return a.Y8||(0,u.H)(e),[i]}));case 7:return p=e.sent,v=(0,n.Z)(p,1),g=v[0],e.abrupt("return","number"===typeof g?g:i);case 11:case"end":return e.stop()}}),e)}))),F.apply(this,arguments)}function I(e,t){return B.apply(this,arguments)}function B(){return B=(0,i.Z)((0,o.Z)().mark((function e(t,r){var i,s,l,h,p,v,g=arguments;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=g.length>2&&void 0!==g[2]?g[2]:"",s=(0,c.g2)(t,r),l=[s,f.string,i],e.next=5,(0,d.st)(d.g8.GetFeature,l).catch((function(e){return a.Y8||(0,u.H)(e),[i]}));case 5:return h=e.sent,p=(0,n.Z)(h,1),v=p[0],e.abrupt("return","string"===typeof v?v:i);case 9:case"end":return e.stop()}}),e)}))),B.apply(this,arguments)}function D(){return A.apply(this,arguments)}function A(){return(A=(0,i.Z)((0,o.Z)().mark((function e(){var t,r,i,a;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.st)(d.g8.GetNativeInfo,[]).catch((function(){return["{}"]}));case 2:if(t=e.sent,r=(0,n.Z)(t,1),"string"===typeof(i=r[0])){e.next=7;break}throw new Error("A string should be returned.");case 7:if(a=JSON.parse(i)){e.next=10;break}throw new Error("Unable to parse the native info json.");case 10:return e.abrupt("return",a);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(e,t){return L.apply(this,arguments)}function L(){return(L=(0,i.Z)((0,o.Z)().mark((function e(t,r){var i,a,c,u;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!0,i=[t,null!==r&&void 0!==r?r:"",true],e.next=4,(0,d.st)(d.g8.GetToken,i);case 4:if(a=e.sent,c=(0,n.Z)(a,1),"string"===typeof(u=c[0])){e.next=9;break}throw new s.gz("Token should be a string.");case 9:return e.abrupt("return",u);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e,t){return M.apply(this,arguments)}function M(){return(M=(0,i.Z)((0,o.Z)().mark((function e(t,r){var i,a,c,u;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(d.g8.InvokeMessageExtensionCommand);case 2:if(!e.sent){e.next=12;break}return e.next=5,(0,d.st)(d.g8.InvokeMessageExtensionCommand,[t,JSON.stringify(r)]);case 5:if(i=e.sent,a=(0,n.Z)(i,1),"string"===typeof(c=a[0])){e.next=10;break}throw new s.gz("The data returned is not a string.");case 10:return u=JSON.parse(c),e.abrupt("return",u);case 12:return e.abrupt("return",void 0);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e,t){return H.apply(this,arguments)}function H(){return(H=(0,i.Z)((0,o.Z)().mark((function e(t,r){var i,s,c;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(d.g8.IsChangeGateEnabled);case 2:if(e.sent){e.next=5;break}return e.abrupt("return",!0);case 5:return e.next=7,(0,d.st)(d.g8.IsChangeGateEnabled,[t,r]).catch((function(e){return a.Y8||(0,u.H)(e),[!0]}));case 7:return i=e.sent,s=(0,n.Z)(i,1),c=s[0],e.abrupt("return","boolean"!==typeof c||c);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e){return U.apply(this,arguments)}function U(){return(U=(0,i.Z)((0,o.Z)().mark((function e(t){var r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.g)();case 2:if((r=e.sent).version){e.next=5;break}return e.abrupt("return",!1);case 5:e.t0=t,e.next=e.t0===d.g8.GetFeature||e.t0===d.g8.GetNativeInfo||e.t0===d.g8.GetToken||e.t0===d.g8.GetUserIdentity||e.t0===d.g8.ReportActivityResult||e.t0===d.g8.SendTelemetry?8:e.t0===d.g8.ShowPermissionCallout?9:e.t0===d.g8.CaretPositionChanged?10:e.t0===d.g8.OnAtMention?11:e.t0===d.g8.OnInvokeFromInjectedScript?12:e.t0===d.g8.FluidComponentCreated?13:e.t0===d.g8.IsChangeGateEnabled?14:e.t0===d.g8.FluidHostIsReady?15:e.t0===d.g8.PassKeyToHost?16:e.t0===d.g8.GetDataForCreate?17:e.t0===d.g8.SetCanProvideDataToSave||e.t0===d.g8.ProvideDataToSave||e.t0===d.g8.FluidComponentEdited?18:e.t0===d.g8.TeachingCalloutDismissed||e.t0===d.g8.TeachingCalloutShown?19:e.t0===d.g8.FluidComponentCreateFailed?20:e.t0===d.g8.InvokeMessageExtensionCommand?21:e.t0===d.g8.Dehydrate?22:e.t0===d.g8.SaveEmbeddedData?23:e.t0===d.g8.UpdateLoopInfo?24:25;break;case 8:return e.abrupt("return",r.version>=1);case 9:return e.abrupt("return",r.version>=2);case 10:return e.abrupt("return",r.version>=3);case 11:return e.abrupt("return",r.version>=4);case 12:return e.abrupt("return",r.version>=8);case 13:return e.abrupt("return",r.version>=9);case 14:return e.abrupt("return",r.version>=10);case 15:return e.abrupt("return",r.version>=12);case 16:return e.abrupt("return",r.version>=13);case 17:return e.abrupt("return",r.version>=15);case 18:return e.abrupt("return",r.version>=16);case 19:return e.abrupt("return",r.version>=17);case 20:return e.abrupt("return",r.version>=18);case 21:return e.abrupt("return",r.version>=22);case 22:return e.abrupt("return",r.version>=24);case 23:return e.abrupt("return",r.version>=25);case 24:return e.abrupt("return",r.version>=26);case 25:return e.abrupt("return",!1);case 26:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e,t){return z.apply(this,arguments)}function z(){return(z=(0,i.Z)((0,o.Z)().mark((function e(t,r){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.st)(d.g8.OnAtMention,[t,r]);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(e){return V.apply(this,arguments)}function V(){return(V=(0,i.Z)((0,o.Z)().mark((function e(t){var r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=he(t))){e.next=4;break}return e.next=4,(0,d.st)(d.g8.PassKeyToHost,[r]);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function G(e,t,r,n){return W.apply(this,arguments)}function W(){return(W=(0,i.Z)((0,o.Z)().mark((function e(t,r,n,i){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(d.g8.ProvideDataToSave);case 2:if(!e.sent){e.next=5;break}return e.next=5,(0,d.st)(d.g8.ProvideDataToSave,[t,r,n,i]);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(e,t,r){return K.apply(this,arguments)}function K(){return(K=(0,i.Z)((0,o.Z)().mark((function e(t,r,n){var i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=[t,r,n],e.next=3,(0,d.st)(d.g8.ReportActivityResult,i).catch(u.H);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Q(e){return X.apply(this,arguments)}function X(){return(X=(0,i.Z)((0,o.Z)().mark((function e(t){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.st)(d.g8.SendTelemetry,t);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $(e){return ee.apply(this,arguments)}function ee(){return(ee=(0,i.Z)((0,o.Z)().mark((function e(t){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(d.g8.SetCanProvideDataToSave);case 2:if(!e.sent){e.next=5;break}return e.next=5,(0,d.st)(d.g8.SetCanProvideDataToSave,[t]);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(e){return re.apply(this,arguments)}function re(){return(re=(0,i.Z)((0,o.Z)().mark((function e(t){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(d.g8.SaveEmbeddedData);case 2:if(!e.sent){e.next=5;break}return e.next=5,(0,d.st)(d.g8.SaveEmbeddedData,[t]);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ne(){return oe.apply(this,arguments)}function oe(){return(oe=(0,i.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.st)(d.g8.ShowPermissionCallout,[]);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ie(e,t,r){return ae.apply(this,arguments)}function ae(){return(ae=(0,i.Z)((0,o.Z)().mark((function e(t,r,n){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.Y8||(0,u.cM)("Size changed: ".concat(t," x ").concat(r)),e.next=3,(0,d.st)(d.g8.SizeChanged,[t,r,(0,d.KE)(n)]);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function se(e){return ce.apply(this,arguments)}function ce(){return(ce=(0,i.Z)((0,o.Z)().mark((function e(t){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.st)(d.g8.TeachingCalloutDismissed,[t]);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ue(){return le.apply(this,arguments)}function le(){return(le=(0,i.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.st)(d.g8.TeachingCalloutShown,[]);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function de(e){return fe.apply(this,arguments)}function fe(){return(fe=(0,i.Z)((0,o.Z)().mark((function e(t){var r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(d.g8.UpdateLoopInfo);case 2:if(!e.sent){e.next=6;break}return r=JSON.stringify(t),e.next=6,(0,d.st)(d.g8.UpdateLoopInfo,[r]);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function he(e){if("Escape"===e)return 27;(0,u.H)("Unsupported key: ".concat(e))}},84216:function(e,t,r){"use strict";function n(){return performance.now()}function o(){return performance.getEntriesByType("resource")}r.d(t,{E:function(){return o},i:function(){return n}})},55477:function(e,t,r){"use strict";r.d(t,{Uv:function(){return y},cM:function(){return p},xv:function(){return g}});var n=r(74165),o=r(15861),i=r(62190),a=r(26982),s=r(12338),c=r(39660),u=r(88861),l=r(83978),d=r(61960),f=new c.Q;function h(e){return"u!"+btoa(e).replace(/=+$/,"").replace("/","_").replace("+","-")}function p(){return v.apply(this,arguments)}function v(){return(v=(0,o.Z)((0,n.Z)().mark((function e(){var t,r,o,s,c,d,h,p;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new URL("https://graph.microsoft.com/v1.0/me/drive"),r=t.origin,e.next=4,(0,u.H8)();case 4:if(!e.sent){e.next=11;break}return s=function(e){return f.getToken([r],e)},e.next=8,(0,a.Xo)(s,t.href);case 8:o=e.sent,e.next=17;break;case 11:return e.next=13,(0,l.T)(r);case 13:return c=e.sent,e.next=16,fetch(t.href,{headers:{Authorization:"Bearer ".concat(c)}});case 16:o=e.sent;case 17:if(!o.ok){e.next=26;break}return e.next=20,o.json();case 20:return d=e.sent,h=null===d||void 0===d?void 0:d.webUrl,p=h?h.split("/").slice(0,-1).join("/"):h,e.abrupt("return",{id:(null===d||void 0===d?void 0:d.id)||"",siteUrl:p||""});case 26:throw new i.gz("Unable to get the Sharepoint drive info. [".concat(o.status," ").concat(o.statusText,"]"));case 27:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return m.apply(this,arguments)}function m(){return(m=(0,o.Z)((0,n.Z)().mark((function e(t){var r,o,a,c,p,v;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"string"===typeof t&&(t=new URL(t)),r=t.origin,o="".concat(r,"/_api/v2.0/shares/").concat(h(t.href)),(0,d.cM)("Getting file name from Sharepoint..."),e.next=6,(0,u.H8)();case 6:if(!e.sent){e.next=13;break}return c=function(e){return f.getToken([r],e)},e.next=10,(0,s.h)({url:o,getToken:c});case 10:a=e.sent.result,e.next=19;break;case 13:return e.next=15,(0,l.T)(r);case 15:return p=e.sent,e.next=18,fetch(o,{headers:{Authorization:"Bearer ".concat(p)}});case 18:a=e.sent;case 19:if(!a.ok){e.next=26;break}return e.next=22,a.json();case 22:return v=e.sent,e.abrupt("return",(null===v||void 0===v?void 0:v.name)||"");case 26:throw new i.gz("Unable to get filename from Sharepoint. [".concat(a.status," ").concat(a.statusText,"]"));case 27:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return b.apply(this,arguments)}function b(){return(b=(0,o.Z)((0,n.Z)().mark((function e(t){var r,o,s,c,d,h;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new URL("https://graph.microsoft.com/v1.0/me/drive/special/".concat(t)),o=r.origin,e.next=4,(0,u.H8)();case 4:if(!e.sent){e.next=11;break}return c=function(e){return f.getToken([o],e)},e.next=8,(0,a.Xo)(c,r.href);case 8:s=e.sent,e.next=17;break;case 11:return e.next=13,(0,l.T)(o);case 13:return d=e.sent,e.next=16,fetch(r.href,{headers:{Authorization:"Bearer ".concat(d)}});case 16:s=e.sent;case 17:if(!s.ok){e.next=24;break}return e.next=20,s.json();case 20:return h=e.sent,e.abrupt("return",(null===h||void 0===h?void 0:h.name)||"");case 24:throw new i.gz("Unable to get special folder name. [".concat(s.status," ").concat(s.statusText,"]"));case 25:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},78832:function(e,t,r){"use strict";function n(e){return new Promise((function(t,r){try{setTimeout(t,e)}catch(n){r(n)}}))}r.d(t,{_:function(){return n}})},49395:function(e,t,r){"use strict";r.d(t,{I:function(){return h},m:function(){return f}});r(72791);var n=r.p+"static/media/DarkBackground.f9c4b682680f49530d388ba0f2830809.svg";var o=r.p+"static/media/LightBackground.d93751152f3824d76f84f995fec9752f.svg";var i=r.p+"static/media/LightShimmerLoading.838ac9544853d68b3b1b62a5009ecef8.svg";var a=r.p+"static/media/DarkShimmerLoading.5bd608fb2a16127c459c6027848848ce.svg";var s=r.p+"static/media/DarkBackground_Old.df15325639cb5218602d4da3c7467955.svg";var c=r.p+"static/media/LightBackground_Old.f5416049e2f7d9abee2b5d9386b6fe77.svg";var u=r.p+"static/media/LightShimmerLoading_Old.ea2f880c2eab4e2bba069ba794390732.svg";var l=r.p+"static/media/DarkShimmerLoading_Old.e340d47723d2a30dc95ec74facf4f8b6.svg",d=r(14423);function f(){var e=document.getElementById(d.Nl),t=document.getElementById(d.OP);e&&(e.hidden=!0),null===t||void 0===t||t.removeAttribute("hidden")}function h(e,t){return t?e?{background:n,shimmer:a}:{background:o,shimmer:i}:e?{background:s,shimmer:l}:{background:c,shimmer:u}}},49069:function(e,t,r){"use strict";r.d(t,{D:function(){return d}});var n=r(74165),o=r(15861),i=r(15671),a=r(43144),s=r(11012),c=r(96914),u=r(14423),l=r(8280),d=function(){function e(t,r){(0,i.Z)(this,e),this.activity=void 0,this.activity=l.k.createActivity({eventName:"Office.Extensibility.Fluid.HostWebApp."+t,eventFlags:{dataCategories:s.K.DataCategories.ProductServiceUsage,diagnosticLevel:s.K.DiagnosticLevel.FullEvent}}),this.addStringDataField("HydrateId",r)}return(0,a.Z)(e,[{key:"endActivity",value:function(){var e=(0,o.Z)((0,n.Z)().mark((function e(t,r,o){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.activity){e.next=6;break}return e.next=3,this.addDataFieldsToActivity(r,o);case 3:this.activity.success=t,this.activity.setResult(r),u.yv&&this.activity.endNow();case 6:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"addInt64DataField",value:function(e,t){var r,n=(0,c.Kq)(e,Math.floor(t));this.activity&&(null!==(r=this.activity)&&void 0!==r&&r.dataFields?this.activity.dataFields.push(n):this.activity.dataFields=[n])}},{key:"addStringDataField",value:function(e,t){var r=(0,c.dt)(e,t);this.activity&&(this.activity.dataFields?this.activity.dataFields.push(r):this.activity.dataFields=[r])}},{key:"addBooleanDataField",value:function(e,t){var r=(0,c.UL)(e,t);this.activity&&(this.activity.dataFields?this.activity.dataFields.push(r):this.activity.dataFields=[r])}}]),e}()},75757:function(e,t,r){"use strict";r.d(t,{g:function(){return s}});var n=r(15671),o=r(43144),i=r(62190),a=r(84216),s=function(){function e(){(0,n.Z)(this,e),this.startTime=void 0,this.stopTime=void 0,this.isSuccess=!1,this.error=void 0}return(0,o.Z)(e,[{key:"measure",value:function(e){try{this.start();var t=e();return this.setSuccess(),t}catch(r){throw this.setFailure(r),r}}},{key:"start",value:function(t){if(this.startTime)throw new i.gz("PerfTracker.start() called when already started.");this.startTime=t||e.getTimePoint()}},{key:"stop",value:function(){var t=e.getTimePoint();if(!this.stopTime){if(!this.startTime)throw new i.gz("PerTracker.stop() called when not started.");this.stopTime=t}}},{key:"getDuration",value:function(){if(this.startTime){var t=(this.stopTime||e.getTimePoint())-this.startTime;return Math.floor(t)}return 0}},{key:"getDurationInSeconds",value:function(){return this.getDuration()/1e6}},{key:"setSuccess",value:function(){this.stop(),this.isSuccess=!0}},{key:"setFailure",value:function(e){this.stop(),this.isSuccess=!1,this.error=e}}],[{key:"getTimePoint",value:function(){return 1e3*(0,a.i)()}},{key:"startNew",value:function(t){var r=new e;return r.start(t),r}}]),e}()},4972:function(e,t,r){"use strict";r.d(t,{D:function(){return y},Y:function(){return b}});var n=r(74165),o=r(15861),i=r(15671),a=r(43144),s=r(60136),c=r(29388),u=r(39660),l=r(79650),d=r(94815),f=r(6232),h=r(49069),p=r(75757),v=r(84216),g=r(8663),m=r(62190),y=function(e){return e[e.Success=0]="Success",e[e.LoadComponentError=1]="LoadComponentError",e[e.RenderComponentError_PromiseRejected=2]="RenderComponentError_PromiseRejected",e[e.RenderComponentError_NoComponent=3]="RenderComponentError_NoComponent",e[e.RenderComponentError_CannotRender=4]="RenderComponentError_CannotRender",e}({}),b=function(e){(0,s.Z)(r,e);var t=(0,c.Z)(r);function r(e,n,o,a){var s;return(0,i.Z)(this,r),(s=t.call(this,"ShowComponent",e)).WebAppMainPerfTracker=void 0,s.LoadPerfTracker=void 0,s.InitialRenderPerfTracker=void 0,s.AppLazyImportTracker=void 0,s.AppLazyStartTracker=void 0,s.ComponentRenderPerfTracker=void 0,s.GetTokenCount=void 0,s.GetTokenTotalDuration=void 0,s.EndTime=void 0,s.EnforceInformationProtectionPerfTracker=void 0,s.odspModuleImportTracker=void 0,s.addStringDataField("ScenarioName",n),s.addStringDataField("Fluid_Audience",o),s.setWebAppMainPerfTracker(a),s}return(0,a.Z)(r,[{key:"setWebAppMainPerfTracker",value:function(e){this.WebAppMainPerfTracker=p.g.startNew(e)}},{key:"setLoadPerfTracker",value:function(){this.LoadPerfTracker=p.g.startNew()}},{key:"setInitialRenderPerfTracker",value:function(){this.InitialRenderPerfTracker=p.g.startNew()}},{key:"setAppLazyImportPerfTracker",value:function(){this.AppLazyImportTracker=p.g.startNew()}},{key:"setAppLazyStartPerfTracker",value:function(){this.AppLazyStartTracker=p.g.startNew()}},{key:"setComponentRenderPerfTracker",value:function(){this.ComponentRenderPerfTracker=p.g.startNew()}},{key:"setEnforceInformationProtectionPerfTracker",value:function(){this.EnforceInformationProtectionPerfTracker=p.g.startNew()}},{key:"setGetTokenCount",value:function(e){this.GetTokenCount=e}},{key:"setGetTokenTotalDuration",value:function(e){this.GetTokenTotalDuration=e}},{key:"onLoadComplete",value:function(e){var t;null===(t=this.LoadPerfTracker)||void 0===t||t.setSuccess(),e instanceof u.Q&&(this.setGetTokenCount(e.getTokenCallCount),this.setGetTokenTotalDuration(e.getTokenTotalDuration))}},{key:"addResourceMetrics",value:function(){var e=(0,v.E)(),t=e.find((function(e){return e.name.match("https://fa000000084.resources.office.net/static/js/268.(.*).chunk.js")})),r=e.find((function(e){return e.name.match("https://fa000000084.resources.office.net/static/js/main.(.*).chunk.js")}));t&&(void 0!=t.startTime&&this.addInt64DataField("LoadResourceBundleStart",t.startTime),void 0!=t.duration&&this.addInt64DataField("LoadResourceBundleDuration",t.duration)),r&&(void 0!=r.startTime&&this.addInt64DataField("LoadResourceMainStart",r.startTime),void 0!=r.duration&&this.addInt64DataField("LoadResourceMainDuration",r.duration))}},{key:"sendTelemetryForSuccess",value:function(){var e=(0,o.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.endActivity(!0,y.Success);case 2:this.EndTime=(0,l.h)(),(0,d.z)(f.l.Success_Hydrated);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"sendTelemetryForFailure",value:function(){var e=(0,o.Z)((0,n.Z)().mark((function e(t,r,o){var i,a,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=null===o||void 0===o?void 0:o.errorType,a=null===o||void 0===o?void 0:o.name,s=(0,m.SS)(o)||i||a,e.next=5,this.endActivity(!1,t,s);case 5:this.EndTime=(0,l.h)(),(0,d.z)(r);case 7:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"addDataFieldsToActivity",value:function(){var e=(0,o.Z)((0,n.Z)().mark((function e(t,r){var o,i,a,s,c,u,l,d,f,h,p,v,m,b,k;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(null===(o=this.WebAppMainPerfTracker)||void 0===o?void 0:o.startTime)&&this.addInt64DataField("WebAppMainStartTime",this.WebAppMainPerfTracker.startTime),(null===(i=this.WebAppMainPerfTracker)||void 0===i?void 0:i.getDuration)&&this.addInt64DataField("WebAppMainDuration",this.WebAppMainPerfTracker.getDuration()),this.WebAppMainPerfTracker&&this.addBooleanDataField("WebAppMainSuccess",this.WebAppMainPerfTracker.isSuccess),(null===(a=this.LoadPerfTracker)||void 0===a?void 0:a.startTime)&&this.addInt64DataField("LoadStartTime",this.LoadPerfTracker.startTime),(null===(s=this.LoadPerfTracker)||void 0===s?void 0:s.getDuration)&&this.addInt64DataField("LoadDuration",this.LoadPerfTracker.getDuration()),this.LoadPerfTracker&&this.addBooleanDataField("LoadSuccess",this.LoadPerfTracker.isSuccess),(null===(c=this.AppLazyImportTracker)||void 0===c?void 0:c.startTime)&&this.addInt64DataField("AppLazyImportStartTime",this.AppLazyImportTracker.startTime),(null===(u=this.AppLazyImportTracker)||void 0===u?void 0:u.getDuration)&&this.addInt64DataField("AppLazyImportDuration",this.AppLazyImportTracker.getDuration()),this.AppLazyImportTracker&&this.addBooleanDataField("AppLazyImportSuccess",this.AppLazyImportTracker.isSuccess),(null===(l=this.AppLazyStartTracker)||void 0===l?void 0:l.startTime)&&this.addInt64DataField("AppLazyStartStartTime",this.AppLazyStartTracker.startTime),(null===(d=this.AppLazyStartTracker)||void 0===d?void 0:d.getDuration)&&this.addInt64DataField("AppLazyStartDuration",this.AppLazyStartTracker.getDuration()),this.AppLazyStartTracker&&this.addBooleanDataField("AppLazyStartSuccess",this.AppLazyStartTracker.isSuccess),(null===(f=this.InitialRenderPerfTracker)||void 0===f?void 0:f.startTime)&&this.addInt64DataField("InitialRenderStartTime",this.InitialRenderPerfTracker.startTime),(null===(h=this.InitialRenderPerfTracker)||void 0===h?void 0:h.getDuration)&&this.addInt64DataField("InitialRenderDuration",this.InitialRenderPerfTracker.getDuration()),this.InitialRenderPerfTracker&&this.addBooleanDataField("InitialRenderSuccess",this.InitialRenderPerfTracker.isSuccess),(null===(p=this.ComponentRenderPerfTracker)||void 0===p?void 0:p.startTime)&&this.addInt64DataField("ComponentRenderStartTime",this.ComponentRenderPerfTracker.startTime),(null===(v=this.ComponentRenderPerfTracker)||void 0===v?void 0:v.getDuration)&&this.addInt64DataField("ComponentRenderDuration",this.ComponentRenderPerfTracker.getDuration()),this.ComponentRenderPerfTracker&&this.addBooleanDataField("ComponentRenderSuccess",this.ComponentRenderPerfTracker.isSuccess),(null===(m=this.EnforceInformationProtectionPerfTracker)||void 0===m?void 0:m.getDuration)&&this.addInt64DataField("EnforceInformationProtectionDuration",this.EnforceInformationProtectionPerfTracker.getDuration()),this.addBooleanDataField("IsUsingServiceDeliveredODSPDriver",g.Rx),this.GetTokenCount&&this.addInt64DataField("GetTokenCount",this.GetTokenCount),this.GetTokenTotalDuration&&this.addInt64DataField("GetTokenTotalDuration",this.GetTokenTotalDuration),(null===(b=this.odspModuleImportTracker)||void 0===b?void 0:b.startTime)&&this.addInt64DataField("OdspModuleImportStartTime",this.odspModuleImportTracker.startTime),(null===(k=this.odspModuleImportTracker)||void 0===k?void 0:k.getDuration)&&this.addInt64DataField("OdspModuleImportDuration",this.odspModuleImportTracker.getDuration()),this.addResourceMetrics(),this.addStringDataField("ResultType",y[t]),r&&this.addStringDataField("ErrorMessage",r);case 27:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()}]),r}(h.D)},8280:function(e,t,r){"use strict";r.d(t,{k:function(){return i}});var n=r(95244),o=r(94497),i=function(){var e=new n.h;return e.addSink(o.y),e.setTenantToken("Office.Extensibility","db334b301e7b474db5e0f02f07c51a47-a1b5bc36-1bbe-482f-a64a-c2d9cb606706-7439",1755),e}()},94815:function(e,t,r){"use strict";r.d(t,{W:function(){return u},z:function(){return l}});var n=r(4942),o=r(62908),i=r(61960),a=r(52230),s=r(43806),c=r(6232);function u(e){var t,r=(t={},(0,n.Z)(t,o.u.clientSessionExpiredError,c.l.Error_FluidContainer_ClientSessionExpiredError),(0,n.Z)(t,o.u.dataCorruptionError,c.l.Error_FluidContainer_DataCorruption),(0,n.Z)(t,o.u.dataProcessingError,c.l.Error_FluidContainer_DataProcessingError),(0,n.Z)(t,o.u.genericError,c.l.Error_FluidContainer_GeneralError),(0,n.Z)(t,o.u.throttlingError,c.l.Error_FluidContainer_ThrottlingError),(0,n.Z)(t,o.u.usageError,c.l.Error_FluidContainer_UsageError),(0,n.Z)(t,o.td.RootComponentCreateFailed,c.l.Error_FluidContainerLoad_RootComponentCreateFailed),(0,n.Z)(t,o.td.RaasNotSupported,c.l.Error_FluidContainerLoad_RaasNotSupported),(0,n.Z)(t,o.C1.authorizationError,c.l.ExpectedError_FluidDriver_AuthorizationError),(0,n.Z)(t,o.C1.deltaStreamConnectionForbidden,c.l.Error_FluidDriver_DeltaStreamConnectionForbidden),(0,n.Z)(t,o.C1.fetchFailure,c.l.ExpectedError_FluidDriver_FetchFailure),(0,n.Z)(t,o.C1.fileNotFoundOrAccessDeniedError,c.l.ExpectedError_FluidDriver_FileNotFoundOrAccessDenied),(0,n.Z)(t,o.C1.fileOverwrittenInStorage,c.l.Error_FluidDriver_FileOverwrittenInStorage),(0,n.Z)(t,o.C1.fluidInvalidSchema,c.l.Error_FluidDriver_FluidInvalidSchema),(0,n.Z)(t,o.C1.genericError,c.l.Error_FluidDriver_GenericError),(0,n.Z)(t,o.C1.genericNetworkError,c.l.Error_FluidDriver_GenericNetworkError),(0,n.Z)(t,o.C1.incorrectServerResponse,c.l.Error_FluidDriver_IncorrectServerResponse),(0,n.Z)(t,o.C1.locationRedirection,c.l.Error_FluidDriver_LocationRedirection),(0,n.Z)(t,o.C1.offlineError,c.l.ExpectedError_FluidDriver_OfflineError),(0,n.Z)(t,o.C1.throttlingError,c.l.Error_FluidDriver_ThrottlingError),(0,n.Z)(t,o.C1.usageError,c.l.Error_FluidDriver_UsageError),(0,n.Z)(t,o.C1.unsupportedClientProtocolVersion,c.l.Error_FluidDriver_UnsupportedClientProtocolVersion),(0,n.Z)(t,o.C1.writeError,c.l.Error_FluidDriver_WriteError),(0,n.Z)(t,o.C1.fileIsLocked,c.l.Error_FluidDriver_FileIsLocked),(0,n.Z)(t,o.xO.cannotCatchUp,c.l.Error_FluidOdsp_CannotCatchUp),(0,n.Z)(t,o.xO.fetchTimeout,c.l.Error_FluidOdsp_FetchTimeout),(0,n.Z)(t,o.xO.fetchTokenError,c.l.Error_FluidOdsp_FetchTokenError),(0,n.Z)(t,o.xO.fluidNotEnabled,c.l.ExpectedError_FluidOdsp_FluidNotEnabled),(0,n.Z)(t,o.xO.invalidFileNameError,c.l.Error_FluidOdsp_InvalidFileNameError),(0,n.Z)(t,o.xO.outOfStorageError,c.l.Error_FluidOdsp_OutOfStorageError),(0,n.Z)(t,o.xO.serviceReadOnly,c.l.Error_FluidOdsp_ServiceReadOnly),(0,n.Z)(t,o.xO.snapshotTooBig,c.l.Error_FluidOdsp_SnapshotTooBig),(0,n.Z)(t,o._6.ComponentNotFound,c.l.Error_FluidOWH_ComponentNotFound),(0,n.Z)(t,o._6.ContainerUpgradeRequired,c.l.Error_FluidOWH_ContainerUpgradeRequired),(0,n.Z)(t,o._6.IframeLoadFailed,c.l.Error_FluidOWH_IFrameLoadFailed),(0,n.Z)(t,o.q0,c.l.Error_Fluid_UnknownError),t);return e?r[e]:c.l.Error_Fluid_Undefined}function l(e){var t=function(e){switch(e){case c.l.Success_Hydrated:case c.l.Success_NoFluidUrl:case c.l.ExpectedError_FluidDriver_AuthorizationError:case c.l.ExpectedError_FluidDriver_FetchFailure:case c.l.ExpectedError_FluidDriver_FileNotFoundOrAccessDenied:case c.l.ExpectedError_FluidDriver_OfflineError:case c.l.ExpectedError_FluidOdsp_FluidNotEnabled:case c.l.ExpectedError_FluidHostWebApp_CannotFetchContainerManifest:return!0;default:return!1}}(e);return(0,i.cM)("Hydrate ".concat(t?"succeeded":"failed",": ").concat(c.l[e]," (").concat(e,").")),(0,a.X_)(s.jd.Hydrate,t,e)}},6232:function(e,t,r){"use strict";r.d(t,{l:function(){return n}});var n=function(e){return e[e.Success_Hydrated=0]="Success_Hydrated",e[e.Success_E2oNotViewed=1]="Success_E2oNotViewed",e[e.Success_NoFluidUrl=2]="Success_NoFluidUrl",e[e.Success_Aborted=3]="Success_Aborted",e[e.Error_FluidHostWebApp_Exception=500]="Error_FluidHostWebApp_Exception",e[e.ExpectedError_FluidHostWebApp_CannotFetchContainerManifest=501]="ExpectedError_FluidHostWebApp_CannotFetchContainerManifest",e[e.Error_Fluid_Undefined=1e3]="Error_Fluid_Undefined",e[e.Error_Fluid_UnknownError=1001]="Error_Fluid_UnknownError",e[e.Error_RenderFailed=1002]="Error_RenderFailed",e[e.Error_FluidContainer_DataCorruption=2e3]="Error_FluidContainer_DataCorruption",e[e.Error_FluidContainer_GeneralError=2001]="Error_FluidContainer_GeneralError",e[e.Error_FluidContainer_ThrottlingError=2002]="Error_FluidContainer_ThrottlingError",e[e.Error_FluidContainer_DataProcessingError=2003]="Error_FluidContainer_DataProcessingError",e[e.Error_FluidContainer_UsageError=2004]="Error_FluidContainer_UsageError",e[e.Error_FluidContainer_ClientSessionExpiredError=2005]="Error_FluidContainer_ClientSessionExpiredError",e[e.ExpectedError_FluidDriver_AuthorizationError=3e3]="ExpectedError_FluidDriver_AuthorizationError",e[e.ExpectedError_FluidDriver_FetchFailure=3001]="ExpectedError_FluidDriver_FetchFailure",e[e.ExpectedError_FluidDriver_FileNotFoundOrAccessDenied=3002]="ExpectedError_FluidDriver_FileNotFoundOrAccessDenied",e[e.Error_FluidDriver_GenericError=3003]="Error_FluidDriver_GenericError",e[e.Error_FluidDriver_GenericNetworkError=3004]="Error_FluidDriver_GenericNetworkError",e[e.Error_FluidDriver_IncorrectServerResponse=3005]="Error_FluidDriver_IncorrectServerResponse",e[e.ExpectedError_FluidDriver_OfflineError=3006]="ExpectedError_FluidDriver_OfflineError",e[e.Error_FluidDriver_ThrottlingError=3007]="Error_FluidDriver_ThrottlingError",e[e.Error_FluidDriver_UnsupportedClientProtocolVersion=3008]="Error_FluidDriver_UnsupportedClientProtocolVersion",e[e.Error_FluidDriver_WriteError=3009]="Error_FluidDriver_WriteError",e[e.Error_FluidDriver_FileOverwrittenInStorage=3010]="Error_FluidDriver_FileOverwrittenInStorage",e[e.Error_FluidDriver_DeltaStreamConnectionForbidden=3011]="Error_FluidDriver_DeltaStreamConnectionForbidden",e[e.Error_FluidDriver_LocationRedirection=3012]="Error_FluidDriver_LocationRedirection",e[e.Error_FluidDriver_FluidInvalidSchema=3013]="Error_FluidDriver_FluidInvalidSchema",e[e.Error_FluidDriver_UsageError=3014]="Error_FluidDriver_UsageError",e[e.Error_FluidDriver_FileIsLocked=3015]="Error_FluidDriver_FileIsLocked",e[e.Error_FluidOdsp_CannotCatchUp=4e3]="Error_FluidOdsp_CannotCatchUp",e[e.Error_FluidOdsp_FetchTimeout=4001]="Error_FluidOdsp_FetchTimeout",e[e.ExpectedError_FluidOdsp_FluidNotEnabled=4002]="ExpectedError_FluidOdsp_FluidNotEnabled",e[e.Error_FluidOdsp_InvalidFileNameError=4003]="Error_FluidOdsp_InvalidFileNameError",e[e.Error_FluidOdsp_OutOfStorageError=4004]="Error_FluidOdsp_OutOfStorageError",e[e.Error_FluidOdsp_SnapshotTooBig=4005]="Error_FluidOdsp_SnapshotTooBig",e[e.Error_FluidOdsp_FetchTokenError=4006]="Error_FluidOdsp_FetchTokenError",e[e.Error_FluidOdsp_ServiceReadOnly=4007]="Error_FluidOdsp_ServiceReadOnly",e[e.Error_FluidOWH_ContainerUpgradeRequired=5e3]="Error_FluidOWH_ContainerUpgradeRequired",e[e.Error_FluidOWH_IFrameLoadFailed=5001]="Error_FluidOWH_IFrameLoadFailed",e[e.Error_FluidOWH_ComponentNotFound=5002]="Error_FluidOWH_ComponentNotFound",e[e.Error_FluidContainerLoad_RootComponentCreateFailed=6e3]="Error_FluidContainerLoad_RootComponentCreateFailed",e[e.Error_FluidContainerLoad_RaasNotSupported=6001]="Error_FluidContainerLoad_RaasNotSupported",e}({})},94497:function(e,t,r){"use strict";r.d(t,{y:function(){return p}});var n=r(74165),o=r(15861),i=r(15671),a=r(43144),s=r(52230),c=r(50224),u=r(78832),l=[],d=!1,f=void 0,h=function(){function e(){(0,i.Z)(this,e)}return(0,a.Z)(e,[{key:"LoopTelemetrySink",get:function(){return this}},{key:"sendTelemetryEvent",value:function(){var e=(0,o.Z)((0,n.Z)().mark((function e(t){var r,o,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==f){e.next=4;break}return e.next=3,(0,c.g)();case 3:f=e.sent;case 4:o=JSON.stringify(t),(i=null!==(r=f.telemetryBatchDurationMs)&&void 0!==r?r:0)>0?(l.push(o),v(i)):(0,s.P3)([o]);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),p=new h;function v(e){return g.apply(this,arguments)}function g(){return(g=(0,o.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d){e.next=8;break}return d=!0,e.next=4,(0,u._)(t);case 4:d=!1,r=l,l=[],(0,s.P3)(r);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},55617:function(e,t,r){"use strict";r.d(t,{jl:function(){return u},TB:function(){return h},Ev:function(){return a},T0:function(){return c},TV:function(){return s},$o:function(){return f},Rb:function(){return p}});r(29331);var n=r(47699),o=function(e){return e[e.Default=0]="Default",e[e.Dark=1]="Dark",e}({}),i=new Map([[o[o.Default],{name:"Default Theme",properties:[]}],[o[o.Dark],{name:"Dark Theme",properties:[[n.Yf.black,"#ffffff"],[n.Yf.white,"#262626"],[n.Yf.neutralDark,"#ffffff"],[n.Yf.neutralPrimary,"#ffffff"],[n.Yf.neutralPrimaryAlt,"#f8f8f8"],[n.Yf.neutralSecondary,"#f4f4f4"],[n.Yf.neutralTertiary,"#eaeaea"],[n.Yf.neutralTertiaryAlt,"#c8c8c8"],[n.Yf.neutralQuaternary,"#2e2e2e"],[n.Yf.neutralLight,"#000000"],[n.Yf.neutralQuaternaryAlt,"#2e2e2e"],[n.Yf.neutralLighter,"#212121"],[n.Yf.neutralLighterAlt,"#363636"],[n.Yf.redDark,"#e81123"],[n.Yf.purple,"#9c89e9"],[n.Yf.themeDarker,"#cfd3d5"],[n.Yf.themeDark,"#bcd6e6"],[n.Yf.themeDarkAlt,"#afd8f0"],[n.Yf.themePrimary,"#79b0c8"],[n.Yf.themeSecondary,"#588b9e"],[n.Yf.themeTertiary,"#597c87"],[n.Yf.themeLight,"#495e66"],[n.Yf.themeLighter,"#485b60"],[n.Yf.themeLighterAlt,"#3c4547"],[n.Yf.EntityRecognitionUnderline,"#8a8886"],[n.Yf.EntityRecognitionHoverHighlight,"#3b3a39"],[n.Yf.TaskRecognitionUnderline,"#8a8886"],[n.Yf.TaskRecognitionHoverHighlight,"#3b3a39"],[n.qH.ThemeName,n.Dc.Dark]]}]]),a="#e49fff",s="#EB0000",c="#FF4D4D",u="#262626",l="#ffffff",d=function(e){return e[e.Colorful=0]="Colorful",e[e.VeryDark=1]="VeryDark",e[e.Black=2]="Black",e[e.Fresh=3]="Fresh",e}({});function f(e){return e===d.Black}function h(e){return e?i.get(o[o.Dark])||{name:"Default Theme",properties:[]}:i.get(o[o.Default])||{name:"Default Theme",properties:[]}}function p(e){var t,r;null===(t=document)||void 0===t||null===(r=t.body)||void 0===r||r.style.setProperty("background-color",e?u:l)}},79650:function(e,t,r){"use strict";function n(){return(new Date).getTime()}r.d(t,{h:function(){return n}})},83978:function(e,t,r){"use strict";r.d(t,{T:function(){return u},Z:function(){return c}});var n=r(74165),o=r(15861),i=r(15671),a=r(43144),s=r(52230),c=function(){function e(){(0,i.Z)(this,e),this.tokenMap=new Map,this.pendingRequests=new Map,this.tokenExpirationDuration=18e4,this.isCacheEnabled=!1}return(0,a.Z)(e,[{key:"generateTokenKey",value:function(e,t){return"".concat(e,"|").concat(t)}},{key:"getToken",value:function(){var t=(0,o.Z)((0,n.Z)().mark((function t(r,o,i){var a,c,u,l,d,f,h,p;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.isCacheEnabled){t.next=5;break}return t.next=3,(0,s.LP)(r,o);case 3:return a=t.sent,t.abrupt("return",{token:a});case 5:if(c=this.generateTokenKey(r,o),!i){t.next=10;break}this.tokenMap.delete(c),t.next=18;break;case 10:if(!(u=this.tokenMap.get(c))){t.next=18;break}if(!(e.getCurrentTime()>=u.expiration)){t.next=16;break}this.tokenMap.delete(c),t.next=18;break;case 16:return l=u.token,t.abrupt("return",{token:l,fromCache:!0});case 18:if(!(d=this.pendingRequests.get(c))){t.next=24;break}return t.next=22,d;case 22:return f=t.sent,t.abrupt("return",{token:f});case 24:return h=(0,s.LP)(r,o),this.pendingRequests.set(c,h),t.prev=26,t.next=29,h;case 29:return p=t.sent,this.tokenMap.set(c,{token:p,expiration:e.getCurrentTime()+this.tokenExpirationDuration}),t.abrupt("return",{token:p});case 32:return t.prev=32,this.pendingRequests.delete(c),t.finish(32);case 35:case"end":return t.stop()}}),t,this,[[26,,32,35]])})));return function(e,r,n){return t.apply(this,arguments)}}()}],[{key:"getCurrentTime",value:function(){return(new Date).getTime()}},{key:"GetInstance",value:function(){return null==this.instance&&(this.instance=new e),this.instance}}]),e}();function u(e,t,r){return l.apply(this,arguments)}function l(){return(l=(0,o.Z)((0,n.Z)().mark((function e(t,r,o){var i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.GetInstance().getToken(t,r,o);case 2:return i=e.sent.token,e.abrupt("return",i);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}c.instance=void 0},72278:function(e,t,r){"use strict";r.d(t,{E:function(){return n}});var n="@1js/card-loop"},46765:function(e,t,r){"use strict";function n(e){i!==e&&(i=e)}function o(){return void 0===i&&(i="undefined"!==typeof document&&!!document.documentElement&&"rtl"===document.documentElement.getAttribute("dir")),i}var i;function a(){return{rtl:o()}}r.d(t,{Eo:function(){return a},ok:function(){return n}}),i=o()},79248:function(e,t,r){"use strict";r.d(t,{Y:function(){return d}});var n,o=r(75971),i=0,a=1,s=2,c="__stylesheet__",u="undefined"!==typeof navigator&&/rv:11.0/.test(navigator.userAgent),l={};try{l=window||{}}catch(f){}var d=function(){function e(e,t){var r,n,s,c,u,l;this._rules=[],this._preservedRules=[],this._counter=0,this._keyToClassName={},this._onInsertRuleCallbacks=[],this._onResetCallbacks=[],this._classNameToArgs={},this._config=(0,o.__assign)({injectionMode:"undefined"===typeof document?i:a,defaultPrefix:"css",namespace:void 0,cspSettings:void 0},e),this._classNameToArgs=null!==(r=null===t||void 0===t?void 0:t.classNameToArgs)&&void 0!==r?r:this._classNameToArgs,this._counter=null!==(n=null===t||void 0===t?void 0:t.counter)&&void 0!==n?n:this._counter,this._keyToClassName=null!==(c=null!==(s=this._config.classNameCache)&&void 0!==s?s:null===t||void 0===t?void 0:t.keyToClassName)&&void 0!==c?c:this._keyToClassName,this._preservedRules=null!==(u=null===t||void 0===t?void 0:t.preservedRules)&&void 0!==u?u:this._preservedRules,this._rules=null!==(l=null===t||void 0===t?void 0:t.rules)&&void 0!==l?l:this._rules}return e.getInstance=function(){if(!(n=l[c])||n._lastStyleElement&&n._lastStyleElement.ownerDocument!==document){var t=(null===l||void 0===l?void 0:l.FabricConfig)||{},r=new e(t.mergeStyles,t.serializedStylesheet);n=r,l[c]=r}return n},e.prototype.serialize=function(){return JSON.stringify({classNameToArgs:this._classNameToArgs,counter:this._counter,keyToClassName:this._keyToClassName,preservedRules:this._preservedRules,rules:this._rules})},e.prototype.setConfig=function(e){this._config=(0,o.__assign)((0,o.__assign)({},this._config),e)},e.prototype.onReset=function(e){var t=this;return this._onResetCallbacks.push(e),function(){t._onResetCallbacks=t._onResetCallbacks.filter((function(t){return t!==e}))}},e.prototype.onInsertRule=function(e){var t=this;return this._onInsertRuleCallbacks.push(e),function(){t._onInsertRuleCallbacks=t._onInsertRuleCallbacks.filter((function(t){return t!==e}))}},e.prototype.getClassName=function(e){var t=this._config.namespace,r=e||this._config.defaultPrefix;return"".concat(t?t+"-":"").concat(r,"-").concat(this._counter++)},e.prototype.cacheClassName=function(e,t,r,n){this._keyToClassName[t]=e,this._classNameToArgs[e]={args:r,rules:n}},e.prototype.classNameFromKey=function(e){return this._keyToClassName[e]},e.prototype.getClassNameCache=function(){return this._keyToClassName},e.prototype.argsFromClassName=function(e){var t=this._classNameToArgs[e];return t&&t.args},e.prototype.insertedRulesFromClassName=function(e){var t=this._classNameToArgs[e];return t&&t.rules},e.prototype.insertRule=function(e,t){var r=this._config.injectionMode,n=r!==i?this._getStyleElement():void 0;if(t&&this._preservedRules.push(e),n)switch(r){case a:var o=n.sheet;try{o.insertRule(e,o.cssRules.length)}catch(c){}break;case s:n.appendChild(document.createTextNode(e))}else this._rules.push(e);this._config.onInsertRule&&this._config.onInsertRule(e),this._onInsertRuleCallbacks.forEach((function(e){return e()}))},e.prototype.getRules=function(e){return(e?this._preservedRules.join(""):"")+this._rules.join("")},e.prototype.reset=function(){this._rules=[],this._counter=0,this._classNameToArgs={},this._keyToClassName={},this._onResetCallbacks.forEach((function(e){return e()}))},e.prototype.resetKeys=function(){this._keyToClassName={}},e.prototype._getStyleElement=function(){var e=this;return this._styleElement||"undefined"===typeof document||(this._styleElement=this._createStyleElement(),u||window.requestAnimationFrame((function(){e._styleElement=void 0}))),this._styleElement},e.prototype._createStyleElement=function(){var e=document.head,t=document.createElement("style"),r=null;t.setAttribute("data-merge-styles","true");var n=this._config.cspSettings;if(n&&n.nonce&&t.setAttribute("nonce",n.nonce),this._lastStyleElement)r=this._lastStyleElement.nextElementSibling;else{var o=this._findPlaceholderStyleTag();r=o?o.nextElementSibling:e.childNodes[0]}return e.insertBefore(t,e.contains(r)?r:null),this._lastStyleElement=t,t},e.prototype._findPlaceholderStyleTag=function(){var e=document.head;return e?e.querySelector("style[data-merge-styles]"):null},e}()},81166:function(e,t,r){"use strict";r.d(t,{j:function(){return a}});var n=r(46765),o=r(79248),i=r(26435);function a(e){var t=o.Y.getInstance(),r=(0,i.dH)((0,n.Eo)(),e);if(!t.classNameFromKey(r)){var a=t.getClassName();t.insertRule("@font-face{".concat(r,"}"),!0),t.cacheClassName(a,r,[],["font-face",r])}}},26435:function(e,t,r){"use strict";r.d(t,{Jh:function(){return T},dH:function(){return E},AE:function(){return N},aj:function(){return Z}});var n,o=r(75971),i=r(79248),a={};function s(e,t){var r=e[t];"-"!==r.charAt(0)&&(e[t]=a[r]=a[r]||r.replace(/([A-Z])/g,"-$1").toLowerCase())}var c={"user-select":1};function u(e,t){var r=function(){var e;if(!n){var t="undefined"!==typeof document?document:void 0,r="undefined"!==typeof navigator?navigator:void 0,o=null===(e=null===r||void 0===r?void 0:r.userAgent)||void 0===e?void 0:e.toLowerCase();n=t?{isWebkit:!(!t||!("WebkitAppearance"in t.documentElement.style)),isMoz:!!(o&&o.indexOf("firefox")>-1),isOpera:!!(o&&o.indexOf("opera")>-1),isMs:!(!r||!/rv:11.0/i.test(r.userAgent)&&!/Edge\/\d./i.test(navigator.userAgent))}:{isWebkit:!0,isMoz:!0,isOpera:!0,isMs:!0}}return n}(),o=e[t];if(c[o]){var i=e[t+1];c[o]&&(r.isWebkit&&e.push("-webkit-"+o,i),r.isMoz&&e.push("-moz-"+o,i),r.isMs&&e.push("-ms-"+o,i),r.isOpera&&e.push("-o-"+o,i))}}var l,d=["column-count","font-weight","flex","flex-grow","flex-shrink","fill-opacity","opacity","order","z-index","zoom"];function f(e,t){var r=e[t],n=e[t+1];if("number"===typeof n){var o=d.indexOf(r)>-1,i=r.indexOf("--")>-1,a=o||i?"":"px";e[t+1]="".concat(n).concat(a)}}var h="left",p="right",v="@noflip",g=((l={})[h]=p,l[p]=h,l),m={"w-resize":"e-resize","sw-resize":"se-resize","nw-resize":"ne-resize"};function y(e,t,r){if(e.rtl){var n=t[r];if(!n)return;var o=t[r+1];if("string"===typeof o&&o.indexOf(v)>=0)t[r+1]=o.replace(/\s*(?:\/\*\s*)?\@noflip\b(?:\s*\*\/)?\s*?/g,"");else if(n.indexOf(h)>=0)t[r]=n.replace(h,p);else if(n.indexOf(p)>=0)t[r]=n.replace(p,h);else if(String(o).indexOf(h)>=0)t[r+1]=o.replace(h,p);else if(String(o).indexOf(p)>=0)t[r+1]=o.replace(p,h);else if(g[n])t[r]=g[n];else if(m[o])t[r+1]=m[o];else switch(n){case"margin":case"padding":t[r+1]=function(e){if("string"===typeof e){var t=e.split(" ");if(4===t.length)return"".concat(t[0]," ").concat(t[3]," ").concat(t[2]," ").concat(t[1])}return e}(o);break;case"box-shadow":t[r+1]=function(e,t){var r=e.split(" "),n=parseInt(r[t],10);return r[0]=r[0].replace(String(n),String(-1*n)),r.join(" ")}(o,0)}}}var b="displayName";var k=/\:global\((.+?)\)/g;function S(e,t){return e.indexOf(":global(")>=0?e.replace(k,"$1"):0===e.indexOf(":")?t+e:e.indexOf("&")<0?t+" "+e:e}function C(e,t,r,n){void 0===t&&(t={__order:[]}),0===r.indexOf("@")?w([n],t,r=r+"{"+e):r.indexOf(",")>-1?function(e){if(!k.test(e))return e;for(var t=[],r=/\:global\((.+?)\)/g,n=null;n=r.exec(e);)n[1].indexOf(",")>-1&&t.push([n.index,n.index+n[0].length,n[1].split(",").map((function(e){return":global(".concat(e.trim(),")")})).join(", ")]);return t.reverse().reduce((function(e,t){var r=t[0],n=t[1],o=t[2];return e.slice(0,r)+o+e.slice(n)}),e)}(r).split(",").map((function(e){return e.trim()})).forEach((function(r){return w([n],t,S(r,e))})):w([n],t,S(r,e))}function w(e,t,r){void 0===t&&(t={__order:[]}),void 0===r&&(r="&");var n=i.Y.getInstance(),o=t[r];o||(o={},t[r]=o,t.__order.push(r));for(var a=0,s=e;a<s.length;a++){var c=s[a];if("string"===typeof c){var u=n.argsFromClassName(c);u&&w(u,t,r)}else if(Array.isArray(c))w(c,t,r);else for(var l in c)if(c.hasOwnProperty(l)){var d=c[l];if("selectors"===l){var f=c.selectors;for(var h in f)f.hasOwnProperty(h)&&C(r,t,h,f[h])}else"object"===typeof d?null!==d&&C(r,t,l,d):void 0!==d&&("margin"===l||"padding"===l?x(o,l,d):o[l]=d)}}return t}function x(e,t,r){var n="string"===typeof r?function(e){for(var t=[],r=0,n=0,o=0;o<e.length;o++)switch(e[o]){case"(":n++;break;case")":n&&n--;break;case"\t":case" ":n||(o>r&&t.push(e.substring(r,o)),r=o+1)}return r<e.length&&t.push(e.substring(r)),t}(r):[r];0===n.length&&n.push(r),"!important"===n[n.length-1]&&(n=n.slice(0,-1).map((function(e){return e+" !important"}))),e[t+"Top"]=n[0],e[t+"Right"]=n[1]||n[0],e[t+"Bottom"]=n[2]||n[0],e[t+"Left"]=n[3]||n[1]||n[0]}function P(e,t){return t<=0?"":1===t?e:e+P(e,t-1)}function E(e,t){if(!t)return"";var r=[];for(var n in t)t.hasOwnProperty(n)&&n!==b&&void 0!==t[n]&&r.push(n,t[n]);for(var o=0;o<r.length;o+=2)s(r,o),f(r,o),y(e,r,o),u(r,o);for(o=1;o<r.length;o+=4)r.splice(o,1,":",r[o],";");return r.join("")}function Z(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=w(t),o=function(e,t){for(var r=[e.rtl?"rtl":"ltr"],n=!1,o=0,i=t.__order;o<i.length;o++){var a=i[o];r.push(a);var s=t[a];for(var c in s)s.hasOwnProperty(c)&&void 0!==s[c]&&(n=!0,r.push(c,s[c]))}return n?r.join(""):void 0}(e,n);if(o){var a=i.Y.getInstance(),s={className:a.classNameFromKey(o),key:o,args:t};if(!s.className){s.className=a.getClassName(function(e){var t=e&&e["&"];return t?t.displayName:void 0}(n));for(var c=[],u=0,l=n.__order;u<l.length;u++){var d=l[u];c.push(d,E(e,n[d]))}s.rulesToInsert=c}return s}}function T(e,t){void 0===t&&(t=1);var r=i.Y.getInstance(),n=e.className,o=e.key,a=e.args,s=e.rulesToInsert;if(s){for(var c=0;c<s.length;c+=2){var u=s[c+1];if(u){var l=s[c];l=l.replace(/&/g,P(".".concat(e.className),t));var d="".concat(l,"{").concat(u,"}").concat(0===l.indexOf("@")?"}":"");r.insertRule(d)}}r.cacheClassName(n,o,a,s)}}function N(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=Z.apply(void 0,(0,o.__spreadArray)([e],t,!1));return n?(T(n,e.specificityMultiplier),n.className):""}},97091:function(e,t,r){"use strict";r.d(t,{j:function(){return l}});var n,o={themeDarker:"#004578",themeDark:"#005a9e",themeDarkAlt:"#106ebe",themePrimary:"#0078d4",themeSecondary:"#2b88d8",themeTertiary:"#71afe5",themeLight:"#c7e0f4",themeLighter:"#deecf9",themeLighterAlt:"#eff6fc",black:"#000000",blackTranslucent40:"rgba(0,0,0,.4)",neutralDark:"#201f1e",neutralPrimary:"#323130",neutralPrimaryAlt:"#3b3a39",neutralSecondary:"#605e5c",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#a19f9d",neutralTertiaryAlt:"#c8c6c4",neutralQuaternary:"#d2d0ce",neutralQuaternaryAlt:"#e1dfdd",neutralLight:"#edebe9",neutralLighter:"#f3f2f1",neutralLighterAlt:"#faf9f8",accent:"#0078d4",white:"#ffffff",whiteTranslucent40:"rgba(255,255,255,.4)",yellowDark:"#d29200",yellow:"#ffb900",yellowLight:"#fff100",orange:"#d83b01",orangeLight:"#ea4300",orangeLighter:"#ff8c00",redDark:"#a4262c",red:"#e81123",magentaDark:"#5c005c",magenta:"#b4009e",magentaLight:"#e3008c",purpleDark:"#32145a",purple:"#5c2d91",purpleLight:"#b4a0ff",blueDark:"#002050",blueMid:"#00188f",blue:"#0078d4",blueLight:"#00bcf2",tealDark:"#004b50",teal:"#008272",tealLight:"#00b294",greenDark:"#004b1c",green:"#107c10",greenLight:"#bad80a"};!function(e){e.depth0="0 0 0 0 transparent",e.depth4="0 1.6px 3.6px 0 rgba(0, 0, 0, 0.132), 0 0.3px 0.9px 0 rgba(0, 0, 0, 0.108)",e.depth8="0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132), 0 0.6px 1.8px 0 rgba(0, 0, 0, 0.108)",e.depth16="0 6.4px 14.4px 0 rgba(0, 0, 0, 0.132), 0 1.2px 3.6px 0 rgba(0, 0, 0, 0.108)",e.depth64="0 25.6px 57.6px 0 rgba(0, 0, 0, 0.22), 0 4.8px 14.4px 0 rgba(0, 0, 0, 0.18)"}(n||(n={}));var i={elevation4:n.depth4,elevation8:n.depth8,elevation16:n.depth16,elevation64:n.depth64,roundedCorner2:"2px",roundedCorner4:"4px",roundedCorner6:"6px"},a=r(25466),s=r(83816),c={s2:"4px",s1:"8px",m:"16px",l1:"20px",l2:"32px"},u=r(53614);function l(e,t){void 0===e&&(e={}),void 0===t&&(t=!1);var r=!!e.isInverted,n={palette:o,effects:i,fonts:a.i,spacing:c,isInverted:r,disableGlobalClassNames:!1,semanticColors:(0,u.b)(o,i,void 0,r,t),rtl:void 0};return(0,s.I)(n,e)}},25466:function(e,t,r){"use strict";r.d(t,{i:function(){return p}});var n=r(81166),o=r(43112),i="'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Helvetica Neue', sans-serif",a="'Segoe UI', '".concat(o.Qm.WestEuropean,"'"),s={ar:o.II.Arabic,bg:o.II.Cyrillic,cs:o.II.EastEuropean,el:o.II.Greek,et:o.II.EastEuropean,he:o.II.Hebrew,hi:o.II.Hindi,hr:o.II.EastEuropean,hu:o.II.EastEuropean,ja:o.II.Japanese,kk:o.II.EastEuropean,ko:o.II.Korean,lt:o.II.EastEuropean,lv:o.II.EastEuropean,pl:o.II.EastEuropean,ru:o.II.Cyrillic,sk:o.II.EastEuropean,"sr-latn":o.II.EastEuropean,th:o.II.Thai,tr:o.II.EastEuropean,uk:o.II.Cyrillic,vi:o.II.Vietnamese,"zh-hans":o.II.ChineseSimplified,"zh-hant":o.II.ChineseTraditional,hy:o.II.Armenian,ka:o.II.Georgian};function c(e,t,r){return{fontFamily:r,MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontSize:e,fontWeight:t}}var u=r(81552),l=r(69561);var d,f=r(71847),h="language";var p=function(e){var t=function(e){for(var t in s)if(s.hasOwnProperty(t)&&e&&0===t.indexOf(e))return s[t];return a}(e),r="".concat(t,", ").concat(i);return{tiny:c(o.TS.mini,o.lq.regular,r),xSmall:c(o.TS.xSmall,o.lq.regular,r),small:c(o.TS.small,o.lq.regular,r),smallPlus:c(o.TS.smallPlus,o.lq.regular,r),medium:c(o.TS.medium,o.lq.regular,r),mediumPlus:c(o.TS.mediumPlus,o.lq.regular,r),large:c(o.TS.large,o.lq.regular,r),xLarge:c(o.TS.xLarge,o.lq.semibold,r),xLargePlus:c(o.TS.xLargePlus,o.lq.semibold,r),xxLarge:c(o.TS.xxLarge,o.lq.semibold,r),xxLargePlus:c(o.TS.xxLargePlus,o.lq.semibold,r),superLarge:c(o.TS.superLarge,o.lq.semibold,r),mega:c(o.TS.mega,o.lq.semibold,r)}}(function(e){if(void 0===e&&(e="sessionStorage"),void 0===d){var t=(0,u.M)(),r="localStorage"===e?function(e){var t=null;try{var r=(0,l.J)();t=r?r.localStorage.getItem(e):null}catch(n){}return t}(h):"sessionStorage"===e?f.r(h):void 0;r&&(d=r),void 0===d&&t&&(d=t.documentElement.getAttribute("lang")),void 0===d&&(d="en")}return d}());function v(e,t,r,o){e="'".concat(e,"'");var i=void 0!==o?"local('".concat(o,"'),"):"";(0,n.j)({fontFamily:e,src:i+"url('".concat(t,".woff2') format('woff2'),")+"url('".concat(t,".woff') format('woff')"),fontWeight:r,fontStyle:"normal",fontDisplay:"swap"})}function g(e,t,r,n,i){void 0===n&&(n="segoeui");var a="".concat(e,"/").concat(r,"/").concat(n);v(t,a+"-light",o.lq.light,i&&i+" Light"),v(t,a+"-semilight",o.lq.semilight,i&&i+" SemiLight"),v(t,a+"-regular",o.lq.regular,i),v(t,a+"-semibold",o.lq.semibold,i&&i+" SemiBold"),v(t,a+"-bold",o.lq.bold,i&&i+" Bold")}!function(e){if(e){var t="".concat(e,"/fonts");g(t,o.Qm.Thai,"leelawadeeui-thai","leelawadeeui"),g(t,o.Qm.Arabic,"segoeui-arabic"),g(t,o.Qm.Cyrillic,"segoeui-cyrillic"),g(t,o.Qm.EastEuropean,"segoeui-easteuropean"),g(t,o.Qm.Greek,"segoeui-greek"),g(t,o.Qm.Hebrew,"segoeui-hebrew"),g(t,o.Qm.Vietnamese,"segoeui-vietnamese"),g(t,o.Qm.WestEuropean,"segoeui-westeuropean","segoeui","Segoe UI"),g(t,o.II.Selawik,"selawik","selawik"),g(t,o.Qm.Armenian,"segoeui-armenian"),g(t,o.Qm.Georgian,"segoeui-georgian"),v("Leelawadee UI Web","".concat(t,"/leelawadeeui-thai/leelawadeeui-semilight"),o.lq.light),v("Leelawadee UI Web","".concat(t,"/leelawadeeui-thai/leelawadeeui-bold"),o.lq.semibold)}}(function(){var e,t,r=null===(e=(0,l.J)())||void 0===e?void 0:e.FabricConfig;return null!==(t=null===r||void 0===r?void 0:r.fontBaseUrl)&&void 0!==t?t:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets"}())},43112:function(e,t,r){"use strict";var n,o,i,a,s;r.d(t,{II:function(){return o},Qm:function(){return n},TS:function(){return i},ld:function(){return s},lq:function(){return a}}),function(e){e.Arabic="Segoe UI Web (Arabic)",e.Cyrillic="Segoe UI Web (Cyrillic)",e.EastEuropean="Segoe UI Web (East European)",e.Greek="Segoe UI Web (Greek)",e.Hebrew="Segoe UI Web (Hebrew)",e.Thai="Leelawadee UI Web",e.Vietnamese="Segoe UI Web (Vietnamese)",e.WestEuropean="Segoe UI Web (West European)",e.Selawik="Selawik Web",e.Armenian="Segoe UI Web (Armenian)",e.Georgian="Segoe UI Web (Georgian)"}(n||(n={})),function(e){e.Arabic="'".concat(n.Arabic,"'"),e.ChineseSimplified="'Microsoft Yahei UI', Verdana, Simsun",e.ChineseTraditional="'Microsoft Jhenghei UI', Pmingliu",e.Cyrillic="'".concat(n.Cyrillic,"'"),e.EastEuropean="'".concat(n.EastEuropean,"'"),e.Greek="'".concat(n.Greek,"'"),e.Hebrew="'".concat(n.Hebrew,"'"),e.Hindi="'Nirmala UI'",e.Japanese="'Yu Gothic UI', 'Meiryo UI', Meiryo, 'MS Pgothic', Osaka",e.Korean="'Malgun Gothic', Gulim",e.Selawik="'".concat(n.Selawik,"'"),e.Thai="'Leelawadee UI Web', 'Kmer UI'",e.Vietnamese="'".concat(n.Vietnamese,"'"),e.WestEuropean="'".concat(n.WestEuropean,"'"),e.Armenian="'".concat(n.Armenian,"'"),e.Georgian="'".concat(n.Georgian,"'")}(o||(o={})),function(e){e.size10="10px",e.size12="12px",e.size14="14px",e.size16="16px",e.size18="18px",e.size20="20px",e.size24="24px",e.size28="28px",e.size32="32px",e.size42="42px",e.size68="68px",e.mini="10px",e.xSmall="10px",e.small="12px",e.smallPlus="12px",e.medium="14px",e.mediumPlus="16px",e.icon="16px",e.large="18px",e.xLarge="20px",e.xLargePlus="24px",e.xxLarge="28px",e.xxLargePlus="32px",e.superLarge="42px",e.mega="68px"}(i||(i={})),function(e){e.light=100,e.semilight=300,e.regular=400,e.semibold=600,e.bold=700}(a||(a={})),function(e){e.xSmall="10px",e.small="12px",e.medium="16px",e.large="20px"}(s||(s={}))},83816:function(e,t,r){"use strict";function n(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n=0,i=t;n<i.length;n++){o(e||{},i[n])}return e}function o(e,t,r){for(var n in void 0===r&&(r=[]),r.push(t),t)if(t.hasOwnProperty(n)&&"__proto__"!==n&&"constructor"!==n&&"prototype"!==n){var i=t[n];if("object"!==typeof i||null===i||Array.isArray(i))e[n]=i;else{var a=r.indexOf(i)>-1;e[n]=a?i:o(e[n]||{},i,r)}}return r.pop(),e}r.d(t,{I:function(){return a}});var i=r(53614);function a(e,t){var r,o,a;void 0===t&&(t={});var s=n({},e,t,{semanticColors:(0,i.Q)(t.palette,t.effects,t.semanticColors,void 0===t.isInverted?e.isInverted:t.isInverted)});if((null===(r=t.palette)||void 0===r?void 0:r.themePrimary)&&!(null===(o=t.palette)||void 0===o?void 0:o.accent)&&(s.palette.accent=t.palette.themePrimary),t.defaultFontStyle)for(var c=0,u=Object.keys(s.fonts);c<u.length;c++){var l=u[c];s.fonts[l]=n(s.fonts[l],t.defaultFontStyle,null===(a=null===t||void 0===t?void 0:t.fonts)||void 0===a?void 0:a[l])}return s}},53614:function(e,t,r){"use strict";r.d(t,{Q:function(){return i},b:function(){return o}});var n=r(75971);function o(e,t,r,o,a){return void 0===a&&(a=!1),function(e,t){var r="";!0===t&&(r=" /* @deprecated */");return e.listTextColor=e.listText+r,e.menuItemBackgroundChecked+=r,e.warningHighlight+=r,e.warningText=e.messageText+r,e.successText+=r,e}(i(e,t,(0,n.__assign)({primaryButtonBorder:"transparent",errorText:o?"#F1707B":"#a4262c",messageText:o?"#F3F2F1":"#323130",messageLink:o?"#6CB8F6":"#005A9E",messageLinkHovered:o?"#82C7FF":"#004578",infoIcon:o?"#C8C6C4":"#605e5c",errorIcon:o?"#F1707B":"#A80000",blockingIcon:o?"#442726":"#FDE7E9",warningIcon:o?"#C8C6C4":"#797775",severeWarningIcon:o?"#FCE100":"#D83B01",successIcon:o?"#92C353":"#107C10",infoBackground:o?"#323130":"#f3f2f1",errorBackground:o?"#442726":"#FDE7E9",blockingBackground:o?"#442726":"#FDE7E9",warningBackground:o?"#433519":"#FFF4CE",severeWarningBackground:o?"#4F2A0F":"#FED9CC",successBackground:o?"#393D1B":"#DFF6DD",warningHighlight:o?"#fff100":"#ffb900",successText:o?"#92c353":"#107C10"},r),o),a)}function i(e,t,r,o,i){void 0===i&&(i=!1);var a={},s=e||{},c=s.white,u=s.black,l=s.themePrimary,d=s.themeDark,f=s.themeDarker,h=s.themeDarkAlt,p=s.themeLighter,v=s.neutralLight,g=s.neutralLighter,m=s.neutralDark,y=s.neutralQuaternary,b=s.neutralQuaternaryAlt,k=s.neutralPrimary,S=s.neutralSecondary,C=s.neutralSecondaryAlt,w=s.neutralTertiary,x=s.neutralTertiaryAlt,P=s.neutralLighterAlt,E=s.accent;return c&&(a.bodyBackground=c,a.bodyFrameBackground=c,a.accentButtonText=c,a.buttonBackground=c,a.primaryButtonText=c,a.primaryButtonTextHovered=c,a.primaryButtonTextPressed=c,a.inputBackground=c,a.inputForegroundChecked=c,a.listBackground=c,a.menuBackground=c,a.cardStandoutBackground=c),u&&(a.bodyTextChecked=u,a.buttonTextCheckedHovered=u),l&&(a.link=l,a.primaryButtonBackground=l,a.inputBackgroundChecked=l,a.inputIcon=l,a.inputFocusBorderAlt=l,a.menuIcon=l,a.menuHeader=l,a.accentButtonBackground=l),d&&(a.primaryButtonBackgroundPressed=d,a.inputBackgroundCheckedHovered=d,a.inputIconHovered=d),f&&(a.linkHovered=f),h&&(a.primaryButtonBackgroundHovered=h),p&&(a.inputPlaceholderBackgroundChecked=p),v&&(a.bodyBackgroundChecked=v,a.bodyFrameDivider=v,a.bodyDivider=v,a.variantBorder=v,a.buttonBackgroundCheckedHovered=v,a.buttonBackgroundPressed=v,a.listItemBackgroundChecked=v,a.listHeaderBackgroundPressed=v,a.menuItemBackgroundPressed=v,a.menuItemBackgroundChecked=v),g&&(a.bodyBackgroundHovered=g,a.buttonBackgroundHovered=g,a.buttonBackgroundDisabled=g,a.buttonBorderDisabled=g,a.primaryButtonBackgroundDisabled=g,a.disabledBackground=g,a.listItemBackgroundHovered=g,a.listHeaderBackgroundHovered=g,a.menuItemBackgroundHovered=g),y&&(a.primaryButtonTextDisabled=y,a.disabledSubtext=y),b&&(a.listItemBackgroundCheckedHovered=b),w&&(a.disabledBodyText=w,a.variantBorderHovered=(null===r||void 0===r?void 0:r.variantBorderHovered)||w,a.buttonTextDisabled=w,a.inputIconDisabled=w,a.disabledText=w),k&&(a.bodyText=k,a.actionLink=k,a.buttonText=k,a.inputBorderHovered=k,a.inputText=k,a.listText=k,a.menuItemText=k),P&&(a.bodyStandoutBackground=P,a.defaultStateBackground=P),m&&(a.actionLinkHovered=m,a.buttonTextHovered=m,a.buttonTextChecked=m,a.buttonTextPressed=m,a.inputTextHovered=m,a.menuItemTextHovered=m),S&&(a.bodySubtext=S,a.focusBorder=S,a.inputBorder=S,a.smallInputBorder=S,a.inputPlaceholderText=S),C&&(a.buttonBorder=C),x&&(a.disabledBodySubtext=x,a.disabledBorder=x,a.buttonBackgroundChecked=x,a.menuDivider=x),E&&(a.accentButtonBackground=E),(null===t||void 0===t?void 0:t.elevation4)&&(a.cardShadow=t.elevation4),!o&&(null===t||void 0===t?void 0:t.elevation8)?a.cardShadowHovered=t.elevation8:a.variantBorderHovered&&(a.cardShadowHovered="0 0 1px "+a.variantBorderHovered),a=(0,n.__assign)((0,n.__assign)({},a),r)}},94640:function(e,t,r){"use strict";r.d(t,{E:function(){return n}});var n={borderRadiusNone:"0",borderRadiusSmall:"2px",borderRadiusMedium:"4px",borderRadiusLarge:"6px",borderRadiusXLarge:"8px",borderRadiusCircular:"10000px"}},57383:function(e,t,r){"use strict";r.d(t,{au:function(){return n}});var n={10:"#061724",20:"#082338",30:"#0a2e4a",40:"#0c3b5e",50:"#0e4775",60:"#0f548c",70:"#115ea3",80:"#0f6cbd",90:"#2886de",100:"#479ef5",110:"#62abf5",120:"#77b7f7",130:"#96c6fa",140:"#b4d6fa",150:"#cfe4fa",160:"#ebf3fc"}},86692:function(e,t,r){"use strict";r.d(t,{C:function(){return i},b:function(){return o}});var n=r(15808),o={red:n.Q6,green:n.ek,darkOrange:n.nn,yellow:n.er,berry:n.Z1,lightGreen:n.ZE,marigold:n.vx},i={darkRed:n.o6,cranberry:n.o0,pumpkin:n.cE,peach:n.C2,gold:n.EV,brass:n.cB,brown:n.P_,forest:n.Ig,seafoam:n.$I,darkGreen:n.Ce,lightTeal:n.B8,teal:n.$C,steel:n.gr,blue:n.iN,royalBlue:n.VI,cornflower:n.wO,navy:n.Ih,lavender:n.N0,purple:n.jk,grape:n.pl,lilac:n.A5,pink:n.iQ,magenta:n.ym,plum:n.vd,beige:n.e9,mink:n.RR,platinum:n.Xd,anchor:n.Eu}},15808:function(e,t,r){"use strict";r.d(t,{$C:function(){return T},$I:function(){return w},A5:function(){return M},B8:function(){return Z},BA:function(){return n},C2:function(){return g},Ce:function(){return E},EV:function(){return b},Eu:function(){return Y},Hf:function(){return i},Ig:function(){return C},Ih:function(){return D},N0:function(){return A},P_:function(){return S},Q6:function(){return h},RR:function(){return q},Sn:function(){return l},VI:function(){return I},Xd:function(){return z},Z1:function(){return _},ZE:function(){return x},cB:function(){return k},cE:function(){return v},d1:function(){return a},e9:function(){return U},ek:function(){return P},er:function(){return y},es:function(){return s},gr:function(){return N},hu:function(){return c},iN:function(){return F},iQ:function(){return R},ix:function(){return u},jZ:function(){return o},jk:function(){return O},nn:function(){return p},o0:function(){return f},o6:function(){return d},pl:function(){return L},vd:function(){return j},vx:function(){return m},wO:function(){return B},ym:function(){return H}});var n={2:"#050505",4:"#0a0a0a",6:"#0f0f0f",8:"#141414",10:"#1a1a1a",12:"#1f1f1f",14:"#242424",16:"#292929",18:"#2e2e2e",20:"#333333",22:"#383838",24:"#3d3d3d",26:"#424242",28:"#474747",30:"#4d4d4d",32:"#525252",34:"#575757",36:"#5c5c5c",38:"#616161",40:"#666666",42:"#6b6b6b",44:"#707070",46:"#757575",48:"#7a7a7a",50:"#808080",52:"#858585",54:"#8a8a8a",56:"#8f8f8f",58:"#949494",60:"#999999",62:"#9e9e9e",64:"#a3a3a3",66:"#a8a8a8",68:"#adadad",70:"#b3b3b3",72:"#b8b8b8",74:"#bdbdbd",76:"#c2c2c2",78:"#c7c7c7",80:"#cccccc",82:"#d1d1d1",84:"#d6d6d6",86:"#dbdbdb",88:"#e0e0e0",90:"#e6e6e6",92:"#ebebeb",94:"#f0f0f0",96:"#f5f5f5",98:"#fafafa"},o={5:"rgba(255, 255, 255, 0.05)",10:"rgba(255, 255, 255, 0.1)",20:"rgba(255, 255, 255, 0.2)",30:"rgba(255, 255, 255, 0.3)",40:"rgba(255, 255, 255, 0.4)",50:"rgba(255, 255, 255, 0.5)",60:"rgba(255, 255, 255, 0.6)",70:"rgba(255, 255, 255, 0.7)",80:"rgba(255, 255, 255, 0.8)",90:"rgba(255, 255, 255, 0.9)"},i={5:"rgba(0, 0, 0, 0.05)",10:"rgba(0, 0, 0, 0.1)",20:"rgba(0, 0, 0, 0.2)",30:"rgba(0, 0, 0, 0.3)",40:"rgba(0, 0, 0, 0.4)",50:"rgba(0, 0, 0, 0.5)",60:"rgba(0, 0, 0, 0.6)",70:"rgba(0, 0, 0, 0.7)",80:"rgba(0, 0, 0, 0.8)",90:"rgba(0, 0, 0, 0.9)"},a={5:"rgba(26, 26, 26, 0.05)",10:"rgba(26, 26, 26, 0.1)",20:"rgba(26, 26, 26, 0.2)",30:"rgba(26, 26, 26, 0.3)",40:"rgba(26, 26, 26, 0.4)",50:"rgba(26, 26, 26, 0.5)",60:"rgba(26, 26, 26, 0.6)",70:"rgba(26, 26, 26, 0.7)",80:"rgba(26, 26, 26, 0.8)",90:"rgba(26, 26, 26, 0.9)"},s={5:"rgba(31, 31, 31, 0.05)",10:"rgba(31, 31, 31, 0.1)",20:"rgba(31, 31, 31, 0.2)",30:"rgba(31, 31, 31, 0.3)",40:"rgba(31, 31, 31, 0.4)",50:"rgba(31, 31, 31, 0.5)",60:"rgba(31, 31, 31, 0.6)",70:"rgba(31, 31, 31, 0.7)",80:"rgba(31, 31, 31, 0.8)",90:"rgba(31, 31, 31, 0.9)"},c={5:"rgba(36, 36, 36, 0.05)",10:"rgba(36, 36, 36, 0.1)",20:"rgba(36, 36, 36, 0.2)",30:"rgba(36, 36, 36, 0.3)",40:"rgba(36, 36, 36, 0.4)",50:"rgba(36, 36, 36, 0.5)",60:"rgba(36, 36, 36, 0.6)",70:"rgba(36, 36, 36, 0.7)",80:"rgba(36, 36, 36, 0.8)",90:"rgba(36, 36, 36, 0.9)"},u="#ffffff",l="#000000",d={shade50:"#130204",shade40:"#230308",shade30:"#420610",shade20:"#590815",shade10:"#690a19",primary:"#750b1c",tint10:"#861b2c",tint20:"#962f3f",tint30:"#ac4f5e",tint40:"#d69ca5",tint50:"#e9c7cd",tint60:"#f9f0f2"},f={shade50:"#200205",shade40:"#3b0509",shade30:"#6e0811",shade20:"#960b18",shade10:"#b10e1c",primary:"#c50f1f",tint10:"#cc2635",tint20:"#d33f4c",tint30:"#dc626d",tint40:"#eeacb2",tint50:"#f6d1d5",tint60:"#fdf3f4"},h={shade50:"#210809",shade40:"#3f1011",shade30:"#751d1f",shade20:"#9f282b",shade10:"#bc2f32",primary:"#d13438",tint10:"#d7494c",tint20:"#dc5e62",tint30:"#e37d80",tint40:"#f1bbbc",tint50:"#f8dadb",tint60:"#fdf6f6"},p={shade50:"#230900",shade40:"#411200",shade30:"#7a2101",shade20:"#a62d01",shade10:"#c43501",primary:"#da3b01",tint10:"#de501c",tint20:"#e36537",tint30:"#e9835e",tint40:"#f4bfab",tint50:"#f9dcd1",tint60:"#fdf6f3"},v={shade50:"#200d03",shade40:"#3d1805",shade30:"#712d09",shade20:"#9a3d0c",shade10:"#b6480e",primary:"#ca5010",tint10:"#d06228",tint20:"#d77440",tint30:"#df8e64",tint40:"#efc4ad",tint50:"#f7dfd2",tint60:"#fdf7f4"},g={shade50:"#291600",shade40:"#4d2a00",shade30:"#8f4e00",shade20:"#c26a00",shade10:"#e67e00",primary:"#ff8c00",tint10:"#ff9a1f",tint20:"#ffa83d",tint30:"#ffba66",tint40:"#ffddb3",tint50:"#ffedd6",tint60:"#fffaf5"},m={shade50:"#251a00",shade40:"#463100",shade30:"#835b00",shade20:"#b27c00",shade10:"#d39300",primary:"#eaa300",tint10:"#edad1c",tint20:"#efb839",tint30:"#f2c661",tint40:"#f9e2ae",tint50:"#fcefd3",tint60:"#fefbf4"},y={primary:"#fde300",shade10:"#e4cc00",shade20:"#c0ad00",shade30:"#817400",shade40:"#4c4400",shade50:"#282400",tint10:"#fde61e",tint20:"#fdea3d",tint30:"#feee66",tint40:"#fef7b2",tint50:"#fffad6",tint60:"#fffef5"},b={shade50:"#1f1900",shade40:"#3a2f00",shade30:"#6c5700",shade20:"#937700",shade10:"#ae8c00",primary:"#c19c00",tint10:"#c8a718",tint20:"#d0b232",tint30:"#dac157",tint40:"#ecdfa5",tint50:"#f5eece",tint60:"#fdfbf2"},k={shade50:"#181202",shade40:"#2e2103",shade30:"#553e06",shade20:"#745408",shade10:"#89640a",primary:"#986f0b",tint10:"#a47d1e",tint20:"#b18c34",tint30:"#c1a256",tint40:"#e0cea2",tint50:"#efe4cb",tint60:"#fbf8f2"},S={shade50:"#170e07",shade40:"#2b1a0e",shade30:"#50301a",shade20:"#6c4123",shade10:"#804d29",primary:"#8e562e",tint10:"#9c663f",tint20:"#a97652",tint30:"#bb8f6f",tint40:"#ddc3b0",tint50:"#edded3",tint60:"#faf7f4"},C={shade50:"#0c1501",shade40:"#162702",shade30:"#294903",shade20:"#376304",shade10:"#427505",primary:"#498205",tint10:"#599116",tint20:"#6ba02b",tint30:"#85b44c",tint40:"#bdd99b",tint50:"#dbebc7",tint60:"#f6faf0"},w={shade50:"#002111",shade40:"#003d20",shade30:"#00723b",shade20:"#009b51",shade10:"#00b85f",primary:"#00cc6a",tint10:"#19d279",tint20:"#34d889",tint30:"#5ae0a0",tint40:"#a8f0cd",tint50:"#cff7e4",tint60:"#f3fdf8"},x={shade50:"#031a02",shade40:"#063004",shade30:"#0b5a08",shade20:"#0e7a0b",shade10:"#11910d",primary:"#13a10e",tint10:"#27ac22",tint20:"#3db838",tint30:"#5ec75a",tint40:"#a7e3a5",tint50:"#cef0cd",tint60:"#f2fbf2"},P={shade50:"#031403",shade40:"#052505",shade30:"#094509",shade20:"#0c5e0c",shade10:"#0e700e",primary:"#107c10",tint10:"#218c21",tint20:"#359b35",tint30:"#54b054",tint40:"#9fd89f",tint50:"#c9eac9",tint60:"#f1faf1"},E={shade50:"#021102",shade40:"#032003",shade30:"#063b06",shade20:"#085108",shade10:"#0a5f0a",primary:"#0b6a0b",tint10:"#1a7c1a",tint20:"#2d8e2d",tint30:"#4da64d",tint40:"#9ad29a",tint50:"#c6e7c6",tint60:"#f0f9f0"},Z={shade50:"#001d1f",shade40:"#00373a",shade30:"#00666d",shade20:"#008b94",shade10:"#00a5af",primary:"#00b7c3",tint10:"#18bfca",tint20:"#32c8d1",tint30:"#58d3db",tint40:"#a6e9ed",tint50:"#cef3f5",tint60:"#f2fcfd"},T={shade50:"#001516",shade40:"#012728",shade30:"#02494c",shade20:"#026467",shade10:"#037679",primary:"#038387",tint10:"#159195",tint20:"#2aa0a4",tint30:"#4cb4b7",tint40:"#9bd9db",tint50:"#c7ebec",tint60:"#f0fafa"},N={shade50:"#000f12",shade40:"#001b22",shade30:"#00333f",shade20:"#004555",shade10:"#005265",primary:"#005b70",tint10:"#0f6c81",tint20:"#237d92",tint30:"#4496a9",tint40:"#94c8d4",tint50:"#c3e1e8",tint60:"#eff7f9"},F={shade50:"#001322",shade40:"#002440",shade30:"#004377",shade20:"#005ba1",shade10:"#006cbf",primary:"#0078d4",tint10:"#1a86d9",tint20:"#3595de",tint30:"#5caae5",tint40:"#a9d3f2",tint50:"#d0e7f8",tint60:"#f3f9fd"},I={shade50:"#000c16",shade40:"#00172a",shade30:"#002c4e",shade20:"#003b6a",shade10:"#00467e",primary:"#004e8c",tint10:"#125e9a",tint20:"#286fa8",tint30:"#4a89ba",tint40:"#9abfdc",tint50:"#c7dced",tint60:"#f0f6fa"},B={shade50:"#0d1126",shade40:"#182047",shade30:"#2c3c85",shade20:"#3c51b4",shade10:"#4760d5",primary:"#4f6bed",tint10:"#637cef",tint20:"#778df1",tint30:"#93a4f4",tint40:"#c8d1fa",tint50:"#e1e6fc",tint60:"#f7f9fe"},D={shade50:"#00061d",shade40:"#000c36",shade30:"#001665",shade20:"#001e89",shade10:"#0023a2",primary:"#0027b4",tint10:"#173bbd",tint20:"#3050c6",tint30:"#546fd2",tint40:"#a3b2e8",tint50:"#ccd5f3",tint60:"#f2f4fc"},A={shade50:"#120f25",shade40:"#221d46",shade30:"#3f3682",shade20:"#5649b0",shade10:"#6656d1",primary:"#7160e8",tint10:"#8172eb",tint20:"#9184ee",tint30:"#a79cf1",tint40:"#d2ccf8",tint50:"#e7e4fb",tint60:"#f9f8fe"},O={shade50:"#0f0717",shade40:"#1c0e2b",shade30:"#341a51",shade20:"#46236e",shade10:"#532982",primary:"#5c2e91",tint10:"#6b3f9e",tint20:"#7c52ab",tint30:"#9470bd",tint40:"#c6b1de",tint50:"#e0d3ed",tint60:"#f7f4fb"},L={shade50:"#160418",shade40:"#29072e",shade30:"#4c0d55",shade20:"#671174",shade10:"#7a1589",primary:"#881798",tint10:"#952aa4",tint20:"#a33fb1",tint30:"#b55fc1",tint40:"#d9a7e0",tint50:"#eaceef",tint60:"#faf2fb"},_={shade50:"#1f091d",shade40:"#3a1136",shade30:"#6d2064",shade20:"#932b88",shade10:"#af33a1",primary:"#c239b3",tint10:"#c94cbc",tint20:"#d161c4",tint30:"#da7ed0",tint40:"#edbbe7",tint50:"#f5daf2",tint60:"#fdf5fc"},M={shade50:"#1c0b1f",shade40:"#35153a",shade30:"#63276d",shade20:"#863593",shade10:"#9f3faf",primary:"#b146c2",tint10:"#ba58c9",tint20:"#c36bd1",tint30:"#cf87da",tint40:"#e6bfed",tint50:"#f2dcf5",tint60:"#fcf6fd"},R={shade50:"#24091b",shade40:"#441232",shade30:"#80215d",shade20:"#ad2d7e",shade10:"#cd3595",primary:"#e43ba6",tint10:"#e750b0",tint20:"#ea66ba",tint30:"#ef85c8",tint40:"#f7c0e3",tint50:"#fbddf0",tint60:"#fef6fb"},H={shade50:"#1f0013",shade40:"#390024",shade30:"#6b0043",shade20:"#91005a",shade10:"#ac006b",primary:"#bf0077",tint10:"#c71885",tint20:"#ce3293",tint30:"#d957a8",tint40:"#eca5d1",tint50:"#f5cee6",tint60:"#fcf2f9"},j={shade50:"#13000c",shade40:"#240017",shade30:"#43002b",shade20:"#5a003b",shade10:"#6b0045",primary:"#77004d",tint10:"#87105d",tint20:"#98246f",tint30:"#ad4589",tint40:"#d696c0",tint50:"#e9c4dc",tint60:"#faf0f6"},U={shade50:"#141313",shade40:"#252323",shade30:"#444241",shade20:"#5d5958",shade10:"#6e6968",primary:"#7a7574",tint10:"#8a8584",tint20:"#9a9594",tint30:"#afabaa",tint40:"#d7d4d4",tint50:"#eae8e8",tint60:"#faf9f9"},q={shade50:"#0f0e0e",shade40:"#1c1b1a",shade30:"#343231",shade20:"#474443",shade10:"#54514f",primary:"#5d5a58",tint10:"#706d6b",tint20:"#84817e",tint30:"#9e9b99",tint40:"#cecccb",tint50:"#e5e4e3",tint60:"#f8f8f8"},z={shade50:"#111314",shade40:"#1f2426",shade30:"#3b4447",shade20:"#505c60",shade10:"#5f6d71",primary:"#69797e",tint10:"#79898d",tint20:"#89989d",tint30:"#a0adb2",tint40:"#cdd6d8",tint50:"#e4e9ea",tint60:"#f8f9fa"},Y={shade50:"#090a0b",shade40:"#111315",shade30:"#202427",shade20:"#2b3135",shade10:"#333a3f",primary:"#394146",tint10:"#4d565c",tint20:"#626c72",tint30:"#808a90",tint40:"#bcc3c7",tint50:"#dbdfe1",tint60:"#f6f7f8"}},4631:function(e,t,r){"use strict";r.d(t,{y:function(){return n}});var n={curveAccelerateMax:"cubic-bezier(1,0,1,1)",curveAccelerateMid:"cubic-bezier(0.7,0,1,0.5)",curveAccelerateMin:"cubic-bezier(0.8,0,1,1)",curveDecelerateMax:"cubic-bezier(0,0,0,1)",curveDecelerateMid:"cubic-bezier(0.1,0.9,0.2,1)",curveDecelerateMin:"cubic-bezier(0.33,0,0.1,1)",curveEasyEaseMax:"cubic-bezier(0.8,0,0.1,1)",curveEasyEase:"cubic-bezier(0.33,0,0.67,1)",curveLinear:"cubic-bezier(0,0,1,1)"}},89414:function(e,t,r){"use strict";r.d(t,{l:function(){return n}});var n={durationUltraFast:"50ms",durationFaster:"100ms",durationFast:"150ms",durationNormal:"200ms",durationSlow:"300ms",durationSlower:"400ms",durationUltraSlow:"500ms"}},93493:function(e,t,r){"use strict";r.d(t,{CH:function(){return n},Vl:function(){return a},tO:function(){return o},vC:function(){return i}});var n={fontSizeBase100:"10px",fontSizeBase200:"12px",fontSizeBase300:"14px",fontSizeBase400:"16px",fontSizeBase500:"20px",fontSizeBase600:"24px",fontSizeHero700:"28px",fontSizeHero800:"32px",fontSizeHero900:"40px",fontSizeHero1000:"68px"},o={lineHeightBase100:"14px",lineHeightBase200:"16px",lineHeightBase300:"20px",lineHeightBase400:"22px",lineHeightBase500:"28px",lineHeightBase600:"32px",lineHeightHero700:"36px",lineHeightHero800:"40px",lineHeightHero900:"52px",lineHeightHero1000:"92px"},i={fontWeightRegular:400,fontWeightMedium:500,fontWeightSemibold:600,fontWeightBold:700},a={fontFamilyBase:"'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif",fontFamilyMonospace:"Consolas, 'Courier New', Courier, monospace",fontFamilyNumeric:"Bahnschrift, 'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif"}},56285:function(e,t,r){"use strict";r.d(t,{e:function(){return v},l:function(){return p}});var n="0",o="2px",i="4px",a="6px",s="8px",c="10px",u="12px",l="16px",d="20px",f="24px",h="32px",p={spacingHorizontalNone:n,spacingHorizontalXXS:o,spacingHorizontalXS:i,spacingHorizontalSNudge:a,spacingHorizontalS:s,spacingHorizontalMNudge:c,spacingHorizontalM:u,spacingHorizontalL:l,spacingHorizontalXL:d,spacingHorizontalXXL:f,spacingHorizontalXXXL:h},v={spacingVerticalNone:n,spacingVerticalXXS:o,spacingVerticalXS:i,spacingVerticalSNudge:a,spacingVerticalS:s,spacingVerticalMNudge:c,spacingVerticalM:u,spacingVerticalL:l,spacingVerticalXL:d,spacingVerticalXXL:f,spacingVerticalXXXL:h}},90613:function(e,t,r){"use strict";r.d(t,{G:function(){return n}});var n={strokeWidthThin:"1px",strokeWidthThick:"2px",strokeWidthThicker:"3px",strokeWidthThickest:"4px"}},97084:function(e,t,r){"use strict";r.d(t,{PN:function(){return n},X:function(){return o}});var n=["red","green","darkOrange","yellow","berry","lightGreen","marigold"],o=["darkRed","cranberry","pumpkin","peach","gold","brass","brown","forest","seafoam","darkGreen","lightTeal","teal","steel","blue","royalBlue","cornflower","navy","lavender","purple","grape","lilac","pink","magenta","plum","beige","mink","platinum","anchor"]},10795:function(e,t,r){"use strict";r.d(t,{_:function(){return y}});var n=r(1413),o=r(4942),i=r(86692),a=r(97084),s=a.PN.reduce((function(e,t){var r,n=t.slice(0,1).toUpperCase()+t.slice(1),a=(r={},(0,o.Z)(r,"colorPalette".concat(n,"Background1"),i.b[t].shade40),(0,o.Z)(r,"colorPalette".concat(n,"Background2"),i.b[t].shade30),(0,o.Z)(r,"colorPalette".concat(n,"Background3"),i.b[t].primary),(0,o.Z)(r,"colorPalette".concat(n,"Foreground1"),i.b[t].tint30),(0,o.Z)(r,"colorPalette".concat(n,"Foreground2"),i.b[t].tint40),(0,o.Z)(r,"colorPalette".concat(n,"Foreground3"),i.b[t].tint20),(0,o.Z)(r,"colorPalette".concat(n,"BorderActive"),i.b[t].tint30),(0,o.Z)(r,"colorPalette".concat(n,"Border1"),i.b[t].primary),(0,o.Z)(r,"colorPalette".concat(n,"Border2"),i.b[t].tint20),r);return Object.assign(e,a)}),{});s.colorPaletteRedForeground3=i.b.red.tint30,s.colorPaletteRedBorder2=i.b.red.tint30,s.colorPaletteGreenForeground3=i.b.green.tint40,s.colorPaletteGreenBorder2=i.b.green.tint40,s.colorPaletteDarkOrangeForeground3=i.b.darkOrange.tint30,s.colorPaletteDarkOrangeBorder2=i.b.darkOrange.tint30,s.colorPaletteRedForegroundInverted=i.b.red.primary,s.colorPaletteGreenForegroundInverted=i.b.green.primary,s.colorPaletteYellowForegroundInverted=i.b.yellow.shade30;var c=a.X.reduce((function(e,t){var r,n=t.slice(0,1).toUpperCase()+t.slice(1),a=(r={},(0,o.Z)(r,"colorPalette".concat(n,"Background2"),i.C[t].shade30),(0,o.Z)(r,"colorPalette".concat(n,"Foreground2"),i.C[t].tint40),(0,o.Z)(r,"colorPalette".concat(n,"BorderActive"),i.C[t].tint30),r);return Object.assign(e,a)}),{});c.colorPaletteDarkRedBackground2=i.C.darkRed.shade20,c.colorPalettePlumBackground2=i.C.plum.shade20;var u=(0,n.Z)((0,n.Z)({},s),c),l=r(15808),d=r(94640),f=r(93493),h=r(90613),p=r(51221),v=r(89414),g=r(4631),m=r(56285),y=function(e){var t=function(e){return{colorNeutralForeground1:l.ix,colorNeutralForeground1Hover:l.ix,colorNeutralForeground1Pressed:l.ix,colorNeutralForeground1Selected:l.ix,colorNeutralForeground2:l.BA[84],colorNeutralForeground2Hover:l.ix,colorNeutralForeground2Pressed:l.ix,colorNeutralForeground2Selected:l.ix,colorNeutralForeground2BrandHover:e[100],colorNeutralForeground2BrandPressed:e[90],colorNeutralForeground2BrandSelected:e[100],colorNeutralForeground3:l.BA[68],colorNeutralForeground3Hover:l.BA[84],colorNeutralForeground3Pressed:l.BA[84],colorNeutralForeground3Selected:l.BA[84],colorNeutralForeground3BrandHover:e[100],colorNeutralForeground3BrandPressed:e[90],colorNeutralForeground3BrandSelected:e[100],colorNeutralForeground4:l.BA[60],colorNeutralForegroundDisabled:l.BA[36],colorNeutralForegroundInvertedDisabled:l.jZ[40],colorBrandForegroundLink:e[100],colorBrandForegroundLinkHover:e[110],colorBrandForegroundLinkPressed:e[90],colorBrandForegroundLinkSelected:e[100],colorNeutralForeground2Link:l.BA[84],colorNeutralForeground2LinkHover:l.ix,colorNeutralForeground2LinkPressed:l.ix,colorNeutralForeground2LinkSelected:l.ix,colorCompoundBrandForeground1:e[100],colorCompoundBrandForeground1Hover:e[110],colorCompoundBrandForeground1Pressed:e[90],colorBrandForeground1:e[100],colorBrandForeground2:e[110],colorBrandForeground2Hover:e[130],colorBrandForeground2Pressed:e[160],colorNeutralForeground1Static:l.BA[14],colorNeutralForegroundStaticInverted:l.ix,colorNeutralForegroundInverted:l.BA[14],colorNeutralForegroundInvertedHover:l.BA[14],colorNeutralForegroundInvertedPressed:l.BA[14],colorNeutralForegroundInvertedSelected:l.BA[14],colorNeutralForegroundInverted2:l.BA[14],colorNeutralForegroundOnBrand:l.ix,colorNeutralForegroundInvertedLink:l.ix,colorNeutralForegroundInvertedLinkHover:l.ix,colorNeutralForegroundInvertedLinkPressed:l.ix,colorNeutralForegroundInvertedLinkSelected:l.ix,colorBrandForegroundInverted:e[80],colorBrandForegroundInvertedHover:e[70],colorBrandForegroundInvertedPressed:e[60],colorBrandForegroundOnLight:e[80],colorBrandForegroundOnLightHover:e[70],colorBrandForegroundOnLightPressed:e[50],colorBrandForegroundOnLightSelected:e[60],colorNeutralBackground1:l.BA[16],colorNeutralBackground1Hover:l.BA[24],colorNeutralBackground1Pressed:l.BA[12],colorNeutralBackground1Selected:l.BA[22],colorNeutralBackground2:l.BA[12],colorNeutralBackground2Hover:l.BA[20],colorNeutralBackground2Pressed:l.BA[8],colorNeutralBackground2Selected:l.BA[18],colorNeutralBackground3:l.BA[8],colorNeutralBackground3Hover:l.BA[16],colorNeutralBackground3Pressed:l.BA[4],colorNeutralBackground3Selected:l.BA[14],colorNeutralBackground4:l.BA[4],colorNeutralBackground4Hover:l.BA[12],colorNeutralBackground4Pressed:l.Sn,colorNeutralBackground4Selected:l.BA[10],colorNeutralBackground5:l.Sn,colorNeutralBackground5Hover:l.BA[8],colorNeutralBackground5Pressed:l.BA[2],colorNeutralBackground5Selected:l.BA[6],colorNeutralBackground6:l.BA[20],colorNeutralBackgroundInverted:l.ix,colorNeutralBackgroundStatic:l.BA[24],colorNeutralBackgroundAlpha:l.d1[50],colorNeutralBackgroundAlpha2:l.es[70],colorSubtleBackground:"transparent",colorSubtleBackgroundHover:l.BA[22],colorSubtleBackgroundPressed:l.BA[18],colorSubtleBackgroundSelected:l.BA[20],colorSubtleBackgroundLightAlphaHover:l.hu[80],colorSubtleBackgroundLightAlphaPressed:l.hu[50],colorSubtleBackgroundLightAlphaSelected:"transparent",colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:l.Hf[10],colorSubtleBackgroundInvertedPressed:l.Hf[30],colorSubtleBackgroundInvertedSelected:l.Hf[20],colorTransparentBackground:"transparent",colorTransparentBackgroundHover:"transparent",colorTransparentBackgroundPressed:"transparent",colorTransparentBackgroundSelected:"transparent",colorNeutralBackgroundDisabled:l.BA[8],colorNeutralBackgroundInvertedDisabled:l.jZ[10],colorNeutralStencil1:l.BA[34],colorNeutralStencil2:l.BA[20],colorNeutralStencil1Alpha:l.jZ[10],colorNeutralStencil2Alpha:l.jZ[5],colorBackgroundOverlay:l.Hf[50],colorScrollbarOverlay:l.jZ[60],colorBrandBackground:e[70],colorBrandBackgroundHover:e[80],colorBrandBackgroundPressed:e[40],colorBrandBackgroundSelected:e[60],colorCompoundBrandBackground:e[100],colorCompoundBrandBackgroundHover:e[110],colorCompoundBrandBackgroundPressed:e[90],colorBrandBackgroundStatic:e[80],colorBrandBackground2:e[20],colorBrandBackground2Hover:e[40],colorBrandBackground2Pressed:e[10],colorBrandBackgroundInverted:l.ix,colorBrandBackgroundInvertedHover:e[160],colorBrandBackgroundInvertedPressed:e[140],colorBrandBackgroundInvertedSelected:e[150],colorNeutralStrokeAccessible:l.BA[68],colorNeutralStrokeAccessibleHover:l.BA[74],colorNeutralStrokeAccessiblePressed:l.BA[70],colorNeutralStrokeAccessibleSelected:e[100],colorNeutralStroke1:l.BA[40],colorNeutralStroke1Hover:l.BA[46],colorNeutralStroke1Pressed:l.BA[42],colorNeutralStroke1Selected:l.BA[44],colorNeutralStroke2:l.BA[32],colorNeutralStroke3:l.BA[24],colorNeutralStrokeSubtle:l.BA[4],colorNeutralStrokeOnBrand:l.BA[16],colorNeutralStrokeOnBrand2:l.ix,colorNeutralStrokeOnBrand2Hover:l.ix,colorNeutralStrokeOnBrand2Pressed:l.ix,colorNeutralStrokeOnBrand2Selected:l.ix,colorBrandStroke1:e[100],colorBrandStroke2:e[50],colorBrandStroke2Hover:e[50],colorBrandStroke2Pressed:e[30],colorCompoundBrandStroke:e[100],colorCompoundBrandStrokeHover:e[110],colorCompoundBrandStrokePressed:e[90],colorNeutralStrokeDisabled:l.BA[26],colorNeutralStrokeInvertedDisabled:l.jZ[40],colorTransparentStroke:"transparent",colorTransparentStrokeInteractive:"transparent",colorTransparentStrokeDisabled:"transparent",colorNeutralStrokeAlpha:l.jZ[10],colorStrokeFocus1:l.Sn,colorStrokeFocus2:l.ix,colorNeutralShadowAmbient:"rgba(0,0,0,0.24)",colorNeutralShadowKey:"rgba(0,0,0,0.28)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.12)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.40)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.48)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"}}(e);return(0,n.Z)((0,n.Z)((0,n.Z)((0,n.Z)((0,n.Z)((0,n.Z)((0,n.Z)((0,n.Z)((0,n.Z)((0,n.Z)((0,n.Z)((0,n.Z)((0,n.Z)((0,n.Z)({},d.E),f.CH),f.tO),f.Vl),f.vC),h.G),m.l),m.e),v.l),g.y),t),u),(0,p.T)(t.colorNeutralShadowAmbient,t.colorNeutralShadowKey)),(0,p.T)(t.colorBrandShadowAmbient,t.colorBrandShadowKey,"Brand"))}(r(57383).au)},40722:function(e,t,r){"use strict";r.d(t,{w:function(){return i}});var n=r(1079),o=r(57383),i=(0,n.f)(o.au)},1079:function(e,t,r){"use strict";r.d(t,{f:function(){return y}});var n=r(1413),o=r(4942),i=r(86692),a=r(97084),s=a.PN.reduce((function(e,t){var r,n=t.slice(0,1).toUpperCase()+t.slice(1),a=(r={},(0,o.Z)(r,"colorPalette".concat(n,"Background1"),i.b[t].tint60),(0,o.Z)(r,"colorPalette".concat(n,"Background2"),i.b[t].tint40),(0,o.Z)(r,"colorPalette".concat(n,"Background3"),i.b[t].primary),(0,o.Z)(r,"colorPalette".concat(n,"Foreground1"),i.b[t].shade10),(0,o.Z)(r,"colorPalette".concat(n,"Foreground2"),i.b[t].shade30),(0,o.Z)(r,"colorPalette".concat(n,"Foreground3"),i.b[t].primary),(0,o.Z)(r,"colorPalette".concat(n,"BorderActive"),i.b[t].primary),(0,o.Z)(r,"colorPalette".concat(n,"Border1"),i.b[t].tint40),(0,o.Z)(r,"colorPalette".concat(n,"Border2"),i.b[t].primary),r);return Object.assign(e,a)}),{});s.colorPaletteYellowForeground1=i.b.yellow.shade30,s.colorPaletteRedForegroundInverted=i.b.red.tint20,s.colorPaletteGreenForegroundInverted=i.b.green.tint20,s.colorPaletteYellowForegroundInverted=i.b.yellow.tint40;var c=a.X.reduce((function(e,t){var r,n=t.slice(0,1).toUpperCase()+t.slice(1),a=(r={},(0,o.Z)(r,"colorPalette".concat(n,"Background2"),i.C[t].tint40),(0,o.Z)(r,"colorPalette".concat(n,"Foreground2"),i.C[t].shade30),(0,o.Z)(r,"colorPalette".concat(n,"BorderActive"),i.C[t].primary),r);return Object.assign(e,a)}),{}),u=(0,n.Z)((0,n.Z)({},s),c),l=r(15808),d=r(94640),f=r(93493),h=r(90613),p=r(51221),v=r(89414),g=r(4631),m=r(56285),y=function(e){var t=function(e){return{colorNeutralForeground1:l.BA[14],colorNeutralForeground1Hover:l.BA[14],colorNeutralForeground1Pressed:l.BA[14],colorNeutralForeground1Selected:l.BA[14],colorNeutralForeground2:l.BA[26],colorNeutralForeground2Hover:l.BA[14],colorNeutralForeground2Pressed:l.BA[14],colorNeutralForeground2Selected:l.BA[14],colorNeutralForeground2BrandHover:e[80],colorNeutralForeground2BrandPressed:e[70],colorNeutralForeground2BrandSelected:e[80],colorNeutralForeground3:l.BA[38],colorNeutralForeground3Hover:l.BA[26],colorNeutralForeground3Pressed:l.BA[26],colorNeutralForeground3Selected:l.BA[26],colorNeutralForeground3BrandHover:e[80],colorNeutralForeground3BrandPressed:e[70],colorNeutralForeground3BrandSelected:e[80],colorNeutralForeground4:l.BA[44],colorNeutralForegroundDisabled:l.BA[74],colorNeutralForegroundInvertedDisabled:l.jZ[40],colorBrandForegroundLink:e[70],colorBrandForegroundLinkHover:e[60],colorBrandForegroundLinkPressed:e[40],colorBrandForegroundLinkSelected:e[70],colorNeutralForeground2Link:l.BA[26],colorNeutralForeground2LinkHover:l.BA[14],colorNeutralForeground2LinkPressed:l.BA[14],colorNeutralForeground2LinkSelected:l.BA[14],colorCompoundBrandForeground1:e[80],colorCompoundBrandForeground1Hover:e[70],colorCompoundBrandForeground1Pressed:e[60],colorBrandForeground1:e[80],colorBrandForeground2:e[70],colorBrandForeground2Hover:e[60],colorBrandForeground2Pressed:e[30],colorNeutralForeground1Static:l.BA[14],colorNeutralForegroundStaticInverted:l.ix,colorNeutralForegroundInverted:l.ix,colorNeutralForegroundInvertedHover:l.ix,colorNeutralForegroundInvertedPressed:l.ix,colorNeutralForegroundInvertedSelected:l.ix,colorNeutralForegroundInverted2:l.ix,colorNeutralForegroundOnBrand:l.ix,colorNeutralForegroundInvertedLink:l.ix,colorNeutralForegroundInvertedLinkHover:l.ix,colorNeutralForegroundInvertedLinkPressed:l.ix,colorNeutralForegroundInvertedLinkSelected:l.ix,colorBrandForegroundInverted:e[100],colorBrandForegroundInvertedHover:e[110],colorBrandForegroundInvertedPressed:e[100],colorBrandForegroundOnLight:e[80],colorBrandForegroundOnLightHover:e[70],colorBrandForegroundOnLightPressed:e[50],colorBrandForegroundOnLightSelected:e[60],colorNeutralBackground1:l.ix,colorNeutralBackground1Hover:l.BA[96],colorNeutralBackground1Pressed:l.BA[88],colorNeutralBackground1Selected:l.BA[92],colorNeutralBackground2:l.BA[98],colorNeutralBackground2Hover:l.BA[94],colorNeutralBackground2Pressed:l.BA[86],colorNeutralBackground2Selected:l.BA[90],colorNeutralBackground3:l.BA[96],colorNeutralBackground3Hover:l.BA[92],colorNeutralBackground3Pressed:l.BA[84],colorNeutralBackground3Selected:l.BA[88],colorNeutralBackground4:l.BA[94],colorNeutralBackground4Hover:l.BA[98],colorNeutralBackground4Pressed:l.BA[96],colorNeutralBackground4Selected:l.ix,colorNeutralBackground5:l.BA[92],colorNeutralBackground5Hover:l.BA[96],colorNeutralBackground5Pressed:l.BA[94],colorNeutralBackground5Selected:l.BA[98],colorNeutralBackground6:l.BA[90],colorNeutralBackgroundInverted:l.BA[16],colorNeutralBackgroundStatic:l.BA[20],colorNeutralBackgroundAlpha:l.jZ[50],colorNeutralBackgroundAlpha2:l.jZ[80],colorSubtleBackground:"transparent",colorSubtleBackgroundHover:l.BA[96],colorSubtleBackgroundPressed:l.BA[88],colorSubtleBackgroundSelected:l.BA[92],colorSubtleBackgroundLightAlphaHover:l.jZ[70],colorSubtleBackgroundLightAlphaPressed:l.jZ[50],colorSubtleBackgroundLightAlphaSelected:"transparent",colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:l.Hf[10],colorSubtleBackgroundInvertedPressed:l.Hf[30],colorSubtleBackgroundInvertedSelected:l.Hf[20],colorTransparentBackground:"transparent",colorTransparentBackgroundHover:"transparent",colorTransparentBackgroundPressed:"transparent",colorTransparentBackgroundSelected:"transparent",colorNeutralBackgroundDisabled:l.BA[94],colorNeutralBackgroundInvertedDisabled:l.jZ[10],colorNeutralStencil1:l.BA[90],colorNeutralStencil2:l.BA[98],colorNeutralStencil1Alpha:l.Hf[10],colorNeutralStencil2Alpha:l.Hf[5],colorBackgroundOverlay:l.Hf[40],colorScrollbarOverlay:l.Hf[50],colorBrandBackground:e[80],colorBrandBackgroundHover:e[70],colorBrandBackgroundPressed:e[40],colorBrandBackgroundSelected:e[60],colorCompoundBrandBackground:e[80],colorCompoundBrandBackgroundHover:e[70],colorCompoundBrandBackgroundPressed:e[60],colorBrandBackgroundStatic:e[80],colorBrandBackground2:e[160],colorBrandBackground2Hover:e[150],colorBrandBackground2Pressed:e[130],colorBrandBackgroundInverted:l.ix,colorBrandBackgroundInvertedHover:e[160],colorBrandBackgroundInvertedPressed:e[140],colorBrandBackgroundInvertedSelected:e[150],colorNeutralStrokeAccessible:l.BA[38],colorNeutralStrokeAccessibleHover:l.BA[34],colorNeutralStrokeAccessiblePressed:l.BA[30],colorNeutralStrokeAccessibleSelected:e[80],colorNeutralStroke1:l.BA[82],colorNeutralStroke1Hover:l.BA[78],colorNeutralStroke1Pressed:l.BA[70],colorNeutralStroke1Selected:l.BA[74],colorNeutralStroke2:l.BA[88],colorNeutralStroke3:l.BA[94],colorNeutralStrokeSubtle:l.BA[88],colorNeutralStrokeOnBrand:l.ix,colorNeutralStrokeOnBrand2:l.ix,colorNeutralStrokeOnBrand2Hover:l.ix,colorNeutralStrokeOnBrand2Pressed:l.ix,colorNeutralStrokeOnBrand2Selected:l.ix,colorBrandStroke1:e[80],colorBrandStroke2:e[140],colorBrandStroke2Hover:e[120],colorBrandStroke2Pressed:e[80],colorCompoundBrandStroke:e[80],colorCompoundBrandStrokeHover:e[70],colorCompoundBrandStrokePressed:e[60],colorNeutralStrokeDisabled:l.BA[88],colorNeutralStrokeInvertedDisabled:l.jZ[40],colorTransparentStroke:"transparent",colorTransparentStrokeInteractive:"transparent",colorTransparentStrokeDisabled:"transparent",colorNeutralStrokeAlpha:l.Hf[5],colorStrokeFocus1:l.ix,colorStrokeFocus2:l.Sn,colorNeutralShadowAmbient:"rgba(0,0,0,0.12)",colorNeutralShadowKey:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.06)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.07)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.20)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.24)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"}}(e);return(0,n.Z)((0,n.Z)((0,n.Z)((0,n.Z)((0,n.Z)((0,n.Z)((0,n.Z)((0,n.Z)((0,n.Z)((0,n.Z)((0,n.Z)((0,n.Z)((0,n.Z)((0,n.Z)({},d.E),f.CH),f.tO),f.Vl),f.vC),h.G),m.l),m.e),v.l),g.y),t),u),(0,p.T)(t.colorNeutralShadowAmbient,t.colorNeutralShadowKey)),(0,p.T)(t.colorBrandShadowAmbient,t.colorBrandShadowKey,"Brand"))}},51221:function(e,t,r){"use strict";r.d(t,{T:function(){return o}});var n=r(4942);function o(e,t){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return r={},(0,n.Z)(r,"shadow2".concat(o),"0 0 2px ".concat(e,", 0 1px 2px ").concat(t)),(0,n.Z)(r,"shadow4".concat(o),"0 0 2px ".concat(e,", 0 2px 4px ").concat(t)),(0,n.Z)(r,"shadow8".concat(o),"0 0 2px ".concat(e,", 0 4px 8px ").concat(t)),(0,n.Z)(r,"shadow16".concat(o),"0 0 2px ".concat(e,", 0 8px 16px ").concat(t)),(0,n.Z)(r,"shadow28".concat(o),"0 0 8px ".concat(e,", 0 14px 28px ").concat(t)),(0,n.Z)(r,"shadow64".concat(o),"0 0 8px ".concat(e,", 0 32px 64px ").concat(t)),r}},17940:function(e,t,r){"use strict";function n(){return"undefined"!==typeof window&&!(!window.document||!window.document.createElement)}r.d(t,{N:function(){return n}})},81552:function(e,t,r){"use strict";r.d(t,{M:function(){return o}});var n=r(17940);function o(e){if((0,n.N)()&&"undefined"!==typeof document){var t=e;return t&&t.ownerDocument?t.ownerDocument:document}}},69561:function(e,t,r){"use strict";r.d(t,{J:function(){return i}});var n=r(17940),o=void 0;try{o=window}catch(a){}function i(e){if((0,n.N)()&&"undefined"!==typeof o){var t=e;return t&&t.ownerDocument&&t.ownerDocument.defaultView?t.ownerDocument.defaultView:o}}},71847:function(e,t,r){"use strict";r.d(t,{L:function(){return i},r:function(){return o}});var n=r(69561);function o(e){var t=null;try{var r=(0,n.J)();t=r?r.sessionStorage.getItem(e):null}catch(o){}return t}function i(e,t){var r;try{null===(r=(0,n.J)())||void 0===r||r.sessionStorage.setItem(e,t)}catch(o){}}},27186:function(e,t,r){"use strict";function n(e,t){if(!e)throw new Error("number"===typeof t?"0x".concat(t.toString(16).padStart(3,"0")):t)}r.d(t,{h:function(){return n}})},29930:function(e,t,r){"use strict";r.d(t,{d3:function(){return i},fW:function(){return o}});var n=r(24071),o=function(e){return n.pv.from(e,"base64").toString("utf-8")},i=function(e){return n.pv.from(e,"utf8").toString("base64")}},24071:function(e,t,r){"use strict";r.d(t,{IN:function(){return u},k8:function(){return l},pv:function(){return h},zT:function(){return d}});var n=r(15671),o=r(43144),i=r(60136),a=r(29388),s=r(28664),c=r(2009);function u(e,t){switch(t){case"base64":return c.fromByteArray(e);case"utf8":case"utf-8":case void 0:return(new TextDecoder).decode(e);default:throw new Error("invalid/unsupported encoding")}}var l=function(e,t){return h.from(e,t).buffer},d=function(e,t){return h.from(e).toString(t)};function f(e){var t=e;return e instanceof ArrayBuffer||"object"===typeof t&&null!==t&&"number"===typeof t.byteLength&&"function"===typeof t.slice&&void 0===t.byteOffset&&void 0===t.buffer}var h=function(e){(0,i.Z)(r,e);var t=(0,a.Z)(r);function r(){return(0,n.Z)(this,r),t.apply(this,arguments)}return(0,o.Z)(r,[{key:"toString",value:function(e){return u(this,e)}}],[{key:"from",value:function(e,t,n){if("string"===typeof e)return r.fromString(e,t);if(null!==e&&"object"===typeof e&&f(e.buffer))return r.fromArrayBuffer(e.buffer,e.byteOffset,e.byteLength);if(f(e))return r.fromArrayBuffer(e,t,n);throw new TypeError}},{key:"fromArrayBuffer",value:function(e,t,n){var o=null!==t&&void 0!==t?t:0,i=null!==n&&void 0!==n?n:e.byteLength-o;if(o<0||o>e.byteLength||i<0||i+o>e.byteLength)throw new RangeError;return new r(e,o,i)}},{key:"fromString",value:function(e,t){switch(t){case"base64":var n=this.sanitizeBase64(e);return new r(c.toByteArray(n).buffer);case"utf8":case"utf-8":case void 0:return new r((new TextEncoder).encode(e).buffer);default:throw new Error("invalid/unsupported encoding")}}},{key:"isBuffer",value:function(e){throw new Error("unimplemented")}},{key:"sanitizeBase64",value:function(e){var t=e;if((t=(t=t.split("=")[0]).replace(/[^\w+-/]/g,"")).length%4!==0){t+=["","===","==","="][t.length%4]}return t}}]),r}((0,s.Z)(Uint8Array))},95576:function(e,t,r){"use strict";function n(e){return 0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}r.d(t,{H:function(){return n}})},5927:function(e,t,r){"use strict";r.d(t,{g:function(){return i}});var n=r(74165),o=r(15861),i=function(){var e=(0,o.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){return setTimeout((function(){return e()}),t)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},1987:function(e,t,r){"use strict";r.d(t,{_:function(){return c}});var n=r(37762),o=r(15671),i=r(43144),a=r(60136),s=r(29388),c=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(e){var n;if((0,o.Z)(this,r),(n=t.call(this)).isDisposed=!1,n.forwardingEvents=new Map,void 0!==e){n.on(r.removeListenerEvent,(function(t){return n.unforwardEvent(e,t)})),n.on(r.newListenerEvent,(function(t){return n.forwardEvent(e,t)}))}return n}return(0,i.Z)(r,[{key:"disposed",get:function(){return this.isDisposed}},{key:"dispose",value:function(){this.isDisposed=!0;var e,t=(0,n.Z)(this.forwardingEvents.values());try{for(t.s();!(e=t.n()).done;){var r,o=e.value,i=(0,n.Z)(o.values());try{for(i.s();!(r=i.n()).done;){var a=r.value;try{a()}catch(s){}}}catch(c){i.e(c)}finally{i.f()}}}catch(c){t.e(c)}finally{t.f()}this.removeAllListeners(),this.forwardingEvents.clear()}},{key:"forwardEvent",value:function(e){for(var t=this,n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];for(var a=function(){var n=c[s];if(void 0!==e&&void 0!==n&&!r.isEmitterEvent(n)){var o=t.forwardingEvents.get(n);if(void 0===o&&(o=new Map,t.forwardingEvents.set(n,o)),!o.has(e)){var i=function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return t.emit.apply(t,[n].concat(r))};o.set(e,(function(){return e.off(n,i)})),e.on(n,i)}}},s=0,c=o;s<c.length;s++)a()}},{key:"unforwardEvent",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];for(var i=0,a=n;i<a.length;i++){var s=a[i];if(void 0!==s&&!r.isEmitterEvent(s)){var c=this.forwardingEvents.get(s);if(!0===(null===c||void 0===c?void 0:c.has(e))&&0===this.listenerCount(s)){var u=c.get(e);void 0!==u&&u(),c.delete(e),0===c.size&&this.forwardingEvents.delete(s)}}}}}],[{key:"isEmitterEvent",value:function(e){return e===r.newListenerEvent||e===r.removeListenerEvent}}]),r}(r(46115).L);c.newListenerEvent="newListener",c.removeListenerEvent="removeListener"},1920:function(e,t,r){"use strict";r.d(t,{o:function(){return i}});var n=r(15671),o=r(43144),i=function(){function e(t){(0,n.Z)(this,e),this.valueGenerator=t,this._evaluated=!1}return(0,o.Z)(e,[{key:"evaluated",get:function(){return this._evaluated}},{key:"value",get:function(){return this._evaluated||(this._evaluated=!0,this._value=this.valueGenerator()),this._value}}]),e}()},9070:function(e,t,r){"use strict";r.d(t,{S:function(){return n}});var n=globalThis.performance},63658:function(e,t,r){"use strict";r.d(t,{t:function(){return c}});var n=r(74165),o=r(15861),i=r(15671),a=r(43144),s=function(){function e(t,r){(0,i.Z)(this,e),this.expiry=t,this.cleanup=r,this.gcTimeouts=new Map}return(0,a.Z)(e,[{key:"schedule",value:function(e){var t=this;"indefinite"!==this.expiry.policy&&this.gcTimeouts.set(e,setTimeout((function(){t.cleanup(e),t.cancel(e)}),this.expiry.durationMs))}},{key:"cancel",value:function(e){var t=this.gcTimeouts.get(e);void 0!==t&&(clearTimeout(t),this.gcTimeouts.delete(e))}},{key:"update",value:function(e){"sliding"===this.expiry.policy&&(this.cancel(e),this.schedule(e))}}]),e}(),c=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.expiry,o=void 0===n?{policy:"indefinite"}:n,a=r.removeOnError,c=void 0===a?function(){return!0}:a;(0,i.Z)(this,e),this.cache=new Map,this.removeOnError=c,this.gc=new s(o,(function(e){return t.remove(e)}))}return(0,a.Z)(e,[{key:"has",value:function(e){return this.cache.has(e)}},{key:"get",value:function(e){return this.has(e)&&this.gc.update(e),this.cache.get(e)}},{key:"remove",value:function(e){return this.gc.cancel(e),this.cache.delete(e)}},{key:"addOrGet",value:function(){var e=(0,o.Z)((0,n.Z)().mark((function e(t,r){var i,a,s=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===(i=this.get(t))&&(a=function(){var e=(0,o.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),i=a(),this.cache.set(t,i),i.catch((function(e){s.removeOnError(e)&&s.remove(t)})),this.gc.schedule(t)),e.abrupt("return",i);case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"add",value:function(e,t){var r=this.has(e);return this.addOrGet(e,t).catch((function(){})),!r}},{key:"addValueOrGet",value:function(){var e=(0,o.Z)((0,n.Z)().mark((function e(t,r){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.addOrGet(t,(0,o.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r);case 1:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"addValue",value:function(e,t){return this.add(e,(0,o.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t);case 1:case"end":return e.stop()}}),e)}))))}}]),e}()},69163:function(e,t,r){"use strict";r.d(t,{B:function(){return s},d:function(){return c}});var n=r(74165),o=r(15861),i=r(15671),a=r(43144),s=function(){function e(){var t=this;(0,i.Z)(this,e),this.completed=!1,this.p=new Promise((function(e,r){t.res=e,t.rej=r}))}return(0,a.Z)(e,[{key:"isCompleted",get:function(){return this.completed}},{key:"promise",get:function(){return this.p}},{key:"resolve",value:function(e){void 0!==this.res&&(this.completed=!0,this.res(e))}},{key:"reject",value:function(e){void 0!==this.rej&&(this.completed=!0,this.rej(e))}}]),e}(),c=function(e){function t(e){(0,i.Z)(this,t),this.execute=e}return(0,a.Z)(t,[{key:e,get:function(){return this.getPromise()[Symbol.toStringTag]}},{key:"then",value:function(){var e=(0,o.Z)((0,n.Z)().mark((function e(t,r){var o,i=arguments;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(o=this.getPromise()).then.apply(o,i));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"catch",value:function(){var e=(0,o.Z)((0,n.Z)().mark((function e(t){var r,o=arguments;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(r=this.getPromise()).catch.apply(r,o));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"finally",value:function(){var e=(0,o.Z)((0,n.Z)().mark((function e(t){var r,o=arguments;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(r=this.getPromise()).finally.apply(r,o));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPromise",value:function(){var e=(0,o.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===this.result&&(this.result=this.execute()),e.abrupt("return",this.result);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),t}(Symbol.toStringTag)},46115:function(e,t,r){"use strict";r.d(t,{L:function(){return d}});var n=r(43144),o=r(15671),i=r(97326),a=r(60136),s=r(29388),c=r(11752),u=r(61120),l=r(47465),d=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(){var e,n,a,s,l,d,f,h;return(0,o.Z)(this,r),(h=t.call(this)).addListener=(0,c.Z)((e=(0,i.Z)(h),(0,u.Z)(r.prototype)),"addListener",e).bind((0,i.Z)(h)),h.on=(0,c.Z)((n=(0,i.Z)(h),(0,u.Z)(r.prototype)),"on",n).bind((0,i.Z)(h)),h.once=(0,c.Z)((a=(0,i.Z)(h),(0,u.Z)(r.prototype)),"once",a).bind((0,i.Z)(h)),h.prependListener=(0,c.Z)((s=(0,i.Z)(h),(0,u.Z)(r.prototype)),"prependListener",s).bind((0,i.Z)(h)),h.prependOnceListener=(0,c.Z)((l=(0,i.Z)(h),(0,u.Z)(r.prototype)),"prependOnceListener",l).bind((0,i.Z)(h)),h.removeListener=(0,c.Z)((d=(0,i.Z)(h),(0,u.Z)(r.prototype)),"removeListener",d).bind((0,i.Z)(h)),h.off=(0,c.Z)((f=(0,i.Z)(h),(0,u.Z)(r.prototype)),"off",f).bind((0,i.Z)(h)),h}return(0,n.Z)(r)}(l.EventEmitter)},89591:function(e,t,r){"use strict";function n(e){throw new Error(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Unreachable Case")}r.d(t,{U:function(){return n}})},90142:function(e,t,r){"use strict";var n;r.d(t,{u:function(){return n}}),function(e){e.genericError="genericError",e.throttlingError="throttlingError",e.dataCorruptionError="dataCorruptionError",e.dataProcessingError="dataProcessingError",e.usageError="usageError",e.clientSessionExpiredError="clientSessionExpiredError"}(n||(n={}))},57115:function(e,t,r){"use strict";var n;r.d(t,{m:function(){return n}}),function(e){e.Detached="Detached",e.Attaching="Attaching",e.Attached="Attached"}(n||(n={}))},74033:function(e,t,r){"use strict";r.d(t,{O:function(){return c}});var n=r(43144),o=r(15671),i=r(60136),a=r(29388),s=r(79616),c=function(e){(0,i.Z)(r,e);var t=(0,a.Z)(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this,e,{usageError:!0})).errorType=s.C.usageError,n.canRetry=!1,n}return(0,n.Z)(r)}(r(65059).j4)},78077:function(e,t,r){"use strict";r.d(t,{$:function(){return o},P:function(){return n}});var n=function(e){return"fluid"===(null===e||void 0===e?void 0:e.type)};function o(e){if(!n(e))throw new Error("resolved is not a Fluid url. Type: ".concat(null===e||void 0===e?void 0:e.type))}},26795:function(e,t,r){"use strict";r.d(t,{LW:function(){return i},UH:function(){return n},eK:function(){return a}});var n,o=r(34977);function i(e){return e.type===o.Cs.Operation}function a(e){return e.type===o.Cs.NoOp||e.type===n.Accept}!function(e){e.Accept="accept"}(n||(n={}))},1244:function(e,t,r){"use strict";r.d(t,{Gg:function(){return l},Hb:function(){return f},K7:function(){return b},LA:function(){return v},M_:function(){return p},V2:function(){return m},Yz:function(){return n},ZZ:function(){return w},j:function(){return k},jx:function(){return S},ms:function(){return C},nq:function(){return g},s1:function(){return y},y7:function(){return h}});var n,o=r(43144),i=r(15671),a=r(60136),s=r(29388),c=r(79616),u=r(65059);function l(){return"object"===typeof navigator&&null!==navigator&&"boolean"===typeof navigator.onLine?navigator.onLine?n.Online:n.Offline:n.Unknown}!function(e){e[e.Offline=0]="Offline",e[e.Online=1]="Online",e[e.Unknown=2]="Unknown"}(n||(n={}));var d=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(e,n,o){var a;return(0,i.Z)(this,r),(a=t.call(this,e,o)).canRetry=n,a.errorType=c.C.genericNetworkError,a}return(0,o.Z)(r)}(u.j4),f=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(e,n){var o;return(0,i.Z)(this,r),(o=t.call(this,e,n)).errorType=c.C.fluidInvalidSchema,o.canRetry=!1,o}return(0,o.Z)(r)}(u.j4),h=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(e,n){var o;return(0,i.Z)(this,r),(o=t.call(this,e,Object.assign(Object.assign({},n),{statusCode:400}))).errorType=r.errorType,o.canRetry=!1,o}return(0,o.Z)(r)}(u.j4);h.errorType=c.C.deltaStreamConnectionForbidden;var p=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(e,n,o,a){var s;return(0,i.Z)(this,r),(s=t.call(this,e,a,new Set(["claims","tenantId"]))).claims=n,s.tenantId=o,s.errorType=c.C.authorizationError,s.canRetry=!1,s}return(0,o.Z)(r)}(u.j4),v=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(e,n,o){var a;return(0,i.Z)(this,r),(a=t.call(this,e,o,new Set(["redirectUrl"]))).redirectUrl=n,a.errorType=c.C.locationRedirection,a.canRetry=!1,a}return(0,o.Z)(r)}(u.j4),g=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(e,n,o,a){var s;return(0,i.Z)(this,r),(s=t.call(this,e,a)).errorType=n,s.canRetry=o,s}return(0,o.Z)(r)}(u.j4),m=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(e,n,o){var a;return(0,i.Z)(this,r),(a=t.call(this,e,n,!1,o)).errorType=n,a}return(0,o.Z)(r)}(g),y=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(e,n,o){var a;return(0,i.Z)(this,r),(a=t.call(this,e,n,!0,o)).errorType=n,a}return(0,o.Z)(r)}(g),b=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(e,n,o){var a;return(0,i.Z)(this,r),(a=t.call(this,e,o)).retryAfterSeconds=n,a.errorType=c.C.throttlingError,a.canRetry=!0,a}return(0,o.Z)(r)}(u.j4),k=function(e,t){return new m(e,c.C.writeError,t)};function S(e,t,r){return void 0!==t.retryAfterMs&&t.canRetry?new b(e,t.retryAfterMs/1e3,r):new d(e,t.canRetry,r)}var C=function(e){return!0===(null===e||void 0===e?void 0:e.canRetry)},w=function(e){return void 0!==(null===e||void 0===e?void 0:e.retryAfterSeconds)?1e3*e.retryAfterSeconds:void 0}},20851:function(e,t,r){"use strict";r.d(t,{f:function(){return o}});var n=r(1244);function o(e,t,r){var o,i,a=Object.assign({},t),s=r.online;if(a.online="string"===typeof s?s:n.Yz[(0,n.Gg)()],"object"===typeof navigator&&null!==navigator){var c=navigator,u=null!==(i=null!==(o=c.connection)&&void 0!==o?o:c.mozConnection)&&void 0!==i?i:c.webkitConnection;null!==u&&"object"===typeof u&&(a.connectionType=u.type)}a.category=(0,n.ms)(r)?"generic":"error",e.sendTelemetryEvent(a,r)}},76692:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});var n="2.0.0-internal.4.4.3"},40698:function(e,t,r){"use strict";r.d(t,{p:function(){return c}});var n=r(74165),o=r(15861),i=r(15671),a=r(43144),s=r(27186),c=function(){function e(t){var r=this;(0,i.Z)(this,e),this.maxRequests=t,this.tasks=[],this.release=function(){var e=r.tasks.shift();if(void 0!==e)return e();r.maxRequests++},(0,s.h)(t>0,174)}return(0,a.Z)(e,[{key:"waitQueueLength",get:function(){return this.tasks.length}},{key:"acquire",value:function(){var e=(0,o.Z)((0,n.Z)().mark((function e(){var t=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.maxRequests>0)){e.next=3;break}return this.maxRequests--,e.abrupt("return");case 3:return e.abrupt("return",new Promise((function(e){t.tasks.push(e)})));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"schedule",value:function(){var e=(0,o.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.acquire();case 2:return e.abrupt("return",t().finally(this.release));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}()},91688:function(e,t,r){"use strict";r.d(t,{g:function(){return a}});var n=r(74165),o=r(15861),i=r(24071);function a(e,t){return s.apply(this,arguments)}function s(){return(s=(0,o.Z)((0,n.Z)().mark((function e(t,r){var o,a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.readBlob(r);case 2:return o=e.sent,a=(0,i.zT)(o,"utf8"),e.abrupt("return",JSON.parse(a));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},65675:function(e,t,r){"use strict";r.d(t,{F2:function(){return i},dM:function(){return a},yK:function(){return s}});var n=r(27186),o=r(24713);function i(e){var t,r,n,i;return void 0!==(null===e||void 0===e?void 0:e.tree)&&(null===(r=null===(t=e.tree)||void 0===t?void 0:t[".app"])||void 0===r?void 0:r.type)===o.J.Tree&&(null===(i=null===(n=e.tree)||void 0===n?void 0:n[".protocol"])||void 0===i?void 0:i.type)===o.J.Tree&&2===Object.keys(e.tree).length}function a(e,t){return(0,n.h)(!i(e),1448),(0,n.h)(!i(t),1449),{type:o.J.Tree,tree:{".protocol":t,".app":e}}}function s(e){var t=e.tree.attributes;return JSON.parse(t.content)}},79616:function(e,t,r){"use strict";var n;r.d(t,{C:function(){return n}}),function(e){e.genericError="genericError",e.genericNetworkError="genericNetworkError",e.authorizationError="authorizationError",e.fileNotFoundOrAccessDeniedError="fileNotFoundOrAccessDeniedError",e.throttlingError="throttlingError",e.offlineError="offlineError",e.unsupportedClientProtocolVersion="unsupportedClientProtocolVersion",e.writeError="writeError",e.fetchFailure="fetchFailure",e.fetchTokenError="fetchTokenError",e.incorrectServerResponse="incorrectServerResponse",e.fileOverwrittenInStorage="fileOverwrittenInStorage",e.deltaStreamConnectionForbidden="deltaStreamConnectionForbidden",e.locationRedirection="locationRedirection",e.fluidInvalidSchema="fluidInvalidSchema",e.usageError="usageError",e.fileIsLocked="fileIsLocked"}(n||(n={}))},31876:function(e,t,r){"use strict";r.d(t,{a:function(){return C}});var n=r(74165),o=r(15861),i=r(15671),a=r(43144),s=r(27186),c=r(82486),u=r(93433),l=[],d=!1;function f(e){l.push({task:e}),h(2e3)}function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!d){if(self.requestIdleCallback)self.requestIdleCallback(p);else{var t=Date.now()+50;self.setTimeout((function(){return p({timeRemaining:function(){return Math.max(t-Date.now(),0)},didTimeout:!1})}),e)}d=!0}}function p(e){!function(e,t){for(var r=[],n=0;n<l.length;n+=1){if(t&&!t()){r.push.apply(r,(0,u.Z)(l.slice(n)));break}var o=l[n];e&&!e(o)?r.push(o):o.task()}l=r}(void 0,(function(){return e.timeRemaining()>10})),d=!1,l.length>0&&h()}var v=r(5362),g="fluidDriverCache",m="driverStorage.V3",y={1:"diverStorage",2:"diverStorage.V2"};function b(e){return"".concat(e.file.docId,"_").concat(e.type,"_").concat(e.key)}function k(e){return new Promise((function(t,r){(0,v.X3)(g,3,{upgrade:function(t,r){try{var n=y[r];n&&t.deleteObjectStore(n)}catch(i){c.G2.create(e).sendErrorEvent({eventName:"FluidCacheDeleteOldDbError"},i)}var o=t.createObjectStore(m);o.createIndex("createdTimeMs","createdTimeMs"),o.createIndex("lastAccessTimeMs","lastAccessTimeMs"),o.createIndex("partitionKey","partitionKey"),o.createIndex("fileId","fileId")},blocked:function(){r(new Error("Could not open DB since it is blocked by an older client that has the DB open"))}}).then(t,r)}))}var S="2.0.0-internal.4.4.3",C=function(){function e(t){var r,a=this;(0,i.Z)(this,e),this.closeDbImmediately=!0,this.dbReuseCount=-1,this.logger=c.G2.create(t.logger),this.partitionKey=t.partitionKey,this.maxCacheItemAge=t.maxCacheItemAge,this.closeDbAfterMs=null!==(r=t.closeDbAfterMs)&&void 0!==r?r:0,this.closeDbAfterMs>0&&(this.closeDbImmediately=!1),f((0,o.Z)((0,n.Z)().mark((function e(){var t,r,o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(t=navigator.storage)||void 0===t?void 0:t.estimate)){e.next=6;break}return e.next=3,navigator.storage.estimate();case 3:"usageDetails"in(r=e.sent)&&(o=r.usageDetails.indexedDB),a.logger.sendTelemetryEvent({eventName:"FluidCacheStorageInfo",subCategory:"FluidCache",quota:r.quota,usage:r.usage,indexedDBSize:o,pkgVersion:S});case 6:case"end":return e.stop()}}),e)})))),f((0,o.Z)((0,n.Z)().mark((function e(){var t,r,o,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k(a.logger);case 3:return t=e.sent,r=t.transaction(m,"readwrite"),o=r.store.index("createdTimeMs"),e.next=8,o.getAllKeys(IDBKeyRange.upperBound((new Date).getTime()-a.maxCacheItemAge));case 8:return i=e.sent,e.next=11,Promise.all(i.map((function(e){return r.store.delete(e)})));case 11:return e.next=13,r.done;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),a.logger.sendErrorEvent({eventName:"FluidCacheDeleteOldEntriesError",pkgVersion:S},e.t0);case 18:return e.prev=18,null===t||void 0===t||t.close(),e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[0,15,18,21]])}))))}return(0,a.Z)(e,[{key:"openDb",value:function(){var e=(0,o.Z)((0,n.Z)().mark((function e(){var t,r=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.closeDbImmediately){e.next=2;break}return e.abrupt("return",k(this.logger));case 2:if(void 0!==this.db){e.next=18;break}return e.next=5,k(this.logger);case 5:if(t=e.sent,void 0!==this.db){e.next=11;break}this.dbReuseCount=-1,this.db=t,e.next=14;break;case 11:return t.close(),this.dbReuseCount+=1,e.abrupt("return",this.db);case 14:this.db.onversionchange=function(e){var t;null===(t=r.db)||void 0===t||t.close(),r.db=void 0,clearTimeout(r.dbCloseTimer),r.dbCloseTimer=void 0},this.db.addEventListener("close",(function(e){clearTimeout(r.dbCloseTimer),r.dbCloseTimer=void 0,r.db=void 0})),(0,s.h)(void 0===this.dbCloseTimer,1734),this.dbCloseTimer=setTimeout((function(){var e;null===(e=r.db)||void 0===e||e.close(),r.db=void 0,r.dbCloseTimer=void 0}),this.closeDbAfterMs);case 18:return(0,s.h)(void 0!==this.db,1735),this.dbReuseCount+=1,e.abrupt("return",this.db);case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"closeDb",value:function(e){this.closeDbImmediately&&(null===e||void 0===e||e.close())}},{key:"removeEntries",value:function(){var e=(0,o.Z)((0,n.Z)().mark((function e(t){var r,o,i,a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.openDb();case 3:return r=e.sent,o=r.transaction(m,"readwrite"),i=o.store.index("fileId"),e.next=8,i.getAllKeys(t.docId);case 8:return a=e.sent,e.next=11,Promise.all(a.map((function(e){return o.store.delete(e)})));case 11:return e.next=13,o.done;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),this.logger.sendErrorEvent({eventName:"FluidCacheDeleteOldEntriesError",pkgVersion:S},e.t0);case 18:return e.prev=18,this.closeDb(r),e.finish(18);case 21:case"end":return e.stop()}}),e,this,[[0,15,18,21]])})));return function(t){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=(0,o.Z)((0,n.Z)().mark((function e(t){var r,o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=performance.now(),e.next=3,this.getItemFromCache(t);case 3:return o=e.sent,this.logger.sendPerformanceEvent({eventName:"FluidCacheAccess",cacheHit:void 0!==o,type:t.type,duration:performance.now()-r,dbOpenPerf:null===o||void 0===o?void 0:o.dbOpenPerf,dbReuseCount:this.dbReuseCount,pkgVersion:S}),e.abrupt("return",null===o||void 0===o?void 0:o.cachedObject);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getItemFromCache",value:function(){var e=(0,o.Z)((0,n.Z)().mark((function e(t){var r,o,i,a,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o=b(t),i=performance.now(),e.next=5,this.openDb();case 5:return r=e.sent,a=performance.now()-i,e.next=9,r.get(m,o);case 9:if(s=e.sent){e.next=13;break}return this.closeDb(r),e.abrupt("return",void 0);case 13:if(s.partitionKey===this.partitionKey){e.next=17;break}return this.logger.sendTelemetryEvent({eventName:"FluidCachePartitionKeyMismatch",subCategory:"FluidCache",pkgVersion:S}),this.closeDb(r),e.abrupt("return",void 0);case 17:if(!((new Date).getTime()-s.createdTimeMs>this.maxCacheItemAge)){e.next=21;break}return this.closeDb(r),e.abrupt("return",void 0);case 21:return this.closeDb(r),e.abrupt("return",Object.assign(Object.assign({},s),{dbOpenPerf:a}));case 25:return e.prev=25,e.t0=e.catch(0),this.logger.sendErrorEvent({eventName:"FluidCacheGetError",pkgVersion:S},e.t0),this.closeDb(r),e.abrupt("return",void 0);case 30:case"end":return e.stop()}}),e,this,[[0,25]])})));return function(t){return e.apply(this,arguments)}}()},{key:"put",value:function(){var e=(0,o.Z)((0,n.Z)().mark((function e(t,r){var o,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.openDb();case 3:return o=e.sent,i=(new Date).getTime(),e.next=7,o.put(m,{cachedObject:r,fileId:t.file.docId,type:t.type,cacheItemId:t.key,partitionKey:this.partitionKey,createdTimeMs:i,lastAccessTimeMs:i},b(t));case 7:this.closeDb(o),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),this.logger.sendErrorEvent({eventName:"FluidCachePutError",pkgVersion:S},e.t0);case 13:return e.prev=13,this.closeDb(o),e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[0,10,13,16]])})));return function(t,r){return e.apply(this,arguments)}}()}]),e}()},18103:function(e,t,r){"use strict";r.d(t,{yW:function(){return S},oS:function(){return m},j:function(){return b},gg:function(){return w},y3:function(){return C}});var n,o=r(43144),i=r(15671),a=r(60136),s=r(29388),c=r(29439),u=r(37762);!function(e){e.genericError="genericError",e.genericNetworkError="genericNetworkError",e.authorizationError="authorizationError",e.fileNotFoundOrAccessDeniedError="fileNotFoundOrAccessDeniedError",e.throttlingError="throttlingError",e.offlineError="offlineError",e.unsupportedClientProtocolVersion="unsupportedClientProtocolVersion",e.writeError="writeError",e.fetchFailure="fetchFailure",e.fetchTokenError="fetchTokenError",e.incorrectServerResponse="incorrectServerResponse",e.fileOverwrittenInStorage="fileOverwrittenInStorage",e.deltaStreamConnectionForbidden="deltaStreamConnectionForbidden",e.locationRedirection="locationRedirection",e.fluidInvalidSchema="fluidInvalidSchema",e.usageError="usageError",e.fileIsLocked="fileIsLocked"}(n||(n={}));var l=r(82486),d=r(65059),f=r(1244),h=r(20427),p=r(29930);var v="Bearer";var g="2.0.0-internal.4.4.3",m=712,y="serviceReadOnly";function b(e){var t={sprequestduration:l.hy.numberFromString(e.get("sprequestduration")),contentsize:l.hy.numberFromString(e.get("content-length"))};[{headerName:"sprequestguid",logName:"sprequestguid"},{headerName:"request-id",logName:"requestId"},{headerName:"client-request-id",logName:"clientRequestId"},{headerName:"x-msedge-ref",logName:"xMsedgeRef"},{headerName:"X-Fluid-Retries",logName:"serverRetries"},{headerName:"content-encoding",logName:"contentEncoding"},{headerName:"content-type",logName:"contentType"}].forEach((function(r){var n=e.get(r.headerName);void 0!==n&&null!==n&&(t[r.logName]=n)}));var r=e.get("x-fluid-telemetry");if(void 0!==r&&null!==r){t.xFluidTelemetry=r;var n,o=r.split(",").map((function(e){return e.split("=")})),i=(0,u.Z)(o);try{for(i.s();!(n=i.n()).done;){var a=(0,c.Z)(n.value,2),s=a[0],d=a[1];if("Origin"===s.trim()){var f=void 0;switch(null===d||void 0===d?void 0:d.trim()){case"c":f="cache";break;case"g":f="graph";break;default:f=null===d||void 0===d?void 0:d.trim()}t.responseOrigin=f;break}}}catch(h){i.e(h)}finally{i.f()}}return t}var k=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(e,o,a){var s;return(0,i.Z)(this,r),(s=t.call(this,e,a,new Set(["redirectLocation"]))).redirectLocation=o,s.errorType=n.fileNotFoundOrAccessDeniedError,s.canRetry=!1,s}return(0,o.Z)(r)}(d.j4);function S(e,t,r,o,i){var a,s,c,u,l,d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},S=function(e){try{if(void 0!==e){var t=JSON.parse(e);if(function(e){var t=null===e||void 0===e?void 0:e.error;return"string"===typeof(null===t||void 0===t?void 0:t.message)&&(void 0===(null===t||void 0===t?void 0:t.code)||"string"===typeof(null===t||void 0===t?void 0:t.code))}(t))return{success:!0,errorResponse:t}}}catch(r){}return{success:!1}}(i);if(S.success){var C=S.errorResponse;d.responseMessage=C.error.message,c=function(e){for(var t=[],r=e.error;"object"===typeof r&&null!==r;)void 0!==r.code&&t.unshift(r.code),r=r.innerError;return t}(C),void 0!==c&&(u=c[0],d.innerMostErrorCode=u)}var w=Object.assign({driverVersion:g,statusCode:t},d);switch(t){case 400:if("fluidInvalidSchema"===u){s=new f.Hb(e,w);break}s=new f.V2(e,n.genericNetworkError,w);break;case 401:case 403:if(u===y)s=new f.s1(e,h.x.serviceReadOnly,w);else{var x=(null===o||void 0===o?void 0:o.headers)?function(e){var t=e.get("www-authenticate");if(t){var r,n=!1;return t.split(",").map((function(e){var t=e.split("=");t.length>=2&&(n||"error"!==t[0].trim().toLowerCase()?r||"claims"!==t[0].trim().toLowerCase()||(r=(0,p.fW)(JSON.parse(e.substring(e.indexOf("=")+1).trim()))):n="insufficient_claims"===JSON.parse(t[1].trim().toLowerCase()))})),n?r:void 0}}(o.headers):void 0,P=(null===o||void 0===o?void 0:o.headers)?function(e){var t=e.get("www-authenticate");if(t){var r,n=t.indexOf(v);if(!(n<0))return t.substring(n+v.length).split(",").map((function(e){if(!r){var t=e.split("=");t.length>=2&&"realm"===t[0].trim().toLowerCase()&&(r=JSON.parse(t[1].trim()))}})),r}}(o.headers):void 0;s=new f.M_(e,x,P,w)}break;case 404:if(S.success){var E=null===(a=null===S||void 0===S?void 0:S.errorResponse)||void 0===a?void 0:a.error;if(void 0!==(l=null===E||void 0===E?void 0:E["@error.redirectLocation"])){s=new k(e,l,w);break}}s=new f.V2(e,n.fileNotFoundOrAccessDeniedError,w);break;case 406:s=new f.V2(e,n.unsupportedClientProtocolVersion,w);break;case 410:s=new f.V2(e,h.x.cannotCatchUp,w);break;case 409:s=new f.V2(e,n.fileOverwrittenInStorage,w);break;case 412:s=new f.V2(e,n.genericNetworkError,w);break;case 413:s=new f.V2(e,h.x.snapshotTooBig,w);break;case 414:s=new f.V2(e,h.x.invalidFileNameError,w);break;case 423:if("resourceLocked"===u){s=new f.V2(e,n.fileIsLocked,w);break}case 500:s=new f.s1(e,n.genericNetworkError,w);break;case 501:s=new f.V2(e,h.x.fluidNotEnabled,w);break;case 507:s=new f.V2(e,h.x.outOfStorageError,w);break;case m:s=new f.V2(e,n.incorrectServerResponse,w);break;default:var Z=void 0!==r?1e3*r:void 0;s=(0,f.jx)(e,{canRetry:!0,retryAfterMs:Z},w)}return function(e,t,r){var n,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.online=f.Yz[(0,f.Gg)()],void 0!==r&&(e.facetCodes=r);if(t&&(o.responseType=t.type,t.headers)){for(var i=b(t.headers),a=0,s=Object.keys(i);a<s.length;a++){var c=s[a];o[c]=i[c]}e.serverEpoch=null!==(n=t.headers.get("x-fluid-epoch"))&&void 0!==n?n:void 0}e.addTelemetryProperties(o)}(s,o,c,void 0),s}function C(e,t,r,n,o){var i=S(e,t,function(e){if(null===e)return;var t=Number(e);if(Number.isNaN(t))return;return t}(r.headers.get("retry-after")),r,n,o);throw i.addTelemetryProperties({odspError:!0,storageServiceError:!0}),i}function w(e){return Array.isArray(null===e||void 0===e?void 0:e.facetCodes)}},20427:function(e,t,r){"use strict";var n;r.d(t,{x:function(){return n}}),function(e){e.outOfStorageError="outOfStorageError",e.invalidFileNameError="invalidFileNameError",e.snapshotTooBig="snapshotTooBig",e.fetchTimeout="fetchTimeout",e.fluidNotEnabled="fluidNotEnabled",e.fetchTokenError="fetchTokenError",e.cannotCatchUp="cannotCatchUp",e.serviceReadOnly="serviceReadOnly"}(n||(n={}))},34264:function(e,t,r){"use strict";r.d(t,{L:function(){return n},r:function(){return o}});var n="snapshot";function o(e){return"".concat(e.file.docId,"_").concat(e.type,"_").concat(e.key)}},74329:function(e,t,r){"use strict";var n,o,i;r.d(t,{SA:function(){return n},gh:function(){return i},h$:function(){return o}}),function(e){e.csl="csl"}(n||(n={})),function(e){e.organization="organization",e.users="users",e.anonymous="anonymous",e.default="default"}(o||(o={})),function(e){e.view="view",e.edit="edit"}(i||(i={}))},74094:function(e,t,r){"use strict";r.d(t,{U:function(){return o},_:function(){return n}});var n="https://my.microsoftpersonalcontent.com",o="https://1drv.ms"},84556:function(e,t,r){"use strict";r.d(t,{N:function(){return n}});var n=3},73333:function(e,t,r){"use strict";var n,o;r.d(t,{U:function(){return n},m:function(){return o}}),function(e){e.isSharingLinkToRedeem="isSharingLinkToRedeem"}(n||(n={})),function(e){e.isClpCompliantApp="X-CLP-Compliant-App"}(o||(o={}))},72330:function(e,t,r){"use strict";function n(e){var t="".concat(e.siteUrl,"?driveId=").concat(encodeURIComponent(e.driveId),"&itemId=").concat(encodeURIComponent(e.itemId),"&path=").concat(encodeURIComponent(e.dataStorePath));return e.containerPackageName&&(t+="&containerPackageName=".concat(encodeURIComponent(e.containerPackageName))),e.fileVersion&&(t+="&fileVersion=".concat(encodeURIComponent(e.fileVersion))),t}r.d(t,{v:function(){return n}})},48102:function(e,t,r){"use strict";r.d(t,{Km:function(){return N},TU:function(){return B}});var n=r(11752),o=r(61120),i=r(60136),a=r(29388),s=r(4942),c=r(29439),u=r(74165),l=r(15861),d=r(15671),f=r(43144),h=r(92810),p=r(27186),v=r(69163),g=r(40698),m=r(1244),y=r(34264),b=r(76269),k=r(15318),S=r(1467),C=r(65059),w=r(82486),x=r(89175),P=r(84556),E=r(73333),Z=r(71520);function T(e,t){var r=Object.assign({},(0,x.r8)(e)),n=new URL(t).origin,o="".concat(n).concat(new URL(r.siteUrl).pathname);return r.siteUrl=o,r}var N="Odsp409Error",F=function(){function e(t,r,n,o){(0,d.Z)(this,e),this.cache=t,this.fileEntry=r,this.logger=n,this.clientIsSummarizer=o,this.driverId=(0,h.Z)(),this.networkCallNumber=1,this.rateLimiter=new g.p(24),this.snapshotCacheExpiryTimeoutMs=(0,k.rZ)(n).config.getBoolean("Fluid.Driver.Odsp.TestOverride.DisableSnapshotCache")?0:1728e5}return(0,f.Z)(e,[{key:"setEpoch",value:function(e,t,r){(0,p.h)(void 0===this._fluidEpoch,475),this._fluidEpoch=e,this.logger.sendTelemetryEvent({eventName:"EpochLearnedFirstTime",epoch:e,fetchType:r,fromCache:t})}},{key:"get",value:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(t){var r,n,o,i;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.cache.get(this.fileEntryFromEntry(t));case 3:if(void 0!==(n=e.sent)&&n.version===P.N){e.next=6;break}return e.abrupt("return",void 0);case 6:if((0,p.h)(void 0!==n.fluidEpoch,476),void 0!==this._fluidEpoch){e.next=11;break}this.setEpoch(n.fluidEpoch,!0,"cache"),e.next=13;break;case 11:if(this._fluidEpoch===n.fluidEpoch){e.next=13;break}return e.abrupt("return",void 0);case 13:if(t.type!==y.L){e.next=21;break}if(o=null===(r=n.value)||void 0===r?void 0:r.cacheEntryTime,i=Date.now(),!(void 0===o||i-o>=this.snapshotCacheExpiryTimeoutMs)){e.next=21;break}return this.logger.sendTelemetryEvent({eventName:"odspVersionsCacheExpired",duration:i-o,maxCacheAgeMs:this.snapshotCacheExpiryTimeoutMs}),e.next=20,this.removeEntries();case 20:return e.abrupt("return",void 0);case 21:return e.abrupt("return",n.value);case 24:return e.prev=24,e.t0=e.catch(0),this.logger.sendErrorEvent({eventName:"cacheFetchError",type:t.type},e.t0),e.abrupt("return",void 0);case 28:case"end":return e.stop()}}),e,this,[[0,24]])})));return function(t){return e.apply(this,arguments)}}()},{key:"put",value:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(t,r){var n,o,i=this;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,p.h)(void 0!==this._fluidEpoch,477),t.type===y.L&&(r.cacheEntryTime=null!==(n=r.cacheEntryTime)&&void 0!==n?n:Date.now()),o={value:r,version:P.N,fluidEpoch:this._fluidEpoch},e.abrupt("return",this.cache.put(this.fileEntryFromEntry(t),o).catch((function(e){throw i.logger.sendErrorEvent({eventName:"cachePutError",type:t.type},e),e})));case 4:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"removeEntries",value:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(){return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.cache.removeEntries(this.fileEntry);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),this.logger.sendErrorEvent({eventName:"removeCacheEntries"},e.t0);case 9:case"end":return e.stop()}}),e,this,[[0,6]])})));return function(){return e.apply(this,arguments)}}()},{key:"fluidEpoch",get:function(){return this._fluidEpoch}},{key:"validateEpoch",value:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(t,r){return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,p.h)(void 0!==t,1412),e.prev=1,this.validateEpochFromResponse(t,r),e.next=10;break;case 5:return e.prev=5,e.t0=e.catch(1),e.next=9,this.checkForEpochError(e.t0,t,r);case 9:throw e.t0;case 10:case"end":return e.stop()}}),e,this,[[1,5]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"fetchAndParseAsJSON",value:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(t,r,n){var o,i,a=arguments;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=a.length>3&&void 0!==a[3]&&a[3],i=a.length>4?a[4]:void 0,e.abrupt("return",this.fetchCore(t,r,x.tu,n,o,i));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"fetch",value:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(t,r,n){var o,i,a=arguments;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=a.length>3&&void 0!==a[3]&&a[3],i=a.length>4?a[4]:void 0,e.abrupt("return",this.fetchCore(t,r,x.X7,n,o,i));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"fetchCore",value:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(t,r,n,o){var i,a,s,c,d=this,f=arguments;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=f.length>4&&void 0!==f[4]&&f[4],a=f.length>5?f[5]:void 0,s=this.formatClientCorrelationId(a),this.addEpochInRequest(r,i,s),e.abrupt("return",this.rateLimiter.schedule((0,l.Z)((0,u.Z)().mark((function e(){return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n(t,r));case 1:case"end":return e.stop()}}),e)})))).then((function(e){return c=e.headers.get("x-fluid-epoch"),d.validateEpochFromResponse(c,o),e.propsToLog.XRequestStatsHeader=s,e})).catch(function(){var e=(0,l.Z)((0,u.Z)().mark((function e(t){return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===c&&(c=t.serverEpoch),e.next=3,d.checkForEpochError(t,c,o);case 3:throw t;case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){if((0,S.IR)(e)&&e.errorType===b.C.fileNotFoundOrAccessDeniedError){var t=e.redirectLocation;if(void 0!==t){var r=T(d.fileEntry.resolvedUrl,t),n=new m.LA(e.message,r,{driverVersion:Z.Z,redirectLocation:t});throw n.addTelemetryProperties(e.getTelemetryProperties()),n}}throw e})).catch((function(e){throw(0,C.SC)(e,{props:{XRequestStatsHeader:s}})})));case 5:case"end":return e.stop()}}),e,this)})));return function(t,r,n,o){return e.apply(this,arguments)}}()},{key:"fetchArray",value:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(t,r,n){var o,i,a=arguments;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=a.length>3&&void 0!==a[3]&&a[3],i=a.length>4?a[4]:void 0,e.abrupt("return",this.fetchCore(t,r,x.n$,n,o,i));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"addEpochInRequest",value:function(e,t,r){var n=(0,x.r8)(this.fileEntry.resolvedUrl).isClpCompliantApp;if(t){var o={};o["X-RequestStats"]=r,void 0!==this.fluidEpoch&&(o["x-fluid-epoch"]=this.fluidEpoch),n&&(o[E.m.isClpCompliantApp]=n.toString()),this.addParamInBody(e,o)}else{var i=function(t,r){e.headers=Object.assign({},e.headers),(0,p.h)(void 0!==e.headers,642),e.headers[t]=r};i("X-RequestStats",r),void 0!==this.fluidEpoch&&i("x-fluid-epoch",this.fluidEpoch),n&&i(E.m.isClpCompliantApp,n.toString())}}},{key:"addParamInBody",value:function(e,t){var r=e.body;(0,p.h)("string"===typeof r,541);var n=r.split("\r\n"),o=n.shift();(0,p.h)(!0===(null===o||void 0===o?void 0:o.startsWith("--")),542);var i=[o];Object.entries(t).forEach((function(e){var t=(0,c.Z)(e,2),r=t[0],n=t[1];i.push("".concat(r,": ").concat(n))})),n.forEach((function(e){i.push(e)})),e.body=i.join("\r\n")}},{key:"formatClientCorrelationId",value:function(e){var t=["driverId=".concat(this.driverId),"RequestNumber=".concat(this.networkCallNumber++),"driverVersion=".concat(Z.Z),"isSummarizer=".concat(this.clientIsSummarizer)];return void 0!==e&&t.push("fetchReason=".concat(e)),t.join(", ")}},{key:"validateEpochFromResponse",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.checkForEpochErrorCore(e);if(void 0!==n)throw n;void 0!==e&&void 0===this._fluidEpoch&&this.setEpoch(e,r,t)}},{key:"checkForEpochError",value:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(t,r,n){var o,i,a,c=arguments;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=c.length>3&&void 0!==c[3]&&c[3],!(0,S.IR)(t)||t.errorType!==b.C.fileOverwrittenInStorage){e.next=10;break}if(void 0===(a=this.checkForEpochErrorCore(r))){e.next=9;break}return a.addTelemetryProperties({fromCache:o,fetchType:n}),this.logger.sendErrorEvent({eventName:"fileOverwrittenInStorage"},a),e.next=8,this.removeEntries();case 8:throw a;case 9:throw new m.K7("Coherency 409: ".concat(t.message),1,(i={},(0,s.Z)(i,N,!0),(0,s.Z)(i,"driverVersion",Z.Z),i));case 10:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"checkForEpochErrorCore",value:function(e){if(this.fluidEpoch&&e&&this.fluidEpoch!==e)return new m.V2("Epoch mismatch",b.C.fileOverwrittenInStorage,{driverVersion:Z.Z,serverEpoch:e,clientEpoch:this.fluidEpoch})}},{key:"fileEntryFromEntry",value:function(e){return Object.assign(Object.assign({},e),{file:this.fileEntry})}}]),e}(),I=function(e){(0,i.Z)(r,e);var t=(0,a.Z)(r);function r(e,n,o,i){var a;return(0,d.Z)(this,r),(a=t.call(this,e,n,o,i)).cache=e,a.fileEntry=n,a.logger=o,a.clientIsSummarizer=i,a.treesLatestDeferral=new v.B,a.treesLatestDeferral.promise.catch((function(){})),a}return(0,f.Z)(r,[{key:"validateEpochFromResponse",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];(0,n.Z)((0,o.Z)(r.prototype),"validateEpochFromResponse",this).call(this,e,t,i),this.treesLatestDeferral.resolve()}},{key:"get",value:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(t){var i,a=this;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(0,n.Z)((0,o.Z)(r.prototype),"get",this).call(this,t),t.type===y.L&&(i=i.then((function(e){return void 0!==e&&a.treesLatestDeferral.resolve(),e})).catch((function(e){throw a.treesLatestDeferral.reject(e),e}))),e.abrupt("return",i);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchAndParseAsJSON",value:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(t,i,a){var s,c,d,f=this,h=arguments;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=h.length>3&&void 0!==h[3]&&h[3],c=h.length>4?h[4]:void 0,d=this.treesLatestDeferral.isCompleted,e.prev=3,e.next=6,(0,n.Z)((0,o.Z)(r.prototype),"fetchAndParseAsJSON",this).call(this,t,i,a,s,c);case 6:return e.abrupt("return",e.sent);case 9:if(e.prev=9,e.t0=e.catch(3),"treesLatest"===a&&this.treesLatestDeferral.reject(e.t0),!("joinSession"!==a||e.t0.statusCode<401||e.t0.statusCode>404||d)){e.next=14;break}throw e.t0;case 14:return e.next=16,w.Xr.timedExecAsync(this.logger,{eventName:"JoinSessionSyncWait"},function(){var e=(0,l.Z)((0,u.Z)().mark((function e(t){var r,n,o;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=51,o=new Promise((function(e){n=setTimeout((function(){e(r)}),15e3)})),e.next=4,Promise.race([o,f.treesLatestDeferral.promise.finally((function(){return clearTimeout(n)}))]);case 4:e.sent===r&&t.cancel();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{start:!0,end:!0,cancel:"generic"});case 16:return e.abrupt("return",(0,n.Z)((0,o.Z)(r.prototype),"fetchAndParseAsJSON",this).call(this,t,i,a,s));case 17:case"end":return e.stop()}}),e,this,[[3,9]])})));return function(t,r,n){return e.apply(this,arguments)}}()}]),r}(F);function B(e,t,r,n,o){var i=new I(e,r,n,o);return{cache:Object.assign(Object.assign({},t),{persistedCache:i}),epochTracker:i}}},66584:function(e,t,r){"use strict";function n(e,t,r){if(!t||0===t.length)return{url:e,headers:{}};if(!r){var n=new URL(e);if(n.searchParams.set("access_token",t),n.search.length<=2048)return{headers:{},url:n.href}}return{headers:{Authorization:"Bearer ".concat(t)},url:e}}r.d(t,{y:function(){return n}})},81543:function(e,t,r){"use strict";r.d(t,{D:function(){return x}});var n=r(74165),o=r(29439),i=r(15861),a=r(15671),s=r(43144),c=r(27186),u=r(65452),l=r(76269),d=r(74329),f=r(1244),h=r(72330),p=r(84693),v=r(89175),g=r(36020),m=r(73333),y=r(71520);function b(e,t,r,n){var o=new URL(e).origin,i=n?"versions/".concat(n,"/"):"";return"".concat((0,p.cB)(o),"/drives/").concat(t,"/items/").concat(r,"/").concat(i)}function k(e,t,r,n){var o=b(e,t,r,n);return"".concat(o,"opStream/snapshots")}function S(e,t,r,n){var o=b(e,t,r,n);return"".concat(o,"opStream/attachment")}function C(e,t,r,n){var o=b(e,t,r,n);return"".concat(o,"opStream/attachments")}function w(e,t,r,n){var o=b(e,t,r,n);return"".concat(o,"opStream")}var x=function(){function e(){(0,a.Z)(this,e)}return(0,s.Z)(e,[{key:"resolve",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,i,a,s,h,p,v,b,x,E,Z,T,N,F,I,B,D,A,O,L,_,M,R,H,j;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(r=t.headers)||void 0===r?void 0:r[u.i.createNew])){e.next=12;break}if(h=t.url.split("?"),p=(0,o.Z)(h,2),v=p[0],b=p[1],x=new URLSearchParams(b),E=t.headers[u.i.createNew].fileName,Z=x.get("driveId"),T=x.get("path"),N=x.get("containerPackageName"),F=x.get("createLinkType"),E&&v&&Z&&null!==T&&void 0!==T){e.next=10;break}throw new f.V2("Proper new file params should be there!!",l.C.genericError,{driverVersion:y.Z});case 10:return F&&F in d.SA&&(I={createLink:{type:d.SA[F]}}),e.abrupt("return",{endpoints:{snapshotStorageUrl:"",attachmentGETStorageUrl:"",attachmentPOSTStorageUrl:"",deltaStorageUrl:""},tokens:{},type:"fluid",odspResolvedUrl:!0,id:"odspCreateNew",url:"fluid-odsp://".concat(v,"?").concat(b,"&version=null"),siteUrl:v,hashedDocumentId:"",driveId:Z,itemId:"",fileName:E,summarizer:!1,codeHint:{containerPackageName:null!==N&&void 0!==N?N:void 0},fileVersion:void 0,shareLinkInfo:I,isClpCompliantApp:null===(i=t.headers)||void 0===i?void 0:i[m.m.isClpCompliantApp]});case 12:return B=P(t.url),D=B.siteUrl,A=B.driveId,O=B.itemId,L=B.path,_=B.containerPackageName,M=B.fileVersion,e.next=15,(0,g.z)(A,O);case 15:return R=e.sent,(0,c.h)(!R.includes("/"),168),H="fluid-odsp://placeholder/placeholder/".concat(R,"/").concat((n=L).startsWith("/")?n.substr(1):n),j=!!(null===(a=t.headers)||void 0===a?void 0:a[u.i.summarizingClient]),e.abrupt("return",{type:"fluid",odspResolvedUrl:!0,endpoints:{snapshotStorageUrl:k(D,A,O,M),attachmentPOSTStorageUrl:S(D,A,O,M),attachmentGETStorageUrl:C(D,A,O,M),deltaStorageUrl:w(D,A,O,M)},id:R,tokens:{},url:H,hashedDocumentId:R,siteUrl:D,driveId:A,itemId:O,dataStorePath:L,fileName:"",summarizer:j,codeHint:{containerPackageName:_},fileVersion:M,isClpCompliantApp:null===(s=t.headers)||void 0===s?void 0:s[m.m.isClpCompliantApp]});case 20:case"end":return e.stop()}var n}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAbsoluteUrl",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r,o){var i,a,s,c,u,l,d,f;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=(0,v.r8)(t),l=r,""===r&&void 0!==u.dataStorePath&&(l=u.dataStorePath),l.startsWith("/")&&(l=l.substr(1)),d=function(e){return"object"===typeof e&&"string"===typeof(null===e||void 0===e?void 0:e.name)&&"object"===typeof(null===e||void 0===e?void 0:e.fluid)},f=null!==(f=o&&"name"in o?o.name:d(null===(i=o)||void 0===i?void 0:i.package)?null===(a=o)||void 0===a?void 0:a.package.name:null===(s=o)||void 0===s?void 0:s.package)&&void 0!==f?f:null===(c=u.codeHint)||void 0===c?void 0:c.containerPackageName,e.abrupt("return",(0,h.v)(Object.assign(Object.assign({},u),{containerPackageName:f,dataStorePath:l})));case 8:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()}]),e}();function P(e){var t=e.split("?"),r=(0,o.Z)(t,2),n=r[0],i=r[1],a=new URLSearchParams(i),s=a.get("driveId"),c=a.get("itemId"),u=a.get("path"),l=a.get("containerPackageName"),d=a.get("fileVersion");if(null===s)throw new Error("ODSP URL did not contain a drive id");if(null===c)throw new Error("ODSP Url did not contain an item id");if(null===u)throw new Error("ODSP Url did not contain a path");return{siteUrl:n,driveId:decodeURIComponent(s),itemId:decodeURIComponent(c),path:decodeURIComponent(u),containerPackageName:l?decodeURIComponent(l):void 0,fileVersion:d?decodeURIComponent(d):void 0}}},78030:function(e,t,r){"use strict";r.d(t,{D:function(){return T}});var n=r(74165),o=r(15861),i=r(15671),a=r(43144),s=r(63658),c=r(56061),u=r(73333),l=r(72330),d=r(81543),f=r(89175),h=r(27186),p=r(1244),v=r(82486),g=r(76269),m=r(66584),y=r(71520),b=r(42874),k=new Map;function S(e,t,r){return C.apply(this,arguments)}function C(){return C=(0,o.Z)((0,n.Z)().mark((function e(t,r,i){var a,s,c,u;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a="".concat(r.siteUrl,"_").concat(r.driveId,"_").concat(r.itemId),void 0===(s=k.get(a))){e.next=4;break}return e.abrupt("return",s);case 4:return c=function(){var e=(0,o.Z)((0,n.Z)().mark((function e(){var s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,b.k)((0,o.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",w(t,r,i));case 1:case"end":return e.stop()}}),e)}))),"getFileLinkCore",i);case 3:s=e.sent,e.next=10;break;case 6:throw e.prev=6,e.t0=e.catch(0),(0,p.ms)(e.t0)||k.delete(a),e.t0;case 10:return(0,h.h)(void 0!==s,658),e.abrupt("return",s);case 12:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),u=c(),k.set(a,u),e.abrupt("return",u);case 8:case"end":return e.stop()}}),e)}))),C.apply(this,arguments)}function w(e,t,r){return x.apply(this,arguments)}function x(){return x=(0,o.Z)((0,n.Z)().mark((function e(t,r,i){var a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E(t,r,i,!0);case 2:return a=e.sent,e.abrupt("return",v.Xr.timedExecAsync(i,{eventName:"odspFileLink",requestName:"getSharingInformation"},function(){var e=(0,o.Z)((0,n.Z)().mark((function e(s){var c,u,l;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=0,e.next=3,(0,f.PM)(function(){var e=(0,o.Z)((0,n.Z)().mark((function e(o){var s,l,d,v,b,k,S,C,w,x;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c++,l=(0,f.zZ)(i,r,t,!0),e.next=4,l(o,"GetFileLinkCore");case 4:return d=e.sent,(0,h.h)(null!==d,699),v=(0,m.y)("".concat(r.siteUrl,"/_api/web/GetFileById(@a1)/ListItemAllFields/GetSharingInformation?@a1=guid").concat(encodeURIComponent("'".concat(a.sharepointIds.listItemUniqueId,"'"))),d,!0),b=v.url,k=v.headers,S={method:"POST",headers:Object.assign({"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose"},k)},e.next=10,(0,f.X7)(b,S);case 10:return C=e.sent,u=C.propsToLog,e.next=14,C.content.json();case 14:if(w=e.sent,"string"===typeof(x=null===(s=null===w||void 0===w?void 0:w.d)||void 0===s?void 0:s.directUrl)){e.next=18;break}throw new p.V2("Malformed GetSharingInformation response",g.C.incorrectServerResponse,{driverVersion:y.Z});case 18:return e.abrupt("return",x);case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:return l=e.sent,s.end(Object.assign(Object.assign({},u),{attempts:c})),e.abrupt("return",l);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:case"end":return e.stop()}}),e)}))),x.apply(this,arguments)}var P=function(e){return"string"===typeof e.webUrl&&"string"===typeof e.webDavUrl&&"object"===typeof e.sharepointIds};function E(e,t,r,n){return Z.apply(this,arguments)}function Z(){return Z=(0,o.Z)((0,n.Z)().mark((function e(t,r,i,a){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",v.Xr.timedExecAsync(i,{eventName:"odspFileLink",requestName:"getFileItemLite"},function(){var e=(0,o.Z)((0,n.Z)().mark((function e(s){var c,u,l;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=0,e.next=3,(0,f.PM)(function(){var e=(0,o.Z)((0,n.Z)().mark((function e(o){var s,l,d,v,b,k,S,C,w,x,E;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c++,s=r.siteUrl,l=r.driveId,d=r.itemId,v=(0,f.zZ)(i,r,t,!0),e.next=5,v(o,"GetFileItemLite");case 5:return b=e.sent,(0,h.h)(null!==b,700),k=(0,m.y)("".concat(s,"/_api/v2.0/drives/").concat(l,"/items/").concat(d,"?select=webUrl,webDavUrl,sharepointIds"),b,a),S=k.url,C=k.headers,w={method:"GET",headers:C},e.next=11,(0,f.X7)(S,w);case 11:return x=e.sent,u=x.propsToLog,e.next=15,x.content.json();case 15:if(E=e.sent,P(E)){e.next=18;break}throw new p.V2("Malformed getFileItemLite response",g.C.incorrectServerResponse,{driverVersion:y.Z});case 18:return e.abrupt("return",E);case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:return l=e.sent,s.end(Object.assign(Object.assign({},u),{attempts:c})),e.abrupt("return",l);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)}))),Z.apply(this,arguments)}var T=function(){function e(t,r,n,o){(0,i.Z)(this,e),this.appName=n,this.getContext=o,this.sharingLinkCache=new s.t,this.logger=(0,f.Wt)(r),t&&(this.shareLinkFetcherProps=Object.assign(Object.assign({},t),{tokenFetcher:t.tokenFetcher}))}return(0,a.Z)(e,[{key:"appendDataStorePath",value:function(e,t){var r=(0,c.KT)(e);if(r){var n=new URL(r.dataStorePath,"".concat(e.protocol,"//").concat(e.hostname));if(t.startsWith("/?")||t.startsWith("?"))new URLSearchParams(t).forEach((function(e,t){n.searchParams.append(t,e)})),r.dataStorePath="".concat(n.pathname).concat(n.search);else r.dataStorePath="".concat(n.pathname).concat(n.pathname.endsWith("/")||t.startsWith("/")?"":"/").concat(t,"/").concat(n.search);return(0,c.MI)(e,r),e.href}}},{key:"getKey",value:function(e){return"".concat(e.siteUrl,",").concat(e.driveId,",").concat(e.itemId)}},{key:"resolve",value:function(){var e=(0,o.Z)((0,n.Z)().mark((function e(t){var r,o,i,a,s,f,h;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i={headers:t.headers,url:t.url},a=null===(r=i.headers)||void 0===r?void 0:r[u.U.isSharingLinkToRedeem];try{s=new URL(t.url),(f=(0,c.KT)(s))&&(i.url=(0,l.v)(f))}catch(n){}return e.next=5,(new d.D).resolve(i);case 5:return h=e.sent,a&&(h.shareLinkInfo=Object.assign(null!==(o=h.shareLinkInfo)&&void 0!==o?o:{},{sharingLinkToRedeem:this.removeNavParam(t.url)})),h.itemId&&this.getShareLinkPromise(h).catch((function(){})),e.abrupt("return",h);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"removeNavParam",value:function(e){var t=new URL(e),r=new URLSearchParams(t.search);return r.delete(c.ku),t.search=r.toString(),t.href}},{key:"getShareLinkPromise",value:function(){var e=(0,o.Z)((0,n.Z)().mark((function e(t){var r,i,a,s=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.shareLinkFetcherProps){e.next=2;break}throw new Error("Failed to get share link because share link fetcher props are missing");case 2:if(t.siteUrl&&t.driveId&&t.itemId){e.next=4;break}throw new Error("Failed to get share link because necessary information is missing (e.g. siteUrl, driveId or itemId)");case 4:if(r=this.getKey(t),!(i=this.sharingLinkCache.get(r))){e.next=8;break}return e.abrupt("return",i);case 8:return a=S(this.shareLinkFetcherProps.tokenFetcher,t,this.logger).catch((function(e){throw s.logger.sendErrorEvent({eventName:"FluidFileUrlError"},e),s.sharingLinkCache.remove(r),e})),this.sharingLinkCache.add(r,(0,o.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a);case 1:case"end":return e.stop()}}),e)})))),e.abrupt("return",a);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAbsoluteUrl",value:function(){var e=(0,o.Z)((0,n.Z)().mark((function e(t,r,o){var i,a,s,u,l,d,h,p,v,g,m,y;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d=(0,f.r8)(t),e.next=3,this.getShareLinkPromise(d);case 3:return h=e.sent,p=new URL(h),v=r,""===r&&void 0!==d.dataStorePath&&(v=d.dataStorePath),g=function(e){return"object"===typeof e&&"string"===typeof(null===e||void 0===e?void 0:e.name)&&"object"===typeof(null===e||void 0===e?void 0:e.fluid)},m=null!==(m=o&&"name"in o?o.name:g(null===(i=o)||void 0===i?void 0:i.package)?null===(a=o)||void 0===a?void 0:a.package.name:null===(s=o)||void 0===s?void 0:s.package)&&void 0!==m?m:null===(u=d.codeHint)||void 0===u?void 0:u.containerPackageName,e.next=12,null===(l=this.getContext)||void 0===l?void 0:l.call(this,d,v);case 12:return y=e.sent,(0,c.MI)(p,{siteUrl:d.siteUrl,driveId:d.driveId,itemId:d.itemId,dataStorePath:v,appName:this.appName,containerPackageName:m,fileVersion:d.fileVersion,context:y}),e.abrupt("return",p.href);case 15:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()}],[{key:"createDocumentUrl",value:function(e,t){var r=new URL(e);return(0,c.MI)(r,t),r.href}},{key:"createNavParam",value:function(e){return(0,c.mt)(e)}}]),e}()},56061:function(e,t,r){"use strict";r.d(t,{KT:function(){return y},MI:function(){return m},ku:function(){return g},mt:function(){return v}});var n=r(29930),o=r(74094),i="1",a="fluid",s="s",c="d",u="f",l="c",d="a",f="p",h="v",p="x";function v(e){var t=new URL(e.siteUrl),r=encodeURIComponent(t.pathname),o=encodeURIComponent(e.driveId),v=encodeURIComponent(e.itemId),g=encodeURIComponent(e.dataStorePath),m="".concat(s,"=").concat(r,"&").concat(c,"=").concat(o,"&").concat(u,"=").concat(v,"&").concat(l,"=").concat(g,"&").concat(a,"=").concat(i);return e.appName&&(m+="&".concat(d,"=").concat(encodeURIComponent(e.appName))),e.containerPackageName&&(m+="&".concat(f,"=").concat(encodeURIComponent(e.containerPackageName))),e.fileVersion&&(m+="&".concat(h,"=").concat(encodeURIComponent(e.fileVersion))),e.context&&(m+="&".concat(p,"=").concat(encodeURIComponent(e.context))),(0,n.d3)(m)}var g="nav";function m(e,t){var r=v(t);e.searchParams.set(g,r)}function y(e){var t=e.searchParams.get(g);if(t)return function(e,t){var r,o,i,v,g=new URLSearchParams((0,n.fW)(e));if("1"===g.get(a)){var m=g.get(s),y=g.get(c),b=g.get(u),k=g.get(l),S=null!==(r=g.get(d))&&void 0!==r?r:void 0,C=null!==(o=g.get(f))&&void 0!==o?o:void 0,w=null!==(i=g.get(h))&&void 0!==i?i:void 0,x=null!==(v=g.get(p))&&void 0!==v?v:void 0;if(m&&y&&b&&null!==k){var P;try{P=new URL(m,t)}catch(E){}if(P)return{siteUrl:P.href,driveId:y,itemId:b,dataStorePath:k,appName:S,containerPackageName:C,fileVersion:w,context:x}}}}(t,e.origin.toLowerCase()===o.U?o._:e.origin)}},36020:function(e,t,r){"use strict";r.d(t,{z:function(){return f}});var n=r(74165),o=r(15861),i=r(24071),a=r(2009);function s(e,t){return c.apply(this,arguments)}function c(){return(c=(0,o.Z)((0,n.Z)().mark((function e(t,r){var o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,crypto.subtle.digest(r,t);case 2:return o=e.sent,e.abrupt("return",new Uint8Array(o));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function u(e,t){switch(t){case"hex":return Array.prototype.map.call(e,(function(e){return e.toString(16).padStart(2,"0")})).join("");case"base64":return a.fromByteArray(e)}}function l(e){return d.apply(this,arguments)}function d(){return d=(0,o.Z)((0,n.Z)().mark((function e(t){var i,a,c,l=arguments;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=l.length>1&&void 0!==l[1]?l[1]:"SHA-1",a=l.length>2&&void 0!==l[2]?l[2]:"hex",void 0!==crypto.subtle){e.next=4;break}return e.abrupt("return",r.e(8564).then(r.bind(r,18075)).then(function(){var e=(0,o.Z)((0,n.Z)().mark((function e(r){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.hashFile(t,i,a));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:return e.next=6,s(t,i);case 6:return c=e.sent,e.abrupt("return",u(c,a));case 8:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}function f(e,t){return h.apply(this,arguments)}function h(){return(h=(0,o.Z)((0,n.Z)().mark((function e(t,r){var o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=i.pv.from("".concat(t,"_").concat(r)),e.t0=encodeURIComponent,e.next=4,l(o,"SHA-256","base64");case 4:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},84693:function(e,t,r){"use strict";function n(e){return e.includes("onedrive.com")||e.includes("storage.live.com")||e.includes("storage.live-int.com")||e.includes("onedrive-tst.com")}function o(e){var t="_api/";return n(e)&&(t=""),"".concat(e,"/").concat(t,"v2.1")}r.d(t,{Is:function(){return n},cB:function(){return o}})},89175:function(e,t,r){"use strict";r.d(t,{Wd:function(){return R},db:function(){return _},Wt:function(){return O},tu:function(){return I},n$:function(){return N},X7:function(){return Z},r8:function(){return A},P$:function(){return w},PM:function(){return P},Cx:function(){return C},zs:function(){return D},OC:function(){return M},L8:function(){return H},iw:function(){return j},zZ:function(){return L},wz:function(){return q}});var n=r(74165),o=r(15861),i=r(29439),a=r(37762),s=r(76269),c=r(1244),u=r(9070),l=r(27186),d=r(82486),f=r(65059),h=r(18103),p=r(20427),v=function(e){return null===e||"string"===typeof e?e:void 0===e?null:e.token},g=function(e){return null===e||"string"===typeof e?void 0:e.fromCache},m=r(34264),y=r(45359),b=r.n(y),k=function(){var e=(0,o.Z)((0,n.Z)().mark((function e(t,r){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",b()(t,r));case 1:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),S=r(71520),C="getWithRetryForTokenRefreshRepeat",w=function(e){return new URL(e).origin};function x(e){var t,r=new Map,n=(0,a.Z)(e.entries());try{for(n.s();!(t=n.n()).done;){var o=(0,i.Z)(t.value,2),s=o[0],c=o[1];r.set(s,c)}}catch(u){n.e(u)}finally{n.f()}return r}function P(e){return E.apply(this,arguments)}function E(){return E=(0,o.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t({refresh:!1}).catch(function(){var e=(0,o.Z)((0,n.Z)().mark((function e(r){var o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o={refresh:!0,previousError:r},e.t0=r.errorType,e.next=e.t0===s.C.authorizationError?4:e.t0===s.C.incorrectServerResponse||e.t0===p.x.fetchTokenError?5:6;break;case 4:return e.abrupt("return",t(Object.assign(Object.assign({},o),{claims:r.claims,tenantId:r.tenantId})));case 5:return e.abrupt("return",t(o));case 6:if(!0!==r[C]){e.next=8;break}return e.abrupt("return",t(o));case 8:throw r;case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)}))),E.apply(this,arguments)}function Z(e,t){return T.apply(this,arguments)}function T(){return T=(0,o.Z)((0,n.Z)().mark((function e(t,r){var i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=u.S.now(),e.abrupt("return",k(t,r).then(function(){var e=(0,o.Z)((0,n.Z)().mark((function e(t){var r,o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t){e.next=3;break}throw new c.V2("No response from ODSP fetch call",s.C.incorrectServerResponse,{driverVersion:S.Z});case 3:if(!(!r.ok||r.status<200||r.status>=300)){e.next=12;break}return e.t0=h.y3,e.t1="ODSP fetch error [".concat(r.status,"]"),e.t2=r.status,e.t3=r,e.next=10,r.text();case 10:e.t4=e.sent,(0,e.t0)(e.t1,e.t2,e.t3,e.t4);case 12:return o=x(r.headers),e.abrupt("return",{content:r,headers:o,propsToLog:(0,h.j)(o),duration:u.S.now()-i});case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){var t=(0,c.Gg)(),r={value:"".concat(e),tag:d.XI.UserData},n=r.value.replace(/((http|https):\/\/(\S*))/i,"REDACTED_URL");if("AbortError"===e.name)throw new c.s1("Fetch Timeout (AbortError)",p.x.fetchTimeout,{driverVersion:S.Z});if(n.includes("ETIMEDOUT"))throw new c.s1("Fetch Timeout (ETIMEDOUT)",p.x.fetchTimeout,{driverVersion:S.Z});throw t===c.Yz.Offline?new c.s1("ODSP fetch failure (Offline): ".concat(n),s.C.offlineError,{driverVersion:S.Z,rawErrorMessage:r}):new c.s1("ODSP fetch failure: ".concat(n),s.C.fetchFailure,{driverVersion:S.Z,rawErrorMessage:r})})));case 2:case"end":return e.stop()}}),e)}))),T.apply(this,arguments)}function N(e,t){return F.apply(this,arguments)}function F(){return(F=(0,o.Z)((0,n.Z)().mark((function e(t,r){var o,i,a,s,c,u;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z(t,r);case 2:return o=e.sent,i=o.content,a=o.headers,s=o.propsToLog,c=o.duration,e.next=9,i.arrayBuffer();case 9:return u=e.sent,s.bodySize=u.byteLength,e.abrupt("return",{headers:a,content:u,propsToLog:s,duration:c});case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(e,t){return B.apply(this,arguments)}function B(){return(B=(0,o.Z)((0,n.Z)().mark((function e(t,r){var o,i,a,s,c,u,l;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z(t,r);case 2:return o=e.sent,i=o.content,a=o.headers,s=o.propsToLog,c=o.duration,e.prev=7,e.next=10,i.text();case 10:u=e.sent,e.next=16;break;case 13:e.prev=13,e.t0=e.catch(7),(0,h.y3)("Error while parsing fetch response",h.oS,i,u);case 16:return s.bodySize=u.length,l={headers:a,content:JSON.parse(u),propsToLog:s,duration:c},e.abrupt("return",l);case 19:case"end":return e.stop()}}),e,null,[[7,13]])})))).apply(this,arguments)}function D(e){return void 0===e.type||"New"===e.type}function A(e){return(0,l.h)(!0===e.odspResolvedUrl,478),e}var O=function(e){return d.G2.create(e,"OdspDriver",{all:{driverVersion:S.Z}})};function L(e,t,r,i){return function(){var a=(0,o.Z)((0,n.Z)().mark((function a(s,u){var l,h=arguments;return(0,n.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return l=h.length>2&&void 0!==h[2]&&h[2],a.abrupt("return",d.Xr.timedExecAsync(e,{eventName:"".concat(u,"_GetToken"),attempts:s.refresh?2:1,hasClaims:!!s.claims,hasTenantId:!!s.tenantId},function(){var e=(0,o.Z)((0,n.Z)().mark((function e(o){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r(Object.assign(Object.assign({},s),t)).then((function(e){var t=v(e);if((l||o.duration>=32)&&o.end({fromCache:g(e),isNull:null===t}),null===t&&i)throw new c.V2("The Host-provided token fetcher returned null",p.x.fetchTokenError,{method:u,driverVersion:S.Z});return t}),(function(e){var t=null===e||void 0===e?void 0:e.canRetry;throw(0,f.Jn)(e,(function(e){return new c.nq("The Host-provided token fetcher threw an error",p.x.fetchTokenError,"boolean"===typeof t&&t,{method:u,errorMessage:e,driverVersion:S.Z})}))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{cancel:"generic"}));case 2:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}()}function _(e){var t;return{type:m.L,key:null!==(t=e.fileVersion)&&void 0!==t?t:"",file:{resolvedUrl:e,docId:e.hashedDocumentId}}}var M=79872;function R(e){if(e){var t=e.scope;if(!t)return"createLinkType=".concat(e);var r="createLinkScope=".concat(t),n=e.role;return r=n?"".concat(r,"&createLinkRole=").concat(n):r}}function H(e){var t=u.S.now();return[e(),u.S.now()-t]}function j(e){return U.apply(this,arguments)}function U(){return(U=(0,o.Z)((0,n.Z)().mark((function e(t){var r,o,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.S.now(),e.next=3,t();case 3:return o=e.sent,i=u.S.now()-r,e.abrupt("return",[o,i]);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e,t,r,n){if(0!==t.length){var o=t[0].sequenceNumber,i=t.length,a=t[i-1].sequenceNumber;o!==r&&(n.sendErrorEvent({eventName:"OpsFetchViolation",reason:e,from:r,start:o,last:a,length:i}),t.length=0),a+1!==r+i&&(n.sendErrorEvent({eventName:"OpsFetchViolation",reason:e,from:r,start:o,last:a,length:i}),t.length=0)}}},71520:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});var n="2.0.0-internal.4.4.3"},42874:function(e,t,r){"use strict";r.d(t,{k:function(){return l}});var n=r(74165),o=r(15861),i=r(9070),a=r(5927),s=r(1244),c=r(20427),u=r(48102);function l(e,t,r,n){return d.apply(this,arguments)}function d(){return(d=(0,o.Z)((0,n.Z)().mark((function e(t,r,o,l){var d,f,h,p,v,g,m,y,b;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f=1e3,h=i.S.now(),v=1;case 3:return void 0!==l&&l(),e.prev=4,e.next=7,t();case 7:return g=e.sent,v>1&&o.sendTelemetryEvent({eventName:"MultipleRetries",callName:r,attempts:v,duration:i.S.now()-h},p),e.abrupt("return",g);case 12:if(e.prev=12,e.t0=e.catch(4),m=(0,s.ms)(e.t0),y=!0===(null===e.t0||void 0===e.t0?void 0:e.t0[u.Km]),b=(null===e.t0||void 0===e.t0?void 0:e.t0.errorType)===c.x.serviceReadOnly,1===v&&o.sendTelemetryEvent({eventName:"".concat(r,"_firstFailed"),callName:r,attempts:v,duration:i.S.now()-h},e.t0),(y||b)&&m){e.next=20;break}throw e.t0;case 20:if(5!==v){e.next=24;break}throw o.sendErrorEvent({eventName:y?"CoherencyErrorTooManyRetries":"ServiceReadonlyErrorTooManyRetries",callName:r,attempts:v,duration:i.S.now()-h},e.t0),e.t0.canRetry=!1,e.t0;case 24:return f=null!==(d=(0,s.ZZ)(e.t0))&&void 0!==d?d:f,e.next=27,(0,a.g)(Math.floor(f));case 27:f+=f/4*(1+Math.random()),p=e.t0;case 29:v++,e.next=3;break;case 32:case"end":return e.stop()}}),e,null,[[4,12]])})))).apply(this,arguments)}},76269:function(e,t,r){"use strict";var n;r.d(t,{C:function(){return n}}),function(e){e.genericError="genericError",e.genericNetworkError="genericNetworkError",e.authorizationError="authorizationError",e.fileNotFoundOrAccessDeniedError="fileNotFoundOrAccessDeniedError",e.throttlingError="throttlingError",e.offlineError="offlineError",e.unsupportedClientProtocolVersion="unsupportedClientProtocolVersion",e.writeError="writeError",e.fetchFailure="fetchFailure",e.fetchTokenError="fetchTokenError",e.incorrectServerResponse="incorrectServerResponse",e.fileOverwrittenInStorage="fileOverwrittenInStorage",e.deltaStreamConnectionForbidden="deltaStreamConnectionForbidden",e.locationRedirection="locationRedirection",e.fluidInvalidSchema="fluidInvalidSchema",e.usageError="usageError",e.fileIsLocked="fileIsLocked"}(n||(n={}))},65452:function(e,t,r){"use strict";var n;r.d(t,{i:function(){return n}}),function(e){e.summarizingClient="fluid-client-summarizer",e.createNew="createNew"}(n||(n={}))},34977:function(e,t,r){"use strict";var n,o,i;r.d(t,{Cs:function(){return n}}),function(e){e.NoOp="noop",e.ClientJoin="join",e.ClientLeave="leave",e.Propose="propose",e.Reject="reject",e.Accept="accept",e.Summarize="summarize",e.SummaryAck="summaryAck",e.SummaryNack="summaryNack",e.Operation="op",e.RemoteHelp="remoteHelp",e.NoClient="noClient",e.RoundTrip="tripComplete",e.Control="control"}(n||(n={})),function(e){e.ClientJoin="join",e.ClientLeave="leave"}(o||(o={})),function(e){e.ThrottlingError="ThrottlingError",e.InvalidScopeError="InvalidScopeError",e.BadRequestError="BadRequestError",e.LimitExceededError="LimitExceededError"}(i||(i={}))},45108:function(e,t,r){"use strict";var n;r.d(t,{p:function(){return n}}),function(e){e.DocRead="doc:read",e.DocWrite="doc:write",e.SummaryWrite="summary:write"}(n||(n={}))},24713:function(e,t,r){"use strict";var n;r.d(t,{J:function(){return n}}),function(e){e.Tree=1,e.Blob=2,e.Handle=3,e.Attachment=4}(n||(n={}))},96418:function(e,t,r){"use strict";r.d(t,{i:function(){return n}});var n="IFluidDependencySynthesizer"},81803:function(e,t,r){"use strict";r.d(t,{Q:function(){return d}});var n=r(4942),o=r(74165),i=r(15861),a=r(37762),s=r(15671),c=r(43144),u=r(69163),l=r(96418),d=function(){function e(){(0,s.Z)(this,e),this.providers=new Map;for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];this.parents=r.filter((function(e){return void 0!==e}))}return(0,c.Z)(e,[{key:"IFluidDependencySynthesizer",get:function(){return this}},{key:"register",value:function(e,t){if(this.providers.has(e))throw new Error("Attempting to register a provider of type ".concat(String(e)," that already exists"));this.providers.set(e,t)}},{key:"unregister",value:function(e){this.providers.has(e)&&this.providers.delete(e)}},{key:"synthesize",value:function(e,t){var r=this,n={};return this.generateRequired(n,t),this.generateOptional(n,e),Object.defineProperty(n,l.i,{get:function(){return r}}),n}},{key:"has",value:function(e,t){return!!this.providers.has(e)||!0!==t&&this.parents.some((function(t){return t.has(e)}))}},{key:"getProvider",value:function(t){if(this.has(t)){if(this.providers.has(t))return this.providers.get(t);var r,n=(0,a.Z)(this.parents);try{for(n.s();!(r=n.n()).done;){var o=r.value;if(o instanceof e)return o.getProvider(t);var i=o;if(void 0!==(null===i||void 0===i?void 0:i.getProvider))return i.getProvider(t)}}catch(s){n.e(s)}finally{n.f()}}}},{key:"generateRequired",value:function(e,t){if(void 0!==t)for(var r=0,n=Object.keys(t);r<n.length;r++){var o=n[r],i=this.resolveProvider(o);if(void 0===i)throw new Error("Object attempted to be created without registered required provider ".concat(String(o)));Object.defineProperty(e,o,i)}}},{key:"generateOptional",value:function(e,t){var r;if(void 0!==t)for(var n=0,a=Object.keys(t);n<a.length;n++){var s=a[n],c=null!==(r=this.resolveProvider(s))&&void 0!==r?r:{get:function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",void 0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()};Object.defineProperty(e,s,c)}}},{key:"resolveProvider",value:function(e){var t=this.providers.get(e);if(void 0!==t)return"function"===typeof t?{get:function(){if(t&&"function"===typeof t)return Promise.resolve(this[l.i]).then(function(){var e=(0,i.Z)((0,o.Z)().mark((function e(r){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t(r));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(t){return null===t||void 0===t?void 0:t[e]}))}}:{get:function(){if(t)return new u.d((0,i.Z)((0,o.Z)().mark((function r(){return(0,o.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",Promise.resolve(t).then((function(t){if(t)return t[e]})));case 1:case"end":return r.stop()}}),r)}))))}};var r,s=(0,a.Z)(this.parents);try{for(s.s();!(r=s.n()).done;){var c=r.value,d=(0,n.Z)({},e,e),f=c.synthesize(d,{}),h=Object.getOwnPropertyDescriptor(f,e);if(void 0!==h)return h}}catch(p){s.e(p)}finally{s.f()}}}]),e}()},15318:function(e,t,r){"use strict";r.d(t,{MD:function(){return m},UK:function(){return k},of:function(){return d},rZ:function(){return b},yV:function(){return y}});var n=r(5647),o=r(93433),i=r(15671),a=r(43144),s=r(37762),c=r(4942),u=r(1920),l=r(82486),d=new u.o((function(){return h(g())})),f={getRawConfig:function(){}},h=function(e){return void 0!==e&&null!==e?new m(void 0,{getRawConfig:function(t){var r,n;try{return null===(n=v(null!==(r=e.getItem(t))&&void 0!==r?r:void 0))||void 0===n?void 0:n.raw}catch(o){}}}):f};function p(e){switch(e){case"boolean":case"number":case"string":return!0;default:return!1}}function v(e){var t,r=e;if("string"===typeof e)try{r=JSON.parse(e),t={raw:e,string:e}}catch(u){}if(void 0===r)return t;var n=typeof r;if(p(n))return Object.assign(Object.assign({},t),(0,c.Z)({raw:e},n,r));if(Array.isArray(r)){var o=typeof r[0];if(!p(o))return t;var i,a=(0,s.Z)(r);try{for(a.s();!(i=a.n()).done;){if(typeof i.value!==o)return t}}catch(l){a.e(l)}finally{a.f()}return Object.assign(Object.assign({},t),(0,c.Z)({raw:e},"".concat(o,"[]"),r))}return t}var g=function(){var e;try{return null!==(e=globalThis.sessionStorage)&&void 0!==e?e:void 0}catch(t){return}},m=function(){function e(t){(0,i.Z)(this,e),this.logger=t,this.configCache=new Map,this.orderedBaseProviders=[];for(var r=new Set,n=arguments.length,a=new Array(n>1?n-1:0),s=1;s<n;s++)a[s-1]=arguments[s];for(var c=[].concat(a);c.length>0;){var u=c.shift();void 0!==u&&S(u)&&!r.has(u)&&(r.add(u),u instanceof e?c.push.apply(c,(0,o.Z)(u.orderedBaseProviders)):this.orderedBaseProviders.push(u))}}return(0,a.Z)(e,[{key:"getBoolean",value:function(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.boolean}},{key:"getNumber",value:function(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.number}},{key:"getString",value:function(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.string}},{key:"getBooleanArray",value:function(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t["boolean[]"]}},{key:"getNumberArray",value:function(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t["number[]"]}},{key:"getStringArray",value:function(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t["string[]"]}},{key:"getRawConfig",value:function(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.raw}},{key:"getCacheEntry",value:function(e){var t;if(!this.configCache.has(e)){var r,n=(0,s.Z)(this.orderedBaseProviders);try{for(n.s();!(r=n.n()).done;){var o=r.value,i=v(null===o||void 0===o?void 0:o.getRawConfig(e));if(void 0!==i)return this.configCache.set(e,i),null===(t=this.logger)||void 0===t||t.send({category:"generic",eventName:"ConfigRead",configName:{tag:l.XI.CodeArtifact,value:e},configValue:{tag:l.XI.CodeArtifact,value:JSON.stringify(i)}}),i}}catch(a){n.e(a)}finally{n.f()}this.configCache.set(e,{raw:void 0})}return this.configCache.get(e)}}]),e}();function y(e){var t=e;return S(null===t||void 0===t?void 0:t.config)&&void 0!==(null===t||void 0===t?void 0:t.logger)}function b(e){return y(e)?e:k(e,d.value)}function k(e){if(y(e))throw new Error("Logger is already a monitoring context");for(var t=e,r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return t.config=(0,n.Z)(m,[e].concat(o)),t.logger=e,t}function S(e){return"function"===typeof(null===e||void 0===e?void 0:e.getRawConfig)}},65059:function(e,t,r){"use strict";r.d(t,{Jn:function(){return m},SC:function(){return v},Vu:function(){return E},XY:function(){return k},YC:function(){return f},bO:function(){return y},fd:function(){return x},gr:function(){return g},j4:function(){return P},nE:function(){return p},zt:function(){return S}});var n=r(97326),o=r(15671),i=r(43144),a=r(60136),s=r(29388),c=r(28664),u=r(92810),l=r(1467),d=function(e){return null!==e&&!Array.isArray(e)&&"object"===typeof e};function f(e,t){var r={message:"string"===typeof(null===e||void 0===e?void 0:e.message)?e.message:String(e)};if(d(e)){var n=e.errorType,o=e.stack,i=e.name;if("string"===typeof n&&(r.errorType=n),"string"===typeof o){var a="string"===typeof i?i:void 0;r.stack=function(e,r){if(!t)return e;var n=e.split("\n");return n.shift(),void 0!==r&&n.unshift(r),n.join("\n")}(o,a)}}return r}var h,p=function(e){return"function"===typeof(null===e||void 0===e?void 0:e.getTelemetryProperties)};function v(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((0,l.n5)(e)&&function(e){var t=e;void 0===t.errorInstanceId&&(t.errorInstanceId=(0,u.Z)())}(e),(0,l.IR)(e))return e.addTelemetryProperties(null!==(t=r.props)&&void 0!==t?t:{}),e;var n=f(e,!1),o=n.message,i=n.stack,a=new Z({message:o,stack:i});if("object"===typeof e&&null!==e){var s=e.canRetry,c=e.retryAfterSeconds;Object.assign(v,{canRetry:s,retryAfterSeconds:c})}"object"!==typeof e&&a.addTelemetryProperties({typeofError:typeof e});var d=P.typeCheck(e)?e.getTelemetryProperties():{untrustedOrigin:1};return a.addTelemetryProperties(Object.assign(Object.assign({},d),r.props)),a}function g(){return function(){var e=new Error("<<generated stack>>");if(void 0===h&&(h=void 0!==e.stack),h)return e;try{throw e}catch(t){return t}}().stack}function m(e,t){var r=f(e,!1),n=r.message,o=r.stack,i=t(n);return void 0!==o&&b(i,o),k(e)&&i.addTelemetryProperties({untrustedOrigin:1}),(0,l.uD)(e)&&(i.overwriteErrorInstanceId(e.errorInstanceId),i.addTelemetryProperties({innerErrorInstanceId:e.errorInstanceId})),p(e)&&i.addTelemetryProperties(e.getTelemetryProperties()),i}function y(e,t,r){var n=m(e,t),o=n.errorInstanceId,i=o;return r.sendTelemetryEvent({eventName:"WrapError",errorInstanceId:o,wrappedByErrorInstanceId:i},e),n}function b(e,t){try{Object.assign(e,{stack:t})}catch(r){e.addTelemetryProperties({stack2:t})}}function k(e){return P.typeCheck(e)?e.errorType===E&&1===e.getTelemetryProperties().untrustedOrigin:!(0,l.n5)(e)}function S(e){var t;return"string"===typeof(null===(t=e)||void 0===t?void 0:t.tag)}function C(e,t){return Array.isArray(e)&&e.every((function(e){return w(e)}))?JSON.stringify(e):w(e)?e:(console.error("UnSupported Format of Logging Error Property for key ".concat(t,":"),e),"REDACTED (arbitrary object)")}function w(e){switch(typeof e){case"string":case"number":case"boolean":case"undefined":return!0;default:return!1}}var x=function(){var e=new WeakSet;return function(t,r){if("object"===typeof r&&null!==r){if(e.has(r))return"<removed/circular>";e.add(r)}return r}},P=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(e,n){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;return(0,o.Z)(this,r),(i=t.call(this,e)).omitPropsFromLogging=a,i._errorInstanceId=(0,u.Z)(),i.fluidErrorCode="-",a.add("omitPropsFromLogging"),a.add("_errorInstanceId"),n&&i.addTelemetryProperties(n),i}return(0,i.Z)(r,[{key:"errorInstanceId",get:function(){return this._errorInstanceId}},{key:"overwriteErrorInstanceId",value:function(e){this._errorInstanceId=e}},{key:"addTelemetryProperties",value:function(e){!function(e,t){for(var r=0,n=Object.keys(t);r<n.length;r++){var o=n[r];void 0===e[o]&&(e[o]=t[o])}}(this,e)}},{key:"getTelemetryProperties",value:function(){var e=function(e,t){for(var r={},n=0,o=Object.keys(e);n<o.length;n++){var i=o[n];if(!t.has(i)){var a=e[i];S(a)?r[i]={value:C(a.value,i),tag:a.tag}:r[i]=C(a,i)}}return r}(this,this.omitPropsFromLogging);return Object.assign(Object.assign({},e),{stack:this.stack,message:this.message,errorInstanceId:this._errorInstanceId})}}],[{key:"typeCheck",value:function(e){return"object"===typeof e&&null!==e&&("function"===typeof e.addTelemetryProperties&&"function"===typeof e.getTelemetryProperties&&"string"===typeof e.errorInstanceId)}}]),r}((0,c.Z)(Error)),E="genericError",Z=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(e){var i;return(0,o.Z)(this,r),(i=t.call(this,e.message)).errorType=E,void 0!==e.stack&&b((0,n.Z)(i),e.stack),i}return(0,i.Z)(r)}(P)},59125:function(e,t,r){"use strict";r.d(t,{M:function(){return u}});var n=r(15671),o=r(43144),i=r(11752),a=r(61120),s=r(60136),c=r(29388),u=function(e){(0,s.Z)(r,e);var t=(0,c.Z)(r);function r(e){var o;return(0,n.Z)(this,r),(o=t.call(this)).errorHandler=e,o}return(0,o.Z)(r,[{key:"emit",value:function(e){try{for(var t,n=arguments.length,o=new Array(n>1?n-1:0),s=1;s<n;s++)o[s-1]=arguments[s];return(t=(0,i.Z)((0,a.Z)(r.prototype),"emit",this)).call.apply(t,[this,e].concat(o))}catch(c){return this.errorHandler(e,c),!0}}}]),r}(r(46115).L)},1467:function(e,t,r){"use strict";r.d(t,{IR:function(){return i},n5:function(){return a},uD:function(){return o}});var n=function(e){return"function"===typeof(null===e||void 0===e?void 0:e.getTelemetryProperties)&&"function"===typeof(null===e||void 0===e?void 0:e.addTelemetryProperties)},o=function(e){return"string"===typeof(null===e||void 0===e?void 0:e.errorInstanceId)};function i(e){return"string"===typeof(null===e||void 0===e?void 0:e.errorType)&&"string"===typeof(null===e||void 0===e?void 0:e.message)&&o(e)&&n(e)}function a(e){return"string"===typeof(null===e||void 0===e?void 0:e.errorType)&&"string"===typeof(null===e||void 0===e?void 0:e.message)&&n(e)}},82486:function(e,t,r){"use strict";r.d(t,{G2:function(){return g},XI:function(){return n},Xr:function(){return y},hy:function(){return v},yw:function(){return m}});var n,o=r(74165),i=r(15861),a=r(97326),s=r(60136),c=r(29388),u=r(15671),l=r(43144),d=r(9070),f=r(15318),h=r(65059),p=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};!function(e){e.CodeArtifact="CodeArtifact",e.UserData="UserData"}(n||(n={}));var v=function(){function e(t,r){(0,u.Z)(this,e),this.namespace=t,this.properties=r}return(0,l.Z)(e,[{key:"sendTelemetryEvent",value:function(e,t){var r;this.sendTelemetryEventCore(Object.assign(Object.assign({},e),{category:null!==(r=e.category)&&void 0!==r?r:"generic"}),t)}},{key:"sendTelemetryEventCore",value:function(t,r){var n=function(e){for(var t=e.category,r=e.eventName,n=p(e,["category","eventName"]),o={category:t,eventName:r},i=0,a=Object.keys(n);i<a.length;i++){var s=a[i];o[s]=k(n[s])}return o}(t);void 0!==r&&e.prepareErrorObject(n,r,!1),"number"===typeof n.duration&&(n.duration=e.formatTick(n.duration)),this.send(n)}},{key:"sendErrorEvent",value:function(e,t){this.sendTelemetryEventCore(Object.assign(Object.assign({error:e.eventName},e),{category:"error"}),t)}},{key:"sendPerformanceEvent",value:function(e,t){var r,n=Object.assign(Object.assign({},e),{category:null!==(r=e.category)&&void 0!==r?r:"performance"});this.sendTelemetryEventCore(n,t)}},{key:"prepareEvent",value:function(t){var r="error"===t.category||void 0!==t.error,n=Object.assign({},t);if(void 0!==this.namespace&&(n.eventName="".concat(this.namespace).concat(e.eventNamespaceSeparator).concat(n.eventName)),this.properties){var o=[];o.push(this.properties.all),r&&o.push(this.properties.error);for(var i=0,a=o;i<a.length;i++){var s=a[i];if(void 0!==s)for(var c=0,u=Object.keys(s);c<u.length;c++){var l=u[c];if(void 0===t[l]){var d=s[l],f="function"===typeof d?d():d;void 0!==f&&(n[l]=f)}}}}return n}}],[{key:"formatTick",value:function(e){return Math.floor(e)}},{key:"numberFromString",value:function(e){if(void 0!==e&&null!==e){var t=Number(e);return Number.isNaN(t)?e:t}}},{key:"sanitizePkgName",value:function(e){return e.replace("@","").replace("/","-")}},{key:"prepareErrorObject",value:function(e,t,r){var n=(0,h.YC)(t,!0),o=n.message,i=n.errorType,a=n.stack;if(e.stack=a,e.error=o,e.errorType=i,(0,h.nE)(t))for(var s=t.getTelemetryProperties(),c=0,u=Object.keys(s);c<u.length;c++){var l=u[c];void 0===e[l]&&(e[l]=s[l])}void 0===e.stack&&r&&(e.stack=(0,h.gr)())}}]),e}();v.eventNamespaceSeparator=":";var g=function(e){(0,s.Z)(r,e);var t=(0,c.Z)(r);function r(e,n,o){var i;return(0,u.Z)(this,r),(i=t.call(this,n,o)).baseLogger=e,(0,f.yV)(e)&&(0,f.UK)((0,a.Z)(i),new f.MD((0,a.Z)(i),e.config)),i}return(0,l.Z)(r,[{key:"send",value:function(e){this.baseLogger.send(this.prepareEvent(e))}}],[{key:"create",value:function(e,t,n){if(e instanceof r){for(var o={},i=0,a=[e.properties,n];i<a.length;i++){var s=a[i];void 0!==s&&(void 0!==s.all&&(o.all=Object.assign(Object.assign({},o.all),s.all)),void 0!==s.error&&(o.error=Object.assign(Object.assign({},o.error),s.error)))}var c=void 0===e.namespace?t:void 0===t?e.namespace:"".concat(e.namespace).concat(v.eventNamespaceSeparator).concat(t);return new r(e.baseLogger,c,o)}return new r(e||new b,t,n)}}]),r}(v),m=function(e){(0,s.Z)(r,e);var t=(0,c.Z)(r);function r(e,n){var o;return(0,u.Z)(this,r),(o=t.call(this,e,n)).loggers=[],o}return(0,l.Z)(r,[{key:"addLogger",value:function(e){void 0!==e&&null!==e&&this.loggers.push(e)}},{key:"send",value:function(e){var t=this.prepareEvent(e);this.loggers.forEach((function(e){e.send(t)}))}}]),r}(v),y=function(){function e(t,r){var n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{end:!0,cancel:"generic"};(0,u.Z)(this,e),this.logger=t,this.markers=o,this.startTime=d.S.now(),this.event=Object.assign({},r),this.markers.start&&this.reportEvent("start"),"object"===typeof window&&null!=window&&(null===(n=window.performance)||void 0===n?void 0:n.mark)&&(this.startMark="".concat(r.eventName,"-start"),window.performance.mark(this.startMark))}return(0,l.Z)(e,[{key:"duration",get:function(){return d.S.now()-this.startTime}},{key:"reportProgress",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"update";this.reportEvent(t,e)}},{key:"autoEnd",value:function(){this.event&&this.markers.end&&this.reportEvent("end"),this.performanceEndMark(),this.event=void 0}},{key:"end",value:function(e){this.reportEvent("end",e),this.performanceEndMark(),this.event=void 0}},{key:"performanceEndMark",value:function(){if(this.startMark&&this.event){var e="".concat(this.event.eventName,"-end");window.performance.mark(e),window.performance.measure("".concat(this.event.eventName),this.startMark,e),this.startMark=void 0}}},{key:"cancel",value:function(e,t){void 0!==this.markers.cancel&&this.reportEvent("cancel",Object.assign({category:this.markers.cancel},e),t),this.event=void 0}},{key:"reportEvent",value:function(e,t,r){if(this.event){var n=Object.assign(Object.assign({},this.event),t);n.eventName="".concat(n.eventName,"_").concat(e),"start"!==e&&(n.duration=this.duration),this.logger.sendPerformanceEvent(n,r)}}}],[{key:"start",value:function(t,r,n){return new e(t,r,n)}},{key:"timedExec",value:function(t,r,n,o){var i=e.start(t,r,o);try{var a=n(i);return i.autoEnd(),a}catch(s){throw i.cancel(void 0,s),s}}},{key:"timedExecAsync",value:function(){var t=(0,i.Z)((0,o.Z)().mark((function t(r,n,i,a){var s,c;return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=e.start(r,n,a),t.prev=1,t.next=4,i(s);case 4:return c=t.sent,s.autoEnd(),t.abrupt("return",c);case 9:throw t.prev=9,t.t0=t.catch(1),s.cancel(void 0,t.t0),t.t0;case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e,r,n,o){return t.apply(this,arguments)}}()}]),e}(),b=function(){function e(){(0,u.Z)(this,e)}return(0,l.Z)(e,[{key:"send",value:function(e){}}]),e}();function k(e){return(0,h.zt)(e)?{value:S(e.value),tag:e.tag}:S(e)}function S(e){switch(typeof e){case"string":case"number":case"boolean":case"undefined":return e;case"object":return JSON.stringify(e);default:return console.error("convertToBasePropertyTypeUntagged: INVALID PROPERTY (typed as ".concat(typeof e,")")),"INVALID PROPERTY (typed as ".concat(typeof e,")")}}},63659:function(e,t,r){"use strict";r.d(t,{XX:function(){return o},Yb:function(){return n}});var n={colorNeutralForeground1:"--colorNeutralForeground1",colorNeutralForeground1Hover:"--colorNeutralForeground1Hover",colorNeutralForeground1Pressed:"--colorNeutralForeground1Pressed",colorNeutralForeground1Selected:"--colorNeutralForeground1Selected",colorNeutralForeground2:"--colorNeutralForeground2",colorNeutralForeground2Hover:"--colorNeutralForeground2Hover",colorNeutralForeground2Pressed:"--colorNeutralForeground2Pressed",colorNeutralForeground2Selected:"--colorNeutralForeground2Selected",colorNeutralForeground2BrandHover:"--colorNeutralForeground2BrandHover",colorNeutralForeground2BrandPressed:"--colorNeutralForeground2BrandPressed",colorNeutralForeground2BrandSelected:"--colorNeutralForeground2BrandSelected",colorNeutralForeground3:"--colorNeutralForeground3",colorNeutralForeground3Hover:"--colorNeutralForeground3Hover",colorNeutralForeground3Pressed:"--colorNeutralForeground3Pressed",colorNeutralForeground3Selected:"--colorNeutralForeground3Selected",colorNeutralForeground3BrandHover:"--colorNeutralForeground3BrandHover",colorNeutralForeground3BrandPressed:"--colorNeutralForeground3BrandPressed",colorNeutralForeground3BrandSelected:"--colorNeutralForeground3BrandSelected",colorNeutralForeground4:"--colorNeutralForeground4",colorNeutralForegroundDisabled:"--colorNeutralForegroundDisabled",colorBrandForegroundLink:"--colorBrandForegroundLink",colorBrandForegroundLinkHover:"--colorBrandForegroundLinkHover",colorBrandForegroundLinkPressed:"--colorBrandForegroundLinkPressed",colorBrandForegroundLinkSelected:"--colorBrandForegroundLinkSelected",colorNeutralForeground2Link:"--colorNeutralForeground2Link",colorNeutralForeground2LinkHover:"--colorNeutralForeground2LinkHover",colorNeutralForeground2LinkPressed:"--colorNeutralForeground2LinkPressed",colorNeutralForeground2LinkSelected:"--colorNeutralForeground2LinkSelected",colorCompoundBrandForeground1:"--colorCompoundBrandForeground1",colorCompoundBrandForeground1Hover:"--colorCompoundBrandForeground1Hover",colorCompoundBrandForeground1Pressed:"--colorCompoundBrandForeground1Pressed",colorNeutralForegroundOnBrand:"--colorNeutralForegroundOnBrand",colorNeutralForegroundInverted:"--colorNeutralForegroundInverted",colorNeutralForegroundInvertedHover:"--colorNeutralForegroundInvertedHover",colorNeutralForegroundInvertedPressed:"--colorNeutralForegroundInvertedPressed",colorNeutralForegroundInvertedSelected:"--colorNeutralForegroundInvertedSelected",colorNeutralForegroundInverted2:"--colorNeutralForegroundInverted2",colorNeutralForegroundStaticInverted:"--colorNeutralForegroundStaticInverted",colorNeutralForegroundInvertedLink:"--colorNeutralForegroundInvertedLink",colorNeutralForegroundInvertedLinkHover:"--colorNeutralForegroundInvertedLinkHover",colorNeutralForegroundInvertedLinkPressed:"--colorNeutralForegroundInvertedLinkPressed",colorNeutralForegroundInvertedLinkSelected:"--colorNeutralForegroundInvertedLinkSelected",colorNeutralForegroundInvertedDisabled:"--colorNeutralForegroundInvertedDisabled",colorBrandForeground1:"--colorBrandForeground1",colorBrandForeground2:"--colorBrandForeground2",colorNeutralForeground1Static:"--colorNeutralForeground1Static",colorBrandForegroundInverted:"--colorBrandForegroundInverted",colorBrandForegroundInvertedHover:"--colorBrandForegroundInvertedHover",colorBrandForegroundInvertedPressed:"--colorBrandForegroundInvertedPressed",colorBrandForegroundOnLight:"--colorBrandForegroundOnLight",colorBrandForegroundOnLightHover:"--colorBrandForegroundOnLightHover",colorBrandForegroundOnLightPressed:"--colorBrandForegroundOnLightPressed",colorBrandForegroundOnLightSelected:"--colorBrandForegroundOnLightSelected",colorNeutralBackground1:"--colorNeutralBackground1",colorNeutralBackground1Hover:"--colorNeutralBackground1Hover",colorNeutralBackground1Pressed:"--colorNeutralBackground1Pressed",colorNeutralBackground1Selected:"--colorNeutralBackground1Selected",colorNeutralBackground2:"--colorNeutralBackground2",colorNeutralBackground2Hover:"--colorNeutralBackground2Hover",colorNeutralBackground2Pressed:"--colorNeutralBackground2Pressed",colorNeutralBackground2Selected:"--colorNeutralBackground2Selected",colorNeutralBackground3:"--colorNeutralBackground3",colorNeutralBackground3Hover:"--colorNeutralBackground3Hover",colorNeutralBackground3Pressed:"--colorNeutralBackground3Pressed",colorNeutralBackground3Selected:"--colorNeutralBackground3Selected",colorNeutralBackground4:"--colorNeutralBackground4",colorNeutralBackground4Hover:"--colorNeutralBackground4Hover",colorNeutralBackground4Pressed:"--colorNeutralBackground4Pressed",colorNeutralBackground4Selected:"--colorNeutralBackground4Selected",colorNeutralBackground5:"--colorNeutralBackground5",colorNeutralBackground5Hover:"--colorNeutralBackground5Hover",colorNeutralBackground5Pressed:"--colorNeutralBackground5Pressed",colorNeutralBackground5Selected:"--colorNeutralBackground5Selected",colorNeutralBackground6:"--colorNeutralBackground6",colorNeutralBackgroundInverted:"--colorNeutralBackgroundInverted",colorNeutralBackgroundStatic:"--colorNeutralBackgroundStatic",colorSubtleBackground:"--colorSubtleBackground",colorSubtleBackgroundHover:"--colorSubtleBackgroundHover",colorSubtleBackgroundPressed:"--colorSubtleBackgroundPressed",colorSubtleBackgroundSelected:"--colorSubtleBackgroundSelected",colorSubtleBackgroundLightAlphaHover:"--colorSubtleBackgroundLightAlphaHover",colorSubtleBackgroundLightAlphaPressed:"--colorSubtleBackgroundLightAlphaPressed",colorSubtleBackgroundLightAlphaSelected:"--colorSubtleBackgroundLightAlphaSelected",colorSubtleBackgroundInverted:"--colorSubtleBackgroundInverted",colorSubtleBackgroundInvertedHover:"--colorSubtleBackgroundInvertedHover",colorSubtleBackgroundInvertedPressed:"--colorSubtleBackgroundInvertedPressed",colorSubtleBackgroundInvertedSelected:"--colorSubtleBackgroundInvertedSelected",colorTransparentBackground:"--colorTransparentBackground",colorTransparentBackgroundHover:"--colorTransparentBackgroundHover",colorTransparentBackgroundPressed:"--colorTransparentBackgroundPressed",colorTransparentBackgroundSelected:"--colorTransparentBackgroundSelected",colorNeutralBackgroundDisabled:"--colorNeutralBackgroundDisabled",colorNeutralBackgroundInvertedDisabled:"--colorNeutralBackgroundInvertedDisabled",colorNeutralStencil1:"--colorNeutralStencil1",colorNeutralStencil2:"--colorNeutralStencil2",colorNeutralStencil1Alpha:"--colorNeutralStencil1Alpha",colorNeutralStencil2Alpha:"--colorNeutralStencil2Alpha",colorBackgroundOverlay:"--colorBackgroundOverlay",colorScrollbarOverlay:"--colorScrollbarOverlay",colorBrandBackground:"--colorBrandBackground",colorBrandBackgroundHover:"--colorBrandBackgroundHover",colorBrandBackgroundPressed:"--colorBrandBackgroundPressed",colorBrandBackgroundSelected:"--colorBrandBackgroundSelected",colorCompoundBrandBackground:"--colorCompoundBrandBackground",colorCompoundBrandBackgroundHover:"--colorCompoundBrandBackgroundHover",colorCompoundBrandBackgroundPressed:"--colorCompoundBrandBackgroundPressed",colorBrandBackgroundStatic:"--colorBrandBackgroundStatic",colorBrandBackground2:"--colorBrandBackground2",colorBrandBackgroundInverted:"--colorBrandBackgroundInverted",colorBrandBackgroundInvertedHover:"--colorBrandBackgroundInvertedHover",colorBrandBackgroundInvertedPressed:"--colorBrandBackgroundInvertedPressed",colorBrandBackgroundInvertedSelected:"--colorBrandBackgroundInvertedSelected",colorNeutralStrokeAccessible:"--colorNeutralStrokeAccessible",colorNeutralStrokeAccessibleHover:"--colorNeutralStrokeAccessibleHover",colorNeutralStrokeAccessiblePressed:"--colorNeutralStrokeAccessiblePressed",colorNeutralStrokeAccessibleSelected:"--colorNeutralStrokeAccessibleSelected",colorNeutralStroke1:"--colorNeutralStroke1",colorNeutralStroke1Hover:"--colorNeutralStroke1Hover",colorNeutralStroke1Pressed:"--colorNeutralStroke1Pressed",colorNeutralStroke1Selected:"--colorNeutralStroke1Selected",colorNeutralStroke2:"--colorNeutralStroke2",colorNeutralStroke3:"--colorNeutralStroke3",colorNeutralStrokeOnBrand:"--colorNeutralStrokeOnBrand",colorNeutralStrokeOnBrand2:"--colorNeutralStrokeOnBrand2",colorNeutralStrokeOnBrand2Hover:"--colorNeutralStrokeOnBrand2Hover",colorNeutralStrokeOnBrand2Pressed:"--colorNeutralStrokeOnBrand2Pressed",colorNeutralStrokeOnBrand2Selected:"--colorNeutralStrokeOnBrand2Selected",colorBrandStroke1:"--colorBrandStroke1",colorBrandStroke2:"--colorBrandStroke2",colorCompoundBrandStroke:"--colorCompoundBrandStroke",colorCompoundBrandStrokeHover:"--colorCompoundBrandStrokeHover",colorCompoundBrandStrokePressed:"--colorCompoundBrandStrokePressed",colorNeutralStrokeDisabled:"--colorNeutralStrokeDisabled",colorNeutralStrokeInvertedDisabled:"--colorNeutralStrokeInvertedDisabled",colorTransparentStroke:"--colorTransparentStroke",colorTransparentStrokeInteractive:"--colorTransparentStrokeInteractive",colorTransparentStrokeDisabled:"--colorTransparentStrokeDisabled",colorStrokeFocus1:"--colorStrokeFocus1",colorStrokeFocus2:"--colorStrokeFocus2",colorNeutralShadowAmbient:"--colorNeutralShadowAmbient",colorNeutralShadowKey:"--colorNeutralShadowKey",colorNeutralShadowAmbientLighter:"--colorNeutralShadowAmbientLighter",colorNeutralShadowKeyLighter:"--colorNeutralShadowKeyLighter",colorNeutralShadowAmbientDarker:"--colorNeutralShadowAmbientDarker",colorNeutralShadowKeyDarker:"--colorNeutralShadowKeyDarker",colorBrandShadowAmbient:"--colorBrandShadowAmbient",colorBrandShadowKey:"--colorBrandShadowKey",colorPaletteDarkOrangeForeground1:"--colorPaletteDarkOrangeForeground1"},o={colorNeutralBackground7:"--colorNeutralBackground7",colorNeutralBackground7Selected:"--colorNeutralBackground7Selected"}},72858:function(e,t,r){"use strict";r.d(t,{cG:function(){return i}});var n=r(63659),o=r(47699),i=("var(".concat(o.Yf.PinkRed10,", #750b1c)"),"var(".concat(o.Yf.Red20,", #a4262c)"),"var(".concat(o.Yf.Red10,", #d13438)"),"var(".concat(o.Yf.RedOrange10,", #da3b01)"),"var(".concat(o.Yf.Orange30,",#8e562e)"),"var(".concat(o.Yf.Orange20,",#ca5010)"),"var(".concat(o.Yf.Orange10,",#ffaa44)"),"var(".concat(o.Yf.Yellow20,",#986f0B)"),"var(".concat(o.Yf.Yellow10,",#fce100)"),"var(".concat(o.Yf.OrangeYellow20,",#986f0b)"),"var(".concat(o.Yf.OrangeYellow10,",#c19c00)"),"var(".concat(o.Yf.YellowGreen10,",#8cbd18)"),"var(".concat(o.Yf.Green20,",#0b6a0b)"),"var(".concat(o.Yf.Green10,",#498205)"),"var(".concat(o.Yf.GreenCyan10,",#00ad56)"),"var(".concat(o.Yf.Cyan30,",#005b70)"),"var(".concat(o.Yf.Cyan20,",#038387)"),"var(".concat(o.Yf.Cyan10,",#00b7c3)"),"var(".concat(o.Yf.CyanBlue20,",#004e8c)"),"var(".concat(o.Yf.CyanBlue10,",#0078d4)"),"var(".concat(o.Yf.Blue10,",#4f6bed)"),"var(".concat(o.Yf.BlueMagenta30,",#5c2e91)"),"var(".concat(o.Yf.BlueMagenta20,",#8764b8)"),"var(".concat(o.Yf.BlueMagenta10,",#8378de)"),"var(".concat(o.Yf.Magenta20,",#881798)"),"var(".concat(o.Yf.Magenta10,",#c239b3)"),"var(".concat(o.Yf.MagentaPink20,",#9b0062)"),"var(".concat(o.Yf.MagentaPink10,",#e3008c)"),"var(".concat(o.Yf.Gray430,",#707070)"),"var(".concat(o.Yf.Gray180,",#252423)"),"var(".concat(o.Yf.Gray130,",#605E5C)"),"var(".concat(o.Yf.Gray100,",#979593)"),"var(".concat(o.Yf.Gray80,", #B2B2B2)"),"var(".concat(o.Yf.Gray70,", #BDBDBD)"),"var(".concat(o.Yf.Gray50,",#D2D0CE)"),"var(".concat(o.Yf.Gray40,",#393939)"),"var(".concat(o.Yf.Gray30,",#7a7574)"),"var(".concat(o.Yf.Gray20,",#69797e)"),"var(".concat(o.Yf.Gray10,",#a0aeb2)"),"var(".concat(o.Yf.Gray4,",#484644)"),"var(".concat(o.Yf.Gray6,",#797775)"),"var(".concat(o.Yf.Gray5,",#3B3A39)"),"var(".concat(o.Yf.Gray1,",#F3F2F1)"),"var(".concat(o.Yf.Away,", #ffaa44)"),"var(".concat(o.Yf.DoNotDisturb,", #c50f1f)"),"var(".concat(o.Yf.Online,", #6bb700)"),"var(".concat(o.Yf.Invisible,", #8a8886)"),"var(".concat(o.Yf.OutOfOffice,", #b4009e)"),"var(".concat(o.Yf.Warning,", #fff4ce)"),"var(".concat(o.Yf.WarningIcon,", #797673)"),"var(".concat(o.Yf.SevereWarning,", #fed9cc)"),"var(".concat(o.Yf.SevereWarningIcon,", #d83b01)"),"var(".concat(o.Yf.ErrorBlock,", #fde7e9)"),"var(".concat(o.Yf.ErrorBlockIcon,", #a80000)"),"var(".concat(o.Yf.ErrorBackground,", #FDE7E9)"),"var(".concat(o.Yf.ErrorBoxBackground,", rgba(253, 231, 233, 0.15))"),"var(".concat(o.Yf.ErrorText,", #323130)"),"var(".concat(o.Yf.InfoText,", #323130)"),"var(".concat(o.Yf.DarkErrorBlock,", #3E1F25)"),"var(".concat(o.Yf.DarkGrayErrorBackground,", #484848)"),"var(".concat(o.Yf.RedErrorText,", #F9526B)"),"var(".concat(o.Yf.GrayIcon,",  #333333)"),"var(".concat(o.Yf.Success,", #dff6dd)"),"var(".concat(o.Yf.SuccessIcon,", #107c10)"),{Theme:{themeDarker:"var(".concat(o.Yf.themeDarker,", #792000)"),themeDark:"var(".concat(o.Yf.themeDark,", #A52C00)"),themeDarkAlt:"var(".concat(o.Yf.themeDarkAlt,", #C33400)"),themePrimary:"var(".concat(o.Yf.themePrimary,", #D83B01)"),themeSecondary:"var(".concat(o.Yf.themeSecondary,", #DD4F1B)"),themeTertiary:"var(".concat(o.Yf.themeTertiary,", #E8825D)"),themeLight:"var(".concat(o.Yf.themeLight,", #F4BEAA)"),themeLighter:"var(".concat(o.Yf.themeLighter,", #F9DCD1)"),themeLighterAlt:"var(".concat(o.Yf.themeLighterAlt,", #FDF6F3)")},Neutral:{black:"var(".concat(o.Yf.black,", #000000)"),neutralDark:"var(".concat(o.Yf.neutralDark,", #201F1E)"),neutralPrimary:"var(".concat(o.Yf.neutralPrimary,", #323130)"),neutralPrimaryAlt:"var(".concat(o.Yf.neutralPrimaryAlt,", #3B3A39)"),neutralSecondary:"var(".concat(o.Yf.neutralSecondary,", #605e5c)"),neutralSecondaryAlt:"var(".concat(o.Yf.neutralSecondaryAlt,", #8A8886)"),neutralTertiary:"var(".concat(o.Yf.neutralTertiary,", #A19F9D)"),neutralTertiaryAlt:"var(".concat(o.Yf.neutralTertiaryAlt,", #C8C6C4)"),neutralQuaternary:"var(".concat(o.Yf.neutralQuaternary,", #D2D0CE)"),neutralQuaternaryAlt:"var(".concat(o.Yf.neutralQuaternaryAlt,", #E1DFDD)"),neutralQuaternaryAlt2:"var(".concat(o.Yf.neutralQuaternaryAlt2,", #E0E0E0)"),neutralLight:"var(".concat(o.Yf.neutralLight,", #EDEBE9)"),neutralLightAlt:"var(".concat(o.Yf.neutralLightAlt,", #F5F5F5)"),neutralLighter:"var(".concat(o.Yf.neutralLighter,", #F3F2F1)"),neutralLighterAlt:"var(".concat(o.Yf.neutralLighterAlt,", #FAF9F8)"),white:"var(".concat(o.Yf.white,", #FFFFFF)")},Accent:{yellowDark:"var(".concat(o.Yf.yellowDark,", #d29200)"),yellow:"var(".concat(o.Yf.yellow,", #ffb900)"),yellowLight:"var(".concat(o.Yf.yellowLight,", #fff100)"),orange:"var(".concat(o.Yf.orange,", #d83b01)"),orangeLight:"var(".concat(o.Yf.orangeLight,", #ea4300)"),orangeLighter:"var(".concat(o.Yf.orangeLighter,", #ff8c00)"),redDark:"var(".concat(o.Yf.redDark,", #a4262c)"),red:"var(".concat(o.Yf.red,", #d13438)"),magentaDark:"var(".concat(o.Yf.magentaDark,", #5c005c)"),magenta:"var(".concat(o.Yf.magenta,", #b4009e)"),magentaLight:"var(".concat(o.Yf.magentaLight,", #e3008c)"),purpleDark:"var(".concat(o.Yf.purpleDark,", #32145a)"),purple:"var(".concat(o.Yf.purple,", #5c2d91)"),purpleLight:"var(".concat(o.Yf.purpleLight,", #b4a0ff)"),blueDark:"var(".concat(o.Yf.blueDark,", #002050)"),blueMid:"var(".concat(o.Yf.blueMid,", #00188f)"),blue:"var(".concat(o.Yf.blue,", #0078d4)"),blueAlt:"var(".concat(o.Yf.blueAlt,", #2E6AC5)"),blueLight:"var(".concat(o.Yf.blueLight,", #00bcf2)"),tealDark:"var(".concat(o.Yf.tealDark,", #004b50)"),teal:"var(".concat(o.Yf.teal,", #008272)"),tealLight:"var(".concat(o.Yf.tealLight,", #00B294)"),greenDark:"var(".concat(o.Yf.greenDark,", #004b1c)"),green:"var(".concat(o.Yf.green,", #107c10)"),greenLight:"var(".concat(o.Yf.greenLight,", #bad80a)")}});"var(".concat(o.Yf.SuggestionAcceptedBackground,", #d4edd4)"),"var(".concat(o.Yf.SpellingSuggestionHoverHighlight,", #cb2f3437)"),"var(".concat(o.Yf.SpellingHoverTextColor,", ").concat(o.Yf.neutralPrimary,")"),"var(".concat(o.Yf.GrammarSuggestionHoverHighlight,", #eaeeff40)"),"var(".concat(o.Yf.GrammarHoverTextColor,", ").concat(o.Yf.neutralPrimary,")"),"var(".concat(o.Yf.HeadingDetectedHoverHighlight,", #d27a3627)"),"var(".concat(o.Yf.HeadingDetectedHoverTextColor,", ").concat(o.Yf.neutralPrimary,")"),"var(".concat(o.Yf.EntityRecognitionUnderline,", #484644)"),"var(".concat(n.XX.colorNeutralBackground7,", var(").concat(o.qH.TextSelectionBackgroundHovered,", ").concat(o.Yf.neutralPrimary,"))"),"var(".concat(o.Yf.EntityRecognitionHoverTextColor,", ").concat(o.Yf.neutralPrimary,")"),"var(".concat(o.Yf.TaskRecognitionUnderline,", #484644)"),"var(".concat(o.Yf.TaskRecognitionHoverHighlight,", #f3f2f1)"),"var(".concat(o.Yf.TaskRecognitionHoverTextColor,", ").concat(o.Yf.neutralPrimary,")"),"var(".concat(o.qH.BodyBackgroundWithAlpha,", #FFFFFF00)")},47699:function(e,t,r){"use strict";r.d(t,{Dc:function(){return i},W2:function(){return s},Yf:function(){return c},nm:function(){return a},qH:function(){return o},xE:function(){return n}});var n={BlockingBackground:"--ms-themeColorBlockingBackground",BlockingIcon:"--ms-themeColorBlockingIcon",BodyBackground:"--ms-themeColorBodyBackground",BodyBackgroundChecked:"--ms-themeColorBodyBackgroundChecked",BodyBackgroundHovered:"--ms-themeColorBodyBackgroundHovered",BodyDivider:"--ms-themeColorBodyDivider",BodyFrameBackground:"--ms-themeColorBodyFrameBackground",BodyFrameDivider:"--ms-themeColorBodyFrameDivider",BodyText:"--ms-themeColorBodyText",BodyTextChecked:"--ms-themeColorBodyTextChecked",BodyStandoutBackground:"--ms-themeColorBodyStandoutBackground",BodySubtext:"--ms-themeColorBodySubtext",DefaultStateBackground:"--ms-themeColorDefaultStateBackground",DisabledBodySubtext:"--ms-themeColorDisabledBodySubtext",DisabledBodyText:"--ms-themeColorDisabledBodyText",DisabledBorder:"--ms-themeColorDisabledBorder",ErrorBackground:"--ms-themeColorErrorBackground",ErrorBoxBackground:"--ms-themeColorErrorBoxBackground",ErrorIcon:"--ms-themeColorErrorIcon",ErrorBorder:"--ms-themeColorErrorBorder",ErrorBlock:"--ms-themeColorErrorBlock",DarkErrorBlock:"--ms-themeColorDarkErrorBlock",GrayErrorBackground:"--ms-themeColorGrayErrorBackground",DarkGrayErrorBackground:"--ms-themeColorDarkGrayErrorBackground",ErrorText:"--ms-themeColorErrorText",InfoText:"--ms-themeColorInfoText",RedErrorText:"--ms-themeColorRedErrorText",GrayIcon:"--ms-themeColorGrayIcon",FocusBorder:"--ms-themeColorFocusBorder",InfoBackground:"--ms-themeColorInfoBackground",InfoIcon:"--ms-themeColorInfoIcon",MessageLink:"--ms-themeColorMessageLink",MessageLinkHovered:"--ms-themeColorMessageLinkHovered",MessageText:"--ms-themeColorMessageText",SevereWarningBackground:"--ms-themeColorSevereWarningBackground",SevereWarningIcon:"--ms-themeColorSevereWarningIcon",SuccessBackground:"--ms-themeColorSuccessBackground",SuccessIcon:"--ms-themeColorSuccessIcon",VariantBorder:"--ms-themeColorVariantBorder",VariantBorderHovered:"--ms-themeColorVariantBorderHovered",WarningBackground:"--ms-themeColorWarningBackground",WarningHighlight:"--ms-themeColorWarningHighlight",WarningIcon:"--ms-themeColorWarningIcon",ActionLink:"--ms-themeColorActionLink",ActionLinkHovered:"--ms-themeColorActionLinkHovered",Link:"--ms-themeColorLink",LinkHovered:"--ms-themeColorLinkHovered",AccentButtonBackground:"--ms-themeColorAccentButtonBackground",AccentButtonText:"--ms-themeColorAccentButtonText",ButtonBackground:"--ms-themeColorButtonBackground",ButtonBackgroundChecked:"--ms-themeColorButtonBackgroundChecked",ButtonBackgroundHovered:"--ms-themeColorButtonBackgroundHovered",ButtonBackgroundCheckedHovered:"--ms-themeColorButtonBackgroundCheckedHovered",ButtonBackgroundPressed:"--ms-themeColorButtonBackgroundPressed",ButtonBackgroundDisabled:"--ms-themeColorButtonBackgroundDisabled",ButtonBorder:"--ms-themeColorButtonBorder",ButtonText:"--ms-themeColorButtonText",ButtonTextHovered:"--ms-themeColorButtonTextHovered",ButtonTextChecked:"--ms-themeColorButtonTextChecked",ButtonTextCheckedHovered:"--ms-themeColorButtonTextCheckedHovered",ButtonTextPressed:"--ms-themeColorButtonTextPressed",ButtonTextDisabled:"--ms-themeColorButtonTextDisabled",ButtonBorderDisabled:"--ms-themeColorButtonBorderDisabled",PrimaryButtonBackground:"--ms-themeColorPrimaryButtonBackground",PrimaryButtonBackgroundHovered:"--ms-themeColorPrimaryButtonBackgroundHovered",PrimaryButtonBackgroundPressed:"--ms-themeColorPrimaryButtonBackgroundPressed",PrimaryButtonBackgroundDisabled:"--ms-themeColorPrimaryButtonBackgroundDisabled",PrimaryButtonBorder:"--ms-themeColorPrimaryButtonBorder",PrimaryButtonText:"--ms-themeColorPrimaryButtonText",PrimaryButtonTextHovered:"--ms-themeColorPrimaryButtonTextHovered",PrimaryButtonTextPressed:"--ms-themeColorPrimaryButtonTextPressed",PrimaryButtonTextDisabled:"--ms-themeColorPrimaryButtonTextDisabled",InputBorder:"--ms-themeColorInputBorder",InputBorderHovered:"--ms-themeColorInputBorderHovered",InputBackground:"--ms-themeColorInputBackground",InputBackgroundChecked:"--ms-themeColorInputBackgroundChecked",InputBackgroundCheckedHovered:"--ms-themeColorInputBackgroundCheckedHovered",InputPlaceholderBackgroundChecked:"--ms-themeColorInputPlaceholderBackgroundChecked",InputForegroundChecked:"--ms-themeColorInputForegroundChecked",InputIcon:"--ms-themeColorInputIcon",InputIconHovered:"--ms-themeColorInputIconHovered",InputIconDisabled:"--ms-themeColorInputIconDisabled",InputFocusBorderAlt:"--ms-themeColorInputFocusBorderAlt",SmallInputBorder:"--ms-themeColorSmallInputBorder",InputText:"--ms-themeColorInputText",InputTextHovered:"--ms-themeColorInputTextHovered",InputTextPressed:"--ms-themeColorInputTextPressed",InputPlaceholderText:"--ms-themeColorInputPlaceholderText",DisabledBackground:"--ms-themeColorDisabledBackground",DisabledText:"--ms-themeColorDisabledText",DisabledSubtext:"--ms-themeColorDisabledSubtext",ListBackground:"--ms-themeColorListBackground",ListText:"--ms-themeColorListText",ListTextColor:"--ms-themeColorListTextColor",ListItemBackgroundHovered:"--ms-themeColorListItemBackgroundHovered",ListItemBackgroundChecked:"--ms-themeColorListItemBackgroundChecked",ListItemBackgroundCheckedHovered:"--ms-themeColorListItemBackgroundCheckedHovered",ListHeaderBackgroundHovered:"--ms-themeColorListHeaderBackgroundHovered",ListHeaderBackgroundPressed:"--ms-themeColorListHeaderBackgroundPressed",MenuBackground:"--ms-themeColorMenuBackground",MenuBorder:"--ms-themeColorMenuBorder",MenuDivider:"--ms-themeColorMenuDivider",MenuIcon:"--ms-themeColorMenuIcon",MenuHeader:"--ms-themeColorMenuHeader",MenuItemBackgroundChecked:"--ms-themeColorMenuItemBackgroundChecked",MenuItemBackgroundHovered:"--ms-themeColorMenuItemBackgroundHovered",MenuItemBackgroundPressed:"--ms-themeColorMenuItemBackgroundPressed",MenuItemText:"--ms-themeColorMenuItemText",MenuItemTextHovered:"--ms-themeColorMenuItemTextHovered",MenuItemTextPressed:"--ms-themeColorMenuItemTextPressed",MenuItemTextChecked:"--ms-themeColorMenuItemTextChecked",MenuItemTextSecondary:"--ms-themeColorMenuItemTextSecondary",CardShadow:"--ms-themeCardShadow",CardShadowHovered:"--ms-themeCardShadowHovered",CardStandoutBackground:"--ms-themeColorCardStandoutBackground",GrabberBorderChecked:"--ms-grabberBorderChecked",GrabberBackgroundChecked:"--ms-grabberBackgroundChecked",GrabberColor:"--ms-grabberColor",GrabberColorChecked:"--ms-grabberColorChecked",CheckboxBackgroundUnchecked:"--ms-checkboxBackgroundUnchecked",CheckboxBackgroundChecked:"--ms-checkboxBackgroundChecked",CheckboxColorUnchecked:"--ms-checkboxColorUnchecked",CheckboxColorUncheckedHovered:"--ms-checkboxColorUncheckedHovered",CheckboxColorCheckedHovered:"--ms-checkboxColorCheckedHovered",CheckboxColorChecked:"--ms-checkboxColorChecked",CheckboxUnpopulated:"--ms-checkboxUnpopulated",TeamsV2DefaultForeground2:"--ms-themeColorPaletteTeamsV2DefaultForeground2",TeamsV2DefaultForeground:"--ms-themeColorPaletteTeamsV2DefaultForeground",TeamsV2DefaultForegroundHover:"--ms-themeColorPaletteTeamsV2DefaultForegroundHover",TeamsV2DefaultForegroundPressed:"--ms-themeColorPaletteTeamsV2DefaultForegroundPressed",TeamsV2DefaultBackground:"--ms-themeColorPaletteTeamsV2DefaultBackground",TeamsV2DefaultBackgroundHover:"--ms-themeColorPaletteTeamsV2DefaultBackgroundHover",TeamsV2DefaultBackgroundPressed:"--ms-themeColorPaletteTeamsV2DefaultBackgroundPressed",TeamsV2DefaultBorder:"--ms-themeColorPaletteTeamsV2DefaultBorder",TeamsV2DefaultBorderHover:"--ms-themeColorPaletteTeamsV2DefaultBorderHover",TeamsV2DefaultBorderPressed:"--ms-themeColorPaletteTeamsV2DefaultBorderPressed",TeamsV2BrandForeground4:"--ms-themeColorPaletteTeamsV2BrandForeground4",TeamsV2BrandBackground:"--ms-themeColorPaletteTeamsV2BrandBackground",TeamsV2BrandBackgroundHover:"--ms-themeColorPaletteTeamsV2BrandBackgroundHover",TeamsV2BrandBackgroundPressed:"--ms-themeColorPaletteTeamsV2BrandBackgroundPressed",VotingButtonHoverShadow:"--ms-themeColorPaletteVotingButtonHoverShadow"},o={ThemeName:"--ms-themeColorThemeName",TextSizeAdjust:"--ms-themeTextSizeAdjust",Selection:"--ms-themeColorSelection",SelectionBackground:"--ms-themeColorSelectionBackground",SelectionBorder:"--ms-themeColorSelectionBorder",DragDropTearOffPageBorder:"--ms-themeColorPaletteDragDropTearOffPageBorder",DragDropTearOffPageBackground:"--ms-themeColorPaletteDragDropTearOffPageBackground",BlockComponentPlaceholderBackground:"--ms-themeColorPaletteBlockComponentPlaceholderBackground",AtMentionBackgroundMe:"--ms-themeColorPaletteAtMentionBackGroundMe",AtMentionTextMe:"--ms-themeColorPaletteAtMentionTextMe",AtMentionBackgroundOther:"--ms-themeColorPaletteAtMentionBackgroundOther",AtMentionTextOther:"--ms-themeColorPaletteAtMentionTextOther",AtMentionBackgroundHighlight:"--ms-themeColorPaletteAtMentionBackgroundHighlight",AtMentionHighlightBorder:"--ms-themeColorPaletteAtMentionHighlightBorder",AtMentionUnresolvedBackground:"--ms-themeColorPaletteAtMentionUnresolvedBackground",AtMentionUnresolvedBackgroundHovered:"--ms-themeColorPaletteAtMentionUnresolvedBackgroudHovered",AtMentionUnresolvedBackgroundPressed:"--ms-themeColorPaletteAtMentionsUnresolvedBackgroundPressed",AtMentionUnresolvedBackgroundSelected:"--ms-themeColorPaletteAtMentionUnresolvedBackgroudSelected",AtMentionUnresolvedIcon:"--ms-themeColorPaletteAtMentionUnresolvedIcon",AtMentionUnresolvedIconHovered:"--ms-themeColorPaletteAtMentionUnresolvedIconHovered",AtMentionUnresolvedIconPressed:"--ms-themeColorPaletteAtMentionUnresolvedIconPressed",AtMentionUnresolvedIconSelected:"--ms-themeColorPaletteAtMentionUnresolvedIconSelected",AtMentionUnresolvedIconInner:"--ms-themeColorPaletteAtMentionUnresolvedIconInner",AtMentionUnresolvedIconInnerHovered:"--ms-themeColorPaletteAtMentionUnresolvedIconInnerHovered",AtMentionUnresolvedIconInnerPressed:"--ms-themeColorPaletteAtMentionUnresolvedIconInnerPressed",AtMentionUnresolvedIconInnerSelected:"--ms-themeColorPaletteAtMentionUnresolvedIconInnerSelected",AtMentionUnresolvedOutline:"--ms-themeColorPaletteAtMentionUnresolvedOutline",AtMentionUnresolvedOutlineHovered:"--ms-themeColorPaletteAtMentionUnresolvedOutlineHovered",AtMentionUnresolvedOutlinePressed:"--ms-themeColorPaletteAtMentionUnresolvedOutlinePressed",AtMentionUnresolvedOutlineSelected:"--ms-themeColorPaletteAtMentionUnresolvedOutlineSelected",IconButton:"--ms-themeColorIconButton",IconButtonHovered:"--ms-themeColorIconButtonHovered",IconButtonPressed:"--ms-themeColorIconButtonPressed",IconButtonChecked:"--ms-themeColorIconButtonChecked",IconButtonBackground:"--ms-themeColorIconButtonBackground",IconButtonBackgroundHovered:"--ms-themeColorIconButtonBackgroundHovered",IconButtonBackgroundPressed:"--ms-themeColorIconButtonBackgroundPressed",IconButtonBackgroundChecked:"--ms-themeColorIconButtonBackgroundChecked",OverflowText:"--ms-themeColorOverflowText",OverflowTextHovered:"--ms-themeColorOverflowTextHovered",OverflowTextPressed:"--ms-themeColorOverflowTextPressed",OverflowTextChecked:"--ms-themeColorOverflowTextChecked",OverflowBackground:"--ms-themeColorOverflowBackground",OverflowBackgroundHovered:"--ms-themeColorOverflowBackgroundHovered",OverflowBackgroundPressed:"--ms-themeColorOverflowBackgroundPressed",OverflowBackgroundChecked:"--ms-themeColorOverflowBackgroundChecked",MenuBorder:"--ms-themeColorMenuBorder",TooltipText:"--ms-themeColorTooltipText",TooltipBackground:"--ms-themeColorTooltipBackground",CalendarCellText:"--ms-themeColorCalendarCellText",CalendarCellTextHovered:"--ms-themeColorCalendarCellTextHovered",CalendarCellTextChecked:"--ms-themeColorCalendarCellTextChecked",CalendarCellTextToday:"--ms-themeColorCalendarCellTextToday",CalendarHeaderText:"--ms-themeColorCalendarHeaderText",CalendarBackground:"--ms-themeColorCalendarBackground",CalendarCellBackground:"--ms-themeColorCalendarCellBackground",CalendarCellBackgroundHovered:"--ms-themeColorCalendarCellBackgroundHovered",CalendarCellBackgroundChecked:"--ms-themeColorCalendarCellBackgroundSelected",CalendarCellBackgroundToday:"--ms-themeColorCalendarCellBackgroundToday",DatePickerTextToday:"--ms-themeColorDatePickerTextToday",DatePickerTextTomorrow:"--ms-themeColorDatePickerTextTomorrow",DatePickerTextYesterday:"--ms-themeColorDatePickerTextYesterday",DatePickerTextOther:"--ms-themeColorDatePickerTextOther",DatePickerBackgroundToday:"--ms-themeColorDatePickerBackgroundToday",DatePickerBackgroundTomorrow:"--ms-themeColorDatePickerBackgroundTomorrow",DatePickerBackgroundYesterday:"--ms-themeColorDatePickerBackgroundYesterday",DatePickerBackground:"--ms-themeColorDatePickerBackground",DatePickerGrayedText:"--ms-themeColorDatePickerGrayedText",DatePickerGrayedBackground:"--ms-themeColorDatePickerGrayedBackground",TaskDueDateTextToday:"--ms-themeColorDatePickerTextToday",TaskDueDateTextTomorrow:"--ms-themeColorDatePickerTextTomorrow",TaskDueDateTextYesterday:"--ms-themeColorDatePickerTextYesterday",TaskDueDateTextOther:"--ms-themeColorDatePickerTextOther",PersonaBorder:"--ms-themeColorPersonaBorder",PersonaText:"--ms-themeColorPersonaText",BodyBackgroundWithAlpha:"--ms-themeColorBodyBackgroundWithAlpha",ErrorCalloutText:"--ms-themeColorErrorCalloutText",ErrorCalloutBackground:"--ms-themeColorErrorCalloutBackground",ErrorSnackbarText:"--ms-themeColorErrorSnackbarText",ErrorSnackbarBackground:"--ms-themeColorErrorSnackbarBackground",WarningSnackbarText:"--ms-themeColorWarningSnackbarText",WarningSnackbarBackground:"--ms-themeColorWarningSnackbarBackground",TextSelectionBackgroundHovered:"--ms-themeColorPaletteTextSelectionBackgroundHovered",TextSelectionBackgroundPressed:"--ms-themeColorPaletteTextSelectionBackgroundPressed",TextSelectionEndCap:"--ms-themeColorPaletteTextSelectionEndCap",TextSelectionHorizontalCap:"--ms-themeColorPaletteTextSelectionHorizontalCap",FloatieText:"--ms-themeColorPaletteFloatieText",FloatieTextHovered:"--ms-themeColorPaletteFloatieTextHovered",FloatieTextPressed:"--ms-themeColorPaletteFloatieTextPressed",FloatieBackground:"--ms-themeColorPaletteFloatieBackground",FloatieBackgroundHovered:"--ms-themeColorPaletteFloatieBackgroundHovered",FloatieBackgroundPressed:"--ms-themeColorPaletteFloatieBackgroundPressed",FloatieBorder:"--ms-themeColorPaletteFloatieBorder",FloatieBorderHovered:"--ms-themeColorPaletteFloatieBorderHovered",FloatieBorderPressed:"--ms-themeColorPaletteFloatieBorderPressed",FontColorRed:"--ms-themeColorPaletteFontColorRed",FontColorOrange:"--ms-themeColorPaletteFontColorOrange",FontColorYellow:"--ms-themeColorPaletteFontColorYellow",FontColorGreen:"--ms-themeColorPaletteFontColorGreen",FontColorBlueGreen:"--ms-themeColorPaletteFontColorBlueGreen",FontColorBlue:"--ms-themeColorPaletteFontColorBlue",FontColorPurple:"--ms-themeColorPaletteFontColorPurple",BackgroundColorRed:"--ms-themeColorPaletteBackgroundColorRed",BackgroundColorOrange:"--ms-themeColorPaletteBackgroundColorOrange",BackgroundColorYellow:"--ms-themeColorPaletteBackgroundColorYellow",BackgroundColorGreen:"--ms-themeColorPaletteBackgroundColorGreen",BackgroundColorBlueGreen:"--ms-themeColorPaletteBackgroundColorBlueGreen",BackgroundColorBlue:"--ms-themeColorPaletteBackgroundColorBlue",BackgroundColorPurple:"--ms-themeColorPaletteBackgroundColorPurple",BackgroundAcrylicColorized:"--colorBackgroundAcrylicColorized",BackgroundAcrylicColorizedFallback:"--colorBackgroundAcrylicColorizedFallback",BackgroundAcrylicNeutral:"--colorBackgroundAcrylicNeutral",BackgroundAcrylicNeutralFallback:"--colorBackgroundAcrylicNeutralFallback",ComponentGlowBorder1:"--ms-themeColorPaletteComponentGlowBorder1",ComponentGlowBorder2:"--ms-themeColorPaletteComponentGlowBorder2",ComponentGlowBorder3:"--ms-themeColorPaletteComponentGlowBorder3",ComponentGlowBorder4:"--ms-themeColorPaletteComponentGlowBorder4",ComponentGlowBorder5:"--ms-themeColorPaletteComponentGlowBorder5",InCanvasPresenceText:"--ms-themeColorInCanvasPresenceText"},i={Default:"default",Dark:"dark",HighContrast:"high-contrast"},a={MarginTopBody:"--ms-themeMarginTopBody",MarginTopHeading1:"--ms-themeMarginTopHeading1",MarginTopHeading2:"--ms-themeMarginTopHeading2",MarginTopHeading3:"--ms-themeMarginTopHeading3",LineHeightBody:"--ms-themeLineHeightBody",LineHeightHeading1:"--ms-themeLineHeightHeading1",LineHeightHeading2:"--ms-themeLineHeightHeading2",LineHeightHeading3:"--ms-themeLineHeightHeading3",OutlineBody:"--ms-themeOutlineBody",OutlineHeading1:"--ms-themeOutlineHeading1",OutlineHeading2:"--ms-themeOutlineHeading2",OutlineHeading3:"--ms-themeOutlineHeading3",TextDecorationComplement:"--ms-themeTextDecorationComplement"},s={FontFamilyBody:"--ms-themeFontFamilyBody",FontFamilyHeading1:"--ms-themeFontFamilyHeading1",FontFamilyHeading2:"--ms-themeFontFamilyHeading2",FontFamilyHeading3:"--ms-themeFontFamilyHeading3",FontFamilyMenu:"--ms-themeFontFamilyMenu",FontFamilyButton:"--ms-themeFontFamilyButton",FontSizeBody:"--ms-themeFontSizeBody",FontSizeHeading1:"--ms-themeFontSizeHeading1",FontSizeHeading2:"--ms-themeFontSizeHeading2",FontSizeHeading3:"--ms-themeFontSizeHeading3",FontSizeHeading4:"--ms-themeFontSizeHeading4",FontSizeMenu:"--ms-themeFontSizeMenu",FontSizeButton:"--ms-themeFontSizeButton",FontWeightBody:"--ms-themeFontWeightBody",FontWeightHeading1:"--ms-themeFontWeightHeading1",FontWeightHeading2:"--ms-themeFontWeightHeading2",FontWeightHeading3:"--ms-themeFontWeightHeading3",FontWeightMenu:"--ms-themeFontWeightMenu",FontWeightButton:"--ms-themeFontWeightButton"},c={PinkRed10:"--ms-themeColorPaletteSharedPinkRed10",Red20:"--ms-themeColorPaletteSharedRed20",Red10:"--ms-themeColorPaletteSharedRed10",RedOrange10:"--ms-themeColorPaletteSharedRedOrange10",Orange30:"--ms-themeColorPaletteSharedOrange30",Orange20:"--ms-themeColorPaletteSharedOrange20",Orange10:"--ms-themeColorPaletteSharedOrange10",Yellow20:"--ms-themeColorPaletteSharedYellow20",Yellow10:"--ms-themeColorPaletteSharedYellow10",OrangeYellow20:"--ms-themeColorPaletteSharedOrangeYellow20",OrangeYellow10:"--ms-themeColorPaletteSharedOrangeYellow10",YellowGreen10:"--ms-themeColorPaletteSharedYellowGreen10",Green20:"--ms-themeColorPaletteSharedGreen20",Green10:"--ms-themeColorPaletteSharedGreen10",GreenCyan10:"--ms-themeColorPaletteSharedGreenCyan10",Cyan30:"--ms-themeColorPaletteSharedCyan30",Cyan20:"--ms-themeColorPaletteSharedCyan20",Cyan10:"--ms-themeColorPaletteSharedCyan10",CyanBlue20:"--ms-themeColorPaletteSharedCyanBlue20",CyanBlue10:"--ms-themeColorPaletteSharedCyanBlue10",Blue10:"--ms-themeColorPaletteSharedBlue10",BlueMagenta30:"--ms-themeColorPaletteSharedBlueMagenta30",BlueMagenta20:"--ms-themeColorPaletteSharedBlueMagenta20",BlueMagenta10:"--ms-themeColorPaletteSharedBlueMagenta10",Magenta20:"--ms-themeColorPaletteSharedMagenta20",Magenta10:"--ms-themeColorPaletteSharedMagenta10",MagentaPink20:"--ms-themeColorPaletteSharedMagentaPink20",MagentaPink10:"--ms-themeColorPaletteSharedMagentaPink10",Gray430:"--ms-themeColorPaletteSharedGray430",Gray180:"--ms-themeColorPaletteSharedGray180",Gray130:"--ms-themeColorPaletteSharedGray130",Gray100:"--ms-themeColorPaletteSharedGray100",Gray80:"--ms-themeColorPaletteSharedGray80",Gray70:"--ms-themeColorPaletteSharedGray70",Gray50:"--ms-themeColorPaletteSharedGray50",Gray40:"--ms-themeColorPaletteSharedGray40",Gray30:"--ms-themeColorPaletteSharedGray30",Gray20:"--ms-themeColorPaletteSharedGray20",Gray10:"--ms-themeColorPaletteSharedGray10",Gray4:"--ms-themeColorPaletteSharedGray4",Gray6:"--ms-themeColorPaletteSharedGray6",Gray5:"--ms-themeColorPaletteSharedGray5",Gray1:"--ms-themeColorPaletteSharedGray1",Away:"--ms-themeColorPalettePresenceAway",DoNotDisturb:"--ms-themeColorPalettePresenceDoNotDisturb",Online:"--ms-themeColorPalettePresenceOnline",Invisible:"--ms-themeColorPalettePresenceInvisible",OutOfOffice:"--ms-themeColorPalettePresenceOutOfOffice",Warning:"--ms-themeColorPaletteMessagingWarning",WarningIcon:"--ms-themeColorPaletteMessagingWarningIcon",SevereWarning:"--ms-themeColorPaletteMessagingSevereWarning",SevereWarningIcon:"--ms-themeColorPaletteMessagingServereWarningIcon",ErrorBlock:"--ms-themeColorPaletteMessagingErrorBlock",ErrorBlockIcon:"--ms-themeColorPaletteMessagingErrorBlockIcon",ErrorBackground:"--ms-themeColorPaletteMessagingErrorBackground",ErrorBoxBackground:"--ms-themeColorPaletteMessagingErrorBoxBackground",ErrorText:"--ms-themeColorPaletteMessagingErrorText",InfoText:"--ms-themeColorPaletteMessagingInfoText",DarkErrorBlock:"--ms-themeColorPaletteMessagingDarkErrorBlock",GrayErrorBackground:"--ms-themeColorPaletteMessagingGrayErrorBackground",DarkGrayErrorBackground:"--ms-themeColorPaletteMessagingDarkGrayErrorBackground",GrayErrorText:"--ms-themeColorPaletteMessagingGrayErrorText",RedErrorText:"--ms-themeColorPaletteMessagingRedErrorText",GrayIcon:"--ms-themeColorPaletteMessagingGrayIcon",ButtonText:"--ms-themeColorPaletteMessagingButtonText",Success:"--ms-themeColorPaletteMessagingSuccess",SuccessIcon:"--ms-themeColorPaletteMessagingSuccessIcon",themeDarker:"--ms-themeColorPaletteThemeDarker",themeDark:"--ms-themeColorPaletteThemeDark",themeDarkAlt:"--ms-themeColorPaletteThemeDarkAlt",themePrimary:"--ms-themeColorPaletteThemePrimary",themeSecondary:"--ms-themeColorPaletteThemeSecondary",themeTertiary:"--ms-themeColorPaletteThemeTertiary",themeLight:"--ms-themeColorPaletteThemeLight",themeLighter:"--ms-themeColorPaletteThemeLighter",themeLighterAlt:"--ms-themeColorPaletteThemeLightAlt",black:"--ms-themeColorPaletteBlack",neutralDark:"--ms-themeColorPaletteNeutralDark",neutralPrimary:"--ms-themeColorPaletteNeutralPrimary",neutralPrimaryAlt:"--ms-themeColorPaletteNeutralPrimaryAlt",neutralSecondary:"--ms-themeColorPaletteNeutralSecondary",neutralSecondaryAlt:"--ms-themeColorPaletteNeutralSecondaryAlt",neutralTertiary:"--ms-themeColorPaletteNeutralTertiary",neutralTertiaryAlt:"--ms-themeColorPaletteNeutralTertiaryAlt",neutralQuaternary:"--ms-themeColorPaletteNeutralQuaternary",neutralQuaternaryAlt:"--ms-themeColorPaletteNeutralQuaternaryAlt",neutralQuaternaryAlt2:"--ms-themeColorPaletteNeutralQuaternaryAlt2",neutralLight:"--ms-themeColorPaletteNeutralLight",neutralLightAlt:"--ms-themeColorPaletteNeutralLightAlt",neutralLighter:"--ms-themeColorPaletteNeutralLighter",neutralLighterAlt:"--ms-themeColorPaletteNeutralLighterAlt",white:"--ms-themeColorPaletteWhite",yellowDark:"--ms-themeColorPaletteAccentYellowDark",yellow:"--ms-themeColorPaletteAccentYellow",yellowLight:"--ms-themeColorPaletteAccentYellowLight",orange:"--ms-themeColorPaletteAccentOrange",orangeLight:"--ms-themeColorPaletteAccentOrangeLight",orangeLighter:"--ms-themeColorPaletteAccentOrangeLighter",redDark:"--ms-themeColorPaletteAccentRedDark",red:"--ms-themeColorPaletteAccentRed",magentaDark:"--ms-themeColorPaletteAccentMagentaDark",magenta:"--ms-themeColorPaletteAccentMagenta",magentaLight:"--ms-themeColorPaletteAccentMagentaLight",purpleDark:"--ms-themeColorPaletteAccentPurpleDark",purple:"--ms-themeColorPaletteAccentPurple",purpleLight:"--ms-themeColorPaletteAccentPurpleLight",blueDark:"--ms-themeColorPaletteAccentBlueDark",blueMid:"--ms-themeColorPaletteAccentBlueMid",blue:"--ms-themeColorPaletteAccentBlue",blueAlt:"--ms-themeColorPaletteAccentBlueAlt",blueLight:"--ms-themeColorPaletteAccentBlueLight",tealDark:"--ms-themeColorPaletteAccentTealDark",teal:"--ms-themeColorPaletteAccentTeal",tealLight:"--ms-themeColorPaletteAccentTealLight",greenDark:"--ms-themeColorPaletteAccentGreenDark",green:"--ms-themeColorPaletteAccentGreen",greenLight:"--ms-themeColorPaletteAccentGreenLight",SuggestionAcceptedBackground:"--ms-themeColorPaletteProofingSuggestionAcceptedBackground",SpellingSuggestionHoverHighlight:"--ms-themeColorPaletteProofingSpellingSuggestionHoverHighlight",SpellingHoverTextColor:"--ms-themeColorPaletteProofingSpellingHoverTextColor",GrammarSuggestionHoverHighlight:"--ms-themeColorPaletteProofingGrammarSuggestionHoverHighlight",GrammarHoverTextColor:"--ms-themeColorPaletteProofingGrammarHoverTextColor",HeadingDetectedHoverHighlight:"--ms-themeColorPaletteAnnotationsHeadingDetectedHoverHighlight",HeadingDetectedHoverTextColor:"--ms-themeColorPaletteAnnotationsHeadingDetectedHoverTextColor",TaskRecognitionUnderline:"--ms-themeColorPaletteAnnotationsTaskRecognitionUnderline",TaskRecognitionHoverHighlight:"--ms-themeColorPaletteAnnotationsTaskRecognitionHoverHighlight",TaskRecognitionHoverTextColor:"--ms-themeColorPaletteAnnotationsTaskRecognitionHoverTextColor",EntityRecognitionUnderline:"--ms-themeColorPaletteAnnotationsEntityRecognitionUnderline",EntityRecognitionHoverHighlight:"--ms-themeColorPaletteAnnotationsEntityRecognitionHoverHighlight",EntityRecognitionHoverTextColor:"--ms-themeColorPaletteAnnotationsEntityRecognitionHoverTextColor",Scrollbar:"--ms-themeColorScrollbar",ScrollbarPressed:"--ms-themeColorScrollbarPressed",HeadingText:"--ms-themeColorHeadingText"}},53313:function(e,t,r){"use strict";r.d(t,{k:function(){return c}});var n=r(37762),o=r(97091),i=r(87191),a="--ms-themeColorPalette",s="--ms-themeColor";function c(e){var t=e?(0,i.n)(e):void 0,r={},c={},l=(0,o.j)(),d=function(e,t){if(e.startsWith(a)){var n=function(e){var t="--ms-themeColorPaletteShared",r="--ms-themeColorPaletteAccent";if(e.startsWith(t))return u(e,t);if(e.startsWith(r))return u(e,r);if(e.startsWith(a))return u(e,a);return}(e);void 0!==n&&l.palette.hasOwnProperty(n)&&!r[n]&&(r[n]=t)}else if(e.startsWith(s)){var o=u(e,s);o&&l.semanticColors.hasOwnProperty(o)&&!c[o]&&(c[o]=t)}};if(t){var f,h=(0,n.Z)(t);try{for(h.s();!(f=h.n()).done;){var p=f.value;d(p.name,p.value)}}catch(v){h.e(v)}finally{h.f()}}return(0,o.j)({palette:r,semanticColors:c})}function u(e,t){var r=e.substring(t.length);return"".concat(r.substring(0,1).toLowerCase()).concat(r.substring(1))}},73284:function(e,t,r){"use strict";r.d(t,{C:function(){return s}});var n=r(37762),o=r(1079),i=r(87191),a="--";function s(e){var t=e?(0,i.n)(e):void 0,r=(0,o.f)({10:"#29130b",20:"#4d2415",30:"#792000",40:"#99482b",50:"#a52c00",60:"#c33400",70:"#e06a3f",80:"#d83b01",90:"#dd4f1b",100:"#fe7948",110:"#ff865a",120:"#ff9973",130:"#e8825d",140:"#ffb498",150:"#f4beaa",160:"#f9dcd1"}),s=function(e,t){var n=function(e){if(e.startsWith(a)){var t=e.replace(a,"");return"".concat(t.charAt(0).toLowerCase()).concat(t.substring(1))}return e}(e);n&&r.hasOwnProperty(n)&&(r[n]=t)};if(t){var c,u=(0,n.Z)(t);try{for(u.s();!(c=u.n()).done;){var l=c.value;s(l.name,l.value)}}catch(d){u.e(d)}finally{u.f()}}return r}},87191:function(e,t,r){"use strict";r.d(t,{n:function(){return s}});var n=r(37762),o=r(63659),i=r(47699),a=new Map([[o.Yb.colorNeutralForeground1,[i.Yf.neutralPrimary]],[o.Yb.colorNeutralForeground1Hover,[i.Yf.neutralPrimary]],[o.Yb.colorNeutralForeground1Pressed,[i.Yf.neutralPrimary]],[o.Yb.colorNeutralForeground1Selected,[i.Yf.neutralPrimary]],[o.Yb.colorNeutralForeground2,[i.Yf.neutralSecondary]],[o.Yb.colorNeutralForeground2Hover,[i.Yf.neutralPrimary]],[o.Yb.colorNeutralForeground2Pressed,[i.Yf.neutralPrimary]],[o.Yb.colorNeutralForeground2Selected,[i.Yf.neutralPrimary]],[o.Yb.colorNeutralForeground2BrandHover,[i.Yf.themePrimary]],[o.Yb.colorNeutralForeground2BrandPressed,[i.Yf.themeDarkAlt]],[o.Yb.colorNeutralForeground2BrandSelected,[i.Yf.themePrimary]],[o.Yb.colorNeutralForeground3,[i.Yf.neutralTertiary]],[o.Yb.colorNeutralForeground3Hover,[i.Yf.neutralSecondary]],[o.Yb.colorNeutralForeground3Pressed,[i.Yf.neutralSecondary]],[o.Yb.colorNeutralForeground3Selected,[i.Yf.neutralSecondary]],[o.Yb.colorNeutralForeground3BrandHover,[i.Yf.themePrimary]],[o.Yb.colorNeutralForeground3BrandPressed,[i.Yf.themeDarkAlt]],[o.Yb.colorNeutralForeground3BrandSelected,[i.Yf.themePrimary]],[o.Yb.colorNeutralForeground4,[i.Yf.neutralQuaternary,i.xE.InputPlaceholderText]],[o.Yb.colorNeutralForegroundDisabled,[i.Yf.neutralTertiaryAlt]],[o.Yb.colorBrandForegroundLink,[i.Yf.themeDarkAlt]],[o.Yb.colorBrandForegroundLinkHover,[i.Yf.themeDark]],[o.Yb.colorBrandForegroundLinkPressed,[i.Yf.themeDarker]],[o.Yb.colorBrandForegroundLinkSelected,[i.Yf.themeDarkAlt]],[o.Yb.colorNeutralForeground2Link,[i.Yf.neutralSecondary]],[o.Yb.colorNeutralForeground2LinkHover,[i.Yf.neutralPrimary]],[o.Yb.colorNeutralForeground2LinkPressed,[i.Yf.neutralPrimary]],[o.Yb.colorNeutralForeground2LinkSelected,[i.Yf.neutralPrimary]],[o.Yb.colorCompoundBrandForeground1,[i.Yf.themePrimary]],[o.Yb.colorCompoundBrandForeground1Hover,[i.Yf.themeDarkAlt]],[o.Yb.colorCompoundBrandForeground1Pressed,[i.Yf.themeDark]],[o.Yb.colorBrandForeground1,[i.Yf.themePrimary]],[o.Yb.colorBrandForeground2,[i.Yf.themeDarkAlt]],[o.Yb.colorNeutralForeground1Static,[i.Yf.neutralPrimary]],[o.Yb.colorNeutralForegroundInverted,[i.Yf.white]],[o.Yb.colorNeutralForegroundInvertedHover,[i.Yf.white]],[o.Yb.colorNeutralForegroundInvertedPressed,[i.Yf.white]],[o.Yb.colorNeutralForegroundInvertedSelected,[i.Yf.white]],[o.Yb.colorNeutralForegroundOnBrand,[i.Yf.white]],[o.Yb.colorNeutralForegroundInvertedLink,[i.Yf.white]],[o.Yb.colorNeutralForegroundInvertedLinkHover,[i.Yf.white]],[o.Yb.colorNeutralForegroundInvertedLinkPressed,[i.Yf.white]],[o.Yb.colorNeutralForegroundInvertedLinkSelected,[i.Yf.white]],[o.Yb.colorNeutralForegroundInverted2,[i.Yf.white]],[o.Yb.colorBrandForegroundInverted,[i.Yf.themeSecondary]],[o.Yb.colorBrandForegroundInvertedHover,[i.Yf.themeTertiary]],[o.Yb.colorBrandForegroundInvertedPressed,[i.Yf.themeSecondary]],[o.Yb.colorBrandForegroundOnLight,[i.Yf.themePrimary]],[o.Yb.colorBrandForegroundOnLightHover,[i.Yf.themeDarkAlt]],[o.Yb.colorBrandForegroundOnLightPressed,[i.Yf.themeDark]],[o.Yb.colorBrandForegroundOnLightSelected,[i.Yf.themeDark]],[o.Yb.colorNeutralBackground1,[i.Yf.white]],[o.Yb.colorNeutralBackground1Hover,[i.Yf.neutralLighter]],[o.Yb.colorNeutralBackground1Pressed,[i.Yf.neutralQuaternaryAlt]],[o.Yb.colorNeutralBackground1Selected,[i.Yf.neutralLight]],[o.Yb.colorNeutralBackground2,[i.Yf.neutralLighterAlt]],[o.Yb.colorNeutralBackground2Hover,[i.Yf.neutralLighter]],[o.Yb.colorNeutralBackground2Pressed,[i.Yf.neutralQuaternaryAlt]],[o.Yb.colorNeutralBackground2Selected,[i.Yf.neutralLight]],[o.Yb.colorNeutralBackground3,[i.Yf.neutralLighter]],[o.Yb.colorNeutralBackground3Hover,[i.Yf.neutralLight]],[o.Yb.colorNeutralBackground3Pressed,[i.Yf.neutralQuaternary]],[o.Yb.colorNeutralBackground3Selected,[i.Yf.neutralQuaternaryAlt]],[o.Yb.colorNeutralBackground4,[i.Yf.neutralLighter]],[o.Yb.colorNeutralBackground4Hover,[i.Yf.neutralLighterAlt]],[o.Yb.colorNeutralBackground4Pressed,[i.Yf.neutralLighter]],[o.Yb.colorNeutralBackground4Selected,[i.Yf.white]],[o.Yb.colorNeutralBackground5,[i.Yf.neutralLight]],[o.Yb.colorNeutralBackground5Hover,[i.Yf.neutralLighter]],[o.Yb.colorNeutralBackground5Pressed,[i.Yf.neutralLighter]],[o.Yb.colorNeutralBackground5Selected,[i.Yf.neutralLighterAlt]],[o.Yb.colorNeutralBackground6,[i.Yf.neutralLight]],[o.Yb.colorNeutralBackgroundInverted,[i.Yf.neutralSecondary]],[o.Yb.colorSubtleBackgroundHover,[i.Yf.neutralLighter]],[o.Yb.colorSubtleBackgroundPressed,[i.Yf.neutralQuaternaryAlt]],[o.Yb.colorSubtleBackgroundSelected,[i.Yf.neutralLight]],[o.Yb.colorNeutralBackgroundDisabled,[i.Yf.neutralLighter]],[o.Yb.colorNeutralStencil1,[i.Yf.neutralLight]],[o.Yb.colorNeutralStencil2,[i.Yf.neutralLighterAlt]],[o.Yb.colorBrandBackground,[i.Yf.themePrimary]],[o.Yb.colorBrandBackgroundHover,[i.Yf.themeDarkAlt]],[o.Yb.colorBrandBackgroundPressed,[i.Yf.themeDarker]],[o.Yb.colorBrandBackgroundSelected,[i.Yf.themeDark]],[o.Yb.colorCompoundBrandBackground,[i.Yf.themePrimary]],[o.Yb.colorCompoundBrandBackgroundHover,[i.Yf.themeDarkAlt]],[o.Yb.colorCompoundBrandBackgroundPressed,[i.Yf.themeDark]],[o.Yb.colorBrandBackgroundStatic,[i.Yf.themePrimary]],[o.Yb.colorBrandBackground2,[i.Yf.themeLighterAlt]],[o.Yb.colorBrandBackgroundInverted,[i.Yf.white]],[o.Yb.colorBrandBackgroundInvertedHover,[i.Yf.themeLighterAlt]],[o.Yb.colorBrandBackgroundInvertedPressed,[i.Yf.themeLight]],[o.Yb.colorBrandBackgroundInvertedSelected,[i.Yf.themeLighter]],[o.Yb.colorNeutralStrokeAccessible,[i.Yf.neutralSecondary]],[o.Yb.colorNeutralStrokeAccessibleHover,[i.Yf.neutralSecondary]],[o.Yb.colorNeutralStrokeAccessiblePressed,[i.Yf.neutralSecondary]],[o.Yb.colorNeutralStrokeAccessibleSelected,[i.Yf.themePrimary]],[o.Yb.colorNeutralStroke1,[i.Yf.neutralQuaternary]],[o.Yb.colorNeutralStroke1Hover,[i.Yf.neutralTertiaryAlt]],[o.Yb.colorNeutralStroke1Pressed,[i.Yf.neutralTertiaryAlt]],[o.Yb.colorNeutralStroke1Selected,[i.Yf.neutralTertiaryAlt]],[o.Yb.colorNeutralStroke2,[i.Yf.neutralQuaternaryAlt]],[o.Yb.colorNeutralStroke3,[i.Yf.neutralLighter]],[o.Yb.colorNeutralStrokeOnBrand,[i.Yf.white]],[o.Yb.colorNeutralStrokeOnBrand2,[i.Yf.white]],[o.Yb.colorNeutralStrokeOnBrand2Hover,[i.Yf.white]],[o.Yb.colorNeutralStrokeOnBrand2Pressed,[i.Yf.white]],[o.Yb.colorNeutralStrokeOnBrand2Selected,[i.Yf.white]],[o.Yb.colorBrandStroke1,[i.Yf.themePrimary]],[o.Yb.colorBrandStroke2,[i.Yf.themeLight]],[o.Yb.colorCompoundBrandStroke,[i.Yf.themePrimary]],[o.Yb.colorCompoundBrandStrokeHover,[i.Yf.themeDarkAlt]],[o.Yb.colorCompoundBrandStrokePressed,[i.Yf.themeDark]],[o.Yb.colorNeutralStrokeDisabled,[i.Yf.neutralQuaternaryAlt]],[i.xE.AccentButtonBackground,[o.Yb.colorBrandBackground]],[i.xE.AccentButtonText,[o.Yb.colorNeutralForegroundOnBrand]],[i.xE.ActionLink,[o.Yb.colorNeutralForeground1]],[i.xE.ActionLinkHovered,[o.Yb.colorNeutralForeground1Hover]],[i.xE.BodyBackground,[o.Yb.colorNeutralBackground1]],[i.xE.BodyBackgroundChecked,[o.Yb.colorNeutralBackground1Selected]],[i.xE.BodyBackgroundHovered,[o.Yb.colorNeutralBackground1Hover]],[i.xE.BodyDivider,[o.Yb.colorNeutralStroke2]],[i.xE.BodyFrameBackground,[o.Yb.colorNeutralBackground1]],[i.xE.BodyFrameDivider,[o.Yb.colorNeutralStroke2]],[i.xE.BodyStandoutBackground,[o.Yb.colorNeutralBackground2]],[i.xE.BodySubtext,[o.Yb.colorNeutralForeground3]],[i.xE.BodyText,[o.Yb.colorNeutralForeground1]],[i.xE.BodyTextChecked,[o.Yb.colorNeutralForeground1Selected]],[i.xE.ButtonBackground,[o.Yb.colorNeutralBackground1]],[i.xE.ButtonBackgroundChecked,[o.Yb.colorNeutralBackground1Selected]],[i.xE.ButtonBackgroundCheckedHovered,[o.Yb.colorNeutralBackground1Hover]],[i.xE.ButtonBackgroundDisabled,[o.Yb.colorNeutralBackgroundDisabled]],[i.xE.ButtonBackgroundHovered,[o.Yb.colorNeutralBackground1Hover]],[i.xE.ButtonBackgroundPressed,[o.Yb.colorNeutralBackground1Pressed]],[i.xE.ButtonBorder,[o.Yb.colorNeutralStroke1]],[i.xE.ButtonBorderDisabled,[o.Yb.colorNeutralStrokeDisabled]],[i.xE.ButtonText,[o.Yb.colorNeutralForeground1]],[i.xE.ButtonTextChecked,[o.Yb.colorNeutralForeground1]],[i.xE.ButtonTextCheckedHovered,[o.Yb.colorNeutralForeground1]],[i.xE.ButtonTextDisabled,[o.Yb.colorNeutralForegroundDisabled]],[i.xE.ButtonTextHovered,[o.Yb.colorNeutralForeground1]],[i.xE.ButtonTextPressed,[o.Yb.colorNeutralForeground1]],[i.xE.CardStandoutBackground,[o.Yb.colorNeutralBackground1]],[i.xE.DefaultStateBackground,[o.Yb.colorNeutralBackground2]],[i.xE.DisabledBackground,[o.Yb.colorNeutralBackgroundDisabled]],[i.xE.DisabledBodySubtext,[o.Yb.colorNeutralForegroundDisabled]],[i.xE.DisabledBodySubtext,[o.Yb.colorNeutralForegroundDisabled]],[i.xE.DisabledBorder,[o.Yb.colorNeutralStrokeDisabled]],[i.xE.DisabledSubtext,[o.Yb.colorNeutralForegroundDisabled]],[i.xE.DisabledText,[o.Yb.colorNeutralForegroundDisabled]],[i.xE.FocusBorder,[o.Yb.colorStrokeFocus2]],[i.xE.InputBackground,[o.Yb.colorNeutralBackground1]],[i.xE.InputBackgroundChecked,[o.Yb.colorCompoundBrandBackground]],[i.xE.InputBackgroundCheckedHovered,[o.Yb.colorCompoundBrandBackgroundHover]],[i.xE.InputBorder,[o.Yb.colorNeutralStrokeAccessible]],[i.xE.InputBorderHovered,[o.Yb.colorNeutralStrokeAccessibleHover]],[i.xE.InputFocusBorderAlt,[o.Yb.colorCompoundBrandStroke]],[i.xE.InputForegroundChecked,[o.Yb.colorNeutralForegroundOnBrand]],[i.xE.InputIcon,[o.Yb.colorNeutralForeground3]],[i.xE.InputIconDisabled,[o.Yb.colorNeutralForegroundDisabled]],[i.xE.InputIconHovered,[o.Yb.colorNeutralForeground3]],[i.xE.InputPlaceholderBackgroundChecked,[o.Yb.colorBrandBackgroundInvertedSelected]],[i.xE.InputPlaceholderText,[o.Yb.colorNeutralForeground4]],[i.xE.InputText,[o.Yb.colorNeutralForeground1]],[i.xE.InputTextHovered,[o.Yb.colorNeutralForeground1Hover]],[i.xE.Link,[o.Yb.colorBrandForegroundLink]],[i.xE.LinkHovered,[o.Yb.colorBrandForegroundLinkHover]],[i.xE.ListBackground,[o.Yb.colorNeutralBackground1]],[i.xE.ListHeaderBackgroundHovered,[o.Yb.colorNeutralBackground1Hover]],[i.xE.ListHeaderBackgroundPressed,[o.Yb.colorNeutralBackground1Pressed]],[i.xE.ListItemBackgroundChecked,[o.Yb.colorNeutralBackground1Selected]],[i.xE.ListItemBackgroundCheckedHovered,[o.Yb.colorNeutralBackground1Selected]],[i.xE.ListItemBackgroundHovered,[o.Yb.colorNeutralBackground1Hover]],[i.xE.ListText,[o.Yb.colorNeutralForeground1]],[i.xE.ListTextColor,[o.Yb.colorNeutralForeground1]],[i.xE.MenuBackground,[o.Yb.colorNeutralBackground1]],[i.xE.MenuDivider,[o.Yb.colorNeutralStroke2]],[i.xE.MenuHeader,[o.Yb.colorNeutralForeground3]],[i.xE.MenuIcon,[o.Yb.colorNeutralForeground1]],[i.xE.MenuItemBackgroundChecked,[o.Yb.colorNeutralBackground1]],[i.xE.MenuItemBackgroundHovered,[o.Yb.colorNeutralBackground1Hover]],[i.xE.MenuItemBackgroundPressed,[o.Yb.colorNeutralBackground1Hover]],[i.xE.MenuItemText,[o.Yb.colorNeutralForeground1]],[i.xE.MenuItemTextHovered,[o.Yb.colorNeutralForeground2Hover]],[i.xE.MessageLink,[o.Yb.colorBrandForegroundLink]],[i.xE.MessageLinkHovered,[o.Yb.colorBrandForegroundLinkHover]],[i.xE.MessageText,[o.Yb.colorNeutralForeground1]],[i.xE.PrimaryButtonBackground,[o.Yb.colorBrandBackground]],[i.xE.PrimaryButtonBackgroundDisabled,[o.Yb.colorNeutralBackgroundDisabled]],[i.xE.PrimaryButtonBackgroundHovered,[o.Yb.colorBrandBackgroundHover]],[i.xE.PrimaryButtonBackgroundPressed,[o.Yb.colorBrandBackgroundPressed]],[i.xE.PrimaryButtonBorder,[o.Yb.colorTransparentStroke]],[i.xE.PrimaryButtonText,[o.Yb.colorNeutralForegroundOnBrand]],[i.xE.PrimaryButtonTextDisabled,[o.Yb.colorNeutralForegroundDisabled]],[i.xE.PrimaryButtonTextHovered,[o.Yb.colorNeutralForegroundOnBrand]],[i.xE.PrimaryButtonTextPressed,[o.Yb.colorNeutralForegroundOnBrand]]]);function s(e){var t,r=[],o=(0,n.Z)(e);try{for(o.s();!(t=o.n()).done;){var i=t.value,s=void 0,c=void 0;Array.isArray(i)?(s=i[0],c=i[1]):(s=i.name,c=i.value),r.push({name:s,value:c});var u=a.get(s);if(u){var l,d=(0,n.Z)(u);try{var f=function(){var e=l.value;if(void 0===r.find((function(t){return t.name===e}))){var t={name:e,value:c};r.push(t)}};for(d.s();!(l=d.n()).done;)f()}catch(h){d.e(h)}finally{d.f()}}}}catch(h){o.e(h)}finally{o.f()}return r}},5442:function(e,t,r){"use strict";r.d(t,{X:function(){return a}});var n=r(29439),o=r(47699),i="--";function a(e){var t=[];e.black&&t.push([o.Yf.black,e.black]),e.white&&t.push([o.Yf.white,e.white]),e.greys&&t.push([o.Yf.neutralDark,e.greys[8]],[o.Yf.neutralPrimary,e.greys[14]],[o.Yf.neutralPrimaryAlt,e.greys[22]],[o.Yf.neutralSecondary,e.greys[36]],[o.Yf.neutralSecondaryAlt,e.greys[52]],[o.Yf.neutralTertiary,e.greys[62]],[o.Yf.neutralTertiaryAlt,e.greys[78]],[o.Yf.neutralQuaternary,e.greys[82]],[o.Yf.neutralQuaternaryAlt,e.greys[88]],[o.Yf.neutralLight,e.greys[92]],[o.Yf.neutralLighter,e.greys[96]],[o.Yf.neutralLighterAlt,e.greys[98]]),e.brandVariants&&t.push([o.Yf.themeDarker,e.brandVariants[40]],[o.Yf.themeDark,e.brandVariants[60]],[o.Yf.themeDarkAlt,e.brandVariants[70]],[o.Yf.themePrimary,e.brandVariants[80]],[o.Yf.themeSecondary,e.brandVariants[90]],[o.Yf.themeTertiary,e.brandVariants[120]],[o.Yf.themeLight,e.brandVariants[140]],[o.Yf.themeLighter,e.brandVariants[150]],[o.Yf.themeLighterAlt,e.brandVariants[160]]),Object.entries(e.fluentThemeV9).forEach((function(e){var r,o=(0,n.Z)(e,2),a=o[0],s=o[1],c=(r=a,"".concat(i).concat(r));t.push([c,s.toString()])}));for(var r=[],a=0,s=t;a<s.length;a++){var c=s[a];r.push({name:c[0],value:c[1]})}return r}},11447:function(e,t,r){"use strict";r.d(t,{AA:function(){return i},U8:function(){return a},yZ:function(){return s}});var n=r(29979),o="mip.getLabel",i="mip.setLabel";function a(e){return(0,n.L5)(o,!0,e)}function s(e){return(0,n.L5)(i,!1,e)}},40550:function(e,t,r){"use strict";r.d(t,{W:function(){return d}});var n=r(37762),o=r(74165),i=r(15861),a=r(15671),s=r(43144),c=r(47699),u=["#C239B3","#CA5010","#E3008C","#A4262C","#498205","#69797E","#881798","#D13438","#0078D4","#038387","#750B1C","#986F0B","#4F6BED","#8764B8","#0B6A0B","#7A7574","#5C2E91","#005B70","#8E562E"],l=["#DC8990","#DA846B","#ECC26E","#B5CC99","#78C9A0","#85ACB8","#7FA3D0","#CC87B1","#E47CA1","#BF9D8C"],d=function(){function e(t){var r,n=this;(0,a.Z)(this,e),this.theming=t,this.nextColorToAssignIndex=0,this.colorAssignmentInFlight=new Set,this.deferredColorAssignment={},this.assignedColors=new Map,this.colorPalette=u,this.disposable={get Disposable(){return this},dispose:function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.theming&&n.theming.off("themePropertiesChanged",n.themePropertiesChangedListener),n.colorAssignmentInFlight.clear(),n.assignedColors.clear();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},this.themePropertiesChangedListener=function(){var e=n.getColorPaletteForTheme();e!==n.colorPalette&&(n.colorPalette=e,n.assignedColors.clear(),n.nextColorToAssignIndex=0)},null===(r=this.theming)||void 0===r||r.on("themePropertiesChanged",this.themePropertiesChangedListener),this.colorPalette=this.getColorPaletteForTheme()}return(0,s.Z)(e,[{key:"PresenceColorProvider",get:function(){return this}},{key:"Disposable",get:function(){return this.disposable}},{key:"getColorPaletteForTheme",value:function(){var e,t,r;return(null!==(e=null===(t=this.theming)||void 0===t?void 0:t.themeName)&&void 0!==e?e:null===(r=this.theming)||void 0===r||null===(r=r.themeProperties)||void 0===r?void 0:r.get(c.qH.ThemeName))===c.Dc.Dark?l:u}},{key:"dispose",value:function(){this.Disposable.dispose().then((function(){})).catch((function(){}))}},{key:"getPresenceColorForUser",value:function(){var e=(0,i.Z)((0,o.Z)().mark((function e(t){var r,i,a,s,c=this;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.assignedColors.get(t))){e.next=3;break}return e.abrupt("return",Promise.resolve(r));case 3:if(!this.colorAssignmentInFlight.has(t)){e.next=5;break}return e.abrupt("return",new Promise((function(e){c.deferredColorAssignment[t].push(e)})));case 5:if(this.colorAssignmentInFlight.add(t),i=this.colorPalette[this.nextColorToAssignIndex],this.nextColorToAssignIndex=(this.nextColorToAssignIndex+1)%this.colorPalette.length,this.assignedColors.set(t,i),this.colorAssignmentInFlight.delete(t),void 0!==this.deferredColorAssignment[t]){a=(0,n.Z)(this.deferredColorAssignment[t]);try{for(a.s();!(s=a.n()).done;)(0,s.value)(i)}catch(o){a.e(o)}finally{a.f()}}return delete this.deferredColorAssignment[t],e.abrupt("return",Promise.resolve(i));case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}()},2770:function(e,t,r){"use strict";r.d(t,{B7:function(){return C},Dl:function(){return P},Hj:function(){return y},Lb:function(){return p},Mv:function(){return Z},Q5:function(){return b},Ql:function(){return o},SN:function(){return u},SZ:function(){return d},Td:function(){return S},U$:function(){return T},Uc:function(){return N},VT:function(){return s},YR:function(){return x},_l:function(){return a},bO:function(){return i},bw:function(){return v},bz:function(){return m},en:function(){return f},fs:function(){return k},ih:function(){return E},mI:function(){return n},mg:function(){return c},mu:function(){return w},nP:function(){return h},nZ:function(){return l},og:function(){return g}});var n="Card",o="Code",i="Date",a="Image",s="List",c="Person",u="RichText",l="Tabular",d="Task",f="URL",h="application/vnd.microsoft.card.adaptive",p="application/vnd.microsoft.card.hero",v="application/vnd.microsoft.card.thumbnail",g="application/vnd.microsoft.teams.card.o365connector",m="SignInCard",y="JITInstallCard",b="ErrorCard",k="Label",S="application/vnd.microsoft.activity.loginRequest",C="TokenProvider",w="SettingsProvider",x="CardChannelProvider",P="MetaOSProvider",E="UrlHandlerProvider",Z="LinkService",T="OptionalConnectedServicesPolicyProvider",N="OfficePolicyProvider"},15555:function(e,t,r){"use strict";var n;r.d(t,{F:function(){return n}}),function(e){e.themePropertiesChanged="themePropertiesChanged",e.textStylesChanged="textStylesChanged"}(n||(n={}))},93322:function(e,t,r){"use strict";var n;r.d(t,{X:function(){return n}}),function(e){e.fixedByHost="fixedByHost",e.grow="grow",e.growHeight="growHeight"}(n||(n={}))},10889:function(e,t,r){"use strict";var n,o;r.d(t,{_6:function(){return n},td:function(){return o}}),function(e){e.IframeLoadFailed="IframeLoadFailed",e.ContainerUpgradeRequired="ContainerUpgradeRequired",e.ComponentNotFound="ComponentNotFound"}(n||(n={})),function(e){e.RootComponentCreateFailed="RootComponentCreateFailed",e.RaasNotSupported="RaasNotSupported"}(o||(o={}));var i;!function(e){e.UndefinedInitializeIframeMethod="UndefinedInitializeIframeMethod"}(i||(i={}))},38546:function(e,t,r){"use strict";var n,o;r.d(t,{J:function(){return n},u:function(){return o}}),function(e){e.Generic="Generic",e.Error="Error",e.UserAction="UserAction",e.Activity="Activity"}(n||(n={})),function(e){e.Success="Success",e.Failure="Failure",e.Cancelled="Cancelled"}(o||(o={}))},30288:function(e,t,r){"use strict";r.d(t,{a:function(){return d}});var n=r(1413),o=r(4942),i=r(15671),a=r(43144),s=r(38546),c=r(92810),u=r(98846);var l=new Set;var d=function(){function e(t,r,n){var o;(0,i.Z)(this,e),this.activityName=t,this.logger=r,this.isAPerformanceMetric=!1,this.additionalPropsToLog=null===n||void 0===n?void 0:n.additionalPropsToLog,this.addUserTiming=null===n||void 0===n?void 0:n.addUserTiming,this.isAPerformanceMetric=(null===n||void 0===n?void 0:n.isAPerformanceMetric)||!1,this.logSubactivityStartTimes=null===(o=null===n||void 0===n?void 0:n.logSubactivityStartTimes)||void 0===o||o,this.subActivities={},this.identifier=(0,c.Z)(),this.activityStartName="".concat(this.activityName,"-start-").concat(this.identifier),this.activityEndName="".concat(this.activityName,"-end-").concat(this.identifier),this.addUserTiming&&performance.mark(this.activityStartName),this.startTime=performance.now(),this.startTimeSinceEpoch=Date.now()}return(0,a.Z)(e,[{key:"markSubActivityStart",value:function(e){this.subActivities[e]={startTime:performance.now(),startTimeSinceEpoch:Date.now()},this.addUserTiming&&performance.mark(this.getSubActivityName(e,"start"))}},{key:"markSubActivityEnd",value:function(e,t){var r=this.subActivities[e];if(r){if(this.addUserTiming){var i=this.getSubActivityName(e,"end");performance.mark(i),performance.measure(e,this.getSubActivityName(e,"start"),i)}var a=(0,o.Z)({},"durationMs_".concat(e),Math.round(performance.now()-r.startTime));this.logSubactivityStartTimes&&(a["startTime_".concat(e)]=r.startTimeSinceEpoch),this.additionalPropsToLog=(0,n.Z)((0,n.Z)((0,n.Z)({},a),this.additionalPropsToLog),t)}}},{key:"setResult",value:function(e,t,r,n){this.logActivityResult(e,t,r,null===n||void 0===n?void 0:n.skipLogging,void 0,null===n||void 0===n?void 0:n.sampleEvent)}},{key:"cancel",value:function(e,t,r){this.logActivityResult(e,t,r,!1,!0)}},{key:"addAdditionalProps",value:function(e){this.additionalPropsToLog=(0,n.Z)((0,n.Z)({},this.additionalPropsToLog),e)}},{key:"dispose",value:function(){this.cancel();var e=function(e){return performance.clearMarks(e)},t=function(e){return performance.clearMeasures(e)};if(this.addUserTiming)for(var r in e(this.activityStartName),e(this.activityEndName),this.cachedMeasureName&&t(this.cachedMeasureName),this.subActivities)e(this.getSubActivityName(r,"start")),e(this.getSubActivityName(r,"end")),t(r)}},{key:"logActivityResult",value:function(e,t,r,o,i,a){if(!this.hasAlreadyResolved){this.hasAlreadyResolved=!0,this.addUserTiming&&performance.mark(this.activityEndName);var c=performance.now(),d=Math.round(c-this.startTime);if(this.isAPerformanceMetric)(window._pageTimings||(window._pageTimings={}))[this.activityName]=d;if(this.logger&&!o){var f=(0,n.Z)((0,n.Z)({eventName:this.activityName,startTime:this.startTimeSinceEpoch,durationMs:d,succeeded:e,sampleEvent:a,resultType:i?s.u.Cancelled:e?s.u.Success:s.u.Failure},this.additionalPropsToLog),t);(0,u.t_)(this.logger,f,r)}this.logger=void 0,l.delete(this),this.addUserTiming&&performance.measure(this.generateMeasureName(e),this.activityStartName,this.activityEndName)}}},{key:"generateMeasureName",value:function(e){return this.cachedMeasureName="".concat(this.activityName).concat(!1===e?"-FAILED":"","-").concat(this.identifier),this.cachedMeasureName}},{key:"getSubActivityName",value:function(e,t){return"".concat(e,"-").concat(t,"-").concat(this.identifier)}}],[{key:"start",value:function(t,r,n){var o=new e(t,r,n);return l.add(o),o}}]),e}()},98846:function(e,t,r){"use strict";r.d(t,{t_:function(){return u},uX:function(){return c},ve:function(){return s},kZ:function(){return l}});var n=r(1413),o=r(38546);var i=["facetCodes","statusCode","innerMostErrorCode","sprequestguid"];function a(e){var t=/[A-Z0-9._%`'+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}/gi;return Object.getOwnPropertyNames(e).map((function(r){if(-1!==r.toLowerCase().indexOf("message")||-1!==r.toLowerCase().indexOf("error")||-1!==r.toLowerCase().indexOf("stack")||!1!==i.includes(r)){var n=e[r];if(void 0!==n&&"string"===typeof n)n=n.toString().replace(t,"scrubbed_email"),e[r]=n.toString().replace(/(https:\/\/)(\w)+(.sharepoint.com|-my.sharepoint.com)/,"(redacted)").replace(/(https:\/\/)(dev.loop.microsoft.com|df.loop.microsoft.com|loop.microsoft.com)(\/p\/)([a-zA-Z0-9%]+)/,"(redacted)")}})),e}function s(e,t){var r=a(t);e.send((0,n.Z)((0,n.Z)({},r),{},{category:o.J.Generic}))}function c(e,t,r){r&&d(t,r);var i=a(t);e.send((0,n.Z)((0,n.Z)({},i),{},{category:o.J.Error}))}new Set,new Set,new Map([["Automation",1],["SyntheticTraffic",1],["Local",1],["Staging",1],["Dogfood",.1],["Preview",.1],["Microsoft",.01],["Production",.001],["GCC",0],["GCC-High",0],["DoD",0]]);function u(e,t,r){r&&d(t,r),t.resultType||void 0===t.succeeded||(t.resultType=t.succeeded?o.u.Success:o.u.Failure);var i=a(t);e.send((0,n.Z)((0,n.Z)({},i),{},{category:o.J.Activity}))}function l(e,t){e.send((0,n.Z)((0,n.Z)({},t),{},{category:o.J.UserAction}))}function d(e,t){!function(e,t){var r,n="object"===typeof e&&null!==e;function o(t){if(n){var r=e[t];return"string"===typeof r?r:void 0}}t.errorMessage=null!==(r=o("message"))&&void 0!==r?r:String(e),t.errorName=o("name"),t.stack=o("stack"),t.errorType=o("errorType"),t.errorInstanceId=o("errorInstanceId"),i.forEach((function(r){var n=e[r];n&&(t[r]="object"===typeof n?JSON.stringify(n):n)}))}(t,e),e.message?e.message="".concat(e.message,"\n").concat(e.errorMessage):e.message=e.errorMessage,void 0===e.stack&&(e.stack=f())}function f(){var e=(new Error).stack;if(!e)try{throw new Error}catch(t){e=t.stack}return e}},28002:function(e,t,r){"use strict";r.d(t,{g:function(){return c}});var n=r(1413),o=r(74165),i=r(15861),a=r(15671),s=r(43144),c=function(){function e(t,r,s){var c=this;if((0,a.Z)(this,e),this.namespace=t,this.disposable={get Disposable(){return this},dispose:function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c.logger=null;case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},r instanceof e){var u=(0,n.Z)((0,n.Z)({},r.persistedProperties),s);this.logger=r.logger,this.persistedProperties=u}else this.logger=r,this.persistedProperties=s}return(0,s.Z)(e,[{key:"NamespaceLogger",get:function(){return this}},{key:"PersistedProperties",get:function(){return this}},{key:"Disposable",get:function(){return this.disposable}},{key:"addPersistedProperties",value:function(e){this.persistedProperties=(0,n.Z)((0,n.Z)({},this.persistedProperties),e)}},{key:"send",value:function(e){this.sendWithNamespace(e,this.namespace)}},{key:"sendWithNamespace",value:function(e,t){var r;null===(r=this.logger)||void 0===r||r.sendWithNamespace((0,n.Z)((0,n.Z)({},this.persistedProperties),e),t)}},{key:"dispose",value:function(){this.logger=null}}]),e}()},66051:function(e,t,r){"use strict";r.d(t,{r:function(){return o}});var n=r(96914);var o=function(e,t){var r=function(e){var t=null!==e&&"object"===typeof e?e:{value:e,tag:void 0},r=t.value,n=t.tag;switch(n){case void 0:case"PackageData":case"CodeArtifact":return r;case"UserData":return"REDACTED (tag: UserData)";default:return"REDACTED (tag: ".concat(n,")")}}(e);if(void 0!==r)return"string"===typeof r?(0,n.dt)(t,r):"number"===typeof r?(0,n.b_)(t,r):(0,n.UL)(t,r)}},59043:function(e,t,r){"use strict";r.d(t,{G:function(){return n}});function n(e){try{var t=new URL(e),r=t.searchParams.get("nav");if(!r)return e;var n=window.atob(r),o=new URLSearchParams(n),i=o.get("c");if((null===i||void 0===i||!i.includes("deepLinkInfo"))&&(null===i||void 0===i||!i.includes("minified")))return e;o.set("c","");var a=o.toString(),s=window.btoa(a);return t.searchParams.set("nav",s),t.toString()}catch(c){return e}}},75879:function(e,t,r){"use strict";r.d(t,{B:function(){return a}});var n,o=r(15671),i=r(43144),a=function(){function e(){var t=this;(0,o.Z)(this,e),this[n]="Deferred",this.isPending=!0,this.p=new Promise((function(e,r){t.res=e,t.rej=r}))}return(0,i.Z)(e,[{key:"then",value:function(e,t){return this.p.then(e,t)}},{key:"catch",value:function(e){return this.p.catch(e)}},{key:"resolve",value:function(e){this.isPending=!1,this.res(e)}},{key:"reject",value:function(e){this.isPending=!1,this.rej(e)}},{key:"pending",value:function(){return this.isPending}},{key:"finally",value:function(e){return this.p.finally(e)}}]),e}();n=Symbol.toStringTag},14034:function(e,t,r){"use strict";var n;r.d(t,{B3:function(){return i}}),function(e){e.genericError="genericError",e.throttlingError="throttlingError",e.dataCorruptionError="dataCorruptionError",e.dataProcessingError="dataProcessingError",e.usageError="usageError",e.clientSessionExpiredError="clientSessionExpiredError"}(n||(n={}));var o=r(10889);function i(e){if("object"===typeof e){var t=e;if(function(e){var t;return e.errorType===o._6.ContainerUpgradeRequired&&(null===(t=e.error)||void 0===t?void 0:t.name)===o._6.ContainerUpgradeRequired}(t))return o._6.ContainerUpgradeRequired;if(function(e){return e.errorType===n.genericError}(t))return n.genericError;if(function(e){return e.errorType===n.throttlingError}(t))return n.throttlingError;var r=function(e){return Object.values(o.td).find((function(t){return t===e.name||t===e.errorType}))}(t);if(r)return r}}},38020:function(e,t,r){"use strict";r.d(t,{hh:function(){return o}});var n=r(21850);function o(e){if("object"===typeof e){var t=e;if(function(e){return e.errorType===n.C.genericError}(t))return n.C.genericError;if(function(e){return e.errorType===n.C.fileNotFoundOrAccessDeniedError}(t))return n.C.fileNotFoundOrAccessDeniedError;if(function(e){return e.errorType===n.C.authorizationError}(t))return n.C.authorizationError;if(function(e){return e.errorType===n.C.throttlingError}(t))return n.C.throttlingError}}},17246:function(e,t,r){"use strict";r.d(t,{ep:function(){return i}});var n=r(20427),o=r(21850);function i(e){if("object"===typeof e){var t=e;if(function(e){return e.errorType===n.x.outOfStorageError}(t))return n.x.outOfStorageError;if(function(e){return e.errorType===n.x.invalidFileNameError}(t))return n.x.invalidFileNameError;if(function(e){return e.errorType===n.x.snapshotTooBig}(t))return n.x.snapshotTooBig;if(function(e){return e.errorType===n.x.fetchTimeout}(t))return n.x.fetchTimeout;if(function(e){return e.errorType===n.x.fluidNotEnabled}(t))return n.x.fluidNotEnabled;if(function(e){return e.errorType===o.C.fileOverwrittenInStorage}(t))return o.C.fileOverwrittenInStorage}}},81268:function(e,t,r){"use strict";r.d(t,{ds:function(){return o}});var n=r(10889);function o(e){if("object"===typeof e){var t=e;if(function(e){return e.name===n._6.IframeLoadFailed}(t))return n._6.IframeLoadFailed;if(function(e){return e.name===n._6.ComponentNotFound}(t))return n._6.ComponentNotFound}}},96701:function(e,t,r){"use strict";r.d(t,{m:function(){return c},g:function(){return s}});var n=r(1413),o=r(92810),i=r(4942);function a(e,t,r){e.headers instanceof Headers?e.headers.set(t,r):e.headers=(0,n.Z)((0,n.Z)({},e.headers),{},(0,i.Z)({},t,r))}var s="Bearer";function c(e,t,r,i){var s=!1,c=new URL(e);i.queryParam&&(c.searchParams.set(i.queryParam,r),(s=!i.doNotExceedQueryParamsLength||c.search.length<=i.doNotExceedQueryParamsLength)||c.searchParams.delete(i.queryParam));var u=t;if(!s){u=(0,n.Z)({},t);var l=!1,d=null!==t&&void 0!==t&&t.method?t.method.toUpperCase():"GET";if(i.preferAuthorizationInMultipartFormBody&&["GET","POST"].includes(d)){u.method="POST";var f=(0,o.Z)(),h=[];h.push("--".concat(f)),h.push("Authorization: ".concat(i.scheme," ").concat(r)),h.push("X-HTTP-Method-Override: ".concat(d)),h.push("_post: 1"),null!==t&&void 0!==t&&t.body&&h.push("\r\n".concat(t.body,"\r\n")),h.push("\r\n--".concat(f,"--"));var p=h.join("\r\n");(l=!i.doNotExceedMultipartFormBodyLength||p.length<=i.doNotExceedMultipartFormBodyLength)&&(u.body=p,a(u,"Content-Type","multipart/form-data;boundary=".concat(f)),c.searchParams.set("ump","1"))}l||(i.scheme?a(u,"Authorization","".concat(i.scheme," ").concat(r)):a(u,"Authorization",r))}return{url:c.href,request:u}}},97103:function(e,t,r){"use strict";r.d(t,{Qg:function(){return a},jR:function(){return i},py:function(){return o}});var n=r(99128);function o(e){return function(){return e}}function i(e){return function(t){return Math.pow(2,t)*e}}function a(e,t,r){return s(e,[],t,r)}function s(e,t,r,o){var i,a=[e(t.length).then((function(e){return i=e,!1}))];return o&&o.timeoutMs>0&&a.push((0,n.g)(o.timeoutMs).then((function(){return!0}))),Promise.race(a).then((function(a){return a&&(i=o.onTimeout()),null===r||void 0===r||!r.filter(i)||t.length>=r.maxRetries?{result:i,tries:t}:(0,n.g)(r.backoffFn(t.length,i)).then((function(){return t.push(i),s(e,t,r,o)}))}))}},12338:function(e,t,r){"use strict";r.d(t,{h:function(){return v},Y:function(){return g}});var n=r(74165),o=r(1413),i=r(15861),a=r(96701),s=r(66773),c=r(16757);function u(e){var t=e.get("www-authenticate");if(t){var r,n=!1;return t.split(",").map((function(e){var t=e.split("=");if(t.length>=2)if(n||"error"!==t[0].trim().toLowerCase()){if(!r&&"claims"===t[0].trim().toLowerCase()){var o=(0,c.C)(e.substring(e.indexOf("=")+1).trim());o&&(r=atob(o))}}else n="insufficient_claims"===(0,c.C)(t[1].trim().toLowerCase())})),n?r:void 0}}var l=r(37762);function d(e){var t=e.get("www-authenticate");if(t){var r,n,o=!1,i=(0,l.Z)(t.split(","));try{for(i.s();!(n=i.n()).done;){var a=n.value.split("=");a.length>=2&&(o||"error"!==a[0].trim().toLowerCase()?void 0===r&&"error_description"===a[0].trim().toLowerCase()&&(r=(0,c.C)(a[1].trim())):o="invalid_token"===(0,c.C)(a[1].trim().toLowerCase()))}}catch(s){i.e(s)}finally{i.f()}return o?{errorDescription:r}:void 0}}var f=r(45782),h=r(98846),p={scheme:a.g};function v(e){var t;return e.tenantId&&(t={tenantId:e.tenantId}),y(e,t)}function g(e){var t;return e.tenantId&&(t={tenantId:e.tenantId}),y(e,t)}var m=3;function y(e,t){return b.apply(this,arguments)}function b(){return b=(0,i.Z)((0,n.Z)().mark((function e(t,r){var i,c,l,h,v,g,b,S,C,w,x,P,E,Z,T,N,F,I,B,D,A,O,L=arguments;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h=L.length>2&&void 0!==L[2]?L[2]:1,v=null!==(i=null===(c=t.retryPolicy)||void 0===c?void 0:c.maxAuthRetries)&&void 0!==i?i:m,e.next=4,t.getToken(r);case 4:if(g=e.sent.token,b=t.url,S=t.requestInit,C=t.retryPolicy,w=t.timeoutMs,x=null!==(l=t.tokenPolicy)&&void 0!==l?l:p,P=(0,a.m)(b,S,g,x),E=P.url,Z=P.request,T=function(e){return 401===e.status&&u(e.headers)||void 0},N=function(e){return 401===e.status&&void 0!==d(e.headers)||void 0},F=function(e){if(401===e.status){var t=(0,f.r)(e.headers);if(t&&t!==(null===r||void 0===r?void 0:r.tenantId))return t}},C&&(I=(0,o.Z)((0,o.Z)({},C),{},{filter:function(e){return!T(e)&&!N(e)&&!F(e)&&C.filter(e)}})),!("logger"in t)||!("nameForLogging"in t)){e.next=18;break}return e.next=15,(0,s.tj)(E,Z,t.nameForLogging,t.logger,t.doNotLogOnSuccess,I,w,t.getAdditionalProps);case 15:e.t0=e.sent,e.next=21;break;case 18:return e.next=20,(0,s.q4)(E,Z,I,w);case 20:e.t0=e.sent;case 21:if(B=e.t0,!(h<=v)){e.next=35;break}if(D=h===v,!(A=T(B.result))){e.next=28;break}return k(t,"InsufficientClaims",h,D),e.abrupt("return",y(t,(0,o.Z)((0,o.Z)({},r),{},{claims:A}),h+1));case 28:if(!N(B.result)){e.next=31;break}return k(t,"InvalidToken",h,D),e.abrupt("return",y(t,(0,o.Z)((0,o.Z)({},r),{},{forceRefresh:!0}),h+1));case 31:if(!(O=F(B.result))){e.next=35;break}return k(t,"SpecificTenant",h,D),e.abrupt("return",y(t,(0,o.Z)((0,o.Z)({},r),{},{tenantId:O}),h+1));case 35:return e.abrupt("return",B);case 36:case"end":return e.stop()}}),e)}))),b.apply(this,arguments)}function k(e,t,r,n){"logger"in e&&"nameForLogging"in e&&(0,h.ve)(e.logger,{eventName:"Retry".concat(e.nameForLogging,"OnAuthError"),subCategory:t,attempt:r,isFinalAttempt:n})}},99128:function(e,t,r){"use strict";r.d(t,{g:function(){return o},s:function(){return i}});var n=r(93433);function o(e){return new Promise((function(t){return setTimeout((function(){return t()}),e)}))}function i(e,t){var r=o(e).then((function(e){return!0})),i=t.map((function(e){return e.then((function(e){return!1})).catch((function(e){return!1}))}));return Promise.race([r].concat((0,n.Z)(i)))}},66773:function(e,t,r){"use strict";r.d(t,{mE:function(){return l},q4:function(){return d},tj:function(){return f}});var n=r(74165),o=r(15861),i=r(1413),a=r(98846),s=r(97103),c=709,u=710;function l(e){return function(t){return t&&e.includes(t.status)}}function d(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=r;return null!==r&&void 0!==r&&r.respectRetryAfterHeader&&((o=(0,i.Z)({},r)).backoffFn=function(e,t){if(429===t.status||503===t.status){var n=t.headers.get("Retry-After");if(n){var o=parseInt(n,10);if(!isNaN(o))return 1e3*o}}return r.backoffFn(e,t)}),(0,s.Qg)((function(){var r=performance.now();return fetch(e,t).then((function(e){var t=e;return t.durationMs=Math.round(performance.now()-r),t})).catch((function(e){if(function(e,t){return e===(null===t||void 0===t?void 0:t.reason)||"object"===typeof e&&null!==e&&("AbortError"===e.name||20===e.code)}(e,null===t||void 0===t?void 0:t.signal))throw e;var n="Error does not provide a message";return e.name&&e.message?n="Error type: ".concat(e.name,", ").concat(e.message):e.name?n="Error type: ".concat(e.name):e.message&&(n="Error message: ".concat(e.message)),{status:window.navigator.onLine?u:c,ok:!1,durationMs:Math.round(performance.now()-r),statusText:n}}))}),o,{timeoutMs:n,onTimeout:function(){return{status:707,ok:!1,durationMs:n}}})}function f(e,t,r,n,o,i){var a=arguments.length>7?arguments[7]:void 0;return d(e,t,i,arguments.length>6&&void 0!==arguments[6]?arguments[6]:0).then((function(e){return n&&r?((!o&&e.result.ok||!e.result.ok)&&h(r,!0,e.result,e.tries.length+1,n,a),e.tries.forEach((function(e,t){h(r,!1,e,t+1,n,a)})),e):e}))}function h(e,t,r,n,o,i){return p.apply(this,arguments)}function p(){return(p=(0,o.Z)((0,n.Z)().mark((function e(t,r,o,s,c,u){var l,d;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=u,!e.t0){e.next=5;break}return e.next=4,u(o,r);case 4:e.t0=e.sent;case 5:d=e.t0,(0,a.ve)(c,(0,i.Z)({subCategory:"Request",eventName:t,isFinalAttempt:r,status:o.status,durationMs:o.durationMs,size:(null===(l=o.headers)||void 0===l?void 0:l.get("Content-Length"))||-1,attempt:s},d));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},17736:function(e,t,r){"use strict";r.d(t,{I:function(){return o}});var n=[{headerName:"sprequestguid",logName:"spRequestGuid"},{headerName:"request-id",logName:"requestId"},{headerName:"client-request-id",logName:"clientRequestId"},{headerName:"x-msedge-ref",logName:"xMsedgeRef"}];function o(e){var t={};return null!==e&&void 0!==e&&e.headers&&n.forEach((function(r){var n=e.headers.get(r.headerName);n&&(t[r.logName]=n)})),t}},45782:function(e,t,r){"use strict";r.d(t,{r:function(){return o}});var n=r(96701);function o(e){var t=e.get("www-authenticate");if(t){var r,o=t.indexOf(n.g);if(!(o<0))return t.substring(o+n.g.length).split(",").map((function(e){if(!r){var t=e.split("=");t.length>=2&&"realm"===t[0].trim().toLowerCase()&&(r=JSON.parse(t[1].trim()))}})),r}}},26982:function(e,t,r){"use strict";r.d(t,{Kj:function(){return h},O6:function(){return l},Xo:function(){return d}});var n=r(74165),o=r(1413),i=r(15861),a=r(66773),s=r(97103),c=r(12338),u=r(17736),l={respectRetryAfterHeader:!0,maxRetries:3,filter:(0,a.mE)([429,503]),backoffFn:(0,s.jR)(100)};function d(e,t,r,n,o,i,a){return f.apply(this,arguments)}function f(){return f=(0,i.Z)((0,n.Z)().mark((function e(t,r,a,s,l,d,f){var h,p,v,g,m,y=arguments;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h=y.length>7&&void 0!==y[7]?y[7]:0,p=y.length>8?y[8]:void 0,v=r.startsWith("http")?r:"https://graph.microsoft.com/v1.0/".concat(r),g={getToken:t,url:v,tenantId:l,requestInit:d,retryPolicy:f,timeoutMs:h},m=s&&a?(0,c.Y)((0,o.Z)((0,o.Z)({},g),{},{logger:s,nameForLogging:a,doNotLogOnSuccess:p,getAdditionalProps:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.I)(t));case 1:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()})):(0,c.h)(g),e.next=7,m;case 7:return e.abrupt("return",e.sent.result);case 8:case"end":return e.stop()}}),e)}))),f.apply(this,arguments)}function h(e,t){var r=new Map;return function(){var n=t.apply(void 0,arguments),o=r.get(n);if(o)return o.then();var i=e.apply(void 0,arguments);return r.set(n,i),i.then((function(e){return"number"===typeof e&&200!==e&&404!==e&&r.delete(n),e}),(function(e){throw r.delete(n),e}))}}},834:function(e,t,r){"use strict";r.d(t,{al:function(){return i},jR:function(){return s}});var n={afZa:"af-za",amEt:"am-et",arSa:"ar-sa",asIn:"as-in",azLatnAz:"az-latn-az",bgBg:"bg-bg",bnIn:"bn-in",bsLatnBa:"bs-latn-ba",caEs:"ca-es",caEsValencia:"ca-es-valencia",csCz:"cs-cz",cyGb:"cy-gb",daDk:"da-dk",deDe:"de-de",elGr:"el-gr",enGb:"en-gb",enUs:"en-us",esEs:"es-es",esMx:"es-mx",etEe:"et-ee",euEs:"eu-es",faIr:"fa-ir",fiFi:"fi-fi",filPh:"fil-ph",frCa:"fr-ca",frFr:"fr-fr",gaIe:"ga-ie",gdGb:"gd-gb",glEs:"gl-es",guIn:"gu-in",heIl:"he-il",hiIn:"hi-in",hrHr:"hr-hr",huHu:"hu-hu",hyAm:"hy-am",idId:"id-id",isIs:"is-is",itIt:"it-it",jaJp:"ja-jp",kaGe:"ka-ge",kkKz:"kk-kz",kmKh:"km-kh",knIn:"kn-in",kokIn:"kok-in",koKr:"ko-kr",lbLu:"lb-lu",loLa:"lo-la",ltLt:"lt-lt",lvLv:"lv-lv",miNz:"mi-nz",mkMk:"mk-mk",mlIn:"ml-in",mrIn:"mr-in",msMy:"ms-my",mtMt:"mt-mt",nbNo:"nb-no",neNp:"ne-np",nlNl:"nl-nl",nnNo:"nn-no",orIn:"or-in",paIn:"pa-in",plPl:"pl-pl",ptBr:"pt-br",ptPt:"pt-pt",quzPe:"quz-pe",roRo:"ro-ro",ruRu:"ru-ru",skSk:"sk-sk",slSi:"sl-si",sqAl:"sq-al",srCyrlBa:"sr-cyrl-ba",srCyrlRs:"sr-cyrl-rs",srLatnRs:"sr-latn-rs",svSe:"sv-se",taIn:"ta-in",teIn:"te-in",thTh:"th-th",trTr:"tr-tr",ttRu:"tt-ru",ugCn:"ug-cn",ukUa:"uk-ua",urPk:"ur-pk",viVn:"vi-vn",zhCn:"zh-cn",zhTw:"zh-tw"},o={af:n.afZa,am:n.amEt,ar:n.arSa,as:n.asIn,az:n.azLatnAz,bg:n.bgBg,bn:n.enGb,bs:n.bsLatnBa,"bs-cyrl-ba":n.enGb,ca:n.caEs,cs:n.csCz,cy:n.cyGb,da:n.daDk,de:n.deDe,el:n.elGr,"el-cy":n.enGb,en:n.enUs,es:n.esEs,et:n.etEe,eu:n.euEs,fa:n.faIr,fi:n.fiFi,fil:n.filPh,fr:n.frFr,ga:n.gaIe,gd:n.gdGb,gl:n.glEs,gu:n.guIn,he:n.heIl,hi:n.hiIn,hr:n.hrHr,hu:n.huHu,hy:n.hyAm,id:n.idId,is:n.isIs,it:n.itIt,iw:n.heIl,"iw-il":n.heIl,ja:n.jaJp,ka:n.kaGe,kk:n.kkKz,km:n.kmKh,kn:n.knIn,ko:n.koKr,kok:n.kokIn,lb:n.lbLu,lo:n.loLa,lt:n.ltLt,lv:n.lvLv,mi:n.miNz,mk:n.mkMk,ml:n.mlIn,mr:n.mrIn,ms:n.msMy,mt:n.mtMt,nb:n.nbNo,ne:n.neNp,nl:n.nlNl,nn:n.nnNo,or:n.orIn,pa:n.paIn,pl:n.plPl,pt:n.ptBr,quz:n.quzPe,ro:n.roRo,ru:n.ruRu,sk:n.skSk,sl:n.slSi,sq:n.sqAl,sv:n.svSe,ta:n.taIn,te:n.teIn,th:n.thTh,tr:n.trTr,"tr-cy":n.enGb,tt:n.ttRu,ug:n.ugCn,uk:n.ukUa,ur:n.urPk,uz:n.enUs,vi:n.viVn,zh:n.enUs,"zh-hans-tw":n.zhTw},i=n.enUs,a=/^([^-]+)-.+/;function s(e){if(void 0===e||null===e)return i;var t=e.toLowerCase();if(Object.values(n).includes(t))return t;var r=o[t];if(void 0!==r)return r;var s=function(e){var t=a.exec(e.trim().toLowerCase());if(null!==t&&t.length>1)return t[1];return}(t);if(void 0!==s){var c=o[s];if(void 0!==c)return c}return i}},75458:function(e,t,r){"use strict";function n(e,t,r){return r||(t||i(e))}function o(e){return i(e)}function i(e){switch(e){case"ar-sa":case"fa-ir":case"he-il":case"ug-cn":case"ur-pk":return"rtl";default:return"ltr"}}r.d(t,{e:function(){return o},t:function(){return n}})},16757:function(e,t,r){"use strict";r.d(t,{C:function(){return o}});var n=r(98846);function o(e,t,r){try{return JSON.parse(e,t)}catch(o){return void(r&&(0,n.uX)(r.logger,r.event,o))}}},98245:function(e,t,r){"use strict";r.d(t,{F:function(){return s}});var n=r(93433),o=[],i=!1,a=!1;function s(e,t){o.push({ensureExecution:!0===(null===t||void 0===t?void 0:t.ensureExecution),task:e}),null!==t&&void 0!==t&&t.ensureExecution&&!a&&(document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&u((function(e){return e.ensureExecution}))})),a=!0),c()}function c(){if(!i){if(window.requestIdleCallback)window.requestIdleCallback(l);else{var e=Date.now()+50;window.setTimeout((function(){return l({timeRemaining:function(){return Math.max(e-Date.now(),0)},didTimeout:!1})}),0)}i=!0}}function u(e,t){for(var r=[],i=0;i<o.length;i+=1){if(t&&!t()){r.push.apply(r,(0,n.Z)(o.slice(i)));break}var a=o[i];e&&!e(a)?r.push(a):a.task()}o=r}function l(e){u(void 0,(function(){return e.timeRemaining()>10})),i=!1,o.length>0&&c()}},29979:function(e,t,r){"use strict";r.d(t,{L5:function(){return d},B$:function(){return n}});var n,o=r(16757),i=r(72633),a=r(62274),s=new Map;function c(e,t){var r=function(e,t){var r,n,o,c=s.get(e);if(void 0!==c)return c;o=void 0!==(r=function(e){var t=a.S.get(e);return u(t)}(e))?r:void 0!==(n=function(e){var t,r=null===(t=(0,i.E)())||void 0===t?void 0:t.getItem(e);return u(r)}(e))?n:t;return s.set(e,o),o}(e,t);return r}function u(e){if(null!==e&&void 0!==e){var t=(0,o.C)(e),r=void 0!==t?t:e;return"on"===r||"off"===r?"on"===r:r}}function l(e,t,r,n){return r?r.getSetting(e,t,n):c(e,t)}function d(e,t,r){return l(e,t,r,"FluidExperiences")}},72633:function(e,t,r){"use strict";var n,o;r.d(t,{E:function(){return i}});try{n=localStorage}catch(a){}n||(n=void 0);try{o=sessionStorage}catch(s){}function i(){return n}o||(o=void 0)},62274:function(e,t,r){"use strict";r.d(t,{S:function(){return n}});var n=new URLSearchParams("undefined"!==typeof location?location.search:"")},21850:function(e,t,r){"use strict";var n;r.d(t,{C:function(){return n}}),function(e){e.genericError="genericError",e.genericNetworkError="genericNetworkError",e.authorizationError="authorizationError",e.fileNotFoundOrAccessDeniedError="fileNotFoundOrAccessDeniedError",e.throttlingError="throttlingError",e.offlineError="offlineError",e.unsupportedClientProtocolVersion="unsupportedClientProtocolVersion",e.writeError="writeError",e.fetchFailure="fetchFailure",e.fetchTokenError="fetchTokenError",e.incorrectServerResponse="incorrectServerResponse",e.fileOverwrittenInStorage="fileOverwrittenInStorage",e.deltaStreamConnectionForbidden="deltaStreamConnectionForbidden",e.locationRedirection="locationRedirection",e.fluidInvalidSchema="fluidInvalidSchema",e.usageError="usageError",e.fileIsLocked="fileIsLocked"}(n||(n={}))},84456:function(e,t,r){"use strict";r.d(t,{Ey:function(){return s},j1:function(){return c},j3:function(){return d},rl:function(){return u}});var n=r(74165),o=r(15861),i=r(15671),a=r(43144),s="@fluidx/video-playback",c="@fluidx/video-playback-extended",u="@fluidx/video-notes-msa",l=function(){function e(){(0,i.Z)(this,e)}return(0,a.Z)(e,[{key:"canLoad",value:function(e){var t=e.packageName;return t===s||t===u||t===c}},{key:"load",value:function(){var e=(0,o.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canLoad(t)){e.next=2;break}throw new Error("Incompatible loop code details.");case 2:return e.abrupt("return",Promise.all([r.e(3711),r.e(8507),r.e(4164),r.e(5262),r.e(1657),r.e(3984),r.e(5480)]).then(r.bind(r,39281)).then((function(e){return{module:e,details:t}})));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),d={instantiateLoopCodeLoader:function(e){return Promise.resolve(new l)}}},7429:function(e,t,r){"use strict";r.d(t,{Vw:function(){return h},cS:function(){return l},cl:function(){return y},fU:function(){return p},gV:function(){return v},n5:function(){return d},oe:function(){return f},t4:function(){return c},z_:function(){return g}});var n=r(96914);function o(e,t){return e?e+"."+t:t}function i(e,t,r,i,a){void 0===a&&(a=4),i&&e.push((0,n.dt)("".concat(o(t,r)),i,a))}function a(e,t,r,i){"boolean"===typeof i&&e.push((0,n.UL)("".concat(o(t,r)),i))}function s(e,t,r,i){"number"===typeof i&&e.push((0,n.Kq)("".concat(o(t,r)),i))}var c,u=function(e){var t="Activity.Result",r=[];return s(r,t,"Code",e.code),i(r,t,"Type",e.type),s(r,t,"Tag",e.tag),a(r,t,"IsExpected",e.isExpected),r.push((0,n.dt)("zC.Activity.Result","Office.System.Result")),r},l={contractName:"Office.System.Activity",getFields:function(e){var t="Activity",r=[];return i(r,t,"CV",e.cV),s(r,t,"Duration",e.duration),s(r,t,"Count",e.count),s(r,t,"AggMode",e.aggMode),a(r,t,"Success",e.success),e.result&&r.push.apply(r,u(e.result)),r.push((0,n.dt)("zC.Activity",this.contractName)),r}},d={getFields:function(e){var t="User",r=[];return i(r,t,"PrimaryIdentityHash",e.primaryIdentityHash),i(r,t,"PrimaryIdentitySpace",e.primaryIdentitySpace),i(r,t,"TenantId",e.tenantId,1),i(r,t,"TenantGroup",e.tenantGroup,1),a(r,t,"IsAnonymous",e.isAnonymous),a(r,t,"IsSignedIn",e.isSignedIn),r}},f={getFields:function(e,t){var r=[];return i(r,e,"Name",t.name),i(r,e,"State",t.state),r}},h={getFields:function(e){var t="UserAction",r=[];return s(r,t,"Id",e.id),i(r,t,"Name",e.name),i(r,t,"CommandSurface",e.commandSurface),i(r,t,"ParentName",e.parentName),i(r,t,"TriggerMethod",e.triggerMethod),s(r,t,"TimeOffsetMs",e.timeOffsetMs),r}};!function(e){e.Web="Web",e.Desktop="Desktop",e.Universal="Universal",e.Mobile="Mobile",e.Win32="Win32",e.iOS="iOS",e.Android="Android"}(c||(c={}));var p,v={getFields:function(e){var t="App",r=[];return i(r,t,"Name",e.name,1),i(r,t,"Platform",e.platform,1),i(r,t,"Version",e.version,1),r}},g={getFields:function(e){var t="Session",r=[];return i(r,t,"Id",e.id,1),i(r,t,"EcsETag",e.ecsETag,1),r}};!function(e){e.Automation="Automation",e.Dogfood="Dogfood",e.Microsoft="Microsoft",e.Insiders="Insiders",e.Production="Production"}(p||(p={}));var m,y={getFields:function(e){var t=[];return i(t,"Release","AudienceGroup",e.audienceGroup,1),t}};!function(e){var t="Copilot";!function(e){e.IsEnabled="IsEnabled",e.IsSeen="IsSeen",e.IsTried="IsTried",e.IsKept="IsKept",e.IsRejected="IsRejected"}(e.FeatureActionType||(e.FeatureActionType={})),function(e){e.ContentGeneration="Content Generation",e.Commanding="Commanding",e.QAandSummaries="QA and Summaries",e.Collaboration="Collaboration",e.Suggestions="Suggestions"}(e.Capability||(e.Capability={})),e.getFields=function(e){var r=[];return void 0!==e.featureActionType&&r.push((0,n.dt)("".concat(t,".FeatureActionType"),e.featureActionType)),void 0!==e.isUserInitiated&&r.push((0,n.UL)("".concat(t,".IsUserInitiated"),e.isUserInitiated)),void 0!==e.featureName&&r.push((0,n.dt)("".concat(t,".FeatureName"),e.featureName)),void 0!==e.capability&&r.push((0,n.dt)("".concat(t,".Capability"),e.capability)),void 0!==e.isThumbsUp&&r.push((0,n.UL)("".concat(t,".IsThumbsUp"),e.isThumbsUp)),r.push((0,n.dt)("zC.".concat(t),"Office.System.Copilot")),r}}(m||(m={}))},96914:function(e,t,r){"use strict";function n(e,t,r){return s(e,1,t,r)}function o(e,t,r){return s(e,2,t,r)}function i(e,t,r){return s(e,3,t,r)}function a(e,t,r){return s(e,0,t,r)}function s(e,t,r,n){return{name:e,dataType:t,value:r,classification:n||4}}r.d(t,{Kq:function(){return o},UL:function(){return n},b_:function(){return i},dt:function(){return a}})},82732:function(e,t,r){"use strict";r.d(t,{H:function(){return a},kr:function(){return o},uf:function(){return i}});var n=function(){var e=[];return{fireEvent:function(t){e.forEach((function(e){return e(t)}))},addListener:function(t){t&&e.push(t)}}}();function o(){return n}function i(e,t,r){n.fireEvent({level:e,category:t,message:r})}function a(e,t,r){i(0,e,(function(){var e=r instanceof Error?r.message:"";return"".concat(t,": ").concat(e)}))}},27188:function(e,t,r){"use strict";r.d(t,{Dw:function(){return b},Vp:function(){return m},vE:function(){return y}});var n=r(75971),o=r(82732),i={};function a(e,t){"Office."===e.substring(0,7)&&"."!==e[e.length-1]?i[e]?(t.ariaTenantToken&&(i[e].ariaTenantToken=t.ariaTenantToken),t.dnmToken&&(i[e].dnmToken=t.dnmToken)):i[e]=t:(0,o.uf)(0,0,(function(){return"Namespace: ".concat(e)}))}function s(e,t){for(var r=e.length;r>0;){var n=e.substr(0,r);if(i[n]){var o=i[n];return t.ariaTenantToken=o.ariaTenantToken,t.dnmToken=o.dnmToken,!0}r=e.lastIndexOf(".",r-1)}return!1}var c=9007199254740991,u=-c,l=98,d=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,f=/^[a-zA-Z0-9_\.]{1,95}$/;function h(e){if(!function(e){if(!e||e.length>l)return!1;return d.test(e)}(e.eventName))throw new Error("Invalid eventName");var t=e.eventContract;if(t){if(t.name&&!p(t.name))throw new Error("Invalid eventContract");v(t.dataFields)}v(e.dataFields)}function p(e){return f.test(e)}function v(e){e&&e.forEach((function(e){if("string"!==typeof e.name||!p(e.name))throw new Error("Invalid dataField name");2===e.dataType&&function(e){if("number"!==typeof e||!isFinite(e)||Math.floor(e)!==e||e<u||e>c)throw new Error("Invalid integer ".concat(JSON.stringify(e)))}(e.value)}))}var g=r(96914),m=-1;function y(e){var t={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?(0,n.__assign)({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp||(new Date).getTime()};return e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t}var b=function(){function e(e,t,r){var o,i,a;this.telemetrySinks=[],this.persistentDataFields=[],this.partAFields=[],this.eventQueue=[],this.config=r||{},e&&(this.telemetrySinks=e.telemetrySinks,(o=this.persistentDataFields).push.apply(o,e.persistentDataFields),this.config=(0,n.__assign)((0,n.__assign)({},e.getConfig()),this.config),(i=this.partAFields).push.apply(i,e.partAFields)),t&&(a=this.persistentDataFields).push.apply(a,t)}return e.prototype.addEventContentType=function(e,t){e.push((0,g.Kq)("EventContent.Type",t))},e.prototype.sendTelemetryEvent=function(e){var t=y(e),r=t.telemetryProperties;r.nexusTenantToken=m;var n=r.ariaTenantToken;if(!n&&(!s(t.eventName,r)&&!n))return void(0,o.uf)(0,0,(function(){return"No tenant token: "+e.eventName}));this.sendTelemetryEventInternal(t,1)},e.prototype.sendCustomerContent=function(e){var t=y(e),r=t.telemetryProperties,n=r.customerContentVersion;return(!n||n>2)&&(r.customerContentVersion=2),r.ariaTenantToken=void 0,r.nexusTenantToken=void 0,r.dnmToken=void 0,this.addEventContentType(t.dataFields,2),this.sendTelemetryEventInternal(t,2)},e.prototype.sendDirectNumericEvent=function(e){var t=y(e),r=t.telemetryProperties;if(!r.dnmToken&&(!s(t.eventName,r)&&!r.dnmToken))return void(0,o.uf)(0,0,(function(){return"No dnm token: "+t.eventName}));this.addEventContentType(t.dataFields,1),this.sendTelemetryEventInternal(t,3)},e.prototype.sendTelemetryEventInternal=function(e,t){if(2===t||!e.telemetryProperties.customerContentVersion&&!e.telemetryProperties.customerContentType){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push([e,t]):(0,o.uf)(1,0,(function(){return"No telemetry sinks are attached."})));this.processTelemetryEvent(e,t)}catch(r){return void(0,o.H)(0,"SendTelemetryEvent",r)}this.telemetrySinks.forEach((function(r){try{3===t||2===t?r.sendNonStandardEvent&&r.sendNonStandardEvent(e,t):r.sendTelemetryEvent(e)}catch(n){}}))}else(0,o.uf)(0,0,(function(){return"Customer content"}))},e.prototype.processTelemetryEvent=function(e,t){var r,n,o;if(e.dataFields&&(null===(o=e.dataFields)||void 0===o||o.unshift((0,g.dt)("OTelJS.Version","4.14.0")),3!==t&&this.persistentDataFields&&(r=e.dataFields).unshift.apply(r,this.persistentDataFields)),this.partAFields.length>0){var i=e.eventContract||{name:"",dataFields:[]};(n=i.dataFields).push.apply(n,this.partAFields),e.eventContract=i}this.config.disableValidation||h(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e),this.flushQueue()},e.prototype.flushQueue=function(){var e=this.eventQueue;if(this.eventQueue=[],this.telemetrySinks.length>0)for(var t=0,r=e;t<r.length;t++){var n=r[t],o=n[0],i=n[1];this.sendTelemetryEventInternal(o,i)}},e.prototype.setTenantToken=function(e,t,r){a(e,{ariaTenantToken:t,nexusTenantToken:r})},e.prototype.setDNMToken=function(e,t){a(e,{dnmToken:t})},e.prototype.cloneEvent=function(e){return y(e)},e.prototype.getConfig=function(){return this.config},e}()},95244:function(e,t,r){"use strict";r.d(t,{h:function(){return h}});var n=r(75971),o=r(27188),i=r(7429),a=r(82732),s=function(){return 1e3*Date.now()};"object"===typeof window&&"object"===typeof window.performance&&"now"in window.performance&&(s=function(){return 1e3*Math.floor(window.performance.now())});var c,u=function e(t){var r,n=s(),c=(0,o.vE)(t.telemetryEvent);return{cv:t.parentCv.getNext(),eventName:t.telemetryEvent.eventName,dataFields:c.dataFields,eventFlags:c.eventFlags,telemetryProperties:c.telemetryProperties,createChildActivity:function(r){return e({telemetryEvent:r,sendTelemetryEvent:t.sendTelemetryEvent,parentCv:this.cv})},setResult:function(e,t,r){this.result={code:e,type:t,tag:r}},endNow:function(){if(!r){void 0===this.success&&void 0===this.result&&(0,a.uf)(1,0,(function(){return"Activity does not have success or result set"}));var e=s();r=!0;var o={duration:e-n,count:1,aggMode:0,cV:this.cv.value,success:this.success,result:this.result},c=this.eventContract&&this.eventContract.dataFields?this.eventContract.dataFields:[];return c.push.apply(c,i.cS.getFields(o)),this.eventContract={name:i.cS.contractName,dataFields:c},t.sendTelemetryEvent(this)}(0,a.uf)(0,0,(function(){return"Already ended"}))}}},l=r(96914),d=function(e){var t="Error",r=[];return r.push((0,l.dt)("".concat(t,".ErrorGroup"),e.errorGroup)),r.push((0,l.Kq)("".concat(t,".Tag"),e.tag)),void 0!==e.code&&r.push((0,l.Kq)("".concat(t,".Code"),e.code)),void 0!==e.id&&r.push((0,l.Kq)("".concat(t,".Id"),e.id)),void 0!==e.count&&r.push((0,l.Kq)("".concat(t,".Count"),e.count)),r},f=function(){function e(e){this.value=e,this.nextChild=0}return e.prototype.getNext=function(){return new e("".concat(this.value,".").concat(++this.nextChild))},e}();var h=function(e){function t(t,r,n){var o=e.call(this,t,r,n)||this;return o.baseCv=function(){if(!c){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=[],r=0;r<22;r++)t.push(e.charAt(Math.floor(64*Math.random())));c=new f(t.join(""))}return c}(),o}return(0,n.__extends)(t,e),t.prototype.createActivity=function(e){return u({sendTelemetryEvent:this.sendTelemetryEvent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t.prototype.sendActivity=function(e,t,r,n){return this.sendTelemetryEvent({eventName:e,eventContract:{name:i.cS.contractName,dataFields:i.cS.getFields(t)},dataFields:r,eventFlags:n})},t.prototype.sendError=function(e){var t=d(e.error);return null!=e.dataFields&&t.push.apply(t,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:t,eventFlags:e.eventFlags})},t.prototype.createCustomerContentActivity=function(e){return u({sendTelemetryEvent:this.sendCustomerContent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t}(o.Dw)},11012:function(e,t,r){"use strict";var n;r.d(t,{K:function(){return n}}),function(e){e.DataClassification={EssentialServiceMetadata:1,AccountData:2,SystemMetadata:4,OrganizationIdentifiableInformation:8,EndUserIdentifiableInformation:16,CustomerContent:32,AccessControl:64,PublicNonPersonalData:128,EndUserPseudonymousInformation:256,PublicPersonalData:512,SupportData:1024,DirectMeasurementData:2048,Everything:65535},e.DataFieldType={String:0,Boolean:1,Int64:2,Double:3,Guid:4},e.SamplingPolicy={NotSet:0,Measure:1,Diagnostics:2,CriticalBusinessImpact:191,CriticalCensus:192,CriticalExperimentation:193,CriticalUsage:194},e.PersistencePriority={NotSet:0,Normal:1,High:2},e.CostPriority={NotSet:0,Normal:1,High:2},e.DataCategories={NotSet:0,SoftwareSetup:1,ProductServiceUsage:2,ProductServicePerformance:4,DeviceConfiguration:8,InkingTypingSpeech:16},e.DiagnosticLevel={ReservedDoNotUse:0,Required:10,BasicEvent:10,Optional:100,FullEvent:100,RequiredServiceData:110,NecessaryServiceDataEvent:110,RequiredServiceDataForEssentialServices:120,AlwaysOnNecessaryServiceDataEvent:120},e.DnmInterval={Hourly:1,Daily:2},e.AllowedPartA={ReleaseAudienceGroup:1,WacRing:2,AppName:3,AppPlatform:4,AppVersion:5},e.CustomerContentType={None:0,MocaAddIn:1},e.LogLevel={Error:0,Warning:1,Info:2,Verbose:3},e.Category={Core:0,Sink:1,Transport:2},e.PrimaryIdentitySpace={UserObjectId:"UserObjectId",MSACID:"MSACID",OrgIdPuid:"OrgIdPuid",OrgIdPUID:"OrgIdPUID",OrgIdCID:"OrgIdCID",MsaPuid:"MsaPuid",MSAPUID:"MSAPUID",WopiAuth:"WopiAuth",ThirdParty:"ThirdParty",Other:"Other"},e.AudienceGroup={Automation:"Automation",Dogfood:"Dogfood",Microsoft:"Microsoft",Insiders:"Insiders",Production:"Production"}}(n||(n={}))},30408:function(e,t,r){"use strict";r.d(t,{E:function(){return n}});var n="@ms/forms-loop"},45593:function(e,t,r){"use strict";r.d(t,{n:function(){return s}});var n=r(78030),o=r(54555),i=r(90704),a=r(5324);function s(e,t,r,s){var c=t&&new o.g("OdspUrlResolver",t),u="UnauthenticatedGuest"===e.identityType?void 0:{tokenFetcher:function(r){return e.getToken((0,i.O)(r.siteUrl),(0,a.c)(r,t))},identityType:e.identityType||"Enterprise"};return new n.D(u,c,null===r||void 0===r?void 0:r.appName,(function(e,t){return s?s.getContext(e,t):Promise.resolve(void 0)}))}},5324:function(e,t,r){"use strict";r.d(t,{c:function(){return F}});var n=r(54555),o=r(74165),i=r(15861),a="https://my.microsoftpersonalcontent.com",s=r(75489),c=r(94465),u=r(1314),l="https://home.microsoftpersonalcontent.com",d=r(67425);function f(e){var t=e.get("www-authenticate");if(t){var r,n=t.indexOf(d.g);if(!(n<0))return t.substring(n+d.g.length).split(",").map((function(e){if(!r){var t=e.split("=");t.length>=2&&"realm"===t[0].trim().toLowerCase()&&(r=JSON.parse(t[1].trim()))}})),r}}var h=r(92337),p=r(76890),v="-my",g="-admin",m=".sharepoint.",y=".sharepoint-df.",b=".onmicrosoft.";function k(e,t){var r=new URL(e);if([a,l].includes(r.origin.toLowerCase()))return"consumers";var n=r.hostname.toLowerCase(),o=function(e){return P().get(e)}(n);if(o)return o.guid?o.guid:(w(e,n,o.hostname,t),o.hostname);var i=n.substring(0,n.indexOf(".")),s=n.substring(i.length),c=!1;0===s.indexOf(m)?s="".concat(b).concat(s.substring(m.length)):0===s.indexOf(y)?s="".concat(b).concat(s.substring(y.length)):c=!0,i.endsWith(v)?i=i.substring(0,i.length-v.length):i.endsWith(g)&&(i=i.substring(0,i.length-g.length));var u=c?void 0:"".concat(i).concat(s);return E(n,{hostname:u}),w(e,n,u,t),u}var S,C=new Set;function w(e,t,r,n){C.has(t)||(C.add(t),(0,h.F)((0,i.Z)((0,o.Z)().mark((function i(){var a,l,d,h;return(0,o.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,l="".concat((0,u.P)(e),"/_api/v2.0/drives"),o.prev=2,o.next=5,(0,c.q4)(l,{method:"GET",headers:{Authorization:"Bearer"},credentials:"omit"});case 5:d=o.sent,o.next=11;break;case 8:o.prev=8,o.t0=o.catch(2),a="Server did not respond";case 11:d&&((h=f(d.result.headers))?E(t,{hostname:r,guid:h}):a="ODSP did not return tenant id in headers. Response status code: ".concat(d.result.status)),o.next=17;break;case 14:o.prev=14,o.t1=o.catch(0),a="Unexpected error";case 17:return o.prev=17,C.delete(t),o.finish(17);case 20:a&&n&&(0,s.ve)(n,{eventName:"AadTenantNotFound",message:a});case 21:case"end":return o.stop()}}),i,null,[[0,14,17,20],[2,8]])}))),{ensureExecution:!1}))}var x="FluidSiteToAadTenantMapping";function P(){if(!S){var e,t=(0,p.E)(),r=null===t||void 0===t?void 0:t.getItem(x);if(r)try{e=JSON.parse(r)}catch(n){null===t||void 0===t||t.removeItem(x)}S=new Map(e)}return S}function E(e,t){P().set(e,t),T()}var Z=!1;function T(){Z||(Z=!0,(0,h.F)((function(){var e;S&&(null===(e=(0,p.E)())||void 0===e||e.setItem(x,JSON.stringify(Array.from(S.entries()))));Z=!1}),{ensureExecution:!0}))}var N=r(97180);function F(e,t){var r=t&&new n.g(N.gL,t);return{claims:e.claims,forceRefresh:e.refresh,siteUrl:e.siteUrl,driveId:e.driveId,itemId:e.itemId,tenantId:e.tenantId||k(e.siteUrl,r)}}},97180:function(e,t,r){"use strict";r.d(t,{FW:function(){return h},Fl:function(){return v},Hf:function(){return i},VR:function(){return l},W_:function(){return s},_7:function(){return o},gL:function(){return k},jJ:function(){return n},k5:function(){return d},lw:function(){return S},pV:function(){return a},qo:function(){return m},rb:function(){return c},s9:function(){return f},sS:function(){return u},uv:function(){return y},v2:function(){return p},wS:function(){return g},zy:function(){return b}});var n="LoadComponentInDiv",o="GetDriver",i="LoadContainer",a="LoadComponentFromContainer",s="RequestComponent",c="GetTemplateContent",u="RehydrateFromTemplateContent",l="LoadCodeFromHint",d="FetchComponentManifest",f="GetLoopComponentCore",h="ContainerPostBootError",p="ContainerPackagePreCacheError",v="GetTemplateContentError",g="UndefinedTemplateContentError",m="ComponentNotSerializableError",y="ComponentManifestFetchError",b="CodeHintExists",k="OfficeWebHost",S="LoopExperiences"},36690:function(e,t,r){"use strict";r.d(t,{Q:function(){return o},a:function(){return n}});var n={GetDriveInfo:"GetDriveInfo",AttachContainer:"AttachContainer",GetFileLink:"GetFileLink",CreateShareLink:"CreateShareLink",RenderComponent:"RenderComponent"},o={RenderComponent:"RenderComponentByHost"}},11503:function(e,t,r){"use strict";r.d(t,{L:function(){return p}});var n=r(74165),o=r(15861),i=r(1413),a=r(15671),s=r(43144),c=r(54555),u=r(46569),l=r(75489),d=r(42437),f=r(36690),h="EndToEnd",p=function(){function e(t,r,n,o,i){(0,a.Z)(this,e),this.activityType=t,this.additionalCleanup=o,this.getExtraPropsToLog=i,null===n||void 0===n||n(),this.logger=new c.g("HostTracker",r),this.activityTracker=u.a.start(t,this.logger,{addUserTiming:!0,isAPerformanceMetric:[f.a.RenderComponent,f.Q.RenderComponent].includes(t)||t.endsWith(h)}),(0,l.ve)(this.logger,{eventName:t,subCategory:"HostActivityTrackerCreated"})}return(0,s.Z)(e,[{key:"setSuccess",value:function(e){var t;this.activityTracker&&(this.activityTracker.setResult(!0,(0,i.Z)((0,i.Z)({},e),null===(t=this.getExtraPropsToLog)||void 0===t?void 0:t.call(this))),this.dispose())}},{key:"setFailure",value:function(e,t){var r;this.activityTracker&&(this.activityTracker.setResult(!1,(0,i.Z)((0,i.Z)((0,i.Z)({},t),null===(r=this.getExtraPropsToLog)||void 0===r?void 0:r.call(this)),{},{errorType:e?e.errorType:void 0}),e),this.dispose())}},{key:"cancel",value:function(){this.dispose()}},{key:"dispose",value:function(){var e,t;null===(e=this.additionalCleanup)||void 0===e||e.call(this),this.logger&&(0,l.ve)(this.logger,{eventName:this.activityType,subCategory:"HostActivityTrackerDisposed"}),null===(t=this.activityTracker)||void 0===t||t.dispose(),this.activityTracker=void 0,this.logger=void 0}}],[{key:"startScenario",value:function(t,r,i,a){if(i){var s=e.startScenario(t,r);return(0,o.Z)((0,n.Z)().mark((function e(){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i(s);case 3:return t=e.sent,s.setSuccess(null===a||void 0===a?void 0:a()),e.abrupt("return",t);case 8:throw e.prev=8,e.t0=e.catch(0),s.setFailure(e.t0,null===a||void 0===a?void 0:a()),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))()}var c;return new e(r+h,t,(function(){c=(0,d.n3)()}),(function(){c&&((0,d.Zm)(c),c=void 0)}),(function(){return{documentHidden:c?(0,d.yv)(c,!0)>-1:""}}))}},{key:"startActivity",value:function(t,r,i){if(i){var a=e.startActivity(t,r);return(0,o.Z)((0,n.Z)().mark((function e(){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i();case 3:return t=e.sent,a.setSuccess(),e.abrupt("return",t);case 8:throw e.prev=8,e.t0=e.catch(0),a.setFailure(e.t0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))()}return new e(f.Q[r]||r,t)}}]),e}()},97288:function(e,t,r){"use strict";var n,o;r.d(t,{J:function(){return n},u:function(){return o}}),function(e){e.Generic="Generic",e.Error="Error",e.UserAction="UserAction",e.Activity="Activity"}(n||(n={})),function(e){e.Success="Success",e.Failure="Failure",e.Cancelled="Cancelled"}(o||(o={}))},46569:function(e,t,r){"use strict";r.d(t,{a:function(){return d}});var n=r(1413),o=r(4942),i=r(15671),a=r(43144),s=r(97288),c=r(92810),u=r(75489);var l=new Set;var d=function(){function e(t,r,n){var o;(0,i.Z)(this,e),this.activityName=t,this.logger=r,this.isAPerformanceMetric=!1,this.additionalPropsToLog=null===n||void 0===n?void 0:n.additionalPropsToLog,this.addUserTiming=null===n||void 0===n?void 0:n.addUserTiming,this.isAPerformanceMetric=(null===n||void 0===n?void 0:n.isAPerformanceMetric)||!1,this.logSubactivityStartTimes=null===(o=null===n||void 0===n?void 0:n.logSubactivityStartTimes)||void 0===o||o,this.subActivities={},this.identifier=(0,c.Z)(),this.activityStartName="".concat(this.activityName,"-start-").concat(this.identifier),this.activityEndName="".concat(this.activityName,"-end-").concat(this.identifier),this.addUserTiming&&performance.mark(this.activityStartName),this.startTime=performance.now(),this.startTimeSinceEpoch=Date.now()}return(0,a.Z)(e,[{key:"markSubActivityStart",value:function(e){this.subActivities[e]={startTime:performance.now(),startTimeSinceEpoch:Date.now()},this.addUserTiming&&performance.mark(this.getSubActivityName(e,"start"))}},{key:"markSubActivityEnd",value:function(e,t){var r=this.subActivities[e];if(r){if(this.addUserTiming){var i=this.getSubActivityName(e,"end");performance.mark(i),performance.measure(e,this.getSubActivityName(e,"start"),i)}var a=(0,o.Z)({},"durationMs_".concat(e),Math.round(performance.now()-r.startTime));this.logSubactivityStartTimes&&(a["startTime_".concat(e)]=r.startTimeSinceEpoch),this.additionalPropsToLog=(0,n.Z)((0,n.Z)((0,n.Z)({},a),this.additionalPropsToLog),t)}}},{key:"setResult",value:function(e,t,r,n){this.logActivityResult(e,t,r,null===n||void 0===n?void 0:n.skipLogging,void 0,null===n||void 0===n?void 0:n.sampleEvent)}},{key:"cancel",value:function(e,t,r){this.logActivityResult(e,t,r,!1,!0)}},{key:"addAdditionalProps",value:function(e){this.additionalPropsToLog=(0,n.Z)((0,n.Z)({},this.additionalPropsToLog),e)}},{key:"dispose",value:function(){this.cancel();var e=function(e){return performance.clearMarks(e)},t=function(e){return performance.clearMeasures(e)};if(this.addUserTiming)for(var r in e(this.activityStartName),e(this.activityEndName),this.cachedMeasureName&&t(this.cachedMeasureName),this.subActivities)e(this.getSubActivityName(r,"start")),e(this.getSubActivityName(r,"end")),t(r)}},{key:"logActivityResult",value:function(e,t,r,o,i,a){if(!this.hasAlreadyResolved){this.hasAlreadyResolved=!0,this.addUserTiming&&performance.mark(this.activityEndName);var c=performance.now(),d=Math.round(c-this.startTime);if(this.isAPerformanceMetric)(window._pageTimings||(window._pageTimings={}))[this.activityName]=d;if(this.logger&&!o){var f=(0,n.Z)((0,n.Z)({eventName:this.activityName,startTime:this.startTimeSinceEpoch,durationMs:d,succeeded:e,sampleEvent:a,resultType:i?s.u.Cancelled:e?s.u.Success:s.u.Failure},this.additionalPropsToLog),t);(0,u.t_)(this.logger,f,r)}this.logger=void 0,l.delete(this),this.addUserTiming&&performance.measure(this.generateMeasureName(e),this.activityStartName,this.activityEndName)}}},{key:"generateMeasureName",value:function(e){return this.cachedMeasureName="".concat(this.activityName).concat(!1===e?"-FAILED":"","-").concat(this.identifier),this.cachedMeasureName}},{key:"getSubActivityName",value:function(e,t){return"".concat(e,"-").concat(t,"-").concat(this.identifier)}}],[{key:"start",value:function(t,r,n){var o=new e(t,r,n);return l.add(o),o}}]),e}()},75489:function(e,t,r){"use strict";r.d(t,{t_:function(){return l},uX:function(){return u},ve:function(){return c}});var n=r(1413),o=r(97288),i=r(55471),a=["facetCodes","statusCode","innerMostErrorCode","sprequestguid"];function s(e){var t=/[A-Z0-9._%`'+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}/gi;return Object.getOwnPropertyNames(e).map((function(r){if(-1!==r.toLowerCase().indexOf("message")||-1!==r.toLowerCase().indexOf("error")||-1!==r.toLowerCase().indexOf("stack")||!1!==a.includes(r)){var n=e[r];void 0!==n&&"string"===typeof n&&(n=n.toString().replace(t,"scrubbed_email"),e[r]=(0,i.NU)(n.toString()))}})),e}function c(e,t){var r=s(t);e.send((0,n.Z)((0,n.Z)({},r),{},{category:o.J.Generic}))}function u(e,t,r){r&&d(t,r);var i=s(t);e.send((0,n.Z)((0,n.Z)({},i),{},{category:o.J.Error}))}new Set,new Set,new Map([["Automation",1],["SyntheticTraffic",1],["Local",1],["Staging",1],["Dogfood",.1],["Preview",.1],["Microsoft",.01],["Production",.001],["GCC",0],["GCC-High",0],["DoD",0]]);function l(e,t,r){r&&d(t,r),t.resultType||void 0===t.succeeded||(t.resultType=t.succeeded?o.u.Success:o.u.Failure);var i=s(t);e.send((0,n.Z)((0,n.Z)({},i),{},{category:o.J.Activity}))}function d(e,t){!function(e,t){var r,n="object"===typeof e&&null!==e;function o(t){if(n){var r=e[t];return"string"===typeof r?r:void 0}}t.errorMessage=null!==(r=o("message"))&&void 0!==r?r:String(e),t.errorName=o("name"),t.stack=o("stack"),t.errorType=o("errorType"),t.errorInstanceId=o("errorInstanceId"),a.forEach((function(r){var n=e[r];n&&(t[r]="object"===typeof n?JSON.stringify(n):n)}))}(t,e),e.message?e.message="".concat(e.message,"\n").concat(e.errorMessage):e.message=e.errorMessage,void 0===e.stack&&(e.stack=f())}function f(){var e=(new Error).stack;if(!e)try{throw new Error}catch(t){e=t.stack}return e}},54555:function(e,t,r){"use strict";r.d(t,{g:function(){return c}});var n=r(1413),o=r(74165),i=r(15861),a=r(15671),s=r(43144),c=function(){function e(t,r,s){var c=this;if((0,a.Z)(this,e),this.namespace=t,this.disposable={get Disposable(){return this},dispose:function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c.logger=null;case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},r instanceof e){var u=(0,n.Z)((0,n.Z)({},r.persistedProperties),s);this.logger=r.logger,this.persistedProperties=u}else this.logger=r,this.persistedProperties=s}return(0,s.Z)(e,[{key:"NamespaceLogger",get:function(){return this}},{key:"PersistedProperties",get:function(){return this}},{key:"Disposable",get:function(){return this.disposable}},{key:"addPersistedProperties",value:function(e){this.persistedProperties=(0,n.Z)((0,n.Z)({},this.persistedProperties),e)}},{key:"send",value:function(e){this.sendWithNamespace(e,this.namespace)}},{key:"sendWithNamespace",value:function(e,t){var r;null===(r=this.logger)||void 0===r||r.sendWithNamespace((0,n.Z)((0,n.Z)({},this.persistedProperties),e),t)}},{key:"dispose",value:function(){this.logger=null}}]),e}()},55471:function(e,t,r){"use strict";function n(e){return e.replace(/(https:\/\/)(\w)+(.sharepoint.com|-my.sharepoint.com|.sharepoint-df.com)/,"(redacted)").replace(/(https:\/\/)(dev.loop.microsoft.com|df.loop.microsoft.com|loop.microsoft.com)(\/p\/)([a-zA-Z0-9%]+)/,"(redacted)")}r.d(t,{NU:function(){return n}})},67425:function(e,t,r){"use strict";r.d(t,{g:function(){return n}});var n="Bearer"},98678:function(e,t,r){"use strict";r.d(t,{Qg:function(){return i},py:function(){return o}});var n=r(61919);function o(e){return function(){return e}}function i(e,t,r){return a(e,[],t,r)}function a(e,t,r,o){var i,s=[e(t.length).then((function(e){return i=e,!1}))];return o&&o.timeoutMs>0&&s.push((0,n.g)(o.timeoutMs).then((function(){return!0}))),Promise.race(s).then((function(s){return s&&(i=o.onTimeout()),null===r||void 0===r||!r.filter(i)||t.length>=r.maxRetries?{result:i,tries:t}:(0,n.g)(r.backoffFn(t.length,i)).then((function(){return t.push(i),a(e,t,r,o)}))}))}},61919:function(e,t,r){"use strict";r.d(t,{g:function(){return o},s:function(){return i}});var n=r(93433);function o(e){return new Promise((function(t){return setTimeout((function(){return t()}),e)}))}function i(e,t){var r=o(e).then((function(e){return!0})),i=t.map((function(e){return e.then((function(e){return!1})).catch((function(e){return!1}))}));return Promise.race([r].concat((0,n.Z)(i)))}},94465:function(e,t,r){"use strict";r.d(t,{mE:function(){return l},q4:function(){return d},tj:function(){return f}});var n=r(74165),o=r(15861),i=r(1413),a=r(75489),s=r(98678),c=709,u=710;function l(e){return function(t){return t&&e.includes(t.status)}}function d(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=r;return null!==r&&void 0!==r&&r.respectRetryAfterHeader&&((o=(0,i.Z)({},r)).backoffFn=function(e,t){if(429===t.status||503===t.status){var n=t.headers.get("Retry-After");if(n){var o=parseInt(n,10);if(!isNaN(o))return 1e3*o}}return r.backoffFn(e,t)}),(0,s.Qg)((function(){var r=performance.now();return fetch(e,t).then((function(e){var t=e;return t.durationMs=Math.round(performance.now()-r),t})).catch((function(e){if(function(e,t){return e===(null===t||void 0===t?void 0:t.reason)||"object"===typeof e&&null!==e&&("AbortError"===e.name||20===e.code)}(e,null===t||void 0===t?void 0:t.signal))throw e;var n="Error does not provide a message";return e.name&&e.message?n="Error type: ".concat(e.name,", ").concat(e.message):e.name?n="Error type: ".concat(e.name):e.message&&(n="Error message: ".concat(e.message)),{status:window.navigator.onLine?u:c,ok:!1,durationMs:Math.round(performance.now()-r),statusText:n,json:function(){return Promise.resolve(void 0)}}}))}),o,{timeoutMs:n,onTimeout:function(){return{status:707,ok:!1,durationMs:n}}})}function f(e,t,r,n,o,i){var a=arguments.length>7?arguments[7]:void 0;return d(e,t,i,arguments.length>6&&void 0!==arguments[6]?arguments[6]:0).then((function(e){return n&&r?((!o&&e.result.ok||!e.result.ok)&&h(r,!0,e.result,e.tries.length+1,n,a),e.tries.forEach((function(e,t){h(r,!1,e,t+1,n,a)})),e):e}))}function h(e,t,r,n,o,i){return p.apply(this,arguments)}function p(){return(p=(0,o.Z)((0,n.Z)().mark((function e(t,r,o,s,c,u){var l,d;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=u,!e.t0){e.next=5;break}return e.next=4,u(o,r);case 4:e.t0=e.sent;case 5:d=e.t0,(0,a.ve)(c,(0,i.Z)({subCategory:"Request",eventName:t,isFinalAttempt:r,status:o.status,durationMs:o.durationMs,size:(null===(l=o.headers)||void 0===l?void 0:l.get("Content-Length"))||-1,attempt:s},d));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},1314:function(e,t,r){"use strict";function n(e){return new URL(e).origin}r.d(t,{P:function(){return n}})},90704:function(e,t,r){"use strict";r.d(t,{O:function(){return o}});var n=r(1314);function o(e){return["".concat((0,n.P)(e),"/files.readwrite.all")]}},42437:function(e,t,r){"use strict";r.d(t,{Zm:function(){return d},n3:function(){return u},yv:function(){return l}});var n=new Map,o=!1,i=0;function a(){if(document.hidden){var e=Date.now();n.forEach((function(t,r){-1===t&&n.set(r,e)})),s()}}function s(){o=!1,document.removeEventListener("visibilitychange",a)}function c(e){document.hidden?n.set(e,0):(o||(o=!0,document.addEventListener("visibilitychange",a)),n.set(e,-1))}function u(){return c(i+=1),i}function l(e,t){var r=n.get(e);return t&&d(e),r}function d(e){n.delete(e),0===n.size&&o&&s()}},92337:function(e,t,r){"use strict";r.d(t,{F:function(){return s}});var n=r(93433),o=[],i=!1,a=!1;function s(e,t){o.push({ensureExecution:!0===(null===t||void 0===t?void 0:t.ensureExecution),task:e}),null!==t&&void 0!==t&&t.ensureExecution&&!a&&(document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&u((function(e){return e.ensureExecution}))})),a=!0),c()}function c(){if(!i){if(window.requestIdleCallback)window.requestIdleCallback(l);else{var e=Date.now()+50;window.setTimeout((function(){return l({timeRemaining:function(){return Math.max(e-Date.now(),0)},didTimeout:!1})}),0)}i=!0}}function u(e,t){for(var r=[],i=0;i<o.length;i+=1){if(t&&!t()){r.push.apply(r,(0,n.Z)(o.slice(i)));break}var a=o[i];e&&!e(a)?r.push(a):a.task()}o=r}function l(e){u(void 0,(function(){return e.timeRemaining()>10})),i=!1,o.length>0&&c()}},76890:function(e,t,r){"use strict";var n,o;r.d(t,{E:function(){return i}});try{n=localStorage}catch(a){}n||(n=void 0);try{o=sessionStorage}catch(s){}function i(){return n}o||(o=void 0)},35935:function(e){"use strict";var t="undefined"!==typeof self?self:"undefined"!==typeof window?window:void 0,r=t.AbortController,n=t.AbortSignal;e.exports=r,e.exports.AbortSignal=n,e.exports.default=r},2009:function(e,t){"use strict";t.byteLength=function(e){var t=s(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,i=s(e),a=i[0],c=i[1],u=new o(function(e,t,r){return 3*(t+r)/4-r}(0,a,c)),l=0,d=c>0?a-4:a;for(r=0;r<d;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],u[l++]=t>>16&255,u[l++]=t>>8&255,u[l++]=255&t;2===c&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,u[l++]=255&t);1===c&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,u[l++]=t>>8&255,u[l++]=255&t);return u},t.fromByteArray=function(e){for(var t,n=e.length,o=n%3,i=[],a=16383,s=0,u=n-o;s<u;s+=a)i.push(c(e,s,s+a>u?u:s+a));1===o?(t=e[n-1],i.push(r[t>>2]+r[t<<4&63]+"==")):2===o&&(t=(e[n-2]<<8)+e[n-1],i.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return i.join("")};for(var r=[],n=[],o="undefined"!==typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0;a<64;++a)r[a]=i[a],n[i.charCodeAt(a)]=a;function s(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function c(e,t,n){for(var o,i,a=[],s=t;s<n;s+=3)o=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(r[(i=o)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return a.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},44037:function(e,t,r){"use strict";var n=r(52506),o=r(19722),i=o(n("String.prototype.indexOf"));e.exports=function(e,t){var r=n(e,!!t);return"function"===typeof r&&i(e,".prototype.")>-1?o(r):r}},19722:function(e,t,r){"use strict";var n=r(33350),o=r(52506),i=o("%Function.prototype.apply%"),a=o("%Function.prototype.call%"),s=o("%Reflect.apply%",!0)||n.call(a,i),c=o("%Object.getOwnPropertyDescriptor%",!0),u=o("%Object.defineProperty%",!0),l=o("%Math.max%");if(u)try{u({},"a",{value:1})}catch(f){u=null}e.exports=function(e){var t=s(n,a,arguments);c&&u&&(c(t,"length").configurable&&u(t,"length",{value:1+l(0,e.length-(arguments.length-1))}));return t};var d=function(){return s(n,i,arguments)};u?u(e.exports,"apply",{value:d}):e.exports.apply=d},18392:function(e,t,r){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var n=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(n++,"%c"===e&&(o=n))})),t.splice(o,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(r){}},t.load=function(){var e;try{e=t.storage.getItem("debug")}catch(r){}!e&&"undefined"!==typeof process&&"env"in process&&(e={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.DEBUG);return e},t.useColors=function(){if("undefined"!==typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=function(){var e=!1;return function(){e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||function(){},e.exports=r(18472)(t),e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}},18472:function(e,t,r){var n=r(861).default;e.exports=function(e){function t(e){var r,n,i,a=null;function s(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];if(s.enabled){var i=s,a=Number(new Date),c=a-(r||a);i.diff=c,i.prev=r,i.curr=a,r=a,n[0]=t.coerce(n[0]),"string"!==typeof n[0]&&n.unshift("%O");var u=0;n[0]=n[0].replace(/%([a-zA-Z%])/g,(function(e,r){if("%%"===e)return"%";u++;var o=t.formatters[r];if("function"===typeof o){var a=n[u];e=o.call(i,a),n.splice(u,1),u--}return e})),t.formatArgs.call(i,n),(i.log||t.log).apply(i,n)}}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=o,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:function(){return null!==a?a:(n!==t.namespaces&&(n=t.namespaces,i=t.enabled(e)),i)},set:function(e){a=e}}),"function"===typeof t.init&&t.init(s),s}function o(e,r){var n=t(this.namespace+("undefined"===typeof r?":":r)+e);return n.log=this.log,n}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){var e=[].concat(n(t.names.map(i)),n(t.skips.map(i).map((function(e){return"-"+e})))).join(",");return t.enable(""),e},t.enable=function(e){var r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];var n=("string"===typeof e?e:"").split(/[\s,]+/),o=n.length;for(r=0;r<o;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(78193),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((function(r){t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){for(var r=0,n=0;n<e.length;n++)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},63133:function(e){"use strict";function t(e){if(this._capacity=n(e),this._length=0,this._front=0,r(e)){for(var t=e.length,o=0;o<t;++o)this[o]=e[o];this._length=t}}t.prototype.toArray=function(){for(var e=this._length,t=new Array(e),r=this._front,n=this._capacity,o=0;o<e;++o)t[o]=this[r+o&n-1];return t},t.prototype.push=function(e){var t=arguments.length,r=this._length;if(t>1){var n=this._capacity;if(r+t>n){for(var o=0;o<t;++o){this._checkCapacity(r+1),this[i=this._front+r&this._capacity-1]=arguments[o],r++,this._length=r}return r}for(var i=this._front,o=0;o<t;++o)this[i+r&n-1]=arguments[o],i++;return this._length=r+t,r+t}return 0===t?r:(this._checkCapacity(r+1),this[o=this._front+r&this._capacity-1]=e,this._length=r+1,r+1)},t.prototype.pop=function(){var e=this._length;if(0!==e){var t=this._front+e-1&this._capacity-1,r=this[t];return this[t]=void 0,this._length=e-1,r}},t.prototype.shift=function(){var e=this._length;if(0!==e){var t=this._front,r=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length=e-1,r}},t.prototype.unshift=function(e){var t=this._length,r=arguments.length;if(r>1){if(t+r>(o=this._capacity)){for(var n=r-1;n>=0;n--){this._checkCapacity(t+1);var o=this._capacity;this[a=(this._front-1&o-1^o)-o]=arguments[n],t++,this._length=t,this._front=a}return t}var i=this._front;for(n=r-1;n>=0;n--){var a;this[a=(i-1&o-1^o)-o]=arguments[n],i=a}return this._front=i,this._length=t+r,t+r}if(0===r)return t;this._checkCapacity(t+1);o=this._capacity;return this[n=(this._front-1&o-1^o)-o]=e,this._length=t+1,this._front=n,t+1},t.prototype.peekBack=function(){var e=this._length;if(0!==e)return this[this._front+e-1&this._capacity-1]},t.prototype.peekFront=function(){if(0!==this._length)return this[this._front]},t.prototype.get=function(e){var t=e;if(t===(0|t)){var r=this._length;if(t<0&&(t+=r),!(t<0||t>=r))return this[this._front+t&this._capacity-1]}},t.prototype.isEmpty=function(){return 0===this._length},t.prototype.clear=function(){for(var e=this._length,t=this._front,r=this._capacity,n=0;n<e;++n)this[t+n&r-1]=void 0;this._length=0,this._front=0},t.prototype.toString=function(){return this.toArray().toString()},t.prototype.valueOf=t.prototype.toString,t.prototype.removeFront=t.prototype.shift,t.prototype.removeBack=t.prototype.pop,t.prototype.insertFront=t.prototype.unshift,t.prototype.insertBack=t.prototype.push,t.prototype.enqueue=t.prototype.push,t.prototype.dequeue=t.prototype.shift,t.prototype.toJSON=t.prototype.toArray,Object.defineProperty(t.prototype,"length",{get:function(){return this._length},set:function(){throw new RangeError("")}}),t.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(n(1.5*this._capacity+16))},t.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e;var r=this._front,n=this._length;r+n>t&&function(e,t,r,n,o){for(var i=0;i<o;++i)r[i+n]=e[i+t],e[i+t]=void 0}(this,0,this,t,r+n&t-1)};var r=Array.isArray;function n(e){if("number"!==typeof e){if(!r(e))return 16;e=e.length}return t=Math.min(Math.max(16,e),1073741824),t>>>=0,t-=1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,1+(t|=t>>16);var t}e.exports=t},47465:function(e){"use strict";var t,r="object"===typeof Reflect?Reflect:null,n=r&&"function"===typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"===typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!==e};function i(){i.init.call(this)}e.exports=i,e.exports.once=function(e,t){return new Promise((function(r,n){function o(r){e.removeListener(t,i),n(r)}function i(){"function"===typeof e.removeListener&&e.removeListener("error",o),r([].slice.call(arguments))}v(e,t,i,{once:!0}),"error"!==t&&function(e,t,r){"function"===typeof e.on&&v(e,"error",t,r)}(e,o,{once:!0})}))},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var a=10;function s(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}function u(e,t,r,n){var o,i,a,u;if(s(r),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),a=i[t]),void 0===a)a=i[t]=r,++e._eventsCount;else if("function"===typeof a?a=i[t]=n?[r,a]:[a,r]:n?a.unshift(r):a.push(r),(o=c(e))>0&&a.length>o&&!a.warned){a.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=a.length,u=l,console&&console.warn&&console.warn(u)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},o=l.bind(n);return o.listener=r,n.wrapFn=o,o}function f(e,t,r){var n=e._events;if(void 0===n)return[];var o=n[t];return void 0===o?[]:"function"===typeof o?r?[o.listener||o]:[o]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(o):p(o,o.length)}function h(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"===typeof r)return 1;if(void 0!==r)return r.length}return 0}function p(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function v(e,t,r,n){if("function"===typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function o(i){n.once&&e.removeEventListener(t,o),r(i)}))}}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(e){if("number"!==typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");a=e}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},i.prototype.getMaxListeners=function(){return c(this)},i.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var o="error"===e,i=this._events;if(void 0!==i)o=o&&void 0===i.error;else if(!o)return!1;if(o){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var c=i[e];if(void 0===c)return!1;if("function"===typeof c)n(c,this,t);else{var u=c.length,l=p(c,u);for(r=0;r<u;++r)n(l[r],this,t)}return!0},i.prototype.addListener=function(e,t){return u(this,e,t,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(e,t){return u(this,e,t,!0)},i.prototype.once=function(e,t){return s(t),this.on(e,d(this,e,t)),this},i.prototype.prependOnceListener=function(e,t){return s(t),this.prependListener(e,d(this,e,t)),this},i.prototype.removeListener=function(e,t){var r,n,o,i,a;if(s(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!==typeof r){for(o=-1,i=r.length-1;i>=0;i--)if(r[i]===t||r[i].listener===t){a=r[i].listener,o=i;break}if(o<0)return this;0===o?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,o),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,a||t)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var o,i=Object.keys(r);for(n=0;n<i.length;++n)"removeListener"!==(o=i[n])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},i.prototype.listeners=function(e){return f(this,e,!0)},i.prototype.rawListeners=function(e){return f(this,e,!1)},i.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):h.call(e,t)},i.prototype.listenerCount=h,i.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},30222:function(e){"use strict";var t=Array.prototype.slice,r=Object.prototype.toString;e.exports=function(e){var n=this;if("function"!==typeof n||"[object Function]"!==r.call(n))throw new TypeError("Function.prototype.bind called on incompatible "+n);for(var o,i=t.call(arguments,1),a=Math.max(0,n.length-i.length),s=[],c=0;c<a;c++)s.push("$"+c);if(o=Function("binder","return function ("+s.join(",")+"){ return binder.apply(this,arguments); }")((function(){if(this instanceof o){var r=n.apply(this,i.concat(t.call(arguments)));return Object(r)===r?r:this}return n.apply(e,i.concat(t.call(arguments)))})),n.prototype){var u=function(){};u.prototype=n.prototype,o.prototype=new u,u.prototype=null}return o}},33350:function(e,t,r){"use strict";var n=r(30222);e.exports=Function.prototype.bind||n},52506:function(e,t,r){"use strict";var n,o=SyntaxError,i=Function,a=TypeError,s=function(e){try{return i('"use strict"; return ('+e+").constructor;")()}catch(t){}},c=Object.getOwnPropertyDescriptor;if(c)try{c({},"")}catch(F){c=null}var u=function(){throw new a},l=c?function(){try{return u}catch(e){try{return c(arguments,"callee").get}catch(t){return u}}}():u,d=r(80697)(),f=r(92203)(),h=Object.getPrototypeOf||(f?function(e){return e.__proto__}:null),p={},v="undefined"!==typeof Uint8Array&&h?h(Uint8Array):n,g={"%AggregateError%":"undefined"===typeof AggregateError?n:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"===typeof ArrayBuffer?n:ArrayBuffer,"%ArrayIteratorPrototype%":d&&h?h([][Symbol.iterator]()):n,"%AsyncFromSyncIteratorPrototype%":n,"%AsyncFunction%":p,"%AsyncGenerator%":p,"%AsyncGeneratorFunction%":p,"%AsyncIteratorPrototype%":p,"%Atomics%":"undefined"===typeof Atomics?n:Atomics,"%BigInt%":"undefined"===typeof BigInt?n:BigInt,"%BigInt64Array%":"undefined"===typeof BigInt64Array?n:BigInt64Array,"%BigUint64Array%":"undefined"===typeof BigUint64Array?n:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"===typeof DataView?n:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"===typeof Float32Array?n:Float32Array,"%Float64Array%":"undefined"===typeof Float64Array?n:Float64Array,"%FinalizationRegistry%":"undefined"===typeof FinalizationRegistry?n:FinalizationRegistry,"%Function%":i,"%GeneratorFunction%":p,"%Int8Array%":"undefined"===typeof Int8Array?n:Int8Array,"%Int16Array%":"undefined"===typeof Int16Array?n:Int16Array,"%Int32Array%":"undefined"===typeof Int32Array?n:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":d&&h?h(h([][Symbol.iterator]())):n,"%JSON%":"object"===typeof JSON?JSON:n,"%Map%":"undefined"===typeof Map?n:Map,"%MapIteratorPrototype%":"undefined"!==typeof Map&&d&&h?h((new Map)[Symbol.iterator]()):n,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"===typeof Promise?n:Promise,"%Proxy%":"undefined"===typeof Proxy?n:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"===typeof Reflect?n:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"===typeof Set?n:Set,"%SetIteratorPrototype%":"undefined"!==typeof Set&&d&&h?h((new Set)[Symbol.iterator]()):n,"%SharedArrayBuffer%":"undefined"===typeof SharedArrayBuffer?n:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":d&&h?h(""[Symbol.iterator]()):n,"%Symbol%":d?Symbol:n,"%SyntaxError%":o,"%ThrowTypeError%":l,"%TypedArray%":v,"%TypeError%":a,"%Uint8Array%":"undefined"===typeof Uint8Array?n:Uint8Array,"%Uint8ClampedArray%":"undefined"===typeof Uint8ClampedArray?n:Uint8ClampedArray,"%Uint16Array%":"undefined"===typeof Uint16Array?n:Uint16Array,"%Uint32Array%":"undefined"===typeof Uint32Array?n:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"===typeof WeakMap?n:WeakMap,"%WeakRef%":"undefined"===typeof WeakRef?n:WeakRef,"%WeakSet%":"undefined"===typeof WeakSet?n:WeakSet};if(h)try{null.error}catch(F){var m=h(h(F));g["%Error.prototype%"]=m}var y=function e(t){var r;if("%AsyncFunction%"===t)r=s("async function () {}");else if("%GeneratorFunction%"===t)r=s("function* () {}");else if("%AsyncGeneratorFunction%"===t)r=s("async function* () {}");else if("%AsyncGenerator%"===t){var n=e("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if("%AsyncIteratorPrototype%"===t){var o=e("%AsyncGenerator%");o&&h&&(r=h(o.prototype))}return g[t]=r,r},b={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},k=r(33350),S=r(58316),C=k.call(Function.call,Array.prototype.concat),w=k.call(Function.apply,Array.prototype.splice),x=k.call(Function.call,String.prototype.replace),P=k.call(Function.call,String.prototype.slice),E=k.call(Function.call,RegExp.prototype.exec),Z=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,T=/\\(\\)?/g,N=function(e,t){var r,n=e;if(S(b,n)&&(n="%"+(r=b[n])[0]+"%"),S(g,n)){var i=g[n];if(i===p&&(i=y(n)),"undefined"===typeof i&&!t)throw new a("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:i}}throw new o("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!==typeof e||0===e.length)throw new a("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!==typeof t)throw new a('"allowMissing" argument must be a boolean');if(null===E(/^%?[^%]*%?$/,e))throw new o("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=function(e){var t=P(e,0,1),r=P(e,-1);if("%"===t&&"%"!==r)throw new o("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==t)throw new o("invalid intrinsic syntax, expected opening `%`");var n=[];return x(e,Z,(function(e,t,r,o){n[n.length]=r?x(o,T,"$1"):t||e})),n}(e),n=r.length>0?r[0]:"",i=N("%"+n+"%",t),s=i.name,u=i.value,l=!1,d=i.alias;d&&(n=d[0],w(r,C([0,1],d)));for(var f=1,h=!0;f<r.length;f+=1){var p=r[f],v=P(p,0,1),m=P(p,-1);if(('"'===v||"'"===v||"`"===v||'"'===m||"'"===m||"`"===m)&&v!==m)throw new o("property names with quotes must have matching quotes");if("constructor"!==p&&h||(l=!0),S(g,s="%"+(n+="."+p)+"%"))u=g[s];else if(null!=u){if(!(p in u)){if(!t)throw new a("base intrinsic for "+e+" exists, but the property is not available.");return}if(c&&f+1>=r.length){var y=c(u,p);u=(h=!!y)&&"get"in y&&!("originalValue"in y.get)?y.get:u[p]}else h=S(u,p),u=u[p];h&&!l&&(g[s]=u)}}return u}},92203:function(e){"use strict";var t={foo:{}},r=Object;e.exports=function(){return{__proto__:t}.foo===t.foo&&!({__proto__:null}instanceof r)}},80697:function(e,t,r){"use strict";var n="undefined"!==typeof Symbol&&Symbol,o=r(63297);e.exports=function(){return"function"===typeof n&&("function"===typeof Symbol&&("symbol"===typeof n("foo")&&("symbol"===typeof Symbol("bar")&&o())))}},63297:function(e){"use strict";e.exports=function(){if("function"!==typeof Symbol||"function"!==typeof Object.getOwnPropertySymbols)return!1;if("symbol"===typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"===typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(t in e[t]=42,e)return!1;if("function"===typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"===typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var n=Object.getOwnPropertySymbols(e);if(1!==n.length||n[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"===typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(e,t);if(42!==o.value||!0!==o.enumerable)return!1}return!0}},58316:function(e,t,r){"use strict";var n=r(33350);e.exports=n.call(Function.call,Object.prototype.hasOwnProperty)},5362:function(e,t,r){"use strict";r.d(t,{X3:function(){return b}});var n,o,i=r(1413),a=r(74165),s=r(15861),c=function(e,t){return t.some((function(t){return e instanceof t}))};var u=new WeakMap,l=new WeakMap,d=new WeakMap,f=new WeakMap,h=new WeakMap;var p={get:function(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return l.get(e);if("objectStoreNames"===t)return e.objectStoreNames||d.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return m(e[t])},set:function(e,t,r){return e[t]=r,!0},has:function(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function v(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(o||(o=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.apply(y(this),r),m(u.get(this))}:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return m(e.apply(y(this),r))}:function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];var i=e.call.apply(e,[y(this),t].concat(n));return d.set(i,t.sort?t.sort():[t]),m(i)}}function g(e){return"function"===typeof e?v(e):(e instanceof IDBTransaction&&function(e){if(!l.has(e)){var t=new Promise((function(t,r){var n=function(){e.removeEventListener("complete",o),e.removeEventListener("error",i),e.removeEventListener("abort",i)},o=function(){t(),n()},i=function(){r(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",o),e.addEventListener("error",i),e.addEventListener("abort",i)}));l.set(e,t)}}(e),c(e,n||(n=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,p):e)}function m(e){if(e instanceof IDBRequest)return function(e){var t=new Promise((function(t,r){var n=function(){e.removeEventListener("success",o),e.removeEventListener("error",i)},o=function(){t(m(e.result)),n()},i=function(){r(e.error),n()};e.addEventListener("success",o),e.addEventListener("error",i)}));return t.then((function(t){t instanceof IDBCursor&&u.set(t,e)})).catch((function(){})),h.set(t,e),t}(e);if(f.has(e))return f.get(e);var t=g(e);return t!==e&&(f.set(e,t),h.set(t,e)),t}var y=function(e){return h.get(e)};function b(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.blocked,o=r.upgrade,i=r.blocking,a=r.terminated,s=indexedDB.open(e,t),c=m(s);return o&&s.addEventListener("upgradeneeded",(function(e){o(m(s.result),e.oldVersion,e.newVersion,m(s.transaction))})),n&&s.addEventListener("blocked",(function(){return n()})),c.then((function(e){a&&e.addEventListener("close",(function(){return a()})),i&&e.addEventListener("versionchange",(function(){return i()}))})).catch((function(){})),c}var k=["get","getKey","getAll","getAllKeys","count"],S=["put","add","delete","clear"],C=new Map;function w(e,t){if(e instanceof IDBDatabase&&!(t in e)&&"string"===typeof t){if(C.get(t))return C.get(t);var r=t.replace(/FromIndex$/,""),n=t!==r,o=S.includes(r);if(r in(n?IDBIndex:IDBObjectStore).prototype&&(o||k.includes(r))){var i=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(t){var i,s,c,u,l,d,f=arguments;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(s=this.transaction(t,o?"readwrite":"readonly"),c=s.store,u=f.length,l=new Array(u>1?u-1:0),d=1;d<u;d++)l[d-1]=f[d];return n&&(c=c.index(l.shift())),e.next=6,Promise.all([(i=c)[r].apply(i,l),o&&s.done]);case 6:return e.abrupt("return",e.sent[0]);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}();return C.set(t,i),i}}}p=function(e){return(0,i.Z)((0,i.Z)({},e),{},{get:function(t,r,n){return w(t,r)||e.get(t,r,n)},has:function(t,r){return!!w(t,r)||e.has(t,r)}})}(p)},29676:function(e,t,r){var n=r(85403),o=r(62747),i=r(16037),a=r(94154),s=r(77728);function c(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}c.prototype.clear=n,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=a,c.prototype.set=s,e.exports=c},38384:function(e,t,r){var n=r(43894),o=r(8699),i=r(64957),a=r(87184),s=r(87109);function c(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}c.prototype.clear=n,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=a,c.prototype.set=s,e.exports=c},95797:function(e,t,r){var n=r(68136)(r(97009),"Map");e.exports=n},78059:function(e,t,r){var n=r(34086),o=r(9255),i=r(29186),a=r(13423),s=r(73739);function c(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}c.prototype.clear=n,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=a,c.prototype.set=s,e.exports=c},22854:function(e,t,r){var n=r(38384),o=r(20511),i=r(50835),a=r(90707),s=r(18832),c=r(35077);function u(e){var t=this.__data__=new n(e);this.size=t.size}u.prototype.clear=o,u.prototype.delete=i,u.prototype.get=a,u.prototype.has=s,u.prototype.set=c,e.exports=u},87197:function(e,t,r){var n=r(97009).Symbol;e.exports=n},46219:function(e,t,r){var n=r(97009).Uint8Array;e.exports=n},13665:function(e){e.exports=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}},47538:function(e,t,r){var n=r(86478),o=r(34963),i=r(93629),a=r(5174),s=r(26800),c=r(19102),u=Object.prototype.hasOwnProperty;e.exports=function(e,t){var r=i(e),l=!r&&o(e),d=!r&&!l&&a(e),f=!r&&!l&&!d&&c(e),h=r||l||d||f,p=h?n(e.length,String):[],v=p.length;for(var g in e)!t&&!u.call(e,g)||h&&("length"==g||d&&("offset"==g||"parent"==g)||f&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||s(g,v))||p.push(g);return p}},86479:function(e,t,r){var n=r(32526),o=r(29231);e.exports=function(e,t,r){(void 0!==r&&!o(e[t],r)||void 0===r&&!(t in e))&&n(e,t,r)}},18463:function(e,t,r){var n=r(32526),o=r(29231),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,r){var a=e[t];i.call(e,t)&&o(a,r)&&(void 0!==r||t in e)||n(e,t,r)}},27112:function(e,t,r){var n=r(29231);e.exports=function(e,t){for(var r=e.length;r--;)if(n(e[r][0],t))return r;return-1}},32526:function(e,t,r){var n=r(48528);e.exports=function(e,t,r){"__proto__"==t&&n?n(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}},65763:function(e,t,r){var n=r(8092),o=Object.create,i=function(){function e(){}return function(t){if(!n(t))return{};if(o)return o(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();e.exports=i},85099:function(e,t,r){var n=r(30372)();e.exports=n},39066:function(e,t,r){var n=r(87197),o=r(81587),i=r(43581),a=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a&&a in Object(e)?o(e):i(e)}},4906:function(e,t,r){var n=r(39066),o=r(43141);e.exports=function(e){return o(e)&&"[object Arguments]"==n(e)}},26703:function(e,t,r){var n=r(74786),o=r(257),i=r(8092),a=r(27907),s=/^\[object .+?Constructor\]$/,c=Function.prototype,u=Object.prototype,l=c.toString,d=u.hasOwnProperty,f=RegExp("^"+l.call(d).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!i(e)||o(e))&&(n(e)?f:s).test(a(e))}},68150:function(e,t,r){var n=r(39066),o=r(24635),i=r(43141),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,e.exports=function(e){return i(e)&&o(e.length)&&!!a[n(e)]}},8664:function(e,t,r){var n=r(8092),o=r(62936),i=r(4221),a=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return i(e);var t=o(e),r=[];for(var s in e)("constructor"!=s||!t&&a.call(e,s))&&r.push(s);return r}},64173:function(e,t,r){var n=r(22854),o=r(86479),i=r(85099),a=r(49216),s=r(8092),c=r(73961),u=r(85906);e.exports=function e(t,r,l,d,f){t!==r&&i(r,(function(i,c){if(f||(f=new n),s(i))a(t,r,c,l,e,d,f);else{var h=d?d(u(t,c),i,c+"",t,r,f):void 0;void 0===h&&(h=i),o(t,c,h)}}),c)}},49216:function(e,t,r){var n=r(86479),o=r(94523),i=r(40613),a=r(10291),s=r(40548),c=r(34963),u=r(93629),l=r(56279),d=r(5174),f=r(74786),h=r(8092),p=r(93977),v=r(19102),g=r(85906),m=r(6576);e.exports=function(e,t,r,y,b,k,S){var C=g(e,r),w=g(t,r),x=S.get(w);if(x)n(e,r,x);else{var P=k?k(C,w,r+"",e,t,S):void 0,E=void 0===P;if(E){var Z=u(w),T=!Z&&d(w),N=!Z&&!T&&v(w);P=w,Z||T||N?u(C)?P=C:l(C)?P=a(C):T?(E=!1,P=o(w,!0)):N?(E=!1,P=i(w,!0)):P=[]:p(w)||c(w)?(P=C,c(C)?P=m(C):h(C)&&!f(C)||(P=s(w))):E=!1}E&&(S.set(w,P),b(P,w,y,k,S),S.delete(w)),n(e,r,P)}}},58794:function(e,t,r){var n=r(2100),o=r(64262),i=r(79156);e.exports=function(e,t){return i(o(e,t,n),e+"")}},7532:function(e,t,r){var n=r(71547),o=r(48528),i=r(2100),a=o?function(e,t){return o(e,"toString",{configurable:!0,enumerable:!1,value:n(t),writable:!0})}:i;e.exports=a},86478:function(e){e.exports=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}},16194:function(e){e.exports=function(e){return function(t){return e(t)}}},7010:function(e,t,r){var n=r(46219);e.exports=function(e){var t=new e.constructor(e.byteLength);return new n(t).set(new n(e)),t}},94523:function(e,t,r){e=r.nmd(e);var n=r(97009),o=t&&!t.nodeType&&t,i=o&&e&&!e.nodeType&&e,a=i&&i.exports===o?n.Buffer:void 0,s=a?a.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var r=e.length,n=s?s(r):new e.constructor(r);return e.copy(n),n}},40613:function(e,t,r){var n=r(7010);e.exports=function(e,t){var r=t?n(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}},10291:function(e){e.exports=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}},64503:function(e,t,r){var n=r(18463),o=r(32526);e.exports=function(e,t,r,i){var a=!r;r||(r={});for(var s=-1,c=t.length;++s<c;){var u=t[s],l=i?i(r[u],e[u],u,r,e):void 0;void 0===l&&(l=e[u]),a?o(r,u,l):n(r,u,l)}return r}},65525:function(e,t,r){var n=r(97009)["__core-js_shared__"];e.exports=n},39934:function(e,t,r){var n=r(58794),o=r(3195);e.exports=function(e){return n((function(t,r){var n=-1,i=r.length,a=i>1?r[i-1]:void 0,s=i>2?r[2]:void 0;for(a=e.length>3&&"function"==typeof a?(i--,a):void 0,s&&o(r[0],r[1],s)&&(a=i<3?void 0:a,i=1),t=Object(t);++n<i;){var c=r[n];c&&e(t,c,n,a)}return t}))}},30372:function(e){e.exports=function(e){return function(t,r,n){for(var o=-1,i=Object(t),a=n(t),s=a.length;s--;){var c=a[e?s:++o];if(!1===r(i[c],c,i))break}return t}}},48528:function(e,t,r){var n=r(68136),o=function(){try{var e=n(Object,"defineProperty");return e({},"",{}),e}catch(t){}}();e.exports=o},31032:function(e,t,r){var n="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g;e.exports=n},32799:function(e,t,r){var n=r(55964);e.exports=function(e,t){var r=e.__data__;return n(t)?r["string"==typeof t?"string":"hash"]:r.map}},68136:function(e,t,r){var n=r(26703),o=r(30040);e.exports=function(e,t){var r=o(e,t);return n(r)?r:void 0}},31137:function(e,t,r){var n=r(12709)(Object.getPrototypeOf,Object);e.exports=n},81587:function(e,t,r){var n=r(87197),o=Object.prototype,i=o.hasOwnProperty,a=o.toString,s=n?n.toStringTag:void 0;e.exports=function(e){var t=i.call(e,s),r=e[s];try{e[s]=void 0;var n=!0}catch(c){}var o=a.call(e);return n&&(t?e[s]=r:delete e[s]),o}},30040:function(e){e.exports=function(e,t){return null==e?void 0:e[t]}},85403:function(e,t,r){var n=r(49620);e.exports=function(){this.__data__=n?n(null):{},this.size=0}},62747:function(e){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},16037:function(e,t,r){var n=r(49620),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(n){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return o.call(t,e)?t[e]:void 0}},94154:function(e,t,r){var n=r(49620),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return n?void 0!==t[e]:o.call(t,e)}},77728:function(e,t,r){var n=r(49620);e.exports=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=n&&void 0===t?"__lodash_hash_undefined__":t,this}},40548:function(e,t,r){var n=r(65763),o=r(31137),i=r(62936);e.exports=function(e){return"function"!=typeof e.constructor||i(e)?{}:n(o(e))}},26800:function(e){var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,r){var n=typeof e;return!!(r=null==r?9007199254740991:r)&&("number"==n||"symbol"!=n&&t.test(e))&&e>-1&&e%1==0&&e<r}},3195:function(e,t,r){var n=r(29231),o=r(21473),i=r(26800),a=r(8092);e.exports=function(e,t,r){if(!a(r))return!1;var s=typeof t;return!!("number"==s?o(r)&&i(t,r.length):"string"==s&&t in r)&&n(r[t],e)}},55964:function(e){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},257:function(e,t,r){var n=r(65525),o=function(){var e=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();e.exports=function(e){return!!o&&o in e}},62936:function(e){var t=Object.prototype;e.exports=function(e){var r=e&&e.constructor;return e===("function"==typeof r&&r.prototype||t)}},43894:function(e){e.exports=function(){this.__data__=[],this.size=0}},8699:function(e,t,r){var n=r(27112),o=Array.prototype.splice;e.exports=function(e){var t=this.__data__,r=n(t,e);return!(r<0)&&(r==t.length-1?t.pop():o.call(t,r,1),--this.size,!0)}},64957:function(e,t,r){var n=r(27112);e.exports=function(e){var t=this.__data__,r=n(t,e);return r<0?void 0:t[r][1]}},87184:function(e,t,r){var n=r(27112);e.exports=function(e){return n(this.__data__,e)>-1}},87109:function(e,t,r){var n=r(27112);e.exports=function(e,t){var r=this.__data__,o=n(r,e);return o<0?(++this.size,r.push([e,t])):r[o][1]=t,this}},34086:function(e,t,r){var n=r(29676),o=r(38384),i=r(95797);e.exports=function(){this.size=0,this.__data__={hash:new n,map:new(i||o),string:new n}}},9255:function(e,t,r){var n=r(32799);e.exports=function(e){var t=n(this,e).delete(e);return this.size-=t?1:0,t}},29186:function(e,t,r){var n=r(32799);e.exports=function(e){return n(this,e).get(e)}},13423:function(e,t,r){var n=r(32799);e.exports=function(e){return n(this,e).has(e)}},73739:function(e,t,r){var n=r(32799);e.exports=function(e,t){var r=n(this,e),o=r.size;return r.set(e,t),this.size+=r.size==o?0:1,this}},49620:function(e,t,r){var n=r(68136)(Object,"create");e.exports=n},4221:function(e){e.exports=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}},49494:function(e,t,r){e=r.nmd(e);var n=r(31032),o=t&&!t.nodeType&&t,i=o&&e&&!e.nodeType&&e,a=i&&i.exports===o&&n.process,s=function(){try{var e=i&&i.require&&i.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(t){}}();e.exports=s},43581:function(e){var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},12709:function(e){e.exports=function(e,t){return function(r){return e(t(r))}}},64262:function(e,t,r){var n=r(13665),o=Math.max;e.exports=function(e,t,r){return t=o(void 0===t?e.length-1:t,0),function(){for(var i=arguments,a=-1,s=o(i.length-t,0),c=Array(s);++a<s;)c[a]=i[t+a];a=-1;for(var u=Array(t+1);++a<t;)u[a]=i[a];return u[t]=r(c),n(e,this,u)}}},97009:function(e,t,r){var n=r(31032),o="object"==typeof self&&self&&self.Object===Object&&self,i=n||o||Function("return this")();e.exports=i},85906:function(e){e.exports=function(e,t){if(("constructor"!==t||"function"!==typeof e[t])&&"__proto__"!=t)return e[t]}},79156:function(e,t,r){var n=r(7532),o=r(83197)(n);e.exports=o},83197:function(e){var t=Date.now;e.exports=function(e){var r=0,n=0;return function(){var o=t(),i=16-(o-n);if(n=o,i>0){if(++r>=800)return arguments[0]}else r=0;return e.apply(void 0,arguments)}}},20511:function(e,t,r){var n=r(38384);e.exports=function(){this.__data__=new n,this.size=0}},50835:function(e){e.exports=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}},90707:function(e){e.exports=function(e){return this.__data__.get(e)}},18832:function(e){e.exports=function(e){return this.__data__.has(e)}},35077:function(e,t,r){var n=r(38384),o=r(95797),i=r(78059);e.exports=function(e,t){var r=this.__data__;if(r instanceof n){var a=r.__data__;if(!o||a.length<199)return a.push([e,t]),this.size=++r.size,this;r=this.__data__=new i(a)}return r.set(e,t),this.size=r.size,this}},27907:function(e){var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(r){}try{return e+""}catch(r){}}return""}},71547:function(e){e.exports=function(e){return function(){return e}}},29231:function(e){e.exports=function(e,t){return e===t||e!==e&&t!==t}},2100:function(e){e.exports=function(e){return e}},34963:function(e,t,r){var n=r(4906),o=r(43141),i=Object.prototype,a=i.hasOwnProperty,s=i.propertyIsEnumerable,c=n(function(){return arguments}())?n:function(e){return o(e)&&a.call(e,"callee")&&!s.call(e,"callee")};e.exports=c},93629:function(e){var t=Array.isArray;e.exports=t},21473:function(e,t,r){var n=r(74786),o=r(24635);e.exports=function(e){return null!=e&&o(e.length)&&!n(e)}},56279:function(e,t,r){var n=r(21473),o=r(43141);e.exports=function(e){return o(e)&&n(e)}},5174:function(e,t,r){e=r.nmd(e);var n=r(97009),o=r(49488),i=t&&!t.nodeType&&t,a=i&&e&&!e.nodeType&&e,s=a&&a.exports===i?n.Buffer:void 0,c=(s?s.isBuffer:void 0)||o;e.exports=c},74786:function(e,t,r){var n=r(39066),o=r(8092);e.exports=function(e){if(!o(e))return!1;var t=n(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},24635:function(e){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},8092:function(e){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},43141:function(e){e.exports=function(e){return null!=e&&"object"==typeof e}},93977:function(e,t,r){var n=r(39066),o=r(31137),i=r(43141),a=Function.prototype,s=Object.prototype,c=a.toString,u=s.hasOwnProperty,l=c.call(Object);e.exports=function(e){if(!i(e)||"[object Object]"!=n(e))return!1;var t=o(e);if(null===t)return!0;var r=u.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&c.call(r)==l}},19102:function(e,t,r){var n=r(68150),o=r(16194),i=r(49494),a=i&&i.isTypedArray,s=a?o(a):n;e.exports=s},73961:function(e,t,r){var n=r(47538),o=r(8664),i=r(21473);e.exports=function(e){return i(e)?n(e,!0):o(e)}},79286:function(e,t,r){var n=r(64173),o=r(39934)((function(e,t,r){n(e,t,r)}));e.exports=o},49488:function(e){e.exports=function(){return!1}},6576:function(e,t,r){var n=r(64503),o=r(73961);e.exports=function(e){return n(e,o(e))}},78193:function(e){var t=1e3,r=60*t,n=60*r,o=24*n,i=7*o,a=365.25*o;function s(e,t,r,n){var o=t>=1.5*r;return Math.round(e/r)+" "+n+(o?"s":"")}e.exports=function(e,c){c=c||{};var u=typeof e;if("string"===u&&e.length>0)return function(e){if((e=String(e)).length>100)return;var s=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!s)return;var c=parseFloat(s[1]);switch((s[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*a;case"weeks":case"week":case"w":return c*i;case"days":case"day":case"d":return c*o;case"hours":case"hour":case"hrs":case"hr":case"h":return c*n;case"minutes":case"minute":case"mins":case"min":case"m":return c*r;case"seconds":case"second":case"secs":case"sec":case"s":return c*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(e);if("number"===u&&isFinite(e))return c.long?function(e){var i=Math.abs(e);if(i>=o)return s(e,i,o,"day");if(i>=n)return s(e,i,n,"hour");if(i>=r)return s(e,i,r,"minute");if(i>=t)return s(e,i,t,"second");return e+" ms"}(e):function(e){var i=Math.abs(e);if(i>=o)return Math.round(e/o)+"d";if(i>=n)return Math.round(e/n)+"h";if(i>=r)return Math.round(e/r)+"m";if(i>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},45359:function(e,t,r){"use strict";var n=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof r.g)return r.g;throw new Error("unable to locate global object")}();e.exports=t=n.fetch,n.fetch&&(t.default=n.fetch.bind(n)),t.Headers=n.Headers,t.Request=n.Request,t.Response=n.Response},31725:function(e){"use strict";var t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(e){n[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(o){return!1}}()?Object.assign:function(e,o){for(var i,a,s=function(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),c=1;c<arguments.length;c++){for(var u in i=Object(arguments[c]))r.call(i,u)&&(s[u]=i[u]);if(t){a=t(i);for(var l=0;l<a.length;l++)n.call(i,a[l])&&(s[a[l]]=i[a[l]])}}return s}},42584:function(e,t,r){var n="function"===typeof Map&&Map.prototype,o=Object.getOwnPropertyDescriptor&&n?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,i=n&&o&&"function"===typeof o.get?o.get:null,a=n&&Map.prototype.forEach,s="function"===typeof Set&&Set.prototype,c=Object.getOwnPropertyDescriptor&&s?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,u=s&&c&&"function"===typeof c.get?c.get:null,l=s&&Set.prototype.forEach,d="function"===typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,f="function"===typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,h="function"===typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,p=Boolean.prototype.valueOf,v=Object.prototype.toString,g=Function.prototype.toString,m=String.prototype.match,y=String.prototype.slice,b=String.prototype.replace,k=String.prototype.toUpperCase,S=String.prototype.toLowerCase,C=RegExp.prototype.test,w=Array.prototype.concat,x=Array.prototype.join,P=Array.prototype.slice,E=Math.floor,Z="function"===typeof BigInt?BigInt.prototype.valueOf:null,T=Object.getOwnPropertySymbols,N="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?Symbol.prototype.toString:null,F="function"===typeof Symbol&&"object"===typeof Symbol.iterator,I="function"===typeof Symbol&&Symbol.toStringTag&&(typeof Symbol.toStringTag===F||"symbol")?Symbol.toStringTag:null,B=Object.prototype.propertyIsEnumerable,D=("function"===typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function A(e,t){if(e===1/0||e===-1/0||e!==e||e&&e>-1e3&&e<1e3||C.call(/e/,t))return t;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"===typeof e){var n=e<0?-E(-e):E(e);if(n!==e){var o=String(n),i=y.call(t,o.length+1);return b.call(o,r,"$&_")+"."+b.call(b.call(i,/([0-9]{3})/g,"$&_"),/_$/,"")}}return b.call(t,r,"$&_")}var O=r(24654),L=O.custom,_=U(L)?L:null;function M(e,t,r){var n="double"===(r.quoteStyle||t)?'"':"'";return n+e+n}function R(e){return b.call(String(e),/"/g,"&quot;")}function H(e){return"[object Array]"===Y(e)&&(!I||!("object"===typeof e&&I in e))}function j(e){return"[object RegExp]"===Y(e)&&(!I||!("object"===typeof e&&I in e))}function U(e){if(F)return e&&"object"===typeof e&&e instanceof Symbol;if("symbol"===typeof e)return!0;if(!e||"object"!==typeof e||!N)return!1;try{return N.call(e),!0}catch(t){}return!1}e.exports=function e(t,r,n,o){var s=r||{};if(z(s,"quoteStyle")&&"single"!==s.quoteStyle&&"double"!==s.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(z(s,"maxStringLength")&&("number"===typeof s.maxStringLength?s.maxStringLength<0&&s.maxStringLength!==1/0:null!==s.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var c=!z(s,"customInspect")||s.customInspect;if("boolean"!==typeof c&&"symbol"!==c)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(z(s,"indent")&&null!==s.indent&&"\t"!==s.indent&&!(parseInt(s.indent,10)===s.indent&&s.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(z(s,"numericSeparator")&&"boolean"!==typeof s.numericSeparator)throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var v=s.numericSeparator;if("undefined"===typeof t)return"undefined";if(null===t)return"null";if("boolean"===typeof t)return t?"true":"false";if("string"===typeof t)return G(t,s);if("number"===typeof t){if(0===t)return 1/0/t>0?"0":"-0";var k=String(t);return v?A(t,k):k}if("bigint"===typeof t){var C=String(t)+"n";return v?A(t,C):C}var E="undefined"===typeof s.depth?5:s.depth;if("undefined"===typeof n&&(n=0),n>=E&&E>0&&"object"===typeof t)return H(t)?"[Array]":"[Object]";var T=function(e,t){var r;if("\t"===e.indent)r="\t";else{if(!("number"===typeof e.indent&&e.indent>0))return null;r=x.call(Array(e.indent+1)," ")}return{base:r,prev:x.call(Array(t+1),r)}}(s,n);if("undefined"===typeof o)o=[];else if(V(o,t)>=0)return"[Circular]";function L(t,r,i){if(r&&(o=P.call(o)).push(r),i){var a={depth:s.depth};return z(s,"quoteStyle")&&(a.quoteStyle=s.quoteStyle),e(t,a,n+1,o)}return e(t,s,n+1,o)}if("function"===typeof t&&!j(t)){var q=function(e){if(e.name)return e.name;var t=m.call(g.call(e),/^function\s*([\w$]+)/);if(t)return t[1];return null}(t),W=$(t,L);return"[Function"+(q?": "+q:" (anonymous)")+"]"+(W.length>0?" { "+x.call(W,", ")+" }":"")}if(U(t)){var ee=F?b.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):N.call(t);return"object"!==typeof t||F?ee:J(ee)}if(function(e){if(!e||"object"!==typeof e)return!1;if("undefined"!==typeof HTMLElement&&e instanceof HTMLElement)return!0;return"string"===typeof e.nodeName&&"function"===typeof e.getAttribute}(t)){for(var te="<"+S.call(String(t.nodeName)),re=t.attributes||[],ne=0;ne<re.length;ne++)te+=" "+re[ne].name+"="+M(R(re[ne].value),"double",s);return te+=">",t.childNodes&&t.childNodes.length&&(te+="..."),te+="</"+S.call(String(t.nodeName))+">"}if(H(t)){if(0===t.length)return"[]";var oe=$(t,L);return T&&!function(e){for(var t=0;t<e.length;t++)if(V(e[t],"\n")>=0)return!1;return!0}(oe)?"["+X(oe,T)+"]":"[ "+x.call(oe,", ")+" ]"}if(function(e){return"[object Error]"===Y(e)&&(!I||!("object"===typeof e&&I in e))}(t)){var ie=$(t,L);return"cause"in Error.prototype||!("cause"in t)||B.call(t,"cause")?0===ie.length?"["+String(t)+"]":"{ ["+String(t)+"] "+x.call(ie,", ")+" }":"{ ["+String(t)+"] "+x.call(w.call("[cause]: "+L(t.cause),ie),", ")+" }"}if("object"===typeof t&&c){if(_&&"function"===typeof t[_]&&O)return O(t,{depth:E-n});if("symbol"!==c&&"function"===typeof t.inspect)return t.inspect()}if(function(e){if(!i||!e||"object"!==typeof e)return!1;try{i.call(e);try{u.call(e)}catch(te){return!0}return e instanceof Map}catch(t){}return!1}(t)){var ae=[];return a&&a.call(t,(function(e,r){ae.push(L(r,t,!0)+" => "+L(e,t))})),Q("Map",i.call(t),ae,T)}if(function(e){if(!u||!e||"object"!==typeof e)return!1;try{u.call(e);try{i.call(e)}catch(t){return!0}return e instanceof Set}catch(r){}return!1}(t)){var se=[];return l&&l.call(t,(function(e){se.push(L(e,t))})),Q("Set",u.call(t),se,T)}if(function(e){if(!d||!e||"object"!==typeof e)return!1;try{d.call(e,d);try{f.call(e,f)}catch(te){return!0}return e instanceof WeakMap}catch(t){}return!1}(t))return K("WeakMap");if(function(e){if(!f||!e||"object"!==typeof e)return!1;try{f.call(e,f);try{d.call(e,d)}catch(te){return!0}return e instanceof WeakSet}catch(t){}return!1}(t))return K("WeakSet");if(function(e){if(!h||!e||"object"!==typeof e)return!1;try{return h.call(e),!0}catch(t){}return!1}(t))return K("WeakRef");if(function(e){return"[object Number]"===Y(e)&&(!I||!("object"===typeof e&&I in e))}(t))return J(L(Number(t)));if(function(e){if(!e||"object"!==typeof e||!Z)return!1;try{return Z.call(e),!0}catch(t){}return!1}(t))return J(L(Z.call(t)));if(function(e){return"[object Boolean]"===Y(e)&&(!I||!("object"===typeof e&&I in e))}(t))return J(p.call(t));if(function(e){return"[object String]"===Y(e)&&(!I||!("object"===typeof e&&I in e))}(t))return J(L(String(t)));if(!function(e){return"[object Date]"===Y(e)&&(!I||!("object"===typeof e&&I in e))}(t)&&!j(t)){var ce=$(t,L),ue=D?D(t)===Object.prototype:t instanceof Object||t.constructor===Object,le=t instanceof Object?"":"null prototype",de=!ue&&I&&Object(t)===t&&I in t?y.call(Y(t),8,-1):le?"Object":"",fe=(ue||"function"!==typeof t.constructor?"":t.constructor.name?t.constructor.name+" ":"")+(de||le?"["+x.call(w.call([],de||[],le||[]),": ")+"] ":"");return 0===ce.length?fe+"{}":T?fe+"{"+X(ce,T)+"}":fe+"{ "+x.call(ce,", ")+" }"}return String(t)};var q=Object.prototype.hasOwnProperty||function(e){return e in this};function z(e,t){return q.call(e,t)}function Y(e){return v.call(e)}function V(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}function G(e,t){if(e.length>t.maxStringLength){var r=e.length-t.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return G(y.call(e,0,t.maxStringLength),t)+n}return M(b.call(b.call(e,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,W),"single",t)}function W(e){var t=e.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return r?"\\"+r:"\\x"+(t<16?"0":"")+k.call(t.toString(16))}function J(e){return"Object("+e+")"}function K(e){return e+" { ? }"}function Q(e,t,r,n){return e+" ("+t+") {"+(n?X(r,n):x.call(r,", "))+"}"}function X(e,t){if(0===e.length)return"";var r="\n"+t.prev+t.base;return r+x.call(e,","+r)+"\n"+t.prev}function $(e,t){var r=H(e),n=[];if(r){n.length=e.length;for(var o=0;o<e.length;o++)n[o]=z(e,o)?t(e[o],e):""}var i,a="function"===typeof T?T(e):[];if(F){i={};for(var s=0;s<a.length;s++)i["$"+a[s]]=a[s]}for(var c in e)z(e,c)&&(r&&String(Number(c))===c&&c<e.length||F&&i["$"+c]instanceof Symbol||(C.call(/[^\w$]/,c)?n.push(t(c,e)+": "+t(e[c],e)):n.push(c+": "+t(e[c],e))));if("function"===typeof T)for(var u=0;u<a.length;u++)B.call(e,a[u])&&n.push("["+t(a[u])+"]: "+t(e[a[u]],e));return n}},59874:function(e){"use strict";var t=String.prototype.replace,r=/%20/g,n="RFC1738",o="RFC3986";e.exports={default:o,formatters:{RFC1738:function(e){return t.call(e,r,"+")},RFC3986:function(e){return String(e)}},RFC1738:n,RFC3986:o}},32808:function(e,t,r){"use strict";var n=r(22334),o=r(4360),i=r(59874);e.exports={formats:i,parse:o,stringify:n}},4360:function(e,t,r){"use strict";var n=r(64184),o=Object.prototype.hasOwnProperty,i=Array.isArray,a={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:n.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},s=function(e){return e.replace(/&#(\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},c=function(e,t){return e&&"string"===typeof e&&t.comma&&e.indexOf(",")>-1?e.split(","):e},u=function(e,t,r,n){if(e){var i=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,a=/(\[[^[\]]*])/g,s=r.depth>0&&/(\[[^[\]]*])/.exec(i),u=s?i.slice(0,s.index):i,l=[];if(u){if(!r.plainObjects&&o.call(Object.prototype,u)&&!r.allowPrototypes)return;l.push(u)}for(var d=0;r.depth>0&&null!==(s=a.exec(i))&&d<r.depth;){if(d+=1,!r.plainObjects&&o.call(Object.prototype,s[1].slice(1,-1))&&!r.allowPrototypes)return;l.push(s[1])}return s&&l.push("["+i.slice(s.index)+"]"),function(e,t,r,n){for(var o=n?t:c(t,r),i=e.length-1;i>=0;--i){var a,s=e[i];if("[]"===s&&r.parseArrays)a=[].concat(o);else{a=r.plainObjects?Object.create(null):{};var u="["===s.charAt(0)&&"]"===s.charAt(s.length-1)?s.slice(1,-1):s,l=parseInt(u,10);r.parseArrays||""!==u?!isNaN(l)&&s!==u&&String(l)===u&&l>=0&&r.parseArrays&&l<=r.arrayLimit?(a=[])[l]=o:"__proto__"!==u&&(a[u]=o):a={0:o}}o=a}return o}(l,t,r,n)}};e.exports=function(e,t){var r=function(e){if(!e)return a;if(null!==e.decoder&&void 0!==e.decoder&&"function"!==typeof e.decoder)throw new TypeError("Decoder has to be a function.");if("undefined"!==typeof e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var t="undefined"===typeof e.charset?a.charset:e.charset;return{allowDots:"undefined"===typeof e.allowDots?a.allowDots:!!e.allowDots,allowPrototypes:"boolean"===typeof e.allowPrototypes?e.allowPrototypes:a.allowPrototypes,allowSparse:"boolean"===typeof e.allowSparse?e.allowSparse:a.allowSparse,arrayLimit:"number"===typeof e.arrayLimit?e.arrayLimit:a.arrayLimit,charset:t,charsetSentinel:"boolean"===typeof e.charsetSentinel?e.charsetSentinel:a.charsetSentinel,comma:"boolean"===typeof e.comma?e.comma:a.comma,decoder:"function"===typeof e.decoder?e.decoder:a.decoder,delimiter:"string"===typeof e.delimiter||n.isRegExp(e.delimiter)?e.delimiter:a.delimiter,depth:"number"===typeof e.depth||!1===e.depth?+e.depth:a.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:"boolean"===typeof e.interpretNumericEntities?e.interpretNumericEntities:a.interpretNumericEntities,parameterLimit:"number"===typeof e.parameterLimit?e.parameterLimit:a.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:"boolean"===typeof e.plainObjects?e.plainObjects:a.plainObjects,strictNullHandling:"boolean"===typeof e.strictNullHandling?e.strictNullHandling:a.strictNullHandling}}(t);if(""===e||null===e||"undefined"===typeof e)return r.plainObjects?Object.create(null):{};for(var l="string"===typeof e?function(e,t){var r,u={},l=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,d=t.parameterLimit===1/0?void 0:t.parameterLimit,f=l.split(t.delimiter,d),h=-1,p=t.charset;if(t.charsetSentinel)for(r=0;r<f.length;++r)0===f[r].indexOf("utf8=")&&("utf8=%E2%9C%93"===f[r]?p="utf-8":"utf8=%26%2310003%3B"===f[r]&&(p="iso-8859-1"),h=r,r=f.length);for(r=0;r<f.length;++r)if(r!==h){var v,g,m=f[r],y=m.indexOf("]="),b=-1===y?m.indexOf("="):y+1;-1===b?(v=t.decoder(m,a.decoder,p,"key"),g=t.strictNullHandling?null:""):(v=t.decoder(m.slice(0,b),a.decoder,p,"key"),g=n.maybeMap(c(m.slice(b+1),t),(function(e){return t.decoder(e,a.decoder,p,"value")}))),g&&t.interpretNumericEntities&&"iso-8859-1"===p&&(g=s(g)),m.indexOf("[]=")>-1&&(g=i(g)?[g]:g),o.call(u,v)?u[v]=n.combine(u[v],g):u[v]=g}return u}(e,r):e,d=r.plainObjects?Object.create(null):{},f=Object.keys(l),h=0;h<f.length;++h){var p=f[h],v=u(p,l[p],r,"string"===typeof e);d=n.merge(d,v,r)}return!0===r.allowSparse?d:n.compact(d)}},22334:function(e,t,r){"use strict";var n=r(40581),o=r(64184),i=r(59874),a=Object.prototype.hasOwnProperty,s={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},c=Array.isArray,u=String.prototype.split,l=Array.prototype.push,d=function(e,t){l.apply(e,c(t)?t:[t])},f=Date.prototype.toISOString,h=i.default,p={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:o.encode,encodeValuesOnly:!1,format:h,formatter:i.formatters[h],indices:!1,serializeDate:function(e){return f.call(e)},skipNulls:!1,strictNullHandling:!1},v={},g=function e(t,r,i,a,s,l,f,h,g,m,y,b,k,S,C,w){for(var x,P=t,E=w,Z=0,T=!1;void 0!==(E=E.get(v))&&!T;){var N=E.get(t);if(Z+=1,"undefined"!==typeof N){if(N===Z)throw new RangeError("Cyclic object value");T=!0}"undefined"===typeof E.get(v)&&(Z=0)}if("function"===typeof h?P=h(r,P):P instanceof Date?P=y(P):"comma"===i&&c(P)&&(P=o.maybeMap(P,(function(e){return e instanceof Date?y(e):e}))),null===P){if(s)return f&&!S?f(r,p.encoder,C,"key",b):r;P=""}if("string"===typeof(x=P)||"number"===typeof x||"boolean"===typeof x||"symbol"===typeof x||"bigint"===typeof x||o.isBuffer(P)){if(f){var F=S?r:f(r,p.encoder,C,"key",b);if("comma"===i&&S){for(var I=u.call(String(P),","),B="",D=0;D<I.length;++D)B+=(0===D?"":",")+k(f(I[D],p.encoder,C,"value",b));return[k(F)+(a&&c(P)&&1===I.length?"[]":"")+"="+B]}return[k(F)+"="+k(f(P,p.encoder,C,"value",b))]}return[k(r)+"="+k(String(P))]}var A,O=[];if("undefined"===typeof P)return O;if("comma"===i&&c(P))A=[{value:P.length>0?P.join(",")||null:void 0}];else if(c(h))A=h;else{var L=Object.keys(P);A=g?L.sort(g):L}for(var _=a&&c(P)&&1===P.length?r+"[]":r,M=0;M<A.length;++M){var R=A[M],H="object"===typeof R&&"undefined"!==typeof R.value?R.value:P[R];if(!l||null!==H){var j=c(P)?"function"===typeof i?i(_,R):_:_+(m?"."+R:"["+R+"]");w.set(t,Z);var U=n();U.set(v,w),d(O,e(H,j,i,a,s,l,f,h,g,m,y,b,k,S,C,U))}}return O};e.exports=function(e,t){var r,o=e,u=function(e){if(!e)return p;if(null!==e.encoder&&"undefined"!==typeof e.encoder&&"function"!==typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||p.charset;if("undefined"!==typeof e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=i.default;if("undefined"!==typeof e.format){if(!a.call(i.formatters,e.format))throw new TypeError("Unknown format option provided.");r=e.format}var n=i.formatters[r],o=p.filter;return("function"===typeof e.filter||c(e.filter))&&(o=e.filter),{addQueryPrefix:"boolean"===typeof e.addQueryPrefix?e.addQueryPrefix:p.addQueryPrefix,allowDots:"undefined"===typeof e.allowDots?p.allowDots:!!e.allowDots,charset:t,charsetSentinel:"boolean"===typeof e.charsetSentinel?e.charsetSentinel:p.charsetSentinel,delimiter:"undefined"===typeof e.delimiter?p.delimiter:e.delimiter,encode:"boolean"===typeof e.encode?e.encode:p.encode,encoder:"function"===typeof e.encoder?e.encoder:p.encoder,encodeValuesOnly:"boolean"===typeof e.encodeValuesOnly?e.encodeValuesOnly:p.encodeValuesOnly,filter:o,format:r,formatter:n,serializeDate:"function"===typeof e.serializeDate?e.serializeDate:p.serializeDate,skipNulls:"boolean"===typeof e.skipNulls?e.skipNulls:p.skipNulls,sort:"function"===typeof e.sort?e.sort:null,strictNullHandling:"boolean"===typeof e.strictNullHandling?e.strictNullHandling:p.strictNullHandling}}(t);"function"===typeof u.filter?o=(0,u.filter)("",o):c(u.filter)&&(r=u.filter);var l,f=[];if("object"!==typeof o||null===o)return"";l=t&&t.arrayFormat in s?t.arrayFormat:t&&"indices"in t?t.indices?"indices":"repeat":"indices";var h=s[l];if(t&&"commaRoundTrip"in t&&"boolean"!==typeof t.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var v="comma"===h&&t&&t.commaRoundTrip;r||(r=Object.keys(o)),u.sort&&r.sort(u.sort);for(var m=n(),y=0;y<r.length;++y){var b=r[y];u.skipNulls&&null===o[b]||d(f,g(o[b],b,h,v,u.strictNullHandling,u.skipNulls,u.encode?u.encoder:null,u.filter,u.sort,u.allowDots,u.serializeDate,u.format,u.formatter,u.encodeValuesOnly,u.charset,m))}var k=f.join(u.delimiter),S=!0===u.addQueryPrefix?"?":"";return u.charsetSentinel&&("iso-8859-1"===u.charset?S+="utf8=%26%2310003%3B&":S+="utf8=%E2%9C%93&"),k.length>0?S+k:""}},64184:function(e,t,r){"use strict";var n=r(59874),o=Object.prototype.hasOwnProperty,i=Array.isArray,a=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),s=function(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},n=0;n<e.length;++n)"undefined"!==typeof e[n]&&(r[n]=e[n]);return r};e.exports={arrayToObject:s,assign:function(e,t){return Object.keys(t).reduce((function(e,r){return e[r]=t[r],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],n=0;n<t.length;++n)for(var o=t[n],a=o.obj[o.prop],s=Object.keys(a),c=0;c<s.length;++c){var u=s[c],l=a[u];"object"===typeof l&&null!==l&&-1===r.indexOf(l)&&(t.push({obj:a,prop:u}),r.push(l))}return function(e){for(;e.length>1;){var t=e.pop(),r=t.obj[t.prop];if(i(r)){for(var n=[],o=0;o<r.length;++o)"undefined"!==typeof r[o]&&n.push(r[o]);t.obj[t.prop]=n}}}(t),e},decode:function(e,t,r){var n=e.replace(/\+/g," ");if("iso-8859-1"===r)return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch(o){return n}},encode:function(e,t,r,o,i){if(0===e.length)return e;var s=e;if("symbol"===typeof e?s=Symbol.prototype.toString.call(e):"string"!==typeof e&&(s=String(e)),"iso-8859-1"===r)return escape(s).replace(/%u[0-9a-f]{4}/gi,(function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"}));for(var c="",u=0;u<s.length;++u){var l=s.charCodeAt(u);45===l||46===l||95===l||126===l||l>=48&&l<=57||l>=65&&l<=90||l>=97&&l<=122||i===n.RFC1738&&(40===l||41===l)?c+=s.charAt(u):l<128?c+=a[l]:l<2048?c+=a[192|l>>6]+a[128|63&l]:l<55296||l>=57344?c+=a[224|l>>12]+a[128|l>>6&63]+a[128|63&l]:(u+=1,l=65536+((1023&l)<<10|1023&s.charCodeAt(u)),c+=a[240|l>>18]+a[128|l>>12&63]+a[128|l>>6&63]+a[128|63&l])}return c},isBuffer:function(e){return!(!e||"object"!==typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},maybeMap:function(e,t){if(i(e)){for(var r=[],n=0;n<e.length;n+=1)r.push(t(e[n]));return r}return t(e)},merge:function e(t,r,n){if(!r)return t;if("object"!==typeof r){if(i(t))t.push(r);else{if(!t||"object"!==typeof t)return[t,r];(n&&(n.plainObjects||n.allowPrototypes)||!o.call(Object.prototype,r))&&(t[r]=!0)}return t}if(!t||"object"!==typeof t)return[t].concat(r);var a=t;return i(t)&&!i(r)&&(a=s(t,n)),i(t)&&i(r)?(r.forEach((function(r,i){if(o.call(t,i)){var a=t[i];a&&"object"===typeof a&&r&&"object"===typeof r?t[i]=e(a,r,n):t.push(r)}else t[i]=r})),t):Object.keys(r).reduce((function(t,i){var a=r[i];return o.call(t,i)?t[i]=e(t[i],a,n):t[i]=a,t}),a)}}},59117:function(e,t,r){"use strict";var n=r(31725),o=60103,i=60106;t.Fragment=60107,t.StrictMode=60108,t.Profiler=60114;var a=60109,s=60110,c=60112;t.Suspense=60113;var u=60115,l=60116;if("function"===typeof Symbol&&Symbol.for){var d=Symbol.for;o=d("react.element"),i=d("react.portal"),t.Fragment=d("react.fragment"),t.StrictMode=d("react.strict_mode"),t.Profiler=d("react.profiler"),a=d("react.provider"),s=d("react.context"),c=d("react.forward_ref"),t.Suspense=d("react.suspense"),u=d("react.memo"),l=d("react.lazy")}var f="function"===typeof Symbol&&Symbol.iterator;function h(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v={};function g(e,t,r){this.props=e,this.context=t,this.refs=v,this.updater=r||p}function m(){}function y(e,t,r){this.props=e,this.context=t,this.refs=v,this.updater=r||p}g.prototype.isReactComponent={},g.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error(h(85));this.updater.enqueueSetState(this,e,t,"setState")},g.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},m.prototype=g.prototype;var b=y.prototype=new m;b.constructor=y,n(b,g.prototype),b.isPureReactComponent=!0;var k={current:null},S=Object.prototype.hasOwnProperty,C={key:!0,ref:!0,__self:!0,__source:!0};function w(e,t,r){var n,i={},a=null,s=null;if(null!=t)for(n in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(a=""+t.key),t)S.call(t,n)&&!C.hasOwnProperty(n)&&(i[n]=t[n]);var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){for(var u=Array(c),l=0;l<c;l++)u[l]=arguments[l+2];i.children=u}if(e&&e.defaultProps)for(n in c=e.defaultProps)void 0===i[n]&&(i[n]=c[n]);return{$$typeof:o,type:e,key:a,ref:s,props:i,_owner:k.current}}function x(e){return"object"===typeof e&&null!==e&&e.$$typeof===o}var P=/\/+/g;function E(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function Z(e,t,r,n,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var c=!1;if(null===e)c=!0;else switch(s){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case o:case i:c=!0}}if(c)return a=a(c=e),e=""===n?"."+E(c,0):n,Array.isArray(a)?(r="",null!=e&&(r=e.replace(P,"$&/")+"/"),Z(a,t,r,"",(function(e){return e}))):null!=a&&(x(a)&&(a=function(e,t){return{$$typeof:o,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,r+(!a.key||c&&c.key===a.key?"":(""+a.key).replace(P,"$&/")+"/")+e)),t.push(a)),1;if(c=0,n=""===n?".":n+":",Array.isArray(e))for(var u=0;u<e.length;u++){var l=n+E(s=e[u],u);c+=Z(s,t,r,l,a)}else if(l=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof l)for(e=l.call(e),u=0;!(s=e.next()).done;)c+=Z(s=s.value,t,r,l=n+E(s,u++),a);else if("object"===s)throw t=""+e,Error(h(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t));return c}function T(e,t,r){if(null==e)return e;var n=[],o=0;return Z(e,n,"","",(function(e){return t.call(r,e,o++)})),n}function N(e){if(-1===e._status){var t=e._result;t=t(),e._status=0,e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}if(1===e._status)return e._result;throw e._result}var F={current:null};function I(){var e=F.current;if(null===e)throw Error(h(321));return e}var B={ReactCurrentDispatcher:F,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:k,IsSomeRendererActing:{current:!1},assign:n};t.Children={map:T,forEach:function(e,t,r){T(e,(function(){t.apply(this,arguments)}),r)},count:function(e){var t=0;return T(e,(function(){t++})),t},toArray:function(e){return T(e,(function(e){return e}))||[]},only:function(e){if(!x(e))throw Error(h(143));return e}},t.Component=g,t.PureComponent=y,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=B,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error(h(267,e));var i=n({},e.props),a=e.key,s=e.ref,c=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,c=k.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(l in t)S.call(t,l)&&!C.hasOwnProperty(l)&&(i[l]=void 0===t[l]&&void 0!==u?u[l]:t[l])}var l=arguments.length-2;if(1===l)i.children=r;else if(1<l){u=Array(l);for(var d=0;d<l;d++)u[d]=arguments[d+2];i.children=u}return{$$typeof:o,type:e.type,key:a,ref:s,props:i,_owner:c}},t.createContext=function(e,t){return void 0===t&&(t=null),(e={$$typeof:s,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=w,t.createFactory=function(e){var t=w.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=x,t.lazy=function(e){return{$$typeof:l,_payload:{_status:-1,_result:e},_init:N}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.useCallback=function(e,t){return I().useCallback(e,t)},t.useContext=function(e,t){return I().useContext(e,t)},t.useDebugValue=function(){},t.useEffect=function(e,t){return I().useEffect(e,t)},t.useImperativeHandle=function(e,t,r){return I().useImperativeHandle(e,t,r)},t.useLayoutEffect=function(e,t){return I().useLayoutEffect(e,t)},t.useMemo=function(e,t){return I().useMemo(e,t)},t.useReducer=function(e,t,r){return I().useReducer(e,t,r)},t.useRef=function(e){return I().useRef(e)},t.useState=function(e){return I().useState(e)},t.version="17.0.2"},72791:function(e,t,r){"use strict";e.exports=r(59117)},40581:function(e,t,r){"use strict";var n=r(52506),o=r(44037),i=r(42584),a=n("%TypeError%"),s=n("%WeakMap%",!0),c=n("%Map%",!0),u=o("WeakMap.prototype.get",!0),l=o("WeakMap.prototype.set",!0),d=o("WeakMap.prototype.has",!0),f=o("Map.prototype.get",!0),h=o("Map.prototype.set",!0),p=o("Map.prototype.has",!0),v=function(e,t){for(var r,n=e;null!==(r=n.next);n=r)if(r.key===t)return n.next=r.next,r.next=e.next,e.next=r,r};e.exports=function(){var e,t,r,n={assert:function(e){if(!n.has(e))throw new a("Side channel does not contain "+i(e))},get:function(n){if(s&&n&&("object"===typeof n||"function"===typeof n)){if(e)return u(e,n)}else if(c){if(t)return f(t,n)}else if(r)return function(e,t){var r=v(e,t);return r&&r.value}(r,n)},has:function(n){if(s&&n&&("object"===typeof n||"function"===typeof n)){if(e)return d(e,n)}else if(c){if(t)return p(t,n)}else if(r)return function(e,t){return!!v(e,t)}(r,n);return!1},set:function(n,o){s&&n&&("object"===typeof n||"function"===typeof n)?(e||(e=new s),l(e,n,o)):c?(t||(t=new c),h(t,n,o)):(r||(r={key:{},next:null}),function(e,t,r){var n=v(e,t);n?n.value=r:e.next={key:t,next:e.next,value:r}}(r,n,o))}};return n}},36369:function(e,t,r){var n;e=r.nmd(e),function(o){t&&t.nodeType,e&&e.nodeType;var i="object"==typeof r.g&&r.g;i.global!==i&&i.window!==i&&i.self;var a,s=2147483647,c=36,u=1,l=26,d=38,f=700,h=72,p=128,v="-",g=/^xn--/,m=/[^\x20-\x7E]/,y=/[\x2E\u3002\uFF0E\uFF61]/g,b={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},k=c-u,S=Math.floor,C=String.fromCharCode;function w(e){throw new RangeError(b[e])}function x(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function P(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),n+x((e=e.replace(y,".")).split("."),t).join(".")}function E(e){for(var t,r,n=[],o=0,i=e.length;o<i;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<i?56320==(64512&(r=e.charCodeAt(o++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),o--):n.push(t);return n}function Z(e){return x(e,(function(e){var t="";return e>65535&&(t+=C((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=C(e)})).join("")}function T(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function N(e,t,r){var n=0;for(e=r?S(e/f):e>>1,e+=S(e/t);e>k*l>>1;n+=c)e=S(e/k);return S(n+(k+1)*e/(e+d))}function F(e){var t,r,n,o,i,a,d,f,g,m,y,b=[],k=e.length,C=0,x=p,P=h;for((r=e.lastIndexOf(v))<0&&(r=0),n=0;n<r;++n)e.charCodeAt(n)>=128&&w("not-basic"),b.push(e.charCodeAt(n));for(o=r>0?r+1:0;o<k;){for(i=C,a=1,d=c;o>=k&&w("invalid-input"),((f=(y=e.charCodeAt(o++))-48<10?y-22:y-65<26?y-65:y-97<26?y-97:c)>=c||f>S((s-C)/a))&&w("overflow"),C+=f*a,!(f<(g=d<=P?u:d>=P+l?l:d-P));d+=c)a>S(s/(m=c-g))&&w("overflow"),a*=m;P=N(C-i,t=b.length+1,0==i),S(C/t)>s-x&&w("overflow"),x+=S(C/t),C%=t,b.splice(C++,0,x)}return Z(b)}function I(e){var t,r,n,o,i,a,d,f,g,m,y,b,k,x,P,Z=[];for(b=(e=E(e)).length,t=p,r=0,i=h,a=0;a<b;++a)(y=e[a])<128&&Z.push(C(y));for(n=o=Z.length,o&&Z.push(v);n<b;){for(d=s,a=0;a<b;++a)(y=e[a])>=t&&y<d&&(d=y);for(d-t>S((s-r)/(k=n+1))&&w("overflow"),r+=(d-t)*k,t=d,a=0;a<b;++a)if((y=e[a])<t&&++r>s&&w("overflow"),y==t){for(f=r,g=c;!(f<(m=g<=i?u:g>=i+l?l:g-i));g+=c)P=f-m,x=c-m,Z.push(C(T(m+P%x,0))),f=S(P/x);Z.push(C(T(f,0))),i=N(r,k,n==o),r=0,++n}++r,++t}return Z.join("")}a={version:"1.4.1",ucs2:{decode:E,encode:Z},decode:F,encode:I,toASCII:function(e){return P(e,(function(e){return m.test(e)?"xn--"+I(e):e}))},toUnicode:function(e){return P(e,(function(e){return g.test(e)?F(e.slice(4).toLowerCase()):e}))}},void 0===(n=function(){return a}.call(t,r,t,e))||(e.exports=n)}()},12114:function(e,t,r){"use strict";var n=r(36369);function o(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var i=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,s=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,c=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),u=["'"].concat(c),l=["%","/","?",";","#"].concat(u),d=["/","?","#"],f=/^[+a-z0-9A-Z_-]{0,63}$/,h=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,p={javascript:!0,"javascript:":!0},v={javascript:!0,"javascript:":!0},g={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},m=r(32808);function y(e,t,r){if(e&&"object"===typeof e&&e instanceof o)return e;var n=new o;return n.parse(e,t,r),n}o.prototype.parse=function(e,t,r){if("string"!==typeof e)throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var o=e.indexOf("?"),a=-1!==o&&o<e.indexOf("#")?"?":"#",c=e.split(a);c[0]=c[0].replace(/\\/g,"/");var y=e=c.join(a);if(y=y.trim(),!r&&1===e.split("#").length){var b=s.exec(y);if(b)return this.path=y,this.href=y,this.pathname=b[1],b[2]?(this.search=b[2],this.query=t?m.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var k=i.exec(y);if(k){var S=(k=k[0]).toLowerCase();this.protocol=S,y=y.substr(k.length)}if(r||k||y.match(/^\/\/[^@/]+@[^@/]+/)){var C="//"===y.substr(0,2);!C||k&&v[k]||(y=y.substr(2),this.slashes=!0)}if(!v[k]&&(C||k&&!g[k])){for(var w,x,P=-1,E=0;E<d.length;E++){-1!==(Z=y.indexOf(d[E]))&&(-1===P||Z<P)&&(P=Z)}-1!==(x=-1===P?y.lastIndexOf("@"):y.lastIndexOf("@",P))&&(w=y.slice(0,x),y=y.slice(x+1),this.auth=decodeURIComponent(w)),P=-1;for(E=0;E<l.length;E++){var Z;-1!==(Z=y.indexOf(l[E]))&&(-1===P||Z<P)&&(P=Z)}-1===P&&(P=y.length),this.host=y.slice(0,P),y=y.slice(P),this.parseHost(),this.hostname=this.hostname||"";var T="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!T)for(var N=this.hostname.split(/\./),F=(E=0,N.length);E<F;E++){var I=N[E];if(I&&!I.match(f)){for(var B="",D=0,A=I.length;D<A;D++)I.charCodeAt(D)>127?B+="x":B+=I[D];if(!B.match(f)){var O=N.slice(0,E),L=N.slice(E+1),_=I.match(h);_&&(O.push(_[1]),L.unshift(_[2])),L.length&&(y="/"+L.join(".")+y),this.hostname=O.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),T||(this.hostname=n.toASCII(this.hostname));var M=this.port?":"+this.port:"",R=this.hostname||"";this.host=R+M,this.href+=this.host,T&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==y[0]&&(y="/"+y))}if(!p[S])for(E=0,F=u.length;E<F;E++){var H=u[E];if(-1!==y.indexOf(H)){var j=encodeURIComponent(H);j===H&&(j=escape(H)),y=y.split(H).join(j)}}var U=y.indexOf("#");-1!==U&&(this.hash=y.substr(U),y=y.slice(0,U));var q=y.indexOf("?");if(-1!==q?(this.search=y.substr(q),this.query=y.substr(q+1),t&&(this.query=m.parse(this.query)),y=y.slice(0,q)):t&&(this.search="",this.query={}),y&&(this.pathname=y),g[S]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){M=this.pathname||"";var z=this.search||"";this.path=M+z}return this.href=this.format(),this},o.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",o=!1,i="";this.host?o=e+this.host:this.hostname&&(o=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&"object"===typeof this.query&&Object.keys(this.query).length&&(i=m.stringify(this.query));var a=this.search||i&&"?"+i||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||g[t])&&!1!==o?(o="//"+(o||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):o||(o=""),n&&"#"!==n.charAt(0)&&(n="#"+n),a&&"?"!==a.charAt(0)&&(a="?"+a),t+o+(r=r.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(a=a.replace("#","%23"))+n},o.prototype.resolve=function(e){return this.resolveObject(y(e,!1,!0)).format()},o.prototype.resolveObject=function(e){if("string"===typeof e){var t=new o;t.parse(e,!1,!0),e=t}for(var r=new o,n=Object.keys(this),i=0;i<n.length;i++){var a=n[i];r[a]=this[a]}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var s=Object.keys(e),c=0;c<s.length;c++){var u=s[c];"protocol"!==u&&(r[u]=e[u])}return g[r.protocol]&&r.hostname&&!r.pathname&&(r.pathname="/",r.path=r.pathname),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!g[e.protocol]){for(var l=Object.keys(e),d=0;d<l.length;d++){var f=l[d];r[f]=e[f]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||v[e.protocol])r.pathname=e.pathname;else{for(var h=(e.pathname||"").split("/");h.length&&!(e.host=h.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==h[0]&&h.unshift(""),h.length<2&&h.unshift(""),r.pathname=h.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var p=r.pathname||"",m=r.search||"";r.path=p+m}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var y=r.pathname&&"/"===r.pathname.charAt(0),b=e.host||e.pathname&&"/"===e.pathname.charAt(0),k=b||y||r.host&&e.pathname,S=k,C=r.pathname&&r.pathname.split("/")||[],w=(h=e.pathname&&e.pathname.split("/")||[],r.protocol&&!g[r.protocol]);if(w&&(r.hostname="",r.port=null,r.host&&(""===C[0]?C[0]=r.host:C.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===h[0]?h[0]=e.host:h.unshift(e.host)),e.host=null),k=k&&(""===h[0]||""===C[0])),b)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,C=h;else if(h.length)C||(C=[]),C.pop(),C=C.concat(h),r.search=e.search,r.query=e.query;else if(null!=e.search){if(w)r.host=C.shift(),r.hostname=r.host,(T=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=T.shift(),r.hostname=T.shift(),r.host=r.hostname);return r.search=e.search,r.query=e.query,null===r.pathname&&null===r.search||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!C.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var x=C.slice(-1)[0],P=(r.host||e.host||C.length>1)&&("."===x||".."===x)||""===x,E=0,Z=C.length;Z>=0;Z--)"."===(x=C[Z])?C.splice(Z,1):".."===x?(C.splice(Z,1),E++):E&&(C.splice(Z,1),E--);if(!k&&!S)for(;E--;E)C.unshift("..");!k||""===C[0]||C[0]&&"/"===C[0].charAt(0)||C.unshift(""),P&&"/"!==C.join("/").substr(-1)&&C.push("");var T,N=""===C[0]||C[0]&&"/"===C[0].charAt(0);w&&(r.hostname=N?"":C.length?C.shift():"",r.host=r.hostname,(T=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=T.shift(),r.hostname=T.shift(),r.host=r.hostname));return(k=k||r.host&&C.length)&&!N&&C.unshift(""),C.length>0?r.pathname=C.join("/"):(r.pathname=null,r.path=null),null===r.pathname&&null===r.search||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},o.prototype.parseHost=function(){var e=this.host,t=a.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)},t.parse=y,t.resolve=function(e,t){return y(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?y(e,!1,!0).resolveObject(t):t},t.format=function(e){return"string"===typeof e&&(e=y(e)),e instanceof o?e.format():o.prototype.format.call(e)},t.Url=o},92810:function(e,t,r){"use strict";var n;r.d(t,{Z:function(){return d}});var o=new Uint8Array(16);function i(){if(!n&&!(n="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(o)}var a=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var s=function(e){return"string"===typeof e&&a.test(e)},c=[],u=0;u<256;++u)c.push((u+256).toString(16).substr(1));var l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(c[e[t+0]]+c[e[t+1]]+c[e[t+2]]+c[e[t+3]]+"-"+c[e[t+4]]+c[e[t+5]]+"-"+c[e[t+6]]+c[e[t+7]]+"-"+c[e[t+8]]+c[e[t+9]]+"-"+c[e[t+10]]+c[e[t+11]]+c[e[t+12]]+c[e[t+13]]+c[e[t+14]]+c[e[t+15]]).toLowerCase();if(!s(r))throw TypeError("Stringified UUID is invalid");return r};var d=function(e,t,r){var n=(e=e||{}).random||(e.rng||i)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(var o=0;o<16;++o)t[r+o]=n[o];return t}return l(n)}},79501:function(e,t,r){var n={"./af-ZA/strings.json":[43668,3668],"./am-ET/strings.json":[88846,8846],"./ar-SA/strings.json":[19753,3118],"./as-IN/strings.json":[75210,5210],"./az-Latn-AZ/strings.json":[2246,2246],"./bg-BG/strings.json":[47085,7085],"./bn-IN/strings.json":[14151,4151],"./bs-Latn-BA/strings.json":[86106,6106],"./ca-ES/strings.json":[78509,8509],"./ca-Es-VALENCIA/strings.json":[56543,6543],"./cs-CZ/strings.json":[48642,8642],"./cy-GB/strings.json":[9034,9034],"./da-DK/strings.json":[19218,9218],"./de-DE/strings.json":[62396,2396],"./el-GR/strings.json":[72924,6479],"./en-GB/strings.json":[64438,4438],"./en-US/strings.json":[26617],"./es-ES/strings.json":[71866,1866],"./es-MX/strings.json":[38024,8024],"./et-EE/strings.json":[89198,2751],"./eu-ES/strings.json":[10246,246],"./fa-IR/strings.json":[77339,8442],"./fi-FI/strings.json":[21794,1794],"./fil-PH/strings.json":[90409,409],"./fr-CA/strings.json":[46332,6332],"./fr-FR/strings.json":[35946,5946],"./ga-IE/strings.json":[14811,4811],"./gd-gb/strings.json":[62409,2409],"./gl-ES/strings.json":[52492,2492],"./gu-IN/strings.json":[76358,6358],"./he-IL/strings.json":[46354,6354],"./hi-IN/strings.json":[67351,7351],"./hr-HR/strings.json":[98555,8555],"./hu-HU/strings.json":[86813,6813],"./hy-AM/strings.json":[71593,1593],"./id-ID/strings.json":[7482,7482],"./is-IS/strings.json":[69681,9681],"./it-IT/strings.json":[82714,2714],"./ja-JP/strings.json":[37979,1490],"./ka-GE/strings.json":[30481,481],"./kk-KZ/strings.json":[3847,3847],"./km-KH/strings.json":[45734,5734],"./kn-IN/strings.json":[82126,2126],"./ko-KR/strings.json":[52009,2009],"./kok-IN/strings.json":[11206,1206],"./lb-LU/strings.json":[77159,7159],"./lt-LT/strings.json":[92634,2634],"./lv-LV/strings.json":[42921,2921],"./mi-NZ/strings.json":[47361,7361],"./mk-MK/strings.json":[24432,4432],"./ml-IN/strings.json":[34512,4512],"./mr-IN/strings.json":[42478,2478],"./ms-MY/strings.json":[62971,2971],"./mt-MT/strings.json":[63996,3996],"./nb-NO/strings.json":[808,808],"./ne-NP/strings.json":[98894,8894],"./nl-NL/strings.json":[4581,4581],"./nn-NO/strings.json":[75679,5679],"./or-IN/strings.json":[27790,7790],"./pa-IN/strings.json":[99097,9097],"./pl-PL/strings.json":[25413,5413],"./pt-BR/strings.json":[13064,3064],"./pt-PT/strings.json":[17251,7251],"./quz-PE/strings.json":[40140,140],"./ro-RO/strings.json":[82218,2218],"./ru-RU/strings.json":[77539,7539],"./sk-SK/strings.json":[43068,3068],"./sl-SI/strings.json":[30802,802],"./sq-AL/strings.json":[81554,1554],"./sr-Cyrl-BA/strings.json":[27905,7957],"./sr-Cyrl-RS/strings.json":[18236,8236],"./sr-Latn-RS/strings.json":[98305,8305],"./sv-SE/strings.json":[38857,8857],"./ta-IN/strings.json":[65758,5758],"./te-IN/strings.json":[67555,7555],"./th-TH/strings.json":[23965,3965],"./tr-TR/strings.json":[16553,2776],"./tt-RU/strings.json":[47423,7423],"./ug-CN/strings.json":[32566,2566],"./uk-UA/strings.json":[47823,7823],"./ur-PK/strings.json":[25945,5945],"./uz-Latn-UZ/strings.json":[38257,8257],"./vi-VN/strings.json":[7e3,7e3],"./zh-CN/strings.json":[14840,4840],"./zh-TW/strings.json":[15446,5446]};function o(e){if(!r.o(n,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],o=t[0];return Promise.all(t.slice(1).map(r.e)).then((function(){return r.t(o,19)}))}o.keys=function(){return Object.keys(n)},o.id=79501,e.exports=o},24654:function(){},73897:function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n},e.exports.__esModule=!0,e.exports.default=e.exports},63405:function(e,t,r){var n=r(73897);e.exports=function(e){if(Array.isArray(e))return n(e)},e.exports.__esModule=!0,e.exports.default=e.exports},79498:function(e){e.exports=function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports},42281:function(e){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},861:function(e,t,r){var n=r(63405),o=r(79498),i=r(86116),a=r(42281);e.exports=function(e){return n(e)||o(e)||i(e)||a()},e.exports.__esModule=!0,e.exports.default=e.exports},86116:function(e,t,r){var n=r(73897);e.exports=function(e,t){if(e){if("string"===typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports},30907:function(e,t,r){"use strict";function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}r.d(t,{Z:function(){return n}})},83878:function(e,t,r){"use strict";function n(e){if(Array.isArray(e))return e}r.d(t,{Z:function(){return n}})},97326:function(e,t,r){"use strict";function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}r.d(t,{Z:function(){return n}})},15861:function(e,t,r){"use strict";function n(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(u){return void r(u)}s.done?t(c):Promise.resolve(c).then(n,o)}function o(e){return function(){var t=this,r=arguments;return new Promise((function(o,i){var a=e.apply(t,r);function s(e){n(a,o,i,s,c,"next",e)}function c(e){n(a,o,i,s,c,"throw",e)}s(void 0)}))}}r.d(t,{Z:function(){return o}})},15671:function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.d(t,{Z:function(){return n}})},5647:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(89611),o=r(78814);function i(e,t,r){return i=(0,o.Z)()?Reflect.construct.bind():function(e,t,r){var o=[null];o.push.apply(o,t);var i=new(Function.bind.apply(e,o));return r&&(0,n.Z)(i,r.prototype),i},i.apply(null,arguments)}},43144:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(49142);function o(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(0,n.Z)(o.key),o)}}function i(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}},37762:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(40181);function o(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=(0,n.Z)(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}},29388:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(61120),o=r(78814),i=r(82963);function a(e){var t=(0,o.Z)();return function(){var r,o=(0,n.Z)(e);if(t){var a=(0,n.Z)(this).constructor;r=Reflect.construct(o,arguments,a)}else r=o.apply(this,arguments);return(0,i.Z)(this,r)}}},4942:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(49142);function o(e,t,r){return(t=(0,n.Z)(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},11752:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(61120);function o(){return o="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=(0,n.Z)(e)););return e}(e,t);if(o){var i=Object.getOwnPropertyDescriptor(o,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},o.apply(this,arguments)}},61120:function(e,t,r){"use strict";function n(e){return n=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},n(e)}r.d(t,{Z:function(){return n}})},60136:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(89611);function o(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&(0,n.Z)(e,t)}},78814:function(e,t,r){"use strict";function n(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}r.d(t,{Z:function(){return n}})},59199:function(e,t,r){"use strict";function n(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}r.d(t,{Z:function(){return n}})},25267:function(e,t,r){"use strict";function n(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}r.d(t,{Z:function(){return n}})},1413:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(4942);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}},44925:function(e,t,r){"use strict";function n(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}r.d(t,{Z:function(){return n}})},82963:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(71002),o=r(97326);function i(e,t){if(t&&("object"===(0,n.Z)(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return(0,o.Z)(e)}},74165:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(71002);function o(){o=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(F){l=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new Z(n||[]);return i(a,"_invoke",{value:w(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(F){return{type:"throw",arg:F}}}e.wrap=d;var h={};function p(){}function v(){}function g(){}var m={};l(m,s,(function(){return this}));var y=Object.getPrototypeOf,b=y&&y(y(T([])));b&&b!==t&&r.call(b,s)&&(m=b);var k=g.prototype=p.prototype=Object.create(m);function S(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function o(i,a,s,c){var u=f(e[i],e,a);if("throw"!==u.type){var l=u.arg,d=l.value;return d&&"object"==(0,n.Z)(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){o("next",e,s,c)}),(function(e){o("throw",e,s,c)})):t.resolve(d).then((function(e){l.value=e,s(l)}),(function(e){return o("throw",e,s,c)}))}c(u.arg)}var a;i(this,"_invoke",{value:function(e,r){function n(){return new t((function(t,n){o(e,r,t,n)}))}return a=a?a.then(n,n):n()}})}function w(e,t,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return N()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var s=x(a,r);if(s){if(s===h)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=f(e,t,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===h)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function x(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var o=f(n,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,h;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function Z(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function T(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:N}}function N(){return{value:void 0,done:!0}}return v.prototype=g,i(k,"constructor",{value:g,configurable:!0}),i(g,"constructor",{value:v,configurable:!0}),v.displayName=l(g,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,l(e,u,"GeneratorFunction")),e.prototype=Object.create(k),e},e.awrap=function(e){return{__await:e}},S(C.prototype),l(C.prototype,c,(function(){return this})),e.AsyncIterator=C,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new C(d(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},S(k),l(k,u,"Generator"),l(k,s,(function(){return this})),l(k,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=T,Z.prototype={constructor:Z,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),c=r.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;E(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:T(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},e}},89611:function(e,t,r){"use strict";function n(e,t){return n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},n(e,t)}r.d(t,{Z:function(){return n}})},29439:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(83878);var o=r(40181),i=r(25267);function a(e,t){return(0,n.Z)(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(l){u=!0,o=l}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||(0,o.Z)(e,t)||(0,i.Z)()}},93433:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(30907);var o=r(59199),i=r(40181);function a(e){return function(e){if(Array.isArray(e))return(0,n.Z)(e)}(e)||(0,o.Z)(e)||(0,i.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},49142:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(71002);function o(e){var t=function(e,t){if("object"!==(0,n.Z)(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==(0,n.Z)(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===(0,n.Z)(t)?t:String(t)}},71002:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}r.d(t,{Z:function(){return n}})},40181:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(30907);function o(e,t){if(e){if("string"===typeof e)return(0,n.Z)(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?(0,n.Z)(e,t):void 0}}},28664:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(61120),o=r(89611);var i=r(5647);function a(e){var t="function"===typeof Map?new Map:void 0;return a=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,a)}function a(){return(0,i.Z)(e,arguments,(0,n.Z)(this).constructor)}return a.prototype=Object.create(e.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),(0,o.Z)(a,e)},a(e)}},75971:function(e,t,r){"use strict";r.r(t),r.d(t,{__addDisposableResource:function(){return A},__assign:function(){return i},__asyncDelegator:function(){return P},__asyncGenerator:function(){return x},__asyncValues:function(){return E},__await:function(){return w},__awaiter:function(){return p},__classPrivateFieldGet:function(){return I},__classPrivateFieldIn:function(){return D},__classPrivateFieldSet:function(){return B},__createBinding:function(){return g},__decorate:function(){return s},__disposeResources:function(){return L},__esDecorate:function(){return u},__exportStar:function(){return m},__extends:function(){return o},__generator:function(){return v},__importDefault:function(){return F},__importStar:function(){return N},__makeTemplateObject:function(){return Z},__metadata:function(){return h},__param:function(){return c},__propKey:function(){return d},__read:function(){return b},__rest:function(){return a},__runInitializers:function(){return l},__setFunctionName:function(){return f},__spread:function(){return k},__spreadArray:function(){return C},__spreadArrays:function(){return S},__values:function(){return y}});var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)};function o(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function s(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function c(e,t){return function(r,n){t(r,n,e)}}function u(e,t,r,n,o,i){function a(e){if(void 0!==e&&"function"!==typeof e)throw new TypeError("Function expected");return e}for(var s,c=n.kind,u="getter"===c?"get":"setter"===c?"set":"value",l=!t&&e?n.static?e:e.prototype:null,d=t||(l?Object.getOwnPropertyDescriptor(l,n.name):{}),f=!1,h=r.length-1;h>=0;h--){var p={};for(var v in n)p[v]="access"===v?{}:n[v];for(var v in n.access)p.access[v]=n.access[v];p.addInitializer=function(e){if(f)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(e||null))};var g=(0,r[h])("accessor"===c?{get:d.get,set:d.set}:d[u],p);if("accessor"===c){if(void 0===g)continue;if(null===g||"object"!==typeof g)throw new TypeError("Object expected");(s=a(g.get))&&(d.get=s),(s=a(g.set))&&(d.set=s),(s=a(g.init))&&o.unshift(s)}else(s=a(g))&&("field"===c?o.unshift(s):d[u]=s)}l&&Object.defineProperty(l,n.name,d),f=!0}function l(e,t,r){for(var n=arguments.length>2,o=0;o<t.length;o++)r=n?t[o].call(e,r):t[o].call(e);return n?r:void 0}function d(e){return"symbol"===typeof e?e:"".concat(e)}function f(e,t,r){return"symbol"===typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function h(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)}function p(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))}function v(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(c){s=[6,c],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}var g=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function m(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||g(t,e,r)}function y(e){var t="function"===typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function b(e,t){var r="function"===typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){o={error:s}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function k(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(b(arguments[t]));return e}function S(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n}function C(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function w(e){return this instanceof w?(this.v=e,this):new w(e)}function x(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||s(e,t)}))})}function s(e,t){try{(r=o[e](t)).value instanceof w?Promise.resolve(r.value.v).then(c,u):l(i[0][2],r)}catch(n){l(i[0][3],n)}var r}function c(e){s("next",e)}function u(e){s("throw",e)}function l(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}}function P(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:w(e[n](t)),done:!1}:o?o(t):t}:o}}function E(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=y(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function Z(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var T=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function N(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&g(t,e,r);return T(t,e),t}function F(e){return e&&e.__esModule?e:{default:e}}function I(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function B(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function D(e,t){if(null===t||"object"!==typeof t&&"function"!==typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"===typeof e?t===e:e.has(t)}function A(e,t,r){if(null!==t&&void 0!==t){if("object"!==typeof t&&"function"!==typeof t)throw new TypeError("Object expected.");var n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(void 0===n){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if("function"!==typeof n)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var O="function"===typeof SuppressedError?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function L(e){function t(t){e.error=e.hasError?new O(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function r(){for(;e.stack.length;){var n=e.stack.pop();try{var o=n.dispose&&n.dispose.call(n.value);if(n.async)return Promise.resolve(o).then(r,(function(e){return t(e),r()}))}catch(i){t(i)}}if(e.hasError)throw e.error}()}t.default={__extends:o,__assign:i,__rest:a,__decorate:s,__param:c,__metadata:h,__awaiter:p,__generator:v,__createBinding:g,__exportStar:m,__values:y,__read:b,__spread:k,__spreadArrays:S,__spreadArray:C,__await:w,__asyncGenerator:x,__asyncDelegator:P,__asyncValues:E,__makeTemplateObject:Z,__importStar:N,__importDefault:F,__classPrivateFieldGet:I,__classPrivateFieldSet:B,__classPrivateFieldIn:D,__addDisposableResource:A,__disposeResources:L}},26617:function(e){"use strict";e.exports=JSON.parse('{"ControlClickToFollowLink":"Ctrl+Click to follow link","GettingThisReady":"Getting this ready...","NewLoopComponentFileName":"Loop component","CalloutTitle":"This is a Loop component","CalloutDescription":"You can edit this directly without sending a reply, and everyone will see changes in real time.","GotIt":"Got it","CustomPermissionsPanelPeopleOutsideWithLinkText":"People outside this message with the link have access","CustomPermissionsPanelSpecificPermissionText":"People in this message have access","CustomPermissionsPanelPeopleOutsideText":"People outside this message have access","CustomPermissionsPanelSomePeopleText":"Some people in this message have access"}')}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}r.m=e,r.F={},r.E=function(e){Object.keys(r.F).map((function(t){r.F[t](e)}))},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};r.t=function(n,o){if(1&o&&(n=this(n)),8&o)return n;if("object"===typeof n&&n){if(4&o&&n.__esModule)return n;if(16&o&&"function"===typeof n.then)return n}var i=Object.create(null);r.r(i);var a={};e=e||[null,t({}),t([]),t(t)];for(var s=2&o&&n;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((function(e){a[e]=function(){return n[e]}}));return a.default=function(){return n},r.d(i,a),i}}(),r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.f={},r.e=function(e){return Promise.all(Object.keys(r.f).reduce((function(t,n){return r.f[n](e,t),t}),[]))},r.u=function(e){return"static/js/"+({47:"hostUxStrings71",67:"hostDefaultsStrings26",80:"InformationProtectionStrings37",123:"hostUxStrings27",129:"hostUxStrings82",155:"hostDefaultsStrings42",162:"InformationProtectionStrings48",174:"hostDefaultsStrings35",200:"InformationProtectionStrings3",201:"VideoPlaybackStrings37",206:"hostDefaultsStrings9",229:"hostDefaultsStrings43",236:"InformationProtectionStrings56",243:"hostUxStrings47",284:"hostUxStrings16",313:"InformationProtectionStrings70",318:"hostDefaultsStrings27",355:"hostDefaultsStrings13",356:"hostDefaultsStrings72",394:"VideoPlaybackStrings38",480:"InformationProtectionStrings45",494:"hostDefaultsStrings8",498:"VideoPlaybackStrings85",500:"hostDefaultsStrings28",504:"VideoPlaybackStrings6",509:"InformationProtectionStrings43",534:"InformationProtectionStrings81",596:"hostDefaultsStrings48",702:"hostUxStrings0",764:"InformationProtectionStrings25",771:"InformationProtectionStrings11",778:"hostDefaultsStrings53",780:"VideoPlaybackStrings55",785:"VideoPlaybackStrings45",835:"StreamEmbeddedRenderer",872:"hostDefaultsStrings17",907:"InformationProtectionStrings66",912:"InformationProtectionStrings55",961:"hostDefaultsStrings18",1007:"hostUxStrings41",1033:"hostUxStrings24",1060:"InformationProtectionStrings59",1064:"VideoPlaybackStrings54",1071:"hostUxStrings63",1112:"hostUxStrings25",1118:"hostDefaultsStrings58",1137:"VideoPlaybackStrings58",1203:"InformationProtectionStrings35",1261:"VideoPlaybackStrings76",1264:"hostUxStrings30",1272:"hostDefaultsStrings3",1286:"hostUxStrings1",1305:"VideoPlaybackStrings65",1330:"hostUxStrings8",1352:"VideoPlaybackStrings7",1375:"hostDefaultsStrings63",1404:"InformationProtectionStrings52",1412:"VideoPlaybackStrings11",1439:"hostUxStrings20",1477:"InformationProtectionStrings73",1518:"hostUxStrings17",1538:"InformationProtectionStrings22",1546:"SharepointInformationProtectionService",1583:"hostDefaultsStrings78",1606:"VideoPlaybackStrings10",1698:"InformationProtectionStrings14",1724:"fluidHost-videoLoop",1744:"InformationProtectionStrings79",1805:"VideoPlaybackStrings13",1847:"InformationProtectionStrings2",1856:"InformationProtectionStrings84",1914:"InformationProtectionStrings29",1916:"InformationProtectionStrings4",1985:"InformationProtectionStrings62",1986:"hostUxStrings74",1992:"hostDefaultsStrings44",2036:"VideoPlaybackStrings16",2061:"hostDefaultsStrings2",2073:"LazyFluidMessageBannerStack",2115:"InformationProtectionStrings60",2136:"hostDefaultsStrings54",2175:"VideoPlaybackStrings21",2191:"VideoPlaybackStrings1",2198:"hostUxStrings28",2249:"VideoPlaybackStrings78",2315:"InformationProtectionStrings68",2326:"hostUxStrings46",2371:"InformationProtectionStrings41",2419:"VideoPlaybackStrings64",2452:"InformationProtectionStrings51",2479:"VideoPlaybackStrings46",2481:"VideoPlaybackStrings27",2486:"hostUxStrings76",2500:"VideoPlaybackStrings63",2515:"VideoPlaybackStrings19",2518:"cardloopmerenderer",2535:"hostDefaultsStrings65",2536:"VideoPlaybackStrings9",2537:"fluidHost-odsp",2596:"hostDefaultsStrings61",2729:"hostUxStrings54",2773:"VideoPlaybackStrings30",2797:"hostDefaultsStrings55",2866:"InformationProtectionStrings57",2879:"VideoPlaybackStrings18",2936:"hostDefaultsStrings47",2938:"VideoPlaybackStrings51",2939:"hostDefaultsStrings37",2951:"VideoPlaybackStrings2",2953:"hostDefaultsStrings46",3046:"hostUxStrings84",3066:"VideoPlaybackStrings53",3119:"createNewModule",3149:"VideoPlaybackStrings41",3184:"hostUxStrings66",3186:"hostUxStrings58",3206:"officeFluidOneDsSink",3267:"VideoPlaybackStrings67",3311:"hostDefaultsStrings57",3325:"VideoPlaybackStrings3",3326:"hostUxStrings67",3364:"hostUxStrings19",3402:"hostUxStrings57",3420:"hostUxStrings6",3528:"VideoPlaybackStrings39",3576:"hostUxStrings18",3583:"InformationProtectionStrings30",3587:"VideoPlaybackStrings48",3595:"VideoPlaybackStrings14",3642:"hostUxStrings3",3661:"hostDefaultsStrings22",3718:"hostDefaultsStrings39",3811:"VideoPlaybackStrings5",3813:"hostUxStrings44",3841:"VideoPlaybackStrings17",3890:"VideoPlaybackStrings74",3908:"hostDefaultsStrings67",4e3:"hostDefaultsStrings0",4089:"InformationProtectionStrings44",4129:"InformationProtectionStrings61",4145:"hostDefaultsStrings85",4159:"hostUxStrings65",4162:"VideoPlaybackStrings84",4180:"hostDefaultsStrings4",4186:"InformationProtectionStrings0",4212:"InformationProtectionStrings75",4221:"hostDefaultsStrings20",4263:"VideoPlaybackStrings57",4346:"hostUxStrings32",4357:"hostUxStrings33",4399:"cardloopcomponent-herocardview",4406:"VideoPlaybackStrings83",4430:"VideoPlaybackStrings69",4489:"hostDefaultsStrings14",4492:"cardloopcomponent-chunk",4559:"VideoPlaybackStrings40",4580:"InformationProtectionStrings13",4596:"hostDefaultsStrings40",4617:"SharepointNotificationService",4623:"hostDefaultsStrings62",4627:"VideoPlaybackStrings20",4632:"hostUxStrings7",4681:"SharepointShareService",4690:"InformationProtectionStrings74",4730:"hostDefaultsStrings50",4731:"hostUxStrings75",4750:"InformationProtectionStrings58",4820:"hostDefaultsStrings16",4863:"hostUxStrings12",4871:"hostDefaultsStrings64",4934:"hostUxStrings35",5057:"VideoPlaybackStrings28",5091:"hostDefaultsStrings71",5095:"hostUxStrings50",5145:"fluid-debugger",5292:"hostUxStrings4",5305:"VideoPlaybackStrings68",5341:"hostUxStrings26",5364:"InformationProtectionStrings39",5409:"hostDefaultsStrings12",5419:"InformationProtectionStrings77",5443:"hostUxStrings10",5447:"hostDefaultsStrings83",5450:"hostDefaultsStrings52",5462:"VideoPlaybackStrings15",5480:"videoPlaybackComponent",5549:"InformationProtectionStrings23",5656:"shareDialog",5667:"hostDefaultsStrings29",5668:"InformationProtectionStrings47",5677:"hostDefaultsStrings77",5678:"hostDefaultsStrings76",5688:"InformationProtectionStrings20",5702:"InformationProtectionStrings80",5742:"hostUxStrings43",5787:"VideoPlaybackStrings44",5792:"VideoPlaybackStrings60",5833:"hostUxStrings37",5851:"hostDefaultsStrings25",5862:"InformationProtectionStrings10",5875:"hostDefaultsStrings24",5901:"InformationProtectionStrings64",5943:"InformationProtectionStrings12",6003:"hostDefaultsStrings31",6008:"hostUxStrings14",6058:"InformationProtectionStrings31",6074:"UnfurlControllerStub",6078:"hostDefaultsStrings68",6091:"VideoPlaybackStrings24",6095:"hostUxStrings42",6173:"hostDefaultsStrings32",6205:"hostUxStrings45",6218:"VideoPlaybackStrings82",6222:"VideoPlaybackStrings47",6244:"hostUxStrings9",6266:"InformationProtectionStrings28",6316:"hostUxStrings53",6330:"hostDefaultsStrings66",6366:"hostUxStrings40",6380:"InformationProtectionStrings8",6387:"InformationProtectionStrings65",6395:"hostUxStrings22",6431:"hostUxStrings23",6443:"InformationProtectionStrings76",6457:"VideoPlaybackStrings0",6482:"hostDefaultsStrings34",6483:"VideoPlaybackStrings77",6532:"hostDefaultsStrings23",6553:"InformationProtectionStrings26",6558:"cardloopcomponent-jitcardview",6665:"InformationProtectionStrings16",6681:"VideoPlaybackStrings35",6682:"cardloopcomponent-o365connectorscardview",6697:"VideoPlaybackStrings72",6728:"VideoPlaybackStrings32",6738:"hostUxStrings68",6746:"InformationProtectionStrings63",6782:"VideoPlaybackStrings66",6789:"hostUxStrings73",6793:"hostUxStrings83",6884:"VideoPlaybackStrings22",6910:"hostUxStrings34",6912:"hostUxStrings31",6937:"VideoPlaybackStrings12",6938:"VideoPlaybackStrings75",6958:"VideoPlaybackStrings25",6967:"VideoPlaybackStrings73",6970:"InformationProtectionStrings53",6981:"InformationProtectionStrings72",7013:"InformationProtectionStrings24",7057:"cardloopcomponent-signincardview",7060:"VideoPlaybackStrings8",7078:"hostDefaultsStrings30",7088:"InformationProtectionStrings15",7099:"hostDefaultsStrings84",7102:"InformationProtectionStrings18",7107:"summaryModule",7109:"hostDefaultsStrings51",7162:"hostDefaultsStrings10",7190:"VideoPlaybackStrings79",7191:"hostDefaultsStrings70",7209:"hostUxStrings77",7233:"InformationProtectionStrings54",7245:"hostDefaultsStrings75",7265:"InformationProtectionStrings40",7288:"hostDefaultsStrings45",7298:"hostDefaultsStrings41",7309:"hostDefaultsStrings60",7311:"hostUxStrings39",7339:"hostUxStrings11",7425:"InformationProtectionStrings17",7431:"hostDefaultsStrings19",7437:"VideoPlaybackStrings81",7444:"VideoPlaybackStrings59",7459:"InformationProtectionStrings6",7460:"VideoPlaybackStrings31",7489:"VideoPlaybackStrings4",7540:"InformationProtectionStrings42",7549:"InformationProtectionStrings19",7591:"hostDefaultsStrings69",7624:"hostUxStrings62",7634:"VideoPlaybackStrings52",7729:"hostUxStrings52",7741:"hostDefaultsStrings49",7750:"VideoPlaybackStrings26",7793:"hostUxStrings64",7834:"hostDefaultsStrings82",7853:"hostDefaultsStrings73",7868:"cardloopcomponent-adaptivecardview",7886:"VideoPlaybackStrings61",7905:"VideoPlaybackStrings36",7912:"InformationProtectionStrings7",7962:"hostDefaultsStrings15",7979:"hostDefaultsStrings38",8025:"InformationProtectionStrings32",8036:"VideoPlaybackStrings33",8049:"hostUxStrings2",8092:"hostUxStrings85",8117:"InformationProtectionStrings49",8139:"VideoPlaybackStrings49",8176:"hostUxStrings61",8242:"hostDefaultsStrings5",8254:"hostDefaultsStrings56",8278:"hostUxStrings72",8287:"VideoPlaybackStrings70",8318:"shareCallout",8341:"hostUxStrings51",8438:"VideoPlaybackStrings29",8446:"hostDefaultsStrings80",8447:"InformationProtectionStrings34",8452:"InformationProtectionStrings33",8491:"hostUxStrings21",8497:"hostUxStrings79",8498:"hostUxStrings69",8535:"hostUxStrings78",8549:"InformationProtectionStrings67",8564:"FluidFramework-HashFallback",8576:"hostDefaultsStrings74",8596:"VideoPlaybackStrings56",8677:"hostUxStrings59",8678:"InformationProtectionStrings83",8715:"hostUxStrings5",8729:"hostUxStrings13",8771:"InformationProtectionStrings50",8814:"cardloopcomponent-thumbnailcardview",8819:"hostDefaultsStrings21",8880:"hostUxStrings55",8891:"InformationProtectionStrings27",8910:"InformationProtectionStrings82",8950:"hostDefaultsStrings1",8951:"InformationProtectionStrings38",8968:"hostDefaultsStrings36",9110:"fluidHost-cardLoop",9170:"InformationProtectionStrings9",9198:"InformationProtectionStrings69",9210:"InformationProtectionStrings1",9238:"InformationProtectionStrings71",9239:"VideoPlaybackStrings62",9240:"hostUxStrings49",9279:"VideoPlaybackStrings71",9306:"hostUxStrings60",9323:"InformationProtectionStrings78",9330:"hostUxStrings36",9339:"socketModule",9369:"WSETFoundInPlaces",9378:"hostDefaultsStrings33",9412:"hostUxStrings80",9448:"VideoPlaybackStrings23",9469:"hostUxStrings81",9472:"VideoPlaybackStrings43",9490:"VideoPlaybackStrings42",9505:"hostUxStrings56",9526:"hostDefaultsStrings81",9533:"hostUxStrings38",9537:"hostDefaultsStrings7",9541:"hostDefaultsStrings6",9576:"AshaUtils",9592:"hostDefaultsStrings59",9619:"InformationProtectionStrings85",9629:"hostUxStrings15",9656:"VideoPlaybackStrings80",9737:"hostUxStrings29",9744:"VideoPlaybackStrings34",9753:"hostUxStrings70",9761:"InformationProtectionStrings21",9778:"hostUxStrings48",9820:"InformationProtectionStrings5",9872:"VideoPlaybackStrings50",9881:"InformationProtectionStrings46",9908:"InformationProtectionStrings36",9942:"hostDefaultsStrings11",9959:"hostDefaultsStrings79"}[e]||e)+"."+{47:"9b11b581",67:"91bd372c",80:"7dc12295",123:"46c3371f",129:"c666d2ad",140:"9eb12a04",155:"eaddb58d",162:"4da2fddb",174:"09fcb6e9",200:"63b7239b",201:"4ee883e4",206:"b3b5d96f",229:"47fba3f5",236:"9fd03ed4",243:"8d936ff4",246:"2f2fcc51",284:"dbafd16c",313:"b85d45ea",318:"d67a0126",355:"6f05f7a1",356:"c4300735",394:"5aaa47f9",409:"6b9b09c2",480:"fbad1c22",481:"cdda36b3",494:"f0bd037e",498:"1d443f94",500:"11e02fb0",504:"d721d937",509:"4ffc3202",534:"347e6778",596:"8f45248f",697:"d3aabccb",702:"b64b39c7",764:"417d5b8b",771:"438025f2",778:"5ff4d21a",780:"060f74b2",785:"f4765a7f",802:"91bc6b20",808:"8ead11fd",835:"26c8f673",872:"db6a03dc",907:"7adbe2f4",912:"4b5aab7e",961:"89baae24",1007:"2ca083e1",1033:"be506ef7",1060:"fd598c05",1064:"5d3f29cb",1071:"51b5a38f",1112:"ef39ec8e",1118:"61980201",1137:"7e656f39",1203:"bbf9f82d",1206:"72cfb45a",1261:"46fde702",1264:"582a5688",1272:"95a83279",1286:"b371c0a2",1305:"f5d8a37d",1330:"f20c65ed",1352:"a8e8fadc",1375:"fb39715c",1404:"b1937e36",1412:"6e42ccf5",1439:"3652346d",1477:"683d0875",1490:"1fc1d051",1518:"ad04e166",1538:"2fd856e2",1546:"f646713e",1554:"0c4338cd",1583:"5120c48e",1593:"e3d2fd25",1606:"df3ce1c3",1657:"398cd175",1698:"2355942f",1721:"51956e87",1724:"8c082670",1744:"718ff028",1794:"15201958",1805:"c795e986",1847:"1010a259",1856:"c1499030",1866:"b3c01c58",1914:"0f7318a0",1916:"976571f2",1985:"cad0f29f",1986:"b03d8d3f",1992:"e2a8309e",2009:"9549d6fe",2036:"6b1a61dc",2061:"a1b53ba9",2073:"544f575c",2115:"a6171245",2126:"ebaba9cf",2136:"656ebbd7",2175:"2327def2",2191:"a372f63b",2198:"c7bbd0bf",2218:"a2919da6",2246:"8563278c",2249:"c1cbffe6",2315:"910b5712",2326:"7e916cc0",2371:"1bd265ff",2396:"99238f7b",2409:"497038f1",2419:"b5f93575",2452:"29a1c95a",2478:"4baa4560",2479:"010f7dfd",2481:"f5941415",2486:"07c5ceeb",2492:"c9b0cefd",2500:"d33fdcc8",2515:"3aaf83fa",2518:"fb60e38e",2535:"dcdedee6",2536:"5861f4b6",2537:"1b38738e",2566:"4ec0df46",2596:"6c56304e",2634:"50332914",2714:"ccd11568",2729:"e5b94dd9",2751:"0ed05f72",2773:"6f28629d",2776:"c305e969",2797:"50eb7ef8",2866:"529506d5",2879:"d6710cb4",2921:"61712b34",2936:"c262355e",2938:"327558b4",2939:"0c4c5448",2951:"7a4e5c98",2953:"e6f807ab",2971:"6234e251",3046:"5577374a",3064:"4a5d7d42",3066:"e527c3fa",3068:"37679190",3118:"6f9f169f",3119:"0bf08b8b",3149:"786de011",3184:"75f34b0c",3186:"88b85896",3206:"9e93fc96",3267:"817c13f9",3311:"378c6476",3325:"556a4ff4",3326:"78242c5f",3364:"41ce8a5a",3402:"aeb574fa",3420:"f7dd1e02",3528:"2d839b48",3576:"473d2e8e",3583:"d0c70420",3587:"9d632b3b",3595:"c3713297",3642:"0abf668c",3661:"06da0d39",3668:"b2fe9bad",3711:"1fec3cb2",3718:"314157be",3811:"8cf8b477",3813:"675feedb",3841:"69966fd0",3847:"3b4d8a6e",3890:"32b83c3c",3908:"32f3998e",3965:"a1f8fb83",3984:"4673adcc",3996:"1f53ebe1",4e3:"f23c0b1b",4012:"92dfb9f9",4089:"2c07ef80",4129:"7721b423",4145:"95cbc87e",4151:"73e08708",4159:"f29a6a14",4162:"4769f071",4164:"5985768e",4180:"2fb19e04",4186:"6923bc69",4212:"58940ad4",4221:"cfe0956d",4263:"0cf24024",4346:"6c2c317e",4357:"3161a0e2",4399:"ca7ba3b5",4406:"1d68a404",4430:"af2be6dc",4432:"5dfdda0b",4438:"636d27fb",4489:"c26f5b10",4492:"30254a95",4512:"310ec13e",4559:"440099a6",4580:"3f8ca7b8",4581:"4a32c785",4596:"ed54d4f3",4617:"d203e7dc",4623:"5b7fd611",4627:"116a6fe4",4632:"f784d5ed",4681:"84273172",4690:"b213d6ce",4730:"26a1adaf",4731:"39f747d8",4750:"346cde8a",4811:"74c2cc2a",4820:"856513ab",4840:"92a0ed6b",4863:"f7822b16",4871:"95b4be86",4927:"9f4c091b",4934:"22e86428",5057:"12e18f18",5091:"3fd46efe",5095:"b796e0e0",5145:"76cefa11",5210:"e187ae98",5262:"794b006a",5292:"97aa5a57",5305:"9c165b94",5341:"974202a8",5364:"488f9602",5409:"182bcdea",5413:"20eeeb7b",5419:"91973f82",5443:"36beb34d",5446:"c9a6a2b5",5447:"eb4d154c",5450:"a422c4e6",5462:"f3e4dbf2",5480:"4a0133e1",5549:"7f947149",5656:"de93c4e1",5667:"4a892ac2",5668:"09d9c865",5677:"22b09d68",5678:"235a0f86",5679:"34bc0a16",5688:"86b03e0f",5689:"fb6c5779",5702:"caa825a2",5734:"96412db0",5742:"3ff84aa6",5758:"f4ae1eb7",5787:"f9dd6911",5792:"946a747d",5833:"6827a5b6",5851:"05f68b9d",5862:"977ec7ab",5875:"e7bc3053",5901:"a2202c7c",5908:"40a49bf4",5943:"eaa21175",5945:"16aca0a2",5946:"7ec9a430",6003:"ded69194",6008:"569c7d97",6058:"86f04fc8",6074:"a231fe71",6078:"566e1ea3",6091:"d0da5fde",6095:"ee1c8358",6106:"60c9008c",6173:"7e5c3a5a",6205:"54493919",6218:"501780fa",6222:"9e17c137",6244:"620a70ab",6266:"b96063fe",6316:"bfcb59b3",6330:"1e3937b7",6332:"f7c16f74",6354:"34fd816e",6358:"d7c8cab3",6366:"55a28c3b",6380:"b62ec12a",6387:"e992d898",6395:"d77f6578",6431:"afa02680",6443:"fc1cedb4",6457:"2148637e",6479:"2986a103",6482:"16ac0161",6483:"6783b475",6532:"0bbc725b",6543:"0923d8a4",6553:"32416a26",6558:"47167476",6622:"d0ba89e5",6665:"cfdfc29b",6681:"a4084a6d",6682:"5654318e",6697:"4d6c4bf7",6728:"905f4cbe",6732:"8ccea83d",6738:"1dc01628",6746:"28a1b7dd",6782:"73c8b46e",6789:"9fd2c353",6793:"c949f994",6813:"ca10a41d",6884:"94ba1bb7",6906:"0af829c7",6910:"42e74518",6912:"a42ea42c",6937:"e3674785",6938:"80328047",6958:"b8a06957",6967:"c824fda3",6970:"7400b423",6981:"a736ec16",7e3:"2b4a3f97",7008:"5d087edb",7013:"3e51839f",7057:"711c91ac",7060:"ff532083",7078:"9d2a0b45",7085:"9ec5fe9c",7088:"f6edb66d",7099:"653c5e3d",7102:"3c71f249",7107:"5a4c2f85",7109:"1ba3b81f",7159:"3b1f2714",7162:"b5506a56",7190:"862f0240",7191:"e2435379",7209:"104615d7",7233:"5cda2b09",7245:"7febb73c",7251:"08af82ed",7265:"0ec6ca69",7288:"03399ce9",7298:"ec2981d9",7309:"ca55549d",7311:"402774a5",7339:"59820874",7351:"56d65c0e",7361:"e3392b33",7423:"abece185",7425:"301ef303",7431:"69ff2223",7437:"314b84f2",7444:"a410ba93",7459:"dbb4b8d5",7460:"334f0f07",7482:"36e78205",7489:"c4561517",7539:"4e16c67f",7540:"f61dfb52",7549:"d61bf7a7",7555:"724cd1b4",7591:"bb9b257d",7624:"690b2ad9",7634:"842d8cbc",7729:"c397ac27",7741:"5ba85f58",7750:"ef76cc10",7790:"32b8b1ad",7793:"8abf8665",7823:"fe272b2e",7834:"5a92e4a6",7853:"b695f979",7868:"19d32c5f",7886:"a369bb87",7905:"4b18f81e",7912:"eb657f21",7957:"a9a74bca",7962:"af416896",7979:"1441d29a",8024:"757db310",8025:"9ab6e39f",8036:"984b1a1c",8049:"db21f16f",8092:"9444135b",8117:"10ab5711",8139:"fa3d8ffb",8176:"2c77cdbf",8236:"b6bf0967",8242:"c42bcd82",8254:"c51b8100",8257:"3f971475",8278:"2a9038a6",8287:"7446faf2",8305:"dedee377",8318:"384ba38c",8341:"bb8c6aaf",8438:"7d3e3558",8442:"314929e3",8446:"c62daaec",8447:"385c3399",8452:"83f9e918",8491:"3eeae8a3",8497:"28b662df",8498:"9a727a8a",8507:"53a3f616",8509:"700b0b84",8535:"11d97686",8549:"498b8c3b",8555:"d637b290",8564:"eeeb2baf",8576:"d4c5d103",8596:"251eb986",8633:"798ac7e3",8642:"232ff539",8663:"4ec9401e",8677:"9c0d897e",8678:"c9f211ac",8715:"2149f504",8729:"1cef056a",8771:"fe649f94",8814:"dd7df570",8819:"0996427f",8846:"efb703a4",8857:"59c2156c",8880:"7ba88812",8891:"ea371c8e",8894:"9051c794",8910:"77a51683",8950:"b6a758d4",8951:"0342037d",8968:"6db24d7f",9005:"b339fec5",9034:"d43df6b0",9097:"9d11161d",9110:"441e2b12",9170:"dc6742f6",9198:"3d78e1f9",9210:"7cb2087a",9218:"1d680191",9238:"e35e530c",9239:"c0dff582",9240:"55d70e69",9279:"9cf16cb8",9306:"5175b123",9323:"7bc796fc",9330:"aa5f493d",9339:"d5207cb1",9369:"512be9eb",9378:"8ed02dac",9412:"cdadf9c4",9448:"d8b580e0",9469:"e56b6dcf",9472:"54363cfc",9490:"7c6e5e22",9505:"220684fb",9526:"bee476d9",9533:"bacb8eb4",9537:"75f4102a",9541:"576d4a14",9576:"3a6cb9df",9592:"1fb290e9",9619:"4587fcd7",9629:"cec54176",9656:"f9cd6003",9681:"0d017c45",9737:"75bc7df4",9744:"b8e03b55",9753:"f75b31db",9761:"5d158000",9778:"5ced0e99",9820:"386794ae",9872:"756424e7",9881:"5ef185b7",9908:"452de3eb",9942:"ab8248d5",9959:"57a8c519"}[e]+".chunk.js"},r.miniCssF=function(e){return"static/css/"+e+".0677cb3a.chunk.css"},r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={},t="fluidhost:";r.l=function(n,o,i,a){if(e[n])e[n].push(o);else{var s,c;if(void 0!==i)for(var u=document.getElementsByTagName("script"),l=0;l<u.length;l++){var d=u[l];if(d.getAttribute("src")==n||d.getAttribute("data-webpack")==t+i){s=d;break}}s||(c=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,r.nc&&s.setAttribute("nonce",r.nc),s.setAttribute("data-webpack",t+i),s.src=n),e[n]=[o];var f=function(t,r){s.onerror=s.onload=null,clearTimeout(h);var o=e[n];if(delete e[n],s.parentNode&&s.parentNode.removeChild(s),o&&o.forEach((function(e){return e(r)})),t)return t(r)},h=setTimeout(f.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=f.bind(null,s.onerror),s.onload=f.bind(null,s.onload),c&&document.head.appendChild(s)}}}(),r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},r.p="./",function(){if("undefined"!==typeof document){var e=function(e){return new Promise((function(t,n){var o=r.miniCssF(e),i=r.p+o;if(function(e,t){for(var r=document.getElementsByTagName("link"),n=0;n<r.length;n++){var o=(a=r[n]).getAttribute("data-href")||a.getAttribute("href");if("stylesheet"===a.rel&&(o===e||o===t))return a}var i=document.getElementsByTagName("style");for(n=0;n<i.length;n++){var a;if((o=(a=i[n]).getAttribute("data-href"))===e||o===t)return a}}(o,i))return t();!function(e,t,r,n,o){var i=document.createElement("link");i.rel="stylesheet",i.type="text/css",i.onerror=i.onload=function(r){if(i.onerror=i.onload=null,"load"===r.type)n();else{var a=r&&("load"===r.type?"missing":r.type),s=r&&r.target&&r.target.href||t,c=new Error("Loading CSS chunk "+e+" failed.\n("+s+")");c.code="CSS_CHUNK_LOAD_FAILED",c.type=a,c.request=s,i.parentNode&&i.parentNode.removeChild(i),o(c)}},i.href=t,r?r.parentNode.insertBefore(i,r.nextSibling):document.head.appendChild(i)}(e,i,null,t,n)}))},t={179:0};r.f.miniCss=function(r,n){t[r]?n.push(t[r]):0!==t[r]&&{5689:1}[r]&&n.push(t[r]=e(r).then((function(){t[r]=0}),(function(e){throw delete t[r],e})))}}}(),function(){var e={179:0};r.f.j=function(t,n){var o=r.o(e,t)?e[t]:void 0;if(0!==o)if(o)n.push(o[2]);else if(5689!=t){var i=new Promise((function(r,n){o=e[t]=[r,n]}));n.push(o[2]=i);var a=r.p+r.u(t),s=new Error;r.l(a,(function(n){if(r.o(e,t)&&(0!==(o=e[t])&&(e[t]=void 0),o)){var i=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+i+": "+a+")",s.name="ChunkLoadError",s.type=i,s.request=a,o[1](s)}}),"chunk-"+t,t)}else e[t]=0},r.F.j=function(t){if((!r.o(e,t)||void 0===e[t])&&5689!=t){e[t]=null;var n=document.createElement("link");r.nc&&n.setAttribute("nonce",r.nc),n.rel="prefetch",n.as="script",n.href=r.p+r.u(t),document.head.appendChild(n)}};var t=function(t,n){var o,i,a=n[0],s=n[1],c=n[2],u=0;if(a.some((function(t){return 0!==e[t]}))){for(o in s)r.o(s,o)&&(r.m[o]=s[o]);if(c)c(r)}for(t&&t(n);u<a.length;u++)i=a[u],r.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self.webpackChunkfluidhost=self.webpackChunkfluidhost||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}(),function(){var e={4681:[8318,5656]};r.f.prefetch=function(t,n){Promise.all(n).then((function(){var n=e[t];Array.isArray(n)&&n.map(r.E)}))}}(),function(){"use strict";var e=r(1413),t=r(74165),n=r(15861),o=r(56061),i=r(28002),a=r(30288),s=r(11447);function c(t){var n=void 0;if((0,s.U8)(t.settingsProvider)&&(n=Promise.all([r.e(5908),r.e(1546)]).then(r.bind(r,25021)).then((function(r){var n=new r.SharepointInformationProtectionService((0,e.Z)((0,e.Z)({},t),{},{logger:t.logger?new i.g("InformationProtectionService",t.logger):void 0}));return n.initialize(),n}))),t.logger){var o=new i.g("InformationProtectionService",t.logger);a.a.start("getInformationProtectionServiceForSharepoint",o).setResult(void 0!==n,{isGetLabelEnabled:(0,s.U8)(t.settingsProvider),isSetLabelEnabled:(0,s.yZ)(t.settingsProvider),settingsProviderExists:void 0!==t.settingsProvider})}return n}var u=r(36020);function l(e,r,o){var s=function(){var e=(0,n.Z)((0,t.Z)().mark((function e(r,n){var s,c,u;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=o?new i.g("InformationProtectionService",o):void 0,c=a.a.start("precacheInformationProtection",s,{addUserTiming:!0,isAPerformanceMetric:!0}),e.prev=2,e.next=5,r;case 5:return u=e.sent,e.next=8,Promise.all([u.getIrmInformation(n),u.getWatermarkInformation(n)]);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),c.setResult(!1);case 13:c.setResult(!0);case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,r){return e.apply(this,arguments)}}();s(e,r)}function d(e,t,r,n,o){return f.apply(this,arguments)}function f(){return(f=(0,n.Z)((0,t.Z)().mark((function e(r,n,o,i,a){return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,u.z)(o,i).then((function(e){l(r,{siteUrl:n,driveId:o,itemId:i,odspResolvedUrl:!0,hashedDocumentId:e,type:"fluid",id:"",url:"",tokens:{},endpoints:{snapshotStorageUrl:"",attachmentPOSTStorageUrl:"",attachmentGETStorageUrl:"",deltaStorageUrl:""},fileName:"",summarizer:!1,fileVersion:""},a)})).catch((function(){}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var h=r(40550),p=r(15671),v=r(43144),g=r(29439),m=r(93433),y=r(98846),b=r(66773),k=r(72633),S=r(62274),C="LocalStorageOverride",w="QueryParamOverride",x="Default",P="CachedServiceResponse",E=r(97103),Z={maxRetries:3,filter:(0,b.mE)([429,500,503]),backoffFn:(0,E.jR)(500)},T=/.+\S\([^\(\)]+\)$/,N={DOD:"https://config.ecs.dod.teams.microsoft.us",GCCHigh:"https://config.ecs.gov.teams.microsoft.us",GCC:"https://ecs.office.com",PUBLIC:"https://ecs.office.com"};function F(e){var t=new URLSearchParams;if(t.append("agents",e.teamNames.join(",")),e.guestAgents){for(var r={},n=0;n<e.guestAgents.length;n+=1){var o=e.guestAgents[n].substring(e.guestAgents[n].indexOf("(")+1,e.guestAgents[n].indexOf(")")),i=e.guestAgents[n].substring(0,e.guestAgents[n].indexOf("("));r[o]=r[o]?"".concat(r[o],",").concat(i):i}Object.entries(r).forEach((function(e){var r=(0,g.Z)(e,2),n=r[0],o=r[1];t.append("guestAgents","".concat(o,"(").concat(n,")"))}))}Object.entries(e.filters).forEach((function(e){var r=(0,g.Z)(e,2),n=r[0],o=r[1];void 0!==o&&t.append(n,o)}));var a=t.toString();return"".concat(e.host,"/config/v1/").concat(e.clientName,"/").concat(e.clientVersion).concat(""!==a?"?".concat(a):"")}function I(e){return 2===(e.cacheVersion||0)&&void 0!==e.expires&&e.expires.valueOf()>Date.now()}function B(e){if(null!==e&&void 0!==e){var t;try{t=JSON.parse(e)}catch(n){}var r=void 0!==t?t:e;return"on"===r||"off"===r?"on"===r:r}}var D=function(){function e(t,r){(0,p.Z)(this,e),this.ecsClientConfiguration=t,this.previouslyAccessedEcsSettings=new Map,this.logger=r&&new i.g("EcsClient",r),this.loadAndClearCache()}return(0,v.Z)(e,[{key:"fetch",value:function(){var e=(0,n.Z)((0,t.Z)().mark((function e(){var r,n,o=this;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.ecsClientConfiguration.alwaysFetchNewSettings&&void 0!==this.ecsResponseFromCache&&I(this.ecsResponseFromCache)&&this.ecsResponseFromCache.sessionId===this.ecsClientConfiguration.sessionId){e.next=5;break}return r=F(this.ecsClientConfiguration),(n=this.fetchAndParse(r)).then((function(e){e&&o.cacheEcsResponse(e)})).catch((function(){})),e.abrupt("return",n);case 5:return e.abrupt("return",void 0);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getSetting",value:function(e,t,r){var n=function(e,t){return{settingName:t,teamName:e,stringifiedLocator:JSON.stringify({teamName:e,settingName:t})}}(r,e);return this.getSettingInternal(n,t).settingValue}},{key:"getSettingInternal",value:function(e,t){var r,n,o;return(r=this.previouslyAccessedEcsSettings.get(e.stringifiedLocator))?r:((r=function(e){var t=S.S.get(e.settingName);if(null!==t&&void 0!==t){var r=B(t);if(void 0!==r)return{settingValue:r,ecsSettingSource:w}}}(e))?(n=r,o="QueryParams"):(r=function(e){var t,r=null===(t=(0,k.E)())||void 0===t?void 0:t.getItem(e.settingName);if(null!==r&&void 0!==r){var n=B(r);if(void 0!==n)return{settingValue:n,ecsSettingSource:C}}}(e))?(n=r,o="LocalStorage"):(r=this.getSettingFromCachedEcsResponse(e))?(n=r,o="EcsNetworkCache"):(n={settingValue:t,ecsSettingSource:x},o="DefaultValue"),this.previouslyAccessedEcsSettings.set(e.stringifiedLocator,n),this.logger&&(0,y.ve)(this.logger,{eventName:"EcsSettingRead",readFrom:o,settingName:e.settingName,settingValue:JSON.stringify(n.settingValue)}),n)}},{key:"getSettingFromCachedEcsResponse",value:function(e){var t,r,n=(null===(t=this.ecsResponseFromCache)||void 0===t?void 0:t.ecsTeamsSettings[e.teamName])&&(null===(r=this.ecsResponseFromCache)||void 0===r?void 0:r.ecsTeamsSettings[e.teamName][e.settingName]);if(void 0!==n){var o={settingValue:n,ecsSettingSource:P};if(void 0!==o.settingValue)return o}}},{key:"fetchAndParse",value:function(){var e=(0,n.Z)((0,t.Z)().mark((function e(r){var n,o,i,s,c=this;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.a.start("EcsFetch",this.logger,{addUserTiming:!0}),e.prev=1,e.next=4,(0,b.q4)(r,void 0,Z);case 4:o=e.sent,e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(1),n.setResult(!1,{},e.t0),e.abrupt("return",void 0);case 11:if(200===o.result.status){e.next=15;break}return i=new Error("Failed to Fetch from ECS. Response is not 200"),n.setResult(!1,{status:o.result.status,statusText:o.result.statusText},i),e.abrupt("return",void 0);case 15:return(s=this.parseResponseToEcsResponse(o)).then((function(e){var t;performance.getEntriesByName(r).map((function(e){e.name.includes(c.ecsClientConfiguration.host)&&(t=e.duration)})),n.setResult(!0,{eTag:e.eTag,networkDurationMs:t,configIds:JSON.stringify(e.configIDs)})})).catch((function(e){n.setResult(!1,{},e)})),e.abrupt("return",s);case 18:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"parseResponseToEcsResponse",value:function(){var e=(0,n.Z)((0,t.Z)().mark((function e(r){var n,o,i,a,s,c,u,l,d,f=this;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.result.json();case 2:for(o=e.sent,i=(0,m.Z)(this.ecsClientConfiguration.teamNames),a={},null===(n=this.ecsClientConfiguration.guestAgents)||void 0===n||n.forEach((function(e){if(T.test(e)){var t=e.substring(0,e.indexOf("("));i.push(t)}else f.logger&&(0,y.uX)(f.logger,{eventName:"ecsTeamFormat"},new Error("".concat(e," doesn't match the format <EcsTeam>(<EcsClient>)")))})),s=0;s<i.length;s+=1)o[i[s]]&&(a[i[s]]=o[i[s]]);return c=r.result.headers.get("ETag")||"",u=o.ConfigIDs||{},this.ecsClientConfiguration.cacheExpiresDurationOverrideInMin?l=new Date(Date.now()+6e4*this.ecsClientConfiguration.cacheExpiresDurationOverrideInMin):(d=r.result.headers.get("Expires"),l=d?new Date(d):void 0),e.abrupt("return",{ecsTeamsSettings:a,eTag:c,configIDs:u,expires:l,cacheVersion:2,sessionId:this.ecsClientConfiguration.sessionId});case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"cacheEcsResponse",value:function(e){var t=(0,k.E)();if(t)try{var r=this.getAllCachedEcsResponses()||{};r[this.ecsClientConfiguration.cacheKey]=e,t.setItem(this.ecsClientConfiguration.responsesCacheKey,JSON.stringify(r))}catch(n){this.logger&&(0,y.uX)(this.logger,{eventName:"cacheEcsResponse"},n)}}},{key:"getAllCachedEcsResponses",value:function(){try{var e=(0,k.E)(),t=null===e||void 0===e?void 0:e.getItem(this.ecsClientConfiguration.responsesCacheKey),r=t&&JSON.parse(t);if(!r||0===Object.keys(r).length)return;return Object.entries(r).forEach((function(e){var t=(0,g.Z)(e,2),r=(t[0],t[1]);"string"===typeof r.expires&&(r.expires=new Date(r.expires))})),r}catch(n){this.logger&&(0,y.uX)(this.logger,{eventName:"getAllCachedEcsResponses"},n)}}},{key:"loadAndClearCache",value:function(){var e=this.getAllCachedEcsResponses();if(e){var t=e[this.ecsClientConfiguration.cacheKey];t&&(this.ecsResponseFromCache=t,this.logger&&(0,y.ve)(this.logger,{eventName:"loadedEcsResponseFromCache",settings:JSON.stringify(this.ecsResponseFromCache.ecsTeamsSettings),eTag:this.ecsResponseFromCache.eTag,configIds:JSON.stringify(this.ecsResponseFromCache.configIDs)})),this.clearExpiredEcsResponsesFromCache(e)}}},{key:"clearExpiredEcsResponsesFromCache",value:function(e){var t=this;try{var r=(0,k.E)();if(!r)return;var n={};Object.entries(e).forEach((function(e){var r=(0,g.Z)(e,2),o=r[0],i=r[1];(I(i)||o===t.ecsClientConfiguration.cacheKey)&&(n[o]=i)})),r.setItem(this.ecsClientConfiguration.responsesCacheKey,JSON.stringify(n))}catch(o){this.logger&&(0,y.uX)(this.logger,{eventName:"clearExpiredEcsResponsesFromCache"},o)}}}]),e}();function A(e){switch(e){case"Automation":case"SyntheticTraffic":case"Local":case"Staging":case"Dogfood":case"Preview":case"Microsoft":case"Production":return N.PUBLIC;case"GCC":return N.GCC;case"GCC-High":return N.GCCHigh;case"DoD":return N.DOD;default:throw new Error("Unexpected audience value provided")}}var O=function(){function e(t,r){var n=this;(0,p.Z)(this,e),this._settingsFetchedFromEcs=!1,this.ecsClient=new D(function(e){var t,r,n,o=e.ecsFilters,i=e.hostName,a=e.sessionId,s=e.responsesCacheKeyOverride,c=e.cacheExpiresDurationOverrideInMin,u=e.fetchHostExperiencesSettings,l=void 0===u||u,d=e.fetchSegmentationSettings,f=void 0===d||d,h=e.alwaysFetchNewSettings,p=o.userContext,v=o.audience,g=(null===(t=p.user)||void 0===t?void 0:t.id)||(null===(r=p.user)||void 0===r?void 0:r.oid),m={audience:v,userId:g,tenantId:null===(n=p.user)||void 0===n?void 0:n.tenantId,hostName:i},y="".concat(g).concat(i).concat(v),b=s||"FluidEcsClientResponses",k=["FluidExperiences"];return l&&k.push("HostExperiences"),f&&k.push("Segmentation"),{host:A(v),clientName:"Fluid",clientVersion:"0.0.0.1",teamNames:k,filters:m,cacheKey:y,responsesCacheKey:b,cacheExpiresDurationOverrideInMin:c,sessionId:a,alwaysFetchNewSettings:h}}(t),r),this.audience=t.ecsFilters.audience,this.fetchSettings().then((function(){n._settingsFetchedFromEcs=!0})).catch((function(e){}))}return(0,v.Z)(e,[{key:"SettingsProvider",get:function(){return this}},{key:"settingsFetchedFromEcs",get:function(){return this._settingsFetchedFromEcs}},{key:"fetchSettings",value:function(){var e=(0,n.Z)((0,t.Z)().mark((function e(){return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ecsClient.fetch();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getSetting",value:function(e,t,r){return this.ecsClient.getSetting(e,t,r)}}]),e}(),L=r(59043),_=r(11503),M=r(45593),R=r(14423),H=r(75757),j=r(61960);function U(e){return q.apply(this,arguments)}function q(){return(q=(0,n.Z)((0,t.Z)().mark((function e(n){var o,i,a,s;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.showComponentActivity,(0,j.cM)("appLazyStart() started."),o.AppLazyImportTracker=new H.g,o.AppLazyStartTracker=new H.g,e.next=6,o.AppLazyImportTracker.measure((function(){return Promise.all([r.e(4927),r.e(3711),r.e(8507),r.e(4164),r.e(5262),r.e(8633),r.e(5908),r.e(697),r.e(7008)]).then(r.bind(r,71893))}));case 6:i=e.sent,o.AppLazyStartTracker.measure((function(){return i.lazyStart(n)})),a=o.AppLazyImportTracker.getDurationInSeconds(),s=o.AppLazyStartTracker.getDurationInSeconds(),(0,j.cM)("appLazyStart() completed.  (Import: ".concat(a," s,  Lazy start: ").concat(s," s)"));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var z=r(81803),Y=r(8663),V=r(88861),G=r(94497);function W(e){return J.apply(this,arguments)}function J(){return(J=(0,n.Z)((0,t.Z)().mark((function e(r){var n,o,i,a,s,c,u,l,d,f,h,p,v,g,m,y;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.cardChannelProvider,o=r.documentServiceFactory,i=r.hostContext,a=r.informationProtectionServicePromise,s=r.internationalizationContext,c=r.metaOSProvider,u=r.officeFluidLogger,l=r.optionalConnectedProvider,d=r.presenceColorProvider,f=r.settingsProvider,h=r.stylingProvider,p=r.telemetryConfig,v=r.tokenProvider,g=r.urlHandlerProvider,m=r.urlResolver,y=new z.Q,n&&y.register("CardChannelProvider",n),y.register("HostContext",i),y.register("InternationalizationContext",s),a&&y.register("InformationProtectionService",a),y.register("LoopTelemetrySink",G.y),c&&y.register("MetaOSProvider",c),y.register("NamespaceLogger",u),l&&y.register("OfficePolicyProvider",l),y.register("PresenceColorProvider",d),y.register("SettingsProvider",f),y.register("StylingProvider",h),y.register("TelemetryConfig",p),y.register("TokenProvider",v),g&&y.register("UrlHandlerProvider",g),!o){e.next=21;break}return e.next=19,V.UG;case 19:e.sent&&y.register("DriverImplementation",new Y.Jg(m,o));case 21:return e.abrupt("return",y);case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var K=r(62190),Q=r(56058),X=r(25178),$=function(){function e(t){(0,p.Z)(this,e),this.isOptionalConnectedExperiencesEnabled=t}return(0,v.Z)(e,[{key:"optionalConnectedExperiencesEnabled",value:function(){var e=(0,n.Z)((0,t.Z)().mark((function e(){return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.isOptionalConnectedExperiencesEnabled);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getEnterpriseFeedbackPolicy",value:function(){var e=(0,n.Z)((0,t.Z)().mark((function e(){return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",void 0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"OfficePolicyProvider",get:function(){return this}}]),e}();function ee(){return(ee=(0,n.Z)((0,t.Z)().mark((function e(){var r,n;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,V.xO)(V.SZ.OEP,"FluidHost.FluidSettingOverrides","");case 2:if(!(r=e.sent)){e.next=12;break}return e.prev=4,n=JSON.parse(r),e.abrupt("return",n);case 9:e.prev=9,e.t0=e.catch(4),(0,K.w5)("HostSettingsProvider",new K.gz("Unable to parse value of FluidHost.FluidSettingsOverride."));case 12:return e.abrupt("return",{});case 13:case"end":return e.stop()}}),e,null,[[4,9]])})))).apply(this,arguments)}var te=function(){function e(t,r,n){var o=this;(0,p.Z)(this,e),this.defaultProvider=void 0,this.settingOverrides=void 0,this.audience=void 0,this.SettingsProvider=void 0,this.defaultProvider=r,this.SettingsProvider=this,this.audience=t,this.settingOverrides=n,void 0===this.settingOverrides&&function(){return ee.apply(this,arguments)}().then((function(e){o.settingOverrides=e}))}return(0,v.Z)(e,[{key:"getSetting",value:function(e,t,r){var n,o;if(this.settingOverrides){var i=this.settingOverrides[e];if(void 0!==i){var a=typeof i,s=typeof t;if(a===s)return(0,j.cM)("Override setting: ".concat(e," = ").concat(i)),i;console.warn("Cannot override setting ".concat(e,". The override type (").concat(a,") is different than the setting type (").concat(s,")."))}}return null!==(n=null===(o=this.defaultProvider)||void 0===o?void 0:o.getSetting(e,t,r))&&void 0!==n?n:t}}]),e}(),re=r(30408),ne=r(72278),oe=r(13885),ie=r(80565),ae=r(72532),se=r(52230),ce=r(50224),ue=r(39660),le=r(29331);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var de=r(55477),fe=r(78832),he=r(49395),pe=r(94815),ve=r(6232),ge=r(4972),me=r(79650),ye=r(83978),be=r(53748);function ke(){return Se.apply(this,arguments)}function Se(){return(Se=(0,n.Z)((0,t.Z)().mark((function e(){var r,n;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(R.yv){e.next=8;break}if(e.t0=R.Y8,e.t0){e.next=6;break}return e.next=5,(0,V.UT)(V.SZ.OEP,"ChangeGate.LocalAudience");case 5:e.t0=e.sent;case 6:if(!e.t0){e.next=8;break}return e.abrupt("return","Local");case 8:return r="Production",e.next=11,(0,V.xO)(V.SZ.OEP,"FluidHost.Audience",r);case 11:n=e.sent,e.t1=n,e.next="Automation"===e.t1||"Dogfood"===e.t1||"Local"===e.t1||"Microsoft"===e.t1||"Preview"===e.t1||"Production"===e.t1||"Staging"===e.t1||"SyntheticTraffic"===e.t1?15:16;break;case 15:return e.abrupt("return",n);case 16:return(0,K.w5)("determineAudience()",new K.gz('Unexpected value for OEP.FluidHost.Audience ("'.concat(n,'").'))),e.abrupt("return",r);case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ce(e){return e.name&&"MailComponent"!==e.name||(e.name="Component"),e.entryPoint||(e.entryPoint="Mail"),e.lifecycle||(e.lifecycle="Load"),e}function we(){return(we=(0,n.Z)((0,t.Z)().mark((function r(i){var a,s,u,l,f,p,v,g,m,y,b,k,S,C,w,x,P,E,Z,T,N,F,I,B,D,A,q,z,G,J,ee,Se,we,Pe,Ee,Ze,Te,Ne,Fe,Ie,Be,De,Ae,Oe,Le,_e,Me,Re,He,je,Ue,qe,ze,Ye,Ve,Ge,We,Je,Ke,Qe,Xe,$e,et,tt,rt,nt,ot,it,at,st,ct,ut,lt,dt,ft,ht,pt,vt,gt,mt,yt,bt,kt,St,Ct,wt,xt,Pt,Et,Zt,Tt,Nt,Ft,It,Bt,Dt;return(0,t.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!R.yG){r.next=5;break}return r.next=3,(0,V.Bm)(V.SZ.OEP,"FluidHost.Debugger.BreakAtMain");case 3:if(!r.sent){r.next=5;break}case 5:return m=H.g.getTimePoint(),y=i.layoutMode,b=i.uiLanguage,r.next=9,(0,ce.g)();case 9:return k=r.sent,S=(null===k||void 0===k?void 0:k.loopInfo)||{},C=i.componentTypeToCreate||"",w=C==R.VP,(0,j.yj)(null===k||void 0===k?void 0:k.consoleLogEnabled),!S.linkUrl&&S.loopData&&(P=JSON.parse(S.loopData),S.linkUrl="string"===typeof P.webUrl?P.webUrl:null===(x=P.webUrl)||void 0===x?void 0:x.href),S.linkText||(S.linkText=i.loopLinkText||""),S.linkUrl||(S.linkUrl=i.loopLinkUrl||""),S.registrationId||(S.registrationId=w?re.E:i.loopRegistrationId||""),E=!S.registrationId||"@fluidx/office-fluid-container"===S.registrationId,Z=S.registrationId===ne.E,T=null===k||void 0===k?void 0:k.fluidSettingOverrides,N=null===k||void 0===k?void 0:k.hydrateId,F=null!==(a=null===k||void 0===k?void 0:k.isDarkBackground)&&void 0!==a&&a,I=null!==(s=null===k||void 0===k?void 0:k.isInEditableDocument)&&void 0!==s&&s,B=null!==k&&void 0!==k&&k.linkProblemState||null!==k&&void 0!==k&&k.isPermissionError?ae.Nb.Error:ae.Nb.None,D=null!==(u=null===k||void 0===k?void 0:k.useTokenCache)&&void 0!==u&&u,ye.Z.GetInstance().isCacheEnabled=D,r.next=29,ke();case 29:return A=r.sent,q=Ce({entryPoint:i.scenarioEntryPoint,name:i.scenarioName,lifecycle:i.scenarioLifecycle,startTime:null!==(l=null===k||void 0===k?void 0:k.scenarioStartTime)&&void 0!==l?l:(0,me.h)()}),z="Create"==q.lifecycle,G=(0,V.Bm)(V.SZ.OEP,"FluidHost.MIP"),J=(0,V.Bm)(V.SZ.OEP,"FluidHost.FluentV9"),ee=(0,V.Bm)(V.SZ.OEP,"FluidHost.LoadCodeFromHint"),Se="".concat(q.lifecycle,"_").concat(q.name,"_").concat(q.entryPoint),we=null!==(f=(null===k||void 0===k?void 0:k.showTeachingCallout)&&E)&&void 0!==f&&f,r.next=39,(0,oe.p)();case 39:if(Pe=r.sent,Ee={buttonText:Pe.GotIt,descriptionText:Pe.CalloutDescription,headerText:Pe.CalloutTitle,officeTheme:null===k||void 0===k?void 0:k.officeTheme,calloutColors:null===k||void 0===k?void 0:k.teachingCalloutColors},Ze=null!==(p=null===k||void 0===k?void 0:k.useNewAnimatedSplashScreen)&&void 0!==p&&p,Te=null!==(v=null===k||void 0===k?void 0:k.enableShowLoopGlowBorderEvent)&&void 0!==v&&v,Ne=null!==(g=null===k||void 0===k?void 0:k.enableRightToLeftSplashScreen)&&void 0!==g&&g,(0,V.XA)(),(0,j.cM)("Audience: ".concat(A)),(0,j.cM)("Scenario: ".concat(Se)),(0,j.cM)("LayoutMode: ".concat(y)),(0,j.cM)("UI Language: ".concat(b)),(0,j.cM)("Native info: ".concat(JSON.stringify(k,void 0,"  "))),(0,j.cM)("Loop info: ".concat(JSON.stringify(S,void 0,"  "))),(0,j.cM)("Is Fluid Loop: ".concat(E)),!E||S.linkUrl||z){r.next=63;break}return 1e3,r.next=56,(0,V.dT)(V.SZ.OEP,"FluidHost.DelayTimeWhenNoFluidUrl",1e3);case 56:return Fe=r.sent,r.next=59,(0,fe._)(Fe);case 59:return r.next=61,(0,pe.z)(ve.l.Success_NoFluidUrl);case 61:r.next=194;break;case 63:return De=new ge.Y(N||"",Se,A,m),Ae=z?(0,de.Uv)("attachments"):Promise.resolve(""),Oe=Promise.resolve(z?S.linkText:""),z||((0,X.ls)(S.linkUrl),"Paste"===q.lifecycle&&(S.linkUrl=(0,L.G)(S.linkUrl)),E&&((Le=(0,o.KT)(new URL(S.linkUrl)))||(0,j.H)("Unable to get the SharePoint locator from the Fluid url."))),r.next=69,(0,X.vg)(b);case 69:return _e=r.sent,Me=_e.localeContext,Re=_e.localization,He=_e.internationalizationContext,je=document.getElementById(R.OP),Ue=document.getElementById(R.Nl),je&&(je.hidden=!0),null===Ue||void 0===Ue||Ue.removeAttribute("hidden"),qe=null===Ue||void 0===Ue?void 0:Ue.clientWidth,ze=qe?Math.min(qe,R.UB):R.UB,Ye=(0,he.I)(F,Ze),Ve=Ye.background,Ge=Ye.shimmer,(We=document.createElement("div")).className="combined",(Je=document.createElement("object")).data=Ve,Je.width=(null===qe||void 0===qe?void 0:qe.toString())||"",Je.height=Ze?R.xf.toString():R.iJ.toString(),(Ke=document.createElement("object")).data=Ge,Ke.width=ze.toString(),Ke.height=Ze?R.xf.toString():R.iJ.toString(),Ne&&"rtl"==Re.localeDirection&&(Ke.style.transform="scale(-1, 1)"),Ke.onload=function(){setTimeout((function(){(0,se.NS)()}),200)},Ke.onerror=function(){Ue&&(Ue.hidden=!0),null===je||void 0===je||je.removeAttribute("hidden"),(0,K.w5)("main()",new K.gz("Failed to load animated Svg.")),(0,se.NS)()},We.append(Je,Ke),null===Ue||void 0===Ue||Ue.append(We),Qe=(0,le.MQ)().replace(/[{}]/g,"").toLowerCase(),Xe=null!==N&&void 0!==N?N:(0,be.u)(),$e=(0,X._N)(Qe,Xe,q,A,Me),r.t0=Xe,r.t1=Qe,et={get TelemetryConfig(){return this},hostCorrelationId:r.t0,hostSessionId:r.t1},tt=new ue.Q,rt=(0,X.Wp)($e,k,A),nt=_.L.startScenario(rt,q.lifecycle),ot=new O({ecsFilters:{audience:$e.audience,userContext:$e.userContext},hostName:$e.hostName},rt),it=new te(A,ot,T),r.next=108,J;case 108:if(at=r.sent,st=(0,X.To)(F,at),ct=st.stylingProvider,ut=st.initialTheme,lt=st.initialThemeV9,r.t2=E,!r.t2){r.next=115;break}return r.next=114,G;case 114:r.t2=r.sent;case 115:if(dt=r.t2,ft=dt?c({tokenProvider:tt,settingsProvider:it,logger:rt,locale:Re.locale}):void 0,dt&&void 0===ft&&(0,K.w5)("main()",new K.gz("getInformationProtectionServiceForSharepoint() failed.")),dt&&ft&&Le)try{d(ft,Le.siteUrl,Le.driveId,Le.itemId,rt)}catch(At){(0,K.w5)("preCacheInformationProtectionWithSharePointIds()",new K.gz("Exception occurred.",At))}if(ht=new h.W(ct),mt=void 0!==(null===k||void 0===k?void 0:k.isOptionalConnectedExperiencesEnabled),yt=void 0!==(null===k||void 0===k?void 0:k.isOptionalConnectedExperiencesEnabled)?new $(mt):void 0,!Z){r.next=129;break}return r.next=125,(0,ie.sr)();case 125:bt=r.sent,gt=bt.getUrlHandlerProvider(),vt=bt.getMetaOSProvider(),pt=null!==k&&void 0!==k&&k.isCardChannelProviderEnabled?bt.getCardChanelProvider():void 0;case 129:return r.next=131,ee;case 131:return kt=r.sent,St=(0,X.tl)(A),Ct={environment:St,logger:rt,loadCodeFromHint:kt},wt=(null===k||void 0===k?void 0:k.partitionCacheKey)||null,xt=k&&""!==k.partitionCacheKey,Pt=void 0,E&&(Pt=(0,Y.x1)(De,Ct,rt,it,tt,xt,wt)),Et=(0,M.n)(tt,rt),r.next=141,W({cardChannelProvider:pt,documentServiceFactory:Pt,hostContext:$e,informationProtectionServicePromise:ft,metaOSProvider:vt,officeFluidLogger:rt,optionalConnectedProvider:yt,presenceColorProvider:ht,settingsProvider:it,stylingProvider:ct,tokenProvider:tt,urlHandlerProvider:gt,urlResolver:Et,internationalizationContext:He,telemetryConfig:et});case 141:return Zt=r.sent,Tt={url:S.linkUrl,headers:{isSharingLinkToRedeem:!0}},dt&&(Tt.headers=(0,e.Z)((0,e.Z)({},Tt.headers),{},{"X-CLP-Compliant-App":!0})),r.next=146,Oe;case 146:return Nt=r.sent,Ft="Mac"!==$e.hostAppPlatform,De.setLoadPerfTracker(),(It=(0,Q.r)(z,C,Ae,Nt,S,Ct,$e,N,Tt,Pt,Et,Zt,rt)).then((function(){var e;De.onLoadComplete(tt);var t=null===(e=De.LoadPerfTracker)||void 0===e?void 0:e.getDurationInSeconds();(0,j.cM)("Fluid component loaded. (".concat(null!==t&&void 0!==t?t:"??"," s)")),S.loopData&&(0,j.cM)("  Data: ".concat(S.loopData)),S.loopIconUrl&&(0,j.cM)("  Icon: ".concat(S.loopIconUrl)),S.loopName&&(0,j.cM)("  Name: ".concat(S.loopName)),S.loopTitle&&(0,j.cM)("  Title: ".concat(S.loopTitle)),S.linkText&&(0,j.cM)("  Link Text: ".concat(S.linkText)),S.linkUrl&&(0,j.cM)("  Link Url: ".concat(S.linkUrl))})),z&&It.catch((0,n.Z)((0,t.Z)().mark((function e(){return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,V.UT)(V.SZ.OEP,"ChangeGate.FluidHost.CreateFailed");case 2:if(!e.sent){e.next=4;break}(0,se.W8)(C);case 4:case"end":return e.stop()}}),e)})))),xe($e),(0,X.Rn)(y),Bt={controlClickToFollowLink:Pe.ControlClickToFollowLink,isDarkBackground:F,linkProblemState:B,linkText:S.linkText,linkUrl:S.linkUrl,onClick:function(e){(0,X.kO)(e,I)},textForEmptyUrl:Pe.GettingThisReady,updateTheme:void 0},De.setInitialRenderPerfTracker(),r.t3=U,r.next=159,(0,V.$G)();case 159:r.t4=r.sent,r.t5=Ft,r.t6=Tt,r.t7=Zt,r.t8=Pt,r.t9=Te,r.t10=z,r.t11=Bt,r.t12=Ct,r.t13=$e,r.t14=ft,r.t15=ut,r.t16=lt,r.t17=at,r.t18=I,r.t19=dt,r.t20=y,r.t21=It,r.t22=Re,r.t23=S,r.t24=rt,r.t25=ht,r.t26=nt,r.t27=it,r.t28=De,r.t29=ct,r.t30=Ee,r.t31=tt,r.t32=Et,r.t33=we,r.t34={areLoopComponentPropertiesEnabled:r.t4,canSetFocusToLink:r.t5,containerRequest:r.t6,dependencySynthesizer:r.t7,documentServiceFactory:r.t8,enableShowLoopGlowBorderEvent:r.t9,giveComponentFocus:r.t10,headerProps:r.t11,hostConfig:r.t12,hostContext:r.t13,informationProtectionServicePromise:r.t14,initialTheme:r.t15,initialThemeV9:r.t16,isFluentV9Enabled:r.t17,isInEditableDocument:r.t18,isMIPEnabled:r.t19,layoutMode:r.t20,loadCompletePromise:r.t21,localization:r.t22,loopInfo:r.t23,officeFluidLogger:r.t24,presenceColorProvider:r.t25,scenarioTracker:r.t26,settingsProvider:r.t27,showComponentActivity:r.t28,stylingProvider:r.t29,teachingProps:r.t30,tokenProvider:r.t31,urlResolver:r.t32,wantToShowTeachingCallout:r.t33},(0,r.t3)(r.t34).catch((function(e){(0,K.w5)("appLazyStart()",(0,K.CR)(e))})),null===(Ie=De.WebAppMainPerfTracker)||void 0===Ie||Ie.setSuccess(),Dt=null===(Be=De.WebAppMainPerfTracker)||void 0===Be?void 0:Be.getDurationInSeconds(),(0,j.cM)("WebApp main complete. (".concat(null!==Dt&&void 0!==Dt?Dt:"??"," s)"));case 194:case"end":return r.stop()}}),r)})))).apply(this,arguments)}function xe(e){return Pe.apply(this,arguments)}function Pe(){return(Pe=(0,n.Z)((0,t.Z)().mark((function e(r){return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"Mac"!=r.hostAppPlatform&&(0,V.UT)(V.SZ.OEP,"ChangeGate.FluidOutlook.FixBorder").then((function(e){if(e){var t=document.getElementById(R.OP);t&&(t.style.paddingRight="1px")}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){(0,j.H)(e.message)})),(0,ae.OX)(),(0,ce.g)(),function(e){return we.apply(this,arguments)}(function(e){var t=function(e){var t=e.search?e.search:e.hash;return new URLSearchParams("#"==t[0]?t.substring(1):t)}(e),r=t.get("create"),n=null!==r,o=null!==t.get("paste");return{componentTypeToCreate:r,layoutMode:(0,X.DT)(t.get("layout")),loopRegistrationId:t.get("loopId"),loopLinkText:t.get("linkText")||t.get("fileName"),loopLinkUrl:function(e){switch(e){case"1":return"";case"2":return"https://microsoft-my.sharepoint-df.com/:fl:/p/manos/ETK44FqyWS1HmflsrI7osCcBaCWLXvZ-GinnJBsnNU9ZXg?nav=cz0lMkZwZXJzb25hbCUyRm1hbm9zX21pY3Jvc29mdF9jb20mZD1iIVVET05QQU1XQlVLOUU2U3NyT2dwTEdtQjVpYmliR3BNa2d4RG1rYXlnTFYtaUVoOHAwNDhTNTR4YUUxUVh6R3EmZj0wMUJNWFJUSUpTWERRRlZNU1pGVkRaVDZMTVZTSE9STUJIJmM9JTJGNTU2YzVkNjEtNmY4Ny00MTBiLTlkMzctYTM2OTE5N2Y1OGZkJTNGc3RhcnQlM0R1bmRlZmluZWQlMjZlbmQlM0QyZDhjNmIwNS1jYTg3LTQ3OGMtOGJjZC1lMGNiNzZkOTk2MjgmZmx1aWQ9MSZwPSU0MG1zJTJGb2ZmaWNlLWZsdWlkLWNvbnRhaW5lcg%3D%3D"}return null}(t.get("fluidUrlOverride"))||t.get("linkUrl")||t.get("fluidUrl"),scenarioEntryPoint:t.get("sep")||"",scenarioLifecycle:o?"Paste":n?"Create":"Load",scenarioName:t.get("s")||"",uiLanguage:t.get("locale")||(0,le.Wx)()||"en-us"}}(window.location)).catch((function(e){(0,K.w5)("main()",(0,K.CR)(e))}))}()}();
//# sourceMappingURL=main.3276f88b.js.map