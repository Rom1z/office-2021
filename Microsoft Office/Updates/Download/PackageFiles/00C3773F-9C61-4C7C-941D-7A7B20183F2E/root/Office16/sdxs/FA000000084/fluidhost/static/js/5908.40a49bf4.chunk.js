"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[5908],{14906:function(e,r,t){t.d(r,{k:function(){return n}});var n={GetAppliedLabelError:"GetAppliedLabelError",GetDlpPolicyTipError:"GetDlpPolicyTipError",GetIrmCapabilitiesError:"GetIrmCapabilitiesError",GetLabelsError:"GetLabelsError",GetPolicySettingsError:"GetPolicySettingsError",GetWatermarkingError:"GetWatermarkingError",InvalidLabelId:"InvalidLabelId",InvalidResolvedUrl:"InvalidResolvedUrl",InvalidTenantId:"InvalidTenantId",RemoveLabelError:"RemoveLabelError",SetLabelError:"SetLabelError",EnforceInformationProtectionError:"EnforceInformationProtectionError",ConfigureMandatoryLabelError:"ConfigureMandatoryLabelError",ConfigureIrmCapabilitiesError:"ConfigureIrmCapabilitiesError"}},80395:function(e,r,t){t.d(r,{L:function(){return n}});var n={RefreshTimerTriggered:"RefreshTimerTriggered",MandatoryLabelHandlerSetReadOnly:"MandatoryLabelHandlerSetReadOnly",MandatoryLabelHandlerResetReadOnly:"MandatoryLabelHandlerResetReadOnly",InformationProtectionServiceDisposed:"InformationProtectionServiceDisposed"}},99427:function(e,r,t){t.d(r,{$:function(){return n}});var n={GetAppliedLabel:"GetAppliedLabel",GetIsProtectionEnabled:"GetIsProtectionEnabled",GetIrmCapabilities:"GetIrmCapabilities",GetWatermarking:"GetWatermarking",SetLabel:"SetLabel",RemoveLabel:"RemoveLabel",GetDlpPolicyTip:"GetDlpPolicyTip",ProcessPolicySettings:"ProcessPolicySettings",EnforceInformationProtection:"EnforceInformationProtection",EnforceMandatoryLabelExperience:"EnforceMandatoryLabelExperience"}},64058:function(e,r,t){t.d(r,{t8:function(){return f},TZ:function(){return g}});var n=t(74165),o=t(15861),a=t(74094),i=t(98846),s=t(66773),c=t(42552),u="https://home.microsoftpersonalcontent.com",l=t(45782),d=t(98245),p=t(72633),f="-my",v="-admin",m=".sharepoint.",h=".sharepoint-df.",b=".onmicrosoft.";function g(e,r){var t=new URL(e);if([a._,u].includes(t.origin.toLowerCase()))return"consumers";var n=t.hostname.toLowerCase(),o=function(e){return x().get(e)}(n);if(o)return o.guid?o.guid:(E(e,n,o.hostname,r),o.hostname);var i=n.substring(0,n.indexOf(".")),s=n.substring(i.length),c=!1;0===s.indexOf(m)?s="".concat(b).concat(s.substring(m.length)):0===s.indexOf(h)?s="".concat(b).concat(s.substring(h.length)):c=!0,i.endsWith(f)?i=i.substring(0,i.length-f.length):i.endsWith(v)&&(i=i.substring(0,i.length-v.length));var l=c?void 0:"".concat(i).concat(s);return k(n,{hostname:l}),E(e,n,l,r),l}var I,y=new Set;function E(e,r,t,a){y.has(r)||(y.add(r),(0,d.F)((0,o.Z)((0,n.Z)().mark((function o(){var u,d,p,f;return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,d="".concat((0,c.P)(e),"/_api/v2.0/drives"),n.prev=2,n.next=5,(0,s.q4)(d,{method:"GET",headers:{Authorization:"Bearer"},credentials:"omit"});case 5:p=n.sent,n.next=11;break;case 8:n.prev=8,n.t0=n.catch(2),u="Server did not respond";case 11:p&&((f=(0,l.r)(p.result.headers))?k(r,{hostname:t,guid:f}):u="ODSP did not return tenant id in headers. Response status code: ".concat(p.result.status)),n.next=17;break;case 14:n.prev=14,n.t1=n.catch(0),u="Unexpected error";case 17:return n.prev=17,y.delete(r),n.finish(17);case 20:u&&a&&(0,i.ve)(a,{eventName:"AadTenantNotFound",message:u});case 21:case"end":return n.stop()}}),o,null,[[0,14,17,20],[2,8]])}))),{ensureExecution:!1}))}var L="FluidSiteToAadTenantMapping";function x(){if(!I){var e,r=(0,p.E)(),t=null===r||void 0===r?void 0:r.getItem(L);if(t)try{e=JSON.parse(t)}catch(n){null===r||void 0===r||r.removeItem(L)}I=new Map(e)}return I}function k(e,r){x().set(e,r),G()}var P=!1;function G(){P||(P=!0,(0,d.F)((function(){var e;I&&(null===(e=(0,p.E)())||void 0===e||e.setItem(L,JSON.stringify(Array.from(I.entries()))));P=!1}),{ensureExecution:!0}))}},42552:function(e,r,t){function n(e){return new URL(e).origin}t.d(r,{P:function(){return n}})},24466:function(e,r,t){t.d(r,{HJ:function(){return g},Nm:function(){return h},eC:function(){return v},tS:function(){return b},zU:function(){return f}});var n=t(74165),o=t(1413),a=t(15861),i=t(42552),s=t(12338),c=t(17736),u=t(78030),l=t(39680),d=t(98846),p=new Map;function f(e,r,t,u,f,v){var m=(0,i.P)(r),h="".concat(m,"_").concat(t,"_").concat(u);if(!p.has(h)){var b=function(){var i=(0,a.Z)((0,n.Z)().mark((function i(){var b,g,I,y,E,L,x,k;return(0,n.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return I="".concat(m,"/_api/v2.0/drives/").concat(t,"/items/").concat(u,"?select=sharepointIds"),y={getToken:function(n){var a=(0,o.Z)((0,o.Z)({},n),{},{siteUrl:r,driveId:t,itemId:u});return e.getToken(["".concat(m,"/files.readwrite.all")],a)},url:I,tenantId:v,requestInit:{method:"GET"},retryPolicy:l.Uj,tokenPolicy:(0,l.Gh)(e)},E=f?(0,s.Y)((0,o.Z)((0,o.Z)({},y),{},{logger:f,nameForLogging:"GetFileSharepointIds",doNotLogOnSuccess:!0,getAdditionalProps:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(r,t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.I)(r));case 1:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}()})):(0,s.h)(y),i.prev=3,i.next=6,E;case 6:L=i.sent.result,i.next=11;break;case 9:i.prev=9,i.t0=i.catch(3);case 11:if(null===(b=L)||void 0===b||!b.ok){i.next=26;break}return i.prev=12,i.next=15,L.json();case 15:k=i.sent,i.next=21;break;case 18:i.prev=18,i.t1=i.catch(12),f&&(0,d.uX)(f,{eventName:"GetFileSharepointIdsResponseParseError"},i.t1);case 21:if(null===(x=k)||void 0===x||!x.sharepointIds){i.next=25;break}return i.abrupt("return",k.sharepointIds);case 25:f&&(0,d.uX)(f,{eventName:"GetFileSharepointIdsUnexpectedResponse"},new Error("sharepointIds is missing from response body"));case 26:return 404!==(null===(g=L)||void 0===g?void 0:g.status)&&p.delete(h),i.abrupt("return",void 0);case 28:case"end":return i.stop()}}),i,null,[[3,9],[12,18]])})));return function(){return i.apply(this,arguments)}}();p.set(h,b())}return p.get(h).then()}function v(e,r,t,n,o,a){return m.apply(this,arguments)}function m(){return m=(0,a.Z)((0,n.Z)().mark((function e(r,t,u,p,f,v){var m,h,b,g,I,y;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h=(0,i.P)(t),b="".concat(h,"/_api/v2.0/drives/").concat(u,"/items/").concat(p,"?select=webUrl,webDavUrl,name,sharepointIds"),g={getToken:function(e){var n=(0,o.Z)((0,o.Z)({},e),{},{siteUrl:t,driveId:u,itemId:p});return r.getToken(["".concat(h,"/files.readwrite.all")],n)},url:b,tenantId:v,requestInit:{method:"GET"},retryPolicy:l.Uj,tokenPolicy:(0,l.Gh)(r)},I=f?(0,s.Y)((0,o.Z)((0,o.Z)({},g),{},{logger:f,nameForLogging:"GetFileItemLite",doNotLogOnSuccess:!0,getAdditionalProps:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(r,t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.I)(r));case 1:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}()})):(0,s.h)(g),e.prev=4,e.next=7,I;case 7:y=e.sent.result,e.next=12;break;case 10:e.prev=10,e.t0=e.catch(4);case 12:if(null===(m=y)||void 0===m||!m.ok){e.next=22;break}return e.prev=13,e.next=16,y.json();case 16:return e.abrupt("return",e.sent);case 19:e.prev=19,e.t1=e.catch(13),f&&(0,d.uX)(f,{eventName:"GetFileItemLiteResponseParseError"},e.t1);case 22:return e.abrupt("return",void 0);case 23:case"end":return e.stop()}}),e,null,[[4,10],[13,19]])}))),m.apply(this,arguments)}var h=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(r,t,o,a){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b(r)){e.next=2;break}return e.abrupt("return",void 0);case 2:return e.abrupt("return",v(t,r.siteUrl,r.driveId,r.itemId,o,a).then((function(e){var r=null===e||void 0===e?void 0:e.webDavUrl.lastIndexOf("/");if(void 0!==r&&r>0)return null===e||void 0===e?void 0:e.webDavUrl.substring(0,r)})));case 3:case"end":return e.stop()}}),e)})));return function(r,t,n,o){return e.apply(this,arguments)}}(),b=function(e){return function(e){return"fluid"===e.type}(e)&&"driveId"in e&&"siteUrl"in e&&"itemId"in e},g=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(r){var t,o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=new u.D,e.next=4,t.resolve({url:r});case 4:return o=e.sent,e.abrupt("return",o);case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",Promise.resolve(void 0));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(r){return e.apply(this,arguments)}}()},39680:function(e,r,t){t.d(r,{Gh:function(){return l},Uj:function(){return s}});var n=t(1413),o=t(96701),a=t(97103),i=t(66773),s={maxRetries:2,backoffFn:(0,a.py)(500),filter:(0,i.mE)([408,409,429,503]),respectRetryAfterHeader:!0},c={scheme:o.g,queryParam:"access_token",doNotExceedQueryParamsLength:2048,preferAuthorizationInMultipartFormBody:!0,doNotExceedMultipartFormBodyLength:81920},u={scheme:o.g,preferAuthorizationInMultipartFormBody:!0,doNotExceedMultipartFormBodyLength:81920};function l(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t="Consumer"===e.identityType?u:c;return(0,n.Z)((0,n.Z)({},t),{},{preferAuthorizationInMultipartFormBody:r})}}}]);
//# sourceMappingURL=5908.40a49bf4.chunk.js.map