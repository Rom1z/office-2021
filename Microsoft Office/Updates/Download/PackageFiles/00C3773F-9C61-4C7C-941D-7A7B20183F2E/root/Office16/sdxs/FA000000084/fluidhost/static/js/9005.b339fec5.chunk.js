/*! For license information please see 9005.b339fec5.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[9005],{69005:function(e,t,r){r.r(t),r.d(t,{IdCompressor:function(){return de},SessionIdNormalizer:function(){return ee},assertIsStableId:function(){return C},assertIsUuidString:function(){return x},compareStrings:function(){return p},createSessionId:function(){return D},defaultClusterCapacity:function(){return oe},ensureSessionUuid:function(){return Q},fail:function(){return y},generateStableId:function(){return b},getIds:function(){return _},getOrCreate:function(){return f},getPositiveDelta:function(){return U},hasOngoingSession:function(){return ve},incrementUuid:function(){return W},isFinalId:function(){return ue},isLocalId:function(){return ce},isStableId:function(){return O},numericUuidEquals:function(){return q},numericUuidFromStableId:function(){return V},stableIdFromNumericUuid:function(){return M}});var i=r(37762),n=r(29439),s=r(93433),a=r(15671),o=r(43144),l=r(27186),u=r(48563),c=r.n(u);function d(e,t){return e-t}function h(e,t){return t-e}function v(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object.is;if(e.size!==t.size)return!1;var s,a=(0,i.Z)(e);try{for(a.s();!(s=a.n()).done;){var o=(0,n.Z)(s.value,2),l=o[0],u=o[1],c=t.get(l);if(void 0===c||!r(u,c))return!1}}catch(d){a.e(d)}finally{a.f()}return!0}function f(e,t,r){var i=e.get(t);return void 0===i&&(i=r(t),e.set(t,i)),i}function p(e,t){return e>t?1:e===t?0:-1}function y(e){throw new Error(e)}function g(e,t,r){void 0!==e&&(t[r]=e)}var m=r(92810),I=Array.from("09afAF").map((function(e){return e.charCodeAt(0)}));function k(e){return e>=I[0]&&e<=I[1]||e>=I[2]&&e<=I[3]||e>=I[4]&&e<=I[5]}x("00000000-0000-0000-0000-000000000000");function x(e){return(0,l.h)(function(e){for(var t=0;t<e.length;t++)switch(t){case 8:case 13:case 18:case 23:if("-"!==e.charAt(t))return!1;break;default:if(!k(e.charCodeAt(t)))return!1}return!0}(e),1186),e}function b(){return C((0,m.Z)())}function C(e){return(0,l.h)(O(e),1187),e}function O(e){if(36!==e.length)return!1;for(var t=0;t<e.length;t++)switch(t){case 8:case 13:case 18:case 23:if("-"!==e.charAt(t))return!1;break;case 14:if("4"!==e.charAt(t))return!1;break;case 19:var r=e.charAt(t);if("8"!==r&&"9"!==r&&"a"!==r&&"b"!==r)return!1;break;default:if(!k(e.charCodeAt(t)))return!1}return!0}var w=r(11752),S=r(61120),N=r(60136),Z=r(29388),L=r(74165),z=function(){function e(t){(0,a.Z)(this,e),this.comparator=t,this.elements=[]}return(0,o.Z)(e,[{key:"size",get:function(){return this.elements.length/2}},{key:"minKey",value:function(){return this.elements[0]}},{key:"maxKey",value:function(){return this.elements[this.elements.length-2]}},{key:"minValue",value:function(){return this.elements[1]}},{key:"maxValue",value:function(){return this.elements[this.elements.length-1]}},{key:"first",value:function(){var e=this.elements;if(0!==e.length)return[e[0],e[1]]}},{key:"last",value:function(){var e=this.elements,t=e.length;if(0!==t){var r=t-2;return[e[r],e[r+1]]}}},{key:"getAtIndex",value:function(e){var t=2*e,r=this.elements;if(!(t<0||t>r.length-1))return[r[t],r[t+1]]}},{key:"entries",value:(0,L.Z)().mark((function e(){var t,r;return(0,L.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.elements,r=0;case 2:if(!(r<t.length)){e.next=8;break}return e.next=5,[t[r],t[r+1]];case 5:r+=2,e.next=2;break;case 8:case"end":return e.stop()}}),e,this)}))},{key:"keys",value:(0,L.Z)().mark((function e(){var t,r;return(0,L.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.elements,r=0;case 2:if(!(r<t.length)){e.next=8;break}return e.next=5,t[r];case 5:r+=2,e.next=2;break;case 8:case"end":return e.stop()}}),e,this)}))},{key:"values",value:(0,L.Z)().mark((function e(){var t,r;return(0,L.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.elements,r=0;case 2:if(!(r<t.length)){e.next=8;break}return e.next=5,t[r+1];case 5:r+=2,e.next=2;break;case 8:case"end":return e.stop()}}),e,this)}))},{key:"entriesReversed",value:(0,L.Z)().mark((function e(){var t,r;return(0,L.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.elements,r=t.length-2;case 2:if(!(r>=0)){e.next=8;break}return e.next=5,[t[r],t[r+1]];case 5:r-=2,e.next=2;break;case 8:case"end":return e.stop()}}),e,this)}))},{key:"append",value:function(e,t){var r=this.elements;0!==r.length&&this.comparator(e,this.maxKey())<=0&&y("Inserted key must be > all others in the map."),r.push(e),r.push(t)}},{key:"get",value:function(t){var r=e.keyIndexOf(this.elements,t,this.comparator);if(!(r<0))return this.elements[r+1]}},{key:"getPairOrNextLower",value:function(e){return this.getPairOrNextLowerBy(e,this.comparator)}},{key:"getPairOrNextHigher",value:function(e){return this.getPairOrNextHigherBy(e,this.comparator)}},{key:"equals",value:function(e,t){if(e===this)return!0;if(this.elements.length!==e.elements.length)return!1;for(var r=this.elements.length-2;r>=0;r-=2){var i=this.elements[r],n=this.elements[r+1],s=e.elements[r],a=e.elements[r+1];if(0!==this.comparator(i,s))return!1;if(!t(n,a))return!1}return!0}},{key:"assertValid",value:function(){var e,t,r=(0,i.Z)(this.entries());try{for(r.s();!(t=r.n()).done;){var n=t.value;void 0!==e&&(0,l.h)(this.comparator(n[0],e[0])>0,1151),e=n}}catch(s){r.e(s)}finally{r.f()}}},{key:"getRange",value:(0,L.Z)().mark((function e(t,r){var i,n,s;return(0,L.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(i=this.getKeyIndexOfOrNextHigher(t,this.comparator))){e.next=3;break}return e.abrupt("return");case 3:if(void 0!==(n=this.getKeyIndexOfOrNextLower(r,this.comparator))){e.next=6;break}return e.abrupt("return");case 6:s=i;case 7:if(!(s<=n)){e.next=13;break}return e.next=10,[this.elements[s],this.elements[s+1]];case 10:s+=2,e.next=7;break;case 13:case"end":return e.stop()}}),e,this)}))},{key:"getPairOrNextLowerBy",value:function(e,t){var r=this.getKeyIndexOfOrNextLower(e,t);if(void 0!==r)return[this.elements[r],this.elements[r+1]]}},{key:"getKeyIndexOfOrNextLower",value:function(t,r){var i=this.elements;if(0!==i.length){var n=e.keyIndexOf(i,t,r);return n<0?(n^=e.failureXor)>0?n-2:void 0:n}}},{key:"getPairOrNextHigherBy",value:function(e,t){var r=this.getKeyIndexOfOrNextHigher(e,t);if(void 0!==r)return[this.elements[r],this.elements[r+1]]}},{key:"getKeyIndexOfOrNextHigher",value:function(t,r){var i=this.elements,n=i.length;if(0!==n){var s=e.keyIndexOf(i,t,r);return s<0?(s^=e.failureXor)<n?s:void 0:s}}}],[{key:"keyIndexOf",value:function(t,r,i){for(var n=0,s=t.length/2,a=s>>1;n<s;){var o=2*a,l=i(r,t[o],t[o+1]);if(l>0)n=a+1;else if(l<0)s=a;else{if(0===l)return o;y("Invalid comparator.")}a=n+s>>1}return 2*a^e.failureXor}}]),e}();z.failureXor=-1;var F=function(e){(0,N.Z)(r,e);var t=(0,Z.Z)(r);function r(e,i,n){var s;return(0,a.Z)(this,r),(s=t.call(this,e)).extractSearchValue=i,s.valueComparator=n,s.compareValues=function(e,t,r){return s.valueComparator(e,s.extractSearchValue(r))},s}return(0,o.Z)(r,[{key:"append",value:function(e,t){0!==this.elements.length&&this.valueComparator(this.extractSearchValue(t),this.extractSearchValue(this.maxValue()))<=0&&y("Inserted value must be > all others in the map."),(0,w.Z)((0,S.Z)(r.prototype),"append",this).call(this,e,t)}},{key:"getPairOrNextLowerByValue",value:function(e){return this.getPairOrNextLowerBy(e,this.compareValues)}},{key:"getPairOrNextHigherByValue",value:function(e){return this.getPairOrNextHigherBy(e,this.compareValues)}},{key:"assertValid",value:function(){var e;(0,w.Z)((0,S.Z)(r.prototype),"assertValid",this).call(this);var t,n=(0,i.Z)(this.entries());try{for(n.s();!(t=n.n()).done;){var s=t.value;void 0!==e&&(0,l.h)(this.valueComparator(this.extractSearchValue(s[1]),this.extractSearchValue(e[1]))>0,1152),e=s}}catch(a){n.e(a)}finally{n.f()}}}]),r}(z);function _(e){var t=e.ids;if(void 0!==t){var r=t.first,i=t.last,n=t;return void 0!==n.overrides&&(null!==r&&void 0!==r||(r=n.overrides[0][0]),null!==i&&void 0!==i||(i=n.overrides[n.overrides.length-1][0])),(0,l.h)(void 0!==r&&void 0!==i,1179),{first:r,last:i,overrides:n.overrides}}}var R=13,P=22,K=Math.pow(2,52)-1,A=Math.pow(2,52);function U(e,t,r){var i=(0,n.Z)(e,2),s=i[0],a=i[1],o=(0,n.Z)(t,2),l=o[0],u=o[1];if(s===l){var c=a-u;return c>=0&&c<=r?c:void 0}var d=Number.parseInt(j.Upper.parse(s),16)-Number.parseInt(j.Upper.parse(l),16);if(!(Math.abs(d)>1)){var h=j.getNumericValue(j.Variant.parse(s)),v=j.getNumericValue(j.Variant.parse(l)),f=a-u;f<0&&(h-=1,f+=A);var p=h-v;if(p<0&&(d-=1,p+=j.twentyThirdBit),0===d&&!(p>1)){var y=A*p+f;return y>r?void 0:y}}}for(var B=[],E=0;E<R;E++)B.push("0".repeat(E));function T(e,t){return e.length===t?e:B[t-e.length]+e}function M(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=e[1]+t;if(r<=K){var i=T(r.toString(16),R);return"".concat(e[0]+i.slice(0,1),"-").concat(i.slice(1))}return M(W(e,t))}function V(e){var t=new Array(2);return t[0]=e.slice(0,P),t[1]=Number.parseInt(j.Lower.parse(e),16),t}function D(){return Q(b())}function q(e,t){return e[0]===t[0]&&e[1]===t[1]}var j,H=Math.pow(2,48)-1;function W(e,t){var r,i=e[1]+t;if(i<=K)r=[e[0],i];else{var s=t-(K-e[1])-1,a=e[0],o=j.increment(a),u=(0,n.Z)(o,2),c=u[0];if(u[1]){var d=j.Upper.parse(a),h=Number.parseInt(d,16);(0,l.h)(h<=H,1180);var v=h+1;if(v>H)y("Exceeded maximum numeric UUID");else{var f=T(v.toString(16),12);r=["".concat(j.Upper.hyphenate(f),"-4").concat(j.Variant.hyphenate(c)),s]}}else r=["".concat(j.Upper.slice(a),"-4").concat(j.Variant.hyphenate(c)),s]}return r}!function(e){var t,r=16773120,i=768,n=255,s=Math.pow(2,22)-1;function a(e){var t=Number.parseInt(e,16);return((t&r)>>2)+(t&i)+(t&n)}e.twentyThirdBit=Math.pow(2,22),function(e){e.parse=function(e){return e.slice(0,8)+e.slice(9,13)},e.hyphenate=function(e){return"".concat(e.slice(0,8),"-").concat(e.slice(8))},e.slice=function(e){return e.slice(0,13)}}(e.Upper||(e.Upper={})),function(e){e.parse=function(e){return e.slice(15,18)+e.slice(19,22)},e.hyphenate=function(e){return"".concat(e.slice(0,3),"-").concat(e.slice(3))}}(t=e.Variant||(e.Variant={})),function(e){e.parse=function(e){return e.slice(P,P+1)+e.slice(P+2)},e.hyphenate=function(e){return"".concat(e.slice(0,1),"-").concat(e.slice(1))}}(e.Lower||(e.Lower={})),e.getNumericValue=a,e.increment=function(e){var o=t.parse(e),u=a(o);(0,l.h)(u<=s,1181);var c=u+1;return[T((((c&r>>2)<<2)+(c&i|2048)+(c&n)).toString(16),o.length),c>s]}}(j||(j={}));var X="ffffffff-ffff-4fff-bf",G=(0,s.Z)(X).filter((function(e){return"f"===e})).length,J=["7","b","d","e"];function Y(e){return"f"===X.charAt(e)}function Q(e){if(e.startsWith(X)){for(var t=Math.floor(Math.random()*G),r=0,i=0;i<t&&!Y(r);r+=1)Y(r)&&i++;var n=J[Math.floor(Math.random()*J.length)];return e.slice(0,r)+n+e.slice(r+1)}return e}var $=(0,L.Z)().mark(ae),ee=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(0,a.Z)(this,t),this.expensiveAsserts=e,this.nextLocalId=-1,this.idRanges=new F(h,(function(e){var t=(0,n.Z)(e,2),r=(t[0],t[1]);if(void 0!==r){var i=function(e){var t;if(te(e))return e;return(null!==(t=e.first())&&void 0!==t?t:y("Map must be non-empty"))[1]}(r);return ie(i)}return Number.POSITIVE_INFINITY}),d)}return(0,o.Z)(t,[{key:"getSessionSpaceId",value:function(e){var t=this.idRanges.getPairOrNextLowerByValue(e);if(void 0!==t){var r=(0,n.Z)(t,2),i=r[0],s=(0,n.Z)(r[1],2),a=s[0],o=ne(i,s[1],e);if(void 0!==o){var l=(0,n.Z)(o,2),u=l[0],c=(0,n.Z)(l[1],2),d=c[0];if(e<=c[1]){var h=e-d;return h<=u-a?u-h:e}}}}},{key:"getFinalId",value:function(e){var t,r=null!==(t=this.idRanges.getPairOrNextLower(e))&&void 0!==t?t:y("Local ID was never recorded with this normalizer."),i=(0,n.Z)(r,2),s=i[0],a=(0,n.Z)(i[1],2),o=a[0],l=a[1];e<o&&y("Local ID was never recorded with this normalizer.");var u=se(s,l,e);if(void 0!==u){var c=(0,n.Z)(u,2),d=c[0],h=(0,n.Z)(c[1],3),v=h[0],f=h[1],p=h[2],g=d-e;if(g<=f-v)return[v+g,p]}}},{key:"getCreationIndex",value:function(e){var t=this.idRanges.getPairOrNextLowerByValue(e);if(void 0!==t){var r=(0,n.Z)(t,2),i=r[0],s=(0,n.Z)(r[1],2),a=(s[0],ne(i,s[1],e));if(void 0!==a){var o=(0,n.Z)(a,2),l=o[0],u=(0,n.Z)(o[1],2),c=u[0];if(e<=u[1])return-l-1+(e-c)}}}},{key:"getIdByCreationIndex",value:function(e){var t,r=-(e+1),i=this.idRanges.getPairOrNextLower(r);if(void 0!==i){var s=(0,n.Z)(i,2),a=s[0],o=(0,n.Z)(s[1],2),l=o[0],u=o[1];if(r>=l)return r;var c=null!==(t=se(a,u,r))&&void 0!==t?t:y("Final ranges not aligned with owning local range."),d=(0,n.Z)(c,2),h=d[0],v=(0,n.Z)(d[1],2),f=v[0]+(h-r);return f<=v[1]?f:void 0}}},{key:"getLastFinalId",value:function(){for(var e=this.idRanges.size-1,t=Math.max(0,e-1),r=e;r>=t;r--){var i=this.idRanges.getAtIndex(r);if(void 0!==i){var n=i[1][1];if(void 0!==n)return re(n)[1]}}}},{key:"addLocalId",value:function(){var e=this.nextLocalId--,t=this.idRanges.last();if(void 0!==t&&e===t[1][0]-1)return t[1][0]=e,e;if(this.expensiveAsserts)if(void 0===t)(0,l.h)(-1===e,1182);else{var r,s=(0,n.Z)(t,2),a=s[0],o=(0,n.Z)(s[1],2),u=(o[0],o[1]),c=0,d=(0,i.Z)(ae(a,u));try{for(d.s();!(r=d.n()).done;){var h=(0,n.Z)(r.value,2),v=(h[0],(0,n.Z)(h[1],2)),f=v[0];c+=v[1]-f+1}}catch(p){d.e(p)}finally{d.f()}(0,l.h)(e===a-c,1183)}return this.idRanges.append(e,[e,void 0]),e}},{key:"addFinalIds",value:function(e,r,i){var s;(0,l.h)(r>=e,1454);var a,o=null!==(s=this.idRanges.last())&&void 0!==s?s:y("Final IDs must be added to an existing local range."),u=(0,n.Z)(o,2),c=u[0],d=u[1],h=(0,n.Z)(d,2),v=h[0],f=h[1];if(void 0===f)d[1]=[e,r,i],a=Math.min(this.nextLocalId,c-(r-e)-1);else{var p=this.getAlignmentOfLastRange(c,f),g=(0,n.Z)(p,4),m=g[0],I=g[1],k=g[2],x=g[3];if(a=Math.min(this.nextLocalId,I-(r-e)-2),e===k+1)x[1]=r;else{var b,C=I-1;te(f)?((b=t.makeFinalRangesMap()).append(m,x),d[1]=b):b=f,b.append(C,[e,r,i]),(0,l.h)(C>=v,1184)}this.expensiveAsserts&&this.idRanges.assertValid()}this.nextLocalId=a}},{key:"registerFinalIdBlock",value:function(e,t,r){var i;(0,l.h)(t>=1,1455);var s,a=null!==(i=this.idRanges.last())&&void 0!==i?i:y("Final ID block should not be registered before any locals."),o=(0,n.Z)(a,2),u=o[0],c=(0,n.Z)(o[1],2),d=c[0],h=c[1];if(void 0===h)s=u-d+1;else{var v=this.getAlignmentOfLastRange(u,h),f=(0,n.Z)(v,2);f[0];s=f[1]-d}(0,l.h)(s>0,1307);var p=e+Math.min(s,t)-1;this.addFinalIds(e,p,r)}},{key:"getAlignmentOfLastRange",value:function(e,t){var r,i,s;if(te(t))s=e,i=t;else{var a=null!==(r=t.last())&&void 0!==r?r:y("Map should be non-empty."),o=(0,n.Z)(a,2);s=o[0],i=o[1]}var l=i,u=(0,n.Z)(l,2),c=u[0],d=u[1];return[s,s-(d-c),d,i]}},{key:e,value:(0,L.Z)().mark((function e(){var t,r,s,a,o,l,u,c,d,h,v,f,p,g,m,I,k,x;return(0,L.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=(0,i.Z)(this.idRanges.entries()),e.prev=1,r.s();case 3:if((s=r.n()).done){e.next=27;break}a=(0,n.Z)(s.value,2),o=a[0],l=(0,n.Z)(a[1],2),u=l[0],c=l[1],d=o;case 6:if(!(d>=u)){e.next=12;break}return e.next=9,d;case 9:d--,e.next=6;break;case 12:if(void 0===c){e.next=25;break}h=void 0,v=void 0,te(c)?(v=o,h=c):(f=null!==(t=c.last())&&void 0!==t?t:y("Map should be non-empty."),p=(0,n.Z)(f,2),v=p[0],h=p[1]),g=h,m=(0,n.Z)(g,2),I=m[0],k=m[1],x=I+(v-u)+1;case 19:if(!(x<=k)){e.next=25;break}return e.next=22,x;case 22:x++,e.next=19;break;case 25:e.next=3;break;case 27:e.next=32;break;case 29:e.prev=29,e.t0=e.catch(1),r.e(e.t0);case 32:return e.prev=32,r.f(),e.finish(32);case 35:case"end":return e.stop()}}),e,this,[[1,29,32,35]])}))},{key:"serialize",value:function(){var e,t={localRanges:[],nextLocalId:this.nextLocalId},r=t.localRanges,s=(0,i.Z)(this.idRanges.entries());try{for(s.s();!(e=s.n()).done;){var a=(0,n.Z)(e.value,2),o=a[0],l=a[1],u=(0,n.Z)(l,2),c=u[0],d=u[1];if(void 0!==d){var h,v=[],f=(0,i.Z)(ae(o,d));try{for(f.s();!(h=f.n()).done;){var p=(0,n.Z)(h.value,2),y=p[0],g=(0,n.Z)(p[1],2),m=g[0],I=g[1];v.push([y,m,I])}}catch(k){f.e(k)}finally{f.f()}r.push([o,c,v])}else r.push([o,c])}}catch(k){s.e(k)}finally{s.f()}return t}},{key:"equals",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e,t){return e===t};return this.nextLocalId===e.nextLocalId&&this.idRanges.equals(e.idRanges,(function(e,r){var i=(0,n.Z)(e,2),s=i[0],a=i[1],o=(0,n.Z)(r,2),l=o[0],u=o[1];if(void 0===a||void 0===u)return a===u;var c=function(e,r){var i=(0,n.Z)(e,3),s=i[0],a=i[1],o=i[2],l=(0,n.Z)(r,3),u=l[0],c=l[1],d=l[2];return s===u&&a===c&&t(o,d)};return te(a)||te(u)?!(!te(a)||!te(u))&&c(a,u):s===l&&a.equals(u,c)}))}}],[{key:"makeFinalRangesMap",value:function(){return new F(h,ie,d)}},{key:"deserialize",value:function(e,r){var s,a=new t,o=a.idRanges,u=(0,i.Z)(e.localRanges);try{for(u.s();!(s=u.n()).done;){var c=(0,n.Z)(s.value,3),d=c[0],h=c[1],v=c[2],f=void 0;if(void 0!==v)if((0,l.h)(0!==v.length,1185),1===v.length){var p=(0,n.Z)(v[0],3),y=(p[0],p[1]);f=[y,p[2],r(y)]}else{f=t.makeFinalRangesMap();var g,m=(0,i.Z)(v);try{for(m.s();!(g=m.n()).done;){var I=(0,n.Z)(g.value,3),k=I[0],x=I[1],b=I[2];f.append(k,[x,b,r(x)])}}catch(C){m.e(C)}finally{m.f()}}o.append(d,[h,f])}}catch(C){u.e(C)}finally{u.f()}return a.nextLocalId=e.nextLocalId,a}}]),t}(Symbol.iterator);function te(e){return Array.isArray(e)}function re(e){var t;return te(e)?e:(null!==(t=e.last())&&void 0!==t?t:y("Map must be non-empty"))[1]}function ie(e){return e[0]}function ne(e,t,r){if(void 0!==t){if(te(t)){if(r<t[0])return;return[e,t]}return t.getPairOrNextLowerByValue(r)}}function se(e,t,r){if(void 0!==t){if(te(t)){if(r>e)return;return[e,t]}return t.getPairOrNextLower(r)}}function ae(e,t){var r,n,s;return(0,L.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(void 0===t){a.next=23;break}if(!te(t)){a.next=6;break}return a.next=4,[e,t];case 4:a.next=23;break;case 6:r=(0,i.Z)(t.entries()),a.prev=7,r.s();case 9:if((n=r.n()).done){a.next=15;break}return s=n.value,a.next=13,s;case 13:a.next=9;break;case 15:a.next=20;break;case 17:a.prev=17,a.t0=a.catch(7),r.e(a.t0);case 20:return a.prev=20,r.f(),a.finish(20);case 23:case"end":return a.stop()}}),$,null,[[7,17,20,23]])}var oe=512,le=Q(C("decaf40b-3c1a-47f8-a7a1-e8461ddb69ce"));function ue(e){return e>=0}function ce(e){return e<0}var de=function(){function e(t,r){(0,a.Z)(this,e),this.localSessionId=t,this.logger=r,this.newClusterCapacity=oe,this.sessions=new Map,this.nextClusterBaseFinalId=0,this.localIdCount=0,this.localOverrides=new z(h),this.sessionIdNormalizer=new ee,this.clustersAndOverridesInversion=new(c())(void 0,p),this.finalIdToCluster=new z(d),this.localSession=this.createSession(t)}return(0,o.Z)(e,[{key:"clusterCapacity",get:function(){return this.newClusterCapacity},set:function(t){(0,l.h)(t>0,1153),(0,l.h)(t<=e.maxClusterSize,1154),this.newClusterCapacity=t}},{key:"createSession",value:function(e){(0,l.h)(!this.clustersAndOverridesInversion.has(e),1156),void 0!==this.sessions.get(e)&&y("createSession must only be called once for each session ID.");var t={sessionUuid:V(e),currentClusterDetails:void 0,lastFinalizedLocalId:void 0};return this.sessions.set(e,t),t}},{key:"takeNextCreationRange",value:function(){var e,t,r,i=-this.localIdCount,n=null!==(e=this.lastTakenLocalId)&&void 0!==e?e:0;if((0,l.h)(i<=n,1157),i!==n){var a=n-1,o=(0,s.Z)(this.localOverrides.getRange(n-1,i));if(r=1,o.length>=r){(0,l.h)(o[0][0]<=a,1158),(0,l.h)(o[o.length-1][0]>=i,1159),t={overrides:o};var u=a===o[0][0]?void 0:a,c=i===o[o.length-1][0]?void 0:i;g(u,t,"first"),g(c,t,"last")}else t={first:a,last:i};this.lastTakenLocalId=i}var d={sessionId:this.localSessionId};return void 0===t||((0,l.h)(this.lastTakenLocalId===-this.localIdCount&&this.lastTakenLocalId!==n,1160),d.ids=t),d}},{key:"finalizeCreationRange",value:function(t){var r,i,s,a,o,u,c,d,h,v,f,p,m=t.sessionId,I=m===this.localSessionId,k=null!==(r=this.sessions.get(m))&&void 0!==r?r:this.createSession(m),x=_(t);if(void 0!==x){var b=k.currentClusterDetails,C=null!==b&&void 0!==b?b:{cluster:void 0,clusterBase:void 0},O=C.cluster,w=C.clusterBase,S=void 0!==O&&void 0!==w,N=null!==(i=k.lastFinalizedLocalId)&&void 0!==i?i:0,Z=x.first,L=x.last;(0,l.h)(Z===N-1,1161);var z=N-L;(0,l.h)(z>=1,1162);var F,R,P,K,A=0,U=0,B=z;if(S){if(I){var E=null!==(s=this.sessionIdNormalizer.getLastFinalId())&&void 0!==s?s:y("Cluster exists but normalizer does not have an entry for it."),T=w+Math.min(O.count+z,O.capacity)-1;T>E&&this.sessionIdNormalizer.addFinalIds(E+1,T,O)}U=O.count;var V=O.capacity-U,D=B-V,q=D<=0;if(q||w===this.finalIdToCluster.maxKey()){if(O.count+=B,A=B,B=0,!q){var j=this.newClusterCapacity+D,H=O.capacity;if(O.capacity+=j,this.nextClusterBaseFinalId=this.nextClusterBaseFinalId+j,(0,l.h)(this.nextClusterBaseFinalId<Number.MAX_SAFE_INTEGER,1163),this.checkClusterForCollision(O),I){var X=w+O.count-1;(0,l.h)(void 0!==k.lastFinalizedLocalId,1164);var G=X-D+1;this.sessionIdNormalizer.registerFinalIdBlock(G,j,O),null===(a=this.logger)||void 0===a||a.sendTelemetryEvent({eventName:"RuntimeIdCompressor:ClusterExpansion",sessionId:this.localSessionId,previousCapacity:H,newCapacity:O.capacity,overflow:D})}}}else F=W(O.baseUuid,O.capacity),O.count+=V,B-=V,null===(o=this.logger)||void 0===o||o.sendTelemetryEvent({eventName:"RuntimeIdCompressor:OverfilledCluster",sessionId:this.localSessionId})}else F=k.sessionUuid,I&&(null===(u=this.logger)||void 0===u||u.sendTelemetryEvent({eventName:"RuntimeIdCompressor:FirstCluster",sessionId:this.localSessionId}));if(void 0!==F){B<=0&&y("Should not create an empty cluster."),void 0!==O&&O.capacity!==O.count&&y("Cluster must be filled before another is allocated."),P=this.nextClusterBaseFinalId;var J=Math.max(this.newClusterCapacity,B);R={baseUuid:F,capacity:J,count:B,session:k},K=Z-(z-B),I&&(null===(c=this.logger)||void 0===c||c.sendTelemetryEvent({eventName:"RuntimeIdCompressor:NewCluster",sessionId:this.localSessionId,clusterCapacity:J,clusterCount:B}),this.sessionIdNormalizer.registerFinalIdBlock(P,R.capacity,R)),this.checkClusterForCollision(R),this.clustersAndOverridesInversion.set(M(R.baseUuid),{clusterBase:P,cluster:R}),k.currentClusterDetails={cluster:R,clusterBase:P},this.nextClusterBaseFinalId=this.nextClusterBaseFinalId+R.capacity,(0,l.h)(this.nextClusterBaseFinalId<Number.MAX_SAFE_INTEGER,1166),this.finalIdToCluster.append(P,R)}var Y=x.overrides;if(void 0!==Y)for(var Q=0;Q<Y.length;Q++){var $=(0,n.Z)(Y[Q],2),ee=$[0],te=$[1];(0,l.h)(0===Q||ee<Y[Q-1][0],1167),(0,l.h)(ee<N,1168),(0,l.h)(ee>=L,1169);var re=void 0,ie=void 0;void 0!==K&&ee<=K?((0,l.h)(void 0!==R&&void 0!==P,1170),re=R,ie=P+(K-ee)):((0,l.h)(void 0!==O&&void 0!==w,1171),re=O,ie=w+U+(N-ee)-1),null!==(d=re.overrides)&&void 0!==d||(re.overrides=new Map);var ne=e.createInversionKey(te),se=this.getExistingIdsForNewOverride(ne,!0),ae=void 0,oe=void 0;if(void 0!==se){var le=void 0;if("number"===typeof se)ce(le=se)&&(oe=le);else{var de=(0,n.Z)(se,2);oe=de[0],le=de[1]}ue(le)?ae=le:((0,l.h)(!I||le===ee,1172),ae=te)}else ae=te;if((0,l.h)(!re.overrides.has(ie),1173),"string"===typeof ae)I||void 0===oe?re.overrides.set(ie,te):re.overrides.set(ie,{override:te,originalOverridingFinal:ie,associatedLocalId:oe});else{var he={override:te,originalOverridingFinal:ae};g(oe,he,"associatedLocalId"),re.overrides.set(ie,he)}var ve={cluster:re,originalOverridingFinal:ie};g(oe,ve,"associatedLocalId");var fe=this.clustersAndOverridesInversion.get(ne);(void 0===fe||e.isUnfinalizedOverride(fe))&&this.clustersAndOverridesInversion.set(ne,ve)}I&&(null===(h=this.logger)||void 0===h||h.sendTelemetryEvent({eventName:"RuntimeIdCompressor:IdCompressorStatus",eagerFinalIdCount:A-(null!==(v=null===Y||void 0===Y?void 0:Y.length)&&void 0!==v?v:0),localIdCount:B+(null!==(f=null===Y||void 0===Y?void 0:Y.length)&&void 0!==f?f:0),overridesCount:null!==(p=null===Y||void 0===Y?void 0:Y.length)&&void 0!==p?p:0,sessionId:this.localSessionId})),k.lastFinalizedLocalId=L}}},{key:"checkClusterForCollision",value:function(t){var r=W(t.baseUuid,t.capacity-1),i=M(r),s=this.clustersAndOverridesInversion.getPairOrNextLower(i);if(void 0!==s){var a=(0,n.Z)(s,2),o=a[0],l=a[1];if(!e.isClusterInfo(l))if(O(o)&&e.uuidsMightCollide(o,i,t.capacity))void 0!==U(r,V(o),t.capacity-1)&&e.failWithCollidingOverride(o)}}},{key:"getExistingIdsForNewOverride",value:function(t,r){var i,s,a,o=this.clustersAndOverridesInversion.getPairOrNextLower(t,pe);if(void 0!==o){var l=(0,n.Z)(o,2),u=l[0],c=l[1];if(e.isClusterInfo(c)){if(e.isStableInversionKey(t)){a=t;var d=c.cluster;if(e.uuidsMightCollide(t,u,d.capacity)){var h=U(s=V(a),d.baseUuid,d.capacity-1);if(void 0!==h&&!r){if(h>=d.count)return;return this.normalizeToSessionSpace(c.clusterBase+h)}}}}else if(u===t){if(e.isUnfinalizedOverride(c))return c;var v=c;return void 0!==v.associatedLocalId?[v.associatedLocalId,v.originalOverridingFinal]:v.originalOverridingFinal}}var f=null!==(i=null!==s&&void 0!==s?s:a)&&void 0!==i?i:e.isStableInversionKey(t)?t:void 0;if(void 0!==f){var p=this.getCompressedIdForStableId(f);if(void 0!==p)return p}}},{key:"generateCompressedId",value:function(t){var r;if(void 0!==t){r=e.createInversionKey(t);var i=this.getExistingIdsForNewOverride(r,!1);if(void 0!==i)return"number"===typeof i?i:i[0]}var n,s,a=-++this.localIdCount,o=this.localSession.currentClusterDetails,u=this.sessionIdNormalizer;if(void 0!==o){s=o.cluster;var c=u.getLastFinalId();void 0!==c&&c-o.clusterBase+1<s.capacity&&(n=c+1)}if(void 0!==r){var d=u.addLocalId();(0,l.h)(d===a,1174),void 0!==n&&u.addFinalIds(n,n,null!==s&&void 0!==s?s:y("No cluster when generating compressed ID")),this.localOverrides.append(a,null!==t&&void 0!==t?t:y("Override must be defined"));var h=a;this.clustersAndOverridesInversion.set(r,h)}else{if(void 0!==n)return u.addFinalIds(n,n,null!==s&&void 0!==s?s:y("No cluster when generating compressed ID")),n;var v=u.addLocalId();(0,l.h)(v===a,1175)}return a}},{key:"decompress",value:function(e){var t;return null!==(t=this.tryDecompress(e))&&void 0!==t?t:y("Compressed ID was not generated by this compressor")}},{key:"tryDecompress",value:function(t){var r;if(ue(t)){var i=this.getClusterForFinalId(t);if(void 0===i){var s=this.sessionIdNormalizer.getCreationIndex(t);return void 0!==s?M(this.localSession.sessionUuid,s):void 0}var a=(0,n.Z)(i,2),o=a[0],l=a[1],u=e.tryGetOverride(l,t);if(void 0!==u)return u;var c=t-o;return M(l.baseUuid,c)}var d=-t;if(!(d>this.localIdCount)){var h=null===(r=this.localOverrides)||void 0===r?void 0:r.get(t);return void 0!==h?h:M(this.localSession.sessionUuid,d-1)}}},{key:"recompress",value:function(e){var t;return null!==(t=this.tryRecompress(e))&&void 0!==t?t:y("No such string has ever been compressed")}},{key:"tryRecompress",value:function(e){return this.recompressInternal(e)}},{key:"recompressInternal",value:function(t,r){var i,s,a=r,o=e.createInversionKey(t),l=e.isStableInversionKey(o),u=this.clustersAndOverridesInversion.getPairOrNextLower(o,pe);if(void 0!==u){var c=(0,n.Z)(u,2),d=c[0],h=c[1];if(e.isClusterInfo(h)){if(!l)return;var v=h.clusterBase,f=h.cluster;null!==a&&void 0!==a||(a=V(o));var p=U(a,f.baseUuid,f.count-1);if(void 0!==p){var y=v+p,g=null===(s=f.overrides)||void 0===s?void 0:s.get(y);if("object"===typeof g){if(void 0!==g.associatedLocalId)return g.associatedLocalId;y=g.originalOverridingFinal}return this.normalizeToSessionSpace(y)}}else if(d===o)return e.isUnfinalizedOverride(h)?h:null!==(i=h.associatedLocalId)&&void 0!==i?i:h.originalOverridingFinal}if(l){var m=this.getCompressedIdForStableId(null!==a&&void 0!==a?a:o);if(void 0!==m)return m}}},{key:"normalizeToOpSpace",value:function(t){var r,i,s;if(ue(t))return t;-t>this.localIdCount&&y("Supplied local ID was not created by this compressor.");var a=this.localSession.lastFinalizedLocalId;if(void 0===a||t<a){var o=this.localOverrides.get(t);if(void 0!==o){var l=e.createInversionKey(o),u=null!==(r=this.clustersAndOverridesInversion.get(l))&&void 0!==r?r:y("Bimap is malformed.");return e.isClusterInfo(u)||e.isUnfinalizedOverride(u)||u.associatedLocalId!==t?t:u.originalOverridingFinal}var c=this.sessionIdNormalizer.getFinalId(t);return null!==(i=null===c||void 0===c?void 0:c[0])&&void 0!==i?i:t}var d=null!==(s=this.sessionIdNormalizer.getFinalId(t))&&void 0!==s?s:y("Locally created cluster should be added to the map when allocated"),h=(0,n.Z)(d,2),v=h[0],f=h[1];if(f.overrides){var p=f.overrides.get(v);if("object"===typeof p&&void 0!==p.originalOverridingFinal)return p.originalOverridingFinal}return v}},{key:"normalizeToSessionSpace",value:function(e,t){var r,i,s,a;if(ce(e)){if(void 0===t||t===this.localSessionId)return-e>this.localIdCount&&y("Supplied local ID was not created by this compressor."),e;var o=-e,l=W((null!==(r=this.sessions.get(t))&&void 0!==r?r:y("No IDs have ever been finalized by the supplied session.")).sessionUuid,o-1);return null!==(i=this.compressNumericUuid(l))&&void 0!==i?i:y("ID is not known to this compressor.")}var u=this.sessionIdNormalizer.getSessionSpaceId(e);if(void 0!==u)return u;var c=null!==(s=this.getClusterForFinalId(e))&&void 0!==s?s:y("Supplied final ID was not finalized by this compressor."),d=(0,n.Z)(c,2),h=(d[0],null===(a=d[1].overrides)||void 0===a?void 0:a.get(e));return"object"===typeof h&&void 0!==h.associatedLocalId?h.associatedLocalId:e}},{key:"compressNumericUuid",value:function(e){var t=M(e),r=this.recompressInternal(t,e);if(void 0!==r)return r}},{key:"getCompressedIdForStableId",value:function(e){var t=U("string"===typeof e?V(e):e,this.localSession.sessionUuid,this.localIdCount-1);if(void 0!==t){var r=this.sessionIdNormalizer.getIdByCreationIndex(t);if(void 0!==r)return r}}},{key:"getClusterForFinalId",value:function(e){var t=this.finalIdToCluster.getPairOrNextLower(e);if(void 0!==t){var r=(0,n.Z)(t,2);if(!(e-r[0]>=r[1].count))return t}}},{key:"equals",value:function(t,r){if(r){if(this.localIdCount!==t.localIdCount||this.localSessionId!==t.localSessionId||this.lastTakenLocalId!==t.lastTakenLocalId)return!1;if(!this.localOverrides.equals(t.localOverrides,(function(e,t){return e===t})))return!1;if(!v(this.sessions,t.sessions,(function(t,i){return e.sessionDataEqual(t,i,!0,r)})))return!1;if(!this.sessionIdNormalizer.equals(t.sessionIdNormalizer,(function(t,i){return e.idClustersEqual(t,i,!1,r)})))return!1}else{var s,a=(0,i.Z)(this.sessions);try{for(a.s();!(s=a.n()).done;){var o=(0,n.Z)(s.value,2),l=o[0],u=o[1],c=t.sessions.get(l);if(void 0===c){if(void 0!==u.lastFinalizedLocalId)return!1}else if(!e.sessionDataEqual(u,c,!0,r))return!1}}catch(m){a.e(m)}finally{a.f()}var d,h=(0,i.Z)(t.sessions);try{for(h.s();!(d=h.n()).done;){var f=(0,n.Z)(d.value,2),p=f[0],y=f[1];if(void 0===this.sessions.get(p)&&void 0!==y.lastFinalizedLocalId)return!1}}catch(m){h.e(m)}finally{h.f()}}if(this.nextClusterBaseFinalId!==t.nextClusterBaseFinalId||this.newClusterCapacity!==t.newClusterCapacity)return!1;if(!this.finalIdToCluster.equals(t.finalIdToCluster,(function(t,i){return e.idClustersEqual(t,i,!0,r)})))return!1;var g=function(t,i){if(r||!e.isUnfinalizedOverride(i))return{break:!0}};return void 0===this.clustersAndOverridesInversion.diffAgainst(t.clustersAndOverridesInversion,g,g,(function(t,i,n){if(!function(t,i){var n=e.isUnfinalizedOverride(t),s=e.isUnfinalizedOverride(i);if(n)return!!s&&t===i;if(s)return!1;if(e.isClusterInfo(t)){if(!e.isClusterInfo(i)||t.clusterBase!==i.clusterBase)return!1}else if(e.isClusterInfo(i)||r&&t.associatedLocalId!==i.associatedLocalId||t.originalOverridingFinal!==i.originalOverridingFinal)return!1;return!!e.idClustersEqual(t.cluster,i.cluster,!0,r)}(i,n))return{break:!0}}))}},{key:"serialize",value:function(e){var t,r,a,o=this,u=[],c=new Map,d=(0,i.Z)(this.sessions);try{for(d.s();!(a=d.n()).done;){var h=(0,n.Z)(a.value,2),v=h[0],f=h[1],p=v===this.localSessionId;if(v!==le&&(void 0!==f.lastFinalizedLocalId||p&&e)){var g=[v];c.set(v,u.length),u.push(g)}}}catch(K){d.e(K)}finally{d.f()}var m,I=[],k=(0,i.Z)(this.finalIdToCluster.entries());try{for(k.s();!(m=k.n()).done;){var x=(0,n.Z)(m.value,2),b=x[0],C=x[1],O=M(C.session.sessionUuid);if(O!==le){var w=[null!==(t=c.get(O))&&void 0!==t?t:y("Session object contains wrong session numeric UUID"),C.capacity];if(C.count!==C.capacity&&w.push(C.count),void 0!==C.overrides){var S,N=[],Z=(0,i.Z)(C.overrides);try{for(Z.s();!(S=Z.n()).done;){var L=(0,n.Z)(S.value,2),z=L[0],F=L[1],_=z-b;"string"===typeof F?N.push([_,F]):F.originalOverridingFinal===z?N.push([_,F.override]):N.push([_,F.override,F.originalOverridingFinal])}}catch(K){Z.e(K)}finally{Z.f()}w.push(N)}I.push(w)}}}catch(K){k.e(K)}finally{k.f()}(0,l.h)(u.length-this.sessions.size<=2,1176);var R={version:he,clusterCapacity:this.clusterCapacity,sessions:u,clusters:I};if(e){var P=R;return P.localSessionIndex=P.sessions.findIndex((function(e){return(0,n.Z)(e,1)[0]===o.localSessionId})),this.localIdCount>0&&(P.localState={localIdCount:this.localIdCount,overrides:(0,s.Z)(this.localOverrides.entries()).map((function(e){return(0,s.Z)(e)})),lastTakenLocalId:this.lastTakenLocalId,sessionNormalizer:this.sessionIdNormalizer.serialize()}),P}return null===(r=this.logger)||void 0===r||r.sendTelemetryEvent({eventName:"RuntimeIdCompressor:SerializedIdCompressorSize",size:JSON.stringify(R).length,clusterCount:R.clusters.length,sessionCount:R.sessions.length}),R}}],[{key:"failWithCollidingOverride",value:function(e){y("Override '".concat(e,"' collides with another allocated UUID."))}},{key:"isClusterInfo",value:function(e){return void 0!==e.clusterBase}},{key:"isUnfinalizedOverride",value:function(e){return"number"===typeof e}},{key:"createInversionKey",value:function(e){return O(e)?e:"".concat("\ue15e").concat(e)}},{key:"isStableInversionKey",value:function(e){return"\ue15e"!==e.charAt(0)}},{key:"uuidsMightCollide",value:function(e,t,r){var i=32-Math.ceil(Math.log2(r)/2);return!!e.startsWith(t.slice(0,i))}},{key:"tryGetOverride",value:function(e,t){var r,i=null===(r=e.overrides)||void 0===r?void 0:r.get(t);if(void 0!==i)return"string"===typeof i?i:i.override}},{key:"sessionDataEqual",value:function(t,r){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return!(!q(t.sessionUuid,r.sessionUuid)||t.lastFinalizedLocalId!==r.lastFinalizedLocalId)&&(void 0===t.currentClusterDetails||void 0===r.currentClusterDetails?t.currentClusterDetails===r.currentClusterDetails:!(i&&!e.idClustersEqual(t.currentClusterDetails.cluster,r.currentClusterDetails.cluster,!1,n)))}},{key:"idClustersEqual",value:function(t,r){var i,n,s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return q(t.baseUuid,r.baseUuid)&&t.capacity===r.capacity&&t.count===r.count&&(!s||e.sessionDataEqual(t.session,r.session,!1,a))&&void 0===t.overrides===(void 0===r.overrides)&&(void 0===t.overrides||v(null!==(i=t.overrides)&&void 0!==i?i:y("Overrides must be defined"),null!==(n=r.overrides)&&void 0!==n?n:y("Overrides must be defined"),(function(e,t){if(a)return"string"===typeof e||"string"===typeof t?e===t:e.override===t.override&&e.originalOverridingFinal===t.originalOverridingFinal&&(!a||e.associatedLocalId===t.associatedLocalId);var r="string"===typeof e?e:e.override,i="string"===typeof t?t:t.override;return("string"===typeof e||"string"===typeof t||e.originalOverridingFinal===t.originalOverridingFinal)&&r===i})))}},{key:"deserialize",value:function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];var a,o,u=r[0],c=r[1],d=u.clusterCapacity,h=u.sessions,v=u.clusters;if(void 0===c){var f=r[0];a=h[f.localSessionIndex][0],o=f.localState}else a=c;var p=new e(a);p.clusterCapacity=d;var m=new Map;if(void 0!==o&&(p.localIdCount=o.localIdCount,p.lastTakenLocalId=o.lastTakenLocalId,void 0!==o.overrides)){var I,k=(0,i.Z)(o.overrides);try{for(k.s();!(I=k.n()).done;){var x=(0,n.Z)(I.value,2),b=x[0],C=x[1];p.localOverrides.append(b,C),m.set(C,b),p.clustersAndOverridesInversion.set(e.createInversionKey(C),b)}}catch(ie){k.e(ie)}finally{k.f()}}var O,w=[],S=(0,i.Z)(h);try{for(S.s();!(O=S.n()).done;){var N=O.value,Z=(0,n.Z)(N,1)[0];if(Z===a)(0,l.h)(ve(u),1177),w.push({session:p.localSession,sessionId:Z});else{var L=p.createSession(Z);w.push({session:L,sessionId:Z})}}}catch(ie){S.e(ie)}finally{S.f()}var z,F=(0,i.Z)(v);try{for(F.s();!(z=F.n()).done;){var _=fe(z.value),R=_.sessionIndex,P=_.capacity,K=_.count,A=_.overrides,U=w[R],B=U.session,E=U.sessionId,T=B.lastFinalizedLocalId,V={capacity:P,count:K,baseUuid:W(B.sessionUuid,void 0===T?0:-T),session:B},D=null!==T&&void 0!==T?T:0,q=p.nextClusterBaseFinalId;if(B.lastFinalizedLocalId=D-K,B.currentClusterDetails={clusterBase:q,cluster:V},p.nextClusterBaseFinalId=p.nextClusterBaseFinalId+P,p.finalIdToCluster.append(q,V),p.clustersAndOverridesInversion.set(M(V.baseUuid),{clusterBase:q,cluster:V}),void 0!==A){V.overrides=new Map;var j,H=(0,i.Z)(A);try{for(H.s();!(j=H.n()).done;){var X=(0,n.Z)(j.value,3),G=X[0],J=X[1],Y=X[2],Q=q+G;if(void 0!==Y){var $={override:J,originalOverridingFinal:Y};void 0!==o&&g(m.get(J),$,"associatedLocalId"),V.overrides.set(Q,$)}else{var te=m.get(J);void 0!==te&&E!==a?V.overrides.set(Q,{override:J,originalOverridingFinal:Q,associatedLocalId:te}):V.overrides.set(Q,J);var re={cluster:V,originalOverridingFinal:Q};void 0!==o&&g(te,re,"associatedLocalId"),p.clustersAndOverridesInversion.set(e.createInversionKey(J),re)}}}catch(ie){H.e(ie)}finally{H.f()}}}}catch(ie){F.e(ie)}finally{F.f()}return void 0!==o&&(p.sessionIdNormalizer=ee.deserialize(o.sessionNormalizer,(function(e){var t,r=null!==(t=p.finalIdToCluster.getPairOrNextLower(e))&&void 0!==t?t:y("Final in serialized normalizer was never created."),i=(0,n.Z)(r,2);i[0];return i[1]}))),(0,l.h)(void 0===p.localSession.lastFinalizedLocalId||p.localIdCount>=-p.localSession.lastFinalizedLocalId,1178),p}},{key:"convertToCurrentVersion",value:function(e,t){e.version!==he&&y("Unknown SerializedIdCompressor version number");var r=e;if(t===ve(r))return r}}]),e}();de.maxClusterSize=Math.pow(2,20);var he="0.0.1";function ve(e){return void 0!==e.localSessionIndex}function fe(e){var t=(0,n.Z)(e,4),r=t[0],i=t[1],s=t[2],a=t[3],o="number"===typeof s;return{sessionIndex:r,capacity:i,count:o?s:i,overrides:o?a:s}}var pe=[]},48563:function(e,t){var r=this&&this.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();function i(e,t){if(Number.isFinite(e)&&Number.isFinite(t))return e-t;var r=typeof e,i=typeof t;if(r!==i)return r<i?-1:1;if("object"===r){if(null===e)return null===t?0:-1;if(null===t)return 1;if((r=typeof(e=e.valueOf()))!==(i=typeof(t=t.valueOf())))return r<i?-1:1}return e<t?-1:e>t?1:e===t?0:Number.isNaN(e)?Number.isNaN(t)?0:-1:Number.isNaN(t)?1:Array.isArray(e)?0:Number.NaN}Object.defineProperty(t,"__esModule",{value:!0}),t.EmptyBTree=t.asSet=t.simpleComparator=t.defaultComparator=void 0,t.defaultComparator=i,t.simpleComparator=function(e,t){return e>t?1:e<t?-1:0};var n=function(){function e(e,t,r){this._root=h,this._size=0,this._maxNodeSize=r>=4?Math.min(r,256):32,this._compare=t||i,e&&this.setPairs(e)}return Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isEmpty",{get:function(){return 0===this._size},enumerable:!1,configurable:!0}),e.prototype.clear=function(){this._root=h,this._size=0},e.prototype.forEach=function(e,t){var r=this;return void 0!==t&&(e=e.bind(t)),this.forEachPair((function(t,i){return e(i,t,r)}))},e.prototype.forEachPair=function(e,t){var r=this.minKey(),i=this.maxKey();return this.forRange(r,i,!0,e,t)},e.prototype.get=function(e,t){return this._root.get(e,t,this)},e.prototype.set=function(e,t,r){this._root.isShared&&(this._root=this._root.clone());var i=this._root.set(e,t,r,this);return!0===i||!1===i?i:(this._root=new o([this._root,i]),!0)},e.prototype.has=function(e){return 0!==this.forRange(e,e,!0,void 0)},e.prototype.delete=function(e){return 0!==this.editRange(e,e,!0,c)},e.prototype.with=function(e,t,r){var i=this.clone();return i.set(e,t,r)||r?i:this},e.prototype.withPairs=function(e,t){var r=this.clone();return 0!==r.setPairs(e,t)||t?r:this},e.prototype.withKeys=function(e,t){for(var r=this.clone(),i=!1,n=0;n<e.length;n++)i=r.set(e[n],void 0,!1)||i;return t&&!i?this:r},e.prototype.without=function(e,t){return this.withoutRange(e,e,!0,t)},e.prototype.withoutKeys=function(e,t){var r=this.clone();return r.deleteKeys(e)||!t?r:this},e.prototype.withoutRange=function(e,t,r,i){var n=this.clone();return 0===n.deleteRange(e,t,r)&&i?this:n},e.prototype.filter=function(e,t){var r,i=this.greedyClone();return i.editAll((function(t,i,n){if(!e(t,i,n))return r=u})),!r&&t?this:i},e.prototype.mapValues=function(e){var t={},r=this.greedyClone();return r.editAll((function(r,i,n){return t.value=e(i,r,n),t})),r},e.prototype.reduce=function(e,t){for(var r,i=0,n=t,s=this.entries(this.minKey(),f);!(r=s.next()).done;)n=e(n,r.value,i++,this);return n},e.prototype.entries=function(e,t){var r=this.findPath(e);if(void 0===r)return s();var i=r.nodequeue,n=r.nodeindex,a=r.leaf,o=void 0!==t?1:0,l=void 0===e?-1:a.indexOf(e,0,this._compare)-1;return s((function(){e:for(;;)switch(o){case 0:if(++l<a.keys.length)return{done:!1,value:[a.keys[l],a.values[l]]};o=2;continue;case 1:if(++l<a.keys.length)return t[0]=a.keys[l],t[1]=a.values[l],{done:!1,value:t};o=2;case 2:for(var e=-1;;){if(++e>=i.length){o=3;continue e}if(++n[e]<i[e].length)break}for(;e>0;e--)i[e-1]=i[e][n[e]].children,n[e-1]=0;a=i[0][n[0]],l=-1,o=void 0!==t?1:0;continue;case 3:return{done:!0,value:void 0}}}))},e.prototype.entriesReversed=function(e,t,r){if(void 0===e&&(r=void 0,void 0===(e=this.maxKey())))return s();var i=this.findPath(e)||this.findPath(this.maxKey()),n=i.nodequeue,a=i.nodeindex,o=i.leaf;p(!n[0]||o===n[0][a[0]],"wat!");var l=o.indexOf(e,0,this._compare);!r&&l<o.keys.length&&this._compare(o.keys[l],e)<=0&&l++;var u=void 0!==t?1:0;return s((function(){e:for(;;)switch(u){case 0:if(--l>=0)return{done:!1,value:[o.keys[l],o.values[l]]};u=2;continue;case 1:if(--l>=0)return t[0]=o.keys[l],t[1]=o.values[l],{done:!1,value:t};u=2;case 2:for(var e=-1;;){if(++e>=n.length){u=3;continue e}if(--a[e]>=0)break}for(;e>0;e--)n[e-1]=n[e][a[e]].children,a[e-1]=n[e-1].length-1;o=n[0][a[0]],l=o.keys.length,u=void 0!==t?1:0;continue;case 3:return{done:!0,value:void 0}}}))},e.prototype.findPath=function(e){var t,r,i=this._root;if(i.isLeaf)t=v,r=v;else{t=[],r=[];for(var n=0;!i.isLeaf;n++){if(t[n]=i.children,r[n]=void 0===e?0:i.indexOf(e,0,this._compare),r[n]>=t[n].length)return;i=t[n][r[n]]}t.reverse(),r.reverse()}return{nodequeue:t,nodeindex:r,leaf:i}},e.prototype.diffAgainst=function(t,r,i,n){if(t._compare!==this._compare)throw new Error("Tree comparators are not the same.");if(this.isEmpty||t.isEmpty){if(this.isEmpty&&t.isEmpty)return;return this.isEmpty?void 0===i?void 0:e.stepToEnd(e.makeDiffCursor(t),i):void 0===r?void 0:e.stepToEnd(e.makeDiffCursor(this),r)}for(var s=this._compare,a=e.makeDiffCursor(this),o=e.makeDiffCursor(t),l=!0,u=!0,c=e.compare(a,o,s);l&&u;){var d=e.compare(a,o,s),h=a.leaf,v=a.internalSpine,f=a.levelIndices,p=o.leaf,y=o.internalSpine,g=o.levelIndices;if(h||p){if(0!==c)if(0===d){if(h&&p&&n){var m=h.values[f[f.length-1]],I=p.values[g[g.length-1]];if(!Object.is(m,I))if((x=n(a.currentKey,m,I))&&x.break)return x.break}}else if(d>0){if(p&&i){var k=p.values[g[g.length-1]];if((x=i(o.currentKey,k))&&x.break)return x.break}}else if(r&&h&&0!==c){var x;m=h.values[f[f.length-1]];if((x=r(a.currentKey,m))&&x.break)return x.break}}else if(!h&&!p&&0===d){var b=v.length-1,C=y.length-1,O=v[b][f[b]];if(y[C][g[C]]===O){c=0,l=e.step(a,!0),u=e.step(o,!0);continue}}c=d,d<0?l=e.step(a):u=e.step(o)}return l&&r?e.finishCursorWalk(a,o,s,r):u&&i?e.finishCursorWalk(o,a,s,i):void 0},e.finishCursorWalk=function(t,r,i,n){var s=e.compare(t,r,i);if(0===s){if(!e.step(t))return}else s<0&&p(!1,"cursor walk terminated early");return e.stepToEnd(t,n)},e.stepToEnd=function(t,r){for(var i=!0;i;){var n=t.leaf,s=t.levelIndices,a=t.currentKey;if(n){var o=r(a,n.values[s[s.length-1]]);if(o&&o.break)return o.break}i=e.step(t)}},e.makeDiffCursor=function(e){var t=e._root;return{height:e.height,internalSpine:[[t]],levelIndices:[0],leaf:void 0,currentKey:t.maxKey()}},e.step=function(e,t){var r=e.internalSpine,i=e.levelIndices,n=e.leaf;if(!0===t||n){var s=i.length;if(!0===t||0===i[s-1]){var a=r.length;if(0===a)return!1;for(var o=a-1,l=o;l>=0;){if(i[l]>0)return l<s-1&&(e.leaf=void 0,i.pop()),l<o&&(e.internalSpine=r.slice(0,l+1)),e.currentKey=r[l][--i[l]].maxKey(),!0;l--}return!1}var u=--i[s-1];return e.currentKey=n.keys[u],!0}var c=r.length,d=c-1,h=r[d][i[d]];if(h.isLeaf){e.leaf=h;u=i[c]=h.values.length-1;e.currentKey=h.keys[u]}else{var v=h.children;r[c]=v;var f=v.length-1;i[c]=f,e.currentKey=v[f].maxKey()}return!0},e.compare=function(e,t,r){var i=e.height,n=e.currentKey,s=e.levelIndices,a=t.height,o=t.currentKey,l=t.levelIndices,u=r(o,n);if(0!==u)return u;var c=i<a?i:a;return s.length-(i-c)-(l.length-(a-c))},e.prototype.keys=function(e){var t=this.entries(e,f);return s((function(){var e=t.next();return e.value&&(e.value=e.value[0]),e}))},e.prototype.values=function(e){var t=this.entries(e,f);return s((function(){var e=t.next();return e.value&&(e.value=e.value[1]),e}))},Object.defineProperty(e.prototype,"maxNodeSize",{get:function(){return this._maxNodeSize},enumerable:!1,configurable:!0}),e.prototype.minKey=function(){return this._root.minKey()},e.prototype.maxKey=function(){return this._root.maxKey()},e.prototype.clone=function(){this._root.isShared=!0;var t=new e(void 0,this._compare,this._maxNodeSize);return t._root=this._root,t._size=this._size,t},e.prototype.greedyClone=function(t){var r=new e(void 0,this._compare,this._maxNodeSize);return r._root=this._root.greedyClone(t),r._size=this._size,r},e.prototype.toArray=function(e){void 0===e&&(e=2147483647);var t=this.minKey(),r=this.maxKey();return void 0!==t?this.getRange(t,r,!0,e):[]},e.prototype.keysArray=function(){var e=[];return this._root.forRange(this.minKey(),this.maxKey(),!0,!1,this,0,(function(t,r){e.push(t)})),e},e.prototype.valuesArray=function(){var e=[];return this._root.forRange(this.minKey(),this.maxKey(),!0,!1,this,0,(function(t,r){e.push(r)})),e},e.prototype.toString=function(){return this.toArray().toString()},e.prototype.setIfNotPresent=function(e,t){return this.set(e,t,!1)},e.prototype.nextHigherPair=function(e,t){return t=t||[],void 0===e?this._root.minPair(t):this._root.getPairOrNextHigher(e,this._compare,!1,t)},e.prototype.nextHigherKey=function(e){var t=this.nextHigherPair(e,f);return t&&t[0]},e.prototype.nextLowerPair=function(e,t){return t=t||[],void 0===e?this._root.maxPair(t):this._root.getPairOrNextLower(e,this._compare,!1,t)},e.prototype.nextLowerKey=function(e){var t=this.nextLowerPair(e,f);return t&&t[0]},e.prototype.getPairOrNextLower=function(e,t){return this._root.getPairOrNextLower(e,this._compare,!0,t||[])},e.prototype.getPairOrNextHigher=function(e,t){return this._root.getPairOrNextHigher(e,this._compare,!0,t||[])},e.prototype.changeIfPresent=function(e,t){return 0!==this.editRange(e,e,!0,(function(e,r){return{value:t}}))},e.prototype.getRange=function(e,t,r,i){void 0===i&&(i=67108863);var n=[];return this._root.forRange(e,t,r,!1,this,0,(function(e,t){return n.push([e,t]),n.length>i?d:void 0})),n},e.prototype.setPairs=function(e,t){for(var r=0,i=0;i<e.length;i++)this.set(e[i][0],e[i][1],t)&&r++;return r},e.prototype.forRange=function(e,t,r,i,n){var s=this._root.forRange(e,t,r,!1,this,n||0,i);return"number"===typeof s?s:s.break},e.prototype.editRange=function(e,t,r,i,n){var s=this._root;s.isShared&&(this._root=s=s.clone());try{var a=s.forRange(e,t,r,!0,this,n||0,i);return"number"===typeof a?a:a.break}finally{for(var o=void 0;s.keys.length<=1&&!s.isLeaf;)o||(o=s.isShared),this._root=s=0===s.keys.length?h:s.children[0];o&&(s.isShared=!0)}},e.prototype.editAll=function(e,t){return this.editRange(this.minKey(),this.maxKey(),!0,e,t)},e.prototype.deleteRange=function(e,t,r){return this.editRange(e,t,r,c)},e.prototype.deleteKeys=function(e){for(var t=0,r=0;t<e.length;t++)this.delete(e[t])&&r++;return r},Object.defineProperty(e.prototype,"height",{get:function(){for(var e=this._root,t=-1;e;)t++,e=e.isLeaf?void 0:e.children[0];return t},enumerable:!1,configurable:!0}),e.prototype.freeze=function(){var e=this;e.clear=e.set=e.editRange=function(){throw new Error("Attempted to modify a frozen BTree")}},e.prototype.unfreeze=function(){delete this.clear,delete this.set,delete this.editRange},Object.defineProperty(e.prototype,"isFrozen",{get:function(){return this.hasOwnProperty("editRange")},enumerable:!1,configurable:!0}),e.prototype.checkValid=function(){var e=this._root.checkValid(0,this,0);p(e===this.size,"size mismatch: counted ",e,"but stored",this.size)},e}();function s(e){void 0===e&&(e=function(){return{done:!0,value:void 0}});var t={next:e};return Symbol&&Symbol.iterator&&(t[Symbol.iterator]=function(){return this}),t}t.default=n,t.asSet=function(e){return e},Symbol&&Symbol.iterator&&(n.prototype[Symbol.iterator]=n.prototype.entries),n.prototype.where=n.prototype.filter,n.prototype.setRange=n.prototype.setPairs,n.prototype.add=n.prototype.set;var a=function(){function e(e,t){void 0===e&&(e=[]),this.keys=e,this.values=t||l,this.isShared=void 0}return Object.defineProperty(e.prototype,"isLeaf",{get:function(){return void 0===this.children},enumerable:!1,configurable:!0}),e.prototype.maxKey=function(){return this.keys[this.keys.length-1]},e.prototype.indexOf=function(e,t,r){for(var i=this.keys,n=0,s=i.length,a=s>>1;n<s;){var o=r(i[a],e);if(o<0)n=a+1;else{if(!(o>0)){if(0===o)return a;if(e===e)return i.length;throw new Error("BTree: NaN was used as a key")}s=a}a=n+s>>1}return a^t},e.prototype.minKey=function(){return this.keys[0]},e.prototype.minPair=function(e){if(0!==this.keys.length)return e[0]=this.keys[0],e[1]=this.values[0],e},e.prototype.maxPair=function(e){if(0!==this.keys.length){var t=this.keys.length-1;return e[0]=this.keys[t],e[1]=this.values[t],e}},e.prototype.clone=function(){var t=this.values;return new e(this.keys.slice(0),t===l?t:t.slice(0))},e.prototype.greedyClone=function(e){return this.isShared&&!e?this:this.clone()},e.prototype.get=function(e,t,r){var i=this.indexOf(e,-1,r._compare);return i<0?t:this.values[i]},e.prototype.getPairOrNextLower=function(e,t,r,i){var n=this.indexOf(e,-1,t),s=n<0?~n-1:r?n:n-1;if(s>=0)return i[0]=this.keys[s],i[1]=this.values[s],i},e.prototype.getPairOrNextHigher=function(e,t,r,i){var n=this.indexOf(e,-1,t),s=n<0?~n:r?n:n+1,a=this.keys;if(s<a.length)return i[0]=a[s],i[1]=this.values[s],i},e.prototype.checkValid=function(e,t,r){var i=this.keys.length,n=this.values.length;return p(this.values===l?i<=n:i===n,"keys/values length mismatch: depth",e,"with lengths",i,n,"and baseIndex",r),p(0==e||i>0,"empty leaf at depth",e,"and baseIndex",r),i},e.prototype.set=function(e,t,r,i){var n=this.indexOf(e,-1,i._compare);if(n<0){if(n=~n,i._size++,this.keys.length<i._maxNodeSize)return this.insertInLeaf(n,e,t,i);var s=this.splitOffRightSide(),a=this;return n>this.keys.length&&(n-=this.keys.length,a=s),a.insertInLeaf(n,e,t,i),s}return!1!==r&&(void 0!==t&&this.reifyValues(),this.keys[n]=e,this.values[n]=t),!1},e.prototype.reifyValues=function(){return this.values===l?this.values=this.values.slice(0,this.keys.length):this.values},e.prototype.insertInLeaf=function(e,t,r,i){if(this.keys.splice(e,0,t),this.values===l){for(;l.length<i._maxNodeSize;)l.push(void 0);if(void 0===r)return!0;this.values=l.slice(0,this.keys.length-1)}return this.values.splice(e,0,r),!0},e.prototype.takeFromRight=function(e){var t=this.values;e.values===l?t!==l&&t.push(void 0):(t=this.reifyValues()).push(e.values.shift()),this.keys.push(e.keys.shift())},e.prototype.takeFromLeft=function(e){var t=this.values;e.values===l?t!==l&&t.unshift(void 0):(t=this.reifyValues()).unshift(e.values.pop()),this.keys.unshift(e.keys.pop())},e.prototype.splitOffRightSide=function(){var t=this.keys.length>>1;return new e(this.keys.splice(t),this.values===l?l:this.values.splice(t))},e.prototype.forRange=function(e,t,r,i,n,s,a){var o,u,c=n._compare;if(t===e){if(!r)return s;if(u=(o=this.indexOf(e,-1,c))+1,o<0)return s}else o=this.indexOf(e,0,c),(u=this.indexOf(t,-1,c))<0?u=~u:!0===r&&u++;var d=this.keys,h=this.values;if(void 0!==a)for(var v=o;v<u;v++){var f=d[v],p=a(f,h[v],s++);if(void 0!==p){if(!0===i){if(f!==d[v]||!0===this.isShared)throw new Error("BTree illegally changed or cloned in editRange");p.delete?(this.keys.splice(v,1),this.values!==l&&this.values.splice(v,1),n._size--,v--,u--):p.hasOwnProperty("value")&&(h[v]=p.value)}if(void 0!==p.break)return p}}else s+=u-o;return s},e.prototype.mergeSibling=function(e,t){if(this.keys.push.apply(this.keys,e.keys),this.values===l){if(e.values===l)return;this.values=this.values.slice(0,this.keys.length)}this.values.push.apply(this.values,e.reifyValues())},e}(),o=function(e){function t(t,r){var i=this;if(!r){r=[];for(var n=0;n<t.length;n++)r[n]=t[n].maxKey()}return(i=e.call(this,r)||this).children=t,i}return r(t,e),t.prototype.clone=function(){for(var e=this.children.slice(0),r=0;r<e.length;r++)e[r].isShared=!0;return new t(e,this.keys.slice(0))},t.prototype.greedyClone=function(e){if(this.isShared&&!e)return this;for(var r=new t(this.children.slice(0),this.keys.slice(0)),i=0;i<r.children.length;i++)r.children[i]=r.children[i].greedyClone(e);return r},t.prototype.minKey=function(){return this.children[0].minKey()},t.prototype.minPair=function(e){return this.children[0].minPair(e)},t.prototype.maxPair=function(e){return this.children[this.children.length-1].maxPair(e)},t.prototype.get=function(e,t,r){var i=this.indexOf(e,0,r._compare),n=this.children;return i<n.length?n[i].get(e,t,r):void 0},t.prototype.getPairOrNextLower=function(e,t,r,i){var n=this.indexOf(e,0,t),s=this.children;if(n>=s.length)return this.maxPair(i);var a=s[n].getPairOrNextLower(e,t,r,i);return void 0===a&&n>0?s[n-1].maxPair(i):a},t.prototype.getPairOrNextHigher=function(e,t,r,i){var n=this.indexOf(e,0,t),s=this.children,a=s.length;if(!(n>=a)){var o=s[n].getPairOrNextHigher(e,t,r,i);return void 0===o&&n<a-1?s[n+1].minPair(i):o}},t.prototype.checkValid=function(e,t,r){var i=this.keys.length,n=this.children.length;p(i===n,"keys/children length mismatch: depth",e,"lengths",i,n,"baseIndex",r),p(i>1||e>0,"internal node has length",i,"at depth",e,"baseIndex",r);for(var s=0,a=this.children,o=this.keys,l=0,u=0;u<n;u++)p((s+=a[u].checkValid(e+1,t,r+s))>=(l+=a[u].keys.length),"wtf",r),p(0===u||a[u-1].constructor===a[u].constructor,"type mismatch, baseIndex:",r),a[u].maxKey()!=o[u]&&p(!1,"keys[",u,"] =",o[u],"is wrong, should be ",a[u].maxKey(),"at depth",e,"baseIndex",r),0===u||t._compare(o[u-1],o[u])<0||p(!1,"sort violation at depth",e,"index",u,"keys",o[u-1],o[u]);var c=0===l;return(c||l>t.maxNodeSize*n)&&p(!1,c?"too few":"too many","children (",l,s,") at depth",e,"maxNodeSize:",t.maxNodeSize,"children.length:",n,"baseIndex:",r),s},t.prototype.set=function(e,t,r,i){var n,s=this.children,a=i._maxNodeSize,o=i._compare,l=Math.min(this.indexOf(e,0,o),s.length-1),u=s[l];(u.isShared&&(s[l]=u=u.clone()),u.keys.length>=a)&&(l>0&&(n=s[l-1]).keys.length<a&&o(u.keys[0],e)<0?(n.isShared&&(s[l-1]=n=n.clone()),n.takeFromRight(u),this.keys[l-1]=n.maxKey()):void 0!==(n=s[l+1])&&n.keys.length<a&&o(u.maxKey(),e)<0&&(n.isShared&&(s[l+1]=n=n.clone()),n.takeFromLeft(u),this.keys[l]=s[l].maxKey()));var c=u.set(e,t,r,i);if(!1===c)return!1;if(this.keys[l]=u.maxKey(),!0===c)return!0;if(this.keys.length<a)return this.insert(l+1,c),!0;var d=this.splitOffRightSide(),h=this;return o(c.maxKey(),this.maxKey())>0&&(h=d,l-=this.keys.length),h.insert(l+1,c),d},t.prototype.insert=function(e,t){this.children.splice(e,0,t),this.keys.splice(e,0,t.maxKey())},t.prototype.splitOffRightSide=function(){var e=this.children.length>>1;return new t(this.children.splice(e),this.keys.splice(e))},t.prototype.takeFromRight=function(e){this.keys.push(e.keys.shift()),this.children.push(e.children.shift())},t.prototype.takeFromLeft=function(e){this.keys.unshift(e.keys.pop()),this.children.unshift(e.children.pop())},t.prototype.forRange=function(e,t,r,i,n,s,a){var o=n._compare,l=this.keys,u=this.children,c=this.indexOf(e,0,o),d=c,h=Math.min(t===e?c:this.indexOf(t,0,o),l.length-1);if(i){if(d<=h)try{for(;d<=h;d++){u[d].isShared&&(u[d]=u[d].clone());f=u[d].forRange(e,t,r,i,n,s,a);if(l[d]=u[d].maxKey(),"number"!==typeof f)return f;s=f}}finally{var v=n._maxNodeSize>>1;for(c>0&&c--,d=h;d>=c;d--)u[d].keys.length<=v&&(0!==u[d].keys.length?this.tryMerge(d,n._maxNodeSize):(l.splice(d,1),u.splice(d,1)));0!==u.length&&0===u[0].keys.length&&p(!1,"emptiness bug")}}else for(;d<=h;d++){var f;if("number"!==typeof(f=u[d].forRange(e,t,r,i,n,s,a)))return f;s=f}return s},t.prototype.tryMerge=function(e,t){var r=this.children;return e>=0&&e+1<r.length&&r[e].keys.length+r[e+1].keys.length<=t&&(r[e].isShared&&(r[e]=r[e].clone()),r[e].mergeSibling(r[e+1],t),r.splice(e+1,1),this.keys.splice(e+1,1),this.keys[e]=r[e].maxKey(),!0)},t.prototype.mergeSibling=function(e,t){var r=this.keys.length;this.keys.push.apply(this.keys,e.keys);var i=e.children;if(this.children.push.apply(this.children,i),e.isShared&&!this.isShared)for(var n=0;n<i.length;n++)i[n].isShared=!0;this.tryMerge(r-1,t)},t}(a),l=[],u={delete:!0},c=function(){return u},d={break:!0},h=function(){var e=new a;return e.isShared=!0,e}(),v=[],f=[];function p(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(!e)throw t.unshift("B+ tree"),new Error(t.join(" "))}t.EmptyBTree=function(){var e=new n;return e.freeze(),e}()}}]);
//# sourceMappingURL=9005.b339fec5.chunk.js.map