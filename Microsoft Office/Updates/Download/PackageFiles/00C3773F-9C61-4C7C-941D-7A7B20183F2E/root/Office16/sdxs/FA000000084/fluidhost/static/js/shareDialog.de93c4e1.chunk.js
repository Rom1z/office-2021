"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[5656],{16805:function(e,r,t){t.d(r,{E:function(){return c}});var n=t(15671),o=t(43144),a=t(60136),i=t(29388),s=t(72791),d=t(87504),l=t(39647),c=function(e){(0,a.Z)(t,e);var r=(0,i.Z)(t);function t(e){var o;return(0,n.Z)(this,t),(o=r.call(this,e)).state={hasError:!1},o}return(0,o.Z)(t,[{key:"componentDidCatch",value:function(e){var r=new l.hl(d.k6.FluentUiError,e.stack,e.stack);this.props.onRenderPromise.reject(r),this.props.onCompletePromise.reject(r)}},{key:"render",value:function(){if(!this.state.hasError)return this.props.children;alert(this.props.stringTable.fluentUiErrorTitle)}}],[{key:"getDerivedStateFromError",value:function(){return{hasError:!0}}}]),t}(s.Component)},85670:function(e,r,t){t.d(r,{Z:function(){return g}});var n=t(29439),o=t(72791),a=t(97708),i=t(90110),s=t(23711),d=t(46839),l=t(87504),c=t(39647),u=t(60661),h="shareIframe",m="www.odwebp.svc.ms",p="https://".concat(m,"/share"),f=void 0,g=o.memo((function(e){var r=e.payloadPromise,t=e.onRenderPromise,s=e.onCompletePromise,d=e.stringTable,l=e.perfMarks,g=e.localization,k=e.renderState,T=e.setRenderState,y=e.onIframeDismiss,S=e.isEnterpriseEndpointEnabled,C=e.isCrossDomainClipboardAccessEnabled,P=o.useState(void 0),D=(0,n.Z)(P,2),L=D[0],Z=D[1],x=o.useState({width:(0,u.qB)(u.pJ),height:u.PN}),R=(0,n.Z)(x,2),$=R[0],M=R[1],_=o.useRef(null),U=o.useRef(null),j=o.useCallback((function(e){var r=e.width,t=e.height;M({width:(0,u.qB)(r),height:t})}),[]),B=o.useCallback((function(e){if(S){f=new URL(e).hostname;var r=Date.now();return"".concat(e).concat("/_layouts/15/sharedialog.aspx?crossdomain=true&migratedhosting=true","&clientId=").concat("fluid","&clickTime=").concat(r)}return f=m,"".concat(p,"?smkt=").concat(g.locale)}),[S,g.locale]),N=o.useCallback((function(e){e&&e.focus()}),[]),z=o.useCallback((function(e){e&&(e.submit(),l.payloadSendStartTime=performance.now())}),[l]),A=o.useCallback((function(){if(null!==_.current&&void 0!==L){var e=L.authToken,r=B(L.webAbsoluteUrl);_.current.target=h,_.current.method="POST",_.current.action=r;var t=document.createElement("input");t.type="text",t.value=e,t.name="access_token",t.hidden=!0,_.current.appendChild(t);var n=document.createElement("input");n.type="text",n.value=JSON.stringify(L),n.name="context",n.hidden=!0,_.current.appendChild(n),_.current.submit(),l.payloadSendStartTime=performance.now()}}),[B,_,L,l]),I=S?A:z;o.useEffect((function(){r.then((function(e){if(Z(e),C){var r=function(e,r){var t="";return"clipboard-read self "+(t=r?new URL(e).origin:p)+"; clipboard-write self "+t}(e.webAbsoluteUrl,S);U.current&&(U.current.allow=r)}I()})).catch((function(e){t.reject(e),s.reject(e)}))}),[r,L,s,t,I,S,C]),o.useEffect((function(){s.catch((function(){T(c.T$.Error)}))}),[s]),o.useEffect((function(){var e=function(e){v(e,y,t,s,T,j,l)};return window.addEventListener("message",e),function(){window.removeEventListener("message",e)}}),[]);var J=b(k,$.width,$.height),F=w($.width,$.height);return o.createElement(o.Fragment,null,k===c.T$.Loading&&o.createElement("div",{className:E,"aria-label":"Loading",ref:N},o.createElement(a.$,{size:i.E.large})),k===c.T$.Error&&o.createElement("div",{"aria-label":d.shareDialogErrorMessage},d.shareDialogErrorMessage),k!==c.T$.Error&&o.createElement("div",{className:J},S?o.createElement("form",{id:"shareform",ref:_}):L&&o.createElement("form",{id:"shareform",action:B(""),method:"post",target:h,ref:I},o.createElement("input",{type:"text",name:"context",defaultValue:JSON.stringify(L),style:{display:"none"}})),o.createElement("iframe",{className:F,name:h,title:e.stringTable.shareIframeTitle,sandbox:void 0,role:"dialog",ref:U})))})),v=function(e,r,t,n,o,a,i){var s=new URL(e.origin);if("https:"===s.protocol&&s.hostname===f){var u=JSON.parse(e.data);switch(u.name){case"share_started":i.sharePointLoadStartTime=performance.now();break;case"share_ready":o(c.T$.Loaded),t.resolve(!0);break;case"share_resize":u&&(0,d.h)(u.width)&&(0,d.h)(u.height)&&0!==u.width&&0!==u.height&&a({width:u.width,height:u.height});break;case"share_dismiss":r();break;case"share_grantAccessCompleted":n.resolve(null===u||void 0===u?void 0:u.successful);break;case"share_completed":n.resolve(!0);break;case"share_error":var h=null!==u&&void 0!==u&&u.error?u.error.toString():"error not provided",m=null!==u&&void 0!==u&&u.errorCategory?u.errorCategory.toString():"error category not provided",p=null!==u&&void 0!==u&&u.errorMessage?u.errorMessage:"error message not provided",g=null!==u&&void 0!==u&&u.debugErrorMessage?u.debugErrorMessage:"debug error message not provided",v=new c.hl(l.k6.SpoShareError,p,g,h,m);t.reject(v),n.reject(v)}}},E=(0,s.y0)({width:350,height:250,paddingBottom:50,display:"flex",justifyContent:"center",alignContent:"center",selectors:{":focus":{outline:"none"}}}),w=function(e,r){return(0,s.y0)({width:e,height:r,border:"none"})},b=function(e,r,t){return(0,s.y0)({width:e===c.T$.Loaded?r:0,height:e===c.T$.Loaded?t:0,overflow:"hidden"})}},29772:function(e,r,t){t.r(r),t.d(r,{ShareDialog:function(){return E},ShareDialogRenderer:function(){return w}});var n=t(1413),o=t(29439),a=t(72791),i=t(88096),s=t(88057),d=t(10914),l=t(84014),c=t(99128),u=t(99329),h=t(39647),m=t(85670),p=t(60661),f=t(87504),g=t(16805),v=t(75815),E=a.memo((function(e){var r=e.onRenderPromise,t=e.onCompletePromise,E=e.onDismissDialog,w=e.stringTable,b=e.perfMarks,k=e.localization,T=e.shareMode,y=e.dialogProps,S=e.showShareProps,C=a.useState(!1),P=(0,o.Z)(C,2),D=P[0],L=P[1],Z=a.useState(h.T$.Loading),x=(0,o.Z)(Z,2),R=x[0],$=x[1],M=function(){L(!0),E()},_=function(e){switch(e){case h.T$.Loading:return{header:{padding:0,height:50},title:{padding:0},inner:{padding:0}};case h.T$.Loaded:return{header:{padding:0,height:0},title:{padding:0},inner:{padding:0,"@media (min-width: 320px) and (max-width: 479px)":{padding:0}}};case h.T$.Error:return{header:{padding:0,height:50},title:{paddingTop:15,paddingBottom:15,paddingLeft:20},inner:{padding:20,width:330}}}}(R),U=(0,i.F)(),j=(0,p.bB)(U,null===y||void 0===y?void 0:y.theme,S);return j.then((function(){b.payloadLoadEndTime=performance.now(),(0,c.s)(15e3,[r,t]).then((function(e){if(e){var n=new h.hl(f.k6.SpoTimeoutError);(0,p.C9)(r,t,n)}})).catch((function(){}))})).catch((function(){})),a.createElement(g.E,{onCompletePromise:t,onRenderPromise:r,stringTable:w},a.createElement(s.f,{theme:null===y||void 0===y?void 0:y.theme},a.createElement(d.V,(0,n.Z)({dialogContentProps:{type:l.i.normal,styles:_},hidden:D,modalProps:{isBlocking:!1,styles:{main:{maxWidth:p.lB,minWidth:p.pJ}}},onDismiss:M,maxWidth:"none",title:R===h.T$.Error?T===u.T.copyLink?w.copyDialogErrorTitle:w.shareDialogErrorTitle:void 0},y),a.createElement(m.Z,{payloadPromise:j,onRenderPromise:r,onCompletePromise:t,stringTable:w,perfMarks:b,localization:k,renderState:R,setRenderState:$,onIframeDismiss:M,isEnterpriseEndpointEnabled:!(0,p.L2)(e.showShareProps.tokenProvider,e.showShareProps.settingsProvider),isCrossDomainClipboardAccessEnabled:(0,v.qU)(e.showShareProps.settingsProvider)}))))})),w=function(e){var r=a.useState(!0),t=(0,o.Z)(r,2),i=t[0],s=t[1];return i?a.createElement(E,(0,n.Z)((0,n.Z)({},e),{},{onDismissDialog:function(){s(!1),e.onDismissDialog()}})):null}}}]);
//# sourceMappingURL=shareDialog.de93c4e1.chunk.js.map